---
title: Создание надстройки COM для добавления настраиваемых функций InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- InfoPath 2007 и Создание надстроек com InfoPath 2007 добавления настраиваемых функций, COM-надстроек [InfoPath 2007]
localization_priority: Normal
ms.assetid: af0b0bc9-20ef-4503-8b3b-8f2a97b671a2
description: Расширение пользовательского интерфейса редактирования форм Microsoft InfoPath поддерживает COM-надстройки. Хотя поддержка надстройки COM сначала был добавлен в InfoPath, других приложений Office, таких как Microsoft Office Word и Microsoft Office Excel поддерживают COM-надстроек с момента Office 2000.
ms.openlocfilehash: 4c70dfb71cf7b15a0978b4567ffac02a8ba524c3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807390"
---
# <a name="create-a-com-add-in-to-add-custom-features-to-infopath"></a><span data-ttu-id="7f2d9-105">Создание надстройки COM для добавления настраиваемых функций InfoPath</span><span class="sxs-lookup"><span data-stu-id="7f2d9-105">Create a COM Add-in to Add Custom Features to InfoPath</span></span>

<span data-ttu-id="7f2d9-106">Расширение пользовательского интерфейса редактирования форм Microsoft InfoPath поддерживает COM-надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-106">Microsoft InfoPath supports COM Add-ins for extending the form editing user experience.</span></span> <span data-ttu-id="7f2d9-107">Хотя поддержка надстройки COM сначала был добавлен в InfoPath, других приложений Office, таких как Microsoft Office Word и Microsoft Office Excel поддерживают COM-надстроек с момента Office 2000.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-107">Although support for COM Add-ins was first added in InfoPath, other Office applications such as Microsoft Office Word and Microsoft Office Excel have supported COM add-ins since Office 2000.</span></span>
  
<span data-ttu-id="7f2d9-108">Поддержка надстройки COM в приложении InfoPath доступна для среды редактирования форм.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-108">COM Add-in support in InfoPath is available for the form editing environment.</span></span> <span data-ttu-id="7f2d9-109">Среда разработки форм не могут быть расширены с помощью COM-надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-109">The form design environment cannot be extended by using COM Add-ins.</span></span>
  
## <a name="the-idtextensibility2-interface"></a><span data-ttu-id="7f2d9-110">Интерфейс IDTExtensibility2</span><span class="sxs-lookup"><span data-stu-id="7f2d9-110">The IDTExtensibility2 Interface</span></span>

<span data-ttu-id="7f2d9-111">InfoPath, которые среда редактирования обеспечивает поддержку интерфейс **IDTExtensibility2** , который должен быть реализован разработчиками COM Add-которые запускаются **IDTExtensibility2** — это объект двойного интерфейса, который предоставляет пять методов, которые действуют как события в среде редактирования.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-111">The InfoPath editing environment provides support for the **IDTExtensibility2** interface, which must be implemented by developers of COM Add-ins. **IDTExtensibility2** is a dual-interface object that provides five methods which act as events within the editing environment.</span></span> <span data-ttu-id="7f2d9-112">Эти методы позволяют надстройки COM реагировать на среду запуска и завершения работы условий, перечисленных в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-112">These methods allow the COM add-in to respond to environment startup and shutdown conditions, listed in the following table.</span></span> 
  
|<span data-ttu-id="7f2d9-113">**Интерфейс**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-113">**Interface**</span></span>|<span data-ttu-id="7f2d9-114">**Описание**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="7f2d9-115">**OnAddInsUpdate (ByVal custom() как вариант)**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-115">**OnAddInsUpdate (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="7f2d9-116">Происходит, когда надстройка загрузке или выгрузке в среде.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-116">Occurs when an add-in is loaded or unloaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-117">**OnBeginShutdown (ByVal custom() как вариант)**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-117">**OnBeginShutdown (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="7f2d9-118">Возникает при завершении работы среды.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-118">Occurs when the environment is being shut down.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-119">**OnConnection (ByVal как объект приложения, ByVal ConnectMode как ext_ConnectMode, ByVal AddInInst как объект, ByVal custom() как Variant)**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-119">**OnConnection(ByVal Application As Object, ByVal ConnectMode As ext_ConnectMode, ByVal AddInInst As Object, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="7f2d9-120">Происходит, когда надстройка загружается в среде.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-120">Occurs when an add-in is loaded in the environment.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-121">**OnDisconnection (ByVal RemoveMode как ext_DisconnectMode, ByVal custom() как Variant)**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-121">**OnDisconnection (ByVal RemoveMode As ext_DisconnectMode, ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="7f2d9-122">Происходит при выгрузке из среды надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-122">Occurs when an add-in is unloaded from the environment.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-123">**OnStartupComplete (ByVal custom() как вариант)**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-123">**OnStartupComplete (ByVal custom() As Variant)**</span></span> <br/> |<span data-ttu-id="7f2d9-124">Возникает при завершении запуска среды.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-124">Occurs when the environment has completed starting.</span></span>  <br/> |
   
## <a name="registering-com-add-ins"></a><span data-ttu-id="7f2d9-125">Регистрация надстройки COM</span><span class="sxs-lookup"><span data-stu-id="7f2d9-125">Registering COM Add-ins</span></span>

<span data-ttu-id="7f2d9-126">Все приложения Office, включая InfoPath, с помощью реестра для надстроек списка в коллекции надстройки COM для хранения состояния подключения и хранятся сведения о загрузке загрузки или запросами.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-126">All Office applications, including InfoPath, use the registry to list add-ins in the COM Add-Ins collection, to store the connect state, and to store the boot or demand load information.</span></span> <span data-ttu-id="7f2d9-127">Для InfoPath надстройки COM, имя каждой надстройки отображается в следующем разделе:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-127">For InfoPath COM Add-ins, the name of each add-in appears under the following key:</span></span>
  
`HKEY_CURRENT_USER\Software\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="7f2d9-128">Для установки надстройки COM для использования с каждого пользователя на клиентском компьютере в разделе реестра находится в кусте реестра HKLM:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-128">For COM Add-ins installed for use by every user of the client computer, the registry key is located in the HKLM registry hive:</span></span>
  
`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\InfoPath\AddIns\`
  
<span data-ttu-id="7f2d9-129">Имя ключа реестра соответствует **ProgIdAttribute** из надстройки, а также содержит следующие значения.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-129">The registry key name corresponds to the **ProgIdAttribute** of the add-in, and contains the following values.</span></span> 
  
|<span data-ttu-id="7f2d9-130">**Имя**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-130">**Name**</span></span>|<span data-ttu-id="7f2d9-131">**Тип**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-131">**Type**</span></span>|<span data-ttu-id="7f2d9-132">**Описание**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-132">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="7f2d9-133">**FriendlyName**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-133">**FriendlyName**</span></span> <br/> |<span data-ttu-id="7f2d9-134">**Строка**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-134">**String**</span></span> <br/> |<span data-ttu-id="7f2d9-135">Имя, которое отображается в диалоговом окне **надстройки COM** и на странице **Add-ins** в **Центр управления безопасностью**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-135">The name that is displayed in the **COM Add-ins** dialog box and listed in the **Add-ins** page of the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-136">**Описание**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-136">**Description**</span></span> <br/> |<span data-ttu-id="7f2d9-137">**Строка**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-137">**String**</span></span> <br/> |<span data-ttu-id="7f2d9-138">Строка, которая отображается при выборе надстройки в **Центр управления безопасностью**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-138">The string that is displayed when the add-in is selected in the **Trust Center**.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-139">**LoadBehavior**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-139">**LoadBehavior**</span></span> <br/> |<span data-ttu-id="7f2d9-140">**ЗНАЧЕНИЕ DWORD**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-140">**DWORD**</span></span> <br/> |<span data-ttu-id="7f2d9-141">Указывает способ надстройки COM загружается.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-141">Specifies the way the COM Add-in is loaded.</span></span> <span data-ttu-id="7f2d9-142">Значение может быть сочетание 0, 1, 2, 8 и 16.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-142">The value can be a combination of 0, 1, 2, 8, and 16.</span></span> <span data-ttu-id="7f2d9-143">В приведенной ниже таблице для получения дополнительных сведений.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-143">See the table below for more information.</span></span>  <br/> |
   
<span data-ttu-id="7f2d9-144">Значение **DWORD** для **LoadBehavior** должны содержать значение, указывающее способ загрузки надстройки COM в среде редактирования.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-144">The **DWORD** value for **LoadBehavior** should contain a value describing how the COM Add-in loads in the editing environment.</span></span> <span data-ttu-id="7f2d9-145">Значение может быть в таблице ниже или сочетание значений из таблицы.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-145">The value can be from the table below, or a combination of values from the table.</span></span> <span data-ttu-id="7f2d9-146">Например, надстройки COM, созданные в Visual Studio 2005 будут иметь **LoadBehavior** «3» загрузить при запуске приложения и быть подключен.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-146">For example, a COM Add-in created in Visual Studio 2005 will have a **LoadBehavior** of "3" loaded at application startup and be connected.</span></span> 
  
|<span data-ttu-id="7f2d9-147">**Значение**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-147">**Value**</span></span>|<span data-ttu-id="7f2d9-148">**Описание**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-148">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="7f2d9-149">0</span><span class="sxs-lookup"><span data-stu-id="7f2d9-149">0</span></span>  <br/> |<span data-ttu-id="7f2d9-150">Отключен.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-150">Disconnected.</span></span> <span data-ttu-id="7f2d9-151">Надстройки показано, как неактивное в диалоговом окне **надстройки COM** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-151">The add-in shows as Inactive in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-152">1</span><span class="sxs-lookup"><span data-stu-id="7f2d9-152">1</span></span>  <br/> |<span data-ttu-id="7f2d9-153">Подключение.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-153">Connected.</span></span> <span data-ttu-id="7f2d9-154">Надстройки показано, как активный в диалоговом окне **надстройки COM** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-154">The add-in shows as Active in the **COM Add-in** dialog box.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-155">2</span><span class="sxs-lookup"><span data-stu-id="7f2d9-155">2</span></span>  <br/> |<span data-ttu-id="7f2d9-156">Загружать при запуске.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-156">Load at Startup.</span></span> <span data-ttu-id="7f2d9-157">Надстройка загружен и подключен при запуске ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-157">The add-in is loaded and connected when the host application starts.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-158">8</span><span class="sxs-lookup"><span data-stu-id="7f2d9-158">8</span></span>  <br/> |<span data-ttu-id="7f2d9-159">Загружать по запросу.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-159">Load on Demand.</span></span> <span data-ttu-id="7f2d9-160">Надстройка загружен и подключен, когда ведущее приложение необходимо, например, когда пользователь нажимает кнопку, которая использует функциональные возможности надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-160">The add-in is loaded and connected when the host application requires it, for example when a user clicks a button that uses functionality in the add-in.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-161">16</span><span class="sxs-lookup"><span data-stu-id="7f2d9-161">16</span></span>  <br/> |<span data-ttu-id="7f2d9-162">Подключите первый раз.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-162">Connect first time.</span></span> <span data-ttu-id="7f2d9-163">Надстройка будет загружать и подключена при первом запуске ведущее приложение после регистрации надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-163">The add-in will be loaded and connected the first time the user runs the host application after registering the add-in.</span></span>  <br/> |
   
## <a name="creating-a-managed-com-add-in-with-visual-studio-2005-or-visual-studio-2008"></a><span data-ttu-id="7f2d9-164">Создание управляемой надстройки COM с помощью Visual Studio 2005 или Visual Studio 2008</span><span class="sxs-lookup"><span data-stu-id="7f2d9-164">Creating a Managed COM Add-in with Visual Studio 2005 or Visual Studio 2008</span></span>

<span data-ttu-id="7f2d9-165">Для создания управляемых COM-надстройки с помощью Microsoft Visual Studio 2005 или Visual Studio 2008, создайте проект Общая надстройка следующим образом:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-165">To create a managed COM add-in using Microsoft Visual Studio 2005 or Visual Studio 2008, create a Shared Add-In project as follows:</span></span> 
  
1. <span data-ttu-id="7f2d9-166">Запустите Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-166">Start Visual Studio.</span></span>
    
2. <span data-ttu-id="7f2d9-167">В меню **файл** выберите команду **Новый проект**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-167">On the **File** menu, click **New Project**.</span></span>
    
3. <span data-ttu-id="7f2d9-168">В области **Типы проектов** в диалоговом окне **Создать проект** выберите папку **Другие типы проектов** и нажмите кнопку **расширяемости**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-168">In the **Project Types** pane of the **New Project** dialog box, click the **Other Projects Types** folder, and then click **Extensibility**.</span></span>
    
4. <span data-ttu-id="7f2d9-169">В области **Шаблоны** выберите **Общая надстройка**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-169">In the **Templates** pane, click **Shared Add-In**.</span></span>
    
5. <span data-ttu-id="7f2d9-170">В поле **имя** введите имя для проекта.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-170">In the **Name** box, type a name for the project.</span></span> 
    
6. <span data-ttu-id="7f2d9-171">В поле **расположение** введите путь к папке или нажмите кнопку **Обзор** и выберите путь к папке и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-171">In the **Location** box, type a folder path or click **Browse** and select a folder path, and then click **OK**.</span></span> <span data-ttu-id="7f2d9-172">Откроется **Мастер надстроек Shared** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-172">The **Shared Add-in Wizard** appears.</span></span> 
    
7. <span data-ttu-id="7f2d9-173">Нажмите кнопку **Далее** в **общих мастер надстроек**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-173">Click **Next** in the **Shared Add-in Wizard**.</span></span> <span data-ttu-id="7f2d9-174">Откроется страница " **Выбрать язык программирования** ".</span><span class="sxs-lookup"><span data-stu-id="7f2d9-174">The **Select a Programming Language** page appears.</span></span> 
    
8. <span data-ttu-id="7f2d9-175">Нажмите кнопку **Создать надстройку, используя Visual Basic**, а затем нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-175">Click **Create an Add-in using Visual Basic**, then click **Next**.</span></span> <span data-ttu-id="7f2d9-176">Откроется страница " **Выберите ведущее приложение** ".</span><span class="sxs-lookup"><span data-stu-id="7f2d9-176">The **Select An Application Host** page appears.</span></span> 
    
9. <span data-ttu-id="7f2d9-177">Снимите флажки рядом с пунктом каждого приложения, за исключением **Microsoft InfoPath**и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-177">Uncheck the boxes next to each application except **Microsoft InfoPath**, and then click **Next**.</span></span> <span data-ttu-id="7f2d9-178">Откроется страница " **Введите имя и описание** ".</span><span class="sxs-lookup"><span data-stu-id="7f2d9-178">The **Enter a Name and Description** page appears.</span></span> 
    
10. <span data-ttu-id="7f2d9-179">В поле **имя надстройки** введите имя для надстройки COM.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-179">In the **What is the name of your Add-In** box, type the name of your COM Add-in.</span></span> 
    
11. <span data-ttu-id="7f2d9-180">В поле **Описание - in** введите описание для надстройки COM и нажмите кнопку **Далее**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-180">In the **What is the description of your Add-In** box, type the description for your COM Add-in, and click **Next**.</span></span> <span data-ttu-id="7f2d9-181">Откроется страница " **Выберите параметры надстройки** ".</span><span class="sxs-lookup"><span data-stu-id="7f2d9-181">The **Choose Add-In Options** page appears.</span></span> 
    
12. <span data-ttu-id="7f2d9-182">Проверьте, **как надстройку во время запуска ведущего приложения загрузки** и **надстройку во должны быть доступны для всех пользователей компьютера, на котором установлена на не только человека, который устанавливает** окон.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-182">Check the **I would like my Add-in to load when the host application loads** and **My Add-in should be available to all users of the computer it was installed on, not just the person who installs it** boxes.</span></span> 
    
13. <span data-ttu-id="7f2d9-183">Нажмите кнопку **Далее** для просмотра на странице **Сводка** , а затем нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-183">Click **Next** to review the **Summary** page, then click **Finish**.</span></span>
    
<span data-ttu-id="7f2d9-184">После создания проекта в Visual Studio, вы увидите два проекта в окне Обозреватель решений.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-184">After the project is created by Visual Studio, you will see two projects in the Solution Explorer window.</span></span> <span data-ttu-id="7f2d9-185">Первый проект — это проект для надстройки COM; второй — проект программы установки для развертывания надстройки COM.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-185">The first project is the project for the COM Add-in; the second project is a setup project for deploying the COM Add-in.</span></span> <span data-ttu-id="7f2d9-186">**Shared Add-in Wizard** только вставляет ссылки на **Библиотеку объектов Microsoft Office 14.0**, поэтому необходимо вставить ссылку на библиотеку объектов Microsoft InfoPath, выполнив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-186">The **Shared Add-in Wizard** only inserts a reference to the **Microsoft Office 14.0 Object Library**, so it is necessary to insert a reference to the InfoPath object library using the following steps:</span></span>
  
1. <span data-ttu-id="7f2d9-187">Дважды щелкните **Мой проект** для отображения свойств проекта надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-187">Double-click **My Project** to display the add-in project properties.</span></span> <span data-ttu-id="7f2d9-188">Перейдите на вкладку **ссылки** для отображения справочных материалов, автоматически добавляется в проект.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-188">Click the **References** tab to display the references automatically added to the project.</span></span> 
    
2. <span data-ttu-id="7f2d9-189">Нажмите кнопку **Добавить** , чтобы открыть диалоговое окно **Добавить ссылку** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-189">Click the **Add** button to display the **Add Reference** dialog box.</span></span> 
    
3. <span data-ttu-id="7f2d9-190">На вкладке **COM** дважды щелкните **Библиотека типов Microsoft.InfoPath 2.0**и нажмите **кнопку ОК**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-190">On the **COM** tab, double-click **Microsoft.InfoPath 2.0 Type Library**, and click **OK**.</span></span>
    
4. <span data-ttu-id="7f2d9-191">Добавление ссылки на **Библиотеку типа Microsoft InfoPath 3.0** также добавляет ссылки на три сборки, которые должны быть удалены: **ADODB**, **MSHTML**и **MSXML2 описывается**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-191">Adding a reference to the **Microsoft InfoPath 3.0 Type Library** also adds references to three assemblies that must be removed: **ADODB**, **MSHTML**, and **MSXML2**.</span></span> <span data-ttu-id="7f2d9-192">В **Обозревателе решений** в области **справочных материалов**щелкните правой кнопкой мыши каждый из этих ссылок и нажмите кнопку **Удалить**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-192">In **Solution Explorer** under **References**, right-click each of these references, and then click **Remove**.</span></span>
    
## <a name="viewing-the-registry-settings"></a><span data-ttu-id="7f2d9-193">Просмотр параметров реестра</span><span class="sxs-lookup"><span data-stu-id="7f2d9-193">Viewing the Registry Settings</span></span>

<span data-ttu-id="7f2d9-194">Чтобы просмотреть параметры реестра, которые будут созданы при установке надстройки COM, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-194">To view the registry settings that will be created when the COM Add-in is installed, follow these steps:</span></span>
  
1. <span data-ttu-id="7f2d9-195">Щелкните правой кнопкой мыши корневой узел проекта установки в **Окне Обозреватель решений**, нажмите кнопку **Просмотр**, затем **редактора**, затем нажмите кнопку **реестра**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-195">Right-click the root node of the setup project in the **Solution Explorer**, click **View**, then **Editor**, then click **Registry**.</span></span>
    
2. <span data-ttu-id="7f2d9-196">В левой области нажмите знак плюс разверните **HKEY_LOCAL_MACHINE**, **программное обеспечение**, **Корпорация Майкрософт**, **InfoPath**, а затем **AddIns**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-196">In the left-hand pane, click the plus to expand **HKEY_LOCAL_MACHINE**, **Software**, **Microsoft**, **InfoPath**, then **AddIns**.</span></span>
    
3. <span data-ttu-id="7f2d9-197">Выберите имя, соответствующее общей надстройки проекта **ProgID**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-197">Click the name corresponding to your shared add-in project's **ProgID**.</span></span>
    
<span data-ttu-id="7f2d9-198">Изменение любого из этих свойств, щелкните правой кнопкой мыши свойство, щелкните **Окно "Свойства"** и введите **значение** в **Окно "Свойства"**.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-198">To change any of these properties, right-click the property, click **Properties Window**, and change the **Value** box in the **Properties Window**.</span></span>
  
## <a name="compiling-and-distributing-the-shared-add-in"></a><span data-ttu-id="7f2d9-199">Компиляция и распространение общей надстройкой</span><span class="sxs-lookup"><span data-stu-id="7f2d9-199">Compiling and Distributing the Shared Add-In</span></span>

<span data-ttu-id="7f2d9-200">Для компиляции управляемой надстройки COM для тестирования на компьютере, на котором был разработан project Общая надстройка, щелкните правой кнопкой мыши корневой узел Общая надстройка проекта в обозревателе решений и выберите построение.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-200">To compile the managed COM Add-in for testing on the computer on which the Shared Add-In project was developed, right-click the root node of the Shared Add-In project in the Solution Explorer and click Build.</span></span> <span data-ttu-id="7f2d9-201">При построении проекта без ошибок, можно начать среды редактирования InfoPath и начать с помощью управляемой надстройки COM.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-201">If the project builds with no errors, you can start the InfoPath editing environment and begin using the managed COM Add-in.</span></span> <span data-ttu-id="7f2d9-202">Если у вас есть экземпляр InfoPath под управлением, закройте его перед построением проекта.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-202">If you have an instance of InfoPath running, close it before building the project.</span></span> <span data-ttu-id="7f2d9-203">Он также может потребоваться открыть диалоговое окно надстройки COM, чтобы убедиться, что надстройка COM зарегистрирован.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-203">It may also be necessary to open the COM Add-ins dialog box to verify that the COM Add-in is registered.</span></span> <span data-ttu-id="7f2d9-204">Чтобы открыть диалоговое окно надстройки COM, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-204">To open the COM Add-ins dialog box, follow these steps:</span></span>
  
1. <span data-ttu-id="7f2d9-205">Откройте среды редактирования InfoPath.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-205">Open the InfoPath editing environment.</span></span> <span data-ttu-id="7f2d9-206">Для этого проще всего открыть существующего шаблона формы, которая создаст новую форму на основе этого шаблона формы.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-206">The easiest way to do this is to open an existing form template, which will create a new form based on that form template.</span></span>
    
2. <span data-ttu-id="7f2d9-207">В меню **Сервис** щелкните **Центр управления безопасностью** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-207">Click **Trust Center** on the **Tools** menu.</span></span> 
    
3. <span data-ttu-id="7f2d9-208">Выберите категорию **надстройки** слева.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-208">Click the **Add-ins** category on the left.</span></span> 
    
4. <span data-ttu-id="7f2d9-209">В разделе **Управление** в нижней части диалогового окна **Центр управления безопасностью** выберите **надстройки COM** в списке и нажмите кнопку **Перейти** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-209">In the **Manage** section near the bottom of the **Trust Center** dialog box, select **COM Add-ins** from the list and click the **Go** button.</span></span> 
    
5. <span data-ttu-id="7f2d9-210">В диалоговом окне **надстройки COM** появится имя надстройки недавно созданных и должен появиться флажок рядом с ним.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-210">In the **COM Add-ins** dialog box, you will see the name of your recently-built add-in and there should be a check box next to it.</span></span> <span data-ttu-id="7f2d9-211">Если флажок рядом с ним, надстройки COM не удалось загрузить из-за ошибки, которое указывается в разделе **Поведение загрузки** диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-211">If there is no check box next to it, the COM Add-in failed to load due to an error, which will be listed in the **Load Behavior** section of the dialog box.</span></span> 
    
<span data-ttu-id="7f2d9-212">Чтобы компилировать управляемой надстройки COM для использования на компьютере, отличных от компьютера, на котором был разработан Общая надстройка project, необходимо выполнить дополнительные действия для обеспечения безопасности кода.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-212">To compile the managed COM add-in for use on a computer other than the computer on which the Shared Add-In project was developed, you must follow additional steps to secure your code.</span></span> <span data-ttu-id="7f2d9-213">Сведения о защите проекты Общая надстройка для использования на других компьютерах, просмотрите следующие три статьи:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-213">For information on securing Shared Add-In projects for use on other computers, see the following three articles:</span></span>
  
- [<span data-ttu-id="7f2d9-214">Развертывание из управляемых надстроек COM в Office XP</span><span class="sxs-lookup"><span data-stu-id="7f2d9-214">Deployment of Managed COM Add-Ins in Office XP</span></span>](http://go.microsoft.com/fwlink/?LinkID=73473)
  
- [<span data-ttu-id="7f2d9-215">Использование решений оболочки совместимости надстройки COM для развертывания управляемых надстроек COM в Office XP</span><span class="sxs-lookup"><span data-stu-id="7f2d9-215">Using the COM Add-in Shim Solution to Deploy Managed COM Add-ins in Office XP</span></span>](http://go.microsoft.com/fwlink/?LinkID=73474)
  
- [<span data-ttu-id="7f2d9-216">Изолирование расширений Microsoft Office с помощью мастера COM Shim</span><span class="sxs-lookup"><span data-stu-id="7f2d9-216">Isolating Office Extensions with the COM Shim Wizard</span></span>](http://go.microsoft.com/fwlink/?LinkID=73475)
  
> [!IMPORTANT]
> <span data-ttu-id="7f2d9-217">Не изоляция надстройки COM может стать причиной утечки памяти и нестабильности приложения.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-217">Not isolating the COM Add-in may cause memory leaks and application instability.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="7f2d9-218">Если .NET Framework или другие необходимые сборки из проекта установки не уже установлены на конечных компьютерах, MSI-файл может установлен неправильно.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-218">If the .NET Framework or other required assemblies from the setup project are not already installed on target computers, the .msi file may not install properly.</span></span> <span data-ttu-id="7f2d9-219">Кроме того нельзя распространение MSI-файл и затем предпринята попытка установить MSI-файл.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-219">Also, you cannot distribute the .msi file and then attempt to install the .msi file.</span></span> <span data-ttu-id="7f2d9-220">Необходимо также передать другие файлы поддержки в той же папке, что исходный файл MSI-файла, созданные приложением Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-220">You must also distribute the other support files in the same folder as the original .msi file generated by Visual Studio.</span></span> 
  
## <a name="coding-in-the-com-add-in"></a><span data-ttu-id="7f2d9-221">Написание кода в надстройки COM</span><span class="sxs-lookup"><span data-stu-id="7f2d9-221">Coding in the COM Add-in</span></span>

<span data-ttu-id="7f2d9-222">События приложения, которые происходят в редактора форм InfoPath можно записаны с COM-надстройки.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-222">Application events that occur in the InfoPath form editing environment can be captured by a COM Add-in.</span></span> <span data-ttu-id="7f2d9-223">Можно использовать следующие события объекта [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) , надстройка COM реагировать на действия пользователя:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-223">The following events of the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object can be used by the COM Add-in to respond to user actions:</span></span> 
  
|<span data-ttu-id="7f2d9-224">**Событие**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-224">**Event**</span></span>|<span data-ttu-id="7f2d9-225">**Описание**</span><span class="sxs-lookup"><span data-stu-id="7f2d9-225">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="7f2d9-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-226">[NewXDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.NewXDocument.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-227">Происходит при создании новой формы.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-227">Occurs when a new form is created.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-228">[Завершите работу](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-228">[Quit](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.Quit.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-229">Происходит, когда пользователь покидает InfoPath.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-229">Occurs when the user quits InfoPath.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-230">[WindowActivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowActivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-231">Происходит при активации любого окна документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-231">Occurs when any document window is activated.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-232">[WindowDeactivate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowDeactivate.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-233">Происходит при отключении любого окна документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-233">Occurs when any document window is deactivated.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-234">[WindowSize](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.WindowSize.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-235">Происходит при изменении размера или перемещении любого окна документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-235">Occurs when any document window is resized or moved.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-236">[XDocumentBeforeClose](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeClose.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-237">Происходит непосредственно перед закрытием любого открытого документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-237">Occurs immediately before any open document closes.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-238">[XDocumentBeforePrint](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforePrint.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-239">Происходит непосредственно перед печатью любого открытого документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-239">Occurs immediately before any open document is printed.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-240">[XDocumentBeforeSave](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentBeforeSave.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-241">Происходит непосредственно перед сохранением любого открытого документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-241">Occurs immediately before any open document is saved.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-242">[XDocumentChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentChange.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-243">Происходит при создании новой формы, при открытии существующей формы или при активировании другой формы.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-243">Occurs when a new form is created, when an existing form is opened, or when another form is made the active form.</span></span>  <br/> |
|<span data-ttu-id="7f2d9-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Событие</span><span class="sxs-lookup"><span data-stu-id="7f2d9-244">[XDocumentOpen](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._ApplicationEvents_Event.XDocumentOpen.aspx) Event</span></span>  <br/> |<span data-ttu-id="7f2d9-245">Происходит при открытии документа.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-245">Occurs when a document is opened.</span></span>  <br/> |
   
<span data-ttu-id="7f2d9-246">Для записи этих событий в надстройки COM, необходимо объявить следующие переменные уровня класса в классе **Connect** :</span><span class="sxs-lookup"><span data-stu-id="7f2d9-246">To capture these events in the COM Add-in, you must declare the following class-level variables in your **Connect** class:</span></span> 
  
```vb
InfoPathApplication = DirectCast( _
   application, Microsoft.Office.Interop.InfoPath._Application3)
InfoPathApplicationEvents = DirectCast( _
   InfoPathApplication.Events, _
   Microsoft.Office.Interop.InfoPath.ApplicationEvents)
```

```cs
InfoPathApplication =
   (Microsoft.Office.Interop.InfoPath._Application3)application;
InfoPathApplicationEvents =
   (Microsoft.Office.Interop.InfoPath.ApplicationEvents)
   InfoPathApplication.Events;
```

<span data-ttu-id="7f2d9-247">Первая строка приводит универсальное приложение, **объект** , получаемые добавить в объект [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-247">The first line casts the generic application **Object** received by the add-in to the [_Application3](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.aspx) object.</span></span> <span data-ttu-id="7f2d9-248">Во второй строке приводит свойства [событий](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) объекта **_Application3** (представленное переменной **InfoPathApplication** ) объект [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-248">The second line casts the [Events](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._Application3.Events.aspx) property of the **_Application3** object (represented by the **InfoPathApplication** variable) to the [ApplicationEvents](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ApplicationEvents.aspx) object.</span></span> 
  
<span data-ttu-id="7f2d9-249">Создание обработчиков событий, выберите **InfoPathApplicationEvents** из раскрывающегося списка **Имя класса** в верхней части окна Visual Studio и выберите события, которое вы хотите обрабатывать в раскрывающемся списке **Имя метода** в верхней части визуального Окно Studio.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-249">To create event handlers, select **InfoPathApplicationEvents** from the **Class Name** drop-down box at the top of the Visual Studio window, and then select the event you want to handle in the **Method Name** drop-down box at the top of the Visual Studio window.</span></span> <span data-ttu-id="7f2d9-250">К примеру Если вам нужно управлять при сохранении формы, обрабатывать события **XDocumentBeforeSave** .</span><span class="sxs-lookup"><span data-stu-id="7f2d9-250">For example, if you need to control when a form is saved, you handle the **XDocumentBeforeSave** event.</span></span> <span data-ttu-id="7f2d9-251">При выборе **XDocumentBeforeSave** из раскрывающегося списка **Имя метода** автоматически вставляется следующую процедуру:</span><span class="sxs-lookup"><span data-stu-id="7f2d9-251">Selecting **XDocumentBeforeSave** from the **Method Name** drop-down automatically inserts the following procedure:</span></span> 
  
```vb
Private Sub InfoPathApplicationEvents_XDocumentBeforeSave( _
   ByVal pDocument As Microsoft.Office.Interop.InfoPath._XDocument, _
   ByRef pfCancel As Boolean) _
   Handles InfoPathApplicationEvents.XDocumentBeforeSave
End Sub
```

```cs
private void InfoPathApplicationEvents_XDocumentBeforeSave(
   Microsoft.Office.Interop.InfoPath._XDocument pDocument, ref bool pfCancel)
{
}

```

<span data-ttu-id="7f2d9-252">Какие-либо события объекта **ApplicationEvents** могут быть обработаны с надстройки COM тем же способом.</span><span class="sxs-lookup"><span data-stu-id="7f2d9-252">Any of the events of the **ApplicationEvents** object can be handled by the COM Add-in using the same method.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="7f2d9-253">См. также</span><span class="sxs-lookup"><span data-stu-id="7f2d9-253">See also</span></span>

- [<span data-ttu-id="7f2d9-254">Создание Microsoft Office 2000 надстройки COM</span><span class="sxs-lookup"><span data-stu-id="7f2d9-254">Creating a Microsoft Office 2000 COM Add-in</span></span>](http://go.microsoft.com/fwlink/?LinkID=73468) 
- [<span data-ttu-id="7f2d9-255">Создание Office управляемых COM-надстроек с помощью Visual Studio .NET</span><span class="sxs-lookup"><span data-stu-id="7f2d9-255">Creating Office Managed COM Add-Ins with Visual Studio .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73470)
- [<span data-ttu-id="7f2d9-256">Работа с IDTExtensibility2 процедуры событий</span><span class="sxs-lookup"><span data-stu-id="7f2d9-256">Working with the IDTExtensibility2 Event Procedures</span></span>](http://go.microsoft.com/fwlink/?LinkID=73471)
- [<span data-ttu-id="7f2d9-257">Построение Office надстройки COM с помощью Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="7f2d9-257">Build an Office COM Add-in With Visual Basic .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73469)
- [<span data-ttu-id="7f2d9-258">Построение Office надстройки COM с помощью Visual C# .NET</span><span class="sxs-lookup"><span data-stu-id="7f2d9-258">Build an Office COM Add-in With Visual C# .NET</span></span>](http://go.microsoft.com/fwlink/?LinkID=73472)
- [<span data-ttu-id="7f2d9-259">Создание надстроек 2007 InfoPath с помощью Visual Studio 2005 Tools for the Office System SE (en)</span><span class="sxs-lookup"><span data-stu-id="7f2d9-259">Creating InfoPath 2007 Add-Ins by Using Visual Studio 2005 Tools for the Office System SE</span></span>](http://msdn.microsoft.com/ru-ru/library/bb968857%28office.12%29.aspx)


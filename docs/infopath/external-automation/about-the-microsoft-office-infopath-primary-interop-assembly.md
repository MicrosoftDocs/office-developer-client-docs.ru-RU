---
title: Сведения об основной сборке взаимодействия Microsoft Office InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- InfoPath 2007, основная сборка взаимодействия, основная сборка взаимодействия InfoPath, PIA [InfoPath 2007], основные сборки взаимодействия [InfoPath 2007]
localization_priority: Normal
ms.assetid: 1b3ae03c-6951-49e4-a489-4712d3f7ba72
description: Для поддержки создания решений InfoPath, использующих языки с управляемым кодом, такие как Visual C# и Visual Basic, параметр Поддержка программирования .NET в программе установки InfoPath устанавливает три сборки взаимодействия.
ms.openlocfilehash: 51773ad46b1371c410c4249e13a489f0c5550cd1
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310138"
---
# <a name="about-the-microsoft-office-infopath-primary-interop-assembly"></a><span data-ttu-id="a5403-104">Сведения об основной сборке взаимодействия Microsoft Office InfoPath</span><span class="sxs-lookup"><span data-stu-id="a5403-104">About the Microsoft Office InfoPath Primary Interop Assembly</span></span>

<span data-ttu-id="a5403-105">Приложение InfoPath создается как приложение модели компонентных объектов (COM), которое предоставляет интерфейсы программирования для внешней автоматизации как интерфейсы COM.</span><span class="sxs-lookup"><span data-stu-id="a5403-105">The InfoPath application is built as a Component Object Model (COM) application that exposes its programmability interfaces for external automation as COM interfaces.</span></span> <span data-ttu-id="a5403-106">Для поддержки создания решений InfoPath, использующих языки с управляемым кодом, такие как Visual C# и Visual Basic, параметр **Поддержка программирования .NET** в программе установки InfoPath устанавливает три сборки взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="a5403-106">To support the creation of InfoPath solutions that use managed-code languages such as Visual C# and Visual Basic, the **.NET Programmability Support** option in the InfoPath setup program installs three interop assemblies.</span></span> <span data-ttu-id="a5403-107">Сборки взаимодействия представляют собой сборки .NET, которые служат "мостом" между управляемым и неуправляемым кодами, сопоставляя элементы COM-объекта эквивалентным управляемым элементам .NET.</span><span class="sxs-lookup"><span data-stu-id="a5403-107">Interop assemblies are .NET assemblies that act as a bridge between managed and unmanaged code, mapping COM object members to equivalent .NET managed members.</span></span> 
  
<span data-ttu-id="a5403-108">Файлы для трех сборок взаимодействия, устанавливаемых InfoPath, имеют следующие имена:</span><span class="sxs-lookup"><span data-stu-id="a5403-108">The files for the three interop assemblies installed by InfoPath are named:</span></span>
  
- <span data-ttu-id="a5403-109">Microsoft. Office. Interop. InfoPath. dll</span><span class="sxs-lookup"><span data-stu-id="a5403-109">Microsoft.Office.Interop.InfoPath.dll</span></span>
    
- <span data-ttu-id="a5403-110">Microsoft. Office. Interop. InfoPath. SemiTrust. dll</span><span class="sxs-lookup"><span data-stu-id="a5403-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span></span>
    
- <span data-ttu-id="a5403-111">Microsoft. Office. Interop. InfoPath. XML. dll</span><span class="sxs-lookup"><span data-stu-id="a5403-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span></span>
    
<span data-ttu-id="a5403-112">В этом разделе рассматривается объектная модель, доступная через сборку взаимодействия Microsoft. Office. Interop. InfoPath, которая используется исключительно для внешнего кода автоматизации.</span><span class="sxs-lookup"><span data-stu-id="a5403-112">This topic discusses the object model exposed through the Microsoft.Office.Interop.InfoPath interop assembly, which is used exclusively for external automation code.</span></span> <span data-ttu-id="a5403-113">Для получения сведений о сборке Microsoft. Office. Interop. InfoPath. SemiTrust, которая используется исключительно для написания и выполнения управляемого кода, который выполняется в шаблонах форм InfoPath (XSN), ознакомьтесь с [объектНыми моделЯми infopath 2003, совместимыми с infopath](https://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5403-113">For information on the Microsoft.Office.Interop.InfoPath.SemiTrust assembly, which is used exclusively for writing and running managed code that runs from within InfoPath form templates (.xsn), see [InfoPath 2003 Compatible Object Models](https://msdn.microsoft.com/library/e4511af6-d7e7-44ad-a50d-1b7ee04f8215%28Office.15%29.aspx).</span></span>
  
## <a name="important-installation-information"></a><span data-ttu-id="a5403-114">Важная информация об установке</span><span class="sxs-lookup"><span data-stu-id="a5403-114">Important Installation Information</span></span>

<span data-ttu-id="a5403-115">Параметр установки по умолчанию программы установки InfoPath устанавливает сборку Microsoft. Office. Interop. InfoPath в глобальном кэше сборок (GAC), содержимое которого можно просмотреть из папки C:\WINDOWS\assembly. (или в К:\виндовс\ассембли\гак_ MSIL при непосредственном просмотре файловой системы).</span><span class="sxs-lookup"><span data-stu-id="a5403-115">The default installation option of the InfoPath setup program installs the Microsoft.Office.Interop.InfoPath assembly in the Global Assembly Cache (GAC), the contents of which can be viewed from the C:\Windows\Assembly folder (or in C:\Windows\assembly\GAC_MSIL when viewing the file system directly).</span></span> <span data-ttu-id="a5403-116">Эта сборка называется "основной сборкой взаимодействия Microsoft Office InfoPath" и часто используется вместе с сборкой Microsoft. Office. Interop. InfoPath. XML, которая также установлена в ГЛОБАЛЬном КЭШЕ сборок для автоматизации приложения InfoPath из внешние приложения, использующие управляемый код.</span><span class="sxs-lookup"><span data-stu-id="a5403-116">This assembly is referred to as the "Microsoft Office InfoPath Primary Interop Assembly" and is often used in conjunction with the Microsoft.Office.Interop.InfoPath.Xml assembly, which is also installed in the GAC, to automate the InfoPath application from external applications that use managed code.</span></span> <span data-ttu-id="a5403-117">Для получения сведений о сборке Microsoft. Office. Interop. InfoPath. XML ознакомьтесь со статьей [о сборке взаимодействия InfoPath в InfoPath](about-the-infopath-xml-interop-assembly.md).</span><span class="sxs-lookup"><span data-stu-id="a5403-117">For information about the Microsoft.Office.Interop.InfoPath.Xml assembly, see [About the InfoPath XML Interop Assembly](about-the-infopath-xml-interop-assembly.md).</span></span>
  
<span data-ttu-id="a5403-118">Если сборка Microsoft. Office. Interop. InfoPath не отображается в ГЛОБАЛЬном КЭШЕ сборок, убедитесь, что приложение InfoPath установлено правильно.</span><span class="sxs-lookup"><span data-stu-id="a5403-118">If the Microsoft.Office.Interop.InfoPath assembly is not visible in the GAC, you should confirm that InfoPath was installed correctly.</span></span> <span data-ttu-id="a5403-119">По умолчанию параметр **поддержки программирования .NET** в программе установки настроен на **Запуск с моего компьютера** при условии, что распространяемый пакет .NET Framework 1,1, пакет средств разработки .NET Framework 1,1 или более поздняя версия .NET Framework. устанавливается перед запуском программы установки.</span><span class="sxs-lookup"><span data-stu-id="a5403-119">By default, the **.NET Programmability Support** option in the setup program is set to **Run from My Computer** as long as the .NET Framework 1.1 Redistributable, .NET Framework 1.1 Software Development Kit (SDK), or a later version of the .NET Framework is installed before running setup.</span></span> <span data-ttu-id="a5403-120">Если эти сборки взаимодействия недоступны на вашем компьютере, необходимо убедиться, что установлено приложение .NET Framework 1,1 или более поздней версии, а затем использовать **программы и компоненты** из **панели управления** для изменения параметров установки с помощью **программирования .NET Поддержка** в разделе **Microsoft Office InfoPath** для **запуска с моего компьютера**.</span><span class="sxs-lookup"><span data-stu-id="a5403-120">If these interop assemblies are not available on your computer, you must confirm that .NET Framework 1.1 or later is installed, and then use **Programs and Features** from the **Control Panel** to change setup by setting the **.NET Programmability Support** option under **Microsoft Office InfoPath** to **Run from My Computer**.</span></span>
  
<span data-ttu-id="a5403-121">Сведения о загрузке распространяемого пакета .NET Framework 1,1 можно найти в разделе [распространяемый пакет .NET framework 1,1](https://www.microsoft.com/en-us/download/details.aspx?id=26).</span><span class="sxs-lookup"><span data-stu-id="a5403-121">For information about downloading the .NET Framework 1.1 Redistributable, see [.NET Framework 1.1 Redistributable](https://www.microsoft.com/en-us/download/details.aspx?id=26).</span></span>
  
## <a name="the-microsoftofficeinteropinfopath-namespace"></a><span data-ttu-id="a5403-122">Пространство имен Microsoft. Office. Interop. InfoPath</span><span class="sxs-lookup"><span data-stu-id="a5403-122">The Microsoft.Office.Interop.InfoPath Namespace</span></span>

<span data-ttu-id="a5403-123">Несмотря на то, что процесс написания управляемого кода для конкретной задачи очень похож на выполнение той же задачи с использованием языка, например Visual Basic для приложений или JScript, объектная модель, доступная при просмотре **Microsoft. Office. Interop. InfoPath** пространство имен из **браузера объектов** в Microsoft Visual Studio выглядит более сложным.</span><span class="sxs-lookup"><span data-stu-id="a5403-123">Although the process of writing managed code for a given task is very similar to performing the same task using a language such as Visual Basic for Applications or JScript, the object model exposed when viewing the **Microsoft.Office.Interop.InfoPath** namespace from the **Object Browser** in Microsoft Visual Studio looks more complex.</span></span> <span data-ttu-id="a5403-124">Это связано с тем, что для взаимодействия с .NET Framework требуется сервер COM для предоставления доступа ко всем общедоступным интерфейсам, а также некоторые дополнительные конструкции, необходимые для .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="a5403-124">This is because interoperability with the .NET Framework requires a COM server to expose all of its public interfaces, as well as some additional constructs required by the .NET Framework itself.</span></span> <span data-ttu-id="a5403-125">Для получения дополнительных сведений о том, как и почему объектная модель, предоставляемая сборкой взаимодействия, становится более сложной, ознакомьтесь с разделом "как объекты COM представлены в управляемом коде" статьи, посвященной объектной модели, совместимой с [InfoPath 2003](../form-templates/infopath-2003-compatible-object-models.md) .</span><span class="sxs-lookup"><span data-stu-id="a5403-125">For more information on how and why the object model exposed by an interop assembly appears more complex, see the "How COM Objects are Exposed to Managed Code" section of the [InfoPath 2003 Compatible Object Models](../form-templates/infopath-2003-compatible-object-models.md) topic.</span></span> 
  
### <a name="using-intellisense"></a><span data-ttu-id="a5403-126">Использование IntelliSense</span><span class="sxs-lookup"><span data-stu-id="a5403-126">Using IntelliSense</span></span>

<span data-ttu-id="a5403-127">В примерах, приведенных в этом разделе, предполагается, что вы установили ссылки на сборки Microsoft. Office. Interop. InfoPath и Microsoft. Office. Interop. InfoPath. XML.</span><span class="sxs-lookup"><span data-stu-id="a5403-127">The examples in this section assume that you have established references to the Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies.</span></span> <span data-ttu-id="a5403-128">Сведения о том, как задать ссылки и дополнительные примеры внешней автоматизации, можно найти в статье [Внешние сценарии автоматизации и примеры](external-automation-scenarios-and-examples.md).</span><span class="sxs-lookup"><span data-stu-id="a5403-128">For information on how to set references and additional external automation examples, see [External Automation Scenarios and Examples](external-automation-scenarios-and-examples.md).</span></span>
  
<span data-ttu-id="a5403-129">Прежде чем можно будет использовать функцию завершения операторов Microsoft IntelliSense в внешнем коде автоматизации, необходимо создать объектную переменную для экземпляра класса [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , как показано в следующей строке кода.</span><span class="sxs-lookup"><span data-stu-id="a5403-129">Before you can use Microsoft IntelliSense statement completion in external automation code, you must create an object variable for an instance of the [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) class as shown in the following line of code.</span></span> 
  
```cs
Application myApp = 
    new Microsoft.Office.Interop.InfoPath.Application();
```

```vb
Dim myApp As Application = _
    New Microsoft.Office.Interop.InfoPath.Application()
```

<span data-ttu-id="a5403-130">После создания объектной переменной при вводе имени переменной, за которым следует точка, отображается раскрывающийся список с элементами класса **приложения** , которые необходимо выбрать.</span><span class="sxs-lookup"><span data-stu-id="a5403-130">After creating the object variable, when you type the variable name followed by a period, a drop-down list is displayed with members of the **Application** class to select.</span></span> 
  
<span data-ttu-id="a5403-131">Для работы с формой InfoPath объявите объектную переменную типа [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocument.aspx) , а затем инициализируйте ее, открыв форму из коллекции [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocuments.aspx) объекта объекта **Application** , как показано в следующей строке кода.</span><span class="sxs-lookup"><span data-stu-id="a5403-131">To work with an InfoPath form, declare an object variable of type [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocument.aspx) , and then initialize it by opening the form from the [XDocuments](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.XDocuments.aspx) collection of the **Application** object variable as shown in the following line of code.</span></span> 
  
```cs
XDocument myXDoc = myApp.XDocuments.Open(
    "c:\\temp\\Form1.xml",
    (int) XdDocumentVersionMode.xdFailOnVersionOlder);
```

```vb
Dim myXDoc As XDocument = myApp.XDocuments.Open( _
    "c:\\temp\\Form1.xml", _
    XdDocumentVersionMode.xdFailOnVersionOlder)
```

<span data-ttu-id="a5403-132">Раскрывающийся список завершения операторов IntelliSense для членов класса **XDocument** будет отображаться при вводе имени переменной, за которой следует точка.</span><span class="sxs-lookup"><span data-stu-id="a5403-132">The IntelliSense statement completion drop-down list for members of the **XDocument** class will be displayed when you type the name of the variable followed by a period.</span></span> 
  
<span data-ttu-id="a5403-133">Для работы с содержимым базового XML-документа для формы с помощью служб MSXML необходимо создать переменную типа [IXMLDOMDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Xml.IXMLDOMDocument2.aspx) , а затем использовать свойство [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._XDocument2.DOM.aspx) класса **XDOCUMENT** , чтобы назначить XML- Объектная модель документа (DOM) формы для этой переменной.</span><span class="sxs-lookup"><span data-stu-id="a5403-133">To work with the contents of the underlying XML document for the form using Microsoft XML Core Services (MSXML), you must create a variable of type [IXMLDOMDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Xml.IXMLDOMDocument2.aspx) , and then use the [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath._XDocument2.DOM.aspx) property of the **XDocument** class to assign the XML Document Object Model (DOM) of the form to that variable.</span></span> 
  
```cs
IXMLDOMDocument2 doc= myXDoc.DOM as IXMLDOMDocument2;
```

```vb
Dim doc As IXMLDOMDocument2 = myXDoc.DOM
```

<span data-ttu-id="a5403-134">Раскрывающийся список завершения операторов IntelliSense для членов класса **IXMLDOMDocument2** будет отображаться при вводе имени переменной, за которой следует точка, что позволит использовать MSXML для работы с XML-документом.</span><span class="sxs-lookup"><span data-stu-id="a5403-134">The IntelliSense statement completion drop-down list for members of the **IXMLDOMDocument2** class will be displayed when you type the name of the variable followed by a period, which allows you to use MSXML to work with the XML document.</span></span> 
  
### <a name="using-the-class-library-reference-documentation"></a><span data-ttu-id="a5403-135">Использование ссылочной документации библиотеки классов</span><span class="sxs-lookup"><span data-stu-id="a5403-135">Using the Class Library Reference Documentation</span></span>

<span data-ttu-id="a5403-136">Структура справочной документации по библиотеке классов пространства имен [Microsoft. Office. Interop. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.aspx) отражает отношения между интерфейсами coclass и наследуемыми ими унаследованными интерфейсами.</span><span class="sxs-lookup"><span data-stu-id="a5403-136">The organization of the [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.aspx) namespace Class Library reference documentation reflects the relationships between coclass interfaces and the inherited interfaces they implement.</span></span> 
  
<span data-ttu-id="a5403-137">При открытии раздела для интерфейса компонентного класса, такого как [приложение](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , ссылка на элементы интерфейса компонентного класса, приведенного в начале раздела, содержит пустой раздел.</span><span class="sxs-lookup"><span data-stu-id="a5403-137">When you open a topic for a coclass interface, such as [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.Application.aspx) , the link to the members of the coclass interface following the description of the interface at the beginning of the topic displays an empty topic.</span></span> <span data-ttu-id="a5403-138">Чтобы отобразить список членов, реализуемых интерфейсом компонентного класса, необходимо открыть раздел для самого свежего интерфейса, наследуемого компонентным классом, и затем открыть таблицу его членов.</span><span class="sxs-lookup"><span data-stu-id="a5403-138">To display the list of members that are implemented by the coclass interface, you must open the topic for the most recent interface that is inherited by the coclass, and then open the table of its members.</span></span> <span data-ttu-id="a5403-139">Ссылка на унаследованный интерфейс располагается вначале раздела "Заметки" в главе, посвященной интерфейсу компонентного класса.</span><span class="sxs-lookup"><span data-stu-id="a5403-139">A link to the inherited interface is provided at the beginning of the Remarks section in the coclass interface topic.</span></span> 
  
<span data-ttu-id="a5403-140">При нажатии клавиши F1 в редакторе кода Visual Studio поведение аналогично, за исключением того, что член, для которого вызывается Справка F1, будет отображаться напрямую, так как чаще всего работает работа с членами интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a5403-140">When you press F1 in the Visual Studio Code Editor, the behavior is similar, except that the member on which you invoke F1 Help will be displayed directly, because you are most typically working with members of an interface.</span></span> <span data-ttu-id="a5403-141">Однако тот факт, что элемент может быть реализован из интерфейса с контролем версий, может создать неопределенность при первом его появлении.</span><span class="sxs-lookup"><span data-stu-id="a5403-141">However, the fact that a member can be implemented from a versioned interface may be confusing the first time you encounter it.</span></span> <span data-ttu-id="a5403-142">Например, если ввести команду  `myXDocument.UI.Alert`, установить курсор на  `Alert` и нажать клавишу F1, отобразится раздел "UI2.Alert Method".</span><span class="sxs-lookup"><span data-stu-id="a5403-142">For example, if you type  `myXDocument.UI.Alert` and place the cursor on  `Alert` and press F1, a topic titled "UI2.Alert Method" is displayed.</span></span> <span data-ttu-id="a5403-143">Это объясняется тем, что метод **Alert** является реализацией члена интерфейса **UI2**.</span><span class="sxs-lookup"><span data-stu-id="a5403-143">This is because the **Alert** method is an implementation of a member of the **UI2** interface.</span></span> 
  
### <a name="passing-optional-parameters-to-infopath-object-model-members"></a><span data-ttu-id="a5403-144">Передача необязательных параметров членам объектной модели InfoPath</span><span class="sxs-lookup"><span data-stu-id="a5403-144">Passing Optional Parameters to InfoPath Object Model Members</span></span>

<span data-ttu-id="a5403-145">Если элемент объектной модели InfoPath содержит необязательный параметр, а значение этого параметра не указано, необходимо передать **тип. отсутствует** поле для этого параметра.</span><span class="sxs-lookup"><span data-stu-id="a5403-145">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter.</span></span> <span data-ttu-id="a5403-146">Если не произвести передачу поля **Type.Missing**, когда его фактическое значение опущено, это может привести к ошибке построения.</span><span class="sxs-lookup"><span data-stu-id="a5403-146">Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error.</span></span> <span data-ttu-id="a5403-147">Это справедливо для кода, написанного на языках C# и Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="a5403-147">This is true for code written in both C# and Visual Basic.</span></span> <span data-ttu-id="a5403-148">Например, метод [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.View2.SelectNodes.aspx) интерфейса [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ViewObject.aspx) включает два необязательных параметра:  _varEndNode_ и  _varViewContext_.</span><span class="sxs-lookup"><span data-stu-id="a5403-148">For example, the [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.View2.SelectNodes.aspx) method of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.ViewObject.aspx) interface includes two optional parameters:  _varEndNode_ and  _varViewContext_.</span></span> <span data-ttu-id="a5403-149">Строка кода, в которой не определены фактические значения для этих необязательных параметров, должна выглядеть так, как показано в следующих примерах.</span><span class="sxs-lookup"><span data-stu-id="a5403-149">A line of code that does not specify actual values for these optional parameters should look like the following examples.</span></span>
  
```cs
myXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing);
```

```vb
myXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing)
```

## <a name="see-also"></a><span data-ttu-id="a5403-150">См. также</span><span class="sxs-lookup"><span data-stu-id="a5403-150">See also</span></span>

- [<span data-ttu-id="a5403-151">Сценарии и примеры автоматизации с использованием внешних решений</span><span class="sxs-lookup"><span data-stu-id="a5403-151">External automation scenarios and examples</span></span>](external-automation-scenarios-and-examples.md)


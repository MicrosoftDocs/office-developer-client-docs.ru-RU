---
title: Использование членов объектной модели SharePoint
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 8cbafca3-7831-4231-8e61-38330b5ad61b
description: Прежде чем начать программировать с использованием членов объектной модели SharePoint из кода, выполняемого в форме InfoPath, необходимо определить ссылку на сборку Microsoft.SharePoint.dll в проекте набора Visual Studio 2012 для формы. Для этого требуется доступ к файловой системе лицензионной копии Microsoft SharePoint Server 2010 или сервера, на котором выполняются Microsoft SharePoint Foundation 2010, чтобы получить копию сборки Microsoft.SharePoint.dll.
ms.openlocfilehash: e29725450a6a1bdcba99215e337493f8686491e3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431661"
---
# <a name="use-sharepoint-object-model-members"></a><span data-ttu-id="0cbff-104">Использование членов объектной модели SharePoint</span><span class="sxs-lookup"><span data-stu-id="0cbff-104">Use SharePoint Object Model Members</span></span>

<span data-ttu-id="0cbff-p102">Прежде чем начать программировать с использованием членов объектной модели SharePoint из кода, выполняемого в форме InfoPath, необходимо определить ссылку на сборку Microsoft.SharePoint.dll в проекте набора Visual Studio 2012 для формы. Для этого требуется доступ к файловой системе лицензионной копии Microsoft SharePoint Server 2010 или сервера, на котором выполняются Microsoft SharePoint Foundation 2010, чтобы получить копию сборки Microsoft.SharePoint.dll.</span><span class="sxs-lookup"><span data-stu-id="0cbff-p102">Before you can program against members of the SharePoint object model from code running in an InfoPath form template, you must reference the Microsoft.SharePoint.dll assembly in the Visual Studio 2012 project for your form. To do that, you must have access to the file system of a licensed copy of Microsoft SharePoint Server 2010 or a server that is running Microsoft SharePoint Foundation 2010 so that you can obtain a copy of the Microsoft.SharePoint.dll assembly.</span></span> 
  
<span data-ttu-id="0cbff-p103">Кроме того, необходимо развернуть шаблон формы на сервере в качестве изолированного или утвержденного администратором решения. Дополнительные сведения об этих параметрах развертывания [Публикация форм с кодом](publishing-forms-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="0cbff-p103">Additionally, your form template must be deployed to the server as either a sandboxed or administrator-approved solution. For more information about these deployment options, see [Publishing Forms with Code](publishing-forms-with-code.md).</span></span>
  
## <a name="add-and-reference-the-microsoftsharepoint-assembly-from-an-infopath-form-template"></a><span data-ttu-id="0cbff-109">Добавление ссылки на сборку Microsoft.SharePoint из шаблона формы InfoPath</span><span class="sxs-lookup"><span data-stu-id="0cbff-109">Add and Reference the Microsoft.SharePoint Assembly from an InfoPath Form Template</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0cbff-p104">[!Важно!] Чтобы избежать конфликта с процессом управления системой проектов InfoPath файлами, добавляемыми в файл шаблона формы, не копируйте сборки, на которые требуется указать ссылки, в папку верхнего уровня проекта шаблона формы. По умолчанию это путь в следующем формате: < *диск*  >:\Users\  *имя_пользователя*  \Documents\InfoPath Projects\  *имя_проекта* > Если требуется переместить сборки, на которые требуется указать ссылки, внутри папки проекта, то следует создать вложенную папку в главной папке проекта  *ProjectName*  , скопировать сборки в эту вложенную папку и указать соответствующие ссылки на эту папку. Однако обратите внимание, что создавать вложенную папку для сборок, на которые добавлены ссылки, необязательно. Если такая сборка не расположена в папке верхнего уровня проекта, система проектов InfoPath скопирует сборку в файл шаблона формы (XSN-файл) при компиляции и публикации проекта.</span><span class="sxs-lookup"><span data-stu-id="0cbff-p104">To avoid a conflict with how the InfoPath project system manages files that are added to the form template file, do not copy any assemblies that you want to reference into the top-level folder of a form template project. By default, this will be a path in the following format: < *drive*  >:\Users\  *UserName*  \Documents\InfoPath Projects\  *ProjectName* > If you do want to move assemblies that you reference to a location within the project folder, you must create a subfolder under the main  *ProjectName*  project folder, and then copy and reference assemblies from that subfolder. However, be aware that creating a subfolder for referenced assemblies is not necessary. As long as a referenced assembly is not located within the project's top-level folder, the InfoPath project system will copy the assembly into the form template file (.xsn) when the project is compiled and published.</span></span> 
  
<span data-ttu-id="0cbff-114">По умолчанию сборка Microsoft.SharePoint.Server.dll устанавливается в папку C:\Program Files\Common Files\Microsoft Shared\Web Server\Extensions\14\ISAPI в файловой системе SharePoint Server 2010 или сервера, на котором запущены службы SharePoint Foundation 2010.</span><span class="sxs-lookup"><span data-stu-id="0cbff-114">By default, Microsoft.SharePoint.Server.dll is installed in C:\Program Files\Common Files\Microsoft Shared\Web Server\Extensions\14\ISAPI in the file system of SharePoint Server 2010 or a server that is running SharePoint Foundation 2010.</span></span>
  
### <a name="to-reference-the-microsoftsharepoint-assembly-from-an-infopath-forms-code-project"></a><span data-ttu-id="0cbff-115">Добавление ссылки на сборку Microsoft.SharePoint из проекта кода формы InfoPath</span><span class="sxs-lookup"><span data-stu-id="0cbff-115">To reference the Microsoft.SharePoint assembly from an InfoPath form's code project</span></span>

1. <span data-ttu-id="0cbff-116">Скопируйте сборку Microsoft.SharePoint.Server.dll с сервера в локальную папку или получите доступ к сборке из общей папки.</span><span class="sxs-lookup"><span data-stu-id="0cbff-116">Copy the Microsoft.SharePoint.Server.dll assembly from the server to a local folder, or get access to the assembly from a shared folder.</span></span>
    
2. <span data-ttu-id="0cbff-117">Откройте проект шаблона формы в наборе Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="0cbff-117">Open the form template project in Visual Studio 2012.</span></span>
    
3. <span data-ttu-id="0cbff-118">В меню **Проект** выберите пункт **Добавить ссылку**.</span><span class="sxs-lookup"><span data-stu-id="0cbff-118">On the **Project** menu, click **Add Reference**.</span></span>
    
4. <span data-ttu-id="0cbff-119">Найдите и укажите сборку на вкладке **Обзор**, после чего нажмите кнопку **ОК**, чтобы добавить ссылку.</span><span class="sxs-lookup"><span data-stu-id="0cbff-119">Click the **Browse** tab, locate and specify the assembly, and then click **OK** to add the reference.</span></span> 
    
<span data-ttu-id="0cbff-p105">После этого можно создавать код с использованием членов объектной модели SharePoint в коде формы. Для большего удобства при использовании ссылок на члены пространства имен Microsoft.SharePoint добавьте директивы  `using Microsoft.SharePoint;` или  `Imports Microsoft.SharePoint` в раздел директив в начале файла кода. Пример, в котором показано использование членов объектной модели SharePoint в форме InfoPath, см. в разделе "Пример 2. Управление поставщиками в списке SharePoint" в статье [Примеры изолированных решений](sample-sandboxed-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="0cbff-p105">Now you can write code against members of the SharePoint object model from your form code. To make it easier to reference members of the Microsoft.SharePoint namespace, add  `using Microsoft.SharePoint;` or  `Imports Microsoft.SharePoint` to the directives at the beginning of your code file. For an example that shows how to use members of the SharePoint object model in an InfoPath form, see "Example 2: Managing Vendors in a SharePoint List" in [Sample Sandboxed Solutions](sample-sandboxed-solutions.md).</span></span>


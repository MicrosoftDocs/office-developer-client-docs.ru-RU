---
title: Развертывание шаблонов форм InfoPath с кодом
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- deploying form templates [infopath 2007],InfoPath 2007, deploying form templates,form templates [InfoPath 2007], deploying,.NET Framework security settings [InfoPath 2007],deployment [InfoPath 2007], form templates
localization_priority: Normal
ms.assetid: ab66e26d-74ee-4211-b387-1385183a6803
description: Форма кода для шаблона формы InfoPath с управляемым кодом компилируется как сборка, запускаемая в среде CLR. Это означает, что, если требуется внести изменения в код формы, то необходимо открыть соответствующий проект в наборе Visual Studio 2012, внести изменения в редакторе кода, повторно скомпилировать шаблон формы, а затем повторно выполнить его развертывание. Кроме того, поскольку частная сборка для шаблона формы с управляемым кодом запускается на текущем домене приложений CLR, то параметры безопасности для форм, требующих полного доверия, отличаются от параметров для шаблонов форм, не требующих полного доверия.
ms.openlocfilehash: 56af865a80df75c7e1d973767066a03310cdde1e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807489"
---
# <a name="deploy-infopath-form-templates-with-code"></a>Развертывание шаблонов форм InfoPath с кодом

Форма кода для шаблона формы InfoPath с управляемым кодом компилируется как сборка, запускаемая в среде CLR. Это означает, что, если требуется внести изменения в код формы, то необходимо открыть соответствующий проект в наборе Visual Studio 2012, внести изменения в редакторе кода, повторно скомпилировать шаблон формы, а затем повторно выполнить его развертывание. Кроме того, поскольку частная сборка для шаблона формы с управляемым кодом запускается на текущем домене приложений CLR, то параметры безопасности для форм, требующих полного доверия, отличаются от параметров для шаблонов форм, не требующих полного доверия.
  
## <a name="deploying-form-templates-that-do-not-require-full-trust"></a>Развертывание шаблонов форм, не требующих полного доверия

Если код формы для шаблона формы не использует элементы объектной модели InfoPath, требующих полного доверия и шаблон формы не использует компоненты, требующих полного доверия, можно опубликовать шаблон формы непосредственно из InfoPath, выполнив следующие действия. Сведения о модели безопасности InfoPath можно [О модели безопасности для шаблонов форм с кодом](about-the-security-model-for-form-templates-with-code.md).
  
### <a name="deploy-a-form-template-that-does-not-require-full-trust"></a>Развертывание шаблона формы, не требующего полного доверия

1. Создайте шаблон формы в наборе Visual Studio 2012 и выполните его отладку.
    
2. В редакторе кода набора Visual Studio 2012 переключитесь в InfoPath, перейдите на вкладку **Файл** и нажмите кнопку необходимого местоположения публикации на вкладке **Публикация**. (Если шаблон формы ранее уже был опубликован, можно просто перейти на вкладку **Файл** и выбрать команду **Быстрая публикация**, чтобы повторно опубликовать шаблон формы в то же местоположение.) 
    
    Шаблон формы скомпилирован, и запущен **Мастер публикации**. Следуйте инструкциям **Мастера публикации** для развертывания формы в выбранное расположение. Дополнительные сведения об использовании **Мастера публикации** см. в справке InfoPath по строке поиска "Публикация шаблона формы".
    
## <a name="deploying-form-templates-that-require-full-trust"></a>Развертывание шаблонов форм, требующих полного доверия

Если код формы шаблона для формы использует члены объектной модели InfoPath, требующие полного доверия, или шаблон формы использует функции, требующие полного доверия, необходимо добавить цифровую подпись в файл шаблона формы (XSN-файл) с сертификатом подписи кода от надежного издателя. При открытии формы пользователям будет отображаться запрос на доверие этому сертификату. Эта процедура также обеспечивает полное доверие для формы, что, в свою очередь, предоставляет набор разрешений FullTrust для кода формы.
  
### <a name="compile-publish-and-digitally-sign-a-form-template"></a>Компиляция, публикация и цифровая подпись шаблона формы

1. Создайте шаблон формы в наборе Visual Studio 2012 и выполните его отладку.
    
2. Если работа осуществляется в редакторе кода набора Visual Studio 2012, переключитесь в InfoPath и выберите пункт **Параметры формы** на вкладке **Файл**.
    
3. Выберите категорию **Безопасность и доверие**. 
    
4. В разделе **Уровень безопасности** снимите флажок **Автоматически определять уровень безопасности** и выберите **Полное доверие**.
    
5. В разделе **Подписывание шаблона формы** выберите **Подписать этот шаблон формы**, щелкните **Выбор сертификата**, а затем укажите сертификат подписи кода, которым необходимо подписать шаблон формы.
    
6. Дважды нажмите кнопку **ОК** для закрытия диалогового окна **Параметры формы**, а затем сохраните изменения. 
    
7. Перейдите на вкладку **Публикация** и нажмите кнопку необходимого местоположения публикации. 
    
8. Шаблон формы скомпилирован, и запущен **Мастер публикации**. Следуйте инструкциям **Мастера публикации** для развертывания шаблона формы. Дополнительные сведения об использовании **Мастера публикации** для развертывания шаблона формы, требующего полного доверия, см. в справке InfoPath по строке поиска "Публикация шаблона формы с полной доверенностью". 
    
 **Примечания**
- Чтобы добавить для формы цифровую подпись, требуется наличие проверенного сертификата подписи кода, установленного на компьютере. Чтобы получить такой сертификат, следует обратиться в центр сертификации или к администратору сети.
    
- Если после публикации требуется внести изменения в форму, то необходимо повторить процедуру и повторно подписать шаблон формы. Это связано с тем, что изменение формы отменяет цифровую подпись. Во время разработки формы, требующего полного доверия разрешений можно использовать процедуры, описанной в [Предварительный просмотр и отладка шаблонов форм, требуют полного доверия](how-to-preview-and-debug-form-templates-that-require-full-trust.md) для регистрации шаблона формы на локальном компьютере. 
    
## <a name="configuring-net-framework-security-settings"></a>Настройка параметров безопасности .NET Framework

Для дополнительного управления разрешениями, предоставленными управляемому коду, который запускается в шаблоне формы InfoPath с управляемым кодом, можно воспользоваться средством настройки .NET Framework 2.0 для предоставления коду формы отдельного набора разрешений.
  
> [!IMPORTANT]
> [!Важно!] Настройка параметров безопасности .NET Framework для шаблона формы InfoPath с управляемым кодом не влияет на разрешение на запуск элементов объектной модели InfoPath, требующих полного доверия. Чтобы разрешить вызовы элементов объектной модели InfoPath, требующих полного доверия, необходимо либо добавить цифровую подпись, либо зарегистрировать шаблон формы, как описано ранее в этой теме. Настройка параметров безопасности .NET Framework применяется только для вызовов элементов управляемых компонентов и классов .NET Framework, отличных от элементов объектной модели InfoPath. 
  
### <a name="compile-publish-and-configure-net-security-settings-for-a-form-template"></a>Компиляция, публикация и настройка параметров безопасности .NET для шаблона формы

1. Создайте шаблон формы в наборе Visual Studio 2012 и выполните его отладку.
    
2. В редакторе кода набора Visual Studio 2012 переключитесь в InfoPath, перейдите на вкладку **Файл** и нажмите кнопку необходимого местоположения публикации на вкладке **Публикация**.
    
    Шаблон формы скомпилирован, и запущен **Мастер публикации**. Следуйте инструкциям **Мастера публикации** для развертывания шаблона формы. Дополнительные сведения об использовании **Мастера публикации** см. в справке InfoPath по строке поиска "Публикация шаблона формы".
    
3. Выполните процедуру, описанную в разделе «Назначение FullTrust для форм в конкретных URL-адрес или UNC-пути» [Настройка параметров безопасности для шаблонов форм с кодом](how-to-configure-security-settings-for-form-templates-with-code.md)
    
## <a name="see-also"></a>См. также

#### <a name="tasks"></a>Задачи

[Настройка параметров безопасности для шаблонов форм с кодом](how-to-configure-security-settings-for-form-templates-with-code.md)


[Сведения о модели безопасности для шаблонов форм с кодом](about-the-security-model-for-form-templates-with-code.md)
  
[Просмотр и отладка шаблонов форм, требующих полного доверия](how-to-preview-and-debug-form-templates-that-require-full-trust.md)


---
title: Развертывание шаблонов форм InfoPath с кодом
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- deploying form templates [infopath 2007],InfoPath 2007, deploying form templates,form templates [InfoPath 2007], deploying,.NET Framework security settings [InfoPath 2007],deployment [InfoPath 2007], form templates
localization_priority: Normal
ms.assetid: ab66e26d-74ee-4211-b387-1385183a6803
description: Форма кода для шаблона формы InfoPath с управляемым кодом компилируется как сборка, запускаемая в среде CLR. Это означает, что, если требуется внести изменения в код формы, то необходимо открыть соответствующий проект в наборе Visual Studio 2012, внести изменения в редакторе кода, повторно скомпилировать шаблон формы, а затем повторно выполнить его развертывание. Кроме того, поскольку частная сборка для шаблона формы с управляемым кодом запускается на текущем домене приложений CLR, то параметры безопасности для форм, требующих полного доверия, отличаются от параметров для шаблонов форм, не требующих полного доверия.
ms.openlocfilehash: ba3629e786a224ea950e78bbec9a9fe94d4499de
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406901"
---
# <a name="deploy-infopath-form-templates-with-code"></a><span data-ttu-id="14341-106">Развертывание шаблонов форм InfoPath с кодом</span><span class="sxs-lookup"><span data-stu-id="14341-106">Deploy InfoPath Form Templates with Code</span></span>

<span data-ttu-id="14341-p102">Форма кода для шаблона формы InfoPath с управляемым кодом компилируется как сборка, запускаемая в среде CLR. Это означает, что, если требуется внести изменения в код формы, то необходимо открыть соответствующий проект в наборе Visual Studio 2012, внести изменения в редакторе кода, повторно скомпилировать шаблон формы, а затем повторно выполнить его развертывание. Кроме того, поскольку частная сборка для шаблона формы с управляемым кодом запускается на текущем домене приложений CLR, то параметры безопасности для форм, требующих полного доверия, отличаются от параметров для шаблонов форм, не требующих полного доверия.</span><span class="sxs-lookup"><span data-stu-id="14341-p102">The form code for an InfoPath managed code form template is compiled as an assembly that runs under the common language runtime (CLR). This means that whenever you need to make changes to the form code, you must open its project in Visual Studio 2012, make changes in the code editor, recompile your form template, and then re-deploy the form template. Additionally, because the private assembly for a managed code form template is running under a hosted CLR application domain, the security settings for forms that require full trust differ somewhat from form templates that do not require full trust.</span></span>
  
## <a name="deploying-form-templates-that-do-not-require-full-trust"></a><span data-ttu-id="14341-110">Развертывание шаблонов форм, не требующих полного доверия</span><span class="sxs-lookup"><span data-stu-id="14341-110">Deploying Form Templates That Do Not Require Full Trust</span></span>

<span data-ttu-id="14341-111">Если код формы для шаблона формы не использует элементы объектной модели InfoPath, требующие полного доверия, а в шаблоне формы не используются функции, требующие полного доверия, то можно опубликовать шаблон формы непосредственно из InfoPath, воспользовавшись следующей процедурой.</span><span class="sxs-lookup"><span data-stu-id="14341-111">If the form code for your form template does not use InfoPath object model members that require full trust, and the form template does not use features that require full trust, you can publish your form template directly from InfoPath using the following procedure.</span></span> <span data-ttu-id="14341-112">Сведения о модели безопасности InfoPath см. в сведениях о модели безопасности для [шаблонов форм с кодом.](about-the-security-model-for-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="14341-112">For information about the InfoPath security model, see [About the Security Model for Form Templates with Code](about-the-security-model-for-form-templates-with-code.md).</span></span>
  
### <a name="deploy-a-form-template-that-does-not-require-full-trust"></a><span data-ttu-id="14341-113">Развертывание шаблона формы, не требующего полного доверия</span><span class="sxs-lookup"><span data-stu-id="14341-113">Deploy a form template that does not require full trust</span></span>

1. <span data-ttu-id="14341-114">Создайте шаблон формы в наборе Visual Studio 2012 и выполните его отладку.</span><span class="sxs-lookup"><span data-stu-id="14341-114">Create and debug your form template in Visual Studio 2012.</span></span>
    
2. <span data-ttu-id="14341-115">В редакторе кода набора Visual Studio 2012 переключитесь в InfoPath, перейдите на вкладку **Файл** и нажмите кнопку необходимого местоположения публикации на вкладке **Публикация**. (Если шаблон формы ранее уже был опубликован, можно просто перейти на вкладку **Файл** и выбрать команду **Быстрая публикация**, чтобы повторно опубликовать шаблон формы в то же местоположение.)</span><span class="sxs-lookup"><span data-stu-id="14341-115">If you are working in the Visual Studio 2012 code editor, switch to InfoPath, click the **File** tab, and then click the button for the desired publishing location on the **Publish** tab. (If you have published the form template previously, you can click the **File** tab, and then click **Quick Publish** to republish the form template to the same location.)</span></span> 
    
    <span data-ttu-id="14341-p104">Шаблон формы скомпилирован, и запущен **Мастер публикации**. Следуйте инструкциям **Мастера публикации** для развертывания формы в выбранное расположение. Дополнительные сведения об использовании **Мастера публикации** см. в справке InfoPath по строке поиска "Публикация шаблона формы".</span><span class="sxs-lookup"><span data-stu-id="14341-p104">The form template is compiled and the **Publishing Wizard** is launched. Follow the steps in the **Publishing Wizard** to deploy your form to the location of your choice. For more information about using the **Publishing Wizard**, search InfoPath Help for "Publish a form template".</span></span>
    
## <a name="deploying-form-templates-that-require-full-trust"></a><span data-ttu-id="14341-119">Развертывание шаблонов форм, требующих полного доверия</span><span class="sxs-lookup"><span data-stu-id="14341-119">Deploying Form Templates That Require Full Trust</span></span>

<span data-ttu-id="14341-p105">Если код формы шаблона для формы использует члены объектной модели InfoPath, требующие полного доверия, или шаблон формы использует функции, требующие полного доверия, необходимо добавить цифровую подпись в файл шаблона формы (XSN-файл) с сертификатом подписи кода от надежного издателя. При открытии формы пользователям будет отображаться запрос на доверие этому сертификату. Эта процедура также обеспечивает полное доверие для формы, что, в свою очередь, предоставляет набор разрешений FullTrust для кода формы.</span><span class="sxs-lookup"><span data-stu-id="14341-p105">If the form code for your form template does use InfoPath object model members that require full trust, or the form template uses features that require full trust, you must digitally sign your form template (.xsn) file with a code signing certificate from a trusted publisher, which your users will be prompted to trust when they open the form. This will also make your form fully-trusted, and in turn grant the FullTrust permission set to your form code.</span></span>
  
### <a name="compile-publish-and-digitally-sign-a-form-template"></a><span data-ttu-id="14341-122">Компиляция, публикация и цифровая подпись шаблона формы</span><span class="sxs-lookup"><span data-stu-id="14341-122">Compile, publish, and digitally sign a form template</span></span>

1. <span data-ttu-id="14341-123">Создайте шаблон формы в наборе Visual Studio 2012 и выполните его отладку.</span><span class="sxs-lookup"><span data-stu-id="14341-123">Create and debug your form template in Visual Studio 2012.</span></span>
    
2. <span data-ttu-id="14341-124">Если работа осуществляется в редакторе кода набора Visual Studio 2012, переключитесь в InfoPath и выберите пункт **Параметры формы** на вкладке **Файл**.</span><span class="sxs-lookup"><span data-stu-id="14341-124">If you are working in the Visual Studio 2012 code editor, switch to InfoPath, click the **File** tab, and then click **Form Options**.</span></span>
    
3. <span data-ttu-id="14341-125">Выберите категорию **Безопасность и доверие**.</span><span class="sxs-lookup"><span data-stu-id="14341-125">Click the **Security and Trust** category.</span></span> 
    
4. <span data-ttu-id="14341-126">В разделе **Уровень безопасности** снимите флажок **Автоматически определять уровень безопасности** и выберите **Полное доверие**.</span><span class="sxs-lookup"><span data-stu-id="14341-126">Under **Security Level**, clear the **Automatically determine security level** check box, and then select **Full Trust**.</span></span>
    
5. <span data-ttu-id="14341-127">В разделе **Подписывание шаблона формы** выберите **Подписать этот шаблон формы**, щелкните **Выбор сертификата**, а затем укажите сертификат подписи кода, которым необходимо подписать шаблон формы.</span><span class="sxs-lookup"><span data-stu-id="14341-127">Under **Form Template Signature**, select **Sign this form template**, click **Select Certificate**, and then specify the code signing certificate with which to sign the form template.</span></span>
    
6. <span data-ttu-id="14341-128">Дважды нажмите кнопку **ОК** для закрытия диалогового окна **Параметры формы**, а затем сохраните изменения.</span><span class="sxs-lookup"><span data-stu-id="14341-128">Click **OK** twice to close the **Form Options** dialog box, and then save your changes.</span></span> 
    
7. <span data-ttu-id="14341-129">Перейдите на вкладку **Публикация** и нажмите кнопку необходимого местоположения публикации.</span><span class="sxs-lookup"><span data-stu-id="14341-129">Click the **Publish** tab, and then click the button for the desired publishing location.</span></span> 
    
8. <span data-ttu-id="14341-p106">Шаблон формы скомпилирован, и запущен **Мастер публикации**. Следуйте инструкциям **Мастера публикации** для развертывания шаблона формы. Дополнительные сведения об использовании **Мастера публикации** для развертывания шаблона формы, требующего полного доверия, см. в справке InfoPath по строке поиска "Публикация шаблона формы с полной доверенностью".</span><span class="sxs-lookup"><span data-stu-id="14341-p106">The form template is compiled and the **Publishing Wizard** is launched. Follow the steps in the **Publishing Wizard** to deploy your form template. For more information about using the **Publishing Wizard** to deploy a form template that requires full trust, search InfoPath Help for "Publish a form template with full trust".</span></span> 
    
 <span data-ttu-id="14341-133">**Примечания**</span><span class="sxs-lookup"><span data-stu-id="14341-133">**Notes**</span></span>
- <span data-ttu-id="14341-p107">Чтобы добавить для формы цифровую подпись, требуется наличие проверенного сертификата подписи кода, установленного на компьютере. Чтобы получить такой сертификат, следует обратиться в центр сертификации или к администратору сети.</span><span class="sxs-lookup"><span data-stu-id="14341-p107">To digitally sign a form, you must have an authenticated code signing certificate installed on your computer. To acquire such a certificate, you must contact a certification authority or your network administrator.</span></span>
    
- <span data-ttu-id="14341-136">Если после публикации требуется внести изменения в форму, то необходимо повторить процедуру и повторно подписать шаблон формы.</span><span class="sxs-lookup"><span data-stu-id="14341-136">If you need to make changes to the form after publishing, you must repeat the procedure and re-sign the form template.</span></span> <span data-ttu-id="14341-137">Это связано с тем, что изменение формы отменяет цифровую подпись.</span><span class="sxs-lookup"><span data-stu-id="14341-137">This is because altering the form invalidates the digital signature.</span></span> <span data-ttu-id="14341-138">Во время разработки формы, которая требует разрешений полного доверия, [](how-to-preview-and-debug-form-templates-that-require-full-trust.md) можно использовать процедуру, описанную в предварительных и отлагических шаблонах форм, которые требуют полного доверия для регистрации шаблона формы на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="14341-138">During the development of a form that requires full trust permissions you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md) to register the form template on your local computer.</span></span> 
    
## <a name="configuring-net-framework-security-settings"></a><span data-ttu-id="14341-139">Настройка параметров безопасности .NET Framework</span><span class="sxs-lookup"><span data-stu-id="14341-139">Configuring .NET Framework Security Settings</span></span>

<span data-ttu-id="14341-140">Для дополнительного управления разрешениями, предоставленными управляемому коду, который запускается в шаблоне формы InfoPath с управляемым кодом, можно воспользоваться средством настройки .NET Framework 2.0 для предоставления коду формы отдельного набора разрешений.</span><span class="sxs-lookup"><span data-stu-id="14341-140">For additional control over the permissions granted to managed code running in an InfoPath managed code form template, you can use the .NET Framework 2.0 Configuration utility to grant a particular permission set to your form code.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="14341-p109">[!Важно!] Настройка параметров безопасности .NET Framework для шаблона формы InfoPath с управляемым кодом не влияет на разрешение на запуск элементов объектной модели InfoPath, требующих полного доверия. Чтобы разрешить вызовы элементов объектной модели InfoPath, требующих полного доверия, необходимо либо добавить цифровую подпись, либо зарегистрировать шаблон формы, как описано ранее в этой теме. Настройка параметров безопасности .NET Framework применяется только для вызовов элементов управляемых компонентов и классов .NET Framework, отличных от элементов объектной модели InfoPath.</span><span class="sxs-lookup"><span data-stu-id="14341-p109">Configuring .NET Framework security settings for an InfoPath managed code form template does not affect whether InfoPath object model members that require full trust are allowed to run. You must either digitally sign or register a form template as described earlier in this topic to enable calls to InfoPath object model members that require full trust. Configuring .NET Framework security settings apply only to calls to members of .NET Framework classes and managed components other than the InfoPath object model.</span></span> 
  
### <a name="compile-publish-and-configure-net-security-settings-for-a-form-template"></a><span data-ttu-id="14341-144">Компиляция, публикация и настройка параметров безопасности .NET для шаблона формы</span><span class="sxs-lookup"><span data-stu-id="14341-144">Compile, publish, and configure .NET security settings for a form template</span></span>

1. <span data-ttu-id="14341-145">Создайте шаблон формы в наборе Visual Studio 2012 и выполните его отладку.</span><span class="sxs-lookup"><span data-stu-id="14341-145">Create and debug your form template in Visual Studio 2012.</span></span>
    
2. <span data-ttu-id="14341-146">В редакторе кода набора Visual Studio 2012 переключитесь в InfoPath, перейдите на вкладку **Файл** и нажмите кнопку необходимого местоположения публикации на вкладке **Публикация**.</span><span class="sxs-lookup"><span data-stu-id="14341-146">If you are working in the Visual Studio 2012 code editor, switch to InfoPath, click the **File** tab, click **Publish**, and then click the button for the desired publishing location.</span></span>
    
    <span data-ttu-id="14341-p110">Шаблон формы скомпилирован, и запущен **Мастер публикации**. Следуйте инструкциям **Мастера публикации** для развертывания шаблона формы. Дополнительные сведения об использовании **Мастера публикации** см. в справке InfoPath по строке поиска "Публикация шаблона формы".</span><span class="sxs-lookup"><span data-stu-id="14341-p110">The form template is compiled and the **Publishing Wizard** is launched. Follow the steps in the **Publishing Wizard** to deploy your form template. For more information about using the **Publishing Wizard**, search InfoPath Help for "Publish a form template".</span></span>
    
3. <span data-ttu-id="14341-150">Выполните процедуру, описанную в разделе "Назначение полной структуры формам по определенному URL-адресу или UNC" в разделе "Настройка параметров безопасности для шаблонов форм с [кодом"](how-to-configure-security-settings-for-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="14341-150">Perform the procedure described in the "Assigning FullTrust to Forms at a Specific URL or UNC" section of the [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md)</span></span>
    
## <a name="see-also"></a><span data-ttu-id="14341-151">См. также</span><span class="sxs-lookup"><span data-stu-id="14341-151">See also</span></span>

#### <a name="tasks"></a><span data-ttu-id="14341-152">Задачи</span><span class="sxs-lookup"><span data-stu-id="14341-152">Tasks</span></span>

[<span data-ttu-id="14341-153">Настройка параметров безопасности для шаблонов форм с помощью кода</span><span class="sxs-lookup"><span data-stu-id="14341-153">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)


[<span data-ttu-id="14341-154">О модели безопасности для шаблонов форм с кодом</span><span class="sxs-lookup"><span data-stu-id="14341-154">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
  
[<span data-ttu-id="14341-155">Предварительный просмотр и отлагивание шаблонов форм, которые требуют полного доверия</span><span class="sxs-lookup"><span data-stu-id="14341-155">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)


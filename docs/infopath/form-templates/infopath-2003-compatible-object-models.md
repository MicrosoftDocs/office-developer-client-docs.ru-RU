---
title: Объектные модели, совместимые с InfoPath 2003
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, object model,InfoPath 2003-compatible object model,object models [InfoPath 2003], compatible with InfoPath 2007,object models [InfoPath 2007], InfoPath 2003 compatible
localization_priority: Normal
ms.assetid: e4511af6-d7e7-44ad-a50d-1b7ee04f8215
description: Приложение Microsoft InfoPath написано как приложение модели COM и предоставляет программируемые интерфейсы как для внешней автоматизации, так и для скриптов шаблонов форм в качестве COM-интерфейсов.
ms.openlocfilehash: f3351a0fee6e23de0785aa28b0970c6a90361f16
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303523"
---
# <a name="infopath-2003-compatible-object-models"></a><span data-ttu-id="9eda4-104">Объектные модели, совместимые с InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9eda4-104">InfoPath 2003 compatible object models</span></span>

<span data-ttu-id="9eda4-p101">Приложение Microsoft InfoPath написано как приложение модели COM и предоставляет программируемые интерфейсы как для внешней автоматизации, так и для скриптов шаблонов форм в качестве COM-интерфейсов. Для поддержки создания решений InfoPath, использующих языки Visual C# и Visual Basic с управляемым кодом, программа установки InfoPath устанавливает три сборки взаимодействия. Сборки взаимодействия представляют собой сборки .NET, которые служат "мостом" между управляемым и неуправляемым кодами, сопоставляя элементы COM-объекта эквивалентным управляемым элементам .NET.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p101">Microsoft InfoPath is written as a Component Object Model (COM) application and exposes its programmability interfaces for both external automation and form template script as COM interfaces. To support the creation of InfoPath solutions that use the Visual C# and Visual Basic managed-code languages, the InfoPath setup program installs three interop assemblies. Interop assemblies are .NET assemblies that act as a bridge between managed and unmanaged code, mapping COM object members to equivalent .NET managed members.</span></span> 
  
<span data-ttu-id="9eda4-108">Файлы для трех сборок взаимодействия, устанавливаемых InfoPath, имеют следующие имена:</span><span class="sxs-lookup"><span data-stu-id="9eda4-108">The files for the three interop assemblies installed by InfoPath are named:</span></span>
  
- <span data-ttu-id="9eda4-109">Microsoft.Office.Interop.InfoPath.dll</span><span class="sxs-lookup"><span data-stu-id="9eda4-109">Microsoft.Office.Interop.InfoPath.dll</span></span>
    
- <span data-ttu-id="9eda4-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span><span class="sxs-lookup"><span data-stu-id="9eda4-110">Microsoft.Office.Interop.InfoPath.SemiTrust.dll</span></span>
    
- <span data-ttu-id="9eda4-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span><span class="sxs-lookup"><span data-stu-id="9eda4-111">Microsoft.Office.Interop.InfoPath.Xml.dll</span></span>
    
<span data-ttu-id="9eda4-112">В этой теме описана объектная модель, предоставляемая через сборку взаимодействия Microsoft.Office.Interop.InfoPath.SemiTrust и используемая исключительно для написания и запуска бизнес-логики с управляемым кодом в рамках шаблонов форм InfoPath (XSN).</span><span class="sxs-lookup"><span data-stu-id="9eda4-112">This topic discusses the object model exposed through the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly, which is used exclusively for writing and running managed-code business logic from within InfoPath form templates (.xsn).</span></span> 
  
<span data-ttu-id="9eda4-113">Сведения о сборках Microsoft.Office.Interop.InfoPath и Microsoft.Office.Interop.InfoPath.Xml см. в документации по пространствам имен [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.aspx) [иMicrosoft.Office.Interop.InfoPath.Xml.](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.xml)</span><span class="sxs-lookup"><span data-stu-id="9eda4-113">For information about the Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies, see the documentation for the [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.aspx) and [Microsoft.Office.Interop.InfoPath.Xml](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.xml) namespaces.</span></span> 
  
## <a name="important-installation-information"></a><span data-ttu-id="9eda4-114">Важные сведения об установке</span><span class="sxs-lookup"><span data-stu-id="9eda4-114">Important installation information</span></span>

<span data-ttu-id="9eda4-p102">При **Стандартной** установке программа установки InfoPath по умолчанию устанавливает копии сборок Microsoft.Office.Interop.InfoPath.SemiTrust и Microsoft.Office.Interop.InfoPath.Xml в папку C:\Program Files\Microsoft Office\Office14. Сборки Microsoft.Office.Interop.InfoPath и Microsoft.Office.Interop.InfoPath.Xml также устанавливаются в глобальный кэш сборок (GAC), содержимое которого можно просмотреть в папке C:\Windows\Assembly.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p102">By default, the **Typical** installation option of the InfoPath setup program installs copies of the Microsoft.Office.Interop.InfoPath.SemiTrust and Microsoft.Office.Interop.InfoPath.Xml assemblies in the C:\Program Files\Microsoft Office\Office14 folder. The Microsoft.Office.Interop.InfoPath and Microsoft.Office.Interop.InfoPath.Xml assemblies are also installed in the Global Assembly Cache (GAC), the contents of which can be viewed from the C:\Windows\Assembly folder.</span></span> 
  
<span data-ttu-id="9eda4-p103">Если эти сборки не установлены, следует убедиться, что приложение Microsoft InfoPath было установлено правильно. Если перед запуском программы установки был установлен пакет .NET Framework 2.0 или более поздней версии, то параметр **Поддержка программирования .NET** в программе установки InfoPath устанавливается на значение **Запускать с моего компьютера** для **Стандартной** установки InfoPath. Если эти сборки взаимодействия недоступны на компьютере, то необходимо убедиться, что установлена платформа .NET Framework 2.0 или более поздней версии, а затем открыть окно **Установка и удаление программ** из **Панели управления** и установить для параметра **Поддержка программирования .NET** значение **Запускать с моего компьютера**.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p103">If these assemblies are not installed, you should confirm that Microsoft InfoPath was installed correctly. As long as the .NET Framework 2.0 or later is installed before running setup, the **.NET Programmability Support** option in the InfoPath setup program is set to **Run from My Computer** for a **Typical** installation of InfoPath. If these interop assemblies are not available on your computer, you must confirm that the .NET Framework 2.0 or later is installed, and then run **Add or Remove Programs** from the **Control Panel** and set the **.NET Programmability Support** option to **Run from My Computer**.</span></span>
  
<span data-ttu-id="9eda4-120">Сведения о загрузке пакета .NET Framework 2.0 Redistributable см. в статье [.NET Framework 2.0 Redistributable](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5).</span><span class="sxs-lookup"><span data-stu-id="9eda4-120">For information on downloading the .NET Framework 2.0 Redistributable, see [.NET Framework 2.0 Redistributable. ](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5)</span></span>
  
## <a name="the-microsoftofficeinteropinfopathsemitrust-namespace"></a><span data-ttu-id="9eda4-121">Пространство имен Microsoft.Office.Interop.InfoPath.SemiTrust</span><span class="sxs-lookup"><span data-stu-id="9eda4-121">The Microsoft.Office.Interop.InfoPath.SemiTrust namespace</span></span>

<span data-ttu-id="9eda4-p104">До выпуска Microsoft Office InfoPath 2003 с пакетом обновления 1 и набора инструментов Microsoft Office InfoPath 2003 для Visual Studio® .NET вся программная логика для шаблонов форм InfoPath создавалась с помощью скриптов Microsoft JScript и Microsoft VBScript, написанных в среде разработки редактора скриптов Microsoft (MSE). Скрипт, написанный в MSE, интерпретировался во время выполнения и получал доступ к объектной модели COM, предоставляемой библиотекой динамической компоновки IPEDITOR.dll.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p104">Prior to the release of Microsoft Office InfoPath 2003 Service Pack 1 and the Microsoft Office InfoPath 2003 Toolkit for Visual Studio® .NET, all programming logic for InfoPath form templates was created using Microsoft JScript or Microsoft VBScript written in the Microsoft Script Editor (MSE) development environment. Script written in MSE is interpreted at run time and accesses the COM object model exposed by the IPEDITOR.dll dynamic link library.</span></span>
  
<span data-ttu-id="9eda4-124">Для поддержки создания шаблонов форм, которые используют языки управляемого кода, такие как Visual C# и Visual Basic для программирования логики, в InfoPath добавлены функциональные возможности для размещения общей языковой цепи (CLR) и сборки межпрограммного управления Microsoft.Office.Interop.InfoPath.SemiTrust, чтобы обеспечить безопасное межпрограммное использование управляемого кода с объектной моделью COM, которая обеспечивается InfoPath.</span><span class="sxs-lookup"><span data-stu-id="9eda4-124">To support the creation of form templates that use managed-code languages such as Visual C# and Visual Basic for programming logic, functionality was added to InfoPath to enable hosting the common language runtime (CLR) and the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly was created to enable managed code to interoperate with the COM object model exposed by InfoPath in a secure manner.</span></span> <span data-ttu-id="9eda4-125">Сведения о модели безопасности, применяемой к шаблонам форм InfoPath с управляемым кодом, см. в сведениях о модели безопасности для шаблонов форм [с кодом.](about-the-security-model-for-form-templates-with-code.md)</span><span class="sxs-lookup"><span data-stu-id="9eda4-125">For information on the security model that applies to InfoPath managed-code form templates, see [About the Security Model for Form Templates with Code](about-the-security-model-for-form-templates-with-code.md).</span></span> 
  
<span data-ttu-id="9eda4-p106">Хотя процедура написания управляемого кода для конкретной задачи в шаблоне формы InfoPath крайне похожа на выполнение аналогичной задачи программирования путем написания скрипта, объектная модель, совместимая с InfoPath 2003, предоставляемая при просмотре пространства имен **Microsoft.Office.Interop.InfoPath.SemiTrust** из **Обозревателя объектов** в наборе Visual Studio 2012 выглядит гораздо сложнее. Это объясняется тем, что технология взаимодействия .NET Framework, используемая для поддержки объектной модели, совместимой с InfoPath 2003, требует, чтобы COM-сервер представлял все свои открытые интерфейсы, а также некоторые дополнительные конструкции, необходимые для самой платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p106">Although the process of writing managed code for a given task in an InfoPath form template is very similar to performing the same programming task by writing script, the InfoPath 2003-compatible object model exposed when viewing the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace from the **Object Browser** in Visual Studio 2012 looks much more complex. This is because the .NET Framework interoperability technology used to support the InfoPath 2003-compatible object model requires a COM server to expose all of its public interfaces, as well as some additional constructs required by the .NET Framework itself.</span></span> 
  
### <a name="how-com-objects-are-exposed-to-the-infopath-2003-compatible-object-model"></a><span data-ttu-id="9eda4-128">Как COM-объекты могут быть открыты для объектной модели, совместимой с InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9eda4-128">How COM objects are exposed to the InfoPath 2003 compatible object model</span></span>

<span data-ttu-id="9eda4-p107">При работе непосредственно с COM-сервером на языках высокого уровня, таких как JScript, VBScript и Visual Basic (но не версии .NET языков Visual Basic и Visual C#) представляемая объектная модель проще, чем базовые классы и интерфейсы COM. Например, при работе с этими языками объект InfoPath **UI** предоставляет набор из семи методов, например метод **Alert** для отображения пользователям окна сообщения.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p107">When working natively with a COM server from high-level languages such as JScript, VBScript, or Visual Basic (but not the .NET version of Visual Basic and Visual C#), the object model that is exposed is simpler than the underlying COM classes and interfaces. For example, when working from these languages, the InfoPath **UI** object exposes a set of seven methods, such as the **Alert** method for displaying a message box to users.</span></span> 
  
<span data-ttu-id="9eda4-p108">Однако базовая конструкция COM, поддерживающая объект **UI**, в действительности состоит из трех компонентов: двух интерфейсов **UI** и **UI2**, а также компонентного класса COM, реализующего элементы этих двух интерфейсов. Существует две версии интерфейса **UI**, поскольку платформе COM требуется сохранять смешанное определение интерфейса для обеспечения обратной совместимости программ и компонентов, вызывающих реализацию этого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p108">However, the underlying COM constructs that support the **UI** object are actually composed of three entities: two interfaces named **UI** and **UI2**, and a COM coclass that implements the members of these two interfaces. There are two versions of the **UI** interface because the COM framework requires the definition of an interface to remain fixed to maintain backward compatibility for programs and components that call an implementation of that interface.</span></span> 
  
<span data-ttu-id="9eda4-p109">В данном случае интерфейс **UI**, который был определен для исходной версии InfoPath, предоставляет четыре метода, включая метод **Alert**. Интерфейс **UI2** может считаться второй версией интерфейса **UI**, и он был определен для версии InfoPath с пакетом обновления 1. Интерфейс **UI2** наследует четыре метода исходного интерфейса **UI** и добавляет три новых метода, например метод **Confirm**. Хотя в рамках скрипта или управляемого кода можно написать строку кода, вызывающую метод **Confirm** с помощью  `XDocument.UI.Confirm`, но в действительности базовый код вызывает метод **Confirm** интерфейса **UI2** из реализации этого метода в компонентном классе COM.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p109">In this case, the **UI** interface, which was defined for the initial release of InfoPath, provides four methods, including the **Alert** method. The **UI2** interface can be considered a second version of the **UI** interface, and it was defined for the InfoPath Service Pack 1 release. The **UI2** interface inherits the four methods of the original **UI** interface and adds three new methods, such as the **Confirm** method. Although you can write a line of code either in script or managed code that calls the **Confirm** method using  `XDocument.UI.Confirm`, the underlying code is actually calling the **Confirm** method of the **UI2** interface from the implementation of that method in the COM coclass.</span></span> 
  
<span data-ttu-id="9eda4-p110">Объектная модель, которая предоставляется для скриптов, скрывает эти подробности, но сборка взаимодействия, которая требуется для работы с COM-сервером из управляемого кода, обеспечивает открытость компонентного класса и обоих интерфейсов. Для отдельного объекта **UI**, используемого в среде скриптов MSE, пространство имен **Microsoft.Office.Interop.InfoPath.SemiTrust** предоставляет следующие три элемента:</span><span class="sxs-lookup"><span data-stu-id="9eda4-p110">The object model as it is exposed to scripting hides these details, but the interop assembly required to work with a COM server from managed code exposes the coclass and both interfaces publicly. For the single **UI** object used in the MSE scripting environment, the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace exposes the following three items:</span></span> 
  
- <span data-ttu-id="9eda4-139">[UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI.aspx) T:Microsoft.Office.Interop.InfoPath.SemiTrust.ADOAdapterObject</span><span class="sxs-lookup"><span data-stu-id="9eda4-139">[UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI.aspx) interface</span></span> 
    
- <span data-ttu-id="9eda4-140">[UI2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.aspx) T:Microsoft.Office.Interop.InfoPath.SemiTrust.ADOAdapterObject</span><span class="sxs-lookup"><span data-stu-id="9eda4-140">[UI2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.aspx) interface</span></span> 
    
- <span data-ttu-id="9eda4-141">Интерфейс компонентного класса [UIObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UIObject.aspx)</span><span class="sxs-lookup"><span data-stu-id="9eda4-141">[UIObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UIObject.aspx) coclass interface</span></span> 
    
<span data-ttu-id="9eda4-p111">Хотя все три этих интерфейса предоставляются в **Обозревателе объектов** и содержатся в документации по библиотекам классов для пространства имен, работа осуществляется только с интерфейсом компонентного класса **UIObject**, который реализует объект **UI**, а также с элементами интерфейса **UI2**, который представляет собой наиболее актуальную версию интерфейса, реализованного интерфейсом компонентного класса **UIObject**. Чтобы получить доступ к интерфейсу компонентного класса **UIObject** из родительского объекта [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) аналогично доступу из скрипта, следует использовать метод доступа [UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.UI.aspx) . За исключением некоторых существенных деталей, эта схема применяется для всех объектов из исходной версии InfoPath, которые были обновлены при выпуске версии InfoPath с пакетом обновления 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="9eda4-p111">Although all three of these interfaces are exposed in the **Object Browser** and are contained in the Class Library documentation for the namespace, you only work with the **UIObject** coclass interface, which implements the **UI** object, and with the members of the **UI2** interface, which is the most current version of the interface that is implemented by the **UIObject** coclass interface. To access the **UIObject** coclass interface from its parent [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object, just as in script, you use the [UI](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.UI.aspx) accessor property. Except for a few notable exceptions, this is the pattern for all objects from the original release of InfoPath that were updated when InfoPath Service Pack 1 was released.</span></span> 
  
<span data-ttu-id="9eda4-p112">Хотя в целом эта схема во всех случаях одинакова, но ситуация несколько проще для полностью новых объектов, которые были добавлены в пакете обновления 1 для InfoPath, например, для объекта **Certificate**. В этом случае следует учитывать только два компонента: интерфейс компонентного класса [CertificateObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.CertificateObject.aspx) и элементы интерфейса [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Certificate.aspx) , представляющего собой наиболее актуальный и единственный интерфейс, реализованный интерфейсом компонентного класса **CertificateObject**. Как и при использовании COM-объектов InfoPath из скрипта, для доступа к объекту из родительского объекта используется метод доступа [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Certificate.aspx) .</span><span class="sxs-lookup"><span data-stu-id="9eda4-p112">While the pattern is basically the same, the situation is slightly simpler for the entirely new objects that were added in InfoPath Service Pack 1, such as the **Certificate** object. In this case, there are only two items to be concerned with: the [CertificateObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.CertificateObject.aspx) coclass interface and the members of the [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Certificate.aspx) interface, which is the most recent and only interface implemented by the **CertificateObject** coclass interface. Just as when using InfoPath COM objects from script, the [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Signature.Certificate.aspx) accessor property is used to access the object from its parent.</span></span> 
  
<span data-ttu-id="9eda4-p113">Эта же схема применяется к интерфейсам семейств, за исключением того, что к имени интерфейса компонентного класса для семейства добавляется слово "Collection", а не "Object". Например, интерфейс компонентного класса для семейства COM **DataAdapters** называется [DataAdaptersCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdaptersCollection.aspx) , а интерфейс, реализующий его, называется [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdapters.aspx) . Аналогичным образом, для доступа к семейству используется метод доступа [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DataAdapters.aspx) родительского объекта **XDocument**.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p113">This same pattern applies to the interfaces for collections, except the coclass interface for a collection has "Collection" appended to its name instead of "Object". For example, the coclass interface for the COM **DataAdapters** collection is named [DataAdaptersCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdaptersCollection.aspx) and the interface it implements is the [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataAdapters.aspx) interface. Similarly, the [DataAdapters](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DataAdapters.aspx) accessor property of the **XDocument** parent object is used to access the collection.</span></span> 
  
<span data-ttu-id="9eda4-p114">Из этой схемы именования существует три исключения. К именам интерфейсов компонентных классов для COM-объектов **Application** и **XDocument** не добавляется слово "Object". Их имена идентичны именам соответствующим COM-объектов: [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) и **XDocument**. Кроме того, к именам интерфейсов, реализованных интерфейсами компонентных классов **Application** и **XDocument**, добавляется префикс в виде символа подчеркивания (_): [_Application2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.aspx) и [_XDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.aspx) . Третьим исключением является COM-объект **DataObject**. Интерфейс компонентного класса для этого объекта называется [DataSourceObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataSourceObject.aspx) , но, как и для других COM-объектов InfoPath, интерфейс, реализующий его, называется [DataObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataObject.aspx) .</span><span class="sxs-lookup"><span data-stu-id="9eda4-p114">There are three exceptions to this naming pattern. The coclass interfaces for the COM **Application** and **XDocument** objects do not have "Object" appended to their names. Their names are identical to their corresponding COM objects: [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) and **XDocument**. Additionally, the names of the interfaces implemented by the **Application** and **XDocument** coclass interfaces are prefixed with the underscore character (_): [_Application2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.aspx) and [_XDocument2](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.aspx) . The third exception is the COM **DataObject** object. The coclass interface for this object is named [DataSourceObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataSourceObject.aspx) , but just like other InfoPath COM objects, the interface it implements is the [DataObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataObject.aspx) interface.</span></span> 
  
### <a name="how-microsoft-xml-core-services-msxml-50-for-microsoft-office-objects-are-exposed-to-the-infopath-2003-compatible-object-model"></a><span data-ttu-id="9eda4-157">Как MSXML (MSXML) 5.0 для Microsoft Office объектной модели, совместимой с InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9eda4-157">How Microsoft XML Core Services (MSXML) 5.0 for Microsoft Office objects are exposed to the InfoPath 2003 compatible object model</span></span>

<span data-ttu-id="9eda4-p115">Подмножество объектов и элементов объектной модели, предоставляемых службами MSXML, которые также являются COM-сервером, реализуется интерфейсами, предоставляемыми сборкой взаимодействия Microsoft.Office.Interop.InfoPath.SemiTrust. Необходимость в этом обусловлена тем, что некоторые элементы объектной модели InfoPath COM основываются на MSXML и должны иметь возможность безопасного доступа к этим элементам. Имена интерфейсов в пространстве имен **Microsoft.Office.Interop.InfoPath.SemiTrust**, реализующем объекты и элементы объектной модели MSXML идентичны именам, предоставляемым COM-сервером MSXML. В большинстве случаев к этим именам добавляется префикс "IXMLDOM", поскольку они используются для работы с моделью XML DOM. Например, свойство [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DOM.aspx) интерфейса **XDocument**, которое используется для возвращения ссылки на базовый XML-документ формы, возвращает интерфейс [IXMLDOMDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.IXMLDOMDocument.aspx) , который реализуется сборкой взаимодействия Microsoft.Office.Interop.InfoPath.SemiTrust. Вызов и использование элементов интерфейса **IXMLDOMDocument** осуществляется в целом аналогично использованию скрипта в шаблонах форм, не использующих управляемый код.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p115">A subset of the objects and members of the object model provided by Microsoft XML Core Services (MSXML), which is also a COM server, are wrapped by interfaces exposed by the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly. The reason this is necessary is that some of the members of the InfoPath COM object model rely on MSXML and must be able to access these members in a secure manner. The names of interfaces in the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace that wrap the objects and members of the MSXML object model are the same as the names exposed by the MSXML COM server. In most cases, these names are prefixed with "IXMLDOM" because they are used to work with the XML Document Object Model (DOM). For example, the [DOM](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.DOM.aspx) property of the **XDocument** interface, which is used to return a reference to a form's underlying XML document, returns the [IXMLDOMDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.IXMLDOMDocument.aspx) interface that is wrapped by the Microsoft.Office.Interop.InfoPath.SemiTrust interop assembly. You call and use the members of the **IXMLDOMDocument** interface in basically the same way as when using script in form templates that don't use managed code.</span></span> 
  
<span data-ttu-id="9eda4-164">Дополнительные сведения об использовании элементов объектной модели MSXML для Microsoft Office в шаблонах форм с управляемым кодом см. в статье [Работа с MSXML и System.Xml с использованием объектной модели InfoPath 2003](working-with-msxml-and-system-xml-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="9eda4-164">For more information on using members of the Microsoft XML Core Services (MSXML) for Microsoft Office object model in managed-code form templates, see [Working with MSXML and System.Xml Using the InfoPath 2003 Object Model](working-with-msxml-and-system-xml-using-the-infopath-2003-object-model.md).</span></span>
  
### <a name="using-intellisense"></a><span data-ttu-id="9eda4-165">Использование IntelliSense</span><span class="sxs-lookup"><span data-stu-id="9eda4-165">Using IntelliSense</span></span>

<span data-ttu-id="9eda4-p116">Как правило, при написании кода для шаблона формы с управляемым кодом, совместимым с InfoPath 2003, используются переменные  `thisXDocument` и  `thisApplication`, которые инициализируются в методе  `_Startup` файла классов по умолчанию FormCode.cs или FormCode.vb. Переменные  `thisXDocument` и  `thisApplication` можно использовать для доступа к элементам интерфейсов компонентных классов [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) и [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) . После того, как будет введено имя любой переменной с точкой в конце, автозавершение инструкции IntelliSense отобразит список элементов в соответствующем интерфейсе компонентного класса. Эту процедуру можно продолжить для получения доступа к элементу объектной модели, с которым требуется осуществить работу.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p116">For most of the code you write against the InfoPath 2003-compatible object model in a managed-code form template, you will use the  `thisXDocument` and  `thisApplication` variables that are initialized in the  `_Startup` method of the default FormCode.cs or FormCode.vb class file. You can use the  `thisXDocument` and  `thisApplication` variables to access the members of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) and [Application](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Application.aspx) coclass interfaces. After you type the name of either variable followed by a period, IntelliSense statement completion will display the list members of the corresponding coclass interface. You can continue in this fashion to access the object model member you want to work with.</span></span> 
  
<span data-ttu-id="9eda4-170">Далее приведен простой пример с использованием переменной  `thisXDocument` для доступа к методу [Alert](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.Alert.aspx) с целью отображения версии приложения InfoPath с помощью свойства [Version](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Version.aspx) , доступ к которому предоставляется из переменной  `thisApplication`.</span><span class="sxs-lookup"><span data-stu-id="9eda4-170">The following shows a simple example that uses the  `thisXDocument` variable to access the [Alert](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.Alert.aspx) method to display the version of the InfoPath application by using the [Version](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._Application2.Version.aspx) property accessed from the  `thisApplication` variable.</span></span> 
  
```cs
thisXDocument.UI.Alert(thisApplication.Version);
```

```vb
thisXDocument.UI.Alert(thisApplication.Version)
```

### <a name="using-the-class-library-reference-documentation"></a><span data-ttu-id="9eda4-171">Использование справочной документации по библиотеке классов</span><span class="sxs-lookup"><span data-stu-id="9eda4-171">Using the Class Library reference documentation</span></span>

<span data-ttu-id="9eda4-p117">Организация ссылочной документации библиотеки классов пространства имен **Microsoft.Office.Interop.InfoPath.SemiTrust** отражает взаимоотношения между интерфейсами компонентных классов и унаследованными интерфейсами, которые они реализуют. Это описано в предыдущем разделе "Представление COM-объектов для управляемого кода" этой статьи.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p117">The organization of the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace Class Library reference documentation reflects the relationships between coclass interfaces and the inherited interfaces they implement. This is described in the "How COM Objects are Exposed to Managed Code" section earlier in this topic.</span></span> 
  
<span data-ttu-id="9eda4-p118">Хотя структура и именование в справочной документации по пространству имен **Microsoft.Office.Interop.InfoPath.SemiTrust** могут вначале показать запутанными, темы в целом упорядочены аналогично руководству по объектной модели InfoPath, которая входит в состав руководства разработчика InfoPath, включенного в приложение InfoPath. За исключением разделов, посвященных интерфейсам **Application** и **XDocument**, все разделы интерфейсов компонентных классов COM соответствуют эквивалентным разделам "Объект" и "Семейство" в ссылке на скрипты InfoPath. Например, темы "Интерфейс UIObject" и "Интерфейс WindowsCollection" в справочной документации по пространству имен **Microsoft.Office.Interop.InfoPath.SemiTrust** соответствует аналогичному содержимому в темах "Объект пользовательского интерфейса" и "Семейство Windows" справочного руководства по скриптам объектной модели InfoPath.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p118">Although the organization and naming of the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace reference documentation appears confusing at first, the topics are basically organized in the same way as the InfoPath Object Model Reference that is part of the InfoPath Developer's Reference, which is included with InfoPath. With the exception of the topics for the **Application** and **XDocument** interfaces, all of the COM coclass interface topics map to the equivalent "Object" and "Collection" topics from the InfoPath scripting reference. For example, the "UIObject Interface" and the "WindowsCollection Interface" topics of the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace reference documentation correspond to similar content in the "UI Object" and "Windows Collection" topics of the InfoPath Object Model Reference scripting reference.</span></span> 
  
<span data-ttu-id="9eda4-p119">Однако ссылка на членов интерфейса компонентного класса, следующая за описанием интерфейса в начале раздела, отображает пустой раздел. Чтобы отобразить список членов, реализуемых интерфейсом компонентного класса, необходимо открыть раздел для самого свежего интерфейса, наследуемого компонентным классом, и затем открыть таблицу его членов. Ссылка на унаследованный интерфейс располагается вначале раздела "Заметки" в главе, посвященной интерфейсу компонентного класса.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p119">However, the link to the members of the coclass interface following the description of the interface at the beginning of the topic displays an empty topic. To display the list of members that are implemented by the coclass interface, you must open the topic for the most recent interface that is inherited by the coclass, and then open the table of its members. A link to the inherited interface is provided at the beginning of the Remarks section in the coclass interface topic.</span></span>
  
<span data-ttu-id="9eda4-p120">Если в редакторе кода нажать клавишу F1, то процедура будет аналогична, за исключением того, что элемент, по которому вызвана справка, будет отображен непосредственно, поскольку работа, как правило, осуществляется с элементами интерфейса. Однако тот факт, что элемент может быть реализован из интерфейса с контролем версий, может создать неопределенность при первом его появлении. Например, если ввести команду  `thisXDocument.UI.Alert`, установить курсор на  `Alert` и нажать клавишу F1, отобразится раздел "UI2.Alert Method". Это объясняется тем, что метод **Alert** является реализацией члена интерфейса **UI2**.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p120">When you press F1 in the Code Editor, the behavior is similar, except that the member on which you invoke F1 Help will be displayed directly, because you are most typically working with members of an interface. However, the fact that a member can be implemented from a versioned interface may be confusing the first time you encounter it. For example, if you type  `thisXDocument.UI.Alert` and place the cursor on  `Alert` and press F1, a topic titled "UI2.Alert Method" is displayed. This is because the **Alert** method is an implementation of a member of the **UI2** interface.</span></span> 
  
### <a name="passing-optional-parameters-to-infopath-object-model-members"></a><span data-ttu-id="9eda4-184">Передача необязательных параметров членам объектной модели InfoPath</span><span class="sxs-lookup"><span data-stu-id="9eda4-184">Passing optional parameters to InfoPath object model members</span></span>

<span data-ttu-id="9eda4-p121">Если элемент объектной модели, совместимой с InfoPath 2003, содержит необязательный параметр, и значение этого параметра не указано, то вместо значения необходимо передать поле **Type.Missing**. Если не произвести передачу поля **Type.Missing**, когда его фактическое значение опущено, это может привести к ошибке построения. Это действительно для кода, написанного как на Visual C#, так и на Visual Basic. Например, метод [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectNodes.aspx) интерфейса [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) включает два необязательных параметра:  _varEndNode_ и  _varViewContext_. Строка кода, в которой не определены фактические значения для этих необязательных параметров, должна выглядеть так, как показано в следующих примерах.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p121">If an InfoPath 2003-compatible object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead. Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error. This is true for code written in both Visual C# and Visual Basic. For example, the [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectNodes.aspx) method of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) interface includes two optional parameters:  _varEndNode_ and  _varViewContext_. A line of code that does not specify actual values for these optional parameters should look like the following examples.</span></span>
  
```cs
IXMLDOMNode group1 = 
   thisXDocument.DOM.selectSingleNode("/my:myFields/my:group1");
thisXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing);
```

```vb
Dim group1 As IXMLDOMNode = _
   thisXDocument.DOM.selectSingleNode("/my:myFields/my:group1")
thisXDocument.View.SelectNodes(group1, Type.Missing, Type.Missing)
```

### <a name="about-common-language-specification-compliance"></a><span data-ttu-id="9eda4-190">О соответствии спецификаций общих языков</span><span class="sxs-lookup"><span data-stu-id="9eda4-190">About common language specification compliance</span></span>

<span data-ttu-id="9eda4-p122">С точки зрения внутренней структуры каждый интерфейс и элемент в сборке Microsoft.Office.Interop.InfoPath.SemiTrust использует атрибут **CLSCompliant** со значением **false**. Поскольку справочная документация создается с использованием, в том числе, **System.Reflection**, то к описанию каждого интерфейса и элемента добавляется строка "Этот интерфейс (метод/свойство) несовместим с CLS". Однако фактически большинство интерфейсов и элементов пространства имен [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) совместимо с CLS.</span><span class="sxs-lookup"><span data-stu-id="9eda4-p122">Internally, every interface and member in the Microsoft.Office.Interop.InfoPath.SemiTrust assembly has its **CLSCompliant** attribute set to **false**. Because the reference documentation is generated in part using **System.Reflection**, the description of each interface and member has the phrase "This interface/method/property is not CLS-compliant" appended to it. However, most of the interfaces and members of the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace actually are CLS-compliant.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="9eda4-194">См. также</span><span class="sxs-lookup"><span data-stu-id="9eda4-194">See also</span></span>

- [<span data-ttu-id="9eda4-195">Типичные задачи по разработке шаблонов форм, использующих объектную модель InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9eda4-195">Common Tasks for Developing Form Templates Using the InfoPath 2003 Object Model</span></span>](common-tasks-for-developing-form-templates-using-infopath-object-model.md)
- [<span data-ttu-id="9eda4-196">О модели безопасности для шаблонов форм с кодом</span><span class="sxs-lookup"><span data-stu-id="9eda4-196">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="9eda4-197">Создание шаблонов форм с помощью объектной модели InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9eda4-197">Creating Form Templates Using the InfoPath 2003 Object Model</span></span>](creating-form-templates-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="9eda4-198">Ознакомление с объектной моделью InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9eda4-198">Understanding the InfoPath 2003 Object Model</span></span>](understanding-the-infopath-2003-object-model.md)


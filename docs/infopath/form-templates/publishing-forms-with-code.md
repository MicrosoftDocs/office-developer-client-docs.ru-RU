---
title: Публикация форм с кодом
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: caafab24-6413-4731-813d-cba3ae9ea97e
description: Любой администратор семейства веб-сайтов может публиковать формы с кодом непосредственно из мастера публикации InfoPath Designer в библиотеке форм в SharePoint. Код выполняется в изолированной среде, что предотвращает выполнение вредоносного кода на сервере. Этот процесс называется публикацией изолированного решения или публикацией в изолированной инфраструктуре SharePoint.
ms.openlocfilehash: f8f8a48ea6810b5331198f6ddc112b3bd38ab886
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303509"
---
# <a name="publishing-forms-with-code"></a>Публикация форм с кодом

Любой администратор семейства веб-сайтов может публиковать формы с кодом непосредственно из мастера публикации InfoPath Designer в библиотеке форм в SharePoint. Код выполняется в изолированной среде, что предотвращает выполнение вредоносного кода на сервере. Этот процесс называется публикацией изолированного решения или публикацией в изолированной инфраструктуре SharePoint.
  
В InfoPath 2010 и SharePoint Server 2010 также поддерживаются решения, развернутые администратором. Разработчик формы публикует формы с кодом в локальном хранилище, которое затем просматривается и отправляется администратором фермы SharePoint. Коду предоставляется уровень полного доверия, поэтому в его состав могут быть включены функции, выполнение которых требует особых привилегий (например, ввод-вывод файлов).
  
## <a name="comparing-sandboxed-and-administrator-approved-solutions"></a>Сравнение изолированных решений и решений, подлежащих рассмотрению администратором

В следующей таблице представлены различия между публикацией изолированных решений и публикацией решений, рассматриваемых администратором.  
  
||**Изолированные решения**|**Решения, рассматриваемые администратором**|
|:-----|:-----|:-----|
|**Необходимые разрешения** <br/> |Могут публиковаться любым администратором семейства сайтов.  <br/> |Могут развертываться администратором фермы.  <br/> |
|**Публикация** <br/> |Можно опубликовать непосредственно из InfoPath.  <br/> |Могут публиковаться с помощью центра администрирования или средства командной строки stsadm.  <br/> |
|**Protection** <br/> |Код запускается в изолированной среде. Это защищает сервер от выполнения вредоносного кода.  <br/> |Код может запускаться с уровнем полного доверия и доступом ко всем ресурсам сервера.  <br/> |
|**Рекомендованное применение** <br/> |Формы, требующие небольшого объема кода.  <br/> |Формы, содержащие большой объем кода.  <br/> |
   
### <a name="publishing-form-templates-as-sandboxed-solutions"></a>Публикация шаблонов формы в качестве изолированных решений

Публикация формы с кодом в качестве решения изолированные решения не отличается от публикации другой формы в библиотеку документов. С помощью мастера публикации форма будет отправлена на сервер и будет выполняться в изолированной среде.
  
Обратите внимание на то, что при развертывании формы в качестве решения изолированные решения существуют определенные ограничения:
  
- Форма должна быть формой InfoPath.
    
- В качестве языка программирования форма должна использовать C# или Visual Basic.
    
- Не удается отправить на подключения к данным электронной почты.
    
- Распространение свойств при соединениях между частями невозможно.
    
- Наличие управляемых элементов управления метаданными или подключений к данным невозможно.
    
Чтобы разрешить администраторам семейства использовать решения изолированные решения в Microsoft SharePoint Server 2010 или сервер под управлением Microsoft SharePoint Foundation 2010, администратору фермы необходимо запустить службу пользовательского кода Windows SharePoint.
  
### <a name="to-start-the-windows-sharepoint-user-code-service"></a>Запуск службы пользовательского кода Windows SharePoint

1. Откройте центр администрирования.
    
2. В разделе **Системные службы** щелкните команду **Управление службами на сервере**.
    
3. Запустите **службу пользовательского кода Microsoft SharePoint Foundation**.
    
### <a name="to-publish-a-sandboxed-solution"></a>Публикация изолированного решения

1. Откройте шаблон формы в конструкторе InfoPath.
    
2. Откройте вкладку **Файл**, а затем щелкните элемент **Сервер SharePoint** на вкладке **Публикация** в Backstage. 
    
3. Введите URL-адрес сайта SharePoint, на который выполняется публикация, а затем нажмите кнопку **Далее**. 
    
    > [!IMPORTANT]
    > [!Важно!] Для публикации шаблона форм как решение изолированные решения необходимо быть администратором семейства сайтов. 
  
4. Выберите элемент **Библиотека форм**, а затем нажмите кнопку **Далее**.
    
5. Выберите команду **Создать библиотеку форм**, а затем нажмите кнопку **Далее**.
    
6. Введите имя и описание для библиотеки форм, а затем нажмите кнопку **Далее**.
    
7. Нажмите кнопку **Опубликовать**.
    
Примеры решений для ситуаций, в которых шаблоны форм следует публиковать в качестве решения изолированные решения, представлены в разделе [Примеры изолированных решений](sample-sandboxed-solutions.md).
  
### <a name="publishing-form-templates-as-administrator-deployed-solutions"></a>Публикация шаблонов формы в качестве решений, рассматриваемых администратором

Публикация формы в качестве шаблона, рассматриваемого администратором, рекомендуется в том случае, если форма имеет несколько подключений к данным, требует уровня полного доверия, или в том случае, если необходим шаблон для всей фермы.
  
Перед тем как такое решение будет доступно на сайте SharePoint, администратор фермы должен выполнить определенные действия, а разработчик должен подготовить решение к рассмотрению.
  
Во-первых, если форма будет развернута с полным доверием, то необходимо установить уровень безопасности, как описано в следующей процедуре.
  
### <a name="to-set-the-security-level-of-a-form-template-to-full-trust"></a>Установка уровня полного доверия для шаблона формы

1. Откройте шаблон формы в конструкторе InfoPath.
    
2. Щелкните вкладку **Файл**, а затем на вкладке **Информация** щелкните команду **Параметры формы**.
    
3. Щелкните категорию **Безопасность и доверие**, а затем снимите флажок **Автоматически определять уровень безопасности**. 
    
4. Выберите параметр **Полное доверие**.
    
Затем выполните публикацию формы, как описано ниже. При этом следует помнить об отличиях от стандартной процедуры публикации.
  
### <a name="to-publish-an-administrator-deployed-solution"></a>Публикация решения, развертываемого администратором

1. На первой странице **мастера публикации** укажите расположение сайта SharePoint Server 2010 или SharePoint Foundation 2010, а затем нажмите кнопку **Далее**.
    
2. InfoPath автоматически установит флажок **Шаблоны форм, утвержденные администратором** на второй странице мастера. Нажмите кнопку **Далее**.
    
3. Третья страница предназначена только для сценариев развертывания администратором. Не выбирайте SharePoint Server, а опубликуйте форму в локальное хранилище. Администратор SharePoint отправит файл из этого расположения в ходе развертывания.
    
4. Установите необходимые параметры на остальных страницах **мастера публикации**.
    


---
title: Сведения о поддержке InfoPath технологий XML
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 074181a2-3a75-824c-049d-549aabff0f9f
description: Microsoft InfoPath — это средство гибридного, объединяющая превосходно традиционных редактирования качества, например текстовый редактор или приложение электронной почты, с возможностями строгие сбор данных форм пакета документов. В этой статье рассматриваются проблемы, для решения которых предназначено средство InfoPath, а также описаны принципы проектирования и отраслевые стандарты XML, использованные в решении проблем.
ms.openlocfilehash: 5d7b0bd0de045bdb9ada6946b7142993cd80df0c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807485"
---
# <a name="about-infopath-support-for-xml-technologies"></a><span data-ttu-id="7754d-104">Сведения о поддержке InfoPath технологий XML</span><span class="sxs-lookup"><span data-stu-id="7754d-104">About InfoPath Support for XML Technologies</span></span>

<span data-ttu-id="7754d-105">Microsoft InfoPath — это средство гибридного, объединяющая превосходно традиционных редактирования качества, например текстовый редактор или приложение электронной почты, с возможностями строгие сбор данных форм пакета документов.</span><span class="sxs-lookup"><span data-stu-id="7754d-105">Microsoft InfoPath is a hybrid tool that combines the best of a traditional document editing experience, such as a word processor or email application, with the rigorous data-capture capabilities of a forms package.</span></span> <span data-ttu-id="7754d-106">В этой статье рассматриваются проблемы, для решения которых предназначено средство InfoPath, а также описаны принципы проектирования и отраслевые стандарты XML, использованные в решении проблем.</span><span class="sxs-lookup"><span data-stu-id="7754d-106">This article describes the problems InfoPath is designed to address and explains the design principles and XML industry standards used to solve these problems.</span></span>
  
## <a name="introduction"></a><span data-ttu-id="7754d-107">Введение</span><span class="sxs-lookup"><span data-stu-id="7754d-107">Introduction</span></span>

<span data-ttu-id="7754d-p103">InfoPath  это средство высшего уровня для создания XML-документов, позволяющее обычным конечным пользователям создавать XML-документы, принадлежащие определенным пользователями схемам XML. При редактировании пользователем XML-документа все изменения контролируются схемой XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p103">InfoPath is a high-level XML authoring tool that enables ordinary end-users to create XML documents that belong to a custom-defined XML schema. When the user edits an XML document, modifications to the document are controlled by the XML schema.</span></span>
  
<span data-ttu-id="7754d-p104">Пользователь взаимодействует с XML-документом посредством интерфейса форматированного текста, отображаемого путем применения к документу таблицы стилей XSLT. Конечный узел или значение атрибута из XML-документа отображается как поле, например текстовое поле или флажок, а иерархия узлов представлена в виде группы полей.</span><span class="sxs-lookup"><span data-stu-id="7754d-p104">The user interacts with the XML document through a rich, formatted view that is displayed by applying an XSLT style sheet to the document. A leaf node or attribute value from the XML document is displayed as a field, such as a text box or check box, whereas a hierarchy of nodes is rendered as a group of fields.</span></span>
  
<span data-ttu-id="7754d-p105">InfoPath дает возможность выполнять структурированное редактирование XML-данных с проверкой, отображая действия редактирования, возможные для выбранного поля или выбранной группы полей. Такой структурированный способ редактирования позволяет пользователю добавлять и удалять допустимые элементы и атрибуты XML, работая с группами полей, отображаемых в форматированных представлениях, не видя сами элементы и атрибуты.</span><span class="sxs-lookup"><span data-stu-id="7754d-p105">InfoPath enables validated, structured editing of XML data by showing the editing actions that are valid for the field or field group that is currently selected. This structured editing enables the user to add and remove valid XML elements and attributes by working with groups of fields displayed in rich dynamic views, without seeing the elements and attributes.</span></span>
  
<span data-ttu-id="7754d-p106">InfoPath решает проблему сбора данных, которую невозможно было решить до появления XML: предоставляя формы, которые можно увеличивать в размере, добавляя группы полей, основанные на иерархической модели данных XML, InfoPath добавляет возможностям скрупулезной проверки приложений форм гибкость документов текстового редактора. Неотъемлемой частью этого решения, предоставляющего динамические и простые в использовании представления XML-данных, являются сложные XSL-преобразования.</span><span class="sxs-lookup"><span data-stu-id="7754d-p106">InfoPath solves a problem in the area of data gathering that could not be solved before the advent of XML: by providing forms that can grow by adding groups of fields that use the hierarchical data model of XML, InfoPath adds the flexibility of word processor documents to the rigorous validation features of a forms application. Complex XSLT transformations are an integral part of this solution that provides dynamic, easy-to-use views of the XML data.</span></span>
  
## <a name="limitations-of-traditional-forms-and-documents-for-gathering-data"></a><span data-ttu-id="7754d-116">Ограничения традиционных форм и документов в отношении сбора данных</span><span class="sxs-lookup"><span data-stu-id="7754d-116">Limitations of Traditional Forms and Documents for Gathering Data</span></span>

<span data-ttu-id="7754d-117">При сборе корпоративных данных пользователям зачастую необходима большая гибкость, чем предоставляемая статическими формами, а также более структурированное редактирование и проверка, чем предоставляемые документами редакторов текстов.</span><span class="sxs-lookup"><span data-stu-id="7754d-117">When gathering corporate data, users often want more flexibility than static forms provide, but more structured editing and validation than word processor documents provide.</span></span>
  
<span data-ttu-id="7754d-p107">Традиционные формы статичны и ограничены по длине. Они представляют собой фиксированное количество повторяющихся строк, которое не может быть увеличено при заполнении формы. Традиционные формы трудно использовать из-за отсутствия в них расширенных возможностей редактирования. Как правило, пользователь должен предоставлять все данные за один раз.</span><span class="sxs-lookup"><span data-stu-id="7754d-p107">Traditional forms are static and limited in length. They have a fixed number of repeating rows, and cannot be extended when the form is being filled out. Traditional forms are difficult to use because they do not have rich editing features. Often, the user must provide all the information in one pass.</span></span>
  
<span data-ttu-id="7754d-p108">С одной стороны, традиционные документы, создаваемые с помощью текстового редактора, дают пользователям возможность свободно добавлять и удалять контент, но не содержат инструкции относительно того, как следует вводить полные, структурированные и действительные данные; определенные в документе поля имеют ограниченные средства проверки типов и значений данных или не имеют таких средств вовсе. Данные полей не помечены для простоты создания ссылок и автоматического повторного использования. Данные содержатся в свободной форме, а не в виде структуры; их нельзя группировать, например, применяя метку "Адрес" к группе полей "Улица", "Город" и "Штат".</span><span class="sxs-lookup"><span data-stu-id="7754d-p108">On the other hand, traditional documents created by using a word processor enable the user to freely add and remove content, but provide little guidance about how to enter complete, structured, and valid information; any fields that are defined in the document have minimal or no validation of data values and data types. Data in the fields is not properly labeled to enable easy referencing and automatic reuse. The data is free-form rather than structured; you cannot group information, such as applying an "Address" label to a group of "Street", "City", and "State" fields.</span></span>
  
<span data-ttu-id="7754d-p109">Потребность в таком гибком, но структурированном, редактировании существовала, но ввиду отсутствия соответствующей технологии до появления XML разработчики вынуждены были создавать пользовательские приложения, требовавшие написания больших объемов кода. Пользовательские приложения дорого и сложно изменять, кроме того, они также требуют написания пользовательского кода для проверки. Помимо этого, требуется проводить дополнительное обучение конечных пользователей таких приложений, а получаемые данные мало пригодны для использования в других бизнес-процессах.</span><span class="sxs-lookup"><span data-stu-id="7754d-p109">Thus there is a need for such flexible yet structured editing, but because this kind of technology was not available before the advent of XML, developers have had to create custom applications, which require extensive coding. Custom applications are expensive and difficult to modify, and require custom coding for validation. Custom applications often require end-user training, and it is difficult to reuse the resulting data for other business processes.</span></span>
  
## <a name="providing-structured-editing-by-displaying-xml-data-as-field-groups"></a><span data-ttu-id="7754d-127">Предоставление структурированного способа редактирования путем отображения XML-данных в виде групп полей</span><span class="sxs-lookup"><span data-stu-id="7754d-127">Providing Structured Editing by Displaying XML Data as Field Groups</span></span>

<span data-ttu-id="7754d-p110">Решена важная техническая проблема проектирования, заключавшаяся в предоставлении простого пользовательского интерфейса для добавления и удаления элементов и атрибутов XML без отображения самих элементов и атрибутов, но с сохранением правильности дерева DOM в соответствии с определенной пользователем схемой XML. Пользовательский интерфейс должен был предоставлять естественный способ редактирования дерева DOM, включая вставку дополнительных поддеревьев, выбор вариантов замены поддеревьев и расширение существующих поддеревьев.</span><span class="sxs-lookup"><span data-stu-id="7754d-p110">An important technical design problem that had to be solved was how to provide an easy user interface for adding and removing XML elements and attributes, without showing the elements and attributes, but keeping the DOM tree valid according to the custom-defined XML schema. The user interface needed to provide a natural way to edit the DOM tree that includes inserting optional subtrees, replacing choices of subtrees, and extending existing subtrees.</span></span>
  
<span data-ttu-id="7754d-130">Чтобы обеспечить этот простой пользовательский интерфейс, поддерева DOM отображается как группа полей или раздела.</span><span class="sxs-lookup"><span data-stu-id="7754d-130">To provide this easy user interface, a DOM subtree is displayed as a field group, or section.</span></span> <span data-ttu-id="7754d-131">Группа полей — это набор элементов управления пользовательского интерфейса, таких как текстовые поля и раскрывающиеся списки и выступает в качестве простой пользовательский интерфейс, который позволяет пользователю визуализировать и изменение иерархических XML-данных.</span><span class="sxs-lookup"><span data-stu-id="7754d-131">A field group is a group of UI controls, such as text boxes and drop-down lists, and serves as an easy user interface that enables the user to visualize and edit hierarchical XML data.</span></span> <span data-ttu-id="7754d-132">Группа полей может содержать другие поля групп и может быть необязательный или повторяющейся, так же, как поддерева DOM может содержать другие поддеревьев и могут быть обязательными или повторяющейся.</span><span class="sxs-lookup"><span data-stu-id="7754d-132">A field group can contain other field groups and can be optional or repeating, just as a DOM subtree can contain other subtrees and can be optional or repeating.</span></span> <span data-ttu-id="7754d-133">Поддерево добавляется в дерево DOM, когда пользователь наводит указатель мыши на группу полей, нажимает раскрывающееся меню, которое появляется в группе поля, а затем выбирает **Вставить \<название группы\>**.</span><span class="sxs-lookup"><span data-stu-id="7754d-133">A subtree is added to the DOM tree when the user rests the mouse pointer over a field group, clicks the drop-down menu that appears on the field group, and then selects **Insert \<field group name\>**.</span></span>
  
<span data-ttu-id="7754d-p112">InfoPath предоставляет такой структурированный способ редактирования данных XML с использованием указанной схемы XML, накладывающей определенные ограничения на процесс редактирования. Схема обусловливает отображение в раскрывающемся меню команды **Вставить** или **Удалить** для той или иной группы полей. Схема также используется для проверки. При редактировании XML-документа, для которого не определена схема XML, InfoPath может создать схему на основе документа XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p112">InfoPath provides this structured editing of XML data by using the specified XML schema to constrain and guide editing. The schema controls whether the **Insert** and **Remove** commands appear on the drop-down menu for a field group. The schema is also used for validation. To enable editing of an XML document for which there is no XML schema, InfoPath can generate a schema from the XML document.</span></span> 
  
## <a name="providing-easy-to-use-views-of-xml-data-by-using-xslt-transformations"></a><span data-ttu-id="7754d-138">Предоставление простых в использовании представлений данных XML с помощью XSL-преобразований</span><span class="sxs-lookup"><span data-stu-id="7754d-138">Providing Easy-to-Use Views of XML Data by Using XSLT Transformations</span></span>

<span data-ttu-id="7754d-p113">Еще одной технической трудностью проектирования было обеспечение возможности организации содержимого элементов управления пользовательского интерфейса в структуры, сильно отличающиеся от структуры данных XML. Для представления данных для просмотра и редактирования в наиболее удобном для пользователя виде разработчик должен иметь возможность представлять данные в отличных от дерева данных DOM последовательностях, исключать некоторые данные из представления, реорганизовывать смежные узлы дерева данных в отдельных представлениях и собирать данные из различных частей дерева данных в единое представление.</span><span class="sxs-lookup"><span data-stu-id="7754d-p113">Another technical design challenge that needed to be solved was how to enable the content of the UI views to be organized very differently than the structure of the XML data. To present the data in a way that makes the most sense for the user and enables the user to easily read and edit the data, the designer must be able to display data in a different sequence than in the DOM data tree, omit some data from a view, reorganize adjacent data tree nodes into separate views, and collect data from different parts of the data tree into a single view.</span></span>
  
<span data-ttu-id="7754d-p114">Порядок и структура содержимого представлений, следовательно, должны быть независимы от порядка и структуры узлов дерева DOM. Такая структурная независимость представлений и данных требует наличия сложных динамических связей или сопоставлений между сгруппированными полями в представлениях и узлах дерева DOM.</span><span class="sxs-lookup"><span data-stu-id="7754d-p114">The order and structure of the content of the views must therefore be independent of the order and structure of the DOM tree nodes. This structural independence of presentation and data requires a complex, dynamic binding or mapping between the grouped fields in the views and the nodes in the DOM tree.</span></span>
  
<span data-ttu-id="7754d-p115">Чтобы обеспечить сложное сопоставление между представлениями и данными, в InfoPath широко применяются XSL-преобразования (XSLT). XSLT  это мощный язык создания таблиц стилей, поддерживающий сложные XSL-преобразования и форматированные представления с динамическим и гибким содержимым. Для каждого представления используется один XSLT-файл. Использование таблицы стилей  это распространенный и зарекомендовавший себя способ, реализованный в средствах создания файлов SGML и XML, а XSLT  это стандарт W3C для таблиц стилей, используемых в таком виде сложных преобразований.</span><span class="sxs-lookup"><span data-stu-id="7754d-p115">To provide this complex mapping between views and data, InfoPath uses XSL Transformations (XSLT) extensively. XSLT is a powerful style sheet language that supports complex XSLT transformations and supports rich views with dynamic, flexible presentation of content. One XSLT file is used for each view. By using a style sheet is a common, well-established design approach in SGML and XML authoring tools, and XSLT is the W3C standard for stylesheets that are used for this kind of complex transformation.</span></span>
  
<span data-ttu-id="7754d-p116">Для предотвращения выполнения всего XSL-преобразования каждый раз, когда пользователь изменяет структуру поддерева DOM, используются специальные алгоритмы определения части представления, требующей обновления. Так к файлу применяется только касающаяся изменений часть таблицы стилей XSLT, и выполняется обновление только измененной части представления.</span><span class="sxs-lookup"><span data-stu-id="7754d-p116">To avoid running the whole XSLT transformation every time that the user modifies the structure of a subtree in the DOM, algorithms are used to determine which part of the view must be refreshed. Then only the relevant part of the XSLT style sheet is applied, and the affected part of the view is refreshed.</span></span>
  
## <a name="how-xml-standards-are-used-when-editing-a-form"></a><span data-ttu-id="7754d-149">Использование стандартов XML при изменении форм</span><span class="sxs-lookup"><span data-stu-id="7754d-149">How XML Standards Are Used When Editing a Form</span></span>

<span data-ttu-id="7754d-150">InfoPath с самого основания строится на стандартах XML, среди которых можно назвать следующие:</span><span class="sxs-lookup"><span data-stu-id="7754d-150">InfoPath is built from the ground up on XML standards that includes the following:</span></span>
  
- <span data-ttu-id="7754d-151">Extensible Markup Language (XML) 1.0 Second Edition</span><span class="sxs-lookup"><span data-stu-id="7754d-151">Extensible Markup Language (XML) 1.0 Second Edition</span></span>
    
- <span data-ttu-id="7754d-152">Пространства имен в XML</span><span class="sxs-lookup"><span data-stu-id="7754d-152">Namespaces in XML</span></span>
    
- <span data-ttu-id="7754d-153">Язык адресации XML (XPath) 1.0</span><span class="sxs-lookup"><span data-stu-id="7754d-153">XML Path Language (XPath) 1.0</span></span>
    
- <span data-ttu-id="7754d-154">Схема XML (XSD) 1.0, Часть 1. Структуры; Часть 2. Типы данных</span><span class="sxs-lookup"><span data-stu-id="7754d-154">XML Schema (XSD) 1.0 Part 1: Structures, and Part 2: Datatypes</span></span>
    
- <span data-ttu-id="7754d-155">Extensible Stylesheet Language Transformations (XSLT) 1.0</span><span class="sxs-lookup"><span data-stu-id="7754d-155">Extensible Stylesheet Language Transformations (XSLT) 1.0</span></span>
    
- <span data-ttu-id="7754d-156">Расширяемый язык гипертекстовой разметки (XHTML) 1.0</span><span class="sxs-lookup"><span data-stu-id="7754d-156">Extensible Hypertext Markup Language (XHTML) 1.0</span></span>
    
- <span data-ttu-id="7754d-157">Каскадные таблицы стилей</span><span class="sxs-lookup"><span data-stu-id="7754d-157">Cascading Style Sheets (CSS)</span></span>
    
- <span data-ttu-id="7754d-158">Модель объектов документа (DOM) 1.0</span><span class="sxs-lookup"><span data-stu-id="7754d-158">Document Object Model (DOM) 1.0</span></span>
    
- <span data-ttu-id="7754d-159">Цифровые подписи XML (XML DSig)</span><span class="sxs-lookup"><span data-stu-id="7754d-159">XML Digital Signatures (XML DSig)</span></span>
    
- <span data-ttu-id="7754d-160">Протокол SOAP 1.1</span><span class="sxs-lookup"><span data-stu-id="7754d-160">Simple Object Access Protocol (SOAP) 1.1</span></span>
    
- <span data-ttu-id="7754d-161">Язык описания веб-служб (WSDL) 1.1</span><span class="sxs-lookup"><span data-stu-id="7754d-161">Web Services Description Language (WSDL) 1.1</span></span>
    
- <span data-ttu-id="7754d-162">Службы UDDI 1.0</span><span class="sxs-lookup"><span data-stu-id="7754d-162">Universal Description, Discovery, and Integration (UDDI) 1.0</span></span>
    
<span data-ttu-id="7754d-p117">Например, InfoPath использует и создает стандартные файлы XML, XSLT и XSD, которые могут использоваться вторично во множестве бизнес-процессов. Для поддержки этих стандартов InfoPath использует MSXML, пакет инструментов SOAP и пространство имен .NET System.XML, а также обеспечивает полностью интегрированную поддержку веб-служб XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p117">For example, InfoPath uses and generates standard XML, XSLT, and XSD files that can be reused in various business processes. InfoPath uses MSXML, the SOAP Toolkit, and the .NET System.XML namespace to support these standards, and provides full integrated support for XML Web services.</span></span>
  
<span data-ttu-id="7754d-p118">На рис. 1 показано контекстное раскрывающееся меню для группы полей **customer**, позволяющее пользователю добавить еще одну группу полей **customer**, удалить данную группу полей **customer**, вставить строку **item** в таблицу элементов закупки в данной группе полей или вставить дополнительную группу полей **actions** внутрь данной группы. Кроме того, можно вставить группу полей **actions**, выбрав ссылку **Щелкнуть здесь**. При этом для каждой строки элементов закупки будет открыто более короткое раскрывающееся меню.</span><span class="sxs-lookup"><span data-stu-id="7754d-p118">Figure 1 shows the context-sensitive drop-down menu for a **customer** field group, which enables the user to add another **customer** field group, remove this **customer** field group, insert an **item** row in the table of purchase items in this field group, or insert an optional **actions** field group within this field group. The **Click here** link provides another way to insert the **actions** field group. A shorter drop-down menu appears on each purchase-item row.</span></span> 
  
1. <span data-ttu-id="7754d-p119">В InfoPath пользователи могут создать новый документ XML на основе шаблона форм InfoPath или открыть существующий документ XML, основанный на шаблоне форм. Документ XML  это файл данных XML, содержащий ссылку на шаблон форм, который может использовать пространства имен XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p119">In InfoPath, the user creates a new XML document based on an InfoPath form template, or opens an existing XML document that is based on a form template. The XML document is an XML data file that contains a reference to the form template and can use XML namespaces.</span></span> 
    
    <span data-ttu-id="7754d-p120">Шаблон форм  это набор файлов, предоставляющих возможность структурированного редактирования документов XML, соответствующих заданной пользователем схемы XML. Файлы, составляющие шаблон форм, могут быть упакованы как отдельные файлы внутри обычной папки или как файлы в папке CAB-файла. В любом случае это стандартные XML-файлы и иногда еще дополнительные файлы, такие как сборки с управляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="7754d-p120">A form template is the set of files that provide structured editing of XML documents that comply with a particular custom-defined XML schema. The files that make up the form template may be packaged as individual files inside a ordinary folder or as files residing in a cabinet folder. In either case, the files are standard XML files and optional supporting files such as managed code assemblies.</span></span>
    
2. <span data-ttu-id="7754d-173">Если документ XML имеет цифровую подпись XML, InfoPath перед открытием XML-файла проверяет ее соответствие.</span><span class="sxs-lookup"><span data-stu-id="7754d-173">If the XML document is digitally signed using XML Signature, InfoPath confirms that the XML file is consistent before it opens it.</span></span>
    
3. <span data-ttu-id="7754d-174">InfoPath создает дерево DOM документа XML в памяти.</span><span class="sxs-lookup"><span data-stu-id="7754d-174">InfoPath creates a DOM data tree of the XML document in-memory.</span></span>
    
4. <span data-ttu-id="7754d-p121">К дереву DOM применяются XSL-преобразования, создающие представления в необходимом пользователю виде. Элементы, расположенные в начале документа XML, могут отображаться в одном представлении в нижней части, в другом  как-то иначе. Представления состоят из контейнеров пользовательских интерфейсов, таких как разделы с текстом и элементы управления, поля ввода форматированного текста, элементы управления выбора даты и раскрывающиеся списки. Контейнеры также могут содержать вложенные контейнеры.</span><span class="sxs-lookup"><span data-stu-id="7754d-p121">XSLT transformations are applied to the DOM tree, producing views that show an appropriate presentation of the document to the user. Elements at the beginning of the XML document could be displayed at the bottom of the view and also in a different arrangement in another view. The views consist of UI containers such as sections that contain text and controls, such as text boxes, rich text boxes, date pickers, and drop-down lists. Containers can also contain other containers.</span></span>
    
5. <span data-ttu-id="7754d-179">XSL-преобразование в качестве вывода создает XHTML, а для управления представлением XHTML используется CSS.</span><span class="sxs-lookup"><span data-stu-id="7754d-179">The XSLT transformation produces XHTML as output, and then a CSS is used to control the presentation of the XHTML.</span></span>
    
6. <span data-ttu-id="7754d-p122">Если схема XML позволяет добавлять узлы к узлу дерева данных, поле или группа полей, сопоставленные с узлом, будут иметь раскрывающееся меню, в котором пользователь может выбрать необходимую команду  добавление или удаление. При изменении документа пользователь может добавлять повторяющиеся или необязательные группы полей, вводить значения, выбирать параметры или вводить форматированный текст. Если узел схемы XML связан со схемой XHTML, InfoPath представляет пользовательский интерфейс для создания форматированного текста. При вводе пользователем форматированного текста контент XHTML создается в виде поддерева в DOM.</span><span class="sxs-lookup"><span data-stu-id="7754d-p122">If the XML schema allows adding nodes to a node of the data tree, the field or field group that is mapped to the node has a drop-down menu that enables the user to add or remove field groups. The user edits the document by adding a repeating or optional field group, entering a value, selecting an option, or entering rich text. If an XML schema node is associated with the schema for XHTML, InfoPath presents a UI for creating rich text. When the user enters rich text, XHTML content is created as a subtree in the DOM.</span></span>
    
7. <span data-ttu-id="7754d-p123">Дерево DOM постоянно поддерживается действительным. В процессе работы с документом XML вносимые изменения проверяются на соответствие связанной схеме XML. Изменения структуры DOM и значений конечных узлов проверяются на соответствие схеме XML, чтобы гарантировать допустимость типов данных и значений. Если изменение дерева DOM признается недопустимым, открывается диалоговое окно проверки, а само изменение не применяется. Если изменения допустимы, выполняется обновление дерева DOM.</span><span class="sxs-lookup"><span data-stu-id="7754d-p123">The DOM tree is always kept valid. As the user edits the XML document, the edits are validated against the associated XML schema. The attempted changes to the DOM structure and leaf node values are validated against the XML schema to ensure that their data types and values are valid. If the attempted changes are invalid, a validation dialog box opens, and the changes are not applied to the DOM tree. If the changes are valid, the DOM tree is updated.</span></span>
    
8. <span data-ttu-id="7754d-189">Измененная часть представления обновляется с применением к дереву DOM только необходимых частей таблицы стилей XSLT.</span><span class="sxs-lookup"><span data-stu-id="7754d-189">The changed part of the view is refreshed, by applying only the required parts of the XSLT style sheet to the DOM tree.</span></span>
    
9. <span data-ttu-id="7754d-p124">Пользователь может сохранить документ XML или отправить его, используя протокол HTTP или SOAP. Отправка документов, не соответствующих схеме XML, невозможна.</span><span class="sxs-lookup"><span data-stu-id="7754d-p124">The user can save the XML document or submit the XML document by using plain HTTP or SOAP. The user is not allowed to submit the document unless it is valid according to the XML schema.</span></span>
    
## <a name="how-xml-standards-are-used-when-designing-a-form"></a><span data-ttu-id="7754d-192">Использование стандартов XML при разработке форм</span><span class="sxs-lookup"><span data-stu-id="7754d-192">How XML Standards Are Used When Designing a Form</span></span>

<span data-ttu-id="7754d-p125">Для создания формы можно начать с использования уже существующей схемы XML, можно подключиться к веб-службе XML или базе данных и получить их схему XML, можно создать схему автоматически на основе новой формы или файла данных XML. Сценарии создания форм описаны в следующих процедурах. На рис. 3 показан базовый пользовательский интерфейс создания шаблона форм.</span><span class="sxs-lookup"><span data-stu-id="7754d-p125">You can design a form by starting with an existing XML schema, by connecting to an XML Web service or database and obtaining its XML schema, or by automatically generating a schema from a new form or from an XML data file. These scenarios are described in the following procedures. Figure 3 shows the basic user interface for designing a form template.</span></span>
  
1. <span data-ttu-id="7754d-p126">Создайте новую форму в InfoPath Designer. Для этого выберите шаблон формы **XML или схема**, а затем выберите существующий файл схемы XML в качестве источника данных. Схема XML будет загружена в область задач и отобразится в виде дерева.</span><span class="sxs-lookup"><span data-stu-id="7754d-p126">Create a new form in the InfoPath Designer by selecting the **XML or Schema** form template, and then select an existing XML schema file as the data source. The XML schema is loaded into the task pane and shown as a tree control.</span></span> 
    
2. <span data-ttu-id="7754d-p127">C помощью средств макетирования можно разметить элементы управления пользовательского интерфейса, такие как строки и фон в одном или сразу нескольких представлениях. При этом создаются некоторые элементы XSLT. Представления XSLT и схема XML автоматически связываются с шаблоном форм.</span><span class="sxs-lookup"><span data-stu-id="7754d-p127">Use the design layout tools to lay out the UI controls, such as rows and the background design, in one or more views. This generates some of the XSLT elements. The XSLT views and the XML schema are automatically associated with the form template.</span></span>
    
3. <span data-ttu-id="7754d-p128">Сопоставление элементов схемы XML с элементами управления пользовательского интерфейса выполняется с помощью операции перетаскивания. InfoPath помогает выбрать соответствующие элементы управления для элементов схемы XML, основываясь на видах элементов схемы. Например, если тип данных XML  дата, InfoPath предложит элемент управления выбора даты. В зависимости от вариантов выбора, предусмотренных в схеме XML, InfoPath может вставлять группы дополнительных или повторяющихся полей. При сопоставлении элементов схемы XML с элементами управления пользовательского интерфейса создается структура XSLT.</span><span class="sxs-lookup"><span data-stu-id="7754d-p128">Map the XML schema elements to the UI controls in the views by using drag-and-drop. InfoPath helps you choose appropriate controls for the XML schema elements, based on the kind of the schema elements. For example, if the XML data type is date, InfoPath suggests a date picker control. Based on choices in the XML schema, InfoPath can insert groups of optional or repeating fields. Mapping the XML schema elements to the UI controls generates the XSLT structure.</span></span>
    
4. <span data-ttu-id="7754d-p129">Сохраните шаблон формы. Для этого сохраните все файлы, составляющие шаблон, в обычной папке или в CAB-файле. В любом случае это будут стандартные XML-файлы. Теперь шаблон форм готов к использованию пользователями.</span><span class="sxs-lookup"><span data-stu-id="7754d-p129">Save the form template. You can save the files that make up the form template as individual files in a regular folder or as files inside a cabinet folder. In either case, the files are standard XML files. The form template is now ready for the user to use.</span></span>
    
<span data-ttu-id="7754d-p130">Шаблон форм содержит все семантические сведения, необходимые для обеспечения структурированного способа редактирования при открытии формы в InfoPath. Шаблон включает файл манифеста, XSLT-файлы, определяющие представления, сведения, необходимые для проверки данных, и дополнительный идентификатор ресурсов для веб-службы XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p130">A form template contains all the semantic information that is needed to provide structured editing when a form is opened in InfoPath. A form template includes a manifest file, the XSLT files that define the views, the information that is needed to validate data, and an optional resource identifier for an XML Web service.</span></span>
  
<span data-ttu-id="7754d-p131">Манифест или файл определения формы  это концентратор и точка входа для всех файлов, требуемых шаблоном форм. Манифест содержит ссылки на другие файлы шаблона форм и сведения, необходимые для проверки данных и обеспечения структурированной правки. Сведения для проверки соответствия схеме XML настраиваются с учетом конечного пользовательского интерфейса и добавляются в файл манифеста. Например, если схема позволяет выполнять вставку в определенное поддерево нескольких дополнительных элементов, можно разработать пользовательский интерфейс так, чтобы при выполнении пользователем одной операции пользовательского интерфейса вставлялось сразу несколько элементов. Такие настройки играют важную роль в обеспечении удобства для обычных пользователей.</span><span class="sxs-lookup"><span data-stu-id="7754d-p131">The manifest, or form definition file , is the common hub and entry point for all of the files that are required by the form template. The manifest contains references to the other files in the form template, and contains the information that is needed to validate data and provide structured editing. The XML schema validation information is customized for the resulting user interface and added to the manifest file. For example, if the schema allows inserting multiple optional elements in a specific subtree, you can design the UI so that multiple optional elements are added when the user performs a single UI operation. This customization is important for providing a great user experience for the ordinary user.</span></span> 
  
<span data-ttu-id="7754d-p132">Форму также можно создать, использовав существующую веб-службу XML для получения схемы XML. Для этого выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7754d-p132">You can also design a form by using an existing XML Web service to provide the XML schema. To do this:</span></span>
  
1. <span data-ttu-id="7754d-219">С помощью UDDI найдите необходимую веб-службу.</span><span class="sxs-lookup"><span data-stu-id="7754d-219">Use UDDI to locate relevant Web services.</span></span>
    
2. <span data-ttu-id="7754d-p133">Выберите веб-службу. InfoPath считает данные из WSDL-файла, связанного с веб-службой, и определит используемую схему XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p133">Select the Web service to use. InfoPath reads the WSDL file associated with the Web service and identifies the XML schema to be used.</span></span>
    
3. <span data-ttu-id="7754d-222">Откройте схему XML, чтобы загрузить ее.</span><span class="sxs-lookup"><span data-stu-id="7754d-222">Open the XML schema to load it.</span></span>
    
4. <span data-ttu-id="7754d-223">Расположите элементы управления пользовательского интерфейса и свяжите их с элементами и атрибутами схемы XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-223">Lay out the UI controls and associate them with XML schema elements and attributes.</span></span>
    
5. <span data-ttu-id="7754d-224">Определите способ отправки документа XML веб-службе, использующей протокол SOAP.</span><span class="sxs-lookup"><span data-stu-id="7754d-224">Define how to submit the XML document to the Web service that uses SOAP.</span></span>
    
<span data-ttu-id="7754d-225">Чтобы создать форму с нуля и автоматически создать для нее схему XML, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7754d-225">If you want to design a form from scratch and automatically generate the XML schema:</span></span>
  
1. <span data-ttu-id="7754d-226">На вкладке **Файл** выберите шаблон формы **Пустая форма** или **Пустая форма (InfoPath Filler)**, а затем выберите пункт **Конструктор форм**.</span><span class="sxs-lookup"><span data-stu-id="7754d-226">On the **File** tab, select either the **Blank Form** or **Blank Form (InfoPath Filler)** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="7754d-p134">На вкладке **Главная** щелкните стрелку, расположенную в правом нижнем углу группы **Элементы управления**, чтобы открыть область задач **Элементы управления**. Убедитесь, что установлен флажок **Автоматически создавать источник данных** (по умолчанию этот флажок установлен).</span><span class="sxs-lookup"><span data-stu-id="7754d-p134">On the **Home** tab, click the arrow in the lower-right corner of the **Controls** group to display the **Controls** task pane, and then make sure that the **Automatically create the data source** check box is selected. (By default, this check box is selected.)</span></span> 
    
3. <span data-ttu-id="7754d-p135">Расположите элементы управления пользовательского интерфейса. При этом InfoPath автоматически создаст схему XML и сопоставит ее элементы и атрибуты с этими элементами управления.</span><span class="sxs-lookup"><span data-stu-id="7754d-p135">Lay out the UI controls. As you lay them out, InfoPath automatically creates the XML schema and maps its elements and attributes to the UI controls.</span></span>
    
<span data-ttu-id="7754d-231">Чтобы создать форму, используя имеющийся файл данных XML, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="7754d-231">To design a form by starting with any well-formed XML data file:</span></span>
  
1. <span data-ttu-id="7754d-232">На вкладке **Файл** выберите шаблон формы **XML или схема**, а затем выберите пункт **Конструктор форм**.</span><span class="sxs-lookup"><span data-stu-id="7754d-232">On the **File** tab, select the **XML or Schema** form template, and then click **Design Form**.</span></span>
    
2. <span data-ttu-id="7754d-p136">В окне **Мастер источника данных** выберите XML-файл, который требуется использовать в качестве источника данных. Схема XML создается автоматически на основе выбранного XML-файла данных.</span><span class="sxs-lookup"><span data-stu-id="7754d-p136">In the **Data Source Wizard**, select the XML file that you want to use as the data source. An XML schema is automatically created, based on the XML data file.</span></span>
    
3. <span data-ttu-id="7754d-235">Разместите элементы управления пользовательского интерфейса, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="7754d-235">Lay out the UI controls as described earlier in this section.</span></span>
    
## <a name="designed-as-an-ideal-client-for-web-services"></a><span data-ttu-id="7754d-236">Идеальный клиент для веб-служб</span><span class="sxs-lookup"><span data-stu-id="7754d-236">Designed as an Ideal Client for Web Services</span></span>

<span data-ttu-id="7754d-p137">Широкомасштабная поддержка веб-служб становится доступной. Многие серверные системы и системы среднего уровня можно настроить на обмен данными с использованием таких стандартов веб-служб, как SOAP, UDDI и WSDL. Такие системы на основе веб-служб включают базы данных, системы рабочих процессов, системы планирования корпоративных ресурсов, системы управления отношениями с клиентами и прочие. В настоящее время InfoPath предоставляет идеальный пользовательский интерфейс для просмотра и редактирования данных XML, отправляемых посредством веб-служб. На рис. 4 показана интегрированная поддержка веб-служб XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p137">Broad industry-wide support for Web services is becoming available. Many back-end and middle-tier systems can be configured to communicate by using Web services standards such as SOAP, UDDI, and WSDL. These Web services-enabled systems include databases, workflow systems, enterprise resource planning (ERP), customer relationship management (CRM), and other systems. Now, InfoPath provides an ideal UI to view and edit the XML data that is being sent through Web services. Figure 4 shows the integrated support for XML Web services.</span></span>
  
<span data-ttu-id="7754d-p138">InfoPath отлично вписывается в слабосвязанную модель веб-служб, в которой данные передаются между компьютерами в виде полных документов XML. Такая крупномодульная модель коммуникации хорошо сочетается с асинхронной природой Интернета. Будучи средством высшего уровня для создания документов XML, InfoPath вместо кодирования SOAP RPC поддерживает кодирование SOAP Document/Literal. InfoPath  это идеальный клиент для веб-служб, поскольку он способен с помощью собственных средств выполнять чтение данных из схемы XML, указанной в сообщении SOAP, и создавать основанный на схеме пользовательский интерфейс, позволяющий пользователям легко просматривать и редактировать документы XML, создаваемые или получаемые соответствующей веб-службой. InfoPath также поддерживает ADO.NET DataSets, включая отслеживание изменений.</span><span class="sxs-lookup"><span data-stu-id="7754d-p138">InfoPath fits well with the loosely coupled model of Web services, in which data is sent between computers as complete XML documents. This coarse-grained communication model fits well with the asynchronous nature of the Web. As a high-level authoring tool for XML documents, InfoPath supports the document/literal SOAP encoding instead of Remote Procedure Call (RPC) SOAP encoding. InfoPath is an ideal client for Web services, because it can natively read the XML schema specified in a SOAP message and then create a UI based on the schema, which enables users to easily view and edit XML documents that are generated or received by the corresponding Web service. InfoPath also provides support for ADO.NET DataSets that includes change-tracking.</span></span>
  
## <a name="terminology"></a><span data-ttu-id="7754d-247">Терминология</span><span class="sxs-lookup"><span data-stu-id="7754d-247">Terminology</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="7754d-248">**Группа полей:**</span><span class="sxs-lookup"><span data-stu-id="7754d-248">**field group:**</span></span> <br/> |<span data-ttu-id="7754d-p139">Раздел, повторяющийся раздел, дополнительный раздел или повторяющаяся таблица. Разделы и повторяющиеся таблицы являются элементами управления формы, содержащей и другие элементы управления, которые повторяются по мере необходимости. При заполнении формы пользователь может вставлять сразу несколько разделов или строк.</span><span class="sxs-lookup"><span data-stu-id="7754d-p139">A section, repeating section, optional section, or repeating table. Sections and repeating tables are controls on a form that contain other controls and that repeat as needed. Users can insert multiple sections or rows when filling out the form.</span></span>  <br/> |
|<span data-ttu-id="7754d-252">**Дерево DOM:**</span><span class="sxs-lookup"><span data-stu-id="7754d-252">**DOM tree:**</span></span> <br/> |<span data-ttu-id="7754d-253">Структура источник данных формы.</span><span class="sxs-lookup"><span data-stu-id="7754d-253">The structure of the data source of the form.</span></span> <span data-ttu-id="7754d-254">В частности, коллекции полей и групп, которые определяют и хранят данные в форме InfoPath.</span><span class="sxs-lookup"><span data-stu-id="7754d-254">In particular, the collection of fields and groups that define and store the data for an InfoPath form.</span></span>  <br/> |
   
## <a name="conclusion"></a><span data-ttu-id="7754d-255">Заключение</span><span class="sxs-lookup"><span data-stu-id="7754d-255">Conclusion</span></span>

<span data-ttu-id="7754d-p141">InfoPath использует открытые стандарты XML для предоставления пользователям гибкого, но структурированного способа редактирования XML при сборе данных. Для обеспечения простоты визуализации и редактирования иерархически организованных данных XML встроенные группы полей, содержащие элементы управления пользовательского интерфейса, сопоставлены с деревом DOM. XSL-преобразования позволяют реорганизовывать содержимое представлений пользовательского интерфейса иначе, чем оно организовано в структуре данных XML.</span><span class="sxs-lookup"><span data-stu-id="7754d-p141">InfoPath uses open XML standards to provide users with flexible yet structured XML editing for data gathering. To provide an easy user interface for visualizing and editing hierarchical XML data, nested field groups that contains UI controls are mapped to the DOM tree. XSLT transformations enable the content of the UI views to be organized differently than the structure of the XML data.</span></span>
  
<span data-ttu-id="7754d-p142">InfoPath предоставляет большую гибкость, чем статичные формы, с более структурированным процессом правки и проверки, чем документы текстовых редакторов. В результате получается гибрид, объединяющий в себе лучшие характеристики традиционной правки документов с возможностями скрупулезного захвата данных пакета форм, что дает возможность обычным пользователям создавать допустимые документы XML, принадлежащие определенной пользователем схеме XML. Интегрированная поддержка веб-служб позволяет легко определять представления для редактирования документов XML в соответствии со схемами веб-служб.</span><span class="sxs-lookup"><span data-stu-id="7754d-p142">InfoPath provides more flexibility than static forms, with more structured editing and validation than word processor documents. The result is a hybrid tool that combines the best of a traditional document editing experience with the rigorous data-capture capabilities of a forms package, which enables ordinary users to create valid XML documents that belong to a custom-defined XML schema. Integrated support for Web services enables easily defining views for editing XML documents that comply with a Web services schema.</span></span>
  


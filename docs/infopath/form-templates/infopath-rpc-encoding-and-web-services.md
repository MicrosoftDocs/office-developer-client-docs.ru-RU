---
title: InfoPath, кодировка RPC и веб-службы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: f8d7b944-a8fd-9c5f-8f66-0f1b628b7c6e
description: 'Веб-службы могут предоставлять один или два стиля привязки к своим веб-методам в контракте WSDL, где они описаны: документальный или RPC.'
ms.openlocfilehash: 01b75df42bce97d62ebb5e273588cb522e5e2a09
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807514"
---
# <a name="infopath-rpc-encoding-and-web-services"></a>InfoPath, кодировка RPC и веб-службы

Веб-службы могут предоставлять один или два стиля привязки к своим веб-методам в контракте WSDL, где они описаны: документальный или RPC. Кроме того, каждый из этих стилей привязки может быть указан как литеральный или закодированный. Самыми распространенными реализациями для каждого типа являются следующие: документальная/литеральная и RPC/закодированная. Однако Microsoft InfoPath поддерживает подключение только к веб-службам, использующим документальный/литеральный стиль.
  
Многие средства развертывания веб-служб располагают переключателем для выбора типа создаваемой веб-службы. При разработке веб-службы, подключение к которой будет выполняться из InfoPath, в качестве стиля и кодирования необходимо указать "документальный/литеральный".
  
Однако если над веб-службой контроль не ведется и необходимо подключиться к веб-службе со стилем RPC/закодированный, можно использовать прокси-службу .NET.
  
## <a name="using-a-net-proxy-service-to-connect-to-a-web-service"></a>Использование прокси-службы .NET для подключения к веб-службе

Если веб-служба со стилем RPC/закодированный не контролируется, можно создать документальную/литеральную прокси-веб-службу .NET, предоставляющую функции оболочки для каждого веб-метода, который нужно вызвать из веб-службы со стилем RPC/закодированный. После этого с документальной/литеральной прокси-веб-службой можно будет работать из приложения InfoPath.
  
Код .NET Framework может функционировать с любым видом веб-службы (RPC/закодированным и документальным/литеральным), а все веб-службы .NET используют документальный/литеральный стиль и кодирование. Поскольку .NET Framework может взаимодействовать с любой веб-службой, можно создать веб-службу .NET с методами, вызывающими RPC/закодированную веб-службу. Веб-служба .NET будет действовать в качестве преобразователя, позволяющего приложению InfoPath осуществлять вызовы в стиле документальный/литеральный для веб-службы .NET, которая в свою очередь может осуществлять вызовы в стиле RPC/закодированный для исходной веб-службы
  
Необходимым требованием для создания такой прокси-веб-службы .NET является наличие компьютера с Microsoft Windows или Microsoft Windows Server, где запущены службы Internet Information Services (IIS) и установлена среда ASP.NET. При создании решения InfoPath вместо веб-службы со стилем RPC/закодированный будет указываться прокси-веб-служба. После этого прокси-веб-служба вызовет службу со стилем RPC/закодированный.
  
## <a name="creating-a-proxy-web-service-using-visual-studio"></a>Создание прокси-веб-службы с помощью Visual Studio

1. Создайте проект **Приложение веб-службы ASP.NET**. 
    
2. В окне **Обозреватель решений** правой кнопкой мыши щелкните папку **Ссылки** нового проекта, а затем нажмите **Добавить веб-ссылку**. 
    
3. В диалоговом окне **Добавление веб-ссылки** введите URL-адрес веб-службы со стилем RPC/закодированный, а затем нажмите кнопку **Найти**.
    
4. Нажмите **Добавить ссылку**. 
    
5. Откройте файл ASMX для веб-службы и добавьте один метод веб-службы для вызова каждого метода веб-службы из указанной веб-службы со стилем RPC/закодированный.
    
6. Для просмотра списка методов на веб-сервере со стилем RPC/закодированный следует открыть окно **Представление классов**. Для каждой веб-службы будет отображено три метода. Например, если метод веб-службы называется  `doSearch`, будет выведено три метода с именами  `doSearch`,  `BegindoSearch` и  `EnddoSearch`. Потребуется лишь создать метод оболочки для метода  `doSearch`. Необходимо обеспечить соответствие точной подписи метода и типа возвращаемого значения. 
    
7. В каждом методе оболочки потребуется написать код для вызова веб-службы со стилем RPC/закодированный, на которую добавлена ссылка, как показано в следующем примере. 
    
   ```cs
    [WebMethod] 
    public string[] doSearch(string keyword) 
    { 
        SearchService srch = new SearchService(); 
        return srch.doSearch(keyword); 
    } 
    
   ```

8. Если необходимо выполнить проверку подлинности веб-службы со стилем RPC/закодированный, можно надежно закодировать учетные данные для подключения к веб-службе со стилем RPC/закодированный в исходном коде для прокси-веб-службы .NET, либо воспользоваться кодом, как в следующем примере. 
    
   ```cs
    myProxy.Credentials = System.Net.CredentialCache.DefaultCredentials; 
    
   ```

Дополнительные сведения см. в статье "ИНСТРУКЦИЯ: передача текущих учетных данных в веб-службу ASP.NET" базы знаний Майкрософт по адресу http://support.microsoft.com/.
    
## <a name="creating-a-proxy-web-service-without-visual-studio-net"></a>Создание прокси-веб-службы без использования Visual Studio .NET

В качестве альтернативы для создания прокси-веб-службы используются средства из комплекта разработки программного обеспечения (SDK) .NET Framework, который можно загрузить с веб-сайта MSDN.
  
С помощью средства языка описания веб-служб (Wsdl.exe) создайте файл кода для прокси-веб-службы. Файл кода можно скомпилировать, воспользовавшись компилятором командной строки C# (csc.exe) или компилятором командной строки Visual Basic .NET (vbc.exe), которые входят в комплект SDK .NET Framework. После того, как средством языка описания веб-служб будет создан файл кода, измените расширение имени файла на ASMX и откройте файл в любом текстовом редакторе. В самую первую строку документа добавьте следующее объявление:
  
```cs
<%@ WebService Language="C#" class="GoogleSearchServiceWrapper" %> 
```

Перейдите в конец файла кода и в веб-службе со стилем RPC/закодированный создайте вызов для каждого метода веб-службы. Далее показан образец кода для веб-службы .NET, которая подключается к веб-службе Google, использующей стиль разработки RPC/закодированный. Для расположения сгенерированного кода wsdl.exe существует заполнитель.
  
```cs
<%@ WebService Language="C#" class="GoogleSearchServiceWrapper" %> 
 
using System; 
using System.Web.Services; 
 
// The auto-generated code from the wsdl.exe tool goes here. 
 
[WebService] 
public class GoogleSearchServiceWrapper : System.Web.Services.WebService  
{ 
    [WebMethod] 
    public System.Byte[] doGetCachedPage(System.String key, System.String url) 
    { 
        GoogleSearchService srch = new GoogleSearchService(); 
        return srch.doGetCachedPage(key, url); 
    } 
 
    [WebMethod] 
    public System.String doSpellingSuggestion(System.String key, System.String phrase) 
    { 
        GoogleSearchService srch = new GoogleSearchService(); 
        return srch.doSpellingSuggestion(key, phrase); 
    } 
 
    [WebMethod] 
    public GoogleSearchResult doGoogleSearch(System.String key, 
      System.String q, 
      System.Int32 start, 
      System.Int32 maxResults, 
      System.Boolean filter, 
      System.String restrict, 
      System.Boolean safeSearch, 
      System.String lr, 
      System.String ie, 
      System.String oe) 
    {
        GoogleSearchService srch = new GoogleSearchService();
           return srch.doGoogleSearch(key, q, start, maxResults, 
               filter, restrict, safeSearch, lr, ie, oe); 
    } 
}
```



---
title: Цифровая подпись данных в формах InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7b396d9f-9a47-3170-367f-5d1f0144f927
description: "Цифровая подпись \x97 это электронная, зашифрованная и защищенная отметка проверки подлинности в макросе документа. Допустимая цифровая подпись подтверждает, что данные получены от подписавшего и они не были изменены с момента подписи. Если документы или определенные данные подписываются, вычисляется подпись и затем добавляется в документ. Таким образом подписи всегда перемещаются с подписанными данными."
ms.openlocfilehash: 6c1f5a1c14c15bc88839dc44d9a5a595d8b52893
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425101"
---
# <a name="digitally-signing-data-in-infopath-forms"></a>Цифровая подпись данных в формах InfoPath

Цифровая подпись  это электронная, зашифрованная и защищенная отметка проверки подлинности в макросе документа. Допустимая цифровая подпись подтверждает, что данные получены от подписавшего и они не были изменены с момента подписи. Если документы или определенные данные подписываются, вычисляется подпись и затем добавляется в документ. Таким образом подписи всегда перемещаются с подписанными данными.
  
Чтобы подписать данные, пользователи должны запросить сертификат в центре сертификации, а затем использовать его для создания цифровых подписей. Центр сертификации управляет жизненным циклом сертификатов и ключей (открытых и закрытых), необходимых для шифрования данных и создания подписи.
  
Последующие пользователи документа должны будут проверить существующие подписи и в зависимости от результатов проверки могут добавить собственную подпись. Для точной проверки пользователь должен доверять центру сертификации, выдавшему сертификат, используемый для первоначального подписывания документа.
  
Цифровые подписи XML предназначены для транзакций XML-документов и данных. XML-подписи можно использовать только для определенных данных в XML-документе.
  
## <a name="types-of-digital-signatures-in-infopath-forms"></a>Типы цифровых подписей в формах InfoPath

В Microsoft InfoPath реализованы цифровые подписи, помогающие защитить данные в формах InfoPath. В InfoPath есть два вида цифровых подписей:
  
- Цифровые подписи, обеспечивающие целостность данных и подлинность шаблона формы (XSN-файла).
    
- Цифровые подписи, обеспечивающие целостность, подлинность данных и поддерживающие неотрекаемые сведения, связанные с данными в формах XML.
    
Первая категория подписей предназначена для шаблонов форм (XSN-файл), а вторая категория  для данных, вводимых пользователями и хранимыми в файлах формы InfoPath (XML-файлы). Создатель формы может позволить пользователям применять цифровые подписи для всей формы или для ее частей. Есть значительные различия между подписанным шаблоном и подписанной формой. Хотя в этом документе упоминаются подписанные шаблоны (как другой способ создания формы, которая выполняется как полностью доверенная форма), здесь нет подробного описания этого вида подписывания. Дополнительные сведения о подписывании шаблонов форм см. в разделе [Развертывание шаблонов подписанной формы InfoPath](deploying-signed-infopath-form-templates.md) Этот раздел посвящен использованию подписанных XML-форм InfoPath. Цифровые подписи, созданные InfoPath для подписи данных в XML-формах, соответствуют стандарту цифровых подписей W3C XML. 
  
## <a name="digital-signatures-features"></a>Функции цифровых подписей

InfoPath предлагает расширенные функции цифровых подписей, позволяющие разработчикам шаблонов создавать гибкие формы с применением подписей ко всей форме или только к определенным данным формы. При применении цифровой подписи ко всей форме всегда создаются подписи других сторон для формы как сущности, подписывание частей форм InfoPath позволяет более гибко выбирать соотношение между подписями, добавляемыми к одному набору данных: допустимы параллельные подписи, подписи других сторон или только одна подпись.
  
С подписью InfoPath также добавляет определенные неотрекаемые сведения для определения данных, которые пользователи увидят в текущем представлении, а также время и другие параметры среды, заданные при создании подписи. Неотрекаемые сведения можно изменить, но в соответствующем диалоговом окне отображаются только данные в узлах неотрекаемых сведений по умолчанию.
  
Чтобы добавить подпись, пользователи должны выбрать набор подписываемых данных. Набор данных, который можно подписать, определяется создателем шаблона формы и используется для подписи данных при заполнении формы. Для каждой подписи пользователи должны выполнить инструкции мастера цифровых подписей для выбора подписываемых данных и сертификата, добавления комментариев, утверждения и применения подписи к форме.
  
Когда пользователь наводит указатель мыши на элемент управления с подписанными данными, InfoPath отображает визуальное подтверждение того, что данные подписаны и их нельзя изменить. Создатели шаблонов форм могут отображать подписи в представлении с подписанными данными, чтобы иметь быстрый доступ к неотрекаемым сведениям.
  
## <a name="programmatic-support-for-digital-signatures"></a>Программная поддержка цифровых подписей

В объектную модель InfoPath включена поддержка цифровых подписей, что позволяет разработчикам программными средствами получать доступ к наборам подписанных данных, заданных в форме, с помощью класса [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) , к подписям каждого набора подписанных данных с помощью класса [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) и к сертификату, использованному для создания подписи, с помощью класса [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) . Кроме того, обработчик события [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) можно изменять в полностью доверенных формах, что дает дополнительные возможности обработки цифровых подписей в формах InfoPath. 
  
## <a name="interoperability"></a>Взаимодействие

Инфраструктура цифровых подписей в InfoPath создана с использованием системы цифровых подписей MSXML5, поэтому цифровые подписи InfoPath могут взаимодействовать с подписями MSXML5.
  
Подписанные формы InfoPath и цифровые подписи, созданные в InfoPath, также взаимодействуют с цифровыми подписями, созданными с помощью платформы Microsoft .NET Framework (начиная с версии 1.1). Приложения, использующие классы проверки подписей платформы .NET Framework, могут проверить подписи, созданные в InfoPath. Подписи, созданные для данных, размещенных в формах InfoPath приложениями, которые созданы с использованием классов проверки подписей платформы .NET Framework, успешно проверяются механизмом проверки цифровых подписей InfoPath.
  
## <a name="see-also"></a>См. также



[Работа с цифровыми подписями](how-to-work-with-digital-signatures.md)


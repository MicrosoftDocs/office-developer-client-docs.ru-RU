---
title: Цифровая подпись данных в формах InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7b396d9f-9a47-3170-367f-5d1f0144f927
description: "Цифровая подпись \x97 это электронная, зашифрованная и защищенная отметка проверки подлинности в макросе документа. Допустимая цифровая подпись подтверждает, что данные получены от подписавшего и они не были изменены с момента подписи. Если документы или определенные данные подписываются, вычисляется подпись и затем добавляется в документ. Таким образом подписи всегда перемещаются с подписанными данными."
ms.openlocfilehash: 6c1f5a1c14c15bc88839dc44d9a5a595d8b52893
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300247"
---
# <a name="digitally-signing-data-in-infopath-forms"></a><span data-ttu-id="b7b0b-106">Цифровая подпись данных в формах InfoPath</span><span class="sxs-lookup"><span data-stu-id="b7b0b-106">Digitally Signing Data in InfoPath Forms</span></span>

<span data-ttu-id="b7b0b-p102">Цифровая подпись  это электронная, зашифрованная и защищенная отметка проверки подлинности в макросе документа. Допустимая цифровая подпись подтверждает, что данные получены от подписавшего и они не были изменены с момента подписи. Если документы или определенные данные подписываются, вычисляется подпись и затем добавляется в документ. Таким образом подписи всегда перемещаются с подписанными данными.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p102">A digital signature is an electronic, encryption-based, secure stamp of authentication on a macro or document. A valid digital signature confirms that the data originated from the signer and has not been altered since it was signed. When documents or certain data in the documents are signed, the signature is computed and added to the document. This way, the signatures will always travel with the signed data.</span></span>
  
<span data-ttu-id="b7b0b-p103">Чтобы подписать данные, пользователи должны запросить сертификат в центре сертификации, а затем использовать его для создания цифровых подписей. Центр сертификации управляет жизненным циклом сертификатов и ключей (открытых и закрытых), необходимых для шифрования данных и создания подписи.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p103">In order to sign data, users need to request a certificate from a certificate authority, and then use it to create digital signatures. The certificate authority will manage the life cycle of the certificates and keys (public or private) needed to encrypt data and create the signature.</span></span>
  
<span data-ttu-id="b7b0b-p104">Последующие пользователи документа должны будут проверить существующие подписи и в зависимости от результатов проверки могут добавить собственную подпись. Для точной проверки пользователь должен доверять центру сертификации, выдавшему сертификат, используемый для первоначального подписывания документа.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p104">Subsequent users of the document will have to verify existing signatures, and according to the result of the verification, may add their own contribution and sign. For accurate verification results, the verifier must trust the certificate authority who issued the certificate that was used to originally sign the document.</span></span>
  
<span data-ttu-id="b7b0b-p105">Цифровые подписи XML предназначены для транзакций XML-документов и данных. XML-подписи можно использовать только для определенных данных в XML-документе.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p105">XML digital signatures are designed for transactions that involve XML documents and data. The power of XML signatures stays in the ability to sign only specific data in an XML document.</span></span>
  
## <a name="types-of-digital-signatures-in-infopath-forms"></a><span data-ttu-id="b7b0b-117">Типы цифровых подписей в формах InfoPath</span><span class="sxs-lookup"><span data-stu-id="b7b0b-117">Types of Digital Signatures in InfoPath Forms</span></span>

<span data-ttu-id="b7b0b-p106">В Microsoft InfoPath реализованы цифровые подписи, помогающие защитить данные в формах InfoPath. В InfoPath есть два вида цифровых подписей:</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p106">Microsoft InfoPath implements digital signatures to help secure data in InfoPath forms. Two kinds of digital signatures are featured in InfoPath:</span></span>
  
- <span data-ttu-id="b7b0b-120">Цифровые подписи, обеспечивающие целостность данных и подлинность шаблона формы (XSN-файла).</span><span class="sxs-lookup"><span data-stu-id="b7b0b-120">Digital signatures that ensure the data integrity and authenticity of the form template (.xsn file)</span></span>
    
- <span data-ttu-id="b7b0b-121">Цифровые подписи, обеспечивающие целостность, подлинность данных и поддерживающие неотрекаемые сведения, связанные с данными в формах XML.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-121">Digital signatures that ensure the integrity, authenticity, and support for non-repudiation related to data in XML forms</span></span>
    
<span data-ttu-id="b7b0b-p107">Первая категория подписей предназначена для шаблонов форм (XSN-файл), а вторая категория  для данных, вводимых пользователями и хранимыми в файлах формы InfoPath (XML-файлы). Создатель формы может позволить пользователям применять цифровые подписи для всей формы или для ее частей. Есть значительные различия между подписанным шаблоном и подписанной формой. Хотя в этом документе упоминаются подписанные шаблоны (как другой способ создания формы, которая выполняется как полностью доверенная форма), здесь нет подробного описания этого вида подписывания. Дополнительные сведения о подписывании шаблонов форм см. в разделе [Развертывание шаблонов подписанной формы InfoPath](deploying-signed-infopath-form-templates.md) Этот раздел посвящен использованию подписанных XML-форм InfoPath. Цифровые подписи, созданные InfoPath для подписи данных в XML-формах, соответствуют стандарту цифровых подписей W3C XML.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p107">Whereas the first category of signatures is targeting the form template (.xsn file), the second category targets the actual user-entered data in InfoPath form files (.xml files), where the form designer can enable users to create digital signatures for the whole form or for sections of the form. There are fundamental differences between a signed template and a signed form. Although this document will have some references to signed templates (as an alternative way to create a form that will run as fully trusted), it does not provide details about this kind of signing. For more information about how to sign form templates, see [Deploying Signed InfoPath Form Templates](deploying-signed-infopath-form-templates.md) The focus in this topic is using signed InfoPath XML forms. Digital signatures created by InfoPath to sign data in XML forms comply with W3C XML Digital Signatures specifications.</span></span> 
  
## <a name="digital-signatures-features"></a><span data-ttu-id="b7b0b-127">Функции цифровых подписей</span><span class="sxs-lookup"><span data-stu-id="b7b0b-127">Digital Signatures Features</span></span>

<span data-ttu-id="b7b0b-p108">InfoPath предлагает расширенные функции цифровых подписей, позволяющие разработчикам шаблонов создавать гибкие формы с применением подписей ко всей форме или только к определенным данным формы. При применении цифровой подписи ко всей форме всегда создаются подписи других сторон для формы как сущности, подписывание частей форм InfoPath позволяет более гибко выбирать соотношение между подписями, добавляемыми к одному набору данных: допустимы параллельные подписи, подписи других сторон или только одна подпись.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p108">InfoPath offers an extended digital signatures feature, with template developers being able to design flexible forms that enable digital signatures either for the whole form or for specific data in the form. Whereas digitally signing the whole form will always create counter-signatures for the form as an entity, signing parts of InfoPath forms enables more flexibility in choosing the kind of relationship between signatures added to the same set of data: there can be co-signatures, counter-signatures, or only one signature allowed.</span></span>
  
<span data-ttu-id="b7b0b-p109">С подписью InfoPath также добавляет определенные неотрекаемые сведения для определения данных, которые пользователи увидят в текущем представлении, а также время и другие параметры среды, заданные при создании подписи. Неотрекаемые сведения можно изменить, но в соответствующем диалоговом окне отображаются только данные в узлах неотрекаемых сведений по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p109">With the signature, InfoPath will also add by default some non-repudiation information to identify the data users have seen in the current view, as well as the time and other environment settings as they were set when the signature was created. The non-repudiation information can be customized, but only the data in default non-repudiation nodes will be displayed in the non-repudiation dialog.</span></span>
  
<span data-ttu-id="b7b0b-p110">Чтобы добавить подпись, пользователи должны выбрать набор подписываемых данных. Набор данных, который можно подписать, определяется создателем шаблона формы и используется для подписи данных при заполнении формы. Для каждой подписи пользователи должны выполнить инструкции мастера цифровых подписей для выбора подписываемых данных и сертификата, добавления комментариев, утверждения и применения подписи к форме.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p110">In order to add a signature, users have to select the set of data that will be signed. The set of data that can be signed is defined by the form template designer and used to sign the data when filling out the form. For each signature, users will have to follow a digital signature wizard for selecting the set of signable data, selecting a certificate, adding comments, and approving and committing the signature to the form.</span></span>
  
<span data-ttu-id="b7b0b-p111">Когда пользователь наводит указатель мыши на элемент управления с подписанными данными, InfoPath отображает визуальное подтверждение того, что данные подписаны и их нельзя изменить. Создатели шаблонов форм могут отображать подписи в представлении с подписанными данными, чтобы иметь быстрый доступ к неотрекаемым сведениям.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p111">When a user rests the mouse over a control that contains signed data, InfoPath displays a visual indication that the data is signed and cannot be changed. Form template designers can choose to have the signatures displayed in the view with the signed data so that users can take advantage of easy access to the non-repudiation information.</span></span>
  
## <a name="programmatic-support-for-digital-signatures"></a><span data-ttu-id="b7b0b-137">Программная поддержка цифровых подписей</span><span class="sxs-lookup"><span data-stu-id="b7b0b-137">Programmatic Support for Digital Signatures</span></span>

<span data-ttu-id="b7b0b-p112">В объектную модель InfoPath включена поддержка цифровых подписей, что позволяет разработчикам программными средствами получать доступ к наборам подписанных данных, заданных в форме, с помощью класса [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) , к подписям каждого набора подписанных данных с помощью класса [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) и к сертификату, использованному для создания подписи, с помощью класса [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) . Кроме того, обработчик события [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) можно изменять в полностью доверенных формах, что дает дополнительные возможности обработки цифровых подписей в формах InfoPath.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p112">The InfoPath object model includes support for digital signatures, which enables developers programmatic access to the sets of signable data are defined in the form through the [SignedDataBlockCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignedDataBlockCollection.aspx) class, to the signatures assigned to each set of signed data through the [SignatureCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignatureCollection.aspx) class, and to the certificate that is used to create a signature through the [Certificate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Certificate.aspx) class. Additionally, the [Sign](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) event handler is customizable in fully trusted forms, offering support for advanced processing of digital signatures in InfoPath forms.</span></span> 
  
## <a name="interoperability"></a><span data-ttu-id="b7b0b-140">Взаимодействие</span><span class="sxs-lookup"><span data-stu-id="b7b0b-140">Interoperability</span></span>

<span data-ttu-id="b7b0b-141">Инфраструктура цифровых подписей в InfoPath создана с использованием системы цифровых подписей MSXML5, поэтому цифровые подписи InfoPath могут взаимодействовать с подписями MSXML5.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-141">The infrastructure for digital signatures in InfoPath was designed by using the digital signatures support in MSXML5 so that InfoPath digital signatures have full interoperability with MSXML5 digital signatures.</span></span>
  
<span data-ttu-id="b7b0b-p113">Подписанные формы InfoPath и цифровые подписи, созданные в InfoPath, также взаимодействуют с цифровыми подписями, созданными с помощью платформы Microsoft .NET Framework (начиная с версии 1.1). Приложения, использующие классы проверки подписей платформы .NET Framework, могут проверить подписи, созданные в InfoPath. Подписи, созданные для данных, размещенных в формах InfoPath приложениями, которые созданы с использованием классов проверки подписей платформы .NET Framework, успешно проверяются механизмом проверки цифровых подписей InfoPath.</span><span class="sxs-lookup"><span data-stu-id="b7b0b-p113">Signed InfoPath forms and digital signatures created by InfoPath will also provide full interoperability with digital signatures created by using the Microsoft .NET Framework (starting with version 1.1). Signatures created by InfoPath can be verified by applications that use .NET Framework signature verification classes. Signatures created for data hosted in InfoPath forms by applications designed using .NET Framework digital signatures classes are successfully verified by InfoPath's digital signatures mechanism.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="b7b0b-145">См. также</span><span class="sxs-lookup"><span data-stu-id="b7b0b-145">See also</span></span>



[<span data-ttu-id="b7b0b-146">Работать с цифровыми подписями</span><span class="sxs-lookup"><span data-stu-id="b7b0b-146">Work with Digital Signatures</span></span>](how-to-work-with-digital-signatures.md)


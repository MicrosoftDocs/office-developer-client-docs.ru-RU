---
title: Предварительный просмотр и отлаживка шаблонов форм InfoPath с кодом
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- previewing form templates [infopath 2007],debugging form templates [InfoPath 2007],form templates [InfoPath 2007], previewing,debugging [InfoPath 2007], managed-code form templates,form templates [InfoPath 2007], debugging,InfoPath 2007, debugging form templates,InfoPath 2007, previewing form templates
localization_priority: Normal
ms.assetid: c8387f1c-b34c-490e-8bf9-d824bf98d826
description: Приложение Microsoft InfoPath с набором Visual Studio 2012 позволяет выполнять отладку путем запуска кода формы в режиме просмотра. При начале отладки кода формы проект компилируется, и приложение InfoPath отображает форму в окне просмотра InfoPath. Когда встречается строка кода, на которой установлена точка останова, фокус переносится на редактор кода. При продолжении выполнения после точки останова фокус смещается обратно на окно просмотра. При закрытии окна просмотра отладка останавливается.
ms.openlocfilehash: 8f9ff97fdd5b4b016d96129304fa6f994d7b4561
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405242"
---
# <a name="preview-and-debug-infopath-form-templates-with-code"></a>Предварительный просмотр и отлаживка шаблонов форм InfoPath с кодом

Приложение Microsoft InfoPath с набором Visual Studio 2012 позволяет выполнять отладку путем запуска кода формы в режиме просмотра. При начале отладки кода формы проект компилируется, и приложение InfoPath отображает форму в окне просмотра InfoPath. Когда встречается строка кода, на которой установлена точка останова, фокус переносится на редактор кода. При продолжении выполнения после точки останова фокус смещается обратно на окно просмотра. При закрытии окна просмотра отладка останавливается.
  
Также можно изменить параметры шаблона формы для просмотра и отладки с помощью указанной роли пользователя, файла образца данных или путем указания домена для публикации формы. 
  
> [!NOTE]
> Отламывать шаблоны форм после их развертывания во время запуска с Visual Studio 2012 г. невозможно. Это включает шаблоны форм, совместимые только с InfoPath, а также шаблоны, совместимые с InfoPath и веб-браузером с InfoPath Forms Services. Однако при необходимости можно заносить значения в поле из кода во время выполнения в целях отладки бизнес-логики шаблона формы. Сведения о том, как это сделать, см. в [журнале Log Values to a Field for Debugging.](how-to-log-values-to-a-field-for-debugging.md) 
  
## <a name="debugging-in-preview-mode"></a>Отладка в режиме просмотра

### <a name="to-debug-an-infopath-project-in-preview-mode"></a>Отладка проекта InfoPath в режиме просмотра

1. Создайте или откройте шаблон формы InfoPath с управляемым кодом в наборе Visual Studio 2012.
    
2. Задайте одну или несколько точек останова в коде формы с помощью редактора кода, щелкнув серую полоску слева от строки кода, где требуется вставить точку останова.
    
    Отобразится красный кружок, а строка кода будет выделена, указывая, что при запуске кода формы возникнет пауза в этой точке останова.
    
3. В меню **Отладка** выберите пункт **Начать отладку** или нажмите клавишу F5.
    
    Проект скомпилируется, и в окне просмотра отобразится форма.
    
4. Выполняйте форму до тех пор, пока не встретится строка кода, содержащая точку останова.
    
    Фокус сместится на редактор кода.
    
5. В меню **Отладка** выберите пункт **Продолжить** или нажмите клавишу F5.
    
6. По завершении отладки закройте окно просмотра или выберите пункт **Остановить отладку** в меню **Отладка**.
    
> [!NOTE]
> Чтобы отлаживать шаблон управляемых форм кода InfoPath при использовании участника объектной модели, требуемой полного доверия, необходимо настроить шаблон формы, описанный в шаблонах Preview и [Debug Form Templates,](how-to-preview-and-debug-form-templates-that-require-full-trust.md)которые требуют полного доверия. 
  
## <a name="using-a-sample-data-file"></a>Использование файла образца данных

По умолчанию при отладке и просмотре используется файл template.xml, который создается при создании шаблона формы. Можно создать собственный файл данных и указать его использование при просмотре и отладке, воспользовавшись одной из следующих процедур.  
  
### <a name="to-specify-a-sample-data-file-to-use-while-debugging-or-previewing-in-visual-studio-tools-for-applications"></a>Указание файла образца данных для использования при отладке и просмотре в наборе средств Visual Studio Tools для работы с приложениями

1. Чтобы просмотреть файл template.xml, откройте шаблон формы в режиме конструктора InfoPath.
    
2. Перейдите на вкладку **Файл**, выберите **Сохранение**, щелкните **Сохранить шаблон формы как** и выберите **Исходные файлы**.
    
3. Сохраните файлы шаблона формы в папку, а затем откройте файл template.xml в текстовом редакторе.
    
4. Создайте и сохраните файл с той же структурой, что и template.xml, и с образцом данных, который требуется использовать.
    
5. Перейдите на вкладку **Файл** и выберите пункт **Параметры формы** на вкладке **Сведения**. 
    
6. Выберите категорию **Просмотр** в диалоговом окне **Параметры формы**, а затем в разделе **Образец данных** укажите файл образца данных, созданный в поле **Расположение файла**. 
    
## <a name="specifying-a-user-role-to-use-while-debugging-or-previewing"></a>Указание роли пользователя для использования при отладке и просмотре

Если для формы, с которой осуществляется работа, определены роли пользователей, то можно указать роль пользователя для использования при отладке и просмотре формы. Сведения об определении ролей пользователей см. в справке InfoPath по строке поиска "роль пользователя".
  
> [!NOTE]
> [!Примечание] Параметр, указывающий роль пользователя, недоступен, если для шаблона форм задана совместимость **Форма веб-браузера**. Роли пользователей не поддерживаются шаблонами форм, открытыми в браузерах из служб форм InfoPath. 
  
### <a name="to-specify-a-role-to-use-while-debugging-or-previewing"></a>Указание роли, используемой при отладке и просмотре

1. Если работа осуществляется в наборе Visual Studio 2012 переключитесь на InfoPath.
    
2. Перейдите на вкладку **Файл** и выберите пункт **Параметры формы** на вкладке **Сведения**. 
    
3. Выберите категорию **Просмотр** в диалоговом окне **Параметры формы**, а затем укажите роль пользователя для использования в раскрывающемся списке **Роль для предварительного просмотра**. 
    
## <a name="specifying-a-domain-to-use-while-debugging-or-previewing"></a>Указание домена для использования при отладке и просмотре

Существует возможность просмотреть форму, как если бы она была опубликована на конкретном домене. Этот параметр применяется только в том случае, если уровень безопасности для шаблона формы явно установлен на значение **Домен**.
  
### <a name="to-specify-a-domain-to-use-while-debugging-or-previewing"></a>Указание домена, используемого при отладке и просмотре

1. Если работа осуществляется в наборе Visual Studio 2012 переключитесь на InfoPath.
    
2. Перейдите на вкладку **Файл** и выберите пункт **Параметры формы** на вкладке **Сведения**. 
    
3. Выберите категорию **Просмотр** в диалоговом окне **Параметры формы**, а затем в поле **Домен** укажите домен для использования при просмотре и отладке. 
    
4. Выберите в диалоговом окне **Параметры формы** категорию **Безопасность и доверие**, снимите флажок **Автоматически определять уровень безопасности**, а затем щелкните **Домен**.
    


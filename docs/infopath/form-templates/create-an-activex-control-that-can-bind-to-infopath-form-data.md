---
title: Создание элемента управления ActiveX, который можно прикрепить к данным формы InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: a0d62047-bf08-9f70-de00-7f81ef1331f1
description: В формах InfoPath, предназначенных для открытия в редакторе InfoPath, разработчики могут размещать элементы управления ActiveX. Такие элементы управления могут уже существовать (при этом применяются некоторые ограничения) или могут создаваться специально для InfoPath.
ms.openlocfilehash: 90378533a7c3cde4a1927753c0325fdd8d0b3ce5
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807479"
---
# <a name="create-an-activex-control-that-can-bind-to-infopath-form-data"></a>Создание элемента управления ActiveX, который можно прикрепить к данным формы InfoPath

В формах InfoPath, предназначенных для открытия в редакторе InfoPath, разработчики могут размещать элементы управления ActiveX. Такие элементы управления могут уже существовать (при этом применяются некоторые ограничения) или могут создаваться специально для InfoPath.
  
## <a name="write-an-activex-control"></a>Создание элемента управления ActiveX

Как и в случае с другими элементами управления InfoPath, элементы управления ActiveX должны поддерживать существующие интерфейсы модели COM:
  
- **IDispatch**
    
- **IPersistPropertyBag**
    
- **Программу**
    
- **IPropertyPage**
    
- **IObjectSafety**
    
- **IPropertyNotifySink**
    
- **IViewObject**
    
- **IOleObject**
    
- **IOleInPlaceObject**
    
Для обновления свойств модели DOM при изменении ими элемента управления в InfoPath этот элемент должен реализовывать следующие интерфейсы:
  
- **IConnectionPointContainer**
    
- **IEnumConnectionPoints**
    
- **IConnectionPoint**
    
- **IEnumConnections**
    
Кроме того, существует два интерфейса COM для InfoPath, обеспечивающие более тесную интеграцию элементов управления:
  
- [IInfoPathControl](http://msdn.microsoft.com/en-us/library/bb264625.aspx)
    
- [IInfoPathControlSite](http://msdn.microsoft.com/en-us/library/bb264627.aspx)
    
## <a name="add-an-activex-control-to-the-infopath-design-environment"></a>Добавление элемента управления ActiveX в среду разработки InfoPath

Команда **Добавление или удаление пользовательских элементов управления** в области задач **Элементы управления** позволяет использовать **мастер добавления пользовательских элементов управления** для добавления таких элементов. Мастер позволяет выбрать уже зарегистрированный элемент управления ActiveX или найти дополнительные пользовательские элементы управления на сайте Office Marketplace. После выбора элемента управления можно указать следующие элементы: 
  
- Укажите CAB-файл для установки элемента управления ActiveX с шаблоном формы.
    
- Укажите свойство привязки, чтобы выполнить привязку к XML.
    
- Укажите свойство, используемое для включения или отключения элемента управления в зависимости от правил или цифровых подписей. Например, это полезно в том случае, если XML отсутствует или используется условное форматирование.
    
- Укажите привязку типа данных.
    
> [!NOTE]
> [!Примечание] Если разрабатываемый элемент управления ActiveX добавлен в область задач **Элементы управления** в InfoPath, то повторное создание элемента управления ActiveX будет невозможно до закрытия InfoPath. 
  
## <a name="deploy-an-activex-control"></a>Развертывание элемента управления ActiveX

Чтобы распространить элемент управления ActiveX, можно создать установщик, который устанавливает элемент управления на целевом компьютере и копирует ICT-файл шаблона InfoPath вместе с CAB-файлом в папку пользователя \Users\\<username\>\AppData\Local\Microsoft\InfoPath\Controls. Обратите внимание на то, что при работе нескольких разработчиков над формами, использующими элементы управления ActiveX, каждый разработчик должен иметь элементы, добавленные в среду разработки InfoPath. В противном случае изменение свойств элементов управления из InfoPath будет невозможно.
  
## <a name="see-also"></a>См. также



Лаборатория 6: Добавление элементов управления ActiveX в InfoPath 2003
  
[Создание пользовательского элемента управления InfoPath с помощью C# и .NET (блог команды разработчиков InfoPath) (Возможно, на английском языке)](http://blogs.msdn.com/infopath/archive/2005/04/15/creating-an-infopath-custom-control-using-c-and-net.aspx)


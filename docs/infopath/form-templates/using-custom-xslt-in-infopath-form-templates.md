---
title: Использование пользовательского XSLT-кода в шаблонах форм InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 32c80bcd-a5d6-af32-38ba-9ca9ff148b99
description: Большинство элементов представления, необходимых в конструкторе форм Microsoft InfoPath, может быть создано пользователем. Если необходим пользовательский элемент представления, который не может создать InfoPath, можно вручную изменить преобразование XSL (XSLT), используемое InfoPath для создания представления. Чтобы сделать это, извлеките форму в соответствующие файлы компонентов при помощи команды Экспортировать исходные файлы на вкладке Опубликовать приложения Microsoft Office Backstage, далее измените преобразование в предпочитаемом редакторе XML, например Microsoft Visual Studio или Блокноте.
ms.openlocfilehash: a61980191dbedeec33b06ad8173ce50126fea781
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32299905"
---
# <a name="using-custom-xslt-in-infopath-form-templates"></a>Использование пользовательского XSLT-кода в шаблонах форм InfoPath

Большинство элементов представления, необходимых в конструкторе форм Microsoft InfoPath, может быть создано пользователем. Если необходим пользовательский элемент представления, который не может создать InfoPath, можно вручную изменить преобразование XSL (XSLT), используемое InfoPath для создания представления. Чтобы сделать это, извлеките форму в соответствующие файлы компонентов при помощи команды **Экспортировать исходные файлы** на вкладке **Опубликовать** приложения Microsoft Office Backstage, далее измените преобразование в предпочитаемом редакторе XML, например Microsoft Visual Studio или Блокноте. 
  
Если изменить преобразования представлений вне InfoPath, а затем открыть представление в режиме конструктора и внести изменения, InfoPath перезапишет изменения, сделанные вручную. Чтобы приложение InfoPath не перезаписывало сделанные изменения, их необходимо помещать в элемент преобразования  `<xsl:template>` и использовать режим  `xd:preserve` следующим образом: 
  
```XML
<xsl:template match="my:field1" mode="xd:preserve"> 
   <div> 
      The value of field1 is <xsl:value-of select="."/> 
   </div> 
</xsl:template>
```

Чтобы включить шаблон в преобразованный файл, используйте элемент  `<xsl:apply-templates>` в том же режиме  `xd:preserve`: 
  
```XML
<xsl:apply-templates select="my:field1" mode="xd:preserve"/>
```

Элементы и конструкторы, заданные в шаблонах XSL в режиме  `xd:preserve`, не будут отображаться в среде разработки InfoPath. InfoPath будет отмечать настраиваемый раздел элементом управления с надписью **Защитить блок кода** и красной границей. При открытии формы для заполнения пользовательские преобразования XSL применяются и элементы управления **Защитить блок кода** не отображаются. 
  


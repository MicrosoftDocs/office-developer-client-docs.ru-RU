---
title: Дополнительные концепции безопасности форм InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 77425a61-bf33-b3d8-442a-caee48e54a48
description: Модель безопасности Microsoft InfoPath основана на модели безопасности, реализованной в Internet Explorer. Модель безопасности Internet Explorer помогает защитить компьютер от небезопасных операций с помощью зон и уровней безопасности. Работая вместе с моделью безопасности Internet Explorer, InfoPath предоставляет два вида развертывания форм, которые определяют, как форма InfoPath работает в данной модели безопасности.
ms.openlocfilehash: 00b0e306507db19f55059fba91277af1ad1714b9
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303775"
---
# <a name="additional-infopath-form-security-concepts"></a>Дополнительные концепции безопасности форм InfoPath

Модель безопасности Microsoft InfoPath основана на модели безопасности, реализованной в Internet Explorer. Модель безопасности Internet Explorer помогает защитить компьютер от небезопасных операций с помощью зон и уровней безопасности. Работая вместе с моделью безопасности Internet Explorer, InfoPath предоставляет два вида развертывания форм, которые определяют, как форма InfoPath работает в данной модели безопасности.
  
- **Форма на основе URL-адреса** Этот метод развертывания используется по умолчанию при публикации из InfoPath на веб-сервере, в библиотеке форм SharePoint Foundation или файловом хранилище. Эти формы называются формами на основе URL-адреса, так как пользователь обычно открывает форму на URL-адресе, на котором форма опубликована, а URL-адрес указывается в атрибуте **publishUrl** элемента **xDocumentClass** в файле определений формы (XSF). Формы на основе URL-адреса называются песочницами, так как у них ограниченный доступ к системным ресурсам и другие потенциальные области риска. У формы на основе URL-адреса такой же уровень разрешений, как и у веб-страницы, которая открывается там же, где и файл шаблона формы (XSN).
    
- **Формы на основе идентификатора URN** Этот метод развертывания предназначен для форм, которым требуется доступ к системным и другим внешним ресурсам, таким как элементы управления ActiveX и другие программные компоненты. Формы InfoPath можно развертывать как полностью доверенные формы. Такие формы также известны как Формы на основе идентификатора URN, потому что вместо указания атрибута **publishUrl** они указывают универсальное имя ресурса (URN) в атрибуте **name** элемента **xDocumentClass** в файле определений формы (XSF). Этот класс форм может запрашивать полное доверие, если значение атрибута **requireFullTrust** элемента **xDocumentClass** в в файле определений формы (XSF) равно  `"yes"`. Формы на основе идентификатора URN нужно регистрировать на клиентском компьютере с помощью программы или скрипта установки. В этом случае форма получает те же разрешения, что и приложение, выполняемое на локальном компьютере. 
    
В сочетании с этими двумя методами развертывания каждый метод и свойство объектной модели InfoPath получает уровень безопасности, управляющий тем, когда этот метод или свойство можно вызывать из скрипта, который выполняется в форме.
  
## <a name="understanding-infopath-integration-with-the-internet-explorer-security-model"></a>Общие сведения об интеграции InfoPath с моделью безопасности Internet Explorer

В Internet Explorer реализованы зоны безопасности, позволяющие управлять уровнем доступа, предоставляемого компьютеру открываемыми веб-страницами. InfoPath использует некоторые из этих зон для определения уровня доступа к ресурсам компьютера, которые получают формы. По умолчанию формы InfoPath выполняются в кэшированном местоположении, у которого нет доступа к критическим системным ресурсам. Формы с полным доступом к системным ресурсам называются полностью доверенными формами. Полностью доверенные формы обычно устанавливаются и регистрируются с помощью программы или скрипта установки, или же они могут иметь цифровую подпись, что дает им более высокий уровень разрешений.
  
Кэшированные формы InfoPath определяются по идентификатору URL или URN, который указывается в файле определений формы (XSF). Тип используемой идентификации и домен (местоположение), с которого открывается форма, определяет, разрешения какой зоны безопасности Internet Explorer наследует форма. Формы, идентифицируемые по URL-адресу, кэшируются на компьютере пользователя, что позволяет использовать их автономно. Такие формы на основе URL наследуют разрешения безопасности и права доступа, такие как междоменный доступ, от параметров безопасности Internet Explorer, применяемых к первоначальному местоположению шаблона формы. Шаблоны формы хранятся на веб-сервере или сервере под управлением SharePoint Foundation, которые работают в зоне "Интернет" или "Местная интрасеть" в зависимости от домена сервера. Установленные формы, определяемые по идентификатору URN, с другой стороны, наследуют разрешения от зоны "Локальный компьютер", что дает такой же уровень разрешений, как и у файлов HTML-приложений (HTA).
  
Полностью доверенные формы определяются по идентификатору URN и по тому, равно ли значение атрибута **requireFullTrust** элемента **xDocumentClass** в файле определений формы (XSF)  `"yes"`. В InfoPath полностью доверенные формы после их установки отображаются на вкладке **Создать** области Microsoft Office Backstage редактора InfoPath. 
  
Подробное описание работы полностью доверенных форм, методов их создания и развертывания см. в разделе [Основные сведения о полностью доверенных формах](understanding-fully-trusted-forms.md).
  
## <a name="trusting-installed-forms"></a>Доверие установленным формам

Возможность использования доверенных форм можно включить или выключить для отдельных компьютеров. Если компьютер доверяет установленным формам, пользователи могут заполнять формы, которым необходим доступ к ресурсам их компьютеров.
  
В редакторе InfoPath в Backstage можно настроить параметры компьютера для доверия установленным формам, щелкнув **Параметры**, **Центр управления безопасностью**, **Параметры центра управления безопасностью** и установив флажок **Разрешить запуск полностью доверенных форм на моем компьютере** на вкладке **Доверенные издатели** диалогового окна **Центр управления безопасностью**. 
  
## <a name="using-security-features-in-infopath"></a>Использование возможностей безопасности в InfoPath

Модель безопасности InfoPath помогает защитить пользователей от следующих угроз, которые вызывают вредоносные шаблоны.
  
- Возможность раскрытия конфиденциальной информации с локального компьютера или удаленных источников данных.
    
- Вредоносное использование элементов управления ActiveX.
    
- Вредоносное использование свойств и методов объектной модели InfoPath.
    
## <a name="cross-domain-data-access"></a>Междоменный доступ к данным

Один из сценариев угрозы безопасности называется междоменным доступом к данным.
  
Модель безопасности Internet Explorer, на которой основано приложение InfoPath, предоставляет параметр с названием **Доступ к источникам данных за пределами домена**. По умолчанию этот параметр отключает междоменный доступ к данным для форм InfoPath, которые размещены в зонах безопасности "Интернет" и "Небезопасные сайты". Пользователь выбирает, разрешить или запретить междоменный доступ для форм InfoPath, размещенных в зоне "Местная интрасеть", а для форм InfoPath, размещенных в зонах **Надежные сайты** и **Локальный компьютер**, междоменный доступ включается. 
  
## <a name="use-of-the-infopath-html-task-pane"></a>Использование панели задач HTML приложения InfoPath

Панель задач HTML приложения InfoPath позволяет отрисовывать веб-страницы, такие как HTM-, ASP- и HTA-файлы. Страницы, ссылки на которые указаны на панели задач, могут быть размещены как в шаблоне формы, так и вне него. Единственное ограничение, касающееся того, на что можно ссылаться вне шаблона формы, состоит в том, что веб-страница должна находиться в том же домене, что и шаблон формы, или в зоне безопасности, в которой расположен шаблон, должны быть разрешения для междоменного доступа для загрузки панели задач.
  
Панель задач не отображает строку адреса или состояния, поэтому пользователь не может подтвердить размещение источника панели задач или использование зашифрованного канала (HTTPS). Поэтому следует избегать использования панели задач для отображения или ввода конфиденциальной информации. Панель задач предназначена для отображения динамической справки и элементов управления для перемещения между представлениями и другими элементами решения. Кроме того, бизнес-логика шаблона формы и скрипт в панели задач могут взаимодействовать друг с другом. Однако это взаимодействие разрешено, только если шаблон формы и панель задач расположены в одном домене, что помогает предотвратить передачу данных между доменами.
  
## <a name="cross-domain-data-access-prompts"></a>Запросы междоменного доступа к данным

Если шаблон формы, которому требуется междоменный доступ к данным, расположен в зоне безопасности, для которой включен запрос для междоменного доступа (параметр по умолчанию для зоны "Местная интрасеть"), пользователь получает запрос на разрешение междоменного доступа. Выбор пользователя сохраняется, пока форма открыта. Если нужно выполнить развертывание шаблонов форм InfoPath, которым требуется междоменный доступ к данным, следует выполнить развертывание этих шаблонов в виде полностью доверенных форм или отметить их как доступные на сервере, расположенном в зоне безопасности "Надежные сайты", чтобы пользователь не получал запросы о разрешении доступа. Пользователей следует проинструктировать о снижении уровня безопасности зоны "Местная интрасеть", чтобы отключить эти запросы.
  
## <a name="forms-without-a-publishurl-attribute"></a>Формы без атрибута publishURL

Если InfoPath загружает с локального компьютера шаблон формы с пустым атрибутом **publishUrl** или если этот атрибут отсутствует, форма размещается в более защищенной зоне безопасности. Это выполняется, чтобы уменьшить угрозу распространения вредоносного шаблона форм по электронной почте. В результате, если пользователь сохраняет этот шаблон формы на диск, его нельзя будет выполнить с разрешениями формы, расположенной в зоне **Локальный компьютер**. 
  
## <a name="unsafe-activex-controls"></a>Небезопасные элементы управления ActiveX

Самая распространенная ситуация с использованием вредоносных элементов управления ActiveX возникает, если автор использует скрипт с элементом управления ActiveX, который предоставляет методы для доступа к файловой системе для получения личных файлов и списков паролей, удаления файлов или отключения системы пользователя. Форма InfoPath может использовать элементы управления ActiveX только из скрипта в главном файле скрипта формы (script.js) или скрипта формы на панели задач. InfoPath не разрешает скриптам в представлениях InfoPath выполнять элементы управления ActiveX.
  
Модель безопасности Internet Explorer, на которой основано приложение Microsoft InfoPath, предоставляет параметр **Инициализация и использование элементов управления ActiveX, отмеченных как небезопасные**, который по умолчанию приводит к следующим действиям, если формы или панели задач InfoPath пытаются инициализировать и использовать в скрипте элементы управления ActiveX, отмеченные как небезопасные для скриптов. 
  
|**Зона безопасности/Развертывание**|**Действие**|
|:-----|:-----|
|Интернет  <br/> |Отключено  <br/> |
|Местная интрасеть  <br/> |Отключено  <br/> |
|Небезопасные сайты  <br/> |Отключено  <br/> |
|Надежные сайты  <br/> |Prompt  <br/> |
|Мой компьютер  <br/> |Prompt  <br/> |
|Полностью доверенная форма  <br/> |Включение  <br/> |
   
## <a name="malicious-use-of-the-infopath-object-model"></a>Вредоносное использование объектной модели InfoPath

Как и элементы управления ActiveX, вызываемые в скрипте, методы и свойства InfoPath, вызываемые в коде, могут представлять различные уровни риска. Например, метод [SaveAs(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) класса [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) можно использовать для записи данных в любом месте файловой системы. 
  
Чтобы защититься от вредоносного использования элементов объектной модели InfoPath, в ней реализовано три уровня безопасности, определяющих, как и где можно использовать данный элемент объектной модели. В объектной модели InfoPath есть три уровня безопасности.
  
- **0** Неограниченный доступ к элементам объектной модели. Эти элементы объектной модели безопасны и поэтому доступ к ним неограничен. 
    
- **2** Доступ к этим элементам имеется только у форм, запускаемых на том же домене, что и открытая в настоящий момент форма, или у форм, которым были присвоены разрешения междоменного доступа. Вызов методов объектной модели с уровнем безопасности 2, ограниченным шаблоном формы, будет успешен, только если осуществляется доступ к ресурсам внутри самого шаблона. 
    
- **3** Доступ к этим элементам имеется только у полностью доверенных форм. 
    
- В каждом разделе, описывающем свойства и методы, справочника по объектной модели InfoPath содержится раздел о безопасности, в котором указан уровень безопасности, применяемый к этому элементу объектной модели.
    
- Уровень безопасности **1** зарезервирован для будущего использования. 
    
## <a name="summary"></a>Сводка

В следующей таблице приведена сводка разрешений по умолчанию для всех методов развертывания форм в InfoPath. Разрешения основаны на зоне безопасности домена, в котором расположен шаблон формы.
  
|**Зона безопасности**|**Развертывание**|**Разрешения по умолчанию**|
|:-----|:-----|:-----|
||**На основе URL-адреса** <br/> |**На основе URN** <br/> |**Отметка небезопасности ActiveX для скриптов** <br/> |**Междоменный доступ к данным** <br/> |**Уровень безопасности объектной модели** <br/> |
|Небезопасные сайты  <br/> |Н/Д  <br/> |Н/Д  <br/> |Н/Д  <br/> |Н/Д  <br/> |Н/Д  <br/> |
|Интернет  <br/> |X  <br/> ||Отключение  <br/> |Отключение  <br/> |2  <br/> |
|Местная интрасеть  <br/> |X  <br/> ||Отключение  <br/> |Prompt  <br/> |2  <br/> |
|Надежные сайты  <br/> |X  <br/> ||Prompt  <br/> |Включение  <br/> |2  <br/> |
|Локальный компьютер  <br/> |X  <br/> |X  <br/> |Отключение  <br/> |Prompt  <br/> |2  <br/> |
|Полностью доверенная форма  <br/> |X (подписано надежным издателем)  <br/> |X  <br/> |Включение  <br/> |Включение  <br/> |4  <br/> |
|Полностью доверенная форма  <br/> ||X  <br/> |Включение  <br/> |Включение  <br/> |4  <br/> |
|Restricted  <br/> ||X  <br/> |Нет ActiveX (за исключением ограниченного жестко заданного списка)  <br/> |Отключение  <br/> |2  <br/> |
|Restricted  <br/> |X  <br/> ||Нет ActiveX (за исключением ограниченного жестко заданного списка)  <br/> |Отключение  <br/> |2  <br/> |
|Restricted  <br/> |X  <br/> |X  <br/> |Нет ActiveX (за исключением ограниченного жестко заданного списка)  <br/> |Отключение  <br/> |2  <br/> |
   
Дополнительные сведения об общих рекомендациях по безопасности при разработке форм см. в статье [Рекомендации по безопасности при разработке форм InfoPath](security-guidelines-for-developing-infopath-forms.md).
  
## <a name="understanding-other-security-features"></a>Общие сведения о других возможностях безопасности

InfoPath предоставляет другие меры обеспечения безопасности для форм, в число которых входит защита форм с помощью цифровых подписей, управление определенными операциями с формами, такими как объединение и отправка, а также доверие установленным формам. В следующих разделах описываются эти меры обеспечения безопасности и причины их использования в InfoPath.
  
## <a name="digital-signatures"></a>Цифровые подписи

Данные, содержащиеся в форме, можно подписать с помощью цифровой подписи, чтобы предотвратить изменение содержания формы.
  
Использование цифровых подписей в форме задается выбором параметра **Разрешить подпись всей формы** или **Разрешить подпись частей формы** в разделе **Цифровые подписи** диалогового окна **Параметры формы**, доступного из Microsoft Office Backstage в конструкторе форм InfoPath. При заполнении формы пользователи могут подписать и проверить формы, нажав кнопку **Подписать форму** на вкладке **Сведения** области Microsoft Office Backstage. При повторном открытии формы пользователь будет предупрежден, если содержимое формы было изменено. 
  
-  Цифровые подписи можно применять ко всей форме или к определенным наборам данных в форме, которые можно подписывать отдельно. 
    
- Можно подписать только определенные части формы, а не всю форму.
    
- Можно разрешить одну или несколько подписей. Также можно указать соотношения для подписываемых наборов данных. Например, можно задать, являются ли все подписи параллельными или каждая подпись отменяет действие предыдущих.
    
- Можно использовать объектную модель InfoPath, чтобы программными средствами добавить различные сведения в блок подписи в полностью доверенной форме.
    
- Безопасность цифровых подписей можно улучшить, получив и включив дополнительные сведения, такие как временная отметка, в качестве неотрекаемых доказательств. Так как дополнительное доказательство является частью подписи, его нельзя удалить без нарушения целостности подписи. В любое время можно просмотреть и изучить извлеченные данные, щелкнув цифровую подпись в форме или выбрав ее из списка в диалоговом окне **Цифровые подписи**. 
    
-  Подпись можно вставить и просмотреть в документе, а также увидеть, как она представляется каждому подписавшему. 
    
- В цифровую подпись также включен моментальный снимок представления того, как ее видел подписавший во время подписи формы. Моментальный снимок хранится в виде образа в стандартном PNG-файле с кодировкой base64. 
    
## <a name="email-deployment"></a>Развертывание электронной почты

Вы можете развернуть шаблоны форм в виде вложения в сообщение электронной почты и переместить шаблоны форм из одного расположения в другое. Развертывание по почте  простой и эффективный способ распространения форм для использования внутри организации и доставки форм удаленным пользователям.
  
Можно применить цифровую подпись к созданному шаблону формы, а затем задать его уровень безопасности как "Полное доверие". Кроме того, подписанные полностью доверенные формы при развертывании в виде вложений электронной почты можно легко и эффективно обновлять.
  
В конструкторе InfoPath все формы создаются с идентификаторами. Эти данные идентификации помогают InfoPath сопоставлять формы с шаблонами форм в кэше и загружать обновления форм при их отправке в общую папку. По умолчанию InfoPath создает два идентификатора для шаблонов форм: идентификатор формы и путь для доступа (также известный как атрибут **publishURL**). Дополнительные сведения о развертывании электронной почты можно найти в разделе [уровни безопасности, развертывание электронной почты и удаленные шаблоны форм](security-levels-email-deployment-and-remote-form-templates.md).
  
## <a name="activex-controls"></a>Элементы ActiveX

InfoPath поддерживает размещение элементов управления ActiveX в формах, открытых в редакторе InfoPath. Элементы управления ActiveX могут быть заданы предварительно (с некоторыми ограничениями) или написаны специально для использования с InfoPath. Элементы управления ActiveX, используемые в формах InfoPath, не загружаются автоматически с веб-сайтов. Вместо этого CAB-файлы элементов управления ActiveX, которых еще нет на компьютере пользователя, нужно добавить в файл шаблона формы.
  
Если элемент управления ActiveX используется в форме и он не зарегистрирован на компьютере пользователя, действия при открытии формы зависят от параметров элемента управления ActiveX в форме. Если CAB-файл не включен в файл шаблона формы, InfoPath не откроет форму. Если в файле шаблона есть CAB-файл, InfoPath запустит установку. Чтобы приложение InfoPath установило CAB-файл, он должен быть подписан, а подпись должна принадлежать надежному издателю. Если издателя нет в списке надежных издателей пользователя с сертификатом (цепочка доверия при этом ведет к корню доверенного сертификата), пользователю выдается запрос о принятии или отклонении издателя. Если пользователь решил не доверять издателю, CAB-файл элемента управления не устанавливается и InfoPath не открывает форму.
  
> [!NOTE]
> [!Примечание] Элементы управления ActiveX должны быть отмечены как "Безопасные для скриптов" и "Безопасные для инициализации с небезопасными данными", чтобы использовать их в InfoPath. 
  
## <a name="net-security"></a>Безопасность .NET

Кроме уровней безопасности InfoPath шаблоны форм с управляемым кодом также поддерживают дополнительные возможности защиты доступа к коду, выполняемому в среде CLR платформы Microsoft .NET Framework.
  
Если форма полностью доверенная, она автоматически получает доступ к ресурсам вне шаблона формы. В этом коде бизнес-логики можно использовать любую сборку. Можно настроить набор разрешений, добавляемый в форму шаблона с управляемым кодом, используя средство настройки платформы Microsoft .NET Framework или средство политики безопасности доступа к коду (Caspol.exe). InfoPath выполняет поиск предопределенной группы кода и применяет набор разрешений, заданный для этой группы в домене приложения (AppDomain), куда загружен управляемый код и откуда он выполняется. Следует выполнить развертывание пользовательских политик безопасности .NET на клиентские компьютеры, на которых будет выполняться управляемый код шаблона формы.
  
Учтите, что система безопасности .NET предоставляет набор разрешений "Интернет" только управляемому коду, выполняемому на надежных сайтах Internet Explorer. Поэтому формы InfoPath с управляемым кодом не будут выполняться, если они опубликованы на надежном сайте.
  
## <a name="merging-forms"></a>Объединение форм

Можно отключить объединение форм, чтобы пользователи не могли импортировать данные из нескольких форм в одну.
  
Включить или отключить объединение форм можно с помощью флажка **Включить объединение форм** в разделе **Дополнительно** диалогового окна **Параметры формы**, доступ к которому можно получить на вкладке **Сведения** конструктора Microsoft Office Backstage при разработке формы. Если объединение форм отключено, пользователи не могут щелкнуть **Объединение форм** на вкладке **Общий доступ** конструктора Microsoft Office Backstage при заполнении формы. 
  
## <a name="submitting-forms"></a>Отправка форм

Можно отключить отправку форм, чтобы пользователи не могли отправлять формы.
  
Включить или отключить отправку форм можно с помощью диалогового окна **Параметры отправки**, открыть которое можно, щелкнув **Параметры отправки** в меню **Данные** в режиме конструктора. Если отправка форм отключена, пользователи не могут нажать кнопку **Отправить** на вкладке **Главная** при заполнении формы. 
  


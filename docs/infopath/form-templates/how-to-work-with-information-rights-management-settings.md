---
title: Работать с параметрами управления правами на доступ к данным
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- Управление правами на доступ к данным [InfoPath 2007], InfoPath 2007, управление правами на доступ к данным, IRM [InfoPath 2007]
localization_priority: Normal
ms.assetid: 4ad91898-b23e-4410-8839-a65259e53d37
description: 'Существует два типа параметров управления правами на доступ к данным (IRM), доступных в Microsoft InfoPath: один для защиты доступа к шаблонам форм InfoPath и один для управления доступом к данным формы, которые хранятся в заполненных формах.'
ms.openlocfilehash: 6f7317cfdc4e6bfc89482e813b1670c8b8861a6b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33420012"
---
# <a name="work-with-information-rights-management-settings"></a><span data-ttu-id="6c57c-104">Работать с параметрами управления правами на доступ к данным</span><span class="sxs-lookup"><span data-stu-id="6c57c-104">Work with Information Rights Management Settings</span></span>

<span data-ttu-id="6c57c-105">Существует два типа параметров управления правами на доступ к данным (IRM), доступных в Microsoft InfoPath: один для защиты доступа к шаблонам форм InfoPath и один для управления доступом к данным формы, которые хранятся в заполненных формах.</span><span class="sxs-lookup"><span data-stu-id="6c57c-105">There are two types of Information Rights Management (IRM) settings available in Microsoft InfoPath: one for protecting access to InfoPath form templates, and one for controlling access to and actions on form data contained in completed forms.</span></span>
  
> [!NOTE]
> <span data-ttu-id="6c57c-106">Ограничение разрешений доступно только для шаблонов форм, совместимых с редактором InfoPath.</span><span class="sxs-lookup"><span data-stu-id="6c57c-106">Restricting permission is only available to form templates compatible with the InfoPath editor.</span></span> <span data-ttu-id="6c57c-107">Шаблоны форм, совместимые с веб-браузером, не поддерживают управление правами на доступ к данным.</span><span class="sxs-lookup"><span data-stu-id="6c57c-107">Browser-compatible form templates do not support IRM.</span></span> 
  
## <a name="adding-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="6c57c-108">Добавление команды "Управление учетными данными" на панель быстрого доступа</span><span class="sxs-lookup"><span data-stu-id="6c57c-108">Adding the Manage Credentials Command to the Quick Access Toolbar</span></span>

<span data-ttu-id="6c57c-p102">Команда **Управление учетными данными**, которая использовалась для работы с параметрами управления правами на доступ к данным при разработке шаблона формы, теперь недоступна по умолчанию. Чтобы добавить ее на **Панель быстрого доступа**, выполните следующие операции.</span><span class="sxs-lookup"><span data-stu-id="6c57c-p102">The **Manage Credentials** command used to work with IRM settings when designing a form template is not available by default. Use the following steps to add it to the **Quick Access Toolbar**.</span></span>
  
### <a name="add-the-manage-credentials-command-to-the-quick-access-toolbar"></a><span data-ttu-id="6c57c-111">Добавление команды "Управление учетными данными" на панель быстрого доступа</span><span class="sxs-lookup"><span data-stu-id="6c57c-111">Add the Manage Credentials Command to the Quick Access Toolbar</span></span>

1.  <span data-ttu-id="6c57c-112">Щелкните стрелку в правом углу **Панели быстрого доступа** для вызова меню **Настройка панели быстрого доступа**, а затем выберите **Другие команды**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-112">Click the arrow on the right end of the **Quick Access Toolbar** to pull down the **Customize Quick Access Toolbar** menu, and then click **More Commands**.</span></span>
    
2. <span data-ttu-id="6c57c-113">В списке **Выбрать команды из** выберите **Все команды**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-113">In the **Choose commands from** list, select **All Commands**.</span></span>
    
3. <span data-ttu-id="6c57c-114">Пролистайте список вниз до раздела **Управление учетными данными**, а затем нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-114">Scroll down the list to **Manage Credentials**, and then click **Add**.</span></span>
    
4. <span data-ttu-id="6c57c-115">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-115">Click **OK**.</span></span>
    
<span data-ttu-id="6c57c-116">Дополнительные сведения об использовании команды **Управление учетными данными** и диалогового окна **Разрешения** в InfoPath см. в разделе "Создание шаблона формы с ограниченными разрешениями" справки по InfoPath.</span><span class="sxs-lookup"><span data-stu-id="6c57c-116">For more information about using **Manage Credentials** command and the **Permission** dialog box in InfoPath, see the "Create a Form Template with Restricted Permission" topic in InfoPath help.</span></span> 
  
## <a name="the-irm-object-model"></a><span data-ttu-id="6c57c-117">Объектная модель управления правами на доступ к данным</span><span class="sxs-lookup"><span data-stu-id="6c57c-117">The IRM Object Model</span></span>

<span data-ttu-id="6c57c-118">Используйте класс [разрешений](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) для доступа к параметрам разрешений [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) и IRM, которые можно применить к форме.</span><span class="sxs-lookup"><span data-stu-id="6c57c-118">Use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.aspx) class to access the [UserPermissionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.aspx) and IRM permission settings that can be applied to a form.</span></span> <span data-ttu-id="6c57c-119">Чтобы получить доступ к объекту **Permission** , связанному с шаблоном формы, используйте свойство [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) класса [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6c57c-119">To access the **Permission** object associated with a form template, use the [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Permission.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class.</span></span> <span data-ttu-id="6c57c-120">Возвращаемый объект **Permission** предоставляет доступ к коллекции объектов [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) , связанных с шаблоном формы, и каждого экземпляра формы, созданного с помощью этого шаблона.</span><span class="sxs-lookup"><span data-stu-id="6c57c-120">The returned **Permission** object provides access to the collection of [UserPermission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.aspx) objects associated with the form template and each form instance created with that template.</span></span> 
  
<span data-ttu-id="6c57c-121">Объект **Permission** и его свойства и методы доступны в зависимости от наличия ограничений разрешений для активного шаблона формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-121">The **Permission** object and its properties and methods are available whether permissions are restricted on the active form template or not.</span></span> <span data-ttu-id="6c57c-122">Используйте свойство [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) , чтобы определить, имеет ли форма ограниченные разрешения.</span><span class="sxs-lookup"><span data-stu-id="6c57c-122">Use the [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property to determine whether a form has restricted permissions.</span></span> 
  
<span data-ttu-id="6c57c-123">Ниже перечислены способы включения разрешений для формы с помощью свойств и методов класса "Permission".</span><span class="sxs-lookup"><span data-stu-id="6c57c-123">Permissions on a form are enabled in one of the following ways by using properties and methods of the Permission class:</span></span>
  
<span data-ttu-id="6c57c-124">Для свойства **Enabled** задается значение **true**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-124">The **Enabled** property is set to **true**.</span></span>
  
<span data-ttu-id="6c57c-125">Задано свойство [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6c57c-125">The [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property is set.</span></span> 
  
<span data-ttu-id="6c57c-126">Задано свойство [рекуестпермиссионурл](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6c57c-126">The [RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property is set.</span></span> 
  
<span data-ttu-id="6c57c-127">Для свойства [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) задано значение **true** или **false**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-127">The [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property is set to **true** or **false**.</span></span>
  
<span data-ttu-id="6c57c-128">Вызывается метод [апплиполици](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6c57c-128">The [ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method is called.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="6c57c-129">Если на компьютере пользователя не установлен клиент управления правами Windows, то использование класса **Permission** приводит к появлению исключения.</span><span class="sxs-lookup"><span data-stu-id="6c57c-129">If the Windows Rights Management client is not installed on a user's computer, using the **Permission** class raises an exception.</span></span> 
  
<span data-ttu-id="6c57c-130">Для программной работы с параметрами управления правами на доступ к данным для отдельных пользователей в формах используйте классы **UserPermissionCollection** и **UserPermission**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-130">To work programmatically with IRM settings of individual users in forms, use the **UserPermissionCollection** and **UserPermission** classes.</span></span> 
  
<span data-ttu-id="6c57c-131">Объект **UserPermission** связывает набор разрешений для текущей формы с отдельным пользователем и задает срок действия (необязательно).</span><span class="sxs-lookup"><span data-stu-id="6c57c-131">A **UserPermission** object associates a set of permissions for the current form with a single user and an optional expiration date.</span></span> <span data-ttu-id="6c57c-132">Используйте метод [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) класса **UserPermissionCollection** для добавления и предоставления пользователю набора разрешений для текущей формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-132">Use the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method of the **UserPermissionCollection** class to add and grant a user a set of permissions on the current form.</span></span> <span data-ttu-id="6c57c-133">Используйте метод [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) класса **UserPermissionCollection** , чтобы удалить пользователя и разрешения пользователя.</span><span class="sxs-lookup"><span data-stu-id="6c57c-133">Use the [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method of the **UserPermissionCollection** class to remove a user and the user's permissions.</span></span> <span data-ttu-id="6c57c-134">Хотя некоторые разрешения, предоставляемые через интерфейс пользователя, например для печати и срока действия, применяются ко всем пользователям, можно воспользоваться классами **UserPermission** и **UserPermissionCollection** для назначения их отдельным пользователям с индивидуальными сроками действия.</span><span class="sxs-lookup"><span data-stu-id="6c57c-134">While some permissions granted through the user interface apply to all users, such as printing and expiration date, you can use the **UserPermission** and **UserPermissionCollection** classes to assign them on a per-user basis with per-user expiration dates.</span></span> <span data-ttu-id="6c57c-135">Объектная модель позволяет разработчикам выполнять перечисление параметров разрешений в форме и предоставлять возможности, позволяющие пользователям формы добавлять в форму разрешения без использования области задач **Разрешения для формы** или диалогового окна **Разрешения**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-135">The object model allows developers to enumerate permission settings in a form and to provide functionality that allows form users to add permissions to the form without having to use the **Form Permission** task pane or the **Permission** dialog box.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="6c57c-136">Разрешения нельзя применить, если форма находится в режиме просмотра.</span><span class="sxs-lookup"><span data-stu-id="6c57c-136">Permissions cannot be applied when a form is in preview mode.</span></span> <span data-ttu-id="6c57c-137">Поэтому все свойства класса **Permission** при просмотре формы доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="6c57c-137">For this reason, all of the properties of the **Permission** class are read-only when a form is being previewed.</span></span> <span data-ttu-id="6c57c-138">В режиме просмотра свойство **Enabled** всегда возвращает значение **false**, а при попытке кода изменить это значение возникает исключение **System.Runtime.InteropServices.COMException** и возвращается ошибка "Свойство/метод недоступны в режиме предварительного просмотра".</span><span class="sxs-lookup"><span data-stu-id="6c57c-138">In preview mode, the **Enabled** property will always return **false**, and if code attempts to change this setting, a **System.Runtime.InteropServices.COMException** is raised and the error "The property/method is not available in preview mode" is returned.</span></span> <span data-ttu-id="6c57c-139">Аналогичным образом методы, связанные с классами **UserPermission** и **UserPermissionCollection**, также будут возвращать это сообщение об ошибке при использовании в режиме просмотра.</span><span class="sxs-lookup"><span data-stu-id="6c57c-139">Similarly, the methods associated with the **UserPermission** and **UserPermissionCollection** classes will also return this error message when used in preview mode.</span></span> 
  
### <a name="overview-of-the-permission-class"></a><span data-ttu-id="6c57c-140">Обзор класса "Permission"</span><span class="sxs-lookup"><span data-stu-id="6c57c-140">Overview of the Permission Class</span></span>

<span data-ttu-id="6c57c-141">Класс **UserPermissionCollection** предоставляет указанные ниже свойства и один метод.</span><span class="sxs-lookup"><span data-stu-id="6c57c-141">The **UserPermissionCollection** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="6c57c-142">**Name**</span><span class="sxs-lookup"><span data-stu-id="6c57c-142">**Name**</span></span>|<span data-ttu-id="6c57c-143">**Описание**</span><span class="sxs-lookup"><span data-stu-id="6c57c-143">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c57c-144">Метод [апплиполици](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-144">[ApplyPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.ApplyPolicy.aspx) method</span></span>  <br/> |<span data-ttu-id="6c57c-145">Применяет к форме политику с помощью файла шаблона политики.</span><span class="sxs-lookup"><span data-stu-id="6c57c-145">Applies a policy to the form using a policy template file.</span></span>  <br/> |
|<span data-ttu-id="6c57c-146">Свойство [DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-146">[DocumentAuthor](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.DocumentAuthor.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-147">Получает или задает автора текущей формы в качестве адреса электронной почты.</span><span class="sxs-lookup"><span data-stu-id="6c57c-147">Gets or sets the author of the current form as an email address.</span></span>  <br/> |
|<span data-ttu-id="6c57c-148">Свойство [Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-148">[Enabled](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.Enabled.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-149">Возвращает или задает значение, указывающее, включены ли для текущей формы параметры разрешений, представленные объектом **Permission**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-149">Gets or sets whether the permission settings represented by the **Permission** object are enabled for the current form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-150">Свойство [PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-150">[PermissionFromPolicy](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PermissionFromPolicy.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-151">Возвращает или задает значение, указывающее, применяется ли политика разрешений к текущей форме.</span><span class="sxs-lookup"><span data-stu-id="6c57c-151">Gets or sets whether a permission policy has been applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-152">Свойство [полицидескриптион](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-152">[PolicyDescription](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyDescription.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-153">Возвращает описание политики, примененной к текущей форме.</span><span class="sxs-lookup"><span data-stu-id="6c57c-153">Gets a description of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-154">Свойство [PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-154">[PolicyName](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.PolicyName.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-155">Возвращает имя политики, примененной к текущей форме.</span><span class="sxs-lookup"><span data-stu-id="6c57c-155">Gets the name of the policy that was applied to the current form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-156">Свойство [рекуестпермиссионурл](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-156">[RequestPermissionUrl](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.RequestPermissionUrl.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-157">Получает или задает файл, URL-адрес или адрес электронной почты для связи с пользователями, которым требуются дополнительные разрешения для текущей формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-157">Gets or sets the file, URL, or email address to contact for users who need additional permissions on the current form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-158">Свойство [StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-158">[StoreLicenses](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.StoreLicenses.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-159">Возвращает или задает значение, указывающее, следует ли кэшировать лицензию пользователя на просмотр текущей формы для обеспечения автономного просмотра в том случае, если пользователь не может подключиться к серверу управления правами.</span><span class="sxs-lookup"><span data-stu-id="6c57c-159">Gets or sets whether the user's license to view the current form should be cached to allow offline viewing when the user cannot connect to a rights management server.</span></span>  <br/> |
|<span data-ttu-id="6c57c-160">Свойство [разрешенияпользователей](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-160">[UserPermissions](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Permission.UserPermissions.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-161">Возвращает объект **UserPermissionCollection** для текущей формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-161">Gets a **UserPermissionCollection** object for the current form.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermissioncollection-class"></a><span data-ttu-id="6c57c-162">Обзор класса "UserPermissionCollection"</span><span class="sxs-lookup"><span data-stu-id="6c57c-162">Overview of the UserPermissionCollection Class</span></span>

<span data-ttu-id="6c57c-163">Класс **UserPermissionCollection** предоставляет следующие свойства и методы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-163">The **UserPermissionCollection** class provides the following properties and methods.</span></span> 
  
|<span data-ttu-id="6c57c-164">**Name**</span><span class="sxs-lookup"><span data-stu-id="6c57c-164">**Name**</span></span>|<span data-ttu-id="6c57c-165">**Описание**</span><span class="sxs-lookup"><span data-stu-id="6c57c-165">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c57c-166">Метод [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) (+ 3 перегрузки)</span><span class="sxs-lookup"><span data-stu-id="6c57c-166">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="6c57c-167">Добавляет нового пользователя для текущей формы с указанием разрешений и срока действия (необязательно).</span><span class="sxs-lookup"><span data-stu-id="6c57c-167">Adds a new user to the current form, optionally specifying permissions and an expiration date.</span></span>  <br/> |
|<span data-ttu-id="6c57c-168">Метод [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-168">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="6c57c-169">Удаляет из коллекции объект **UserPermission** с указанным идентификатором **UserId**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-169">Removes the **UserPermission** object with the specified **UserId** from the collection.</span></span>  <br/> |
|<span data-ttu-id="6c57c-170">Метод [RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-170">[RemoveAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.RemoveAll.aspx) method</span></span>  <br/> |<span data-ttu-id="6c57c-171">Удаляет из коллекции все объекты **UserPermission**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-171">Removes all **UserPermission** objects from the collection.</span></span>  <br/> |
|<span data-ttu-id="6c57c-172">Свойство [Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-172">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-173">Возвращает количество объектов **UserPermission** в коллекции.</span><span class="sxs-lookup"><span data-stu-id="6c57c-173">Gets the number of **UserPermission** objects in the collection.</span></span>  <br/> |
|<span data-ttu-id="6c57c-174">Свойство [Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) (+ 1 перегрузка)</span><span class="sxs-lookup"><span data-stu-id="6c57c-174">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermissionCollection.Item.aspx) property (+1 overload)</span></span>  <br/> |<span data-ttu-id="6c57c-175">Возвращает объект **UserPermission**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-175">Gets a **UserPermission** object.</span></span>  <br/> |
   
### <a name="overview-of-the-userpermission-class"></a><span data-ttu-id="6c57c-176">Обзор класса "UserPermission"</span><span class="sxs-lookup"><span data-stu-id="6c57c-176">Overview of the UserPermission Class</span></span>

<span data-ttu-id="6c57c-177">Класс **UserPermission** предоставляет указанные ниже свойства и один метод.</span><span class="sxs-lookup"><span data-stu-id="6c57c-177">The **UserPermission** class provides the following properties and one method.</span></span> 
  
|<span data-ttu-id="6c57c-178">**Name**</span><span class="sxs-lookup"><span data-stu-id="6c57c-178">**Name**</span></span>|<span data-ttu-id="6c57c-179">**Описание**</span><span class="sxs-lookup"><span data-stu-id="6c57c-179">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c57c-180">Метод [Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-180">[Remove](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Remove.aspx) method</span></span>  <br/> |<span data-ttu-id="6c57c-181">Удаляет текущий объект **UserPermission** из разрешений формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-181">Removes the current **UserPermission** object from the form's permissions.</span></span>  <br/> |
|<span data-ttu-id="6c57c-182">Свойство [ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-182">[ExpirationDate](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.ExpirationDate.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-183">Возвращает или задает необязательный срок действия разрешений текущей формы, назначенных пользователю, связанному с экземпляром класса **UserPermission**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-183">Gets or sets the optional expiration date for the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="6c57c-184">Свойство [Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-184">[Permission](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.Permission.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-185">Возвращает или задает значение, представляющее разрешения текущей формы, назначенные пользователю, связанному с экземпляром класса **UserPermission**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-185">Gets or sets a value representing the permissions on the current form assigned to the user associated with an instance of the **UserPermission** class.</span></span>  <br/> |
|<span data-ttu-id="6c57c-186">Свойство [UserID](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx)</span><span class="sxs-lookup"><span data-stu-id="6c57c-186">[UserId](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.UserPermission.UserId.aspx) property</span></span>  <br/> |<span data-ttu-id="6c57c-187">Получает адрес электронной почты пользователя, разрешения которого в текущей форме определяются указанным объектом **UserPermission** .</span><span class="sxs-lookup"><span data-stu-id="6c57c-187">Gets the email address of the user whose permissions on the current form are determined by the specified **UserPermission** object.</span></span>  <br/> |
   
### <a name="the-permissiontype-enumeration"></a><span data-ttu-id="6c57c-188">Перечисление "PermissionType"</span><span class="sxs-lookup"><span data-stu-id="6c57c-188">The PermissionType Enumeration</span></span>

<span data-ttu-id="6c57c-189">Разрешения пользователя задаются или считываются с помощью значений перечисления [пермиссионтипе](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6c57c-189">A user's permissions are set or read using [PermissionType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.PermissionType.aspx) enumeration values.</span></span> 
  
|<span data-ttu-id="6c57c-190">**Name**</span><span class="sxs-lookup"><span data-stu-id="6c57c-190">**Name**</span></span>|<span data-ttu-id="6c57c-191">**Описание**</span><span class="sxs-lookup"><span data-stu-id="6c57c-191">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="6c57c-192">**Пермиссионтипе. Change**</span><span class="sxs-lookup"><span data-stu-id="6c57c-192">**PermissionType.Change**</span></span> <br/> |<span data-ttu-id="6c57c-193">Позволяет пользователям просматривать, редактировать, копировать и сохранять форму, но не печатать ее.</span><span class="sxs-lookup"><span data-stu-id="6c57c-193">Allows users to view, edit, copy, and save, but not print a form.</span></span> <span data-ttu-id="6c57c-194">Эквивалентно сочетанию разрешений **Read**, **Edit**, **Save** и **Extract**.</span><span class="sxs-lookup"><span data-stu-id="6c57c-194">Equivalent to the **Read**, **Edit**, **Save**, and **Extract** permissions combined.</span></span>  <br/> |
|<span data-ttu-id="6c57c-195">**Пермиссионтипе. Edit**</span><span class="sxs-lookup"><span data-stu-id="6c57c-195">**PermissionType.Edit**</span></span> <br/> |<span data-ttu-id="6c57c-196">Позволяет пользователю редактировать форму.</span><span class="sxs-lookup"><span data-stu-id="6c57c-196">Allows the user to edit the form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-197">**Пермиссионтипе. Extract**</span><span class="sxs-lookup"><span data-stu-id="6c57c-197">**PermissionType.Extract**</span></span> <br/> |<span data-ttu-id="6c57c-198">Позволяет пользователю с разрешением **Read** копировать содержимое формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-198">Allows a user with the **Read** permission to copy content in the form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-199">**Пермиссионтипе. FullControl**</span><span class="sxs-lookup"><span data-stu-id="6c57c-199">**PermissionType.FullControl**</span></span> <br/> |<span data-ttu-id="6c57c-200">Позволяет пользователю добавлять, изменять и удалять разрешения для других пользователей формы.</span><span class="sxs-lookup"><span data-stu-id="6c57c-200">Allows the user to add, change, and remove permissions for other users of a form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-201">**Пермиссионтипе. ObjectModel**</span><span class="sxs-lookup"><span data-stu-id="6c57c-201">**PermissionType.ObjectModel**</span></span> <br/> |<span data-ttu-id="6c57c-202">Предоставляет пользователю программный доступ к документу формы через его объектную модель.</span><span class="sxs-lookup"><span data-stu-id="6c57c-202">Allows a user to access the form document programmatically through its object model.</span></span> <span data-ttu-id="6c57c-203">Пользователи без разрешения **ObjectModel** не могут использовать объектную модель для определения собственных разрешений.</span><span class="sxs-lookup"><span data-stu-id="6c57c-203">Users without the **ObjectModel** permission cannot use the object model to determine their own permissions.</span></span>  <br/> |
|<span data-ttu-id="6c57c-204">**Пермиссионтипе. Print**</span><span class="sxs-lookup"><span data-stu-id="6c57c-204">**PermissionType.Print**</span></span> <br/> |<span data-ttu-id="6c57c-205">Позволяет пользователю печатать форму.</span><span class="sxs-lookup"><span data-stu-id="6c57c-205">Allows the user to print the form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-206">**Пермиссионтипе. Read**</span><span class="sxs-lookup"><span data-stu-id="6c57c-206">**PermissionType.Read**</span></span> <br/> |<span data-ttu-id="6c57c-207">Позволяет пользователю читать (просматривать) форму.</span><span class="sxs-lookup"><span data-stu-id="6c57c-207">Allows the user to read (view) the form.</span></span> <span data-ttu-id="6c57c-208">(Разрешения **Read** и **View** эквивалентны.)</span><span class="sxs-lookup"><span data-stu-id="6c57c-208">(The **Read** and **View** permissions are equivalent.)</span></span>  <br/> |
|<span data-ttu-id="6c57c-209">**Пермиссионтипе. Save**</span><span class="sxs-lookup"><span data-stu-id="6c57c-209">**PermissionType.Save**</span></span> <br/> |<span data-ttu-id="6c57c-210">Позволяет пользователю сохранять форму.</span><span class="sxs-lookup"><span data-stu-id="6c57c-210">Allows the user to save the form.</span></span>  <br/> |
|<span data-ttu-id="6c57c-211">**Пермиссионтипе. View**</span><span class="sxs-lookup"><span data-stu-id="6c57c-211">**PermissionType.View**</span></span> <br/> |<span data-ttu-id="6c57c-212">Позволяет пользователю просматривать (читать) форму.</span><span class="sxs-lookup"><span data-stu-id="6c57c-212">Allows the user to view (read) the form.</span></span> <span data-ttu-id="6c57c-213">(Разрешения **Read** и **View** эквивалентны.)</span><span class="sxs-lookup"><span data-stu-id="6c57c-213">(The **Read** and **View** permissions are equivalent.)</span></span>  <br/> |
   
### <a name="example"></a><span data-ttu-id="6c57c-214">Пример</span><span class="sxs-lookup"><span data-stu-id="6c57c-214">Example</span></span>

<span data-ttu-id="6c57c-215">В следующем примере при нажатии элемента управления **Кнопка** выполняется получение объекта **UserPermissionsCollection** для текущей формы, добавление уровня разрешений "Изменение доступа" для пользователя и задание срока действия, который составляет два дня от текущей даты.</span><span class="sxs-lookup"><span data-stu-id="6c57c-215">In the following example, clicking the **Button** control gets the **UserPermissionsCollection** for the current form, adds and assigns a user to the Change access level, and sets an expiration date of two days from the current date.</span></span> 
  
```cs
public void CTRL1_Clicked(object sender, ClickedEventArgs e)
{
   string strExpirationDate = DateTime.Today.AddDays(2).ToString();
   DateTime dtExpirationDate = DateTime.Parse(strExpirationDate);
   this.Permission.UserPermissions.Add("someone@example.com", 
      PermissionType.Change, dtExpirationDate);
}
```

```vb
Public Sub CTRL1_Clicked(ByVal sender As Object, _
   ByVal e As ClickedEventArgs)
   Dim strExpirationDate As String = _
      DateTime.Today.AddDays(2).ToString()
   dtExpirationDate As DateTime = DateTime.Parse(strExpirationDate)
   Me.Permission.UserPermissions.Add("someone@example.com", _
      PermissionType.Change, dtExpirationDate)
End Sub
```



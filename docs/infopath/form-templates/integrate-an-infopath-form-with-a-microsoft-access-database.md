---
title: Интеграция формы InfoPath с базой данных Microsoft Access
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath поддерживает использование базы данных Microsoft Access 2010 в качестве основного источника данных для форм или в качестве дополнительного источника данных для форм и элементов управления. В данной статье описывается использование базы данных Access 2010 в качестве источника данных.
ms.openlocfilehash: dbc39e0d0908214904d77b8955f3d231f0bfb20b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33423113"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="98a9c-104">Интеграция формы InfoPath с базой данных Microsoft Access</span><span class="sxs-lookup"><span data-stu-id="98a9c-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="98a9c-p102">Microsoft InfoPath поддерживает использование базы данных Microsoft Access 2010 в качестве основного источника данных для форм или в качестве дополнительного источника данных для форм и элементов управления. В данной статье описывается использование базы данных Access 2010 в качестве источника данных.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p102">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control. This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="98a9c-107">Использование базы данных Microsoft Access в качестве источника данных</span><span class="sxs-lookup"><span data-stu-id="98a9c-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="98a9c-108">Настройка базы данных Microsoft Access в качестве основного источника данных для форм</span><span class="sxs-lookup"><span data-stu-id="98a9c-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="98a9c-p103">Подключения базы данных в InfoPath устанавливаются при помощи **Мастера подключения данных**. Чтобы открыть этот мастер, выберите команду **База данных** в разделе **Дополнительные шаблоны форм** на вкладке **Новые** в Microsoft Office Backstage, а затем нажмите кнопку **Создать форму**.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p103">Database connections are established in InfoPath by using the **Data Connection Wizard**. This wizard is opened by selecting **Database** in the **Advanced Form Templates** section on the **New** tab of the Microsoft Office Backstage, and then clicking pressing **Design This Form**.</span></span>
  
<span data-ttu-id="98a9c-111">Нажав кнопку **Выбрать базу данных**, можно выбрать существующий источник данных или подключиться напрямую к заданному файлу базы данных.</span><span class="sxs-lookup"><span data-stu-id="98a9c-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="98a9c-p104">После выбора базы данных мастер предложит выбрать таблицу из базы данных, которую нужно использовать в качестве источника данных для формы. После добавления таблиц устанавливаются их взаимные связи, и мастер отображает таблицы и их иерархические взаимоотношения в списке **Структура источника данных**. Если установить флажок **Показать столбцы таблицы**, мастер отобразит в списке структуры источника данных названия полей таблиц; флажки рядом с названиями полей используются для того, чтобы задать включение полей в инструкцию SQL, которая создается мастером.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p104">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the **Show table columns** check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="98a9c-115">[!Примечание] Поля первичных ключей в каждый таблице всегда выбраны и не могут быть удалены.</span><span class="sxs-lookup"><span data-stu-id="98a9c-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="98a9c-p105">После указания таблиц, связей и полей в **Мастере подключения данных**, можно нажать кнопку **Изменить SQL**, чтобы просмотреть инструкцию SQL, которая будет использоваться для установления источника данных для формы. В диалоговом окне **Изменение инструкции SQL** можно нажать кнопку **Проверить инструкцию SQL**, чтобы проверить возможность создания InfoPath источника данных из предоставленной информации. Также диалоговое окно **Изменение инструкции SQL** можно использовать для изменения инструкции SQL, чтобы создать более сложные запросы.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p105">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="98a9c-p106">[!Примечание] Инструкции SQL, используемые в InfoPath, являются запросами формирования данных. Запросы формирования данных позволяют строить иерархические связи между двумя или более логическими записями в запросе. Возможно использование инструкций SQL JOIN, но это не рекомендуется, так как при этом отключается отправка форм. Дополнительные сведения по запросам формирования данных см. в документации Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="98a9c-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="98a9c-p107">Последняя страница **Мастера подключения данных** отображает сводные сведения об источнике данных, включая имя и расположение файла источника данных, имя основной родительской таблицы, число использованных таблиц и состояние отправки. Состояние отправки говорит о том, позволит ли созданная инструкция SQL осуществлять успешную отправку данных в источник данных.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p107">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="98a9c-125">Настройка базы данных Microsoft Access в качестве дополнительного источника данных</span><span class="sxs-lookup"><span data-stu-id="98a9c-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="98a9c-p108">Дополнительные источники данных могут использоваться для предоставления записей спискам или раскрывающимся спискам, или можно написать код для добавления данных из дополнительного источника в форму. Чтобы работать с дополнительными источниками данных в форме, при разработке формы выберите команду **Подключения к данным** на вкладке **Данные**.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p108">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="98a9c-p109">При запуске **Мастера подключения данных**, будет выдан запрос, принимать ли данные для использования в форме или отправлять данные в форме. Выберите вариант **Получение данных** и нажмите кнопку **Далее**. Чтобы создать дополнительный источник данных из базы данных, выберите команду **База данных (только база данных Microsoft SQL Server или Microsoft Office Access)**. На следующей странице мастера нажмите кнопку **Выбрать базу данных**, чтобы выбрать существующий источник данных или подключиться напрямую к заданному файлу базы данных.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p109">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form. Choose **Receive data**, and then click **Next**. To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**. On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="98a9c-p110">После выбора базы данных мастер предложит выбрать таблицу или запрос из базы данных, чтобы использовать в качестве источника данных для формы. Необходимо выбрать таблицу или запрос, чтобы начать работу, но позже при необходимости можно выбрать дополнительные таблицы. После выбора таблицы или запроса мастер позволит выбрать поля для использования в списке **Структура источника данных**. По умолчанию все поля таблицы выбраны, но можно удалить поля, если они не нужны в форме. Можно также задать, как сортируются записи, получаемые из таблицы, и допустимо ли несколько записей. Чтобы сделать это, нажмите кнопку **Изменить таблицу** и выберите критерии сортировки (не более трех) в диалоговом окне **Порядок сортировки**. После завершения нажмите кнопку **Готово**.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p110">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form. You must select one table or query to begin with, but you can select additional tables later if you want to include them. After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list. By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form. You can also control how the records returned from the table are sorted, and whether multiple records are allowed. To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box. When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="98a9c-139">[!Примечание] Поля первичных ключей в каждой таблице всегда выбраны и не могут быть удалены.</span><span class="sxs-lookup"><span data-stu-id="98a9c-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="98a9c-p111">InfoPath также позволяет получать данные из нескольких таблиц или запросов одновременно. При получении данных из нескольких таблиц или запросов необходимо иметь возможность устанавливать связи между всеми задействованными таблицами или запросами с исходной таблицей или запросом, выбранным в **Мастере подключения данных**. Например, если происходит получение данных из таблицы "Клиенты" базы данных "Борей", можно добавить таблицу "Заказы", чтобы получать данные о всех заказах от клиента, и таблицу "Сведения о заказе", чтобы получать дополнительные сведения по каждому заказу.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p111">InfoPath also enables you to retrieve data from multiple tables or queries at the same time. When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**. For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="98a9c-p112">Чтобы добавить дополнительную таблицу в источник данных, выберите таблицу, в которую необходимо добавить дочернюю таблицу, в списке **Структура источника данных** и нажмите кнопку **Добавить таблицу**. Выберите таблицу или запрос, который необходимо добавить, и нажмите кнопку **Далее**. InfoPath выдаст запрос для выбора связи или связей, которые нужно использовать. Если поля в двух таблицах имеют одинаковое имя, InfoPath автоматически добавит эти поля в качестве связи, но если это не так или если нужно использовать другую связь, можно нажать кнопку **Добавить отношение**, чтобы указать, какие поля в родительской таблице соответствуют полям в дочерней таблице. Также можно удалить существующие связи, нажав кнопку **Удалить отношение** в диалоговом окне **Изменение связей**.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p112">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**. Select the table or query you want to add, and then click **Next**. InfoPath prompts you to select the relationship or relationships you want to use. If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table. You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="98a9c-p113">После завершения работы со связями, нажмите кнопку **Готово**. Так же, как и для основной таблицы, можно задать, какие поля нужно получать из дочерней таблицы. Но при этом нельзя использовать кнопку **Изменить таблицу**, чтобы изменить порядок, в котором возвращаются записи.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p113">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the **Modify Table** button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="98a9c-p114">После того, как таблицы, связи и поля заданы, можно нажать кнопку **Изменить SQL**, чтобы просмотреть инструкцию SQL, которая будет использована для установления источника данных для формы. В диалоговом окне **Изменение инструкции SQL** можно нажать кнопку **Проверить инструкцию SQL**, чтобы проверить возможность создания источника данных из предоставленной информации в InfoPath. Также диалоговое окно **Изменение инструкции SQL** можно использовать для изменения инструкции SQL, чтобы создать более сложные запросы.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p114">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="98a9c-p115">[!Примечание] Инструкции SQL, используемые в InfoPath, являются запросами формирования данных. Запросы формирования данных позволяют строить иерархические связи между двумя или более логическими записями в запросе. Возможно использование инструкций соединения SQL, но это не рекомендуется, так как это отключает отправку форм. Дополнительные сведения по запросам формирования данных см. в документации Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="98a9c-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="98a9c-158">Включение отправки форм</span><span class="sxs-lookup"><span data-stu-id="98a9c-158">Enabling Form Submission</span></span>

<span data-ttu-id="98a9c-p116">Кроме получения данных из базы данных Access, InfoPath может отправлять новые или измененные данные назад в базу данных. При использовании команды **Отправить** на вкладке **Главная** или Microsoft Office Backstage, чтобы отправить изменения в базу данных, InfoPath использует объекты данных ActiveX (ADO) для обновления записей в базе данных. Отправка форм возможна при выполнении следующих условий:</span><span class="sxs-lookup"><span data-stu-id="98a9c-p116">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database. When you use the **Submit** command on the **Home** tab or the Microsoft Office Backstage to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database. Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="98a9c-162">Для каждого столбца, который используется в запросе формы, должен быть базовый столбец.</span><span class="sxs-lookup"><span data-stu-id="98a9c-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="98a9c-163">Столбец таблицы не может присутствовать в запросе несколько раз.</span><span class="sxs-lookup"><span data-stu-id="98a9c-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="98a9c-164">Первичный ключ, уникальное ограничение или уникальный индекс должны быть доступны для каждой таблицы в условии SELECT, которое используется в запросе формы.</span><span class="sxs-lookup"><span data-stu-id="98a9c-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="98a9c-165">Таблица не может быть включена несколько раз в запрос формы.</span><span class="sxs-lookup"><span data-stu-id="98a9c-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="98a9c-166">Связи между родительскими и дочерними таблицами должны включать все столбцы первичных ключей из родительской таблицы.</span><span class="sxs-lookup"><span data-stu-id="98a9c-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="98a9c-167">Может быть только одна базовая таблица для всех столбцов в условии SELECT, которое используется в запросе формы.</span><span class="sxs-lookup"><span data-stu-id="98a9c-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="98a9c-p117">Существует несколько случаев, в которых InfoPath не может отправить в базу данных изменения формы. Например, если создается форма, которая выводит данные из запроса, а не из таблицы, или если в инструкцию SQL, использующуюся InfoPath, был добавлен оператор JOIN, InfoPath не сможет отправлять изменения. Другой случай, который препятствует отправке изменений InfoPath, состоит в добавлении таблиц в форму, имеющую связи с их родительскими таблицами типа "один ко многим". В случаях, когда InfoPath не может отправить изменения в базу данных, в поле **Состояние отправки** на последней странице **Мастера подключения данных** будет отображаться причина ограничения.</span><span class="sxs-lookup"><span data-stu-id="98a9c-p117">There are some circumstances under which InfoPath cannot submit form changes to a database. For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes. Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table. In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  


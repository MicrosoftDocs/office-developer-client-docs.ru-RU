---
title: Интеграция формы InfoPath с базой данных Microsoft Access
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath поддерживает использование базы данных Microsoft Access 2010 в качестве основного источника данных для форм или в качестве дополнительного источника данных для форм и элементов управления. В данной статье описывается использование базы данных Access 2010 в качестве источника данных.
ms.openlocfilehash: dbc39e0d0908214904d77b8955f3d231f0bfb20b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303516"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a>Интеграция формы InfoPath с базой данных Microsoft Access

Microsoft InfoPath поддерживает использование базы данных Microsoft Access 2010 в качестве основного источника данных для форм или в качестве дополнительного источника данных для форм и элементов управления. В данной статье описывается использование базы данных Access 2010 в качестве источника данных.
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a>Использование базы данных Microsoft Access в качестве источника данных

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a>Настройка базы данных Microsoft Access в качестве основного источника данных для форм

Подключения базы данных в InfoPath устанавливаются при помощи **Мастера подключения данных**. Чтобы открыть этот мастер, выберите команду **База данных** в разделе **Дополнительные шаблоны форм** на вкладке **Новые** в Microsoft Office Backstage, а затем нажмите кнопку **Создать форму**.
  
Нажав кнопку **Выбрать базу данных**, можно выбрать существующий источник данных или подключиться напрямую к заданному файлу базы данных.
  
После выбора базы данных мастер предложит выбрать таблицу из базы данных, которую нужно использовать в качестве источника данных для формы. После добавления таблиц устанавливаются их взаимные связи, и мастер отображает таблицы и их иерархические взаимоотношения в списке **Структура источника данных**. Если установить флажок **Показать столбцы таблицы**, мастер отобразит в списке структуры источника данных названия полей таблиц; флажки рядом с названиями полей используются для того, чтобы задать включение полей в инструкцию SQL, которая создается мастером. 
  
> [!NOTE]
> [!Примечание] Поля первичных ключей в каждый таблице всегда выбраны и не могут быть удалены. 
  
После указания таблиц, связей и полей в **Мастере подключения данных**, можно нажать кнопку **Изменить SQL**, чтобы просмотреть инструкцию SQL, которая будет использоваться для установления источника данных для формы. В диалоговом окне **Изменение инструкции SQL** можно нажать кнопку **Проверить инструкцию SQL**, чтобы проверить возможность создания InfoPath источника данных из предоставленной информации. Также диалоговое окно **Изменение инструкции SQL** можно использовать для изменения инструкции SQL, чтобы создать более сложные запросы. 
  
> [!NOTE]
> [!Примечание] Инструкции SQL, используемые в InfoPath, являются запросами формирования данных. Запросы формирования данных позволяют строить иерархические связи между двумя или более логическими записями в запросе. Возможно использование инструкций SQL JOIN, но это не рекомендуется, так как при этом отключается отправка форм. Дополнительные сведения по запросам формирования данных см. в документации Microsoft Developer Network (MSDN). 
  
Последняя страница **Мастера подключения данных** отображает сводные сведения об источнике данных, включая имя и расположение файла источника данных, имя основной родительской таблицы, число использованных таблиц и состояние отправки. Состояние отправки говорит о том, позволит ли созданная инструкция SQL осуществлять успешную отправку данных в источник данных. 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a>Настройка базы данных Microsoft Access в качестве дополнительного источника данных

Дополнительные источники данных могут использоваться для предоставления записей спискам или раскрывающимся спискам, или можно написать код для добавления данных из дополнительного источника в форму. Чтобы работать с дополнительными источниками данных в форме, при разработке формы выберите команду **Подключения к данным** на вкладке **Данные**. 
  
При запуске **Мастера подключения данных**, будет выдан запрос, принимать ли данные для использования в форме или отправлять данные в форме. Выберите вариант **Получение данных** и нажмите кнопку **Далее**. Чтобы создать дополнительный источник данных из базы данных, выберите команду **База данных (только база данных Microsoft SQL Server или Microsoft Office Access)**. На следующей странице мастера нажмите кнопку **Выбрать базу данных**, чтобы выбрать существующий источник данных или подключиться напрямую к заданному файлу базы данных. 
  
После выбора базы данных мастер предложит выбрать таблицу или запрос из базы данных, чтобы использовать в качестве источника данных для формы. Необходимо выбрать таблицу или запрос, чтобы начать работу, но позже при необходимости можно выбрать дополнительные таблицы. После выбора таблицы или запроса мастер позволит выбрать поля для использования в списке **Структура источника данных**. По умолчанию все поля таблицы выбраны, но можно удалить поля, если они не нужны в форме. Можно также задать, как сортируются записи, получаемые из таблицы, и допустимо ли несколько записей. Чтобы сделать это, нажмите кнопку **Изменить таблицу** и выберите критерии сортировки (не более трех) в диалоговом окне **Порядок сортировки**. После завершения нажмите кнопку **Готово**.
  
> [!NOTE]
> [!Примечание] Поля первичных ключей в каждой таблице всегда выбраны и не могут быть удалены. 
  
InfoPath также позволяет получать данные из нескольких таблиц или запросов одновременно. При получении данных из нескольких таблиц или запросов необходимо иметь возможность устанавливать связи между всеми задействованными таблицами или запросами с исходной таблицей или запросом, выбранным в **Мастере подключения данных**. Например, если происходит получение данных из таблицы "Клиенты" базы данных "Борей", можно добавить таблицу "Заказы", чтобы получать данные о всех заказах от клиента, и таблицу "Сведения о заказе", чтобы получать дополнительные сведения по каждому заказу.
  
Чтобы добавить дополнительную таблицу в источник данных, выберите таблицу, в которую необходимо добавить дочернюю таблицу, в списке **Структура источника данных** и нажмите кнопку **Добавить таблицу**. Выберите таблицу или запрос, который необходимо добавить, и нажмите кнопку **Далее**. InfoPath выдаст запрос для выбора связи или связей, которые нужно использовать. Если поля в двух таблицах имеют одинаковое имя, InfoPath автоматически добавит эти поля в качестве связи, но если это не так или если нужно использовать другую связь, можно нажать кнопку **Добавить отношение**, чтобы указать, какие поля в родительской таблице соответствуют полям в дочерней таблице. Также можно удалить существующие связи, нажав кнопку **Удалить отношение** в диалоговом окне **Изменение связей**. 
  
После завершения работы со связями, нажмите кнопку **Готово**. Так же, как и для основной таблицы, можно задать, какие поля нужно получать из дочерней таблицы. Но при этом нельзя использовать кнопку **Изменить таблицу**, чтобы изменить порядок, в котором возвращаются записи. 
  
После того, как таблицы, связи и поля заданы, можно нажать кнопку **Изменить SQL**, чтобы просмотреть инструкцию SQL, которая будет использована для установления источника данных для формы. В диалоговом окне **Изменение инструкции SQL** можно нажать кнопку **Проверить инструкцию SQL**, чтобы проверить возможность создания источника данных из предоставленной информации в InfoPath. Также диалоговое окно **Изменение инструкции SQL** можно использовать для изменения инструкции SQL, чтобы создать более сложные запросы. 
  
> [!NOTE]
> [!Примечание] Инструкции SQL, используемые в InfoPath, являются запросами формирования данных. Запросы формирования данных позволяют строить иерархические связи между двумя или более логическими записями в запросе. Возможно использование инструкций соединения SQL, но это не рекомендуется, так как это отключает отправку форм. Дополнительные сведения по запросам формирования данных см. в документации Microsoft Developer Network (MSDN). 
  
## <a name="enabling-form-submission"></a>Включение отправки форм

Кроме получения данных из базы данных Access, InfoPath может отправлять новые или измененные данные назад в базу данных. При использовании команды **Отправить** на вкладке **Главная** или Microsoft Office Backstage, чтобы отправить изменения в базу данных, InfoPath использует объекты данных ActiveX (ADO) для обновления записей в базе данных. Отправка форм возможна при выполнении следующих условий: 
  
- Для каждого столбца, который используется в запросе формы, должен быть базовый столбец.
    
- Столбец таблицы не может присутствовать в запросе несколько раз.
    
- Первичный ключ, уникальное ограничение или уникальный индекс должны быть доступны для каждой таблицы в условии SELECT, которое используется в запросе формы.
    
- Таблица не может быть включена несколько раз в запрос формы.
    
- Связи между родительскими и дочерними таблицами должны включать все столбцы первичных ключей из родительской таблицы.
    
- Может быть только одна базовая таблица для всех столбцов в условии SELECT, которое используется в запросе формы.
    
Существует несколько случаев, в которых InfoPath не может отправить в базу данных изменения формы. Например, если создается форма, которая выводит данные из запроса, а не из таблицы, или если в инструкцию SQL, использующуюся InfoPath, был добавлен оператор JOIN, InfoPath не сможет отправлять изменения. Другой случай, который препятствует отправке изменений InfoPath, состоит в добавлении таблиц в форму, имеющую связи с их родительскими таблицами типа "один ко многим". В случаях, когда InfoPath не может отправить изменения в базу данных, в поле **Состояние отправки** на последней странице **Мастера подключения данных** будет отображаться причина ограничения. 
  


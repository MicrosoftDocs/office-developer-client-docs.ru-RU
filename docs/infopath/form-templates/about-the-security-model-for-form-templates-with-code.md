---
title: Модель безопасности для шаблонов форм с кодом
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, security,code access security [InfoPath 2007],security [InfoPath 2007], security model for managed code,security [InfoPath 2007], levels,CAS [InfoPath 2007],InfoPath 2003-compatible form templates, security,permissions [InfoPath 2007]
localization_priority: Normal
ms.assetid: 5e1c1c72-f98d-4871-9c57-82c315277aa1
description: Шаблоны форм InfoPath с управляемым кодом поддерживают такие же уровни безопасности, как и скрипт, выполняющийся в неуправляемых шаблонах форм. Они также поддерживают дополнительные возможности доступа к коду, которые применяются к управляемому коду, работающему в среде CLR платформы .NET Framework.
ms.openlocfilehash: 97f0239a5bd6699b539ddaebf4d1d2ed7d1394db
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436148"
---
# <a name="about-the-security-model-for-form-templates-with-code"></a><span data-ttu-id="d4041-104">Модель безопасности для шаблонов форм с кодом</span><span class="sxs-lookup"><span data-stu-id="d4041-104">About the Security Model for Form Templates with Code</span></span>

<span data-ttu-id="d4041-105">Шаблоны форм InfoPath с управляемым кодом поддерживают такие же уровни безопасности, как и скрипт, выполняющийся в неуправляемых шаблонах форм. Они также поддерживают дополнительные возможности доступа к коду, которые применяются к управляемому коду, работающему в среде CLR платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d4041-105">InfoPath managed code form templates support the same security levels as script running in unmanaged form templates, and they also support additional code access security features that apply to managed code running under the common language runtime (CLR) of the .NET Framework.</span></span>
  
## <a name="infopath-managed-object-model-security-levels"></a><span data-ttu-id="d4041-106">Уровни безопасности объектной модели InfoPath с управляемым кодом</span><span class="sxs-lookup"><span data-stu-id="d4041-106">InfoPath Managed Object Model Security Levels</span></span>

<span data-ttu-id="d4041-107">В следующей таблице описаны соотношения различных уровней безопасности для элементов объектной модели скрипта, а также соответствующий набор разрешений, необходимый для каждого уровня при использовании элемента объектной модели в шаблоне формы с управляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="d4041-107">The following table describes the relationship between the security levels for script object model members and the corresponding permission set that is demanded for each level when the object model member is used in a managed code form template.</span></span>
  
|<span data-ttu-id="d4041-108">**Уровень безопасности объектной модели**</span><span class="sxs-lookup"><span data-stu-id="d4041-108">**Object Model Security Level**</span></span>|<span data-ttu-id="d4041-109">**Описание**</span><span class="sxs-lookup"><span data-stu-id="d4041-109">**Description**</span></span>|<span data-ttu-id="d4041-110">**Необходимый набор разрешений**</span><span class="sxs-lookup"><span data-stu-id="d4041-110">**Permission Set Demanded**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="d4041-111">нуль</span><span class="sxs-lookup"><span data-stu-id="d4041-111">0</span></span>  <br/> |<span data-ttu-id="d4041-112">Доступ возможен без ограничений.</span><span class="sxs-lookup"><span data-stu-id="d4041-112">Can be accessed without restrictions.</span></span>  <br/> |<span data-ttu-id="d4041-113">Нет</span><span class="sxs-lookup"><span data-stu-id="d4041-113">None</span></span>  <br/> |
|<span data-ttu-id="d4041-114">2</span><span class="sxs-lookup"><span data-stu-id="d4041-114">2</span></span>  <br/> |<span data-ttu-id="d4041-115">Доступ возможен только от форм, запущенных на том же домене, что и открытая в данный момент форма, либо от форм, которым были присвоены междоменные разрешения.</span><span class="sxs-lookup"><span data-stu-id="d4041-115">Can be accessed only by forms running in the same domain as the currently open form, or by forms that have been granted cross-domain permissions.</span></span>  <br/> |<span data-ttu-id="d4041-116">Нет</span><span class="sxs-lookup"><span data-stu-id="d4041-116">None</span></span>  <br/> |
|<span data-ttu-id="d4041-117">4</span><span class="sxs-lookup"><span data-stu-id="d4041-117">3</span></span>  <br/> |<span data-ttu-id="d4041-118">Доступ возможен только от форм с полным доверием.</span><span class="sxs-lookup"><span data-stu-id="d4041-118">Can be accessed only by fully trusted forms.</span></span>  <br/> |<span data-ttu-id="d4041-119">Надежные</span><span class="sxs-lookup"><span data-stu-id="d4041-119">FullTrust</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="d4041-120">Уровень безопасности "1" не используется текущим сервером COM приложения InfoPath и зарезервирован для использования в будущем.</span><span class="sxs-lookup"><span data-stu-id="d4041-120">The security level "1" is not used by the current InfoPath COM server and is reserved for future use.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="d4041-121">[!Важно!] Несмотря на то, что уровни 0 и 2 в объектной модели не требуют какого-либо набора разрешений, поскольку содержат управляемый код, они рассматриваются как определенные на уровне безопасности "Домен" для доступа к доменам, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="d4041-121">Even though object model levels 0 and 2 do not demand any permission set, because they contain managed code, they behave as defined for the Domain domain access security level that is described in the following section.</span></span> 
  
<span data-ttu-id="d4041-122">Уровень безопасности каждого элемента объектной модели, предоставляемого сборками Microsoft.Office.InfoPath и Microsoft.Office.Interop.InfoPath.SemiTrust, указан в разделе "Заметки" темы с документацией по этому элементу в пространствах имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) и [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d4041-122">The security level of each object model member exposed by the Microsoft.Office.InfoPath and Microsoft.Office.Interop.InfoPath.SemiTrust assemblies is specified in the Remarks section of the topic that documents that member in the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) and [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespaces.</span></span> 
  
## <a name="infopath-domain-access-security-levels"></a><span data-ttu-id="d4041-123">Уровни безопасности доступа к доменам InfoPath</span><span class="sxs-lookup"><span data-stu-id="d4041-123">InfoPath Domain Access Security Levels</span></span>

<span data-ttu-id="d4041-p101">В сочетании с уровнями безопасности объектной модели, которые применяются сервером COM, предоставляемым приложением InfoPath, в приложении InfoPath также определяются три уровня безопасности, которые применяются в зависимости от местоположения шаблона формы, метода развертывания формы и параметров, настроенных в режиме конструктора. Эти три уровня безопасности описаны в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="d4041-p101">In conjunction with the object model security levels that are enforced by the COM server exposed by the InfoPath application, InfoPath defines three security levels that are applied depending on where the form template is located, how the form is deployed, and settings configured in design mode. These three security levels are defined in the following table.</span></span>
  
|<span data-ttu-id="d4041-126">**Уровень безопасности доступа к доменам**</span><span class="sxs-lookup"><span data-stu-id="d4041-126">**Domain Access Security Level**</span></span>|<span data-ttu-id="d4041-127">**Описание**</span><span class="sxs-lookup"><span data-stu-id="d4041-127">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d4041-128">Restricted</span><span class="sxs-lookup"><span data-stu-id="d4041-128">Restricted</span></span>  <br/> |<span data-ttu-id="d4041-129">Полностью запрещает внешние связи шаблона формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-129">Does not permit any communication outside of the form template.</span></span> <span data-ttu-id="d4041-130">Этот уровень безопасности призван предотвратить любую возможную передачу данных вредоносными формами от текущего компьютера к злоумышленнику.</span><span class="sxs-lookup"><span data-stu-id="d4041-130">This security level is intended to prevent harmful forms from transmitting any data from your computer to a malicious attacker.</span></span> <span data-ttu-id="d4041-131">При запуске в этом режиме безопасности не будут работать следующие функции: настраиваемая область задач, подключения к данным (кроме отправки по электронной почте), элементы управления ActiveX, код формы, роли и рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="d4041-131">When running in this security mode, the following features will not work: Custom Task Pane, Data Connections (except email submit), ActiveX controls, managed code form code, Roles, and Workflow.</span></span> <span data-ttu-id="d4041-132">Шаблоны форм с управляемым кодом невозможно запустить на домене с доступом "Ограниченный".</span><span class="sxs-lookup"><span data-stu-id="d4041-132">Managed code form templates cannot run in the Restricted domain.</span></span> <span data-ttu-id="d4041-133">Если для шаблона формы с управляемым кодом установлен параметр **Автоматически определять уровень безопасности** в категории **Безопасность и доверие** диалогового окна **Параметры формы**, шаблону формы для запуска кода всегда будет необходим как минимум уровень доступа безопасности "Домен".</span><span class="sxs-lookup"><span data-stu-id="d4041-133">When a managed code form template is set to the **Automatically determine security level** setting in the **Security and Trust** category of the **Form Options** dialog box, the form template will always require at least the Domain security access level to run code.</span></span>  <br/><br/><span data-ttu-id="d4041-134">**Важно!** сборка управляемого кода, созданная для шаблона формы с управляемым кодом, не будет загружаться и выполняться при открытии формы из домена с ограниченным доступом, например из формы InfoPath, отправленной в виде вложения в сообщение электронной почты.</span><span class="sxs-lookup"><span data-stu-id="d4041-134">**IMPORTANT**: The managed code assembly created for a managed code form template will not load and run when a form is opened from a Restricted domain, for example, from an InfoPath form sent as an email attachment.</span></span> <span data-ttu-id="d4041-135">Все шаблоны форм, которые вы хотите развернуть как вложение электронной почты, должны опускать перечисленные выше компоненты, а если шаблон формы содержит код формы, код формы должен быть реализован в JScript или VBScript и использовать только элементы объектной модели с уровнем безопасности 0 (ноль).</span><span class="sxs-lookup"><span data-stu-id="d4041-135">Any form template you wish to deploy as an email attachment must omit the features listed above, and if the form template contains form code, form code must be implemented in JScript or VBScript, and must only utilize object model members with a security level of 0 (zero).</span></span>           |
|<span data-ttu-id="d4041-136">Домен</span><span class="sxs-lookup"><span data-stu-id="d4041-136">Domain</span></span>  <br/> |<span data-ttu-id="d4041-p104">Ограничивает форму на основе ее размещения в одной из зон безопасности, указанных приложением Microsoft Internet Explorer. Например, если форма расположена в зоне "Местная интрасеть", то ей разрешено связываться с другими данными вне исходного домена, но не разрешено получать данные из других доменов. Размещение в зоне безопасности Microsoft Internet Explorer также определяет разрешение на запуск элементов управления ActiveX, отмеченных как небезопасные для скриптов.</span><span class="sxs-lookup"><span data-stu-id="d4041-p104">Restricts a form based on its location in one of the security zones defined by Microsoft Internet Explorer. For example, if the form is located in the Local Intranet zone, it is allowed to communicate with other data inside its own domain but it is not permitted to retrieve data from other domains. The location in a Microsoft Internet Explorer security zone also determines whether ActiveX controls that are marked as unsafe for scripting will be allowed to run.</span></span>  <br/> |
|<span data-ttu-id="d4041-140">Полное доверие</span><span class="sxs-lookup"><span data-stu-id="d4041-140">Full Trust</span></span>  <br/> |<span data-ttu-id="d4041-141">Позволяет запускать форму с полным доверием на компьютере, на котором будет использоваться форма.</span><span class="sxs-lookup"><span data-stu-id="d4041-141">Allows you to run a form with full trust on the computer where the form will be used.</span></span> <span data-ttu-id="d4041-142">Этот уровень безопасности можно использовать только при работе с формой, подписанной цифровой подписью, которая соответствует доверенному корневому издателю на компьютере, или путем создания программы установки, которая устанавливает форму, и задает для атрибута **requireFullTrust** элемента **xDocumentClass** значение "Да" в файле определения формы (XSF).</span><span class="sxs-lookup"><span data-stu-id="d4041-142">This security level can only be used when working with a form that is digitally signed with a signature that matches a trusted root publisher on your computer, or by creating an installation program that installs the form and sets the **requireFullTrust** attribute of the **xDocumentClass** element to "yes" in the form definition file (.xsf).</span></span> <span data-ttu-id="d4041-143">С помощью этого параметра форма может получать доступ к вызовам объектных моделей, которые требуют уровня безопасности 3, например свойства и методы, обращающиеся к файловой системе, а также можно отключить определенные запросы безопасности, которые появляются при выполнении более ограниченного уровня безопасности.</span><span class="sxs-lookup"><span data-stu-id="d4041-143">By using this setting, your form can access object model calls that require object model security level 3, such as properties and methods that access the file system, and you can disable certain security prompts that appear when running at a more restrictive security level.</span></span>  <br/> |
   
<span data-ttu-id="d4041-144">По умолчанию форма InfoPath настроена на автоматический выбор ограниченного или доменного уровня безопасности в зависимости от возможностей, используемых в шаблоне формы, а также места и способа развертывания шаблона формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-144">By default, an InfoPath form is configured to select automatically either the Restricted or Domain security level depending on the features that are being used in the form template, and where and how the form template is deployed.</span></span> <span data-ttu-id="d4041-145">Например, шаблон формы, развернутый в качестве вложения электронной почты, автоматически настраивается на ограниченный уровень безопасности.</span><span class="sxs-lookup"><span data-stu-id="d4041-145">For example, a form template deployed as an email attachment is automatically configured to the Restricted security level.</span></span> <span data-ttu-id="d4041-146">Параметр безопасности всегда как можно более строгий, начиная с ограниченного, чтобы обеспечить более высокий уровень защиты данных.</span><span class="sxs-lookup"><span data-stu-id="d4041-146">The security setting is always as restrictive as possible, starting at Restricted, to ensure a greater level of protection for you and your data.</span></span> <span data-ttu-id="d4041-147">Если шаблон формы, содержащий управляемый код, настроен на автоматический выбор уровня безопасности, шаблону формы всегда будет требоваться по крайней мере уровень доступа к безопасности домена, прежде чем можно будет запустить код.</span><span class="sxs-lookup"><span data-stu-id="d4041-147">When a form template that contains managed code is set to automatically select the security level, the form template will always require at least the Domain security access level before code can run.</span></span> <span data-ttu-id="d4041-148">Вы можете вручную переопределить этот параметр в режиме конструктора, чтобы выбрать уровень безопасности, который больше подходит для формы, с помощью следующей процедуры.</span><span class="sxs-lookup"><span data-stu-id="d4041-148">You can manually override this setting at design time to select a level of security that is more appropriate for the form by using the following procedure.</span></span> 
  
### <a name="specify-a-forms-security-level"></a><span data-ttu-id="d4041-149">Указание уровня безопасности формы</span><span class="sxs-lookup"><span data-stu-id="d4041-149">Specify a form's security level</span></span>

1. <span data-ttu-id="d4041-150">Откройте форму в разработчике форм InfoPath, щелкните вкладку **Файл**, нажмите **Сведения**, а затем выберите **Параметры формы**.</span><span class="sxs-lookup"><span data-stu-id="d4041-150">Open the form in the InfoPath form designer, click the **File** tab, click **Info**, and then click **Form Options**.</span></span>
    
2. <span data-ttu-id="d4041-151">В диалоговом окне **Параметры формы** выберите категорию **Безопасность и доверие**.</span><span class="sxs-lookup"><span data-stu-id="d4041-151">In the **Form Options** dialog box, click the **Security and Trust** category.</span></span> 
    
3. <span data-ttu-id="d4041-152">Снимите флажок **Автоматически определять уровень безопасности (рекомендуется)**.</span><span class="sxs-lookup"><span data-stu-id="d4041-152">Clear the **Automatically determine security level (recommended)** check box.</span></span> 
    
4. <span data-ttu-id="d4041-153">Выберите необходимый уровень безопасности.</span><span class="sxs-lookup"><span data-stu-id="d4041-153">Select the desired security level.</span></span>
    
> [!NOTE] 
> - <span data-ttu-id="d4041-154">Если для шаблона формы с управляемым кодом выбрать уровень безопасности **Ограниченный**, то код формы не будет загружаться и запускаться независимо от того, какие элементы объектной модели используются в этом коде.</span><span class="sxs-lookup"><span data-stu-id="d4041-154">If you the select the **Restricted** security level for a managed code form template, the code behind the form will not load and run regardless of which object model members are used in the form code.</span></span> <span data-ttu-id="d4041-155">Этот уровень безопасности в основном предназначен для форм InfoPath, развернутых с помощью электронной почты.</span><span class="sxs-lookup"><span data-stu-id="d4041-155">This security level is primarily designed for InfoPath forms that are deployed using email.</span></span>     
> - <span data-ttu-id="d4041-156">Если выбрать уровень безопасности **Полное доверие**, то необходимо поставить цифровую подпись или установить и зарегистрировать формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-156">If you select the **Full Trust** security level, you need to digitally sign or install and register the form.</span></span> <span data-ttu-id="d4041-157">Дополнительные сведения можно найти [в статье Развертывание шаблонов форм InfoPath с кодом](how-to-deploy-infopath-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="d4041-157">For more information, see [Deploy InfoPath Form Templates with Code](how-to-deploy-infopath-form-templates-with-code.md).</span></span>
    
<span data-ttu-id="d4041-p109">В следующей таблице содержатся обобщенные сведения о модели безопасности InfoPath. В первом столбце перечислены уровни, указываемые или требующиеся для формы. Во втором и третьем столбцах указывается наличие идентификатора URN или URL для расположения формы. В остальных столбцах указываются объекты, запуск которых разрешен. Дополнительные сведения о скриптах развертывания и наборах разрешений для шаблонов форм с управляемым кодом см. в разделе "Функции безопасности для доступа к коду в среде CLR" далее в этой теме.</span><span class="sxs-lookup"><span data-stu-id="d4041-p109">The following table summarizes the InfoPath security model. The first column lists the level specified for or required by the form. The second and third columns specify whether the form has a URN or URL identifier for its location. The remaining columns specify what is allowed to run. For more information on deployment scenarios and permission sets for managed code form templates, see the "Common Language Runtime Code Access Security Features" section later in this topic.</span></span>
  
|<span data-ttu-id="d4041-163">**Уровень, необходимый для формы**</span><span class="sxs-lookup"><span data-stu-id="d4041-163">**Level Required by form**</span></span>|<span data-ttu-id="d4041-164">**Наличие идентификатора URN**</span><span class="sxs-lookup"><span data-stu-id="d4041-164">**Has URN Identifier**</span></span>|<span data-ttu-id="d4041-165">**Наличие идентификатора URL**</span><span class="sxs-lookup"><span data-stu-id="d4041-165">**Has URL Identifier**</span></span>|<span data-ttu-id="d4041-166">**Отметка небезопасности ActiveX для скриптов**</span><span class="sxs-lookup"><span data-stu-id="d4041-166">**ActiveX marked unsafe for scripting**</span></span>|<span data-ttu-id="d4041-167">**Междоменный доступ**</span><span class="sxs-lookup"><span data-stu-id="d4041-167">**Cross-Domain Access**</span></span>|<span data-ttu-id="d4041-168">**Управляемый код**</span><span class="sxs-lookup"><span data-stu-id="d4041-168">**Managed code**</span></span>|<span data-ttu-id="d4041-169">**Безопасность объектной модели**</span><span class="sxs-lookup"><span data-stu-id="d4041-169">**Object Model Security**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="d4041-170">Restricted</span><span class="sxs-lookup"><span data-stu-id="d4041-170">Restricted</span></span>  <br/> ||<span data-ttu-id="d4041-171">X</span><span class="sxs-lookup"><span data-stu-id="d4041-171">X</span></span>  <br/> |<span data-ttu-id="d4041-172">Нет ActiveX для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-172">No ActiveX at all</span></span>  <br/> |<span data-ttu-id="d4041-173">Ошибк</span><span class="sxs-lookup"><span data-stu-id="d4041-173">Fail</span></span>  <br/> |<span data-ttu-id="d4041-174">Ферма загружается, но управляемый код не запускается.</span><span class="sxs-lookup"><span data-stu-id="d4041-174">Form loads, but managed code won't run</span></span>  <br/> |<span data-ttu-id="d4041-175">нуль</span><span class="sxs-lookup"><span data-stu-id="d4041-175">0</span></span>  <br/> |
|<span data-ttu-id="d4041-176">Домен (Зона **Ограниченные узлы** в Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="d4041-176">Domain (Internet Explorer **Restricted sites** zone)</span></span>  <br/> |<span data-ttu-id="d4041-177">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-177">Won't run at all</span></span>  <br/> |<span data-ttu-id="d4041-178">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-178">Won't run at all</span></span>  <br/> |<span data-ttu-id="d4041-179">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-179">Won't run at all</span></span>  <br/> |<span data-ttu-id="d4041-180">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-180">Won't run at all</span></span>  <br/> |<span data-ttu-id="d4041-181">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-181">Won't run at all</span></span>  <br/> |<span data-ttu-id="d4041-182">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-182">Won't run at all</span></span>  <br/> |
|<span data-ttu-id="d4041-183">Домен (зона **Интернет** в Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="d4041-183">Domain (Internet Explorer **Internet** zone)</span></span>  <br/> |<span data-ttu-id="d4041-184">X</span><span class="sxs-lookup"><span data-stu-id="d4041-184">X</span></span>  <br/> ||<span data-ttu-id="d4041-185">Ошибк</span><span class="sxs-lookup"><span data-stu-id="d4041-185">Fail</span></span>  <br/> |<span data-ttu-id="d4041-186">Ошибк</span><span class="sxs-lookup"><span data-stu-id="d4041-186">Fail</span></span>  <br/> |<span data-ttu-id="d4041-187">Не запускается для всех</span><span class="sxs-lookup"><span data-stu-id="d4041-187">Won't run at all</span></span>  <br/> |<span data-ttu-id="d4041-188">нуль</span><span class="sxs-lookup"><span data-stu-id="d4041-188">0</span></span>  <br/> |
|<span data-ttu-id="d4041-189">Домен (зона **Местная интрасеть** Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="d4041-189">Domain (Internet Explorer **Local intranet** zone)</span></span>  <br/> |<span data-ttu-id="d4041-190">X</span><span class="sxs-lookup"><span data-stu-id="d4041-190">X</span></span>  <br/> ||<span data-ttu-id="d4041-191">Ошибк</span><span class="sxs-lookup"><span data-stu-id="d4041-191">Fail</span></span>  <br/> |<span data-ttu-id="d4041-192">Prompt</span><span class="sxs-lookup"><span data-stu-id="d4041-192">Prompt</span></span>  <br/> |<span data-ttu-id="d4041-193">Управляемый код запускается с разрешениями **Местная интрасеть**.</span><span class="sxs-lookup"><span data-stu-id="d4041-193">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="d4041-194">2</span><span class="sxs-lookup"><span data-stu-id="d4041-194">2</span></span>  <br/> |
|<span data-ttu-id="d4041-195">Домен (зона **Надежные узлы** в Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="d4041-195">Domain (Internet Explorer **Trusted sites** zone)</span></span>  <br/> |<span data-ttu-id="d4041-196">X</span><span class="sxs-lookup"><span data-stu-id="d4041-196">X</span></span>  <br/> ||<span data-ttu-id="d4041-197">Prompt</span><span class="sxs-lookup"><span data-stu-id="d4041-197">Prompt</span></span>  <br/> |<span data-ttu-id="d4041-198">OK</span><span class="sxs-lookup"><span data-stu-id="d4041-198">OK</span></span>  <br/> |<span data-ttu-id="d4041-p110">Управляемый код запускается с разрешениями **Интернет**. Междоменный доступ разрешен. Обратите внимание, что даже если форма находится в зоне **Надежные узлы**, то применяются разрешения зоны **Интернет**.</span><span class="sxs-lookup"><span data-stu-id="d4041-p110">Managed code runs with **Internet** permissions. Cross-domain access is allowed. Note that even though the form is in the **Trusted sites** zone, **Internet** zone permissions are applied.  </span></span><br/> |<span data-ttu-id="d4041-202">2</span><span class="sxs-lookup"><span data-stu-id="d4041-202">2</span></span>  <br/> |
|<span data-ttu-id="d4041-203">Домен (зона **Локальный компьютер** в Internet Explorer)</span><span class="sxs-lookup"><span data-stu-id="d4041-203">Domain (Internet Explorer **Local computer** zone)</span></span>  <br/> |<span data-ttu-id="d4041-204">X</span><span class="sxs-lookup"><span data-stu-id="d4041-204">X</span></span>  <br/> |<span data-ttu-id="d4041-205">X</span><span class="sxs-lookup"><span data-stu-id="d4041-205">X</span></span>  <br/> |<span data-ttu-id="d4041-206">Prompt</span><span class="sxs-lookup"><span data-stu-id="d4041-206">Prompt</span></span>  <br/> |<span data-ttu-id="d4041-207">Ошибк</span><span class="sxs-lookup"><span data-stu-id="d4041-207">Fail</span></span>  <br/> |<span data-ttu-id="d4041-208">Управляемый код запускается с разрешениями **Местная интрасеть**.</span><span class="sxs-lookup"><span data-stu-id="d4041-208">Managed code runs with **Local intranet** permissions.</span></span>  <br/> |<span data-ttu-id="d4041-209">2</span><span class="sxs-lookup"><span data-stu-id="d4041-209">2</span></span>  <br/> |
|<span data-ttu-id="d4041-210">Полное доверие</span><span class="sxs-lookup"><span data-stu-id="d4041-210">Full Trust</span></span>  <br/> |<span data-ttu-id="d4041-211">X</span><span class="sxs-lookup"><span data-stu-id="d4041-211">X</span></span>  <br/> |<span data-ttu-id="d4041-212">X</span><span class="sxs-lookup"><span data-stu-id="d4041-212">X</span></span>  <br/> |<span data-ttu-id="d4041-213">OK</span><span class="sxs-lookup"><span data-stu-id="d4041-213">OK</span></span>  <br/> |<span data-ttu-id="d4041-214">OK</span><span class="sxs-lookup"><span data-stu-id="d4041-214">OK</span></span>  <br/> |<span data-ttu-id="d4041-215">Полное доверие</span><span class="sxs-lookup"><span data-stu-id="d4041-215">Full Trust</span></span>  <br/> |<span data-ttu-id="d4041-216">4</span><span class="sxs-lookup"><span data-stu-id="d4041-216">3</span></span>  <br/> |
   
> [!IMPORTANT]
> <span data-ttu-id="d4041-p111">Приведенные выше описания в столбцах "Отметка небезопасности ActiveX для скриптов" и "Междоменный доступ" предполагают использование параметров безопасности Microsoft Internet Explorer по умолчанию. Если пользователь изменяет эти параметры безопасности, то поведение InfoPath изменится соответствующим образом. Например, если в зоне **Местная интрасеть** для параметра **Доступ к источникам данных за пределами домена** установлено значение **Включить**, то пользователи не будут получать запрос на разрешение междоменного доступа, указанный в таблице.</span><span class="sxs-lookup"><span data-stu-id="d4041-p111">The descriptions above in the "ActiveX marked unsafe for scripting" and "Cross-Domain Access" columns assume the default security settings for Microsoft Internet Explorer. If a user changes their security settings, InfoPath will behave accordingly. For example, if in the **Local intranet** zone, **Access data sources across domains** is set to **Enable**, then users will not be prompted to allow cross-domain access as described in the table.</span></span> 
  
## <a name="common-language-runtime-code-access-security-features"></a><span data-ttu-id="d4041-220">Функции безопасности для доступа к коду в среде CLR</span><span class="sxs-lookup"><span data-stu-id="d4041-220">Common Language Runtime Code Access Security Features</span></span>

<span data-ttu-id="d4041-221">При компиляции шаблона формы InfoPath с управляемым кодом создается частная сборка с управляемым кодом, в которой содержится реализация логики кода формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-221">When an InfoPath managed code form template is compiled, a private managed code assembly is created that contains the implementation of the form code logic.</span></span>
  
<span data-ttu-id="d4041-p112">На платформе .NET Framework сборка управляемого кода по умолчанию получает разрешения "Полное доверие" для запуска на локальном компьютере и не получает разрешений "Полное доверие" для запуска в интрасети. Чтобы обеспечить более точный контроль над политикой безопасности и предоставить возможность запуска шаблонов форм InfoPath с управляемым кодом как полностью доверенных форм из интрасети, приложение InfoPath внедряет следующую архитектуру безопасности.</span><span class="sxs-lookup"><span data-stu-id="d4041-p112">In the .NET Framework, by default, a managed code assembly has Full Trust permissions when running on the local machine, and is not granted Full Trust permissions when running on the Intranet. To provide more fine-grained control over security policy, and to provide the option to run InfoPath managed code form templates as fully trusted forms from the Intranet, InfoPath implements the following security architecture.</span></span>
  
- <span data-ttu-id="d4041-224">Приложение InfoPath использует среду CLR для платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d4041-224">The InfoPath application hosts the .NET Framework common language runtime (CLR).</span></span>
    
- <span data-ttu-id="d4041-225">В используемой InfoPath среде CLR каждый шаблон формы с управляемым кодом запускается на отдельном домене приложения, который представляет собой среду, обеспечивающую границы изоляции, выгрузки и безопасности для исполнения управляемого кода.</span><span class="sxs-lookup"><span data-stu-id="d4041-225">Within the CLR hosted by InfoPath, each managed code form template runs in a separate application domain, which is an environment that provides isolation, unloading, and security boundaries for executing managed code.</span></span>
    
- <span data-ttu-id="d4041-226">Приложение InfoPath устанавливает на домене приложения политику безопасности по умолчанию в зависимости от уровня надежности, связанного с шаблоном формы и URL-адресом его расположения.</span><span class="sxs-lookup"><span data-stu-id="d4041-226">InfoPath sets a default security policy on the application domain depending on the level of trust associated with the form template and the URL of its location.</span></span>
    
- <span data-ttu-id="d4041-p113">По умолчанию шаблон формы с управляемым кодом, запускающийся на локальном компьютере (группа кода зоны "Мой компьютер"), получает разрешения ниже уровня "Полное доверие" (разрешения зоны "Местная интрасеть"). Для получения разрешений "Полного доверие" форму необходимо зарегистрировать или подписать цифровой подписью с доверенного сертификата.</span><span class="sxs-lookup"><span data-stu-id="d4041-p113">By default, a managed code form template running on the local computer (the My Computer Zone code group) gets a lower level of permissions than Full Trust (Local Intranet Zone permissions). To have Full Trust permissions, the form must be registered or digitally signed with a trusted certificate.</span></span>
    
<span data-ttu-id="d4041-p114">Набор политик безопасности, используемый по умолчанию на домене приложения для шаблона формы с управляемым кодом, обеспечивает применение уровней безопасности для доступа к доменам InfoPath, а также любых дополнительных ограничений безопасности .NET. Чтобы обеспечить дополнительную гибкость, система безопасности InfoPath опознает группу кода безопасности "Шаблоны форм InfoPath" для доступа к коду .NET. Если эта группа кода присутствует на компьютере пользователя, то конфигурация безопасности и все возможные дочерние группы кода в рамках этой конфигурации будут применены к домену приложения.</span><span class="sxs-lookup"><span data-stu-id="d4041-p114">The default security policy set for the application domain of a managed code form template ensures that the InfoPath domain access security levels as well as any additional .NET security restrictions are enforced. To provide additional flexibility, the InfoPath security system recognizes a .NET code access security code group named "InfoPath Form Templates". If this code group is present on a user's computer, its security configuration, and those of any child code groups within it will be applied to the application domain.</span></span>
  
> [!IMPORTANT] 
> - <span data-ttu-id="d4041-p115">Группа кода "Шаблоны форм InfoPath" применяется только непосредственно к сборке кода формы с управляемым кодом. Соответственно, если предоставить набор разрешений "Полное доверие" для кода формы InfoPath с управляемым кодом без установки и регистрации (или цифровой подписи) самого шаблона формы (что обеспечивает полное доверие для всего шаблона формы), то вызовы элементов объектной модели с уровнем безопасности 3 будут по-прежнему выдавать ошибки в коде формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-p115">The InfoPath Form Templates code group applies only to the managed code form code assembly itself. As a result, if you grant the Full Trust permission set to InfoPath managed code form code, but you have not installed and registered (or digitally signed) the form template itself (which makes the entire form template fully trusted), calls in the form code to security level 3 object model members will still fail.</span></span>   
> - <span data-ttu-id="d4041-234">Если используется ссылка или явная загрузка (Assembly.Load) сборки, настроенная с помощью ограниченного набора разрешений и использующая свидетельство хэша, строгого имени или издателя для определения условия членства сборки в проекте шаблона формы, то сборка, тем не менее, будет загружена и выполнена шаблоном формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-234">If you reference or explicitly load (Assembly.Load) an assembly that is configured with a restricted permission set using Hash, Strong Name, or Publisher evidence to determine its membership condition in a form template project, the assembly will nonetheless be loaded and executed by the form template.</span></span>
    
<span data-ttu-id="d4041-235">Сведения о том, как создать и настроить группу кода шаблонов форм InfoPath, можно узнать в статье [Настройка параметров безопасности для шаблонов форм с кодом](how-to-configure-security-settings-for-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="d4041-235">For information on how to create and configure the InfoPath Form Templates code group, see [Configure Security Settings for Form Templates with Code](how-to-configure-security-settings-for-form-templates-with-code.md).</span></span>
  
<span data-ttu-id="d4041-236">В следующей таблице приведены обобщенные сведения о скриптах развертывания и наборах разрешений, применяемых к шаблонам форм с управляемым кодом.</span><span class="sxs-lookup"><span data-stu-id="d4041-236">The following table summarizes the deployment scenarios and permission sets that apply to managed code form templates.</span></span>
  
|<span data-ttu-id="d4041-237">**Сценарий развертывания**</span><span class="sxs-lookup"><span data-stu-id="d4041-237">**Deployment Scenario**</span></span>|<span data-ttu-id="d4041-238">**Набор разрешений**</span><span class="sxs-lookup"><span data-stu-id="d4041-238">**Permission Set**</span></span>|<span data-ttu-id="d4041-239">**Примечания**</span><span class="sxs-lookup"><span data-stu-id="d4041-239">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="d4041-240">Шаблон форм публикуется на локальном компьютере, а разработчик использует Visual Studio для написания и отладки кода формы.</span><span class="sxs-lookup"><span data-stu-id="d4041-240">The form template is published on the local computer, and the developer is using Visual Studio to write and debug form code.</span></span>  <br/> |<span data-ttu-id="d4041-241">Набор разрешений "Местная интрасеть".</span><span class="sxs-lookup"><span data-stu-id="d4041-241">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="d4041-242">Сборки, установленные в глобальном кэше сборок (GAC) и отмеченные атрибутом **AllowPartiallyTrustedCallersAttribute**, получают набор разрешений "Полное доверие".</span><span class="sxs-lookup"><span data-stu-id="d4041-242">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="d4041-243">По умолчанию шаблоны форм, запускаемые с локального компьютера, не получают набор разрешений "Полное доверие".</span><span class="sxs-lookup"><span data-stu-id="d4041-243">By default, form templates running from the local computer are not granted the Full Trust permission set.</span></span> <span data-ttu-id="d4041-244">При разработке шаблонов форм, использующих функции и вызовы элементов объектной модели, требующих разрешений полного доверия, можно использовать процедуру, описанную в статье [Предварительный просмотр и отладка шаблонов форм, требующих полного доверия](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="d4041-244">While developing form templates that use features and calls to object model members that require Full Trust permissions, you can use the procedure described in [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>  <br/> |
|<span data-ttu-id="d4041-245">Шаблон формы публикуется на локальном компьютере и указывает ссылку на пользовательскую сборку, которой на этом локальном компьютере требуется набор разрешений "Полное доверие".</span><span class="sxs-lookup"><span data-stu-id="d4041-245">The form template is published on the local computer and references a custom assembly that requests the Full Trust permission set on the local computer.</span></span>  <br/> |<span data-ttu-id="d4041-246">Набор разрешений "Местная интрасеть".</span><span class="sxs-lookup"><span data-stu-id="d4041-246">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="d4041-247">Сборки, установленные в глобальном кэше сборок (GAC) и отмеченные атрибутом **AllowPartiallyTrustedCallersAttribute**, получают набор разрешений "Полное доверие".</span><span class="sxs-lookup"><span data-stu-id="d4041-247">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span> <span data-ttu-id="d4041-248">Пользовательская сборка получает набор разрешений "Местная интрасеть".</span><span class="sxs-lookup"><span data-stu-id="d4041-248">The custom assembly is granted the Local Intranet permission set.</span></span>  <br/> |<span data-ttu-id="d4041-p118">Чтобы указать внешние сборки для использования в коде шаблона формы, разработчику необходимо воспользоваться группой кода "Шаблоны форм InfoPath" для предоставления разрешений "Полное доверие" (или соответствующего набора разрешений) для внешней сборки, указанной в коде шаблона формы. Приложение InfoPath не применяет никаких исходных условий для внешних сборок, отличных от установленных в глобальном кэше сборок (GAC). Разработчик должен явным образом предоставить сборке необходимые разрешения с помощью группы кода "Шаблоны форм InfoPath", даже если сборка уже является доверенной благодаря разрешениям, предоставленным в группе кода "My_Computer_Zone".</span><span class="sxs-lookup"><span data-stu-id="d4041-p118">To reference external assemblies for use in the form template's code, the developer must use the InfoPath Form Templates code group to grant Full Trust (or the appropriate permission set) to the external assembly referenced in the form template's code. InfoPath does not make any assumptions about external assemblies other than those installed in the Global Assembly Cache (GAC). The developer must explicitly grant the assembly the necessary permissions using the InfoPath Form Templates code group even if the assembly is already trusted though permissions granted in the My_Computer_Zone code group.</span></span>  <br/> |
|<span data-ttu-id="d4041-252">Шаблон формы публикуется в общем расположении местной интрасети, например в файловом хранилище, в библиотеке форм SharePoint или на веб-сервере.</span><span class="sxs-lookup"><span data-stu-id="d4041-252">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server.</span></span>  <br/> |<span data-ttu-id="d4041-253">Набор разрешений "Местная интрасеть".</span><span class="sxs-lookup"><span data-stu-id="d4041-253">Local Intranet permission set.</span></span>  <br/> <span data-ttu-id="d4041-254">Сборки, установленные в глобальном кэше сборок (GAC) и отмеченные атрибутом **AllowPartiallyTrustedCallersAttribute**, получают набор разрешений "Полное доверие".</span><span class="sxs-lookup"><span data-stu-id="d4041-254">Assemblies installed in the Global Assembly Cache (GAC) and marked with the **AllowPartiallyTrustedCallersAttribute** attribute are granted the Full Trust permission set.</span></span>  <br/> ||
|<span data-ttu-id="d4041-255">Шаблон формы публикуется в общей папке местной интрасети, например в файловом хранилище, в библиотеке форм SharePoint или на веб-сервере, обозначенном как надежный узел в Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="d4041-255">The form template is published on a shared location in the local intranet, such as a file share, SharePoint Form library, or a Web server that is designated as a Trusted site in Internet Explorer.</span></span>  <br/> |<span data-ttu-id="d4041-256">Набор разрешений "Интернет".</span><span class="sxs-lookup"><span data-stu-id="d4041-256">Internet permission set.</span></span>  <br/> <span data-ttu-id="d4041-257">Сборки, подписанные Майкрософт и ECMA, получают набор разрешений "Полный доступ".</span><span class="sxs-lookup"><span data-stu-id="d4041-257">Assemblies signed by Microsoft and ECMA are granted the Full Trust permission set.</span></span>  <br/> |<span data-ttu-id="d4041-p119">Безопасность доступа к коду CLR обеспечивает только набор разрешений "Интернет" к сайтам, обозначенным как надежные в Internet Explorer. Приложение InfoPath соблюдает эту политику. Обратите внимание, что данная схема отличается от схемы для шаблонов форм InfoPath, использующих скрипт для кода формы, где при публикации в зоне "Надежные узлы" предоставляется более высокий уровень разрешений. </span><span class="sxs-lookup"><span data-stu-id="d4041-p119">CLR code access security grants only the Internet permission set to sites that are designated as Trusted sites in Internet Explorer. InfoPath respects this policy. Note that this is unlike an InfoPath form template that uses script for form code, which receives a higher level of permissions when published in a Trusted sites zone.</span></span>  <br/> |
|<span data-ttu-id="d4041-261">Шаблон формы загружается или копируется с веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="d4041-261">The form template is downloaded or copied from an Internet location.</span></span>  <br/> |<span data-ttu-id="d4041-p120">По умолчанию нет. Сборка управляемого кода для шаблона формы не загружается и не запускается.</span><span class="sxs-lookup"><span data-stu-id="d4041-p120">By default, none. The managed code assembly for the form template is not loaded and does not run.</span></span>  <br/> ||
   
## <a name="see-also"></a><span data-ttu-id="d4041-264">См. также</span><span class="sxs-lookup"><span data-stu-id="d4041-264">See also</span></span>

- [<span data-ttu-id="d4041-265">Настройка параметров безопасности для шаблонов форм с кодом</span><span class="sxs-lookup"><span data-stu-id="d4041-265">Configure Security Settings for Form Templates with Code</span></span>](how-to-configure-security-settings-for-form-templates-with-code.md)
- [<span data-ttu-id="d4041-266">Предварительный просмотр и отладка шаблонов форм, требующих полного доверия</span><span class="sxs-lookup"><span data-stu-id="d4041-266">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)


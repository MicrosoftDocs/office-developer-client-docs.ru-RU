---
title: Реагирование на события формы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- Порядок событий [InfoPath 207], события [InfoPath 2007], реагирование, события [InfoPath 2007], Order, InfoPath 2007, реагирование to Events, классы EventArgs [InfoPath 2007]
localization_priority: Normal
ms.assetid: 754db64b-179f-4385-8dd9-c20c9407b186
description: Можно написать код, реагирующий на различные события, которые могут произойти при заполнении пользователем формы. Для работы с событиями в InfoPath следует добавить обработчики событий при работе с шаблоном формы в режиме конструктора.
ms.openlocfilehash: 0db3209dfe005f2a87ad65f3fc89b1714ec7d95c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300107"
---
# <a name="respond-to-form-events"></a><span data-ttu-id="6ac15-105">Реагирование на события формы</span><span class="sxs-lookup"><span data-stu-id="6ac15-105">Respond to Form Events</span></span>

<span data-ttu-id="6ac15-p102">Можно написать код, реагирующий на различные события, которые могут произойти при заполнении пользователем формы. Для работы с событиями в InfoPath следует добавить обработчики событий при работе с шаблоном формы в режиме конструктора.</span><span class="sxs-lookup"><span data-stu-id="6ac15-p102">You can write code to respond to various events that can occur as a user fills out a form. To work with events in InfoPath, you add event handlers while working with a form template in design mode.</span></span>
  
<span data-ttu-id="6ac15-108">Обработчики событий InfoPath необходимо всегда создавать в режиме конструктора, поскольку приложение InfoPath автоматически добавляет правильное описание для принятия события в метод **InternalStartup** и вставляет структуру кода обработчика событий в файл кода формы (FormCode.cs или FormCode.vb).</span><span class="sxs-lookup"><span data-stu-id="6ac15-108">InfoPath event handlers should always be created in design mode because InfoPath automatically adds the correct declaration for sinking the event to the **InternalStartup** method and inserts the event handler's code skeleton into a form's code file (FormCode.cs or FormCode.vb).</span></span> <span data-ttu-id="6ac15-109">После создания обработчика событий не следует изменять его объявление в файле кода формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-109">After you have created an event handler, you should not alter its declaration in the form's code file.</span></span> 
  
<span data-ttu-id="6ac15-110">Сведения о создании обработчиков событий InfoPath приведены в разделе [Добавление обработчика событий](how-to-add-an-event-handler.md).</span><span class="sxs-lookup"><span data-stu-id="6ac15-110">For information about creating the InfoPath event handlers, see [Add an Event Handler](how-to-add-an-event-handler.md).</span></span>
  
## <a name="overview-of-the-event-classes"></a><span data-ttu-id="6ac15-111">Обзор классов событий</span><span class="sxs-lookup"><span data-stu-id="6ac15-111">Overview of the Event Classes</span></span>

<span data-ttu-id="6ac15-112">Модель InfoPath, предоставляемая пространством имен [Microsoft. Office. InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) , реализует три класса, которые реализуют 12 событий, которые могут быть вызваны и обработаны в бизнес-логике шаблона формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-112">The InfoPath model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace implements three classes that implement the 12 events that can be raised and handled by form template business logic.</span></span> <span data-ttu-id="6ac15-113">В следующей таблице перечисляются все объекты событий InfoPath, объекты, с которыми они связываются, а также описания предоставляемых ими возможностей.</span><span class="sxs-lookup"><span data-stu-id="6ac15-113">The following table lists each of the InfoPath event objects, the events they are associated with, and a description of the functionality they provide.</span></span> 
  
|<span data-ttu-id="6ac15-114">**Name**</span><span class="sxs-lookup"><span data-stu-id="6ac15-114">**Name**</span></span>|<span data-ttu-id="6ac15-115">**События**</span><span class="sxs-lookup"><span data-stu-id="6ac15-115">**Events**</span></span>|<span data-ttu-id="6ac15-116">**Описание**</span><span class="sxs-lookup"><span data-stu-id="6ac15-116">**Description**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="6ac15-117">Буттоневент</span><span class="sxs-lookup"><span data-stu-id="6ac15-117">ButtonEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ButtonEvent.aspx) <br/> |[<span data-ttu-id="6ac15-118">Нажатии</span><span class="sxs-lookup"><span data-stu-id="6ac15-118">Clicked</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ButtonEvent.Clicked.aspx) <br/> |<span data-ttu-id="6ac15-119">Класс **ButtonEvent** внедряет событие **Clicked**, вызываемое при щелчке элемента управления **Кнопка** в форме.</span><span class="sxs-lookup"><span data-stu-id="6ac15-119">The **ButtonEvent** class implements the **Clicked** event that is raised when a **Button** control is clicked on a form.</span></span>  <br/> |
|[<span data-ttu-id="6ac15-120">Формевентс</span><span class="sxs-lookup"><span data-stu-id="6ac15-120">FormEvents</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.aspx) <br/> |[<span data-ttu-id="6ac15-121">ContextChanged</span><span class="sxs-lookup"><span data-stu-id="6ac15-121">ContextChanged</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.ContextChanged.aspx) <br/> [<span data-ttu-id="6ac15-122">Загрузки</span><span class="sxs-lookup"><span data-stu-id="6ac15-122">Loading</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Loading.aspx) <br/> [<span data-ttu-id="6ac15-123">Merge</span><span class="sxs-lookup"><span data-stu-id="6ac15-123">Merge</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Merge.aspx) <br/> [<span data-ttu-id="6ac15-124">Save</span><span class="sxs-lookup"><span data-stu-id="6ac15-124">Save</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Save.aspx) <br/> [<span data-ttu-id="6ac15-125">Sign</span><span class="sxs-lookup"><span data-stu-id="6ac15-125">Sign</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Sign.aspx) <br/> [<span data-ttu-id="6ac15-126">Отправить</span><span class="sxs-lookup"><span data-stu-id="6ac15-126">Submit</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.Submit.aspx) <br/> [<span data-ttu-id="6ac15-127">VersionUpgrade</span><span class="sxs-lookup"><span data-stu-id="6ac15-127">VersionUpgrade</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.VersionUpgrade.aspx) <br/> [<span data-ttu-id="6ac15-128">ViewSwitched</span><span class="sxs-lookup"><span data-stu-id="6ac15-128">ViewSwitched</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormEvents.ViewSwitched.aspx) <br/> |<span data-ttu-id="6ac15-129">Класс **FormEvents** внедряет события, специфичные для самого шаблона формы InfoPath:</span><span class="sxs-lookup"><span data-stu-id="6ac15-129">The **FormEvents** class implements the events that are specific to an InfoPath form template itself:</span></span>  <br/> <span data-ttu-id="6ac15-130">**ContextChanged**</span><span class="sxs-lookup"><span data-stu-id="6ac15-130">**ContextChanged**</span></span> <br/> <span data-ttu-id="6ac15-131">Создается после изменения узла контекста.</span><span class="sxs-lookup"><span data-stu-id="6ac15-131">Occurs after the context node changes.</span></span>  <br/> <span data-ttu-id="6ac15-132">**Загрузки**</span><span class="sxs-lookup"><span data-stu-id="6ac15-132">**Loading**</span></span> <br/> <span data-ttu-id="6ac15-133">Создается после загрузки шаблона формы, но до инициализации какого-либо представления.</span><span class="sxs-lookup"><span data-stu-id="6ac15-133">Occurs when the form template has been loaded, but before any views have been initialized.</span></span>  <br/> <span data-ttu-id="6ac15-134">**Merge**</span><span class="sxs-lookup"><span data-stu-id="6ac15-134">**Merge**</span></span> <br/> <span data-ttu-id="6ac15-135">Возникает при вызове команды " **Объединить формы** " из пользовательского интерфейса или при запуске InfoPath с параметром `/aggregate` командной строки.</span><span class="sxs-lookup"><span data-stu-id="6ac15-135">Occurs when the **Merge Forms** command is invoked from the user interface, or InfoPath is started with the  `/aggregate` command-line switch.</span></span>  <br/> <span data-ttu-id="6ac15-136">**Save**</span><span class="sxs-lookup"><span data-stu-id="6ac15-136">**Save**</span></span> <br/> <span data-ttu-id="6ac15-137">Возникает при использовании в пользовательском интерфейсе команд " **сохранить** " или " **Сохранить как** " или при использовании методов [Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) и [SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) для класса [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6ac15-137">Occurs when the **Save** or **Save As** commands are used from the user interface, or when the [Save](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Save.aspx) and [SaveAs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) methods of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class are used.</span></span>  <br/> <span data-ttu-id="6ac15-138">**Sign**</span><span class="sxs-lookup"><span data-stu-id="6ac15-138">**Sign**</span></span> <br/> <span data-ttu-id="6ac15-139">Создается после того, как набор подписанных данных был выбран для подписи в диалоговом окне **Цифровые подписи**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-139">Occurs after a set of signed data has been selected to sign through the **Digital Signatures** dialog box.</span></span>  <br/> <span data-ttu-id="6ac15-140">**Отправить**</span><span class="sxs-lookup"><span data-stu-id="6ac15-140">**Submit**</span></span> <br/> <span data-ttu-id="6ac15-141">Возникает при использовании команды " **послать** " из пользовательского интерфейса или при использовании метода " [послать](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) " класса **XmlForm** .</span><span class="sxs-lookup"><span data-stu-id="6ac15-141">Occurs when the **Submit** command is used from the user interface, or the [Submit](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Submit.aspx) method of the **XmlForm** class is used.</span></span>  <br/> <span data-ttu-id="6ac15-142">**VersionUpgrade**</span><span class="sxs-lookup"><span data-stu-id="6ac15-142">**VersionUpgrade**</span></span> <br/> <span data-ttu-id="6ac15-143">Создается, если номер версии открываемой формы старше номера версии шаблона формы, на котором она основана.</span><span class="sxs-lookup"><span data-stu-id="6ac15-143">Occurs when the version number of the form being opened is older than the version number of the form template on which it is based.</span></span>  <br/> <span data-ttu-id="6ac15-144">**ViewSwitched**</span><span class="sxs-lookup"><span data-stu-id="6ac15-144">**ViewSwitched**</span></span> <br/> <span data-ttu-id="6ac15-145">Создается после успешного переключения представления формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-145">Occurs after a view of a form has been successfully switched.</span></span>  <br/> |
|[<span data-ttu-id="6ac15-146">XmlEvent</span><span class="sxs-lookup"><span data-stu-id="6ac15-146">XmlEvent</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.aspx) <br/> |[<span data-ttu-id="6ac15-147">Изменяем</span><span class="sxs-lookup"><span data-stu-id="6ac15-147">Changed</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) <br/> [<span data-ttu-id="6ac15-148">Изменениях</span><span class="sxs-lookup"><span data-stu-id="6ac15-148">Changing</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changing.aspx) <br/> [<span data-ttu-id="6ac15-149">Нарушение</span><span class="sxs-lookup"><span data-stu-id="6ac15-149">Validating</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Validating.aspx) <br/> |<span data-ttu-id="6ac15-150">Внедряет события, порождаемые изменениями данных в базовом XML-документе экземпляра формы:</span><span class="sxs-lookup"><span data-stu-id="6ac15-150">Implements the events raised by changes to the data in the underlying XML document of a form instance:</span></span>  <br/> <span data-ttu-id="6ac15-151">**Изменяем**</span><span class="sxs-lookup"><span data-stu-id="6ac15-151">**Changed**</span></span> <br/> <span data-ttu-id="6ac15-152">Возникает после принятия изменений в базовом XML-документе формы и после возникновения события **Validating**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-152">Occurs after changes to a form's underlying XML document have been accepted and after the **Validating** event has occurred.</span></span>  <br/> <span data-ttu-id="6ac15-153">**Изменениях**</span><span class="sxs-lookup"><span data-stu-id="6ac15-153">**Changing**</span></span> <br/> <span data-ttu-id="6ac15-154">Создается после изменений в связанном XML-документе формы, но до принятия этих изменений.</span><span class="sxs-lookup"><span data-stu-id="6ac15-154">Occurs after changes to a form's underlying XML document have been made but before the changes have been accepted.</span></span>  <br/> <span data-ttu-id="6ac15-155">**Нарушение**</span><span class="sxs-lookup"><span data-stu-id="6ac15-155">**Validating**</span></span> <br/> <span data-ttu-id="6ac15-156">Возникает после принятия изменений в базовом XML-документе формы, но до возникновения события **Changed**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-156">Occurs after changes to a form's underlying XML document have been accepted but before the **Changed** event has occurred.</span></span>  <br/> <span data-ttu-id="6ac15-157">Класс **XmlEvent** также реализует свойство [раисеундоредофорчанжед](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.RaiseUndoRedoForChanged.aspx) , которое получает или задает значение, указывающее, будет ли событие **Changed** вызываться при выполнении операции отмены или повтора.</span><span class="sxs-lookup"><span data-stu-id="6ac15-157">The **XmlEvent** class also implements the [RaiseUndoRedoForChanged](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.RaiseUndoRedoForChanged.aspx) property, which gets or sets whether the **Changed** event will be raised when an undo or redo operation occurs.</span></span>  <br/> |
   
> [!NOTE]
>  <span data-ttu-id="6ac15-158">События Changed \*\*\*\* и **Changed** срабатывают только один раз при внесении изменений в непустое поле формы, в то время как сравнимые события в InfoPath 2003 и объектной модели, совместимой с InfoPath 2003, предоставляемые [ Пространство имен Microsoft. Office. Interop. InfoPath. SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) ( [OnBeforeChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) и [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) ) активируется дважды для изменений непустого поля: один раз при удалении старого значения и повторно при вставке нового значения.</span><span class="sxs-lookup"><span data-stu-id="6ac15-158">The **Changed** and **Changing** events fire only once when a change is made in a non-blank field in the form, whereas the comparable events in InfoPath 2003 and the InfoPath 2003-compatible object model provided by the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace ( [OnBeforeChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnBeforeChange.aspx) and [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) ) fire twice on changes to a non-blank field: once when the old value is deleted, and again when the new value is inserted.</span></span> 
  
## <a name="overview-of-the-eventargs-classes"></a><span data-ttu-id="6ac15-159">Обзор класса EventArgs</span><span class="sxs-lookup"><span data-stu-id="6ac15-159">Overview of the EventArgs Classes</span></span>

<span data-ttu-id="6ac15-160">Каждое из 12 событий использует объект **EventArgs**, связанный с событием и передаваемый обработчику соответствующих событий для предоставления сведений о состоянии и других возможностей, которые можно использовать в коде обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="6ac15-160">Each of the 12 events have an **EventArgs** object associated with the event that are passed to the event handler for the event to provide state information and other functionality that can be used in the event handler code.</span></span> <span data-ttu-id="6ac15-161">В следующей таблице перечисляются события InfoPath с соответствующими им объектами  **EventArgs** и краткие описания возможностей, предоставляемых свойствами и методами каждого объекта.</span><span class="sxs-lookup"><span data-stu-id="6ac15-161">The following table lists the InfoPath events with their associated **EventArgs** objects and a brief description of the functionality provided by the properties and methods of the object.</span></span> <span data-ttu-id="6ac15-162">Подробные сведения о конкретных свойствах и методах объектов можно вызвать, щелкнув имя объекта **EventArgs** в таблице, а затем щелкнув ссылку "Элементы" в теме.</span><span class="sxs-lookup"><span data-stu-id="6ac15-162">For details on the specific properties and methods of the object, click the name of the **EventArgs** object in the table, and then click on the Members link in the topic.</span></span> 
  
|<span data-ttu-id="6ac15-163">**Event**</span><span class="sxs-lookup"><span data-stu-id="6ac15-163">**Event**</span></span>|<span data-ttu-id="6ac15-164">**Класс EventsArgs**</span><span class="sxs-lookup"><span data-stu-id="6ac15-164">**EventsArgs Class**</span></span>|<span data-ttu-id="6ac15-165">**Описание**</span><span class="sxs-lookup"><span data-stu-id="6ac15-165">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="6ac15-166">**Нажатии**</span><span class="sxs-lookup"><span data-stu-id="6ac15-166">**Clicked**</span></span> <br/> |[<span data-ttu-id="6ac15-167">Кликкедевентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-167">ClickedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ClickedEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-168">Возвращает идентификатор элемента управления.</span><span class="sxs-lookup"><span data-stu-id="6ac15-168">Gets the control ID.</span></span>  <br/> <span data-ttu-id="6ac15-169">Возвращает объект **XPathNavigator**, располагающийся в наиболее вложенном XML-узле базового XML-документа формы, содержащего элемент управления **Кнопка**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-169">Get an **XPathNavigator** object positioned at the innermost XML node of the form's underlying XML document that contains the **Button** control.</span></span>  <br/> |
|<span data-ttu-id="6ac15-170">**ContextChanged**</span><span class="sxs-lookup"><span data-stu-id="6ac15-170">**ContextChanged**</span></span> <br/> |[<span data-ttu-id="6ac15-171">Контекстчанжедевентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-171">ContextChangedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ContextChangedEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-172">Возвращает тип изменения контекста, выполняемого при возникновении события.</span><span class="sxs-lookup"><span data-stu-id="6ac15-172">Gets the type of context change that was performed when the event occurred.</span></span>  <br/> <span data-ttu-id="6ac15-173">Возвращает значение, указывающее, возникает ли событие изменения контекста в ответ на операцию отмены или повтора действия. </span><span class="sxs-lookup"><span data-stu-id="6ac15-173">Gets a value indicating whether the context change event occurred in response to undoing or redoing an operation.</span></span>  <br/> <span data-ttu-id="6ac15-174">Возвращает ссылку на объект **XPathNavigator**, расположенный в контекстном узле, породившем событие. </span><span class="sxs-lookup"><span data-stu-id="6ac15-174">Gets a reference to an **XPathNavigator** positioned at the context node that raised the event.</span></span>  <br/> |
|<span data-ttu-id="6ac15-175">**Загрузки**</span><span class="sxs-lookup"><span data-stu-id="6ac15-175">**Loading**</span></span> <br/> |[<span data-ttu-id="6ac15-176">Лоадинжевентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-176">LoadingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-177">Указывает представление, в котором будет открыта форма после загрузки.</span><span class="sxs-lookup"><span data-stu-id="6ac15-177">Specifies the view in which to open the form after loading.</span></span>  <br/> <span data-ttu-id="6ac15-178">Возвращает ссылку на объект **XmlFormCancelEventArgs**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-178">Gets a reference to the **XmlFormCancelEventArgs** object.</span></span>  <br/> <span data-ttu-id="6ac15-179">Получает объект **IDictionary** , содержащий все входные параметры, `/InputParameters` указанные с помощью параметра командной строки, или заданный с помощью параметров запроса в URL-адресе для открытия формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-179">Gets an **IDictionary** containing any input parameters specified using the  `/InputParameters` command-line option, or specified using query parameters in a URL to open the form.</span></span>  <br/> |
|<span data-ttu-id="6ac15-180">**Merge**</span><span class="sxs-lookup"><span data-stu-id="6ac15-180">**Merge**</span></span> <br/> |[<span data-ttu-id="6ac15-181">Мержеевентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-181">MergeEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.MergeEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-182">Возвращает ссылку на объект **XmlFormCancelEventArgs**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-182">Gets a reference to the **XmlFormCancelEventArgs** object.</span></span>  <br/> <span data-ttu-id="6ac15-183">Возвращает количество форм, объединенных в операции объединения.</span><span class="sxs-lookup"><span data-stu-id="6ac15-183">Gets the count of the number of forms being merged in a merging operation.</span></span>  <br/> <span data-ttu-id="6ac15-184">Возвращает индекс объединяемой в данный момент формы (начиная с нуля).</span><span class="sxs-lookup"><span data-stu-id="6ac15-184">Gets the zero-based index of the form that is currently being merged.</span></span>  <br/> <span data-ttu-id="6ac15-185">Возвращает или задает значение, которое используется с свойством **Cancel** для определения выбора отмены только текущей формы или всей операции объединения. </span><span class="sxs-lookup"><span data-stu-id="6ac15-185">Gets or sets a value that is used with the **Cancel** property to determine whether to cancel only the current form or the entire merging operation.</span></span>  <br/> <span data-ttu-id="6ac15-186">Возвращает объект **XPathNavigator**, размещенный в корневом узле связанного XML-документа текущей объединяемой формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-186">Gets an **XPathNavigator** object positioned at the root node of the underlying XML document of the form that is currently being merged.</span></span>  <br/> |
|<span data-ttu-id="6ac15-187">**Save**</span><span class="sxs-lookup"><span data-stu-id="6ac15-187">**Save**</span></span> <br/> |[<span data-ttu-id="6ac15-188">Савивентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-188">SaveEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SaveEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-189">Выполняет операцию сохранения, запрошенную пользователем.</span><span class="sxs-lookup"><span data-stu-id="6ac15-189">Performs the save operation requested by the user.</span></span>  <br/> <span data-ttu-id="6ac15-190">Возвращает ссылку на объект **SaveCancelEventArgs**, который можно использовать для отмены события.</span><span class="sxs-lookup"><span data-stu-id="6ac15-190">Gets a reference to the **SaveCancelEventArgs** object that can be used to cancel the event.</span></span>  <br/> <span data-ttu-id="6ac15-191">Возвращает имя файла для использования в обработчике событий применительно к данному событию.</span><span class="sxs-lookup"><span data-stu-id="6ac15-191">Gets the file name to be used in the event handler for the event.</span></span>  <br/> <span data-ttu-id="6ac15-192">Возвращает выбор для операции сохранения: "сохранить" или "сохранить как". </span><span class="sxs-lookup"><span data-stu-id="6ac15-192">Gets whether the save operation will be performed as a "save" operation or as a "save as" operation.</span></span>  <br/> |
|<span data-ttu-id="6ac15-193">**Sign**</span><span class="sxs-lookup"><span data-stu-id="6ac15-193">**Sign**</span></span> <br/> |[<span data-ttu-id="6ac15-194">Сигневентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-194">SignEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SignEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-195">Возвращает или задает факт отображения диалогового окна **Цифровые подписи**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-195">Gets or sets whether to display the **Digital Signatures** dialog box.</span></span>  <br/> <span data-ttu-id="6ac15-196">Возвращает набор подписываемых данных, порождаемых событием.</span><span class="sxs-lookup"><span data-stu-id="6ac15-196">Gets the set of signable data that raised the event.</span></span>  <br/> |
|<span data-ttu-id="6ac15-197">**Отправить**</span><span class="sxs-lookup"><span data-stu-id="6ac15-197">**Submit**</span></span> <br/> |[<span data-ttu-id="6ac15-198">Субмитевентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-198">SubmitEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SubmitEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-199">Возвращает ссылку на объект **XmlFormCancelEventArgs** для отмены события.</span><span class="sxs-lookup"><span data-stu-id="6ac15-199">Gets a reference to the **XmlFormCancelEventArgs** object for cancelling the event.</span></span>  <br/> |
|<span data-ttu-id="6ac15-200">**VersionUpgrade**</span><span class="sxs-lookup"><span data-stu-id="6ac15-200">**VersionUpgrade**</span></span> <br/> |[<span data-ttu-id="6ac15-201">Версионупградивентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-201">VersionUpgradeEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.VersionUpgradeEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-202">Возвращает ссылку на объект **XmlFormCancelEventArgs** для отмены события.</span><span class="sxs-lookup"><span data-stu-id="6ac15-202">Gets a reference to the **XmlFormCancelEventArgs** object for cancelling the event.</span></span>  <br/> <span data-ttu-id="6ac15-203">Возвращает номер версии обновляемого документа формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-203">Gets the version number of the form document being upgraded.</span></span>  <br/> <span data-ttu-id="6ac15-204">Возвращает номер версии шаблона формы, связанного с обновляемой формой.</span><span class="sxs-lookup"><span data-stu-id="6ac15-204">Gets the version number of the form template associated with the form being upgraded.</span></span>  <br/> |
|<span data-ttu-id="6ac15-205">**ViewSwitched**</span><span class="sxs-lookup"><span data-stu-id="6ac15-205">**ViewSwitched**</span></span> <br/> |[<span data-ttu-id="6ac15-206">Виевсвитчедевентаргс</span><span class="sxs-lookup"><span data-stu-id="6ac15-206">ViewSwitchedEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.ViewSwitchedEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-207">Класс **ViewSwitchedEventArgs** не предоставляет свойств и методов для событий, отличных от наследуемых из объекта **System.Object**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-207">The **ViewSwitchedEventArgs** class does not provide any properties and methods for the event other than those inherited from **System.Object**.</span></span>  <br/> |
|<span data-ttu-id="6ac15-208">**Изменяем**</span><span class="sxs-lookup"><span data-stu-id="6ac15-208">**Changed**</span></span> <br/> |[<span data-ttu-id="6ac15-209">XmlEventArgs</span><span class="sxs-lookup"><span data-stu-id="6ac15-209">XmlEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-210">Возвращает объект **XPathExpression**, содержащий выражение XPath, которое возвращает изменяемый в данный момент узел.</span><span class="sxs-lookup"><span data-stu-id="6ac15-210">Gets an **XPathExpression** object which contains an XPath expression that returns the node that is currently being changed.</span></span>  <br/> <span data-ttu-id="6ac15-211">Возвращает новое значение для изменяемого узла.</span><span class="sxs-lookup"><span data-stu-id="6ac15-211">Gets the new value for the node being changed.</span></span>  <br/> <span data-ttu-id="6ac15-212">Возвращает объект **XPathNavigator**, указывающий на узел, являющийся родительским для удаляемого узла.</span><span class="sxs-lookup"><span data-stu-id="6ac15-212">Gets an **XPathNavigator** object pointing to the node which is the parent of the node being deleted.</span></span>  <br/> <span data-ttu-id="6ac15-213">Возвращает начальное значение изменяемого узла.</span><span class="sxs-lookup"><span data-stu-id="6ac15-213">Gets the original value of the node that is being changed.</span></span>  <br/> <span data-ttu-id="6ac15-214">Получает перечисление [ксмлоператион](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlOperation.aspx) , которое указывает тип операции, произошедшей при изменении узла.</span><span class="sxs-lookup"><span data-stu-id="6ac15-214">Gets an [XmlOperation](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlOperation.aspx) enumeration that indicates the type of operation that occurred when the node was changed.</span></span>  <br/> <span data-ttu-id="6ac15-215">Возвращает объект **XPathNavigator**, указывающий на изменяемый узел.</span><span class="sxs-lookup"><span data-stu-id="6ac15-215">Gets an **XPathNavigator** object pointing at the node that is being changed.</span></span>  <br/> <span data-ttu-id="6ac15-216">Возвращает значение, которое указывает, является ли изменяемый узел частью операции отмены или возращения.</span><span class="sxs-lookup"><span data-stu-id="6ac15-216">Gets a value that indicates whether the node being changed is part of an undo or redo operation.</span></span>  <br/> |
|<span data-ttu-id="6ac15-217">**Изменениях**</span><span class="sxs-lookup"><span data-stu-id="6ac15-217">**Changing**</span></span> <br/> |[<span data-ttu-id="6ac15-218">XmlChangingEventArgs</span><span class="sxs-lookup"><span data-stu-id="6ac15-218">XmlChangingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-219">Возвращает объект **XmlFormCancelEventArgs**, связанный с событием.</span><span class="sxs-lookup"><span data-stu-id="6ac15-219">Gets an **XmlFormCancelEventArgs** object associated with the event.</span></span>  <br/> <span data-ttu-id="6ac15-220">Наследует все возможности, перечисленные выше для объекта **XmlEventArgs**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-220">Inherits all of the functionality listed above for the **XmlEventArgs** object.</span></span>  <br/> |
|<span data-ttu-id="6ac15-221">**Нарушение**</span><span class="sxs-lookup"><span data-stu-id="6ac15-221">**Validating**</span></span> <br/> |[<span data-ttu-id="6ac15-222">XmlValidatingEventArgs</span><span class="sxs-lookup"><span data-stu-id="6ac15-222">XmlValidatingEventArgs</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) <br/> |<span data-ttu-id="6ac15-223">Создает объект [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) , который содержит настраиваемые сведения об ошибке с указанными значениями, и добавляет их в объект [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) формы.</span><span class="sxs-lookup"><span data-stu-id="6ac15-223">Creates a [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) object that contains custom error information with the specified values and adds it to the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) object of the form.</span></span>  <br/> <span data-ttu-id="6ac15-224">Наследует все возможности, перечисленные выше для объекта **XmlEventArgs**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-224">Inherits all of the functionality listed above for the **XmlEventArgs** object.</span></span>  <br/> |
   
## <a name="using-the-eventargs-objects"></a><span data-ttu-id="6ac15-225">Использование объектов EventArgs</span><span class="sxs-lookup"><span data-stu-id="6ac15-225">Using the EventArgs Objects</span></span>

<span data-ttu-id="6ac15-226">При создании обработчика событий приложение InfoPath создает объявление обработчика событий в коде формы проекта.</span><span class="sxs-lookup"><span data-stu-id="6ac15-226">When you create an event handler, InfoPath creates the event handler's declaration in the project's form code.</span></span> <span data-ttu-id="6ac15-227">В объявлении обработчика событий приложение InfoPath использует **e** в качестве имени параметра, передаваемого обработчику событий.</span><span class="sxs-lookup"><span data-stu-id="6ac15-227">In the declaration of the event handler, InfoPath uses **e** as the name of the parameter that is passed to the event handler.</span></span> <span data-ttu-id="6ac15-228">Этот параметр содержит объект **EventArgs**, который связан с обработчиком событий и используется для предоставления сведений о состоянии и других возможностей при возникновении события.</span><span class="sxs-lookup"><span data-stu-id="6ac15-228">This parameter contains the **EventArgs** object that is associated with the event handler for providing state information and other functionality when the event occurs.</span></span> 
  
<span data-ttu-id="6ac15-229">Например, при создании обработчика событий для события Loading \*\*\*\* в режиме конструктора (выбрав пункт **Загрузка события** на вкладке **разработчик** ), InfoPath добавляет объявление обработчика событий, который получает объект [лоадинжевентаргс](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) в файл кода формы, а затем открывает редактор кода, чтобы можно было добавить код в следующее объявление обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="6ac15-229">For example, when you create an event handler for the **Loading** event in design mode (by clicking **Loading Event** menu on the **Developer** tab), InfoPath adds the declaration for the event handler that receives the [LoadingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.LoadingEventArgs.aspx) object to the form code file, and then opens the code editor so that you can add your code to the following event handler declaration.</span></span> 
  
```cs
public void FormEvents_Loading(object sender, LoadingEventArgs e)
{
   // Write your code here.
}
```

```vb
Public Sub FormEvents_Loading(ByVal sender As Object, _
   ByVal e As LoadingEventArgs)
   ' Write your code here.
End Sub
```

<span data-ttu-id="6ac15-230">При написании кода для обработчика событий можно использовать свойства и методы, реализуемые объектом **EventArgs**, который передается через параметр **e**.</span><span class="sxs-lookup"><span data-stu-id="6ac15-230">When writing code for an event handler, you can use the properties and methods implemented by the **EventArgs** object that is passed through the **e** parameter.</span></span> <span data-ttu-id="6ac15-231">Например, в следующем обработчике события **изменения** свойство [newValue](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.NewValue.aspx) объекта [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) (которое наследуется от класса [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) ) используется для проверки значения только что измененного поля.</span><span class="sxs-lookup"><span data-stu-id="6ac15-231">For example, in the following **Changing** event handler, the [NewValue](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.NewValue.aspx) property of the [XmlChangingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.aspx) object (which is inherited from the [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) class) is used to check the value of the field that was just changed.</span></span> <span data-ttu-id="6ac15-232">Если пользователь изменил поле и оставил его пустым, свойство [Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.Message.aspx) класса [XmlFormCancelEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.aspx) вызывается с помощью свойства [CancelableArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.CancelableArgs.aspx) объекта **XmlChangingEventArgs** для отображения ошибки для пользователя, а для свойства **XmlFormCancelEventArgs. Cancel** задано **значение true**, отмена события и откат изменений, внесенных пользователем.</span><span class="sxs-lookup"><span data-stu-id="6ac15-232">If the user changed the field and left it blank, the [Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.Message.aspx) property of the [XmlFormCancelEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlFormCancelEventArgs.aspx) class is accessed using the [CancelableArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlChangingEventArgs.CancelableArgs.aspx) property of the **XmlChangingEventArgs** object to display an error to the user, and the **XmlFormCancelEventArgs.Cancel** property is set to **true**, to cancel the event and roll back the changes the user made.</span></span>
  
```cs
public void field1_Changing(object sender, LoadingEventArgs e)
{
   // Determine whether there is a new value.
   if (e.NewValue == "")
   {
      // The value is blank, so display an error message
      // and roll back the changes.
      e.CancelableArgs.Message = 
         "You must supply a value for this field.";
      e.CancelableArgs.Cancel = true;
      return;
   }
}
```

```vb
Public Sub field1_Changing(ByVal sender As Object, _
   ByVal e As LoadingEventArgs)
   ' Determine whether there is a new value.
   If (e.NewValue = "") Then
      ' The value is blank, so display an error message 
      ' and roll back the changes.
      e.CancelableArgs.Message = _
         "You must supply a value for this field."
      e.CancelableArgs.Cancel = True
      Return
   End If
End Sub
```



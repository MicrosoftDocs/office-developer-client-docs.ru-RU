---
title: Работа с представлениями, использующих объектную модель InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- шаблоны форм с поддержкой 2003 InfoPath, представлений, представлений [InfoPath 2007], совместимых с InfoPath 2003 шаблонов форм
localization_priority: Normal
ms.assetid: feb1bfcb-1cb1-4d5c-bc84-df86a33a5934
description: При работе с шаблона формы InfoPath можно написать код для доступа к представлениям формы и выполните ряд действий на данные, которые содержат представления. Объектная модель совместимых с InfoPath 2003 поддерживает доступ к представлений формы посредством использования члены интерфейса ViewObject.
ms.openlocfilehash: 1cbc472993ff18b26f31e3bc28b12a75e559644a
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807507"
---
# <a name="work-with-views-using-the-infopath-2003-object-model"></a><span data-ttu-id="3caea-105">Работа с представлениями, использующих объектную модель InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="3caea-105">Work with Views Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="3caea-106">При работе с шаблона формы InfoPath можно написать код для доступа к представлениям формы и выполните ряд действий на данные, которые содержат представления.</span><span class="sxs-lookup"><span data-stu-id="3caea-106">When working with an InfoPath form template, you can write code to access the form's views, and then perform a variety of actions on the data that the views contain.</span></span> <span data-ttu-id="3caea-107">Объектная модель совместимых с InfoPath 2003 поддерживает доступ к представлений формы посредством использования члены интерфейса [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3caea-107">The InfoPath 2003-compatible object model supports access to a form's views through the use of the members of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) interface.</span></span> 
  
## <a name="overview-of-the-viewobject-interface"></a><span data-ttu-id="3caea-108">Обзор интерфейса ViewObject</span><span class="sxs-lookup"><span data-stu-id="3caea-108">Overview of the ViewObject Interface</span></span>

<span data-ttu-id="3caea-109">Интерфейса [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) предоставляет следующие методы и свойства, которые могут использоваться разработчиками форм для взаимодействия с представлением InfoPath.</span><span class="sxs-lookup"><span data-stu-id="3caea-109">The [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) interface provides the following methods and properties, which form developers can use to interact with an InfoPath view.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="3caea-110">Методы и свойства интерфейса [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) недоступны во время события [OnLoad](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnLoad.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3caea-110">The methods and properties of the [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) interface are not available during the [OnLoad](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocumentEventSink2_Event.OnLoad.aspx) event.</span></span> 
  
|<span data-ttu-id="3caea-111">**Имя**</span><span class="sxs-lookup"><span data-stu-id="3caea-111">**Name**</span></span>|<span data-ttu-id="3caea-112">**Описание**</span><span class="sxs-lookup"><span data-stu-id="3caea-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3caea-113">Метод [DisableAutoUpdate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.DisableAutoUpdate.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-113">[DisableAutoUpdate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.DisableAutoUpdate.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-114">Отключает синхронизацию модели XML DOM и представления.</span><span class="sxs-lookup"><span data-stu-id="3caea-114">Disables synchronization of the XML Document Object Model (DOM) and the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-115">Метод [EnableAutoUpdate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.EnableAutoUpdate.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-115">[EnableAutoUpdate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.EnableAutoUpdate.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-116">Включает синхронизацию модели XML DOM и представления.</span><span class="sxs-lookup"><span data-stu-id="3caea-116">Enables synchronization of the XML DOM and the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-117">Метод [ExecuteAction](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.ExecuteAction.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-117">[ExecuteAction](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.ExecuteAction.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-118">Выполняет действие редактирования InfoPath.</span><span class="sxs-lookup"><span data-stu-id="3caea-118">Executes an InfoPath editing action.</span></span>  <br/> |
|<span data-ttu-id="3caea-119">Метод [Export](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Export.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-119">[Export](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Export.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-120">Экспортирует представление в файл указанного формата.</span><span class="sxs-lookup"><span data-stu-id="3caea-120">Exports the view as a file of the specified format.</span></span>  <br/> |
|<span data-ttu-id="3caea-121">Метод [ForceUpdate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.ForceUpdate.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-121">[ForceUpdate](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.ForceUpdate.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-122">Синхронизирует модель XML DOM и представление.</span><span class="sxs-lookup"><span data-stu-id="3caea-122">Synchronizes the XML DOM and the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-123">Метод [GetContextNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.GetContextNodes.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-123">[GetContextNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.GetContextNodes.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-124">Возвращает ссылку на интерфейс [XMLNodesCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XMLNodesCollection.aspx) , основываясь на указанном XML узле и контексте представления или текущем выделении в представлении.</span><span class="sxs-lookup"><span data-stu-id="3caea-124">Returns a reference to the [XMLNodesCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XMLNodesCollection.aspx) interface, based on the specified XML node and view context or on the current selection in the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-125">Метод [GetSelectedNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.GetSelectedNodes.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-125">[GetSelectedNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.GetSelectedNodes.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-126">Возвращает ссылку на интерфейс **XMLNodesCollection** , основываясь на текущем выделении в представлении.</span><span class="sxs-lookup"><span data-stu-id="3caea-126">Returns a reference to the **XMLNodesCollection** interface, based on the current selection in the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-127">Метод [SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectNodes.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-127">[SelectNodes](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectNodes.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-128">Выбирает диапазон XML-узлов в представлении.</span><span class="sxs-lookup"><span data-stu-id="3caea-128">Selects a range of XML nodes in the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-129">Метод [SelectText](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectText.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-129">[SelectText](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SelectText.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-130">Выбирает текст, содержащийся в указанном XML-узле в представлении.</span><span class="sxs-lookup"><span data-stu-id="3caea-130">Selects the text contained in the specified XML node in the view.</span></span>  <br/> |
|<span data-ttu-id="3caea-131">Метод [SwitchView](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SwitchView.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-131">[SwitchView](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.SwitchView.aspx) method</span></span>  <br/> |<span data-ttu-id="3caea-132">Переключает форму InfoPath в указанное представление. </span><span class="sxs-lookup"><span data-stu-id="3caea-132">Switches an InfoPath form to the specified view</span></span>  <br/> |
|<span data-ttu-id="3caea-133">Свойство [Name](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Name.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-133">[Name](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Name.aspx) property</span></span>  <br/> |<span data-ttu-id="3caea-134">Возвращает строковое значение, указывающее имя текущего представления.</span><span class="sxs-lookup"><span data-stu-id="3caea-134">Returns a string value indicating the name of the current view.</span></span>  <br/> |
|<span data-ttu-id="3caea-135">Свойство [Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Window.aspx)</span><span class="sxs-lookup"><span data-stu-id="3caea-135">[Window](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.View.Window.aspx) property</span></span>  <br/> |<span data-ttu-id="3caea-136">Возвращает ссылку на интерфейс [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowObject.aspx) , который осуществляет доступ к **окно** , связанное с представлением.</span><span class="sxs-lookup"><span data-stu-id="3caea-136">Returns a reference to the [WindowObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.WindowObject.aspx) interface which accesses the **Window** associated with the view.</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="3caea-137">Объектная модель совместимых с InfoPath 2003 также предоставляет интерфейс [ViewInfosCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewInfosCollection.aspx) , который можно использовать для получения сведений обо всех представлениях, реализованных в форме.</span><span class="sxs-lookup"><span data-stu-id="3caea-137">The InfoPath 2003-compatible object model also provides the [ViewInfosCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewInfosCollection.aspx) interface, which can be used to get information about all of the views implemented in a form.</span></span> 
  
## <a name="using-the-viewobject-interface"></a><span data-ttu-id="3caea-138">Использование интерфейса ViewObject</span><span class="sxs-lookup"><span data-stu-id="3caea-138">Using the ViewObject Interface</span></span>

<span data-ttu-id="3caea-139">Интерфейса [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) доступен через свойство [представления](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.View.aspx) интерфейса [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) (которого осуществляется с помощью `thisXDocument` переменную, которая инициализируется в `_Startup` метод класса кода формы).</span><span class="sxs-lookup"><span data-stu-id="3caea-139">The [ViewObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewObject.aspx) interface is accessed through the [View](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument2.View.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) interface (which is accessed through the  `thisXDocument` variable that is initialized in the  `_Startup` method of the form code class).</span></span> <span data-ttu-id="3caea-140">Например в следующем примере кода показано, как [оповещения](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.Alert.aspx) метод интерфейса [UIObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UIObject.aspx) используется для отображения окна сообщения с именем текущего представления, связанного с XML-документом формы.</span><span class="sxs-lookup"><span data-stu-id="3caea-140">For example, the following code sample demonstrates how to use the [Alert](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UI2.Alert.aspx) method of the [UIObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.UIObject.aspx) interface to display a message box with the name of the current view that is associated with a form's underlying XML document.</span></span> 
  
```cs
thisXDocument.UI.Alert("Current view name: " + 
   thisXDocument.View.Name);
```

```vb
thisXDocument.UI.Alert("Current view name: " &amp; _
   thisXDocument.View.Name)
```

<span data-ttu-id="3caea-141">Все формы InfoPath содержат по крайней мере один представление по умолчанию; Тем не менее InfoPath поддерживает создание нескольких представлений формы XML-документом.</span><span class="sxs-lookup"><span data-stu-id="3caea-141">All InfoPath forms contain at least one default view; however, InfoPath also supports the creation of multiple views of a form's underlying XML document.</span></span> <span data-ttu-id="3caea-142">При наличии нескольких представлений в форме объект **представления** можно использовать для работы с представлением активной.</span><span class="sxs-lookup"><span data-stu-id="3caea-142">When you have multiple views in a form, the **View** object can be used to work with the view that is currently active.</span></span> <span data-ttu-id="3caea-143">Программными средствами можно изменить представление, в настоящее время активной, используя метод **SwitchView** объекта **View** , как показано в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="3caea-143">You can programmatically change the view that is currently active by using the **SwitchView** method of the **View** object, as the following code sample demonstrates.</span></span> 
  
```cs
thisXDocument.View.SwitchView("MySecondView");
```

```vb
thisXDocument.View.SwitchView("MySecondView")
```

<span data-ttu-id="3caea-144">Для предыдущего примера для переключения представления будут работать только после открыта форма.</span><span class="sxs-lookup"><span data-stu-id="3caea-144">The previous example for switching a view will work only after the form is opened.</span></span> <span data-ttu-id="3caea-145">Чтобы задать представление по умолчанию во время события **OnLoad** , используйте свойство [IsDefault](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewInfo.IsDefault.aspx) интерфейс [ViewInfoObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewInfoObject.aspx) , как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="3caea-145">To set a default view during the **OnLoad** event, use the [IsDefault](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewInfo.IsDefault.aspx) property of the [ViewInfoObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ViewInfoObject.aspx) interface, as shown in the following example.</span></span> 
  
```cs
thisXDocument.ViewInfos["MyDefaultView"].IsDefault = true;
```

```vb
thisXDocument.ViewInfos("MyDefaultView").IsDefault = True
```



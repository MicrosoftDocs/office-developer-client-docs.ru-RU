---
title: Открытие и преобразование шаблона формы, созданного с помощью набора средств InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- Преобразование шаблонов форм [infopath 2007] на набора инструментов InfoPath, открытие шаблонов форм из шаблонов форм [InfoPath 2007], открыв InfoPath 2007, преобразование шаблонов форм набора инструментов InfoPath, открытие шаблонов форм [InfoPath 2007] шаблонов форм [InfoPath 2007], преобразование, скрипта [InfoPath 2007], преобразование в управляемый код
localization_priority: Normal
ms.assetid: af8eca2e-ba9a-4c37-94af-662815fff518
description: Если создан шаблон формы управляемого кода InfoPath 2003, с помощью одного из средств InfoPath 2003 для Visual Studio и требуется обеспечить совместимость с InfoPath 2003, можно продолжать работать с и дальнейшей разработки проекта шаблона формы, открыв его в Microsoft InfoPath и Visual Studio 2012.
ms.openlocfilehash: 7ca6a676c9db740b6b176783273a523715032387
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807508"
---
# <a name="open-or-convert-a-form-template-created-with-the-infopath-toolkit"></a>Открытие и преобразование шаблона формы, созданного с помощью набора средств InfoPath

Если создан шаблон формы управляемого кода InfoPath 2003, с помощью одного из средств InfoPath 2003 для Visual Studio и требуется обеспечить совместимость с InfoPath 2003, можно продолжать работать с и дальнейшей разработки проекта шаблона формы, открыв его в Microsoft InfoPath и Visual Studio 2012.
  
Кроме того можно перенос и обновление кода в проекте InfoPath 2003 для использования новой объектной модели .NET, предоставляемой пространством имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) . При этом весь код, необходимо повторно записи для использования элементов пространства имен **Microsoft.Office.InfoPath** , но весь код из предыдущей проекта сохраняется и окружены **#if InfoPathManagedObjectModel** и **#endif **(C#) **Или #If InfoPathManagedObject модели** и операторы **#End If** (Visual Basic) для справки. 
  
Следующие процедуры описывают порядок открытия шаблона формы с управляемым кодом, созданного с помощью набора инструментов InfoPath и сохранение совместимости с InfoPath 2003 или перенос и обновление для новой объектной модели InfoPath. 
  
### <a name="open-a-managed-code-form-template-created-with-the-infopath-toolkit-and-maintain-compatibility-with-infopath-2003-using-visual-studio-tools-for-applications"></a>Открытие шаблона формы с управляемым кодом, созданного с помощью набора инструментов InfoPath, и сохранение совместимости с приложением InfoPath 2003, использующим набор средств Visual Studio Tools для работы с приложениями

1. Откройте конструктор InfoPath и на вкладке **файл** нажмите кнопку **Открыть** . 
    
2. В диалоговом окне **Открытие в режиме конструктора** перейдите в папку проекта, где сохранен проект шаблона формы набора инструментов InfoPath. 
    
    По умолчанию это будет папка в `C:\Users\` *username* `\Documents\Visual Studio Projects` на компьютере, где был создан проект.   Или можно переместить папку в расположение, где InfoPath сохраняет проектов Visual Studio 2012, который по умолчанию является `C:\Users\` *имя пользователя*  `\Documents\InfoPath Projects`
    
3. Щелкните файл, который называется manifest.xsf и нажмите кнопку **Открыть**.
    
4. Перейдите на вкладку **Разработчик** и щелкните элемент **Редактор кода**.
    
5. Отобразится сообщение "Чтобы в шаблон формы можно было добавить код Visual Basic или C#, шаблон необходимо сохранить". Нажмите кнопку **ОК**, чтобы продолжить. 
    
6. Перейдите в расположение, где требуется сохранить файл, введите имя файла и нажмите кнопку **Сохранить**.
    
7. Отобразится сообщение "Этот код был создан с использованием одного из наборов инструментов InfoPath 2003 для Microsoft Visual Studio. Проект набора инструментов необходимо перевести в новый формат.". Нажмите кнопку **ОК**, чтобы продолжить. 
    
8. Выберите файл решения Visual Studio (SLN) для проекта и нажмите кнопку **Открыть**.
    
9. По завершении процедуры переноса отобразится сообщение "Проект был перенесен". Нажмите кнопку **ОК**, чтобы продолжить. 
    
10. «Код в этой форме использует объектную модель InfoPath 2003"отображается сообщение с командной строке «Требуется обновление кода для использования объектной модели Microsoft Office InfoPath?» Нажмите кнопку **Нет** для сохранения совместимости с InfoPath 2003 и для продолжения работы с помощью объектной модели, предоставляемой пространством имен [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) . 
    
    Сведения о работе с шаблонов форм с управляемым кодом, совместимые с InfoPath 2003 см в [Разработке форм шаблонов с помощью объектной модели InfoPath 2003](developing-form-templates-using-the-infopath-2003-object-model.md).
    
### <a name="open-a-managed-code-form-template-created-with-the-infopath-toolkit-and-upgrade-it-to-use-the-new-infopath-object-model-using-visual-studio-tools-for-applications"></a>Открытие шаблона формы с управляемым кодом, созданного с помощью набора инструментов InfoPath, и его обновление для использования с объектной моделью InfoPath и пакетом средств Visual Studio Tools для работы с приложениями

1. Откройте конструктор InfoPath и на вкладке **файл** нажмите кнопку **Открыть** . 
    
2. В разделе **Открытие шаблона формы** щелкните **На моем компьютере**.
    
3. В диалоговом окне **Открытие в режиме конструктора** перейдите в папку проекта, где сохранен проект шаблона формы набора инструментов InfoPath. 
    
    По умолчанию это будет папка в `C:\Users\` *username* `\Documents\Visual Studio Projects` на компьютере, где был создан проект.   Или можно переместить папку в расположение, где InfoPath сохраняет проектов Visual Studio 2012, который по умолчанию является `C:\Users\` *имя пользователя*  `\Documents\InfoPath Projects`
    
4. Щелкните файл, который называется manifest.xsf и нажмите кнопку **Открыть**.
    
5. Перейдите на вкладку **Разработчик** и щелкните элемент **Редактор кода**.
    
6. Отобразится сообщение "Чтобы в шаблон формы можно было добавить код Visual Basic или C#, шаблон необходимо сохранить". Нажмите кнопку **ОК**, чтобы продолжить. 
    
7. Перейдите в расположение, где требуется сохранить файл, введите имя файла и нажмите кнопку **Сохранить**.
    
8. Отобразится сообщение "Этот код был создан с использованием одного из наборов инструментов InfoPath 2003 для Microsoft Visual Studio. Проект набора инструментов необходимо перевести в новый формат.". Нажмите кнопку **ОК**, чтобы продолжить. 
    
9. Выберите файл решения Visual Studio (SLN) для проекта и нажмите кнопку **Открыть**.
    
10. По завершении процедуры переноса отобразится сообщение "Проект был перенесен". Нажмите кнопку **ОК**, чтобы продолжить. 
    
11. «Код в этой форме использует объектную модель InfoPath 2003"отображается сообщение с командной строке «Требуется обновление кода для использования объектной модели Microsoft Office InfoPath?» Нажмите кнопку **Да** для обновления шаблона формы для использования новой объектной модели управляемого кода, представленные в пространстве имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) . 
    
    Код формы откроется в редакторе кода Visual Studio 2012 с весь код из предыдущей проекта окружены **#if** **InfoPathManagedObjectModel** и **#endif** (C#) или **#If InfoPathManagedObjectModel** и **#End If **Операторы (Visual Basic) для справки. Весь этот код будет иметь записываться повторно использовать элементы объектной модели, предоставляемой пространством имен **Microsoft.Office.InfoPath** . 
    
    Сведения о работе с шаблонами форм управляемого кода, использующие новые объектная модель управляемого кода InfoPath можно [Разработке шаблонов форм InfoPath с кодом](developing-infopath-form-templates-with-code.md).
    


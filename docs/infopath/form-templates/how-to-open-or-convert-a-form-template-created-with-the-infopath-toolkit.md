---
title: Открытие и преобразование шаблона формы, созданных с помощью набора инструментов InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- Преобразование шаблонов форм [infopath 2007] на набора инструментов InfoPath, открытие шаблонов форм из шаблонов форм [InfoPath 2007], открыв InfoPath 2007, преобразование шаблонов форм набора инструментов InfoPath, открытие шаблонов форм [InfoPath 2007] шаблонов форм [InfoPath 2007], преобразование, скрипта [InfoPath 2007], преобразование в управляемый код
localization_priority: Normal
ms.assetid: af8eca2e-ba9a-4c37-94af-662815fff518
description: Если создан шаблон формы управляемого кода InfoPath 2003, с помощью одного из средств InfoPath 2003 для Visual Studio и требуется обеспечить совместимость с InfoPath 2003, можно продолжать работать с и дальнейшей разработки проекта шаблона формы, открыв его в Microsoft InfoPath и Visual Studio 2012.
ms.openlocfilehash: 7ca6a676c9db740b6b176783273a523715032387
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807508"
---
# <a name="open-or-convert-a-form-template-created-with-the-infopath-toolkit"></a><span data-ttu-id="0e23e-104">Открытие и преобразование шаблона формы, созданных с помощью набора инструментов InfoPath</span><span class="sxs-lookup"><span data-stu-id="0e23e-104">Open or Convert a Form Template Created with the InfoPath Toolkit</span></span>

<span data-ttu-id="0e23e-105">Если создан шаблон формы управляемого кода InfoPath 2003, с помощью одного из средств InfoPath 2003 для Visual Studio и требуется обеспечить совместимость с InfoPath 2003, можно продолжать работать с и дальнейшей разработки проекта шаблона формы, открыв его в Microsoft InfoPath и Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="0e23e-105">If you created an InfoPath 2003 managed code form template using one of the InfoPath 2003 Toolkits for Visual Studio and want to maintain compatibility with InfoPath 2003, you can continue to work on and further develop your form template project by opening it in Microsoft InfoPath and Visual Studio 2012.</span></span>
  
<span data-ttu-id="0e23e-106">Кроме того можно перенос и обновление кода в проекте InfoPath 2003 для использования новой объектной модели .NET, предоставляемой пространством имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0e23e-106">Alternatively, you can migrate and upgrade the code in your InfoPath 2003 project to use the new .NET object model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace.</span></span> <span data-ttu-id="0e23e-107">При этом весь код, необходимо повторно записи для использования элементов пространства имен **Microsoft.Office.InfoPath** , но весь код из предыдущей проекта сохраняется и окружены **#if InfoPathManagedObjectModel** и **#endif **(C#) **Или #If InfoPathManagedObject модели** и операторы **#End If** (Visual Basic) для справки.</span><span class="sxs-lookup"><span data-stu-id="0e23e-107">When doing so, all of your code will need to be re-written to use members of the **Microsoft.Office.InfoPath** namespace, but all of the code from your previous project is retained and surrounded by **#if InfoPathManagedObjectModel** and **#endif** (C#) or **#If InfoPathManagedObject Model** and **#End If** (Visual Basic) statements for your reference.</span></span> 
  
<span data-ttu-id="0e23e-108">Следующие процедуры описывают порядок открытия шаблона формы с управляемым кодом, созданного с помощью набора инструментов InfoPath и сохранение совместимости с InfoPath 2003 или перенос и обновление для новой объектной модели InfoPath.</span><span class="sxs-lookup"><span data-stu-id="0e23e-108">The following procedures describe how to open a managed code form template created by using the InfoPath Toolkit and maintain compatibility with InfoPath 2003 or migrate and upgrade to the new InfoPath object model.</span></span> 
  
### <a name="open-a-managed-code-form-template-created-with-the-infopath-toolkit-and-maintain-compatibility-with-infopath-2003-using-visual-studio-tools-for-applications"></a><span data-ttu-id="0e23e-109">Открытие шаблона формы с управляемым кодом, созданного с помощью набора инструментов InfoPath, и сохранение совместимости с приложением InfoPath 2003, использующим набор средств Visual Studio Tools для работы с приложениями</span><span class="sxs-lookup"><span data-stu-id="0e23e-109">Open a managed code form template created with the InfoPath Toolkit and maintain compatibility with InfoPath 2003 using Visual Studio Tools for Applications</span></span>

1. <span data-ttu-id="0e23e-110">Откройте конструктор InfoPath и на вкладке **файл** нажмите кнопку **Открыть** .</span><span class="sxs-lookup"><span data-stu-id="0e23e-110">Open the InfoPath Designer, and then click **Open** on the **File** tab.</span></span> 
    
2. <span data-ttu-id="0e23e-111">В диалоговом окне **Открытие в режиме конструктора** перейдите в папку проекта, где сохранен проект шаблона формы набора инструментов InfoPath.</span><span class="sxs-lookup"><span data-stu-id="0e23e-111">In the **Open in Design Mode** dialog box, navigate to the project folder where the InfoPath Toolkit form template project is saved.</span></span> 
    
    <span data-ttu-id="0e23e-112">По умолчанию это будет папка в `C:\Users\` *username* `\Documents\Visual Studio Projects` на компьютере, где был создан проект.  </span><span class="sxs-lookup"><span data-stu-id="0e23e-112">By default, this will be a folder in  `C:\Users\` *username*  `\Documents\Visual Studio Projects` on the computer where the project was created.</span></span> <span data-ttu-id="0e23e-113">Или можно переместить папку в расположение, где InfoPath сохраняет проектов Visual Studio 2012, который по умолчанию является `C:\Users\` *имя пользователя*  `\Documents\InfoPath Projects`</span><span class="sxs-lookup"><span data-stu-id="0e23e-113">Or, you can move the folder to the location where InfoPath stores Visual Studio 2012 projects, which by default is  `C:\Users\` *username*  `\Documents\InfoPath Projects`</span></span>
    
3. <span data-ttu-id="0e23e-114">Щелкните файл, который называется manifest.xsf и нажмите кнопку **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-114">Click the file that is named manifest.xsf, and then click **Open**.</span></span>
    
4. <span data-ttu-id="0e23e-115">На вкладке **Разработчик** щелкните элемент **Редактор кода**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-115">On the **Developer** tab, click **Code Editor**.</span></span>
    
5. <span data-ttu-id="0e23e-116">Сообщение, что отображается «этот шаблон формы, необходимо сначала сохранить в нее можно добавить код Visual Basic или C#».</span><span class="sxs-lookup"><span data-stu-id="0e23e-116">The message "This form template must be saved before you can add Visual Basic or C# code to it" is displayed.</span></span> <span data-ttu-id="0e23e-117">Нажмите **кнопку ОК** , чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0e23e-117">Click **OK** to continue.</span></span> 
    
6. <span data-ttu-id="0e23e-118">Перейдите в расположение, где требуется сохранить файл, назовите файл и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-118">Navigate to the location where you want to save the file, name the file, and then click **Save**.</span></span>
    
7. <span data-ttu-id="0e23e-119">Сообщение «Этот код был создан с помощью одного из InfoPath 2003 наборы средств for Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0e23e-119">The message "This code was created with one of the InfoPath 2003 Toolkits for Microsoft Visual Studio.</span></span> <span data-ttu-id="0e23e-120">Необходимо перевести в новый формат проект набора инструментов» отображается.</span><span class="sxs-lookup"><span data-stu-id="0e23e-120">InfoPath needs to migrate the toolkit project to a new format" is displayed.</span></span> <span data-ttu-id="0e23e-121">Нажмите **кнопку ОК** , чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0e23e-121">Click **OK** to continue.</span></span> 
    
8. <span data-ttu-id="0e23e-122">Выберите файл решения Visual Studio (SLN) для проекта и нажмите кнопку **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-122">Select the Visual Studio Solution (.sln) file for the project, and then click **Open**.</span></span>
    
9. <span data-ttu-id="0e23e-123">По завершении процесса переноса, отображается сообщение, «проект перенесен».</span><span class="sxs-lookup"><span data-stu-id="0e23e-123">The message "Your project has been migrated" is displayed when the migration process is complete.</span></span> <span data-ttu-id="0e23e-124">Нажмите **кнопку ОК** , чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0e23e-124">Click **OK** to continue.</span></span> 
    
10. <span data-ttu-id="0e23e-125">«Код в этой форме использует объектную модель InfoPath 2003"отображается сообщение с командной строке «Требуется обновление кода для использования объектной модели Microsoft Office InfoPath?»</span><span class="sxs-lookup"><span data-stu-id="0e23e-125">The message "The code in this form uses the InfoPath 2003 object model" is displayed with the prompt "Do you want to upgrade your code to use the Microsoft Office InfoPath object model?"</span></span> <span data-ttu-id="0e23e-126">Нажмите кнопку **Нет** для сохранения совместимости с InfoPath 2003 и для продолжения работы с помощью объектной модели, предоставляемой пространством имен [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0e23e-126">Click **No** to retain compatibility with InfoPath 2003 and to continue working with the object model provided by the [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) namespace.</span></span> 
    
    <span data-ttu-id="0e23e-127">Сведения о работе с шаблонов форм с управляемым кодом, совместимые с InfoPath 2003 см в [Разработке форм шаблонов с помощью объектной модели InfoPath 2003](developing-form-templates-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="0e23e-127">For information about how to work with managed code form templates that are compatible with InfoPath 2003, see [Developing Form Templates Using the InfoPath 2003 Object Model](developing-form-templates-using-the-infopath-2003-object-model.md).</span></span>
    
### <a name="open-a-managed-code-form-template-created-with-the-infopath-toolkit-and-upgrade-it-to-use-the-new-infopath-object-model-using-visual-studio-tools-for-applications"></a><span data-ttu-id="0e23e-128">Открытие шаблона формы с управляемым кодом, созданного с помощью набора инструментов InfoPath, и его обновление для использования с объектной моделью InfoPath и пакетом средств Visual Studio Tools для работы с приложениями</span><span class="sxs-lookup"><span data-stu-id="0e23e-128">Open a managed code form template created with the InfoPath Toolkit and upgrade it to use the new InfoPath object model using Visual Studio Tools for Applications</span></span>

1. <span data-ttu-id="0e23e-129">Откройте конструктор InfoPath и на вкладке **файл** нажмите кнопку **Открыть** .</span><span class="sxs-lookup"><span data-stu-id="0e23e-129">Open the InfoPath Designer, and then click **Open** on the **File** tab.</span></span> 
    
2. <span data-ttu-id="0e23e-130">В разделе **Открытие шаблона формы**щелкните **На моем компьютере**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-130">Under **Open a form template**, click **On My Computer**.</span></span>
    
3. <span data-ttu-id="0e23e-131">В диалоговом окне **Открытие в режиме конструктора** перейдите в папку проекта, где сохранен проект шаблона формы набора инструментов InfoPath.</span><span class="sxs-lookup"><span data-stu-id="0e23e-131">In the **Open in Design Mode** dialog box, navigate to the project folder where the InfoPath Toolkit form template project is saved.</span></span> 
    
    <span data-ttu-id="0e23e-132">По умолчанию это будет папка в `C:\Users\` *username* `\Documents\Visual Studio Projects` на компьютере, где был создан проект.  </span><span class="sxs-lookup"><span data-stu-id="0e23e-132">By default this will be a folder in  `C:\Users\` *username*  `\Documents\Visual Studio Projects` on the computer where the project was created.</span></span> <span data-ttu-id="0e23e-133">Или можно переместить папку в расположение, где InfoPath сохраняет проектов Visual Studio 2012, который по умолчанию является `C:\Users\` *имя пользователя*  `\Documents\InfoPath Projects`</span><span class="sxs-lookup"><span data-stu-id="0e23e-133">Or, you can move the folder to the location where InfoPath stores Visual Studio 2012 projects, which by default is  `C:\Users\` *username*  `\Documents\InfoPath Projects`</span></span>
    
4. <span data-ttu-id="0e23e-134">Щелкните файл, который называется manifest.xsf и нажмите кнопку **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-134">Click the file that is named manifest.xsf, and then click **Open**.</span></span>
    
5. <span data-ttu-id="0e23e-135">На вкладке **Разработчик** щелкните элемент **Редактор кода**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-135">On the **Developer** tab, click **Code Editor**.</span></span>
    
6. <span data-ttu-id="0e23e-136">Сообщение, что отображается «этот шаблон формы, необходимо сначала сохранить в нее можно добавить код Visual Basic или C#».</span><span class="sxs-lookup"><span data-stu-id="0e23e-136">The message "This form template must be saved before you can add Visual Basic or C# code to it" is displayed.</span></span> <span data-ttu-id="0e23e-137">Нажмите **кнопку ОК** , чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0e23e-137">Click **OK** to continue.</span></span> 
    
7. <span data-ttu-id="0e23e-138">Перейдите в расположение, где требуется сохранить файл, назовите файл и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-138">Navigate to the location where you want to save the file, name the file, and then click **Save**.</span></span>
    
8. <span data-ttu-id="0e23e-139">Сообщение «Этот код был создан с помощью одного из InfoPath 2003 наборы средств for Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0e23e-139">The message "This code was created with one of the InfoPath 2003 Toolkits for Microsoft Visual Studio.</span></span> <span data-ttu-id="0e23e-140">Необходимо перевести в новый формат проект набора инструментов» отображается.</span><span class="sxs-lookup"><span data-stu-id="0e23e-140">InfoPath needs to migrate the toolkit project to a new format" is displayed.</span></span> <span data-ttu-id="0e23e-141">Нажмите **кнопку ОК** , чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0e23e-141">Click **OK** to continue.</span></span> 
    
9. <span data-ttu-id="0e23e-142">Выберите файл решения Visual Studio (SLN) для проекта и нажмите кнопку **Открыть**.</span><span class="sxs-lookup"><span data-stu-id="0e23e-142">Select the Visual Studio Solution (.sln) file for the project, and then click **Open**.</span></span>
    
10. <span data-ttu-id="0e23e-143">По завершении процесса переноса, отображается сообщение, «проект перенесен».</span><span class="sxs-lookup"><span data-stu-id="0e23e-143">The message "Your project has been migrated" is displayed when the migration process is complete.</span></span> <span data-ttu-id="0e23e-144">Нажмите **кнопку ОК** , чтобы продолжить.</span><span class="sxs-lookup"><span data-stu-id="0e23e-144">Click **OK** to continue.</span></span> 
    
11. <span data-ttu-id="0e23e-145">«Код в этой форме использует объектную модель InfoPath 2003"отображается сообщение с командной строке «Требуется обновление кода для использования объектной модели Microsoft Office InfoPath?»</span><span class="sxs-lookup"><span data-stu-id="0e23e-145">The message "The code in this form uses the InfoPath 2003 object model" is displayed with the prompt "Do you want to upgrade your code to use the Microsoft Office InfoPath object model?"</span></span> <span data-ttu-id="0e23e-146">Нажмите кнопку **Да** для обновления шаблона формы для использования новой объектной модели управляемого кода, представленные в пространстве имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0e23e-146">Click **Yes** to upgrade the form template to use the new managed code object model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace.</span></span> 
    
    <span data-ttu-id="0e23e-147">Код формы откроется в редакторе кода Visual Studio 2012 с весь код из предыдущей проекта окружены **#if** **InfoPathManagedObjectModel** и **#endif** (C#) или **#If InfoPathManagedObjectModel** и **#End If **Операторы (Visual Basic) для справки.</span><span class="sxs-lookup"><span data-stu-id="0e23e-147">Your form code is opened in the Visual Studio 2012 code editor with all of the code from your previous project surrounded by **#if** **InfoPathManagedObjectModel** and **#endif** (C#) or **#If InfoPathManagedObjectModel** and **#End If** (Visual Basic) statements for your reference.</span></span> <span data-ttu-id="0e23e-148">Весь этот код будет иметь записываться повторно использовать элементы объектной модели, предоставляемой пространством имен **Microsoft.Office.InfoPath** .</span><span class="sxs-lookup"><span data-stu-id="0e23e-148">All of this code will have to be re-written to use members of the object model provided by the **Microsoft.Office.InfoPath** namespace.</span></span> 
    
    <span data-ttu-id="0e23e-149">Сведения о работе с шаблонами форм управляемого кода, использующие новые объектная модель управляемого кода InfoPath можно [Разработке шаблонов форм InfoPath с кодом](developing-infopath-form-templates-with-code.md).</span><span class="sxs-lookup"><span data-stu-id="0e23e-149">For information about how to work with managed code form templates that use the new InfoPath managed code object model, see [Developing InfoPath Form Templates with Code](developing-infopath-form-templates-with-code.md).</span></span>
    


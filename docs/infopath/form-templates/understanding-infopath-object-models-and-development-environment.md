---
title: Общие сведения о средах разработки и объектных моделях InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, object models,object models [InfoPath 2007],InfoPath 2007, development environments
localization_priority: Normal
ms.assetid: 29415c5b-9a42-46f4-a9e8-6a7d5bb7bdbf
description: Microsoft InfoPath 2013 поддерживает два типа моделей программирования для разработки бизнес-логики в шаблонах форм, а также поддерживает внешнюю автоматизацию из управляемого кода.
ms.openlocfilehash: c2ed1254acf86136ab7144c732aef91ac4c14c53
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25400112"
---
# <a name="understanding-infopath-object-models-and-development-environment"></a>Общие сведения о среде разработки и объектных моделях InfoPath

Microsoft InfoPath 2013 поддерживает два типа моделей программирования для разработки бизнес-логики в шаблонах форм, а также поддерживает внешнюю автоматизацию из управляемого кода.
  
InfoPath Forms Services, который доступен в SharePoint Server 2013, предоставляет веб-интерфейс браузера для заполнения форм InfoPath. После развертывания на сервере под управлением InfoPath Forms Services формы, основанные на совместимых с браузером шаблонах форм (XSN), можно открывать в веб-браузере на компьютерах, на которых не установлен пакет InfoPath, однако после установки InfoPath они будут открываться в нем. InfoPath Forms Services также предоставляет объектную модель для автоматизации серверных задач, связанных с публикацией и администрированием шаблона форм InfoPath.
  
InfoPath 2013 поддерживает Visual Studio 2012, программирования среды и ее связанный языки программирования, описанных далее в этом разделе.
  
## <a name="infopath-programming-models"></a>Модели программирования InfoPath

Для разработки бизнес-логики в шаблонах форм InfoPath 2013 поддерживает две объектных моделей:
  
- Объектная модель управляемого кода, совместимая с InfoPath.
    
- Новая объектная модель управляемого кода, совместимая с InfoPath 2003.
    
Кроме того InfoPath 2013 возможность написания управляемого кода для автоматизации InfoPath из внешнего приложения.
  
InfoPath Forms Services предоставляет объектную модель для автоматизации серверных задач, таких как проверка и отправка шаблонов форм из кода, выполняемого на сервере, что требует прав и разрешений администратора сервера.
  
> [!NOTE]
> InfoPath Filler 2013 можно открыть и запустить формы InfoPath шаблона решений, созданных в более ранних версиях InfoPath, использующих бизнес-логику с языками сценариев (JScript и VBScript). Однако InfoPath Designer 2010 не поддерживает создание и изменение шаблонов форм, использующих бизнес-логику со скриптами. 
  
### <a name="the-infopath-managed-code-object-model"></a>Объектная модель управляемого кода InfoPath

Объектная модель управляемого кода InfoPath 2013 реализована в двух сборках, которые называются Microsoft.Office.Infopath.dll.
  
Реализует подмножество объектной модели InfoPath, которая содержит типы и члены, которые поддерживаются в бизнес-логики шаблонов форм, развернутые в виде шаблонов форм с поддержкой веб-браузера, запущенные на SharePoint Server 2013 с одной версии сборки Службы InfoPath Forms Services. Шаблоны форм с бизнес-логикой, написанной для этой сборки, будут открываться и запускаться только в InfoPath Filler и веб-браузере.
  
Другая версия этой сборки реализует дополнительные типы и члены, обеспечивающие функциональные возможности, не поддерживаемые в бизнес-логике основанных на браузере шаблонов форм. Шаблоны форм с бизнес-логикой, написанной с применением дополнительных классов и членов, будут открываться и запускаться только в редакторе InfoPath Filler.
  
> [!NOTE]
> Существует возможность записи условную логику, которая использует свойства класс [среды](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Environment.aspx) , чтобы определить, какой среде (InfoPath Filler или веб-браузера) шаблона формы работает в. С помощью этой условной логики, бизнес-логика может ветвиться между кода, который работает в веб-браузере и код, написанный с классы и члены, которые работают только в редакторе InfoPath Filler. Дополнительные сведения можно [записать условной логики, определяет среды выполнения](how-to-write-conditional-logic-that-determines-the-run-time-environment.md)
  
Сборка, используемая InfoPath при добавлении и компилировании бизнес-логики для шаблона форм, зависит от того, выбран ли шаблон **Пустая форма** или **Пустая форма (InfoPath Filler)** на вкладке **Новый** программы Microsoft Office Backstage в начале процесса создания нового шаблона форм в конструкторе InfoPath. Формы, созданные с помощью шаблона форм **Пустая форма**, используют сборку, содержащую только типы и члены, поддерживаемые в бизнес-логике шаблона форм, развернутого как шаблон форм с включенной поддержкой браузера. Формы, созданные с помощью шаблона форм **Пустая форма**, можно открыть как в веб-браузере, так и в редакторе InfoPath Filler. Формы, созданные с помощью шаблона форм **Пустая форма (InfoPath Filler)**, используют сборку, реализующую дополнительные типы и члены, обеспечивающие функциональные возможности, не поддерживаемые в бизнес-логике шаблонов форм с включенной поддержкой браузеров, поэтому открыть их можно только в редакторе InfoPath Filler. 
  
> [!TIP]
> После запуска разработка шаблона формы, можно изменить, какие сборки используется, изменив параметры формы совместимости. Для этого выберите **Язык** на вкладке **Разработчик** и щелкните **Совместимость** в списке **Категория**. В списке **тип формы** выберите **Форма веб-браузера** , чтобы создать форму, могут быть развернуты как форму с поддержкой веб-браузера в SharePoint Server 2013. Выберите **Форма InfoPath Filler**, чтобы создать форму, которая может выполняться только в редакторе InfoPath Filler. Остальные параметры в списке **Тип формы** обеспечивают совместимость с InfoPath 2007 и InfoPath 2003. 
  
Классы и члены из обеих версий этой объектной модели предоставляются через пространство имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) . В следующей таблице перечислены расположение сборки в каталогах при установке InfoPath 2013. 
  
|**Сборки**|**Описание**|
|:-----|:-----|
|Microsoft.Office.InfoPath.dll (находится в C:\Program Files\Microsoft Office\Office15\InfoPathOM\InfoPathOMFormServices)  <br/> |Подмножество объектную модель, включающая типы и члены, которые будут запускаться в бизнес-логике шаблона формы, развернутого на сервере, работающего под управлением службы InfoPath Forms Services.  <br/> |
|Microsoft.Office.InfoPath.dll (находится в C:\Program Files\Microsoft Office\Office15\InfoPathOM)  <br/> |«Полная» объектная модель, содержащая типы и члены, которые не будут запускаться в бизнес-логике шаблона формы, развернутого в InfoPath Forms Services.  <br/> |
   
> [!NOTE]
> [!Примечание] Указанные выше сборки используются во время разработки при написании и компиляции кода. Во время выполнения сборка, которая используется при открытии шаблона в InfoPath, размещается в глобальном кэше сборок на компьютере, на котором установлено приложение InfoPath. Когда шаблон формы открывается в веб-браузере с сервера InfoPath Forms Services, используется сборка, расположенная на сервере. 
  
Предоставление двух сборок позволяет реализовать систему, при которой в бизнес-логике содержатся только вызовы соответствующих членов объектной модели для поддерживаемых редакторов форм (веб-браузера или InfoPath Filler). Например, при редактировании кода функции IntelliSense, такие как завершение операторов и встроенная документация, будут отображаться и работать только для членов объектной модели, соответствующих указанным редакторам форм.
  
В обеих версиях новой объектной модели управляемого кода, предоставляемых сборкой Microsoft.Office.InfoPath, для переходов по хранилищам XML-данных и для обновления этих хранилищ в бизнес-логике требуются вызовы членов класса **System.Xml.XPath.XPathNavigator**. В InfoPath 2003 для переходов по хранилищам XML-данных и для обновления этих хранилищ требуется вызов членов классов MSXML (для бизнес-логики, созданной с помощью JScript или VBScript) или вызов через оболочки для классов MSXML, предоставляемые пространством имен **Microsoft.Office.Interop.InfoPath.SemiTrust** (для бизнес-логики, созданной с помощью C# или Visual Basic и набора Microsoft Office InfoPath 2003 Toolkit для Visual Studio .NET). 
  
Использование членов класса **XPathNavigator** позволяет же код бизнес-логики для поддержки обработку DOM для шаблонов форм, которые открываются в клиенте InfoPath и в веб-форм из SharePoint Server 2013 с помощью форм InfoPath Службы в веб-браузере. 
  
Сведения о том, как работать с членами класса **XPathNavigator** в бизнес-логики InfoPath шаблонов форм с управляемым кодом, можно [работать с классов XPathNavigator и XPathNodeIterator](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).
  
### <a name="the-infopath-2003-compatible-managed-code-object-model"></a>Объектная модель управляемого кода, совместимая с InfoPath 2003

Объектная модель управляемого кода, совместимая с InfoPath 2003, впервые была представлена в пакете обновления 1 (SP1) для InfoPath 2003 в сочетании с набором средств Microsoft Office InfoPath 2003 Toolkit для Visual Studio .NET. Эта объектная модель по-прежнему поддерживается InfoPath 2013 для обеспечения совместимости с InfoPath 2003.
  
Классы и члены этой объектной модели предоставляются через пространство имен [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) . Эта модель объекта реализуется в следующий файл сборки, который находится в папке C:\Program Files\Microsoft Office\Office14. 
  
|**Сборки**|**Описание**|
|:-----|:-----|
|Microsoft.Office.Interop.InfoPath.SemiTrust.dll  <br/> |Обеспечивает COM-взаимодействие с использованием объектной модели COM приложения InfoPath для бизнес-логики шаблонов форм, написанной на языке C# или Visual Basic.  <br/> |
   
> [!NOTE]
> Хотя для создания бизнес-логики с взаимодействия управляемого кода объектной модели COM, предоставляемые с использованием сборки Microsoft.Office.Interop.InfoPath.SemiTrust по-прежнему поддерживается InfoPath 2013, записанные с помощью объектной модели, не поддерживается для бизнес-логики шаблоны форм с поддержкой веб-браузера, развернуть в SharePoint Server 2013 с помощью службы InfoPath Forms Services. В шаблонах форм с поддержкой браузера необходимо использовать новую объектную модель управляемого кода InfoPath для пользовательской бизнес-логики. 
  
### <a name="automating-infopath-from-managed-code"></a>Автоматизация InfoPath из управляемого кода

Помимо написания бизнес-логики с помощью управляемого кода, можно автоматизировать InfoPath, используя управляемый код, выполняемый во внешнем приложении. Эта функция и сборки, необходимые для написания кода, впервые были представлены в пакете обновления 1 (SP1) для InfoPath 2003. Объекты и члены для автоматизации InfoPath были обновлены для предоставления дополнительных функциональных возможностей для написания кода внешней автоматизации InfoPath 2013.
  
Классы и члены, используемые для внешней автоматизации, предоставляются через пространства имен [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.aspx) и [Microsoft.Office.Interop.InfoPath.Xml](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.xml). Файлы сборки, которые необходимы для написания кода автоматизации, находятся в папке C:\Program Files\Microsoft Office\Office14. 
  
|**Сборки**|**Описание**|
|:-----|:-----|
|Microsoft.Office.Interop.InfoPath.dll  <br/> |Обеспечивает COM-взаимодействие с использованием объектной модели COM приложения InfoPath для кода внешней автоматизации, написанном на языке C# или Visual Basic.  <br/> |
|Microsoft.Office.Interop.InfoPath.Xml.dll  <br/> |Предоставляет COM-взаимодействие в MSXML для операций XML DOM в коде внешней автоматизации, написанном на языке C# или Visual Basic.  <br/> |
   
Дополнительные сведения о объектных моделей, предоставленные пространства имен **Microsoft.Office.Interop.InfoPath** и **Microsoft.Office.Interop.InfoPath.Xml** , которые используются исключительно для автоматизации приложения InfoPath с помощью управляемых Примеры кода из внешних приложений, см в [Центр разработчиков InfoPath](https://msdn.microsoft.com/office/aa905434.aspx).
  
### <a name="the-infopath-forms-services-object-model"></a>Новая объектная модель служб форм InfoPath

Объектная модель управляемого кода для автоматизации задач администрирования службы InfoPath Forms Services реализована в файл Microsoft.Office.InfoPath.Server.dll, которая расположена в каталоге \<диск\>: \Program Files\Microsoft Office Server\15.0\Bin на Установка Microsoft SharePoint Server 2013.
  
|**Сборки**|**Описание**|
|:-----|:-----|
|Microsoft.Office.InfoPath.Server.dll  <br/> |Объектная модель для автоматизации InfoPath Forms Services задач, таких как отправка, включение и выключение шаблонов форм с поддержкой веб-браузера.  <br/> |
   
Дополнительные сведения об объектной модели InfoPath Forms Services можно в SharePoint Server 2013 программное обеспечение разработчикам SDK для доступной на MSDN.
  
## <a name="infopath-development-environment"></a>Среда разработки InfoPath

Разработку бизнес-логики в шаблонах форм InfoPath 2013, могут выполняться с помощью Visual Studio 2012 с установлен [Набор средств Microsoft Visual Studio 2012 приложений](https://www.microsoft.com/en-us/download/details.aspx?id=38807) надстройки. 
  
> [!NOTE]
> InfoPath 2013 не поддерживает создание и изменение шаблонов форм, использующих бизнес-логику с JScript и VBScript, несмотря на то, что InfoPath Filler поддерживает шаблоны открытия формы на основе сценариев, которые были созданы в предыдущих версиях InfoPath. 
  
## <a name="see-also"></a>См. также

- [Пошаговое руководство. Создание базового шаблона формы с кодом](walkthrough-creating-a-basic-form-template-with-code.md)
- [Пошаговое руководство. Создание и отладка начального шаблона формы с помощью объектной модели InfoPath 2003](walkthrough-create-and-debug-basic-form-template-using-infopath-object-model.md)


---
title: Общие сведения о средах разработки и объектных моделях InfoPath
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2007, object models,object models [InfoPath 2007],InfoPath 2007, development environments
localization_priority: Normal
ms.assetid: 29415c5b-9a42-46f4-a9e8-6a7d5bb7bdbf
description: Microsoft InfoPath 2013 поддерживает два вида моделей программирования для разработки бизнес-логики в шаблонах форм и поддерживает внешнюю автоматизацию из управляемого кода.
ms.openlocfilehash: c2ed1254acf86136ab7144c732aef91ac4c14c53
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303460"
---
# <a name="understanding-infopath-object-models-and-development-environment"></a>Общие сведения о средах разработки и объектных моделях InfoPath

Microsoft InfoPath 2013 поддерживает два вида моделей программирования для разработки бизнес-логики в шаблонах форм и поддерживает внешнюю автоматизацию из управляемого кода.
  
InfoPath Forms Services, которая доступна в SharePoint Server 2013, предоставляет возможность веб-браузера для заполнения форм InfoPath. После развертывания на сервере под управлением InfoPath Forms Services формы, основанные на совместимых с браузером шаблонах форм (XSN), можно открывать в веб-браузере на компьютерах, на которых не установлен пакет InfoPath, однако после установки InfoPath они будут открываться в нем. InfoPath Forms Services также предоставляет объектную модель для автоматизации серверных задач, связанных с публикацией и администрированием шаблона форм InfoPath.
  
InfoPath 2013 поддерживает среду программирования 2012 Visual Studio 2012 г. и связанные с ней языки программирования, которые описаны позже в этом разделе.
  
## <a name="infopath-programming-models"></a>Модели программирования InfoPath

InfoPath 2013 поддерживает две объектные модели для разработки бизнес-логики в шаблонах форм:
  
- Объектная модель управляемого кода, совместимая с InfoPath.
    
- Новая объектная модель управляемого кода, совместимая с InfoPath 2003.
    
Кроме того, InfoPath 2013 позволяет писать управляемый код для автоматизации InfoPath из внешнего приложения.
  
InfoPath Forms Services предоставляет объектную модель для автоматизации серверных задач, таких как проверка и отправка шаблонов форм из кода, выполняемого на сервере, что требует прав и разрешений администратора сервера.
  
> [!NOTE]
> Заполнитель InfoPath 2013 может открывать и запускать решения шаблонов форм InfoPath, созданные в более ранних версиях InfoPath, которые используют бизнес-логику, написанную на языках скриптов (JScript и VBScript). Однако InfoPath Designer 2010 не поддерживает создание и изменение шаблонов форм, использующих бизнес-логику со скриптами. 
  
### <a name="the-infopath-managed-code-object-model"></a>Объектная модель управляемого кода InfoPath

Объектная модель управляемого кода InfoPath 2013 реализована в двух сборках с именем Microsoft.Office.Infopath.dll.
  
В одной из версий сборки реализуется подмножество объектной модели InfoPath, которое содержит только типы и члены, поддерживаемые в бизнес-логике шаблонов форм, развернутых в качестве шаблонов форм с поддержкой браузера, работающих на SharePoint Server 2013 с InfoPath Forms Services. Шаблоны форм с бизнес-логикой, написанной для этой сборки, будут открываться и запускаться только в InfoPath Filler и веб-браузере.
  
Другая версия этой сборки реализует дополнительные типы и члены, обеспечивающие функциональные возможности, не поддерживаемые в бизнес-логике основанных на браузере шаблонов форм. Шаблоны форм с бизнес-логикой, написанной с применением дополнительных классов и членов, будут открываться и запускаться только в редакторе InfoPath Filler.
  
> [!NOTE]
> Можно написать условную логику, использующую свойства класса [Environment,](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.Environment.aspx) чтобы определить, в какой среде (заполните infoPath или веб-браузер) запущен шаблон формы. С помощью этой условной логики бизнес-логика может ветвиться между кодом, который работает в веб-браузере, и кодом, написанным в отношении классов и членов, которые работают только в редакторе InfoPath Filler. Дополнительные сведения см. в [статью Write Conditional Logic That Determines the Run-time Environment](how-to-write-conditional-logic-that-determines-the-run-time-environment.md)
  
Сборка, используемая InfoPath при добавлении и компилировании бизнес-логики для шаблона форм, зависит от того, выбран ли шаблон **Пустая форма** или **Пустая форма (InfoPath Filler)** на вкладке **Новый** программы Microsoft Office Backstage в начале процесса создания нового шаблона форм в конструкторе InfoPath. Формы, созданные с помощью шаблона форм **Пустая форма**, используют сборку, содержащую только типы и члены, поддерживаемые в бизнес-логике шаблона форм, развернутого как шаблон форм с включенной поддержкой браузера. Формы, созданные с помощью шаблона форм **Пустая форма**, можно открыть как в веб-браузере, так и в редакторе InfoPath Filler. Формы, созданные с помощью шаблона форм **Пустая форма (InfoPath Filler)**, используют сборку, реализующую дополнительные типы и члены, обеспечивающие функциональные возможности, не поддерживаемые в бизнес-логике шаблонов форм с включенной поддержкой браузеров, поэтому открыть их можно только в редакторе InfoPath Filler. 
  
> [!TIP]
> После разработки шаблона формы можно изменить сборку, изменив параметры совместимости форм. Для этого выберите **Язык** на вкладке **Разработчик** и щелкните **Совместимость** в списке **Категория**. В **списке** типов  форм выберите форму веб-браузера, чтобы создать форму, которая может быть развернута в виде формы, совместимой с браузером, на SharePoint Server 2013. Выберите **Форма InfoPath Filler**, чтобы создать форму, которая может выполняться только в редакторе InfoPath Filler. Остальные параметры в списке **Тип формы** обеспечивают совместимость с InfoPath 2007 и InfoPath 2003. 
  
Классы и члены из обеих версий этой объектной модели предоставляются через пространство имен [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) . В следующей таблице перечислены места, в которых сборки находятся в каталогах установки InfoPath 2013. 
  
|**Assembly**|**Описание**|
|:-----|:-----|
|Microsoft.Office.InfoPath.dll (расположен в C:\Program Files\Microsoft Office\Office15\InfoPathOM\InfoPathOMFormServices)  <br/> |Подмножество объектной модели, содержаще только типы и члены, которые будут работать в бизнес-логике шаблона формы, развернутого на сервере, который выполняется InfoPath Forms Services.  <br/> |
|Microsoft.Office.InfoPath.dll (расположен в C:\Program Files\Microsoft Office\Office15\InfoPathOM)  <br/> |"Полная" объектная модель, включаемая типы и члены, которые не будут работать в бизнес-логике шаблона формы, развернутого в InfoPath Forms Services.  <br/> |
   
> [!NOTE]
> [!Примечание] Указанные выше сборки используются во время разработки при написании и компиляции кода. Во время выполнения сборка, которая используется при открытии шаблона в InfoPath, размещается в глобальном кэше сборок на компьютере, на котором установлено приложение InfoPath. Когда шаблон формы открывается в веб-браузере с сервера InfoPath Forms Services, используется сборка, расположенная на сервере. 
  
Предоставление двух сборок позволяет реализовать систему, при которой в бизнес-логике содержатся только вызовы соответствующих членов объектной модели для поддерживаемых редакторов форм (веб-браузера или InfoPath Filler). Например, при редактировании кода функции IntelliSense, такие как завершение операторов и встроенная документация, будут отображаться и работать только для членов объектной модели, соответствующих указанным редакторам форм.
  
В обеих версиях новой объектной модели управляемого кода, предоставляемых сборкой Microsoft.Office.InfoPath, для переходов по хранилищам XML-данных и для обновления этих хранилищ в бизнес-логике требуются вызовы членов класса **System.Xml.XPath.XPathNavigator**. В InfoPath 2003 для переходов по хранилищам XML-данных и для обновления этих хранилищ требуется вызов членов классов MSXML (для бизнес-логики, созданной с помощью JScript или VBScript) или вызов через оболочки для классов MSXML, предоставляемые пространством имен **Microsoft.Office.Interop.InfoPath.SemiTrust** (для бизнес-логики, созданной с помощью C# или Visual Basic и набора Microsoft Office InfoPath 2003 Toolkit для Visual Studio .NET). 
  
Использование членов **класса XPathNavigator** позволяет одному и том же коду бизнес-логики поддерживать манипуляции doM для шаблонов форм, открытых как в клиенте InfoPath, так и в веб-формах, открытых с SharePoint Server 2013 с InfoPath Forms Services в веб-браузере. 
  
Сведения о том, как работать с участниками **класса XPathNavigator** в бизнес-логике шаблонов управляемых форм кода InfoPath, см. в этой ссылке Работа с [классами XPathNavigator и XPathNodeIterator.](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md)
  
### <a name="the-infopath-2003-compatible-managed-code-object-model"></a>Новая объектная модель управляемого кода, совместимая с InfoPath 2003.

Объектная модель управляемого кода, совместимая с InfoPath 2003, впервые была представлена в пакете обновления 1 (SP1) для InfoPath 2003 в сочетании с набором средств Microsoft Office InfoPath 2003 Toolkit для Visual Studio .NET. Эта объектная модель по-прежнему поддерживается InfoPath 2013 для обеспечения совместимости с InfoPath 2003.
  
Классы и члены этой объектной модели предоставляются через пространство имен [Microsoft.Office.Interop.InfoPath.SemiTrust](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.aspx) . Эта объектная модель реализована в следующем файле сборки, который расположен в папке C:\Program Files\Microsoft Office\Office14. 
  
|**Assembly**|**Описание**|
|:-----|:-----|
|Microsoft.Office.Interop.InfoPath.SemiTrust.dll  <br/> |Обеспечивает com-интероп с объектной моделью InfoPath COM для бизнес-логики шаблона форм, написанной с C# или Visual Basic.  <br/> |
   
> [!NOTE]
> Хотя создание бизнес-логики с помощью объектной модели управления кодом com, предоставляемой Корпорацией Майкрософт. Office.Interop.InfoPath.SemiTrust сборка по-прежнему поддерживается InfoPath 2013, бизнес-логика, написанная с помощью этой объектной модели, не поддерживается для шаблонов форм с поддержкой браузера, развернутых в SharePoint Server 2013 с InfoPath Forms Services. В шаблонах форм с поддержкой браузера необходимо использовать новую объектную модель управляемого кода InfoPath для пользовательской бизнес-логики. 
  
### <a name="automating-infopath-from-managed-code"></a>Автоматизация InfoPath из управляемого кода

Помимо написания бизнес-логики с помощью управляемого кода, можно автоматизировать InfoPath, используя управляемый код, выполняемый во внешнем приложении. Эта функция и сборки, необходимые для написания кода, впервые были представлены в пакете обновления 1 (SP1) для InfoPath 2003. Объекты и участники для автоматизации InfoPath были обновлены, чтобы обеспечить дополнительные функциональные возможности при написании кода внешней автоматизации для InfoPath 2013.
  
Классы и члены, используемые для внешней автоматизации, предоставляются через пространства имен [Microsoft.Office.Interop.InfoPath](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.aspx) и [Microsoft.Office.Interop.InfoPath.Xml](https://msdn.microsoft.com/library/microsoft.office.interop.infopath.xml). Файлы сборки, необходимые для написания кода автоматизации, расположены в папке C:\Program Files\Microsoft Office\Office14. 
  
|**Assembly**|**Описание**|
|:-----|:-----|
|Microsoft.Office.Interop.InfoPath.dll  <br/> |Обеспечивает com-интероп с объектной моделью InfoPath COM для внешнего кода автоматизации, написанного с C# или Visual Basic.  <br/> |
|Microsoft.Office.Interop.InfoPath.Xml.dll  <br/> |Предоставляет COM-взаимодействие в MSXML для операций XML DOM в коде внешней автоматизации, написанном на языке C# или Visual Basic.  <br/> |
   
Дополнительные сведения об объектных моделях, предоставляемых пространствами имен **Microsoft.Office.Interop.InfoPath** и **Microsoft.Office.Interop.InfoPath.Xml,** которые используются исключительно для автоматизации приложения InfoPath с помощью управляемого кода из внешних приложений, см. в центре разработчиков [InfoPath.](https://msdn.microsoft.com/office/aa905434.aspx)
  
### <a name="the-infopath-forms-services-object-model"></a>Новая объектная модель служб форм InfoPath

Объектная модель управляемого кода для автоматизации InfoPath Forms Services задач администрирования реализуется в Microsoft.Office.InfoPath.Server.dll, расположенном на \< \> диске :\Program Files\Microsoft Office Server\15.0\Bin на установке Microsoft SharePoint Server 2013 г.
  
|**Assembly**|**Описание**|
|:-----|:-----|
|Microsoft.Office.InfoPath.Server.dll  <br/> |Объектная модель для автоматизации InfoPath Forms Services таких задач, как загрузка, активация или отключение шаблонов форм с поддержкой браузера.  <br/> |
   
Дополнительные сведения о InfoPath Forms Services объектной модели см. в SharePoint Server 2013 Software Developers Kit (SDK), который доступен в MSDN.
  
## <a name="infopath-development-environment"></a>Среда разработки InfoPath

Разработка бизнес-логики в шаблонах форм InfoPath 2013 может быть выполнена с помощью Visual Studio 2012 г. с установкой надстройки [2012 набор средств Microsoft Visual Studio Tools для работы с приложениями 2012](https://www.microsoft.com/en-us/download/details.aspx?id=38807) г. 
  
> [!NOTE]
> InfoPath 2013 не поддерживает создание или редактирование шаблонов форм, которые используют бизнес-логику, написанную с помощью JScript или VBScript, хотя заполните infoPath поддерживает открытие шаблонов форм на основе скриптов, созданных в предыдущих версиях InfoPath. 
  
## <a name="see-also"></a>См. также

- [Погон: создание базового шаблона формы с кодом](walkthrough-creating-a-basic-form-template-with-code.md)
- [Пошаговое руководство. Создание и отладка начального шаблона формы с помощью объектной модели InfoPath 2003](walkthrough-create-and-debug-basic-form-template-using-infopath-object-model.md)


---
title: Обработка ошибок
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- ошибки [infopath 2007], обработка,FormErrorCollection [InfoPath 2007], InfoPath 2007, обработка ошибок,FormError [InfoPath 2007], обработка ошибок [InfoPath 2007]
localization_priority: Normal
ms.assetid: 132cb698-d9a5-4767-b3d1-5dd1343a1ff4
description: При создании пользовательских приложений разработчики часто выполняют обработку ошибок, которая предполагает написание программы для проверки на наличие ошибок, созданных приложением, или для создания и инициирования пользовательских ошибок. Объектная модель InfoPath, предоставленная Корпорацией Майкрософт. Office. Пространство имен InfoPath поддерживает обработку ошибок с помощью класса FormError в связи с классом FormErrorCollection.
ms.openlocfilehash: 30cf649188b7e4cbc35469d2a50540bb13ecb38d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410779"
---
# <a name="handle-errors"></a><span data-ttu-id="3165f-105">Обработка ошибок</span><span class="sxs-lookup"><span data-stu-id="3165f-105">Handle Errors</span></span>

<span data-ttu-id="3165f-106">При создании пользовательских приложений разработчики часто выполняют обработку ошибок, которая предполагает написание программы для проверки на наличие ошибок, созданных приложением, или для создания и инициирования пользовательских ошибок.</span><span class="sxs-lookup"><span data-stu-id="3165f-106">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors.</span></span> <span data-ttu-id="3165f-107">Объектная модель InfoPath, предоставленная [Microsoft.Office. Пространство](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) имен InfoPath поддерживает обработку ошибок с помощью класса [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) в связи с классом [FormErrorCollection.](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-107">The InfoPath object model provided by the [Microsoft.Office.InfoPath](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.aspx) namespace supports error handling through the use of the [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) class in association with the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> 
  
<span data-ttu-id="3165f-108">Ниже перечислены причины, по которым в приложении InfoPath могут возникать ошибки.</span><span class="sxs-lookup"><span data-stu-id="3165f-108">In InfoPath, errors can occur for the following reasons:</span></span>
  
- <span data-ttu-id="3165f-109">Введенным данным не удается пройти проверку на соответствие схеме XML.</span><span class="sxs-lookup"><span data-stu-id="3165f-109">When data entered into a form fails XML schema validation.</span></span>
    
- <span data-ttu-id="3165f-110">Неудачный результат проверки на соответствие пользовательским ограничениям.</span><span class="sxs-lookup"><span data-stu-id="3165f-110">When a custom validation constraint fails.</span></span>
    
- <span data-ttu-id="3165f-111">Если ошибка создается методом [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) объекта [событий XmlValidatingEventArgs.](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-111">When an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) method of the [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) event object.</span></span> 
    
- <span data-ttu-id="3165f-112">При ошибке, определенной пользователем, создается метод [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) класса [FormErrorCollection.](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-112">When a user-defined error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method of the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> 
    
## <a name="overview-of-the-formerrorcollection-class"></a><span data-ttu-id="3165f-113">Обзор класса "FormErrorCollection"</span><span class="sxs-lookup"><span data-stu-id="3165f-113">Overview of the FormErrorCollection Class</span></span>

<span data-ttu-id="3165f-114">Класс [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) предоставляет следующие методы и свойства, которые разработчики форм могут использовать для управления [объектами FormError,](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) которые содержит коллекция.</span><span class="sxs-lookup"><span data-stu-id="3165f-114">The [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class provides the following methods and properties, which form developers can use to manage the [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) objects that the collection contains.</span></span> 
  
|<span data-ttu-id="3165f-115">**Имя**</span><span class="sxs-lookup"><span data-stu-id="3165f-115">**Name**</span></span>|<span data-ttu-id="3165f-116">**Описание**</span><span class="sxs-lookup"><span data-stu-id="3165f-116">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3165f-117">[Добавление](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) метода (+3 перегрузки)</span><span class="sxs-lookup"><span data-stu-id="3165f-117">[Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method (+3 overloads)</span></span>  <br/> |<span data-ttu-id="3165f-118">Создает объект **FormError** и добавляет его в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="3165f-118">Creates a **FormError** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="3165f-119">[Удаление](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Delete.aspx) метода (+1 перегрузки)</span><span class="sxs-lookup"><span data-stu-id="3165f-119">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Delete.aspx) method (+1 overload)</span></span>  <br/> |<span data-ttu-id="3165f-120">Удаляет указанную пользовательскую ошибку из коллекции.</span><span class="sxs-lookup"><span data-stu-id="3165f-120">Deletes the specified user-defined error from the collection.</span></span>  <br/> |
|<span data-ttu-id="3165f-121">[Метод DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.DeleteAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-121">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="3165f-122">Удаляет все объекты **FormError** из коллекции.</span><span class="sxs-lookup"><span data-stu-id="3165f-122">Deletes all **FormError** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="3165f-123">[GetErrors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.GetErrors.aspx) (+1 перегрузка)</span><span class="sxs-lookup"><span data-stu-id="3165f-123">[GetErrors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.GetErrors.aspx) (+1 overload)</span></span>  <br/> |<span data-ttu-id="3165f-124">Возвращает все объекты **FormError** с указанным именем или типом, находящиеся в коллекции.</span><span class="sxs-lookup"><span data-stu-id="3165f-124">Returns all **FormError** objects of the specified name or type from the collection.</span></span>  <br/> |
|<span data-ttu-id="3165f-125">Свойство [Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-125">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-126">Возвращает количество объектов **FormError**, содержащихся в коллекции.</span><span class="sxs-lookup"><span data-stu-id="3165f-126">Gets a count of the number of **FormError** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="3165f-127">Свойство [Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-127">[Item](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-128">Возвращает ссылку на объект **FormError**, основываясь на указанном номере индекса.</span><span class="sxs-lookup"><span data-stu-id="3165f-128">Gets a reference to an **FormError** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-formerror-class"></a><span data-ttu-id="3165f-129">Обзор класса "FormError"</span><span class="sxs-lookup"><span data-stu-id="3165f-129">Overview of the FormError Class</span></span>

<span data-ttu-id="3165f-130">Класс [FormError предоставляет](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) следующие свойства, которые разработчики формы могут использовать для доступа к сведениям об ошибке, которая была поднята.</span><span class="sxs-lookup"><span data-stu-id="3165f-130">The [FormError](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.aspx) class provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="3165f-131">**Имя**</span><span class="sxs-lookup"><span data-stu-id="3165f-131">**Name**</span></span>|<span data-ttu-id="3165f-132">**Описание**</span><span class="sxs-lookup"><span data-stu-id="3165f-132">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3165f-133">[Свойство DetailedMessage](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.DetailedMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-133">[DetailedMessage](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.DetailedMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-134">Возвращает или задает подробное сообщение об ошибке для объекта **FormError**.</span><span class="sxs-lookup"><span data-stu-id="3165f-134">Gets or sets the detailed error message of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="3165f-135">[Свойство ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.ErrorCode.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-135">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-136">Возвращает или задает код ошибки для объекта **FormError**.</span><span class="sxs-lookup"><span data-stu-id="3165f-136">Gets or sets the error code of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="3165f-137">[Свойство site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Site.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-137">[Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Site.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-138">Возвращает объект **XPathNavigator**, расположенном в узле, связанном с объектом **FormError**.</span><span class="sxs-lookup"><span data-stu-id="3165f-138">Gets an **XPathNavigator** object that is positioned at the node associated with the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="3165f-139">[Свойство Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Message.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-139">[Message](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.Message.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-140">Возвращает или задает краткое сообщение об ошибке для объекта **FormError**.</span><span class="sxs-lookup"><span data-stu-id="3165f-140">Gets or sets the short error message of the **FormError** object.</span></span>  <br/> |
|<span data-ttu-id="3165f-141">[Свойство FormErrorType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.FormErrorType.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-141">[FormErrorType](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormError.FormErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="3165f-142">Возвращает тип объекта **FormError**.</span><span class="sxs-lookup"><span data-stu-id="3165f-142">Gets the type of the **FormError** object.</span></span>  <br/> |
   
## <a name="using-the-formerrorcollection-and-formerror-classes"></a><span data-ttu-id="3165f-143">Использование классов "FormErrorCollection" и "FormError"</span><span class="sxs-lookup"><span data-stu-id="3165f-143">Using the FormErrorCollection and FormError Classes</span></span>

<span data-ttu-id="3165f-144">Объект **FormErrorCollection,** связанный с формой, можно получить доступ через свойство [Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) объекта [XmlForm.](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-144">The **FormErrorCollection** object associated with a form is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.Errors.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) object.</span></span> <span data-ttu-id="3165f-145">Объект **FormErrorCollection** связан с базовым XML-документом формы, поэтому при возникновении ошибки можно получить доступ к этой и любым дополнительным ошибкам XML и управлять ими в текущем документе.</span><span class="sxs-lookup"><span data-stu-id="3165f-145">The **FormErrorCollection** object is associated with a form's underlying XML document so that when an error occurs, it and any additional errors can be accessed and managed within the current XML document.</span></span> <span data-ttu-id="3165f-146">В следующем примере демонстрируется использование цикла для поиска возможных ошибок в базовом XML-документе формы.</span><span class="sxs-lookup"><span data-stu-id="3165f-146">The following example demonstrates how a loop can be used to check the errors that may exist in a form's underlying XML document.</span></span> <span data-ttu-id="3165f-147">Если ошибки присутствуют, то эта функция обрабатывает в цикле каждую из них и отображает пользователю окна сообщения с помощью свойства **Message** объекта **FormError**.</span><span class="sxs-lookup"><span data-stu-id="3165f-147">If there are errors, the function loops through each of them, and, using the **Message** property of the **FormError** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(XPathNavigator xmlNode)
{
   foreach(FormError err in this.Errors)
   {
      if(xmlNode.InnerXml == err.Site.InnerXml)
         MessageBox.Show("The following error has occured: "
             + err.Message);
   }
}
```

```vb
Public Sub CheckErrors(ByVal xmlNode As XPathNavigator)
   Dim err As FormError
   For Each err In Me.Errors
      If xmlNode.InnerXml = err.Site.InnerXml Then
         MessageBox.Show("The following error has occured: " _
             &amp; err.Message)
   End If
End Sub
```

<span data-ttu-id="3165f-148">Предыдущую функцию можно вызвать из одного из обработчиков событий проверки данных в форме.</span><span class="sxs-lookup"><span data-stu-id="3165f-148">The preceding function could be called from one of the form's data validation event handlers.</span></span> <span data-ttu-id="3165f-149">Например, при использовании в обработнике событий для измененного события поля в форме вызов функции передает аргумент узла XML с помощью свойства [Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.Site.aspx) объекта [событий XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) следующим образом. [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-149">For example, when used in the event handler for the [Changed](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEvent.Changed.aspx) event of a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.Site.aspx) property of the [XmlEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlEventArgs.aspx) event object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

```vb
CheckErrors(e.Site)
```

<span data-ttu-id="3165f-150">Помимо обработки ошибок, созданных InfoPath, разработчики форм также могут создавать настраиваемые ошибки с помощью метода [ReportError (XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) [](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) объекта [событий XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) или с помощью метода Add класса [FormErrorCollection.](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx)</span><span class="sxs-lookup"><span data-stu-id="3165f-150">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) method of the [XmlValidatingEventArgs](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.aspx) event object, or by using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) method of the [FormErrorCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.aspx) class.</span></span> <span data-ttu-id="3165f-151">Для получения сведений об использовании методов [ReportError (XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) или [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) щелкните ссылки для этих методов в начале этой темы.</span><span class="sxs-lookup"><span data-stu-id="3165f-151">For information about using the [ReportError(XPathNavigator, Boolean, String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlValidatingEventArgs.ReportError.aspx) or [Add](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FormErrorCollection.Add.aspx) methods, click the links for those methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="3165f-152">Обработка исключений управляемого кода</span><span class="sxs-lookup"><span data-stu-id="3165f-152">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="3165f-153">Для обработки исключений, возникающих в шаблоне формы с управляемым кодом, можно воспользоваться методом "try-catch", как показано в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="3165f-153">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
FileQueryConnection queryXMLFile = 
   (FileQueryConnection)this.DataConnections["form1"];
// Perform the query.
try
{
   queryXMLFile.Execute();
}
catch (Exception ex)
{
   MessageBox.Show("Failed to query." + System.Environment.NewLine 
      + ex.Message);
}
```

```vb
Dim queryXMLFile As FileQueryConnection = _
   DirectCast(Me.DataConnections("form1"), FileQueryConnection)
' Perform the query.
Try
   queryXMLFile.Execute();
Catch ex As Exception
   MessageBox.Show("Failed to query." &amp; System.Environment.NewLine 
      &amp; ex.Message)
End Try
```

<span data-ttu-id="3165f-p106">Если в коде формы не используется обработка исключений "try-catch", то при отладке и просмотре приложение InfoPath будет отображать сведения о необработанных исключениях в диалоговом окне ошибок InfoPath. Кроме того, по умолчанию необработанные исключения не отображаются в диалоговом окне InfoPath во время выполнения при развертывании шаблона формы с управляемым кодом. Чтобы отображать сведения о необработанных исключениях во время выполнения, воспользуйтесь приведенной ниже процедурой.</span><span class="sxs-lookup"><span data-stu-id="3165f-p106">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing. Additionally, by default, unhandled exceptions are not displayed in the InfoPath error dialog box at run time when you deploy your managed-code form template. To display information about unhandled exceptions at run time, use the following procedure.</span></span>
  
### <a name="enable-notifications-for-unhandled-managed-code-exceptions-at-run-time"></a><span data-ttu-id="3165f-157">Включение уведомлений для необработанных исключений управляемого кода во время выполнения</span><span class="sxs-lookup"><span data-stu-id="3165f-157">Enable notifications for unhandled managed-code exceptions at run time</span></span>

1. <span data-ttu-id="3165f-158">Откройте конструктор InfoPath и щелкните вкладку **File.**</span><span class="sxs-lookup"><span data-stu-id="3165f-158">Open the InfoPath designer, and then click the **File** tab.</span></span> 
    
2. <span data-ttu-id="3165f-159">Щелкните **Параметры**, затем выберите **Параметры InfoPath** в категории **Общие**.</span><span class="sxs-lookup"><span data-stu-id="3165f-159">Click **Options**, and then click **InfoPath Options** under the **General** category.</span></span> 
    
3. <span data-ttu-id="3165f-160">На вкладке **Дополнительно** установите флажок **Уведомлять об ошибках кода Visual Basic и C#**.</span><span class="sxs-lookup"><span data-stu-id="3165f-160">On the **Advanced** tab, select the **Show a notification for Visual Basic and C# code errors** check box.</span></span> 
    


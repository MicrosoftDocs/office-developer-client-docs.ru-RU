---
title: Доступ ко внешним источникам данных
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
keywords:
- классов подключений данных [infopath 2007], дополнительным источникам данных [InfoPath 2007], данных [InfoPath 2007], дополнительный, класс DataSource [InfoPath 2007], доступ к внешним источникам данных [InfoPath 2007], класс DataSourceCollection [InfoPath 2007] Класс DataConnectionCollection [InfoPath 2007], класс DataConnection [InfoPath 2007], InfoPath 2007, доступ к внешним данным, данные [InfoPath 2007] внешних источников
localization_priority: Normal
ms.assetid: db7c2521-a1ad-4802-b398-79575d3d310a
description: При работе с шаблоном формы InfoPath можно написать код для доступа к дополнительным источникам данных формы и управления содержащимися в них данными.
ms.openlocfilehash: e26708e0033bbfe4110ac522dd1e0a0dd037c31e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807493"
---
# <a name="access-external-data-sources"></a><span data-ttu-id="e1c12-104">Доступ ко внешним источникам данных</span><span class="sxs-lookup"><span data-stu-id="e1c12-104">Access External Data Sources</span></span>

<span data-ttu-id="e1c12-105">При работе с шаблоном формы InfoPath можно написать код для доступа к дополнительным источникам данных формы и управления содержащимися в них данными.</span><span class="sxs-lookup"><span data-stu-id="e1c12-105">When working with an InfoPath form template, you can write code to access the form's secondary data sources and manipulate the data that they contain.</span></span> 
  
<span data-ttu-id="e1c12-106">Каждый дополнительный источник данных представлены объектом создан с помощью класса [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) и соответствующий сохраненные данные, полученные из внешнего источника данных, например база данных или веб-службы запросов.</span><span class="sxs-lookup"><span data-stu-id="e1c12-106">Each secondary data source is represented by an object instantiated using the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class, and corresponds to stored data, obtained from some external source of data, such as a database or a Web Service query.</span></span> <span data-ttu-id="e1c12-107">Следующие источники данных будут называться дополнительный так как при сохранении формы InfoPath, пользователь является сохранение данных только в источнике данных основной (или основной), не данные в дополнительные источники данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-107">These data sources are referred to as secondary because when the user saves an InfoPath form, the user is saving the data only in the main (or primary) data source, not the data in the secondary data sources.</span></span> <span data-ttu-id="e1c12-108">Подключение к источнику данных, представленного объект, созданный с помощью одного из классов «подключение к данным», такие как класс [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) , который представляет подключение к веб-службе XML.</span><span class="sxs-lookup"><span data-stu-id="e1c12-108">The connection to a data source is represented by an object instantiated using one of the "data connection" classes, such as the [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class, which represents a data connection to an XML Web Service.</span></span> 
  
<span data-ttu-id="e1c12-109">Представляет экземпляр объекта [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) хранилище данных XML, возвращенный подключения к данным (из базы данных или веб-службы запросов) и класс «подключение к данным» представляет само подключение к данным (как определенной и именованные с помощью **данных Подключения к** на вкладке **данные** ).</span><span class="sxs-lookup"><span data-stu-id="e1c12-109">The instantiated [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) object represents the storage of XML data returned by a data connection (from a database or Web Service query), and the "data connection" class represents the data connection itself (as defined and named using the **Data Connections** command on the **Data** tab).</span></span> 
  
<span data-ttu-id="e1c12-110">Объектная модель InfoPath поддерживает доступ к источникам данных дополнительного формы посредством использования класса [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) в сочетании с классом [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e1c12-110">The InfoPath object model supports access to a form's secondary data sources through the use of the [DataSource](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.aspx) class in association with the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class.</span></span> 
  
<span data-ttu-id="e1c12-111">Объектная модель InfoPath также предоставляет набор классов подключений данных, где содержатся сведения об используемых формой подключениях данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-111">The InfoPath object model also provides a set of data connection classes, containing information about the data connections used by the form.</span></span>
  
> [!NOTE]
> <span data-ttu-id="e1c12-112">В приложении Microsoft InfoPath 2003 подключение данных указывается как адаптер данных. </span><span class="sxs-lookup"><span data-stu-id="e1c12-112">In Microsoft InfoPath 2003, a data connection is referred to as a data adapter.</span></span> 
  
<span data-ttu-id="e1c12-p102">Существует два типа подключений данных. Подключения запросов используются для получения данных, которые затем сохраняются в дополнительном источнике данных. Подключения отправки используются для отправки данных, например, в базу данных или веб-службу. Отправленные данные копируются из основных или дополнительных источников данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-p102">Data connections are of two kinds: Query connections are used to obtain the data that is then stored in a secondary data source. Submit connections are used to submit data, to a database or Web service, for example. The submitted data is copied from the main or secondary data sources.</span></span> 
  
## <a name="overview-of-the-datasourcecollection-class"></a><span data-ttu-id="e1c12-116">Обзор класса DataSourceCollection</span><span class="sxs-lookup"><span data-stu-id="e1c12-116">Overview of the DataSourceCollection Class</span></span>

<span data-ttu-id="e1c12-117">Класс [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) предоставляет следующие свойства и методы, которые могут использоваться разработчиками форм для управления экземплярами объекта [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) , содержащимися в форме.</span><span class="sxs-lookup"><span data-stu-id="e1c12-117">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following properties and methods, which form developers can use to manage the [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) object instances that the form contains.</span></span> 
  
|<span data-ttu-id="e1c12-118">**Имя**</span><span class="sxs-lookup"><span data-stu-id="e1c12-118">**Name**</span></span>|<span data-ttu-id="e1c12-119">**Описание**</span><span class="sxs-lookup"><span data-stu-id="e1c12-119">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e1c12-120">Свойство [Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-120">[Count](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="e1c12-121">Возвращает количество экземпляров объектов  **DataSource** в семействе.</span><span class="sxs-lookup"><span data-stu-id="e1c12-121">Returns a count of the number of **DataSource** object instances contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="e1c12-122">Метод [GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-122">[GetEnumerator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.GetEnumerator.aspx) method</span></span>  <br/> |<span data-ttu-id="e1c12-123">Возвращает объект **IEnumerator**, который можно использовать для выполнения итерации по семейству.</span><span class="sxs-lookup"><span data-stu-id="e1c12-123">Returns an **IEnumerator** that can be used to iterate through the collection.</span></span>  <br/> |
|<span data-ttu-id="e1c12-124">Свойство [Item [Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-124">[Item[Int32]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="e1c12-125">Возвращает ссылку на указанный объект **DataSource** по значению индекса.</span><span class="sxs-lookup"><span data-stu-id="e1c12-125">Returns a reference to the specified **DataSource** object by index value.</span></span>  <br/> |
|<span data-ttu-id="e1c12-126">Свойство [Item [String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-126">[Item[String]](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="e1c12-127">Возвращает ссылку на указанный объект **DataSource** по имени.</span><span class="sxs-lookup"><span data-stu-id="e1c12-127">Returns a reference to the specified **DataSource** object by name.</span></span>  <br/> |
   
## <a name="overview-of-the-datasource-class"></a><span data-ttu-id="e1c12-128">Обзор класса DataSource</span><span class="sxs-lookup"><span data-stu-id="e1c12-128">Overview of the DataSource Class</span></span>

<span data-ttu-id="e1c12-129">Класс [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) предоставляет следующие методы и свойства, которые могут использоваться разработчиками форм для взаимодействия с дополнительным источником данных InfoPath.</span><span class="sxs-lookup"><span data-stu-id="e1c12-129">The [DataSourceCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSourceCollection.aspx) class provides the following method and properties, which form developers can use to interact with an InfoPath secondary data source.</span></span> 
  
|<span data-ttu-id="e1c12-130">**Имя**</span><span class="sxs-lookup"><span data-stu-id="e1c12-130">**Name**</span></span>|<span data-ttu-id="e1c12-131">**Описание**</span><span class="sxs-lookup"><span data-stu-id="e1c12-131">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e1c12-132">Метод [CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-132">[CreateNavigator](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.CreateNavigator.aspx) method</span></span>  <br/> |<span data-ttu-id="e1c12-133">Возвращает объект [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) для доступа и редактирования источника данных</span><span class="sxs-lookup"><span data-stu-id="e1c12-133">Returns an [XPathNavigator](https://msdn.microsoft.com/library/system.xml.xpath.xpathnavigator%28v=vs.110%29.aspx) object for accessing and editing the data source</span></span>  <br/> |
|<span data-ttu-id="e1c12-134">Свойство [QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-134">[QueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.QueryConnection.aspx) property</span></span>  <br/> |<span data-ttu-id="e1c12-135">Возвращает ссылку на связанный объект подключения данных. </span><span class="sxs-lookup"><span data-stu-id="e1c12-135">Gets a reference to the associated data connection object.</span></span>  <br/> <span data-ttu-id="e1c12-136">Чтобы выполнить запрос на подключение к данным и вставка возвращенные данные в XML-ФАЙЛЕ в узле XML, связанного с объектом **источника данных** , используйте метод [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) связанный объект подключения данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-136">To execute the query on the data connection and insert the returned data as XML into the XML node associated with the **DataSource** object, use the [Execute](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnection.Execute.aspx) method of the associated data connection object.</span></span>  <br/> |
|<span data-ttu-id="e1c12-137">Свойство [Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-137">[Name](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.Name.aspx) property</span></span>  <br/> |<span data-ttu-id="e1c12-138">Возвращает имя объекта **DataSource**.</span><span class="sxs-lookup"><span data-stu-id="e1c12-138">Gets the name of the **DataSource** object.</span></span>  <br/> |
|<span data-ttu-id="e1c12-139">Свойство [только для чтения](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-139">[ReadOnly](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.ReadOnly.aspx) property</span></span>  <br/> |<span data-ttu-id="e1c12-140">Возвращает значение, которое указывает наличие у источника данных атрибута только для чтения</span><span class="sxs-lookup"><span data-stu-id="e1c12-140">Gets a value that indicates whether the data source is in a read-only state</span></span>  <br/> |
|<span data-ttu-id="e1c12-141">Метод [GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-141">[GetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.GetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="e1c12-142">Возвращает значение именованного свойства для указанного XML-узла, который должен являться узлом **nonattribute** в основном источнике данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-142">Gets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
|<span data-ttu-id="e1c12-143">Метод [SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-143">[SetNamedNodeProperty](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataSource.SetNamedNodeProperty.aspx) method</span></span>  <br/> |<span data-ttu-id="e1c12-144">Задает значение именованного свойства для указанного XML-узла, который должен являться узлом **nonattribute** в основном источнике данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-144">Sets the value of a named property for the specified XML node, which must be a **nonattribute** node in the main data source.</span></span>  <br/> |
   
## <a name="overview-of-the-data-connection-classes"></a><span data-ttu-id="e1c12-145">Обзор классов подключений данных</span><span class="sxs-lookup"><span data-stu-id="e1c12-145">Overview of the Data Connection Classes</span></span>

<span data-ttu-id="e1c12-p103">Классы для доступа к подключениям данных представляют различные свойства и методы для получения и отправки данных через подключения к внешним источникам данных. Подключение данных, связанное с объектом **DataSource**, зависит от типа подключения внешних данных. Для доступа к подключениям данных приложение InfoPath реализует следующие классы.</span><span class="sxs-lookup"><span data-stu-id="e1c12-p103">The classes for accessing data connections provide different properties and methods that retrieve and submit data through connections to external data sources; the data connection that is associated with a **DataSource** object is dependent on the type of external data connection. InfoPath implements the following classes for accessing data connections.</span></span> 
  
|<span data-ttu-id="e1c12-148">**Имя**</span><span class="sxs-lookup"><span data-stu-id="e1c12-148">**Name**</span></span>|<span data-ttu-id="e1c12-149">**Описание**</span><span class="sxs-lookup"><span data-stu-id="e1c12-149">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e1c12-150">Класс [AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-150">[AdoQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-151">Запрашивает источник данных ADO/OLEDB, ограничивается Microsoft Access и Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e1c12-151">Queries an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="e1c12-152">Класс [AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-152">[AdoSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-153">Отправляет данные в источник данных ADO/OLEDB, ограничивается Microsoft Access и Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e1c12-153">Submits to an ADO/OLEDB data source; limited to Microsoft Access and Microsoft SQL Server.</span></span>  <br/> |
|<span data-ttu-id="e1c12-154">Класс [SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-154">[SharePointListRWQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-155">Запрашивает библиотеку документов или список SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e1c12-155">Queries a SharePoint list or document library.</span></span>  <br/> |
|[<span data-ttu-id="e1c12-156">SharePointListRWSubmitConnection</span><span class="sxs-lookup"><span data-stu-id="e1c12-156">SharePointListRWSubmitConnection</span></span>](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.SharePointListRWSubmitConnection.aspx) <br/> |<span data-ttu-id="e1c12-157">Отправляет данные в библиотеку документов или список SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e1c12-157">Submits to a SharePoint list or document library.</span></span>  <br/> |
|<span data-ttu-id="e1c12-158">Класс [WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-158">[WebServiceConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.WebServiceConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-159">Подключается к веб-службе XML.</span><span class="sxs-lookup"><span data-stu-id="e1c12-159">Connects to an XML Web service.</span></span>  <br/> |
|<span data-ttu-id="e1c12-160">Класс [FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-160">[FileQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-161">Запрашивает XML-файл.</span><span class="sxs-lookup"><span data-stu-id="e1c12-161">Queries an XML file.</span></span>  <br/> |
|<span data-ttu-id="e1c12-162">Класс [FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-162">[FileSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.FileSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-163">Отправляет данные в XML-файл.</span><span class="sxs-lookup"><span data-stu-id="e1c12-163">Submits to an XML file.</span></span>  <br/> |
|<span data-ttu-id="e1c12-164">Класс [EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-164">[EmailSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.EmailSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-165">Отправляет форму в виде вложения в сообщении электронной почты.</span><span class="sxs-lookup"><span data-stu-id="e1c12-165">Submits a form as an attachment in email.</span></span>  <br/> |
|<span data-ttu-id="e1c12-166">Класс [BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-166">[BdcQueryConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcQueryConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-167">Запрашивает внешний список на сервере под управлением SharePoint Foundation 2010 и SharePoint Server 2010.</span><span class="sxs-lookup"><span data-stu-id="e1c12-167">Queries an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
|<span data-ttu-id="e1c12-168">Класс [BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx)</span><span class="sxs-lookup"><span data-stu-id="e1c12-168">[BdcSubmitConnection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.BdcSubmitConnection.aspx) class</span></span>  <br/> |<span data-ttu-id="e1c12-169">Отправляет данные во внешний список на сервере под управлением SharePoint Foundation 2010 и SharePoint Server 2010.</span><span class="sxs-lookup"><span data-stu-id="e1c12-169">Submits to an external list on a server running SharePoint Foundation 2010 or SharePoint Server 2010.</span></span>  <br/> |
   
## <a name="using-the-datasourcecollection-and-the-datasource-classes"></a><span data-ttu-id="e1c12-170">Использование классов DataSourceCollection и DataSource</span><span class="sxs-lookup"><span data-stu-id="e1c12-170">Using the DataSourceCollection and the DataSource Classes</span></span>

<span data-ttu-id="e1c12-171">**DataSourceCollection** объект, представляющий коллекцию источников данных, связанных с шаблоном формы доступен через свойство [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) класса [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e1c12-171">The **DataSourceCollection** object that represents the collection of data sources associated with a form template is accessed through the [DataSources](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataSources.aspx) property of the [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) class.</span></span> <span data-ttu-id="e1c12-172">Например, при создании дополнительного источника данных с именем сотрудников, который получает данные из таблицы Employees базы данных Northwind, можно использовать объекта **DataSourceCollection** для задания ссылки на объект **DataSource** , который представляет извлеченные данные.</span><span class="sxs-lookup"><span data-stu-id="e1c12-172">For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataSourceCollection** object to set a reference to a **DataSource** object that represents the retrieved data.</span></span> 
  
<span data-ttu-id="e1c12-p105">В следующем примере кода имя дополнительного источника данных передается в метод доступа класса **DataSourceCollection**, возвращающего ссылку на объект **DataSource**, представляющий полученные данные таблицы Employees. XML-узел, где хранятся данные, полученные из дополнительного источника данных, отображается в окне сообщения с помощью метода **CreateNavigator** класса **DataSource** для доступа к свойству **InnerXml** класса **XPathNavigator**.</span><span class="sxs-lookup"><span data-stu-id="e1c12-p105">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataSourceCollection** class, which returns a reference to the **DataSource** object that represents the retrieved Employees table data. The XML node that stores the retrieved data from the secondary data source is displayed in a message box using the **CreateNavigator** method of the **DataSource** class to access the **InnerXml** property of the **XPathNavigator** class.</span></span> 
  
```cs
// Instantiate a variable to access the specified data source
// from the DataSourceCollection of the form.
DataSource myDataSource = 
   this.DataSources["Employees"];
// Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " +
   myDataSource.CreateNavigator().InnerXml.ToString());
```

```vb
' Instantiate a variable to access the specified data source
' from the DataSourceCollection of the form.
Dim myDataSource As DataSource = _
   Me.DataSources("Employees")
' Display the XML data from the secondary data source.
MessageBox.Show("Data source data: " &amp; _
   myDataSource.CreateNavigator().InnerXml.ToString())
```

<span data-ttu-id="e1c12-175">Для работы с данными, в дополнительного источника данных, используйте метод **CreateNavigator** класса **DataSource** возвращает ссылку на объект **XPathNavigator** , размещенный в узле, где хранится дополнительных данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-175">To manipulate the data that is contained in a secondary data source, use the **CreateNavigator** method of the **DataSource** class to return a reference to an **XPathNavigator** object positioned at the node where the secondary data is stored.</span></span> <span data-ttu-id="e1c12-176">Можно использовать свойства и методы класса **XPathNavigator** для работы с данными.</span><span class="sxs-lookup"><span data-stu-id="e1c12-176">You can use the properties or methods of the **XPathNavigator** class to manipulate the data.</span></span> <span data-ttu-id="e1c12-177">Для получения дополнительных сведений см [классов XPathNavigator и XPathNodeIterator](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span><span class="sxs-lookup"><span data-stu-id="e1c12-177">For more information, see [Work with the XPathNavigator and XPathNodeIterator Classes](how-to-work-with-the-xpathnavigator-and-xpathnodeiterator-classes.md).</span></span>
  
## <a name="using-the-dataconnectioncollection-and-the-dataconnection-classes"></a><span data-ttu-id="e1c12-178">Использование классов DataConnectionCollection и DataConnection</span><span class="sxs-lookup"><span data-stu-id="e1c12-178">Using the DataConnectionCollection and the DataConnection Classes</span></span>

<span data-ttu-id="e1c12-179">[DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) объект, представляющий коллекцию подключений к данным, связанного с шаблоном формы доступен через свойство [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) класса **XmlForm** .</span><span class="sxs-lookup"><span data-stu-id="e1c12-179">The [DataConnectionCollection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.DataConnectionCollection.aspx) object that represents the collection of data connections associated with a form template is accessed through the [DataConnections](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.DataConnections.aspx) property of the **XmlForm** class.</span></span> <span data-ttu-id="e1c12-180">Например при создании дополнительного источника данных с именем сотрудников, который получает данные из таблицы Employees базы данных Northwind, можно использовать объект **DataConnectionCollection** , связанный с шаблоном формы для задания ссылки на ** Подключение данных** , который представляет подключение к базе данных.</span><span class="sxs-lookup"><span data-stu-id="e1c12-180">For example, if you create a secondary data source named Employees that retrieves data from the Employees table in the Northwind database, you can use the **DataConnectionCollection** object associated with the form template to set a reference to the **DataConnection** that represents the connection to the database.</span></span> 
  
<span data-ttu-id="e1c12-181">В следующем примере кода имя дополнительного источника данных передается свойство доступа к данным класс **DataConnectionCollection** , который в этом случае возвращает ссылку на объект **ADOQueryConnection** , который представляет подключение к базе данных "Борей".</span><span class="sxs-lookup"><span data-stu-id="e1c12-181">In the following code sample, the name of the secondary data source is passed to the accessor property of the **DataConnectionCollection** class, which, in this case, returns a reference to the **ADOQueryConnection** object that represents the connection to the Northwind database.</span></span> <span data-ttu-id="e1c12-182">Для правильной работы необходимо явно привести объект, возвращаемых к типу **ADOQueryConnection** .</span><span class="sxs-lookup"><span data-stu-id="e1c12-182">For this to work properly, you must explicitly cast the object being returned to the **ADOQueryConnection** type.</span></span> <span data-ttu-id="e1c12-183">Свойство [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) интерфейса **ADOAdapterObject** используется для отображения в окне сообщения строки подключения ADO.</span><span class="sxs-lookup"><span data-stu-id="e1c12-183">The [Connection](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.AdoQueryConnection.Connection.aspx) property of the **ADOAdapterObject** interface is used to display the ADO connection string in a message box.</span></span> 
  
```cs
// Instantiate a variable to access the specified data connection
// from the DataConnectionCollection of the form. 
// You must cast to the specific data connection type
// (ADOQueryConnection) before you can access the data connection.
ADOQueryConnection myADOConnection = 
   (ADOQueryConnection)this.DataConnections["Employees"];
// Display the connection information for the data connection.
MessageBox.Show("Connection string: " + myADOConnection.Connection);
```

```vb
' Instantiate a variable to access the specified data connection
' from the DataConnectionCollection of the form. 
' You must cast to the specific data connection type
' (ADOQueryConnection) before you can access the data connection.
Dim myADOConnection As ADOQueryConnection = _
   DirectCast(Me.DataConnections("Employees"), ADOQueryConnection)
' Display the connection information for the data connection.
MessageBox.Show("Connection string: " &amp; myADOConnection.Connection)
```

## <a name="see-also"></a><span data-ttu-id="e1c12-184">См. также</span><span class="sxs-lookup"><span data-stu-id="e1c12-184">See also</span></span>



[<span data-ttu-id="e1c12-185">Создание шаблонов форм InfoPath, работающих со службами InfoPath Forms Services</span><span class="sxs-lookup"><span data-stu-id="e1c12-185">Creating InfoPath Form Templates That Work With InfoPath Forms Services</span></span>](creating-infopath-form-templates-that-work-with-infopath-forms-services.md)


---
title: Рекомендации по безопасности при разработке форм InfoPath
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 4690028e-20ac-297b-4651-801f5159c747
description: Перед прочтением данного раздела ознакомьтесь с разделом Дополнительные концепции безопасности форм InfoPath, чтобы получить общие сведения о модели безопасности InfoPath.
ms.openlocfilehash: 5108d8b1967b72ac4805f892bcf3bbae3aecccbe
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437814"
---
# <a name="security-guidelines-for-developing-infopath-forms"></a>Рекомендации по безопасности при разработке форм InfoPath

Перед прочтением данного раздела ознакомьтесь с разделом [Дополнительные концепции безопасности форм InfoPath](additional-infopath-form-security-concepts.md), чтобы получить общие сведения о модели безопасности InfoPath. 
  
## <a name="security-issues-for-users-of-infopath-forms"></a>Проблемы безопасности для пользователей форм InfoPath

Основные вопросы безопасности для пользователей Microsoft InfoPath подобны тем, которые связаны с веб-приложениями, работающими в Internet Explorer. Но нужно заметить, что уровень безопасности, обеспеченный в форме, зависит только от расположения шаблона форм, но не от того, где пользователи сохраняют и открывают конечные XML-документы, созданные ими. Пользователи могут определить расположение шаблона форм, с котором они работают, по строке состояния.
  
InfoPath помогает защитить пользователей от следующих потенциальных угроз, исходящих от шаблонов форм, созданных злоумышленниками:
  
- Возможность разглашения конфиденциальной информации с локального компьютера или удаленных источников данных.
    
- Злоумышленное использование элементов управления ActiveX.
    
- Злоумышленное использование свойств и методов объектной модели InfoPath.
    
## <a name="disclosure-of-sensitive-information"></a>Разглашение конфиденциальной информации

Наиболее общий сценарий разглашения конфиденциальной информации может быть реализован, если злоумышленно создается форма, использующая текущие учетные данные безопасности пользователя, чтобы получить доступ к источнику данных в домене, отличном от домена, на котором развернута сама форма. Например, злоумышленник может отправить форму по электронной почте или с помощью URL-адреса формы в частной папке или на веб-сервере. Форма может содержать скрипт, который выполняет запросы доступа к данным, используя текущие учетные данные пользователя, чтобы получить данные из источника данных в домене, к которому у пользователя-злоумышленника нет доступа; это может быть база данных зарплаты или другая конфиденциальная информация. Данный класс сценариев угроз безопасности называется междоменным доступом к данным.
  
Модель безопасности Internet Explorer, на которой построено приложение InfoPath, предоставляет параметр, называемый **Доступ к источникам данных за пределами доменов**, который по умолчанию отключает междоменный доступ для форм InfoPath, расположенных в зонах безопасности **Интернет** и **Ограниченные узлы**. Этот параметр также выдает пользователю запрос на разрешение или запрещение междоменного доступа для форм InfoPath, расположенных в зоне безопасности **Местная интрасеть**, и разрешает междоменный доступ для форм InfoPath, расположенных в зонах безопасности **Надежные узлы** или **Локальный компьютер**. 
  
## <a name="malicious-use-of-activex-controls"></a>Злоумышленное использование элементов управления ActiveX

Основной сценарий злоумышленного использования элементов ActiveX заключается в злоумышленном создании кода, направленном на элемент управления ActiveX, который получает доступ к файловой системе, чтобы получить личные файлы, списки паролей, удалить файлы или отключить систему пользователя. Форма InfoPath может запускать код, направленный на элементы управления ActiveX, только из бизнес-логики или из скрипта, работающего в панели задач. InfoPath не позволяет скриптам в представлениях InfoPath запускать элементы управления ActiveX.
  
Модель безопасности Internet Explorer, на которой построено приложение InfoPath, предоставляет параметр, называемый **Инициализировать и выполнять скрипты элементов ActiveX, помеченных как небезопасные**. Данный параметр по умолчанию отключает инициализацию и выполнение скриптов ActiveX, помеченных как небезопасные, для форм InfoPath, расположенных в зонах безопасности **Местная интрасеть**, **Интернет** и **Ограниченные узлы**. Этот параметр выдает запрос пользователю на разрешение или запрещение выполнения скриптов элементов управления ActiveX, помеченных как небезопасные, для форм InfoPath, расположенных в зонах безопасности **Надежные узлы** или **Локальный компьютер**, и разрешает выполнение скриптов элементов управления ActiveX, помеченных как небезопасные, для полностью надежных форм InfoPath. 
  
В режиме конструктора нельзя вставить элемент управления ActiveX, помеченный как небезопасный, в панель задач элементов управления для инициализации и выполнения скриптов вне зависимости от зоны безопасности и уровня надежности формы.
  
## <a name="malicious-use-of-infopath-object-model-code"></a>Злоумышленное использование кода объектной модели InfoPath

Методы и свойства InfoPath, вызываемые кодом, могут представлять различные уровни угроз. Например, метод [SaveAs(String)](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.SaveAs.aspx) класса [XmlForm](https://msdn.microsoft.com/library/Microsoft.Office.InfoPath.XmlForm.aspx) можно использовать для записи данных в любом месте файловой системы. Чтобы помочь в защите от злоумышленного использования таких элементов объектной модели, в объектной модели InfoPath реализовано три уровня безопасности, которые определяют, как и где может использоваться определенный элемент объектной модели. Дополнительные сведения об этой функции можно найти в статье [о модели безопасности для шаблонов форм с кодом](about-the-security-model-for-form-templates-with-code.md).
  
## <a name="best-practices-for-developers-of-infopath-forms"></a>Рекомендации для разработчиков форм InfoPath

Разработчики, создающие формы InfoPath, должны знать способы реализации следующих аспектов обеспечения безопасности:
  
- Распознавание потенциальных проблем безопасности в XML-файле, связанном с формой.
    
- Методы, позволяющие избежать отображения для пользователей форм назойливых или вводящих в заблуждение сообщений об ошибках.
    
- Подпись CAB-файлов элементов управления ActiveX.
    
- Как подписывать шаблоны форм, отправляемые в виде вложений в сообщения электронной почты.
    
## <a name="best-practices-for-xml-data-associated-with-a-form"></a>Рекомендации по данным XML, связанным с формой

Обратите внимание, что формы InfoPath могут извлекать данные XML из любых источников, включая такие, которые не контролируются пользователем или не являются доверенными. Например, InfoPath может получать XML-данные из ссылки на веб-страницу или из XML-вложения, отправленного пользователю в сообщении электронной почты. Чтобы предотвратить эти риски, ознакомьтесь со следующими рекомендациями:
  
- Не передавайте не имеющие доверия данные, полученные из XML, в функцию Microsoft JScript **eval()** или в свойство **innerHTML** панели задач. Эти вызовы могут использоваться для выполнения вредоносного скрипта. В панели задач в качестве альтернативы используйте свойство **innerText**. Обратите внимание, что представления InfoPath не могут выполнять скрипты. 
    
- Данные, отправленные в базу данных из XML-файла, могут представлять угрозы безопасности для базы данных, если они не проверены перед отправкой.
    
Данные, не проверенные перед отправкой их в источник данных, могут нарушить целостность данных в источнике данных или в худших случаях представляют потенциальную угрозу переполнений буфера. Также возможно внедрение в скрипт или SQL, если не имеющие доверия данные используются непосредственно на сервере.
  
## <a name="best-practices-to-avoid-presenting-confusing-error-messages"></a>Рекомендации по предотвращению неясных сообщений об ошибках

 **Развертывайте формы и их источники данных в одном и том же домене**
  
Угроза безопасности при междоменном доступе к данным плохо понимается большинством пользователей. Развертывание форм, которые постоянно выдают пользователям предупреждения и запросы о разрешении междоменного доступа к данным, создает эффект привыкания пользователей разрешать все запросы на междоменный доступ к данным или ведет к добавлению исходного домена в список **Надежные узлы** без принятия всерьез угроз безопасности. Чтобы избегать таких ситуаций, развертывайте формы InfoPath на том же сервере, что и все источники данных, от которых они зависят. 
  
 **Избегайте использования элементов управления ActiveX, не отмеченных как безопасные для выполнения скриптов**
  
Элементы управления ActiveX потенциально могут иметь открытые свойства и методы, которые можно использовать для нарушения системы пользователя, например методы для доступа к файловой системе компьютера. Рекомендуется использовать по возможности только элементы управления ActiveX, которые отмечены как безопасные для выполнения скриптов. Это элементы управления, проверенные на то, что они не повредят систему пользователя и не нарушат безопасность пользователя вне зависимости от того, как методы и свойства этих элементов управления контролируются скриптом веб-страницы. Также при создании элементов управления ActiveX для использования с InfoPath следует внимательно исследовать код и проверять элемент управления ActiveX перед тем, как сделать его безопасным для выполнения скриптов.
  
InfoPath использует модель безопасности, основанную на зонах безопасности Internet Explorer. Поэтому форма InfoPath будет использовать те же разрешения, что и Internet Explorer, которые по умолчанию включают вызовы скриптов для элементов управления ActiveX, отмеченных как безопасные для выполнения скриптов, без выдачи запроса пользователю.
  
## <a name="best-practices-for-managing-the-cab-files-of-activex-controls"></a>Рекомендации по управлению CAB-файлами элементов управления ActiveX

Элементы управления ActiveX могут располагаться в шаблонах форм, разработанных для редактора InfoPath. CAB-файлы для этих элементов управления, которые еще не находятся на компьютерах пользователей, должны быть включены в файл шаблона формы (с расширением XSN). Чтобы быть установленными, CAB-файлы, включенные в шаблоны форм, должны иметь цифровую подпись. InfoPath не будет устанавливать CAB-файл, не имеющий цифровой подписи, вне зависимости от уровня доверия или зоны безопасности.
  
Чтобы цифровая подпись CAB-файла могла быть проверена, файл должен быть подписан сертификатом, имеющим цепочку доверия, ведущую к уже доверенному корневому сертификату. В противном случае невозможно проверить подлинность цифровой подписи; при проверке цифровой подписи будет выдана ошибка и CAB-файл не будет установлен.
  
## <a name="best-practices-for-form-templates-sent-as-an-attachment-to-an-email-message"></a>Рекомендации по шаблонам форм, отправляемым в виде вложения в сообщение электронной почты

InfoPath поддерживает развертывание шаблонов форм в виде вложения в сообщение электронной почты и перемещение шаблонов форм из одного расположения в другое. Хорошей практикой безопасности является цифровая подпись шаблона формы, который вы разрабатываете и планируете развернуть в виде вложения в сообщение электронной почты. Цифровая подпись в шаблоне формы, развернутой в сообщении электронной почты, не только гарантирует подлинность шаблона. Она имеет дополнительное значение, позволяя автоматически обновлять шаблоны форм.
  
Шаблон форм должен быть подписан сертификатом, имеющим цепочку доверия, ведущую к уже доверенному корневому сертификату. Если он еще не подписан с помощью такого сертификата, проверка цифровой подписи выдаст ошибку, так как невозможно проверить подлинность подписи.
  
> [!NOTE]
> [!Примечание] Если подписанный шаблон форм запрашивает доступ типа "Домен" или "Ограниченный", InfoPath будет проверять цифровую подпись только для того, чтобы определить, может ли InfoPath автоматически обновлять шаблон форм. 
  
Дополнительные сведения о развертывании электронной почты можно найти в [уровнях безопасности, развертывании электронной почты и удаленных шаблонАх форм](security-levels-email-deployment-and-remote-form-templates.md).
  


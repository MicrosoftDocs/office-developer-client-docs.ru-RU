---
title: Уровни безопасности, развертывание электронной почты и удаленные шаблоны форм
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7fc438ad-ae26-3632-3444-371537eaecb3
description: Microsoft InfoPath поддерживает перемещение шаблонов форм из одного расположения в другое, отправку их в виде вложения в сообщение электронной почты и создание шаблонов форм с полным доверием, подписанных или установленных с цифровой подписью.
ms.openlocfilehash: 799f2b19bfc4daa4a177d789a811d20ca09e7153
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32299855"
---
# <a name="security-levels-email-deployment-and-remote-form-templates"></a>Уровни безопасности, развертывание электронной почты и удаленные шаблоны форм

Microsoft InfoPath поддерживает перемещение шаблонов форм из одного расположения в другое, отправку их в виде вложения в сообщение электронной почты и создание шаблонов форм с полным доверием, подписанных или установленных с цифровой подписью.
  
## <a name="security-levels"></a>Уровни безопасности

У шаблонов форм может быть один из трех уровней безопасности, в зависимости от того, где расположена форма. Эти три уровня безопасности описываются в следующих разделах. 
  
### <a name="restricted"></a>Ограниченный доступ

Уровень безопасности "Ограниченный" не допускает передачи каких-либо данных за пределы шаблона формы. Этот уровень безопасности призван предотвратить любую возможную передачу данных вредоносными формами от текущего компьютера к злоумышленнику. При запуске в этом режиме безопасности не будут работать следующие возможности:
  
- Области задач HTML  
- Запросы к SharePoint
- Отправка в SharePoint
- Запрос к XML-файлу
- Запрос к базе данных
- Отправка в базу данных
- Запрос к веб-службе
- Отправка в веб-службу
- Отправка в пользовательский код
- Отправка в среду внешнего размещения
- Элементы управления ActiveX
- Роли
- Рабочий процесс SharePoint
- Правила открытия нового документа
- Управляемый код
- Представление для внешней печати
- Связанные рисунки
    
### <a name="domain"></a>Домен

Уровень безопасности "Домен" допускает использование формы только в определенном домене, а разрешения ограничиваются параметрами Internet Explorer для зоны, в которой расположен домен. Форме разрешается отправлять данные в другие источники данных внутри собственного домена и получать данные из них, но обычно она не может получать данные из других доменов, если в зоне не допускается передача данных между доменами. Это минимально допустимый уровень безопасности для шаблонов форм, совместимых с браузером.
  
### <a name="full-trust"></a>Полное доверие

Уровень безопасности "Полное доверие" позволяет запускать форму с полным доверием на компьютере, на котором она будет использоваться. Этот уровень безопасности может использоваться только при работе с расположенной на сервере формой, подпись которой соответствует надежному корневому издателю на вашем компьютере, а также при установке формы. В обоих случаях требуется присвоить атрибуту **requireFullTrust** значение "yes". Этот параметр позволяет форме обращаться к вызовам объектной модели, например к функции сохранения файлов; кроме того, отключаются некоторые запросы безопасности, которые выводятся при запуске с более ограниченным уровнем безопасности. 
  
> [!NOTE]
> [!Примечание] Всем создаваемым в конструкторе InfoPath формам задается определенный уровень безопасности. InfoPath открывает формы с заданным ей уровнем безопасности. Если заданный форме уровень безопасности выше уровня безопасности, который может быть ей предоставлен, форма не откроется. 
  
Для установленных или подписанных шаблонов форм может быть задан только уровень безопасности "Полное доверие"; в противном случае максимальным уровнем доверия может быть "Домен". Программой InfoPath уровень доверия "Полное доверие" автоматически не устанавливается.
  
Уровень безопасности, предоставляемый форме, зависит от местоположения, из которого она открывается.
  
## <a name="trust-levels"></a>Уровни доверия

Максимальный уровень доверия, который можно задать шаблону формы, определяется местоположением, из которого открывается форма, а также дополнительным кодом подтверждения, как показано в следующей таблице. Атрибуты, перечисленные в таблице (например, HTTP, UNC,  *requireFullTrust),*— это записи, которые используются для определения уровня доверия, который можно предоставить форме, и применяются к формам, открытым в клиенте InfoPath. 
  
|Максимальный заданный уровень доверия|Полное доверие|Клиентский компьютер (в "песочнице")|Интрасеть (в "песочнице")|Интернет (в "песочнице")|Ограниченный доступ|
|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|
|**Файл: путь для доступа=местоположение, из которого открывается форма** <br/> |||X  <br/> |||
|**file: путь доступа, открытый из расположения или без пути доступа (независимо от того, \< \> откуда поступила форма)** <br/> |||||X  <br/> |
|**Местоположение, из которого открывается форма: интрасеть, HTTP или HTTPS** <br/> |||X  <br/> |||
|**Местоположение, из которого открывается форма: Интернет, HTTP или HTTPS** <br/> ||||X  <br/> ||
|**Местоположение, из которого открывается форма: UNC** <br/> |||X  <br/> |||
|**Установленный шаблон (requireFullTrust="yes")** <br/> |X  <br/> |||||
|**Установленный шаблон (requireFullTrust="no")** <br/> ||X  <br/> ||||
|**Шаблон с сертификатом надежного издателя** <br/> |X  <br/> |||||
|**Экспортированные файлы формы** <br/> |||X  <br/> |||
   
## <a name="form-open-behavior"></a>Поведение при открытых формах

Все файлы форм, открываемые в редакторе InfoPath, связаны набором условий, определяющих уровень безопасности, с которым форма будет открываться (если вообще будет). При открытии формы InfoPath в редакторе она либо будет открыта с соответствующим уровнем безопасности, либо не откроется совсем. Если форма запросит более высокий уровень безопасности, чем может быть ей предоставлен, (форма запрашивает определенный уровень безопасности с помощью атрибута **trustLevel** или **requireFullTrust**), загрузка будет запрещена. В противном случае она будет загружена с запрашиваемым уровнем безопасности. Если не разрешить открытие шаблона формы с запрашиваемым уровнем безопасности, пользователь не сможет открыть форму и получит сообщение об ошибке. 
  
В следующей таблице описываются условия, необходимые для открытия формы с каждым уровнем безопасности, а также поведение формы при попытке пользователя открыть ее.
  
|Открытие редактора или сбой|"Полное доверие" (requireFullTrust="yes")|"Домен" (trustLevel="Domain" или значение не присвоено)|"Ограниченный" (trustLevel="Restricted")|
|:-----|:-----|:-----|:-----|
|**Доверенный (установленный или с доверенным сертификатом)** <br/> |Редактор открывается с уровнем "Полное доверие"  <br/> |Н/Д  <br/> |Н/Д  <br/> |
|**Уровень доверия "Домен": клиентский компьютер** <br/> |Не открывается  <br/> |Редактор открывается на уровне домена  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
|**Уровень доверия "Домен": интрасеть** <br/> |Не открывается  <br/> |Редактор открывается на уровне домена  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
|**Уровень доверия "Домен": Интернет** <br/> |Не открывается  <br/> |Редактор открывается на уровне домена  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
|**Ограниченный доступ** <br/> |Не открывается  <br/> |Не открывается  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
   
## <a name="specifying-a-security-level"></a>Указание уровня безопасности

Конструктор форм InfoPath автоматически выбирает соответствующий уровень безопасности ("Ограниченный" или "Домен") в зависимости от используемых в форме функций. Всегда выбирается настройка безопасности с максимальными ограничениями (начиная с уровня "Ограниченный", чтобы обеспечить более высокий уровень защиты данных. Можно вручную переопределить эту автоматически задаваемую настройку, чтобы выбрать наиболее подходящий для формы уровень безопасности. Для этого нужно выполнить следующие действия:
  
1. Щелкните вкладку **Файл**, а затем  **Параметры формы** на вкладке **Сведения**. 
    
2. В списке **Категории** выберите **Безопасность и доверие**.
    
3. Снимите флажок **Автоматически определять уровень безопасности (рекомендуется)**. 
    
4. Выберите необходимый уровень безопасности.
    
## <a name="mail-deployment-and-browser-enabled-form-templates"></a>Развертывание почты и шаблоны форм с поддержкой веб-браузера

InfoPath позволяет отправлять шаблоны форм в виде вложения в сообщение электронной почты и перемещать их из одного расположения в другое. Развертывание по почте  простой и эффективный способ распространения форм для использования внутри организации и доставки форм удаленным пользователям.
  
Как вариант, при использовании Microsoft SharePoint Server 2010 с InfoPath Forms Services можно создавать шаблоны форм, позволяющие пользователям, у которых не установлен InfoPath, заполнять формы в веб-браузере.
  
## <a name="understanding-form-identity"></a>Понимание удостоверения формы

В конструкторе InfoPath все формы создаются с идентификаторами. Эти данные идентификации помогают InfoPath сопоставлять формы с шаблонами форм в кэше и загружать обновления форм при их отправке в общую папку. По умолчанию InfoPath создает два идентификатора для шаблонов форм: идентификатор формы (Form ID) и путь для доступа (Access Path). 
  
### <a name="form-id"></a>Идентификатор формы

Идентификатор формы  это уникальный идентификатор, который состоит из префикса, имени формы и пространства имен формы. Идентификатор должен иметь уникальное имя, с помощью которого можно правильно сопоставлять файлы формы со связанным шаблоном в кэше клиентского компьютера. Идентификатор формы указывается как атрибут имени (например,  `name="urn:MyForm:MyCompany:Template1:myXSD-1583-78-G3V94-23-47"`) в файле определения формы (XSF). 
  
### <a name="access-path"></a>Путь для доступа

Путь для доступа  это идентификатор местоположения, который используется для определения правильного местоположения шаблона формы, а также места для получения обновлений. При сохранении или публикации то местоположение, в котором сохраняется или публикуется шаблон формы, становится путем для доступа по умолчанию. Всякий раз при открытии формы на клиентском компьютере форма пытается сопоставить себя с формой из кэша. Это выполняется в следующем порядке:
  
1. поиск шаблона формы с полным доверием с совпадающим идентификатором формы;
    
2. поиск в кэше шаблона формы с полным доверием с совпадающим путем для доступа;
    
3. поиск в кэше шаблона формы с полным доверием с совпадающим идентификатором формы;
    
При обнаружении совпадения форма откроется с сопоставленным шаблоном формы. При обнаружении совпадения пути для доступа этот путь будет использоваться InfoPath для загрузки обновлений в шаблон формы. Этот способ упрощает администрирование, обслуживание и обновление форм на предприятиях. В тех случаях, когда совпадение не может быть найдено, а используется уровень доверия "Домен", форма не откроется. Путь для доступа указывается как атрибут **publishUrl** в файле определения формы (XSF). 
  
Так как для каждого шаблона формы существует два свойства идентификации, имеется набор эвристических методов для определения результирующих записей в кэше на основе состояния шаблона формы (имеет ли он путь для доступа, идентификатор формы или и то, и другое), а также на основе состояния сетевого подключения.
  
## <a name="designing-a-form-to-send-as-an-attachment-to-an-email-message"></a>Разработка формы для отправки в виде вложения в сообщение электронной почты

Все формы, созданные в конструкторе InfoPath, могут быть отправлены пользователям в виде вложения в сообщение электронной почты. Развертывание электронной почты — это простой и эффективный способ распространения форм для использования между пользователями, а также для развертывания форм среди удаленных пользователей.
  
### <a name="to-mail-a-form-template-to-other-users"></a>Отправка шаблона формы другим пользователям по электронной почте

1. Щелкните **вкладку** "Файл", **выберите**"Опубликовать" и нажмите кнопку **"Электронная** почта". 
    
2. Заполните следующие две страницы **Мастера публикации**, нажимая **Далее** после заполнения каждой из них, а затем нажмите кнопку **Опубликовать**.
    
3. Отобразилось сообщение электронной почты, позволяя вам заполнить список получателей и дополнительные инструкции для них.
    
4. Сделав это, нажмите кнопку **Отправить**. Форма и шаблон формы будут вложены в сообщение.
    
## <a name="email-deployment-restricted-domain-and-full-trust-form-templates"></a>Развертывание электронной почты: шаблоны форм с ограниченным доступом, доменами и полным доверием

Развертывание шаблонов форм с ограниченным доступом по электронной почте позволяет открывать динамические формы без подключений к данным из любого места. Получатели могут открывать шаблоны форм, отправленные как вложения электронной почты Microsoft Outlook 2010, русская версия из любого места, где получатель сохранил вложение. Кроме того, Outlook 2010 позволяет пользователям изменять формы непосредственно в сообщении.
  
Шаблоны форм с уровнем доверия "Домен" должны открываться из места публикации, но при публикации в списке получателей электронной почты в мастере публикации их можно отправить в виде вложения в сообщение электронной почты. При открытии вложения оно работает как ссылка на реальное место публикации шаблона. То, что действительно открывается в редакторе InfoPath,  это шаблон формы, находящийся в этом местоположении.
  
Использование шаблона формы уровня домена, отправленного в виде вложения электронной почты, напоминает использование любого другого типа документа; например, книга Microsoft Excel или документ Microsoft Word. Пользователь может просто щелкнуть форму, после чего она откроется, и ее можно будет использовать. Кроме того, пользователям доступны все преимущества обновления на уровне домена.
  
Вы можете отправлять сообщения по электронной почте шаблонам форм, которые запрашивают доступ с полным доверием, но эти шаблоны должны быть подписаны или они не смогут открываться. Шаблоны форм, запрашивающие доступ "Домен" или "Ограниченный доступ", не должны быть подписаны для отправки в виде вложения электронной почты. InfoPath не проверяет подпись, даже если шаблон подписан, за исключением проверки на возможность автоматического обновления. При добавлении цифровой подписи к шаблону формы с уровнем доверия "Домен" или "Ограниченный" функция автоматического обновления будет по-прежнему доступна. В этом случае цифровая подпись заблокирует вывод сообщений о конфликте в кэше.
  
## <a name="sharing-forms-by-email-message-or-from-a-common-shared-location"></a>Совместное использование форм по электронной почте или из общего общего расположения

При создании формы, которая будет развернута по электронной почте, следует учитывать некоторые вопросы.
  
- **Будет ли форма обновляться регулярно?** При разработке формы, которая должна регулярно обновляться, ее следует опубликовать в общей папке, прежде чем отправлять другим пользователям. Это позволяет обновлять форму, публикуя новые версии в общей папке, а также сразу же распространять шаблон формы среди пользователей, не имеющих доступа к общей папке. 
    
   Если форма обновляется, а затем распространяется по электронной почте, пользователи получают сообщение о конфликте в кэше при попытке открыть новую форму, если на компьютере сохранена более старая версия и путь доступа изменился. Появится запрос, какую версию необходимо использовать. Даже если обновленная форма и форма на компьютере пользователя одинаковы, будет выведено сообщение о конфликте в кэше, а также запрос на выбор определенной копии для использования. В последнем случае лучше всего совместно использовать форму из общей папки.
    
- **Использует ли форма подключение к данным или другие функции, не поддерживаемые при уровне безопасности "Ограниченный"?** При разработке формы, которой нужен уровень безопасности "Домен", потребуется опубликовать форму в общей папке, чтобы пользователи смогли ее открыть. Поскольку шаблоны форм открываются только на запрашиваемом уровне безопасности, формы, открытые непосредственно из сообщения электронной почты, не открываются, если InfoPath не может предоставить безопасность на уровне домена. 
    
## <a name="benefits-of-using-signed-form-templates"></a>Преимущества использования подписанных шаблонов форм

- Шаблон формы открывается с уровнем безопасности "Полное доверие".
    
- Не выводится сообщение о конфликте в кэше при перемещении формы в новое местоположение.
    
Кроме того, если шаблон формы подписан, доступна функция автоматического обновления. Дополнительные сведения см. в разделе [Развертывание шаблонов подписанной формы InfoPath](deploying-signed-infopath-form-templates.md).
  
### <a name="example-updating-domain-or-restricted-templates"></a>Пример: обновление шаблонов домена или с ограниченным доступом

В следующем примере показано, как обновленный подписанный шаблон формы, запрашивающий доступ уровня "Домен" или "Ограниченный", перезаписывает более старую копию: 
  
1. "А" отправляет подписанный шаблон формы "Б".
    
2. "Б" открывает шаблон формы.
    
3. "А" обновляет шаблон формы (например, добавляет поля).
    
4. "А" отправляет обновленный шаблон формы "Б".
    
5. "Б" открывает обновленный шаблон формы.
    
### <a name="example-deploying-restricted-form-templates-on-an-extranet"></a>Пример. Развертывание ограниченных шаблонов форм в экстрасети
  
1. Сохраните шаблон формы "Домен" на веб-сайте, на Microsoft SharePoint Foundation 2010.
    
2. Измените уровень безопасности шаблона формы на "Ограниченный".
    
3. Сохраните шаблон формы на рабочем столе компьютера.
    
4. Удалите URL-адрес (это необходимо сделать, только если пользователи имеют доступ к первоначальному месту публикации).
    
5. Отправьте форму пользователям по экстрасети.
    
6. Попросите пользователей установить форму.
    
7. Попросите пользователей заполнить форму и отправить ее вам обратно.
    
8. Сохраните форму обратно на веб-сайте, где работает SharePoint Foundation 2010, и повторно привяжите форму к этой библиотеке с помощью параметра **"Relink documents to this** **Library"** на странице "Параметры библиотеки форм". 
    
## <a name="signature-verification-failure"></a>Сбой проверки подписи

Подписанный шаблон форм, запрашивающий доступ с полным доверием, но для которого невозможно выполнить проверку подлинности подписи, не откроется. Сбой проверки подписи может возникнуть по одной из следующих причин:
  
- Корневой сертификат находится не в хранилище доверенных корневых сертификатов.
    
- Истек срок действия сертификата, который использовался для подписывания шаблона формы.
    
- Сертификат, который использовался для подписывания шаблона формы, был отозван.
    
- Подпись шаблона формы повреждена (это свидетельствует о том, что шаблон формы был изменен после подписывания).
    
Если подписанный шаблон формы запрашивает доступ с уровнем "Домен" или "Ограниченный", InfoPath не проверяет подпись, за исключением проверки на возможность автоматического обновления шаблона.
  
## <a name="infrastructure-registry-keys-for-form-migration-open-behavior"></a>Ключи реестра инфраструктуры для открытого поведения при миграции формы

Когда пользователь пытается открыть форму, а идентификаторы формы и шаблоном совпадают, выводится сообщение об ошибке, если шаблон формы имеет уровень доверия "Домен", а домен не совпадает с атрибутом  *href*  формы. Это не позволяет открывать формы, которые не были явным образом созданы с помощью шаблона формы. 
  
В InfoPath не допускается одновременное существование шаблонов форм с одинаковым идентификатором формы. С помощью четырех дополнительных разделов реестра администраторы могут разрешать или запрещать пользователями открывать XML-файл с использованием шаблона формы. Данная модель также позволяет администраторам определять желаемое поведение форм при их открытии.
  
В следующей таблице приведены параметры разделов реестра по умолчанию. Если разделы реестра отсутствуют, будут использоваться значения по умолчанию из таблицы.
  
Приведенные пары "имя-значение" соответствуют параметрам домена Internet Explorer. Эти значения задают поведение при открытии форм в указанных зонах безопасности: они либо полностью запрещают или разрешают открытие форм, либо предоставляют пользователям возможность сделать этот выбор самостоятельно.
  
|**Значение имени**|**Block**|**Пользовательский интерфейс**|**Allow**|
|:-----|:-----|:-----|:-----|
|**Интернет** <br/> |X  <br/> |||
|**Интрасеть** <br/> ||X  <br/> ||
|**Клиентский компьютер** <br/> |||X  <br/> |
|**Надежный сайт** <br/> |||X  <br/> |
   
Путь к ключу `HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\InfoPath\Open Behaviors` реестра: .

Поведение формы при ее открытии определяется следующим образом:
  
- `Block [REG_DWORD = 0]`- Выводится диалоговое окно об ошибке с кнопкой "Справка". Если форма запущена в указанной зоне безопасности и не соответствует домену шаблона, открытие XML-файла будет запрещено. 
    
- `User Interface [REG_DWORD = 1]`- Выводится диалоговое окно с кнопками "Да" и "Нет". Если форма запущена в указанной зоне безопасности и не соответствует домену шаблона, пользователю будет предложено открыть XML-файл с использованием шаблона формы. 
    
- `Allow [REG_DWORD = 2]`- XML-файл откроется, а сообщения об ошибках или предупреждения выводиться не будут. Если форма запущена в указанной зоне безопасности и не соответствует домену шаблона, открытие XML-файла будет разрешено. 
    
Если открыть форму с использованием шаблона, запущенного с уровнем безопасности "Домен", а домен безопасности местоположения "cached from" этого шаблона (то есть, местоположения, откуда выполняется кэширование формы) и атрибут формы **href** не совпадут, программа InfoPath обратится к реестру, чтобы задать поведение формы при ее открытии. Заданное поведение определяется в зависимости от зоны безопасности, в которой расположен шаблон (значение  *CachedFromLocation*  ). 
  
Например, когда у формы и у шаблона совпадает идентификатор формы, но не путь для доступа, а кэширование шаблона формы выполняется из местоположения в Интернете, программой InfoPath будет выведено диалоговое окно об ошибке с кнопкой "Справка".
  
> [!NOTE]
> [!Примечание] Если в качестве домена используется домен "Ограниченный" для Internet Explorer, формы InfoPath открываться не будут, поэтому раздел реестра для зоны ограниченных сайтов Internet Explorer отсутствует. 
  


---
title: Уровни безопасности, развертывание по электронной почте и удаленные шаблоны форм
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 7fc438ad-ae26-3632-3444-371537eaecb3
description: Microsoft InfoPath поддерживает перемещение шаблонов форм из одного места в другое, их отправку в виде вложения в сообщение электронной почты и создание полное доверие шаблонов форм, которые имеют цифровую подпись или установлены.
ms.openlocfilehash: ea0145eb45f6a03dc8637ba5ec1dc1c80d240006
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807592"
---
# <a name="security-levels-email-deployment-and-remote-form-templates"></a>Уровни безопасности, развертывание по электронной почте и удаленные шаблоны форм

Microsoft InfoPath поддерживает перемещение шаблонов форм из одного места в другое, их отправку в виде вложения в сообщение электронной почты и создание полное доверие шаблонов форм, которые имеют цифровую подпись или установлены.
  
## <a name="security-levels"></a>Уровни безопасности

У шаблонов форм может быть один из трех уровней безопасности, в зависимости от того, где расположена форма. Эти три уровня безопасности описываются в следующих разделах. 
  
### <a name="restricted"></a>Ограниченный

Уровень безопасности "Ограниченный" не допускает передачи каких-либо данных за пределы шаблона формы. Этот уровень безопасности призван предотвратить любую возможную передачу данных вредоносными формами от текущего компьютера к злоумышленнику. При запуске в этом режиме безопасности не будут работать следующие возможности:
  
- Области задач HTML  
- Запросы к SharePoint
- Отправка в SharePoint
- Запрос к XML-файлу
- Запрос к базе данных
- Отправка в базу данных
- Запрос к веб-службе
- Отправка в веб-службу
- Отправка в пользовательский код
- Отправка в среду внешнего размещения
- Элементы управления ActiveX
- Роли
- Рабочий процесс SharePoint
- Правила открытия нового документа
- Управляемый код
- Представление для внешней печати
- Связанные рисунки
    
### <a name="domain"></a>Домен

Уровень безопасности "Домен" допускает использование формы только в определенном домене, а разрешения ограничиваются параметрами Internet Explorer для зоны, в которой расположен домен. Форме разрешается отправлять данные в другие источники данных внутри собственного домена и получать данные из них, но обычно она не может получать данные из других доменов, если в зоне не допускается передача данных между доменами. Это минимально допустимый уровень безопасности для шаблонов форм, совместимых с браузером.
  
### <a name="full-trust"></a>Полное доверие

Уровень безопасности "Полное доверие" позволяет запускать форму с полным доверием на компьютере, на котором она будет использоваться. Этот уровень безопасности может использоваться только при работе с расположенной на сервере формой, подпись которой соответствует надежному корневому издателю на вашем компьютере, а также при установке формы. В обоих случаях требуется присвоить атрибуту **requireFullTrust** значение "yes". Этот параметр позволяет форме обращаться к вызовам объектной модели, например к функции сохранения файлов; кроме того, отключаются некоторые запросы безопасности, которые выводятся при запуске с более ограниченным уровнем безопасности. 
  
> [!NOTE]
> [!Примечание] Всем создаваемым в конструкторе InfoPath формам задается определенный уровень безопасности. InfoPath открывает формы с заданным ей уровнем безопасности. Если заданный форме уровень безопасности выше уровня безопасности, который может быть ей предоставлен, форма не откроется. 
  
Для установленных или подписанных шаблонов форм может быть задан только уровень безопасности "Полное доверие"; в противном случае максимальным уровнем доверия может быть "Домен". Программой InfoPath уровень доверия "Полное доверие" автоматически не устанавливается.
  
Уровень безопасности, предоставляемый форме, зависит от местоположения, из которого она открывается.
  
## <a name="trust-levels"></a>Уровни доверия

Максимальный уровень доверия, который можно задать шаблону формы, определяется местоположением, из которого открывается форма, а также дополнительным кодом подтверждения, как показано в следующей таблице. Атрибуты, перечисленные в таблице (например, HTTP, UNC, *requireFullTrust*), записи, которые используются для определения уровня доверия, который может быть предоставлен формы и примените на формах, открытых в клиенте InfoPath. 
  
|Максимальный заданный уровень доверия |Полное доверие|Клиентский компьютер (в "песочнице")|Интрасеть (в "песочнице")|Интернет (в "песочнице")|Ограниченный|
|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|
|**файл: путь для доступа = местоположение, из** <br/> |||X   <br/> |||
|**файл: путь для доступа\<\>местоположение, из или путь для доступа отсутствует (независимо от того, где откуда получена форма)** <br/> |||||X   <br/> |
|**Открывается из расположения: Интрасеть, HTTP или HTTPS** <br/> |||X   <br/> |||
|**Открывается из расположения: Интернет, HTTP или HTTPS** <br/> ||||X   <br/> ||
|**Открывается из расположения: UNC** <br/> |||X   <br/> |||
|**Установленный шаблон (requireFullTrust = «yes»)** <br/> |X   <br/> |||||
|**Установленный шаблон (requireFullTrust = «no»)** <br/> ||X   <br/> ||||
|**Шаблон с сертификатом надежного издателя** <br/> |X   <br/> |||||
|**Экспортированные файлы формы** <br/> |||X   <br/> |||
   
## <a name="form-open-behavior"></a>Поведение при открытии формы

Все файлы форм, открываемые в редакторе InfoPath, связаны набором условий, определяющих уровень безопасности, с которым форма будет открываться (если вообще будет). При открытии формы InfoPath в редакторе она либо будет открыта с соответствующим уровнем безопасности, либо не откроется совсем. Если форма запросит более высокий уровень безопасности, чем может быть ей предоставлен, (форма запрашивает определенный уровень безопасности с помощью атрибута **trustLevel** или **requireFullTrust**), загрузка будет запрещена. В противном случае она будет загружена с запрашиваемым уровнем безопасности. Если не разрешить открытие шаблона формы с запрашиваемым уровнем безопасности, пользователь не сможет открыть форму и получит сообщение об ошибке. 
  
В следующей таблице описываются условия, необходимые для открытия формы с каждым уровнем безопасности, а также поведение формы при попытке пользователя открыть ее.
  
|Открытие редактора или сбой|"Полное доверие" (requireFullTrust="yes")|"Домен" (trustLevel="Domain" или значение не присвоено)|"Ограниченный" (trustLevel="Restricted")|
|:-----|:-----|:-----|:-----|
|**Доверенный (установленный или с доверенным сертификатом)** <br/> |Редактор открывается с уровнем "Полное доверие"  <br/> |недоступно  <br/> |Нет  <br/> |
|**Доверия домен: Клиентский компьютер** <br/> |Не открывается  <br/> |Редактор открывается на уровне домена  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
|**Доверия домен: интрасеть** <br/> |Не открывается  <br/> |Редактор открывается на уровне домена  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
|**Доверия домен: Интернет** <br/> |Не открывается  <br/> |Редактор открывается на уровне домена  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
|**Существуют ограничения** <br/> |Не открывается  <br/> |Не открывается  <br/> |Редактор открывается с уровнем "Ограниченный"  <br/> |
   
## <a name="specifying-a-security-level"></a>Определение уровня безопасности

Конструктор форм InfoPath автоматически выбирает соответствующий уровень безопасности ("Ограниченный" или "Домен") в зависимости от используемых в форме функций. Всегда выбирается настройка безопасности с максимальными ограничениями (начиная с уровня "Ограниченный", чтобы обеспечить более высокий уровень защиты данных. Можно вручную переопределить эту автоматически задаваемую настройку, чтобы выбрать наиболее подходящий для формы уровень безопасности. Для этого нужно выполнить следующие действия:
  
1. Щелкните вкладку **Файл**, а затем  **Параметры формы** на вкладке **Сведения**. 
    
2. В списке **Категории** выберите **Безопасность и доверие**.
    
3. Снимите флажок **Автоматически определять уровень безопасности (рекомендуется)**. 
    
4. Выберите необходимый уровень безопасности.
    
## <a name="mail-deployment-and-browser-enabled-form-templates"></a>Развертывание по почте и шаблоны форм с поддержкой веб-браузера

InfoPath позволяет отправлять шаблоны форм в виде вложения в сообщение электронной почты и переместите их из одного места в другое. Развертывание по почте  простой и эффективный способ распространения форм для использования внутри организации и доставки форм удаленным пользователям.
  
Как вариант, при использовании Microsoft SharePoint Server 2010 с InfoPath Forms Services можно создавать шаблоны форм, позволяющие пользователям, у которых не установлен InfoPath, заполнять формы в веб-браузере.
  
## <a name="understanding-form-identity"></a>Общие сведения об идентификаторах формы

В конструкторе InfoPath все формы создаются с идентификаторами. Эти данные идентификации помогают InfoPath сопоставлять формы с шаблонами форм в кэше и загружать обновления форм при их отправке в общую папку. По умолчанию InfoPath создает два идентификатора для шаблонов форм: идентификатор формы (Form ID) и путь для доступа (Access Path). 
  
### <a name="form-id"></a>Идентификатор формы

Идентификатор формы  это уникальный идентификатор, который состоит из префикса, имени формы и пространства имен формы. Идентификатор должен иметь уникальное имя, с помощью которого можно правильно сопоставлять файлы формы со связанным шаблоном в кэше клиентского компьютера. Идентификатор формы указывается как атрибут имени (например,  `name="urn:MyForm:MyCompany:Template1:myXSD-1583-78-G3V94-23-47"`) в файле определения формы (XSF). 
  
### <a name="access-path"></a>Путь для доступа

Путь для доступа  это идентификатор местоположения, который используется для определения правильного местоположения шаблона формы, а также места для получения обновлений. При сохранении или публикации то местоположение, в котором сохраняется или публикуется шаблон формы, становится путем для доступа по умолчанию. Всякий раз при открытии формы на клиентском компьютере форма пытается сопоставить себя с формой из кэша. Это выполняется в следующем порядке:
  
1. поиск шаблона формы с полным доверием с совпадающим идентификатором формы;
    
2. поиск в кэше шаблона формы с полным доверием с совпадающим путем для доступа;
    
3. поиск в кэше шаблона формы с полным доверием с совпадающим идентификатором формы;
    
При обнаружении совпадения форма откроется с сопоставленным шаблоном формы. При обнаружении совпадения пути для доступа этот путь будет использоваться InfoPath для загрузки обновлений в шаблон формы. Этот способ упрощает администрирование, обслуживание и обновление форм на предприятиях. В тех случаях, когда совпадение не может быть найдено, а используется уровень доверия "Домен", форма не откроется. Путь для доступа указывается как атрибут **publishUrl** в файле определения формы (XSF). 
  
Так как для каждого шаблона формы существует два свойства идентификации, имеется набор эвристических методов для определения результирующих записей в кэше на основе состояния шаблона формы (имеет ли он путь для доступа, идентификатор формы или и то, и другое), а также на основе состояния сетевого подключения.
  
## <a name="designing-a-form-to-send-as-an-attachment-to-an-email-message"></a>Разработка формы для отправки в виде вложения в сообщение электронной почты

Все формы, созданные в конструкторе InfoPath можно отправить пользователям как вложения в сообщение электронной почты. Развертывание электронной почты — это простой и удобный инструмент для распространения формы для использования офисами и развертывания форм для удаленных пользователей.
  
### <a name="to-mail-a-form-template-to-other-users"></a>Отправка шаблона формы другим пользователям по электронной почте

1. Перейдите на вкладку **файл** , нажмите кнопку **Опубликовать**и затем нажмите кнопку **электронной почты** . 
    
2. Заполните следующие две страницы **Мастера публикации**, нажимая **Далее** после заполнения каждой из них, а затем нажмите кнопку **Опубликовать**.
    
3. Сообщения электронной почты появится в список получателей и любые дополнительные инструкции, которые могут иметь для них.
    
4. Сделав это, нажмите кнопку **Отправить**. Форма и шаблон формы будут вложены в сообщение.
    
## <a name="email-deployment-restricted-domain-and-full-trust-form-templates"></a>Отправить по электронной почте развертывания: ограниченный, домен и полное доверие шаблонов форм

Развертывание по электронной почте шаблонов форм с ограниченным доступом позволяет динамических форм без подключения к данным для открытия в любом месте. Получатели могут открывать шаблонов форм, отправляемых в виде вложений электронной почты непосредственно из Microsoft Outlook 2010 или всякий раз, когда получатель сохранить вложение. Кроме того, Outlook 2010 позволяет пользователям изменять формы непосредственно в сообщении.
  
Шаблоны форм с уровнем доверия домен должен быть открыт из опубликованного расположения, однако, опубликовав их в список получателей электронной почты в окне Мастер публикации, они могут быть отправлены как вложение в сообщение электронной почты. При открытии вложения оно работает как ссылка на реальное место публикации шаблона. То, что действительно открывается в редакторе InfoPath,  это шаблон формы, находящийся в этом местоположении.
  
С помощью шаблона формы — на уровне домена, отправляемые в виде вложения электронной почты имеет следующий вид: с помощью любого типа документов; Например в Microsoft Excel или документ Microsoft Word. Пользователь может просто щелкнуть форму, после чего она откроется, и ее можно будет использовать. Кроме того, пользователям доступны все преимущества обновления на уровне домена.
  
По электронной почте шаблонов форм, запрашивающих доступ к полное доверие, но эти шаблоны должны быть подписаны или они не смогут открыть. Шаблоны форм, запрашивающих домен "или" ограниченный доступ нет подписи требуется отправлять в виде вложения. InfoPath не проверяет подпись, даже если шаблон подписан, за исключением проверки на возможность автоматического обновления. При добавлении цифровой подписи к шаблону формы с уровнем доверия "Домен" или "Ограниченный" функция автоматического обновления будет по-прежнему доступна. В этом случае цифровая подпись заблокирует вывод сообщений о конфликте в кэше.
  
## <a name="sharing-forms-by-email-message-or-from-a-common-shared-location"></a>Совместное использование форм, сообщение электронной почты или из общей папке

При создании формы, распространяемой по сообщение электронной почты следует учитывать следующие вопросы.
  
- **Будет ли форма обновляться регулярно?** При разработке формы, которая должна регулярно обновляться, ее следует опубликовать в общей папке, прежде чем отправлять другим пользователям. Это позволяет обновлять форму, публикуя новые версии в общей папке, а также сразу же распространять шаблон формы среди пользователей, не имеющих доступа к общей папке. 
    
   Если формы обновления и затем распространяются с сообщение электронной почты, пользователи получают сообщение о конфликте кэша при попытке открыть новую форму, если они используют более старую версию, хранящиеся на компьютере и доступ был изменен. Появится запрос, какую версию необходимо использовать. Даже если обновленная форма и форма на компьютере пользователя одинаковы, будет выведено сообщение о конфликте в кэше, а также запрос на выбор определенной копии для использования. В последнем случае лучше всего совместно использовать форму из общей папки.
    
- **Использует ли форма подключение к данным или другие функции, не поддерживаемые при уровне безопасности "Ограниченный"?** При разработке формы, которой нужен уровень безопасности "Домен", потребуется опубликовать форму в общей папке, чтобы пользователи смогли ее открыть. Так как шаблоны форм будут только с уровнем безопасности, которые они запроса, формах, открытых непосредственно из сообщения электронной почты не будет открываться, если InfoPath не может предоставить безопасности на уровне домена. 
    
## <a name="benefits-of-using-signed-form-templates"></a>Преимущества использования подписанных шаблонов форм

- Шаблон формы открывается с уровнем безопасности "Полное доверие".
    
- Не выводится сообщение о конфликте в кэше при перемещении формы в новое местоположение.
    
Кроме того, если шаблон формы подписан, доступна функция автоматического обновления. Дополнительные сведения см. в разделе [Развертывание шаблонов подписанной формы InfoPath](deploying-signed-infopath-form-templates.md).
  
### <a name="example-updating-domain-or-restricted-templates"></a>Пример: Обновление домена или ограниченных шаблонов

В следующем примере показано, как обновленный подписанный шаблон формы запрашивает домен "или" ограниченный доступ, перезаписывает более старую копию: 
  
1. "А" отправляет подписанный шаблон формы "Б".
    
2. "Б" открывает шаблон формы.
    
3. "А" обновляет шаблон формы (например, добавляет поля).
    
4. "А" отправляет обновленный шаблон формы "Б".
    
5. "Б" открывает обновленный шаблон формы.
    
### <a name="example-deploying-restricted-form-templates-on-an-extranet"></a>Пример: Развертывание ограниченного доступа шаблонов форм в экстрасети
  
1. Сохраните шаблон формы с уровнем "Домен" на работающем веб-сайте Microsoft SharePoint Foundation 2010.
    
2. Измените уровень безопасности шаблона формы на "Ограниченный".
    
3. Сохраните шаблон формы на рабочем столе компьютера.
    
4. Удалите URL-адрес (это необходимо сделать, только если пользователи имеют доступ к первоначальному месту публикации).
    
5. Отправьте форму пользователям по экстрасети.
    
6. Попросите пользователей установить форму.
    
7. Попросите пользователей заполнить форму и отправить ее вам обратно.
    
8. Сохраните форму на работающий веб-сайт SharePoint Foundation 2010 и выполните повторное связывание формы с помощью параметра **Повторно связать документы с этой библиотекой** на странице **Параметры библиотеки форм**. 
    
## <a name="signature-verification-failure"></a>Сбой проверки подписи

Подписанный шаблон форм, запрашивающий доступ с полным доверием, но для которого невозможно выполнить проверку подлинности подписи, не откроется. Сбой проверки подписи может возникнуть по одной из следующих причин:
  
- Корневой сертификат находится не в хранилище доверенных корневых сертификатов.
    
- Истек срок действия сертификата, который использовался для подписывания шаблона формы.
    
- Сертификат, который использовался для подписывания шаблона формы, был отозван.
    
- Подпись шаблона формы повреждена (это свидетельствует о том, что шаблон формы был изменен после подписывания).
    
Если подписанный шаблон формы запрашивает доступ с уровнем "Домен" или "Ограниченный", InfoPath не проверяет подпись, за исключением проверки на возможность автоматического обновления шаблона.
  
## <a name="infrastructure-registry-keys-for-form-migration-open-behavior"></a>Разделы реестра инфраструктуры для переноса формы поведения при открытии

Когда пользователь пытается открыть форму, а идентификаторы формы и шаблоном совпадают, выводится сообщение об ошибке, если шаблон формы имеет уровень доверия "Домен", а домен не совпадает с атрибутом  *href*  формы. Это не позволяет открывать формы, которые не были явным образом созданы с помощью шаблона формы. 
  
В InfoPath не допускается одновременное существование шаблонов форм с одинаковым идентификатором формы. С помощью четырех дополнительных разделов реестра администраторы могут разрешать или запрещать пользователями открывать XML-файл с использованием шаблона формы. Данная модель также позволяет администраторам определять желаемое поведение форм при их открытии.
  
В следующей таблице приведены параметры разделов реестра по умолчанию. Если разделы реестра отсутствуют, будут использоваться значения по умолчанию из таблицы.
  
Приведенные пары "имя-значение" соответствуют параметрам домена Internet Explorer. Эти значения задают поведение при открытии форм в указанных зонах безопасности: они либо полностью запрещают или разрешают открытие форм, либо предоставляют пользователям возможность сделать этот выбор самостоятельно.
  
|**Имя значения**|**Блок**|**Пользовательский интерфейс**|**Разрешить**|
|:-----|:-----|:-----|:-----|
|**Интернет** <br/> |X   <br/> |||
|**Интрасеть** <br/> ||X   <br/> ||
|**Клиентский компьютер** <br/> |||X   <br/> |
|**Список надежных сайтов** <br/> |||X   <br/> |
   
Путь к разделу реестра `HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\InfoPath\Open Behaviors`.

Поведение формы при ее открытии определяется следующим образом:
  
- `Block [REG_DWORD = 0]`- Выводится диалоговое окно об ошибке с кнопкой "Справка". Если форма запущена в указанной зоне безопасности и не соответствует домену шаблона, открытие XML-файла будет запрещено. 
    
- `User Interface [REG_DWORD = 1]`- Выводится диалоговое окно с кнопками "Да" и "Нет". Если форма запущена в указанной зоне безопасности и не соответствует домену шаблона, пользователю будет предложено открыть XML-файл с использованием шаблона формы. 
    
- `Allow [REG_DWORD = 2]`- XML-файл откроется, а сообщения об ошибках или предупреждения выводиться не будут. Если форма запущена в указанной зоне безопасности и не соответствует домену шаблона, открытие XML-файла будет разрешено. 
    
Если открыть форму с использованием шаблона, запущенного с уровнем безопасности "Домен", а домен безопасности местоположения "cached from" этого шаблона (то есть, местоположения, откуда выполняется кэширование формы) и атрибут формы **href** не совпадут, программа InfoPath обратится к реестру, чтобы задать поведение формы при ее открытии. Заданное поведение определяется в зависимости от зоны безопасности, в которой расположен шаблон (значение  *CachedFromLocation*  ). 
  
Например, когда у формы и у шаблона совпадает идентификатор формы, но не путь для доступа, а кэширование шаблона формы выполняется из местоположения в Интернете, программой InfoPath будет выведено диалоговое окно об ошибке с кнопкой "Справка".
  
> [!NOTE]
> [!Примечание] Если в качестве домена используется домен "Ограниченный" для Internet Explorer, формы InfoPath открываться не будут, поэтому раздел реестра для зоны ограниченных сайтов Internet Explorer отсутствует. 
  


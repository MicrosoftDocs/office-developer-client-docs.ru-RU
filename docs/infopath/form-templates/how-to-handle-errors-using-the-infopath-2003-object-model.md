---
title: Обработка ошибок с помощью объектной модели InfoPath 2003
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- шаблоны форм с поддержкой веб-2003 InfoPath, обработки ошибок, совместимых с InfoPath 2003 шаблонов форм, обработки ошибок, шаблонов форм [InfoPath 2007], обработки ошибок, ошибок [InfoPath 2007], шаблонов форм совместимых с InfoPath 2003
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: При создании настраиваемых приложений разработчики должны выполнять обработку ошибок, включающую написание программного кода на наличие ошибок, вызываемых приложения или для создания и обнаружения настраиваемых ошибок. Объектная модель совместимых с InfoPath 2003 поддерживает обработку ошибок с помощью объекта ErrorObject в сочетании с семейства ErrorsCollection.
ms.openlocfilehash: 577e531d8943dc8fc3884cd81f68b11ca285c5d3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807513"
---
# <a name="handle-errors-using-the-infopath-2003-object-model"></a><span data-ttu-id="3dee5-105">Обработка ошибок с помощью объектной модели InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="3dee5-105">Handle Errors Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="3dee5-106">При создании настраиваемых приложений разработчики должны выполнять обработку ошибок, включающую написание программного кода на наличие ошибок, вызываемых приложения или для создания и обнаружения настраиваемых ошибок.</span><span class="sxs-lookup"><span data-stu-id="3dee5-106">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors.</span></span> <span data-ttu-id="3dee5-107">Объектная модель совместимых с InfoPath 2003 поддерживает обработку ошибок с помощью объекта [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) в сочетании с семейства [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3dee5-107">The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
<span data-ttu-id="3dee5-108">В приложении InfoPath могут возникать ошибки, когда данные, введенные в форму не удается выполнить проверку на соответствие схеме XML, при сбое ограничение нестандартной проверки, когда ошибка создается с помощью метода [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) объекта [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) или при создании ошибки с помощью метода [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) семейства [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3dee5-108">In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
## <a name="overview-of-the-errorscollection-collection"></a><span data-ttu-id="3dee5-109">Обзор семейства ErrorsCollection</span><span class="sxs-lookup"><span data-stu-id="3dee5-109">Overview of the ErrorsCollection Collection</span></span>

<span data-ttu-id="3dee5-110">Семейство **ErrorsCollection** предоставляет следующие методы и свойства, которые могут использоваться разработчиками форм для управления объектами **ErrorObject** , содержащихся в коллекции.</span><span class="sxs-lookup"><span data-stu-id="3dee5-110">The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains.</span></span> 
  
|<span data-ttu-id="3dee5-111">**Имя**</span><span class="sxs-lookup"><span data-stu-id="3dee5-111">**Name**</span></span>|<span data-ttu-id="3dee5-112">**Описание**</span><span class="sxs-lookup"><span data-stu-id="3dee5-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3dee5-113">Метод [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method</span></span>  <br/> |<span data-ttu-id="3dee5-114">Создает объект **ErrorObject** и добавляет его в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="3dee5-114">Creates an **ErrorObject** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="3dee5-115">Метод [DELETE](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method</span></span>  <br/> |<span data-ttu-id="3dee5-116">Удаляет все объекты **ErrorObject** , связанные с указанным XML узлом и именем условия, за исключением пользовательских ошибок, добавленных с помощью метода **ReportError** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-116">Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.</span></span>  <br/> |
|<span data-ttu-id="3dee5-117">Метод [DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="3dee5-118">Удаляет все объекты **ErrorObject** , содержащихся в коллекции.</span><span class="sxs-lookup"><span data-stu-id="3dee5-118">Deletes all **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="3dee5-119">Свойство [Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-120">Возвращает количество объектов **ErrorObject** , содержащихся в коллекции.</span><span class="sxs-lookup"><span data-stu-id="3dee5-120">Gets a count of the number of **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="3dee5-121">Свойство [Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-122">Возвращает ссылку на объект **ErrorObject** , основываясь на указанном номере индекса.</span><span class="sxs-lookup"><span data-stu-id="3dee5-122">Gets a reference to an **ErrorObject** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-errorobject-object"></a><span data-ttu-id="3dee5-123">Обзор объекта ErrorObject</span><span class="sxs-lookup"><span data-stu-id="3dee5-123">Overview of the ErrorObject Object</span></span>

<span data-ttu-id="3dee5-124">Объект **ErrorObject** предоставляет следующие свойства, которые могут использоваться разработчиками форм для доступа к сведениям о возникшей ошибке.</span><span class="sxs-lookup"><span data-stu-id="3dee5-124">The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="3dee5-125">**Имя**</span><span class="sxs-lookup"><span data-stu-id="3dee5-125">**Name**</span></span>|<span data-ttu-id="3dee5-126">**Описание**</span><span class="sxs-lookup"><span data-stu-id="3dee5-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3dee5-127">Свойство [ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-128">Возвращает имя условия ошибки, или **значение null**, в зависимости от типа объекта **ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-128">Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="3dee5-129">Свойство [DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-130">Получает или задает подробное сообщение об ошибке для объекта **ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-130">Gets or sets the detailed error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="3dee5-131">Свойство [ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-132">Получает или задает код ошибки для объекта **ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-132">Gets or sets the error code of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="3dee5-133">Свойство [узла](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-134">Возвращает ссылку на узел XML, связанный с объектом **ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-134">Gets a reference to the XML node associated with the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="3dee5-135">Свойство [ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-136">Получает или задает краткое сообщение об ошибке для объекта **ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-136">Gets or sets the short error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="3dee5-137">Свойство [ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx)</span><span class="sxs-lookup"><span data-stu-id="3dee5-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="3dee5-138">Получает тип объекта **ErrorObject** .</span><span class="sxs-lookup"><span data-stu-id="3dee5-138">Gets the type of the **ErrorObject** object.</span></span>  <br/> |
   
## <a name="using-the-errorscollection-and-errorobject"></a><span data-ttu-id="3dee5-139">Использование ErrorsCollection и ErrorObject</span><span class="sxs-lookup"><span data-stu-id="3dee5-139">Using the ErrorsCollection and ErrorObject</span></span>

<span data-ttu-id="3dee5-140">Семейство **ErrorsCollection** доступен через свойство [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) объекта [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) .</span><span class="sxs-lookup"><span data-stu-id="3dee5-140">The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object.</span></span> <span data-ttu-id="3dee5-141">Семейство **ErrorsCollection** связан с XML-документом формы, что при возникновении ошибки, происходит в XML-документ.</span><span class="sxs-lookup"><span data-stu-id="3dee5-141">The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document.</span></span> <span data-ttu-id="3dee5-142">Следующий пример показывает, как цикла **foreach** Visual C# можно использовать для проверки ошибок, которые могут существовать в XML-документом формы.</span><span class="sxs-lookup"><span data-stu-id="3dee5-142">The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document.</span></span> <span data-ttu-id="3dee5-143">При наличии ошибок, функция обрабатывает каждую из них и, с помощью свойства **ShortErrorMessage** объекта **ErrorObject** отображает окно сообщения для пользователя.</span><span class="sxs-lookup"><span data-stu-id="3dee5-143">If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

<span data-ttu-id="3dee5-144">Предыдущая функцию можно вызвать из одного из обработчиков событий проверки данных формы.</span><span class="sxs-lookup"><span data-stu-id="3dee5-144">The preceding function could be called from one of the form's data validation event handlers.</span></span> <span data-ttu-id="3dee5-145">Например при использовании в обработчике события [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) для поля в форме, вызов функции проходит аргумент узла XML, с помощью свойства [сайта](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) объекта [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) следующим образом.</span><span class="sxs-lookup"><span data-stu-id="3dee5-145">For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

<span data-ttu-id="3dee5-146">В дополнение к обработке ошибок, сгенерированными InfoPath, разработчики форм также можно создать пользовательских ошибок с помощью метода **ReportError** объекта **DataDOMEventObject** или с помощью метода **Add** **ErrorsCollection** семейства сайтов.</span><span class="sxs-lookup"><span data-stu-id="3dee5-146">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection.</span></span> <span data-ttu-id="3dee5-147">Для получения сведений об использовании методов **ReportError** или **Добавить** щелкните соответствующий метод в начале этого раздела.</span><span class="sxs-lookup"><span data-stu-id="3dee5-147">For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="3dee5-148">Обработка исключений управляемого кода</span><span class="sxs-lookup"><span data-stu-id="3dee5-148">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="3dee5-149">Для обработки исключений, возникающих в шаблоне формы с управляемым кодом, можно воспользоваться методом "try-catch", как показано в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="3dee5-149">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

<span data-ttu-id="3dee5-150">Если в коде формы не используется обработка исключений "try-catch", то при отладке и просмотре приложение InfoPath будет отображать сведения о необработанных исключениях в диалоговом окне ошибок InfoPath. </span><span class="sxs-lookup"><span data-stu-id="3dee5-150">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing.</span></span> 
  


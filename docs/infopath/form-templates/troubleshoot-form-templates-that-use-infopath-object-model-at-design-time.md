---
title: Шаблоны форм устранения неполадок, которые используют объектную модель InfoPath во время разработки
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, troubleshooting at design time, troubleshooting form templates [InfoPath 2007], design time
localization_priority: Normal
ms.assetid: 4179b235-e21d-4c37-ae2b-ad01388296ec
description: В следующих разделах описываются распространенные сценарии устранения неполадок, которые могут встретиться при разработке и отладке шаблонов форм с управляемым кодом, использующих объектную модель, совместимую с InfoPath 2003, которая предоставляется пространством имен Microsoft.Office.Interop.InfoPath.SemiTrust.
ms.openlocfilehash: 106f12602bae86d85c2a7d2f920f59d50326c908
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436526"
---
# <a name="troubleshoot-form-templates-that-use-the-infopath-object-model-at-design-time"></a><span data-ttu-id="ee654-104">Шаблоны форм устранения неполадок, которые используют объектную модель InfoPath во время разработки</span><span class="sxs-lookup"><span data-stu-id="ee654-104">Troubleshoot form templates that use the InfoPath object model at design time</span></span>

<span data-ttu-id="ee654-105">В следующих разделах описываются распространенные сценарии устранения неполадок, которые могут встретиться при разработке и отладке шаблонов форм с управляемым кодом, использующих объектную модель, совместимую с InfoPath 2003, которая предоставляется пространством имен **Microsoft.Office.Interop.InfoPath.SemiTrust**.</span><span class="sxs-lookup"><span data-stu-id="ee654-105">The following sections describe common troubleshooting scenarios you may encounter while designing and debugging managed code form templates that use the InfoPath 2003-compatible object model provided by the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace.</span></span> 
  
## <a name="cannot-preview-or-debug-form-templates-that-use-calls-to-object-model-security-level-3-methods-and-properties"></a><span data-ttu-id="ee654-106">Не удается просмотреть или отладить шаблоны форм, использующие вызовы методов и свойств объектной модели с уровнем безопасности 3</span><span class="sxs-lookup"><span data-stu-id="ee654-106">Cannot Preview or Debug Form Templates That Use Calls to Object Model Security Level 3 Methods and Properties</span></span>

<span data-ttu-id="ee654-107">При попытке отладить или просмотреть проект с управляемым кодом, вызывающим элементы объектной модели, для которых требуется полное доверие, приложение InfoPath отобразит сообщение об ошибке "В форме кода произошло необработанное исключение безопасности" и форма не откроется.</span><span class="sxs-lookup"><span data-stu-id="ee654-107">If you attempt to debug or preview a managed-code project that contains code that invokes object model members that require full trust, InfoPath will display the error message "An unhandled security exception has occurred in the form's code" and the form will not open.</span></span> <span data-ttu-id="ee654-108">Чтобы разрешить отладку и просмотр бизнес-логики шаблона формы, необходимо установить уровень безопасности **Полное доверите** и указать для шаблона формы цифровую подпись.</span><span class="sxs-lookup"><span data-stu-id="ee654-108">To allow business logic in the form template to be debugged or previewed, you must set the security level to **Full Trust** and digitally sign the form template.</span></span> <span data-ttu-id="ee654-109">Дополнительные сведения о том, как это сделать, см. в материале [Preview and Debug Form Templates, которые требуют полного доверия.](how-to-preview-and-debug-form-templates-that-require-full-trust.md)</span><span class="sxs-lookup"><span data-stu-id="ee654-109">For details on how to do this, see [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>
  
## <a name="cannot-update-xpath-expressions-in-event-handlers-if-the-matchpath-parameter-value-was-deleted-manually"></a><span data-ttu-id="ee654-110">Не удается обновить выражения XPath в обработчиках событий, если значение параметра "MatchPath" было удалено вручную</span><span class="sxs-lookup"><span data-stu-id="ee654-110">Cannot Update XPath Expressions in Event Handlers If the MatchPath Parameter Value Was Deleted Manually</span></span>

<span data-ttu-id="ee654-111">Если добавить обработник событий в поле или группу, а затем изменить схему источника данных в области задач InfoPath **Fields** таким образом, чтобы она влияет на это поле или группу (например, путем переименования или перемещения), будет отображаться сообщение с просьбой обновить выражения XPath в коде формы.</span><span class="sxs-lookup"><span data-stu-id="ee654-111">If you add an event handler to a field or group and later change the schema of the data source in the InfoPath **Fields** task pane in a way that affects that field or group (for example, by renaming or moving it), a message will be displayed asking if you want to update the XPath expressions in your form's code.</span></span> <span data-ttu-id="ee654-112">Выражения XPath, указанные в этом сообщении, — это значения, указанные в параметре [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) атрибута [InfoPathEventHandlerAttribute,](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) которые используются для связи обработика событий с полем или группой в источнике данных вашей формы.</span><span class="sxs-lookup"><span data-stu-id="ee654-112">The XPath expressions referred to in this message are the values specified in the [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) parameter of the [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) attribute, which are used to associate the event handler with a field or group in your form's data source.</span></span> <span data-ttu-id="ee654-113">Никакие другие выражения XPath в коде не обновляются.</span><span class="sxs-lookup"><span data-stu-id="ee654-113">No other XPath expressions in your code will be updated.</span></span> <span data-ttu-id="ee654-114">Алгоритм обновления выражений XPath зависит от значения, которое присутствует в параметре **MatchPath** атрибутов **InfoPathEventHandler,** которые применяются в коде формы.</span><span class="sxs-lookup"><span data-stu-id="ee654-114">The algorithm for updating the XPath expressions depends on a value being present in the **MatchPath** parameter of the **InfoPathEventHandler** attributes that are applied in your form code.</span></span> <span data-ttu-id="ee654-115">Если вы вручную удалили эти значения перед ответом на запрос об обновлении выражений XPath, InfoPath не сможет автоматически обновлять выражения XPath.</span><span class="sxs-lookup"><span data-stu-id="ee654-115">If you manually deleted these values before responding to the prompt to update XPath expressions, InfoPath will not be able to update the XPath expressions automatically.</span></span> <span data-ttu-id="ee654-116">Дополнительные сведения см. в рубрике Добавление обработера событий [с помощью объектной модели InfoPath 2003.](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md)</span><span class="sxs-lookup"><span data-stu-id="ee654-116">For more information, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="cannot-call-members-of-the-infopath-2003-compatible-object-model-on-a-separate-thread"></a><span data-ttu-id="ee654-117">Не удается вызвать элементы объектной модели, совместимой с InfoPath 2003, в отдельном потоке</span><span class="sxs-lookup"><span data-stu-id="ee654-117">Cannot Call Members of the InfoPath 2003 Compatible Object Model on a Separate Thread</span></span>

<span data-ttu-id="ee654-p103">Объектная модель, совместимая с InfoPath 2003, не поддерживает вызовы в отдельном потоке. Например, следующий код, вызывающий функцию LaunchOMFunction, которая вызывает элементы объектной модели InfoPath, не запустится.</span><span class="sxs-lookup"><span data-stu-id="ee654-p103">The InfoPath 2003-compatible object model does not support calls on a separate thread. For example, the following code, which calls a function named LaunchOMFunction that calls members of the InfoPath object model, will not run.</span></span> 
  
```cs
Thread th = new Thread(new ThreadStart(LaunchOMFunction));
th.Start();
```

<span data-ttu-id="ee654-120">При необходимости существует возможность обойти это ограничение.</span><span class="sxs-lookup"><span data-stu-id="ee654-120">When necessary, there is a way to work around this limitation.</span></span> <span data-ttu-id="ee654-121">Сведения см. в [примере Поддержка потоков в проектах InfoPath с использованием объектной модели InfoPath 2003.](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md)</span><span class="sxs-lookup"><span data-stu-id="ee654-121">For information, see [Threading Support in InfoPath Projects Using the InfoPath 2003 Object Model](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="omitting-optional-parameters-causes-a-build-error-in-visual-basic-and-visual-c"></a><span data-ttu-id="ee654-122">Пропуск необязательных параметров приводит к ошибке построения в Visual Basic и Visual C#</span><span class="sxs-lookup"><span data-stu-id="ee654-122">Omitting Optional Parameters Causes a Build Error in Visual Basic and Visual C#</span></span>

<span data-ttu-id="ee654-123">Если элемент объектной модели InfoPath содержит необязательный параметр и значение этого параметра не указано, то необходимо передать для этого параметра поле **Type.Missing**.</span><span class="sxs-lookup"><span data-stu-id="ee654-123">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead.</span></span> <span data-ttu-id="ee654-124">Если не произвести передачу поля **Type.Missing**, когда его фактическое значение опущено, это может привести к ошибке построения.</span><span class="sxs-lookup"><span data-stu-id="ee654-124">Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error.</span></span> <span data-ttu-id="ee654-125">Это применимо к коду, написанному как на Visual Basic, так и на Visual C#.</span><span class="sxs-lookup"><span data-stu-id="ee654-125">This is true for code written in both Visual Basic and Visual C#.</span></span> <span data-ttu-id="ee654-126">Дополнительные сведения и примеры см. в разделе "Передача необязательных параметров участникам объектной модели InfoPath" в разделе [InfoPath 2003 Compatible Object Models.](infopath-2003-compatible-object-models.md)</span><span class="sxs-lookup"><span data-stu-id="ee654-126">For more information and examples see the "Passing Optional Parameters to InfoPath Object Model Members" section in the [InfoPath 2003 Compatible Object Models](infopath-2003-compatible-object-models.md) topic.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="ee654-127">См. также</span><span class="sxs-lookup"><span data-stu-id="ee654-127">See also</span></span>

- [<span data-ttu-id="ee654-128">О модели безопасности шаблонов форм с кодом</span><span class="sxs-lookup"><span data-stu-id="ee654-128">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="ee654-129">Развертывание шаблонов форм InfoPath с помощью кода</span><span class="sxs-lookup"><span data-stu-id="ee654-129">Deploy InfoPath Form Templates with Code</span></span>](how-to-deploy-infopath-form-templates-with-code.md)
- [<span data-ttu-id="ee654-130">Обработка ошибок с помощью объектной модели InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="ee654-130">Handle Errors Using the InfoPath 2003 Object Model</span></span>](how-to-handle-errors-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="ee654-131">Шаблоны предварительного просмотра и отлаговки форм, которые требуют полного доверия</span><span class="sxs-lookup"><span data-stu-id="ee654-131">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)
- [<span data-ttu-id="ee654-132">Отлаживать проекты InfoPath с помощью объектной модели InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="ee654-132">Debug InfoPath Projects Using the InfoPath 2003 Object Model</span></span>](how-to-debug-infopath-projects-using-the-infopath-2003-object-model.md)


---
title: Устранение неполадок шаблонов форм, использующих объектную модель InfoPath во время разработки
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
keywords:
- infopath 2003-compatible form templates, troubleshooting at design time,troubleshooting form templates [InfoPath 2007], design time
localization_priority: Normal
ms.assetid: 4179b235-e21d-4c37-ae2b-ad01388296ec
description: В следующих разделах описываются распространенные сценарии устранения неполадок, которые могут встретиться при разработке и отладке шаблонов форм с управляемым кодом, использующих объектную модель, совместимую с InfoPath 2003, которая предоставляется пространством имен Microsoft.Office.Interop.InfoPath.SemiTrust.
ms.openlocfilehash: af71c8058744561a4c8ee0870fb37054e9979751
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807593"
---
# <a name="troubleshoot-form-templates-that-use-the-infopath-object-model-at-design-time"></a><span data-ttu-id="9093f-104">Устранение неполадок шаблонов форм, использующих объектную модель InfoPath во время разработки</span><span class="sxs-lookup"><span data-stu-id="9093f-104">Troubleshoot form templates that use the InfoPath object model at design time</span></span>

<span data-ttu-id="9093f-105">В следующих разделах описываются распространенные сценарии устранения неполадок, которые могут встретиться при разработке и отладке шаблонов форм с управляемым кодом, использующих объектную модель, совместимую с InfoPath 2003, которая предоставляется пространством имен **Microsoft.Office.Interop.InfoPath.SemiTrust**.</span><span class="sxs-lookup"><span data-stu-id="9093f-105">The following sections describe common troubleshooting scenarios you may encounter while designing and debugging managed code form templates that use the InfoPath 2003-compatible object model provided by the **Microsoft.Office.Interop.InfoPath.SemiTrust** namespace.</span></span> 
  
## <a name="cannot-preview-or-debug-form-templates-that-use-calls-to-object-model-security-level-3-methods-and-properties"></a><span data-ttu-id="9093f-106">Не удается просмотреть или отладить шаблоны форм, использующие вызовы методов и свойств объектной модели с уровнем безопасности 3</span><span class="sxs-lookup"><span data-stu-id="9093f-106">Cannot Preview or Debug Form Templates That Use Calls to Object Model Security Level 3 Methods and Properties</span></span>

<span data-ttu-id="9093f-107">При попытке отладки или предварительного просмотра проекта управляемого кода, который содержит код, который вызывает элементы объектной модели, требующих полного доверия, InfoPath будет отображаться сообщение об ошибке «в коде формы произошло исключение необработанное безопасности» и форма не будет открываться .</span><span class="sxs-lookup"><span data-stu-id="9093f-107">If you attempt to debug or preview a managed-code project that contains code that invokes object model members that require full trust, InfoPath will display the error message "An unhandled security exception has occurred in the form's code" and the form will not open.</span></span> <span data-ttu-id="9093f-108">Чтобы разрешить бизнес-логика в шаблоне формы для отладки или предварительного просмотра, необходимо установить уровень безопасности **Полное доверие** и использовать цифровую подпись шаблона формы.</span><span class="sxs-lookup"><span data-stu-id="9093f-108">To allow business logic in the form template to be debugged or previewed, you must set the security level to **Full Trust** and digitally sign the form template.</span></span> <span data-ttu-id="9093f-109">Для получения дополнительных сведений о том, как это сделать см [Просмотр и отладка шаблонов форм, требуется полное доверие](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span><span class="sxs-lookup"><span data-stu-id="9093f-109">For details on how to do this, see [Preview and Debug Form Templates that Require Full Trust](how-to-preview-and-debug-form-templates-that-require-full-trust.md).</span></span>
  
## <a name="cannot-update-xpath-expressions-in-event-handlers-if-the-matchpath-parameter-value-was-deleted-manually"></a><span data-ttu-id="9093f-110">Не удается обновить выражения XPath в обработчиках событий, если значение параметра "MatchPath" было удалено вручную</span><span class="sxs-lookup"><span data-stu-id="9093f-110">Cannot Update XPath Expressions in Event Handlers If the MatchPath Parameter Value Was Deleted Manually</span></span>

<span data-ttu-id="9093f-111">Если добавить обработчик событий для поля или группы и впоследствии изменить схемы источника данных в области задач InfoPath **полей** , чтобы влияет на этого поля или группы (например, по переименованию или перемещению его), сообщение будет отображаться вопросом, следует ли обновлено e XPath выражений в коде формы.</span><span class="sxs-lookup"><span data-stu-id="9093f-111">If you add an event handler to a field or group and later change the schema of the data source in the InfoPath **Fields** task pane in a way that affects that field or group (for example, by renaming or moving it), a message will be displayed asking if you want to update the XPath expressions in your form's code.</span></span> <span data-ttu-id="9093f-112">Выражения XPath, приведенные в этом сообщении являются значения, заданные с помощью параметра ["matchpath"](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) атрибута [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) , используемые для связи обработчика событий с помощью поля или группы в источник данных для формы .</span><span class="sxs-lookup"><span data-stu-id="9093f-112">The XPath expressions referred to in this message are the values specified in the [MatchPath](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.MatchPath.aspx) parameter of the [InfoPathEventHandlerAttribute](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.InfoPathEventHandlerAttribute.aspx) attribute, which are used to associate the event handler with a field or group in your form's data source.</span></span> <span data-ttu-id="9093f-113">Другие выражения XPath в коде не будут обновлены.</span><span class="sxs-lookup"><span data-stu-id="9093f-113">No other XPath expressions in your code will be updated.</span></span> <span data-ttu-id="9093f-114">Алгоритм для обновления выражения XPath зависит от значения, этот параметр указан с помощью параметра **"matchpath"** **InfoPathEventHandler** атрибутов, которые применяются в коде формы.</span><span class="sxs-lookup"><span data-stu-id="9093f-114">The algorithm for updating the XPath expressions depends on a value being present in the **MatchPath** parameter of the **InfoPathEventHandler** attributes that are applied in your form code.</span></span> <span data-ttu-id="9093f-115">Если эти значения удалены вручную перед ответом на запрос на обновление выражения XPath, InfoPath не сможет автоматически обновить выражения XPath.</span><span class="sxs-lookup"><span data-stu-id="9093f-115">If you manually deleted these values before responding to the prompt to update XPath expressions, InfoPath will not be able to update the XPath expressions automatically.</span></span> <span data-ttu-id="9093f-116">Дополнительные сведения можно [Добавить события обработчик с помощью объектной модели InfoPath 2003](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="9093f-116">For more information, see [Add an Event Handler Using the InfoPath 2003 Object Model](how-to-add-an-event-handler-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="cannot-call-members-of-the-infopath-2003-compatible-object-model-on-a-separate-thread"></a><span data-ttu-id="9093f-117">Не удается вызвать элементы объектной модели, совместимой с InfoPath 2003, в отдельном потоке</span><span class="sxs-lookup"><span data-stu-id="9093f-117">Cannot Call Members of the InfoPath 2003 Compatible Object Model on a Separate Thread</span></span>

<span data-ttu-id="9093f-p103">Объектная модель, совместимая с InfoPath 2003, не поддерживает вызовы в отдельном потоке. Например, следующий код, вызывающий функцию LaunchOMFunction, которая вызывает элементы объектной модели InfoPath, не запустится.</span><span class="sxs-lookup"><span data-stu-id="9093f-p103">The InfoPath 2003-compatible object model does not support calls on a separate thread. For example, the following code, which calls a function named LaunchOMFunction that calls members of the InfoPath object model, will not run.</span></span> 
  
```cs
Thread th = new Thread(new ThreadStart(LaunchOMFunction));
th.Start();
```

<span data-ttu-id="9093f-p104">При необходимости существует возможность обойти это ограничение. Дополнительные сведения см. в статье [Поддержка потоков в проектах InfoPath, использующих объектную модель InfoPath 2003](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="9093f-p104">When necessary, there is a way to work around this limitation. For information, see [Threading Support in InfoPath Projects Using the InfoPath 2003 Object Model](threading-support-in-infopath-projects-using-the-infopath-2003-object-model.md).</span></span>
  
## <a name="omitting-optional-parameters-causes-a-build-error-in-visual-basic-and-visual-c"></a><span data-ttu-id="9093f-122">Пропуск необязательных параметров приводит к ошибке построения в Visual Basic и Visual C#</span><span class="sxs-lookup"><span data-stu-id="9093f-122">Omitting Optional Parameters Causes a Build Error in Visual Basic and Visual C#</span></span>

<span data-ttu-id="9093f-p105">Если элемент объектной модели InfoPath содержит необязательный параметр и значение этого параметра не указано, то необходимо передать для этого параметра поле **Type.Missing**. Если не передать поле **Type.Missing** при пропуске фактического значения, произойдет ошибка построения. Это применимо к коду, написанному как на Visual Basic, так и на Visual C#. Дополнительные сведения и примеры см. в подразделе "Передача необязательных параметров для элементов объектной модели InfoPath" раздела [Объектные модели, совместимые с InfoPath 2003](infopath-2003-compatible-object-models.md).</span><span class="sxs-lookup"><span data-stu-id="9093f-p105">If an InfoPath object model member contains an optional parameter, and you do not specify a value for that parameter, you must pass the **Type.Missing** field for that parameter instead. Failure to pass the **Type.Missing** field when an actual value is omitted will result in a build error. This is true for code written in both Visual Basic and Visual C#. For more information and examples see the "Passing Optional Parameters to InfoPath Object Model Members" section in the [InfoPath 2003 Compatible Object Models](infopath-2003-compatible-object-models.md) topic.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="9093f-127">См. также</span><span class="sxs-lookup"><span data-stu-id="9093f-127">See also</span></span>

- [<span data-ttu-id="9093f-128">Модель безопасности для шаблонов форм с кодом</span><span class="sxs-lookup"><span data-stu-id="9093f-128">About the Security Model for Form Templates with Code</span></span>](about-the-security-model-for-form-templates-with-code.md)
- [<span data-ttu-id="9093f-129">Развертывание шаблонов форм InfoPath с кодом</span><span class="sxs-lookup"><span data-stu-id="9093f-129">Deploy InfoPath Form Templates with Code</span></span>](how-to-deploy-infopath-form-templates-with-code.md)
- [<span data-ttu-id="9093f-130">Обработка ошибок с помощью объектной модели InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9093f-130">Handle Errors Using the InfoPath 2003 Object Model</span></span>](how-to-handle-errors-using-the-infopath-2003-object-model.md)
- [<span data-ttu-id="9093f-131">Просмотр и отладка шаблонов форм, требующих полного доверия</span><span class="sxs-lookup"><span data-stu-id="9093f-131">Preview and Debug Form Templates that Require Full Trust</span></span>](how-to-preview-and-debug-form-templates-that-require-full-trust.md)
- [<span data-ttu-id="9093f-132">Отладка проектов InfoPath с помощью объектной модели InfoPath 2003</span><span class="sxs-lookup"><span data-stu-id="9093f-132">Debug InfoPath Projects Using the InfoPath 2003 Object Model</span></span>](how-to-debug-infopath-projects-using-the-infopath-2003-object-model.md)


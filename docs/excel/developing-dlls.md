---
title: ���������� ��������� DLL
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- dlls [excel 2007], creating,creating DLLs [Excel 2007]
localization_priority: Normal
ms.assetid: 5d69d06d-a126-4c47-82ad-17112674c8a3
description: '������� ����������: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: 030cdd4358d9a71841eca6acfcef6e71839e02a0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807169"
---
# <a name="developing-dlls"></a>���������� ��������� DLL

**Применимо к**: Excel 2013 | Office 2013 | Visual Studio 
  
���������� � ��� ���������������� ���, ������� ������������ ������� ������������ ���������� � ������������� ��� ������. ���������� ����� ���� ������� ���������� � �����������, ������ � ��� ���������� LIB � DLL ��������������. ����������� ���������� (��������, ���������� ������� ���������� C) ����������� � ����������� �� ����� ���������� � ���������� ������ ����������� ������������ �����. ���������� ��������� ���������� DLL, ����� ��� ���������� (������ ��� �������). ���� ���������� DLL ����� ��������� ������ ���������� DLL � ����������� ��������� �� ���.
  
## <a name="benefits-of-using-dlls"></a>Преимущества использования библиотек DLL

���� ��������� �������� ������������ ��������� DLL.
  
- ��� ���������� ����� ������������ ���� ����� �� �����.
    
- ����������� ����� ���������� �������� �������.
    
- ����������� ��������� ������� �������. ������������ ���������� � ��������� DLL ������ ������ ����������� ��������� ��������������� ������. ���� ��������� �������������� � ���������� DLL.
    
- ������������ DLL ����� ��������� ���������� DLL, ����� �������� �� ������������� ��� ��������� ������, �� �������� ��� ������������ �� ����������, ���� ���������������� ��������� ���������� DLL �� ����������.
    
� ������� DLL ����� ��������� ������� � ������� � Microsoft Excel.
  
## <a name="resources-for-creating-dlls"></a>Ресурсы для создания библиотеки DLL

��� ��� �����, ����� ������� ���������� DLL:
  
- �������� ��������� ����.
    
- ���������� ��� �������������� ��������� ���� � ���������, ����������� � �������������.
    
- ����������� ��� ���������� ���� �� ����������� ��������� � �������� ������������ DLL-�����.
    
� ����������� ��������������� ������ ���������� (IDE), �������� Microsoft Visual Studio, ���� ��� ��� ����������, � ����� �����-���������, ����������� ��� ������� ���� � ���������� ����������� ���������, ������� �������� �������� � ������ ������ �����������.
  
�� ������ ��������� ���������� DLL �� ���������� ������, �������� C/C++, Pascal � Visual Basic. ��� ��� �������� ��� API Excel � C � C++, � ���� ������������ ��������������� ������ ��� ��� �����.
  
## <a name="exporting-functions-and-commands"></a>Экспорт команды и функции

��� ���������� ������� DLL ���������� � ����������� ������ �����, ����� ������� ��������������, ����� ������������ � ��� ������ � ����������. � ���� ������� ������� ��������� �������.
  
��� ���������� ��������� ���� ����������� ������ �������� ����� �������. ��� ����� ��� ������ ��������� ������� � ������ ��� ����� �����. ���� ������� ���������� ������������� �����. ���������� ���������, ��� ����������, ����������� ���������� DLL, ����� ���������� ��� �������������� �������. ��� ����� ����� ������������� ���� �������� ������������ ����������� ����������� ��� � ����� ������� ������ ��������. ��� ����� ���� ��� �� ��������� ���� ��� ������.
  
������ ������������� ����� ������� �� ����� � ������� ������ �������, ����������� ������������, �. �. ���������� � �������. ����������� ������������� ���������� � ������� ��� Windows, ������������ � ����������� DLL, � ��� WinAPI. � ������ ���������� Windows ��� ���������� ��� **WINAPI** � ������� ����������� Win32 **__stdcall**.
  
�������, �������������� � DLL-���� ��� Excel (������� �����, �������, ������������� ����� ��������, ��� ���������������� �������) ������ ������ ������������ ���������� � ������� **WINAPI** / **__stdcall**. � ����������� ������� ���������� ���� �������� ��������� **WINAPI**, ��� ��� �� ��������� � ������������ Win32 ������������ ���������� � ������� **__cdecl**, ����� ������������ ��� **WINAPIV**.
  
�� ������ �������� ������������ � ������������� �������� �������, � ����� �� ������� ��� ����������� ���������:
  
- ��������� ������� � DEF-���� ����� ��������� ����� **EXPORTS** � �������� ������ �� ���� ���� � �������� ������� DLL �� ����� ����������. 
    
- ����������� ���������� **__declspec(dllexport)** � ����������� �������. 
    
- ����������� ��������� ������������� **#pragma** ��� �������� ��������� ������������. 
    
� ������� ����� ������������ ��� ��� �������, ��� �������������� � ������������, � �������������, �� �� ������� �������������� ���� ������� ����� ��� ����� ��������. Например, предположим, что библиотеки DLL содержит два исходного кода модулей, один C и C++ один, содержащие две функции для экспорта, **Мои\_C\_Экспорт** и **Мои\_Cpp\_Экспорт** соответственно. ��� �������� �����������, ��� ������� ��������� ���� �������� �������� ������� �������� � ���������� ������ ���� �� ����. Альтернативы для экспорта каждой функции с помощью каждого из этих методов описанные в следующих разделах. 
  
### <a name="using-a-def-file"></a>С помощью DEF-файла

```C
double WINAPI my_C_export(double x)
{
/* Modify x and return it. */
    return x * 2.0;
}
```

```cpp
double WINAPI my_Cpp_export(double x)
{
// Modify x and return it.
    return x * 2.0;
}
```

<br/>

DEF-���� ������ ��������� ��������� ������.
  
`EXPORTS my_C_export = _my_C_export@8  my_Cpp_export`

<br/>

���� �������� ����� ��������� ������, ��������� �� ���������� **EXPORTS**. 
  
`entryname[=internalname] [@ordinal[NONAME]] [DATA] [PRIVATE]`

�������� ��������, ��� ������� C ������������, �� � DEF-����� ������������ ���� ���� �������� ������������� ��� �������, ��������� ��� �� ��������� ���� (� ������ �������). ����������� ������ ������������ ������� C++, ��������� ��� ��������� ����, ��� ��� � DEF-���� ������������� �������� ����������� ���.
  
���������� ��� ������� ������� API 32-��������� Windows ��������������� ��������� ������������� ������� C: **function_name** ���������� _ **function_name@** _n_, ���  _n_ � ���������� ������, ���������� � ���� ����������� �����, ������������ ����� �����������, ��� ���� ���������� ������ ��� ������� ����������� �� ���������� �����, �������� �������. 
  
> [!NOTE]
> [!����������] ������ ���� ���������� � Win32 � ������ �����. ��� ������������� �������� �� ������ �� ������������� �����. 
  
����� ���������� C++ ������������ �������, ��������� ������������� �����, ��������� ������� � �� ��������� �� ������� ���� "C" {�}, ��� �������� � ����������� ���� �������. (�������� ������ **{}** ����� �������, ��� ��� ���������� ��������� ������ � ����� ���� �������, �������������� ��������������� �� ���.) 
  
```cpp
extern "C"
double WINAPI my_undecorated_Cpp_export(double x)
{
// Modify x and return it.
    return x * 2.0;
}

```

��� ���������� ���������� ������� C � ������ ����������, ������� ����� ���� �������� � �������� ����� C ��� C++, ���������� �������� ��������� ��������� �������������.
  
```cpp
#ifdef __cplusplus
extern "C" {
#endif
double WINAPI my_C_export(double x);
double WINAPI my_Cdecorated_Cpp_export(double x);
#ifdef __cplusplus
}
#endif
```

### <a name="using-the-declspecdllexport-declarator"></a>С помощью оператора объявления __declspec(dllexport)

�������� ����� **__declspec(dllexport)** ����� ������������ � ���������� ������� ��������� �������. 
  
```cpp
__declspec(dllexport) double WINAPI my_C_export(double x)
{
/* Modify x and return it. */
    return x * 2.0;
}
```

�������� ����� **__declspec(dllexport)** ���������� �������� � ������� ����� ����� ����������. ������������ ����� �������: ������� �� ����� ��������� � DEF-�����, � ��������� �������� ����������� ������ � ������������. 
  
���� �� �� ������ ������������ ��� ������� C++, ���������� �������� ������� ��������� �������.
  
```cpp
extern "C"
__declspec(dllexport) double WINAPI my_undecorated_Cpp_export(double x)
{
// Modify x and return it.
    return x * 2.0;
}
```

����������� ������� ������� ��������� ��� ������ my_undecorated_Cpp_export, �� ���� ������ �� ��������� ����, ��� �������������.
  
### <a name="using-a-pragma-preprocessor-linker-directive"></a>С помощью директивы препроцессору компоновщика #pragma

��������� ������ Microsoft Visual Studio ������������ ��� ���������������� �������, ������� ��� ������������� � ���������� **#pragma** ��������� ������ �������� ������������ �������������� ������� ��������������� � ���� �������. ������� __FUNCTION__ � __FUNCDNAME__ (�������� �������� �� ��� ������� ������������� � ������ �������) ������������ � ����������������� � ��������������� ������� ������� ��������������. 
  
��������, ��� ������������� Microsoft Visual Studio ��� ������ ����� �������� � ����� ���� ���������, ��� �������� ����.
  
```cpp
#if _MSC_VER > 1200 // Later than Visual Studio 6.0
#define EXPORT comment(linker, "/EXPORT:"__FUNCTION__"="__FUNCDNAME__)
#else // Cannot use this way of exporting functions.
#define EXPORT
#endif // else need to use DEF file or __declspec(dllexport)

```

���� ����� ��������� ������� � �������� �����, ��� �������, ����������� � �������� �������, ����� �������������� ��������� �������.
  
��� C:
  
```C
double WINAPI my_C_export(double x)
{
#pragma EXPORT
/* Modify x and return it. */
    return x * 2.0;
}
```

��� C++:
  
```cpp
double WINAPI my_Cpp_export(double x)
{
#pragma EXPORT
// Modify x and return it.
    return x * 2.0;
}
```

�������� ��������, ��� ��������� ���������� ��������� � ��� �������. �� ����� ����������, ������ ���� ��������� **/EP** � **/P** ����������� �� ������. ��� ������������� ����� ������� �������� ������������� � DEF-����� � ���������� **__declspec(dllexport)**, � ������������ ��������� �������� ����������� � ���� �������. 
  
## <a name="see-also"></a>��. �����

- [Доступа к библиотекам DLL в Excel](how-to-access-dlls-in-excel.md)
- [����� � Excel �� DLL ��� XLL](calling-into-excel-from-the-dll-or-xll.md)
- [�������� ���������������� � Excel](excel-programming-concepts.md)
- [���������� XLL-������� ��� Excel 2013](developing-excel-xlls.md)


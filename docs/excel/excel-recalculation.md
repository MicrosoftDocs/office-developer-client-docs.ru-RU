---
title: �������� � Excel
manager: kelbow
ms.date: 03/09/2018
ms.audience: Developer
ms.topic: overview
keywords:
- forced calculation [excel 2007],selective recalculation [Excel 2007],functions [Excel 2007], volatile,calculation modes,recalculated cells [Excel 2007],dependence [Excel 2007],specified worksheet calculation [Excel 2007],recalculation [Excel 2007],workbook tree rebuild [Excel 2007],range calculation [Excel 2007],Excel recalculation,volatile functions [Excel 2007],functions [Excel 2007], non-volatile,active worksheet calculation [Excel 2007],dirty cells [Excel 2007],non-volatile functions [Excel 2007],forced recalculation [Excel 2007]
localization_priority: Normal
ms.assetid: b4c38442-42e6-4fd2-a1b0-97cfa3300379
description: '������� ����������: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: 9964f2c4282158e83891d82ba43fa19f23ab1eb6
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807221"
---
# <a name="excel-recalculation"></a>�������� � Excel

 **Применимо к**: Excel 2013 | Office 2013 | Visual Studio 
  
������������ ����� �������� �������� � Microsoft Excel ����������� ���������, ��������:
  
- ����� ����� ����� ������ (���� Excel ��������� � ������ ��������������� ���������, ��������� ����� � ���� ������);
    
- ����� ��������� Excel ����������� ��� ����� ��� �� �����;
    
- ����� �������� ��� ������� ������ ��� �������;
    
- ����� ���������� ����� ��� ���������� ��������� **�������� ����� �����������**; 
    
- ����� ���������� ��������� �������� �����������;
    
- ������� ������� �� ����������� ����� ��� �������� (� ������ ��������������� ����������);
    
- ����� ����������, �������������� ��� �������� ��������� �����;
    
- ����� �������������� �����;
    
- ����� ��������� ������� ����� ������������ ������ ������;
    
- ����� ������� ��� ����������� ����� (�� ��������).
    
> [!NOTE]
> [!����������] � ���� ������ �� �������� �������� ����� ���������������� �������� ������� ��� ������ ���� ������������� � ����������� ���� ����� �������� ��� ��������. ������������ ��������� ������� ��� ������ ���-����, ����� ��� �����������, ������� ��� ����� ��������� ��������� ������������. ����� �������, ����� "������������" ����� �������� "������������ ���� ������� ��� �������, ���������� �������������". 
  
## <a name="dependence-dirty-cells-and-recalculated-cells"></a>�����������, "�������" ������ � ������������� ������

���������� ������ � Excel ����� ������������� ��� ������� �� ���� ������:
  
1. �������� ������ ������������
    
2. �������� ������� ����������
    
3. �������� �����
    
������ ������������ �������� Excel, ����� ������ ������� �� ������ ����� ���, ����������, ����� ������ �������� ������������ ��� ������. �� ����� ������ Excel ���������� ������� ����������. � ��� ������������� ��� ������, ������� �������� �������, � ��� �������, � ������� �� ���������� ���������. �� ����� ��������� Excel �������� ��� �������, ���� �������������� �������, ������� ������� �� ��� �� ����������� ������. � ���� ������ ����������� ������ � ��������� �� ��� ������ ������������ ���� �� �������. �� ���� ������� ����� ���������� � ������ ���������� ������ ����� ����������� �� ������, ������� ���� ������ ��� �������.
  
��� ����������� ��������� �����, �������� ��� ����� ����� �������, Excel ������ ������� ������ ������������ � ������� ����������. ��� ����� ����� ������ ��� ����� ������ Excel �������� ��� ������, ������� ������� �� ����� ������, ��� ��������� ���������. ���������� ����� ������� ������ ����������  *"��������"*  . ��� ������ � ��������� ��������� ������ ���������� ��� "�������", ������� ���� ������ B1 ������� �� ������ A1, � ������ C1 � �� B1, �� ��� ��������� ������ A1 ������ B1 � C1 ���������� ��� "�������". 
  
���� ������ �������, ����� ��� ��������, �� ����, �� Excel ������������ ����������� ������ � ������������� ������������. ��� �������, ��� �������� � ������, ������� ������������ ������ ���������, � Excel ������������� �������� ����������� � ������������� ��������, ������� ������� ������������ ����� �������� ����������� �����������. � ��������� ������� ��� ������� ��������� ���������. � �������, ��� ����� ��������� ����������� ����������, ��� ��������� ������ ��� ��������� �������� �������� ��������� ����������. Excel ������������ ���������� ������������ ������������ � ������� ����������� ���� ���������� ����������.
  
������� ������ ��� "�������" ��� ��������� ���������, Excel �������� ��������� ���������� ������ "�������" ������ � �������, ������������ �������� ����������. � ����������� ���� ������� ��� ��������, ��� ������� ����������� ������ B1, � ����� � C1. �������� ���������� ����� ����� ����, ��� Excel �������� �������� ������ ��� "�������", ���� ������ �������������� ����� ���������. � ��������� ������ ��� ���������� �����.
  
������� � Microsoft Excel 2002, ������ **Range** � Microsoft Visual Basic ��� ���������� (VBA) ������������ ����� **Range.Dirty**, ������� �������� ������ ��� ��������� ��������. ����� �� ������������ ��������� � ������� **Range.Calculate** (��. ��������� ������), �� �������� �������������� �������� ����� � ������������ ���������. ��� ������� ��� ���������� ������������� ���������� � �������, ��� ���������� ������ ����� ����������, �� ��������� ������� ����������� �����, �� ����������� � ������� �������. ������ ���������� ���������� ���������� ����� API C. 
  
� Excel 2002 � ����� ������ ������� Excel ��������� ������� ���������� ��� ������� ����� � ������ �������� �����. ��� ��������� ��������� ��������� ������ ����� ������� � ��������� ������������ ��� ����������� ������������ ���������. � ���������, � Excel 2000 ���������� ������� � �������� ����������� ����� ������� � ����������� ������ ����� � ���������� �������, ����� �����, ��������� �� ������ ������, ��������� �� �������� �� �������, �� ������� ��� �������.
  
� Excel�2007 ������ ���� �������� ��� ��������� ��������� � ��������� �������, ����� ������� ������� ���������� �� �������� ���� �� ����� � �� ����� ���� ��������� ������������. �� ������ ��������� Excel ��� ������������� ���������� ������� �� ���������� � ����� ����������� ��� ������ ������ �� ����������������� ��� ������������ ����������. 
  
## <a name="asynchronous-user-defined-functions-udfs"></a>����������� ���������������� �������

����� ���������� ������������ ����������� ���������������� �������, ��� ��������� ��������� ������� �������, ��������� ���������������� ������� � ���������� ��������� ��������� ������. ����� ���������� ��������� ������ �����, Excel ���� ���������� ����������� �������, ���� ��� ��� �����������. �� ���� ���� ��� ������ ����������� ������� �������� � �����������, Excel ��������� �������, � ����� ��������� ����� �������� ����������, ����� ����������� ������, ������� ���������� ������ �� ������� �� ����������� �������.
  
## <a name="volatile-and-non-volatile-functions"></a>���������� � ���������� �������

Excel ������������ ���������� �������, �� ���� �������, �������� ������� � ������ ������� ����� ����������, ���� ���� �� ���� �� ���������� (���� ��� �����������) �� ���������. Excel �������� ��������� ������, ������� �������� ���������� �������, ������ �� ����� ���������� ��������� ��� ������ ���������. �� ���� ������� ���������� ������������� ���������� ������� ����� ��������� ��������. ����������� �� ��������.
  
����������� �������� ��������� ������� Excel:
  
- **NOW**
    
- **TODAY**
    
- **СЛУЧМЕЖДУ()**
    
- **OFFSET**
    
- **INDIRECT**
    
- **INFO** (� ����������� �� ����������) 
    
- **CELL** (� ����������� �� ����������) 
    
- **СУММЕСЛИ** (в зависимости от его аргументов) 
    
���������� API VBA � C ������������ ������� �������� Excel, ��� ���������������� ������� ������� ������������ ��� ����������. � VBA ���������������� ������� ����������� ���������� ��������� �������.
  
```vb
Function MyUDF(MakeMeVolatile As Boolean) As Double
   ' Good practice to call this on the first line.
   Application.Volatile (MakeMeVolatile)
   MyUDF = Now
End Function

```

�� ��������� Excel ������������, ��� ���������������� ������� VBA �� �������� �����������. Excel ������, ��� ���������������� ������� �������� ����������, ������ ��� �� ������ ������. ���������� ���������������� ������� ����� ������� ����������, ��� � ��������� �������.
  
� ������� API C ����� ���������������� ������� XLL ��� ���������� �� �� ������� ������. �� ����� ��������� �������� � ��������� ���������� ��������� ������� �����.
  
�� ��������� Excel ������������ ���������������� ������� XLL, ������� ��������� ��������� � �������� ���������� � ��������� ��� ����������� ����� ��������, ��� ����������. �� ������ ��������� ��� ��������� �� ��������� � ������� ������� **xlfVolatile** ��� ������ ������ ���������������� �������. 
  
## <a name="calculation-modes-commands-selective-recalculation-and-data-tables"></a>������ ����������, �������, ���������� �������� � ������� ������

� Excel ���� ��� ������ ����������:
  
- ��������������
    
- ��������������, ����� ������
    
- ������
    
� �������������� ������ ���������� �������� ���������� ������ ����� ������� ����� ������ � ����� ������������ �������, ����� ��� ������� � ���������� �������. � ����� ������� ������ �������� ����� �������� ��� ����� �������, ��� ������������� ���������� ������������ ��� �������, ����� �������� ���������� ������ ��� �������������. ��� ����� Excel ������������ ������ �����. ������������ ����� ������� ����� � ������� ���� Excel ��� ����������� �������� � ������� API VBA, COM ��� C.
  
������� ������ � ��� ����������� ��������� �� �����. ������� ������������ ����������� ���������� ���������� �� �����. ��� ������� �� ������ ��� ���� ���������� ��������� ������ � ������ ����������. ����� ������������ ����� ������� ������� ����������� ��� ������ �������� ������ ��� ����� ��������� ������. ������� ��������� � ������� **������� ������ ������**. ����� ��������� ������� Excel �� ������ ���������� ����� � ���������� � �������� ���������� �������� � �������. ��� ��� ����� ������������ ���� ��� ��� �����, ������� ������ ����� ���� ����������� ��� ����������. 
  
�������� ������ ������ �������������� ������� ��-�������:
  
- �������� �������������� ���������� � ������� �� �������� ��������� ����, ������� �������� ������� ������ ����� �������� ������ �������, ��� �������� ��������� ��������� �����.
    
- ����������� ������ �����������. ���� ����������, ������������ ��� ��������� ����������, ������� �� ������ ��� ���������� �������� �� ������� ������, �� Excel �� ���������� ������ ����������� �����������. 
    
��������, ��� Excel ��-������� ������������ �������� ������ ������, � ���������� ������� ������, ��������� �� ������� ��� ������� ����������, ����� �������� ����� �������, Excel ��������� ��������� �������������� ���������� ������ ������. ��� ����� �������� ����� ���������� "��������������, ����� ������". � ���� ������ ������������ ����� ������������� ������, ����� ������� F9 ��� �������� ������������� ����������� ��������.
  
Excel ������������� ������, � ������� ������� ����� �������� ����� ��������� � ��������� ��. ��� ������ ���������� �� ������ � ������, ����� ���������� ����������� ����� ������� ����������. ����������� API C � ���� ��������� �������� �����������, ��������� � Excel ������ 5, ������� �� ������������� ������ ����������, ��� ��� ������������� VBA � ����� ������� �������. 
  
��� ������ ���� ����� ������������, ����� Excel ��������� � ������ ������ ����������, � ��������� ��������� ��������� �����, ����� � ���������, ��������� ������������� ��� �������� ����� � ���� ��������� ������������� ������ ������������ � ������� ����������.
  
### <a name="range-calculation"></a>���������� ����������

�������: ���
  
VBA: **Range.Calculate** (�������� � Excel 2000, ������� � Excel�2007) � **Range.CalculateRowMajorOrder** (�������� � Excel�2007) 
  
API C: �� ��������������
  
- **������ �����**
    
    ������������� ������ ������ � ������������ ��������� ���������� �� ����, "�������" �� ���. ��������� ������ **Range.Calculate** ���������� � Excel�2007. ��� �� �����, ������ ��������� ��-�������� �������������� � **Range.CalculateRowMajorOrder** method. 
    
- **����� "��������������" ��� "��������������, ����� ������"**
    
    ������������� �����, �� �� ��������� �������������� �������� ��������� ��� �����-���� ����� � ���.
    
### <a name="active-worksheet-calculation"></a>�������� ���������� ������

�������: SHIFT+F9
  
VBA: **ActiveSheet.Calculate**
  
API C: **xlcCalculateDocument**
  
- **��� ������**
    
    ������������� ������, ���������� ��� ����������, ������ �� �������� �����.
    
### <a name="specified-worksheet-calculation"></a>���������� ��������� ������

�������: ���
  
VBA: **Worksheets(** ������ **).Calculate**
  
API C: �� ��������������
  
- **��� ������**
    
    ������������� "�������" ������ � �� ����������� ������ �� ��������� �����. ������ � ��� ��� ����� ��� ������ ��� ����� ������� � ��������������� �����.
    
    Excel 2000 � ����� ������� ������ ������������� �������� ����� **EnableCalculation** � ������� **Boolean**. ���� ������ ��� ���� �������� **True** ������ **False**, ��� ������ �� ��������� ����� ����� �������� ��� "�������". � �������������� ������� ��� ����� �������� �������� ���� �����. 
    
    � ������ ������ ��������� ��� �������� �������� ������ ��������� �����.
    
  ```vb
  With ActiveSheet
    .EnableCalculation = False
    .EnableCalculation = True
    .Calculate
  End With
  
  ```

### <a name="workbook-tree-rebuild-and-forced-recalculation"></a>��������� �������� � �������������� �������� ������ �����

�������: CTRL+ALT+SHIFT+F9 (��������� � Excel 2002)
  
VBA: **Workbooks(** ������ **).ForceFullCalculation** (��������� � Excel�2007) 
  
API C: �� ��������������
  
- **��� ������**
    
    ��������� Excel ������ ������� ������ ������������ � ������� ���������� ��� ������������ ����� � �������� �������� ���� �����, ���������� �������.
    
### <a name="all-open-workbooks"></a>��� �������� �����

�������: F9
  
VBA: **Application.Calculate**
  
API C: **xlcCalculateNow**
  
- **��� ������**
    
    ������������� ��� ������, ������� Excel ������� ��� "�������", �� ���� ��������� �� ���������� ��� ���������� ������, � ������, ���������� ���������� ��� "�������". ���� ������ ����� ���������� "��������������, ����� ������", ���� ����� ��������� �������, ������� ������� ����������, � ����� ��� ���������� ������� � �� �����������.
    
### <a name="all-open-workbooks-tree-rebuild-and-forced-calculation"></a>��������� �������� � �������������� ���������� ������ ���� �������� ����

�������: CTRL+ALT+F9
  
VBA: **Application.CalculateFull**
  
API C: �� ��������������
  
- **��� ������**
    
    ������������� ��� ������ �� ���� �������� ������. ���� ������ ����� ���������� "��������������, ����� ������", ����������� �������������� �������� ������.
    
## <a name="see-also"></a>��. �����



[�������������� �������� � Excel](multithreaded-recalculation-in-excel.md)
  
[���� ������, ������������ � Excel](data-types-used-by-excel.md)
  
[���������� ������� � Excel](memory-management-in-excel.md)
  
[�������� ���������������� � Excel](excel-programming-concepts.md)


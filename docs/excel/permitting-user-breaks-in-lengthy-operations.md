---
title: Разрешение перерывов пользователей в длительных операциях
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- xlabort function [excel 2007],concurrent tasks [Excel 2007],user breaks [Excel 2007]
localization_priority: Normal
ms.assetid: 0e3df597-0aa6-497f-bc52-58c7dc064538
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 650af14e4e97ebd2642a4442a87965f313d3b556
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414692"
---
# <a name="permitting-user-breaks-in-lengthy-operations"></a>Разрешение перерывов пользователей в длительных операциях

 **Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
Несмотря на то, что Windows использует предварительное многозадачное выполнение, выполнение функций или команд может занять много времени, лучше уступить некоторое время операционной системе сейчас и снова, чтобы она спланировать параллельно выполняемые задачи. С помощью вызовов Windows можно использовать функцию спящий режим. С помощью API C это можно сделать с помощью функции [xlAbort,](xlabort.md)которая не только мгновенно дает процессор, но и **проверяет,** нажал ли пользователь клавишу отмены ESC.
  
Следовательно, функция **xlAbort** позволяет коду проверить, хочет ли пользователь закончить процесс, сделать необходимую очистку, а затем вернуть управление в Excel. Функция также позволяет очистить условие приорва. Это позволяет командам отображать диалоговое окно для проверки того, хочет ли пользователь закончить команду. Если пользователь не хочет закончить команду, вызов функции **xlAbort** с аргументом  *FALSE*  очищает разрыв. (Аргумент по умолчанию  *— TRUE,*  который просто проверяет условие, но не очищает его.) 
  
Функцию **xlAbort** можно вызвать из пользовательской функции (UDF) или из команды XLL. В пользовательской функции, когда функция **xlAbort** возвращает **значение TRUE,** обнаруживая разрыв пользователя, вы обычно отключали вычисление функции и возвращали некоторое значение, чтобы указать, что вычисление не завершено, например ошибка или ноль. Условие приорва не очищается, чтобы другие экземпляры длительных функций, которые также проверяют это условие, также разрывались. Excel неявно очищает это условие после окончания пересчета.
  
При обнаружении условия приорва в команде, как правило, это условие очищается путем повторного вызова функции **xlAbort** с аргументом **FALSE,** хотя Excel неявно очищает это условие после окончания команды.
  
## <a name="see-also"></a>См. также



[Функции API C, которые можно вызывать только из библиотеки DLL или XLL](c-api-functions-that-can-be-called-only-from-a-dll-or-xll.md)
  
[Многопоточный пересчет в Excel](multithreaded-recalculation-in-excel.md)
  
[Разработка XLL-файлов для Excel](developing-excel-xlls.md)
  
[Доступ к дескрипторам основного окна и экземпляра Excel](how-to-access-excel-instance-and-main-window-handles.md)


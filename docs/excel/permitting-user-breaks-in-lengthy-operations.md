---
title: Разрешение прерывания длительных операций пользователем
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- функция xlAbort [excel 2007,] параллельных задач [Excel 2007], разрывов пользователя [Excel 2007]
localization_priority: Normal
ms.assetid: 0e3df597-0aa6-497f-bc52-58c7dc064538
description: 'Относится к: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: b13f9b9a8c0e5621b25df13537632bdbe5dfc29e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807312"
---
# <a name="permitting-user-breaks-in-lengthy-operations"></a>Разрешение прерывания длительных операций пользователем

 **Относится к**: Excel 2013 | Office 2013 | Visual Studio 
  
Несмотря на то, что используется Windows включить многозадачность, где функции или команды может занять много времени на выполнение, рекомендуется, чтобы получить некоторое время для операционной системы и для ее планирования параллельных задач. С помощью собственного вызовов Windows, можно сделать это с помощью функции спящего режима. Использование интерфейса API для C, можно сделать его с помощью [функции xlAbort](xlabort.md), который не только дает процессора для обмена мгновенными, но также проверяет, если пользователь нажата клавиша cancel, **ESC**.
  
Функция **xlAbort** таким образом включает код для проверки, является ли пользователю необходимо завершить процесс, выполните необходимые очистки и затем вернуться элемента управления в Excel. Функция также позволяет очистить условия останова. Это позволяет команды для отображения диалогового окна Проверка ли пользователь хочет завершения команды. Если пользователь не нужно закончить команды, вызов функции **xlAbort** с аргументом *FALSE* очищает приостановки выполнения. (Аргумент по умолчанию используется *значение TRUE* , которое просто проверяет условие, но не очищает.) 
  
Можно вызвать функцию **xlAbort** из пользовательской функции (UDF) или команду XLL. В пользовательской функции функция **xlAbort** возвращает **значение TRUE**, обнаружен разрыв пользователя необходимо обычно Вырезать короткий вычисления функции и возврата некоторые значение, указывающее, что расчет завершилось завершено, возможно сообщение об ошибке или ноль. Вы не снять условие приостановки выполнения, чтобы другие экземпляры длительным функций, которые также проверить это условие также разрыв. Excel неявно очищает это условие, при завершении пересчета.
  
Если в команду обнаружить условия останова, обычно снять условие путем вызова функции **xlAbort** еще раз с аргументом, **значение FALSE**, несмотря на то, что Excel неявно очищает это условие при завершении команды.
  
## <a name="see-also"></a>См. также



[Функции API C, которые можно вызывать только из библиотеки DLL или XLL](c-api-functions-that-can-be-called-only-from-a-dll-or-xll.md)
  
[Многопоточный пересчет в Excel](multithreaded-recalculation-in-excel.md)
  
[Разработка XLL-файлов для Excel](developing-excel-xlls.md)
  
[Доступ к дескрипторам основного окна и экземпляра Excel](how-to-access-excel-instance-and-main-window-handles.md)


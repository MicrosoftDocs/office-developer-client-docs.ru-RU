---
title: Разрешение перерывов пользователя в длительных операциях
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- xlabort function [excel 2007], concurrent tasks [Excel 2007], user breaks [Excel 2007]
localization_priority: Normal
ms.assetid: 0e3df597-0aa6-497f-bc52-58c7dc064538
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 650af14e4e97ebd2642a4442a87965f313d3b556
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414692"
---
# <a name="permitting-user-breaks-in-lengthy-operations"></a>Разрешение перерывов пользователя в длительных операциях

 **Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
Хотя Windows использует устроительный многозадачность, когда выполнение функций или команд может занять много времени, не стоит уступать некоторое время операционной системе, чтобы помочь ей планировать одновременно выполняемые задачи. С помощью Windows вызовов можно сделать это с помощью функции сна. С помощью API C вы можете сделать это с помощью функции [xlAbort,](xlabort.md)которая не только дает процессор на мгновение, но и проверяет, нажал ли пользователь клавишу отмены, **ESC**.
  
Поэтому **функция xlAbort** позволяет коду проверить, хочет ли пользователь закончить процесс, сделать необходимую очистку, а затем вернуть управление Excel. Функция также позволяет очистить условие перерыва. Это позволяет командам отображать диалоговое окно, чтобы проверить, хочет ли пользователь закончить команду. Если пользователь не хочет закончить команду, вызов **функции xlAbort** с аргументом  *FALSE*  снимет разрыв. (Аргумент по умолчанию  *true*  , который просто проверяет условие, но не очищает его.) 
  
Функцию **xlAbort** можно вызвать из пользовательской функции (UDF) или из команды XLL. В UDF, когда функция **xlAbort** возвращает **TRUE,** обнаружив перерыв пользователя, обычно вы пресекать вычисление функции и возвращать некоторое значение, чтобы указать, что вычисление не завершено, возможно, ошибка или ноль. Условие перерыва не будет очищаться, чтобы другие экземпляры длительных функций, которые также проверяли это условие, также нарушались. Excel неявно очищает это условие после окончания пересчета.
  
При обнаружении условия перерыва в команде обычно очищается условие путем вызова **функции xlAbort** снова с аргументом **FALSE,** хотя Excel неявно очищает это условие, когда команда заканчивается.
  
## <a name="see-also"></a>См. также



[Функции API C, которые можно вызывать только из библиотеки DLL или XLL](c-api-functions-that-can-be-called-only-from-a-dll-or-xll.md)
  
[Многопоточный пересчет в Excel](multithreaded-recalculation-in-excel.md)
  
[Разработка XLL-файлов для Excel](developing-excel-xlls.md)
  
[Доступ к дескрипторам основного окна и экземпляра Excel](how-to-access-excel-instance-and-main-window-handles.md)


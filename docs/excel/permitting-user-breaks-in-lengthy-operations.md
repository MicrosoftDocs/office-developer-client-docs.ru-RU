---
title: Разрешение преРывать работу пользователей в длительные операции
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- функция xlAbort [Excel 2007], одновременные задачи [Excel 2007], пользовательские перерывы [Excel 2007]
localization_priority: Normal
ms.assetid: 0e3df597-0aa6-497f-bc52-58c7dc064538
description: 'Относится к: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 650af14e4e97ebd2642a4442a87965f313d3b556
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310383"
---
# <a name="permitting-user-breaks-in-lengthy-operations"></a>Разрешение преРывать работу пользователей в длительные операции

 **Относится к**: Excel 2013 | Office 2013 | Visual Studio 
  
Несмотря на то, что Windows использует многозадачное прерывание, где выполнение функций или команд может занять длительное время, рекомендуется немедленно получить некоторое время на операционную систему и еще раз, чтобы оно могло запланировать параллельные задачи. С помощью собственных вызовов Windows вы можете сделать это с помощью функции Sleep. С помощью API C можно сделать это с помощью [функции xlAbort](xlabort.md), которая не только получает обработчик для мгновенного, но также проверяет, нажал ли пользователь клавишу Cancel, **ESC**.
  
Таким образом, функция **xlAbort** позволяет коду проверять, желает ли пользователь закончить процесс, выполнить необходимую очистку и вернуть управление в Excel. Функция также позволяет очистить условие приостанова. Это позволяет командам отображать диалоговое окно, чтобы проверить, хочет ли пользователь завершить команду. Если пользователю не требуется завершать команду, вызов функции **xlAbort** с аргументом *false* очищает разрыв. (Аргумент Default имеет *значение true* , которое просто проверяет условие, но не очищает его.) 
  
Вы можете вызвать функцию **xlAbort** из пользовательской функции (UDF) или команды XLL. Если функция XlAbort возвращает значение true, то в случае, если функция **** возвращает **значение true**, при обнаружении разрыва пользователя, как правило, будет сокращена функция вычисления функции и возвращено значение, указывающее, что вычисление не было завершено, а может быть ошибкой или нулем. Вы не можете очистить условие останова, чтобы другие экземпляры длительных функций, которые также проверяют это условие, также применялись. Excel неявно удаляет это условие при завершении пересчета.
  
При обнаружении условия останова в команде обычно выполняется очистка условия путем повторного вызова функции **xlAbort** с аргументом **false**, хотя Excel неявно удаляет это условие при завершении команды.
  
## <a name="see-also"></a>См. также



[Функции API C, которые можно вызывать только из библиотеки DLL или XLL](c-api-functions-that-can-be-called-only-from-a-dll-or-xll.md)
  
[Многопоточный пересчет в Excel](multithreaded-recalculation-in-excel.md)
  
[Разработка XLL-файлов для Excel](developing-excel-xlls.md)
  
[Доступ к дескрипторам основного окна и экземпляра Excel](how-to-access-excel-instance-and-main-window-handles.md)


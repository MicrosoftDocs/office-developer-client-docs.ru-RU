---
title: Известные проблемы, возникающие при разработке XLL для Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- Известные проблемы, возникающие [excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'Относится к: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 34784f6895386efe7e6c3ca7ec213c7d71931058
ms.sourcegitcommit: f139451a43598b59da22775333779df691df460a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/27/2018
ms.locfileid: "26685181"
---
# <a name="known-issues-in-excel-xll-development"></a>Известные проблемы, возникающие при разработке XLL для Excel

 **Относится к**: Excel 2013 | Office 2013 | Visual Studio 
  
В этом разделе описываются известные проблемы, возникающие в Microsoft Excel, которые могут возникать в разработку XLL-Модулей.
  
## <a name="unregistering-xll-commands-and-functions"></a>Отмена регистрации XLL команд и функций

Когда надстройке XLL регистрирует функции или команды, Excel создает новое имя для ресурса и связывает ссылка на функцию DLL с таким именем. Имя берется из четвертый аргумент *pxFunctionText* , функции [xlfRegister](xlfregister-form-1.md) . Это имя скрыто от обычных диалоговых окон для управления имена листов. Чтобы отменить регистрацию функции или команды, необходимо удалить имя с с помощью функции [xlfSetName](xlfsetname.md) , передающая свое имя, но не передав определение. Тем не менее ошибки не позволяет это удаление имя из списков Мастер функций. 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a>Усечение строки описание аргумента в Мастер функций

Параметр *pxArgumentHelp1* и всех последующих параметров функции **xlfRegister** — это необязательный строк, соответствующих аргументы функции XLL. Мастер функций отображает эти для предоставления справки в диалоговом окне аргумент стадии разработки. В некоторых случаях Excel ограничивает длину строки, соответствующий последний аргумент с одним или двумя символов при отображении в диалоговом окне. Это позволяет избежать путем добавления дополнительных «пустая строка» в качестве последнего параметра «аргумент справки» регистрация функции.
  
## <a name="binary-name-scope-limitation"></a>Ограничение области имя двоичного файла

Двоичные имена и данные могут быть получены только в том случае, если лист, выполненного в то время, когда они были созданы еще раз является активным. Так как функции листа не удается активировать листы в книге (только для команды для этого), приложения двоичные имена очень ограничены. При наличии команду, которая вызывается только из отдельного листа, например, можно использовать имя двоичного файла для хранения данных, связанных с командной.
  
## <a name="xlset-and-workbooks-with-array-formulas"></a>функция xlSet и книги с помощью формулы массива

В Excel 2003 и более ранних версий, [функция xlSet функции](xlset.md) происходит сбой при попытке назначения значения для диапазона на листе, который не является активного листа, где эквивалентный диапазона на активном листе содержит формулы массива. В этом случае Excel с сообщением «Не может изменить частью массива». Эта ошибка исправлена в Excel 2007. 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a>Циклические ссылки допускаются в таблицах данных

В настоящее время Excel вызывает ошибку, если если вычислений на основе таблицы данных ссылается на что-нибудь в всю таблицу. Как вероятнее всего, не может быть этот сценарий, вам следует проявлять осторожность при Создание или изменение формул, которые используются для вычисления значения таблицы данных.
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a>Преобразование XLOPER12 целое число в XLOPER

Так как тип integer **xltypeInt** 32-разрядное целое число со знаком в типе данных **XLOPER12** , но его только 16-разрядного целого числа со знаком в типе данных **XLOPER** , это возможно, что некоторые значения **XLOPER12** целое число не могут содержаться в целое число, **XLOPER**. Где Excel преобразует этот тип во внутренней сети, он получает решения проблемы можно преобразовать тип с плавающей запятой **xltypeNum** **XLOPER**.
  
Функция Framework [XLOper12ToXLOper](xloper12toxloper.md) отображают это поведение для соответствия Excel во внутренней сети. При вызове этой функции не предполагается, что возвращенные **XLOPER** всегда будет **xltypeInt**; чтение **my_xloper.val.w** дает значение false, если тип **my_xloper** **xltypeNum**.
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a>Возвращает ошибку XLOPER или XLOPER12 путем изменения аргументов на месте

Excel позволяет регистрации функций, возвращающих **XLOPER** или **XLOPER12** путем изменения аргумента на месте. Тем не менее если **XLOPER**/ **XLOPER12** аргумент указывает на память и указатель затем перезаписанного возвращаемое значение функции DLL, Excel можно утечка памяти. Excel не отображает ошибку, но он может завершиться со временем. Кроме того если библиотеки DLL выделение памяти для возвращаемого значения, Excel мог попытаться сведениям, память, что может привести к сбоем интерпретации приложения. Таким образом, не следует изменять **XLOPER**/ аргументы**XLOPER12** на месте. Аргументы всех **XLOPER** или **XLOPER12** должны рассматриваться как строго только для чтения. 
  
Дополнительные сведения см. в статье [Управление памятью в Excel](memory-management-in-excel.md).
  
## <a name="see-also"></a>См. также



[XLOper12ToXLOper](xloper12toxloper.md)


[Разработка XLL-файлов для Excel](developing-excel-xlls.md)
  
[Справочник по функциям API SDK XLL для Excel](excel-xll-sdk-api-function-reference.md)
  
[Управление памятью в Excel](memory-management-in-excel.md)


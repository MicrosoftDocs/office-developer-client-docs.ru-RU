---
title: Известные проблемы разработки XLL в Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- Известные проблемы [Excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'Относится к: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 34784f6895386efe7e6c3ca7ec213c7d71931058
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32304006"
---
# <a name="known-issues-in-excel-xll-development"></a>Известные проблемы разработки XLL в Excel

 **Относится к**: Excel 2013 | Office 2013 | Visual Studio 
  
В этом разделе описываются известные проблемы в Microsoft Excel, которые могут встретиться при разработке XLL.
  
## <a name="unregistering-xll-commands-and-functions"></a>Отмена регистрации команд и функций XLL

Когда XLL регистрирует функцию или команду, Excel создает новое имя для ресурса и связывает ссылку на функцию DLL с таким именем. Имя берется из четвертого аргумента ( *пксфунктионтекст* ) функции [xlfRegister](xlfregister-form-1.md) . Это имя скрыто из обычных диалоговых окон для управления именами листов. Чтобы отменить регистрацию функции или команды, необходимо удалить имя с помощью функции [xlfSetName](xlfsetname.md) , передав имя, но не передавая определение. Однако ошибка не позволяет удалить имя из списка мастера функций. 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a>Описание аргумента усечение строки в мастере функций

Параметр *pxArgumentHelp1* и все последующие параметры функции **xlfRegister** — это необязательные строки, соответствующие аргументам функции XLL. Мастер функций отображает их для предоставления справки в диалоговом окне Создание аргументов. Иногда Excel усекает строку, соответствующую последнему аргументу, на один или два символа при его отображении в диалоговом окне. Это можно избежать, добавив дополнительную "пустую строку" в качестве последнего параметра "аргумент Help" регистрации функции.
  
## <a name="binary-name-scope-limitation"></a>Ограничение области имен двоичных файлов

Двоичные имена и их данные могут извлекаться только в том случае, если лист, который был активен в момент создания, снова активен. Так как функции листа не могут активировать листы в книге (это можно делать только с помощью команд), приложения с двоичными именами очень ограничены. Если у вас есть команда, которая вызывается только с определенного листа, например, можно использовать двоичное имя для хранения данных, связанных с командой.
  
## <a name="xlset-and-workbooks-with-array-formulas"></a>Кслсет и книги с формулами массива

В Excel 2003 и более ранних версиях [функция кслсет](xlset.md) завершается с ошибкой, если вы пытаетесь присвоить значения диапазону на листе, который не является активным листом, где эквивалентный диапазон на активном листе содержит формулу массива. В этом случае Excel отображает сообщение "невозможно изменить часть массива". Это было исправлено в Excel 2007. 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a>В таблицах данных доПускают циклические ссылки

В настоящее время Excel не вызывает ошибку, если вычисление, на котором основана таблица данных, ссылается на что-либо в самой таблице. Как маловероятно, так как этот сценарий может быть нецелесообразным, следует быть внимательным при создании или изменении формул, которые используются для вычисления значений таблицы данных.
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a>Преобразование целого числа XLOPER12 в XLOPER

Так как тип целого числа **кслтипеинт** является 32-битным целым числом со знаком в типе данных **XLOPER12** , но это только 16-разрядное целое число со знаком в типе данных **XLOPER** , возможно, что некоторые целочисленные значения **XLOPER12** не могут содержаться в число **XLOPER**. Где Excel преобразует этот тип внутренним образом, он обходит эту проблему путем преобразования типа в **кслтипенум** **XLOPER**.
  
Функция Framework [XLOper12ToXLOper](xloper12toxloper.md) отражает это поведение для внутреннего согласования с Excel. При вызове этой функции не следует предполагать, что возвращаемая **XLOPER** всегда будет **кслтипеинт**; при чтении **ми_кслопер. Val. w** выдается значение false, если тип **ми_кслопер** — **кслтипенум**.
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a>Возвращение XLOPER или XLOPER12 за счет изменения аргументов на месте

Excel позволяет регистрировать функции, возвращающие **XLOPER** или **XLOPER12** , изменяя аргумент на месте. Тем не менее, если аргумент **XLOPER**/ **XLOPER12** указывает на память, а указатель переопределяется возвращаемым значением функции DLL, Excel может утечка памяти. Excel не отображает сообщение об ошибке, но может в конечном итоге завершиться со сбоем. Кроме того, если выделена память DLL для возвращаемого значения, Excel может попытаться освободить эту память, что может привести к немедленному сбою приложения. Таким образом, не следует изменять аргументы **XLOPER**/ **XLOPER12** на месте. Все аргументы **XLOPER** и **XLOPER12** должны рассматриваться как строго только для чтения. 
  
Дополнительные сведения см. в статье [Управление памятью в Excel](memory-management-in-excel.md).
  
## <a name="see-also"></a>См. также



[XLOper12ToXLOper](xloper12toxloper.md)


[Разработка XLL-файлов для Excel](developing-excel-xlls.md)
  
[Справочник по функциям API SDK XLL для Excel](excel-xll-sdk-api-function-reference.md)
  
[Управление памятью в Excel](memory-management-in-excel.md)


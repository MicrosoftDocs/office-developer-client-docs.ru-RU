---
title: Доступ к XLL-коду в Excel
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- доступ к xll-коду [excel 2007,] XLL-модулей [Excel 2007], доступ к кода, команды [Excel 2007], регистрация, функции [Excel 2007], регистрация, звонок XLL-модулей для Excel, регистрация команды [Excel 2007], регистрация функций [Excel 2007]
localization_priority: Normal
ms.assetid: 6e4bf1f3-8eca-4be5-9632-75355ac31d61
description: '������� ����������: Excel 2013�| Office 2013�| Visual Studio'
ms.openlocfilehash: 1523f9e8213cb955f1bfd995c42f921b001299fe
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807145"
---
# <a name="accessing-xll-code-in-excel"></a>Доступ к XLL-коду в Excel

**Применимо к**: Excel 2013 | Office 2013 | Visual Studio 
  
Должно быть доступно в Microsoft Excel, функции и команды, которые содержит XLL-модуль:
  
- Необходимо экспортировать с XLL.
    
- Должны быть зарегистрированы в Excel.
    
## <a name="registering-functions-and-commands-with-excel"></a>Регистрация команды и функций в Excel

Регистрация сообщает о точки входа библиотеки DLL Excel следующее:
  
- Будет ли оно скрыто или, если функция, будет ли это видимы в Мастер функций.
    
- Будет ли это вызывать только из таблицы макросов XLM или из листа.
    
- Если команда, будет ли это функция листа или эквивалентную функцию листа макросов.
    
- Экспорт именем XLL/DLL и введите имя, которое требуется Excel для использования.
    
- Если функция:
    
  - Какие данные его тип возвращает и принимает в качестве аргументов.
    
  - Оно возвращает результат путем изменения аргумента на месте.
    
  - Будет ли это переменные.
    
  - Будет ли это потокобезопасными (поддерживаемые начиная с версии Excel 2007).
    
  - При вызове функции должны отображать какой Мастер функций вставить текст и редактор автозаполнения.
    
  - Которой работает, оно должно быть указано в разделе категории.
    
Это все достигается с помощью интерфейса API для C функция [xlfRegister](xlfregister-form-1.md), эквивалентен функции XLM **регистрации**.
  
## <a name="calling-xll-functions-directly-from-excel"></a>Вызов функции XLL непосредственно из Excel

После регистрации они функции листа XLL листа и макрос можно вызывать из везде, где встроенные функции могут вызываться из:
  
- Формула одной ячейки или массив на листе.
    
- Формула одной ячейки или массив на листе макросов.
    
- Определение определенного имени.
    
- Условия и ограничения полей в диалоговом окне Условное форматирование.
    
- Из другой надстройки с помощью функции интерфейса API для C [xlUDF](xludf.md).
    
- В Visual Basic для приложений (VBA) с помощью метода **Application.Run** . 
    
Можно получить ссылку на вызывающий ячейки или диапазона ячеек в функции с помощью функции интерфейса API для C **xlfCaller**. При вызове функции из ячейки условное форматирование в выражение, вы по-прежнему возвращаются ссылку на связанный одну или несколько ячеек, поэтому нельзя предполагается, что формула ячейки содержит функции XLL. Если функция вызван из VBA пользовательской функции (UDF), **xlfCaller** еще раз возвращает адрес ячейки, вызывать функцию VBA. Для получения дополнительных сведений см [xlfCaller](xlfcaller.md).
  
> [!NOTE]
> Excel также вызывает функции XLL-коду в диалоговых окнах **Мастер функции вставки** и **замены** . Может потребоваться ограничить в случае диалогового окна **Вставить функцию аргументов** , особенно где функции может занять много времени на выполнение обычных выполнение вашего кода. Для определения, если функция вызывается с помощью одной из этих диалоговых окон, необходимо реализовать часть кода в проекте, который выполняет итерацию всех открытых окон, чтобы определить, если окно переднего один из этих диалоговых окон и если да, какой из них. 
  
## <a name="calling-xll-commands-directly-from-excel"></a>Вызов команд XLL непосредственно из Excel

После регистрации они XLL команды можно вызвать одним из способов, что можно вызвать другие пользовательские макросы:
  
- Связанного с объектом управления внедренным в лист.
    
- В диалоговом окне выполнить макрос.
    
- Из пользовательских макроса VBA с помощью метода **Application.Run** . 
    
- Элемент настраиваемого меню или панели инструментов.
    
- С помощью сочетания клавиш настроить при регистрации команда.
    
- Перехват что команда выполняется, если указанный события.
    
> [!NOTE]
> Команды XLL скрыты, в том, что они не отображаются в списке доступных макросов в Excel диалоговых окон. Однако они могут быть введены вручную в поле имя макроса. Предполагается, что имя зарегистрирована как в этих диалоговых окнах, а не имя DLL-файла экспорта. 
  
Все команды XLL, зарегистрированных в Excel предполагается, что в Excel, чтобы иметь следующий вид:
  
```cs
short WINAPI xll_cmd_name(void)
{
// Function code...
    return 1;
}

```

Excel возвращаемое значение игнорируется, если не вызывается из листа макросов XLM, в котором случае возвращаемое значение преобразуется в значение **TRUE** или **FALSE**. Следует таким образом возвращает 1, если команда выполнена успешно, а 0, если он не удалась или отменена пользователем.
  
Вы можете получить сведения о вызов команду с помощью интерфейса API для C работать **xlfCaller**. Для получения дополнительных сведений см [xlfCaller](xlfcaller.md).
  
Начиная с версии Excel 2007 пользовательского интерфейса очень отличается от более ранних версий. Функции интерфейса API для C, которые разрешают Добавление и удаление настраиваемых меню, меню, подменю, элементов меню, настраиваемые панели инструментов и кнопки панели инструментов по-прежнему поддерживается в большинстве случаев. Тем не менее они могут не всегда вносить добавленного элемента недоступны, чтобы пользователи знакомы с. Следует тщательно проверять по-прежнему доступны любые дополнительные функции или реализовать настройки разных версий. Начиная с версии Excel 2007 пользовательского интерфейса лучше всего настроить с помощью модуля управляемого кода, который может затем быть тесно связаны с вашим командам XLL.
  
## <a name="see-also"></a>См. также

- [Создание XLL-модулей](creating-xlls.md)
- [Вызов функции XLL из Мастер функций или заменить диалоговых окон](how-to-call-xll-functions-from-the-function-wizard-or-replace-dialog-boxes.md)
- [Диспетчер надстроек и функции XLL интерфейса](add-in-manager-and-xll-interface-functions.md)
- [���������� XLL-������� ��� Excel 2013](developing-excel-xlls.md)




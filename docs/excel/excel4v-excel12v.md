---
title: Excel4v/Excel12v
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Excel12v
- Excel4v
keywords:
- Функция Excel12v [Excel 2007], функция Excel4v [Excel 2007]
localization_priority: Normal
ms.assetid: e3e96b98-c5a7-4625-95b6-a1e2d09c6d3d
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 11ab86a95dde2ad52840822b28ce4d74dd05d148
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414993"
---
# <a name="excel4vexcel12v"></a>Excel4v/Excel12v

 **Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
Вызывает внутреннюю функцию листа Microsoft Excel, функцию или команду листа макроса или специальную функцию или команду, предназначенную только для XLL, из библиотеки DLL, XLL или программного ресурса.
  
Все последние версии Excel поддерживают **Excel4v**. Начиная с Excel 2007, поддерживается **Excel12v** . 
  
Эти функции можно вызывать, только когда Excel передает управление в библиотеку DLL или XLL. Они также могут вызываться, когда Excel передает управление неявным образом с помощью вызова Visual Basic для приложений (VBA). Они не могут быть вызваны в любое другое время. Например, они не могут вызываться во время вызовов функции DllMain или другие случаи, когда операционная система вызвала DLL или из потока, созданного библиотекой DLL. 
  
Функции [Excel4 и Excel12](excel4-excel12.md) принимают аргументы в виде списка переменных длины в стеке, а функции **Excel4v** и **Excel12v** принимают аргументы в виде массива. Во всех остальных отношениях **Excel4** имеет то же значение, что и **Excel4v**, а **Excel12** — то же самое, что и **Excel12v**.
  
```cs
int _cdecl Excel4v(int iFunction, LPXLOPER pxRes, int iCount, LPXLOPER rgx[]);
int _cdecl Excel12v(int iFunction, LPXLOPER12 pxRes, int iCount, LPXLOPER12 rgx[]);
```

## <a name="parameters"></a>Параметры

 _ифунктион_ (**int**)
  
Число, обозначающее команду, функцию или специальную функцию, которую требуется вызвать. Список допустимых значений _ифунктион_ можно найти в приведенном ниже разделе "Примечания". 
  
 _пксрес_ (**лпкслопер** или **LPXLOPER12**)
  
Указатель на **XLOPER** (в случае **Excel4v**) или **XLOPER12** (в случае **Excel12v**), который будет хранить результаты вычисленной функции.
  
 _икаунт_ (**int**)
  
Количество последующих аргументов, которые будут переданы в функцию. В версиях Excel до 2003 это может быть любое число от 0 до 30. Начиная с 2007 Excel, это может быть любое число от 0 до 255.
  
 _ргкс_ (**лпкслопер []** или **LPXLOPER12 []**)
  
Массив, содержащий аргументы функции. Все аргументы в массиве должны быть указателями на значения **XLOPER** или **XLOPER12** . 
  
## <a name="return-value"></a>Возвращаемое значение

Эти функции возвращают те же значения, что и **Excel4** и **Excel12**.
  
## <a name="remarks"></a>Примечания

Эти функции удобно использовать в тех случаях, когда число аргументов, передаваемых оператору, является переменной. Например, **Excel4v** и **Excel12v** можно использовать при регистрации функций с помощью [xlfRegister](xlfregister-form-1.md) , где количество аргументов зависит от количества аргументов, принятых регистрируемой функцией. **Excel4v** и **Excel12v** также могут использоваться при написании функции-оболочки для **Excel4** или **Excel12**. В таких случаях необходимо преобразовать список аргументов переменных, как обычно указывается в **Excel4** или **Excel12**, в один аргумент массива, равный переменной Size, для обратного вызова в Excel с помощью **Excel4v** или **Excel12v**.
  
### <a name="example"></a>Пример

Примеры кода приведены в разделе Code for **Excel** and **Excel12f** functions in the Excel 2010 XLL SDK, в следующем расположении, где вы установили пакет SDK: 
  
самплес\фрамеврк\фрамеврк.к
  
## <a name="see-also"></a>См. также



[Excel4/Excel12](excel4-excel12.md)


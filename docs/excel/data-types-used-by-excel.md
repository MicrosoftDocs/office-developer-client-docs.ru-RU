---
title: Типы данных, используемые в Excel
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
keywords:
- типы регистрационных данных [excel 2007], типы данных Excel, строки [Excel 2007], числа [Excel 2007], структуры данных [Excel 2007], типы данных [Excel 2007]
ms.assetid: 8740a8fb-ad67-4232-a49b-d78967a786c2
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
localization_priority: Priority
ms.openlocfilehash: c546fc80b212301689744d3279a59733d9cc5524
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28710610"
---
# <a name="data-types-used-by-excel"></a>Типы данных, используемые в Excel

**Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
В Microsoft Excel осуществляется замена типов ANSI C/C++ и структур данных, предназначенных специально для Excel. В этой статье сведения о них приведены лишь в качестве дополнения к другим разделам. Их подробное описание приведено в статье [xlfRegister (форма 1)](xlfregister-form-1.md). 
  
## <a name="ansi-cc-types"></a>Типы ANSI C/C++

### <a name="numbers"></a>Числа

Во всех версиях Excel:
  
- double (8-байтовые);
    
- [signed] short [int] (используется для значений **Boolean** и целых чисел); 
    
- unsigned short [int];
    
- [signed long] int.
    
### <a name="strings"></a>Строки

Во всех версиях Excel:
  
- [signed] char \* (строки байтов длиной до 255 символов, оканчивающиеся нулем);
    
- unsigned char \* (строки байтов с ограничением длины, включающие до 255 символов).
    
Начиная с Excel 2007:
  
- unsigned short \* (строки Юникода длиной до 32 767 символов, которые могут оканчиваться нулем или иметь ограничение длины).
    
Все числа листа в Excel сохраняются в двоичном формате, чтобы не нужно было объявлять функции надстройки (что на самом деле представляет собой небольшую нагрузку преобразования) как заменяющиеся целочисленные типы в Excel.
  
Когда вы используете целочисленные типы, Excel проверяет, соответствуют ли вводимые данные заданным типам. Если это не так, отобразится сообщение об ошибке **#NUM!**. Исключение составляют ситуации, когда вы регистрируете функцию, чтобы принять аргумент **Boolean**, внедренный с помощью типа short int. В таком случае любое вводимое число, отличное от нуля, преобразовывается в 1, а нуль пропускается. 
  
## <a name="excel-specific-data-structures"></a>Структуры данных, предназначенные специально для Excel

Во всех версиях Excel:
  
- **FP** — структура двухмерного массива с плавающей запятой, поддерживающая до 65 356 строк при максимально возможном количестве столбцов в текущей версии Excel. 
    
- **XLOPER** — структура многотипных данных, представляющая все типы данных листов (в том числе сообщения об ошибках), целые числа, ссылки на диапазон, типы управления потоком для листов с макросами XLM и тип данных внутреннего хранилища двоичных данных. 
    
   > [!NOTE]
   > Строки представлены в виде строк байтов с ограничением длины (до 255 символов). 
  
Начиная с Excel 2007:
  
- **FP12** — структура двухмерного массива с плавающей запятой, поддерживающая все строки и столбцы, начиная с Excel 2007. 
    
- **XLOPER12** — структура многотипных данных, представляющая все типы данных листов (в том числе сообщения об ошибках), целые числа, ссылки на диапазон, типы управления потоком для листов с макросами XLM и тип данных внутреннего хранилища двоичных данных. 
    
   > [!NOTE]
   > Строки представлены в виде строк Юникода с ограничением длины до 32 767 символов. 
  
## <a name="registration-data-type-codes"></a>Коды для типов регистрационных данных

Функции XLL регистрируются с помощью функции C API **xlfRegister**, которая в качестве третьего аргумента принимает строку букв, кодирующих типы возвращаемых данных и аргументов. Эта строка также содержит сведения для Excel, определяющие, является ли функция переменной, потокобезопасной (начиная с Excel 2007), эквивалентной листу макросов, а также возвращает ли она результат, изменяя аргумент на месте.
  
Таблица ниже представлена и описана более подробно в статье [xlfRegister (форма 1)](xlfregister-form-1.md). Здесь она приведена лишь в качестве дополнения к сведениям этого раздела. Например, функцию, принимающую строку Юникода с ограничением длины (начиная с Excel 2007) можно описать как функцию, которая принимает аргумент типа C%. 
  
|Тип данных|Передаваемый по значению|Передаваемый по ссылке (указателю)|Комментарии|
|:-----|:-----|:-----|:-----|
|Boolean  <br/> |A  <br/> |L  <br/> |short (0=false или 1=true)  <br/> |
|double  <br/> |B  <br/> |E  <br/> ||
|char \*  <br/> ||C, F  <br/> |Строка байтов ASCII, оканчивающаяся нулем  <br/> |
|unsigned char \*  <br/> ||D, G  <br/> |Строка байтов ASCII с ограничением длины  <br/> |
|unsigned short \* (начиная с Excel 2007)  <br/> ||C%, F%  <br/> |Строка Юникода с расширенными символами, оканчивающаяся нулем  <br/> |
|unsigned short \* (начиная с Excel 2007)  <br/> ||D%, G%  <br/> |Строка символов в многобайтовой кодировке Юникода с ограничением длины  <br/> |
|unsigned short [int]  <br/> |H  <br/> ||WORD  <br/> |
|[signed] short [int]  <br/> |I  <br/> |M  <br/> |16-разрядный  <br/> |
|[signed long] int  <br/> |J  <br/> |N  <br/> |32-разрядный  <br/> |
|Array  <br/> ||O  <br/> | Передается по ссылке в виде трех аргументов:  <br/>1. short int \*rows  <br/>2. short int \*columns  <br/>3. double \*array  <br/> |
|Array  <br/> (������� � Excel�2007)  <br/> ||O%  <br/> | Передается по ссылке в виде трех аргументов:  <br/>1. int \*rows  <br/>2. int \*columns  <br/>3. double \*array  <br/> |
|FP  <br/> ||K  <br/> |Структура массива с плавающей запятой  <br/> |
|FP12  <br/> (������� � Excel�2007)  <br/> ||K%  <br/> |Структура большого массива сетки с плавающей запятой  <br/> |
|XLOPER  <br/> ||P  <br/> |Значения и массивы листа в виде переменной  <br/> |
|||R  <br/> |Значения, массивы и ссылки на диапазон  <br/> |
|XLOPER12  <br/> (������� � Excel�2007)  <br/> ||Q  <br/> |Значения и массивы листа в виде переменной  <br/> |
|||U  <br/> |Значения, массивы и ссылки на диапазон  <br/> |
   
���� **C%**, **F%**, **D%**, **G%**, **K%**, **O%**, **Q** � **U** ������� ������������ � Microsoft Office Excel 2007 � �� �������������� � ����� ������ �������. ���� ����� **F**, **F%**, **G** � **G%** ������������ ��� ����������, ���������� �� �����. ����� ��������� **XLOPER** ��� **XLOPER12** �������������� ��� ���� **P** ��� **Q** ��������������, ���������� Excel ��� ���������� ������ ��������������� ������ �� ���� ������ � ������� ��������, � ������ �� ��������� ����� � � �������. 
  
���� **P** � **Q** ������ ������������ � ������� � ���� ��������� �����: **xltypeNum**, **xltypeStr**, **xltypeBool**, **xltypeErr**, **xltypeMulti**, **xltypeMissing** ��� **xltypeNil**, �� �� � ���� **xltypeRef** ��� **xltypeSRef**, ��� ��� �� ������ ��������������. 
  
��� **O**, ������� ���������� ������������ ����� ��� ��������� � �����, ��� ������ ��� ����������� ������������� � ������������ DLL Fortran, ��� ��������� ���������� � ������� ������. �� �� ������� ��� ������������ ��� �������� ��������, ���� �� �������� �������� ��� ������������ �������� ��� ��������� �� ����� � �� ��������� ���������� � ���������, �� ������� ��������� ������. ��� **O%** ��������� ��� **O** � ���������� Excel�2007, ����� � ���� ��� ������ � ��������, ������� ���������� �������, ������� �� �������, ��� ����� Office Excel 2003. 
  
## <a name="see-also"></a>См. также

- [xlfRegister (форма 1)](xlfregister-form-1.md)
- [Понятия, связанные с программированием для Excel](excel-programming-concepts.md)
- [Справочник по функциям API SDK XLL для Excel](excel-xll-sdk-api-function-reference.md)


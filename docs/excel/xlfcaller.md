---
title: xlfCaller
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- xlfCaller
keywords:
- функция xlfCaller [Excel 2007]
localization_priority: Normal
ms.assetid: de4b119c-ae2e-4207-9783-8d5692a4d052
description: 'Относится к: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: fb788375504cefab75fde9513147c1d54acdaa07
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310229"
---
# <a name="xlfcaller"></a>xlfCaller

 **Относится к**: Excel 2013 | Office 2013 | Visual Studio 
  
Возвращает сведения о ячейке, диапазоне ячеек, команде меню, инструменте на панели инструментов или объекте, вызвавшем команду или функцию DLL, которая выполняется в данный момент.
  
|**Код, вызываемый из**|**Возвращаемое значение**|
|:-----|:-----|
|ФАЙЛ  <br/> |Идентификатор регистра.  <br/> |
|Одна ячейка  <br/> |Ссылка на одну ячейку.  <br/> |
|Формула массива С несколькими ячейками  <br/> |Ссылка на несколько ячеек.  <br/> |
|Выражение условного форматирования  <br/> |Ссылка на ячейку, к которой применяется условие форматирования.  <br/> |
|Меню  <br/> | Однострочный массив из четырех элементов:  <br/>  Идентификатор столбца.  <br/>  Положение меню.  <br/>  Положение вложенного меню.  <br/>  Положение команды.  <br/> |
|Панель инструментов  <br/> | Однострочный массив из двух элементов:  <br/>  Номер панели инструментов для встроенных панелей инструментов или имя панели инструментов для настраиваемых панелей инструментов.  <br/>  Положение на панели инструментов.  <br/> |
|Графический объект  <br/> |Идентификатор объекта (имя объекта).  <br/> |
|Команда, связанная с параметром Кслконентер, ON. Ввод, ловушка события  <br/> |Ссылка на вводимую ячейку или ячейки.  <br/> |
|Команда, связанная с параметром Кслкондаублекликк, ON. DOUBLECLICK, ловушка события.  <br/> |Ячейка, которая была двойным щелчком (не обязательно является активной ячейкой).  <br/> |
|Ауто_опен, автоЗакрытие, Ауто_активате или Ауто_деактивате макрос  <br/> |Имя телефонной ведомости.  <br/> |
|Другие методы, не указанные в списке  <br/> |#ССЫЛКА! Ошибка  <br/> |
   
```cs
Excel12(xlfCaller, (LPXLOPER12) pxRes,0);
```

## <a name="property-valuereturn-value"></a>Значение свойства и возвращаемое значение

Возвращаемое значение — один из следующих типов данных **XLOPER**/ **XLOPER12** : **кслтипереф**, **кслтипесреф**, **кслтипенум**, **кслтипестр**, **кслтипирр**или **xltypeMulti**. Так как три этих типа наделяются на выделенную память, возвращаемое значение **xlfCaller** всегда должно освобождаться в вызове [функции кслфри](xlfree.md) , когда он больше не нужен. 
  
Для получения дополнительных сведений о параметрах **XLOPER**/ **** см [в Excel](memory-management-in-excel.md).
  
## <a name="remarks"></a>Замечания

Эта функция является единственной функцией, не являющейся функцией, которая может вызываться из функции листа DLL/XLL. Другие функции данных XLM могут вызываться только из команд или эквивалентных функций листа макросов.
  
## <a name="example"></a>Пример

 `\SAMPLES\EXAMPLE\EXAMPLE.C`. Эта функция вызывает макрос Command (Кслкселект) и будет работать правильно только при вызове из листа макросов.
  
```cs
short WINAPI CallerExample(void)
{
   XLOPER12 xRes;
   Excel12(xlfCaller, &xRes, 0);
   Excel12(xlcSelect, 0, 1, (LPXLOPER12)&xRes);
   Excel12(xlFree, 0, 1, (LPXLOPER12)&xRes);
   return 1;
}
```

## <a name="see-also"></a>См. также



[Необходимые и полезные функции XLM из API C](essential-and-useful-c-api-xlm-functions.md)


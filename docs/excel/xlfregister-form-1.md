---
title: xlfRegister (форма 1)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- xlfRegister
keywords:
- функция xlfregister [Excel 2007]
localization_priority: Normal
ms.assetid: c730124c-1886-4a0f-8f06-79763025537d
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 3cd2e5072c8602fe301028e69592220a8345c211
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303866"
---
# <a name="xlfregister-form-1"></a><span data-ttu-id="07f0a-104">xlfRegister (форма 1)</span><span class="sxs-lookup"><span data-stu-id="07f0a-104">xlfRegister (Form 1)</span></span>

<span data-ttu-id="07f0a-105">**Область применения:** Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="07f0a-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="07f0a-106">Может быть вызвано из команды DLL или XLL, которая сама была вызвана Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="07f0a-106">Can be called from a DLL or XLL command that has itself been called by Microsoft Excel.</span></span> <span data-ttu-id="07f0a-107">Это равно вызову **REGISTER** из макрос Excel XLM.</span><span class="sxs-lookup"><span data-stu-id="07f0a-107">This is equal to calling **REGISTER** from an Excel XLM macro sheet.</span></span> 
  
<span data-ttu-id="07f0a-108">**xlfRegister** можно назвать в двух формах:</span><span class="sxs-lookup"><span data-stu-id="07f0a-108">**xlfRegister** can be called in two forms:</span></span> 
  
- <span data-ttu-id="07f0a-109">xlfRegister (Форма 1): регистрирует одну команду или функцию.</span><span class="sxs-lookup"><span data-stu-id="07f0a-109">xlfRegister (Form 1): Registers a single command or function.</span></span>
    
- <span data-ttu-id="07f0a-110">[xlfRegister (Форма 2)](xlfregister-form-2.md): Загружает и активирует XLL.</span><span class="sxs-lookup"><span data-stu-id="07f0a-110">[xlfRegister (Form 2)](xlfregister-form-2.md): Loads and activates an XLL.</span></span>
    
<span data-ttu-id="07f0a-111">Вызванная в форме 1, эта функция делает функцию DLL доступной для Excel, задает ее количество использования до 1 и возвращает ее регистрационный ID, который можно использовать для вызова функции позже с помощью [функции xlUDF](xludf.md) или **xlfCall.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-111">Called in Form 1, this function makes a DLL function or command available to Excel, sets its use count to 1, and returns its registration ID, which can be used to call the function later by using the [xlUDF](xludf.md) or the **xlfCall** function.</span></span> <span data-ttu-id="07f0a-112">Регистрационный номер также используется для отрегистрации функции [с помощью xlfUnregister (Form 1).](xlfunregister-form-1.md)</span><span class="sxs-lookup"><span data-stu-id="07f0a-112">The registration ID is also used to unregister the function using [xlfUnregister (Form 1)](xlfunregister-form-1.md).</span></span> <span data-ttu-id="07f0a-113">Если функция зарегистрирована, вызов **xlfRegister** снова приумношает количество ее использования.</span><span class="sxs-lookup"><span data-stu-id="07f0a-113">If the function has been registered, calling **xlfRegister** again increments its use count.</span></span> 
  
<span data-ttu-id="07f0a-114">Эта форма функции также определяет скрытое имя, которое является текстовым аргументом функции  _pxFunctionText_ и которое оценивается в регистрационный ID функции или команды.</span><span class="sxs-lookup"><span data-stu-id="07f0a-114">This form of the function also defines a hidden name which is the function text argument,  _pxFunctionText_, and which evaluates to the registration ID of the function or command.</span></span> <span data-ttu-id="07f0a-115">При отрегистрации функции удалите это имя с помощью [xlfSetName.](xlfsetname.md)</span><span class="sxs-lookup"><span data-stu-id="07f0a-115">When you unregister the function, delete this name using the [xlfSetName](xlfsetname.md).</span></span> <span data-ttu-id="07f0a-116">Дополнительные сведения см. в статье [Известные проблемы, возникающие при разработке XLL для Excel](known-issues-in-excel-xll-development.md).</span><span class="sxs-lookup"><span data-stu-id="07f0a-116">For more information, see [Known Issues in Excel XLL Development](known-issues-in-excel-xll-development.md).</span></span>
  
```cs
Excel12(xlfRegister, LPXLOPER12 pxRes, int iCount,
    LPXLOPER12 pxModuleText,   LPXLOPER12 pxProcedure,
    LPXLOPER12 pxTypeText,     LPXLOPER12 pxFunctionText,
    LPXLOPER12 pxArgumentText, LPXLOPER12 pxMacroType,
    LPXLOPER12 pxCategory,     LPXLOPER12 pxShortcutText,
    LPXLOPER12 pxHelpTopic,    LPXLOPER12 pxFunctionHelp,
    LPXLOPER12 pxArgumentHelp1, LPXLOPER12 pxArgumentHelp2,
        ...);
```

## <a name="parameters"></a><span data-ttu-id="07f0a-117">Parameters</span><span class="sxs-lookup"><span data-stu-id="07f0a-117">Parameters</span></span>

<span data-ttu-id="07f0a-118">_pxModuleText_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-118">_pxModuleText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-119">Имя DLL, содержатую функцию.</span><span class="sxs-lookup"><span data-stu-id="07f0a-119">The name of the DLL that contains the function.</span></span> <span data-ttu-id="07f0a-120">Это можно получить путем вызова функции [xlGetName](xlgetname.md) только для XLL, если зарегистрированная функция также находится в настоящее время выполняется DLL.</span><span class="sxs-lookup"><span data-stu-id="07f0a-120">This can be obtained by calling the XLL-only function [xlGetName](xlgetname.md) if the function registered is also within the currently executing DLL.</span></span> 
  
<span data-ttu-id="07f0a-121">_pxProcedure_ **(xltypeStr** или **xltypeNum)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-121">_pxProcedure_ (**xltypeStr** or **xltypeNum**)</span></span>
  
<span data-ttu-id="07f0a-122">Если строка, имя функции, вызываемой в коде DLL.</span><span class="sxs-lookup"><span data-stu-id="07f0a-122">If a string, the name of the function to call as it appears in the DLL code.</span></span> <span data-ttu-id="07f0a-123">Если номер, ordinal export number of the function to call.</span><span class="sxs-lookup"><span data-stu-id="07f0a-123">If a number, the ordinal export number of the function to call.</span></span> <span data-ttu-id="07f0a-124">Для ясности всегда используйте строковую форму.</span><span class="sxs-lookup"><span data-stu-id="07f0a-124">For clarity, always use the string form.</span></span>
  
<span data-ttu-id="07f0a-125">_pxTypeText_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-125">_pxTypeText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-126">Необязательная строка, которая указывает типы аргументов для функции и тип возвращаемого значения функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-126">An optional string that specifies the types of arguments to the function and the type of the return value of the function.</span></span> <span data-ttu-id="07f0a-127">Дополнительные сведения см. в разделе "Примечания".</span><span class="sxs-lookup"><span data-stu-id="07f0a-127">For more information, see the Remarks section.</span></span> <span data-ttu-id="07f0a-128">Этот аргумент может быть опущен для отдельной DLL (XLL), которая включает функцию [xlAutoRegister](xlautoregister-xlautoregister12.md) или **xlAutoRegister12**.</span><span class="sxs-lookup"><span data-stu-id="07f0a-128">This argument can be omitted for a stand-alone DLL (XLL) that includes an [xlAutoRegister function](xlautoregister-xlautoregister12.md) or **xlAutoRegister12**.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="07f0a-129">**xlAutoRegister12** поддерживается только Excel 2007 г.</span><span class="sxs-lookup"><span data-stu-id="07f0a-129">**xlAutoRegister12** is only supported in Excel 2007.</span></span> 
  
<span data-ttu-id="07f0a-130">Если **xlfRegister** вызывается с этим аргументом отсутствует, Excel **вызывает xlAutoRegister** или **xlAutoRegister12**, если либо существует в указанной DLL, которая должна правильно зарегистрировать функцию, предоставив эту информацию.</span><span class="sxs-lookup"><span data-stu-id="07f0a-130">If **xlfRegister** is called with this argument missing, Excel calls **xlAutoRegister** or **xlAutoRegister12**, if either exists in the specified DLL, which should then correctly register the function by providing this information.</span></span>
  
<span data-ttu-id="07f0a-131">_pxFunctionText_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-131">_pxFunctionText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-132">Имя функции, которое появится в мастере функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-132">The function name as it will appear in the Function Wizard.</span></span> <span data-ttu-id="07f0a-133">Этот аргумент необязателен; Если она не будет опущена, функция недоступна в мастере функции и может быть вызвана только с помощью функции **CALL** с помощью ИД регистрации функций из макрос листа XLM.</span><span class="sxs-lookup"><span data-stu-id="07f0a-133">This argument is optional; if it is omitted, the function is not available in the Function Wizard, and can only be called using the **CALL** function using the functions registration ID from an XLM macro sheet.</span></span> <span data-ttu-id="07f0a-134">Поэтому для обычного использования таблицы этот аргумент следует обрабатывать по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="07f0a-134">Therefore, for ordinary worksheet use, you should handle this argument as required.</span></span> 
  
<span data-ttu-id="07f0a-135">_pxArgumentText_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-135">_pxArgumentText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-136">Необязательная текстовая строка, описываемая аргументами для функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-136">An optional text string that describes the arguments to the function.</span></span> <span data-ttu-id="07f0a-137">Пользователь видит это в мастере функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-137">The user sees this in the Function Wizard.</span></span> <span data-ttu-id="07f0a-138">Если оно не будет пропущено, Excel основные описания из _pxTypeText_.</span><span class="sxs-lookup"><span data-stu-id="07f0a-138">If it is omitted, Excel constructs basic descriptions from  _pxTypeText_.</span></span>
  
<span data-ttu-id="07f0a-139">_pxMacroType_ **(xltypeNum** или **xltypeInt)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-139">_pxMacroType_ (**xltypeNum** or **xltypeInt**)</span></span>
  
<span data-ttu-id="07f0a-140">Необязательный аргумент, который указывает тип точки входа XLL.</span><span class="sxs-lookup"><span data-stu-id="07f0a-140">An optional argument that indicates the type of XLL entry point.</span></span> <span data-ttu-id="07f0a-141">Значение по умолчанию, если оно опущено, составляет 1.</span><span class="sxs-lookup"><span data-stu-id="07f0a-141">The default value, if it is omitted, is 1.</span></span>
  
|||||
|:-----|:-----|:-----|:-----|
| <span data-ttu-id="07f0a-142">_значение pxMacroType_</span><span class="sxs-lookup"><span data-stu-id="07f0a-142">_pxMacroType value_</span></span> <br/> |<span data-ttu-id="07f0a-143">0</span><span class="sxs-lookup"><span data-stu-id="07f0a-143">0</span></span>  <br/> |<span data-ttu-id="07f0a-144">1</span><span class="sxs-lookup"><span data-stu-id="07f0a-144">1</span></span>  <br/> |<span data-ttu-id="07f0a-145">2</span><span class="sxs-lookup"><span data-stu-id="07f0a-145">2</span></span>  <br/> |
|<span data-ttu-id="07f0a-146">Может быть вызвано из таблицы</span><span class="sxs-lookup"><span data-stu-id="07f0a-146">Can be called from a worksheet</span></span>  <br/> |<span data-ttu-id="07f0a-147">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-147">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-148">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-148">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-149">Нет</span><span class="sxs-lookup"><span data-stu-id="07f0a-149">No</span></span>  <br/> |
|<span data-ttu-id="07f0a-150">Может быть вызвано из листа макроса</span><span class="sxs-lookup"><span data-stu-id="07f0a-150">Can be called from a macro sheet</span></span>  <br/> |<span data-ttu-id="07f0a-151">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-151">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-152">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-152">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-153">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-153">Yes</span></span>  <br/> |
|<span data-ttu-id="07f0a-154">Может быть вызвано из определенного определения имени</span><span class="sxs-lookup"><span data-stu-id="07f0a-154">Can be called from a defined name definition</span></span>  <br/> |<span data-ttu-id="07f0a-155">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-155">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-156">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-156">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-157">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-157">Yes</span></span>  <br/> |
|<span data-ttu-id="07f0a-158">Может быть вызвано из условного выражения формата</span><span class="sxs-lookup"><span data-stu-id="07f0a-158">Can be called from a conditional format expression</span></span>  <br/> |<span data-ttu-id="07f0a-159">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-159">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-160">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-160">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-161">Нет</span><span class="sxs-lookup"><span data-stu-id="07f0a-161">No</span></span>  <br/> |
|<span data-ttu-id="07f0a-162">Указанный в мастере функций для функций лист</span><span class="sxs-lookup"><span data-stu-id="07f0a-162">Listed in the Function Wizard for worksheet functions</span></span>  <br/> |<span data-ttu-id="07f0a-163">Нет</span><span class="sxs-lookup"><span data-stu-id="07f0a-163">No</span></span>  <br/> |<span data-ttu-id="07f0a-164">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-164">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-165">Нет</span><span class="sxs-lookup"><span data-stu-id="07f0a-165">No</span></span>  <br/> |
|<span data-ttu-id="07f0a-166">Перечисленный в мастере функций для функций макрос листа</span><span class="sxs-lookup"><span data-stu-id="07f0a-166">Listed in the Function Wizard for macro sheet functions</span></span>  <br/> |<span data-ttu-id="07f0a-167">Нет</span><span class="sxs-lookup"><span data-stu-id="07f0a-167">No</span></span>  <br/> |<span data-ttu-id="07f0a-168">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-168">Yes</span></span>  <br/> |<span data-ttu-id="07f0a-169">Да</span><span class="sxs-lookup"><span data-stu-id="07f0a-169">Yes</span></span>  <br/> |
   
<span data-ttu-id="07f0a-170">На практике следует использовать 1 для функций листа, 1 — для эквивалентных функций макроса (зарегистрированных как тип), которые необходимо вызвать из листа, и 2 — для **#** команд.</span><span class="sxs-lookup"><span data-stu-id="07f0a-170">In practice, you should use 1 for worksheet functions, 1 for macro sheet equivalent functions (registered as type **#**) that you want to call from the worksheet, and 2 for commands.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="07f0a-171">Команды XLL скрыты и не отображаются в диалоговом окну для запуска макрос, хотя их имена можно входить везде, где требуется допустимый командный имени.</span><span class="sxs-lookup"><span data-stu-id="07f0a-171">XLL commands are hidden and not displayed in dialog boxes for running macros, although their names can be entered anywhere a valid command name is required.</span></span> 
  
<span data-ttu-id="07f0a-172">_pxCategory_ **(xltypeStr** или **xltypeNum)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-172">_pxCategory_ (**xltypeStr** or **xltypeNum**)</span></span>
  
<span data-ttu-id="07f0a-173">Необязательный аргумент, позволяющий указать, к какой категории должна принадлежать новая функция или команда.</span><span class="sxs-lookup"><span data-stu-id="07f0a-173">An optional argument that enables you to specify which category that the new function or command should belong to.</span></span> <span data-ttu-id="07f0a-174">Мастер функций делит функции по типу (категории).</span><span class="sxs-lookup"><span data-stu-id="07f0a-174">The Function Wizard divides functions by type (category).</span></span> <span data-ttu-id="07f0a-175">Можно указать имя категории или последовательное число, где номер — это положение, в котором категория отображается в мастере функций.</span><span class="sxs-lookup"><span data-stu-id="07f0a-175">You can specify a category name or a sequential number, where the number is the position in which the category appears in the Function Wizard.</span></span> <span data-ttu-id="07f0a-176">Дополнительные сведения см. в разделе "Имена категорий".</span><span class="sxs-lookup"><span data-stu-id="07f0a-176">For more information, see the "Category Names" section.</span></span> <span data-ttu-id="07f0a-177">Если он опущен, предполагается категория User Defined.</span><span class="sxs-lookup"><span data-stu-id="07f0a-177">If it is omitted, the User Defined category is assumed.</span></span>
  
<span data-ttu-id="07f0a-178">_pxShortcutText_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-178">_pxShortcutText_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-179">Однояховая строка, которая указывает клавишу управления, назначенную этой команде.</span><span class="sxs-lookup"><span data-stu-id="07f0a-179">A one-character, case-sensitive string that specifies the control key assigned to this command.</span></span> <span data-ttu-id="07f0a-180">Например, "A" назначает эту команду диспетчеру CONTROL+SHIFT+A.</span><span class="sxs-lookup"><span data-stu-id="07f0a-180">For example, "A" assigns this command to CONTROL+SHIFT+A.</span></span> <span data-ttu-id="07f0a-181">Этот аргумент необязателен и используется только для команд.</span><span class="sxs-lookup"><span data-stu-id="07f0a-181">This argument is optional and is used for commands only.</span></span>
  
<span data-ttu-id="07f0a-182">_pxHelpTopic_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-182">_pxHelpTopic_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-183">Необязательная ссылка на файл справки (.chm или .hlp), отображаемый при нажатии кнопки справки (при отображите настраиваемую функцию).</span><span class="sxs-lookup"><span data-stu-id="07f0a-183">An optional reference to the Help file (.chm or .hlp) to display when the user clicks the Help button (when your custom function is displayed).</span></span> <span data-ttu-id="07f0a-184">Может быть в форме  `filepath!HelpContextID` или  `https://address/path_to_file_in_site!0` .</span><span class="sxs-lookup"><span data-stu-id="07f0a-184">Can be in the form  `filepath!HelpContextID` or  `https://address/path_to_file_in_site!0`.</span></span> <span data-ttu-id="07f0a-185">Обе части до и после "!" необходимы.</span><span class="sxs-lookup"><span data-stu-id="07f0a-185">Both parts before and after the "!" are required.</span></span>  <span data-ttu-id="07f0a-186">*HelpContextID* не должен содержать одиночных кавычках и будет преобразован Excel в неподписаную 4-бетовую длину в десятичной форме.</span><span class="sxs-lookup"><span data-stu-id="07f0a-186">*HelpContextID*  must not contain single quotes, and will be converted by Excel to an unsigned integer 4 bytes long, in decimal form.</span></span> <span data-ttu-id="07f0a-187">При использовании формы URL-адреса Excel только ссылаясь на файл справки.</span><span class="sxs-lookup"><span data-stu-id="07f0a-187">When using the URL form, Excel opens only the referenced help file.</span></span> 
  
<span data-ttu-id="07f0a-188">_pxFunctionHelp_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-188">_pxFunctionHelp_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-189">Необязательная строка, описываемая настраиваемой функцией при выборе в мастере функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-189">An optional string that describes your custom function when it is selected in the Function Wizard.</span></span>
  
<span data-ttu-id="07f0a-190">_pxArgumentHelp1_ **(xltypeStr)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-190">_pxArgumentHelp1_ (**xltypeStr**)</span></span>
  
<span data-ttu-id="07f0a-191">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="07f0a-191">Optional.</span></span> <span data-ttu-id="07f0a-192">Первая строка, описываемая настраиваемые аргументы функции при выборе функции в мастере функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-192">The first of the strings that describe the custom arguments of the function when the function is selected in the Function Wizard.</span></span> <span data-ttu-id="07f0a-193">В Excel 2003 г. и ранее **xlfRegister** может принять не более 30 аргументов, чтобы вы могли предоставить эту помощь только для первых 20 аргументов функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-193">In Excel 2003 and earlier, **xlfRegister** can take, at most, 30 arguments so that you can provide this help for the first 20 of your function arguments only.</span></span> <span data-ttu-id="07f0a-194">Начиная с Excel 2007 г., **xlfRegister** может принимать до 255 аргументов, чтобы вы могли предоставить эту помощь для 245 параметров функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-194">Starting in Excel 2007, **xlfRegister** can take up to 255 arguments so that you can provide this help for up to 245 function parameters.</span></span> 
  
## <a name="property-valuereturn-value"></a><span data-ttu-id="07f0a-195">Значение свойства и возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="07f0a-195">Property value/Return value</span></span>

<span data-ttu-id="07f0a-196">Если регистрация прошла успешно, эта функция возвращает регистрационный номер функции **(xltypeNum),** который можно использовать в вызовах **xlUDF** и **xlfUnregister** в DLL или с **CALL** и **UNREGISTER** в макрослете XLM.</span><span class="sxs-lookup"><span data-stu-id="07f0a-196">If registration was successful, this function returns the register ID of the function (**xltypeNum**), which can be used in calls to **xlUDF** and **xlfUnregister** in a DLL, or with **CALL** and **UNREGISTER** in an XLM macro sheet.</span></span> <span data-ttu-id="07f0a-197">В противном случае возвращается #VALUE!</span><span class="sxs-lookup"><span data-stu-id="07f0a-197">Otherwise, it returns a #VALUE!</span></span> <span data-ttu-id="07f0a-198">ошибка.</span><span class="sxs-lookup"><span data-stu-id="07f0a-198">error.</span></span> 
  
## <a name="remarks"></a><span data-ttu-id="07f0a-199">Примечания</span><span class="sxs-lookup"><span data-stu-id="07f0a-199">Remarks</span></span>

### <a name="data-types"></a><span data-ttu-id="07f0a-200">Типы данных</span><span class="sxs-lookup"><span data-stu-id="07f0a-200">Data types</span></span>

<span data-ttu-id="07f0a-201">Аргумент  _pxTypeText_ указывает тип данных возвращаемого значения и типы данных всех аргументов для функции DLL или ресурса кода.</span><span class="sxs-lookup"><span data-stu-id="07f0a-201">The  _pxTypeText_ argument specifies the data type of the return value and the data types of all arguments to the DLL function or code resource.</span></span> <span data-ttu-id="07f0a-202">Первый символ  _pxTypeText_ указывает тип данных возвращаемого значения.</span><span class="sxs-lookup"><span data-stu-id="07f0a-202">The first character of  _pxTypeText_ specifies the data type of the return value.</span></span> <span data-ttu-id="07f0a-203">Остальные символы указывают типы данных всех аргументов.</span><span class="sxs-lookup"><span data-stu-id="07f0a-203">The remaining characters indicate the data types of all the arguments.</span></span> <span data-ttu-id="07f0a-204">Например, для функции DLL, которая возвращает номер с плавающей точкой и принимает целый ряд и номер плавающей точки в качестве аргументов, потребуется "BIB" для аргумента _pxTypeText._</span><span class="sxs-lookup"><span data-stu-id="07f0a-204">For example, a DLL function that returns a floating-point number and takes an integer and a floating-point number as arguments would require "BIB" for the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="07f0a-205">Типы и структуры данных, используемые Excel для обмена данными с XLLs, суммируются в следующих двух таблицах.</span><span class="sxs-lookup"><span data-stu-id="07f0a-205">The data types and structures used by Excel to exchange data with XLLs are summarized in the following two tables.</span></span>
  
<span data-ttu-id="07f0a-206">В первой таблице перечислены типы, поддерживаемые во всех Excel.</span><span class="sxs-lookup"><span data-stu-id="07f0a-206">The first table lists the types supported in all versions of Excel.</span></span>
  
|<span data-ttu-id="07f0a-207">**��� ������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-207">**Data type**</span></span>|<span data-ttu-id="07f0a-208">**������������ �� ��������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-208">**Pass by value**</span></span>|<span data-ttu-id="07f0a-209">**������������ �� ������ (���������)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-209">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="07f0a-210">**�����������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-210">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="07f0a-211">Boolean</span><span class="sxs-lookup"><span data-stu-id="07f0a-211">Boolean</span></span>  <br/> |<span data-ttu-id="07f0a-212">A</span><span class="sxs-lookup"><span data-stu-id="07f0a-212">A</span></span>  <br/> |<span data-ttu-id="07f0a-213">L</span><span class="sxs-lookup"><span data-stu-id="07f0a-213">L</span></span>  <br/> |<span data-ttu-id="07f0a-214">короткий [int] (0=false или 1=true)</span><span class="sxs-lookup"><span data-stu-id="07f0a-214">short [int] (0=false or 1=true)</span></span>  <br/> |
|<span data-ttu-id="07f0a-215">double</span><span class="sxs-lookup"><span data-stu-id="07f0a-215">double</span></span>  <br/> |<span data-ttu-id="07f0a-216">B</span><span class="sxs-lookup"><span data-stu-id="07f0a-216">B</span></span>  <br/> |<span data-ttu-id="07f0a-217">E</span><span class="sxs-lookup"><span data-stu-id="07f0a-217">E</span></span>  <br/> ||
|<span data-ttu-id="07f0a-218">char \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-218">char \*</span></span>  <br/> ||<span data-ttu-id="07f0a-219">C, F</span><span class="sxs-lookup"><span data-stu-id="07f0a-219">C, F</span></span>  <br/> |<span data-ttu-id="07f0a-220">Строка байтов ASCII, оканчивающаяся нулем</span><span class="sxs-lookup"><span data-stu-id="07f0a-220">Null-terminated ASCII byte string</span></span>  <br/> |
|<span data-ttu-id="07f0a-221">unsigned char \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-221">unsigned char \*</span></span>  <br/> ||<span data-ttu-id="07f0a-222">D, G</span><span class="sxs-lookup"><span data-stu-id="07f0a-222">D, G</span></span>  <br/> |<span data-ttu-id="07f0a-223">Строка byte с подсчетом ASCII</span><span class="sxs-lookup"><span data-stu-id="07f0a-223">Counted ASCII byte string</span></span>  <br/> |
|<span data-ttu-id="07f0a-224">unsigned short [int]</span><span class="sxs-lookup"><span data-stu-id="07f0a-224">unsigned short [int]</span></span>  <br/> |<span data-ttu-id="07f0a-225">H</span><span class="sxs-lookup"><span data-stu-id="07f0a-225">H</span></span>  <br/> ||<span data-ttu-id="07f0a-226">16-битная WORD</span><span class="sxs-lookup"><span data-stu-id="07f0a-226">16-bit WORD</span></span>  <br/> |
|<span data-ttu-id="07f0a-227">[signed] short [int]</span><span class="sxs-lookup"><span data-stu-id="07f0a-227">[signed] short [int]</span></span>  <br/> |<span data-ttu-id="07f0a-228">I</span><span class="sxs-lookup"><span data-stu-id="07f0a-228">I</span></span>  <br/> |<span data-ttu-id="07f0a-229">M</span><span class="sxs-lookup"><span data-stu-id="07f0a-229">M</span></span>  <br/> |<span data-ttu-id="07f0a-230">16-bit signed integer</span><span class="sxs-lookup"><span data-stu-id="07f0a-230">16-bit signed integer</span></span>  <br/> |
|<span data-ttu-id="07f0a-231">[signed long] int</span><span class="sxs-lookup"><span data-stu-id="07f0a-231">[signed long] int</span></span>  <br/> |<span data-ttu-id="07f0a-232">J</span><span class="sxs-lookup"><span data-stu-id="07f0a-232">J</span></span>  <br/> |<span data-ttu-id="07f0a-233">N</span><span class="sxs-lookup"><span data-stu-id="07f0a-233">N</span></span>  <br/> |<span data-ttu-id="07f0a-234">32-bit signed integer</span><span class="sxs-lookup"><span data-stu-id="07f0a-234">32-bit signed integer</span></span>  <br/> |
|<span data-ttu-id="07f0a-235">FP</span><span class="sxs-lookup"><span data-stu-id="07f0a-235">FP</span></span>  <br/> ||<span data-ttu-id="07f0a-236">K</span><span class="sxs-lookup"><span data-stu-id="07f0a-236">K</span></span>  <br/> |<span data-ttu-id="07f0a-237">Структура массива с плавающей запятой</span><span class="sxs-lookup"><span data-stu-id="07f0a-237">Floating-point array structure</span></span>  <br/> |
|<span data-ttu-id="07f0a-238">Array</span><span class="sxs-lookup"><span data-stu-id="07f0a-238">Array</span></span>  <br/> ||<span data-ttu-id="07f0a-239">O</span><span class="sxs-lookup"><span data-stu-id="07f0a-239">O</span></span>  <br/> |<span data-ttu-id="07f0a-240">Передаются три аргумента:</span><span class="sxs-lookup"><span data-stu-id="07f0a-240">Three arguments are passed:</span></span><br/><span data-ttu-id="07f0a-241">- неподписаный короткий int \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-241">- unsigned short int \*</span></span><br/><span data-ttu-id="07f0a-242">- неподписаный короткий int \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-242">- unsigned short int \*</span></span><br/><span data-ttu-id="07f0a-243">- дважды []</span><span class="sxs-lookup"><span data-stu-id="07f0a-243">- double []</span></span>  <br/> |
|<span data-ttu-id="07f0a-244">XLOPER</span><span class="sxs-lookup"><span data-stu-id="07f0a-244">XLOPER</span></span>  <br/> ||<span data-ttu-id="07f0a-245">P</span><span class="sxs-lookup"><span data-stu-id="07f0a-245">P</span></span>  <br/> |<span data-ttu-id="07f0a-246">Значения и массивы листа в виде переменной</span><span class="sxs-lookup"><span data-stu-id="07f0a-246">Variable-type worksheet values and arrays</span></span>  <br/> |
|||<span data-ttu-id="07f0a-247">R</span><span class="sxs-lookup"><span data-stu-id="07f0a-247">R</span></span>  <br/> |<span data-ttu-id="07f0a-248">Значения, массивы и ссылки на диапазон</span><span class="sxs-lookup"><span data-stu-id="07f0a-248">Values, arrays, and range references</span></span>  <br/> |
   
<span data-ttu-id="07f0a-249">В Excel 2007 г. для поддержки больших сеток и длинных строк Единого кода были введены следующие типы данных.</span><span class="sxs-lookup"><span data-stu-id="07f0a-249">In Excel 2007 the following data types were introduced to support the larger grids and long Unicode strings.</span></span>
  
|<span data-ttu-id="07f0a-250">**��� ������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-250">**Data type**</span></span>|<span data-ttu-id="07f0a-251">**������������ �� ��������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-251">**Pass by value**</span></span>|<span data-ttu-id="07f0a-252">**������������ �� ������ (���������)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-252">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="07f0a-253">**�����������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-253">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="07f0a-254">неподписаный короткий \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-254">unsigned short \*</span></span>  <br/> ||<span data-ttu-id="07f0a-255">C%, F%</span><span class="sxs-lookup"><span data-stu-id="07f0a-255">C%, F%</span></span>  <br/> |<span data-ttu-id="07f0a-256">Null-terminated Unicode wide-character string</span><span class="sxs-lookup"><span data-stu-id="07f0a-256">Null-terminated Unicode wide-character string</span></span>  <br/> |
|<span data-ttu-id="07f0a-257">неподписаный короткий \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-257">unsigned short \*</span></span>  <br/> ||<span data-ttu-id="07f0a-258">D%, G%</span><span class="sxs-lookup"><span data-stu-id="07f0a-258">D%, G%</span></span>  <br/> |<span data-ttu-id="07f0a-259">Строка с широкими символами Единого кода</span><span class="sxs-lookup"><span data-stu-id="07f0a-259">Counted Unicode wide-character string</span></span>  <br/> |
|<span data-ttu-id="07f0a-260">FP12</span><span class="sxs-lookup"><span data-stu-id="07f0a-260">FP12</span></span>  <br/> ||<span data-ttu-id="07f0a-261">K%</span><span class="sxs-lookup"><span data-stu-id="07f0a-261">K%</span></span>  <br/> |<span data-ttu-id="07f0a-262">Структура массива с плавающей точкой большого размера сетки</span><span class="sxs-lookup"><span data-stu-id="07f0a-262">Larger grid floating-point array structure</span></span>  <br/> |
|<span data-ttu-id="07f0a-263">Массив</span><span class="sxs-lookup"><span data-stu-id="07f0a-263">Array</span></span>  <br/> ||<span data-ttu-id="07f0a-264">O%</span><span class="sxs-lookup"><span data-stu-id="07f0a-264">O%</span></span>  <br/> |<span data-ttu-id="07f0a-265">Передаются три аргумента:</span><span class="sxs-lookup"><span data-stu-id="07f0a-265">Three arguments are passed:</span></span><br/><span data-ttu-id="07f0a-266">- подписанный int \* / RW \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-266">- signed int \* / RW \*</span></span><br/><span data-ttu-id="07f0a-267">- подписанный int \* / COL \*</span><span class="sxs-lookup"><span data-stu-id="07f0a-267">- signed int \* / COL \*</span></span><br/><span data-ttu-id="07f0a-268">- дважды []</span><span class="sxs-lookup"><span data-stu-id="07f0a-268">- double []</span></span>  <br/> |
|<span data-ttu-id="07f0a-269">XLOPER12</span><span class="sxs-lookup"><span data-stu-id="07f0a-269">XLOPER12</span></span>  <br/> ||<span data-ttu-id="07f0a-270">Q</span><span class="sxs-lookup"><span data-stu-id="07f0a-270">Q</span></span>  <br/> |<span data-ttu-id="07f0a-271">Значения и массивы листа в виде переменной</span><span class="sxs-lookup"><span data-stu-id="07f0a-271">Variable-type worksheet values and arrays</span></span>  <br/> |
|||<span data-ttu-id="07f0a-272">U</span><span class="sxs-lookup"><span data-stu-id="07f0a-272">U</span></span>  <br/> |<span data-ttu-id="07f0a-273">Значения, массивы и ссылки на диапазон</span><span class="sxs-lookup"><span data-stu-id="07f0a-273">Values, arrays, and range references</span></span>  <br/> |
   
<span data-ttu-id="07f0a-274">Начиная с Excel 2010 г. были введены следующие типы данных:</span><span class="sxs-lookup"><span data-stu-id="07f0a-274">Starting in Excel 2010 the following data types were introduced:</span></span>
  
|<span data-ttu-id="07f0a-275">**Тип данных**</span><span class="sxs-lookup"><span data-stu-id="07f0a-275">**Data Type**</span></span>|<span data-ttu-id="07f0a-276">**������������ �� ��������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-276">**Pass by value**</span></span>|<span data-ttu-id="07f0a-277">**������������ �� ������ (���������)**</span><span class="sxs-lookup"><span data-stu-id="07f0a-277">**Pass by ref (pointer)**</span></span>|<span data-ttu-id="07f0a-278">**�����������**</span><span class="sxs-lookup"><span data-stu-id="07f0a-278">**Comments**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="07f0a-279">XLOPER12</span><span class="sxs-lookup"><span data-stu-id="07f0a-279">XLOPER12</span></span>  <br/> ||<span data-ttu-id="07f0a-280">X</span><span class="sxs-lookup"><span data-stu-id="07f0a-280">X</span></span>  <br/> |<span data-ttu-id="07f0a-281">Асинхронная ручка используется для отслеживания ожидаемого вызова асинхронной функции Excel и XLL.Существование типа параметра в строке типа также обозначает функцию асинхронной. Дополнительные сведения об асинхронных функциях см. в [User-Defined.](asynchronous-user-defined-functions.md)</span><span class="sxs-lookup"><span data-stu-id="07f0a-281">The asynchronous handle is used to track a pending asynchronous function call by Excel and the XLL.The existence of the parameter type in the type string also designates the function as asynchronous.For more information about asynchronous functions, see [Asynchronous User-Defined Functions](asynchronous-user-defined-functions.md).</span></span>  <br/> |
   
<span data-ttu-id="07f0a-282">���� ����� **F**, **F%**, **G** � **G%** ������������ ��� ����������, ���������� �� �����.</span><span class="sxs-lookup"><span data-stu-id="07f0a-282">The string types **F**, **F%**, **G**, and **G%** are used for arguments that are modified-in-place.</span></span> 
  
<span data-ttu-id="07f0a-283">При работе с типами данных, отображаемой в предыдущей таблице, следует помнить следующее:</span><span class="sxs-lookup"><span data-stu-id="07f0a-283">When working with the data types displayed in the previous table, be aware of the following:</span></span>
  
- <span data-ttu-id="07f0a-284">В C-language declarations предполагается, что компилятор использует 8-byte doubles, 2-byte short inte inte и 4-byte long intes byte long inte byte byte.</span><span class="sxs-lookup"><span data-stu-id="07f0a-284">The C-language declarations assume that your compiler uses 8-byte doubles, 2-byte short integers, and 4-byte long integers by default.</span></span>
    
- <span data-ttu-id="07f0a-285">Все функции в DLLs и ресурсах кода называются с помощью **__stdcall** вызовов.</span><span class="sxs-lookup"><span data-stu-id="07f0a-285">All functions in DLLs and code resources are called using the **__stdcall** calling convention.</span></span> 
    
- <span data-ttu-id="07f0a-286">Любая функция, возвращаемая типу данных по ссылке, то есть возвращая указатель на что-то, может безопасно возвращать указатель null.</span><span class="sxs-lookup"><span data-stu-id="07f0a-286">Any function that returns a data type by reference, that is, that returns a pointer to something, can safely return a null pointer.</span></span> <span data-ttu-id="07f0a-287">Excel интерпретирует указатель null как #NUM!</span><span class="sxs-lookup"><span data-stu-id="07f0a-287">Excel interprets a null pointer as a #NUM!</span></span> <span data-ttu-id="07f0a-288">ошибка.</span><span class="sxs-lookup"><span data-stu-id="07f0a-288">error.</span></span>
    
## <a name="additional-data-type-information"></a><span data-ttu-id="07f0a-289">Дополнительные сведения о типе данных</span><span class="sxs-lookup"><span data-stu-id="07f0a-289">Additional data type information</span></span>

<span data-ttu-id="07f0a-290">В этом разделе содержатся подробные сведения о типах данных **E,** **F,** **F%**, **G**, **G%,** **K,** **O,** **P,** **Q,** **R** и **U,** а также другие сведения о _аргументе pxTypeText._</span><span class="sxs-lookup"><span data-stu-id="07f0a-290">This section contains detailed information about the **E**, **F**, **F%**, **G**, **G%**, **K**, **O**, **P**, **Q**, **R**, and **U** data types, and other information about the _pxTypeText_ argument.</span></span> 
  
### <a name="e-data-type"></a><span data-ttu-id="07f0a-291">Тип данных E</span><span class="sxs-lookup"><span data-stu-id="07f0a-291">E data type</span></span>

<span data-ttu-id="07f0a-292">Excel ожидает, что DLL, использующий тип данных E, передает указатели на номера с плавающей точкой в стеке.</span><span class="sxs-lookup"><span data-stu-id="07f0a-292">Excel expects a DLL using the E data type to pass pointers to floating-point numbers on the stack.</span></span> <span data-ttu-id="07f0a-293">Это может привести к проблемам с некоторыми языками (например, Borland C++), которые ожидают, что номер будет передан в стек эмулятора coprocessor.</span><span class="sxs-lookup"><span data-stu-id="07f0a-293">This can cause problems with some languages (for example, Borland C++) that expect the number to be passed on the coprocessor emulator stack.</span></span> <span data-ttu-id="07f0a-294">Обходное решение — передать указатель на номер в стеке coprocessor.</span><span class="sxs-lookup"><span data-stu-id="07f0a-294">The workaround is to pass a pointer to the number on the coprocessor stack.</span></span> <span data-ttu-id="07f0a-295">В следующем примере показано, как вернуть дубль из Borland C++.</span><span class="sxs-lookup"><span data-stu-id="07f0a-295">The following example shows how to return a double from Borland C++.</span></span>
  
```cpp
typedef double * lpDbl;
extern "C" lpDbl __stdcall AddDbl(double D1,
    double D2, WORD npDbl)
{
    lpDbl Result;
    Result = (lpDbl)MK_FP(_SS, npDbl);
    *Result = D1 + D2;
    return (Result);
}
```

### <a name="f-f-g-and-g-data-types"></a><span data-ttu-id="07f0a-296">Типы данных F, F%, G и G%</span><span class="sxs-lookup"><span data-stu-id="07f0a-296">F, F%, G, and G% data types</span></span>

<span data-ttu-id="07f0a-297">С **типами данных F,** **F%,** **G** и **G%** функция может изменять буфер строки, выделенный Excel.</span><span class="sxs-lookup"><span data-stu-id="07f0a-297">With the **F**, **F%**, **G**, and **G%** data types, a function can modify a string buffer that is allocated by Excel.</span></span> <span data-ttu-id="07f0a-298">Если код типа возвращаемого значения является одним из этих типов, Excel игнорирует возвращаемую функцией значение.</span><span class="sxs-lookup"><span data-stu-id="07f0a-298">If the return value type code is one of these types, Excel ignores the value returned by the function.</span></span> <span data-ttu-id="07f0a-299">Вместо этого Excel список аргументов функций для первого соответствующего типа данных **(F,** **F%**, **G** или **G%),** а затем принимает текущее содержимое выделенного буфера строки в качестве возвращаемого значения.</span><span class="sxs-lookup"><span data-stu-id="07f0a-299">Instead, Excel searches the list of function arguments for the first corresponding data type (**F**, **F%**, **G**, or **G%**) and then takes the current contents of the allocated string buffer as the return value.</span></span> <span data-ttu-id="07f0a-300">Все версии Excel выделяют 256 bytes для строк **F** и **G** ASCII, а начиная с Excel 2007 г. выделяется 65 536 битов, что достаточно для 32 768 символов Unicode для строк Юникод **F%** и **G%** .</span><span class="sxs-lookup"><span data-stu-id="07f0a-300">All versions of Excel allocate 256 bytes for **F** and **G** ASCII strings, and starting in Excel 2007 65,536 bytes are allocated, enough for 32,768 Unicode characters, for **F%** and **G%** Unicode strings.</span></span> <span data-ttu-id="07f0a-301">Помните, что буферы должны включать символ графа (типы **G** и **G%)** или null-termination (типы **F** и **F%),** чтобы фактическая максимальная длина строки была 255 и 32 767.</span><span class="sxs-lookup"><span data-stu-id="07f0a-301">Remember that the buffers must include a count character (types **G** and **G%**) or a null-termination character (types **F** and **F%**), so that the actual maximum string lengths are 255 and 32,767.</span></span> <span data-ttu-id="07f0a-302">Строки Юникод и, следовательно, аргументы **типа F%** и **G%** доступны только через API C в Excel.</span><span class="sxs-lookup"><span data-stu-id="07f0a-302">Unicode strings, and therefore type **F%** and **G%** arguments, are available only through the C API in Excel.</span></span> 
  
### <a name="k-and-k-data-types"></a><span data-ttu-id="07f0a-303">Типы данных K и K%</span><span class="sxs-lookup"><span data-stu-id="07f0a-303">K and K% data types</span></span>

<span data-ttu-id="07f0a-304">Типы **данных K** и **K%** используют указатели для структур FP и FP12 размеров переменной соответственно.</span><span class="sxs-lookup"><span data-stu-id="07f0a-304">The **K** and **K%** data types use pointers to the variable-sized FP and FP12 structures respectively.</span></span> <span data-ttu-id="07f0a-305">Эти структуры определены в XLLCALL.H.</span><span class="sxs-lookup"><span data-stu-id="07f0a-305">These structures are defined in XLLCALL.H.</span></span> <span data-ttu-id="07f0a-306">Структуры FP12 и, следовательно, аргументы **типа K%** поддерживаются только с Excel 2007 г.</span><span class="sxs-lookup"><span data-stu-id="07f0a-306">FP12 structures, and therefore type **K%** arguments, are only supported starting in Excel 2007.</span></span> 
  
### <a name="o-and-o-data-types"></a><span data-ttu-id="07f0a-307">Типы данных O и O%</span><span class="sxs-lookup"><span data-stu-id="07f0a-307">O and O% data types</span></span>

<span data-ttu-id="07f0a-308">Типы **данных O** и **O%** можно использовать только для аргументов, а не для возвращающихся значений, хотя значения можно вернуть, изменяя аргумент типа **O** или **O%** на месте.</span><span class="sxs-lookup"><span data-stu-id="07f0a-308">The **O** and **O%** data types can only be used for arguments, not return values, although values can be returned my modifying an **O** or **O%** type argument in place.</span></span> <span data-ttu-id="07f0a-309">Каждый из них передает три пункта: указатель на количество строк в массиве, указатель на количество столбцов в массиве и указатель на двумерный массив номеров с плавающей точкой.</span><span class="sxs-lookup"><span data-stu-id="07f0a-309">Each passes three items: a pointer to the number of rows in an array, a pointer to the number of columns in an array, and a pointer to a two-dimensional array of floating-point numbers.</span></span> 
  
<span data-ttu-id="07f0a-310">Чтобы изменить массив, переданный типом данных O или O% на месте, в качестве аргумента  _pxTypeText_ можно использовать ">O" или ">O%".</span><span class="sxs-lookup"><span data-stu-id="07f0a-310">To modify an array passed by the O or O% data type in place, you could use ">O" or ">O%" as the  _pxTypeText_ argument.</span></span> <span data-ttu-id="07f0a-311">Дополнительные сведения об изменении массива см. в разделе "Изменение на месте: функции, объявленные недействительными".</span><span class="sxs-lookup"><span data-stu-id="07f0a-311">For more information about modifying an array, see the "Modifying in Place: Functions Declared as Void" section in this topic.</span></span> 
  
<span data-ttu-id="07f0a-312">Тип **данных O** был создан для прямой совместимости с DLLs Fortran, которые передают аргументы по ссылке.</span><span class="sxs-lookup"><span data-stu-id="07f0a-312">The **O** data type was created for direct compatibility with Fortran DLLs, which pass arguments by reference.</span></span> 
  
<span data-ttu-id="07f0a-313">**O%** поддерживается начиная с Excel 2007 г. и вмещает большее число строк, Excel поддерживается.</span><span class="sxs-lookup"><span data-stu-id="07f0a-313">The **O%** is supported starting in Excel 2007, and accommodates the larger number of rows that Excel supports.</span></span> 
  
### <a name="p-and-q-data-types"></a><span data-ttu-id="07f0a-314">Типы данных P и Q</span><span class="sxs-lookup"><span data-stu-id="07f0a-314">P and Q data types</span></span>

<span data-ttu-id="07f0a-315">Когда аргументы функции DLL регистрируются как принимая тип **P** XLOPERs или тип **Q** XLOPER12, Excel преобразует одноклеточные ссылки на простые значения и многоклеточные ссылки на массивы при подготовке этих аргументов.</span><span class="sxs-lookup"><span data-stu-id="07f0a-315">When DLL function arguments are registered as taking type **P** XLOPERs or type **Q** XLOPER12s, Excel converts single-cell references to simple values and multi-cell references to arrays when preparing these arguments.</span></span> <span data-ttu-id="07f0a-316">Другими словами, типы **P** и **Q** всегда будут поступать в функцию как один из этих типов: **xltypeNum**, **xltypeStr**, **xltypeBool**, **xltypeErr**, **xltypeMulti**, **xltypeMissing**, или **xltypeNil**, но не **xltypeRef** или **xltypeSRef,** поскольку они всегда dereferenced.</span><span class="sxs-lookup"><span data-stu-id="07f0a-316">In other words, **P** and **Q** types will always arrive in your function as one of these types: **xltypeNum**, **xltypeStr**, **xltypeBool**, **xltypeErr**, **xltypeMulti**, **xltypeMissing**, or **xltypeNil**, but not **xltypeRef** or **xltypeSRef** because these are always dereferenced.</span></span> <span data-ttu-id="07f0a-317">**Аргументы XLOPER12** и, следовательно, аргументы **типа Q** поддерживаются только с Excel 2007 г.</span><span class="sxs-lookup"><span data-stu-id="07f0a-317">**XLOPER12** s, and therefore type **Q** arguments, are only supported starting in Excel 2007.</span></span> 
  
<span data-ttu-id="07f0a-318">Если типы **xltypeMissing** или **xltypeNil** используются для возвращающихся значений, они интерпретируются Excel как числовая ноль.</span><span class="sxs-lookup"><span data-stu-id="07f0a-318">If types **xltypeMissing** or **xltypeNil** are used for return values, they are interpreted by Excel as numeric zero.</span></span> <span data-ttu-id="07f0a-319">**xltypeMissing** передается, когда вызывающий недопустит аргумент.</span><span class="sxs-lookup"><span data-stu-id="07f0a-319">**xltypeMissing** is passed when the caller omits an argument.</span></span> <span data-ttu-id="07f0a-320">**xltypeNil** передается, когда вызываемая передает ссылку на пустую ячейку.</span><span class="sxs-lookup"><span data-stu-id="07f0a-320">**xltypeNil** is passed when the caller passes a reference to an empty cell.</span></span> <span data-ttu-id="07f0a-321">Когда диапазон ячеек преобразуется в **xltypeMulti,** который передается как тип **P** или **Q,** все пустые ячейки в диапазоне преобразуются в **элементы массива xltypeNil.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-321">When a range of cells is converted to an **xltypeMulti** to be passed as type **P** or **Q**, any blank cells within the range are converted to **xltypeNil** array elements.</span></span> <span data-ttu-id="07f0a-322">Отсутствующие элементы в буквальном массиве также передаются в **качестве элементов xltypeNil.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-322">Missing elements in a literal array are similarly passed as **xltypeNil** elements.</span></span> 
  
### <a name="volatile-functions-and-recalculation"></a><span data-ttu-id="07f0a-323">Летучие функции и пересчет</span><span class="sxs-lookup"><span data-stu-id="07f0a-323">Volatile functions and recalculation</span></span>

<span data-ttu-id="07f0a-324">На таблице можно сделать функцию DLL или ресурс кода волатильной, чтобы она пересчитала каждый раз при пересчете таблицы.</span><span class="sxs-lookup"><span data-stu-id="07f0a-324">On a worksheet, you can make a DLL function or code resource volatile, so that it recalculates every time the worksheet recalculates.</span></span> <span data-ttu-id="07f0a-325">Для этого добавьте восклицательный знак (!) после последнего кода аргументов в _аргументе pxTypeText._</span><span class="sxs-lookup"><span data-stu-id="07f0a-325">To do this, add an exclamation mark (!) after the last argument code in the  _pxTypeText_ argument.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="07f0a-326">По умолчанию функции, которые принимают **тип R** XLOPERs или тип **U** XLOPER12 и регистрируются в качестве эквивалентов макросовых листов (тип, см. следующий раздел), обрабатываются как неустойчивые в **#** Excel.</span><span class="sxs-lookup"><span data-stu-id="07f0a-326">By default, functions that take type **R** XLOPERs or type **U** XLOPER12s and that are registered as macro sheet equivalents (type **#**; see next section) are handled as volatile in Excel.</span></span> 
  
### <a name="functions-declared-as-void"></a><span data-ttu-id="07f0a-327">Функции, объявленные недействительными</span><span class="sxs-lookup"><span data-stu-id="07f0a-327">Functions declared as void</span></span>

<span data-ttu-id="07f0a-328">Существует два случая, когда функция объявляется недействительной.</span><span class="sxs-lookup"><span data-stu-id="07f0a-328">There are two cases that call for declaring a function as returning void.</span></span> <span data-ttu-id="07f0a-329">В обоих случаях функция возвращает результат другими средствами.</span><span class="sxs-lookup"><span data-stu-id="07f0a-329">In both cases, the function returns its result by other means.</span></span>
  
#### <a name="modifying-in-place"></a><span data-ttu-id="07f0a-330">Изменение на месте</span><span class="sxs-lookup"><span data-stu-id="07f0a-330">Modifying in place</span></span>

<span data-ttu-id="07f0a-331">Для кода возвращаемого типа  _в_  _pxTypeText_ можно использовать одну цифру n, где  _n_ — это число от 1 до 9.</span><span class="sxs-lookup"><span data-stu-id="07f0a-331">You can use a single digit  _n_ for the return type code in  _pxTypeText_, where  _n_ is a number from 1 through 9.</span></span> <span data-ttu-id="07f0a-332">Это предписывает Excel значение переменной в расположении, на который указывает аргумент __n_th pxTypeText_ в качестве возвращаемого значения.</span><span class="sxs-lookup"><span data-stu-id="07f0a-332">This instructs Excel to take the value of the variable in the location pointed to by the  _n_th argument in  _pxTypeText_ as the return value.</span></span> <span data-ttu-id="07f0a-333">Это также называется изменением на месте.</span><span class="sxs-lookup"><span data-stu-id="07f0a-333">This is also known as modifying in place.</span></span> <span data-ttu-id="07f0a-334">Аргумент _n_th должен быть типом данных для передачи данных (C, D, E, F, F%, G, G%, K, K%, L, M, N, O, O%, P, Q, R или U).</span><span class="sxs-lookup"><span data-stu-id="07f0a-334">The  _n_th argument must be a pass-by-reference data type (C, D, E, F, F%, G, G%, K, K%, L, M, N, O, O%, P, Q, R, or U).</span></span> <span data-ttu-id="07f0a-335">Функция DLL или ресурс кода также  должны быть объявлены с пустым ключевым  словом на языках C/C++ (или ключевое слово процедуры на паскальском языке).</span><span class="sxs-lookup"><span data-stu-id="07f0a-335">The DLL function or code resource must also be declared with the **void** keyword in the C/C++ languages (or the **procedure** keyword in the Pascal language).</span></span> 
  
<span data-ttu-id="07f0a-336">Например, функция DLL, которая принимает строку с null-terminated и две указатели для integers, так как аргументы могут изменить строку на месте.</span><span class="sxs-lookup"><span data-stu-id="07f0a-336">For example, a DLL function that takes a null-terminated string and two pointers to integers as arguments can modify the string in place.</span></span> <span data-ttu-id="07f0a-337">Используйте "1FMM" в качестве  _аргумента pxTypeText_ и объявите функцию недействительной.</span><span class="sxs-lookup"><span data-stu-id="07f0a-337">Use "1FMM" as the  _pxTypeText_ argument, and declare the function as void.</span></span> 
  
<span data-ttu-id="07f0a-338">Предыдущие версии Excel, используемые в начале **\>** _pxTypeText,_ чтобы уликать, что функция была объявлена недействительной и что первый аргумент должен быть изменен на месте, не было способа изменить любой аргумент, кроме первого.</span><span class="sxs-lookup"><span data-stu-id="07f0a-338">Previous versions of Excel used **\>** at the start of  _pxTypeText_ to signify that the function was declared as void and that the first argument was to be modified in place—there was no way to modify any argument other than the first.</span></span> <span data-ttu-id="07f0a-339">Эквивалент n = 1 в текущих версиях Excel и это использование синхронных функций поддерживается только для обратной **\>**  **\>** совместимости.</span><span class="sxs-lookup"><span data-stu-id="07f0a-339">The **\>** is equivalent to  _n_ = 1 in current Excel versions and this use of **\>** in synchronous functions is supported for backward compatibility only.</span></span> 
  
#### <a name="asynchronous-functions"></a><span data-ttu-id="07f0a-340">Асинхронные функции</span><span class="sxs-lookup"><span data-stu-id="07f0a-340">Asynchronous functions</span></span>

<span data-ttu-id="07f0a-341">Асинхронная функция, обозначаемая с помощью параметра типа X в **pxTypeText,** не возвращает результат от начального вызова функции.</span><span class="sxs-lookup"><span data-stu-id="07f0a-341">An asynchronous function, denoted by using a parameter of type X in **pxTypeText**, does not return its result from the initial function call.</span></span> <span data-ttu-id="07f0a-342">Вместо этого необходимо объявить асинхронную функцию недействительной, а затем надстройка возвращает результат с помощью обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="07f0a-342">Instead, you must declare an asynchronous function as void and later the add-in returns the result through a callback.</span></span> <span data-ttu-id="07f0a-343">Асинхронная функция должна быть зарегистрирована с помощью в **\>** начале **pxTypeText.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-343">The asynchronous function must be registered by using **\>** at the start of **pxTypeText**.</span></span> <span data-ttu-id="07f0a-344">В асинхронных функциях указывается, что функция объявляется недействительной, но не указывает, что первый аргумент **\>** изменен на месте.</span><span class="sxs-lookup"><span data-stu-id="07f0a-344">In asynchronous functions, **\>** denotes that the function is declared as void, but does not indicate that the first argument is modified in place.</span></span> <span data-ttu-id="07f0a-345">Дополнительные сведения об асинхронных функциях см. в [User-Defined.](asynchronous-user-defined-functions.md)</span><span class="sxs-lookup"><span data-stu-id="07f0a-345">For more information about asynchronous functions, see [Asynchronous User-Defined Functions](asynchronous-user-defined-functions.md).</span></span> 

### <a name="registering-worksheet-functions-as-macro-sheet-equivalents-handling-uncalculated-cells"></a><span data-ttu-id="07f0a-346">Регистрация функций листа в качестве эквивалентов макрос листа (обработка нерасчетных ячеек)</span><span class="sxs-lookup"><span data-stu-id="07f0a-346">Registering worksheet functions as macro sheet equivalents (handling uncalculated cells)</span></span>

<span data-ttu-id="07f0a-347">Размещение **#** символа после последнего кода параметров  _в pxTypeText_ дает функции те же разрешения на вызов, что и функции на макросхеме.</span><span class="sxs-lookup"><span data-stu-id="07f0a-347">Placing a **#** character after the last parameter code in  _pxTypeText_ gives the function the same calling permissions as functions on a macro sheet.</span></span> <span data-ttu-id="07f0a-348">Эти данные следуют следующим образом:</span><span class="sxs-lookup"><span data-stu-id="07f0a-348">These are as follows:</span></span> 
  
- <span data-ttu-id="07f0a-349">Функция может получить значения ячеек, которые еще не были рассчитаны в этом цикле пересчета.</span><span class="sxs-lookup"><span data-stu-id="07f0a-349">The function can retrieve the values of cells that have not yet been calculated in this recalculation cycle.</span></span>
    
- <span data-ttu-id="07f0a-350">Функция может вызывать любые функции XLM-информации (класс 2), например **xlfGetCell.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-350">The function can call any of the XLM information (Class 2) functions, for example, **xlfGetCell**.</span></span>
    
- <span data-ttu-id="07f0a-351">Если знака номера (#) нет: оценка нерасчитаемой ячейки приводит к ошибке **xlretUncalced,** и текущая функция снова вызвана после вычисления ячейки; вызов любой функции XLM, кроме **xlfCaller,** приводит к ошибке **xlretInvXlfn.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-351">If the number sign (#) is not present: evaluating an uncalculated cell results in an **xlretUncalced** error, and the current function is called again once the cell has been calculated; calling any XLM information function other than **xlfCaller** results in an **xlretInvXlfn** error.</span></span> 
    
### <a name="registering-worksheet-functions-as-thread-safe"></a><span data-ttu-id="07f0a-352">Регистрация функций таблицы в качестве безопасной для потоков</span><span class="sxs-lookup"><span data-stu-id="07f0a-352">Registering worksheet functions as thread-safe</span></span>

<span data-ttu-id="07f0a-353">Начиная с Excel 2007 г. Excel могут выполнять многоуровневый пересчет книг.</span><span class="sxs-lookup"><span data-stu-id="07f0a-353">Starting in Excel 2007, Excel can perform multithreaded workbook recalculation.</span></span> <span data-ttu-id="07f0a-354">Это означает, что он может назначать различные экземпляры функции, безопасной для потоков, для одновременного переозначения потоков.</span><span class="sxs-lookup"><span data-stu-id="07f0a-354">This means that it can assign different instances of a thread-safe function to concurrent threads for reevaluation.</span></span> <span data-ttu-id="07f0a-355">Начиная с Excel 2007 г. большинство встроенных функций таблицы безопасны для потоков.</span><span class="sxs-lookup"><span data-stu-id="07f0a-355">Starting in Excel 2007, most of the built-in worksheet functions are thread-safe.</span></span> <span data-ttu-id="07f0a-356">Начиная с Excel 2007 г. Excel XLLs также позволяет регистрировать функции таблицы как безопасные потоки.</span><span class="sxs-lookup"><span data-stu-id="07f0a-356">Starting in Excel 2007, Excel also allows XLLs to register worksheet functions as thread-safe.</span></span> <span data-ttu-id="07f0a-357">Для этого включите **$** символ после последнего кода параметров _в pxTypeText._</span><span class="sxs-lookup"><span data-stu-id="07f0a-357">To do this, include a **$** character after the last parameter code in  _pxTypeText_.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="07f0a-358">Только функции таблицы можно объявлять безопасными для потоков.</span><span class="sxs-lookup"><span data-stu-id="07f0a-358">Only worksheet functions can be declared as thread-safe.</span></span> <span data-ttu-id="07f0a-359">Excel не считает функцию, эквивалентную макросам, безопасной для потока, так что нельзя примесить и символы к аргументу **#** **$** _pxTypeText._</span><span class="sxs-lookup"><span data-stu-id="07f0a-359">Excel does not consider a macro sheet equivalent function to be thread-safe, so that you cannot append both **#** and **$** characters to the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="07f0a-360">Если вы зарегистрировали функцию в качестве безопасной для потоков, необходимо убедиться, что она ведет себя безопасно, хотя Excel отклоняет любые небезопасные для потоков вызовы через API C.</span><span class="sxs-lookup"><span data-stu-id="07f0a-360">If you have registered a function as thread-safe, you must ensure that it behaves in a thread-safe way, although Excel rejects any thread-unsafe calls via the C API.</span></span> <span data-ttu-id="07f0a-361">Например, если функция, безопасная для потоков, пытается вызвать **xlfGetCell,** вызов не удается с **ошибкой xlretNotThreadSafe.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-361">For example, if a thread-safe function tries to call **xlfGetCell**, the call fails with the **xlretNotThreadSafe** error.</span></span> 
  
### <a name="registering-worksheet-functions-as-cluster-safe"></a><span data-ttu-id="07f0a-362">Регистрация функций таблицы в качестве безопасного кластера</span><span class="sxs-lookup"><span data-stu-id="07f0a-362">Registering worksheet functions as cluster-safe</span></span>

<span data-ttu-id="07f0a-363">Начиная с Excel 2010 г., Excel может разгрузить вызовы функций назначенного поставщика вычислительных кластеров.</span><span class="sxs-lookup"><span data-stu-id="07f0a-363">Starting in Excel 2010, Excel can offload function calls to a designated compute cluster provider.</span></span> <span data-ttu-id="07f0a-364">Дополнительные сведения см. в [Сейф Cluster.](cluster-safe-functions.md)</span><span class="sxs-lookup"><span data-stu-id="07f0a-364">For more information, see [Cluster Safe Functions](cluster-safe-functions.md).</span></span> <span data-ttu-id="07f0a-365">Все функции таблицы XLL, зарегистрированные как безопасные для кластера, принимают участие в разгрузке, если кластер доступен.</span><span class="sxs-lookup"><span data-stu-id="07f0a-365">Any XLL worksheet functions registered as cluster-safe take part in offloading if a cluster is available.</span></span> <span data-ttu-id="07f0a-366">Функции, безопасные для кластера, регистрируются путем включив символ после последнего кода **&amp;** параметров в _аргументе pxTypeText._</span><span class="sxs-lookup"><span data-stu-id="07f0a-366">Cluster-safe functions are registered by including the **&amp;** character after the last parameter code in the  _pxTypeText_ argument.</span></span> 
  
<span data-ttu-id="07f0a-367">Если вы зарегистрировали функцию в качестве безопасной для кластера, необходимо убедиться, что она ведет себя безопасно кластерно.</span><span class="sxs-lookup"><span data-stu-id="07f0a-367">If you have registered a function as cluster-safe, you must ensure that it behaves in a cluster-safe way.</span></span> <span data-ttu-id="07f0a-368">Дополнительные сведения см. в [Сейф Cluster.](cluster-safe-functions.md)</span><span class="sxs-lookup"><span data-stu-id="07f0a-368">For more information, see [Cluster Safe Functions](cluster-safe-functions.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="07f0a-369">Только функции таблицы можно объявлять кластерными.</span><span class="sxs-lookup"><span data-stu-id="07f0a-369">Only worksheet functions can be declared as cluster-safe.</span></span> <span data-ttu-id="07f0a-370">Excel не считает функцию, эквивалентную макрос листам, безопасной для кластера, так что к аргументу **#** **&amp;** _pxTypeText_ нельзя примесить как символы, так и символы.</span><span class="sxs-lookup"><span data-stu-id="07f0a-370">Excel does not consider a macro sheet equivalent function to be cluster-safe, so that you cannot append both **#** and **&amp;** characters to the  _pxTypeText_ argument.</span></span> <span data-ttu-id="07f0a-371">Функции таблицы можно объявлять как кластеробезопасные, так и нитки.</span><span class="sxs-lookup"><span data-stu-id="07f0a-371">Worksheet functions can be declared as both cluster-safe and thread-safe.</span></span> <span data-ttu-id="07f0a-372">В этом случае Excel эти функции будут принимать участие в многопрофиленном пересчете при отключении отгрузки кластера.</span><span class="sxs-lookup"><span data-stu-id="07f0a-372">In this case, Excel will allow these functions to take part in multithreaded recalculation when cluster offloading is disabled.</span></span> 
  
### <a name="category-names"></a><span data-ttu-id="07f0a-373">Имена категорий</span><span class="sxs-lookup"><span data-stu-id="07f0a-373">Category names</span></span>

<span data-ttu-id="07f0a-374">Чтобы определить, в какую категорию помещались функции XLL, используйте следующие рекомендации.</span><span class="sxs-lookup"><span data-stu-id="07f0a-374">Use the following guidelines to determine which category to put your XLL functions in.</span></span>
  
- <span data-ttu-id="07f0a-375">Если функция делает что-то, что может быть сделано пользователем в составе пользовательского интерфейса надстройки, следует поместить функцию в категорию **Команд.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-375">If the function does something that could be done by the user as a part of your add-in user interface, you should put the function in the **Commands** category.</span></span> 
    
- <span data-ttu-id="07f0a-376">Если функция возвращает сведения о состоянии надстройки или любых других полезных сведений, следует поместить функцию в **категорию "Информация".**</span><span class="sxs-lookup"><span data-stu-id="07f0a-376">If the function returns information about the state of the add-in or any other useful information, you should put the function in the **Information** category.</span></span> 
    
- <span data-ttu-id="07f0a-377">Надстройка никогда не должна добавлять функции или команды в **категорию User Defined.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-377">An add-in should never add functions or commands to the **User Defined** category.</span></span> <span data-ttu-id="07f0a-378">Эта категория используется для исключительного использования конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="07f0a-378">This category is for the exclusive use of end users.</span></span> 
    
<span data-ttu-id="07f0a-379">Категория указывается с помощью параметра _pxCategory_ **в xlfRegister.**</span><span class="sxs-lookup"><span data-stu-id="07f0a-379">The category is specified using the  _pxCategory_ parameter to **xlfRegister**.</span></span> <span data-ttu-id="07f0a-380">Это может быть номер или текст, соответствующий одной из стандартных категорий с жесткой кодом, или текст новой категории, заданной DLL.</span><span class="sxs-lookup"><span data-stu-id="07f0a-380">This can be a number or text that corresponds to one of the hard-coded standard categories, or the text of a new category specified by the DLL.</span></span> <span data-ttu-id="07f0a-381">Если данный текст еще не существует, Excel создает новую категорию с этим именем.</span><span class="sxs-lookup"><span data-stu-id="07f0a-381">If the text given does not already exist, Excel creates a new category with that name.</span></span>
  
<span data-ttu-id="07f0a-382">В следующей таблице перечислены стандартные категории, которые видны при просмотре диалогового окна **Функции** вклейки из таблицы.</span><span class="sxs-lookup"><span data-stu-id="07f0a-382">The following table lists the standard categories that are visible when you view the **Paste Function** dialog box from within a worksheet.</span></span> 
  
|<span data-ttu-id="07f0a-383">**Number**</span><span class="sxs-lookup"><span data-stu-id="07f0a-383">**Number**</span></span>|<span data-ttu-id="07f0a-384">**Text**</span><span class="sxs-lookup"><span data-stu-id="07f0a-384">**Text**</span></span>|
|:-----|:-----|
|<span data-ttu-id="07f0a-385">1</span><span class="sxs-lookup"><span data-stu-id="07f0a-385">1</span></span>  <br/> |<span data-ttu-id="07f0a-386">Финансы</span><span class="sxs-lookup"><span data-stu-id="07f0a-386">Financial</span></span>  <br/> |
|<span data-ttu-id="07f0a-387">2</span><span class="sxs-lookup"><span data-stu-id="07f0a-387">2</span></span>  <br/> |<span data-ttu-id="07f0a-388">Время &amp; даты</span><span class="sxs-lookup"><span data-stu-id="07f0a-388">Date &amp; Time</span></span>  <br/> |
|<span data-ttu-id="07f0a-389">3</span><span class="sxs-lookup"><span data-stu-id="07f0a-389">3</span></span>  <br/> |<span data-ttu-id="07f0a-390">Math &amp; Trig</span><span class="sxs-lookup"><span data-stu-id="07f0a-390">Math &amp; Trig</span></span>  <br/> |
|<span data-ttu-id="07f0a-391">4 </span><span class="sxs-lookup"><span data-stu-id="07f0a-391">4</span></span>  <br/> |<span data-ttu-id="07f0a-392">Текст</span><span class="sxs-lookup"><span data-stu-id="07f0a-392">Text</span></span>  <br/> |
|<span data-ttu-id="07f0a-393">5 </span><span class="sxs-lookup"><span data-stu-id="07f0a-393">5</span></span>  <br/> |<span data-ttu-id="07f0a-394">Логический</span><span class="sxs-lookup"><span data-stu-id="07f0a-394">Logical</span></span>  <br/> |
|<span data-ttu-id="07f0a-395">6 </span><span class="sxs-lookup"><span data-stu-id="07f0a-395">6</span></span>  <br/> |<span data-ttu-id="07f0a-396">Справка по &amp; lookup</span><span class="sxs-lookup"><span data-stu-id="07f0a-396">Lookup &amp; Reference</span></span>  <br/> |
|<span data-ttu-id="07f0a-397">7 </span><span class="sxs-lookup"><span data-stu-id="07f0a-397">7</span></span>  <br/> |<span data-ttu-id="07f0a-398">Database</span><span class="sxs-lookup"><span data-stu-id="07f0a-398">Database</span></span>  <br/> |
|<span data-ttu-id="07f0a-399">8 </span><span class="sxs-lookup"><span data-stu-id="07f0a-399">8</span></span>  <br/> |<span data-ttu-id="07f0a-400">Статистическая</span><span class="sxs-lookup"><span data-stu-id="07f0a-400">Statistical</span></span>  <br/> |
|<span data-ttu-id="07f0a-401">9 </span><span class="sxs-lookup"><span data-stu-id="07f0a-401">9</span></span>  <br/> |<span data-ttu-id="07f0a-402">Информация</span><span class="sxs-lookup"><span data-stu-id="07f0a-402">Information</span></span>  <br/> |
|<span data-ttu-id="07f0a-403">14 </span><span class="sxs-lookup"><span data-stu-id="07f0a-403">14</span></span>  <br/> |<span data-ttu-id="07f0a-404">Определение пользователя</span><span class="sxs-lookup"><span data-stu-id="07f0a-404">User Defined</span></span>  <br/> |
||<span data-ttu-id="07f0a-405">Engineering (начиная с Excel 2007 г.)</span><span class="sxs-lookup"><span data-stu-id="07f0a-405">Engineering (starting in Excel 2007)</span></span>  <br/> |
||<span data-ttu-id="07f0a-406">Cube (начиная с Excel 2007 г.)</span><span class="sxs-lookup"><span data-stu-id="07f0a-406">Cube (starting in Excel 2007)</span></span>  <br/> |
   
<span data-ttu-id="07f0a-407">Кроме того, эти категории также видны при просмотре диалогового окна **Функции** вклейки из макроса.</span><span class="sxs-lookup"><span data-stu-id="07f0a-407">In addition, these categories are also visible when you view the **Paste Function** dialog box from within a macro sheet.</span></span> 
  
|<span data-ttu-id="07f0a-408">**Number**</span><span class="sxs-lookup"><span data-stu-id="07f0a-408">**Number**</span></span>|<span data-ttu-id="07f0a-409">**Text**</span><span class="sxs-lookup"><span data-stu-id="07f0a-409">**Text**</span></span>|
|:-----|:-----|
|<span data-ttu-id="07f0a-410">10 </span><span class="sxs-lookup"><span data-stu-id="07f0a-410">10</span></span>  <br/> |<span data-ttu-id="07f0a-411">Команды</span><span class="sxs-lookup"><span data-stu-id="07f0a-411">Commands</span></span>  <br/> |
|<span data-ttu-id="07f0a-412">11</span><span class="sxs-lookup"><span data-stu-id="07f0a-412">11</span></span>  <br/> |<span data-ttu-id="07f0a-413">DDE/External</span><span class="sxs-lookup"><span data-stu-id="07f0a-413">DDE/External</span></span>  <br/> |
|<span data-ttu-id="07f0a-414">12 </span><span class="sxs-lookup"><span data-stu-id="07f0a-414">12</span></span>  <br/> |<span data-ttu-id="07f0a-415">Настройка</span><span class="sxs-lookup"><span data-stu-id="07f0a-415">Customizing</span></span>  <br/> |
|<span data-ttu-id="07f0a-416">13</span><span class="sxs-lookup"><span data-stu-id="07f0a-416">13</span></span>  <br/> |<span data-ttu-id="07f0a-417">Управление макросами</span><span class="sxs-lookup"><span data-stu-id="07f0a-417">Macro Control</span></span>  <br/> |
   
### <a name="example"></a><span data-ttu-id="07f0a-418">Пример</span><span class="sxs-lookup"><span data-stu-id="07f0a-418">Example</span></span>

<span data-ttu-id="07f0a-419">См. код функции **xlAutoOpen**  `\SAMPLES\GENERIC\GENERIC.C` в .</span><span class="sxs-lookup"><span data-stu-id="07f0a-419">See the code for the **xlAutoOpen** function in  `\SAMPLES\GENERIC\GENERIC.C`.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="07f0a-420">См. также</span><span class="sxs-lookup"><span data-stu-id="07f0a-420">See also</span></span>

- [<span data-ttu-id="07f0a-421">REGISTER.ID</span><span class="sxs-lookup"><span data-stu-id="07f0a-421">REGISTER.ID</span></span>](xlfregisterid.md)
- [<span data-ttu-id="07f0a-422">UNREGISTER</span><span class="sxs-lookup"><span data-stu-id="07f0a-422">UNREGISTER</span></span>](xlfunregister-form-1.md)
- [<span data-ttu-id="07f0a-423">Необходимые и полезные функции XLM из API C</span><span class="sxs-lookup"><span data-stu-id="07f0a-423">Essential and Useful C API XLM Functions</span></span>](essential-and-useful-c-api-xlm-functions.md)


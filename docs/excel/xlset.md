---
title: xlSet
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
f1_keywords:
- xlSet
keywords:
- Функция кслсет [Excel 2007]
localization_priority: Normal
ms.assetid: 121e6212-0692-4430-97be-4792b53719bf
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 0912c1d40882933778d0df927ceb9de773063444
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404605"
---
# <a name="xlset"></a>xlSet

**Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
Очень быстро помещает постоянные значения в ячейки или диапазоны. Для получения дополнительных сведений обратитесь к разделу "Кслсет and книги с формулами массива" в статье " [Известные проблемы разработки XLL для Excel](known-issues-in-excel-xll-development.md)".
  
```cs
Excel12(xlSet, LPXLOPER12 pxRes, 2, LPXLOPER12 pxReference, LPXLOPER pxValue);
```

## <a name="parameters"></a>Параметры

_пксреференце_ (**кслтипереф** или **кслтипесреф**)
  
Прямоугольная ссылка, описывающая целевую ячейку или ячейки. Ссылка должна описывать смежные ячейки, поэтому в **кслтипереф** `val.mref.lpmref->count` должно быть задано значение 1. 
  
_пксвалуе_
  
Значение или значения, помещаемые в ячейки или ячейки. Для получения дополнительных сведений см раздел "Примечания".
  
## <a name="remarks"></a>Примечания

### <a name="pxvalue-argument"></a>аргумент Пксвалуе

_пксвалуе_ может быть либо значением, либо массивом. Если это значение, весь конечный диапазон заполняется этим значением. Если это массив (**xltypeMulti**), элементы массива помещаются в соответствующие расположения в прямоугольнике.
  
Если для второго аргумента используется горизонтальный массив, он повторяется, чтобы заполнить весь прямоугольник. Если вы используете вертикальный массив, он дублируется справа, чтобы заполнить весь прямоугольник. Если используется прямоугольный массив, и он слишком мал для прямоугольного диапазона, в который его следует поместить, этот диапазон дополняются **#N/a**s.
  
Если целевой диапазон меньше исходного массива, значения копируются вплоть до пределов целевого диапазона, а дополнительные данные игнорируются.
  
Чтобы очистить элемент конечного прямоугольника, используйте элемент массива типа **кслтипенил** в исходном массиве. Чтобы очистить весь прямоугольник назначения, опустите второй аргумент. 
  
### <a name="restrictions"></a>Наложен

**кслсет** не может быть отменен. Кроме того, он уничтожает все сведения об отмене, которые могли быть доступны до. 
  
**кслсет** может помещать в ячейки только константы, а не формулы. 
  
**кслсет** функционирует как функция, эквивалентная команде класса 3; то есть он доступен только в библиотеке DLL, когда DLL вызывается из объекта, макроса, меню, панели инструментов, сочетания клавиш или кнопки **выполнить** в диалоговом окне **макрос** (доступного из вкладки **вид** на ленте, начиная с Excel 2007, а меню **инструменты** — в более ранних версиях). 
  
## <a name="example"></a>Пример

В следующем примере заполняются B205: B206 со значением, переданным из макроса. В этом примере функции команды требуется аргумент, поэтому он будет работать только при вызове из листа макросов XLM или из модуля VBA с помощью метода **Application. Run** . 
  
`\SAMPLES\EXAMPLE\EXAMPLE.C`
  
```cs
short WINAPI xlSetExample(short int iVal)
{
   XLOPER12 xRef, xValue;
   xRef.xltype = xltypeSRef;
   xRef.val.sref.count = 1;
   xRef.val.sref.ref.rwFirst = 204;
   xRef.val.sref.ref.rwLast = 205;
   xRef.val.sref.ref.colFirst = 1;
   xRef.val.sref.ref.colLast = 1;
   xValue.xltype = xltypeInt;
   xValue.val.w = iVal;
   Excel12(xlSet, 0, 2, (LPXLOPER12)&xRef, (LPXLOPER12)&xValue);
   return 1;
}
```

## <a name="see-also"></a>См. также

- [xlCoerce](xlcoerce.md)
- [Функции API C, которые можно вызывать только из библиотеки DLL или XLL](c-api-functions-that-can-be-called-only-from-a-dll-or-xll.md)


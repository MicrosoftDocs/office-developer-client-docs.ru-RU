---
title: xlSet
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
f1_keywords:
- xlSet
keywords:
- функция xlSet функции [excel 2007]
localization_priority: Normal
ms.assetid: 121e6212-0692-4430-97be-4792b53719bf
description: 'Относится к: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 63f50e441f5d851677f36754a17bcd6403705239
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807378"
---
# <a name="xlset"></a>xlSet

**Относится к**: Excel 2013 | Office 2013 | Visual Studio 
  
Очень быстро переводит постоянных значений в ячейки или диапазоны. Для получения дополнительных сведений см «функция xlSet и книги с формул массива» в разделе [Известные проблемы при разработке XLL для Excel](known-issues-in-excel-xll-development.md).
  
```cs
Excel12(xlSet, LPXLOPER12 pxRes, 2, LPXLOPER12 pxReference, LPXLOPER pxValue);
```

## <a name="parameters"></a>Параметры

_pxReference_ (**xltypeRef** или **xltypeSRef**)
  
Прямоугольный ссылки на описания конечного одну или несколько ячеек. Справочные материалы по необходимо описать смежных ячеек таким образом, в **xltypeRef** `val.mref.lpmref->count` должен иметь значение 1. 
  
_pxValue_
  
Значение или значения должен быть помещен в одну или несколько ячеек. Дополнительные сведения см в разделе «Примечания».
  
## <a name="remarks"></a>Замечания

### <a name="pxvalue-argument"></a>Аргумент pxValue

_pxValue_ может быть значение или массив. Если это значение, это значение заполняется весь диапазон назначения. Если это массив (**xltypeMulti**) элементы массива помещаются в соответствующих расположений в прямоугольника.
  
Если вы используете горизонтального массива для второй аргумент, дублируется вниз для заполнения всей прямоугольника. Если вы используете вертикального массива, уже используется для заполнения всей прямоугольника справа. Если использовать прямоугольный массив слишком мал для прямоугольный диапазон, чтобы поместить его в, этот диапазон дополняется s **# Н/д**.
  
Если указанный диапазон меньше исходного массива, значения копируются в до ограничения в указанный диапазон и дополнительных данных игнорируются.
  
Чтобы удалить элемент конечного прямоугольника, используйте элемент **xltypeNil** тип массива исходного массива. Чтобы очистить всю конечного прямоугольника, не заданы второй. 
  
### <a name="restrictions"></a>Ограничения

**функция xlSet** невозможно отменить. Кроме того какие-либо сведения отмены, которая была перед уничтожает. 
  
**функция xlSet** можно поместить только константы, не формулы в ячейках. 
  
**функция xlSet** ведет себя как функция эквивалент команды класса 3; то есть оно доступно только в библиотеке DLL при вызове из объекта, макрос, меню, панели инструментов, сочетания клавиш или кнопки **запустить** в диалоговое окно **макроса** (доступного из **представления** вкладки на ленте, начиная с версии Excel 2007, а также средства **библиотеки DLL **меню в более ранних версий). 
  
## <a name="example"></a>Пример

В следующем примере заполняется B205:B206 со значением, который был получен из макроса. В этом примере функция команда требуется аргумент и поэтому будет работать только при вызове из таблицы макросов XLM или из модуля VBA с помощью метода **Application.Run** . 
  
`\SAMPLES\EXAMPLE\EXAMPLE.C`
  
```cs
short WINAPI xlSetExample(short int iVal)
{
   XLOPER12 xRef, xValue;
   xRef.xltype = xltypeSRef;
   xRef.val.sref.count = 1;
   xRef.val.sref.ref.rwFirst = 204;
   xRef.val.sref.ref.rwLast = 205;
   xRef.val.sref.ref.colFirst = 1;
   xRef.val.sref.ref.colLast = 1;
   xValue.xltype = xltypeInt;
   xValue.val.w = iVal;
   Excel12(xlSet, 0, 2, (LPXLOPER12)&xRef, (LPXLOPER12)&xValue);
   return 1;
}
```

## <a name="see-also"></a>См. также

- [xlCoerce](xlcoerce.md)
- [Функции API C, которые можно вызывать только из библиотеки DLL или XLL](c-api-functions-that-can-be-called-only-from-a-dll-or-xll.md)


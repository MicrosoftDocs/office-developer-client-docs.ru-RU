---
title: Ссылки на таблицы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- references [excel 2007], worksheet,worksheet references [Excel 2007],external worksheet references [Excel 2007],active worksheet [Excel 2007],current worksheet [Excel 2007],internal worksheet references [Excel 2007]
localization_priority: Normal
ms.assetid: 53406fb8-4ca5-4204-a6ad-b21ca9e6a100
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 2944f73a3144837a4be8aff7c7fed9a8d2158203
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416463"
---
# <a name="worksheet-references"></a>Ссылки на таблицы

 **Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
Ссылка в Microsoft Excel — это тип данных, который ссылается на прямоугольный блок ячеек (который может быть только одной ячейкой) или, в некоторых случаях, на несколько несоотдиняемых блоков ячеек. Для ячеек на текущем листе Excel использует один тип ссылки, который называется внутренней ссылкой. Любая ячейка, которая не находится на текущем листе, описывается другим типом ссылки, который называется внешней ссылкой. Определение активного и текущего см. в следующем разделе.
  
## <a name="active-vs-current"></a>Активный или текущий

В Excel термин "активный" обозначает то, что просматривает пользователь. Активная книга и таблица — это книги, на которые в данный момент смотрит пользователь, или, если Excel потеряет фокус на другом приложении, смотрит на время последнего фокуса Excel. Активный лист всегда находится в активной книге. Одна или несколько ячеек, выбранных на активном листе, называются активными ячейками. Если внедренный объект имеет фокус, последние выбранные ячейки по-прежнему активны. 
  
Текущий термин относится к пересчету в Excel. Текущая книга и таблица — это книги, которые в настоящее время пересчитываются. Текущий лист всегда находится в текущей книге. Пересчитаемая ячейка называется текущей ячейкой или, в случае пересчета формулы массива, текущими ячейками. 
  
Следует помнить о таких важных моментах:
  
- Активная книга, таблица или ячейка обычно не является текущей, хотя это возможно.
    
- Функция надстройки в модуле Visual Basic для приложений (VBA), DLL или XLL всегда будет вызвана из текущей ячейки на текущем листе или одна из них в случае многопоточных пересчетов (MTR).
    
Многие функции Excel, которые предоставляют сведения о ячейке, диапазоне ячеек или листе в книге, отличают активную книгу, лист или ячейку от текущей книги, листа или ячейки. Это различие отражается в типах данных, используемых для описания ссылок на блоки ячеек, как описано в следующем разделе.
  
## <a name="internal-and-external-worksheet-references"></a>Внутренние и внешние ссылки на таблицы

Ключевое различие между внутренними и внешними ссылками состоит в том, что тип данных внешней ссылки содержит ИД для таблицы, а также описание ячеек, на которые ссылаются. Внутренняя ссылка не содержит ссылки на лист — неявно, что лист является текущим листом. 
  
Многие функции API C возвращают ссылки или принимают аргументы ссылок. Любая функция API C, которая принимает опорные аргументы, принимает внутренние или внешние ссылки, за исключением функции **xlSheetNm,** для которой требуется внешняя ссылка. Некоторые функции возвращают только внутренние или внешние ссылки. Например, функция [XlfCaller](xlfcaller.md) API C возвращает ссылку на вызывающая ячейка по определению на текущем листе. Возвращаемая ссылка всегда является внутренней ссылкой, хотя функция может возвращать не справочные типы, в которых функция не вызвана из ячейки таблицы. Функция API [C xlSheetId](xlsheetid.md) всегда возвращает ИД таблицы, содержаной во внешнем типе ссылок. 
  
Другое ключевое различие между внутренними и внешними эталонными типами состоит в том, что тип данных внешней ссылки может описывать несколько несоединяемых блоков ячеек на одном листе. Внутренние ссылки могут описывать только один блок на текущем листе. Несоединяемая ссылка может передаваться любой функции, которая принимает аргумент диапазона.
  
## <a name="see-also"></a>См. также



[Понятия, связанные с программированием для Excel](excel-programming-concepts.md)
  
[Оценка имен и других выражений в формулах листов](evaluating-names-and-other-worksheet-formula-expressions.md)
  
[Оценка выражений и листов Excel](excel-worksheet-and-expression-evaluation.md)


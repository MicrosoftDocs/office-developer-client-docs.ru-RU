---
title: Ссылки на лист
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- REFERENCES [Excel 2007], лист, ссылки на листы [Excel 2007], ссылки на внешние листы [Excel 2007], активный лист [Excel 2007], текущий лист [Excel 2007], ссылки на внутренние листы [Excel 2007]
localization_priority: Normal
ms.assetid: 53406fb8-4ca5-4204-a6ad-b21ca9e6a100
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 2944f73a3144837a4be8aff7c7fed9a8d2158203
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416463"
---
# <a name="worksheet-references"></a><span data-ttu-id="f58d6-104">Ссылки на лист</span><span class="sxs-lookup"><span data-stu-id="f58d6-104">Worksheet References</span></span>

 <span data-ttu-id="f58d6-105">**Область применения:** Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="f58d6-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="f58d6-106">Ссылка в Microsoft Excel — это тип данных, ссылающийся на прямоугольный блок ячеек (может быть только одна ячейка), или, в некоторых случаях, несколько несвязанных блоков ячеек.</span><span class="sxs-lookup"><span data-stu-id="f58d6-106">A reference in Microsoft Excel is a data type that refers to a rectangular block of cells (which can be just one cell), or in some cases, a number of disjoint blocks of cells.</span></span> <span data-ttu-id="f58d6-107">Для внутренних целей Excel использует один ссылочный тип для ячеек на текущем листе, который называется внутренней ссылкой.</span><span class="sxs-lookup"><span data-stu-id="f58d6-107">Internally, Excel uses one reference type for cells on the current sheet, known as an internal reference.</span></span> <span data-ttu-id="f58d6-108">Любая ячейка, не включенная в текущий лист, описана другим типом ссылки, называемой внешней ссылкой.</span><span class="sxs-lookup"><span data-stu-id="f58d6-108">Any cell that is not on the current sheet is described by another type of reference known as an external reference.</span></span> <span data-ttu-id="f58d6-109">Определение активных и текущих элементов приведено в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="f58d6-109">See the next section for the definition of active and current.</span></span>
  
## <a name="active-vs-current"></a><span data-ttu-id="f58d6-110">Активная и текущая</span><span class="sxs-lookup"><span data-stu-id="f58d6-110">Active vs. Current</span></span>

<span data-ttu-id="f58d6-111">В Excel термин активная указывает на то, что просматривает пользователь.</span><span class="sxs-lookup"><span data-stu-id="f58d6-111">In Excel, the term active refers to what the user is viewing.</span></span> <span data-ttu-id="f58d6-112">Активная книга и лист — это те, в которых пользователь в данный момент находится в данный момент, или, если приложение Excel потеряло фокус на другое приложение, в момент последнего фокуса в Excel.</span><span class="sxs-lookup"><span data-stu-id="f58d6-112">The active workbook and worksheet are those that the user is currently looking at, or, if Excel has lost focus to another application, was looking at when Excel last had focus.</span></span> <span data-ttu-id="f58d6-113">Активный лист всегда находится в активной книге.</span><span class="sxs-lookup"><span data-stu-id="f58d6-113">The active sheet is always in the active workbook.</span></span> <span data-ttu-id="f58d6-114">Одна или несколько ячеек, выбранных на активном листе, называются активными ячейками.</span><span class="sxs-lookup"><span data-stu-id="f58d6-114">The one or more cells that are selected in the active sheet are known as the active cells.</span></span> <span data-ttu-id="f58d6-115">Если в фокусе внедренный объект находится в фокусе, последние выбранные ячейки по-прежнему активны.</span><span class="sxs-lookup"><span data-stu-id="f58d6-115">If an embedded object has focus, the last-selected cells are still active.</span></span> 
  
<span data-ttu-id="f58d6-116">Термин Текущая относится к пересчету Excel.</span><span class="sxs-lookup"><span data-stu-id="f58d6-116">The term current refers to what Excel is recalculating.</span></span> <span data-ttu-id="f58d6-117">Текущая книга и лист — это пересчитанные в данный момент книги.</span><span class="sxs-lookup"><span data-stu-id="f58d6-117">The current workbook and worksheet are those that are currently being recalculated.</span></span> <span data-ttu-id="f58d6-118">Текущий лист всегда находится в текущей книге.</span><span class="sxs-lookup"><span data-stu-id="f58d6-118">The current sheet is always in the current workbook.</span></span> <span data-ttu-id="f58d6-119">Пересчитанная ячейка называется текущей ячейкой или в случае пересчета формулы массива, текущей ячейки.</span><span class="sxs-lookup"><span data-stu-id="f58d6-119">The cell being recalculated is known as the current cell, or, in the case of an array formula being recalculated, the current cells.</span></span> 
  
<span data-ttu-id="f58d6-120">Ниже приведены важные моменты, которые необходимо запомнить.</span><span class="sxs-lookup"><span data-stu-id="f58d6-120">The important points to remember are as follows:</span></span>
  
- <span data-ttu-id="f58d6-121">Активная книга/лист/ячейка обычно не является текущей, хотя это может быть.</span><span class="sxs-lookup"><span data-stu-id="f58d6-121">The active workbook/worksheet/cell is not generally the current one, although it can be.</span></span>
    
- <span data-ttu-id="f58d6-122">Функция надстройки, будь то в модуле Visual Basic для приложений (VBA) или библиотеке DLL или XLL, всегда вызывается из текущей ячейки на текущем листе или из одного из них в случае многопоточного пересчета (MTR).</span><span class="sxs-lookup"><span data-stu-id="f58d6-122">An add-in function, whether in a Visual Basic for Applications (VBA) module or a DLL or XLL, is always called from the current cell on the current sheet, or one of them in the case of multithreaded recalculation (MTR).</span></span>
    
<span data-ttu-id="f58d6-123">Многие функции Excel, предоставляющие сведения о ячейке, диапазоне ячеек или листе в книге различаются между текущей книгой, листом или ячейкой, текущей книгой, листом или ячейкой.</span><span class="sxs-lookup"><span data-stu-id="f58d6-123">Many Excel functions that provide information about a cell, a range of cells, or a sheet in a workbook distinguish between the active workbook, sheet, or cell and the current workbook, sheet, or cell.</span></span> <span data-ttu-id="f58d6-124">Это различие отражается на типах данных, используемых для описания ссылок на блоки ячеек, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="f58d6-124">This difference is reflected in the data types used to describe references to blocks of cells, as described in the following section.</span></span>
  
## <a name="internal-and-external-worksheet-references"></a><span data-ttu-id="f58d6-125">Ссылки на внутренние и внешние листы</span><span class="sxs-lookup"><span data-stu-id="f58d6-125">Internal and External Worksheet References</span></span>

<span data-ttu-id="f58d6-126">Ключевое различие между внутренними и внешними ссылками состоит в том, что тип данных External Reference содержит идентификатор листа, а также описание ячеек, на которые они ссылаются.</span><span class="sxs-lookup"><span data-stu-id="f58d6-126">The key difference between internal and external references is that the external reference data type contains an ID for the worksheet and also a description of which cells are referred to.</span></span> <span data-ttu-id="f58d6-127">Внутренняя ссылка не содержит ссылки на лист — он является неявным, так как этот лист является текущим листом.</span><span class="sxs-lookup"><span data-stu-id="f58d6-127">An internal reference contains no reference to the sheet—it is implicit that the sheet is the current sheet.</span></span> 
  
<span data-ttu-id="f58d6-128">Многие функции C API возвращают ссылки или принимают ссылочные аргументы.</span><span class="sxs-lookup"><span data-stu-id="f58d6-128">Many C API functions return references or take reference arguments.</span></span> <span data-ttu-id="f58d6-129">Любая функция C API, принимающая ссылочные аргументы, принимает как внутренние, так и внешние ссылки, за исключением функции **кслшитнм** , для которой требуется внешняя ссылка.</span><span class="sxs-lookup"><span data-stu-id="f58d6-129">Any C API function that takes reference arguments accepts either internal or external references, except the **xlSheetNm** function, which requires an external reference.</span></span> <span data-ttu-id="f58d6-130">Некоторые функции возвращают как внутренние, так и внешние ссылки.</span><span class="sxs-lookup"><span data-stu-id="f58d6-130">Some functions only return either internal or external references.</span></span> <span data-ttu-id="f58d6-131">Например, функция C API [xlfCaller](xlfcaller.md) возвращает ссылку на вызывающие ячейки по определению на текущем листе.</span><span class="sxs-lookup"><span data-stu-id="f58d6-131">For example, the C API function [xlfCaller](xlfcaller.md) returns a reference to the calling cells, by definition, on the current sheet.</span></span> <span data-ttu-id="f58d6-132">Возвращаемая ссылка всегда является внутренней ссылкой, хотя функция может возвращать типы, не связанные с ссылками, в которых функция не вызывается из ячейки листа.</span><span class="sxs-lookup"><span data-stu-id="f58d6-132">The returned reference is always an internal reference, although the function can return non-reference types where the function is not called from a worksheet cell.</span></span> <span data-ttu-id="f58d6-133">Функция [КСЛШИТИД](xlsheetid.md) API C всегда возвращает идентификатор листа, содержащегося в типе данных внешней ссылки.</span><span class="sxs-lookup"><span data-stu-id="f58d6-133">The C API function [xlSheetId](xlsheetid.md) always returns the ID of a worksheet contained within an external reference data type.</span></span> 
  
<span data-ttu-id="f58d6-134">Другое ключевое различие между внутренними и внешними ссылочными типами состоит в том, что тип данных внешней ссылки может описывать несколько несвязанных блоков ячеек на одном листе.</span><span class="sxs-lookup"><span data-stu-id="f58d6-134">The other key difference between the internal and external reference types is that the external reference data type can describe multiple disjoint blocks of cells on the same sheet.</span></span> <span data-ttu-id="f58d6-135">Внутренние ссылки могут описывать только один блок на текущем листе.</span><span class="sxs-lookup"><span data-stu-id="f58d6-135">Internal references can describe only a single block on the current sheet.</span></span> <span data-ttu-id="f58d6-136">Несвязанные ссылки можно передавать в любую функцию, принимающую аргумент Range.</span><span class="sxs-lookup"><span data-stu-id="f58d6-136">Disjoint references can be passed to any function that takes a range argument.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="f58d6-137">См. также</span><span class="sxs-lookup"><span data-stu-id="f58d6-137">See also</span></span>



[<span data-ttu-id="f58d6-138">Понятия, связанные с программированием для Excel</span><span class="sxs-lookup"><span data-stu-id="f58d6-138">Excel Programming Concepts</span></span>](excel-programming-concepts.md)
  
[<span data-ttu-id="f58d6-139">Оценка имен и других выражений в формулах листов</span><span class="sxs-lookup"><span data-stu-id="f58d6-139">Evaluating Names and Other Worksheet Formula Expressions</span></span>](evaluating-names-and-other-worksheet-formula-expressions.md)
  
[<span data-ttu-id="f58d6-140">Оценка выражений и листов Excel</span><span class="sxs-lookup"><span data-stu-id="f58d6-140">Excel Worksheet and Expression Evaluation</span></span>](excel-worksheet-and-expression-evaluation.md)


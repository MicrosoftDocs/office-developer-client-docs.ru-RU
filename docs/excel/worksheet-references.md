---
title: Ссылки на лист
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- REFERENCES [Excel 2007], лист, ссылки на листы [Excel 2007], ссылки на внешние листы [Excel 2007], активный лист [Excel 2007], текущий лист [Excel 2007], ссылки на внутренние листы [Excel 2007]
localization_priority: Normal
ms.assetid: 53406fb8-4ca5-4204-a6ad-b21ca9e6a100
description: 'Область применения: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 2944f73a3144837a4be8aff7c7fed9a8d2158203
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416463"
---
# <a name="worksheet-references"></a>Ссылки на лист

 **Область применения:** Excel 2013 | Office 2013 | Visual Studio 
  
Ссылка в Microsoft Excel — это тип данных, ссылающийся на прямоугольный блок ячеек (может быть только одна ячейка), или, в некоторых случаях, несколько несвязанных блоков ячеек. Для внутренних целей Excel использует один ссылочный тип для ячеек на текущем листе, который называется внутренней ссылкой. Любая ячейка, не включенная в текущий лист, описана другим типом ссылки, называемой внешней ссылкой. Определение активных и текущих элементов приведено в следующем разделе.
  
## <a name="active-vs-current"></a>Активная и текущая

В Excel термин активная указывает на то, что просматривает пользователь. Активная книга и лист — это те, в которых пользователь в данный момент находится в данный момент, или, если приложение Excel потеряло фокус на другое приложение, в момент последнего фокуса в Excel. Активный лист всегда находится в активной книге. Одна или несколько ячеек, выбранных на активном листе, называются активными ячейками. Если в фокусе внедренный объект находится в фокусе, последние выбранные ячейки по-прежнему активны. 
  
Термин Текущая относится к пересчету Excel. Текущая книга и лист — это пересчитанные в данный момент книги. Текущий лист всегда находится в текущей книге. Пересчитанная ячейка называется текущей ячейкой или в случае пересчета формулы массива, текущей ячейки. 
  
Ниже приведены важные моменты, которые необходимо запомнить.
  
- Активная книга/лист/ячейка обычно не является текущей, хотя это может быть.
    
- Функция надстройки, будь то в модуле Visual Basic для приложений (VBA) или библиотеке DLL или XLL, всегда вызывается из текущей ячейки на текущем листе или из одного из них в случае многопоточного пересчета (MTR).
    
Многие функции Excel, предоставляющие сведения о ячейке, диапазоне ячеек или листе в книге различаются между текущей книгой, листом или ячейкой, текущей книгой, листом или ячейкой. Это различие отражается на типах данных, используемых для описания ссылок на блоки ячеек, как описано в следующем разделе.
  
## <a name="internal-and-external-worksheet-references"></a>Ссылки на внутренние и внешние листы

Ключевое различие между внутренними и внешними ссылками состоит в том, что тип данных External Reference содержит идентификатор листа, а также описание ячеек, на которые они ссылаются. Внутренняя ссылка не содержит ссылки на лист — он является неявным, так как этот лист является текущим листом. 
  
Многие функции C API возвращают ссылки или принимают ссылочные аргументы. Любая функция C API, принимающая ссылочные аргументы, принимает как внутренние, так и внешние ссылки, за исключением функции **кслшитнм** , для которой требуется внешняя ссылка. Некоторые функции возвращают как внутренние, так и внешние ссылки. Например, функция C API [xlfCaller](xlfcaller.md) возвращает ссылку на вызывающие ячейки по определению на текущем листе. Возвращаемая ссылка всегда является внутренней ссылкой, хотя функция может возвращать типы, не связанные с ссылками, в которых функция не вызывается из ячейки листа. Функция [КСЛШИТИД](xlsheetid.md) API C всегда возвращает идентификатор листа, содержащегося в типе данных внешней ссылки. 
  
Другое ключевое различие между внутренними и внешними ссылочными типами состоит в том, что тип данных внешней ссылки может описывать несколько несвязанных блоков ячеек на одном листе. Внутренние ссылки могут описывать только один блок на текущем листе. Несвязанные ссылки можно передавать в любую функцию, принимающую аргумент Range.
  
## <a name="see-also"></a>См. также



[Понятия, связанные с программированием для Excel](excel-programming-concepts.md)
  
[Оценка имен и других выражений в формулах листов](evaluating-names-and-other-worksheet-formula-expressions.md)
  
[Оценка выражений и листов Excel](excel-worksheet-and-expression-evaluation.md)


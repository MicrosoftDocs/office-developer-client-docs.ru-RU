---
title: Устранение проблем с файлами Office и пользовательскими решениями при помощи журнала телеметрии
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
ms.assetid: ef88e30e-7537-488e-bc72-8da29810f7aa
description: Используйте журнал телеметрии для Office 2013, чтобы выявить проблемы совместимости с Office 2013 и решениями для предыдущих версий Office.
localization_priority: Priority
ms.openlocfilehash: 3954662a9476dca0cbb9bf4b8197979783b7e11e
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28715167"
---
# <a name="troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log"></a>Устранение проблем с файлами Office и пользовательскими решениями при помощи журнала телеметрии

Используйте журнал телеметрии для Office 2013, чтобы выявить проблемы совместимости с Office 2013 и решениями для предыдущих версий Office.
  
В статье ниже описывается журнал телеметрии и способы его использования. Дополнительные сведения о конкретных результатах, отображаемых в журнале телеметрии, см. в статье [Проблемы совместимости в Office](compatibility-issues-in-office.md).

Издав многочисленные выпуски, корпорация Майкрософт предоставила средства и платформы для настройки, автоматизации и расширения функций Office. Это позволило предприятиям и отдельным пользователям создавать решения или надстройки для приложений Office, повышающие их производительность и эффективность. По сложности такие решения могут быть как простыми макросами Visual Basic для приложений (VBA), так и развернутыми настройками .NET Framework. Многие пользователи таких решений полагаются на них при выполнении критичных для бизнеса задач и могут даже не знать, что пользуются настройкой, добавленной в их приложения Office.
  
Из-за огромного количества решений для набора Office обновление его версий может оказаться непростой задачей. Предприятия и отдельные пользователи не могут определить, обеспечивается ли полная совместимость крайне необходимых решений с новой версией. Эти решения могут использовать функции или код, доступные в предыдущих версиях Office, но признанные устаревшими в последующих. Если решение, использующее устаревшую функцию, загружается в ведущее приложение, это решение может работать иначе, вызывать ошибку, не загружаться или вызывать сбой ведущего приложения.
  
Журнал телеметрии для Office 2013, созданный на базе Excel 2013, помогает разработчикам и опытным пользователям диагностировать проблемы совместимости благодаря отображению событий, возникающих в выбранных приложениях Office 2013. С помощью этого средства пользователи могут выявлять потенциальные проблемы с надстройками, которые используются в рабочей среде. Это, в свою очередь, позволит лицам, принимающим решения в компании, обоснованно утвердить или отклонить обновление до Office 2013. Журнал телеметрии также предоставляет подробные отчеты о конкретных изменениях или устаревших функциях в объектных моделях для приложений Office 2013, что позволяет разработчикам быстро выявить проблемный код или элементы управления и выполнить их рефакторинг. ИТ-специалисты могут просматривать тенденции работоспособности решений для нескольких клиентов, используя Панель мониторинга телеметрии для Office 2013  вспомогательное средство для Журнал телеметрии.
  
Дополнительные сведения см. в статье [Развертывание панели мониторинга телеметрии](https://technet.microsoft.com/library/f69cde72-689d-421f-99b8-c51676c77717).
  
## <a name="how-the-telemetry-log-works"></a>Принцип работы Журнал телеметрии
<a name="OEV_Types"> </a>

При загрузке, использовании, закрытии или сбое файла или решения Office в одном из выбранных приложений Office 2013 оно добавляет запись с информацией о событии в локальное хранилище данных (база данных, расположенная на том же компьютере). Эта запись включает в себя заголовок для события, приложение, зарегистрировавшее событие, время, имя файлы или решения, серьезность и краткое описание всех возникших ошибок. При обновлении книга Журнал телеметрии отображает список записей, содержащихся в локальном хранилище данных.
  
> [!NOTE]
> В качестве расположения по умолчанию для локального хранилища данных используется папка %Users%\[текущий пользователь]\AppData\Local\Microsoft\Office\15.0\Telemetry. Максимальный размер этого хранилища данных по умолчанию составляет 5 МБ (5120 КБ). 
  
Выбранные приложения Office 2013 снабжены интерфейсом API регистрации во время выполнения, который создает запись в локальном хранилище данных при каждом возникновении одного из следующих событий для файла или решения:
  
- **OnLoad**: запись вносится в локальное хранилище данных при загрузке файла или решения в заданных приложениях Office 2013. При возникновении события **OnLoad** функция регистрации ошибок во время выполнения заносит имя файла, расположение и другие сведения в локальное хранилище данных. 
    
- **OnClose**: запись вносится при закрытии файла или решения в приложении. Эта запись включает в себя имя решения или файла, его расположение, а также приложение, зарегистрировавшее событие.
    
- **OnError**: запись вносится при обнаружении ошибки в решении для определенных приложений Office 2013. Эта запись включает в себя имя решения или файла, а также возникшую у пользователя проблему времени выполнения или совместимости. По возможности ошибки сопоставляются с известными проблемами совместимости и в таком виде отображаются в журнале Журнал телеметрии.
    
Журнал Журнал телеметрии отображает сведения о большом списке типов файлов и решений для выбранных приложений Office 2013. Тип файлов и решений, отслеживаемых интерфейсами API регистрации во время выполнения, зависит от приложения. Дополнительные сведения о том, какие виды решений отслеживаются, см. в таблице 1.
  
### <a name="table-1-types-of-office-files-and-solutions-tracked-in-telemetry-log"></a>Табл. 1. Типы файлов и решений Office, отслеживаемые в Журнал телеметрии
<a name="OEV_Table1"> </a>

|**Тип решения**|**Приложения**|**Описание**|
|:-----|:-----|:-----|
|Приложения области задач  <br/> |Excel 2013, Word 2013, Project 2013  <br/> |Это Надстройки Office, размещаемые в области задач клиентского приложения.  <br/> |
|контентных приложений;  <br/> |Excel 2013  <br/> |Это Надстройки Office, интегрированные в содержимое файла Office.  <br/> |
|Почтовые приложения  <br/> |Outlook 2013  <br/> |Приложения, которые отображаются в Outlook 2013 при соблюдении определенных условий (содержание или тема сообщения электронной почты включает определенные слова или фразы).  <br/> |
|Активные документы  <br/> |Word 2013  <br/> PowerPoint 2013  <br/> Excel 2013  <br/> | Активные документы  это файлы документов Office, отличные от остальных типов решений, которые перечислены в данной таблице. К ним могут относиться следующие элементы:  <br/>  Файлы Office в двоичном формате (DOC, PPT, PPS, XLS).  <br/>  Файлы в формате Office OpenXML (DOCX, PPTX, PPSX, XLSX).  <br/>  Файлы с поддержкой макросов, содержащие код VBA (DOCM, DOTM, PPTM, POTM, XLSM, XLTM).  <br/>  Файлы, содержащие элементы управления ActiveX.  <br/>  Файлы, имеющие подключения к внешним данным.  <br/> |
|Надстройки COM  <br/> |Word 2013  <br/> PowerPoint 2013  <br/> Excel 2013  <br/> Outlook 2013  <br/> |К надстройкам COM относятся надстройки уровня приложения Инструменты разработчика Office в Visual Studio 2010.  <br/> |
|Надстройки автоматизации Excel  <br/> |Excel 2013  <br/> |К этому типу решений относятся предыдущие версии поддерживаемых в Excel надстроек автоматизации, построенных на базе надстроек COM. Функции в надстройках автоматизации могут вызываться из формул на листах Excel.  <br/> |
|Надстройки Excel XLL  <br/> |Excel 2013  <br/> |Надстройки XLL предназначены специально для Excel и созданы с помощью любого компилятора, поддерживающего построение библиотек динамической компоновки (DLL). Их не требуется устанавливать или регистрировать. Надстройки XLL также включают в себя библиотеки DLL с заданными пользователем командами и функциями.  <br/> |
|Надстройка RTD XLS Excel  <br/> |Excel 2013  <br/> |Надстройки XLS данных реального времени (RTD) представляют собой листы Excel, использующие функцию листа **RealTimeData**, чтобы вызвать сервер автоматизации для извлечения данных в режиме реального времени.  <br/> |
|Надстройки Word WLL  <br/> |Word 2013  <br/> |Надстройки WLL (с расширением WLL) используются в Word и создаются с помощью любого компилятора, поддерживающего сборку библиотек DLL.  <br/> |
|Надстройки приложений  <br/> |Word 2013  <br/> PowerPoint 2013  <br/> Excel 2013  <br/> |Надстройки приложений  это файлы, которые связаны с конкретным приложением и содержат код VBA. Сюда относятся шаблоны Word с поддержкой макросов (DOTM), надстройки Excel (XLA, XLAM) и надстройки PowerPoint (PPA, PPAM).  <br/> |
|Шаблоны  <br/> |Word 2013  <br/> PowerPoint 2013  <br/> Excel 2013  <br/> |К шаблонам относятся шаблоны документов (DOT, DOTX), листов (XLT, XLTX) или презентаций (POT, POTX), прилагаемые к файлу Office.  <br/> |
   
## <a name="using-the-office-telemetry-log"></a>Использование журнала телеметрии Office
<a name="OEV_Using"> </a>

При установке Office 2013 устанавливается журнал Журнал телеметрии, на том же компьютере создается локальное хранилище данных, а в ранее указанных приложениях Office 2013 активируются API регистрации во время выполнения. Однако для начала мониторинга решения или файла журналом Журнал телеметрии они должны быть загружены или открыты в приложении.
  
Используйте следующую процедуру для отображения зарегистрированных в журнале Журнал телеметрии проблем Office. 
  
### <a name="to-use-the-telemetry-log"></a>Порядок использования журнала Журнал телеметрии

1. Чтобы открыть журнал Журнал телеметрии, выполните одно из следующих действий:
    
   - **Для Windows 7:** в меню **Пуск** выберите пункт **Все программы**, в списке программ разверните узел **Microsoft Office 2013**, узел **Office 2013 Tools** (Инструменты Office 2013), а затем щелкните элемент **Office 2013 Telemetry Log** (Журнал телеметрии Office 2013).
    
     В Excel 2013 открывается новая книга с тремя листами  **События**, **Сведения о системе** и **Руководство**.
    
   - **Для Windows 8:** проведите вверх для отображения панели приложения, выберите **All Apps** (Все приложения) и затем **Office 2013 Telemetry Log** (Журнал телеметрии Office 2013).
    
     В Excel 2013 открывается новая книга с тремя листами  **События**, **Сведения о системе** и **Руководство**.
    
2. Чтобы просмотреть актуальный список событий, выберите элемент **Обновить** в верхней части листа **События**.
    
3. Чтобы просмотреть данные о событиях, собранные из приложений Office 2013, обратитесь к таблице, отображаемой на листе **События**. 
    
4. Чтобы просмотреть сведения о компьютере, на котором установлен Office 2013 и журнал Журнал телеметрии, обратитесь к таблице, отображаемой на листе **Сведения о системе**. 
    
> [!NOTE]
> Книгу журнала Журнал телеметрии не требуется сохранять в Excel 2013 для регистрации результатов, так как эти сведения сохраняются в локальном хранилище данных (которое расположено отдельно от журнала Журнал телеметрии). Однако сохранение этой книги не приведет к повреждению журнала Журнал телеметрии. 
  
Журнал Журнал телеметрии отображает простые сведения о зарегистрированных событиях. Каждая из отображаемых в журнале Журнал телеметрии записей содержит заголовок события и сведения о его серьезности. Для ошибок в записи также включается описание ошибки и мер по ее устранению. Помните о том, что не все отображаемые записи представляют ошибки, вызванные решениями Office; в журнале Журнал телеметрии также приводятся сведения об успешной загрузке или успешном закрытии файлов и решений. 
  
Например, проблема с заголовком "OM Hidden: Comment.Initial Property" (Объектная модель скрыта: свойство Comment.Initial) появляется в том случае, если решение или файл с поддержкой макросов, открытые в Word 2013, пытаются получить инициалы автора комментария. Word 2013 предоставляет улучшенные возможности комментирования, в которых по умолчанию отображение инициалов автора комментария отключено. Интерфейсы API, сопоставленные с более старой моделью комментирования, были скрыты в объектной модели Word 2013, но остались доступными для обеспечения обратной совместимости. Проблема "OM Hidden: Comment.Initial" (Объектная модель скрыта: Comment.Initial) в журнале содержит сведения о файле, попытавшемся использовать API, приложении, вызвавшем событие (Word 2013), времени и дате события, а также короткое описание ошибки и способов ее устранения.
  
**Рис. 1. Журнал телеметрии Office**
  
![Записи в средстве "Просмотр событий" Office.](media/off15_OfficeEventViewer_SD.png "Записи в средстве \"Просмотр событий\" Office.")
  
> [!NOTE]
>  Лист **Сведения о системе** в журнале телеметрии содержит сведения о компьютере, на котором установлен Office 2013. На этом листе отображается следующая информация: 
> - Имя пользователя.
> - Полное имя компьютера.
> - Архитектура операционной системы (x64/64-разрядная или x86/32-разрядная).
> - Версия установленной на компьютере операционной системы Windows.
> - Часовой пояс внутренних часов компьютера.
> - Версия журнала телеметрии.
> - Версия пакета Office, установленного на компьютере.
> 
> Эти сведения могут оказаться полезными при интерпретации проблем и событий, перечисленных на листе **События**. 
  
В журнале Журнал телеметрии вместе с известными проблемами отображается степень серьезности. В предыдущем примере проблема, указывающая на скрытую объектную модель, чаще всего имеет степень серьезности "Информационная". С другой стороны, остальные известные проблемы могут иметь более высокую степень серьезности и требовать более быстрого реагирования. Серьезность отображаемой в журнале Журнал телеметрии проблемы может иметь одно из следующих значений:
  
- **Информационная**. В данный момент проблема может не оказывать воздействие на совместимость приложений, но позднее пользователю может потребоваться предпринять некоторые меры. Эту степень серьезность имеют многие проблемы типа "OM hidden" (Объектная модель скрыта). 
    
- **Предупреждающая**. Проблема может привести к потере данных или снижению качества воспроизведения. 
    
- **Критическая**. Проблема может привести к потере значительной части функциональных возможностей или к сбою приложения. 
    
### <a name="table-2-types-of-events-displayed-in-the-telemetry-log"></a>Табл. 2. Типы событий, отображаемых в Журнал телеметрии
<a name="OEV_Table2"> </a>

Используйте следующую таблицу (табл. 2) при интерпретации записей, отображаемых в журнале Журнал телеметрии.
  
|**Код события**|**Название**|**Серьезность**|**Описание**|
|:-----|:-----|:-----|:-----|
|1  <br/> |Документ успешно загружен  <br/> ||Файл, указанный в столбце **Файл**, был открыт в приложении Office без каких-либо проблем.  <br/> |
|2  <br/> |Не удалось загрузить документ  <br/> |Предупреждение  <br/> | Приложению не удалось загрузить файл. Возможно, с этим связаны какие-либо проблемы совместимости.  <br/><br/>Дополнительные сведения о восстановлении поврежденной книги в Excel 2013 см. в статье [Восстановление поврежденной книги](https://office.microsoft.com/ru-RU/excel-help/repairing-a-corrupted-workbook-HA102749554.aspx).<br/><br/>Дополнительные сведения о восстановлении поврежденного документа в Word 2013 см. в статье [Сохранение и восстановление резервной копии документа](https://office.microsoft.com/ru-RU/word-help/save-and-recover-a-backup-copy-of-a-document-HA010121250.aspx). <br/> |
|3  <br/> |Шаблон успешно загружен  <br/> ||Файл шаблона, указанный в столбце **Файл**, был открыт в приложении Office без каких-либо проблем.  <br/> |
|4  <br/> |Не удалось загрузить шаблон  <br/> |Предупреждение  <br/> | Приложению не удалось загрузить шаблон. Возможно, с этим связаны какие-либо проблемы совместимости, либо изменилась доступность шаблона.  <br/><br/>Дополнительные сведения о восстановлении поврежденной книги в Excel 2013 см. в статье [Восстановление поврежденной книги](https://office.microsoft.com/ru-RU/excel-help/repairing-a-corrupted-workbook-HA102749554.aspx).<br/><br/>Дополнительные сведения о восстановлении поврежденного документа в Word 2013 см. в статье [Сохранение и восстановление резервной копии документа](https://office.microsoft.com/ru-RU/word-help/save-and-recover-a-backup-copy-of-a-document-HA010121250.aspx). <br/> |
|5  <br/> |Надстройка успешно загружена  <br/> ||Надстройка, указанная в столбце **Файл**, успешно загружена в приложении Office. Проблемы совместимости отсутствуют.  <br/> |
|6  <br/> |Приложению не удалось загрузить надстройку  <br/> |Критический  <br/> | Приложению не удалось загрузить надстройку, указанную в столбце **Файл**.  <br/><br/>Дополнительные сведения о восстановлении поврежденной книги в Excel 2013 см. в статье [Восстановление поврежденной книги](https://office.microsoft.com/ru-RU/excel-help/repairing-a-corrupted-workbook-HA102749554.aspx). <br/><br/>  Дополнительные сведения о восстановлении поврежденного документа в Word 2013 см. в статье [Сохранение и восстановление резервной копии документа](https://office.microsoft.com/ru-RU/word-help/save-and-recover-a-backup-copy-of-a-document-HA010121250.aspx). <br/> |
|7  <br/> |Манифест надстройки загружен успешно  <br/> ||Ведущее приложение успешно загрузило манифест надстройки Office.  <br/> |
|8  <br/> |Манифест надстройки не загружен  <br/> |Критическая  <br/> |Ведущему приложению не удалось загрузить файл манифеста Надстройка Office из каталога SharePoint, корпоративного каталога или Магазин Office.  <br/> |
|9  <br/> |Не удалось проанализировать манифест надстройки  <br/> |Критическая  <br/> |Ведущее приложение загрузило манифест надстройки Office, но ему не удалось считать XML.  <br/> |
|10  <br/> |Надстройка использует слишком много ресурсов ЦП  <br/> |Критическая  <br/> |Приложение Надстройка Office использовало более 90 % ресурсов ЦП за конечный промежуток времени.  <br/> |
|11  <br/> |Произошел сбой при загрузке приложения  <br/> |Критический  <br/> |При запуске приложение Office попыталось загрузить документ или решение, но из-за проблем с этим документом или решением запуск приложения не был выполнен.  <br/> |
|12  <br/> |Проблема привела к закрытию приложения  <br/> |Критический  <br/> |Что-то вызвало критическую ошибку в приложении, поэтому оно было закрыто.  <br/> |
|13  <br/> |Документ успешно закрыт  <br/> ||Файл, указанный в столбце **Файл**, успешно закрыт.  <br/> |
|14  <br/> |Превышено время сеанса приложения  <br/> ||Сеансы приложений с открытым документом или решением должны длиться не более 24 часов. При превышении этого значения ведущее приложение создает новый сеанс.  <br/> |
|15  <br/> |Тайм-аут поиска строки привел к отключению надстройки  <br/> ||Почтовая надстройка выполняет поиск в строке темы и тексте электронного сообщения, чтобы определить, требуется ли их отображать с использованием регулярного выражения. Почтовое приложение, указанное в столбце **Файл**, было отключено Outlook 2013 из-за многократного тайм-аута при попытке сопоставления регулярного выражения.  <br/> |
|16  <br/> |Этот документ был открыт, когда произошел сбой приложения  <br/> |Критический  <br/> |Файл, указанный в столбце **Файл**, был открыт во время сбоя приложения (указанного в столбце приложения). Этот файл может как иметь, так и не иметь отношение к сбою данного **приложения**.  <br/> |
|17  <br/> |Надстройка успешно закрыта  <br/> |Информационные  <br/> |Приложению удалось успешно завершить работу надстройки.  <br/> |
|18  <br/> |Приложение успешно закрыто  <br/> ||Ведущему приложению удалось успешно закрыть приложение Надстройка Office.  <br/> |
|19  <br/> |Надстройка обнаружила ошибку времени выполнения  <br/> |Критический  <br/> |Надстройка Office столкнулось с проблемой и завершилось со сбоем. Для получения дополнительных сведений просмотрите журнал оповещений Microsoft Office с помощью средства просмотра событий Windows на том компьютере, где возникла ошибка.  <br/> |
|20  <br/> |Сбой надстройки при проверке лицензирования  <br/> |Критический  <br/> |Не удалось проверить сведения о лицензировании для приложения Надстройка Office, возможно, срок их действия истек. Для получения дополнительных сведений просмотрите журнал оповещений Microsoft Office с помощью средства просмотра событий Windows на том компьютере, где возникла ошибка.  <br/> |
|Различные модели  <br/> |"OM Behavior Change: ..." (Изменение поведения объектной модели: ...)  <br/> |Информационные  <br/> |В коде надстройки или документа с поддержкой макросов используется объект, элемент, коллекция, перечисление или константа, которые ведут себя иначе, чем в предыдущих версиях Office.<br/><br/> Дополнительные сведения см. в статье [Проблемы совместимости в Office](compatibility-issues-in-office.md).  <br/> |
|Разное  <br/> |"OM Removed: …" (Объектная модель удалена: …)  <br/> |Критический  <br/> |В коде надстройки или документа с поддержкой макросов используется объект, элемент, коллекция, перечисление или константа, которые удалены из объектной модели.<br/><br/>Дополнительные сведения см. в статье [Проблемы совместимости в Office](compatibility-issues-in-office.md).  <br/> |
|Разное  <br/> |"OM Hidden: …" (Объектная модель скрыта: …)  <br/> |Информационные  <br/> |В коде надстройки или документа с поддержкой макросов используется объект, элемент, коллекция, перечисление или константа, которые скрыты в объектной модели.<br/><br/>Дополнительные сведения см. в статье [Проблемы совместимости в Office](compatibility-issues-in-office.md).  <br/> |
|Разное  <br/> |"Control: …" (Элемент управления: …)  <br/> ||Файл содержит элемент управления, который может не поддерживаться в Office 2013 или операционной системе компьютера.<br/><br/>Дополнительные сведения см. в статье [Проблемы совместимости в Office](compatibility-issues-in-office.md).  <br/> |
   
## <a name="conclusion"></a>Заключение
<a name="OEV_Conclusion"> </a>

Журнал телеметрии  простое средство мониторинга критически важных решений для Office, которое могут использовать крупные предприятия, отдельные пользователи и разработчики. Выявляя проблемные решения для Office перед масштабным обновлением, предприятия могут точнее прогнозировать стоимость внедрения Office 2013.
  
## <a name="see-also"></a>Дополнительные ресурсы
<a name="OEV_Additional"> </a>

- [Центр разработчиков Office](https://msdn.microsoft.com/office/aa905340.aspx)
- [Проблемы совместимости в Office](compatibility-issues-in-office.md)
- [Развертывание панели мониторинга телеметрии Office](https://technet.microsoft.com/library/f69cde72-689d-421f-99b8-c51676c77717)
- [Центр разработчиков Office](https://msdn.microsoft.com/office/aa905340)
    


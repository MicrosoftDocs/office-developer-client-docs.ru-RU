---
title: Фильтрация представления с помощью макроса в приложении Access
manager: kelbow
ms.date: 08/18/2017
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: db4dbb71-1b22-4dfd-bc07-5f7d694fc038
description: Узнайте, как для фильтрации представления в приложение Access с помощью действия макроса RequeryRecords и макрос данных.
ms.openlocfilehash: 7ce65ef0c04fe91334d00649810c608cdab2f310
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25390410"
---
# <a name="filter-a-view-by-using-a-macro-in-an-access-app"></a>Фильтрация представления с помощью макроса в приложении Access

Узнайте, как для фильтрации представления в приложение Access с помощью действия макроса RequeryRecords и макрос данных.
  
> [!IMPORTANT]
> Корпорация Майкрософт больше не рекомендует создавать и использовать веб-приложения для Access в SharePoint. В качестве альтернативы можно использовать [Microsoft PowerApps](https://powerapps.microsoft.com/en-us/), чтобы создавать бизнес-решения без кода для Интернета и мобильных устройств. 

Представление списка по умолчанию в приложение Access позволяет фильтровать проблемы на значения, содержащиеся в полях. Возможны случаи, где требуется отфильтровать представлении, основываясь на набор условий, а не с сопоставления значения. Для этого необходимо создать макрос. В этой статье показано, как создать макрос, позволяющие фильтровать представления для отображения задач, для выполнения или из-за в следующие 7 дней.
  
## <a name="prerequisites-for-building-an-app-with-access"></a>Предварительные требования для создания приложения с помощью Access
<a name="Access2013FilterViewByUsingMacro_Prerequisites"> </a>

Для выполнения действия, описанные в этом примере, вам потребуются:
  
- Access 2013
- Среда разработки SharePoint 2013
    
> [!NOTE]
> Дополнительные сведения о настройке среды разработки SharePoint видеть [настроить среду разработки, общие для SharePoint 2013](https://msdn.microsoft.com/library/08e4e4e1-d960-43fa-85df-f3c279ed6927%28Office.15%29.aspx). Дополнительные сведения о получении Access 2013 и SharePoint 2013 видеть [файлы для загрузки](https://msdn.microsoft.com/office/apps/fp123627). 
  
## <a name="create-the-app"></a>Создание приложения
<a name="Access2013FilterViewByUsingMacro_CreateApp"> </a>

Предположим, что вы хотите создать приложение Access, который отслеживает задачи для бизнеса. Прежде чем приступить к созданию таблицы и представления, необходимо найти шаблона схемы.
  
### <a name="to-create-the-task-tracking-app"></a>Для создания приложения отслеживания задач

1. Откройте доступ и выберите пункт **настраиваемых веб-приложения**.
    
2. Введите имя и расположение веб-приложения. Можно выбрать расположение из **списка** и выберите команду **Создать**.
    
3. В поле « **Поиск** » введите **задачи** и нажмите клавишу ВВОД. 
    
    Шаблоны, которые могут оказаться полезными для отслеживания задач отображаются на рисунке 1.
    
   **На рисунке 1. Шаблоны, соответствующие поиск задач**

   ![Шаблоны, соответствующие поиску проблем] (media/odc_Access15_CreateAndCustomizeWebApp_Figure01.JPG "Шаблоны, соответствующие поиску проблем")
  
4. Выберите **задачи**.
    
Access создает набор таблиц и представлений.
  
Введите некоторые примеры задач и сотрудников в вашем приложении. Для этого выберите **Запуск приложения** , чтобы открыть его в веб-браузере. Введите значение в поле **Дата завершения** для каждой задачи. Вернуться к доступа, после завершения. 
  
## <a name="plan-the-customizations"></a>Планирование настроек
<a name="Access2013FilterViewByUsingMacro_PlanCustomizations"> </a>

Теперь у вас есть приложения, которое содержит несколько задач. Представление по умолчанию позволяет найти все задачи, с помощью элементов, которые хранятся в поля, отображаемые в представлении. Например, можно выполнить поиск важных проблем и проблем в процессе выполнения. Предположим, что требуется определить приоритеты работу, отображая активные вопросы, которые срок выполнения в течение нескольких недель. Для этого необходимо создать макрос пользовательского интерфейса (UI).
  
Команда макрос пользовательского интерфейса, которые можно использовать для фильтрации представлений — [Действия макроса RequeryRecords (приложение настраиваемых web Access)](requeryrecords-macro-action-access-custom-web-app.md). Действия макроса **RequeryRecords** фильтр представлении, основываясь на *где* аргумент, который предоставляется в виде предложения SQL WHERE. Для фильтрации представлений, необходимо указать несколько факты в определенный формат для фильтрации представления. 
  
Соответствующие факты являются:
  
- Одно или несколько полей для сравнения
    
- Обращение к текущей дате
    
- Как ссылаться на конкретный день относительно текущей даты
    
- Как определить, который на задачи находятся в процессе выполнения
    
Поле **Дата выполнения** предоставляет сведения о задача — срок выполнения. Поле **состояние** предоставляет сведения о состоянии о каждой задачи. Для ссылки на поля в макросе, используйте формат **[*имя_таблицы*]. [ *FieldName*]**. Использование **[задачи]. [ Дата завершения]** для ссылки на поля **Дату завершения** и **[задачи]. [ Состояние]** для ссылки на поле **состояние** . 
  
Функция [Сегодня функции (приложение настраиваемых web Access)](today-function-access-custom-web-app.md) возвращает текущую дату. Функция [Функции DateAdd (приложение настраиваемых web Access)](dateadd-function-access-custom-web-app.md) можно использовать для вычисления даты, определенного количества дней после определенной даты. 
  
Поле **состояния** содержит несколько возможных значений. Значение **завершено** указывает, что задача больше не активен. 
  
Эти данные могут быть объединены в следующие предложения SQL WHERE.
  
```sql
[Tasks].[Due Date]<DateAdd(Day,7,Today()) AND [Tasks].[Status]<>"Completed"
```

В этом предложения SQL WHERE используется в макросе для фильтрации представления для отображения активные вопросы, срок выполнения в течение 7 дней, или просроченных.
  
Чтобы запустить макрос пользовательского интерфейса, его необходимо подключенного к элемента или событий, возникающих в представлении в. Добавление пользовательской команды в представление удобно в **Панель действий** . **Панель действий** — настраиваемая панель инструментов, который отображается в верхней части каждого представления. По умолчанию **Панель действий** содержит кнопки для добавления, изменения, сохранение, удаление и отменить изменения. Можно добавить кнопки для выполнения настраиваемых действий, например фильтрации представления. 
  
Если представление содержит записи, которые соответствуют заданным критериям, **RequeryRecords** фильтр представления. Тем не менее если в представлении нет записей, которые соответствуют критериям, чем новые, отображается пустую запись. Если вы не хотите пустую запись будет отображаться, если отсутствуют задачи, срок выполнения следующей недели, необходимо найти метод для проверки задачи, прежде чем вызывать действия макроса **RequeryRecords** . Для этого создайте макрос данных на наличие записей, которые соответствуют критериям. 
  
Макрос пользовательского интерфейса, можно вызвать макрос данных попытается найти задание, которое должно быть выполнено следующей недели. Если макрос данных находит задачи настройки приложения.
  
## <a name="customize-the-app"></a>Настройка приложения
<a name="Access2013FilterViewByUsingMacro_CustomizeApp"> </a>

Теперь, когда вы определили настроек, их реализации. Сначала необходимо создать макрос данных. Некоторые макросы данных присоединяются напрямую с таблицами. Тем не менее этот макрос данных является отдельной макрос.
  
### <a name="to-create-the-data-macro"></a>Чтобы создать макрос данных

1. Откройте приложение в Access.
    
2. В группе **Создание** нажмите кнопку **Дополнительно**и выберите **Макрос данных**.
    
    Макрос данных открывается в режиме конструктора макросов.
    
3. В списке **Добавить новое действие** выберите команду **макрокомандой НайтиЗапись, после**.
    
4. В поле **Поиск копирование записи в** списке выберите **задачи**.
    
5. В поле **Условие отбора** введите **[задачи]. [ Дата завершения]\<DateAdd(Day,7,Today()) и [задачи]. [Состояние] \< \>«Завершена»**. 
    
6. Выберите **SetReturnVar** в списке **Добавить действие** . 
    
    > [!NOTE]
    > Вы увидите два поля списка **Добавить действие** , один внутри блока **макрокомандой НайтиЗапись, после** и другой вне блока **макрокомандой НайтиЗапись, после** . Следует выбрать список **Добавить действие** в блоке **макрокомандой НайтиЗапись, после** , как показано на рисунке 1. 
  
   **На рисунке 1. Добавьте поле со списком новое действие**

   ![Добавление нового действия раскрывающийся список] (media/odc_Access2013_FilterFormByUsingMacro_Figure01.jpg "Добавление нового действия раскрывающийся список")
  
7. В поле **имя** введите **TaskFound**. 
    
8. В поле **выражение** введите **«Да»**. 
    
9. Нажмите кнопку **Сохранить**. В поле **Имя** введите **TasksDueSoon** и нажмите кнопку **ОК**.
    
    Макрос должен выглядеть макрос, показано на рисунке 2.
    
   **На рисунке 2. Макрос данных tasksduesoon**

   ![Макрос данных tasksduesoon] (media/odc_Access2013_FilterFormByUsingMacro_Figure02.jpg "Макрос данных tasksduesoon")
  
10. Закрытие конструктора макроса.
    
Теперь мы готовы для добавления настраиваемой кнопке панели действий.
  
### <a name="to-add-a-custom-button-to-the-action-bar"></a>Добавление настраиваемой кнопки на панель действий

1. Выберите таблицу **задачи** . Это выбирает формы списка задач. 
    
2. Выбор представления в выберите **список**, выберите значок **Параметры и действия** и выберите команду **Изменить**.
    
    Представление открывается в режиме конструктора.
    
3. Теперь мы готовы для добавления настраиваемой кнопке панели действий. Для этого нажмите кнопку **Добавить настраиваемое действие** , как показано на рисунке 3. 
    
   **На рисунке 3. Кнопка добавления настраиваемого действия**

   ![Кнопку Добавить настраиваемое действие] (media/odc_Access2013_FilterFormByUsingMacro_Figure03.jpg "Кнопку Добавить настраиваемое действие")
  
    Новое действие отображается как кнопка со значком звезда, как показано на рисунке 4.
    
   **На рисунке 4. Кнопка панели новых действий**

   ![Кнопка Создать панель действий] (media/odc_Access2013_FilterFormByUsingMacro_Figure04.jpg "Кнопка Создать панель действий")
  
4. Нажмите кнопку панели настраиваемые действия и выберите значок **данных** . 
    
    Откроется диалоговое окно **данных** . 
    
5. В поле **Имя элемента управления** введите **FilterTasks**. 
    
6. В поле **всплывающая подсказка** введите **отображаемое обзор задач после выполнения или из-за следующей недели**. 
    
Теперь мы готовы создать макрос пользовательского интерфейса, чтобы отфильтровать представление.
  
### <a name="to-create-the-ui-macro-to-filter-the-view"></a>Чтобы создать макрос пользовательского интерфейса для фильтрации представлений

1. В диалоговом окне **данных** выберите **На выберите** , как показано на рисунке 5. 
    
   **На рисунке 5. Диалоговое окно "данные"**

   ![Диалоговое окно "данные"] (media/odc_Access2013_FilterFormByUsingMacro_Figure05.jpg "Диалоговое окно \"данные\"")
  
    Пустой макрос пользовательского интерфейса открывается в режиме конструктора макросов.
    
2. В списке **Добавить новое действие** выберите команду **ЗапускМакросаДанных**. 
    
3. В поле Имя введите **TasksDueSoon**. 
    
    В поле **SetLocalVar** введите **FilterRecords**. 
    
    **ЗапускМакросаДанных** вызывает **макрос данных tasksduesoon, которые мы создали раньше** и сохраняет ее результатов в переменной с именем **FilterRecords**. 
    
4. В списке **Добавить новое действие** выберите, **если**. 
    
5. Введите в поле **Если** **[FilterRecords] = «Yes»**. 
    
6. В списке **Добавить новое действие** выберите команду **RequeryRecords**. 
    
    > [!NOTE]
    > Вы увидите два поля списка **Добавить действие** , один в блок **If** , а другой за пределами блок **If** . Поле со списком **Добавлять новые действия** в пределах блок **If** должен выбрать, как показано на рисунке 6. 
  
   **На рисунке 6. Добавьте поле со списком новое действие**

   ![Добавление нового действия раскрывающийся список] (media/odc_Access2013_FilterFormByUsingMacro_Figure06.jpg "Добавление нового действия раскрывающийся список")
  
7. В поле **где** введите **[задачи]. [ Дата завершения]\<DateAdd(Day,7,Today()) и [задачи]. [Состояние] \< \>«Завершена»**. 
    
8. В поле **Order By** введите **[Дата завершения]**. 
    
9. Выберите ссылку **Добавить человеку** , который отображается в правой части в поле **Добавить действие** , как показано на рисунке 7. 
    
   **На рисунке 7. Добавление ссылки Else**

   ![Добавьте еще ссылок] (media/odc_Access2013_FilterFormByUsingMacro_Figure07.jpg "Добавьте еще ссылок")
  
    Предложение Else добавляется в том случае, если блокировки.
    
10. В списке **Добавить новое действие** выберите команду **MessageBox**. 
    
11. В поле **сообщение** введите **отсутствуют задачи, просроченные или завершающиеся в следующие 7 дней!**. 
    
12. Нажмите кнопку **Сохранить**.
    
    Макрос должен выглядеть макрос, показано на рисунке 8.
    
    **На рисунке 8. Макрос пользовательского интерфейса для фильтрации представлений**

    ![Макрос пользовательского интерфейса для фильтрации представлений] (media/odc_Access2013_FilterFormByUsingMacro_Figure08.jpg "Макрос пользовательского интерфейса для фильтрации представлений")
  
13. Закрытие конструктора макроса.
    
На этом этапе мы создали макрос пользовательского интерфейса, которая фильтрует представления списка задач для отображения срочных задач. Не будет вежливы из представления в отфильтрованные состоянии не предоставление метода для удаления фильтра. Для этого добавьте другой кнопки панель действий и макрос пользовательского интерфейса.
  
### <a name="to-add-an-action-bar-button-to-remove-the-filter"></a>Чтобы добавить кнопку панели действия для удаления фильтра

1. Нажмите кнопку **Добавить настраиваемое действие**.
    
    Новое действие отображается как кнопка со значком звезда
    
2. Нажмите кнопку настраиваемые панель действий и выберите значок **данных** . 
    
    Откроется диалоговое окно **данных** . 
    
3. В поле **Имя элемента управления** введите **RemoveFilter**. 
    
4. В поле **всплывающая подсказка** введите **Удалить все фильтр в представление**. 
    
Теперь мы готовы создать макрос пользовательского интерфейса, который будет удалить форму фильтр представления.
  
### <a name="to-create-the-ui-macro-to-remove-the-filter-from-the-view"></a>Чтобы создать макрос пользовательского интерфейса, чтобы удалить фильтр из представления

1. В диалоговом окне **данных** выберите **Пункт**.
    
    Пустой макрос пользовательского интерфейса открывается в режиме конструктора макросов.
    
2. В списке **Добавить новое действие** выберите команду **RequeryRecords**. 
    
    Настоящее время мы будет оставьте **Where** и **Order By** поля пустыми. Действие **RequeryRecords** вызывается без параметров, а затем удаляются все фильтры из представления. 
    
3. Нажмите кнопку **Сохранить**.
    
4. Закрытие конструктора макроса.
    
5. Закройте представление списка задач. Когда вам будет предложено сохранить изменения, нажмите кнопку **Да** . 
    
Теперь мы готовы к тексту настройки. Нажмите кнопку **Запуск приложения** откройте приложение в веб-браузере и нажмите кнопку настраиваемые FilterTasks панель действий. Задачи после завершения или завершающиеся в следующие 7 дней, отображаются. Если приложение не содержит срочных задач отображается сообщение. 
  
## <a name="conclusion"></a>Заключение

Действия макроса **RequeryRecords** можно использовать в макросе пользовательского интерфейса для фильтрации представления на основе критериев, которые можно выбрать. В зависимости от желаемое поведение может потребоваться создать макрос данных, чтобы убедиться, что запись соответствует критерии, прежде чем использовать действия макроса **RequeryRecords** . 
  
## <a name="see-also"></a>См. также

- [Новые возможности для разработчиков Access 2013](https://msdn.microsoft.com/library/df778f51-d65e-4c30-b618-65003ceb39b3%28Office.15%29.aspx)
    


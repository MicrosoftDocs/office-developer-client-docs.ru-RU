---
title: Создание и настройка веб-приложения в Access
manager: kelbow
ms.date: 08/18/2017
ms.audience: Developer
ms.topic: reference
ms.assetid: 628745f4-82e9-4838-9726-6f3e506a654f
localization_priority: Priority
ms.openlocfilehash: d7d27e98189a5b6784e4db48c81a545b85f01fc1
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32306139"
---
# <a name="create-and-customize-a-web-app-in-access"></a>Создание и настройка веб-приложения в Access

> [!IMPORTANT]
> Корпорация Майкрософт больше не рекомендует создавать и использовать веб-приложения для Access в SharePoint. В качестве альтернативы можно использовать [Microsoft PowerApps](https://powerapps.microsoft.com/ru-RU/), чтобы создавать бизнес-решения без кода для Интернета и мобильных устройств. 
  
Access 2013 содержит новую модель приложения, позволяющую экспертам быстро создавать веб-приложения. В состав Access включен набор шаблонов, которые можно использовать для быстрого создания приложения.

<a name="ac15_CreateAndCustomizeWebApp_Prerequisites"> </a>

## <a name="prerequisites-for-building-an-app-with-access-2013"></a>Предварительные требования для создания приложения с помощью Access 2013

Для выполнения действий, описанных в этом примере, вам потребуется следующее:
  
- Access
    
- Среда разработки SharePoint
    
Дополнительные сведения о настройке среды разработки SharePoint см. в статье [Настройка общей среды разработки для SharePoint](https://docs.microsoft.com/sharepoint/dev/general-development/set-up-a-general-development-environment-for-sharepoint). 
  
Дополнительные сведения о получении Access и SharePoint см. в [Загрузках](https://msdn.microsoft.com/office/apps/fp123627).

<a name="ac15_CreateAndCustomizeWebApp_CreateTheApp"> </a>

## <a name="create-the-app"></a>Создание приложения

Предположим, что вы хотите создать приложение Access, отслеживающее проблемы в вашей организации. Перед созданием таблиц и представлений с нуля следует выполнить поиск шаблона схемы, соответствующего вашим требованиям.
  
### <a name="to-create-the-issue-tracking-app"></a>Создание приложения, отслеживающего проблемы

1. Запустите Access и выберите вариант **Пользовательское веб-приложение**.
    
2. Введите имя и веб-адрес вашего приложения. Либо выберите расположение из списка **Доступные места** и нажмите кнопку **Создать**.
    
3. Введите **Проблемы** в поле **Что нужно отслеживать?** и нажмите клавишу ВВОД. 
    
   Список шаблонов, которые могут помочь с отслеживанием проблем, показан на рисунке 1.
    
   **Рисунок 1. Шаблоны, с помощью которых выполняется поиск проблем**

   ![Шаблоны, с помощью которых выполняется поиск проблем](media/odc_Access15_CreateAndCustomizeWebApp_Figure01.JPG "Шаблоны, с помощью которых выполняется поиск проблем")
  
4. Выберите **Проблемы**.
    
Access создает набор таблиц и представлений.
  
## <a name="explore-the-app"></a>Обзор приложения
<a name="ac15_CreateAndCustomizeWebApp_ExploreTheApp"> </a>

Чтобы понять, соответствует ли схема и представления вашим требованиям, следует их рассмотреть подробнее.
  
Таблицы, созданные при выборе схемы "Проблемы", отображаются в панели плиток. Таблицы "Проблемы", "Клиент" и "Сотрудники" являются основными для приложения. В таблице "Проблемы" хранятся сведения о каждой проблеме. Каждая проблема открывается и назначается сотруднику от имени клиента. Таблицы "Связанные проблемы" и "Комментарии к проблеме" играют вспомогательную роль в приложении. Таблица "Связанные проблемы" позволяет связывать одну проблему с другой. Таблица "Комментарии к проблеме" хранит несколько примечаний к одной проблеме.
  
В базе данных Access на компьютере (ACCDB) связи между таблицами управляются в окне **Связи**. Приложение Access 2013 управляет связями с помощью полей с присвоенным типом данных **Lookup**. Проверить связи таблицы "Проблемы" можно, щелкнув правой кнопки мыши плитку **Проблемы** и выбрав пункт **Изменить таблицу**.
  
Поле **Клиент** связано с таблицей **Клиенты**. Чтобы проверить связь, выберите поле **Клиент** и нажмите кнопку **Изменить подстановку**. Отобразится **Мастер подстановок**, как показано на рисунке 2. 
  
**Рисунок 2. Мастер подстановок, отображающий связь с таблицей "Клиенты"**

![Мастер подстановок, отображающий связь](media/odc_Access15_CreateAndCustomizeWebApp_Figure02.jpg "Мастер подстановок, отображающий связь")
  
Диалоговое окно мастера подстановок показывает, что поле **Клиент** связано с таблицей **Клиенты** и должно возвращаться поле **Отображаемое имя: Имя Фамилия** из таблицы **Клиенты**. 
  
Поля **Создано**, **Назначено** и **Изменено** относятся к таблице **Сотрудники**. Нескольким другим полям также присвоен тип данных **Lookup**. В этих случаях тип данных Lookup используется для указания конкретных значений, допустимых в поле. 
  
Закройте таблицу **Проблемы** и просмотрите панель плиток. Отображение верхних трех плиток для таблиц **Проблемы**, **Клиенты** и **Сотрудники** отличается от нижних двух плиток для таблиц **Связанные проблемы** и **Комментарии о проблеме**, как показано на рисунке 3. 
  
**Рисунок 3. Панель плиток для схемы "Проблемы"**

![Панель плиток для схемы "Проблемы"](media/odc_Access15_CreateAndCustomizeWebApp_Figure03.jpg "Панель плиток для схемы \"Проблемы\"")
  
Таблицы **Связанные проблемы** и **Комментарии о проблеме** затемнены, так как они скрыты от пользователей в веб-браузере. 
  
Воспользуемся приложением для отслеживания некоторых проблем. Для этого щелкните пункт **Запустить приложение**, чтобы открыть приложение в веб-браузере. 
  
Приложение откроет представление **Список проблем** таблицы "Проблемы". Прежде чем добавить проблему рекомендуется добавить несколько клиентов и сотрудников. Щелкните плитку **Клиенты**, чтобы начать добавление клиентов. 
  
С помощью средства выбора представления выберите одно из трех представлений, доступных для таблицы **Клиенты**, с именами **Список**, **Таблица** и **Группы**, как показано на рисунке 4. 
  
**Рисунок 4. Выбор представления**

![Выбор представления](media/odc_Access15_CreateAndCustomizeWebApp_Figure04.jpg "Выбор представления")
  
Выбор варианта **Список** активирует представление **Список клиентов**, являющееся представлением со сведениями о списке. Сведения о списке — одно из представлений, которое Access автоматически создает при создании таблицы. Основной функцией, отличающей представление "Сведения о списке", является область списка, отображающаяся в левой части представления. Область списка используется для фильтрации и перехода к записям, содержащимся в представлении. В базе данных Access на компьютере реализация представления списка с возможностью поиска потребует написания пользовательского кода. 
  
При выборе варианта **Таблица** откроется представление **Таблица клиентов**. Таблица — это другой тип представления, которое Access автоматически создает при создании таблицы. Табличные представления удобны для тех, кому проще вводить, сортировать и фильтровать данные в электронной таблице. 
  
При выборе варианта "Группы" откроется сводное представление. Сводные представления можно использовать для группировки записей на основе поля и выбора вычисления суммы или среднего значения.
  
Если вы добавляете клиентов, используйте панель действий, чтобы добавлять, изменять, сохранять и удалять записи, а также отменять изменения. Панель действий — это настраиваемая панель инструментов, которая отображается в верхней части каждого представления, как показано на рисунке 5.
  
**Рисунок 5. Панель действий**

![Панель действий](media/odc_Access15_CreateAndCustomizeWebApp_Figure05.jpg "Панель действий")
  
После добавления нескольких клиентов и сотрудников откройте представление "Список проблем" и начните добавление проблемы. При вводе имени клиента в поле "Клиент" появится одно или несколько имен клиентов, как показано на рисунке 6.
  
**Рисунок 6. Элемент управления AutoComplete**

![Элемент управления AutoComplete](media/odc_Access15_CreateAndCustomizeWebApp_Figure06.jpg "Элемент управления AutoComplete")
  
Поле "Клиент" — это элемент управления AutoComplete. Элемент управления AutoComplete отображает список записей, соответствующих вводимому в поле тексту. Это помогает обеспечить точность ввода данных.
  
## <a name="customize-the-app"></a>Настройка приложения
<a name="ac15_CreateAndCustomizeWebApp_CustomizeTheApp"> </a>

После обзора приложения вы можете заметить, что в представлении "Список проблем" нет контактных данных клиента. Настроим приложение, чтобы добавлять рабочий телефон клиента в таблицу "Проблемы" при создании проблемы.
  
### <a name="to-add-a-field-to-the-issues-table"></a>Добавление поля в таблицу "Проблемы"

1. Откройте приложение в Access.
    
2. Выберите плитку **Проблемы**, щелкните значок **Параметры/действие** и нажмите кнопку **Изменить таблицу**.
    
3. Введите **Номер контакта** в первой пустой ячейке столбца **Имя поля**. 
    
4. Выберите вариант **Короткий текст** в столбце **Тип данных**. 
    
5. Нажмите кнопку **Сохранить**.
    
6. Закройте таблицу "Проблемы".
    
Теперь, когда есть поле для сохранения номера телефона, создадим макрос данных для поиска контактных данных.
  
### <a name="to-create-the-data-macro-to-look-up-contact-information"></a>Создание макроса данных для поиска контактных данных

1. В группе **Создание** выберите **Дополнительно**, а затем **Макрос данных**.
    
2. Выберите **Создать параметр**.
    
3. В поле **Имя** введите **CustID**. В раскрывающемся списке **Тип** выберите **Число (десятичное с плавающей запятой).**
    
4. В раскрывающемся списке **Добавить новую макрокоманду** выберите пункт **НайтиЗапись**. 
    
5. В раскрывающемся списке **Найти запись в** выберите пункт **Клиенты**. 
    
6. В поле **Условие отбора** введите **[Клиенты].[ID]=[CustID]**. 
    
7. Выберите **SetReturnVar** в раскрывающемся списке **Добавить новую макрокоманду**. 
    
    > [!NOTE]
    > Появится два раскрывающихся списка **Добавить новую макрокоманду**: один в блоке **НайтиЗапись**, а другой за его пределами. Следует выбрать раскрывающийся список **Добавить новую макрокоманду** в блоке **НайтиЗапись**, как показано на рисунке 7. 
  
   **Рисунок 7. Раскрывающееся меню "Добавить новую макрокоманду"**

   ![Раскрывающееся меню "Добавить новую макрокоманду"](media/odc_Access15_CreateAndCustomizeWebApp_Figure07.jpg "Раскрывающееся меню \"Добавить новую макрокоманду\"")
  
8. В поле **Имя** введите **ContactPhone**. 
    
9. В поле **Выражение** введите **[Клиенты].[Рабочий телефон]**. 
    
10. Нажмите кнопку **Сохранить**. Введите **GetContactPhone** в поле **Имя макроса** и нажмите кнопку **ОК**.
    
    Макрос должен выглядеть примерно как на рисунке 8.
    
    **Рисунок 8. Макрос данных GetContactPhone**

    ![Макрос данных GetContactPhone](media/odc_Access15_CreateAndCustomizeWebApp_Figure08.jpg "Макрос данных GetContactPhone")
  
11. Закройте представление "Конструктор" макроса.
    
Теперь можно добавить поле **Номер контакта** в форму "Список проблем". 
  
### <a name="to-add-the-contact-number-field-to-the-issues-list-form"></a>Добавление поля "Номер контакта" в форму "Список проблем"

1. Откройте таблицу **Проблемы**. При этом будет выбрана форма "Список проблем". 
    
2. В средстве выбора представления выберите **Список**, щелкните значок **Параметры/действие** и нажмите кнопку **Изменить**.
    
3. Перетащите поле **Номер контакта** из области **Список полей** в нужное место отображения номера контакта. 
    
4. Выберите поле **Номер контакта** и щелкните **Данные**. 
    
5. В поле **Имя элемента** введите **CustomerContact** и закройте всплывающее окно **Данные**. 
    
6. Нажмите кнопку **Сохранить**.
    
Теперь нужно создать макрос пользовательского интерфейса, который копирует поле **Рабочий телефон** из таблицы **Клиенты** в поле **Телефон контакта** таблицы **Проблемы**. Событие **После обновления** элемента управления **CustomerAutocomplete** является хорошим расположением для макроса. 
  
### <a name="to-create-the-afterupdate-macro"></a>Создание макроса "После обновления"

1. Выберите элемент управления **CustomerAutocomplete**, нажмите кнопку **Действия** и выберите **После обновления**. 
    
    Откроется пустой макрос в режиме конструктора.
    
2. В раскрывающемся списке **Добавить новую макрокоманду** выберите пункт **ЗапускМакросаДанных**. 
    
3. В раскрывающемся списке **Имя макроса** выберите **GetContactPhone**. 
    
4. В поле **CustID** введите **[CustomerAutocomplete]**. 
    
5. В поле **ЗадатьЛокПеременную** введите **Телефон**. 
    
    Если вы выбрали макрос данных GetContactPhone, созданный ранее, Access автоматически заполнит параметр имени и вернет переменную для макроса.
    
    Номер телефона клиента хранится в переменной с именем "Телефон".
    
6. В раскрывающемся списке **Добавить новую макрокоманду** выберите пункт **ЗадатьСвойство**. 
    
7. В поле **Имя элемента** введите **CustomerContact**. 
    
8. В раскрывающемся списке **Свойство** выберите **Значение**. 
    
9. В поле **Значение** введите **=[Телефон]**. 
    
10. Нажмите кнопку **Сохранить**.
    
    Макрос должен выглядеть примерно как на рисунке 9.
    
    **Рисунок 9. Макрос "После обновления"**

    ![Макрос "После обновления"](media/odc_Access15_CreateAndCustomizeWebApp_Figure09.jpg "Макрос \"После обновления\"")
  
11. Закройте представление "Конструктор" макроса.
    
12. Закройте представление "Список проблем". Выберите **Да**, когда будет предложено сохранить изменения. 
    
Теперь все готово для проверки настроек. Щелкните пункт **Запустить приложение**, чтобы открыть приложение в веб-браузере, и добавьте новую проблему. Поле **Номер контакта** автоматически обновляется после ввода имени клиента, как показано на рисунке 10. 
  
**Рисунок 10. Представление "Проблемы", в которое добавлен номер телефона**

![Представление "Проблемы", в которое добавлен номер телефона](media/odc_Access15_CreateAndCustomizeWebApp_Figure10.jpg "Представление \"Проблемы\", в которое добавлен номер телефона")
  
## <a name="conclusion"></a>Заключение

Использование одного из имеющихся шаблонов схемы — это отличный способ быстро перейти к созданию веб-приложения Access. Автоматически создаваемые представления содержат расширенные функции, требующие использования пользовательского кода для реализации в базе данных Access на компьютере. 
  
## <a name="see-also"></a>См. также

- [Новые возможности для разработчиков Access 2013](https://msdn.microsoft.com/library/df778f51-d65e-4c30-b618-65003ceb39b3%28Office.15%29.aspx) 
- [Справочник по пользовательским веб-приложениям для Access](access-custom-web-app-reference.md)
  


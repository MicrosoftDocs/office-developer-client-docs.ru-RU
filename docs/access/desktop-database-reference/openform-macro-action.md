---
title: Макрокоманда OpenForm
TOCTitle: OpenForm macro action
ms:assetid: c519a9d7-99d4-4765-ad96-59c3fe1be9e3
ms:mtpsurl: https://msdn.microsoft.com/library/Ff823095(v=office.15)
ms:contentKeyID: 48547604
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: cf89b61a65c11f09d5a07e52caeee5ad416c118a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288373"
---
# <a name="openform-macro-action"></a>Макрокоманда OpenForm

**Область применения**: Access 2013, Office 2013

Вы можете использовать действие **OpenForm** для открытия формы в представлении формы, представлении дизайна, предварительной печати или представлении таблицы данных. Он позволяет выбирать режим ввода данных и режим окна для формы, а также ограничивать количество записей, отображаемых в форме.

## <a name="setting"></a>Параметр

Действие **OpenForm** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Имя формы</strong></p></td>
<td><p>Имя формы для открытия. Поле <strong>Имя формы</strong> в разделе <strong>Аргументы</strong> действий в области Macro Builder отображает все формы в текущей базе данных. Это обязательный аргумент. Если вы запустите макрос, содержащий действие <strong>OpenForm</strong> в базе данных библиотеки, Microsoft Access сначала ищет форму с этим именем в базе данных библиотеки, а затем в текущей базе данных.</p></td>
</tr>
<tr class="even">
<td><p><strong>View</strong></p></td>
<td><p>Представление, в котором откроется форма. Щелкните <strong>форму,</strong> <strong>дизайн,</strong> <strong>предварительный</strong>просмотр <strong>печати,</strong>таблицу <strong></strong> данных, таблицу <strong>pivotTable</strong>или сводная диаграмма в <strong>поле Просмотр.</strong> По умолчанию является <strong>Form</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong> <STRONG>Параметр аргумента View</STRONG> переопределяет параметры свойств <STRONG>DefaultView</STRONG> формы и <STRONG>ViewsAllowed.</STRONG> Например, если свойство <STRONG>ViewsAllowed</STRONG> формы настроено на <STRONG>таблицу Datasheet,</STRONG>можно использовать действие <STRONG>OpenForm</STRONG> для открытия формы в представлении Формы.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя фильтра</strong></p></td>
<td><p>Фильтр, который ограничивает или сортит записи формы. Можно ввести имя существующего запроса или фильтра, сохраненного в качестве запроса. Однако запрос должен включать все поля в открываемой форме или иметь свойство <strong>OutputAllFields,</strong> за набором <strong>да.</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>Где состояние</strong></p></td>
<td><p>Допустимый SQL where (без слова WHERE) или выражение, которое Access использует для выбора записей из таблицы или запроса формы. Если выбрать фильтр с аргументом <strong>Имя фильтра,</strong> Access применяет этот пункт WHERE к результатам фильтра. Чтобы открыть форму и ограничить ее записи теми, которые указаны значением управления в другой форме, используйте следующее выражение: <strong>[</strong><em>имя</em>поля ]<strong>= Forms![</strong> <em>formname</em><strong>]! [</strong><em>имя управления в</em>другой <em></em> <strong>форме] Замените</strong> имя поля на имя поля в таблице или запросе формы, которая должна открыться. <em>Замените</em> имя <em></em> формы и имя управления в другой форме с именем другой формы и управлением в другой форме, которая содержит необходимое значение записей в первой форме для совпадения.</p><p><strong>ПРИМЕЧАНИЕ.</strong>Максимальная длина аргумента <STRONG>Where Condition</STRONG> — 255 символов. Если требуется ввести более сложный пункт SQL WHERE дольше, используйте метод <STRONG>OpenForm</STRONG> объекта <STRONG>DoCmd</STRONG> в модуле Visual Basic для приложений (VBA). Вы можете ввести SQL, где в VBA можно ввести утверждения о клаузулах до 32 768 знаков.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Режим данных</strong></p></td>
<td><p>Режим ввода данных для формы. Это относится только к формам, открываемым в режиме формы или режиме таблицы. Щелкните <strong>Добавить</strong> (пользователь может добавлять новые записи, но не может изменять существующие записи), <strong></strong> изменить (пользователь может изменять существующие записи и добавлять новые записи) или <strong>Только</strong> для чтения (пользователь может просматривать только записи). По умолчанию <strong>изменить</strong>. <strong>Примечания</strong></p>
<ul>
<li><p>Параметр <strong>аргумента Режим</strong> данных переопределяет параметры свойств <strong>AllowEdits</strong>формы, <strong>AllowDeletions,</strong> <strong>AllowAdditions</strong>и <strong>DataEntry.</strong> Например, если свойство <strong>AllowEdits</strong> формы настроено на <strong>"Нет",</strong>можно использовать действие <strong>OpenForm</strong> для открытия формы в режиме Редактирования.</p></li>
<li><p>Если оставить этот аргумент пустым, Access открывает форму в режиме ввода данных, заданной свойствами <strong>AllowEdits,</strong> <strong>AllowDeletions,</strong> <strong>AllowAdditions</strong>и <strong>DataEntry.</strong></p></li>
</ul>
<p></p></td>
</tr>
<tr class="even">
<td><p><strong>Режим окна</strong></p></td>
<td><p>Режим окна, в котором открывается форма. Щелкните <strong>Normal</strong> (форма открывается в режиме, задаваемом его свойствами), <strong>Hidden</strong> (форма скрыта), <strong>Icon</strong> (форма открывается свести к минимуму как небольшая строка заголовка в нижней части экрана) или <strong>Диалоговое</strong> окно (свойства <strong>Modal</strong> и <strong>PopUp</strong> формы задаваются <strong>да).</strong> По умолчанию является <strong>нормальным</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong>Некоторые <STRONG>параметры аргумента в</STRONG> режиме окна не применяются при использовании документов на вкладке. Чтобы перейти на перекрывающиеся окна:</p>
<ol>
<li><p>Щелкните вкладку File и нажмите кнопку <strong>Параметры</strong>.</p></li>
<li><p>В <strong>диалоговом окне Параметры</strong> доступа щелкните <strong>Текущая база данных</strong>.</p></li>
<li><p>В разделе <strong>Параметры приложений</strong>в <strong>разделе Параметры окна документов</strong>нажмите <strong>кнопку Перекрытие Windows</strong>.</p></li>
<li><p>Нажмите <strong>кнопку ОК,</strong>затем закроем и снова откроете базу данных.</p></li>
</ol></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

Это действие аналогично дважды щелкнуть форму в области навигации или щелкнуть правой кнопкой мыши форму в области навигации, а затем выбрать представление.

Форма может быть модальной (она должна быть закрыта или скрыта перед выполнением пользователем любых других действий) или без режима (пользователь может перейти в другие окна, пока форма открыта). Это может быть всплывающее окно (форма, используемая для сбора или отображения информации, которая остается на верхней части всех остальных окон Access). При разработке формы вы задали свойства **Modal** и **PopUp.** Если используется **аргумент Normal** для **аргумента Window Mode,** форма открывается в режиме, заданном этими настройками свойств. Если вы используете **диалоговое окно** для **аргумента Режим окна,** эти свойства за набором **да**. Форма, открытая как скрытая или как значок, возвращается в режим, заданный его настройками свойств при показе или восстановлении.

Когда вы открываете форму с аргументом **Window Mode** set to **Dialog,** Access приостанавливать макрос, пока форма не будет закрыта или скрыта. Вы можете скрыть форму, установив **ее** видимое свойство **"Нет",** используя **действие SetValue.**

> [!TIP]
> Вы можете выбрать форму в области навигации и перетаскивать ее в строку действий макроса. Это автоматически создает действие **OpenForm,** которое открывает форму в представлении Формы.

Фильтр и условия WHERE, которые вы применяли, становятся параметром свойства **Фильтр формы.**

## <a name="examples"></a>Примеры

**Установка значения элемента управления с помощью макроса**

Следующий макрос открывает форму "Добавить товары" с помощью кнопки в форме "Поставщики". Он демонстрирует применение макрокоманд **ВыводНаЭкран**, **ЗакрытьОкно**, **ОткрытьФорму**, **ЗадатьЗначение** и **КЭлементуУправления**. Действие **SetValue задает** контроль поставщика в форме Продуктов текущему поставщику в форме Поставщики. Затем **действие GoToControl** перемещает фокус в поле Category ID, где можно начать ввод данных для нового продукта. Этот макрос должен быть привязан к кнопке "Добавить товары" в форме "Поставщики".

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Макрокоманда</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Примечание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>ВыводНаЭкран</strong></p></td>
<td><p><strong>Включить вывод</strong>: <strong>Нет</strong></p></td>
<td><p>Приостанавливает обновление экрана, пока выполняется макрос.</p></td>
</tr>
<tr class="even">
<td><p><strong>ЗакрытьОкно</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>FormObject Имя</strong>: Список товаров <strong>Сохранить</strong>: <strong>Нет</strong></p></td>
<td><p>Закрывает форму "Список товаров".</p></td>
</tr>
<tr class="odd">
<td><p><strong>ОткрытьФорму</strong></p></td>
<td><p><strong>Имя формы</strong>: Товары <strong>Представление</strong>: <strong>FormData Режим</strong>: <strong>AddWindow Режим</strong>: <strong>Обычный</strong></p></td>
<td><p>Открывает форму "Товары".</p></td>
</tr>
<tr class="even">
<td><p><strong>ЗадатьЗначение</strong></p></td>
<td><p><strong>Элемент</strong>: [Forms]![Товары]![КодПоставщика] <strong>Выражение</strong>: КодПоставщика</p></td>
<td><p>Установите контроль поставщика для текущего поставщика в форме Поставщики.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КЭлементуУправления</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: КодКатегории</p></td>
<td><p>Перейдите к контролю category ID.</p></td>
</tr>
</tbody>
</table>


Следующий макрос открывает форму Списка продуктов в нижнем правом углу формы Поставщики, отображая продукты текущего поставщика. В нем показано использование действий **Echo,** **MessageBox,** **GoToControl,** **StopMacro,** **OpenForm** и **MoveAndSizeWindow.** В нем также показано использование условного выражения с **действиями MessageBox,** **GoToControl** и **StopMacro.** Этот макрос следует прикрепить к кнопке Review Products в форме Поставщики.

**Синхронизация форм с помощью макроса**

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Условие</p></th>
<th><p>Макрокоманда</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Примечание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p></p></td>
<td><p><strong>ВыводНаЭкран</strong></p></td>
<td><p><strong>Включить вывод</strong>: <strong>Нет</strong></p></td>
<td><p>Приостанавливает обновление экрана, пока выполняется макрос.</p></td>
</tr>
<tr class="even">
<td><p>IsNull([SupplierID])</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение.</strong>Перейдите к записи поставщика, продукты которого вы хотите видеть, а затем нажмите кнопку Обзор продуктов снова. <strong>Звуковой сигнал</strong>: <strong>YesType</strong>: <strong>NoneTitle</strong>: Выберите поставщика</p></td>
<td><p>Если в форме Поставщики нет текущего поставщика, отобразить сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя управления:</strong>CompanyName</p></td>
<td><p>Переместите фокус на управление CompanyName.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p><strong>StopMacro</strong></p></td>
<td><p></p></td>
<td><p>Остановите макрос.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p><strong>OpenForm</strong></p></td>
<td><p><strong>Имя формы</strong>: Представление списка <strong>продуктов:</strong> <strong>Имя DatasheetFilter</strong>: Where <strong>Condition</strong>: [SupplierID] = [Forms]! [Поставщики]! [SupplierID] <strong>Режим данных:</strong> <strong>Режим чтения OnlyWindow</strong>: <strong>Нормальный</strong></p></td>
<td><p>Откройте форму списка продуктов и покажите продукты текущего поставщика.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p><strong>MoveAndSizeWindow</strong></p></td>
<td><p><strong>Справа</strong>: 0.7799 &quot; <strong>Вниз</strong>: 1.8&quot;</p></td>
<td><p>Расположить форму списка продуктов в нижнем праве формы Поставщики.</p></td>
</tr>
</tbody>
</table>


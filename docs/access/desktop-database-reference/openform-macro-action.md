---
title: Макрокоманда OpenForm
TOCTitle: OpenForm macro action
ms:assetid: c519a9d7-99d4-4765-ad96-59c3fe1be9e3
ms:mtpsurl: https://msdn.microsoft.com/library/Ff823095(v=office.15)
ms:contentKeyID: 48547604
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: cf89b61a65c11f09d5a07e52caeee5ad416c118a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288373"
---
# <a name="openform-macro-action"></a>Макрокоманда OpenForm

**Область применения**: Access 2013, Office 2013

Макрокоманда «ОткрытьФорму» ( **OpenForm** ) позволяет открыть форму в режиме формы, конструктора, просмотра или таблицы. Он позволяет выбирать режим ввода данных и режим окна для формы, а также ограничивать количество записей, отображаемых в форме.

## <a name="setting"></a>Параметр

Макрокоманда «ОткрытьФорму» ( **OpenForm** ) использует следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Имя формы</strong></p></td>
<td><p>Имя открываемой формы. В поле <strong>имя формы</strong> в разделе <strong>аргументы макрокоманды</strong> области построителя макросов отображаются все формы в текущей базе данных. Обязательный аргумент. При запуске макроса, содержащего макрокоманду "ОткрытьФорму" ( <strong>OpenForm</strong> ), в библиотечной базе данных Microsoft Access сначала ищет форму с этим именем в библиотечной базе данных, а затем в текущей базе данных.</p></td>
</tr>
<tr class="even">
<td><p><strong>View</strong></p></td>
<td><p>Представление, в котором будет открыта форма. В поле <strong>вид</strong> выберите <strong>форма</strong>, <strong>Макет</strong>, <strong></strong> <strong>Предварительный просмотр</strong>, таблица, <strong>Сводная таблица</strong>или <strong>Сводная диаграмма</strong> . По умолчанию используется <strong>форма</strong>.</p><p><strong>Note</strong>: значение аргумента <STRONG>View</STRONG> переопределяет параметры свойства <STRONG>DefaultView</STRONG> формы и свойства <STRONG>виевсалловед</STRONG> . Например, если для свойства формы <STRONG>виевсалловед</STRONG> задано значение <STRONG>Таблица</STRONG>, по-прежнему можно использовать макрокоманду "ОткрытьФорму" ( <STRONG>OpenForm</STRONG> ), чтобы открыть форму в представлении формы.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя фильтра</strong></p></td>
<td><p>Фильтр, который запрещает или сортирует записи формы. Можно ввести имя существующего запроса или фильтра, сохраненного в виде запроса. Однако запрос должен включать все поля в форме, которые вы открываете, или задать для свойства <strong>OutputAllFields</strong> значение <strong>"Да"</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Условие отбора</strong></p></td>
<td><p>Допустимое предложение WHERE (без слова WHERE) или выражение, которое Access использует для выбора записей из базовой таблицы или запроса формы. Если выбран фильтр с аргументом <strong>имя фильтра</strong> , Access применяет это предложение WHERE к результатам фильтра. Чтобы открыть форму и ограничить записи записями, указанными в значении элемента управления в другой форме, используйте следующее выражение: <strong>[</strong><em>fieldname</em><strong>] = Forms! [</strong> <em>FormName</em> <strong>]! [</strong><em>контролнаме в другой форме</em><strong>]</strong> замените <em>fieldname</em> именем поля в базовой таблице или запросе формы, которую нужно открыть. Замените <em>FormName</em> и <em>контролнаме в другой форме</em> , указав имя другой формы и элемент управления в другой форме, который содержит значение, в котором будут сопоставлены записи в первой форме.</p><p><strong>Note</strong>: максимальная длина аргумента <STRONG>условия WHERE</STRONG> — 255 символов. Если необходимо ввести более сложное предложение WHERE SQL, более длинное, используйте метод <STRONG>OpenForm</STRONG> объекта DoCmd в <STRONG></STRONG> модуле Visual Basic для приложений (VBA). Вы можете ввести инструкции SQL WHERE, содержащие до 32 768 символов в VBA.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Режим данных</strong></p></td>
<td><p>Режим ввода данных для формы. Это относится только к формам, открываемым в режиме формы или режиме таблицы. Нажмите кнопку <strong>Добавить</strong> (пользователь может добавлять новые записи, но не может изменять существующие), <strong>изменять</strong> (пользователь может изменять существующие записи и добавлять новые записи) или <strong>только для чтения</strong> (пользователи могут только просматривать записи). Значение по умолчанию — <strong>Edit</strong>. <strong>Notes</strong></p>
<ul>
<li><p>Параметр <strong>режим данных</strong> в аргументе переопределяет параметры свойств <strong>AllowEdits</strong>, <strong>алловделетионс</strong>, <strong>алловаддитионс</strong>и <strong>DataEntry</strong> формы. Например, если свойству <strong>AllowEdits</strong> формы присвоено значение <strong>нет</strong>, вы по-прежнему можете открыть форму в режиме редактирования с помощью макрокоманды "ОткрытьФорму" ( <strong>OpenForm</strong> ).</p></li>
<li><p>Если оставить этот аргумент пустым, Access открывает форму в режиме ввода данных, заданном в свойствах <strong>AllowEdits</strong>, <strong>алловделетионс</strong>, <strong>алловаддитионс</strong>и <strong>DataEntry</strong> формы.</p></li>
</ul>
<p></p></td>
</tr>
<tr class="even">
<td><p><strong>Режим окна</strong></p></td>
<td><p>Режим окна, в котором открывается форма. Нажмите кнопку <strong>обычный</strong> (форма открывается в режиме, заданном его свойствами), <strong>скрыто</strong> (форма скрыта), <strong>значок</strong> (форма открывается в свернутом виде в нижней части экрана) или диалоговое <strong>окно</strong> ( <strong>модальное</strong> и всплывающее окно формы <strong> </strong>для свойств задано значение <strong>"Да"</strong>). Значение по умолчанию — <strong>Normal</strong>.</p><p><strong>Note</strong>: некоторые параметры аргументов <STRONG>режима окна</STRONG> не применяются при использовании документов с вкладками. Чтобы переключиться на перекрывающиеся окна:</p>
<ol>
<li><p>Перейдите на вкладку файл и нажмите кнопку <strong>Параметры</strong>.</p></li>
<li><p>В диалоговом окне " <strong>Параметры Access</strong> " щелкните <strong>Текущая база данных</strong>.</p></li>
<li><p>В разделе Параметры <strong>приложения</strong>в разделе <strong>Параметры окна документа</strong>щелкните перекрывающиеся <strong>окна</strong>.</p></li>
<li><p>Нажмите кнопку <strong>ОК</strong>, а затем закройте и снова откройте базу данных.</p></li>
</ol></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

Это действие аналогично двойному щелчку формы в области навигации или щелчку правой кнопкой мыши формы в области навигации и последующему выбору представления.

Форма может быть модальной (ее необходимо закрыть или скрыть до того, как пользователь сможет выполнять какие-либо другие действия) или немодальные (пользователь может перемещаться в другие окна, пока форма открыта). Это также может быть всплывающая форма (форма, используемая для сбора и отображения информации, которая остается в верхней части всех остальных окон Access). Свойства модальных **** и **всплывающих окон** задаются при разработке формы. Если вы используете параметр **Normal** для аргумента **Window Mode** , форма откроется в режиме, определяемом параметрами этих свойств. Если вы используете **диалоговОе окно** для аргумента **mode Window** , для обоих свойств устанавливается значение **Да**. Форма, открытая как скрытая или как значок, возвращается в режим, заданный параметрами его свойства при его отображении или восстановлении.

Когда вы открываете форму с диалоговым окном аргумента **** **режим окна** , Access приостанавливает макрос до тех пор, пока форма не будет закрыта или скрыта. Вы можете скрыть форму, задав для ее свойства **Visible** значение **нет** , используя действие **SetValue** .

> [!TIP]
> Вы можете выбрать форму в области навигации и перетащить ее в строку макрокоманды. При этом автоматически создается макрокоманда "ОткрытьФорму" ( **OpenForm** ), которая открывает форму в режиме формы.

Фильтр и условие, где вы хотите применить, становятся значением свойства **Filter** формы.

## <a name="examples"></a>Примеры

**Задание значения элемента управления с помощью макроса**

Следующий макрос открывает форму "Добавление продуктов" на кнопке в форме "поставщики". В нем показано использование действий **echo**, **клосевиндов**, **OpenForm**, **SetValue**и **КЭлементуУправления** . Действие **SetValue** устанавливает для элемента управления "идентификатор поставщика" в форме "продукты" текущего поставщика в форме "поставщики". После этого действие " **КЭлементуУправления** " переместит фокус на поле "идентификатор категории", в котором можно начать ввод данных для нового продукта. Этот макрос должен быть присоединен к кнопке "добавить продукты" в форме "поставщики".

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Действие</p></th>
<th><p>Аргументы: Настройка</p></th>
<th><p>Комментарий</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Echo</strong></p></td>
<td><p><strong>Echo on</strong>: <strong>нет</strong></p></td>
<td><p>Остановить обновление экрана во время выполнения макроса.</p></td>
</tr>
<tr class="even">
<td><p><strong>Клосевиндов</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>Формобжект Name</strong>: List Product <strong>Save</strong>: <strong>No</strong></p></td>
<td><p>Закройте форму "список товаров".</p></td>
</tr>
<tr class="odd">
<td><p><strong>OpenForm</strong></p></td>
<td><p><strong>Имя формы</strong>: " <strong>Просмотр</strong>продуктов: <strong>режим формдата</strong>: режим <strong>аддвиндов</strong>: <strong>обычный</strong> "</p></td>
<td><p>Откройте форму продукты.</p></td>
</tr>
<tr class="even">
<td><p><strong>SetValue</strong></p></td>
<td><p><strong>Элемент</strong>: [Forms]! [Products]! Ключев <strong>Выражение</strong>: КодПоставщика</p></td>
<td><p>В форме Поставщики задайте для элемента управления "идентификатор поставщика" текущего поставщика.</p></td>
</tr>
<tr class="odd">
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: КодТипа</p></td>
<td><p>Перейдите к элементу управления ИДЕНТИФИКАТОРом категории.</p></td>
</tr>
</tbody>
</table>


Следующий макрос открывает форму списка товаров в правом нижнем углу формы поставщики, в которой отображаются продукты текущего поставщика. В нем показано использование действий **echo**, **MessageBox**, **КЭлементуУправления**, **Макрокоманда StopMacro**, **OpenForm**и **мовеандсизевиндов** . В нем также показано использование условного выражения с действиями **MessageBox**, **КЭлементуУправления**и **Макрокоманда StopMacro** . Этот макрос необходимо прикрепить к кнопке "проверить продукты" в форме "поставщики".

**Синхронизация форм с помощью макроса**

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Условие</p></th>
<th><p>Действие</p></th>
<th><p>Аргументы: Настройка</p></th>
<th><p>Комментарий</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p></p></td>
<td><p><strong>Echo</strong></p></td>
<td><p><strong>Echo on</strong>: <strong>нет</strong></p></td>
<td><p>Остановить обновление экрана во время выполнения макроса.</p></td>
</tr>
<tr class="even">
<td><p>IsNull ([КодПоставщика])</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение</strong>: перейдите к записи поставщика, продукты которой вы хотите просмотреть, а затем снова нажмите кнопку Просмотр продуктов. <strong>Beep</strong>: <strong>естипе</strong>: <strong>нонетитле</strong>: выберите поставщика</p></td>
<td><p>Если в форме Поставщики нет текущего поставщика, отобразите сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: CompanyName</p></td>
<td><p>Перемещение фокуса на элемент управления CompanyName.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p><strong>StopMacro</strong></p></td>
<td><p></p></td>
<td><p>Остановка макроса.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p><strong>OpenForm</strong></p></td>
<td><p><strong>Имя формы</strong>: <strong>представление</strong>списка продуктов: <strong>даташитфилтер Name</strong>: <strong>WHERE Condition</strong>: [КодПоставщика] = [Forms]! [Поставщики]! Ключев <strong>Режим данных</strong>: <strong>режим чтения онливиндов</strong>: <strong>обычный</strong></p></td>
<td><p>Откройте форму Список продуктов и отобразите текущие продукты поставщика.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p><strong>Мовеандсизевиндов</strong></p></td>
<td><p><strong>Right</strong>: 0,7799&quot; <strong>вниз</strong>: 1,8&quot;</p></td>
<td><p>РасПоложите форму списка товаров в правом нижнем углу формы Поставщики.</p></td>
</tr>
</tbody>
</table>


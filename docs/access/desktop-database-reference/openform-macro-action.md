---
title: OpenForm Macro Action
TOCTitle: OpenForm Macro Action
ms:assetid: c519a9d7-99d4-4765-ad96-59c3fe1be9e3
ms:mtpsurl: https://msdn.microsoft.com/library/Ff823095(v=office.15)
ms:contentKeyID: 48547604
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: ba0314fff63014b36565b178f97950660ffec14f
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2018
ms.locfileid: "25482789"
---
# <a name="openform-macro-action"></a>OpenForm Macro Action


**Применимо к**: Access 2013 | Office 2013


**ОткрытьФорму** можно использовать для открытия формы в режиме формы, режиме конструктора, предварительный или представление таблицы данных. Можно выбрать режимы запись и окно данных для формы и ограничить записи, которые отображаются в форме.

## <a name="setting"></a>Параметр

**ОткрытьФорму** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Имя формы</strong></p></td>
<td><p>Имя формы для ее открытия. В поле <strong>Имя формы</strong> в разделе <strong>Действие аргументы</strong> в области построения макросов показывает все формы в текущей базе данных. Обязательный аргумент. Если макрос, содержащий <strong>ОткрытьФорму в базе данных библиотеки</strong> , Microsoft Access сначала выполняет поиск формы с указанным именем в базе данных библиотеки, а затем в текущей базе данных.</p></td>
</tr>
<tr class="even">
<td><p><strong>Просмотр</strong></p></td>
<td><p>Представление, в котором будет открыта форма. Выберите <strong>формы</strong>, <strong>разработки</strong>, <strong>Режим предварительного просмотра</strong>, <strong>таблицы</strong>, <strong>сводной таблицы</strong>или <strong>сводной диаграммы</strong> в поле <strong>View</strong> . Значение по умолчанию — <strong>формы</strong>.</p>

> [!NOTE]
> <P>Аргумент <STRONG>представления</STRONG> переопределяет параметры свойств <STRONG>режим по умолчанию</STRONG> и <STRONG>Допустимые режимы</STRONG> формы. Например если свойство <STRONG>Допустимые режимы</STRONG> формы задано для <STRONG>таблицы данных</STRONG>, по-прежнему можно использовать <STRONG>ОткрытьФорму</STRONG> для открытия формы в режиме формы.</P>


<p></p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя фильтра</strong></p></td>
<td><p>Фильтр, который ограничивает и сортировки записей формы. Можно ввести имя существующего запроса или фильтр, который был сохранен в виде запроса. Тем не менее запрос необходимо включить все поля в форме открытия или свойству <strong>Вывод всех полей</strong> , значение <strong>Да</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Условие отбора</strong></p></td>
<td><p>Оператор SQL WHERE (без слова ГДЕ) или выражение, которое следует использовать для выбора записей из формы базовым таблицы или запроса. Если выбран параметр аргумента <strong>Имя фильтра</strong> , доступа применяется это предложение WHERE к фильтру. Для открытия формы и отобрать те указанное значение элемента управления на другой формы ее записи, используйте следующее выражение: <strong>[</strong><em>fieldname</em><strong>] = Forms! [</strong> <em>имя_формы</em> <strong>]! [</strong><em>имяЭлементаВДругойФорме</em><strong>]</strong> <em>fieldname</em> замените имя поля в базовой таблице или запросе формы, который необходимо открыть. Замените имя другой формы и элемента управления в форме, которая содержит значение записей в первую форму в соответствии с <em>имя_формы</em> и <em>имяЭлементаВДругойФорме</em> .</p>

> [!NOTE]
> <P>Максимальная длина аргумента <STRONG>Условие</STRONG> составляет 255 знаков. Если необходимо ввести более сложных SQL предложение WHERE большее используйте метод <STRONG>ОткрытьФорму</STRONG> <STRONG>объекта</STRONG> в Visual Basic для приложений (VBA) модуля. Можно ввести предложение инструкции SQL до 32 768 знаков в VBA.</P>


<p></p></td>
</tr>
<tr class="odd">
<td><p><strong>Режим данных</strong></p></td>
<td><p>Режим ввода данных для формы. Это относится только к формах, открытых в режиме формы или таблицы. Нажмите кнопку <strong>Add</strong> (пользователь может добавлять новые записи, но не могут изменять существующие записи), <strong>Изменение</strong> (пользователь может изменять существующие записи и добавление новых записей), или <strong>Только для чтения</strong> (пользователь может только просматривать записи). Значение по умолчанию — <strong>Изменить</strong>. <strong>Примечания</strong></p>
<ul>
<li><p>Аргумент <strong>Режим данных</strong> переопределяет параметры свойств <strong>AllowEdits</strong>, <strong>AllowDeletions</strong>, <strong>AllowAdditions</strong>и <strong>DataEntry</strong> формы. Например если свойство <strong>AllowEdits</strong> формы задано значение <strong>No</strong>, по-прежнему можно использовать <strong>ОткрытьФорму</strong> для открытия формы в режиме редактирования.</p></li>
<li><p>Если оставить этот аргумент пустым, форма будет открыта в режиме ввода данных, от <strong>AllowEdits</strong>, <strong>AllowDeletions</strong>, <strong>AllowAdditions</strong>и <strong>DataEntry</strong> свойств формы.</p></li>
</ul>
<p></p></td>
</tr>
<tr class="even">
<td><p><strong>Режим окна</strong></p></td>
<td><p>Режим окна, в котором открывается форма. Нажмите кнопку <strong>Normal</strong> (форма открывается в режиме, от его свойств), <strong>Hidden</strong> (форма скрыта), <strong>значок</strong> (свернутом виде малого заголовка в нижней части экрана откроется форма), или <strong>диалоговое окно</strong> ( <strong>модальные окна</strong> и формы <strong>контекстного меню </strong>задано значение <strong>Да</strong>). Значение по умолчанию — <strong>Normal</strong>.</p>

> [!NOTE]
> <P>Некоторые параметры аргумент <STRONG>Режим окна</STRONG> не применяются при использовании документов с вкладками. Чтобы переключиться на перекрывающиеся windows:</P>


<p></p>
<ol>
<li><p>Перейдите на вкладку файл и нажмите кнопку <strong>Параметры</strong>.</p></li>
<li><p>В диалоговом окне <strong>Параметры доступа</strong> щелкните <strong>Текущей базы данных</strong>.</p></li>
<li><p>В разделе <strong>Параметры приложения</strong>в разделе <strong>Параметры окна документа</strong>нажмите кнопку <strong>Перекрывающиеся Windows</strong>.</p></li>
<li><p>Нажмите кнопку <strong>ОК</strong>, а затем закройте и снова откройте базу данных.</p></li>
</ol></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

Это действие аналогично дважды щелкнув формы в области навигации или щелкнув правой кнопкой мыши форму в области навигации, а затем выбрав представления.

Форма может быть модальные окна (его необходимо быть закрыт или скрытым, прежде чем пользователь может выполнять любые другие действия) или немодальной (пользователь может перейти в другое время, пока открыта форма). Он также может быть как всплывающая форма (форма, используемая для сбора или отображение сведений остается поверх других окон Access). **Модальное** **всплывающее** окно задать при разработке формы. Если вы используете **Normal** для аргумента **Режим окна** , форма открывается в режиме, указанного идентификатором эти параметры свойств. Если вы используете **диалоговое окно** для аргумента **Режим окна** , эти свойства задаются значение **Да**. Возвращает формы, открывается как скрытый или значка для режима, указанного с его параметры свойств, когда экран или восстановлении.

При открытии формы с аргументом **Режим окна** , задайте значение **диалоговое окно**макроса приостанавливается до закрытия формы или скрытым. Чтобы скрыть форму, значения свойства **Visible** **No** с помощью **макрокоманды** .


> [!TIP]
> <P>Можно выбрать форму в области навигации и перетащите его в строку действие в макросе. Это автоматически создает <STRONG>ОткрытьФорму</STRONG> действие, которое открывается форма в представлении формы.</P>



Фильтр и условия WHERE, применяемые становятся значением свойства **фильтра** формы.

## <a name="examples"></a>Примеры

**Задайте значение элемента управления с помощью макроса**

Следующий макрос открывает форму добавления продуктов с помощью кнопки на форме Поставщики. Демонстрируется использование **эхо**, **CloseWindow**, **ОткрытьФорму**, **SetValue**и **КЭлементуУправления** действий. Действие **SetValue** задает код поставщика управления на форме продуктов для текущего поставщика в форме Поставщики. **Затем КЭлементуУправления** перемещает фокус в поле Идентификатор категории, где можно вводить данные для нового продукта. Этот макрос должен быть связан с кнопкой Добавить продукты в форме Поставщики.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Действие</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Эхо</strong></p></td>
<td><p><strong>Вывод на экран</strong>: <strong>Нет</strong></p></td>
<td><p>Остановите обновление экрана в процессе выполнения макроса.</p></td>
</tr>
<tr class="even">
<td><p><strong>CloseWindow</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>FormObject имя</strong>: продукт списка <strong>Сохранить</strong>: <strong>Нет</strong></p></td>
<td><p>Закройте форму списка продуктов.</p></td>
</tr>
<tr class="odd">
<td><p><strong>ОткрытьФорму</strong></p></td>
<td><p><strong>Имя формы</strong>: продуктов <strong>представления</strong>: <strong>FormData режима</strong>: <strong>Режим AddWindow</strong>: <strong>Обычный</strong></p></td>
<td><p>Откройте форму продуктов.</p></td>
</tr>
<tr class="even">
<td><p><strong>SetValue</strong></p></td>
<td><p><strong>Элемент</strong>: [формы]! [Товары]! [Код поставщика] <strong>Выражение</strong>: КодПоставщика</p></td>
<td><p>Значение текущего поставщика управления код поставщика в форме Поставщики.</p></td>
</tr>
<tr class="odd">
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: идентификатор категории</p></td>
<td><p>Перейдите к элементу управления идентификатор категории.</p></td>
</tr>
</tbody>
</table>


Следующий макрос открывает форму списка продуктов в правом нижнем углу формы Поставщики, отображение текущего поставщика продуктов. Демонстрируется использование **эхо**, **MessageBox**, **КЭлементуУправления**, **ОстановитьМакрос**, **ОткрытьФорму**и **MoveAndSizeWindow** действий. Также показано использование условного выражения с **MessageBox**, **КЭлементуУправления**« **Поставщики** ». Этот макрос должен быть связан с кнопкой Обзор продуктов в форме Поставщики.

**Синхронизация форм с помощью макроса (en)**

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Condition</p></th>
<th><p>Действие</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p></p></td>
<td><p><strong>Эхо</strong></p></td>
<td><p><strong>Вывод на экран</strong>: <strong>Нет</strong></p></td>
<td><p>Остановите обновление экрана в процессе выполнения макроса.</p></td>
</tr>
<tr class="even">
<td><p>IsNull([SupplierID])</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение</strong>: перемещение на запись поставщика, продукты, чтобы увидеть, затем нажмите кнопку Предварительный просмотр еще раз. <strong>Звуковые сигналы</strong>: <strong>YesType</strong>: <strong>NoneTitle</strong>: Выбор поставщика</p></td>
<td><p>При отсутствии никто из современных поставщиков в форме Поставщики, отображается сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: CompanyName</p></td>
<td><p>Перемещение фокуса на элемент управления CompanyName.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p><strong>StopMacro</strong></p></td>
<td><p></p></td>
<td><p>Остановка макроса.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p><strong>ОткрытьФорму</strong></p></td>
<td><p><strong>Имя формы</strong>: список продуктов <strong>представления</strong>: <strong>Имя DatasheetFilter</strong>: <strong>условие отбора</strong>: [код поставщика] = [Forms]! [Поставщики]! [Код поставщика] <strong>Режим данных</strong>: <strong>Режим чтения OnlyWindow</strong>: <strong>Обычный</strong></p></td>
<td><p>Откройте форму списка продуктов и отображение текущего поставщика продуктов.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p><strong>MoveAndSizeWindow</strong></p></td>
<td><p><strong>Право</strong>: 0,7799&quot; <strong>вниз</strong>: 1,8&quot;</p></td>
<td><p>Положение формы списка продуктов в нижней правой части формы Поставщики.</p></td>
</tr>
</tbody>
</table>


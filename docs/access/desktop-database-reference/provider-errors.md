---
title: Ошибки поставщика (Справочник по базам данных Access на компьютере)
TOCTitle: Provider errors
ms:assetid: 9c39d450-6e67-b2fd-aeb5-849e6b65fd54
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249710(v=office.15)
ms:contentKeyID: 48546592
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: d175cdaa007a354d12304dceff0352a923de2291
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32301129"
---
# <a name="provider-errors"></a>Ошибки поставщиков


**Область применения**: Access 2013, Office 2013 

При возникновении ошибки поставщика возвращается ошибка времени выполнения — 2147467259. При возникновении этой ошибки проверьте коллекцию **Errors** объекта Active **Connection** , которая будет содержать одну или несколько ошибок, описывающих, что произошло.

## <a name="the-ado-errors-collection"></a>Коллекция Errors ADO

Так как конкретная операция ADO может приводить к нескольким ошибкам поставщика, ADO предоставляет коллекцию объектов Error через объект **Connection** . Эта коллекция не содержит объектов, если операция завершается успешно и содержит один или несколько объектов **Error** , если что-то пошло не так, и поставщик вызвал одну или несколько ошибок. ИзУчите каждый отдельный объект Error, чтобы определить точную причину ошибки.

Завершив обработку всех произошедших ошибок, можно очистить коллекцию, вызвав метод **clear** . Особенно важно явным образом очистить коллекцию Errors **** перед вызовом метода Resync ****, **UpdateBatch**или **CancelBatch** для объекта **Recordset** — метод **Open** для **подключения** . объект или задайте свойство **Filter** для объекта **Recordset** . Если очистить коллекцию явным образом, можно убедиться в том, что все объекты **Error** в коллекции не остались за предыдущими операциями.

Некоторые операции могут создавать предупреждения и ошибки. Предупреждения также представлены объектами **Error** в коллекции Errors **** . Когда поставщик добавляет предупреждение в коллекцию, это не приводит к возникновению ошибки времени выполнения. Проверьте свойство **Count** коллекции Errors **** , чтобы определить, было ли предупреждение вызвано определенной операцией. Если число равно 1 или больше, в коллекцию добавляется объект **Error** . После определения того, что коллекция **Errors** содержит ошибки или предупреждения, можно выполнить итерацию по коллекции и получить сведения о каждом из содержащихся в ней объектов **Error** . В следующем примере на языке Visual Basic показано это:

```vb 
 
' BeginErrorHandlingVB02 
Private Function DeleteCustomer(ByVal CompanyName As String) As Long 
 On Error GoTo DeleteCustomerError 
 
 rst.Find "CompanyName='" & CompanyName & "'" 
 
DeleteCustomerError: 
 
 Dim objError As ADODB.Error 
 Dim strError As String 
 
 If cnn.Errors.Count > 0 Then 
 For Each objError In cnn.Errors 
 strError = strError & "Error #" & objError.Number & _ 
 " " & objError.Description & vbCrLf & _ 
 "NativeError: " & objError.NativeError & vbCrLf & _ 
 "SQLState: " & objError.SQLState & vbCrLf & _ 
 "Reported by: " & objError.Source & vbCrLf & _ 
 "Help file: " & objError.HelpFile & vbCrLf & _ 
 "Help Context ID: " & objError.HelpContext 
 Next 
 MsgBox strError 
 End If 
End Function 
' EndErrorHandlingVB02 
```

Процедура обработки ошибок включает цикл **for each** , который проверяет каждый объект в семействе Errors **** . В этом примере он просто накапливает сообщение для отображения. В работающей программе необходимо написать код для выполнения соответствующей задачи для каждой ошибки, например, для закрытия всех открытых файлов и завершения работы программы в надлежащем порядке.

## <a name="the-error-object"></a>Объект Error

Изучив объект **Error** , вы можете определить, какая ошибка возникла, и что важнее, какое приложение или какой объект вызвал ошибку. Объект **Error** имеет следующие свойства:

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя свойства</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Описание</strong></p></td>
<td><p>Текстовое описание возникшей ошибки.</p></td>
</tr>
<tr class="even">
<td><p><strong>HelpContext, HelpFile</strong></p></td>
<td><p>Ссылка на раздел справки и файл справки, содержащие описание возникшей ошибки.</p></td>
</tr>
<tr class="odd">
<td><p><strong>NativeError</strong></p></td>
<td><p>Номер ошибки, зависящий от поставщика.</p></td>
</tr>
<tr class="even">
<td><p><strong>Number</strong></p></td>
<td><p>Длинное целое число, представляющее число (указанное в <strong>еррорвалуинум</strong>) возникшей ошибки.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Source</strong></p></td>
<td><p>Указывает имя объекта или приложения, создавшего ошибку.</p></td>
</tr>
<tr class="even">
<td><p><strong>SQLState</strong></p></td>
<td><p>Код ошибки из пяти символов, который возвращает поставщик во время выполнения инструкции SQL.</p></td>
</tr>
</tbody>
</table>


Объект **Error** ADO похож на стандартный объект **Err** языка Visual Basic. Его свойства описывают возникшую ошибку. Кроме номера ошибки, вы также получаете два связанных фрагмента данных. Свойство **NativeError** содержит номер ошибки, относящийся к используемому поставщику. В предыдущем примере поставщиком является поставщик Microsoft OLE DB для SQL Server, поэтому **NativeError** будет содержать ошибки, характерные для SQL Server. Свойство **SQLSTATE** имеет пятизначный код, описывающий ошибку в операторе SQL.

## <a name="event-related-errors"></a>Ошибки, связанные с событиями

Объект **Error** также используется при возникновении ошибок, связанных с событиями. Вы можете определить, произошла ли ошибка в процессе, который вызвал событие ADO, проверив объект **Error** , переданный в качестве параметра события.

Если операция, вызывающая событие, завершается успешно, параметру *адстатус* обработчика событий будет присвоено значение *адстатусок*. С другой стороны, если не удалось выполнить операцию, вызвавшую событие, параметру *адстатус* присвоено значение *адстатусеррорсоккурред*. В этом случае параметр *перрор* будет содержать объект **Error** с описанием ошибки.


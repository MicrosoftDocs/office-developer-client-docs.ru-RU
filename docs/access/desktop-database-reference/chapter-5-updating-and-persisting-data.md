---
title: 'Глава 5: Обновление и сохранение данных'
TOCTitle: 'Chapter 5: Updating and persisting data'
ms:assetid: 77acb763-1c60-1945-791d-3e83d684fb0d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249493(v=office.15)
ms:contentKeyID: 48545732
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: decb4eefa7c1215d8889fec85c22296d33eff40c
ms.sourcegitcommit: 38d0db57580cc5f4a0231c27b1643f8db5431ca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2018
ms.locfileid: "25937311"
---
# <a name="chapter-5-updating-and-persisting-data"></a><span data-ttu-id="d491c-102">Глава 5: Обновление и сохранение данных</span><span class="sxs-lookup"><span data-stu-id="d491c-102">Chapter 5: Updating and persisting data</span></span>

<span data-ttu-id="d491c-103">**Применимо к**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="d491c-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="d491c-104">Предыдущая главы рассматриваются способы использования ADO для получения данных в источнике данных, как просматривать данные и даже как для изменения данных.</span><span class="sxs-lookup"><span data-stu-id="d491c-104">The preceding chapters have discussed how to use ADO to get to data in a data source, how to move around in the data, and even how to edit the data.</span></span> <span data-ttu-id="d491c-105">Конечно Если целью приложения является разрешить пользователям изменять данные, необходимо понять, как сохранить изменения.</span><span class="sxs-lookup"><span data-stu-id="d491c-105">Of course, if the goal of your application is to allow users to make changes to the data, you will need to understand how to save those changes.</span></span> <span data-ttu-id="d491c-106">Либо можно сохранять изменения **записей** в файл с помощью метода **Сохранить** или отправке изменений обратно в источник данных для хранения данных с помощью метода **Update** или **UpdateBatch** .</span><span class="sxs-lookup"><span data-stu-id="d491c-106">You can either persist the **Recordset** changes to a file using the **Save** method, or you can send the changes back to the data source for storage using the **Update** or **UpdateBatch** methods.</span></span>

<span data-ttu-id="d491c-107">В предыдущем главы изменены данные в нескольких строках **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="d491c-107">In the preceding chapters, you changed the data in several rows of the **Recordset**.</span></span> <span data-ttu-id="d491c-108">ADO поддерживает две основные понятия, связанные с Добавление, удаление и изменение строк данных.</span><span class="sxs-lookup"><span data-stu-id="d491c-108">ADO supports two basic notions relating to the addition, deletion, and modification of rows of data.</span></span>

<span data-ttu-id="d491c-109">— Это первый общее представление о том, что не внесены изменения сразу же **набора записей**; Вместо этого они выполняются внутреннего *буфера копирования*.</span><span class="sxs-lookup"><span data-stu-id="d491c-109">The first notion is that changes aren't immediately made to the **Recordset**; instead, they are made to an internal *copy buffer*.</span></span> <span data-ttu-id="d491c-110">Если вы решили, что изменения не нужно, изменения в буфере копии будут удалены.</span><span class="sxs-lookup"><span data-stu-id="d491c-110">If you decide you don't want the changes, the modifications in the copy buffer are discarded.</span></span> <span data-ttu-id="d491c-111">Если необходимо сохранить изменения, изменения в буфер копирования применяются к **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="d491c-111">If you decide to keep the changes, the changes in the copy buffer are applied to the **Recordset**.</span></span>

<span data-ttu-id="d491c-112">Общее представление о второй — это изменения, либо распространить на источник данных, сразу же работы, объявляемые в строке полный (то есть, режим *интерпретации* ) или сбора все изменения в набор строк, пока не объявить рабочего набора завершения (это *пакетном* режиме).</span><span class="sxs-lookup"><span data-stu-id="d491c-112">The second notion is that changes are either propagated to the data source as soon as you declare the work on a row complete (that is, *immediate* mode), or all changes to a set of rows are collected until you declare the work for the set complete (that is, *batch* mode).</span></span> <span data-ttu-id="d491c-113">Свойство **LockType для** определяет при внесении изменений в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="d491c-113">The **LockType** property determines when the changes are made to the underlying data source.</span></span> <span data-ttu-id="d491c-114">**adLockOptimistic** или **adLockPessimistic** режим интерпретации, а **adLockBatchOptimistic** указывает пакетном режиме.</span><span class="sxs-lookup"><span data-stu-id="d491c-114">**adLockOptimistic** or **adLockPessimistic** specifies immediate mode, while **adLockBatchOptimistic** specifies batch mode.</span></span> <span data-ttu-id="d491c-115">Свойство **CursorLocation** влияет на доступные параметры **LockType для** .</span><span class="sxs-lookup"><span data-stu-id="d491c-115">The **CursorLocation** property can affect which **LockType** settings are available.</span></span> <span data-ttu-id="d491c-116">Например параметр **adLockPessimistic** не поддерживается, если свойство **CursorLocation** имеет значение **adUseClient**.</span><span class="sxs-lookup"><span data-stu-id="d491c-116">For instance, the **adLockPessimistic** setting is not supported if the **CursorLocation** property is set to **adUseClient**.</span></span>

<span data-ttu-id="d491c-117">В режиме интерпретации каждого вызова метода **Update** распространяет изменения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="d491c-117">In immediate mode, each invocation of the **Update** method propagates the changes to the data source.</span></span> <span data-ttu-id="d491c-118">В пакетном режиме каждого вызова **обновления** или перемещения из текущей позиции строки сохраняет изменения в буфер копирования, но только метод **UpdateBatch** распространяет изменения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="d491c-118">In batch mode, each invocation of **Update** or movement of the current row position saves the changes to the copy buffer, but only the **UpdateBatch** method propagates the changes to the data source.</span></span>

<span data-ttu-id="d491c-119">В этой главе рассматриваются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="d491c-119">This chapter covers the following topics:</span></span>

- [<span data-ttu-id="d491c-120">Обновление данных (ADO)</span><span class="sxs-lookup"><span data-stu-id="d491c-120">Updating data (ADO)</span></span>](updating-data.md)
- [<span data-ttu-id="d491c-121">Сохранение данных (ADO)</span><span class="sxs-lookup"><span data-stu-id="d491c-121">Persisting data (ADO)</span></span>](persisting-data.md)
---
title: 'Chapter 5: Updating and Persisting Data'
TOCTitle: 'Chapter 5: Updating and Persisting Data'
ms:assetid: 77acb763-1c60-1945-791d-3e83d684fb0d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249493(v=office.15)
ms:contentKeyID: 48545732
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 91c747c970988a9ca853f0be66f5c0b485f5c3f6
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2018
ms.locfileid: "25480063"
---
# <a name="chapter-5-updating-and-persisting-data"></a><span data-ttu-id="35adc-102">Chapter 5: Updating and Persisting Data</span><span class="sxs-lookup"><span data-stu-id="35adc-102">Chapter 5: Updating and Persisting Data</span></span>


<span data-ttu-id="35adc-103">**Применимо к**: Access 2013 | Office 2013</span><span class="sxs-lookup"><span data-stu-id="35adc-103">**Applies to**: Access 2013 | Office 2013</span></span>

<span data-ttu-id="35adc-104">Предыдущая главы рассматриваются способы использования ADO для получения данных в источнике данных, как просматривать данные и даже как для изменения данных.</span><span class="sxs-lookup"><span data-stu-id="35adc-104">The preceding chapters have discussed how to use ADO to get to data in a data source, how to move around in the data, and even how to edit the data.</span></span> <span data-ttu-id="35adc-105">Конечно Если целью приложения является разрешить пользователям изменять данные, необходимо понять, как сохранить изменения.</span><span class="sxs-lookup"><span data-stu-id="35adc-105">Of course, if the goal of your application is to allow users to make changes to the data, you will need to understand how to save those changes.</span></span> <span data-ttu-id="35adc-106">Либо можно сохранять изменения **записей** в файл с помощью метода **Сохранить** или отправке изменений обратно в источник данных для хранения данных с помощью метода **Update** или **UpdateBatch** .</span><span class="sxs-lookup"><span data-stu-id="35adc-106">You can either persist the **Recordset** changes to a file using the **Save** method, or you can send the changes back to the data source for storage using the **Update** or **UpdateBatch** methods.</span></span>

<span data-ttu-id="35adc-107">В предыдущем главы изменены данные в нескольких строках **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="35adc-107">In the preceding chapters, you changed the data in several rows of the **Recordset**.</span></span> <span data-ttu-id="35adc-108">ADO поддерживает две основные понятия, связанные с Добавление, удаление и изменение строк данных.</span><span class="sxs-lookup"><span data-stu-id="35adc-108">ADO supports two basic notions relating to the addition, deletion, and modification of rows of data.</span></span>

<span data-ttu-id="35adc-109">— Это первый общее представление о том, что не внесены изменения сразу же **набора записей**; Вместо этого они выполняются внутреннего *буфера копирования*.</span><span class="sxs-lookup"><span data-stu-id="35adc-109">The first notion is that changes aren't immediately made to the **Recordset**; instead, they are made to an internal *copy buffer*.</span></span> <span data-ttu-id="35adc-110">Если вы решили, что изменения не нужно, изменения в буфере копии будут удалены.</span><span class="sxs-lookup"><span data-stu-id="35adc-110">If you decide you don't want the changes, the modifications in the copy buffer are discarded.</span></span> <span data-ttu-id="35adc-111">Если необходимо сохранить изменения, изменения в буфер копирования применяются к **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="35adc-111">If you decide to keep the changes, the changes in the copy buffer are applied to the **Recordset**.</span></span>

<span data-ttu-id="35adc-112">Общее представление о второй — это изменения, либо распространить на источник данных, сразу же работы, объявляемые в строке полный (то есть, режим *интерпретации* ) или сбора все изменения в набор строк, пока не объявить рабочего набора завершения (это *пакетном* режиме).</span><span class="sxs-lookup"><span data-stu-id="35adc-112">The second notion is that changes are either propagated to the data source as soon as you declare the work on a row complete (that is, *immediate* mode), or all changes to a set of rows are collected until you declare the work for the set complete (that is, *batch* mode).</span></span> <span data-ttu-id="35adc-113">Свойство **LockType для** определяет при внесении изменений в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="35adc-113">The **LockType** property determines when the changes are made to the underlying data source.</span></span> <span data-ttu-id="35adc-114">**adLockOptimistic** или **adLockPessimistic** режим интерпретации, а **adLockBatchOptimistic** указывает пакетном режиме.</span><span class="sxs-lookup"><span data-stu-id="35adc-114">**adLockOptimistic** or **adLockPessimistic** specifies immediate mode, while **adLockBatchOptimistic** specifies batch mode.</span></span> <span data-ttu-id="35adc-115">Свойство **CursorLocation** влияет на доступные параметры **LockType для** .</span><span class="sxs-lookup"><span data-stu-id="35adc-115">The **CursorLocation** property can affect which **LockType** settings are available.</span></span> <span data-ttu-id="35adc-116">Например параметр **adLockPessimistic** не поддерживается, если свойство **CursorLocation** имеет значение **adUseClient**.</span><span class="sxs-lookup"><span data-stu-id="35adc-116">For instance, the **adLockPessimistic** setting is not supported if the **CursorLocation** property is set to **adUseClient**.</span></span>

<span data-ttu-id="35adc-117">В режиме интерпретации каждого вызова метода **Update** распространяет изменения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="35adc-117">In immediate mode, each invocation of the **Update** method propagates the changes to the data source.</span></span> <span data-ttu-id="35adc-118">В пакетном режиме каждого вызова **обновления** или перемещения из текущей позиции строки сохраняет изменения в буфер копирования, но только метод **UpdateBatch** распространяет изменения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="35adc-118">In batch mode, each invocation of **Update** or movement of the current row position saves the changes to the copy buffer, but only the **UpdateBatch** method propagates the changes to the data source.</span></span>


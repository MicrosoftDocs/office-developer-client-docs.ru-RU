---
title: Глава 5. Обновление и сохранение данных
TOCTitle: 'Chapter 5: Updating and persisting data'
ms:assetid: 77acb763-1c60-1945-791d-3e83d684fb0d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249493(v=office.15)
ms:contentKeyID: 48545732
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 18dd63acd733624fba522ee7382f305d34019905
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296432"
---
# <a name="chapter-5-updating-and-persisting-data"></a><span data-ttu-id="ca0f5-102">Глава 5. Обновление и сохранение данных</span><span class="sxs-lookup"><span data-stu-id="ca0f5-102">Chapter 5: Updating and persisting data</span></span>

<span data-ttu-id="ca0f5-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="ca0f5-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="ca0f5-104">В предыдущих главах обсуждалось, как использовать ADO для получения данных в источнике данных, перемещения по данным и даже для изменения данных.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-104">The preceding chapters have discussed how to use ADO to get to data in a data source, how to move around in the data, and even how to edit the data.</span></span> <span data-ttu-id="ca0f5-105">Конечно, если ваше приложение должно разрешить пользователям вносить изменения в данные, необходимо понять, как сохранить эти изменения.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-105">Of course, if the goal of your application is to allow users to make changes to the data, you will need to understand how to save those changes.</span></span> <span data-ttu-id="ca0f5-106">Вы можете сохранить изменения в **наборе записей** в файле с помощью метода **Save** или отправить изменения в источник данных для хранения с помощью методов **Update** или **UpdateBatch** .</span><span class="sxs-lookup"><span data-stu-id="ca0f5-106">You can either persist the **Recordset** changes to a file using the **Save** method, or you can send the changes back to the data source for storage using the **Update** or **UpdateBatch** methods.</span></span>

<span data-ttu-id="ca0f5-107">В предыдущих главах вы изменили данные в нескольких строках **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-107">In the preceding chapters, you changed the data in several rows of the **Recordset**.</span></span> <span data-ttu-id="ca0f5-108">ADO поддерживает два основных понятия, связанные с добавлением, удалением и изменением строк данных.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-108">ADO supports two basic notions relating to the addition, deletion, and modification of rows of data.</span></span>

<span data-ttu-id="ca0f5-109">Первое понятие заключается в том, что изменения не вносятся сразу в **набор записей**; Вместо этого они вносятся во внутренний *буфер копирования*.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-109">The first notion is that changes aren't immediately made to the **Recordset**; instead, they are made to an internal *copy buffer*.</span></span> <span data-ttu-id="ca0f5-110">Если вы решили, что изменения не нужны, изменения в буфере копирования отбрасываются.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-110">If you decide you don't want the changes, the modifications in the copy buffer are discarded.</span></span> <span data-ttu-id="ca0f5-111">Если вы решите сохранить изменения, то изменения, внесенные в буфер копирования, будут применены к **набору записей**.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-111">If you decide to keep the changes, the changes in the copy buffer are applied to the **Recordset**.</span></span>

<span data-ttu-id="ca0f5-112">Вторая идея состоит в том, что изменения либо распространяются в источник данных сразу же после объявления работы по строке завершен (то есть режим *интерпретации* ), или все изменения набора строк собираются до тех пор, пока не будет объявлена работа для инструкции SET Complete (то есть *пакетный* режим).</span><span class="sxs-lookup"><span data-stu-id="ca0f5-112">The second notion is that changes are either propagated to the data source as soon as you declare the work on a row complete (that is, *immediate* mode), or all changes to a set of rows are collected until you declare the work for the set complete (that is, *batch* mode).</span></span> <span data-ttu-id="ca0f5-113">Свойство **LockType** определяет, когда изменения вносятся в базовый источник данных.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-113">The **LockType** property determines when the changes are made to the underlying data source.</span></span> <span data-ttu-id="ca0f5-114">**адлоккоптимистик** или **адлоккпессимистик** указывает режим интерпретации, а **адлоккбатчоптимистик** задает пакетный режим.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-114">**adLockOptimistic** or **adLockPessimistic** specifies immediate mode, while **adLockBatchOptimistic** specifies batch mode.</span></span> <span data-ttu-id="ca0f5-115">Свойство **CursorLocation** может влиять на доступные параметры **LockType** .</span><span class="sxs-lookup"><span data-stu-id="ca0f5-115">The **CursorLocation** property can affect which **LockType** settings are available.</span></span> <span data-ttu-id="ca0f5-116">Например, параметр **адлоккпессимистик** не поддерживается, если для свойства **CursorLocation** задано значение **адусеклиент**.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-116">For instance, the **adLockPessimistic** setting is not supported if the **CursorLocation** property is set to **adUseClient**.</span></span>

<span data-ttu-id="ca0f5-117">В режиме интерпретации каждый вызов метода **Update** распространяет изменения в источник данных.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-117">In immediate mode, each invocation of the **Update** method propagates the changes to the data source.</span></span> <span data-ttu-id="ca0f5-118">В пакетном режиме каждый вызов **обновления** или перемещения текущей позиции строки сохраняет изменения в буфере копирования, но только метод **UpdateBatch** распространяет изменения в источник данных.</span><span class="sxs-lookup"><span data-stu-id="ca0f5-118">In batch mode, each invocation of **Update** or movement of the current row position saves the changes to the copy buffer, but only the **UpdateBatch** method propagates the changes to the data source.</span></span>

<span data-ttu-id="ca0f5-119">В этой главе рассматриваются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="ca0f5-119">This chapter covers the following topics:</span></span>

- [<span data-ttu-id="ca0f5-120">Обновление данных (ADO)</span><span class="sxs-lookup"><span data-stu-id="ca0f5-120">Updating data (ADO)</span></span>](updating-data.md)
- [<span data-ttu-id="ca0f5-121">Хранимые данные (ADO)</span><span class="sxs-lookup"><span data-stu-id="ca0f5-121">Persisting data (ADO)</span></span>](persisting-data.md)

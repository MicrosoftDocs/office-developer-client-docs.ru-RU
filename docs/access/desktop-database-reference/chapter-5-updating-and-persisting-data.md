---
title: Глава 5. Обновление и сохранение данных
TOCTitle: 'Chapter 5: Updating and persisting data'
ms:assetid: 77acb763-1c60-1945-791d-3e83d684fb0d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249493(v=office.15)
ms:contentKeyID: 48545732
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 18dd63acd733624fba522ee7382f305d34019905
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296432"
---
# <a name="chapter-5-updating-and-persisting-data"></a>Глава 5. Обновление и сохранение данных

**Область применения**: Access 2013, Office 2013

В предыдущих главах было рассмотрено, как использовать ADO для получения данных в источнике данных, как перемещаться по данным и даже как редактировать данные. Конечно, если цель приложения — разрешить пользователям вносить изменения в данные, необходимо понимать, как сохранить эти изменения. Вы можете сохранить изменения **recordset** в файле с помощью метода **Save** или отправить изменения обратно в источник данных для хранения с помощью методов **Update** или **UpdateBatch.**

В предыдущих главах данные были изменены в нескольких строках **наборов записей.** ADO поддерживает два основных понятия, связанных с добавлением, удалением и изменением строк данных.

Первое понятие состоит в том, что изменения не сразу внося в **набор записей;** вместо этого они будут сделаны во внутренний *буфер копирования.* Если вы решите, что не хотите вносить изменения, изменения в буфере копирования будут отменены. Если вы решили сохранить изменения, изменения в буфере копирования применяются к **набору записей.**

Во-вторых, изменения распространяются в источник данных, как только вы объявляете, что  работа над строкой завершена (то есть в немедленном режиме), или все изменения набора строк собираются до тех пор, пока вы не объявите работу для набора завершенных (то есть *пакетный* режим). Свойство **LockType** определяет время внесения изменений в исходный источник данных. **AdLockOptimistic** или **adLockPessimistic** указывает непосредственный режим, а **adLockBatchOptimistic** указывает режим пакета. Свойство **CursorLocation** может влиять на то, какие параметры **LockType** доступны. Например, параметр **adLockPessimistic** не поддерживается, если свойство **CursorLocation** имеет свойство **adUseClient.**

В немедленном режиме каждое вызов метода **Update** распространяет изменения в источник данных. В пакетном режиме каждое вызов обновления или перемещение текущей позиции строки сохраняет изменения в буфере копирования, но только метод **UpdateBatch** распространяет изменения в источник данных. 

В этой главе освещались следующие темы:

- [Обновление данных (ADO)](updating-data.md)
- [Persisting data (ADO)](persisting-data.md)

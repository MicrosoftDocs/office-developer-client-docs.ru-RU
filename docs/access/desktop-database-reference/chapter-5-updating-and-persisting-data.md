---
title: Глава 5. Обновление и сохранение данных
TOCTitle: 'Chapter 5: Updating and persisting data'
ms:assetid: 77acb763-1c60-1945-791d-3e83d684fb0d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249493(v=office.15)
ms:contentKeyID: 48545732
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 18dd63acd733624fba522ee7382f305d34019905
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296432"
---
# <a name="chapter-5-updating-and-persisting-data"></a>Глава 5. Обновление и сохранение данных

**Область применения**: Access 2013, Office 2013

В предыдущих главах обсуждалось, как использовать ADO для получения данных в источнике данных, перемещения по данным и даже для изменения данных. Конечно, если ваше приложение должно разрешить пользователям вносить изменения в данные, необходимо понять, как сохранить эти изменения. Вы можете сохранить изменения в **наборе записей** в файле с помощью метода **Save** или отправить изменения в источник данных для хранения с помощью методов **Update** или **UpdateBatch** .

В предыдущих главах вы изменили данные в нескольких строках **набора записей**. ADO поддерживает два основных понятия, связанные с добавлением, удалением и изменением строк данных.

Первое понятие заключается в том, что изменения не вносятся сразу в **набор записей**; Вместо этого они вносятся во внутренний *буфер копирования*. Если вы решили, что изменения не нужны, изменения в буфере копирования отбрасываются. Если вы решите сохранить изменения, то изменения, внесенные в буфер копирования, будут применены к **набору записей**.

Вторая идея состоит в том, что изменения либо распространяются в источник данных сразу же после объявления работы по строке завершен (то есть режим *интерпретации* ), или все изменения набора строк собираются до тех пор, пока не будет объявлена работа для инструкции SET Complete (то есть *пакетный* режим). Свойство **LockType** определяет, когда изменения вносятся в базовый источник данных. **адлоккоптимистик** или **адлоккпессимистик** указывает режим интерпретации, а **адлоккбатчоптимистик** задает пакетный режим. Свойство **CursorLocation** может влиять на доступные параметры **LockType** . Например, параметр **адлоккпессимистик** не поддерживается, если для свойства **CursorLocation** задано значение **адусеклиент**.

В режиме интерпретации каждый вызов метода **Update** распространяет изменения в источник данных. В пакетном режиме каждый вызов **обновления** или перемещения текущей позиции строки сохраняет изменения в буфере копирования, но только метод **UpdateBatch** распространяет изменения в источник данных.

В этой главе рассматриваются следующие темы:

- [Обновление данных (ADO)](updating-data.md)
- [Хранимые данные (ADO)](persisting-data.md)

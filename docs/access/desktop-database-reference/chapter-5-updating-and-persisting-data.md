---
title: Глава 5. Обновление и сохранение данных
TOCTitle: 'Chapter 5: Updating and persisting data'
ms:assetid: 77acb763-1c60-1945-791d-3e83d684fb0d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249493(v=office.15)
ms:contentKeyID: 48545732
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 18dd63acd733624fba522ee7382f305d34019905
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296432"
---
# <a name="chapter-5-updating-and-persisting-data"></a>Глава 5. Обновление и сохранение данных

**Область применения**: Access 2013, Office 2013

В предыдущих главах были рассмотрены вопросы использования ADO для получения данных в источнике данных, перемещения в данных и даже редактирования данных. Конечно, если цель приложения состоит в том, чтобы разрешить пользователям вносить изменения в данные, необходимо понять, как сохранить эти изменения. Можно либо сохранить изменения **в recordset** в файле с помощью метода **Сохранить,** либо отправить изменения обратно в источник данных для хранения с помощью методов **Update** или **UpdateBatch.**

В предыдущих главах вы изменили данные в нескольких строках **наборов Записей.** ADO поддерживает два основных понятия, связанных с добавлением, удалением и изменением строк данных.

Первое понятие состоит в том, что изменения не сразу внести в **Набор записей;** вместо этого они будут сделаны во внутренний буфер *копирования.* Если вы решите, что изменения не нужны, изменения в буфере копирования удаляются. Если вы решили сохранить изменения, изменения в буфере копирования применяются к **Набору записей.**

Второе понятие: изменения либо распространяются на источник данных, как только вы объявляете работу  в строке полной (то есть немедленном режиме), либо все изменения в набор строк собираются до объявления работы для набора завершена (то есть *пакетный* режим). Свойство **LockType** определяет, когда будут внесены изменения в исходный источник данных. **adLockOptimistic** или **adLockPessimistic** указывает непосредственный режим, а **adLockBatchOptimistic** указывает пакетный режим. Свойство **CursorLocation может** повлиять на доступные параметры **LockType.** Например, параметр **adLockPessimistic** не поддерживается, если свойство **CursorLocation** настроено **на adUseClient.**

В немедленном режиме каждое вызов метода **Update** распространяет изменения в источник данных. В пакетном режиме каждое вызов **обновления** или перемещение текущей позиции строки сохраняет изменения в буфере копирования, но только метод **UpdateBatch** распространяет изменения в источник данных.

В этой главе освещают следующие темы:

- [Обновление данных (ADO)](updating-data.md)
- [Сохраняющиеся данные (ADO)](persisting-data.md)

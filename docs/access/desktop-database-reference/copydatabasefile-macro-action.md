---
title: Макрокоманда CopyDatabaseFile
TOCTitle: CopyDatabaseFile macro action
ms:assetid: e6320b55-946b-9efc-9b64-b86513801a37
ms:mtpsurl: https://msdn.microsoft.com/library/Ff835963(v=office.15)
ms:contentKeyID: 48548373
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: b3c98d8795bb7039c0ae158414401dc5d754066f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295501"
---
# <a name="copydatabasefile-macro-action"></a>Макрокоманда CopyDatabaseFile

**Область применения**: Access 2013, Office 2013

Вы можете использовать **действие CopyDatabaseFile,** чтобы сделать копию текущей Microsoft SQL Server 7.0 или более поздней базы данных, подключенной к проекту Access. Access отсоединит текущую базу данных и прикрепит ее к серверу назначения. Дополнительные сведения об отсоединения и присоединении базы данных см. в SQL Server документации.

> [!NOTE]
> Эта макрокоманда доступна только для доверенных баз данных. 


## <a name="setting"></a>Параметр

Действие **CopyDatabaseFile** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Имя файла базы данных</strong></p></td>
<td><p>Имя нового файла мастер-данных. Путь по умолчанию для файла — текущее расположение файла проекта Access (.adp).</p></td>
</tr>
<tr class="even">
<td><p><strong>Переописывание существующего файла</strong></p></td>
<td><p>Указывает, следует ли заменить существующий файл с тем же именем. Если <strong>установлено да,</strong> и имя файла уже существует, файл перезаписан. Если <strong>установлено нет</strong> и имя файла уже существует, файл не перезаписывается и действие не удается. Если файл еще не существует, этот параметр игнорируется. По умолчанию — <strong>Да.</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>Отключение всех пользователей</strong></p></td>
<td><p>Указывает, должен ли Access выговарить пользователей из базы данных. Если <strong>установлено да,</strong>все пользователи, подключенные к текущей базе данных, отключаются, чтобы операция базы данных копирования продолжалась. Если <strong>установлено, что нет</strong> и один или несколько пользователей подключены к базе данных, операция базы данных копирования сбой. По умолчанию используется значение <strong>Нет</strong>.</p><p><strong>ВНИМАНИЕ.</strong>Отключение пользователей из базы данных без надлежащего предупреждения может привести к потере данных.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

Операция копирования синхронна, поэтому другие операции нельзя выполнять до завершения копии базы данных.

Действие **CopyDatabaseFile** не только копирует данные, определения данных и объекты баз данных, но и копирует расширенные свойства, такие как значения по умолчанию, текстовые ограничения и значения поиска.

Требования к копированию базы данных:

- Перед копированием файла базы данных необходимо отключить все приложения и пользователей.

- Все объекты и представления, кроме области навигации, должны быть закрыты.

- Текущая база данных не должна реплицироваться.

- База данных исходных серверов должна быть Microsoft SQL Server версии 7.0 или более поздней версии или SQL Server 2000 desktop Engine, запущенной на локальном компьютере.

- Базой SQL Server на сервере исходных данных должна быть единая база данных файлов.

- Вы должны быть членом роли sysadmin на исходных и SQL Server компьютерах.

Чтобы выполнить **действие CopyDatabaseFile** в Visual Basic для приложений, используйте метод **CopyDatabaseFile** объекта **DoCmd.**


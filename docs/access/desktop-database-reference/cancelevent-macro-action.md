---
title: CancelEvent Macro Action
TOCTitle: CancelEvent Macro Action
ms:assetid: d9d3ea99-c9fb-2524-c570-e3ee6d20af98
ms:mtpsurl: https://msdn.microsoft.com/library/Ff835110(v=office.15)
ms:contentKeyID: 48548066
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm78430
f1_categories:
- Office.Version=v15
ms.openlocfilehash: 52822d45b30c631dcabe3c38b6722398e96f489f
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2018
ms.locfileid: "25482324"
---
# <a name="cancelevent-macro-action"></a>CancelEvent Macro Action


**Применимо к**: Access 2013 | Office 2013


Действие **ОтменитьСобытие** можно использовать для отмены события, вызвавшего доступа для запуска макроса, содержащего эту операцию. Имя макроса задано для свойства события **BeforeUpdate**, **формы**, **OnUnload**или **OnPrint**.

## <a name="setting"></a>Параметр

Действие **ОтменитьСобытие** не требует аргументов.

## <a name="remarks"></a>Замечания

В форме обычно используется **ОтменитьСобытие в макросе проверки** со свойством событие **BeforeUpdate** . При вводе данных в элемент управления или запись Access запускает макрос перед добавлением данные в базу данных. В случае сбоя в макросе условиям проверки данных **ОтменитьСобытие** действие отменяет процесс обновления до его запуска.

Часто используется это действие с действием **MessageBox** для указания, что данные не удалось выполнить проверку условий и предоставляются полезные сведения о типе данных, которые должны быть введены.

Следующие события можно отменить с **ОтменитьСобытие** .

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>ApplyFilter</strong></p></td>
<td><p><strong>Dirty</strong></p></td>
<td><p><strong>MouseDown</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>До подтверждения Del</strong></p></td>
<td><p><strong>Выход</strong></p></td>
<td><p><strong>NoData</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>До вставки</strong></p></td>
<td><p><strong>Filter</strong></p></td>
<td><p><strong>Открытие</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>До обновления</strong></p></td>
<td><p><strong>Формат</strong></p></td>
<td><p><strong>Печать</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>DblClick</strong></p></td>
<td><p><strong>Нажатие клавиши</strong></p></td>
<td><p><strong>Unload</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>Delete</strong></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>



> [!NOTE]
> <P>Можно использовать действие <STRONG>ОтменитьСобытие</STRONG> с события <STRONG>MouseDown</STRONG> только, чтобы отменить событие, происходящее при щелчке правой кнопкой мыши объект.</P>



Если значение свойства события элемента управления **OnDblClick** указывает макрос, содержащий **ОтменитьСобытие** , то действие отменяет событие **DblClick** .

Для событий, которые можно отменить поведение по умолчанию для события (то есть, которое Access обычно выполняет при возникновении события) после выполнения макроса для события. Это позволяет отменить поведение по умолчанию. Например дважды щелкните слово, которое точка вставки находится на в текстовом поле, обычно выделяет слово. Можно отменить это поведение по умолчанию в макросе для события **DblClick** и выполнение некоторых действий, таких как Открытие формы, содержащей сведения о данных в текстовом поле. Для событий, не может быть отменен поведение по умолчанию до выполнения макроса.


> [!NOTE]
> <P>Если свойство события <STRONG>OnUnload</STRONG> формы указывает макроса, выполняющего <STRONG>ОтменитьСобытие</STRONG> действие, не будут иметь возможность закрыть форму. Необходимо либо исправить условие, в которой обнаружен <STRONG>ОтменитьСобытие осуществляться или откройте макрос и удаление <STRONG>ОтменитьСобытие</STRONG> действия</STRONG> . Если форма модальную форму, не будут иметь возможность открыть макрос.</P>



Для выполнения **ОтменитьСобытие в Visual Basic для приложений (VBA) модуль** , используйте метод **ОтменитьСобытие** **объекта** .

## <a name="example"></a>Пример

Проверка данных с помощью макроса (en)

Следующий макрос для проверки проверяет почтовые индексы, введенные в форме Поставщики. Демонстрируется использование **ОстановитьМакрос**, **MessageBox**, **ОтменитьСобытие**и **КЭлементуУправления** действия. Условным выражением проверяет страны или региона и почтового индекса в записи на форме. Если почтовый индекс не в нужном формате для страны или региона, макрос отображается окно сообщения и показано, как отменить сохранение записи. Оно будет снова к элементу управления почтовый индекс для исправления ошибки. Этот макрос должен быть связан свойством **BeforeUpdate** формы Поставщики.

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Condition</p></th>
<th><p>Действие</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>IsNull([CountryRegion])</p></td>
<td><p>StopMacro</p></td>
<td><p></p></td>
<td><p>Если Страна имеет <strong>значение Null</strong>, почтовый индекс не может быть проверен.</p></td>
</tr>
<tr class="even">
<td><p>[Страна] В (&quot;Франции&quot;,&quot;Италия&quot;,&quot;Испания&quot;) и Len ([Почтовый индекс]) &lt; &gt; 5</p></td>
<td><p>MessageBox</p></td>
<td><p>Сообщение об ошибке: Почтовый индекс должен быть 5 символов. Звуковые: <strong>Да</strong> тип: <strong>сведения о</strong> заголовок: ошибка почтовый индекс</p></td>
<td><p>Если почтовый индекс не 5 знаков, отобразите сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p>ОтменитьСобытие</p></td>
<td><p></p></td>
<td><p>Отмените событие.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p>GoToControl</p></td>
<td><p>Имя элемента управления: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="odd">
<td><p>[Страна] В (&quot;Австралия&quot;,&quot;Сингапур&quot;) и Len ([Почтовый индекс]) &lt; &gt; 4</p></td>
<td><p>MessageBox</p></td>
<td><p>Сообщение об ошибке: Почтовый индекс должен быть 4 символов. Звуковые: <strong>Да</strong> тип: <strong>сведения о</strong> заголовок: ошибка почтовый индекс</p></td>
<td><p>Если почтовый индекс не 4 символа, отобразите сообщение.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p>ОтменитьСобытие</p></td>
<td><p></p></td>
<td><p>Отмените событие.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p>GoToControl</p></td>
<td><p>Имя элемента управления: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="even">
<td><p>([Страна] = &quot;Канада&quot;) И ([Почтовый индекс] не нравится&quot;[A-Z] [0-9] [A-Z] [0-9] [A-Z] [0-9]&quot;)</p></td>
<td><p>MessageBox</p></td>
<td><p>Сообщение об ошибке: Почтовый индекс не является допустимым. Пример кода, английский (Канада): H1J 1 c 3 звуковые сигналы: <strong>Да</strong> тип: <strong>данные</strong> заголовка: почтовый код ошибки</p></td>
<td><p>Если почтовый индекс не соответствует формату для Канады, отобразите сообщение. (Пример кода, английский (Канада): H1J 1 c 3)</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p>ОтменитьСобытие</p></td>
<td><p></p></td>
<td><p>Отмените событие.</p></td>
</tr>
</tbody>
</table>


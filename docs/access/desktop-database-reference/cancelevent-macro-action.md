---
title: Макрокоманда CancelEvent
TOCTitle: CancelEvent macro action
ms:assetid: d9d3ea99-c9fb-2524-c570-e3ee6d20af98
ms:mtpsurl: https://msdn.microsoft.com/library/Ff835110(v=office.15)
ms:contentKeyID: 48548066
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm78430
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: b55fc51f70bcc2c9d2f7e93cf9c79228cd2fe440
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296635"
---
# <a name="cancelevent-macro-action"></a>Макрокоманда CancelEvent

**Область применения**: Access 2013, Office 2013

Вы можете использовать действие **Макрокоманда CancelEvent** , чтобы отменить событие, которое привело к запуску макроса, содержащего это действие. Имя макроса — это значение свойства события, например " **до обновления**" ****, "OnOpen", "OnOpen" или "OnOpen". **** ****

## <a name="setting"></a>Параметр

Макрокоманда **Макрокоманда CancelEvent** не содержит аргументов.

## <a name="remarks"></a>Замечания

В форме, как правило, используется действие **Макрокоманда CancelEvent** в макросе проверки с свойством **до обновления** события. Когда пользователь вводит данные в элемент управления или запись, Access выполняет макрос перед добавлением данных в базу данных. Если данные не прошли условия проверки в макросе, действие **Макрокоманда CancelEvent** отменяет процесс обновления перед запуском.

Часто вы используете это действие с действием **MessageBox** , чтобы указать, что данные не прошли условия проверки и содержат полезную информацию о типе вводимых данных.

Действие **Макрокоманда CancelEvent** может отменять следующие события.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>ApplyFilter</strong></p></td>
<td><p><strong>Dirty</strong></p></td>
<td><p><strong>MouseDown</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>BeforeDelConfirm</strong></p></td>
<td><p><strong>Exit</strong></p></td>
<td><p><strong>NoData</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>BeforeInsert</strong></p></td>
<td><p><strong>Filter</strong></p></td>
<td><p><strong>Open</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>BeforeUpdate</strong></p></td>
<td><p><strong>Format</strong></p></td>
<td><p><strong>Print</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>DblClick</strong></p></td>
<td><p><strong>KeyPress</strong></p></td>
<td><p><strong>Unload</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>удаление</strong>;</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> Вы можете использовать действие **Макрокоманда CancelEvent** с событием **MouseDown** только для отмены события, которое возникает при щелчке объекта правой кнопкой мыши.

Если параметр свойства события **ондблкликк** элемента управления указывает макрос, содержащий действие **Макрокоманда CancelEvent** , действие отменяет событие **DblClick** .

Для событий, которые можно отменять, поведение по умолчанию для события (то есть, как правило, обычно выполняется при возникновении события) возникает после запуска макроса для события. Это позволяет отменить поведение по умолчанию. Например, если дважды щелкнуть слово, в текстовом поле которого находится точка вставки, Access обычно выделяет это слово. Вы можете отменить это поведение по умолчанию в макросе для события **DblClick** и выполнить другие действия, такие как открытие формы, содержащей сведения о данных в текстовом поле. Для событий, которые не могут быть отменены, поведение по умолчанию возникает перед запуском макроса.

> [!NOTE]
> Если свойство события **OnUnload** формы указывает макрос, который выполняет действие **Макрокоманда CancelEvent** , вы не сможете закрыть форму. Необходимо либо исправить условие, вызвавшее действие **Макрокоманда CancelEvent** , либо открыть макрос и удалить действие **Макрокоманда CancelEvent** . Если форма является модальной, открыть макрос будет невозможно.

Чтобы выполнить действие **Макрокоманда CancelEvent** в модуле Visual Basic для приложений (VBA), используйте метод **Макрокоманда CancelEvent** объекта **DoCmd** .

## <a name="example"></a>Пример

Проверка данных с помощью макроса

Следующий макрос проверки проверяет почтовые индексы, введенные в форме Поставщики. В нем показано использование действий **Макрокоманда StopMacro**, **MessageBox**, **Макрокоманда CancelEvent**и **КЭлементуУправления** . Условное выражение проверяет страну, регион и почтовый индекс, введенные в записи в форме. Если почтовый индекс находится в неправильном формате для страны или региона, макрос выводит окно сообщения и отменяет сохранение записи. Затем выполняется возврат к элементу управления "почтовый индекс", в котором можно исправить ошибку. Этот макрос необходимо вложить в свойство **BeforeUpdate** формы "поставщики".

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Условие</p></th>
<th><p>Действие</p></th>
<th><p>Аргументы: Настройка</p></th>
<th><p>Комментарий</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>IsNull ([страна])</p></td>
<td><p>StopMacro</p></td>
<td><p></p></td>
<td><p>Если страна имеет <strong>значение NULL</strong>, почтовый индекс не может быть проверен.</p></td>
</tr>
<tr class="even">
<td><p>Ватикан В (&quot;Франция&quot;,&quot;Италия&quot;,&quot;Испания&quot;) и len ([почтовый индекс]) &lt; &gt; 5</p></td>
<td><p>MessageBox</p></td>
<td><p>Сообщение: длина почтового индекса не должна превышать 5 символов. Гудок: тип <strong>Да</strong> : <strong>сведения</strong> : ошибка почтового индекса</p></td>
<td><p>Если почтовый индекс не имеет 5 символов, отобразится сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p>ОтменитьСобытие</p></td>
<td><p></p></td>
<td><p>Отмена события.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p>GoToControl</p></td>
<td><p>Имя элемента управления: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="odd">
<td><p>Ватикан В (&quot;Австралия&quot;,&quot;Сингапур&quot;) и len ([почтовый индекс]) &lt; &gt; 4</p></td>
<td><p>MessageBox</p></td>
<td><p>Сообщение: почтовый индекс должен иметь 4 символа. Гудок: тип <strong>Да</strong> : <strong>сведения</strong> : ошибка почтового индекса</p></td>
<td><p>Если почтовый индекс не имеет 4 символов, отобразится сообщение.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p>ОтменитьСобытие</p></td>
<td><p></p></td>
<td><p>Отмена события.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p>GoToControl</p></td>
<td><p>Имя элемента управления: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="even">
<td><p>([Страна] = &quot;Канада&quot;) And ([почтовый индекс] не похоже&quot;на [A-z] [0-9] [A-z] [0-9] [A-z] [0-9&quot;])</p></td>
<td><p>MessageBox</p></td>
<td><p>Сообщение: недопустимый почтовый индекс. Пример кода канадского канадского: H1J 1C3 beep: тип <strong>Да</strong> : <strong>сведения</strong> : ошибка почтового индекса</p></td>
<td><p>Если почтовый индекс не подходит для Канады, отобразите сообщение. (Пример канадского кода: H1J 1C3)</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p>ОтменитьСобытие</p></td>
<td><p></p></td>
<td><p>Отмена события.</p></td>
</tr>
</tbody>
</table>


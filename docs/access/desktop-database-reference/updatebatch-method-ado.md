---
title: Метод UpdateBatch (ADO)
TOCTitle: UpdateBatch method (ADO)
ms:assetid: 69e72a65-b637-36fd-d09f-7f81050f71ad
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249416(v=office.15)
ms:contentKeyID: 48545420
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 9d269a9012588a7b82505ac2e28466151715cbb0
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32313578"
---
# <a name="updatebatch-method-ado"></a>Метод UpdateBatch (ADO)

**Область применения**: Access 2013, Office 2013

ЗаПисывает все ожидающие пакетные обновления на диск.

## <a name="syntax"></a>Синтаксис

*набор записей*. UpdateBatch*аффектрекордс*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Аффектрекордс* |Необязательно. Значение [аффектенум](affectenum.md) , указывающее количество записей, на которые влияет метод **UpdateBatch** .|

## <a name="remarks"></a>Примечания

Используйте метод **UpdateBatch** при изменении объекта **Recordset** в режиме пакетного обновления для передачи всех изменений, внесенных в объект **Recordset** в базовую базу данных.

Если объект **Recordset** поддерживает пакетное обновление, можно кэшировать несколько изменений в одну или несколько записей локально, пока не будет вызван метод **UpdateBatch** . Если вы редактируете текущую запись или добавляете новую запись при вызове метода **UpdateBatch** , ADO автоматически вызывает метод [Update](update-method-ado.md) для сохранения всех ожидающих изменений в текущей записи, прежде чем передавать пакетные изменения в поставщики. Пакетное обновление следует использовать только с помощью набора ключей или только статического курсора.

> [!NOTE]
> Указание **адаффектграуп** в качестве значения для этого параметра приведет к ошибке при отсутствии отображаемых записей в текущем **наборе записей** (например, в фильтре, для которого не найдено записей).

Если при попытке передать изменения для любой или всех записей возникла ошибка из-за конфликта с базовыми данными (например, запись уже была удалена другим пользователем), то поставщик возвращает предупреждения для коллекции [Errors](errors-collection-ado.md) и возникает ошибка времени выполнения. . Используйте свойство [Filter](filter-property-ado.md) (**адфилтераффектедрекордс**) и свойство [Status](status-property-ado-recordset.md) для обнаружения записей с конфликтами.

Чтобы отменить все ожидающие пакетные обновления, используйте метод [CancelBatch](cancelbatch-method-ado.md) .

Если задана [уникальная таблица](unique-table-unique-schema-unique-catalog-properties-dynamic-ado.md) и динамические свойства повторной [синхронизации обновления](update-resync-property-dynamic-ado.md) , а **набор записей** является результатом выполнения операции присоединения к нескольким таблицам, то при выполнении метода **UpdateBatch** неявно следуют [](resync-method-ado.md) Метод Resync в зависимости от параметров свойства Resync свойства **Update Sync** .

Порядок, в котором отдельные обновления пакета выполняются в источнике данных, не обязательно совпадает с порядком, в котором они были выполнены для локального **набора записей**. Порядок обновления зависит от поставщика. Это необходимо учитывать при кодировании обновлений, связанных друг с другом, таких как ограничения внешнего ключа при вставке или обновлении.


---
title: Метод UpdateBatch (ADO)
TOCTitle: UpdateBatch method (ADO)
ms:assetid: 69e72a65-b637-36fd-d09f-7f81050f71ad
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249416(v=office.15)
ms:contentKeyID: 48545420
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 3ce946d3354f6bbf05ac3819efc5f96c436fa174
ms.sourcegitcommit: 980a96cf444882d3d34cecb5faac8f8a7b7c4b57
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2018
ms.locfileid: "25950127"
---
# <a name="updatebatch-method-ado"></a>Метод UpdateBatch (ADO)

**Применимо к**: Access 2013, Office 2013

Записывает все ожидающие пакета обновления на диск.

## <a name="syntax"></a>Синтаксис

*набор записей*. UpdateBatch*AffectRecords*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*AffectRecords* |Необязательно указывать. От [AffectEnum](affectenum.md) значение, которое указывает, сколько записей влияет на метод **UpdateBatch** .|

## <a name="remarks"></a>Примечания

Используйте метод **UpdateBatch** при изменении объекта **набора записей** в пакетном режиме обновления для передачи все изменения, внесенные в объект **набора записей** в основной базе данных.

Если объект **набора записей** поддерживает пакетного обновления, можно кэшировать внесение нескольких изменений в одну или несколько записей локально до вызова метода **UpdateBatch** . При изменении текущей записи или добавления новой записи при вызове метода **UpdateBatch** , ADO автоматически будет вызвать метод [Update](update-method-ado.md) для сохранения всех ожидающих изменений в текущей записи перед передачей пакетные изменения Поставщик. Следует использовать пакетного обновления с набором ключей или статических текущей позиции.

> [!NOTE]
> Указание **adAffectGroup** в качестве значения для этого параметра приведет к ошибку при нет видимых записей в текущего **набора записей** (например, фильтр, для которого нет записей, соответствующих).

В случае сбоя попытка передать изменения для некоторых или всех записей из-за конфликта с базовыми данными (например, запись уже была удалена другим пользователем), поставщик возвращает предупреждения семейство [Errors](errors-collection-ado.md) и возникает ошибка времени выполнения . Используйте свойство [фильтра](filter-property-ado.md) (**adFilterAffectedRecords**) и свойство [состояние](status-property-ado-recordset.md) для поиска записей с конфликтами.

Чтобы отменить все ожидающие пакета обновления, используйте метод [CancelBatch](cancelbatch-method-ado.md) .

Если заданы свойства динамического [Уникальной таблицы](unique-table-unique-schema-unique-catalog-properties-dynamic-ado.md) и [Выполнить повторную синхронизацию обновления](update-resync-property-dynamic-ado.md) и **записей** результат выполнения операции СОЕДИНЕНИЯ на несколько таблиц, то выполнение метода **UpdateBatch** неявно следуют Метод [выполнить повторную синхронизацию](resync-method-ado.md) в зависимости от параметров свойства **Обновления выполнить повторную синхронизацию** .

Порядок, в котором отдельные обновления пакета выполняются в источнике данных не обязательно то же, что порядок, в котором они были созданы на локальном **набора записей**. Порядок обновления зависит от поставщика. Это учитывать при программировании обновлений, которые связаны с друг с другом, такие как ограничения внешнего ключа при вставке или обновлении.


---
title: Метод UpdateBatch (ADO)
TOCTitle: UpdateBatch method (ADO)
ms:assetid: 69e72a65-b637-36fd-d09f-7f81050f71ad
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249416(v=office.15)
ms:contentKeyID: 48545420
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 9d269a9012588a7b82505ac2e28466151715cbb0
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32313578"
---
# <a name="updatebatch-method-ado"></a>Метод UpdateBatch (ADO)

**Область применения**: Access 2013, Office 2013

Записывает все ожидающих пакетных обновлений на диск.

## <a name="syntax"></a>Синтаксис

*набор записей.* UpdateBatch *AffectRecords*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*AffectRecords* |Необязательный параметр. Значение [AffectEnum,](affectenum.md) которое указывает, сколько записей повлияет на метод **UpdateBatch.**|

## <a name="remarks"></a>Примечания

Используйте метод **UpdateBatch** при изменении объекта **Recordset** в режиме пакетного обновления, чтобы передать все изменения, внесенные в **объекте Recordset,** в базовую базу данных.

Если объект **Recordset поддерживает** пакетное обновление, можно кэшировать несколько изменений в одну или несколько записей локально до вызова метода **UpdateBatch.** При редактировании текущей записи или добавлении новой записи при вызове метода **UpdateBatch** ADO будет автоматически вызывать метод Update, чтобы сохранить все ожидающие изменения текущей записи перед передачей пакетных изменений поставщику. [](update-method-ado.md) Необходимо использовать пакетное обновление только с помощью наборов ключей или статического курсора.

> [!NOTE]
> Указание **adAffectGroup** в качестве значения для этого параметра приведет к ошибке, если в текущем наборе записей нет видимых **записей** (например, фильтра, для которого записи не совпадают).

Если попытка передачи изменений не удалась для любых или всех записей из-за конфликта с данными( например, запись уже удалена [](errors-collection-ado.md) другим пользователем), поставщик возвращает предупреждения в коллекцию ошибок и возникает ошибка в течение времени. Используйте свойство [Filter](filter-property-ado.md) **(adFilterAffectedRecords)** и свойство [Status](status-property-ado-recordset.md) для обнаружения записей с конфликтами.

Чтобы отменить все ожидающих пакетных обновлений, используйте [метод CancelBatch.](cancelbatch-method-ado.md)

Если динамические свойства Unique [Table](unique-table-unique-schema-unique-catalog-properties-dynamic-ado.md) и [Update Resync](update-resync-property-dynamic-ado.md) установлены, а набор **Recordset** является результатом выполнения операции JOIN на нескольких таблицах, то за выполнением метода **UpdateBatch** неявно следует метод [Resync](resync-method-ado.md) в зависимости от параметров свойства **Update Resync.**

Порядок выполнения отдельных обновлений пакета в источнике данных не обязательно совпадает с порядком, в котором они выполнялись в локальном **наборе Записей.** Порядок обновления зависит от поставщика. Учитывайте это при кодировании обновлений, связанных друг с другом, таких как внешние ограничения клавиш на вставке или обновлении.


---
title: Метод AddNew (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f733c574ba7927587c6fcb6305a361ca1070de0f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282515"
---
# <a name="addnew-method-ado"></a>Метод AddNew (ADO)

**Область применения**: Access 2013, Office 2013

Создает новую запись для обновляемого объекта [Recordset](recordset-object-ado.md).

## <a name="syntax"></a>Синтаксис

*recordset*. AddNew *FieldList*, *Values*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*recordset* |Объект **Recordset.**|
|*FieldList* |Необязательный параметр. Одно имя или массив имен или порядковых позиций полей в новой записи.|
|*Values* |Необязательный параметр. Одно значение или массив значений для полей в новой записи. Если *fieldlist* является массивом, *значения* также должны быть массивом с одинаковым количеством членов; в противном случае возникает ошибка. Порядок имен полей должен соответствовать порядку значений полей в каждом массиве.|

## <a name="remarks"></a>Заметки

Используйте метод **AddNew** для создания и инициализации новой записи. Используйте метод [Supports](supports-method-ado.md) с **adAddNew** (значение [CursorOptionEnum),](cursoroptionenum.md) чтобы проверить, можно ли добавлять записи к текущему объекту **Recordset.**

После вызова метода **AddNew** новая запись становится текущей и остается текущей после вызова метода [Update.](update-method-ado.md) Так как новая запись будет appended к **набору записей,** вызов **MoveNext** после обновления будет перемещаться за конец **recordset,** делая **EOF** True. Если объект **Recordset** не поддерживает закладки, возможно, вы не сможете получить доступ к новой записи после перемещения в другую запись. В зависимости от типа курсора может потребоваться вызвать метод [Requery,](requery-method-ado.md) чтобы сделать новую запись доступной.

Если вы вызываете **AddNew** при редактировании текущей записи или при добавлении новой записи, ADO вызывает метод **Update,** чтобы сохранить все изменения, а затем создает новую запись.

Поведение метода **AddNew** зависит от режима обновления объекта **Recordset** и от того, передаются ли аргументы *Fieldlist* и *Values.*

В режиме немедленного обновления *(в* котором поставщик записывает изменения в исходный источник данных после вызова метода **Update),** вызов метода **AddNew** без аргументов задает для свойства [EditMode](editmode-property-ado.md) значение **adEditAdd** (значение [EditModeEnum).](editmodeenum.md) Поставщик кэшетет все изменения значения поля локально. Вызов метода **Update** передает новую запись в базу данных и сбрасывает свойство **EditMode** в **adEditNone** (значение **EditModeEnum).** Если передать *аргументы Fieldlist* и *Values,* ADO немедленно публикует новую  запись в базе данных (вызов обновления не требуется); Значение **свойства EditMode** не меняется (**adEditNone).**

В режиме пакетного обновления *(в* котором поставщик кэширует несколько изменений и записывает их в исходный источник данных только при вызове метода [UpdateBatch),](updatebatch-method-ado.md) вызов метода **AddNew** без аргументов задает для свойства **EditMode** **свойство adEditAdd.** Поставщик кэшетет все изменения значения поля локально. Вызов метода **Update** добавляет новую запись в текущий набор **recordset** и сбрасывает свойство **EditMode** в **adEditNone,** но поставщик не записи изменений в баз данных, пока вы не вызываете **метод UpdateBatch.** Если передать *аргументы Fieldlist* и *Values,* ADO отправляет новую запись поставщику для хранения в кэше; Необходимо вызвать метод **UpdateBatch,** чтобы опубликовать новую запись в базовую базу данных.


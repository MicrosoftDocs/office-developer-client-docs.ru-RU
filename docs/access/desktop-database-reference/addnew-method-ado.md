---
title: Метод AddNew (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f733c574ba7927587c6fcb6305a361ca1070de0f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282515"
---
# <a name="addnew-method-ado"></a><span data-ttu-id="1c758-102">Метод AddNew (ADO)</span><span class="sxs-lookup"><span data-stu-id="1c758-102">AddNew method (ADO)</span></span>

<span data-ttu-id="1c758-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="1c758-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="1c758-104">Создает новую запись для обновляемого объекта [Recordset](recordset-object-ado.md).</span><span class="sxs-lookup"><span data-stu-id="1c758-104">Creates a new record for an updatable [Recordset](recordset-object-ado.md) object.</span></span>

## <a name="syntax"></a><span data-ttu-id="1c758-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="1c758-105">Syntax</span></span>

<span data-ttu-id="1c758-106">*набор записей*. *Фиелдлист*AddNew, *Values*</span><span class="sxs-lookup"><span data-stu-id="1c758-106">*recordset*.AddNew *FieldList*, *Values*</span></span>

## <a name="parameters"></a><span data-ttu-id="1c758-107">Параметры</span><span class="sxs-lookup"><span data-stu-id="1c758-107">Parameters</span></span>

|<span data-ttu-id="1c758-108">Параметр</span><span class="sxs-lookup"><span data-stu-id="1c758-108">Parameter</span></span>|<span data-ttu-id="1c758-109">Описание</span><span class="sxs-lookup"><span data-stu-id="1c758-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="1c758-110">*Recordset*</span><span class="sxs-lookup"><span data-stu-id="1c758-110">*recordset*</span></span> |<span data-ttu-id="1c758-111">Объект **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="1c758-111">A **Recordset** object.</span></span>|
|<span data-ttu-id="1c758-112">*Фиелдлист*</span><span class="sxs-lookup"><span data-stu-id="1c758-112">*FieldList*</span></span> |<span data-ttu-id="1c758-113">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="1c758-113">Optional.</span></span> <span data-ttu-id="1c758-114">Одно имя или массив имен или порядковое расположение полей в новой записи.</span><span class="sxs-lookup"><span data-stu-id="1c758-114">A single name, or an array of names or ordinal positions of the fields in the new record.</span></span>|
|<span data-ttu-id="1c758-115">*Values*</span><span class="sxs-lookup"><span data-stu-id="1c758-115">*Values*</span></span> |<span data-ttu-id="1c758-116">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="1c758-116">Optional.</span></span> <span data-ttu-id="1c758-117">Одно значение или массив значений для полей в новой записи.</span><span class="sxs-lookup"><span data-stu-id="1c758-117">A single value, or an array of values for the fields in the new record.</span></span> <span data-ttu-id="1c758-118">Если *фиелдлист* является массивом, то *значения* также должны быть массивом с одинаковым количеством элементов; в противном случае возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="1c758-118">If *Fieldlist* is an array, *Values* must also be an array with the same number of members; otherwise, an error occurs.</span></span> <span data-ttu-id="1c758-119">Порядок имен полей должен быть соответствующим порядку значений полей в каждом массиве.</span><span class="sxs-lookup"><span data-stu-id="1c758-119">The order of field names must match the order of field values in each array.</span></span>|

## <a name="remarks"></a><span data-ttu-id="1c758-120">Замечания</span><span class="sxs-lookup"><span data-stu-id="1c758-120">Remarks</span></span>

<span data-ttu-id="1c758-121">Используйте метод **AddNew** для создания и инициализации новой записи.</span><span class="sxs-lookup"><span data-stu-id="1c758-121">Use the **AddNew** method to create and initialize a new record.</span></span> <span data-ttu-id="1c758-122">Используйте метод [](supports-method-ado.md) Supports с **Ададднев** (значение [курсороптионенум](cursoroptionenum.md) ), чтобы проверить, можно ли добавлять записи в текущий объект **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="1c758-122">Use the [Supports](supports-method-ado.md) method with **adAddNew** (a [CursorOptionEnum](cursoroptionenum.md) value) to verify whether you can add records to the current **Recordset** object.</span></span>

<span data-ttu-id="1c758-123">После вызова метода **AddNew** новая запись становится текущей и остается текущей после вызова метода [Update](update-method-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="1c758-123">After you call the **AddNew** method, the new record becomes the current record and remains current after you call the [Update](update-method-ado.md) method.</span></span> <span data-ttu-id="1c758-124">Так как новая запись добавляется к набору **записей**, вызов **MoveNext** после обновления перемещается за пределы объекта **Recordset**, делая **EOF** истинной.</span><span class="sxs-lookup"><span data-stu-id="1c758-124">Since the new record is appended to the **Recordset**, a call to **MoveNext** following the Update will move past the end of the **Recordset**, making **EOF** True.</span></span> <span data-ttu-id="1c758-125">Если объект **Recordset** не поддерживает закладки, вы не сможете получить доступ к новой записи после того, как вы перейдете к другой записи.</span><span class="sxs-lookup"><span data-stu-id="1c758-125">If the **Recordset** object does not support bookmarks, you may not be able to access the new record once you move to another record.</span></span> <span data-ttu-id="1c758-126">В зависимости от типа курсора может потребоваться вызвать метод reQuery, [](requery-method-ado.md) чтобы сделать новую запись доступной.</span><span class="sxs-lookup"><span data-stu-id="1c758-126">Depending on your cursor type, you may need to call the [Requery](requery-method-ado.md) method to make the new record accessible.</span></span>

<span data-ttu-id="1c758-127">При вызове **AddNew** при редактировании текущей записи или добавлении новой записи ADO вызывает метод **Update** , чтобы сохранить изменения, а затем создает новую запись.</span><span class="sxs-lookup"><span data-stu-id="1c758-127">If you call **AddNew** while editing the current record or while adding a new record, ADO calls the **Update** method to save any changes and then creates the new record.</span></span>

<span data-ttu-id="1c758-128">Поведение метода **AddNew** зависит от режима обновления объекта **Recordset** и от того, передаются ли аргументы *фиелдлист* и *Values* .</span><span class="sxs-lookup"><span data-stu-id="1c758-128">The behavior of the **AddNew** method depends on the updating mode of the **Recordset** object and whether you pass the *Fieldlist* and *Values* arguments.</span></span>

<span data-ttu-id="1c758-129">В *режиме немедленного обновления* (когда поставщик записывает изменения в базовом источнике данных после вызова метода **Update** ), вызов метода **AddNew** без аргументов задает для свойства [EditMode](editmode-property-ado.md) значение **адедитадд** ( значение [едитмодинум](editmodeenum.md) ).</span><span class="sxs-lookup"><span data-stu-id="1c758-129">In *immediate update mode* (in which the provider writes changes to the underlying data source once you call the **Update** method), calling the **AddNew** method without arguments sets the [EditMode](editmode-property-ado.md) property to **adEditAdd** (an [EditModeEnum](editmodeenum.md) value).</span></span> <span data-ttu-id="1c758-130">Поставщик кэширует все изменения значения поля локально.</span><span class="sxs-lookup"><span data-stu-id="1c758-130">The provider caches any field value changes locally.</span></span> <span data-ttu-id="1c758-131">При вызове метода **Update** в базу данных отправляется новая запись и сбрасывается значение свойства **EditMode** в **адедитноне** (значение **едитмодинум** ).</span><span class="sxs-lookup"><span data-stu-id="1c758-131">Calling the **Update** method posts the new record to the database and resets the **EditMode** property to **adEditNone** (an **EditModeEnum** value).</span></span> <span data-ttu-id="1c758-132">Если вы передаете аргументы *фиелдлист* и *Values* , ADO сразу же отправляет новую запись в базу данных (вызов **обновления** не требуется); значение свойства **EditMode** не изменяется (**адедитноне**).</span><span class="sxs-lookup"><span data-stu-id="1c758-132">If you pass the *Fieldlist* and *Values* arguments, ADO immediately posts the new record to the database (no **Update** call is necessary); the **EditMode** property value does not change (**adEditNone**).</span></span>

<span data-ttu-id="1c758-133">В *режиме пакетного обновления* (в котором поставщик кэширует несколько изменений и записывает их в базовый источник данных только при вызове метода [UpdateBatch](updatebatch-method-ado.md) ), вызов метода **AddNew** без аргументов задает **EditMode** для свойства **адедитадд**.</span><span class="sxs-lookup"><span data-stu-id="1c758-133">In *batch update mode* (in which the provider caches multiple changes and writes them to the underlying data source only when you call the [UpdateBatch](updatebatch-method-ado.md) method), calling the **AddNew** method without arguments sets the **EditMode** property to **adEditAdd**.</span></span> <span data-ttu-id="1c758-134">Поставщик кэширует все изменения значения поля локально.</span><span class="sxs-lookup"><span data-stu-id="1c758-134">The provider caches any field value changes locally.</span></span> <span data-ttu-id="1c758-135">Вызов метода **Update** добавляет новую запись в текущий **набор записей** и сбрасывает свойство **EditMode** в **адедитноне**, но поставщик не отправляет изменения в базовую базу данных, пока не будет вызвана функция \*\*UpdateBatch \*\*метод.</span><span class="sxs-lookup"><span data-stu-id="1c758-135">Calling the **Update** method adds the new record to the current **Recordset** and resets the **EditMode** property to **adEditNone**, but the provider does not post the changes to the underlying database until you call the **UpdateBatch** method.</span></span> <span data-ttu-id="1c758-136">Если вы передаете аргументы *фиелдлист* и *Values* , ADO отправляет новую запись поставщику для хранения в кэше; для отправки новой записи в базовую базу данных необходимо вызвать метод **UpdateBatch** .</span><span class="sxs-lookup"><span data-stu-id="1c758-136">If you pass the *Fieldlist* and *Values* arguments, ADO sends the new record to the provider for storage in a cache; you need to call the **UpdateBatch** method to post the new record to the underlying database.</span></span>


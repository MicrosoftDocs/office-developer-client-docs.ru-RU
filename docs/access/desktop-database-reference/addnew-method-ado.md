---
title: Метод AddNew (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f733c574ba7927587c6fcb6305a361ca1070de0f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282515"
---
# <a name="addnew-method-ado"></a>Метод AddNew (ADO)

**Область применения**: Access 2013, Office 2013

Создает новую запись для обновляемого объекта [Recordset](recordset-object-ado.md).

## <a name="syntax"></a>Синтаксис

*набор записей*. *Фиелдлист*AddNew, *Values*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Recordset* |Объект **Recordset** .|
|*Фиелдлист* |Необязательный атрибут. Одно имя или массив имен или порядковое расположение полей в новой записи.|
|*Values* |Необязательный атрибут. Одно значение или массив значений для полей в новой записи. Если *фиелдлист* является массивом, то *значения* также должны быть массивом с одинаковым количеством элементов; в противном случае возникает ошибка. Порядок имен полей должен быть соответствующим порядку значений полей в каждом массиве.|

## <a name="remarks"></a>Замечания

Используйте метод **AddNew** для создания и инициализации новой записи. Используйте метод [](supports-method-ado.md) Supports с **Ададднев** (значение [курсороптионенум](cursoroptionenum.md) ), чтобы проверить, можно ли добавлять записи в текущий объект **Recordset** .

После вызова метода **AddNew** новая запись становится текущей и остается текущей после вызова метода [Update](update-method-ado.md) . Так как новая запись добавляется к набору **записей**, вызов **MoveNext** после обновления перемещается за пределы объекта **Recordset**, делая **EOF** истинной. Если объект **Recordset** не поддерживает закладки, вы не сможете получить доступ к новой записи после того, как вы перейдете к другой записи. В зависимости от типа курсора может потребоваться вызвать метод reQuery, [](requery-method-ado.md) чтобы сделать новую запись доступной.

При вызове **AddNew** при редактировании текущей записи или добавлении новой записи ADO вызывает метод **Update** , чтобы сохранить изменения, а затем создает новую запись.

Поведение метода **AddNew** зависит от режима обновления объекта **Recordset** и от того, передаются ли аргументы *фиелдлист* и *Values* .

В *режиме немедленного обновления* (когда поставщик записывает изменения в базовом источнике данных после вызова метода **Update** ), вызов метода **AddNew** без аргументов задает для свойства [EditMode](editmode-property-ado.md) значение **адедитадд** ( значение [едитмодинум](editmodeenum.md) ). Поставщик кэширует все изменения значения поля локально. При вызове метода **Update** в базу данных отправляется новая запись и сбрасывается значение свойства **EditMode** в **адедитноне** (значение **едитмодинум** ). Если вы передаете аргументы *фиелдлист* и *Values* , ADO сразу же отправляет новую запись в базу данных (вызов **обновления** не требуется); значение свойства **EditMode** не изменяется (**адедитноне**).

В *режиме пакетного обновления* (в котором поставщик кэширует несколько изменений и записывает их в базовый источник данных только при вызове метода [UpdateBatch](updatebatch-method-ado.md) ), вызов метода **AddNew** без аргументов задает **EditMode** для свойства **адедитадд**. Поставщик кэширует все изменения значения поля локально. Вызов метода **Update** добавляет новую запись в текущий **набор записей** и сбрасывает свойство **EditMode** в **адедитноне**, но поставщик не отправляет изменения в базовую базу данных, пока не будет вызвана функция **UpdateBatch **метод. Если вы передаете аргументы *фиелдлист* и *Values* , ADO отправляет новую запись поставщику для хранения в кэше; для отправки новой записи в базовую базу данных необходимо вызвать метод **UpdateBatch** .


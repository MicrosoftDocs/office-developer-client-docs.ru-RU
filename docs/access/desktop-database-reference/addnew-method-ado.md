---
title: Метод AddNew (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 379aa71ad875213ab8c1ae022f7c8af3350b2662
ms.sourcegitcommit: d7248f803002b31cf7fc561b03530199a9b0a8fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2018
ms.locfileid: "25927748"
---
# <a name="addnew-method-ado"></a>Метод AddNew (ADO)


**Применимо к**: Access 2013, Office 2013

Создает новую запись для обновляемых объекта [набора записей](recordset-object-ado.md) .

## <a name="syntax"></a>Синтаксис

*набор записей*. AddNew *FieldList*, *значения*

## <a name="parameters"></a>Параметры

  - *набор записей*

  - Объект **набора записей** .

  - *FieldList*

  - Необязательно указывать. Имя одного или массив имен или порядковый номер позиции поля в новую запись.

  - *Значения*

  - Необязательно указывать. Одиночное значение или массив значений для полей в новую запись. Если *Fieldlist* является массивом, *значения* также должны быть массив с числом участников; в противном случае возникает ошибка. Порядок имена полей должен совпадать с порядком значений полей в каждом массиве.

## <a name="remarks"></a>Примечания

Используйте метод **AddNew** для создания и инициализации новую запись. Использование метода [поддерживает](supports-method-ado.md) с **adAddNew** (значение [CursorOptionEnum](cursoroptionenum.md) ) для проверки, является ли записи можно добавлять в текущий объект **набора записей** .

После вызова метода **AddNew** новую запись становится текущей и остается в текущем после вызова метода [Update](update-method-ado.md) . Поскольку новую запись добавляется к **набору записей**, вызов **MoveNext** после обновления будут перемещаться за пределами набора **записей**, создание **EOF** значение True. Если объекта **набора записей** не поддерживает закладки, может не иметь возможность получить доступ к новой записи после перемещения к другой записи. В зависимости от типа вашей текущей позиции необходимо вызвать метод [повторный запрос](requery-method-ado.md) для предоставления специальных возможностей новую запись.

При вызове **AddNew** во время редактирования текущей записи или при добавлении новой записи, ADO вызывает метод **Update** , чтобы сохранить все изменения и затем создает новую запись.

Поведение метода **AddNew** зависит от режима обновления объекта **набора записей** и ли передавать аргументы *Fieldlist* и их *значения* .

В *режиме немедленное обновление* (где поставщик записывает изменения к базовому источнику данных после вызова метода **Update** ) вызов метода **AddNew** без аргументов задает свойство [EditMode](editmode-property-ado.md) **adEditAdd** ) значение [EditModeEnum](editmodeenum.md) ). Поставщик кэширует изменения значений полей локально. Вызов метода **Update** публикует новую запись в базу данных и сбрасывает свойство **EditMode** **как таковые** (значение **EditModeEnum** ). Если передать аргументы *Fieldlist* и *значения* , ADO немедленно публикует новую запись в базу данных (без вызова **обновления** не требуется); значение свойства **EditMode** не изменяется (**как таковые**).

В *пакетном режиме обновления* (в котором поставщик кэширует несколько изменений и записывает их в источнике данных только при вызове метода [UpdateBatch](updatebatch-method-ado.md) ) вызов метода **AddNew** без аргументов задает **EditMode** свойство, позволяющее **adEditAdd**. Поставщик кэширует изменения значений полей локально. Вызов метода **Update** добавляет новую запись текущего **набора записей** и сбрасывает свойство **EditMode** **как таковые**, но поставщик не учесть изменения в основной базе данных, пока не будет вызван **UpdateBatch **метод. Если передать аргументы *Fieldlist* и *значения* , ADO отправляет новую запись поставщика для хранения в кэше; необходимо вызвать метод **UpdateBatch** для публикации новой записи в основной базе данных.


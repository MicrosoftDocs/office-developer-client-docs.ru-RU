---
title: Метод AddNew (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f733c574ba7927587c6fcb6305a361ca1070de0f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282515"
---
# <a name="addnew-method-ado"></a>Метод AddNew (ADO)

**Область применения**: Access 2013, Office 2013

Создает новую запись для обновляемого объекта [Recordset](recordset-object-ado.md).

## <a name="syntax"></a>Синтаксис

*набор записей.* AddNew *FieldList*, *Значения*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*набор записей* |Объект **Recordset.**|
|*FieldList* |Необязательный параметр. Одно имя или массив имен или координат полей в новой записи.|
|*Values* |Необязательный параметр. Одно значение или массив значений для полей в новой записи. Если *Fieldlist* — массив, *значения* также должны быть массивом с таким же количеством участников; в противном случае возникает ошибка. Порядок имен полей должен соответствовать порядку значений поля в каждом массиве.|

## <a name="remarks"></a>Примечания

Используйте метод **AddNew** для создания и инициализации новой записи. Используйте метод [Supports](supports-method-ado.md) с **помощью adAddNew** (значение [CursorOptionEnum)](cursoroptionenum.md) для проверки возможности добавления записей к текущему объекту **Recordset.**

После вызова метода **AddNew** новая запись становится текущей и остается текущей после вызова метода [Update.](update-method-ado.md) Так как новая запись примыкает к **Набору** записей, вызов **MoveNext** после обновления будет перемещаться мимо конца **recordset,** что делает **EOF** True. Если объект **Recordset** не поддерживает закладки, вы не сможете получить доступ к новой записи после перемещения на другую запись. В зависимости от типа курсора может потребоваться вызвать метод [Requery,](requery-method-ado.md) чтобы сделать новую запись доступной.

Если вы вызываете **AddNew** при редактировании текущей записи или при добавлении новой записи, ADO вызывает метод **Update,** чтобы сохранить все изменения, а затем создает новую запись.

Поведение метода **AddNew** зависит от режима обновления объекта **Recordset** и от того, передаете ли вы аргументы *Fieldlist* и *Values.*

В режиме немедленного обновления (в котором поставщик записывает изменения  в исходный источник данных после вызова метода Update), вызов метода **AddNew** без аргументов задает свойство [EditMode](editmode-property-ado.md) **adEditAdd** (значение [EditModeEnum).](editmodeenum.md)  Поставщик кэшет любых изменений локального значения поля. Метод **Обновления публикует** новую запись в базу данных и сбрасывает свойство **EditMode** в **adEditNone** (значение **EditModeEnum).** Если вы передаете *аргументы Fieldlist* и *Values,* ADO немедленно публикует новую запись в базу данных (вызов **обновления** не требуется); значение **свойства EditMode** не меняется **(adEditNone).**

В режиме пакетного обновления *(в* котором поставщик кэширует несколько изменений и записывает их в исходный источник данных только при вызове метода [UpdateBatch),](updatebatch-method-ado.md) вызов метода **AddNew** без аргументов задает свойство **EditMode** **adEditAdd.** Поставщик кэшет любых изменений локального значения поля. Вызов метода **Update** добавляет новую запись в текущий набор **recordset** и сбрасывает свойство **EditMode** в **adEditNone,** но поставщик не вывешит изменения в баз данных, пока не будет вызывать метод **UpdateBatch.** Если вы передаете *аргументы Fieldlist* и *Values,* ADO отправляет новую запись поставщику для хранения в кэше; для публикации новой записи в баз данных необходимо вызвать метод **UpdateBatch.**


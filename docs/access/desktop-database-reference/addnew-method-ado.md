---
title: Метод AddNew (ADO)
TOCTitle: AddNew method (ADO)
ms:assetid: bae09be0-5707-4f38-9c74-0acd0f29dbac
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249899(v=office.15)
ms:contentKeyID: 48547384
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f733c574ba7927587c6fcb6305a361ca1070de0f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282515"
---
# <a name="addnew-method-ado"></a><span data-ttu-id="f7c16-102">Метод AddNew (ADO)</span><span class="sxs-lookup"><span data-stu-id="f7c16-102">AddNew method (ADO)</span></span>

<span data-ttu-id="f7c16-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="f7c16-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="f7c16-104">Создает новую запись для обновляемого объекта [Recordset](recordset-object-ado.md).</span><span class="sxs-lookup"><span data-stu-id="f7c16-104">Creates a new record for an updatable [Recordset](recordset-object-ado.md) object.</span></span>

## <a name="syntax"></a><span data-ttu-id="f7c16-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="f7c16-105">Syntax</span></span>

<span data-ttu-id="f7c16-106">*набор записей.* AddNew *FieldList*, *Значения*</span><span class="sxs-lookup"><span data-stu-id="f7c16-106">*recordset*.AddNew *FieldList*, *Values*</span></span>

## <a name="parameters"></a><span data-ttu-id="f7c16-107">Параметры</span><span class="sxs-lookup"><span data-stu-id="f7c16-107">Parameters</span></span>

|<span data-ttu-id="f7c16-108">Параметр</span><span class="sxs-lookup"><span data-stu-id="f7c16-108">Parameter</span></span>|<span data-ttu-id="f7c16-109">Описание</span><span class="sxs-lookup"><span data-stu-id="f7c16-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="f7c16-110">*набор записей*</span><span class="sxs-lookup"><span data-stu-id="f7c16-110">*recordset*</span></span> |<span data-ttu-id="f7c16-111">Объект **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="f7c16-111">A **Recordset** object.</span></span>|
|<span data-ttu-id="f7c16-112">*FieldList*</span><span class="sxs-lookup"><span data-stu-id="f7c16-112">*FieldList*</span></span> |<span data-ttu-id="f7c16-113">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f7c16-113">Optional.</span></span> <span data-ttu-id="f7c16-114">Одно имя или массив имен или координат полей в новой записи.</span><span class="sxs-lookup"><span data-stu-id="f7c16-114">A single name, or an array of names or ordinal positions of the fields in the new record.</span></span>|
|<span data-ttu-id="f7c16-115">*Values*</span><span class="sxs-lookup"><span data-stu-id="f7c16-115">*Values*</span></span> |<span data-ttu-id="f7c16-116">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f7c16-116">Optional.</span></span> <span data-ttu-id="f7c16-117">Одно значение или массив значений для полей в новой записи.</span><span class="sxs-lookup"><span data-stu-id="f7c16-117">A single value, or an array of values for the fields in the new record.</span></span> <span data-ttu-id="f7c16-118">Если *Fieldlist* — массив, *значения* также должны быть массивом с таким же количеством участников; в противном случае возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="f7c16-118">If *Fieldlist* is an array, *Values* must also be an array with the same number of members; otherwise, an error occurs.</span></span> <span data-ttu-id="f7c16-119">Порядок имен полей должен соответствовать порядку значений поля в каждом массиве.</span><span class="sxs-lookup"><span data-stu-id="f7c16-119">The order of field names must match the order of field values in each array.</span></span>|

## <a name="remarks"></a><span data-ttu-id="f7c16-120">Примечания</span><span class="sxs-lookup"><span data-stu-id="f7c16-120">Remarks</span></span>

<span data-ttu-id="f7c16-121">Используйте метод **AddNew** для создания и инициализации новой записи.</span><span class="sxs-lookup"><span data-stu-id="f7c16-121">Use the **AddNew** method to create and initialize a new record.</span></span> <span data-ttu-id="f7c16-122">Используйте метод [Supports](supports-method-ado.md) с **помощью adAddNew** (значение [CursorOptionEnum)](cursoroptionenum.md) для проверки возможности добавления записей к текущему объекту **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="f7c16-122">Use the [Supports](supports-method-ado.md) method with **adAddNew** (a [CursorOptionEnum](cursoroptionenum.md) value) to verify whether you can add records to the current **Recordset** object.</span></span>

<span data-ttu-id="f7c16-123">После вызова метода **AddNew** новая запись становится текущей и остается текущей после вызова метода [Update.](update-method-ado.md)</span><span class="sxs-lookup"><span data-stu-id="f7c16-123">After you call the **AddNew** method, the new record becomes the current record and remains current after you call the [Update](update-method-ado.md) method.</span></span> <span data-ttu-id="f7c16-124">Так как новая запись примыкает к **Набору** записей, вызов **MoveNext** после обновления будет перемещаться мимо конца **recordset,** что делает **EOF** True.</span><span class="sxs-lookup"><span data-stu-id="f7c16-124">Since the new record is appended to the **Recordset**, a call to **MoveNext** following the Update will move past the end of the **Recordset**, making **EOF** True.</span></span> <span data-ttu-id="f7c16-125">Если объект **Recordset** не поддерживает закладки, вы не сможете получить доступ к новой записи после перемещения на другую запись.</span><span class="sxs-lookup"><span data-stu-id="f7c16-125">If the **Recordset** object does not support bookmarks, you may not be able to access the new record once you move to another record.</span></span> <span data-ttu-id="f7c16-126">В зависимости от типа курсора может потребоваться вызвать метод [Requery,](requery-method-ado.md) чтобы сделать новую запись доступной.</span><span class="sxs-lookup"><span data-stu-id="f7c16-126">Depending on your cursor type, you may need to call the [Requery](requery-method-ado.md) method to make the new record accessible.</span></span>

<span data-ttu-id="f7c16-127">Если вы вызываете **AddNew** при редактировании текущей записи или при добавлении новой записи, ADO вызывает метод **Update,** чтобы сохранить все изменения, а затем создает новую запись.</span><span class="sxs-lookup"><span data-stu-id="f7c16-127">If you call **AddNew** while editing the current record or while adding a new record, ADO calls the **Update** method to save any changes and then creates the new record.</span></span>

<span data-ttu-id="f7c16-128">Поведение метода **AddNew** зависит от режима обновления объекта **Recordset** и от того, передаете ли вы аргументы *Fieldlist* и *Values.*</span><span class="sxs-lookup"><span data-stu-id="f7c16-128">The behavior of the **AddNew** method depends on the updating mode of the **Recordset** object and whether you pass the *Fieldlist* and *Values* arguments.</span></span>

<span data-ttu-id="f7c16-129">В режиме немедленного обновления (в котором поставщик записывает изменения  в исходный источник данных после вызова метода Update), вызов метода **AddNew** без аргументов задает свойство [EditMode](editmode-property-ado.md) **adEditAdd** (значение [EditModeEnum).](editmodeenum.md) </span><span class="sxs-lookup"><span data-stu-id="f7c16-129">In *immediate update mode* (in which the provider writes changes to the underlying data source once you call the **Update** method), calling the **AddNew** method without arguments sets the [EditMode](editmode-property-ado.md) property to **adEditAdd** (an [EditModeEnum](editmodeenum.md) value).</span></span> <span data-ttu-id="f7c16-130">Поставщик кэшет любых изменений локального значения поля.</span><span class="sxs-lookup"><span data-stu-id="f7c16-130">The provider caches any field value changes locally.</span></span> <span data-ttu-id="f7c16-131">Метод **Обновления публикует** новую запись в базу данных и сбрасывает свойство **EditMode** в **adEditNone** (значение **EditModeEnum).**</span><span class="sxs-lookup"><span data-stu-id="f7c16-131">Calling the **Update** method posts the new record to the database and resets the **EditMode** property to **adEditNone** (an **EditModeEnum** value).</span></span> <span data-ttu-id="f7c16-132">Если вы передаете *аргументы Fieldlist* и *Values,* ADO немедленно публикует новую запись в базу данных (вызов **обновления** не требуется); значение **свойства EditMode** не меняется **(adEditNone).**</span><span class="sxs-lookup"><span data-stu-id="f7c16-132">If you pass the *Fieldlist* and *Values* arguments, ADO immediately posts the new record to the database (no **Update** call is necessary); the **EditMode** property value does not change (**adEditNone**).</span></span>

<span data-ttu-id="f7c16-133">В режиме пакетного обновления *(в* котором поставщик кэширует несколько изменений и записывает их в исходный источник данных только при вызове метода [UpdateBatch),](updatebatch-method-ado.md) вызов метода **AddNew** без аргументов задает свойство **EditMode** **adEditAdd.**</span><span class="sxs-lookup"><span data-stu-id="f7c16-133">In *batch update mode* (in which the provider caches multiple changes and writes them to the underlying data source only when you call the [UpdateBatch](updatebatch-method-ado.md) method), calling the **AddNew** method without arguments sets the **EditMode** property to **adEditAdd**.</span></span> <span data-ttu-id="f7c16-134">Поставщик кэшет любых изменений локального значения поля.</span><span class="sxs-lookup"><span data-stu-id="f7c16-134">The provider caches any field value changes locally.</span></span> <span data-ttu-id="f7c16-135">Вызов метода **Update** добавляет новую запись в текущий набор **recordset** и сбрасывает свойство **EditMode** в **adEditNone,** но поставщик не вывешит изменения в баз данных, пока не будет вызывать метод **UpdateBatch.**</span><span class="sxs-lookup"><span data-stu-id="f7c16-135">Calling the **Update** method adds the new record to the current **Recordset** and resets the **EditMode** property to **adEditNone**, but the provider does not post the changes to the underlying database until you call the **UpdateBatch** method.</span></span> <span data-ttu-id="f7c16-136">Если вы передаете *аргументы Fieldlist* и *Values,* ADO отправляет новую запись поставщику для хранения в кэше; для публикации новой записи в баз данных необходимо вызвать метод **UpdateBatch.**</span><span class="sxs-lookup"><span data-stu-id="f7c16-136">If you pass the *Fieldlist* and *Values* arguments, ADO sends the new record to the provider for storage in a cache; you need to call the **UpdateBatch** method to post the new record to the underlying database.</span></span>


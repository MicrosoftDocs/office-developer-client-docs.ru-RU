---
title: Using RDS with ODBC Connection Pooling
TOCTitle: Using RDS with ODBC Connection Pooling
ms:assetid: 6e8b023a-d211-44cb-10af-d43174a5d4bc
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249437(v=office.15)
ms:contentKeyID: 48545513
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 87d380fdc52cdee2aa834fd6e78ff1b761a0e93a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32312119"
---
# <a name="using-rds-with-odbc-connection-pooling"></a>Использование RDS с группировкой подключений ODBC


**Область применения**: Access 2013, Office 2013

Если вы используете источник данных ODBC, вы можете использовать параметр пулов подключений в службах IIS для обеспечения высокой производительности нагрузки клиентов. Пул подключений является диспетчером ресурсов для подключений, сохраняя открытое состояние в часто используемых подключениях.

Для включения пула подключений обратитесь к документации Internet Information Services.

Обратите внимание, что включение пула подключений может привести к перечислению веб-сервера на другие ограничения, как указано в документации Microsoft Internet Information Services.

Чтобы обеспечить стабильность пула подключений и повышения производительности, необходимо настроить Microsoft SQL Server для использования сетевой библиотеки сокетов TCP/IP.

Для этого необходимо выполнить указанные ниже действия.

  - Настройка компьютера с SQL Server для использования сокетов TCP/IP.

  - Настройте веб-сервер для использования сокетов TCP/IP.

## <a name="configuring-the-sql-server-computer-to-use-tcpip-sockets"></a>Настройка компьютера с SQL Server для использования сокетов TCP/IP

На компьютере с SQL Server запустите программу установки SQL Server, чтобы при взаимодействии с источником данных использовалась сетевая библиотека сокетов TCP/IP.

**Указание сетевой библиотеки сокетов TCP/IP на компьютере с SQL Server**

**В Microsoft SQL Server 6,5:**

1.  В меню **Пуск** выберите **программы**, затем **Microsoft SQL Server 6,5**и щелкните **Установка SQL**.

2.  Дважды нажмите кнопку **продолжить** .

3.  В диалоговом окне **Параметры Microsoft SQL Server** выберите **Изменить сетевую поддержку**, а затем нажмите кнопку **продолжить**.

4.  Убедитесь, что установлен флажок **сокеты TCP/IP** , и нажмите кнопку **ОК**.

5.  Нажмите кнопку **Далее** , чтобы завершить работу и выйти из программы установки.

**В Microsoft SQL Server 7,0:**

1.  В меню **Пуск** последовательно выберите пункты **программы**, **Microsoft SQL Server 7,0**и **сетевое средство сервера**.

2.  На вкладке " **Общие** " диалогового окна нажмите кнопку **Добавить**.

3.  В диалоговом окне **Добавление конфигурации сетевой библиотеки** выберите **TCP/IP**.

4.  В поля **номер порта** и **адрес прокси-сервера** введите номер порта и адрес прокси-сервера, предоставленные администратором сети.

5.  Нажмите кнопку **ОК** , чтобы завершить работу, и закройте программу установки.

## <a name="configuring-the-web-server-to-use-tcpip-sockets"></a>Настройка веб-сервера для использования сокетов TCP/IP

Настроить веб-сервер для использования сокетов TCP/IP можно двумя способами. Действия, которые вы выполняете, зависят от того, доступны ли все серверы SQL с веб-сервера, или доступ к конкретному серверу SQL с веб-сервера.

Если доступ ко всем серверам SQL Server осуществляется с веб-сервера, необходимо запустить служебную программу настройки клиента SQL Server на компьютере веб-сервера. Следующие действия изменяют сетевую библиотеку по умолчанию для всех подключений SQL Server, выполняемых с этого веб-сервера IIS, для использования сетевой библиотеки TCP/IP Sockets.

**Настройка веб-сервера (все серверы SQL Server)**

**Для Microsoft SQL Server 6,5:**

1.  В меню **Пуск** выберите **программы**, затем **Microsoft SQL Server 6,5**и щелкните **служебная программа настройки клиента SQL**.

2.  Перейдите на вкладку **Библиотека NET** .

3.  В поле **сеть по умолчанию** выберите **сокеты TCP/IP**.

4.  Нажмите кнопку **Готово** , чтобы сохранить изменения и выйти из программы.

**Для Microsoft SQL Server 7,0:**

1.  В меню **Пуск** последовательно выберите пункты **программы**, **Microsoft SQL Server 7,0**и **служебная сеть клиента**.

2.  Перейдите на вкладку **Общие**.

3.  В поле **Сетевая библиотека по умолчанию** выберите **TCP/IP**.

4.  Нажмите кнопку **ОК** , чтобы сохранить изменения и выйти из программы.

Если доступ к определенному серверу SQL Server осуществляется с веб-сервера, необходимо запустить служебную программу настройки клиента SQL Server на компьютере веб-сервера. Чтобы изменить сетевую библиотеку для конкретного подключения к SQL Server, настройте клиентское программное обеспечение SQL Server на компьютере веб-сервера следующим образом.

**Настройка веб-сервера (определенного сервера SQL Server)**

**Для Microsoft SQL Server 6,5:**

1.  В меню **Пуск** выберите **программы**, затем **Microsoft SQL Server 6,5**и щелкните **служебная программа настройки клиента SQL**.

2.  Откройте вкладку **Дополнительно**.

3.  В поле **сервер** введите имя сервера, к которому необходимо подключиться с помощью сокетов **TCP/IP**.

4.  В поле **имя библиотеки DLL** выберите пункт **сокеты TCP/IP**.

5.  Нажмите кнопку **Добавить/изменить**. Все источники данных, указывающие на этот сервер, теперь будут использовать сокеты TCP/IP.

6.  Нажмите кнопку **Готово**.

**Для Microsoft SQL Server 7,0:**

1.  В меню **Пуск** последовательно выберите пункты **программы**, **Microsoft SQL Server 7,0**и **служебная программа настройки клиента**.

2.  Перейдите на вкладку **Общие**.

3.  Нажмите кнопку **Добавить**.

4.  Введите псевдоним сервера в поле **псевдоним сервера** . В поле **сетевые библиотеки** выберите **TCP/IP**. В поле **имя компьютера** введите имя компьютера, который прослушивает клиентов сокетов TCP/IP. В поле **номер порта введите номер** порта, на котором проСлушивается SQL Server.

5.  Нажмите кнопку **ОК**, а затем снова кнопку **ОК** , чтобы выйти из служебной программы.


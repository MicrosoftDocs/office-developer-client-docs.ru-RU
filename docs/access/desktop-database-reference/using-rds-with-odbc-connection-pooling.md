---
title: Using RDS with ODBC Connection Pooling
TOCTitle: Using RDS with ODBC Connection Pooling
ms:assetid: 6e8b023a-d211-44cb-10af-d43174a5d4bc
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249437(v=office.15)
ms:contentKeyID: 48545513
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 87d380fdc52cdee2aa834fd6e78ff1b761a0e93a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32312119"
---
# <a name="using-rds-with-odbc-connection-pooling"></a>Использование RDS с группировкой подключений ODBC


**Область применения**: Access 2013, Office 2013

При использовании источника данных ODBC можно использовать параметр пула подключений в службах IIS для обеспечения высокой производительности обработки клиентской нагрузки. Пулы подключений — это диспетчер ресурсов для подключений, который поддерживает открытое состояние для часто используемых подключений.

Чтобы включить пул подключений, обратитесь к документации по службам Internet Information Services.

Обратите внимание, что включение пула подключений может привести к другим ограничениям веб-сервера, как отмечено в Microsoft IIS документации.

Чтобы обеспечить стабильность пула подключений и повышение производительности, необходимо настроить Microsoft SQL Server для использования сетевой библиотеки TCP/IP-socket.

Для этого необходимо выполнить указанные ниже действия.

  - Настройте компьютер SQL Server для использования TCP/IP-sockets.

  - Настройте веб-сервер для использования TCP/IP-sockets.

## <a name="configuring-the-sql-server-computer-to-use-tcpip-sockets"></a>Настройка компьютера SQL Server для использования TCP/IP-sockets

На компьютере SQL Server запустите программу установки SQL Server, чтобы взаимодействие с источником данных использовали сетевую библиотеку TCP/IP-socket.

**Указание сетевой библиотеки TCP/IP-SQL Server компьютера**

**В Microsoft SQL Server 6.5:**

1.  В меню **"Пуск"** найдите пункт "Программы", выберите Microsoft SQL Server **6.5,** а затем нажмите кнопку **SQL программы установки.** 

2.  Дважды **нажмите кнопку** "Продолжить".

3.  В **диалоговом окне Microsoft SQL Server параметры** выберите **"Изменить** поддержку сети" и нажмите кнопку **"Продолжить".**

4.  Убедитесь, что для **TCP/IP-сосетей** выбраны все и нажмите кнопку **"ОК".**

5.  Нажмите **кнопку** "Продолжить", чтобы завершить настройку, и завершите настройку.

**В Microsoft SQL Server 7.0:**

1.  В меню **"Пуск"** выберите **пункты**"Программы", **"Microsoft SQL Server 7.0"** и "Сетевая программа **сервера".**

2.  На **вкладке "Общие"** диалоговое окно нажмите кнопку **"Добавить".**

3.  В **диалоговом окне** "Добавление конфигурации сетевой библиотеки" щелкните **TCP/IP.**

4.  В **полях "Номер порта"** и **"Адрес** прокси-сервера" введите номер порта и прокси-адрес, предоставленные администратором сети.

5.  Нажмите **кнопку** "ОК", чтобы завершить настройку, и выйдите из нее.

## <a name="configuring-the-web-server-to-use-tcpip-sockets"></a>Настройка веб-сервера для использования TCP/IP-sockets

Существует два варианта настройки веб-сервера на использование TCP/IP-sockets. То, что вы делаете, зависит от того SQL ли все серверы SQL с веб-сервера или только определенный SQL Server доступ с веб-сервера.

Если все SQL серверы доступны с веб-сервера, необходимо запустить SQL Server клиентской конфигурации на компьютере веб-сервера. Следующие действия изменяют сетевую библиотеку по умолчанию для всех подключений SQL Server, сделанных с этого веб-сервера IIS, на использование сетевой библиотеки TCP/IP Sockets.

**Настройка веб-сервера (всех SQL серверов)**

**Для Microsoft SQL Server 6.5:**

1.  В меню **"Пуск"** найдите пункт "Программы", выберите Microsoft SQL Server **6.5,** а затем выберите SQL **client Configuration Utility.** 

2.  Перейдите **на вкладку "Net Library".**

3.  В поле **"Сеть по** умолчанию" выберите **TCP/IP-sockets.**

4.  Нажмите **кнопку "Готово",** чтобы сохранить изменения и выйти из нее.

**Для Microsoft SQL Server 7.0:**

1.  В меню **"Пуск"** выберите **пункты**"Программы", **"Microsoft SQL Server 7.0"** и "Совая программа **клиента".**

2.  Перейдите на вкладку **Общие**.

3.  В поле **сетевой библиотеки по умолчанию** щелкните **TCP/IP.**

4.  Нажмите **кнопку "ОК",** чтобы сохранить изменения и выйти из нее.

Если определенный SQL Server с веб-сервера, необходимо запустить SQL Server клиентской конфигурации на компьютере веб-сервера. Чтобы изменить сетевую библиотеку для определенного SQL Server подключения, настройте программное обеспечение клиента SQL Server на компьютере веб-сервера следующим образом.

**Настройка веб-сервера (определенного SQL Server)**

**Для Microsoft SQL Server 6.5:**

1.  В меню **"Пуск"** найдите пункт "Программы", выберите Microsoft SQL Server **6.5,** а затем выберите SQL **client Configuration Utility.** 

2.  Откройте вкладку **Дополнительно**.

3.  В поле **"Сервер"** введите имя сервера для подключения с помощью **TCP/IP-sockets.**

4.  В поле **"Имя DLL"** выберите **TCP/IP-sockets.**

5.  Нажмите **кнопку "Добавить/изменить".** Все источники данных, которые указывают на этот сервер, теперь будут использовать TCP/IP-sockets.

6.  Нажмите кнопку **Готово**.

**Для Microsoft SQL Server 7.0:**

1.  В меню **"Пуск"** выберите **пункты**"Программы", **"Microsoft SQL Server 7.0"** и "Совластика конфигурации **клиента".**

2.  Перейдите на вкладку **Общие**.

3.  Нажмите **Добавить**.

4.  Введите псевдоним сервера в поле **"Псевдоним сервера".** В поле **"Сетевые библиотеки"** щелкните **TCP/IP.** В поле **"Имя компьютера"** введите имя компьютера, который прослушивает клиенты TCP/IP Sockets. В поле **"Номер порта"** введите порт, по которому SQL Server прослушивает.

5.  Нажмите **кнопку**"ОК", а затем снова ОК, чтобы выйти из этой сущности. 


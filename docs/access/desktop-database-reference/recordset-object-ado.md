---
title: Объект Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300478"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="26593-102">Объект Recordset (ADO)</span><span class="sxs-lookup"><span data-stu-id="26593-102">Recordset object (ADO)</span></span>

<span data-ttu-id="26593-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="26593-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="26593-104">Представляет весь набор записей из базовой таблицы или результаты выполнения команды.</span><span class="sxs-lookup"><span data-stu-id="26593-104">Represents the entire set of records from a base table or the results of an executed command.</span></span> <span data-ttu-id="26593-105">В любой момент объект **Recordset** ссылается только на одну запись в наборе в качестве текущей записи.</span><span class="sxs-lookup"><span data-stu-id="26593-105">At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="26593-106">Заметки</span><span class="sxs-lookup"><span data-stu-id="26593-106">Remarks</span></span>

<span data-ttu-id="26593-107">Объекты **Recordset используются** для управления данными от поставщика.</span><span class="sxs-lookup"><span data-stu-id="26593-107">You use **Recordset** objects to manipulate data from a provider.</span></span> <span data-ttu-id="26593-108">При использовании ADO вы практически полностью управляете данными с помощью **объектов Recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-108">When you use ADO, you manipulate data almost entirely using **Recordset** objects.</span></span> <span data-ttu-id="26593-109">Все **объекты Recordset** состоят из записей (строк) и полей (столбцов).</span><span class="sxs-lookup"><span data-stu-id="26593-109">All **Recordset** objects consist of records (rows) and fields (columns).</span></span> <span data-ttu-id="26593-110">В зависимости от функций, поддерживаемых поставщиком, некоторые методы или свойства **recordset** могут быть недоступны.</span><span class="sxs-lookup"><span data-stu-id="26593-110">Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="26593-111">ADODB. Recordset — это progID, который следует использовать для создания **объекта Recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-111">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object.</span></span> <span data-ttu-id="26593-112">Существующие приложения, ссылаясь на устаревший ADOR. Recordset ProgID продолжит работать без повторной скомпилы, но новая разработка должна ссылаться на ADODB. Recordset.</span><span class="sxs-lookup"><span data-stu-id="26593-112">Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="26593-113">Существует четыре различных типа курсоров, определенных в ADO:</span><span class="sxs-lookup"><span data-stu-id="26593-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="26593-114">**Динамический курсор** — позволяет просматривать добавления, изменения и удаления другими пользователями; позволяет всем типам перемещения по **набору записей,** не зависят от закладок; и разрешает закладки, если поставщик их поддерживает.</span><span class="sxs-lookup"><span data-stu-id="26593-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="26593-115">**Курсор Keyset** — ведет себя как динамический курсор, за исключением того, что он не позволяет увидеть записи, которые добавляют другие пользователи, и не позволяет получить доступ к записям, которые другие пользователи удаляют.</span><span class="sxs-lookup"><span data-stu-id="26593-115">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete.</span></span> <span data-ttu-id="26593-116">Изменения данных другими пользователями по-прежнему будут видны.</span><span class="sxs-lookup"><span data-stu-id="26593-116">Data changes by other users will still be visible.</span></span> <span data-ttu-id="26593-117">Он всегда поддерживает закладки и, следовательно, разрешает все типы перемещения через **recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-117">It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="26593-118">**Статический курсор** — предоставляет статическую копию набора записей, которые можно использовать для поиска данных или создания отчетов; всегда разрешает закладки и, следовательно, разрешает все типы перемещения через **набор записей.**</span><span class="sxs-lookup"><span data-stu-id="26593-118">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**.</span></span> <span data-ttu-id="26593-119">Добавления, изменения или удаления другими пользователями не будут видны.</span><span class="sxs-lookup"><span data-stu-id="26593-119">Additions, changes, or deletions by other users will not be visible.</span></span> <span data-ttu-id="26593-120">Это единственный тип курсора, разрешенный при открываемом клиентском объекте **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-120">This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="26593-121">**Курсор "Только вперед"** позволяет прокручивать только набор **записей.**</span><span class="sxs-lookup"><span data-stu-id="26593-121">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**.</span></span> <span data-ttu-id="26593-122">Добавления, изменения или удаления другими пользователями не будут видны.</span><span class="sxs-lookup"><span data-stu-id="26593-122">Additions, changes, or deletions by other users will not be visible.</span></span> <span data-ttu-id="26593-123">Это повышает производительность в ситуациях, когда требуется сделать только один проход через **набор записей.**</span><span class="sxs-lookup"><span data-stu-id="26593-123">This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="26593-124">Установите свойство [CursorType](cursortype-property-ado.md) перед открытием набора **записей,** чтобы выбрать тип курсора, или передав аргумент *CursorType* с помощью метода [Open.](open-method-ado-recordset.md)</span><span class="sxs-lookup"><span data-stu-id="26593-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="26593-125">Некоторые поставщики поддерживают не все типы курсоров.</span><span class="sxs-lookup"><span data-stu-id="26593-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="26593-126">Проверьте документацию для поставщика.</span><span class="sxs-lookup"><span data-stu-id="26593-126">Check the documentation for the provider.</span></span> <span data-ttu-id="26593-127">Если не указать тип курсора, ADO по умолчанию открывает курсор "только вперед".</span><span class="sxs-lookup"><span data-stu-id="26593-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="26593-128">Если для свойства [CursorLocation](cursorlocation-property-ado.md) установлено свойство **adUseClient** для открытия объекта **Recordset,** свойство **UnderlyingValue** в объектах [Field](field-object-ado.md) будет недоступным в возвращаемом объекте **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-128">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object.</span></span> <span data-ttu-id="26593-129">При использовании с некоторыми поставщиками (например, с поставщиком Microsoft ODBC для OLE DB в сочетании с Microsoft SQL Server) можно создать **объекты Recordset** независимо от ранее определенного объекта [Connection,](connection-object-ado.md) передав строку подключения с методом **Open.**</span><span class="sxs-lookup"><span data-stu-id="26593-129">When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method.</span></span> <span data-ttu-id="26593-130">ADO по-прежнему создает объект [Connection,](connection-object-ado.md) но не назначает этот объект объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="26593-130">ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable.</span></span> <span data-ttu-id="26593-131">Однако при открытии нескольких объектов **Recordset** по одному подключению необходимо явно создать и открыть **объект Connection;** При этом объект **Connection назначается** объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="26593-131">However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable.</span></span> <span data-ttu-id="26593-132">Если эта объектная переменная не используется при открытии объектов **Recordset,** ADO создает новый объект **Connection** для каждого нового объекта **Recordset,** даже если передается та же строка подключения.</span><span class="sxs-lookup"><span data-stu-id="26593-132">If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="26593-133">Можно создать столько объектов **Recordset,** сколько необходимо.</span><span class="sxs-lookup"><span data-stu-id="26593-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="26593-134">При **открываемом** наборе записей текущая запись устанавливается в первую запись (если таково), а свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) заданы как **False.**</span><span class="sxs-lookup"><span data-stu-id="26593-134">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**.</span></span> <span data-ttu-id="26593-135">Если записей нет, параметры свойств **BOF** и **EOF** имеют свойство **True.**</span><span class="sxs-lookup"><span data-stu-id="26593-135">If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="26593-136">Можно использовать методы [MoveFirst,](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) **MoveLast,** **MoveNext** и **MovePrevious;** метод [Move;](move-method-ado.md) и свойства [AbsolutePosition,](absoluteposition-property-ado.md) [AbsolutePage](absolutepage-property-ado.md)и [Filter](filter-property-ado.md) для переустановки текущей записи при условии, что поставщик поддерживает соответствующие функции.</span><span class="sxs-lookup"><span data-stu-id="26593-136">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality.</span></span> <span data-ttu-id="26593-137">Объекты **Recordset с переадранным** протоколом поддерживают только [метод MoveNext.](movefirst-movelast-movenext-and-moveprevious-methods-ado.md)</span><span class="sxs-lookup"><span data-stu-id="26593-137">Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method.</span></span> <span data-ttu-id="26593-138">При использовании методов **Move** для посещения каждой записи (или для нумерации объекта **Recordset)** можно использовать свойства **BOF** и **EOF,** чтобы определить, перемещены ли вы за пределы начала или конца **объекта Recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-138">When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="26593-139">**Объекты recordset** могут поддерживать два типа обновления: немедленное и пакетное.</span><span class="sxs-lookup"><span data-stu-id="26593-139">**Recordset** objects can support two types of updating: immediate and batched.</span></span> <span data-ttu-id="26593-140">При немедленном обновлении все изменения данных немедленно вписаны в исходный источник данных после вызова метода [Update.](update-method-ado.md)</span><span class="sxs-lookup"><span data-stu-id="26593-140">In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method.</span></span> <span data-ttu-id="26593-141">Вы также можете передать массивы значений в качестве параметров с помощью методов [AddNew](addnew-method-ado.md) и **Update** и одновременно обновить несколько полей в записи.</span><span class="sxs-lookup"><span data-stu-id="26593-141">You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="26593-142">Если поставщик поддерживает пакетное обновление, вы можете изменить кэш поставщика на несколько записей, а затем передать их в одном вызове базы данных с помощью метода [UpdateBatch.](updatebatch-method-ado.md)</span><span class="sxs-lookup"><span data-stu-id="26593-142">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method.</span></span> <span data-ttu-id="26593-143">Это относится к изменениям, внесенным с помощью методов **AddNew,** **Update** и [Delete.](delete-method-ado-recordset.md)</span><span class="sxs-lookup"><span data-stu-id="26593-143">This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods.</span></span> <span data-ttu-id="26593-144">После вызова метода **UpdateBatch** вы можете использовать свойство [Status,](status-property-ado-recordset.md) чтобы проверить все конфликты данных, чтобы устранить их.</span><span class="sxs-lookup"><span data-stu-id="26593-144">After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="26593-145">Чтобы выполнить запрос без использования объекта [Command,](command-object-ado.md) передайте строку запроса **методу Open** объекта **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="26593-145">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object.</span></span> <span data-ttu-id="26593-146">Однако объект **Command** необходим, если необходимо сохранить текст команды и выполнить его повторно, или использовать параметры запроса.</span><span class="sxs-lookup"><span data-stu-id="26593-146">However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="26593-147">Свойство [Mode](mode-property-ado.md) управляет разрешениями доступа.</span><span class="sxs-lookup"><span data-stu-id="26593-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="26593-148">Коллекция **Fields** является членом объекта **Recordset** по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="26593-148">The **Fields** collection is the default member of the **Recordset** object.</span></span> <span data-ttu-id="26593-149">В результате два следующих кода являются эквивалентными.</span><span class="sxs-lookup"><span data-stu-id="26593-149">As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

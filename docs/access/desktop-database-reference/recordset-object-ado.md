---
title: Объект Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300478"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="0f366-102">Объект Recordset (ADO)</span><span class="sxs-lookup"><span data-stu-id="0f366-102">Recordset object (ADO)</span></span>

<span data-ttu-id="0f366-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="0f366-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="0f366-104">Представляет весь набор записей из базовой таблицы или результаты выполненной команды.</span><span class="sxs-lookup"><span data-stu-id="0f366-104">Represents the entire set of records from a base table or the results of an executed command.</span></span> <span data-ttu-id="0f366-105">В любой момент объект **Recordset** относится только к одной записи в наборе в качестве текущей записи.</span><span class="sxs-lookup"><span data-stu-id="0f366-105">At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="0f366-106">Замечания</span><span class="sxs-lookup"><span data-stu-id="0f366-106">Remarks</span></span>

<span data-ttu-id="0f366-107">Объекты **Recordset** используются для управления данными от поставщика.</span><span class="sxs-lookup"><span data-stu-id="0f366-107">You use **Recordset** objects to manipulate data from a provider.</span></span> <span data-ttu-id="0f366-108">При использовании ADO данные практически полностью управляются с помощью объектов **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0f366-108">When you use ADO, you manipulate data almost entirely using **Recordset** objects.</span></span> <span data-ttu-id="0f366-109">Все объекты **Recordset** состоят из записей (строк) и полей (столбцов).</span><span class="sxs-lookup"><span data-stu-id="0f366-109">All **Recordset** objects consist of records (rows) and fields (columns).</span></span> <span data-ttu-id="0f366-110">В зависимости от функциональных возможностей, поддерживаемых поставщиком, некоторые методы или свойства **набора записей** могут быть недоступны.</span><span class="sxs-lookup"><span data-stu-id="0f366-110">Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="0f366-111">ADODB. Recordset — это ProgID, который следует использовать для создания объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0f366-111">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object.</span></span> <span data-ttu-id="0f366-112">Существующие приложения, ссылающиеся на устаревшую АДОР. Набор записей ProgID будет продолжать работать без повторной компиляции, но новая разработка должна ссылаться на ADODB. Recordset.</span><span class="sxs-lookup"><span data-stu-id="0f366-112">Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="0f366-113">В ADO определены четыре типа курсора:</span><span class="sxs-lookup"><span data-stu-id="0f366-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="0f366-114">**Динамический курсор** — позволяет просматривать добавления, изменения и удаления других пользователей; разрешает все типы передвижений по **набору записей** , которые не основываются на закладках; и позволяет использовать закладки, если они поддерживаются поставщиком.</span><span class="sxs-lookup"><span data-stu-id="0f366-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="0f366-115">**Курсор KEYSET** — имеет вид динамического курсора, за исключением того, что он не позволяет просматривать записи, добавленные другими пользователями, а также запрещает доступ к записям, которые удаляются другими пользователями.</span><span class="sxs-lookup"><span data-stu-id="0f366-115">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete.</span></span> <span data-ttu-id="0f366-116">Изменения данных, внесенные другими пользователями, по-прежнему будут отображаться.</span><span class="sxs-lookup"><span data-stu-id="0f366-116">Data changes by other users will still be visible.</span></span> <span data-ttu-id="0f366-117">Он всегда поддерживает закладки и позволяет выполнять все типы передвижений по **набору записей**.</span><span class="sxs-lookup"><span data-stu-id="0f366-117">It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="0f366-118">**Static Cursor** — содержит статическую копию набора записей, которую можно использовать для поиска данных или создания отчетов; всегда разрешает закладки и позволяет выполнять все типы передвижений по **набору записей**.</span><span class="sxs-lookup"><span data-stu-id="0f366-118">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**.</span></span> <span data-ttu-id="0f366-119">Добавленные, измененные или удаленные пользователи не будут отображаться.</span><span class="sxs-lookup"><span data-stu-id="0f366-119">Additions, changes, or deletions by other users will not be visible.</span></span> <span data-ttu-id="0f366-120">Это единственный тип курсора, разрешенный при открытии объекта **Recordset** на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="0f366-120">This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="0f366-121">**Однонаправленный курсор** — позволяет прокручивать только вперед по набору **записей**.</span><span class="sxs-lookup"><span data-stu-id="0f366-121">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**.</span></span> <span data-ttu-id="0f366-122">Добавленные, измененные или удаленные пользователи не будут отображаться.</span><span class="sxs-lookup"><span data-stu-id="0f366-122">Additions, changes, or deletions by other users will not be visible.</span></span> <span data-ttu-id="0f366-123">Это повышает производительность в ситуациях, когда необходимо выполнить только один проход через **набор записей**.</span><span class="sxs-lookup"><span data-stu-id="0f366-123">This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="0f366-124">Задайте свойство [CursorType](cursortype-property-ado.md) перед открытием объекта **Recordset** , чтобы выбрать тип курсора, или передайте аргумент *CursorType* с помощью метода [Open](open-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="0f366-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="0f366-125">Некоторые поставщики не поддерживают типы курсоров.</span><span class="sxs-lookup"><span data-stu-id="0f366-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="0f366-126">Проверьте документацию для поставщика.</span><span class="sxs-lookup"><span data-stu-id="0f366-126">Check the documentation for the provider.</span></span> <span data-ttu-id="0f366-127">Если не указать тип курсора, ADO по умолчанию открывает однонаправленный курсор.</span><span class="sxs-lookup"><span data-stu-id="0f366-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="0f366-128">Если свойству [CursorLocation](cursorlocation-property-ado.md) присвоено значение **адусеклиент** , чтобы открыть объект **Recordset**, свойство **UnderlyingValue** объектов [Fields](field-object-ado.md) недоступно в возвращенном объекте **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0f366-128">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object.</span></span> <span data-ttu-id="0f366-129">При использовании с некоторыми поставщиками (например, поставщиком Microsoft ODBC для OLE DB в сочетании с Microsoft SQL Server) можно создавать объекты **Recordset** независимо от ранее определенного объекта [Connection](connection-object-ado.md) путем передачи строки подключения с помощью метода **Open** .</span><span class="sxs-lookup"><span data-stu-id="0f366-129">When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method.</span></span> <span data-ttu-id="0f366-130">ADO по-прежнему создает объект [Connection](connection-object-ado.md) , но он не назначает этот объект объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="0f366-130">ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable.</span></span> <span data-ttu-id="0f366-131">Тем не менее, если вы открываете несколько объектов **Recordset** по одному подключению, необходимо явно создать и открыть объект **Connection** ; При этом объект **Connection** будет назначен объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="0f366-131">However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable.</span></span> <span data-ttu-id="0f366-132">Если не использовать эту объектную переменную при открытии объектов **Recordset** , ADO создает новый объект **Connection** для каждого нового объекта **Recordset**, даже если вы передаете одну и ту же строку подключения.</span><span class="sxs-lookup"><span data-stu-id="0f366-132">If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="0f366-133">Вы можете создать любое количество объектов **Recordset** по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="0f366-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="0f366-134">Когда вы открываете объект **Recordset**, текущая запись размещается в первой записи (если она есть), а свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) имеют значение **false**.</span><span class="sxs-lookup"><span data-stu-id="0f366-134">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**.</span></span> <span data-ttu-id="0f366-135">Если записей нет, параметры свойства **BOF** и **EOF** имеют **значение true**.</span><span class="sxs-lookup"><span data-stu-id="0f366-135">If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="0f366-136">Вы можете использовать методы [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**и **MovePrevious** ; метод [Move](move-method-ado.md) ; и свойства [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md)и [Filter](filter-property-ado.md) , чтобы изменить положение текущей записи, предполагая, что поставщик поддерживает соответствующую функциональность.</span><span class="sxs-lookup"><span data-stu-id="0f366-136">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality.</span></span> <span data-ttu-id="0f366-137">Объекты **Recordset** , посылаемые только вперед, поддерживают только метод [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="0f366-137">Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method.</span></span> <span data-ttu-id="0f366-138">При использовании методов **Move** для посещения каждой записи (или перечисления **набора записей**) можно использовать свойства **BOF** и **EOF** , чтобы определить, переместилось ли вы за начало или конец **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="0f366-138">When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="0f366-139">Объекты **Recordset** могут поддерживать два типа обновления: немедленные и пакетные.</span><span class="sxs-lookup"><span data-stu-id="0f366-139">**Recordset** objects can support two types of updating: immediate and batched.</span></span> <span data-ttu-id="0f366-140">При немедленном обновлении все изменения данных немедленно записываются в базовый источник данных после вызова метода [Update](update-method-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="0f366-140">In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method.</span></span> <span data-ttu-id="0f366-141">Вы также можете передавать массивы значений в виде параметров с помощью методов [AddNew](addnew-method-ado.md) и **Update** , а также одновременно обновлять несколько полей в записи.</span><span class="sxs-lookup"><span data-stu-id="0f366-141">You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="0f366-142">Если поставщик поддерживает пакетное обновление, можно изменить кэш поставщика на более одной записи и затем передать их в одном вызове к базе данных с помощью метода [UpdateBatch](updatebatch-method-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="0f366-142">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method.</span></span> <span data-ttu-id="0f366-143">Это относится к изменениям, выполненным с помощью методов **AddNew**, **Update**и [Delete](delete-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="0f366-143">This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods.</span></span> <span data-ttu-id="0f366-144">После вызова метода **UpdateBatch** можно использовать свойство [Status](status-property-ado-recordset.md) для проверки наличия конфликтов данных, чтобы устранить их.</span><span class="sxs-lookup"><span data-stu-id="0f366-144">After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="0f366-145">Чтобы выполнить запрос, не используя объект [Command](command-object-ado.md) , передайте строку запроса в метод **Open** объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0f366-145">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object.</span></span> <span data-ttu-id="0f366-146">Однако при необходимости сохранения текста команды и его повторного выполнения или использования параметров запроса требуется объект **Command** .</span><span class="sxs-lookup"><span data-stu-id="0f366-146">However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="0f366-147">Свойство [mode](mode-property-ado.md) управляет разрешениями на доступ.</span><span class="sxs-lookup"><span data-stu-id="0f366-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="0f366-148">Коллекция **Fields** является элементом объекта **Recordset** по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0f366-148">The **Fields** collection is the default member of the **Recordset** object.</span></span> <span data-ttu-id="0f366-149">В результате следующие два оператора кода эквивалентны.</span><span class="sxs-lookup"><span data-stu-id="0f366-149">As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

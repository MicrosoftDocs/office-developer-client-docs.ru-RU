---
title: Объект Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300478"
---
# <a name="recordset-object-ado"></a>Объект Recordset (ADO)

**Область применения**: Access 2013, Office 2013

Представляет весь набор записей из базовой таблицы или результаты выполненной команды. В любой момент объект **Recordset** относится только к одной записи в наборе в качестве текущей записи.

## <a name="remarks"></a>Замечания

Объекты **Recordset** используются для управления данными от поставщика. При использовании ADO данные практически полностью управляются с помощью объектов **Recordset** . Все объекты **Recordset** состоят из записей (строк) и полей (столбцов). В зависимости от функциональных возможностей, поддерживаемых поставщиком, некоторые методы или свойства **набора записей** могут быть недоступны.

ADODB. Recordset — это ProgID, который следует использовать для создания объекта **Recordset** . Существующие приложения, ссылающиеся на устаревшую АДОР. Набор записей ProgID будет продолжать работать без повторной компиляции, но новая разработка должна ссылаться на ADODB. Recordset.

В ADO определены четыре типа курсора:

  - **Динамический курсор** — позволяет просматривать добавления, изменения и удаления других пользователей; разрешает все типы передвижений по **набору записей** , которые не основываются на закладках; и позволяет использовать закладки, если они поддерживаются поставщиком.

  - **Курсор KEYSET** — имеет вид динамического курсора, за исключением того, что он не позволяет просматривать записи, добавленные другими пользователями, а также запрещает доступ к записям, которые удаляются другими пользователями. Изменения данных, внесенные другими пользователями, по-прежнему будут отображаться. Он всегда поддерживает закладки и позволяет выполнять все типы передвижений по **набору записей**.

  - **Static Cursor** — содержит статическую копию набора записей, которую можно использовать для поиска данных или создания отчетов; всегда разрешает закладки и позволяет выполнять все типы передвижений по **набору записей**. Добавленные, измененные или удаленные пользователи не будут отображаться. Это единственный тип курсора, разрешенный при открытии объекта **Recordset** на стороне клиента.

  - **Однонаправленный курсор** — позволяет прокручивать только вперед по набору **записей**. Добавленные, измененные или удаленные пользователи не будут отображаться. Это повышает производительность в ситуациях, когда необходимо выполнить только один проход через **набор записей**.

Задайте свойство [CursorType](cursortype-property-ado.md) перед открытием объекта **Recordset** , чтобы выбрать тип курсора, или передайте аргумент *CursorType* с помощью метода [Open](open-method-ado-recordset.md) . Некоторые поставщики не поддерживают типы курсоров. Проверьте документацию для поставщика. Если не указать тип курсора, ADO по умолчанию открывает однонаправленный курсор.

Если свойству [CursorLocation](cursorlocation-property-ado.md) присвоено значение **адусеклиент** , чтобы открыть объект **Recordset**, свойство **UnderlyingValue** объектов [Fields](field-object-ado.md) недоступно в возвращенном объекте **Recordset** . При использовании с некоторыми поставщиками (например, поставщиком Microsoft ODBC для OLE DB в сочетании с Microsoft SQL Server) можно создавать объекты **Recordset** независимо от ранее определенного объекта [Connection](connection-object-ado.md) путем передачи строки подключения с помощью метода **Open** . ADO по-прежнему создает объект [Connection](connection-object-ado.md) , но он не назначает этот объект объектной переменной. Тем не менее, если вы открываете несколько объектов **Recordset** по одному подключению, необходимо явно создать и открыть объект **Connection** ; При этом объект **Connection** будет назначен объектной переменной. Если не использовать эту объектную переменную при открытии объектов **Recordset** , ADO создает новый объект **Connection** для каждого нового объекта **Recordset**, даже если вы передаете одну и ту же строку подключения.

Вы можете создать любое количество объектов **Recordset** по мере необходимости.

Когда вы открываете объект **Recordset**, текущая запись размещается в первой записи (если она есть), а свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) имеют значение **false**. Если записей нет, параметры свойства **BOF** и **EOF** имеют **значение true**.

Вы можете использовать методы [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**и **MovePrevious** ; метод [Move](move-method-ado.md) ; и свойства [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md)и [Filter](filter-property-ado.md) , чтобы изменить положение текущей записи, предполагая, что поставщик поддерживает соответствующую функциональность. Объекты **Recordset** , посылаемые только вперед, поддерживают только метод [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) . При использовании методов **Move** для посещения каждой записи (или перечисления **набора записей**) можно использовать свойства **BOF** и **EOF** , чтобы определить, переместилось ли вы за начало или конец **набора записей**.

Объекты **Recordset** могут поддерживать два типа обновления: немедленные и пакетные. При немедленном обновлении все изменения данных немедленно записываются в базовый источник данных после вызова метода [Update](update-method-ado.md) . Вы также можете передавать массивы значений в виде параметров с помощью методов [AddNew](addnew-method-ado.md) и **Update** , а также одновременно обновлять несколько полей в записи.

Если поставщик поддерживает пакетное обновление, можно изменить кэш поставщика на более одной записи и затем передать их в одном вызове к базе данных с помощью метода [UpdateBatch](updatebatch-method-ado.md) . Это относится к изменениям, выполненным с помощью методов **AddNew**, **Update**и [Delete](delete-method-ado-recordset.md) . После вызова метода **UpdateBatch** можно использовать свойство [Status](status-property-ado-recordset.md) для проверки наличия конфликтов данных, чтобы устранить их.

> [!NOTE]
> Чтобы выполнить запрос, не используя объект [Command](command-object-ado.md) , передайте строку запроса в метод **Open** объекта **Recordset** . Однако при необходимости сохранения текста команды и его повторного выполнения или использования параметров запроса требуется объект **Command** .

Свойство [mode](mode-property-ado.md) управляет разрешениями на доступ.

Коллекция **Fields** является элементом объекта **Recordset** по умолчанию. В результате следующие два оператора кода эквивалентны.

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

---
title: Объект Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300478"
---
# <a name="recordset-object-ado"></a>Объект Recordset (ADO)

**Область применения**: Access 2013, Office 2013

Представляет весь набор записей из базовой таблицы или результаты выполнения команды. В любой момент объект **Recordset** ссылается только на одну запись в наборе в качестве текущей записи.

## <a name="remarks"></a>Заметки

Объекты **Recordset используются** для управления данными от поставщика. При использовании ADO вы практически полностью управляете данными с помощью **объектов Recordset.** Все **объекты Recordset** состоят из записей (строк) и полей (столбцов). В зависимости от функций, поддерживаемых поставщиком, некоторые методы или свойства **recordset** могут быть недоступны.

ADODB. Recordset — это progID, который следует использовать для создания **объекта Recordset.** Существующие приложения, ссылаясь на устаревший ADOR. Recordset ProgID продолжит работать без повторной скомпилы, но новая разработка должна ссылаться на ADODB. Recordset.

Существует четыре различных типа курсоров, определенных в ADO:

  - **Динамический курсор** — позволяет просматривать добавления, изменения и удаления другими пользователями; позволяет всем типам перемещения по **набору записей,** не зависят от закладок; и разрешает закладки, если поставщик их поддерживает.

  - **Курсор Keyset** — ведет себя как динамический курсор, за исключением того, что он не позволяет увидеть записи, которые добавляют другие пользователи, и не позволяет получить доступ к записям, которые другие пользователи удаляют. Изменения данных другими пользователями по-прежнему будут видны. Он всегда поддерживает закладки и, следовательно, разрешает все типы перемещения через **recordset.**

  - **Статический курсор** — предоставляет статическую копию набора записей, которые можно использовать для поиска данных или создания отчетов; всегда разрешает закладки и, следовательно, разрешает все типы перемещения через **набор записей.** Добавления, изменения или удаления другими пользователями не будут видны. Это единственный тип курсора, разрешенный при открываемом клиентском объекте **Recordset.**

  - **Курсор "Только вперед"** позволяет прокручивать только набор **записей.** Добавления, изменения или удаления другими пользователями не будут видны. Это повышает производительность в ситуациях, когда требуется сделать только один проход через **набор записей.**

Установите свойство [CursorType](cursortype-property-ado.md) перед открытием набора **записей,** чтобы выбрать тип курсора, или передав аргумент *CursorType* с помощью метода [Open.](open-method-ado-recordset.md) Некоторые поставщики поддерживают не все типы курсоров. Проверьте документацию для поставщика. Если не указать тип курсора, ADO по умолчанию открывает курсор "только вперед".

Если для свойства [CursorLocation](cursorlocation-property-ado.md) установлено свойство **adUseClient** для открытия объекта **Recordset,** свойство **UnderlyingValue** в объектах [Field](field-object-ado.md) будет недоступным в возвращаемом объекте **Recordset.** При использовании с некоторыми поставщиками (например, с поставщиком Microsoft ODBC для OLE DB в сочетании с Microsoft SQL Server) можно создать **объекты Recordset** независимо от ранее определенного объекта [Connection,](connection-object-ado.md) передав строку подключения с методом **Open.** ADO по-прежнему создает объект [Connection,](connection-object-ado.md) но не назначает этот объект объектной переменной. Однако при открытии нескольких объектов **Recordset** по одному подключению необходимо явно создать и открыть **объект Connection;** При этом объект **Connection назначается** объектной переменной. Если эта объектная переменная не используется при открытии объектов **Recordset,** ADO создает новый объект **Connection** для каждого нового объекта **Recordset,** даже если передается та же строка подключения.

Можно создать столько объектов **Recordset,** сколько необходимо.

При **открываемом** наборе записей текущая запись устанавливается в первую запись (если таково), а свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) заданы как **False.** Если записей нет, параметры свойств **BOF** и **EOF** имеют свойство **True.**

Можно использовать методы [MoveFirst,](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) **MoveLast,** **MoveNext** и **MovePrevious;** метод [Move;](move-method-ado.md) и свойства [AbsolutePosition,](absoluteposition-property-ado.md) [AbsolutePage](absolutepage-property-ado.md)и [Filter](filter-property-ado.md) для переустановки текущей записи при условии, что поставщик поддерживает соответствующие функции. Объекты **Recordset с переадранным** протоколом поддерживают только [метод MoveNext.](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) При использовании методов **Move** для посещения каждой записи (или для нумерации объекта **Recordset)** можно использовать свойства **BOF** и **EOF,** чтобы определить, перемещены ли вы за пределы начала или конца **объекта Recordset.**

**Объекты recordset** могут поддерживать два типа обновления: немедленное и пакетное. При немедленном обновлении все изменения данных немедленно вписаны в исходный источник данных после вызова метода [Update.](update-method-ado.md) Вы также можете передать массивы значений в качестве параметров с помощью методов [AddNew](addnew-method-ado.md) и **Update** и одновременно обновить несколько полей в записи.

Если поставщик поддерживает пакетное обновление, вы можете изменить кэш поставщика на несколько записей, а затем передать их в одном вызове базы данных с помощью метода [UpdateBatch.](updatebatch-method-ado.md) Это относится к изменениям, внесенным с помощью методов **AddNew,** **Update** и [Delete.](delete-method-ado-recordset.md) После вызова метода **UpdateBatch** вы можете использовать свойство [Status,](status-property-ado-recordset.md) чтобы проверить все конфликты данных, чтобы устранить их.

> [!NOTE]
> Чтобы выполнить запрос без использования объекта [Command,](command-object-ado.md) передайте строку запроса **методу Open** объекта **Recordset.** Однако объект **Command** необходим, если необходимо сохранить текст команды и выполнить его повторно, или использовать параметры запроса.

Свойство [Mode](mode-property-ado.md) управляет разрешениями доступа.

Коллекция **Fields** является членом объекта **Recordset** по умолчанию. В результате два следующих кода являются эквивалентными.

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

---
title: Recordset Object (ADO)
TOCTitle: Recordset Object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 400373a773342ea03c08be5d587a3da1fcdac750
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2018
ms.locfileid: "25482581"
---
# <a name="recordset-object-ado"></a>Recordset Object (ADO)

**Применимо к**: Access 2013 | Office 2013

Представляет полного набора записей из базовой таблицы или результаты выполнения команды. В любое время в объект **набора записей** называется только одной записи в наборе текущей записи.

## <a name="remarks"></a>Замечания

Используйте объекты **набора записей** для работы с данными из поставщика. При использовании ADO работы с данным почти полностью с помощью объектов **набора записей** . Все объекты **наборов записей** состоят из записей (строк) и полей (столбцов). В зависимости от функциональных возможностей, поддерживаемых поставщиком некоторые из **набора записей** методов и свойств недоступен.

ADODB. Набор записей — это программный идентификатор, который должен использоваться для создания объекта **набора записей** . Существующие приложения, ссылающиеся на устаревшие ADOR. Идентификатор ProgID записей будут работать без повторной компиляции, но новые разработки должен ссылаться на ADODB. Набор записей.

Существует четыре типа другой курсор, определенных в ADO.

  - **Динамический курсор** — дает возможность просмотра, добавления, изменения и удаления другими пользователями; Разрешает все типы перемещения по **набору записей** , не зависящие от закладки; и разрешает закладки, если поставщик поддерживает их.

  - **Курсор набора ключей** — действует как динамический курсор, за исключением того, что не позволяет просматривать записи, которые другие пользователи добавляют и предотвращает доступ к записям, которые удаляют другим пользователям. Изменения данных другие пользователи по-прежнему будут отображаться. Он всегда поддерживает закладки и таким образом разрешает все типы перемещения по **набора записей**.

  - **Статический курсор** — содержит статические копию набора записей можно использовать для поиска данных и создания отчетов; всегда позволяет закладки и поэтому позволяет всех типов перемещения по **набора записей**. Дополнения, изменения или удаления другие пользователи не видны. Это единственный тип курсора разрешены при открытии объекта **набора записей** со стороны клиента.

  - **Последовательный курсор** — позволяет только просмотреть **записей**. Дополнения, изменения или удаления другие пользователи не видны. Это повышает производительность в ситуациях, когда требуется сделать только один проход по **набора записей**.

Присвойте свойству [CursorType](cursortype-property-ado.md) перед открытием **набора записей** для выбора типа курсора или аргумент *CursorType* передается с помощью метода [Open](open-method-ado-recordset.md) . Некоторые поставщики не поддерживают все типы курсора. Обратитесь к документации для поставщика. Если не указан тип курсора, ADO откроется последовательный курсор по умолчанию.

Если свойство [CursorLocation](cursorlocation-property-ado.md) имеет значение для **adUseClient** для открытия **набора записей**, свойство **UnderlyingValue** на объекты [поля](field-object-ado.md) не доступны в возвращенного объекта **набора записей** . Если для некоторых поставщиков (например, Microsoft ODBC для OLE DB совместно с Microsoft SQL Server), можно создать объекты **наборов записей** независимо от ранее определенный объект [подключения](connection-object-ado.md) , передав строку подключения с помощью метода **Open** . ADO по-прежнему создает объект [подключения](connection-object-ado.md) , но она не назначает этот объект переменной объекта. Тем не менее при открытии нескольких объектов **наборов записей** через то же подключение, необходимо явно создать и откройте объект **подключения** ; Это назначает объект **подключения** объектную переменную. Если не используется в этом объектной переменной при открытии объектов **набора записей** , ADO создает новый объект **подключения** для каждого нового **набора записей**, даже в том случае, если передать ту же строку подключения.

Можно создать любое количество объектов **набора записей** при необходимости.

При открытии **набора записей**, размещенный текущей записи для первой записи (при его наличии) и [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) задано значение **False**. Если нет записей, значения свойств **BOF** и **EOF** , **значение True**.

Можно использовать [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**и **MovePrevious** методов. метод [Move](move-method-ado.md) ; и [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md)и свойства [фильтра](filter-property-ado.md) для изменения положения текущей записи при условии, что поставщик поддерживает соответствующие функциональные возможности. Объекты **набора записей** однонаправленные поддерживают только метод [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) . При использовании методов **перемещения** посетите каждая запись (или перечисление **записей**), можно использовать свойства **BOF** и **EOF** для определения, если перемещен за пределы начале или конце **набора записей**.

Объекты **набора записей** поддерживает два типа обновления: немедленные и пакетной. В немедленное обновление всех изменений в данные записываются непосредственно к базовому источнику данных после вызова метода [Update](update-method-ado.md) . Можно также передать массивы значений параметров с методами [AddNew](addnew-method-ado.md) и **обновления** и одновременно обновить несколько полей в записи.

Если поставщик поддерживает обновление пакета, могут иметь изменения кэша поставщика для более чем одной записи и передачи их в один вызов к базе данных с помощью метода [UpdateBatch](updatebatch-method-ado.md) . Это относится к изменения, внесенные с методами **AddNew**, **Update**и [Delete](delete-method-ado-recordset.md) . После вызова метода **UpdateBatch** , можно использовать свойство [состояние](status-property-ado-recordset.md) для проверки любого конфликтов данных для их устранения.

> [!NOTE]
> Для выполнения запроса без использования объекта [команды](command-object-ado.md) , передайте строку запроса метод **Open** объекта **набора записей** . Тем не менее объект **команды** является обязательным, когда необходимо сохранять текст команды и повторно выполнить или используйте параметры запроса.

Свойство [Mode](mode-property-ado.md) управляет разрешений доступа.

По умолчанию коллекции **полей** принадлежит объекта **набора записей** . В результате следующих двух операторов кода эквивалентны.

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

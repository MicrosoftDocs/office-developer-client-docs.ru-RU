---
title: Объект Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: a99b3f792518e65900841bab90977e2edda6e804
ms.sourcegitcommit: d7248f803002b31cf7fc561b03530199a9b0a8fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2018
ms.locfileid: "25927041"
---
# <a name="recordset-object-ado"></a><span data-ttu-id="d01ba-102">Объект Recordset (ADO)</span><span class="sxs-lookup"><span data-stu-id="d01ba-102">Recordset object (ADO)</span></span>

<span data-ttu-id="d01ba-103">**Применимо к**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="d01ba-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="d01ba-104">Представляет полного набора записей из базовой таблицы или результаты выполнения команды.</span><span class="sxs-lookup"><span data-stu-id="d01ba-104">Represents the entire set of records from a base table or the results of an executed command.</span></span> <span data-ttu-id="d01ba-105">В любое время в объект **набора записей** называется только одной записи в наборе текущей записи.</span><span class="sxs-lookup"><span data-stu-id="d01ba-105">At any time, the **Recordset** object refers to only a single record within the set as the current record.</span></span>

## <a name="remarks"></a><span data-ttu-id="d01ba-106">Примечания</span><span class="sxs-lookup"><span data-stu-id="d01ba-106">Remarks</span></span>

<span data-ttu-id="d01ba-107">Используйте объекты **набора записей** для работы с данными из поставщика.</span><span class="sxs-lookup"><span data-stu-id="d01ba-107">You use **Recordset** objects to manipulate data from a provider.</span></span> <span data-ttu-id="d01ba-108">При использовании ADO работы с данным почти полностью с помощью объектов **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="d01ba-108">When you use ADO, you manipulate data almost entirely using **Recordset** objects.</span></span> <span data-ttu-id="d01ba-109">Все объекты **наборов записей** состоят из записей (строк) и полей (столбцов).</span><span class="sxs-lookup"><span data-stu-id="d01ba-109">All **Recordset** objects consist of records (rows) and fields (columns).</span></span> <span data-ttu-id="d01ba-110">В зависимости от функциональных возможностей, поддерживаемых поставщиком некоторые из **набора записей** методов и свойств недоступен.</span><span class="sxs-lookup"><span data-stu-id="d01ba-110">Depending on the functionality supported by the provider, some **Recordset** methods or properties may not be available.</span></span>

<span data-ttu-id="d01ba-111">ADODB. Набор записей — это программный идентификатор, который должен использоваться для создания объекта **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="d01ba-111">ADODB.Recordset is the ProgID that should be used to create a **Recordset** object.</span></span> <span data-ttu-id="d01ba-112">Существующие приложения, ссылающиеся на устаревшие ADOR. Идентификатор ProgID записей будут работать без повторной компиляции, но новые разработки должен ссылаться на ADODB. Набор записей.</span><span class="sxs-lookup"><span data-stu-id="d01ba-112">Existing applications that reference the outdated ADOR.Recordset ProgID will continue to work without recompiling, but new development should reference ADODB.Recordset.</span></span>

<span data-ttu-id="d01ba-113">Существует четыре типа другой курсор, определенных в ADO.</span><span class="sxs-lookup"><span data-stu-id="d01ba-113">There are four different cursor types defined in ADO:</span></span>

  - <span data-ttu-id="d01ba-114">**Динамический курсор** — дает возможность просмотра, добавления, изменения и удаления другими пользователями; Разрешает все типы перемещения по **набору записей** , не зависящие от закладки; и разрешает закладки, если поставщик поддерживает их.</span><span class="sxs-lookup"><span data-stu-id="d01ba-114">**Dynamic cursor** — allows you to view additions, changes, and deletions by other users; allows all types of movement through the **Recordset** that doesn't rely on bookmarks; and allows bookmarks if the provider supports them.</span></span>

  - <span data-ttu-id="d01ba-115">**Курсор набора ключей** — действует как динамический курсор, за исключением того, что не позволяет просматривать записи, которые другие пользователи добавляют и предотвращает доступ к записям, которые удаляют другим пользователям.</span><span class="sxs-lookup"><span data-stu-id="d01ba-115">**Keyset cursor** — behaves like a dynamic cursor, except that it prevents you from seeing records that other users add, and prevents access to records that other users delete.</span></span> <span data-ttu-id="d01ba-116">Изменения данных другие пользователи по-прежнему будут отображаться.</span><span class="sxs-lookup"><span data-stu-id="d01ba-116">Data changes by other users will still be visible.</span></span> <span data-ttu-id="d01ba-117">Он всегда поддерживает закладки и таким образом разрешает все типы перемещения по **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-117">It always supports bookmarks and therefore allows all types of movement through the **Recordset**.</span></span>

  - <span data-ttu-id="d01ba-118">**Статический курсор** — содержит статические копию набора записей можно использовать для поиска данных и создания отчетов; всегда позволяет закладки и поэтому позволяет всех типов перемещения по **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-118">**Static cursor** — provides a static copy of a set of records for you to use to find data or generate reports; always allows bookmarks and therefore allows all types of movement through the **Recordset**.</span></span> <span data-ttu-id="d01ba-119">Дополнения, изменения или удаления другие пользователи не видны.</span><span class="sxs-lookup"><span data-stu-id="d01ba-119">Additions, changes, or deletions by other users will not be visible.</span></span> <span data-ttu-id="d01ba-120">Это единственный тип курсора разрешены при открытии объекта **набора записей** со стороны клиента.</span><span class="sxs-lookup"><span data-stu-id="d01ba-120">This is the only type of cursor allowed when you open a client-side **Recordset** object.</span></span>

  - <span data-ttu-id="d01ba-121">**Последовательный курсор** — позволяет только просмотреть **записей**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-121">**Forward-only cursor** — allows you to only scroll forward through the **Recordset**.</span></span> <span data-ttu-id="d01ba-122">Дополнения, изменения или удаления другие пользователи не видны.</span><span class="sxs-lookup"><span data-stu-id="d01ba-122">Additions, changes, or deletions by other users will not be visible.</span></span> <span data-ttu-id="d01ba-123">Это повышает производительность в ситуациях, когда требуется сделать только один проход по **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-123">This improves performance in situations where you need to make only a single pass through a **Recordset**.</span></span>

<span data-ttu-id="d01ba-124">Присвойте свойству [CursorType](cursortype-property-ado.md) перед открытием **набора записей** для выбора типа курсора или аргумент *CursorType* передается с помощью метода [Open](open-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="d01ba-124">Set the [CursorType](cursortype-property-ado.md) property prior to opening the **Recordset** to choose the cursor type, or pass a *CursorType* argument with the [Open](open-method-ado-recordset.md) method.</span></span> <span data-ttu-id="d01ba-125">Некоторые поставщики не поддерживают все типы курсора.</span><span class="sxs-lookup"><span data-stu-id="d01ba-125">Some providers don't support all cursor types.</span></span> <span data-ttu-id="d01ba-126">Обратитесь к документации для поставщика.</span><span class="sxs-lookup"><span data-stu-id="d01ba-126">Check the documentation for the provider.</span></span> <span data-ttu-id="d01ba-127">Если не указан тип курсора, ADO откроется последовательный курсор по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d01ba-127">If you don't specify a cursor type, ADO opens a forward-only cursor by default.</span></span>

<span data-ttu-id="d01ba-128">Если свойство [CursorLocation](cursorlocation-property-ado.md) имеет значение для **adUseClient** для открытия **набора записей**, свойство **UnderlyingValue** на объекты [поля](field-object-ado.md) не доступны в возвращенного объекта **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="d01ba-128">If the [CursorLocation](cursorlocation-property-ado.md) property is set to **adUseClient** to open a **Recordset**, the **UnderlyingValue** property on [Field](field-object-ado.md) objects is not available in the returned **Recordset** object.</span></span> <span data-ttu-id="d01ba-129">Если для некоторых поставщиков (например, Microsoft ODBC для OLE DB совместно с Microsoft SQL Server), можно создать объекты **наборов записей** независимо от ранее определенный объект [подключения](connection-object-ado.md) , передав строку подключения с помощью метода **Open** .</span><span class="sxs-lookup"><span data-stu-id="d01ba-129">When used with some providers (such as the Microsoft ODBC Provider for OLE DB in conjunction with Microsoft SQL Server), you can create **Recordset** objects independently of a previously defined [Connection](connection-object-ado.md) object by passing a connection string with the **Open** method.</span></span> <span data-ttu-id="d01ba-130">ADO по-прежнему создает объект [подключения](connection-object-ado.md) , но она не назначает этот объект переменной объекта.</span><span class="sxs-lookup"><span data-stu-id="d01ba-130">ADO still creates a [Connection](connection-object-ado.md) object, but it doesn't assign that object to an object variable.</span></span> <span data-ttu-id="d01ba-131">Тем не менее при открытии нескольких объектов **наборов записей** через то же подключение, необходимо явно создать и откройте объект **подключения** ; Это назначает объект **подключения** объектную переменную.</span><span class="sxs-lookup"><span data-stu-id="d01ba-131">However, if you are opening multiple **Recordset** objects over the same connection, you should explicitly create and open a **Connection** object; this assigns the **Connection** object to an object variable.</span></span> <span data-ttu-id="d01ba-132">Если не используется в этом объектной переменной при открытии объектов **набора записей** , ADO создает новый объект **подключения** для каждого нового **набора записей**, даже в том случае, если передать ту же строку подключения.</span><span class="sxs-lookup"><span data-stu-id="d01ba-132">If you do not use this object variable when opening your **Recordset** objects, ADO creates a new **Connection** object for each new **Recordset**, even if you pass the same connection string.</span></span>

<span data-ttu-id="d01ba-133">Можно создать любое количество объектов **набора записей** при необходимости.</span><span class="sxs-lookup"><span data-stu-id="d01ba-133">You can create as many **Recordset** objects as needed.</span></span>

<span data-ttu-id="d01ba-134">При открытии **набора записей**, размещенный текущей записи для первой записи (при его наличии) и [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) задано значение **False**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-134">When you open a **Recordset**, the current record is positioned to the first record (if any) and the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are set to **False**.</span></span> <span data-ttu-id="d01ba-135">Если нет записей, значения свойств **BOF** и **EOF** , **значение True**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-135">If there are no records, the **BOF** and **EOF** property settings are **True**.</span></span>

<span data-ttu-id="d01ba-136">Можно использовать [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**и **MovePrevious** методов. метод [Move](move-method-ado.md) ; и [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md)и свойства [фильтра](filter-property-ado.md) для изменения положения текущей записи при условии, что поставщик поддерживает соответствующие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="d01ba-136">You can use the [MoveFirst](movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, and **MovePrevious** methods; the [Move](move-method-ado.md) method; and the [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), and [Filter](filter-property-ado.md) properties to reposition the current record, assuming the provider supports the relevant functionality.</span></span> <span data-ttu-id="d01ba-137">Объекты **набора записей** однонаправленные поддерживают только метод [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="d01ba-137">Forward-only **Recordset** objects support only the [MoveNext](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) method.</span></span> <span data-ttu-id="d01ba-138">При использовании методов **перемещения** посетите каждая запись (или перечисление **записей**), можно использовать свойства **BOF** и **EOF** для определения, если перемещен за пределы начале или конце **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="d01ba-138">When you use the **Move** methods to visit each record (or enumerate the **Recordset**), you can use the **BOF** and **EOF** properties to determine if you've moved beyond the beginning or end of the **Recordset**.</span></span>

<span data-ttu-id="d01ba-139">Объекты **набора записей** поддерживает два типа обновления: немедленные и пакетной.</span><span class="sxs-lookup"><span data-stu-id="d01ba-139">**Recordset** objects can support two types of updating: immediate and batched.</span></span> <span data-ttu-id="d01ba-140">В немедленное обновление всех изменений в данные записываются непосредственно к базовому источнику данных после вызова метода [Update](update-method-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="d01ba-140">In immediate updating, all changes to data are written immediately to the underlying data source once you call the [Update](update-method-ado.md) method.</span></span> <span data-ttu-id="d01ba-141">Можно также передать массивы значений параметров с методами [AddNew](addnew-method-ado.md) и **обновления** и одновременно обновить несколько полей в записи.</span><span class="sxs-lookup"><span data-stu-id="d01ba-141">You can also pass arrays of values as parameters with the [AddNew](addnew-method-ado.md) and **Update** methods and simultaneously update several fields in a record.</span></span>

<span data-ttu-id="d01ba-142">Если поставщик поддерживает обновление пакета, могут иметь изменения кэша поставщика для более чем одной записи и передачи их в один вызов к базе данных с помощью метода [UpdateBatch](updatebatch-method-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="d01ba-142">If a provider supports batch updating, you can have the provider cache changes to more than one record and then transmit them in a single call to the database with the [UpdateBatch](updatebatch-method-ado.md) method.</span></span> <span data-ttu-id="d01ba-143">Это относится к изменения, внесенные с методами **AddNew**, **Update**и [Delete](delete-method-ado-recordset.md) .</span><span class="sxs-lookup"><span data-stu-id="d01ba-143">This applies to changes made with the **AddNew**, **Update**, and [Delete](delete-method-ado-recordset.md) methods.</span></span> <span data-ttu-id="d01ba-144">После вызова метода **UpdateBatch** , можно использовать свойство [состояние](status-property-ado-recordset.md) для проверки любого конфликтов данных для их устранения.</span><span class="sxs-lookup"><span data-stu-id="d01ba-144">After you call the **UpdateBatch** method, you can use the [Status](status-property-ado-recordset.md) property to check for any data conflicts in order to resolve them.</span></span>

> [!NOTE]
> <span data-ttu-id="d01ba-145">Для выполнения запроса без использования объекта [команды](command-object-ado.md) , передайте строку запроса метод **Open** объекта **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="d01ba-145">To execute a query without using a [Command](command-object-ado.md) object, pass a query string to the **Open** method of a **Recordset** object.</span></span> <span data-ttu-id="d01ba-146">Тем не менее объект **команды** является обязательным, когда необходимо сохранять текст команды и повторно выполнить или используйте параметры запроса.</span><span class="sxs-lookup"><span data-stu-id="d01ba-146">However, a **Command** object is required when you want to persist the command text and re-execute it, or use query parameters.</span></span>

<span data-ttu-id="d01ba-147">Свойство [Mode](mode-property-ado.md) управляет разрешений доступа.</span><span class="sxs-lookup"><span data-stu-id="d01ba-147">The [Mode](mode-property-ado.md) property governs access permissions.</span></span>

<span data-ttu-id="d01ba-148">По умолчанию коллекции **полей** принадлежит объекта **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="d01ba-148">The **Fields** collection is the default member of the **Recordset** object.</span></span> <span data-ttu-id="d01ba-149">В результате следующих двух операторов кода эквивалентны.</span><span class="sxs-lookup"><span data-stu-id="d01ba-149">As a result, the following two code statements are equivalent.</span></span>

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

---
title: Объект Recordset (ADO)
TOCTitle: Recordset object (ADO)
ms:assetid: 0f963bf8-f066-dc8a-b754-f427de712df1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248865(v=office.15)
ms:contentKeyID: 48543267
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 636681cf8e0c20f078387b21974141a9cb66cfcd
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300478"
---
# <a name="recordset-object-ado"></a>Объект Recordset (ADO)

**Область применения**: Access 2013, Office 2013

Представляет весь набор записей из базовой таблицы или результаты выполненной команды. В любое время объект **Recordset** ссылается только на одну запись в наборе в качестве текущей записи.

## <a name="remarks"></a>Примечания

Вы используете **объекты Recordset** для управления данными от поставщика. При использовании ADO вы почти полностью управляете данными с помощью **объектов Recordset.** Все **объекты Recordset** состоят из записей (строк) и полей (столбцов). В зависимости от функций, поддерживаемых поставщиком, некоторые методы или свойства **Recordset** могут быть недоступны.

ADODB. Recordset — это ProgID, который следует использовать для создания объекта **Recordset.** Существующие приложения, ссылаясь на устаревшие ADOR. Recordset ProgID продолжит работать без перекомпилинга, но новая разработка должна ссылаться на ADODB. Recordset.

Существует четыре различных типа курсоров, определенных в ADO:

  - **Динамический курсор** — позволяет просматривать добавления, изменения и удаления другими пользователями; позволяет всем типам перемещения через **Набор записей,** который не полагается на закладки; и позволяет закладки, если поставщик поддерживает их.

  - **Курсор Keyset** — ведет себя как динамический курсор, за исключением того, что он не позволяет видеть записи, которые добавляют другие пользователи, и не позволяет получить доступ к записям, которые другие пользователи удаляют. Изменения данных другими пользователями по-прежнему будут видны. Он всегда поддерживает закладки и, следовательно, позволяет всем типам перемещения через **Набор записей.**

  - **Статичный курсор** — это статическая копия набора записей, которые можно использовать для поиска данных или создания отчетов; всегда позволяет закладки и, следовательно, позволяет все типы перемещения через **Recordset**. Добавления, изменения или удаления других пользователей не будут видны. Это единственный тип курсора, разрешенный при открывлении клиентского объекта **Recordset.**

  - **Курсор только для форвардов** — позволяет прокручивать только **записи.** Добавления, изменения или удаления других пользователей не будут видны. Это повышает производительность в ситуациях, когда необходимо сделать только один проход через **Набор записей.**

Установите свойство [CursorType](cursortype-property-ado.md) перед открытием **набора** записей, чтобы выбрать тип курсора, или передать аргумент *CursorType* с методом [Open.](open-method-ado-recordset.md) Некоторые поставщики не поддерживают все типы курсоров. Проверьте документацию для поставщика. Если вы не указываете тип курсора, ADO открывает курсор только вперед по умолчанию.

Если [](field-object-ado.md) свойство [CursorLocation](cursorlocation-property-ado.md) настроено на **adUseClient** для открытия набора записей, свойство **UnderlyingValue** для объектов Field не доступно в возвращаемом объекте **Recordset.**  При использовании с некоторыми поставщиками (например, с поставщиком ODBC Microsoft для OLE DB совместно с Microsoft SQL Server) можно создать **объекты Recordset** независимо от ранее определенного объекта Подключения, передав строку подключения методом [](connection-object-ado.md) **Open.** ADO по-прежнему создает объект [Connection,](connection-object-ado.md) но не назначает этот объект переменной объекта. Однако если вы открываете несколько объектов **Recordset** по одному подключению, необходимо явно создать и открыть объект **Подключения;** это назначает объект **Подключение** к переменной объекта. Если эта переменная объекта не используется при открытии объектов **Recordset,** ADO создает новый объект Подключения для каждого нового набора  **записей,** даже если вы передаете ту же строку подключения.

Вы можете создать столько объектов **Recordset,** сколько необходимо.

При открываемом **наборе** записей текущая запись устанавливается к первой записи (если таково), а свойства [boF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) заданы **false**. Если записей нет, параметры **свойств BOF** и **EOF** **верны.**

Вы можете использовать методы [MoveFirst,](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) **MoveLast,** **MoveNext** и **MovePrevious;** метод [Move;](move-method-ado.md) и свойства [AbsolutePosition,](absoluteposition-property-ado.md) [AbsolutePage](absolutepage-property-ado.md)и [Filter](filter-property-ado.md) для повторного размещения текущей записи при условии, что поставщик поддерживает соответствующие функции. Объекты **Recordset только для forward поддерживают** только метод [MoveNext.](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) При использовании методов **Move** для посещения каждой записи (или переустановки наборов записей) вы можете использовать свойства **BOF** и **EOF,** чтобы определить, перешли ли вы за пределы начала или конца **наборов записей.**

**Объекты Recordset** могут поддерживать два типа обновления: немедленное и пакетное. При немедленном обновлении все изменения в данных немедленно вписаны в исходный источник данных после вызова метода [Update.](update-method-ado.md) Вы также можете передать массивы значений в качестве параметров с помощью методов [AddNew](addnew-method-ado.md) и **Update** и одновременно обновить несколько полей в записи.

Если поставщик поддерживает пакетное обновление, можно изменить кэш поставщика на несколько записей, а затем передать их одним вызовом в базу данных с помощью метода [UpdateBatch.](updatebatch-method-ado.md) Это относится к изменениям, внесенным с помощью **методов AddNew,** **Update** и [Delete.](delete-method-ado-recordset.md) После вызова метода **UpdateBatch** можно использовать свойство [Status](status-property-ado-recordset.md) для проверки любых конфликтов данных для их устранения.

> [!NOTE]
> Чтобы выполнить запрос без использования объекта [Command,](command-object-ado.md) передайте строку запроса **в** открытый метод объекта **Recordset.** Однако для **сохраняемого** командного текста и его повторного выполнения или использования параметров запроса требуется объект Command.

Свойство [Mode](mode-property-ado.md) управляет разрешениями доступа.

Коллекция **Fields** является по умолчанию членом объекта **Recordset.** В результате два следующих кода эквивалентны.

```vb
    Debug.Print objRs.Fields.Item(0)  ' Both statements print 
    Debug.Print objRs(0)              '  the Value of Item(0).
```

---
title: Инициализация драйвера Microsoft Excel
TOCTitle: Initializing the Microsoft Excel driver
ms:assetid: 06c7f823-8e74-0811-cc00-e6b32075ef11
ms:mtpsurl: https://msdn.microsoft.com/library/Ff844939(v=office.15)
ms:contentKeyID: 48543054
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- acmain11.chm1032159
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: cec7890385e5730831cea9241278511d88b6f3a1
ms.sourcegitcommit: 8ead5b5501f59c108cf02969070be21f7fc52467
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/21/2019
ms.locfileid: "30135749"
---
# <a name="initializing-the-microsoft-excel-driver"></a>Инициализация драйвера Microsoft Excel

Область **применения**: Access 2013 | Office 2013

При установке драйвера Excel программа установки записывает набор значений по умолчанию в реестр Windows в подразделах Engines и ISAM formats. Эти параметры не следует изменять напрямую; Используйте программу установки приложения, чтобы добавлять, удалять или изменять эти параметры. В следующих разделах описываются параметры инициализации и ISAM Format для драйвера базы данных Microsoft Excel.

## <a name="excel-initialization-settings"></a>Параметры инициализации Excel

Папка **\\Excel Engines\\Engine** включает параметры инициализации для драйвера ацеекскл. dll, который используется для внешнего доступа к листам Microsoft Excel. Типичные параметры записей в этой папке показаны в следующем примере.

```vb
    win32=<path>\ Aceexcl.dll  
    
    TypeGuessRows=8 
    
    ImportMixedTypes=Text 
    
    AppendBlankRows=1 
    
    FirstRowHasNames=Yes
```

Ядро СУБД Microsoft Access использует записи папки Excel, как показано ниже.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Запись</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>оригиналь</p></td>
<td><p>Расположение файла msexcl40. dll. Полный путь определяется во время установки. Значения имеют тип REG_SZ.</p></td>
</tr>
<tr class="even">
<td><p>Типегуессровс</p></td>
<td><p>Количество строк, проверяемых для типа данных. Тип данных определяется с учетом максимального числа найденных типов данных. Если задано значение, тип данных определяется в следующем порядке: Number, Currency, Date, Text, Boolean. Если обнаружены данные, которые не совпадают с типом данных, предполагаемым для столбца, то возвращается значение <strong>null</strong> . При импорте, если столбец содержит смешанные типы данных, весь столбец будет приведен в соответствии с параметром Импортмикседтипес. По умолчанию число проверяемых строк равно 8. Значения имеют тип REG_DWORD.</p></td>
</tr>
<tr class="odd">
<td><p>Импортмикседтипес</p></td>
<td><p>Может быть задано значение Мажорититипе или Text. Если задано значение Мажорититипе, столбцы смешанных типов данных будут приведены к типу данных предоминате при импорте. Если для параметра задано значение Text, при импорте столбцы смешанных типов данных будут приведены к типу text (текст). Значение по умолчанию — Text. Значения имеют тип REG_SZ.</p></td>
</tr>
<tr class="even">
<td><p>Аппендбланкровс</p></td>
<td><p>Число пустых строк, добавляемых в конец листа версии 3,5 или версии 4,0 перед добавлением новых данных. Например, если для Аппендбланкровс задано значение 4, Microsoft Jet добавит 4 пустые строки в конец листа перед добавлением строк, содержащих данные. Целочисленные значения этого параметра могут изменяться в диапазоне от 0 до 16; значение по умолчанию — 01 (добавляется одна дополнительная строка). Значения имеют тип REG_DWORD.</p></td>
</tr>
<tr class="odd">
<td><p>Фирстровхаснамес</p></td>
<td><p>Двоичное значение, которое указывает, содержит ли первая строка таблицы имена столбцов. Значение 01 указывает, что во время импорта имена столбцов берутся из первой строки. Значение 00 указывает, что в первой строке нет имен столбцов; имена столбцов отображаются в виде F1, F2, F3 и т. д. Значение по умолчанию — 01. Значения имеют тип REG_BINARY.</p></td>
</tr>
</tbody>
</table>

<br/>

Папка **\\Excel 8,0 Engine\\Engines Engine** содержит следующие записи, которые относятся к Microsoft Excel 97.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя записи</p></th>
<th><p>Тип</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Модул</p></td>
<td><p>REG_SZ</p></td>
<td><p>Excel</p></td>
</tr>
<tr class="even">
<td><p>Експортфилтер</p></td>
<td><p>REG_SZ</p></td>
<td><p>Microsoft Excel 97-2000 (*. xls)</p></td>
</tr>
<tr class="odd">
<td><p>Канлинк</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
<tr class="even">
<td><p>Онетаблеперфиле</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="odd">
<td><p>Исамтипе</p></td>
<td><p>REG_DWORD</p></td>
<td><p>1,1</p></td>
</tr>
<tr class="even">
<td><p>Индексдиалог</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="odd">
<td><p>Креатедбонекспорт</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
<tr class="even">
<td><p>Ресулттекстекспорт</p></td>
<td><p>REG_SZ</p></td>
<td><p>Экспорт данных из текущей базы данных в файл Microsoft Excel 97. При этом данные будут перезаписаны при экспорте в существующий файл.</p></td>
</tr>
<tr class="odd">
<td><p>Суппортслонгнамес</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
</tbody>
</table>

## <a name="using-the-typeguessrows-setting-for-excel-driver"></a>Использование параметра Типегуессровс для драйвера Excel
При использовании драйвера Microsoft Excel можно указать количество строк, проверяемых для типа данных, с помощью значения реестра **типегуессровс** . Значение **типегуессровс** находится в следующем подразделе реестра:

# <a name="office-2016taboffice-2016"></a>[Office 2016](#tab/office-2016)

Для установки пакета Office для MSI

- Для 32 — разрядная версия Office в 32 — разрядная версия Windows или 64 — разрядная версия для Windows:
    
  **Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Access Енгине\енгинес\ексцел**

- Для 32 — разрядная версия Office в 64 — разрядная версия Windows:

  **Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\16.0\Access Енгине\енгинес\ексцел**
    
Установка Office "нажми и работай"

- Для 32 — разрядная версия Office в 32 — разрядная версия Windows или 64 — разрядная версия для Windows:
    
  **Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Office\16.0\Access Енгине\енгинес\ексцел**

- Для 32 — разрядная версия Office в 64 — разрядная версия Windows:
    
  **Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Wow6432Node\Microsoft\Office\16.0\Access Енгине\енгинес\ексцел**

Значение по умолчанию для проверяемых строк равно **8** (8). Если для параметра **типегуессровс** задано значение **0** (ноль), драйвер Excel проверяет первые 16 384 строк для типа данных. Если требуется проверить более 16 384 строк, задайте для параметра **типегуессровс** значение в соответствии с требуемым диапазоном. Чтобы проверить все строки, задайте для параметра **типегуессровс** значение 1 048 576 (максимально допустимое число строк в Excel).
 
Тип данных определяется максимальным количеством найденных типов данных. Если задано значение, тип данных определяется в следующем порядке:

- Число.
- Денежные единицы.
- Дата
- Текст
- Логический

Если обнаружены данные, которые не совпадают с предполагаемым типом данных для столбца, эти данные возвращаются в виде значения **null** . При импорте, если столбец содержит смешанные типы данных, столбец целиком приводится к типу данных, заданному параметром **импортмикседтипес** .

# <a name="office-2013taboffice-2013"></a>[Office 2013](#tab/office-2013)

Для 32 — разрядная версия Office в 32 — разрядная версия Windows или 64 — разрядная версия для Windows:

**Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\15.0\Access Енгине\енгинес\ексцел**

Для 32 — разрядная версия Office в 64 — разрядная версия Windows:

**Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\Access Енгине\енгинес\ексцел**

Значение по умолчанию для проверяемых строк равно **8** (8). Если для параметра **типегуессровс** задано значение **0** (ноль), драйвер Excel проверяет первые 16 384 строк для типа данных. Если требуется проверить более 16 384 строк, задайте для параметра **типегуессровс** значение в соответствии с требуемым диапазоном. Чтобы проверить все строки, задайте для параметра **типегуессровс** значение 1 048 576 (максимально допустимое число строк в Excel).
 
Тип данных определяется максимальным количеством найденных типов данных. Если задано значение, тип данных определяется в следующем порядке:

- Число.
- Денежные единицы.
- Дата
- Текст
- Логический

Если обнаружены данные, которые не совпадают с предполагаемым типом данных для столбца, эти данные возвращаются в виде значения **null** . При импорте, если столбец содержит смешанные типы данных, столбец целиком приводится к типу данных, заданному параметром **импортмикседтипес** .

# <a name="office-2010taboffice-2010"></a>[Office 2010](#tab/office-2010)

Для 32 — разрядная версия Office в 32 — разрядная версия Windows или 64 — разрядная версия для Windows:

**Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\15.0\Access Енгине\енгинес\ексцел**

Для 32 — разрядная версия Office в 64 — разрядная версия Windows:

**Подключение к HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\Access Енгине\енгинес\ексцел**

Значение по умолчанию для проверяемых строк равно **8** (8). Если для параметра **типегуессровс** задано значение **0** (ноль), драйвер Excel проверяет первые 16 384 строк для типа данных. Если требуется проверить более 16 384 строк, задайте для параметра **типегуессровс** значение в соответствии с требуемым диапазоном. Чтобы проверить все строки, задайте для параметра **типегуессровс** значение 1 048 576 (максимально допустимое число строк в Excel).
 
Тип данных определяется максимальным количеством найденных типов данных. Если задано значение, тип данных определяется в следующем порядке:

- Число.
- Денежные единицы.
- Дата
- Текст
- Логический

Если обнаружены данные, которые не совпадают с предполагаемым типом данных для столбца, эти данные возвращаются в виде значения **null** . При импорте, если столбец содержит смешанные типы данных, столбец целиком приводится к типу данных, заданному параметром **импортмикседтипес** .

---
> [!NOTE]
> При изменении параметров реестра Windows необходимо выйти и перезапустить ядро СУБД, чтобы новые параметры вступили в силу.

## <a name="see-also"></a>См. также

- [Использование параметра Типегуессровс для драйвера Excel](https://support.office.com/en-us/article/using-the-typeguessrows-setting-for-excel-driver-6aa3e101-2a90-47ac-bf0f-7d4109a5708b?ui=en-US&rs=en-US&ad=US)

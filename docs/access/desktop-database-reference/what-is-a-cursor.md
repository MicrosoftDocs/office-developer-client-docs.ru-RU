---
title: What is a Cursor?  (Ссылка на настольные базы данных)
TOCTitle: What is a Cursor?
ms:assetid: cc70d941-05e0-9b14-1c5d-6b1a5802f546
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250013(v=office.15)
ms:contentKeyID: 48547738
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2023b39620f80e6f770153e381c74d5285d027c6
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32302746"
---
# <a name="what-is-a-cursor"></a><span data-ttu-id="43a0b-103">Что такое курсор?</span><span class="sxs-lookup"><span data-stu-id="43a0b-103">What is a cursor?</span></span>


<span data-ttu-id="43a0b-104">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="43a0b-104">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="43a0b-105">Операции в реляционной базе данных действуют на полный набор строк.</span><span class="sxs-lookup"><span data-stu-id="43a0b-105">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="43a0b-106">Набор строк, возвращаемых в заявлении SELECT, состоит из всех строк, удовлетворяющих условиям в пункте WHERE этого утверждения.</span><span class="sxs-lookup"><span data-stu-id="43a0b-106">The set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="43a0b-107">Этот полный набор строк, возвращаемого в заявлении, называется набором результатов.</span><span class="sxs-lookup"><span data-stu-id="43a0b-107">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="43a0b-108">Приложения, особенно интерактивные и интерактивные, не всегда могут эффективно работать со всем набором результатов в качестве единицы.</span><span class="sxs-lookup"><span data-stu-id="43a0b-108">Applications, especially those that are interactive and online, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="43a0b-109">Этим приложениям необходим механизм для работы с одной строкой или небольшим блоком строк одновременно.</span><span class="sxs-lookup"><span data-stu-id="43a0b-109">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="43a0b-110">Курсоры — это расширение для набора результатов, которые предоставляют этот механизм.</span><span class="sxs-lookup"><span data-stu-id="43a0b-110">Cursors are an extension to result sets that provide that mechanism.</span></span>

<span data-ttu-id="43a0b-111">Курсор реализуется библиотекой курсоров.</span><span class="sxs-lookup"><span data-stu-id="43a0b-111">A cursor is implemented by a cursor library.</span></span> <span data-ttu-id="43a0b-112">Библиотека курсоров — это программное обеспечение, которое часто реализуется в рамках системы баз данных или API доступа к данным, которое используется для управления атрибутами данных, возвращаемого из источника данных (набора результатов).</span><span class="sxs-lookup"><span data-stu-id="43a0b-112">A cursor library is software, often implemented as a part of a database system or a data access API, that is used to manage attributes of data returned from a data source (a result set).</span></span> <span data-ttu-id="43a0b-113">Эти атрибуты включают управление конвалютами, положение в наборе результатов, количество возвращенных строк, а также то, можно ли двигаться вперед и/или назад через набор результатов (прокрутки).</span><span class="sxs-lookup"><span data-stu-id="43a0b-113">These attributes include concurrency management, position in the result set, number of rows returned, and whether or not you can move forward and/or backward through the result set (scrollability).</span></span>

<span data-ttu-id="43a0b-114">Курсор отслеживает положение в наборе результатов и позволяет выполнять несколько операций подряд в отношении набора результатов с возвратом к исходной таблице или без нее.</span><span class="sxs-lookup"><span data-stu-id="43a0b-114">A cursor keeps track of the position in the result set, and allows you to perform multiple operations row by row against a result set, with or without returning to the original table.</span></span> <span data-ttu-id="43a0b-115">Другими словами, курсоры концептуально возвращают набор результатов на основе таблиц в базах данных.</span><span class="sxs-lookup"><span data-stu-id="43a0b-115">In other words, cursors conceptually return a result set based on tables within the databases.</span></span> <span data-ttu-id="43a0b-116">Курсор так и называется, так как указывает текущее положение в наборе результатов, точно так же, как курсор на экране компьютера указывает текущее положение.</span><span class="sxs-lookup"><span data-stu-id="43a0b-116">The cursor is so named because it indicates the current position in the result set, just as the cursor on a computer screen indicates current position.</span></span>

<span data-ttu-id="43a0b-117">Важно ознакомиться с концепцией курсоров, прежде чем двигаться дальше, чтобы узнать особенности их использования в ADO.</span><span class="sxs-lookup"><span data-stu-id="43a0b-117">It is important to become familiar with the concept of cursors before moving on to learn the specifics of their usage in ADO.</span></span>

<span data-ttu-id="43a0b-118">С помощью курсоров можно:</span><span class="sxs-lookup"><span data-stu-id="43a0b-118">Using cursors, you can:</span></span>

  - <span data-ttu-id="43a0b-119">Укажите расположение в определенных строках в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="43a0b-119">Specify positioning at specific rows in the result set.</span></span>

  - <span data-ttu-id="43a0b-120">Извлекать одну строку или блок строк в зависимости от текущей позиции набора результатов.</span><span class="sxs-lookup"><span data-stu-id="43a0b-120">Retrieve one row or a block of rows based on the current result set position.</span></span>

  - <span data-ttu-id="43a0b-121">Изменение данных в строках в текущей позиции в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="43a0b-121">Modify data in the rows at the current position in the result set.</span></span>

  - <span data-ttu-id="43a0b-122">Определение различных уровней чувствительности к изменениям данных, внесенным другими пользователями.</span><span class="sxs-lookup"><span data-stu-id="43a0b-122">Define different levels of sensitivity to data changes made by other users.</span></span>

<span data-ttu-id="43a0b-123">Например, рассмотрим приложение, которое отображает список доступных продуктов потенциальному покупателю.</span><span class="sxs-lookup"><span data-stu-id="43a0b-123">For example, consider an application that displays a list of available products to a potential buyer.</span></span> <span data-ttu-id="43a0b-124">Покупатель прокручивает список, чтобы просмотреть сведения о продукте и стоимость, и, наконец, выбирает продукт для покупки.</span><span class="sxs-lookup"><span data-stu-id="43a0b-124">The buyer scrolls through the list to see product details and cost, and finally selects a product for purchase.</span></span> <span data-ttu-id="43a0b-125">Дополнительный прокрутки и выбор происходит для остальной части списка.</span><span class="sxs-lookup"><span data-stu-id="43a0b-125">Additional scrolling and selection occurs for the remainder of the list.</span></span> <span data-ttu-id="43a0b-126">Что касается покупателя, то продукты отображаются по одному, но приложение использует прокручиваемый курсор для просмотра вверх и вниз по набору результатов.</span><span class="sxs-lookup"><span data-stu-id="43a0b-126">As far as the buyer is concerned, the products appear one at a time, but the application uses a scrollable cursor to browse up and down through the result set.</span></span>

<span data-ttu-id="43a0b-127">Курсоры можно использовать различными способами:</span><span class="sxs-lookup"><span data-stu-id="43a0b-127">You can use cursors in a variety of ways:</span></span>

  - <span data-ttu-id="43a0b-128">Без строк.</span><span class="sxs-lookup"><span data-stu-id="43a0b-128">With no rows at all.</span></span>

  - <span data-ttu-id="43a0b-129">С некоторыми или всеми строками в одной таблице.</span><span class="sxs-lookup"><span data-stu-id="43a0b-129">With some or all of the rows in a single table.</span></span>

  - <span data-ttu-id="43a0b-130">С некоторыми или всеми строками из логически соединяемой таблицы.</span><span class="sxs-lookup"><span data-stu-id="43a0b-130">With some or all of the rows from logically joined tables.</span></span>

  - <span data-ttu-id="43a0b-131">Только для чтения или для обновления на уровне курсора или поля.</span><span class="sxs-lookup"><span data-stu-id="43a0b-131">As read-only or updateable at the cursor or field level.</span></span>

  - <span data-ttu-id="43a0b-132">Как только вперед или полностью прокрутки.</span><span class="sxs-lookup"><span data-stu-id="43a0b-132">As forward-only or fully scrollable.</span></span>

  - <span data-ttu-id="43a0b-133">С набором ключей курсора, расположенным на сервере.</span><span class="sxs-lookup"><span data-stu-id="43a0b-133">With the cursor keyset located on the server.</span></span>

  - <span data-ttu-id="43a0b-134">Чувствителен к изменениям в таблице, вызванным другими приложениями (например, членством, сортировкой, вставками, обновлениями и удалениями).</span><span class="sxs-lookup"><span data-stu-id="43a0b-134">Sensitive to underlying table changes caused by other applications (such as membership, sort, inserts, updates, and deletes).</span></span>

  - <span data-ttu-id="43a0b-135">Существующие на сервере или клиенте.</span><span class="sxs-lookup"><span data-stu-id="43a0b-135">Existing on either the server or the client.</span></span>

<span data-ttu-id="43a0b-136">Курсоры только для чтения помогают пользователям просматривать набор результатов, а курсоры чтения и записи могут выполнять отдельные обновления строк.</span><span class="sxs-lookup"><span data-stu-id="43a0b-136">Read-only cursors help users browse through the result set, and read/write cursors can implement individual row updates.</span></span> <span data-ttu-id="43a0b-137">Сложные курсоры можно определить с помощью клавиш, которые указывают на базовые строки таблицы.</span><span class="sxs-lookup"><span data-stu-id="43a0b-137">Complex cursors can be defined with keysets that point back to base table rows.</span></span> <span data-ttu-id="43a0b-138">Хотя некоторые курсоры только для чтения в направлении вперед, другие могут перемещаться вперед и назад и обеспечивать динамическое обновление набора результатов на основе изменений, которые другие приложения делают в базе данных.</span><span class="sxs-lookup"><span data-stu-id="43a0b-138">While some cursors are read-only in a forward direction, others can move back and forth and provide a dynamic refresh of the result set based on changes that other applications are making to the database.</span></span>

<span data-ttu-id="43a0b-139">Не всем приложениям необходимо использовать курсоры для доступа к данным или обновления.</span><span class="sxs-lookup"><span data-stu-id="43a0b-139">Not all applications need to use cursors to access or update data.</span></span> <span data-ttu-id="43a0b-140">Некоторые запросы просто не требуют обновления прямой строки с помощью курсора.</span><span class="sxs-lookup"><span data-stu-id="43a0b-140">Some queries simply do not require direct row updating by using a cursor.</span></span> <span data-ttu-id="43a0b-141">Курсоры должны быть одним из последних методов, которые вы выбираете для получения данных, а затем следует выбрать самый низкий возможный курсор воздействия.</span><span class="sxs-lookup"><span data-stu-id="43a0b-141">Cursors should be one of the last techniques you choose to retrieve data — and then you should choose the lowest impact cursor possible.</span></span> <span data-ttu-id="43a0b-142">При создании результата, задаваемого с помощью сохраненной процедуры, набор результатов не обновляется с помощью методов редактирования курсора или обновления.</span><span class="sxs-lookup"><span data-stu-id="43a0b-142">When you create a result set by using a stored procedure, the result set is not updateable using cursor edit or update methods.</span></span>

## <a name="concurrency"></a><span data-ttu-id="43a0b-143">Concurrency</span><span class="sxs-lookup"><span data-stu-id="43a0b-143">Concurrency</span></span>

<span data-ttu-id="43a0b-144">В некоторых приложениях с несколькими пользователями жизненно важно, чтобы данные, представленные конечному пользователю, были как можно более актуальными.</span><span class="sxs-lookup"><span data-stu-id="43a0b-144">In some multi-user applications it is vitally important for the data presented to the end user to be as current as possible.</span></span> <span data-ttu-id="43a0b-145">Классическим примером такой системы является система резервирования авиакомпаний, в которой многие пользователи могут бороться за одно и то же место на заданный рейс (и, следовательно, одну запись).</span><span class="sxs-lookup"><span data-stu-id="43a0b-145">A classic example of such a system is an airline reservation system, where many users might be contending for the same seat on a given flight (and thus, a single record).</span></span> <span data-ttu-id="43a0b-146">В таком случае проект приложения должен обрабатывать одновечерные операции на одной записи.</span><span class="sxs-lookup"><span data-stu-id="43a0b-146">In a case like this, the application design must handle concurrent operations on a single record.</span></span>

<span data-ttu-id="43a0b-147">В других приложениях значение concurrency не так важно.</span><span class="sxs-lookup"><span data-stu-id="43a0b-147">In other applications, concurrency is not as important.</span></span> <span data-ttu-id="43a0b-148">В таких случаях затраты, связанные с сохранением текущих данных во все времена, не могут быть оправданы.</span><span class="sxs-lookup"><span data-stu-id="43a0b-148">In such cases, the expense involved in keeping the data current at all times cannot be justified.</span></span>

## <a name="position"></a><span data-ttu-id="43a0b-149">Position</span><span class="sxs-lookup"><span data-stu-id="43a0b-149">Position</span></span>

<span data-ttu-id="43a0b-150">Курсор также отслеживает текущее положение в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="43a0b-150">A cursor also keeps track of the current position in a result set.</span></span> <span data-ttu-id="43a0b-151">Подумайте о позиции курсора в качестве указателя на текущую запись, аналогично тому, как индекс массива указывает на значение в этом конкретном расположении массива.</span><span class="sxs-lookup"><span data-stu-id="43a0b-151">Think of the cursor position as a pointer to the current record, similar to the way an array index points to the value at that particular location in the array.</span></span>

## <a name="scrollability"></a><span data-ttu-id="43a0b-152">Прокрутка</span><span class="sxs-lookup"><span data-stu-id="43a0b-152">Scrollability</span></span>

<span data-ttu-id="43a0b-153">Тип курсора, занятого вашим приложением, также влияет на возможность перемещения вперед и назад по строкам в наборе результатов; это иногда называется прокрутки.</span><span class="sxs-lookup"><span data-stu-id="43a0b-153">The type of cursor employed by your application also affects the ability to move forward and backward through the rows in a result set; this is sometimes called scrollability.</span></span> <span data-ttu-id="43a0b-154">Возможность перемещения вперед *и* назад с помощью набора результатов добавляет сложности курсора и, следовательно, более затратна в реализации.</span><span class="sxs-lookup"><span data-stu-id="43a0b-154">The ability to move forward *and* backward through a result set adds to the complexity of the cursor, and is therefore more expensive to implement.</span></span> <span data-ttu-id="43a0b-155">По этой причине следует попросить курсор с этой функцией только при необходимости.</span><span class="sxs-lookup"><span data-stu-id="43a0b-155">For this reason, you should ask for a cursor with this functionality only when necessary.</span></span>


---
title: What is a Cursor?  (Ссылка на настольные базы данных)
TOCTitle: What is a Cursor?
ms:assetid: cc70d941-05e0-9b14-1c5d-6b1a5802f546
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250013(v=office.15)
ms:contentKeyID: 48547738
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2023b39620f80e6f770153e381c74d5285d027c6
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32302746"
---
# <a name="what-is-a-cursor"></a>Что такое курсор?


**Область применения**: Access 2013, Office 2013

Операции в реляционной базе данных действуют на полный набор строк. Набор строк, возвращаемых в заявлении SELECT, состоит из всех строк, удовлетворяющих условиям в пункте WHERE этого утверждения. Этот полный набор строк, возвращаемого в заявлении, называется набором результатов. Приложения, особенно интерактивные и интерактивные, не всегда могут эффективно работать со всем набором результатов в качестве единицы. Этим приложениям необходим механизм для работы с одной строкой или небольшим блоком строк одновременно. Курсоры — это расширение для набора результатов, которые предоставляют этот механизм.

Курсор реализуется библиотекой курсоров. Библиотека курсоров — это программное обеспечение, которое часто реализуется в рамках системы баз данных или API доступа к данным, которое используется для управления атрибутами данных, возвращаемого из источника данных (набора результатов). Эти атрибуты включают управление конвалютами, положение в наборе результатов, количество возвращенных строк, а также то, можно ли двигаться вперед и/или назад через набор результатов (прокрутки).

Курсор отслеживает положение в наборе результатов и позволяет выполнять несколько операций подряд в отношении набора результатов с возвратом к исходной таблице или без нее. Другими словами, курсоры концептуально возвращают набор результатов на основе таблиц в базах данных. Курсор так и называется, так как указывает текущее положение в наборе результатов, точно так же, как курсор на экране компьютера указывает текущее положение.

Важно ознакомиться с концепцией курсоров, прежде чем двигаться дальше, чтобы узнать особенности их использования в ADO.

С помощью курсоров можно:

  - Укажите расположение в определенных строках в наборе результатов.

  - Извлекать одну строку или блок строк в зависимости от текущей позиции набора результатов.

  - Изменение данных в строках в текущей позиции в наборе результатов.

  - Определение различных уровней чувствительности к изменениям данных, внесенным другими пользователями.

Например, рассмотрим приложение, которое отображает список доступных продуктов потенциальному покупателю. Покупатель прокручивает список, чтобы просмотреть сведения о продукте и стоимость, и, наконец, выбирает продукт для покупки. Дополнительный прокрутки и выбор происходит для остальной части списка. Что касается покупателя, то продукты отображаются по одному, но приложение использует прокручиваемый курсор для просмотра вверх и вниз по набору результатов.

Курсоры можно использовать различными способами:

  - Без строк.

  - С некоторыми или всеми строками в одной таблице.

  - С некоторыми или всеми строками из логически соединяемой таблицы.

  - Только для чтения или для обновления на уровне курсора или поля.

  - Как только вперед или полностью прокрутки.

  - С набором ключей курсора, расположенным на сервере.

  - Чувствителен к изменениям в таблице, вызванным другими приложениями (например, членством, сортировкой, вставками, обновлениями и удалениями).

  - Существующие на сервере или клиенте.

Курсоры только для чтения помогают пользователям просматривать набор результатов, а курсоры чтения и записи могут выполнять отдельные обновления строк. Сложные курсоры можно определить с помощью клавиш, которые указывают на базовые строки таблицы. Хотя некоторые курсоры только для чтения в направлении вперед, другие могут перемещаться вперед и назад и обеспечивать динамическое обновление набора результатов на основе изменений, которые другие приложения делают в базе данных.

Не всем приложениям необходимо использовать курсоры для доступа к данным или обновления. Некоторые запросы просто не требуют обновления прямой строки с помощью курсора. Курсоры должны быть одним из последних методов, которые вы выбираете для получения данных, а затем следует выбрать самый низкий возможный курсор воздействия. При создании результата, задаваемого с помощью сохраненной процедуры, набор результатов не обновляется с помощью методов редактирования курсора или обновления.

## <a name="concurrency"></a>Concurrency

В некоторых приложениях с несколькими пользователями жизненно важно, чтобы данные, представленные конечному пользователю, были как можно более актуальными. Классическим примером такой системы является система резервирования авиакомпаний, в которой многие пользователи могут бороться за одно и то же место на заданный рейс (и, следовательно, одну запись). В таком случае проект приложения должен обрабатывать одновечерные операции на одной записи.

В других приложениях значение concurrency не так важно. В таких случаях затраты, связанные с сохранением текущих данных во все времена, не могут быть оправданы.

## <a name="position"></a>Position

Курсор также отслеживает текущее положение в наборе результатов. Подумайте о позиции курсора в качестве указателя на текущую запись, аналогично тому, как индекс массива указывает на значение в этом конкретном расположении массива.

## <a name="scrollability"></a>Прокрутка

Тип курсора, занятого вашим приложением, также влияет на возможность перемещения вперед и назад по строкам в наборе результатов; это иногда называется прокрутки. Возможность перемещения вперед *и* назад с помощью набора результатов добавляет сложности курсора и, следовательно, более затратна в реализации. По этой причине следует попросить курсор с этой функцией только при необходимости.


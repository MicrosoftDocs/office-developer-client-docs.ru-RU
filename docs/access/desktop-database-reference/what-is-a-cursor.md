---
title: What is a Cursor?  (Справочник по базам данных Access на компьютере)
TOCTitle: What is a Cursor?
ms:assetid: cc70d941-05e0-9b14-1c5d-6b1a5802f546
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250013(v=office.15)
ms:contentKeyID: 48547738
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2023b39620f80e6f770153e381c74d5285d027c6
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32302746"
---
# <a name="what-is-a-cursor"></a><span data-ttu-id="495c8-103">Что такое курсор?</span><span class="sxs-lookup"><span data-stu-id="495c8-103">What is a cursor?</span></span>


<span data-ttu-id="495c8-104">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="495c8-104">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="495c8-105">Операции в реляционной базе данных действуют в полном наборе строк.</span><span class="sxs-lookup"><span data-stu-id="495c8-105">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="495c8-106">Набор строк, возвращаемых инструкцией SELECT, состоит из всех строк, которые удовлетворяют условиям в предложении WHERE оператора.</span><span class="sxs-lookup"><span data-stu-id="495c8-106">The set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="495c8-107">Этот полный набор строк, возвращаемых инструкцией, называется набором результатов.</span><span class="sxs-lookup"><span data-stu-id="495c8-107">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="495c8-108">Приложения, особенно интерактивные и интерактивные, не всегда могут эффективно работать с результирующим набором как единое целое.</span><span class="sxs-lookup"><span data-stu-id="495c8-108">Applications, especially those that are interactive and online, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="495c8-109">Этим приложениям необходим механизм для работы с одной строкой или небольшим блоком строк за раз.</span><span class="sxs-lookup"><span data-stu-id="495c8-109">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="495c8-110">Курсоры это расширение наборов результатов, которые предоставляют этот механизм.</span><span class="sxs-lookup"><span data-stu-id="495c8-110">Cursors are an extension to result sets that provide that mechanism.</span></span>

<span data-ttu-id="495c8-111">Курсор реализуется библиотекой курсоров.</span><span class="sxs-lookup"><span data-stu-id="495c8-111">A cursor is implemented by a cursor library.</span></span> <span data-ttu-id="495c8-112">Библиотека курсоров — это программное обеспечение, которое часто реализуется как часть системы базы данных или API доступа к данным, которое используется для управления атрибутами данных, возвращаемых из источника данных (набор результатов).</span><span class="sxs-lookup"><span data-stu-id="495c8-112">A cursor library is software, often implemented as a part of a database system or a data access API, that is used to manage attributes of data returned from a data source (a result set).</span></span> <span data-ttu-id="495c8-113">Эти атрибуты включают управление параллелизмом, положение в результирующем наборе, число возвращаемых строк, а также сведения о том, можно ли перемещаться вперед и назад в наборе результатов (прокрутку).</span><span class="sxs-lookup"><span data-stu-id="495c8-113">These attributes include concurrency management, position in the result set, number of rows returned, and whether or not you can move forward and/or backward through the result set (scrollability).</span></span>

<span data-ttu-id="495c8-114">Курсор отслеживает положение в наборе результатов и позволяет выполнять несколько операций по строкам в результирующем наборе, а также без возврата к исходной таблице.</span><span class="sxs-lookup"><span data-stu-id="495c8-114">A cursor keeps track of the position in the result set, and allows you to perform multiple operations row by row against a result set, with or without returning to the original table.</span></span> <span data-ttu-id="495c8-115">Другими словами, с помощью курсоров концептуально возвращается набор результатов, основанный на таблицах баз данных.</span><span class="sxs-lookup"><span data-stu-id="495c8-115">In other words, cursors conceptually return a result set based on tables within the databases.</span></span> <span data-ttu-id="495c8-116">Курсор имеет имя, так как указывает текущее положение в наборе результатов, так как курсор на экране компьютера указывает текущее положение.</span><span class="sxs-lookup"><span data-stu-id="495c8-116">The cursor is so named because it indicates the current position in the result set, just as the cursor on a computer screen indicates current position.</span></span>

<span data-ttu-id="495c8-117">Прежде чем перейти к сведениям об использовании в ADO, важно ознакомиться с концепцией курсоров.</span><span class="sxs-lookup"><span data-stu-id="495c8-117">It is important to become familiar with the concept of cursors before moving on to learn the specifics of their usage in ADO.</span></span>

<span data-ttu-id="495c8-118">С помощью курсоров вы можете:</span><span class="sxs-lookup"><span data-stu-id="495c8-118">Using cursors, you can:</span></span>

  - <span data-ttu-id="495c8-119">Указание положения в определенных строках в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="495c8-119">Specify positioning at specific rows in the result set.</span></span>

  - <span data-ttu-id="495c8-120">Получение одной строки или блока строк на основе текущего положения набора результатов.</span><span class="sxs-lookup"><span data-stu-id="495c8-120">Retrieve one row or a block of rows based on the current result set position.</span></span>

  - <span data-ttu-id="495c8-121">Изменение данных в строках, расположенных в текущей позиции в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="495c8-121">Modify data in the rows at the current position in the result set.</span></span>

  - <span data-ttu-id="495c8-122">Определите различные уровни конфиденциальности для изменений данных, внесенных другими пользователями.</span><span class="sxs-lookup"><span data-stu-id="495c8-122">Define different levels of sensitivity to data changes made by other users.</span></span>

<span data-ttu-id="495c8-123">Например, рассмотрим приложение, которое отображает список доступных продуктов для потенциального покупателя.</span><span class="sxs-lookup"><span data-stu-id="495c8-123">For example, consider an application that displays a list of available products to a potential buyer.</span></span> <span data-ttu-id="495c8-124">Покупатель прокручивает список, чтобы просмотреть сведения о продукте и затраты, а затем выберет продукт для покупки.</span><span class="sxs-lookup"><span data-stu-id="495c8-124">The buyer scrolls through the list to see product details and cost, and finally selects a product for purchase.</span></span> <span data-ttu-id="495c8-125">Дополнительная прокрутка и выделение выполняется для оставшейся части списка.</span><span class="sxs-lookup"><span data-stu-id="495c8-125">Additional scrolling and selection occurs for the remainder of the list.</span></span> <span data-ttu-id="495c8-126">С точки зрения покупателя продукты появятся по одному, но приложение использует прокручиваемый курсор для просмотра в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="495c8-126">As far as the buyer is concerned, the products appear one at a time, but the application uses a scrollable cursor to browse up and down through the result set.</span></span>

<span data-ttu-id="495c8-127">Вы можете использовать курсоры различными способами:</span><span class="sxs-lookup"><span data-stu-id="495c8-127">You can use cursors in a variety of ways:</span></span>

  - <span data-ttu-id="495c8-128">Без строк.</span><span class="sxs-lookup"><span data-stu-id="495c8-128">With no rows at all.</span></span>

  - <span data-ttu-id="495c8-129">С некоторыми или всеми строками в одной таблице.</span><span class="sxs-lookup"><span data-stu-id="495c8-129">With some or all of the rows in a single table.</span></span>

  - <span data-ttu-id="495c8-130">С некоторыми или всеми строками из логически соединяемых таблиц.</span><span class="sxs-lookup"><span data-stu-id="495c8-130">With some or all of the rows from logically joined tables.</span></span>

  - <span data-ttu-id="495c8-131">Доступен только для чтения или обновляемый на уровне курсора или поля.</span><span class="sxs-lookup"><span data-stu-id="495c8-131">As read-only or updateable at the cursor or field level.</span></span>

  - <span data-ttu-id="495c8-132">Как прямой или полностью прокручиваемый.</span><span class="sxs-lookup"><span data-stu-id="495c8-132">As forward-only or fully scrollable.</span></span>

  - <span data-ttu-id="495c8-133">С набором ключей курсора, расположенном на сервере.</span><span class="sxs-lookup"><span data-stu-id="495c8-133">With the cursor keyset located on the server.</span></span>

  - <span data-ttu-id="495c8-134">Конфиденциальные изменения в базовой таблице, вызванные другими приложениями (например, членством, сортировкой, вставкой, обновлением и удалением).</span><span class="sxs-lookup"><span data-stu-id="495c8-134">Sensitive to underlying table changes caused by other applications (such as membership, sort, inserts, updates, and deletes).</span></span>

  - <span data-ttu-id="495c8-135">Существующий на сервере или в клиенте.</span><span class="sxs-lookup"><span data-stu-id="495c8-135">Existing on either the server or the client.</span></span>

<span data-ttu-id="495c8-136">Курсоры, доступные только для чтения, помогают пользователям просматривать набор результатов, а курсоры чтения и записи могут реализовать обновление отдельных строк.</span><span class="sxs-lookup"><span data-stu-id="495c8-136">Read-only cursors help users browse through the result set, and read/write cursors can implement individual row updates.</span></span> <span data-ttu-id="495c8-137">Сложные курсоры можно определить с помощью кэйсетс, которые будут указывать на строки базовой таблицы.</span><span class="sxs-lookup"><span data-stu-id="495c8-137">Complex cursors can be defined with keysets that point back to base table rows.</span></span> <span data-ttu-id="495c8-138">Хотя некоторые курсоры доступны только для чтения в направлении вперед, другие могут перемещаться назад и вперед и предоставлять динамическое обновление результирующего набора на основе изменений, которые другие приложения создают в базе данных.</span><span class="sxs-lookup"><span data-stu-id="495c8-138">While some cursors are read-only in a forward direction, others can move back and forth and provide a dynamic refresh of the result set based on changes that other applications are making to the database.</span></span>

<span data-ttu-id="495c8-139">Не все приложения должны использовать курсоры для доступа к данным и их обновления.</span><span class="sxs-lookup"><span data-stu-id="495c8-139">Not all applications need to use cursors to access or update data.</span></span> <span data-ttu-id="495c8-140">В некоторых запросах просто не требуется обновление прямой строки с помощью курсора.</span><span class="sxs-lookup"><span data-stu-id="495c8-140">Some queries simply do not require direct row updating by using a cursor.</span></span> <span data-ttu-id="495c8-141">Курсоры должны быть последними методами, выбранными для получения данных, а затем следует выбирать самый низкий затронутый курсор.</span><span class="sxs-lookup"><span data-stu-id="495c8-141">Cursors should be one of the last techniques you choose to retrieve data — and then you should choose the lowest impact cursor possible.</span></span> <span data-ttu-id="495c8-142">При создании набора результатов с помощью хранимой процедуры набор результатов не обновляется с помощью методов редактирования или обновления курсора.</span><span class="sxs-lookup"><span data-stu-id="495c8-142">When you create a result set by using a stored procedure, the result set is not updateable using cursor edit or update methods.</span></span>

## <a name="concurrency"></a><span data-ttu-id="495c8-143">Параллелизм</span><span class="sxs-lookup"><span data-stu-id="495c8-143">Concurrency</span></span>

<span data-ttu-id="495c8-144">В некоторых приложениях с несколькими пользователями это жизненно важно, чтобы данные, представленные конечному пользователю, были как можно более актуальными.</span><span class="sxs-lookup"><span data-stu-id="495c8-144">In some multi-user applications it is vitally important for the data presented to the end user to be as current as possible.</span></span> <span data-ttu-id="495c8-145">Классическим примером такой системы является система резервирования авиакомпании, в которой многие пользователи могут заинтересовать одно и то же рабочее место (и, следовательно, одну запись).</span><span class="sxs-lookup"><span data-stu-id="495c8-145">A classic example of such a system is an airline reservation system, where many users might be contending for the same seat on a given flight (and thus, a single record).</span></span> <span data-ttu-id="495c8-146">В таком случае проект приложения должен обрабатывать параллельные операции над одной записью.</span><span class="sxs-lookup"><span data-stu-id="495c8-146">In a case like this, the application design must handle concurrent operations on a single record.</span></span>

<span data-ttu-id="495c8-147">В других приложениях параллелизм не имеет значения.</span><span class="sxs-lookup"><span data-stu-id="495c8-147">In other applications, concurrency is not as important.</span></span> <span data-ttu-id="495c8-148">В таких случаях затраты, связанные с постоянном поддержание текущих данных, не могут быть выравниваются.</span><span class="sxs-lookup"><span data-stu-id="495c8-148">In such cases, the expense involved in keeping the data current at all times cannot be justified.</span></span>

## <a name="position"></a><span data-ttu-id="495c8-149">Position</span><span class="sxs-lookup"><span data-stu-id="495c8-149">Position</span></span>

<span data-ttu-id="495c8-150">Курсор также отслеживает текущую позицию в наборе результатов.</span><span class="sxs-lookup"><span data-stu-id="495c8-150">A cursor also keeps track of the current position in a result set.</span></span> <span data-ttu-id="495c8-151">ПроДумайте положение курсора в качестве указателя на текущую запись, аналогично тому, как индекс массива указывает на значение в этом конкретном расположении в массиве.</span><span class="sxs-lookup"><span data-stu-id="495c8-151">Think of the cursor position as a pointer to the current record, similar to the way an array index points to the value at that particular location in the array.</span></span>

## <a name="scrollability"></a><span data-ttu-id="495c8-152">ПроКрутка</span><span class="sxs-lookup"><span data-stu-id="495c8-152">Scrollability</span></span>

<span data-ttu-id="495c8-153">Тип курсора, используемый приложением, также влияет на возможность перемещения вперед и назад по строкам в наборе результатов; Иногда это называется прокруткой.</span><span class="sxs-lookup"><span data-stu-id="495c8-153">The type of cursor employed by your application also affects the ability to move forward and backward through the rows in a result set; this is sometimes called scrollability.</span></span> <span data-ttu-id="495c8-154">Возможность перемещаться вперед *и* назад по набору результатов повышает сложность курсора, поэтому ее реализация более затратна.</span><span class="sxs-lookup"><span data-stu-id="495c8-154">The ability to move forward *and* backward through a result set adds to the complexity of the cursor, and is therefore more expensive to implement.</span></span> <span data-ttu-id="495c8-155">По этой причине следует запрашивать курсор с помощью этой функции, только если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="495c8-155">For this reason, you should ask for a cursor with this functionality only when necessary.</span></span>


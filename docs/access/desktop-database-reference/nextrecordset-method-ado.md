---
title: Метод NextRecordset (ADO)
TOCTitle: NextRecordset method (ADO)
ms:assetid: d2776dd5-d521-c57f-dbe5-e02ee238104d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250051(v=office.15)
ms:contentKeyID: 48547887
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: b572f4ebe55da1add781ecd86df97937cfeae126
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288619"
---
# <a name="nextrecordset-method-ado"></a>Метод NextRecordset (ADO)

**Область применения**: Access 2013, Office 2013
 
Очищает текущий объект [Recordset](recordset-object-ado.md) и возвращает следующий **набор записей,** продвигаясь по ряду команд.

## <a name="syntax"></a>Синтаксис

Установите *recordset2*  =  *recordset1*. NextRecordset *(RecordsAffected* )

## <a name="return-value"></a>Возвращаемое значение

Возвращает объект **Recordset.** В модели синтаксиса *recordset1* и *recordset2* может быть тем же объектом **Recordset** или использовать отдельные объекты. При использовании отдельных объектов **Recordset** при сбросе свойства **ActiveConnection** в исходном наборе записей *(recordset1)* после того, как был вызван **NextRecordset,** создается ошибка. 

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*RecordsAffected* |Необязательный параметр. **Длинная** переменная, в которую поставщик возвращает количество записей, на которые повлияла текущая операция.|

> [!NOTE]
> Этот параметр возвращает только количество записей, затронутых операцией; он не возвращает количество записей из выбранного утверждения, используемого для создания **наборов записей.**

## <a name="remarks"></a>Примечания

Используйте метод **NextRecordset,** чтобы вернуть результаты следующей команды в сложном командном заявлении или сохраненной процедуре, которая возвращает несколько результатов. Если вы открываете **объект Recordset** на основе сложного командного утверждения (например, "ВЫБЕРИТЕ \* ИЗ таблицы1; ВЫБЕРИТЕ ИЗ таблицы2") с помощью метода Execute в команде или метода Open в \* **recordset,** [](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) ADO [](open-method-ado-recordset.md) выполняет только первую команду и возвращает результаты в *набор записей.* [](command-object-ado.md) Чтобы получить доступ к результатам последующих команд в заявлении, позвоните по методу **NextRecordset.**

Пока есть дополнительные результаты, а набор **recordset,** содержащий сложные утверждения, не отключается и не маршалится через границы процессов, метод **NextRecordset** будет возвращать объекты **Recordset.** Если команда, возвращаемая строками, выполняется успешно, но не возвращает записи, возвращенный объект **Recordset** будет открыт, но пуст. Проверьте для этого случая, проверяя, что [свойства BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) являются как **True**. Если команда, не возвращаемая строками, выполняется успешно, возвращенный объект **Recordset** будет [](state-property-ado.md) закрыт, что можно проверить, протестив свойство state в **Recordset.** Если результатов больше нет, *набор записей* будет установлен в *Nothing*.

Метод **NextRecordset** не доступен для отключенного объекта **Recordset,** где [ActiveConnection](activeconnection-property-ado.md) задавалось nothing **(в** Microsoft Visual Basic) или NULL (на других языках).

Если изменение продолжается в режиме немедленного обновления, вызов метода **NextRecordset** создает ошибку; сначала вызвать [метод Update](update-method-ado.md) или [CancelUpdate.](cancelupdate-method-ado.md)

Чтобы передать параметры для более чем одной команды [](parameters-collection-ado.md) в составной выписке, заполнив коллекцию Параметры или передав массив с помощью исходного вызова **Open** или **Execute,** параметры должны быть в том же порядке в коллекции или массиве, что и их соответствующие команды в командной серии. Необходимо завершить чтение всех результатов перед чтением значений параметров вывода.

Поставщик OLE DB определяет, когда выполняется каждая команда в сложном операторе. Поставщик [microsoft OLE DB](microsoft-ole-db-provider-for-sql-server.md)для SQL Server, например, выполняет все команды пакетом после получения сложного оператора. В результате **записи просто** возвращаются при вызове **NextRecordset.**

Однако другие поставщики могут выполнить следующую команду в операторе только после того, как будет вызван NextRecordset. Для этих поставщиков, если перед выполнением всей командной записи объект **Recordset** явно закрывается, ADO никогда не выполняет оставшиеся команды.


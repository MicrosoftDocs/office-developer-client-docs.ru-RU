---
title: Метод NextRecordset (ADO)
TOCTitle: NextRecordset method (ADO)
ms:assetid: d2776dd5-d521-c57f-dbe5-e02ee238104d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250051(v=office.15)
ms:contentKeyID: 48547887
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: b572f4ebe55da1add781ecd86df97937cfeae126
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28717162"
---
# <a name="nextrecordset-method-ado"></a>Метод NextRecordset (ADO)

**Применимо к**: Access 2013, Office 2013
 
Удаляет текущий объект [набора записей](recordset-object-ado.md) и возвращает следующего **набора записей** путем перемещения через последовательность команд.

## <a name="syntax"></a>Синтаксис

Установка *recordset2* = *recordset1*. NextRecordset (*RecordsAffected* )

## <a name="return-value"></a>Возвращаемое значение

Возвращает объект **набора записей** . В этой модели синтаксис *recordset1* и *recordset2* может быть один и тот же объект **набора записей** или можно использовать отдельные объекты. При использовании отдельных объектов **наборов записей** , сброс свойства **ActiveConnection** на исходный **записей** (*recordset1*) после вызова **NextRecordset** приведет к ошибке.

## <a name="parameters"></a>Parameters

|Параметр|Описание|
|:--------|:----------|
|*RecordsAffected* |Необязательно. **Длинные** переменной, в который поставщик возвращает число записей, которое влияет на текущей операции.|

> [!NOTE]
> Этот параметр только возвращает число записей, затронутых операцией; Возвращает число записей в инструкции select, используемый для создания **записей**.

## <a name="remarks"></a>Замечания

Используйте метод **NextRecordset** для возврата результатов следующей команды в операторе составные команду или хранимую процедуру, возвращающую несколько результатов. При открытии объекта **набора записей** на основе инструкции составные команды (например, «ВЫБЕРИТЕ \* из Таблица1. Выбор \* из таблица2») с помощью метода [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) на [команду](command-object-ado.md) или метод [Open](open-method-ado-recordset.md) на **набора записей**ADO выполняет только первой команды и возвращает результаты для *набора записей*. Чтобы получить доступ к результаты последующих команд в операторе, вызовите метод **NextRecordset** .

Поскольку существует Дополнительные результаты и **записей** , содержащий составные операторы будет отключен или не переданы через границы процессов, метод **NextRecordset** будет продолжать возвращают объекты **набора записей** . Если команда возвращает строку выполняется успешно, но не возвращает записи, возвращенного объекта **набора записей** будет открыта, но пуста. Проверить наличие в этом случае убедитесь, что параметры [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) используются оба **значение True**. Если команда не возвращающие – строки выполнена успешно, возвращенного объекта **набора записей** будут закрыты, которой вы можете проверить путем тестирования свойство [State](state-property-ado.md) на **набора записей**. Если нет больше результатов, *записей* будет задано значение *Nothing*.

Метод **NextRecordset** не доступен на отключенный объект **набора записей** , где [ActiveConnection](activeconnection-property-ado.md) присвоено значение **Nothing** (в Microsoft Visual Basic) или значение NULL (на других языках).

Если редактирование выполняется в режиме немедленное обновление, вызов метода **NextRecordset** приводит к ошибке; Вызовите метод [Update](update-method-ado.md) или [CancelUpdate](cancelupdate-method-ado.md) сначала.

Для передачи параметров для более одной команды в составной оператор, заполнив коллекцию [параметров](parameters-collection-ado.md) или при передаче массива с исходной **открытой** или **выполнение** вызовов, параметры должны быть в том же порядке, в коллекции или массива как их соответствующих команд в серии команды. Необходимо завершить чтение всех результатов перед чтением данных параметра.

Поставщик OLE DB определяет, когда выполняется на составной оператор команды командной. [Поставщик Microsoft OLE DB для SQL Server](microsoft-ole-db-provider-for-sql-server.md), например, выполняет все команды в пакете при получении составной оператор. При вызове **NextRecordset**просто возвращаются результирующего **набора записей** .

Тем не менее других поставщиков может выполнить следующую команду в операторе только после вызова NextRecordset. Для этих поставщиков Если перед пошаговая инструкция всей команды явно закрыть объекта **набора записей** ADO никогда не выполняет оставшиеся команды.


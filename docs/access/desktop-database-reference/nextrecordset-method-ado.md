---
title: NextRecordset Method (ADO)
TOCTitle: NextRecordset Method (ADO)
ms:assetid: d2776dd5-d521-c57f-dbe5-e02ee238104d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250051(v=office.15)
ms:contentKeyID: 48547887
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: e412fbcb083e4cf5acae363ef05ce11ad9754215
ms.sourcegitcommit: a49b77f4c8cec69f90656a86f0872cf34c35968e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2018
ms.locfileid: "25603401"
---
# <a name="nextrecordset-method-ado"></a><span data-ttu-id="5facc-102">NextRecordset Method (ADO)</span><span class="sxs-lookup"><span data-stu-id="5facc-102">NextRecordset Method (ADO)</span></span>


<span data-ttu-id="5facc-103">**Применимо к**: Access 2013 | Office 2013</span><span class="sxs-lookup"><span data-stu-id="5facc-103">**Applies to**: Access 2013 | Office 2013</span></span>
 

<span data-ttu-id="5facc-104">Удаляет текущий объект [набора записей](recordset-object-ado.md) и возвращает следующего **набора записей** путем перемещения через последовательность команд.</span><span class="sxs-lookup"><span data-stu-id="5facc-104">Clears the current [Recordset](recordset-object-ado.md) object and returns the next **Recordset** by advancing through a series of commands.</span></span>

## <a name="syntax"></a><span data-ttu-id="5facc-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="5facc-105">Syntax</span></span>

<span data-ttu-id="5facc-106">Установка *recordset2* = *recordset1*. NextRecordset (*RecordsAffected* )</span><span class="sxs-lookup"><span data-stu-id="5facc-106">Set *recordset2* = *recordset1*.NextRecordset(*RecordsAffected* )</span></span>

<span data-ttu-id="5facc-107"><<<<<<< HEAD</span><span class="sxs-lookup"><span data-stu-id="5facc-107"><<<<<<< HEAD</span></span>
## <a name="return-value"></a><span data-ttu-id="5facc-108">Возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="5facc-108">Return Value</span></span>
=======
## <a name="return-value"></a><span data-ttu-id="5facc-109">Возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="5facc-109">Return value</span></span>
>>>>>>> <span data-ttu-id="5facc-110">master</span><span class="sxs-lookup"><span data-stu-id="5facc-110">master</span></span>

<span data-ttu-id="5facc-111">Возвращает объект **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="5facc-111">Returns a **Recordset** object.</span></span> <span data-ttu-id="5facc-112">В этой модели синтаксис *recordset1* и *recordset2* может быть один и тот же объект **набора записей** или можно использовать отдельные объекты.</span><span class="sxs-lookup"><span data-stu-id="5facc-112">In the syntax model, *recordset1* and *recordset2* can be the same **Recordset** object, or you can use separate objects.</span></span> <span data-ttu-id="5facc-113">При использовании отдельных объектов **наборов записей** , сброс свойства **ActiveConnection** на исходный **записей** (*recordset1*) после вызова **NextRecordset** приведет к ошибке.</span><span class="sxs-lookup"><span data-stu-id="5facc-113">When using separate **Recordset** objects, resetting the **ActiveConnection** property on the original **Recordset** (*recordset1*) after **NextRecordset** has been called will generate an error.</span></span>

## <a name="parameters"></a><span data-ttu-id="5facc-114">Параметры</span><span class="sxs-lookup"><span data-stu-id="5facc-114">Parameters</span></span>

- <span data-ttu-id="5facc-115">*RecordsAffected*</span><span class="sxs-lookup"><span data-stu-id="5facc-115">*RecordsAffected*</span></span>

- <span data-ttu-id="5facc-116">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="5facc-116">Optional.</span></span> <span data-ttu-id="5facc-117">**Длинные** переменной, в который поставщик возвращает число записей, которое влияет на текущей операции.</span><span class="sxs-lookup"><span data-stu-id="5facc-117">A **Long** variable to which the provider returns the number of records that the current operation affected.</span></span>


> [!NOTE]
> <P><span data-ttu-id="5facc-118">Этот параметр только возвращает число записей, затронутых операцией; Возвращает число записей в инструкции select, используемый для создания <STRONG>записей</STRONG>.</span><span class="sxs-lookup"><span data-stu-id="5facc-118">This parameter only returns the number of records affected by an operation; it does not return a count of records from a select statement used to generate the <STRONG>Recordset</STRONG>.</span></span></P>



## <a name="remarks"></a><span data-ttu-id="5facc-119">Замечания</span><span class="sxs-lookup"><span data-stu-id="5facc-119">Remarks</span></span>

<span data-ttu-id="5facc-120"><<<<<<< HEAD метод **NextRecordset** используется для возвращения результатов следующей команды в операторе составные команду или хранимую процедуру, возвращающую несколько результатов.</span><span class="sxs-lookup"><span data-stu-id="5facc-120"><<<<<<< HEAD Use the **NextRecordset** method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results.</span></span> <span data-ttu-id="5facc-121">При открытии объекта **набора записей** на основе инструкции составные команды (например, «ВЫБЕРИТЕ \* из Таблица1. Выбор \* из таблица2») с помощью метода [Execute](https://msdn.microsoft.com/library/jj248785\(v=office.15\)) на [команду](command-object-ado.md) или метод [Open](open-method-ado-recordset.md) на **набора записей**ADO выполняет только первой команды и возвращает результаты для *набора записей*.</span><span class="sxs-lookup"><span data-stu-id="5facc-121">If you open a **Recordset** object based on a compound command statement (for example, "SELECT \* FROM table1;SELECT \* FROM table2") using the [Execute](https://msdn.microsoft.com/library/jj248785\(v=office.15\)) method on a [Command](command-object-ado.md) or the [Open](open-method-ado-recordset.md) method on a **Recordset**, ADO executes only the first command and returns the results to *recordset*.</span></span> <span data-ttu-id="5facc-122">Чтобы получить доступ к результаты последующих команд в операторе, вызовите метод **NextRecordset** .</span><span class="sxs-lookup"><span data-stu-id="5facc-122">To access the results of subsequent commands in the statement, call the **NextRecordset** method.</span></span>
<span data-ttu-id="5facc-123">=== Используйте метод **NextRecordset** для возврата результатов следующей команды в операторе составные команду или хранимую процедуру, возвращающую несколько результатов.</span><span class="sxs-lookup"><span data-stu-id="5facc-123">======= Use the **NextRecordset** method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results.</span></span> <span data-ttu-id="5facc-124">При открытии объекта **набора записей** на основе инструкции составные команды (например, «ВЫБЕРИТЕ \* из Таблица1. Выбор \* из таблица2») с помощью метода [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) на [команду](command-object-ado.md) или метод [Open](open-method-ado-recordset.md) на **набора записей**ADO выполняет только первой команды и возвращает результаты для *набора записей*.</span><span class="sxs-lookup"><span data-stu-id="5facc-124">If you open a **Recordset** object based on a compound command statement (for example, "SELECT \* FROM table1;SELECT \* FROM table2") using the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method on a [Command](command-object-ado.md) or the [Open](open-method-ado-recordset.md) method on a **Recordset**, ADO executes only the first command and returns the results to *recordset*.</span></span> <span data-ttu-id="5facc-125">Чтобы получить доступ к результаты последующих команд в операторе, вызовите метод **NextRecordset** .</span><span class="sxs-lookup"><span data-stu-id="5facc-125">To access the results of subsequent commands in the statement, call the **NextRecordset** method.</span></span>
>>>>>>> <span data-ttu-id="5facc-126">master</span><span class="sxs-lookup"><span data-stu-id="5facc-126">master</span></span>

<span data-ttu-id="5facc-127">Поскольку существует Дополнительные результаты и **записей** , содержащий составные операторы будет отключен или не переданы через границы процессов, метод **NextRecordset** будет продолжать возвращают объекты **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="5facc-127">As long as there are additional results and the **Recordset** containing the compound statements is not disconnected or marshaled across process boundaries, the **NextRecordset** method will continue to return **Recordset** objects.</span></span> <span data-ttu-id="5facc-128">Если команда возвращает строку выполняется успешно, но не возвращает записи, возвращенного объекта **набора записей** будет открыта, но пуста.</span><span class="sxs-lookup"><span data-stu-id="5facc-128">If a row-returning command executes successfully but returns no records, the returned **Recordset** object will be open but empty.</span></span> <span data-ttu-id="5facc-129">Проверить наличие в этом случае убедитесь, что параметры [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) используются оба **значение True**.</span><span class="sxs-lookup"><span data-stu-id="5facc-129">Test for this case by verifying that the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are both **True**.</span></span> <span data-ttu-id="5facc-130">Если команда не возвращающие – строки выполнена успешно, возвращенного объекта **набора записей** будут закрыты, которой вы можете проверить путем тестирования свойство [State](state-property-ado.md) на **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="5facc-130">If a non–row-returning command executes successfully, the returned **Recordset** object will be closed, which you can verify by testing the [State](state-property-ado.md) property on the **Recordset**.</span></span> <span data-ttu-id="5facc-131">Если нет больше результатов, *записей* будет задано значение *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="5facc-131">When there are no more results, *recordset* will be set to *Nothing*.</span></span>

<span data-ttu-id="5facc-132">Метод **NextRecordset** не доступен на отключенный объект **набора записей** , где [ActiveConnection](activeconnection-property-ado.md) присвоено значение **Nothing** (в Microsoft Visual Basic) или значение NULL (на других языках).</span><span class="sxs-lookup"><span data-stu-id="5facc-132">The **NextRecordset** method is not available on a disconnected **Recordset** object, where [ActiveConnection](activeconnection-property-ado.md) has been set to **Nothing** (in Microsoft Visual Basic) or NULL (in other languages).</span></span>

<span data-ttu-id="5facc-133">Если редактирование выполняется в режиме немедленное обновление, вызов метода **NextRecordset** приводит к ошибке; Вызовите метод [Update](update-method-ado.md) или [CancelUpdate](cancelupdate-method-ado.md) сначала.</span><span class="sxs-lookup"><span data-stu-id="5facc-133">If an edit is in progress while in immediate update mode, calling the **NextRecordset** method generates an error; call the [Update](update-method-ado.md) or [CancelUpdate](cancelupdate-method-ado.md) method first.</span></span>

<span data-ttu-id="5facc-134">Для передачи параметров для более одной команды в составной оператор, заполнив коллекцию [параметров](parameters-collection-ado.md) или при передаче массива с исходной **открытой** или **выполнение** вызовов, параметры должны быть в том же порядке, в коллекции или массива как их соответствующих команд в серии команды.</span><span class="sxs-lookup"><span data-stu-id="5facc-134">To pass parameters for more than one command in the compound statement by filling the [Parameters](parameters-collection-ado.md) collection, or by passing an array with the original **Open** or **Execute** call, the parameters must be in the same order in the collection or array as their respective commands in the command series.</span></span> <span data-ttu-id="5facc-135">Необходимо завершить чтение всех результатов перед чтением данных параметра.</span><span class="sxs-lookup"><span data-stu-id="5facc-135">You must finish reading all the results before reading output parameter values.</span></span>

<span data-ttu-id="5facc-136">Поставщик OLE DB определяет, когда выполняется на составной оператор команды командной.</span><span class="sxs-lookup"><span data-stu-id="5facc-136">Your OLE DB provider determines when each command command in a compound statement is executed.</span></span> <span data-ttu-id="5facc-137">[Поставщик Microsoft OLE DB для SQL Server](microsoft-ole-db-provider-for-sql-server.md), например, выполняет все команды в пакете при получении составной оператор.</span><span class="sxs-lookup"><span data-stu-id="5facc-137">The [Microsoft OLE DB Provider for SQL Server](microsoft-ole-db-provider-for-sql-server.md), for example, executes all commands in a batch upon receiving the compound statement.</span></span> <span data-ttu-id="5facc-138">При вызове **NextRecordset**просто возвращаются результирующего **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="5facc-138">The resulting **Recordsets** are simply returned when you call **NextRecordset**.</span></span>

<span data-ttu-id="5facc-139">Тем не менее других поставщиков может выполнить следующую команду в операторе только после вызова NextRecordset.</span><span class="sxs-lookup"><span data-stu-id="5facc-139">However, other providers may execute the next command in a statement only after NextRecordset is called.</span></span> <span data-ttu-id="5facc-140">Для этих поставщиков Если перед пошаговая инструкция всей команды явно закрыть объекта **набора записей** ADO никогда не выполняет оставшиеся команды.</span><span class="sxs-lookup"><span data-stu-id="5facc-140">For these providers, if you explicitly close the **Recordset** object before stepping through the entire command statement, ADO never executes the remaining commands.</span></span>


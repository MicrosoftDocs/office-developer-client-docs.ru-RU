---
title: Метод NextRecordset (ADO)
TOCTitle: NextRecordset method (ADO)
ms:assetid: d2776dd5-d521-c57f-dbe5-e02ee238104d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250051(v=office.15)
ms:contentKeyID: 48547887
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: b572f4ebe55da1add781ecd86df97937cfeae126
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288619"
---
# <a name="nextrecordset-method-ado"></a><span data-ttu-id="24b19-102">Метод NextRecordset (ADO)</span><span class="sxs-lookup"><span data-stu-id="24b19-102">NextRecordset method (ADO)</span></span>

<span data-ttu-id="24b19-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="24b19-103">**Applies to**: Access 2013, Office 2013</span></span>
 
<span data-ttu-id="24b19-104">Очищает текущий объект [Recordset](recordset-object-ado.md) и возвращает следующий **набор записей,** продвигаясь по ряду команд.</span><span class="sxs-lookup"><span data-stu-id="24b19-104">Clears the current [Recordset](recordset-object-ado.md) object and returns the next **Recordset** by advancing through a series of commands.</span></span>

## <a name="syntax"></a><span data-ttu-id="24b19-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="24b19-105">Syntax</span></span>

<span data-ttu-id="24b19-106">Установите *recordset2*  =  *recordset1*. NextRecordset *(RecordsAffected* )</span><span class="sxs-lookup"><span data-stu-id="24b19-106">Set *recordset2* = *recordset1*.NextRecordset(*RecordsAffected* )</span></span>

## <a name="return-value"></a><span data-ttu-id="24b19-107">Возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="24b19-107">Return value</span></span>

<span data-ttu-id="24b19-108">Возвращает объект **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="24b19-108">Returns a **Recordset** object.</span></span> <span data-ttu-id="24b19-109">В модели синтаксиса *recordset1* и *recordset2* может быть тем же объектом **Recordset** или использовать отдельные объекты.</span><span class="sxs-lookup"><span data-stu-id="24b19-109">In the syntax model, *recordset1* and *recordset2* can be the same **Recordset** object, or you can use separate objects.</span></span> <span data-ttu-id="24b19-110">При использовании отдельных объектов **Recordset** при сбросе свойства **ActiveConnection** в исходном наборе записей *(recordset1)* после того, как был вызван **NextRecordset,** создается ошибка. </span><span class="sxs-lookup"><span data-stu-id="24b19-110">When using separate **Recordset** objects, resetting the **ActiveConnection** property on the original **Recordset** (*recordset1*) after **NextRecordset** has been called will generate an error.</span></span>

## <a name="parameters"></a><span data-ttu-id="24b19-111">Параметры</span><span class="sxs-lookup"><span data-stu-id="24b19-111">Parameters</span></span>

|<span data-ttu-id="24b19-112">Параметр</span><span class="sxs-lookup"><span data-stu-id="24b19-112">Parameter</span></span>|<span data-ttu-id="24b19-113">Описание</span><span class="sxs-lookup"><span data-stu-id="24b19-113">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="24b19-114">*RecordsAffected*</span><span class="sxs-lookup"><span data-stu-id="24b19-114">*RecordsAffected*</span></span> |<span data-ttu-id="24b19-115">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="24b19-115">Optional.</span></span> <span data-ttu-id="24b19-116">**Длинная** переменная, в которую поставщик возвращает количество записей, на которые повлияла текущая операция.</span><span class="sxs-lookup"><span data-stu-id="24b19-116">A **Long** variable to which the provider returns the number of records that the current operation affected.</span></span>|

> [!NOTE]
> <span data-ttu-id="24b19-117">Этот параметр возвращает только количество записей, затронутых операцией; он не возвращает количество записей из выбранного утверждения, используемого для создания **наборов записей.**</span><span class="sxs-lookup"><span data-stu-id="24b19-117">This parameter only returns the number of records affected by an operation; it does not return a count of records from a select statement used to generate the **Recordset**.</span></span>

## <a name="remarks"></a><span data-ttu-id="24b19-118">Примечания</span><span class="sxs-lookup"><span data-stu-id="24b19-118">Remarks</span></span>

<span data-ttu-id="24b19-119">Используйте метод **NextRecordset,** чтобы вернуть результаты следующей команды в сложном командном заявлении или сохраненной процедуре, которая возвращает несколько результатов.</span><span class="sxs-lookup"><span data-stu-id="24b19-119">Use the **NextRecordset** method to return the results of the next command in a compound command statement or of a stored procedure that returns multiple results.</span></span> <span data-ttu-id="24b19-120">Если вы открываете **объект Recordset** на основе сложного командного утверждения (например, "ВЫБЕРИТЕ \* ИЗ таблицы1; ВЫБЕРИТЕ ИЗ таблицы2") с помощью метода Execute в команде или метода Open в \* **recordset,** [](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) ADO [](open-method-ado-recordset.md) выполняет только первую команду и возвращает результаты в *набор записей.* [](command-object-ado.md)</span><span class="sxs-lookup"><span data-stu-id="24b19-120">If you open a **Recordset** object based on a compound command statement (for example, "SELECT \* FROM table1;SELECT \* FROM table2") using the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method on a [Command](command-object-ado.md) or the [Open](open-method-ado-recordset.md) method on a **Recordset**, ADO executes only the first command and returns the results to *recordset*.</span></span> <span data-ttu-id="24b19-121">Чтобы получить доступ к результатам последующих команд в заявлении, позвоните по методу **NextRecordset.**</span><span class="sxs-lookup"><span data-stu-id="24b19-121">To access the results of subsequent commands in the statement, call the **NextRecordset** method.</span></span>

<span data-ttu-id="24b19-122">Пока есть дополнительные результаты, а набор **recordset,** содержащий сложные утверждения, не отключается и не маршалится через границы процессов, метод **NextRecordset** будет возвращать объекты **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="24b19-122">As long as there are additional results and the **Recordset** containing the compound statements is not disconnected or marshaled across process boundaries, the **NextRecordset** method will continue to return **Recordset** objects.</span></span> <span data-ttu-id="24b19-123">Если команда, возвращаемая строками, выполняется успешно, но не возвращает записи, возвращенный объект **Recordset** будет открыт, но пуст.</span><span class="sxs-lookup"><span data-stu-id="24b19-123">If a row-returning command executes successfully but returns no records, the returned **Recordset** object will be open but empty.</span></span> <span data-ttu-id="24b19-124">Проверьте для этого случая, проверяя, что [свойства BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) являются как **True**.</span><span class="sxs-lookup"><span data-stu-id="24b19-124">Test for this case by verifying that the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties are both **True**.</span></span> <span data-ttu-id="24b19-125">Если команда, не возвращаемая строками, выполняется успешно, возвращенный объект **Recordset** будет [](state-property-ado.md) закрыт, что можно проверить, протестив свойство state в **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="24b19-125">If a non–row-returning command executes successfully, the returned **Recordset** object will be closed, which you can verify by testing the [State](state-property-ado.md) property on the **Recordset**.</span></span> <span data-ttu-id="24b19-126">Если результатов больше нет, *набор записей* будет установлен в *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="24b19-126">When there are no more results, *recordset* will be set to *Nothing*.</span></span>

<span data-ttu-id="24b19-127">Метод **NextRecordset** не доступен для отключенного объекта **Recordset,** где [ActiveConnection](activeconnection-property-ado.md) задавалось nothing **(в** Microsoft Visual Basic) или NULL (на других языках).</span><span class="sxs-lookup"><span data-stu-id="24b19-127">The **NextRecordset** method is not available on a disconnected **Recordset** object, where [ActiveConnection](activeconnection-property-ado.md) has been set to **Nothing** (in Microsoft Visual Basic) or NULL (in other languages).</span></span>

<span data-ttu-id="24b19-128">Если изменение продолжается в режиме немедленного обновления, вызов метода **NextRecordset** создает ошибку; сначала вызвать [метод Update](update-method-ado.md) или [CancelUpdate.](cancelupdate-method-ado.md)</span><span class="sxs-lookup"><span data-stu-id="24b19-128">If an edit is in progress while in immediate update mode, calling the **NextRecordset** method generates an error; call the [Update](update-method-ado.md) or [CancelUpdate](cancelupdate-method-ado.md) method first.</span></span>

<span data-ttu-id="24b19-129">Чтобы передать параметры для более чем одной команды [](parameters-collection-ado.md) в составной выписке, заполнив коллекцию Параметры или передав массив с помощью исходного вызова **Open** или **Execute,** параметры должны быть в том же порядке в коллекции или массиве, что и их соответствующие команды в командной серии.</span><span class="sxs-lookup"><span data-stu-id="24b19-129">To pass parameters for more than one command in the compound statement by filling the [Parameters](parameters-collection-ado.md) collection, or by passing an array with the original **Open** or **Execute** call, the parameters must be in the same order in the collection or array as their respective commands in the command series.</span></span> <span data-ttu-id="24b19-130">Необходимо завершить чтение всех результатов перед чтением значений параметров вывода.</span><span class="sxs-lookup"><span data-stu-id="24b19-130">You must finish reading all the results before reading output parameter values.</span></span>

<span data-ttu-id="24b19-131">Поставщик OLE DB определяет, когда выполняется каждая команда в сложном операторе.</span><span class="sxs-lookup"><span data-stu-id="24b19-131">Your OLE DB provider determines when each command command in a compound statement is executed.</span></span> <span data-ttu-id="24b19-132">Поставщик [microsoft OLE DB](microsoft-ole-db-provider-for-sql-server.md)для SQL Server, например, выполняет все команды пакетом после получения сложного оператора.</span><span class="sxs-lookup"><span data-stu-id="24b19-132">The [Microsoft OLE DB Provider for SQL Server](microsoft-ole-db-provider-for-sql-server.md), for example, executes all commands in a batch upon receiving the compound statement.</span></span> <span data-ttu-id="24b19-133">В результате **записи просто** возвращаются при вызове **NextRecordset.**</span><span class="sxs-lookup"><span data-stu-id="24b19-133">The resulting **Recordsets** are simply returned when you call **NextRecordset**.</span></span>

<span data-ttu-id="24b19-134">Однако другие поставщики могут выполнить следующую команду в операторе только после того, как будет вызван NextRecordset.</span><span class="sxs-lookup"><span data-stu-id="24b19-134">However, other providers may execute the next command in a statement only after NextRecordset is called.</span></span> <span data-ttu-id="24b19-135">Для этих поставщиков, если перед выполнением всей командной записи объект **Recordset** явно закрывается, ADO никогда не выполняет оставшиеся команды.</span><span class="sxs-lookup"><span data-stu-id="24b19-135">For these providers, if you explicitly close the **Recordset** object before stepping through the entire command statement, ADO never executes the remaining commands.</span></span>


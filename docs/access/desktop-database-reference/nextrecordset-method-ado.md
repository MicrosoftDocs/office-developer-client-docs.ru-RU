---
title: Метод NextRecordset (ADO)
TOCTitle: NextRecordset method (ADO)
ms:assetid: d2776dd5-d521-c57f-dbe5-e02ee238104d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250051(v=office.15)
ms:contentKeyID: 48547887
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: b572f4ebe55da1add781ecd86df97937cfeae126
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288619"
---
# <a name="nextrecordset-method-ado"></a>Метод NextRecordset (ADO)

**Область применения**: Access 2013, Office 2013
 
Очищает текущий объект [Recordset](recordset-object-ado.md) и возвращает следующий **набор записей** путем перемещения по ряду команд.

## <a name="syntax"></a>Синтаксис

Задайте *recordset2* = *recordset1*. NextRecordset (*рекордсаффектед* )

## <a name="return-value"></a>Возвращаемое значение

Возвращает объект **Recordset** . В модели синтаксиса *recordset1* и *recordset2* могут иметь один и тот же объект **Recordset** , или можно использовать отдельные объекты. При использовании отдельных объектов **Recordset** при сбросе свойства **ActiveConnection** в исходном **наборе записей** (*recordset1*) после вызова **NextRecordset** будет выдаваться сообщение об ошибке.

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*рекордсаффектед* |Необязательное. **Длинная** переменная, с которой поставщик возвращает число записей, на которые влияет текущая операция.|

> [!NOTE]
> Этот параметр возвращает только число записей, затронутых операцией; Он не возвращает количество записей в операторе SELECT, используемом для создания объекта **Recordset**.

## <a name="remarks"></a>Примечания

Используйте метод **NextRecordset** , чтобы возвратить результаты следующей команды в составном операторе команды или сохраненной процедуре, возвращающей несколько результатов. Если открыть объект **Recordset** на основе составного оператора команды (например, "выбрать \* из table1"; SELECT \* from Table2 ") с помощью метода [EXECUTE](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) для [команды](command-object-ado.md) или метода [Open](open-method-ado-recordset.md) в объекте **Recordset**, ADO выполняет только первую команду и возвращает результаты в *набор записей*. Чтобы получить доступ к результатам последующих команд в операторе, вызовите метод **NextRecordset** .

Пока имеются дополнительные результаты, а **набор записей** , содержащий составные операторы, не отключается или маршалируется в пределах границ процесса, метод **NextRecordset** будет продолжать возвращать объекты **Recordset** . Если команда, возвращающая строки, успешно выполняется, но не возвращает ни одной записи, возвращенный объект **Recordset** будет открыт, но пустой. Протестируйте это обращение, убедившись, что свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) имеют **значение true**. При успешном выполнении команды, не являющейся возвратом строки, возвращается объект **Recordset** , который можно проверить, проверив свойство [State](state-property-ado.md) в **наборе записей**. Если больше нет результатов, для параметра *Recordset* будет задано значение *Nothing*.

Метод **NextRecordset** недоступен для отключенного объекта **Recordset** , где [ActiveConnection](activeconnection-property-ado.md) имеет значение **Nothing** (в Microsoft Visual Basic) или null (на других языках).

Если в режиме немедленного обновления выполняется изменение, вызов метода **NextRecordset** приводит к возникновению ошибки; Сначала вызовите метод [Update](update-method-ado.md) или [CancelUpdate](cancelupdate-method-ado.md) .

Чтобы передать параметры для нескольких команд в операторе составного оператора, заполнив коллекцию [Parameters](parameters-collection-ado.md) или передав массив с первоначальным вызовом **Open** или **EXECUTE** , параметры должны находиться в том же порядке в коллекции или массиве, что и соответствующие команды в наборе команд. Прежде чем считывать значения выходных параметров, необходимо завершить чтение всех результатов.

Поставщик OLE DB определяет, когда выполняется команда в составном операторе. Например, [поставщик Microsoft OLE DB для SQL Server](microsoft-ole-db-provider-for-sql-server.md)выполняет все команды в пакете после получения составного оператора. Результирующие **наборы записей** просто возвращаются при вызове **NextRecordset**.

Однако другие поставщики могут выполнять следующую команду в операторе только после вызова NextRecordset. Для этих поставщиков, если вы явно закрываете объект **Recordset** перед заходом всего оператора команды, ADO не выполняет оставшиеся команды.


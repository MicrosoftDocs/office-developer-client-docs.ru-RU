---
title: Макрокоманда GoToControl
TOCTitle: GoToControl macro action
ms:assetid: caff76dc-7ca8-4f87-8144-89445ed4600d
ms:mtpsurl: https://msdn.microsoft.com/library/Ff834370(v=office.15)
ms:contentKeyID: 48547705
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: c056f2b0922402ea7cde7cf767969b73f912f572
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292169"
---
# <a name="gotocontrol-macro-action"></a>Макрокоманда GoToControl

**Область применения**: Access 2013, Office 2013

Чтобы переместить фокус на указанное поле или элемент управления в текущей записи открытой формы, таблицы формы, таблицы или запроса в режиме таблицы, можно использовать макрокоманду **КЭлементуУправления (КЭлементуУправления** ). Эта макрокоманда позволяет переместить фокус на определенное поле или на другой элемент управления. Затем это поле или элемент управления можно использовать для сравнения или макрокоманд **НайтиЗапись** . Кроме того, можно использовать эту макрокоманду для навигации в форме в соответствии с определенными условиями. Например, если пользователь введет "Нет" в элементе управления "Брак" формы медицинского страхования, фокус может сразу автоматически переместиться на элемент управления, следующий за элементом управления "Имя партнера".

## <a name="setting"></a>Параметр

> [!NOTE]
> Это действие недоступно для использования со страницами доступа к данным.

Макрокоманда **GoToControl** имеет указанный ниже аргумент.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Имя элемента управления</strong></p></td>
<td><p>Имя поля или элемента управления, куда необходимо переместить фокус. Введите имя поля или элемента управления в поле <strong>имя элемента</strong> управления в разделе <strong>аргументы макрокоманды</strong> в области построителя макросов. Это обязательный аргумент.</p>
<p><strong>Note</strong>: введите только имя поля или элемента управления в аргументе <strong>имя элемента управления</strong> , а не полный идентификатор, например Forms! Продуктов! [Product ID].</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

Нельзя использовать макрокоманду **КЭлементуУправления** для перемещения фокуса на элемент управления в скрытой форме.

> [!TIP]
> С помощью макрокоманды **КЭлементуУправления** можно перейти к подчиненной форме, которая представляет собой тип элемента управления. Затем можно использовать макрокоманду **GoToRecord (GoToRecord** ) для перехода к определенной записи в подчиненной форме. Вы также можете перейти к элементу управления в подчиненной форме, используя макрокоманду **КЭлементуУправления (КЭлементуУправления** ), чтобы перейти к подчиненной форме, а затем к элементу управления в подчиненной форме.

Чтобы выполнить макрокоманду **КЭлементуУправления** в модуле Visual Basic для приложений (VBA), используйте метод **КЭлементуУправления** объекта **DoCmd** . Кроме того, можно использовать метод **SetFocus** для перемещения фокуса на элемент управления в форме или любой из его подчиненных форм или в поле в таблице в режиме таблицы, запросе или форме.

## <a name="examples"></a>Примеры

**Установка значения элемента управления с помощью макроса**

Следующий макрос открывает форму "Добавить товары" с помощью кнопки в форме "Поставщики". Он демонстрирует применение макрокоманд **ВыводНаЭкран**, **ЗакрытьОкно**, **ОткрытьФорму**, **ЗадатьЗначение** и **КЭлементуУправления**. Действие **SetValue** устанавливает для элемента управления "идентификатор поставщика" в форме "продукты" текущего поставщика в форме "поставщики". После этого действие " **КЭлементуУправления** " переместит фокус на поле "идентификатор категории", в котором можно начать ввод данных для нового продукта. Этот макрос должен быть привязан к кнопке "Добавить товары" в форме "Поставщики".

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Макрокоманда</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Примечание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>ВыводНаЭкран</strong></p></td>
<td><p><strong>Включить вывод</strong>: <strong>Нет</strong></p></td>
<td><p>Приостанавливает обновление экрана, пока выполняется макрос.</p></td>
</tr>
<tr class="even">
<td><p><strong>ЗакрытьОкно</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>FormObject Имя</strong>: Список товаров <strong>Сохранить</strong>: <strong>Нет</strong></p></td>
<td><p>Закройте форму "список товаров".</p></td>
</tr>
<tr class="odd">
<td><p><strong>ОткрытьФорму</strong></p></td>
<td><p><strong>Имя формы</strong>: Товары <strong>Представление</strong>: <strong>FormData Режим</strong>: <strong>AddWindow Режим</strong>: <strong>Обычный</strong></p></td>
<td><p>Открывает форму "Товары".</p></td>
</tr>
<tr class="even">
<td><p><strong>ЗадатьЗначение</strong></p></td>
<td><p><strong>Элемент</strong>: [Forms]![Товары]![КодПоставщика] <strong>Выражение</strong>: КодПоставщика</p></td>
<td><p>В форме Поставщики задайте для элемента управления "идентификатор поставщика" текущего поставщика.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КЭлементуУправления</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: КодКатегории</p></td>
<td><p>Перейдите к элементу управления ИДЕНТИФИКАТОРом категории.</p></td>
</tr>
</tbody>
</table>


**Проверка данных с помощью макроса**

Следующий макрос проверки проверяет почтовые индексы, введенные в форме Поставщики. В нем показано использование действий **Макрокоманда StopMacro**, **MessageBox**, **Макрокоманда CancelEvent**и **КЭлементуУправления** . Условное выражение проверяет страну, регион и почтовый индекс, введенные в записи в форме. Если почтовый индекс находится в неправильном формате для страны или региона, макрос выводит окно сообщения и отменяет сохранение записи. После этого макрос вернется к элементу управления почтового кода, где можно исправить ошибку. Этот макрос необходимо вложить в свойство **BeforeUpdate** формы "поставщики".

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Условие</p></th>
<th><p>Макрокоманда</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Примечание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>IsNull ([страна])</p></td>
<td><p><strong>StopMacro</strong></p></td>
<td><p></p></td>
<td><p>Если страна имеет <strong>значение NULL</strong>, почтовый индекс не может быть проверен.</p></td>
</tr>
<tr class="even">
<td><p>Ватикан В (&quot;Франция&quot;,&quot;Италия&quot;,&quot;Испания&quot;) и len ([почтовый индекс]) &lt; &gt; 5</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение</strong>: длина почтового индекса не должна превышать 5 символов. <strong>Гудок</strong>: <strong>естипе</strong>: <strong>Информатионтитле</strong>: ошибка почтового кода</p></td>
<td><p>Если почтовый индекс не состоит из 5 символов, отобразится сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>CancelEvent</strong></p></td>
<td><p></p></td>
<td><p>Отмена события.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="odd">
<td><p>Ватикан В (&quot;Австралия&quot;,&quot;Сингапур&quot;) и len ([почтовый индекс]) &lt; &gt; 4</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p>Сообщение: почтовый индекс должен иметь 4 символа. <strong>Гудок</strong>: <strong>естипе</strong>: <strong>Информатионтитле</strong>: ошибка почтового кода</p></td>
<td><p>Если почтовый индекс не состоит из 4 символов, отобразится сообщение.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p><strong>CancelEvent</strong></p></td>
<td><p></p></td>
<td><p>Отмена события.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="even">
<td><p>([Страна] = &quot;Канада&quot;) And ([почтовый индекс] не похоже&quot;на [a-z] [0-9] [a-z] [0-9] [a-z] [0-9&quot;])</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение</strong>: недопустимый почтовый индекс. Пример кода канадского канадского: H1J 1C3 <strong>Beep</strong>: <strong>естипе</strong>: <strong>Информатионтитле</strong>: ошибка почтового кода</p></td>
<td><p>Если почтовый индекс неправилен для Канады, отобразите сообщение. (Пример канадского кода: H1J 1C3)</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>CancelEvent</strong></p></td>
<td><p></p></td>
<td><p>Отмена события.</p></td>
</tr>
</tbody>
</table>


---
title: Макрокоманда GoToControl
TOCTitle: GoToControl macro action
ms:assetid: caff76dc-7ca8-4f87-8144-89445ed4600d
ms:mtpsurl: https://msdn.microsoft.com/library/Ff834370(v=office.15)
ms:contentKeyID: 48547705
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 9fafa3ea40b492baf8b49dd240c6f7767ffad655
ms.sourcegitcommit: d7248f803002b31cf7fc561b03530199a9b0a8fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2018
ms.locfileid: "25926656"
---
# <a name="gotocontrol-macro-action"></a>Макрокоманда GoToControl


**Применимо к**: Access 2013, Office 2013



Можно использовать **КЭлементуУправления** для перемещения фокуса указанного поля или элемента управления в записи текущей открытой формы, формы, таблицы или запроса таблицы данных. Эта макрокоманда позволяет переместить фокус на определенное поле или на другой элемент управления. В этом поле или элемент управления затем используется для сравнения или **НайтиЗапись** действий. Кроме того, можно использовать эту макрокоманду для навигации в форме в соответствии с определенными условиями. Например, если пользователь введет "Нет" в элементе управления "Брак" формы медицинского страхования, фокус может сразу автоматически переместиться на элемент управления, следующий за элементом управления "Имя партнера".

## <a name="setting"></a>Параметр


> [!NOTE]
> <P>Это действие недоступно для использования с страницы доступа к данным.</P>



Макрокоманда **GoToControl** имеет указанный ниже аргумент.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Имя элемента управления</strong></p></td>
<td><p>Имя поля или элемента управления, куда необходимо переместить фокус. Введите имя элемента управления или поля в поле <strong>Имя элемента управления</strong> в разделе <strong>Действие аргументы</strong> в области построения макросов. Обязательный аргумент.</p>

> [!NOTE]
> <P>Введите только имя поля или элемента управления в качестве аргумента <STRONG>Имя элемента управления</STRONG> , не полный идентификатор, такие как Forms! Продукты! [Код продукта].</P>


<p></p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

**КЭлементуУправления** нельзя использовать для перемещения фокуса на элемент управления на форме скрытые.


> [!TIP]
> <P><STRONG>КЭлементуУправления</STRONG> можно использовать для перемещения подчиненной формы, который является элементом управления. Затем можно использовать действие <STRONG>НаЗапись</STRONG> для перехода к конкретной записи подчиненной формы. Вы также можете переместить на элемент управления подчиненной формы с помощью <STRONG>КЭлементуУправления</STRONG> для перемещения сначала к подчиненной формы, а затем в элемент управления подчиненной формы.</P>



Чтобы запустить **КЭлементуУправления** в Visual Basic для приложений (VBA) модуль, используйте метод **КЭлементуУправления** **объекта** . Можно также использовать метод **SetFocus** для перемещения фокуса на элемент управления в форме или в подчиненной или к полю открыть таблицу, запроса или формы.

## <a name="examples"></a>Примеры

**Задайте значение элемента управления с помощью макроса**

Следующий макрос открывает форму добавления продуктов с помощью кнопки на форме Поставщики. Демонстрируется использование **эхо**, **CloseWindow**, **ОткрытьФорму**, **SetValue**и **КЭлементуУправления** действий. Действие **SetValue** задает код поставщика управления на форме продуктов для текущего поставщика в форме Поставщики. **Затем КЭлементуУправления** перемещает фокус в поле Идентификатор категории, где можно вводить данные для нового продукта. Этот макрос должен быть связан с кнопкой Добавить продукты в форме Поставщики.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Действие</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Эхо</strong></p></td>
<td><p><strong>Вывод на экран</strong>: <strong>Нет</strong></p></td>
<td><p>Остановите обновление экрана в процессе выполнения макроса.</p></td>
</tr>
<tr class="even">
<td><p><strong>CloseWindow</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>FormObject имя</strong>: продукт списка <strong>Сохранить</strong>: <strong>Нет</strong></p></td>
<td><p>Закрыть форму списка продуктов.</p></td>
</tr>
<tr class="odd">
<td><p><strong>ОткрытьФорму</strong></p></td>
<td><p><strong>Имя формы</strong>: продуктов <strong>представления</strong>: <strong>FormData режима</strong>: <strong>Режим AddWindow</strong>: <strong>Обычный</strong></p></td>
<td><p>Откройте форму продуктов.</p></td>
</tr>
<tr class="even">
<td><p><strong>SetValue</strong></p></td>
<td><p><strong>Элемент</strong>: [формы]! [Товары]! [Код поставщика] <strong>Выражение</strong>: КодПоставщика</p></td>
<td><p>Значение текущего поставщика управления код поставщика в форме Поставщики.</p></td>
</tr>
<tr class="odd">
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: идентификатор категории</p></td>
<td><p>Перейдите к элементу управления идентификатор категории.</p></td>
</tr>
</tbody>
</table>


**Проверка данных с помощью макроса (en)**

Следующий макрос для проверки проверяет почтовые индексы, введенные в форме Поставщики. Демонстрируется использование **ОстановитьМакрос**, **MessageBox**, **ОтменитьСобытие**и **КЭлементуУправления** действия. Условным выражением проверяет страны или региона и почтового индекса в записи на форме. Если почтовый индекс не в нужном формате для страны или региона, макрос отображается окно сообщения и показано, как отменить сохранение записи. Макрос будет снова к элементу управления почтовый индекс для исправления ошибки. Этот макрос должен быть связан свойством **BeforeUpdate** формы Поставщики.

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Condition</p></th>
<th><p>Действие</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>IsNull([CountryRegion])</p></td>
<td><p><strong>StopMacro</strong></p></td>
<td><p></p></td>
<td><p>Если Страна имеет <strong>значение Null</strong>, почтовый индекс не может быть проверен.</p></td>
</tr>
<tr class="even">
<td><p>[Страна] В (&quot;Франции&quot;,&quot;Италия&quot;,&quot;Испания&quot;) и Len ([Почтовый индекс]) &lt; &gt; 5</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение</strong>: почтовый индекс должен состоять из 5 знаков. <strong>Звуковые сигналы</strong>: <strong>YesType</strong>: <strong>InformationTitle</strong>: ошибка почтовый индекс</p></td>
<td><p>Если почтовый индекс не 5 знаков, отображать сообщение.</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>ОтменитьСобытие</strong></p></td>
<td><p></p></td>
<td><p>Отмените событие.</p></td>
</tr>
<tr class="even">
<td><p></p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="odd">
<td><p>[Страна] В (&quot;Австралия&quot;,&quot;Сингапур&quot;) и Len ([Почтовый индекс]) &lt; &gt; 4</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p>Сообщение об ошибке: Почтовый индекс должен быть 4 символов. <strong>Звуковые сигналы</strong>: <strong>YesType</strong>: <strong>InformationTitle</strong>: ошибка почтовый индекс</p></td>
<td><p>Если почтовый индекс не 4 символа, отображать сообщение.</p></td>
</tr>
<tr class="even">
<td><p>...</p></td>
<td><p><strong>ОтменитьСобытие</strong></p></td>
<td><p></p></td>
<td><p>Отмените событие.</p></td>
</tr>
<tr class="odd">
<td><p></p></td>
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: PostalCode</p></td>
<td><p></p></td>
</tr>
<tr class="even">
<td><p>([Страна] = &quot;Канада&quot;) И ([Почтовый индекс] не нравится&quot;[A-Z] [0-9] [A-Z] [0-9] [A-Z] [0-9]&quot;)</p></td>
<td><p><strong>MessageBox</strong></p></td>
<td><p><strong>Сообщение</strong>: почтовый индекс является недопустимым. Пример кода, английский (Канада): H1J 1 c 3 <strong>звуковые сигналы</strong>: <strong>YesType</strong>: <strong>InformationTitle</strong>: почтовый код ошибки</p></td>
<td><p>Если почтовый индекс не подходит для Канады, отображать сообщение. (Пример кода, английский (Канада): H1J 1 c 3)</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p><strong>ОтменитьСобытие</strong></p></td>
<td><p></p></td>
<td><p>Отмените событие.</p></td>
</tr>
</tbody>
</table>


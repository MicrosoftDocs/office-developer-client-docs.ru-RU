---
title: Метод Workspace. Rollback (DAO)
TOCTitle: Rollback Method
ms:assetid: 10775fcc-7db2-9e14-5625-048db5c50466
ms:mtpsurl: https://msdn.microsoft.com/library/Ff845335(v=office.15)
ms:contentKeyID: 48543294
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 377d122821dc95b275c28ecab420748c3d120e0f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32302445"
---
# <a name="workspacerollback-method-dao"></a>Метод Workspace. Rollback (DAO)

**Область применения**: Access 2013, Office 2013

Завершает текущую транзакцию и восстанавливает базы данных в объекте **Workspace** в том состоянии, в котором они были в момент начала текущей транзакции.

## <a name="syntax"></a>Синтаксис

*Expression* . Отката

*expression*: переменная, представляющая объект **Workspace**.

## <a name="remarks"></a>Примечания

Методы транзакции **BeginTrans**, **CommitTrans**и **ROLLBACK** управляют обработкой транзакций во время сеанса, определенного объектом **Workspace** . Эти методы используются вместе с объектом **Workspace** , когда необходимо обрабатывать серию изменений, внесенных в базы данных в сеансе, как единое целое.

Как правило, транзакции используются для поддержания целостности данных, когда необходимо обновить записи в двух или более таблицах и убедиться в том, что изменения выполнены (зафиксированы) во всех таблицах или нет (выполняется откат). Например, если вы переносите деньги из одной учетной записи в другую, вы можете вычесть сумму из единицы и добавить сумму в другую. Если обновление завершается сбоем, учетные записи больше не сбалансированы. Используйте метод **BeginTrans** перед обновлением первой записи, а затем, если при последующих обновлениях происходит сбой, можно использовать метод **ROLLBACK** для отмены всех обновлений. Используйте метод **CommitTrans** после успешного обновления последней записи.

> [!NOTE]
> В пределах одного объекта **Workspace** транзакции всегда являются глобальными для **рабочей области** и не ограничиваются одним **подключением** или объектом **Database** . Если вы выполняете операции над несколькими подключениями или базами данных в транзакции **рабочей области** , разрешение транзакции (то есть с помощью метода **CommitTrans** или **ROLLBACK** ) влияет на все операции всех подключений и баз данных в этой рабочей области.

Если вы используете **CommitTrans**, вы не сможете отменить изменения, внесенные во время этой транзакции, пока транзакция не будет вложена в другую транзакцию, которая откатывается обратно. При вложении транзакций необходимо разрешить текущую транзакцию, прежде чем можно будет разрешить транзакцию на более высоком уровне вложения.

Если требуется одновременные транзакции с перекрывающимися невложенными областями, можно создать дополнительные объекты **рабочей области** , которые будут содержать параллельные транзакции.

Если закрыть объект **Workspace** , не разрешающий все ожидающие транзакции, выполняется автоматический откат транзакций.

Если вы используете метод **CommitTrans** или **ROLLBACK** без предварительного использования метода **BeginTrans** , возникнет ошибка.

Некоторые базы данных ISAM, используемые в рабочей области Microsoft Access, могут не поддерживать транзакции, в этом случае свойство **Transactions** объекта **базы данных** или объекта **Recordset** имеет **значение false**. Чтобы убедиться, что база данных поддерживает транзакции, проверьте значение свойства **Transactions** объекта **Database** , прежде чем использовать метод **BeginTrans** . Если вы используете объект **Recordset** на основе нескольких баз данных, проверьте свойство **Transactions** объекта **Recordset** . Если **набор записей** полностью основан на таблицах ядра СУБД Microsoft Access, всегда можно использовать транзакции. Однако объекты **Recordset** , основанные на таблицах, созданных другими продуктами баз данных, могут не поддерживать транзакции. Например, нельзя использовать транзакции в **наборе записей** , основанном на таблице Paradox. В этом случае свойство **Transactions** имеет **значение false**. Если **база данных** или **набор записей** не поддерживают транзакции, методы игнорируются, и ошибка не возникает.

Нельзя вкладывать транзакции, если доступ к источникам данных ODBC осуществляется с помощью ядра СУБД Microsoft Access.

В рабочих областях ODBC при использовании **CommitTrans** курсор может стать недействительным. Используйте метод **Requery** для просмотра изменений в **наборе записей**, а также для закрытия и повторного открытия объекта **Recordset**.

- Вы часто можете увеличить производительность приложения, разбив операции, требующие доступа к диску, в блоки транзакций. Это приводит к буферизации операций и значительно сокращает количество обращений к диску.

- В рабочей области Microsoft Access транзакции записываются в файл, сохраненный в каталоге, указанном в переменной среды TEMP на рабочей станции. Если файл журнала транзакций исчерпал Доступное хранилище на диске TEMP, ядро СУБД запускает ошибку во время выполнения. На этом шаге при использовании **CommitTrans**зафиксировано неопределенное количество операций, но оставшиеся незавершенные операции теряются и операция должна быть перезапущена. Использование метода **отката** освобождает журнал транзакций и выполняет откат всех операций в транзакции.

- Закрытие **набора записей** клонирования в ожидающей транзакции приводит к неявной операции **отката** .


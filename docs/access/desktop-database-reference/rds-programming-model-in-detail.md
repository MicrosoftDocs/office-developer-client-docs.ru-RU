---
title: Подробные сведения о модели программирования RDS
TOCTitle: RDS programming model in detail
ms:assetid: 133fc059-9b51-52e2-2e61-339716d8d965
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248906(v=office.15)
ms:contentKeyID: 48543364
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 4a2312be682ee63368397109377690b6dde3e627
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300870"
---
# <a name="rds-programming-model-in-detail"></a><span data-ttu-id="0dcab-102">Подробные сведения о модели программирования RDS</span><span class="sxs-lookup"><span data-stu-id="0dcab-102">RDS programming model in detail</span></span>

<span data-ttu-id="0dcab-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="0dcab-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="0dcab-104">Ниже приведены ключевые элементы модели программирования RDS:</span><span class="sxs-lookup"><span data-stu-id="0dcab-104">The following are key elements of the RDS programming model:</span></span>

- <span data-ttu-id="0dcab-105">Рабочих. DataSpace</span><span class="sxs-lookup"><span data-stu-id="0dcab-105">RDS.DataSpace</span></span>
- <span data-ttu-id="0dcab-106">Рдссервер. факт.</span><span class="sxs-lookup"><span data-stu-id="0dcab-106">RDSServer.DataFactory</span></span>
- <span data-ttu-id="0dcab-107">Рабочих. DataControl</span><span class="sxs-lookup"><span data-stu-id="0dcab-107">RDS.DataControl</span></span>
- <span data-ttu-id="0dcab-108">Событие</span><span class="sxs-lookup"><span data-stu-id="0dcab-108">Event</span></span>

## <a name="rdsdataspace"></a><span data-ttu-id="0dcab-109">Рабочих. DataSpace</span><span class="sxs-lookup"><span data-stu-id="0dcab-109">RDS.DataSpace</span></span>

<span data-ttu-id="0dcab-110">Клиентское приложение должно указать сервер и программу сервера, которые необходимо вызвать.</span><span class="sxs-lookup"><span data-stu-id="0dcab-110">Your client application must specify the server and the server program to invoke.</span></span> <span data-ttu-id="0dcab-111">В случае возврата приложение получает ссылку на серверную программу и может рассматривать ссылку так, как если бы она была серверной программой.</span><span class="sxs-lookup"><span data-stu-id="0dcab-111">In return, your application receives a reference to the server program and can treat the reference as if it were the server program itself.</span></span>

<span data-ttu-id="0dcab-112">Объектная модель RDS ембодиес эту функцию с помощью [RDS. Объект Space](dataspace-object-rds.md) .</span><span class="sxs-lookup"><span data-stu-id="0dcab-112">The RDS object model embodies this functionality with the [RDS.DataSpace](dataspace-object-rds.md) object.</span></span>

<span data-ttu-id="0dcab-113">Серверная программа указывается с помощью идентификатора программы или *ProgID*.</span><span class="sxs-lookup"><span data-stu-id="0dcab-113">The server program is specified with a program identifier, or *ProgID*.</span></span> <span data-ttu-id="0dcab-114">Сервер использует *ProgID* и реестр компьютера сервера для обнаружения сведений о фактической программе, которую необходимо инициировать.</span><span class="sxs-lookup"><span data-stu-id="0dcab-114">The server uses the *ProgID* and the server machine's registry to locate information about the actual program to initiate.</span></span>

<span data-ttu-id="0dcab-115">Служба RDS обеспечивает внутреннее различие в зависимости от того, находится ли серверная программа на удаленном сервере через Интернет или интрасеть; сервер в локальной сети; на сервере, но вместо этого в локальной библиотеке динамической компоновки (DLL).</span><span class="sxs-lookup"><span data-stu-id="0dcab-115">RDS makes a distinction internally depending on whether the server program is on a remote server across the Internet or an intranet; a server on a local area network; or not on a server at all, but instead on a local dynamic-link library (DLL).</span></span> <span data-ttu-id="0dcab-116">Это различие определяет, как обмен данными осуществляется между клиентом и сервером, и становится нематериальным различием в типе ссылок, возвращаемых в клиентское приложение.</span><span class="sxs-lookup"><span data-stu-id="0dcab-116">This distinction determines how information is exchanged between the client and the server, and makes a tangible difference in the type of reference returned to your client application.</span></span> <span data-ttu-id="0dcab-117">Однако с точки зрения это отличие не имеет особого смысла.</span><span class="sxs-lookup"><span data-stu-id="0dcab-117">However, from your point of view, this distinction has no special meaning.</span></span> <span data-ttu-id="0dcab-118">Все, что имеет значение, это то, что вы получаете пригодную к использованию ссылку на программу.</span><span class="sxs-lookup"><span data-stu-id="0dcab-118">All that matters is that you receive a usable program reference.</span></span>

## <a name="rdsserverdatafactory"></a><span data-ttu-id="0dcab-119">Рдссервер. факт.</span><span class="sxs-lookup"><span data-stu-id="0dcab-119">RDSServer.DataFactory</span></span>

<span data-ttu-id="0dcab-120">RDS предоставляет серверную программу по умолчанию, которая может выполнять запрос SQL для источника данных и возвращать объект [Recordset](recordset-object-ado.md) или принимать объект **Recordset** и обновлять источник данных.</span><span class="sxs-lookup"><span data-stu-id="0dcab-120">RDS provides a default server program that can either perform a SQL query against the data source and return a [Recordset](recordset-object-ado.md) object or take a **Recordset** object and update the data source.</span></span>

<span data-ttu-id="0dcab-121">Объектная модель RDS ембодиес эту функцию с помощью объекта [рдссервер.](datafactory-object-rdsserver.md) DataObject.</span><span class="sxs-lookup"><span data-stu-id="0dcab-121">The RDS object model embodies this functionality with the [RDSServer.DataFactory](datafactory-object-rdsserver.md) object.</span></span>

<span data-ttu-id="0dcab-122">Кроме того, этот объект содержит метод для создания пустого объекта **Recordset** , который можно заполнить программным способом ([CreateRecordset](createrecordset-method-rds.md)), а другой метод преобразования объекта **Recordset** в текстовую строку для создания веб-страницы ([ ConvertToString](converttostring-method-rds.md)).</span><span class="sxs-lookup"><span data-stu-id="0dcab-122">In addition, this object has a method for creating an empty **Recordset** object that you can fill programmatically ([CreateRecordset](createrecordset-method-rds.md)), and another method for converting a **Recordset** object into a text string to build a webpage ([ConvertToString](converttostring-method-rds.md)).</span></span>

<span data-ttu-id="0dcab-123">С помощью ADO можно переопределить некоторые стандартные поведение подключения и команды для объекта **рдссервер.** с помощью обработчика фактов и \*\*\*\* файла настройки, содержащего параметры подключения, команды и безопасности.</span><span class="sxs-lookup"><span data-stu-id="0dcab-123">With ADO, you can override some of the standard connection and command behavior of the **RDSServer.DataFactory** with a **DataFactory** handler and a customization file that contains connection, command, and security parameters.</span></span>

<span data-ttu-id="0dcab-124">Серверная программа иногда называется *бизнес-объектом*.</span><span class="sxs-lookup"><span data-stu-id="0dcab-124">The server program is sometimes called a *business object*.</span></span> <span data-ttu-id="0dcab-125">Вы можете написать собственный настраиваемый бизнес-объект, который может выполнять сложные операции доступа к данным, проверки допустимости и т. д.</span><span class="sxs-lookup"><span data-stu-id="0dcab-125">You can write your own custom business object that can perform complicated data access, validity checks, and so on.</span></span> <span data-ttu-id="0dcab-126">Даже при написании настраиваемого бизнес-объекта можно создать экземпляр объекта **рдссервер.** DataObject и использовать некоторые его методы для выполнения собственных задач.</span><span class="sxs-lookup"><span data-stu-id="0dcab-126">Even when writing a custom business object, you can create an instance of an **RDSServer.DataFactory** object and use some of its methods to accomplish your own tasks.</span></span>

## <a name="rdsdatacontrol"></a><span data-ttu-id="0dcab-127">Рабочих. DataControl</span><span class="sxs-lookup"><span data-stu-id="0dcab-127">RDS.DataControl</span></span>

<span data-ttu-id="0dcab-128">RDS предоставляет средства для объединения функциональных возможностей **RDS. Пространство** данных и **рдссервер.** DataObject, а также включение визуальных элементов управления для простого использования объекта **Recordset** , возвращенного запросом из источника данных.</span><span class="sxs-lookup"><span data-stu-id="0dcab-128">RDS provides a means to combine the functionality of the **RDS.DataSpace** and **RDSServer.DataFactory**, and also enable visual controls to easily use the **Recordset** object returned by a query from a data source.</span></span> <span data-ttu-id="0dcab-129">В большинстве случаев RDS предпринимает попытки автоматически получить доступ к данным на сервере и отображать их в визуальном элементе управления.</span><span class="sxs-lookup"><span data-stu-id="0dcab-129">RDS attempts, for the most common case, to do as much as possible to automatically gain access to information on a server and display it in a visual control.</span></span>

<span data-ttu-id="0dcab-130">Объектная модель RDS ембодиес эту функцию с помощью [RDS. Объект управления](datacontrol-object-rds.md) DataObject.</span><span class="sxs-lookup"><span data-stu-id="0dcab-130">The RDS object model embodies this functionality with the [RDS.DataControl](datacontrol-object-rds.md) object.</span></span>

<span data-ttu-id="0dcab-131">**RDS. У элемента управления** с двумя аспектами.</span><span class="sxs-lookup"><span data-stu-id="0dcab-131">The **RDS.DataControl** has two aspects.</span></span> <span data-ttu-id="0dcab-132">Один аспект относится к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="0dcab-132">One aspect pertains to the data source.</span></span> <span data-ttu-id="0dcab-133">Если вы задаете команду и сведения о подключении, используя свойства **Connect** и **SQL** объекта **RDS. Элемент управления**, он автоматически будет использовать **RDS. Пространство** для создания ссылки на объект **рдссервер.** DataObject, используемый по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0dcab-133">If you set the command and connection information using the **Connect** and **SQL** properties of the **RDS.DataControl**, it will automatically use the **RDS.DataSpace** to create a reference to the default **RDSServer.DataFactory** object.</span></span> <span data-ttu-id="0dcab-134">Затем объект **рдссервер.** DataObject будет использовать значение свойства **Connect** для подключения к источнику данных, использовать значение свойства **SQL** для получения **набора записей** из источника данных и возврата объекта **Recordset** в **RDS. . Элемент управления**.</span><span class="sxs-lookup"><span data-stu-id="0dcab-134">Then the **RDSServer.DataFactory** will use the **Connect** property value to connect to the data source, use the **SQL** property value to obtain a **Recordset** from the data source, and return the **Recordset** object to the **RDS.DataControl**.</span></span>

<span data-ttu-id="0dcab-135">Второй аспект относится к отображению возвращаемых сведений о **наборе записей** в визуальном элементе управления.</span><span class="sxs-lookup"><span data-stu-id="0dcab-135">The second aspect pertains to the display of returned **Recordset** information in a visual control.</span></span> <span data-ttu-id="0dcab-136">Вы можете связать визуальный элемент управления с элементом **ActiveX RDS. Элемент управления** данными (в процессе, называемый привязкой) и доступ к сведениям в связанном объекте **Recordset** с отображением результатов запроса на веб-странице в Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="0dcab-136">You can associate a visual control with the **RDS.DataControl** (in a process called binding) and gain access to the information in the associated **Recordset** object, displaying query results on a webpage in Microsoft Internet Explorer.</span></span> <span data-ttu-id="0dcab-137">Каждой **RDS. Элемент управления** DataObject связывает один объект **Recordset** , представляющий результаты одного запроса, с одним или несколькими визуальными элементами управления (например, текстовым полем, полем со списком, элементом управления Grid и т. д.).</span><span class="sxs-lookup"><span data-stu-id="0dcab-137">Each **RDS.DataControl** object binds one **Recordset** object, representing the results of a single query, to one or more visual controls (for example, a text box, combo box, grid control, and so forth).</span></span> <span data-ttu-id="0dcab-138">Может быть несколько **RDS. Объект управления** DataObject на каждой странице.</span><span class="sxs-lookup"><span data-stu-id="0dcab-138">There may be more than one **RDS.DataControl** object on each page.</span></span> <span data-ttu-id="0dcab-139">Каждой **RDS. Объект элемента управления** данными может быть подключен к другому источнику данных и содержать результаты отдельного запроса.</span><span class="sxs-lookup"><span data-stu-id="0dcab-139">Each **RDS.DataControl** object can be connected to a different data source and contain the results of a separate query.</span></span>

<span data-ttu-id="0dcab-140">\*\*RDS. \*\*Объект данных также имеет собственные методы для навигации, сортировки и фильтрации строк связанного объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0dcab-140">The **RDS.DataControl** object also has its own methods for navigating, sorting, and filtering the rows of the associated **Recordset** object.</span></span> <span data-ttu-id="0dcab-141">Эти методы аналогичны, но не совпадают с методами объекта **Recordset** объекта ADO.</span><span class="sxs-lookup"><span data-stu-id="0dcab-141">These methods are similar, but not the same as the methods on the ADO **Recordset** object.</span></span>

## <a name="events"></a><span data-ttu-id="0dcab-142">События</span><span class="sxs-lookup"><span data-stu-id="0dcab-142">Events</span></span>

<span data-ttu-id="0dcab-143">RDS поддерживает два собственных события, которые не зависят от модели событий ADO.</span><span class="sxs-lookup"><span data-stu-id="0dcab-143">RDS supports two of its own events, which are independent of the ADO event model.</span></span> <span data-ttu-id="0dcab-144">Событие [онреадистатечанже](onreadystatechange-event-rds.md) вызывается всякий раз, когда элемент **ActiveX RDS. Свойство ReadyState элемента управления для элемента управления** [](readystate-property-rds.md) , уведомляя о том, что асинхронная операция успешно завершена, прервана или возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="0dcab-144">The [onReadyStateChange](onreadystatechange-event-rds.md) event is called whenever the **RDS.DataControl** [ReadyState](readystate-property-rds.md) property changes, thus notifying you when an asynchronous operation has successfully completed, terminated, or experienced an error.</span></span> <span data-ttu-id="0dcab-145">Событие [OnError](onerror-event-rds.md) вызывается при возникновении ошибки, даже если ошибка возникает во время асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="0dcab-145">The [onError](onerror-event-rds.md) event is called whenever an error occurs, even if the error occurs during an asynchronous operation.</span></span>

> [!NOTE]
> <span data-ttu-id="0dcab-146">Microsoft Internet Explorer предоставляет два дополнительных события для RDS — **ондатасетчанжед** ( **набор записей** работает, но по-прежнему получает строки) и **ондатасеткомплете** (объект **Recordset** завершил извлечение строк).</span><span class="sxs-lookup"><span data-stu-id="0dcab-146">Microsoft Internet Explorer provides two additional events to RDS — **onDataSetChanged** (the **Recordset** is functional but still retrieving rows) and **onDataSetComplete** (the **Recordset** has finished retrieving rows).</span></span>



---
title: Подробные сведения о модели программирования RDS
TOCTitle: RDS programming model in detail
ms:assetid: 133fc059-9b51-52e2-2e61-339716d8d965
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248906(v=office.15)
ms:contentKeyID: 48543364
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 4a2312be682ee63368397109377690b6dde3e627
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300870"
---
# <a name="rds-programming-model-in-detail"></a><span data-ttu-id="1fd21-102">Подробные сведения о модели программирования RDS</span><span class="sxs-lookup"><span data-stu-id="1fd21-102">RDS programming model in detail</span></span>

<span data-ttu-id="1fd21-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="1fd21-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="1fd21-104">Ниже ключевых элементов модели программирования RDS:</span><span class="sxs-lookup"><span data-stu-id="1fd21-104">The following are key elements of the RDS programming model:</span></span>

- <span data-ttu-id="1fd21-105">RDS. DataSpace</span><span class="sxs-lookup"><span data-stu-id="1fd21-105">RDS.DataSpace</span></span>
- <span data-ttu-id="1fd21-106">RDSServer.DataFactory</span><span class="sxs-lookup"><span data-stu-id="1fd21-106">RDSServer.DataFactory</span></span>
- <span data-ttu-id="1fd21-107">RDS. DataControl</span><span class="sxs-lookup"><span data-stu-id="1fd21-107">RDS.DataControl</span></span>
- <span data-ttu-id="1fd21-108">Событие</span><span class="sxs-lookup"><span data-stu-id="1fd21-108">Event</span></span>

## <a name="rdsdataspace"></a><span data-ttu-id="1fd21-109">RDS. DataSpace</span><span class="sxs-lookup"><span data-stu-id="1fd21-109">RDS.DataSpace</span></span>

<span data-ttu-id="1fd21-110">Клиентские приложения должны указывать сервер и серверную программу для вызова.</span><span class="sxs-lookup"><span data-stu-id="1fd21-110">Your client application must specify the server and the server program to invoke.</span></span> <span data-ttu-id="1fd21-111">В ответ приложение получает ссылку на серверную программу и может рассматривать ссылку так, как если бы она была самой серверной программой.</span><span class="sxs-lookup"><span data-stu-id="1fd21-111">In return, your application receives a reference to the server program and can treat the reference as if it were the server program itself.</span></span>

<span data-ttu-id="1fd21-112">Объектная модель RDS олицетворяет эту функциональность с [RDS. Объект DataSpace.](dataspace-object-rds.md)</span><span class="sxs-lookup"><span data-stu-id="1fd21-112">The RDS object model embodies this functionality with the [RDS.DataSpace](dataspace-object-rds.md) object.</span></span>

<span data-ttu-id="1fd21-113">Серверная программа указывается с идентификатором программы или *программным идентификатором.*</span><span class="sxs-lookup"><span data-stu-id="1fd21-113">The server program is specified with a program identifier, or *ProgID*.</span></span> <span data-ttu-id="1fd21-114">Сервер использует *программный ИД* и реестр сервера для поиска сведений о фактической программе, которую необходимо инициировать.</span><span class="sxs-lookup"><span data-stu-id="1fd21-114">The server uses the *ProgID* and the server machine's registry to locate information about the actual program to initiate.</span></span>

<span data-ttu-id="1fd21-115">RDS делает внутреннее различие в зависимости от того, находится ли серверная программа на удаленном сервере в Интернете или интрасети; сервер в локальной сети; или вообще не на сервере, а в локальной библиотеке динамической ссылки (DLL).</span><span class="sxs-lookup"><span data-stu-id="1fd21-115">RDS makes a distinction internally depending on whether the server program is on a remote server across the Internet or an intranet; a server on a local area network; or not on a server at all, but instead on a local dynamic-link library (DLL).</span></span> <span data-ttu-id="1fd21-116">Это различие определяет обмен информацией между клиентом и сервером и существенно меняет тип ссылки, возвращаемой в клиентские приложения.</span><span class="sxs-lookup"><span data-stu-id="1fd21-116">This distinction determines how information is exchanged between the client and the server, and makes a tangible difference in the type of reference returned to your client application.</span></span> <span data-ttu-id="1fd21-117">Однако с вашей точки зрения это различие не имеет особого значения.</span><span class="sxs-lookup"><span data-stu-id="1fd21-117">However, from your point of view, this distinction has no special meaning.</span></span> <span data-ttu-id="1fd21-118">Все, что важно, это то, что вы получаете ссылку на программу.</span><span class="sxs-lookup"><span data-stu-id="1fd21-118">All that matters is that you receive a usable program reference.</span></span>

## <a name="rdsserverdatafactory"></a><span data-ttu-id="1fd21-119">RDSServer.DataFactory</span><span class="sxs-lookup"><span data-stu-id="1fd21-119">RDSServer.DataFactory</span></span>

<span data-ttu-id="1fd21-120">RDS предоставляет серверную программу по умолчанию, которая может выполнять запрос SQL к источнику данных и возвращать объект [Recordset](recordset-object-ado.md) или принимать объект **Recordset** и обновлять источник данных.</span><span class="sxs-lookup"><span data-stu-id="1fd21-120">RDS provides a default server program that can either perform a SQL query against the data source and return a [Recordset](recordset-object-ado.md) object or take a **Recordset** object and update the data source.</span></span>

<span data-ttu-id="1fd21-121">Объектная модель RDS олицетворяет эту функциональность с помощью объекта [RDSServer.DataFactory.](datafactory-object-rdsserver.md)</span><span class="sxs-lookup"><span data-stu-id="1fd21-121">The RDS object model embodies this functionality with the [RDSServer.DataFactory](datafactory-object-rdsserver.md) object.</span></span>

<span data-ttu-id="1fd21-122">Кроме того, этот объект имеет метод для создания пустого объекта **Recordset,** который можно заполнить программным способом ([CreateRecordset),](createrecordset-method-rds.md)и другой метод для преобразования объекта **Recordset** в текстовую строку для создания веб-страницы ([ConvertToString](converttostring-method-rds.md)).</span><span class="sxs-lookup"><span data-stu-id="1fd21-122">In addition, this object has a method for creating an empty **Recordset** object that you can fill programmatically ([CreateRecordset](createrecordset-method-rds.md)), and another method for converting a **Recordset** object into a text string to build a webpage ([ConvertToString](converttostring-method-rds.md)).</span></span>

<span data-ttu-id="1fd21-123">С помощью ADO можно переопременить некоторые стандартные действия подключения и команды **RDSServer.DataFactory** с помощью обработчика **DataFactory** и файла настройки, который содержит параметры подключения, команды и безопасности.</span><span class="sxs-lookup"><span data-stu-id="1fd21-123">With ADO, you can override some of the standard connection and command behavior of the **RDSServer.DataFactory** with a **DataFactory** handler and a customization file that contains connection, command, and security parameters.</span></span>

<span data-ttu-id="1fd21-124">Серверная программа иногда называется *бизнес-объектом.*</span><span class="sxs-lookup"><span data-stu-id="1fd21-124">The server program is sometimes called a *business object*.</span></span> <span data-ttu-id="1fd21-125">Вы можете написать собственный бизнес-объект, который может выполнять сложные проверки доступа к данным, проверки действительности и так далее.</span><span class="sxs-lookup"><span data-stu-id="1fd21-125">You can write your own custom business object that can perform complicated data access, validity checks, and so on.</span></span> <span data-ttu-id="1fd21-126">Даже при написании настраиваемого бизнес-объекта можно создать экземпляр объекта **RDSServer.DataFactory** и использовать некоторые из его методов для выполнения собственных задач.</span><span class="sxs-lookup"><span data-stu-id="1fd21-126">Even when writing a custom business object, you can create an instance of an **RDSServer.DataFactory** object and use some of its methods to accomplish your own tasks.</span></span>

## <a name="rdsdatacontrol"></a><span data-ttu-id="1fd21-127">RDS. DataControl</span><span class="sxs-lookup"><span data-stu-id="1fd21-127">RDS.DataControl</span></span>

<span data-ttu-id="1fd21-128">RDS предоставляет средства для объединения функций **RDS. DataSpace** и **RDSServer.DataFactory,** а также позволяют визуальным средствам управления легко использовать объект **Recordset,** возвращенный запросом из источника данных.</span><span class="sxs-lookup"><span data-stu-id="1fd21-128">RDS provides a means to combine the functionality of the **RDS.DataSpace** and **RDSServer.DataFactory**, and also enable visual controls to easily use the **Recordset** object returned by a query from a data source.</span></span> <span data-ttu-id="1fd21-129">RDS пытается сделать как можно больше, чтобы автоматически получить доступ к информации на сервере и отобразить ее в визуальном контроле.</span><span class="sxs-lookup"><span data-stu-id="1fd21-129">RDS attempts, for the most common case, to do as much as possible to automatically gain access to information on a server and display it in a visual control.</span></span>

<span data-ttu-id="1fd21-130">Объектная модель RDS олицетворяет эту функциональность с [RDS. Объект DataControl.](datacontrol-object-rds.md)</span><span class="sxs-lookup"><span data-stu-id="1fd21-130">The RDS object model embodies this functionality with the [RDS.DataControl](datacontrol-object-rds.md) object.</span></span>

<span data-ttu-id="1fd21-131">The **RDS. DataControl** имеет два аспекта.</span><span class="sxs-lookup"><span data-stu-id="1fd21-131">The **RDS.DataControl** has two aspects.</span></span> <span data-ttu-id="1fd21-132">Один аспект относится к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="1fd21-132">One aspect pertains to the data source.</span></span> <span data-ttu-id="1fd21-133">Если заданы сведения о  команде и подключении с SQL connect **и** SQL **RDS. DataControl,** он будет автоматически использовать **RDS. DataSpace** для создания ссылки на объект **RDSServer.DataFactory** по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1fd21-133">If you set the command and connection information using the **Connect** and **SQL** properties of the **RDS.DataControl**, it will automatically use the **RDS.DataSpace** to create a reference to the default **RDSServer.DataFactory** object.</span></span> <span data-ttu-id="1fd21-134">Затем **RDSServer.DataFactory** будет использовать значение свойства **Connect** для подключения к источнику данных, использовать значение свойства **SQL** для получения объекта **Recordset** из источника данных и возврата объекта **Recordset** в **RDS. DataControl**.</span><span class="sxs-lookup"><span data-stu-id="1fd21-134">Then the **RDSServer.DataFactory** will use the **Connect** property value to connect to the data source, use the **SQL** property value to obtain a **Recordset** from the data source, and return the **Recordset** object to the **RDS.DataControl**.</span></span>

<span data-ttu-id="1fd21-135">Второй аспект относится к отобралю возвращенных сведений **о** наборе записей в визуальном контроле.</span><span class="sxs-lookup"><span data-stu-id="1fd21-135">The second aspect pertains to the display of returned **Recordset** information in a visual control.</span></span> <span data-ttu-id="1fd21-136">Визуальный контроль можно связать с **RDS. DataControl** (в процессе, называемом привязкой) и получение доступа к сведениям в связанном объекте **Recordset,** отображая результаты запроса на веб-странице в Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="1fd21-136">You can associate a visual control with the **RDS.DataControl** (in a process called binding) and gain access to the information in the associated **Recordset** object, displaying query results on a webpage in Microsoft Internet Explorer.</span></span> <span data-ttu-id="1fd21-137">Все **RDS. Объект DataControl** привязывает один объект Recordset, представляющий результаты одного запроса, к одному или более визуальным средствам управления (например, текстовом поле, поле со **combo,** элементом управления сеткой и так далее).</span><span class="sxs-lookup"><span data-stu-id="1fd21-137">Each **RDS.DataControl** object binds one **Recordset** object, representing the results of a single query, to one or more visual controls (for example, a text box, combo box, grid control, and so forth).</span></span> <span data-ttu-id="1fd21-138">Может быть несколько **RDS. Объект DataControl** на каждой странице.</span><span class="sxs-lookup"><span data-stu-id="1fd21-138">There may be more than one **RDS.DataControl** object on each page.</span></span> <span data-ttu-id="1fd21-139">Все **RDS. Объект DataControl** можно подключать к другому источнику данных и содержать результаты отдельного запроса.</span><span class="sxs-lookup"><span data-stu-id="1fd21-139">Each **RDS.DataControl** object can be connected to a different data source and contain the results of a separate query.</span></span>

<span data-ttu-id="1fd21-140">The **RDS. У объекта DataControl** также есть собственные методы для навигации, сортировки и фильтрации строк связанного **объекта Recordset.**</span><span class="sxs-lookup"><span data-stu-id="1fd21-140">The **RDS.DataControl** object also has its own methods for navigating, sorting, and filtering the rows of the associated **Recordset** object.</span></span> <span data-ttu-id="1fd21-141">Эти методы похожи, но не такие же, как методы в объекте ADO **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="1fd21-141">These methods are similar, but not the same as the methods on the ADO **Recordset** object.</span></span>

## <a name="events"></a><span data-ttu-id="1fd21-142">События</span><span class="sxs-lookup"><span data-stu-id="1fd21-142">Events</span></span>

<span data-ttu-id="1fd21-143">RDS поддерживает два собственных события, которые не зависят от модели событий ADO.</span><span class="sxs-lookup"><span data-stu-id="1fd21-143">RDS supports two of its own events, which are independent of the ADO event model.</span></span> <span data-ttu-id="1fd21-144">Событие [onReadyStateChange](onreadystatechange-event-rds.md) вызвано каждый раз, когда **RDS. Свойство DataControl** [ReadyState](readystate-property-rds.md) изменяется, таким образом уведомляя вас об успешном завершении асинхронной операции, ее завершении или ошибке.</span><span class="sxs-lookup"><span data-stu-id="1fd21-144">The [onReadyStateChange](onreadystatechange-event-rds.md) event is called whenever the **RDS.DataControl** [ReadyState](readystate-property-rds.md) property changes, thus notifying you when an asynchronous operation has successfully completed, terminated, or experienced an error.</span></span> <span data-ttu-id="1fd21-145">Событие [onError](onerror-event-rds.md) возникает при любой ошибке, даже если она возникает во время асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="1fd21-145">The [onError](onerror-event-rds.md) event is called whenever an error occurs, even if the error occurs during an asynchronous operation.</span></span>

> [!NOTE]
> <span data-ttu-id="1fd21-146">Microsoft Internet Explorer предоставляет RDS два дополнительных события: **onDataSetChanged** (набор **recordset** работает, но по-прежнему искомые строки) и **onDataSetComplete** **(набор Recordset** завершил искомые строки).</span><span class="sxs-lookup"><span data-stu-id="1fd21-146">Microsoft Internet Explorer provides two additional events to RDS — **onDataSetChanged** (the **Recordset** is functional but still retrieving rows) and **onDataSetComplete** (the **Recordset** has finished retrieving rows).</span></span>



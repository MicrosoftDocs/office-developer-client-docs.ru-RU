---
title: Подробные сведения о модели программирования RDS
TOCTitle: RDS programming model in detail
ms:assetid: 133fc059-9b51-52e2-2e61-339716d8d965
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248906(v=office.15)
ms:contentKeyID: 48543364
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 4a2312be682ee63368397109377690b6dde3e627
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32300870"
---
# <a name="rds-programming-model-in-detail"></a><span data-ttu-id="76ee4-102">Подробные сведения о модели программирования RDS</span><span class="sxs-lookup"><span data-stu-id="76ee4-102">RDS programming model in detail</span></span>

<span data-ttu-id="76ee4-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="76ee4-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="76ee4-104">Ниже ключевых элементов модели программирования RDS:</span><span class="sxs-lookup"><span data-stu-id="76ee4-104">The following are key elements of the RDS programming model:</span></span>

- <span data-ttu-id="76ee4-105">RDS. DataSpace</span><span class="sxs-lookup"><span data-stu-id="76ee4-105">RDS.DataSpace</span></span>
- <span data-ttu-id="76ee4-106">RDSServer.DataFactory</span><span class="sxs-lookup"><span data-stu-id="76ee4-106">RDSServer.DataFactory</span></span>
- <span data-ttu-id="76ee4-107">RDS. DataControl</span><span class="sxs-lookup"><span data-stu-id="76ee4-107">RDS.DataControl</span></span>
- <span data-ttu-id="76ee4-108">Событие</span><span class="sxs-lookup"><span data-stu-id="76ee4-108">Event</span></span>

## <a name="rdsdataspace"></a><span data-ttu-id="76ee4-109">RDS. DataSpace</span><span class="sxs-lookup"><span data-stu-id="76ee4-109">RDS.DataSpace</span></span>

<span data-ttu-id="76ee4-110">Клиентская программа должна указать сервер и серверную программу для вызова.</span><span class="sxs-lookup"><span data-stu-id="76ee4-110">Your client application must specify the server and the server program to invoke.</span></span> <span data-ttu-id="76ee4-111">Взамен приложение получает ссылку на серверную программу и может относиться к ссылке так, как если бы это была сама серверная программа.</span><span class="sxs-lookup"><span data-stu-id="76ee4-111">In return, your application receives a reference to the server program and can treat the reference as if it were the server program itself.</span></span>

<span data-ttu-id="76ee4-112">Объектная модель RDS воплощает эту функцию в [RDS. Объект DataSpace.](dataspace-object-rds.md)</span><span class="sxs-lookup"><span data-stu-id="76ee4-112">The RDS object model embodies this functionality with the [RDS.DataSpace](dataspace-object-rds.md) object.</span></span>

<span data-ttu-id="76ee4-113">Серверная программа указывается идентификатором программы или *ProgID.*</span><span class="sxs-lookup"><span data-stu-id="76ee4-113">The server program is specified with a program identifier, or *ProgID*.</span></span> <span data-ttu-id="76ee4-114">Сервер использует *реестр ProgID* и серверной машины для поиска сведений о фактической программе для инициации.</span><span class="sxs-lookup"><span data-stu-id="76ee4-114">The server uses the *ProgID* and the server machine's registry to locate information about the actual program to initiate.</span></span>

<span data-ttu-id="76ee4-115">RDS проводит внутреннее различие в зависимости от того, находится ли серверная программа на удаленном сервере через Интернет или интрасети; сервер в локальной сети; или вообще не на сервере, а в локальной библиотеке динамических ссылок (DLL).</span><span class="sxs-lookup"><span data-stu-id="76ee4-115">RDS makes a distinction internally depending on whether the server program is on a remote server across the Internet or an intranet; a server on a local area network; or not on a server at all, but instead on a local dynamic-link library (DLL).</span></span> <span data-ttu-id="76ee4-116">Это различие определяет обмен информацией между клиентом и сервером и существенно меняет тип ссылок, возвращаемых в клиентские приложения.</span><span class="sxs-lookup"><span data-stu-id="76ee4-116">This distinction determines how information is exchanged between the client and the server, and makes a tangible difference in the type of reference returned to your client application.</span></span> <span data-ttu-id="76ee4-117">Однако, с вашей точки зрения, это различие не имеет особого значения.</span><span class="sxs-lookup"><span data-stu-id="76ee4-117">However, from your point of view, this distinction has no special meaning.</span></span> <span data-ttu-id="76ee4-118">Важно только то, что вы получаете ссылку на программу.</span><span class="sxs-lookup"><span data-stu-id="76ee4-118">All that matters is that you receive a usable program reference.</span></span>

## <a name="rdsserverdatafactory"></a><span data-ttu-id="76ee4-119">RDSServer.DataFactory</span><span class="sxs-lookup"><span data-stu-id="76ee4-119">RDSServer.DataFactory</span></span>

<span data-ttu-id="76ee4-120">RDS предоставляет серверную программу по умолчанию, которая может выполнять SQL запроса к источнику данных и возвращать объект [Recordset](recordset-object-ado.md) или принимать объект **Recordset** и обновлять источник данных.</span><span class="sxs-lookup"><span data-stu-id="76ee4-120">RDS provides a default server program that can either perform a SQL query against the data source and return a [Recordset](recordset-object-ado.md) object or take a **Recordset** object and update the data source.</span></span>

<span data-ttu-id="76ee4-121">Объектная модель RDS воплощает эту функцию в [объекте RDSServer.DataFactory.](datafactory-object-rdsserver.md)</span><span class="sxs-lookup"><span data-stu-id="76ee4-121">The RDS object model embodies this functionality with the [RDSServer.DataFactory](datafactory-object-rdsserver.md) object.</span></span>

<span data-ttu-id="76ee4-122">Кроме того, этот объект имеет метод создания пустого объекта **Recordset,** который можно заполнить программным способом [(CreateRecordset),](createrecordset-method-rds.md)а также другой метод преобразования объекта **Recordset** в текстовую строку для создания веб-страницы [(ConvertToString).](converttostring-method-rds.md)</span><span class="sxs-lookup"><span data-stu-id="76ee4-122">In addition, this object has a method for creating an empty **Recordset** object that you can fill programmatically ([CreateRecordset](createrecordset-method-rds.md)), and another method for converting a **Recordset** object into a text string to build a webpage ([ConvertToString](converttostring-method-rds.md)).</span></span>

<span data-ttu-id="76ee4-123">С помощью ADO можно переопременить некоторые стандартные параметры подключения и команды **RDSServer.DataFactory** с обработчиком **DataFactory** и файлом настройки, который содержит параметры подключения, команды и безопасности.</span><span class="sxs-lookup"><span data-stu-id="76ee4-123">With ADO, you can override some of the standard connection and command behavior of the **RDSServer.DataFactory** with a **DataFactory** handler and a customization file that contains connection, command, and security parameters.</span></span>

<span data-ttu-id="76ee4-124">Программа сервера иногда называется *бизнес-объектом.*</span><span class="sxs-lookup"><span data-stu-id="76ee4-124">The server program is sometimes called a *business object*.</span></span> <span data-ttu-id="76ee4-125">Вы можете написать собственный настраиваемый бизнес-объект, который может выполнять сложный доступ к данным, проверку подлинности и так далее.</span><span class="sxs-lookup"><span data-stu-id="76ee4-125">You can write your own custom business object that can perform complicated data access, validity checks, and so on.</span></span> <span data-ttu-id="76ee4-126">Даже при написании настраиваемого бизнес-объекта можно создать экземпляр объекта **RDSServer.DataFactory** и использовать некоторые из его методов для выполнения собственных задач.</span><span class="sxs-lookup"><span data-stu-id="76ee4-126">Even when writing a custom business object, you can create an instance of an **RDSServer.DataFactory** object and use some of its methods to accomplish your own tasks.</span></span>

## <a name="rdsdatacontrol"></a><span data-ttu-id="76ee4-127">RDS. DataControl</span><span class="sxs-lookup"><span data-stu-id="76ee4-127">RDS.DataControl</span></span>

<span data-ttu-id="76ee4-128">RDS предоставляет средство для объединения функций **RDS. DataSpace** и **RDSServer.DataFactory,** а также включить визуальные элементы управления для легкого использования объекта **Recordset,** возвращаемого запросом из источника данных.</span><span class="sxs-lookup"><span data-stu-id="76ee4-128">RDS provides a means to combine the functionality of the **RDS.DataSpace** and **RDSServer.DataFactory**, and also enable visual controls to easily use the **Recordset** object returned by a query from a data source.</span></span> <span data-ttu-id="76ee4-129">В наиболее частом случае RDS пытается сделать как можно больше, чтобы автоматически получить доступ к информации на сервере и отобразить ее в визуальном контроле.</span><span class="sxs-lookup"><span data-stu-id="76ee4-129">RDS attempts, for the most common case, to do as much as possible to automatically gain access to information on a server and display it in a visual control.</span></span>

<span data-ttu-id="76ee4-130">Объектная модель RDS воплощает эту функцию в [RDS. Объект DataControl.](datacontrol-object-rds.md)</span><span class="sxs-lookup"><span data-stu-id="76ee4-130">The RDS object model embodies this functionality with the [RDS.DataControl](datacontrol-object-rds.md) object.</span></span>

<span data-ttu-id="76ee4-131">The **RDS. DataControl** имеет два аспекта.</span><span class="sxs-lookup"><span data-stu-id="76ee4-131">The **RDS.DataControl** has two aspects.</span></span> <span data-ttu-id="76ee4-132">Один аспект относится к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="76ee4-132">One aspect pertains to the data source.</span></span> <span data-ttu-id="76ee4-133">Если задать команду и  сведения о подключении с Подключение **SQL** **свойствами RDS. DataControl** автоматически использует **RDS. DataSpace** для создания ссылки на объект **RDSServer.DataFactory** по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="76ee4-133">If you set the command and connection information using the **Connect** and **SQL** properties of the **RDS.DataControl**, it will automatically use the **RDS.DataSpace** to create a reference to the default **RDSServer.DataFactory** object.</span></span> <span data-ttu-id="76ee4-134">Затем **RDSServer.DataFactory** будет использовать значение свойства **Подключение** для подключения к источнику данных, использовать значение  свойства SQL для получения наборов записей из источника данных и возвращения объекта **Recordset** в  **RDS. DataControl**.</span><span class="sxs-lookup"><span data-stu-id="76ee4-134">Then the **RDSServer.DataFactory** will use the **Connect** property value to connect to the data source, use the **SQL** property value to obtain a **Recordset** from the data source, and return the **Recordset** object to the **RDS.DataControl**.</span></span>

<span data-ttu-id="76ee4-135">Второй аспект касается отображения возвращаемой информации **Recordset** в визуальном контроле.</span><span class="sxs-lookup"><span data-stu-id="76ee4-135">The second aspect pertains to the display of returned **Recordset** information in a visual control.</span></span> <span data-ttu-id="76ee4-136">Визуальное управление можно связать с **RDS. DataControl** (в процессе, называемом привязкой) и получение доступа к сведениям в связанном объекте **Recordset,** отображая результаты запроса на веб-странице в Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="76ee4-136">You can associate a visual control with the **RDS.DataControl** (in a process called binding) and gain access to the information in the associated **Recordset** object, displaying query results on a webpage in Microsoft Internet Explorer.</span></span> <span data-ttu-id="76ee4-137">Каждый **RDS. Объект DataControl** связывает один объект **Recordset,** представляющий результаты одного запроса, с одним или более визуальными средствами управления (например, текстовым полем, комбо-полем, управлением сеткой и так далее).</span><span class="sxs-lookup"><span data-stu-id="76ee4-137">Each **RDS.DataControl** object binds one **Recordset** object, representing the results of a single query, to one or more visual controls (for example, a text box, combo box, grid control, and so forth).</span></span> <span data-ttu-id="76ee4-138">Может быть несколько **RDS. Объект DataControl** на каждой странице.</span><span class="sxs-lookup"><span data-stu-id="76ee4-138">There may be more than one **RDS.DataControl** object on each page.</span></span> <span data-ttu-id="76ee4-139">Каждый **RDS. Объект DataControl** можно подключать к другому источнику данных и содержать результаты отдельного запроса.</span><span class="sxs-lookup"><span data-stu-id="76ee4-139">Each **RDS.DataControl** object can be connected to a different data source and contain the results of a separate query.</span></span>

<span data-ttu-id="76ee4-140">The **RDS. Объект DataControl** также имеет собственные методы навигации, сортировки и фильтрации строк связанного объекта **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="76ee4-140">The **RDS.DataControl** object also has its own methods for navigating, sorting, and filtering the rows of the associated **Recordset** object.</span></span> <span data-ttu-id="76ee4-141">Эти методы похожи, но не такие же, как методы на объекте ADO **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="76ee4-141">These methods are similar, but not the same as the methods on the ADO **Recordset** object.</span></span>

## <a name="events"></a><span data-ttu-id="76ee4-142">События</span><span class="sxs-lookup"><span data-stu-id="76ee4-142">Events</span></span>

<span data-ttu-id="76ee4-143">RDS поддерживает два собственных события, которые не зависят от модели событий ADO.</span><span class="sxs-lookup"><span data-stu-id="76ee4-143">RDS supports two of its own events, which are independent of the ADO event model.</span></span> <span data-ttu-id="76ee4-144">Событие [onReadyStateChange](onreadystatechange-event-rds.md) называется всякий раз, когда **происходит RDS. Свойство DataControl** [ReadyState](readystate-property-rds.md) изменяется, уведомляя, таким образом, о том, что асинхронная операция успешно завершилась, завершилась или произошла ошибка.</span><span class="sxs-lookup"><span data-stu-id="76ee4-144">The [onReadyStateChange](onreadystatechange-event-rds.md) event is called whenever the **RDS.DataControl** [ReadyState](readystate-property-rds.md) property changes, thus notifying you when an asynchronous operation has successfully completed, terminated, or experienced an error.</span></span> <span data-ttu-id="76ee4-145">Событие [onError](onerror-event-rds.md) называется всякий раз, когда возникает ошибка, даже если ошибка возникает во время асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="76ee4-145">The [onError](onerror-event-rds.md) event is called whenever an error occurs, even if the error occurs during an asynchronous operation.</span></span>

> [!NOTE]
> <span data-ttu-id="76ee4-146">Microsoft Internet Explorer предоставляет RDS два дополнительных события : **onDataSetChanged** (набор **recordset** является функциональным, но все еще продолжает поиск строк) и **onDataSetComplete** (recordset завершила поиск строк). </span><span class="sxs-lookup"><span data-stu-id="76ee4-146">Microsoft Internet Explorer provides two additional events to RDS — **onDataSetChanged** (the **Recordset** is functional but still retrieving rows) and **onDataSetComplete** (the **Recordset** has finished retrieving rows).</span></span>



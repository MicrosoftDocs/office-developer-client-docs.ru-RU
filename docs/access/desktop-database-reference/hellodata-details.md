---
title: Сведения о HelloData (Справочник по для настольных баз данных Access)
TOCTitle: HelloData Details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: c25197f0a8a45487f93f56543f73a2beeea062ff
ms.sourcegitcommit: a49b77f4c8cec69f90656a86f0872cf34c35968e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2018
ms.locfileid: "25603157"
---
# <a name="hellodata-details"></a><span data-ttu-id="09194-102">HelloData Details</span><span class="sxs-lookup"><span data-stu-id="09194-102">HelloData Details</span></span>


<span data-ttu-id="09194-103">**Применимо к**: Access 2013 | Office 2013</span><span class="sxs-lookup"><span data-stu-id="09194-103">**Applies to**: Access 2013 | Office 2013</span></span>

<span data-ttu-id="09194-104">Приложение HelloData проходит через базовых операций типичное приложение ADO: начало, проверки, изменение и обновление данных.</span><span class="sxs-lookup"><span data-stu-id="09194-104">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data.</span></span> <span data-ttu-id="09194-105">При запуске приложения, щелкните первую кнопку **Получить данные**.</span><span class="sxs-lookup"><span data-stu-id="09194-105">When you start the application, click the first button, **Get Data**.</span></span> <span data-ttu-id="09194-106">Будет запущен подпрограмму GetData().</span><span class="sxs-lookup"><span data-stu-id="09194-106">This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="09194-107">GetData</span><span class="sxs-lookup"><span data-stu-id="09194-107">GetData</span></span>

<span data-ttu-id="09194-108">GetData помещает это допустимая строка подключения в переменной уровня модуля *m\_sConnStr*.</span><span class="sxs-lookup"><span data-stu-id="09194-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="09194-109">Дополнительные сведения о строках подключения к [Строке подключения](creating-the-connection-string.md)см.</span><span class="sxs-lookup"><span data-stu-id="09194-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="09194-110">Назначьте обработчик ошибок с помощью оператора Visual Basic **OnError** .</span><span class="sxs-lookup"><span data-stu-id="09194-110">Assign an error handler using a Visual Basic **OnError** statement.</span></span> <span data-ttu-id="09194-111">Дополнительные сведения об обработке ошибок в ADO можно [Глава 6: обработки ошибок](chapter-6-error-handling.md).</span><span class="sxs-lookup"><span data-stu-id="09194-111">For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md).</span></span> <span data-ttu-id="09194-112">Создается новый объект **подключения** , а свойство **CursorLocation** имеет значение **adUseClient** , так как HelloData создается *отключен набора записей*.</span><span class="sxs-lookup"><span data-stu-id="09194-112">A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*.</span></span> <span data-ttu-id="09194-113">Это означает, что после получило данных из источника данных физическое соединение с источником данных будет отключена, но пользователь может работать с данными, которые кэшированы локально в объекта **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="09194-113">This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="09194-114">После открытия подключения присвойте переменной (sSQL) строки SQL.</span><span class="sxs-lookup"><span data-stu-id="09194-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="09194-115">Затем создайте экземпляр объекта **набора записей** , m\_oRecordset1.</span><span class="sxs-lookup"><span data-stu-id="09194-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="09194-116">В следующей строке кода откройте через существующие **подключения**, передав в **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="09194-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="09194-117">В следующей строке кода откройте **записей** через существующие **подключения**, передав sSQL в качестве источника **записей**.</span><span class="sxs-lookup"><span data-stu-id="09194-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="09194-118">ADO помочь в создании определение, что строка SQL, переданной в качестве источника для **набора записей** — текстовое определение команды, передав **adCmdText** в последний аргумент методу **записей** **Open** .</span><span class="sxs-lookup"><span data-stu-id="09194-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="09194-119">Эта строка также задает **LockType для** и **CursorType** связана с **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="09194-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="09194-120"><<<<<<< HEAD следующая строка кода задает свойство **MarshalOptions** равно **adMarshalModifiedOnly**.</span><span class="sxs-lookup"><span data-stu-id="09194-120"><<<<<<< HEAD The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="09194-121">**MarshalOptions** указывает, какие записи маршалинга средний уровень (или веб-сервера).</span><span class="sxs-lookup"><span data-stu-id="09194-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or Web server).</span></span> <span data-ttu-id="09194-122">Дополнительные сведения о маршалинга COM см.</span><span class="sxs-lookup"><span data-stu-id="09194-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="09194-123">При использовании **adMarshalModifiedOnly** с курсором со стороны клиента ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), только записи, которые были изменены в клиенте записываются на среднем уровне.</span><span class="sxs-lookup"><span data-stu-id="09194-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="09194-124">Установка **MarshalOptions** для **adMarshalModifiedOnly** могут улучшить производительность, так как упаковать меньшее число строк.</span><span class="sxs-lookup"><span data-stu-id="09194-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>
<span data-ttu-id="09194-125">=== Следующая строка кода задает свойство **MarshalOptions** равно **adMarshalModifiedOnly**.</span><span class="sxs-lookup"><span data-stu-id="09194-125">======= The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="09194-126">**MarshalOptions** указывает, какие записи маршалинга средний уровень (или веб-сервера).</span><span class="sxs-lookup"><span data-stu-id="09194-126">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="09194-127">Дополнительные сведения о маршалинга COM см.</span><span class="sxs-lookup"><span data-stu-id="09194-127">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="09194-128">При использовании **adMarshalModifiedOnly** с курсором со стороны клиента ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), только записи, которые были изменены в клиенте записываются на среднем уровне.</span><span class="sxs-lookup"><span data-stu-id="09194-128">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="09194-129">Установка **MarshalOptions** для **adMarshalModifiedOnly** могут улучшить производительность, так как упаковать меньшее число строк.</span><span class="sxs-lookup"><span data-stu-id="09194-129">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>
>>>>>>> <span data-ttu-id="09194-130">master</span><span class="sxs-lookup"><span data-stu-id="09194-130">master</span></span>

<span data-ttu-id="09194-131">Затем отключите **записей** путем установки свойства **ActiveConnection** равна **Nothing**.</span><span class="sxs-lookup"><span data-stu-id="09194-131">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**.</span></span> <span data-ttu-id="09194-132">Для получения дополнительных сведений см [Disconnecting и повторного подключения набора записей](disconnecting-and-reconnecting-the-recordset.md) в главе 5: обновления и сохранение данных.</span><span class="sxs-lookup"><span data-stu-id="09194-132">For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="09194-133">Закройте подключение к источнику данных и удалите существующий объект **подключения** , тем самым освобождения ресурсов, которые его использования.</span><span class="sxs-lookup"><span data-stu-id="09194-133">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="09194-134">— Это последний этап установки **набора записей** как **источник данных** для элемента управления сетки с привязкой к данным Microsoft в форме, то можно легко отобразить данные из **записей** в форме.</span><span class="sxs-lookup"><span data-stu-id="09194-134">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="09194-135">Щелкните вторую кнопку **Проверки данных**.</span><span class="sxs-lookup"><span data-stu-id="09194-135">Click the second button, **Examine Data**.</span></span> <span data-ttu-id="09194-136">Это запускает подпрограмму ExamineData.</span><span class="sxs-lookup"><span data-stu-id="09194-136">This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="09194-137">ExamineData</span><span class="sxs-lookup"><span data-stu-id="09194-137">ExamineData</span></span>

<span data-ttu-id="09194-138">ExamineData использует различные методы и свойства объекта **набора записей** для отображения сведений о данных в **набор записей**.</span><span class="sxs-lookup"><span data-stu-id="09194-138">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span></span> <span data-ttu-id="09194-139">Число записей его отчетов с помощью свойства **RecordCount** .</span><span class="sxs-lookup"><span data-stu-id="09194-139">It reports the number of records by using the **RecordCount** property.</span></span> <span data-ttu-id="09194-140">Он циклически просматривает **записей** и печатает значение свойства **AbsolutePosition** в текстовом поле отображаемое в форме.</span><span class="sxs-lookup"><span data-stu-id="09194-140">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span></span> <span data-ttu-id="09194-141">Также в цикл, значение свойства **закладку** для третьего записи помещаются в переменную типа variant, *vBookmark*, для дальнейшего использования.</span><span class="sxs-lookup"><span data-stu-id="09194-141">Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="09194-142">Процедура непосредственно переходит обратно на третий записи, с помощью переменной закладку, сохраненную ранее.</span><span class="sxs-lookup"><span data-stu-id="09194-142">The routine navigates directly back to the third record using the bookmark variable that it stored earlier.</span></span> <span data-ttu-id="09194-143">Процедура вызывает подпрограмму WalkFields, который перебирает коллекцию **полей** **набора записей** и отображает сведения о каждом **поле** в коллекции.</span><span class="sxs-lookup"><span data-stu-id="09194-143">The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="09194-144">И, наконец ExamineData использует свойство **фильтра** набора **записей** на экран только тех записей со идентификатор категории, равным 2.</span><span class="sxs-lookup"><span data-stu-id="09194-144">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2.</span></span> <span data-ttu-id="09194-145">Результат применения этот фильтр видимым в отображение сетки на форме.</span><span class="sxs-lookup"><span data-stu-id="09194-145">The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="09194-146">Дополнительные сведения о функциях, приведенные в подпрограмму ExamineData можно [Глава 3: проверка данных](chapter-3-examining-data.md).</span><span class="sxs-lookup"><span data-stu-id="09194-146">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="09194-147">Выберите третья кнопка **Изменить данные**.</span><span class="sxs-lookup"><span data-stu-id="09194-147">Next, click the third button, **Edit Data**.</span></span> <span data-ttu-id="09194-148">Будет запущен подпрограмму EditData.</span><span class="sxs-lookup"><span data-stu-id="09194-148">This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="09194-149">EditData</span><span class="sxs-lookup"><span data-stu-id="09194-149">EditData</span></span>

<span data-ttu-id="09194-150">Когда код переходит в подпрограмму EditData, **записей** по-прежнему фильтруется на идентификатор категории, равное 2, это так, только те элементы, которые соответствуют критериям фильтра являются видимыми.</span><span class="sxs-lookup"><span data-stu-id="09194-150">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible.</span></span> <span data-ttu-id="09194-151">Сначала циклически просматривает **записей** и увеличивает цену каждого видимого элемента в наборе **записей** на 10 процентов.</span><span class="sxs-lookup"><span data-stu-id="09194-151">It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent.</span></span> <span data-ttu-id="09194-152">Путем установки свойства **значение** для этого поля равно новые, действительный сумма изменяется значение поля **Цена** .</span><span class="sxs-lookup"><span data-stu-id="09194-152">The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="09194-153">Имейте в виду, что **записей** отключается от источника данных.</span><span class="sxs-lookup"><span data-stu-id="09194-153">Remember that the **Recordset** is disconnected from the data source.</span></span> <span data-ttu-id="09194-154">Изменения, внесенные в EditData выполняются только на кэшированную копию данных.</span><span class="sxs-lookup"><span data-stu-id="09194-154">The changes made in EditData are made only to the locally cached copy of the data.</span></span> <span data-ttu-id="09194-155">Дополнительные сведения можно [раздел 4: редактирование данных](chapter-4-editing-data.md).</span><span class="sxs-lookup"><span data-stu-id="09194-155">For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="09194-156">Изменения не станут источника данных до щелчка Четвертая кнопка **Обновить данные**.</span><span class="sxs-lookup"><span data-stu-id="09194-156">The changes will not be made on the data source until you click the fourth button, **Update Data**.</span></span> <span data-ttu-id="09194-157">Будет запущен подпрограмму UpdateData.</span><span class="sxs-lookup"><span data-stu-id="09194-157">This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="09194-158">UpdateData</span><span class="sxs-lookup"><span data-stu-id="09194-158">UpdateData</span></span>

<span data-ttu-id="09194-159">UpdateData сначала удаляет фильтр, которая была применена к **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="09194-159">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="09194-160">Код удаляет и восстанавливаются значения по умолчанию как **источник данных** для привязанных DataGrid Microsoft на форме, чтобы в таблице появится неотфильтрованные **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="09194-160">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="09194-161">Код затем проверяется ли вы можете перемещать назад в **набора записей** с помощью метода **поддерживает** с аргументом **adMovePrevious** .</span><span class="sxs-lookup"><span data-stu-id="09194-161">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="09194-162">Процедура переходит к первой записи, с помощью метода **MoveFirst** и отображает поле исходные и текущие значения с помощью свойства **OriginalValue** и **значение** объекта **поля** .</span><span class="sxs-lookup"><span data-stu-id="09194-162">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object.</span></span> <span data-ttu-id="09194-163">Эти свойства, а также свойство **UnderlyingValue** (не используется здесь), подробно рассмотрены в [Глава 5: обновления и сохранение данных](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="09194-163">These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="09194-164">После этого нового объекта **подключения** создается и используется чтобы восстановить подключение к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="09194-164">Next, a new **Connection** object is created and used to reestablish a connection to the data source.</span></span> <span data-ttu-id="09194-165">Переподключение **набора записей** в источник данных, установка новое **подключение** в качестве **ActiveConnection** для **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="09194-165">You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**.</span></span> <span data-ttu-id="09194-166">Чтобы отправлять обновления на сервере, код вызывает **UpdateBatch** **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="09194-166">To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="09194-167">Если пакет обновления завершается успешно, переменная уровня модуля флаг, имеет значение True.</span><span class="sxs-lookup"><span data-stu-id="09194-167">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="09194-168">Это будет Напомнить позднее, чтобы очистить все изменения, внесенные в базу данных.</span><span class="sxs-lookup"><span data-stu-id="09194-168">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="09194-169">И, наконец код переход к первой записи в **набор записей** и отображает исходные и текущие значения.</span><span class="sxs-lookup"><span data-stu-id="09194-169">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values.</span></span> <span data-ttu-id="09194-170">Значения совпадают с после вызова **UpdateBatch**.</span><span class="sxs-lookup"><span data-stu-id="09194-170">The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="09194-171">Более подробные сведения об обновлении данных, в том числе возможные действия при изменении данных на сервере во время отключения набора **записей** см [Глава 5: обновления и сохранение данных](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="09194-171">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="formunload"></a><span data-ttu-id="09194-172">Форма\_Unload</span><span class="sxs-lookup"><span data-stu-id="09194-172">Form\_Unload</span></span>

<span data-ttu-id="09194-173">Форма\_подпрограммы Unload важна по ряду причин.</span><span class="sxs-lookup"><span data-stu-id="09194-173">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="09194-174">Во-первых, так как это пример приложения, формы\_Unload очищает изменений, внесенных в базу данных до завершения приложения.</span><span class="sxs-lookup"><span data-stu-id="09194-174">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="09194-175">Во-вторых в коде показано, как команда может быть выполнена непосредственно из open объекта **подключения** с помощью метода **Execute** .</span><span class="sxs-lookup"><span data-stu-id="09194-175">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="09194-176">И, наконец он показан пример выполнения запроса, не являющиеся – возвращающие строки (запрос на обновление), в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="09194-176">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>


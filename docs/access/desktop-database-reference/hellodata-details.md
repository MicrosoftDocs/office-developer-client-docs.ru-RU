---
title: HelloData Details (Справочник по базам данных Access на компьютере)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292001"
---
# <a name="hellodata-details"></a><span data-ttu-id="ff544-102">Сведения о HelloData</span><span class="sxs-lookup"><span data-stu-id="ff544-102">HelloData details</span></span>


<span data-ttu-id="ff544-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="ff544-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="ff544-104">Приложение HelloData пошаговое руководство по основным операциям типичного приложения ADO: "Просмотр", "Проверка", "Редактирование и обновление данных".</span><span class="sxs-lookup"><span data-stu-id="ff544-104">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data.</span></span> <span data-ttu-id="ff544-105">При запуске приложения нажмите первую кнопку, **получить данные**.</span><span class="sxs-lookup"><span data-stu-id="ff544-105">When you start the application, click the first button, **Get Data**.</span></span> <span data-ttu-id="ff544-106">При этом будет запущена подпрограмма GetData ().</span><span class="sxs-lookup"><span data-stu-id="ff544-106">This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="ff544-107">GetData</span><span class="sxs-lookup"><span data-stu-id="ff544-107">GetData</span></span>

<span data-ttu-id="ff544-108">GetData помещает допустимую строку подключения в переменную уровня модуля, *m\_сконнстр*.</span><span class="sxs-lookup"><span data-stu-id="ff544-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="ff544-109">Дополнительные сведения о строках подключения приведены [в разделе Создание строки подключения](creating-the-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="ff544-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="ff544-110">Назначьте обработчик ошибок с помощью оператора Visual Basic **OnError** .</span><span class="sxs-lookup"><span data-stu-id="ff544-110">Assign an error handler using a Visual Basic **OnError** statement.</span></span> <span data-ttu-id="ff544-111">Дополнительные сведения об обработке ошибок в ADO содержатся в [главе 6: обработка ошибок](chapter-6-error-handling.md).</span><span class="sxs-lookup"><span data-stu-id="ff544-111">For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md).</span></span> <span data-ttu-id="ff544-112">Создается новый объект **Connection** , а для свойства **CursorLocation** задается значение **адусеклиент** , так как в примере HelloData создается *отключенный набор записей*.</span><span class="sxs-lookup"><span data-stu-id="ff544-112">A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*.</span></span> <span data-ttu-id="ff544-113">Это означает, что после получения данных из источника данных физическое подключение к источнику данных разорвано, но вы по-прежнему можете работать с данными, кэшированными локально в объекте **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="ff544-113">This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="ff544-114">После открытия подключения назначьте строку SQL переменной (Сскл).</span><span class="sxs-lookup"><span data-stu-id="ff544-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="ff544-115">Затем создайте экземпляр нового объекта **Recordset** , m\_oRecordset1.</span><span class="sxs-lookup"><span data-stu-id="ff544-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="ff544-116">В следующей строке кода откройте **набор записей** для существующего **подключения**, передав его.</span><span class="sxs-lookup"><span data-stu-id="ff544-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="ff544-117">В следующей строке кода откройте **набор записей** для существующего **подключения**, передав в сскл в качестве источника объекта **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="ff544-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="ff544-118">Вы можете помочь ADO, чтобы определить, что строка SQL, которую вы передали в качестве источника для объекта **Recordset** , является текстовым определением команды, передав **адкмдтекст** в последнем аргументе методу Recordset для объекта **Recordset** \*\*\*\* .</span><span class="sxs-lookup"><span data-stu-id="ff544-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="ff544-119">В этой строке также задаются **LockType** и **CursorType** , связанные с **набором записей**.</span><span class="sxs-lookup"><span data-stu-id="ff544-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="ff544-120">Следующая строка кода задает свойство **MarshalOptions** равным **адмаршалмодифиедонли**.</span><span class="sxs-lookup"><span data-stu-id="ff544-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="ff544-121">**MarshalOptions** указывает, какие записи должны быть упакованы в средний уровень (или на веб-сервер).</span><span class="sxs-lookup"><span data-stu-id="ff544-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="ff544-122">Для получения дополнительных сведений о маршалинге обратитесь к документации по COM.</span><span class="sxs-lookup"><span data-stu-id="ff544-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="ff544-123">При использовании **адмаршалмодифиедонли** с клиентским курсором ([CursorLocation](cursorlocation-property-ado.md) = **адусеклиент**) только записи, которые были изменены в клиенте, записываются обратно на средний уровень.</span><span class="sxs-lookup"><span data-stu-id="ff544-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="ff544-124">Установка **MarshalOptions** в **адмаршалмодифиедонли** может увеличить производительность, так как уменьшается число строк.</span><span class="sxs-lookup"><span data-stu-id="ff544-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="ff544-125">Затем отсоедините **набор записей** , задав для его свойства **ActiveConnection** значение **Nothing**.</span><span class="sxs-lookup"><span data-stu-id="ff544-125">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**.</span></span> <span data-ttu-id="ff544-126">Дополнительную информацию можно узнать в статье [Отключение и повторное подключение набора записей](disconnecting-and-reconnecting-the-recordset.md) в главе 5: обновление и постоянное обновление данных.</span><span class="sxs-lookup"><span data-stu-id="ff544-126">For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="ff544-127">Закройте подключение к источнику данных и уничтожайте существующий объект **Connection** , освобождая таким образом ресурсы, которые он использовал.</span><span class="sxs-lookup"><span data-stu-id="ff544-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="ff544-128">Завершающим шагом является установка объекта **Recordset** в качестве **источника данных** для элемента управления Grid Microsoft DataBound в форме, чтобы можно было легко отобразить данные из **набора записей** в форме.</span><span class="sxs-lookup"><span data-stu-id="ff544-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="ff544-129">Нажмите вторую кнопку, изУчите **данные**.</span><span class="sxs-lookup"><span data-stu-id="ff544-129">Click the second button, **Examine Data**.</span></span> <span data-ttu-id="ff544-130">При этом выполняется подпрограмма Ексаминедата.</span><span class="sxs-lookup"><span data-stu-id="ff544-130">This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="ff544-131">Ексаминедата</span><span class="sxs-lookup"><span data-stu-id="ff544-131">ExamineData</span></span>

<span data-ttu-id="ff544-132">Ексаминедата использует различные методы и свойства объекта **Recordset** для отображения сведений о данных в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ff544-132">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span></span> <span data-ttu-id="ff544-133">Он отображает количество записей с помощью свойства **RecordCount** .</span><span class="sxs-lookup"><span data-stu-id="ff544-133">It reports the number of records by using the **RecordCount** property.</span></span> <span data-ttu-id="ff544-134">Он выполняет цикл по **набору записей** и печатает значение свойства **AbsolutePosition** в текстовом поле Display формы.</span><span class="sxs-lookup"><span data-stu-id="ff544-134">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span></span> <span data-ttu-id="ff544-135">Кроме того, в цикле значение свойства **Bookmark** для третьей записи помещается в переменную типа Variant ( *вбукмарк*) для последующего использования.</span><span class="sxs-lookup"><span data-stu-id="ff544-135">Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="ff544-136">Процедура непосредственно переходит к третьей записи с помощью переменной закладки, которая была сохранена ранее.</span><span class="sxs-lookup"><span data-stu-id="ff544-136">The routine navigates directly back to the third record using the bookmark variable that it stored earlier.</span></span> <span data-ttu-id="ff544-137">Процедура вызывает подпрограмму Валкфиелдс, которая выполняет цикл по коллекции **Fields** **набора записей** и отображает сведения о каждом **поле** в коллекции.</span><span class="sxs-lookup"><span data-stu-id="ff544-137">The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="ff544-138">Наконец, Ексаминедата использует свойство **Filter** объекта **Recordset** для отображения только тех записей, у которых значение CategoryID равно 2.</span><span class="sxs-lookup"><span data-stu-id="ff544-138">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2.</span></span> <span data-ttu-id="ff544-139">Результат применения этого фильтра сразу отображается в сетке отображения на форме.</span><span class="sxs-lookup"><span data-stu-id="ff544-139">The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="ff544-140">Дополнительные сведения о функциях, показанных в подпрограмме Ексаминедата, приведены в [главе 3: исследование данных](chapter-3-examining-data.md).</span><span class="sxs-lookup"><span data-stu-id="ff544-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="ff544-141">Затем нажмите третью кнопку, **измените данные**.</span><span class="sxs-lookup"><span data-stu-id="ff544-141">Next, click the third button, **Edit Data**.</span></span> <span data-ttu-id="ff544-142">При этом будет выполняться подпрограмма Едитдата.</span><span class="sxs-lookup"><span data-stu-id="ff544-142">This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="ff544-143">Едитдата</span><span class="sxs-lookup"><span data-stu-id="ff544-143">EditData</span></span>

<span data-ttu-id="ff544-144">Когда код вводит подпрограмму Едитдата, он по \*\*\*\* -прежнему фильтруется по значению CategoryID, равному 2, поэтому отображаются только те элементы, которые соответствуют условиям фильтра.</span><span class="sxs-lookup"><span data-stu-id="ff544-144">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible.</span></span> <span data-ttu-id="ff544-145">Сначала он выполняет цикл по **набору записей** и увеличивает цену каждого видимого элемента в **наборе записей** на 10 процентов.</span><span class="sxs-lookup"><span data-stu-id="ff544-145">It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent.</span></span> <span data-ttu-id="ff544-146">Значение поля **Price** изменяется путем присвоения свойству Value этого поля **значения** , равного новой, допустимой сумме.</span><span class="sxs-lookup"><span data-stu-id="ff544-146">The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="ff544-147">Помните, что **набор записей** отключен от источника данных.</span><span class="sxs-lookup"><span data-stu-id="ff544-147">Remember that the **Recordset** is disconnected from the data source.</span></span> <span data-ttu-id="ff544-148">Изменения, внесенные в Едитдата, вносятся только в локально кэшированную копию данных.</span><span class="sxs-lookup"><span data-stu-id="ff544-148">The changes made in EditData are made only to the locally cached copy of the data.</span></span> <span data-ttu-id="ff544-149">Дополнительные сведения приведены в [главе 4: Edit Data](chapter-4-editing-data.md).</span><span class="sxs-lookup"><span data-stu-id="ff544-149">For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="ff544-150">Изменения не вносятся в источник данных, пока не будет нажата четвертая кнопка, **обновите данные**.</span><span class="sxs-lookup"><span data-stu-id="ff544-150">The changes will not be made on the data source until you click the fourth button, **Update Data**.</span></span> <span data-ttu-id="ff544-151">При этом будет выполняться подпрограмма Упдатедата.</span><span class="sxs-lookup"><span data-stu-id="ff544-151">This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="ff544-152">Упдатедата</span><span class="sxs-lookup"><span data-stu-id="ff544-152">UpdateData</span></span>

<span data-ttu-id="ff544-153">Упдатедата сначала удаляет фильтр, примененный к **набору записей**.</span><span class="sxs-lookup"><span data-stu-id="ff544-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="ff544-154">Код удаляет и сбрасывает в качестве **источника данных** для связанной с Microsoft DataGrid в форме, чтобы в сетке отображался неФильтрованный **набор записей** .</span><span class="sxs-lookup"><span data-stu-id="ff544-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="ff544-155">Затем код проверяет, можно ли перемещаться в обратном наборе **записей** с помощью метода \*\*\*\* Supports с аргументом **адмовепревиаус** .</span><span class="sxs-lookup"><span data-stu-id="ff544-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="ff544-156">Процедура перемещается к первой записи с помощью метода **MoveFirst** и отображает исходные и текущие значения поля, используя свойства **originalValue** и **value** объекта **field** .</span><span class="sxs-lookup"><span data-stu-id="ff544-156">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object.</span></span> <span data-ttu-id="ff544-157">Эти свойства вместе со свойством **UnderlyingValue** (не используется здесь) обсуждаются в [главе 5: обновление и постоянное обновление данных](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="ff544-157">These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="ff544-158">Затем создается новый объект **Connection** , который используется для восстановления подключения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="ff544-158">Next, a new **Connection** object is created and used to reestablish a connection to the data source.</span></span> <span data-ttu-id="ff544-159">Необходимо повторно подключить объект **Recordset** к источнику данных, установив новое **Подключение** в качестве **ActiveConnection** для объекта **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="ff544-159">You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**.</span></span> <span data-ttu-id="ff544-160">Чтобы отправить обновления на сервер, код вызывает **UpdateBatch** для объекта **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="ff544-160">To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="ff544-161">Если пакетное обновление выполнено успешно, переменная флага уровня модуля имеет значение true.</span><span class="sxs-lookup"><span data-stu-id="ff544-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="ff544-162">В дальнейшем будет выдано напоминание об очистке всех изменений, внесенных в базу данных.</span><span class="sxs-lookup"><span data-stu-id="ff544-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="ff544-163">Наконец, код перемещается обратно в первую запись в **наборе записей** и отображает исходные и текущие значения.</span><span class="sxs-lookup"><span data-stu-id="ff544-163">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values.</span></span> <span data-ttu-id="ff544-164">Значения совпадают после вызова **UpdateBatch**.</span><span class="sxs-lookup"><span data-stu-id="ff544-164">The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="ff544-165">Для получения более подробных сведений об обновлении данных, в том числе действия, выполняемые при изменении данных на сервере, когда **набор записей** отключен, ознакомьтесь со статьей [глава 5: обновление и сохранение данных](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="ff544-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="formunload"></a><span data-ttu-id="ff544-166">Выгрузка формы\_</span><span class="sxs-lookup"><span data-stu-id="ff544-166">Form\_Unload</span></span>

<span data-ttu-id="ff544-167">Подпрограмма\_выгрузки формы важна по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="ff544-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="ff544-168">Во-первых, так как это пример приложения,\_выгрузка формы очищает изменения, внесенные в базу данных до завершения работы приложения.</span><span class="sxs-lookup"><span data-stu-id="ff544-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="ff544-169">Во вторых, код показывает, как можно выполнить команду непосредственно из открытого объекта **Connection** с помощью метода **EXECUTE** .</span><span class="sxs-lookup"><span data-stu-id="ff544-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="ff544-170">В заключение показан пример выполнения запроса, не являющегося строкой (запрос на обновление), в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="ff544-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>


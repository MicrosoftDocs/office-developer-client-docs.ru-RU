---
title: Сведения HelloData (ссылка на настольные базы данных)
TOCTitle: HelloData details
ms:assetid: db51e15c-1b5b-c64a-2f84-34dd0e78c6cf
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250105(v=office.15)
ms:contentKeyID: 48548103
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 78b04b74d4e2b8d9c215235d6e7ccebed4fa2ef2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292001"
---
# <a name="hellodata-details"></a><span data-ttu-id="72ef6-102">Сведения о HelloData</span><span class="sxs-lookup"><span data-stu-id="72ef6-102">HelloData details</span></span>


<span data-ttu-id="72ef6-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="72ef6-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="72ef6-104">Приложение HelloData проходит через основные операции типичного приложения ADO: получение, изучение, редактирование и обновление данных.</span><span class="sxs-lookup"><span data-stu-id="72ef6-104">The HelloData application steps through the basic operations of a typical ADO application: getting, examining, editing, and updating data.</span></span> <span data-ttu-id="72ef6-105">При запуске приложения нажмите первую кнопку Get **Data**.</span><span class="sxs-lookup"><span data-stu-id="72ef6-105">When you start the application, click the first button, **Get Data**.</span></span> <span data-ttu-id="72ef6-106">В этом случае будет работать подраутин GetData().</span><span class="sxs-lookup"><span data-stu-id="72ef6-106">This will run the GetData() subroutine.</span></span>

## <a name="getdata"></a><span data-ttu-id="72ef6-107">GetData</span><span class="sxs-lookup"><span data-stu-id="72ef6-107">GetData</span></span>

<span data-ttu-id="72ef6-108">GetData помещает допустимую строку подключения в переменную уровня модуля *m \_ sConnStr.*</span><span class="sxs-lookup"><span data-stu-id="72ef6-108">GetData places a valid connection string into a module-level variable, *m\_sConnStr*.</span></span> <span data-ttu-id="72ef6-109">Дополнительные сведения о строках подключения см. в [строке Создание строки подключения.](creating-the-connection-string.md)</span><span class="sxs-lookup"><span data-stu-id="72ef6-109">For more information about connection strings, see [Creating the Connection String](creating-the-connection-string.md).</span></span>

<span data-ttu-id="72ef6-110">Назначьте обработчик ошибок с помощью Visual Basic **OnError.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-110">Assign an error handler using a Visual Basic **OnError** statement.</span></span> <span data-ttu-id="72ef6-111">Дополнительные сведения об обработке ошибок в ADO см. в главе [6. Обработка ошибок.](chapter-6-error-handling.md)</span><span class="sxs-lookup"><span data-stu-id="72ef6-111">For more information about error handling in ADO, see [Chapter 6: Error Handling](chapter-6-error-handling.md).</span></span> <span data-ttu-id="72ef6-112">Создается  новый объект Подключения, и свойство **CursorLocation** задано **для adUseClient,** так как в примере HelloData создается *отключенный набор записей.*</span><span class="sxs-lookup"><span data-stu-id="72ef6-112">A new **Connection** object is created, and the **CursorLocation** property is set to **adUseClient** because the HelloData example creates a *disconnected Recordset*.</span></span> <span data-ttu-id="72ef6-113">Это означает, что после получения данных из источника данных физическое подключение к источнику данных будет нарушено, но вы все равно можете работать с данными, которые кэшироваться локально в объекте **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-113">This means that once the data has been fetched from the data source, the physical connection with the data source is broken, but you can still work with the data that is cached locally in your **Recordset** object.</span></span>

<span data-ttu-id="72ef6-114">После открытия подключения назначьте строку SQL переменной (sSQL).</span><span class="sxs-lookup"><span data-stu-id="72ef6-114">After the connection has been opened, assign a SQL string to a variable (sSQL).</span></span> <span data-ttu-id="72ef6-115">Затем мгновенный доступ к новому **объекту Recordset** m \_ oRecordset1.</span><span class="sxs-lookup"><span data-stu-id="72ef6-115">Then instantiate a new **Recordset** object, m\_oRecordset1 .</span></span> <span data-ttu-id="72ef6-116">В следующей строке кода откройте **набор записей** по существующему **подключению**, проходя.</span><span class="sxs-lookup"><span data-stu-id="72ef6-116">In the next line of code, open the **Recordset** over the existing **Connection**, passing in .</span></span> <span data-ttu-id="72ef6-117">В следующей строке кода откройте **набор записей** по существующему подключению, передавая sSQL в качестве источника **recordset.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-117">In the next line of code, open the **Recordset** over the existing **Connection**, passing in sSQL as the source of the **Recordset**.</span></span> <span data-ttu-id="72ef6-118">Вы помогаете ADO определить, что строка SQL, которую вы передали в качестве источника для **Recordset,** является текстовым определением команды, передав **adCmdText** в окончательном аргументе методу **Recordset** **Open.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-118">You assist ADO in making the determination that the SQL string you have passed as the source for the **Recordset** is a textual definition of a command by passing **adCmdText** in the final argument to the **Recordset** **Open** method.</span></span> <span data-ttu-id="72ef6-119">Эта строка также задает **LockType** и **CursorType,** связанные с **Набором записей.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-119">This line also sets the **LockType** and **CursorType** associated with the **Recordset**.</span></span>

<span data-ttu-id="72ef6-120">Следующая строка кода задает свойство **MarshalOptions,** равное **adMarshalModifiedOnly.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-120">The next line of code sets the **MarshalOptions** property equal to **adMarshalModifiedOnly**.</span></span> <span data-ttu-id="72ef6-121">**MarshalOptions указывает,** какие записи следует маршалить до среднего уровня (или веб-сервера).</span><span class="sxs-lookup"><span data-stu-id="72ef6-121">**MarshalOptions** indicates which records should be marshaled to the middle tier (or web server).</span></span> <span data-ttu-id="72ef6-122">Дополнительные сведения о маршалинге см. в документации com.</span><span class="sxs-lookup"><span data-stu-id="72ef6-122">For more information about marshaling, see the COM documentation.</span></span> <span data-ttu-id="72ef6-123">При использовании **adMarshalModifiedOnly** с клиентской стороной курсора [(CursorLocation](cursorlocation-property-ado.md)  =  **adUseClient)** на средний уровень записывают только записи, измененные на клиенте.</span><span class="sxs-lookup"><span data-stu-id="72ef6-123">When using **adMarshalModifiedOnly** with a client-side cursor ([CursorLocation](cursorlocation-property-ado.md) = **adUseClient**), only records that have been modified on the client are written back to the middle tier.</span></span> <span data-ttu-id="72ef6-124">Настройка **marshalOptions** **для adMarshalModifiedOnly** может повысить производительность, так как количество строк меньше.</span><span class="sxs-lookup"><span data-stu-id="72ef6-124">Setting **MarshalOptions** to **adMarshalModifiedOnly** can improve performance because fewer rows are marshaled.</span></span>

<span data-ttu-id="72ef6-125">Затем отключите **набор записей,** установив его свойство **ActiveConnection,** равное **Nothing**.</span><span class="sxs-lookup"><span data-stu-id="72ef6-125">Next, disconnect the **Recordset** by setting its **ActiveConnection** property equal to **Nothing**.</span></span> <span data-ttu-id="72ef6-126">Дополнительные сведения см. в раздел [Отключение](disconnecting-and-reconnecting-the-recordset.md) и подключение к набору записей в главе 5: Обновление и сохраняющиеся данные.</span><span class="sxs-lookup"><span data-stu-id="72ef6-126">For more information, see [Disconnecting and Reconnecting the Recordset](disconnecting-and-reconnecting-the-recordset.md) in Chapter 5: Updating and Persisting Data.</span></span>

<span data-ttu-id="72ef6-127">Закрой подключение к источнику данных и уничтожив существующий объект **Connection,** освободив тем самым потребляемых ресурсов.</span><span class="sxs-lookup"><span data-stu-id="72ef6-127">Close the connection to the data source and destroy the existing **Connection** object, thereby releasing the resources it consumed.</span></span>

<span data-ttu-id="72ef6-128">На заключительном этапе  необходимо установить набор записей в качестве центра **dataSource** для управления сеткой  данных Майкрософт в форме, чтобы можно было легко отображать данные из набора записей в форме.</span><span class="sxs-lookup"><span data-stu-id="72ef6-128">The final step is to set the **Recordset** as the **DataSource** for the Microsoft DataBound Grid Control on the form so that you can easily display the data from the **Recordset** on the form.</span></span>

<span data-ttu-id="72ef6-129">Щелкните вторую кнопку " **Изучите данные.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-129">Click the second button, **Examine Data**.</span></span> <span data-ttu-id="72ef6-130">В этом случае выполняется субраутин ExamineData.</span><span class="sxs-lookup"><span data-stu-id="72ef6-130">This runs the ExamineData subroutine.</span></span>

## <a name="examinedata"></a><span data-ttu-id="72ef6-131">ExamineData</span><span class="sxs-lookup"><span data-stu-id="72ef6-131">ExamineData</span></span>

<span data-ttu-id="72ef6-132">ExamineData использует различные методы и свойства объекта **Recordset** для отображения сведений о данных в **Наборе записей.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-132">ExamineData uses various methods and properties of the **Recordset** object to display information about the data in the **Recordset**.</span></span> <span data-ttu-id="72ef6-133">Он сообщает о количестве записей с помощью свойства **RecordCount.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-133">It reports the number of records by using the **RecordCount** property.</span></span> <span data-ttu-id="72ef6-134">Он проходит циклы через **Набор записей** и печатает значение свойства **AbsolutePosition** в текстовом окне отображения формы.</span><span class="sxs-lookup"><span data-stu-id="72ef6-134">It loops through the **Recordset** and prints the value of the **AbsolutePosition** property in the display text box on the form.</span></span> <span data-ttu-id="72ef6-135">Кроме того, в цикле значение свойства **Bookmark** для третьей записи помещается в переменную варианта *vBookmark* для более позднего использования.</span><span class="sxs-lookup"><span data-stu-id="72ef6-135">Also while in the loop, the value of the **Bookmark** property for the third record is placed into a variant variable, *vBookmark*, for later use.</span></span>

<span data-ttu-id="72ef6-136">Обычно перемещается непосредственно к третьей записи с помощью переменной закладки, которую она хранила ранее.</span><span class="sxs-lookup"><span data-stu-id="72ef6-136">The routine navigates directly back to the third record using the bookmark variable that it stored earlier.</span></span> <span data-ttu-id="72ef6-137">В обычной процедуре вызывается подпрограмма WalkFields, которая проходит циклы через коллекцию **Поля** в **Наборе** записей и отображает сведения о каждом **поле** в коллекции.</span><span class="sxs-lookup"><span data-stu-id="72ef6-137">The routine calls the WalkFields subroutine, which loops through the **Fields** collection of the **Recordset** and displays details about each **Field** in the collection.</span></span>

<span data-ttu-id="72ef6-138">Наконец, в ExamineData используется свойство **Filter** в **наборе записей** для проверки только этих записей с помощью categoryId, равного 2.</span><span class="sxs-lookup"><span data-stu-id="72ef6-138">Finally, ExamineData uses the **Filter** property of the **Recordset** to screen for only those records with a CategoryId equal to 2.</span></span> <span data-ttu-id="72ef6-139">Результат применения этого фильтра сразу же отображается в сетке отображения на форме.</span><span class="sxs-lookup"><span data-stu-id="72ef6-139">The result of applying this filter is immediately visible in the display grid on the form.</span></span>

<span data-ttu-id="72ef6-140">Дополнительные сведения о функциональных возможностях, показанных в субраутине ExamineData, см. в главе [3. Изучение данных.](chapter-3-examining-data.md)</span><span class="sxs-lookup"><span data-stu-id="72ef6-140">For more information about the functionality shown in the ExamineData subroutine, see [Chapter 3: Examining Data](chapter-3-examining-data.md).</span></span>

<span data-ttu-id="72ef6-141">Далее нажмите третью кнопку Изменить **данные**.</span><span class="sxs-lookup"><span data-stu-id="72ef6-141">Next, click the third button, **Edit Data**.</span></span> <span data-ttu-id="72ef6-142">При этом будет работать подраутин EditData.</span><span class="sxs-lookup"><span data-stu-id="72ef6-142">This will run the EditData subroutine.</span></span>

## <a name="editdata"></a><span data-ttu-id="72ef6-143">EditData</span><span class="sxs-lookup"><span data-stu-id="72ef6-143">EditData</span></span>

<span data-ttu-id="72ef6-144">Когда код входит в субраутин EditData, набор **Записей** по-прежнему фильтруется на categoryId, равном 2, поэтому видны только те элементы, которые соответствуют критериям фильтра.</span><span class="sxs-lookup"><span data-stu-id="72ef6-144">When the code enters the EditData subroutine, the **Recordset** is still filtered on CategoryId equal to 2, so only those items that meet the filter criteria are visible.</span></span> <span data-ttu-id="72ef6-145">Он сначала проходит циклы через **Набор записей** и увеличивает цену каждого видимого элемента в **Наборе** записей на 10 процентов.</span><span class="sxs-lookup"><span data-stu-id="72ef6-145">It first loops through the **Recordset** and increases the price of each visible item in the **Recordset** by 10 percent.</span></span> <span data-ttu-id="72ef6-146">Значение поля **Цена** меняется, установив свойство **Value** для этого поля, равное новой допустимой сумме.</span><span class="sxs-lookup"><span data-stu-id="72ef6-146">The value of the **Price** field is changed by setting the **Value** property for that field equal to a new, valid amount.</span></span>

<span data-ttu-id="72ef6-147">Помните, что **набор Recordset** отключен от источника данных.</span><span class="sxs-lookup"><span data-stu-id="72ef6-147">Remember that the **Recordset** is disconnected from the data source.</span></span> <span data-ttu-id="72ef6-148">Изменения, внесенные в EditData, внося только в локализованную кэшированную копию данных.</span><span class="sxs-lookup"><span data-stu-id="72ef6-148">The changes made in EditData are made only to the locally cached copy of the data.</span></span> <span data-ttu-id="72ef6-149">Дополнительные сведения см. [в главе 4. Редактирование данных.](chapter-4-editing-data.md)</span><span class="sxs-lookup"><span data-stu-id="72ef6-149">For more information, see [Chapter 4: Editing Data](chapter-4-editing-data.md).</span></span>

<span data-ttu-id="72ef6-150">Изменения не будут внесены в источник данных, пока не нажмете четвертую кнопку Update **Data**.</span><span class="sxs-lookup"><span data-stu-id="72ef6-150">The changes will not be made on the data source until you click the fourth button, **Update Data**.</span></span> <span data-ttu-id="72ef6-151">При этом будет работать подраутин UpdateData.</span><span class="sxs-lookup"><span data-stu-id="72ef6-151">This will run the UpdateData subroutine.</span></span>

## <a name="updatedata"></a><span data-ttu-id="72ef6-152">UpdateData</span><span class="sxs-lookup"><span data-stu-id="72ef6-152">UpdateData</span></span>

<span data-ttu-id="72ef6-153">UpdateData сначала удаляет фильтр, который был применен к **Набору записей.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-153">UpdateData first removes the filter that has been applied to the **Recordset**.</span></span> <span data-ttu-id="72ef6-154">Код удаляется и сбрасывается в виде **DataSource** для Microsoft Bound DataGrid в  форме, чтобы в сетке появился неотсортованный набор записей.</span><span class="sxs-lookup"><span data-stu-id="72ef6-154">The code removes and resets as the **DataSource** for the Microsoft Bound DataGrid on the form so that the unfiltered **Recordset** appears in the grid.</span></span>

<span data-ttu-id="72ef6-155">Затем код проверяет, можно ли двигаться назад в **Наборе** записей с помощью метода **Supports** с **аргументом adMovePrevious.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-155">The code then checks to see whether you can move backward in the **Recordset** by using the **Supports** method with the **adMovePrevious** argument.</span></span>

<span data-ttu-id="72ef6-156">Обычно перемещается к первой записи с помощью метода **MoveFirst** и отображает исходные и текущие значения поля с использованием свойств **OriginalValue** и **Value** объекта **Field.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-156">The routine moves to the first record using the **MoveFirst** method and displays the field's original and current values, using the **OriginalValue** and **Value** properties of the **Field** object.</span></span> <span data-ttu-id="72ef6-157">Эти свойства, а также свойство **UnderlyingValue** (не используется здесь), обсуждаются в главе [5: Обновление и сохраняющиеся данные](chapter-5-updating-and-persisting-data.md).</span><span class="sxs-lookup"><span data-stu-id="72ef6-157">These properties, along with the **UnderlyingValue** property (not used here), are discussed in [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

<span data-ttu-id="72ef6-158">Далее создается новый объект **Connection,** который используется для повторного подключения к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="72ef6-158">Next, a new **Connection** object is created and used to reestablish a connection to the data source.</span></span> <span data-ttu-id="72ef6-159">Вы повторно подключили **набор записей** к  источнику данных, установив новое подключение в качестве **ActiveConnection** для **наборов записей.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-159">You reconnect the **Recordset** to the data source by setting the new **Connection** as the **ActiveConnection** for the **Recordset**.</span></span> <span data-ttu-id="72ef6-160">Чтобы отправить обновления на сервер, код вызывает **UpdateBatch** в **Наборе записей.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-160">To send the updates to the server, the code calls **UpdateBatch** on the **Recordset**.</span></span>

<span data-ttu-id="72ef6-161">Если пакетное обновление будет успешным, переменная флага на уровне модуля будет настроена на значение True.</span><span class="sxs-lookup"><span data-stu-id="72ef6-161">If the batch update succeeds, a module-level flag variable, , is set to True.</span></span> <span data-ttu-id="72ef6-162">Это напомнит вам позже, чтобы очистить все изменения, внесенные в базу данных.</span><span class="sxs-lookup"><span data-stu-id="72ef6-162">This will remind you later to clean up all changes made to the database.</span></span>

<span data-ttu-id="72ef6-163">Наконец, код возвращается к первой записи **в Recordset** и отображает исходные и текущие значения.</span><span class="sxs-lookup"><span data-stu-id="72ef6-163">Finally, the code moves back to the first record in the **Recordset** and displays the original and current values.</span></span> <span data-ttu-id="72ef6-164">Значения одинаковы после вызова в **UpdateBatch.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-164">The values are the same after the call to **UpdateBatch**.</span></span>

<span data-ttu-id="72ef6-165">Дополнительные сведения об обновлении данных, в том числе о  том, что делать, если данные на сервере меняются во время отключения вашего наборов записей, см. в главе [5: Обновление и сохраняющихся данных.](chapter-5-updating-and-persisting-data.md)</span><span class="sxs-lookup"><span data-stu-id="72ef6-165">For more detailed information about updating data, including what to do when data on the server changes while your **Recordset** is disconnected, see [Chapter 5: Updating and Persisting Data](chapter-5-updating-and-persisting-data.md).</span></span>

## <a name="form_unload"></a><span data-ttu-id="72ef6-166">\_Разгрузка формы</span><span class="sxs-lookup"><span data-stu-id="72ef6-166">Form\_Unload</span></span>

<span data-ttu-id="72ef6-167">\_Субраутин разгрузки формы важен по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="72ef6-167">The Form\_Unload subroutine is important for several reasons.</span></span> <span data-ttu-id="72ef6-168">Во-первых, так как это пример приложения, Form Unload очищает изменения, внесенные в базу данных перед \_ выходом приложения.</span><span class="sxs-lookup"><span data-stu-id="72ef6-168">First, because this is a sample application, Form\_Unload cleans up the changes made to the database before the application exits.</span></span> <span data-ttu-id="72ef6-169">Во-вторых, код показывает, как команда может выполняться непосредственно с открытого объекта **Подключения** с помощью **метода Execute.**</span><span class="sxs-lookup"><span data-stu-id="72ef6-169">Second, the code shows how a command can be executed directly from an open **Connection** object using the **Execute** method.</span></span> <span data-ttu-id="72ef6-170">Наконец, в нем показан пример выполнения запроса, не возвращаемого строками (запрос UPDATE) в отношении источника данных.</span><span class="sxs-lookup"><span data-stu-id="72ef6-170">Finally, it shows an example of executing a non-row–returning query (an UPDATE query) against the data source.</span></span>


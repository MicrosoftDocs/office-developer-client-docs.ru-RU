---
title: Методы BeginTrans, CommitTrans и RollbackTrans (ADO)
TOCTitle: BeginTrans, CommitTrans, and RollbackTrans methods (ADO)
ms:assetid: 9a0415f0-9424-8d1c-4779-92e932292d46
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249694(v=office.15)
ms:contentKeyID: 48546529
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 8d9dc28bd64966e85d16ee2d8cb62fdebc3ba942
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296873"
---
# <a name="begintrans-committrans-and-rollbacktrans-methods-ado"></a>Методы BeginTrans, CommitTrans и RollbackTrans (ADO)

**Область применения**: Access 2013, Office 2013

Эти методы транзакции управляют обработкой транзакций в [объекте Подключения](connection-object-ado.md) следующим образом:

- **BeginTrans** — начинается новая транзакция.

- **CommitTrans** — сохраняет все изменения и завершает текущую транзакцию. Кроме того, может начаться новая транзакция.

- **RollbackTrans** — отменяет изменения, внесенные во время текущей транзакции, и завершает транзакцию. Кроме того, может начаться новая транзакция.

## <a name="syntax"></a>Синтаксис

*уровень*  =  *объект*. BeginTrans()

*объект*. BeginTrans

*объект*. CommitTrans

*объект*. RollbackTrans

## <a name="return-value"></a>Возвращаемое значение

**BeginTrans** можно назвать функцией, возвращаемой переменной **Long,** указывающей уровень вложения транзакции.

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*object* |Объект **Подключения.**|

### <a name="connection"></a>Connection

Используйте эти методы с объектом **Connection,** если необходимо сохранить или отменить ряд изменений, внесенных в исходные данные в качестве единого блока. Например, чтобы перевести деньги между счетами, вычитайте сумму из одной и добавьте ту же сумму в другую. Если обновление не удается, учетные записи перестают балансировать. Внесение этих изменений в открытую транзакцию гарантирует, что все или никакие изменения не будут проходить.

> [!NOTE]
> Не все поставщики поддерживают транзакции. Убедитесь, что **DDL** транзакции с определенным поставщиком свойства отображается в коллекции [свойств](properties-collection-ado.md) объекта **Connection,** указав, что поставщик поддерживает транзакции. Если поставщик не поддерживает транзакции, вызов одного из этих методов возвращает ошибку.

После вызова метода **BeginTrans** поставщик больше не будет мгновенно совершать изменения, внесенные до вызова **CommitTrans** или **RollbackTrans** для окончания транзакции.

Для поставщиков, которые поддерживают вложенные транзакции, вызов метода **BeginTrans** в рамках открытой транзакции запускает новую вложенную транзакцию. Возвращаемая величина указывает уровень вложения: значение возврата "1" указывает, что вы открыли транзакцию верхнего уровня (то есть транзакция не вложена в другую транзакцию), "2" указывает, что вы открыли транзакцию второго уровня (транзакция, вложенная в транзакцию верхнего уровня) и так далее. Вызов **CommitTrans или** **RollbackTrans** влияет только на недавно открытую транзакцию; необходимо закрыть или откатить текущую транзакцию, прежде чем разрешить любые транзакции более высокого уровня.

Вызов метода **CommitTrans позволяет** сохранить изменения, внесенные в открытой транзакции, на подключении и завершает транзакцию. Вызов метода **RollbackTrans отменяет** все изменения, внесенные в открытой транзакции, и завершает транзакцию. Вызов любого метода при отсутствие открытой транзакции создает ошибку.

В зависимости от свойства [](attributes-property-ado.md) **Атрибуты** объекта Подключения вызов методов **CommitTrans** или **RollbackTrans** может автоматически запускать новую транзакцию. Если свойство **Attributes** настроено на **adXactCommitRetaining,** поставщик автоматически запускает новую транзакцию после вызова **CommitTrans.** Если свойство **Attributes** настроено на **adXactAbortRetaining,** поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans.**

### <a name="remote-data-service"></a>Служба удаленных данных

Методы **BeginTrans,** **CommitTrans** и **RollbackTrans** недоступны для объекта клиентского **подключения.**


---
title: Методы BeginTrans, CommitTrans и RollbackTrans (ADO)
TOCTitle: BeginTrans, CommitTrans, and RollbackTrans methods (ADO)
ms:assetid: 9a0415f0-9424-8d1c-4779-92e932292d46
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249694(v=office.15)
ms:contentKeyID: 48546529
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 8d9dc28bd64966e85d16ee2d8cb62fdebc3ba942
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296873"
---
# <a name="begintrans-committrans-and-rollbacktrans-methods-ado"></a>Методы BeginTrans, CommitTrans и RollbackTrans (ADO)

**Область применения**: Access 2013, Office 2013

Эти методы транзакции управляют обработкой транзакций в объекте [Connection](connection-object-ado.md) следующим образом:

- **BeginTrans** — начинает новую транзакцию.

- **CommitTrans** — сохраняет все изменения и завершает текущую транзакцию. Кроме того, может начаться новая транзакция.

- **RollbackTrans** — отменяет все изменения, внесенные во время текущей транзакции, и завершает транзакцию. Кроме того, может начаться новая транзакция.

## <a name="syntax"></a>Синтаксис

*level* = *объект*Level. BeginTrans ()

*объект*. BeginTrans

*объект*. CommitTrans

*объект*. RollbackTrans

## <a name="return-value"></a>Возвращаемое значение

**BeginTrans** может вызываться в качестве функции, возвращающей **длинную** переменную, указывающую уровень вложенности транзакции.

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*object* |Объект **Connection** .|

### <a name="connection"></a>Connection

Используйте эти методы вместе с объектом **Connection** , если необходимо сохранить или отменить серию изменений, внесенных в источник данных, как единое целое. Например, чтобы перенести деньги между учетными записями, можно вычесть сумму из единицы и добавить одинаковую сумму к другому. Если обновление завершается сбоем, учетные записи больше не сбалансированы. Внесение этих изменений в открытую транзакцию гарантирует, что все изменения не проходят или не проходят какие либо никакие изменения.

> [!NOTE]
> Не все поставщики поддерживают транзакции. Убедитесь, что в коллекции [свойств](properties-collection-ado.md) объекта **Connection** отображается **DDL** -свойство, заданное поставщиком, указывая, что поставщик поддерживает транзакции. Если поставщик не поддерживает транзакции, то при вызове одного из этих методов возвращается ошибка.

После вызова метода **BeginTrans** поставщик больше не будет выполнять изменения, пока не будет вызвана **CommitTrans** или **RollbackTrans** для завершения транзакции.

Для поставщиков, поддерживающих вложенные транзакции, вызов метода **BeginTrans** в открытой транзакции начинает новую вложенную транзакцию. Возвращаемое значение указывает уровень вложенности: возвращаемое значение "1" указывает на то, что вы открыли транзакцию верхнего уровня (то есть транзакция не является вложенной в другую транзакцию), "2" означает, что вы открыли транзакцию второго уровня (транзакция, вложенная в транзакцию верхнего уровня) и так далее. Вызов **CommitTrans** или **RollbackTrans** влияет только на самую последнюю открытую транзакцию; Прежде чем можно будет разрешить транзакции верхнего уровня, необходимо закрыть или откатить текущую транзакцию.

При вызове метода **CommitTrans** сохраняются изменения, внесенные в открытую транзакцию для подключения, и завершается транзакция. Вызов метода **RollbackTrans** отменяет все изменения, внесенные в открытую транзакцию, и завершает транзакцию. Вызов любого метода при отсутствии открытой транзакции приводит к ошибке.

В зависимости от свойства [Attribute](attributes-property-ado.md) объекта **Connection** , вызов методов **CommitTrans** или **RollbackTrans** может автоматически запустить новую транзакцию. Если для свойства **Attributes** задано значение **адксакткоммитретаининг**, поставщик автоматически запускает новую транзакцию после вызова **CommitTrans** . Если для свойства **Attributes** задано значение **адксактабортретаининг**, поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans** .

### <a name="remote-data-service"></a>Удаленная служба данных

Методы **BeginTrans**, **CommitTrans**и **RollbackTrans** недоступны для объекта **подключения** на стороне клиента.


---
title: BeginTrans, CommitTrans, and RollbackTrans Methods (ADO)
TOCTitle: BeginTrans, CommitTrans, and RollbackTrans Methods (ADO)
ms:assetid: 9a0415f0-9424-8d1c-4779-92e932292d46
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249694(v=office.15)
ms:contentKeyID: 48546529
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 69d3d7830204ec400e01b64bb11434c272da5c29
ms.sourcegitcommit: 19aca09c5812cfb98b68b5d4604dcaa814479df7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2018
ms.locfileid: "25481019"
---
# <a name="begintrans-committrans-and-rollbacktrans-methods-ado"></a>BeginTrans, CommitTrans, and RollbackTrans Methods (ADO)


**Применимо к**: Access 2013 | Office 2013


Эти методы транзакций управление транзакций обработка объект [подключения](connection-object-ado.md) следующим образом:

  - **BeginTrans** — начало новой транзакции.

  - **CommitTrans** — сохраняет все изменения и заканчивающейся текущей операции. Он также может начать новую операцию.

  - **RollbackTrans** — показано, как отменить все изменения, внесенные во время текущей операции и заканчивающейся транзакции. Он также может начать новую операцию.

## <a name="syntax"></a>Синтаксис

*уровень* = *объектов*. BeginTrans()

*объект*. BeginTrans

*объект*. CommitTrans

*объект*. RollbackTrans

## <a name="return-value"></a>Возвращаемое значение

**BeginTrans** можно вызывать как функцию, которая возвращает **длинный** переменной, указывающее уровень вложенности транзакции.

## <a name="parameters"></a>Параметры

  - *object*

  - Объект **подключения** .

**Подключение**

Использование этих методов с объектом **подключения** необходимо сохранить или отменить ряд изменений, внесенных в источник данных как единый элемент. К примеру деньги переключение между учетными записями, вы вычесть сумму из одного и добавьте совпадает со значением в другой. Если либо обновить возникает ошибка, больше не сбалансировать учетные записи. Эти изменения в открытую операцию гарантирует, что все или изменения проходят через.


> [!NOTE]
> <P>Не все поставщики поддерживают транзакции. Убедитесь, что поставщик, определенный «<STRONG>DDL транзакций</STRONG>» отображается в коллекции <A href="properties-collection-ado.md">свойств</A> объекта <STRONG>подключения</STRONG> , указывающего на то, что поставщик поддерживает транзакции. Если поставщик поддерживает транзакции, вызвав один из этих методов возвращает ошибку.</P>



После вызова метода **BeginTrans** поставщик фиксируется больше не мгновенно изменения, внесенные, пока не будет вызван **CommitTrans** или **RollbackTrans** для завершения операции.

Для поставщиков, которые поддерживают вложенные транзакции вызов метода **BeginTrans** open транзакции начинается новый, вложенных транзакций. Возвращаемое значение указывает уровня вложенности: возвращаемое значение «1» указывает, был открыт верхнего уровня транзакций (то есть транзакция не вложен в другой транзакции), «2» указывает, что был открыт второго уровня транзакций ( транзакций, включенная в верхнего уровня транзакций), и т. д. Вызов **CommitTrans** или **RollbackTrans** влияет на недавно открытых транзакций; необходимо закрыть или отката текущей операции, чтобы связать любой транзакции более высокого уровня.

Вызов метода **CommitTrans** сохраняет изменения, внесенные в открытую операцию для подключения и заканчивающейся транзакции. Вызов метода **RollbackTrans** отменяет все изменения, внесенные в открытую операцию и заканчивающейся транзакции. Вызов любой из методов, когда нет open транзакции приведет к ошибке.

В зависимости от того, свойство [Attributes](attributes-property-ado.md) объект **подключения** вызов методов параметр **CommitTrans** или **RollbackTrans** автоматически запускать новые транзакции. Если свойство **Attributes** **adXactCommitRetaining**, поставщик автоматически запускает новую транзакцию после **CommitTrans** вызова. Если свойство **Attributes** **adXactAbortRetaining**, поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans** .

**Службы удаленных данных**

Методы **BeginTrans** **CommitTrans**и **RollbackTrans** недоступны на объект **подключения** со стороны клиента.


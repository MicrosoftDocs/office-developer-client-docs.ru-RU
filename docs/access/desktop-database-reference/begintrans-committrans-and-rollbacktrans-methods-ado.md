---
title: Методы BeginTrans, CommitTrans и RollbackTrans (ADO)
TOCTitle: BeginTrans, CommitTrans, and RollbackTrans methods (ADO)
ms:assetid: 9a0415f0-9424-8d1c-4779-92e932292d46
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249694(v=office.15)
ms:contentKeyID: 48546529
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 8d9dc28bd64966e85d16ee2d8cb62fdebc3ba942
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296873"
---
# <a name="begintrans-committrans-and-rollbacktrans-methods-ado"></a>Методы BeginTrans, CommitTrans и RollbackTrans (ADO)

**Область применения**: Access 2013, Office 2013

Эти методы транзакций управляют обработкой транзакций в [объекте Connection](connection-object-ado.md) следующим образом:

- **BeginTrans** — начинает новую транзакцию.

- **CommitTrans** — сохраняет все изменения и завершает текущую транзакцию. Он также может запустить новую транзакцию.

- **RollbackTrans** — отменяет все изменения, внесенные во время текущей транзакции, и завершает транзакцию. Он также может запустить новую транзакцию.

## <a name="syntax"></a>Синтаксис

*level*  =  *object .* BeginTrans()

*object .* BeginTrans

*object .* CommitTrans

*object .* RollbackTrans

## <a name="return-value"></a>Возвращаемое значение

**BeginTrans** можно назвать функцией, которая возвращает переменную **Long,** указывающее уровень вложенности транзакции.

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*object* |Объект **Connection.**|

### <a name="connection"></a>Connection

Используйте эти методы с объектом **Connection,** чтобы сохранить или отменить ряд изменений, внесенных в исходные данные, в качестве одного блока. Например, чтобы перевести деньги между учетными данными, вы вычитайте сумму из одной и добавьте ту же сумму на другую. Если обновление не удастся, учетные записи перестают балансировать. Внесение этих изменений в открытую транзакцию гарантирует, что все или никакие изменения не будут внесены.

> [!NOTE]
> Не все поставщики поддерживают транзакции. Убедитесь, что свойство **Transaction DDL,** определенное поставщиком, отображается в коллекции свойств объекта **Connection,** указывая, что поставщик поддерживает транзакции. [](properties-collection-ado.md) Если поставщик не поддерживает транзакции, вызов одного из этих методов возвратит ошибку.

После вызова метода **BeginTrans** поставщик больше не будет мгновенно фиксировать внесенные изменения, пока вы незовите **CommitTrans** или **RollbackTrans,** чтобы закончить транзакцию.

Для поставщиков, которые поддерживают вложенные транзакции, вызов метода **BeginTrans** в открытой транзакции запускает новую вложенную транзакцию. Возвращаемая величина указывает уровень вложенности: возвращаемого значения "1" означает, что вы открыли транзакцию верхнего уровня (то есть транзакция не вложена в другую транзакцию), "2" означает, что вы открыли транзакцию второго уровня (транзакция, вложенная в транзакцию верхнего уровня) и так далее. Вызов **CommitTrans** или **RollbackTrans** влияет только на самая недавно открытая транзакция; Необходимо закрыть или откатить текущую транзакцию, прежде чем разрешать транзакции более высокого уровня.

Вызов метода **CommitTrans** сохраняет изменения, внесенные в открытой транзакции, и завершает транзакцию. Вызов метода **RollbackTrans отменяет** все изменения, внесенные в открытой транзакции, и завершает транзакцию. Вызов любого метода при отсутствие открытой транзакции создает ошибку.

В зависимости от свойства [Attributes](attributes-property-ado.md) объекта **Connection** вызов методов **CommitTrans** или **RollbackTrans** может автоматически запустить новую транзакцию. Если свойство **Attributes** имеет свойство **adXactCommitRetaining,** поставщик автоматически запускает новую транзакцию после вызова **CommitTrans.** Если свойство **Attributes** имеет свойство **adXactAbortRetaining,** поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans.**

### <a name="remote-data-service"></a>Удаленная служба данных

Методы **BeginTrans,** **CommitTrans** и **RollbackTrans** недоступны в объекте подключения на **стороне** клиента.


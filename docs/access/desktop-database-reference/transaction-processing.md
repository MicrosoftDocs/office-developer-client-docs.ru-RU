---
title: Transaction Processing
TOCTitle: Transaction Processing
ms:assetid: 7cacf3bb-e523-8739-f9ff-c8663c9ddfeb
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249523(v=office.15)
ms:contentKeyID: 48545842
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: c13f25df31bea1eb742b4a7e7c958ccdbfb7274a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314009"
---
# <a name="transaction-processing"></a>Обработка транзакций

**Область применения**: Access 2013, Office 2013

ADO предоставляет следующие методы управления транзакциями: **BeginTrans,** **CommitTrans** и **RollbackTrans.** Используйте эти методы с объектом **Connection,** если вы хотите сохранить или отменить ряд изменений, внесенных в исходные данные, как единая единица. Например, чтобы перевести деньги между учетными данными, вы вычитайте сумму из одной и добавьте ту же сумму на другую. В случае сбой любого из обновлений учетные записи перестают балансировать. Внесение этих изменений в открытую транзакцию гарантирует, что все или никакие изменения не будут внесены.

> [!NOTE]
> Не все поставщики поддерживают транзакции. Убедитесь, что в коллекции свойств объекта **Connection** отображается свойство, [](properties-collection-ado.md) определенное поставщиком "**Transaction DDL",** указывающее, что поставщик поддерживает транзакции. Если поставщик не поддерживает транзакции, вызов одного из этих методов возвратит ошибку.

После вызова метода **BeginTrans** поставщик больше не будет мгновенно фиксировать изменения, внесенные до вызова **CommitTrans** или **RollbackTrans** для окончания транзакции.

Вызов метода **CommitTrans** сохраняет изменения, внесенные в открытой транзакции, в подсети и завершает транзакцию. Вызов метода **RollbackTrans отменяет** все изменения, внесенные в открытой транзакции, и завершает транзакцию. Вызов любого метода при отсутствие открытой транзакции создает ошибку.

В зависимости от свойства [Attributes](attributes-property-ado.md) объекта **Connection** вызов метода **CommitTrans** или **RollbackTrans** может автоматически запустить новую транзакцию. Если для **свойства Attributes** установлено свойство **adXactCommitRetaining,** поставщик автоматически запускает новую транзакцию после вызова **CommitTrans.** Если свойство **Attributes** имеет свойство **adXactAbortRetaining,** поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans.**

## <a name="transaction-isolation-level"></a>Уровень изоляции транзакций

Используйте свойство **IsolationLevel,** чтобы установить уровень изоляции транзакции для объекта **Connection.** Параметр не вступает в силу до следующего вызова метода [BeginTrans.](begintrans-committrans-and-rollbacktrans-methods-ado.md) Если запрашиваемый уровень изоляции недоступен, поставщик может вернуть следующий более высокий уровень изоляции. Дополнительные сведения о допустимых значениях можно найти в свойстве **IsolationLevel** в справочнике программиста ADO.

## <a name="nested-transactions"></a>Вложенные транзакции

Для поставщиков, которые поддерживают вложенные транзакции, вызов метода **BeginTrans** в открытой транзакции запускает новую вложенную транзакцию. Возвращаемая величина указывает уровень вложенности: возвращаемого значения "1" означает, что вы открыли транзакцию верхнего уровня (то есть транзакция не вложена в другую транзакцию), "2" означает, что вы открыли транзакцию второго уровня (транзакция, вложенная в транзакцию верхнего уровня) и так далее. Вызов **CommitTrans** или **RollbackTrans** влияет только на самая недавно открытая транзакция; Необходимо закрыть или откатить текущую транзакцию, прежде чем разрешать транзакции более высокого уровня.


---
title: Transaction Processing
TOCTitle: Transaction Processing
ms:assetid: 7cacf3bb-e523-8739-f9ff-c8663c9ddfeb
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249523(v=office.15)
ms:contentKeyID: 48545842
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: c13f25df31bea1eb742b4a7e7c958ccdbfb7274a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314009"
---
# <a name="transaction-processing"></a>Обработка транзакций

**Область применения**: Access 2013, Office 2013

ADO предоставляет следующие методы для управления транзакциями: **BeginTrans**, **CommitTrans**и **RollbackTrans**. Используйте эти методы вместе с объектом **Connection** , если необходимо сохранить или отменить серию изменений, внесенных в источник данных, как единое целое. Например, чтобы перенести деньги между учетными записями, можно вычесть сумму из единицы и добавить одинаковую сумму к другому. Если обновление завершается сбоем, учетные записи больше не сбалансированы. Внесение этих изменений в открытую транзакцию гарантирует, что все изменения не проходят или не проходят какие либо никакие изменения.

> [!NOTE]
> Не все поставщики поддерживают транзакции. Убедитесь, что свойство "**Transaction DDL**", определяемое поставщиком, отображается в коллекции [свойств](properties-collection-ado.md) объекта **Connection** , указывая, что поставщик поддерживает транзакции. Если поставщик не поддерживает транзакции, то при вызове одного из этих методов возвращается ошибка.

После вызова метода **BeginTrans** поставщик больше не будет выполнять изменения, пока не будет вызвана **CommitTrans** или **RollbackTrans** для завершения транзакции.

При вызове метода **CommitTrans** сохраняются изменения, внесенные в открытую транзакцию для подключения, и завершается транзакция. Вызов метода **RollbackTrans** отменяет все изменения, внесенные в открытую транзакцию, и завершает транзакцию. Вызов любого метода при отсутствии открытой транзакции приводит к ошибке.

В зависимости от свойства [Attribute](attributes-property-ado.md) объекта **Connection** , вызов метода **CommitTrans** или **RollbackTrans** может автоматически запустить новую транзакцию. Если для **** свойства Attributes задано значение **адксакткоммитретаининг**, поставщик автоматически запускает новую транзакцию после вызова **CommitTrans** . Если для **** свойства Attributes задано значение **адксактабортретаининг**, поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans** .

## <a name="transaction-isolation-level"></a>Уровень изоляции транзакции

Используйте свойство **IsolationLevel** , чтобы задать уровень изоляции транзакции для объекта **Connection** . Параметр не вступает в силу до следующего вызова метода [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md) . Если уровень изоляции, который вы запрашиваете, недоступен, поставщик может вернуть следующий более высокий уровень изоляции. Для получения дополнительных сведений о допустимых значениях обратитесь к свойству **IsolationLevel** в справочнике программиста по ADO.

## <a name="nested-transactions"></a>Вложенные транзакции

Для поставщиков, поддерживающих вложенные транзакции, вызов метода **BeginTrans** в открытой транзакции начинает новую вложенную транзакцию. Возвращаемое значение указывает уровень вложенности: возвращаемое значение "1" указывает на то, что вы открыли транзакцию верхнего уровня (то есть транзакция не является вложенной в другую транзакцию), "2" указывает на то, что вы открыли транзакцию второго уровня ( транзакция, вложенная в транзакцию верхнего уровня, и т. д. Вызов **CommitTrans** или **RollbackTrans** влияет только на самую последнюю открытую транзакцию; Прежде чем можно будет разрешить транзакции верхнего уровня, необходимо закрыть или откатить текущую транзакцию.


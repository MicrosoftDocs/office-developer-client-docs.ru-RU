---
title: Transaction Processing
TOCTitle: Transaction Processing
ms:assetid: 7cacf3bb-e523-8739-f9ff-c8663c9ddfeb
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249523(v=office.15)
ms:contentKeyID: 48545842
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: c13f25df31bea1eb742b4a7e7c958ccdbfb7274a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314009"
---
# <a name="transaction-processing"></a><span data-ttu-id="b14f8-102">Обработка транзакций</span><span class="sxs-lookup"><span data-stu-id="b14f8-102">Transaction processing</span></span>

<span data-ttu-id="b14f8-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="b14f8-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="b14f8-104">ADO предоставляет следующие методы управления транзакциями: **BeginTrans,** **CommitTrans** и **RollbackTrans.**</span><span class="sxs-lookup"><span data-stu-id="b14f8-104">ADO provides the following methods for controlling transactions: **BeginTrans**, **CommitTrans**, and **RollbackTrans**.</span></span> <span data-ttu-id="b14f8-105">Используйте эти методы с объектом **Connection,** если вы хотите сохранить или отменить ряд изменений, внесенных в исходные данные, как единая единица.</span><span class="sxs-lookup"><span data-stu-id="b14f8-105">Use these methods with a **Connection** object when you want to save or cancel a series of changes made to the source data as a single unit.</span></span> <span data-ttu-id="b14f8-106">Например, чтобы перевести деньги между учетными данными, вы вычитайте сумму из одной и добавьте ту же сумму на другую.</span><span class="sxs-lookup"><span data-stu-id="b14f8-106">For example, to transfer money between accounts, you subtract an amount from one and add the same amount to the other.</span></span> <span data-ttu-id="b14f8-107">В случае сбой любого из обновлений учетные записи перестают балансировать.</span><span class="sxs-lookup"><span data-stu-id="b14f8-107">If either update fails, the accounts no longer balance.</span></span> <span data-ttu-id="b14f8-108">Внесение этих изменений в открытую транзакцию гарантирует, что все или никакие изменения не будут внесены.</span><span class="sxs-lookup"><span data-stu-id="b14f8-108">Making these changes within an open transaction ensures that either all or none of the changes go through.</span></span>

> [!NOTE]
> <span data-ttu-id="b14f8-109">Не все поставщики поддерживают транзакции.</span><span class="sxs-lookup"><span data-stu-id="b14f8-109">Not all providers support transactions.</span></span> <span data-ttu-id="b14f8-110">Убедитесь, что в коллекции свойств объекта **Connection** отображается свойство, [](properties-collection-ado.md) определенное поставщиком "**Transaction DDL",** указывающее, что поставщик поддерживает транзакции.</span><span class="sxs-lookup"><span data-stu-id="b14f8-110">Verify that the provider-defined property "**Transaction DDL**" appears in the **Connection** object's [Properties](properties-collection-ado.md) collection, indicating that the provider supports transactions.</span></span> <span data-ttu-id="b14f8-111">Если поставщик не поддерживает транзакции, вызов одного из этих методов возвратит ошибку.</span><span class="sxs-lookup"><span data-stu-id="b14f8-111">If the provider does not support transactions, calling one of these methods will return an error.</span></span>

<span data-ttu-id="b14f8-112">После вызова метода **BeginTrans** поставщик больше не будет мгновенно фиксировать изменения, внесенные до вызова **CommitTrans** или **RollbackTrans** для окончания транзакции.</span><span class="sxs-lookup"><span data-stu-id="b14f8-112">After you call the **BeginTrans** method, the provider will no longer instantaneously commit changes you make until you call **CommitTrans** or **RollbackTrans** to end the transaction.</span></span>

<span data-ttu-id="b14f8-113">Вызов метода **CommitTrans** сохраняет изменения, внесенные в открытой транзакции, в подсети и завершает транзакцию.</span><span class="sxs-lookup"><span data-stu-id="b14f8-113">Calling the **CommitTrans** method saves changes made within an open transaction on the connection and ends the transaction.</span></span> <span data-ttu-id="b14f8-114">Вызов метода **RollbackTrans отменяет** все изменения, внесенные в открытой транзакции, и завершает транзакцию.</span><span class="sxs-lookup"><span data-stu-id="b14f8-114">Calling the **RollbackTrans** method reverses any changes made within an open transaction and ends the transaction.</span></span> <span data-ttu-id="b14f8-115">Вызов любого метода при отсутствие открытой транзакции создает ошибку.</span><span class="sxs-lookup"><span data-stu-id="b14f8-115">Calling either method when there is no open transaction generates an error.</span></span>

<span data-ttu-id="b14f8-116">В зависимости от свойства [Attributes](attributes-property-ado.md) объекта **Connection** вызов метода **CommitTrans** или **RollbackTrans** может автоматически запустить новую транзакцию.</span><span class="sxs-lookup"><span data-stu-id="b14f8-116">Depending on the **Connection** object's [Attributes](attributes-property-ado.md) property, calling either the **CommitTrans** or **RollbackTrans** method may automatically start a new transaction.</span></span> <span data-ttu-id="b14f8-117">Если для **свойства Attributes** установлено свойство **adXactCommitRetaining,** поставщик автоматически запускает новую транзакцию после вызова **CommitTrans.**</span><span class="sxs-lookup"><span data-stu-id="b14f8-117">If the **Attributes** property is set to **adXactCommitRetaining**, the provider automatically starts a new transaction after a **CommitTrans** call.</span></span> <span data-ttu-id="b14f8-118">Если свойство **Attributes** имеет свойство **adXactAbortRetaining,** поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans.**</span><span class="sxs-lookup"><span data-stu-id="b14f8-118">If the **Attributes** property is set to **adXactAbortRetaining**, the provider automatically starts a new transaction after a **RollbackTrans** call.</span></span>

## <a name="transaction-isolation-level"></a><span data-ttu-id="b14f8-119">Уровень изоляции транзакций</span><span class="sxs-lookup"><span data-stu-id="b14f8-119">Transaction isolation level</span></span>

<span data-ttu-id="b14f8-120">Используйте свойство **IsolationLevel,** чтобы установить уровень изоляции транзакции для объекта **Connection.**</span><span class="sxs-lookup"><span data-stu-id="b14f8-120">Use the **IsolationLevel** property to set the isolation level of a transaction on a **Connection** object.</span></span> <span data-ttu-id="b14f8-121">Параметр не вступает в силу до следующего вызова метода [BeginTrans.](begintrans-committrans-and-rollbacktrans-methods-ado.md)</span><span class="sxs-lookup"><span data-stu-id="b14f8-121">The setting does not take effect until the next time you call the [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md) method.</span></span> <span data-ttu-id="b14f8-122">Если запрашиваемый уровень изоляции недоступен, поставщик может вернуть следующий более высокий уровень изоляции.</span><span class="sxs-lookup"><span data-stu-id="b14f8-122">If the level of isolation you request is unavailable, the provider may return the next greater level of isolation.</span></span> <span data-ttu-id="b14f8-123">Дополнительные сведения о допустимых значениях можно найти в свойстве **IsolationLevel** в справочнике программиста ADO.</span><span class="sxs-lookup"><span data-stu-id="b14f8-123">Refer to the **IsolationLevel** property in the ADO programmer's reference for more details on valid values.</span></span>

## <a name="nested-transactions"></a><span data-ttu-id="b14f8-124">Вложенные транзакции</span><span class="sxs-lookup"><span data-stu-id="b14f8-124">Nested transactions</span></span>

<span data-ttu-id="b14f8-125">Для поставщиков, которые поддерживают вложенные транзакции, вызов метода **BeginTrans** в открытой транзакции запускает новую вложенную транзакцию.</span><span class="sxs-lookup"><span data-stu-id="b14f8-125">For providers that support nested transactions, calling the **BeginTrans** method within an open transaction starts a new, nested transaction.</span></span> <span data-ttu-id="b14f8-126">Возвращаемая величина указывает уровень вложенности: возвращаемого значения "1" означает, что вы открыли транзакцию верхнего уровня (то есть транзакция не вложена в другую транзакцию), "2" означает, что вы открыли транзакцию второго уровня (транзакция, вложенная в транзакцию верхнего уровня) и так далее.</span><span class="sxs-lookup"><span data-stu-id="b14f8-126">The return value indicates the level of nesting: a return value of "1" indicates you have opened a top-level transaction (that is, the transaction is not nested within another transaction), "2" indicates that you have opened a second-level transaction (a transaction nested within a top-level transaction), and so forth.</span></span> <span data-ttu-id="b14f8-127">Вызов **CommitTrans** или **RollbackTrans** влияет только на самая недавно открытая транзакция; Необходимо закрыть или откатить текущую транзакцию, прежде чем разрешать транзакции более высокого уровня.</span><span class="sxs-lookup"><span data-stu-id="b14f8-127">Calling **CommitTrans** or **RollbackTrans** affects only the most recently opened transaction; you must close or roll back the current transaction before you can resolve any higher-level transactions.</span></span>


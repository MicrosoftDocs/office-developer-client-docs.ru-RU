---
title: Обработка транзакций
TOCTitle: Transaction Processing
ms:assetid: 7cacf3bb-e523-8739-f9ff-c8663c9ddfeb
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249523(v=office.15)
ms:contentKeyID: 48545842
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 24e7940c86b079d5eb51fa894426a19e7700bf39
ms.sourcegitcommit: 38d0db57580cc5f4a0231c27b1643f8db5431ca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2018
ms.locfileid: "25937486"
---
# <a name="transaction-processing"></a>Обработка транзакций


**Применимо к**: Access 2013, Office 2013

ADO предоставляет следующие методы для управления транзакции: **BeginTrans** **CommitTrans**и **RollbackTrans**. Использование этих методов с объектом **подключения** необходимо сохранить или отменить ряд изменений, внесенных в источник данных как единый элемент. К примеру деньги переключение между учетными записями, вы вычесть сумму из одного и добавьте совпадает со значением в другой. Если либо обновить возникает ошибка, больше не сбалансировать учетные записи. Эти изменения в открытую операцию гарантирует, что все или изменения проходят через.


> [!NOTE]
> <P>Не все поставщики поддерживают транзакции. Убедитесь, что поставщик, определенный «<STRONG>DDL транзакций</STRONG>» отображается в коллекции <A href="properties-collection-ado.md">свойств</A> объекта <STRONG>подключения</STRONG> , указывающего на то, что поставщик поддерживает транзакции. Если поставщик поддерживает транзакции, вызвав один из этих методов возвращает ошибку.</P>



После вызова метода **BeginTrans** поставщик фиксируется больше не мгновенно изменения, внесенные, пока не будет вызван **CommitTrans** или **RollbackTrans** для завершения операции.

Вызов метода **CommitTrans** сохраняет изменения, внесенные в открытую операцию для подключения и заканчивающейся транзакции. Вызов метода **RollbackTrans** отменяет все изменения, внесенные в открытую операцию и заканчивающейся транзакции. Вызов любой из методов, когда нет open транзакции приведет к ошибке.

В зависимости от того, свойство [Attributes](attributes-property-ado.md) объект **подключения** вызов метода параметр **CommitTrans** или **RollbackTrans** автоматически запускать новые транзакции. Если свойство **Attributes** **adXactCommitRetaining**, поставщик автоматически запускает новую транзакцию после **CommitTrans** вызова. Если свойство **Attributes** **adXactAbortRetaining**, поставщик автоматически запускает новую транзакцию после вызова **RollbackTrans** .

## <a name="transaction-isolation-level"></a>Уровень изоляции транзакций

Используйте свойство **IsolationLevel** установить уровень изоляции транзакции для объекта **подключения** . Параметр не вступят в силу только при следующем вызове метода [BeginTrans](begintrans-committrans-and-rollbacktrans-methods-ado.md) . Если уровень изоляции, которые вы запрашиваете недоступен, поставщик может возвращать Далее больший уровень изоляции. Обращайтесь к свойству **IsolationLevel** Справочник программиста ADO для получения дополнительных сведений о допустимые значения.

## <a name="nested-transactions"></a>Вложенные транзакции

Для поставщиков, которые поддерживают вложенные транзакции вызов метода **BeginTrans** open транзакции начинается новый, вложенных транзакций. Возвращаемое значение указывает уровня вложенности: возвращаемое значение «1» указывает, был открыт верхнего уровня транзакций (то есть транзакция не вложен в другой транзакции), «2» указывает, что был открыт второго уровня транзакций ( транзакций, включенная в верхнего уровня транзакций), и т. д. Вызов **CommitTrans** или **RollbackTrans** влияет на недавно открытых транзакций; необходимо закрыть или отката текущей операции, чтобы связать любой транзакции более высокого уровня.


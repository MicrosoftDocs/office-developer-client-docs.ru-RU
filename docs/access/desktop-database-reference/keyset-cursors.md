---
title: Курсоры Keyset (справочник по базам данных Access для настольных ПК)
TOCTitle: Keyset cursors
ms:assetid: 4b6e5f90-4413-4fb3-0a08-2cb89d3c61f7
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249236(v=office.15)
ms:contentKeyID: 48544690
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 200b10599683a5b5877952664c04e94b2523cfee
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32290717"
---
# <a name="keyset-cursors"></a>Курсоры наборов ключей

**Область применения**: Access 2013, Office 2013

Курсор наборов клавиш обеспечивает функциональность между статическим и динамическим курсором в возможности обнаружения изменений. Как и статический курсор, он не всегда обнаруживает изменения членства и порядка набора результатов. Как и динамический курсор, он обнаруживает изменения значений строк в наборе результатов.

Курсоры на основе набора клавиш управляются набором уникальных идентификаторов (ключей), известных как набор ключей. Ключи построены из набора столбцов, которые уникальным образом идентифицируют строки в наборе результатов. Набор ключей — это набор ключевых значений из всех строк, возвращаемого в запросе.

С помощью курсоров на основе наборов клавиш ключ строится и сохраняется для каждой строки курсора и сохраняется на клиентской рабочей станции или на сервере. При доступе к каждой строке сохраненный ключ используется для получения текущих значений данных из источника данных. В курсоре на основе набора клавиш членство в наборе результатов заморозкается, когда набор ключей заполняется полностью. После этого добавления или обновления, влияющие на членство, не будут в составе набора результатов до повторного открытия.

Изменения значений данных (сделанные владельцем набора ключей или другими процессами) видны, когда пользователь прокручивает набор результатов. Вставки, сделанные вне курсора (другими процессами), видны только в том случае, если курсор закрыт и открыт повторно. Вставки, сделанные из курсора, видны в конце набора результатов.

Когда курсор на основе набора клавиш пытается получить удаленную строку, строка отображается в наборе результатов как "неверная". Ключ для строки существует в наборе ключей, но строка больше не существует в наборе результатов. Если значения ключей в строке обновлены, считается, что строка была удалена, а затем вставлена, поэтому такие строки также отображаются в наборе результатов как вехи. Курсор на основе наборов клавиш всегда может обнаруживать строки, удаленные другими процессами, но при желании он может удалить ключи для строк, которые он сам удаляет. Курсоры на основе keyset, которые делают это, не могут обнаружить собственные удаления, так как свидетельство было удалено.

Обновление ключевого столбца выполняется как удаление старого ключа и вставка нового ключа. Новое значение ключа не отображается, если обновление не было выполнено с помощью курсора. Если обновление было выполнено с помощью курсора, новое значение клавиши отображается в конце набора результатов.

Существует вариант курсоров на основе наборов клавиш, называемых стандартными курсорами на основе наборов клавиш. В стандартном курсоре на основе набора клавиш членство строк в наборе результатов и порядок строк фиксируются во время открытия курсора, но изменения значений, сделанных владельцем курсора и внесенные другими процессами изменения видны. Если изменение аннулирует членство в строке или влияет на порядок строки, она не исчезает и не перемещается, пока курсор не будет закрыт и повторно открыт. Вставленные данные не отображаются, но изменения существующих данных отображаются при извлечении строк.

Курсор, управляемый набором клавиш, сложно использовать правильно, так как чувствительность к изменениям данных зависит от множества различных условий, как описано выше. Однако если ваше приложение не связано с одновременно обновляющимися данными, может программным образом обрабатывать неудачные ключи и должно получать прямой доступ к определенным строкам с ключами, курсор на основе наборов клавиш может вам помочь. Используйте **adOpenKeyset** **CursorTypeEnum,** чтобы указать, что вы хотите использовать курсор наборов клавиш в ADO.


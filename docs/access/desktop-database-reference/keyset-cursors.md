---
title: Курсоры KEYSET (Справочник по базам данных Access на компьютере)
TOCTitle: Keyset cursors
ms:assetid: 4b6e5f90-4413-4fb3-0a08-2cb89d3c61f7
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249236(v=office.15)
ms:contentKeyID: 48544690
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 200b10599683a5b5877952664c04e94b2523cfee
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32290717"
---
# <a name="keyset-cursors"></a>Курсоры наборов ключей

**Область применения**: Access 2013, Office 2013

Курсор KEYSET предоставляет функциональные возможности между статическим и динамическим курсором в возможности обнаружения изменений. Как и статический курсор, он не всегда обнаруживает изменения членства и порядка набора результатов. Как и динамический курсор, он обнаруживает изменения значений строк в наборе результатов.

Управляемые набором ключей курсоры управляются набором уникальных идентификаторов (ключами), называемых набором ключей. Ключи создаются из набора столбцов, которые уникально идентифицируют строки в наборе результатов. KEYSET — это набор ключевых значений из всех строк, возвращенных оператором запроса.

При использовании курсоров, управляемых набором ключей, ключ создается и сохраняется для каждой строки в курсоре и хранится либо на клиентской рабочей станции, либо на сервере. При доступе к каждой строке хранимый ключ используется для получения текущих значений данных из источника данных. В курсоре, управляемом набором ключей, членство в результирующем наборе заморожено при полном заполнении набора ключей. После этого дополнения и обновления, затрагивающие членство, не входят в набор результатов до повторного открытия.

Изменение значений данных (сделанных с помощью владельца набора ключей или других процессов) отображается при прокрутке набора результатов пользователем. Вставки, сделанные снаружи курсора (другими процессами), отображаются только в том случае, если курсор закрыт и повторно открыт. Вставки, выполненные внутри курсора, отображаются в конце набора результатов.

Когда курсор, управляемый набором ключей, пытается получить удаленную строку, строка отображается в наборе результатов как "отверстие". Ключ для строки существует в наборе ключей, но строка больше не существует в наборе результатов. Если ключевые значения в строке обновлены, строка считается удаленной и вставленной, поэтому такие строки также отображаются как отверстия в наборе результатов. В то время как курсор, управляемый набором ключей, всегда может определять строки, удаленные другими процессами, он может при необходимости удалять ключи для строк, которые он удаляет. Курсоры, управляемые набором ключей, не могут обнаруживать свои действия по удалению, так как свидетельство удалено.

Обновление ключевого столбца действует аналогично удалению старого ключа, за которым следует Вставка нового ключа. Новое значение ключа не отображается, если обновление не было выполнено с помощью курсора. Если обновление выполнялось с помощью курсора, в конце набора результатов отображается новое значение ключа.

В курсорах, управляемых набором ключей, есть варианты, называемые стандартными курсорами, управляемыми набором ключей. В стандартном курсоре, основанном на наборе ключей, членство строк в наборе результатов и порядок строк зафиксированы в момент открытия курсора, но изменяются значения, внесенные владельцем курсора и подтвержденными изменениями, внесенными другими процессами. Если изменение раскрывает строку для членства или влияет на порядок строки, эта строка не исчезает или перемещается, пока курсор не будет закрыт и повторно открыт. Вставленные данные не отображаются, но изменения существующих данных отображаются при получении строк.

Курсоры, управляемые набором ключей, трудно использовать правильно, так как чувствительность к изменениям данных зависит от множества различных обстоятельств, описанных выше. Тем не менее, если приложение не работает с параллельными обновлениями, может программно обрабатывать неправильные ключи и получать прямой доступ к определенным строкам с ключами, управляемый с помощью набора ключей курсор может работать. Используйте **адопенкэйсет** **курсортипинум** , чтобы указать, что вы хотите использовать курсор KEYSET в ADO.


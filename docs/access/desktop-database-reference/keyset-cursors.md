---
title: Набор ключей курсоры (Справочник по для настольных баз данных Access)
TOCTitle: Keyset cursors
ms:assetid: 4b6e5f90-4413-4fb3-0a08-2cb89d3c61f7
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249236(v=office.15)
ms:contentKeyID: 48544690
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 200b10599683a5b5877952664c04e94b2523cfee
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28721922"
---
# <a name="keyset-cursors"></a>Курсоры наборов ключей

**Применимо к**: Access 2013, Office 2013

Курсор набора ключей предоставляет функциональные возможности между статический и динамический курсор в возможности для обнаружения изменений. Как статический курсор он не всегда находит изменения членства и порядок набора результатов. Как динамического курсора обнаруживать изменения значений строк в наборе результатов.

Курсоры управляются с помощью набора уникальных идентификаторов (ключи) — ключей. Ключи создаются из набора столбцов, которые однозначно идентифицируют строки в наборе результатов. Набор ключей — это набор ключевых значений всех строк, возвращаемых оператором запроса.

С помощью курсоры ключ построена и сохранения для каждой строки в текущей позиции и хранятся на клиентском компьютере или на сервере. При получении доступа к каждой строки, сохраненные ключ используется для получения текущего значения данных из источника данных. В текущей позиции с набором ключей членство в набор результатов останавливается, когда набор ключей полностью заполнен. После этого добавления или обновления, которые влияют на членство не являющихся частью результирующего набора до его повторном открытии.

Изменение значений данных (доступного либо владелец набора ключей или другими процессами) отображаются при прокрутке набора результатов. Вставки, выполненные за пределами курсора (другими процессами) видны только в том случае, если курсор закрыт и открыт повторно. Вставка, созданную в пределах в видны в конце набора результатов.

На основе набора ключей курсора пытается получить строку, которая была удалена, строке отображается как «дыра» в наборе результатов. Ключ для строки существует в набор ключей, но строку больше не существует в наборе результатов. Если при обновлении значений ключей в строке строку считается удален и затем вставлен таким такие строки также отображаются как отверстия в наборе результатов. Пока курсор на основе набора ключей всегда можно обнаружить строк, удаленных с другими процессами, его можно удалить ключи для строк, которые он удаляет себя. Курсоры, которые этого не может определить собственные удаления, так как свидетельство было удалено.

Обновление ключа действует как удалить старые ключа последующей вставкой нового ключа. Новое значение ключа не отображается, если обновление не было выполнено через курсор. Если обновление было выполнено через курсор, новое значение ключа отображается в конце набора результатов.

Нет вариантов на курсоры называется standard курсоры. В стандартный курсор на основе набора ключей членство строк в результирующем наборе и порядок строк фиксированных во время открытия курсора, но изменения, внесенные владельцем курсора и применить изменения, внесенные другими процессами, доступны. Если изменение disqualifies строку для контроля членства или влияет на порядок строки, строки не исчезают или переместите пока курсор закрывается и открывается повторно. Вставленный данных не отображается, но изменения существующих данных отображаются как извлекаемых строк.

Указатель на основе набора ключей сложно использовать правильно так, как уровень конфиденциальности сообщения для изменения данных зависит от многих различных случаях, как описано выше. Тем не менее если приложение не отвечает за параллельных обновлений, программными средствами можно обрабатывать bad ключей и должен прямого доступа к определенные строки с ключом, курсор на основе набора ключей может решить проблему. Чтобы указать, что вы хотите использовать курсор набора ключей в ADO используйте **adOpenKeyset** **CursorTypeEnum** .


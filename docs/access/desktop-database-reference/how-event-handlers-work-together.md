---
title: Взаимодействие обработчиков событий
TOCTitle: How event handlers work together
ms:assetid: 02122824-881e-0bb8-cba1-c963024790ae
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248788(v=office.15)
ms:contentKeyID: 48542951
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e772e93f27d6bb5f30d865e3435d4bde6bdc5e73
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291924"
---
# <a name="how-event-handlers-work-together"></a>Взаимодействие обработчиков событий

**Область применения**: Access 2013, Office 2013

Если вы не программировали в Visual Basic, все обработчики событий для событий **Подключения** и **Recordset** должны быть реализованы независимо от того, обрабатываете ли вы все события. Объем работы по реализации зависит от языка программирования. Дополнительные сведения см. в [сообщении ADO Event Instantiation by Language.](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/ado-event-instantiation-by-language-ado)

## <a name="paired-event-handlers"></a>Сопряженные обработчики событий

Каждый обработник событий Will имеет связанный обработок событий Complete. Например, когда приложение меняет значение поля, обработник **событий WillChangeField** называется. Если изменение допустимо, приложение оставляет параметр **adStatus** без изменений и операция выполняется. По завершению операции **событие FieldChangeComplete** сообщает приложению о том, что операция завершена. Если оно успешно завершено, **adStatus содержит** **adStatusOK;** в **противном случае adStatus** содержит **adStatusErrorsOccurred,** и для определения причины ошибки необходимо проверить объект **Error.**

Когда **будет вызвано WillChangeField,** вы можете определить, что изменение не должно быть сделано. В этом случае установите **adStatus** **в adStatusCancel**. Операция отменяется, и **событие FieldChangeComplete** получает значение **adStatus adStatusErrorsOccurred.**  Объект **Error** содержит **adErrOperationCancelled,** чтобы обработщик **FieldChangeComplete** знал, что операция была отменена. Однако перед его изменением необходимо проверить значение параметра **adStatus,** так как установка **adStatus** **в adStatusCancel** не влияет, если параметр был задан **для adStatusCantDeny** при входе в процедуру.

Иногда операция может собрать несколько событий. Например, объект **Recordset имеет** сопряженные события для изменений **поля** и **записи.** Когда ваше приложение изменяет значение **поля,** обработник **событий WillChangeField** называется. Если он определяет, что операция может продолжаться, также поднят обработник событий **WillChangeRecord.** Если этот обработчик также позволяет продолжить событие, это изменение выполнено и вызваны обработчики событий **FieldChangeComplete** и **RecordChangeComplete.** Порядок вызова обработчиков событий Will для определенной операции не определен, поэтому следует избегать написания кода, который зависит от обработчиков вызовов в определенной последовательности.

В случаях, когда будет поднято несколько событий Will, одно из событий может отменить ожидаемую операцию. Например, когда приложение меняет значение **поля,** обычно будут вызваны обработчики событий **WillChangeField** и **WillChangeRecord.** Однако, если операция отменяется в первом обработщике событий, ее связанный обработщик Complete немедленно вызван **с помощью adStatusOperationCancelled.** Второй обработок никогда не называется. Если, однако, обработник первого события позволяет продолжить событие, будет вызван другой обработник событий. Если она отменит операцию, оба события Complete будут вызваны, как в предыдущих примерах.

## <a name="unpaired-event-handlers"></a>Неоплаченные обработчики событий

До тех пор, пока статус, переданный событию, не **является adStatusCantDeny,** вы можете отключить уведомления о событиях для любого события, возвращая **adStatusUnwantedEvent** в *параметре Status.* Например, когда обработитель событий Complete вызван в первый раз, можно вернуть **adStatusUnwantedEvent.** Впоследствии вы будете получать только события Will. Однако некоторые события можно запускать по нескольким причинам. В этом случае событие будет иметь параметр *Reason.* Когда вы возвращаете **adStatusUnwantedEvent,** вы прекратите получать уведомления для этого события только тогда, когда они происходят по этой конкретной причине. Другими словами, вы потенциально будете получать уведомления по каждой возможной причине, по которой событие может быть вызвано.

Обработчики событий Single Will могут быть полезны при проверке параметров, которые будут использоваться в операции. Эти параметры операции можно изменить или отменить.

Кроме того, оставьте включенное уведомление о событии Complete. Когда вызван первый обработитель событий Will, **верните adStatusUnwantedEvent**. Впоследствии вы будете получать только полные события.

Обработчики событий Single Complete могут быть полезны для управления асинхронными операциями. Каждая асинхронная операция имеет соответствующее событие Complete.

Например, заполнение большого объекта [Recordset](recordset-object-ado.md) может занять много времени. Если приложение правильно записано, можно начать операцию и продолжить другую обработку. В конечном итоге вы будете уведомлены, когда **набор recordset** заполняется **событием ExecuteComplete.**

## <a name="single-event-handlers-and-multiple-objects"></a>Обработчики одного события и несколько объектов

Гибкость языка программирования, например Microsoft Visual C++ позволяет иметь одно событие обработки событий из нескольких объектов. Например, может быть один обработник **событий Отключения** из нескольких объектов **Подключения.** Если одно из подключений завершено, будет вызван обработок событий **Disconnect.** Можно сказать, какое подключение вызвало событие, так как параметр объекта обработки событий будет задан соответствующему **объекту Подключения.**

> [!NOTE]
> Этот метод нельзя использовать в Visual Basic, так как этот язык может соотносить только один объект с обработить событие.



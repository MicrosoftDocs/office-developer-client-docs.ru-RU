---
title: Совместная работа обработчиков событий
TOCTitle: How event handlers work together
ms:assetid: 02122824-881e-0bb8-cba1-c963024790ae
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248788(v=office.15)
ms:contentKeyID: 48542951
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: a397b0f88bb60552a6e53432a3c8c4d788013103
ms.sourcegitcommit: 1dd744993ecb4bed241ace874ad26edaef1778b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2018
ms.locfileid: "25997275"
---
# <a name="how-event-handlers-work-together"></a><span data-ttu-id="f5bea-102">Совместная работа обработчиков событий</span><span class="sxs-lookup"><span data-stu-id="f5bea-102">How event handlers work together</span></span>

<span data-ttu-id="f5bea-103">**Применимо к**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="f5bea-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="f5bea-104">Если не программирования в Visual Basic все обработчики событий для события **подключения** и **записей** должен быть реализован, независимо от того, ли вы фактически обрабатывают все события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-104">Unless you are programming in Visual Basic, all event handlers for **Connection** and **Recordset** events must be implemented, regardless of whether you actually process all of the events.</span></span> <span data-ttu-id="f5bea-105">Объем работы реализации, что вам нужно сделать зависит от языка программирования.</span><span class="sxs-lookup"><span data-stu-id="f5bea-105">The amount of implementation work you have to do depends on your programming language.</span></span> <span data-ttu-id="f5bea-106">Для получения дополнительных сведений см [При создании экземпляра события ADO по языкам](https://msdn.microsoft.com/library/jj250244\(v=office.15\)).</span><span class="sxs-lookup"><span data-stu-id="f5bea-106">For more information, see [ADO Event Instantiation by Language](https://msdn.microsoft.com/library/jj250244\(v=office.15\)).</span></span>

## <a name="paired-event-handlers"></a><span data-ttu-id="f5bea-107">Обработчики событий парного</span><span class="sxs-lookup"><span data-stu-id="f5bea-107">Paired event handlers</span></span>

<span data-ttu-id="f5bea-108">Каждый обработчик событий будет имеет связанные полный обработчик.</span><span class="sxs-lookup"><span data-stu-id="f5bea-108">Each Will event handler has an associated Complete event handler.</span></span> <span data-ttu-id="f5bea-109">Например при изменении значения поля приложения называется обработчика событий **WillChangeField** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-109">For example, when your application changes the value of a field, the **WillChangeField** event handler is called.</span></span> <span data-ttu-id="f5bea-110">Если изменить допустима, приложение покидает параметр **adStatus** без изменений и выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="f5bea-110">If the change is acceptable, your application leaves the **adStatus** parameter unchanged and the operation is performed.</span></span> <span data-ttu-id="f5bea-111">После завершения операции, **FieldChangeComplete** событие уведомляет приложение, которое завершения операции.</span><span class="sxs-lookup"><span data-stu-id="f5bea-111">When the operation completes, a **FieldChangeComplete** event notifies your application that the operation has finished.</span></span> <span data-ttu-id="f5bea-112">Если успешно завершена, **adStatus** содержит **adStatusOK**; в противном случае **adStatus** содержит **adStatusErrorsOccurred** и необходимо проверить объект **Error** , чтобы определить причину ошибки.</span><span class="sxs-lookup"><span data-stu-id="f5bea-112">If it completed successfully, **adStatus** contains **adStatusOK**; otherwise, **adStatus** contains **adStatusErrorsOccurred** and you must check the **Error** object to determine the cause of the error.</span></span>

<span data-ttu-id="f5bea-113">При вызове **WillChangeField** можно указать, что изменения не следует делать.</span><span class="sxs-lookup"><span data-stu-id="f5bea-113">When **WillChangeField** is called, you might determine that the change should not be made.</span></span> <span data-ttu-id="f5bea-114">В этом случае значение **adStatusCancel** **adStatus** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-114">In that case, set **adStatus** to **adStatusCancel**.</span></span> <span data-ttu-id="f5bea-115">Операция отменена и события **FieldChangeComplete** получает значение **adStatus** **adStatusErrorsOccurred**.</span><span class="sxs-lookup"><span data-stu-id="f5bea-115">The operation is canceled and the **FieldChangeComplete** event receives an **adStatus** value of **adStatusErrorsOccurred**.</span></span> <span data-ttu-id="f5bea-116">Объект **Error** содержит **adErrOperationCancelled** , чтобы обработчик **FieldChangeComplete** знала, что операция отменена.</span><span class="sxs-lookup"><span data-stu-id="f5bea-116">The **Error** object contains **adErrOperationCancelled** so that your **FieldChangeComplete** handler knows that the operation was canceled.</span></span> <span data-ttu-id="f5bea-117">Тем не менее следует проверить значение параметра **adStatus** перед изменением, так как параметр **adStatus** для **adStatusCancel** не оказывает влияния, если параметр было задано значение **adStatusCantDeny** на запись к процедуре.</span><span class="sxs-lookup"><span data-stu-id="f5bea-117">However, you need to check the value of the **adStatus** parameter before changing it, because setting **adStatus** to **adStatusCancel** has no effect if the parameter was set to **adStatusCantDeny** on entry to the procedure.</span></span>

<span data-ttu-id="f5bea-118">В некоторых случаях операции могут вызывать более одного события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-118">Sometimes an operation can raise more than one event.</span></span> <span data-ttu-id="f5bea-119">Например объекта **набора записей** пару событий для изменения **поля** и изменения **записей** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-119">For example, the **Recordset** object has paired events for **Field** changes and **Record** changes.</span></span> <span data-ttu-id="f5bea-120">Когда приложение изменяется значение **поля**, вызывает обработчик события **WillChangeField** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-120">When your application changes the value of a **Field**, the **WillChangeField** event handler is called.</span></span> <span data-ttu-id="f5bea-121">Если он определяет, что можно продолжить операцию, обработчик событий **WillChangeRecord** также вызывается.</span><span class="sxs-lookup"><span data-stu-id="f5bea-121">If it determines that the operation can continue, the **WillChangeRecord** event handler is also raised.</span></span> <span data-ttu-id="f5bea-122">Если этот обработчик также позволяет событие продолжить, изменения и обработчики событий **FieldChangeComplete** и **RecordChangeComplete** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-122">If this handler also allows the event to continue, the change is made and the **FieldChangeComplete** and **RecordChangeComplete** event handlers are called.</span></span> <span data-ttu-id="f5bea-123">Порядок вызова обработчиков событий будет для конкретной операции не определен, поэтому следует избегать написания кода, который зависит от того, вызов обработчиков в определенной последовательности.</span><span class="sxs-lookup"><span data-stu-id="f5bea-123">The order in which the Will event handlers for a particular operation are called is not defined, so you should avoid writing code that depends on calling handlers in a particular sequence.</span></span>

<span data-ttu-id="f5bea-124">В случаях при возникновении событий нескольких будет, одного из событий может отменить ожидающие операции.</span><span class="sxs-lookup"><span data-stu-id="f5bea-124">In instances when multiple Will events are raised, one of the events might cancel the pending operation.</span></span> <span data-ttu-id="f5bea-125">Например когда изменяется значение **поля** **WillChangeField** и **WillChangeRecord** обработчиков событий обычно вызывается.</span><span class="sxs-lookup"><span data-stu-id="f5bea-125">For example, when your application changes the value of a **Field**, both **WillChangeField** and **WillChangeRecord** event handlers would normally be called.</span></span> <span data-ttu-id="f5bea-126">Тем не менее если операция отменена в первом обработчика событий, его связанного полный обработчик сразу же вызывается с **adStatusOperationCancelled**.</span><span class="sxs-lookup"><span data-stu-id="f5bea-126">However, if the operation is canceled in the first event handler, its associated Complete handler is immediately called with **adStatusOperationCancelled**.</span></span> <span data-ttu-id="f5bea-127">Второй обработчик никогда не производится.</span><span class="sxs-lookup"><span data-stu-id="f5bea-127">The second handler is never called.</span></span> <span data-ttu-id="f5bea-128">Если тем не менее, первый обработчик событий позволяет событие продолжить работу, будет вызываться обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="f5bea-128">If, however, the first event handler allows the event to proceed, the other event handler will be called.</span></span> <span data-ttu-id="f5bea-129">Если затем отменил операцию, как и в предыдущих примерах будет вызываться оба завершения события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-129">If it then cancels the operation, both Complete events will be called as in the earlier examples.</span></span>

## <a name="unpaired-event-handlers"></a><span data-ttu-id="f5bea-130">Обработчики событий непарные</span><span class="sxs-lookup"><span data-stu-id="f5bea-130">Unpaired event handlers</span></span>

<span data-ttu-id="f5bea-131">Поскольку состояние, переданное в событие не **adStatusCantDeny**, можно отключить уведомления о событиях для всех событий, возвращая **adStatusUnwantedEvent** с помощью параметра *состояние* .</span><span class="sxs-lookup"><span data-stu-id="f5bea-131">As long as the status passed to the event is not **adStatusCantDeny**, you can turn off event notifications for any event by returning **adStatusUnwantedEvent** in the *Status* parameter.</span></span> <span data-ttu-id="f5bea-132">Например при вызове обработчика события Complete первый раз, можно вернуть **adStatusUnwantedEvent**.</span><span class="sxs-lookup"><span data-stu-id="f5bea-132">For example, when your Complete event handler is called the first time, you can return **adStatusUnwantedEvent**.</span></span> <span data-ttu-id="f5bea-133">Затем вы получите только события будут.</span><span class="sxs-lookup"><span data-stu-id="f5bea-133">You will subsequently receive only Will events.</span></span> <span data-ttu-id="f5bea-134">Тем не менее для более чем одной из причин может быть запущено некоторые события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-134">However, some events can be triggered for more than one reason.</span></span> <span data-ttu-id="f5bea-135">В этом случае событие будет иметь параметр *причине* .</span><span class="sxs-lookup"><span data-stu-id="f5bea-135">In that case, the event will have a *Reason* parameter.</span></span> <span data-ttu-id="f5bea-136">При возврате **adStatusUnwantedEvent**будет прекратить получать уведомления для этого события только в том случае, когда они возникают по этой причине определенного.</span><span class="sxs-lookup"><span data-stu-id="f5bea-136">When you return **adStatusUnwantedEvent**, you will stop receiving notifications for that event only when they occur for that particular reason.</span></span> <span data-ttu-id="f5bea-137">Другими словами потенциально будет получать уведомления для каждой из возможных причин может инициировать события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-137">In other words, you will potentially receive notification for each possible reason that the event could be triggered.</span></span>

<span data-ttu-id="f5bea-138">Один будет обработчиков событий при можно использовать для просмотра параметров, которые будут использоваться в рамках одной операции.</span><span class="sxs-lookup"><span data-stu-id="f5bea-138">Single Will event handlers can be useful when you want to examine the parameters that will be used in an operation.</span></span> <span data-ttu-id="f5bea-139">Можно изменить эти параметры операции или отменить операцию.</span><span class="sxs-lookup"><span data-stu-id="f5bea-139">You can modify those operation parameters or cancel the operation.</span></span>

<span data-ttu-id="f5bea-140">Кроме того оставьте завершения события уведомления включены.</span><span class="sxs-lookup"><span data-stu-id="f5bea-140">Alternatively, leave Complete event notification enabled.</span></span> <span data-ttu-id="f5bea-141">При вызове первого обработчик событий будет возвратите **adStatusUnwantedEvent**.</span><span class="sxs-lookup"><span data-stu-id="f5bea-141">When your first Will event handler is called, return **adStatusUnwantedEvent**.</span></span> <span data-ttu-id="f5bea-142">Впоследствии будет получать только полная события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-142">You will subsequently receive only Complete events.</span></span>

<span data-ttu-id="f5bea-143">Обработчики событий один полный можно использовать для управления асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="f5bea-143">Single Complete event handlers can be useful for managing asynchronous operations.</span></span> <span data-ttu-id="f5bea-144">Каждой асинхронной операции имеет соответствующий завершения события.</span><span class="sxs-lookup"><span data-stu-id="f5bea-144">Each asynchronous operation has an appropriate Complete event.</span></span>

<span data-ttu-id="f5bea-145">Например может потребоваться много времени для заполнения объекта большого [набора записей](recordset-object-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="f5bea-145">For example, it can take a long time to populate a large [Recordset](recordset-object-ado.md) object.</span></span> <span data-ttu-id="f5bea-146">Если приложение записывается должным образом, можно начать операцию и продолжить работу других обработки.</span><span class="sxs-lookup"><span data-stu-id="f5bea-146">If your application is appropriately written, you can start a operation and continue with other processing.</span></span> <span data-ttu-id="f5bea-147">Вы получите уведомление в конечном итоге при заполнении **набора записей** событие **ExecuteComplete** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-147">You will eventually be notified when the **Recordset** is populated by an **ExecuteComplete** event.</span></span>

## <a name="single-event-handlers-and-multiple-objects"></a><span data-ttu-id="f5bea-148">Обработчики событий для одного и нескольких объектов</span><span class="sxs-lookup"><span data-stu-id="f5bea-148">Single event handlers and multiple objects</span></span>

<span data-ttu-id="f5bea-149">Гибкость языка программирования, таких как Microsoft Visual C++ позволяет использовать одну события процесса обработчик события из нескольких объектов.</span><span class="sxs-lookup"><span data-stu-id="f5bea-149">The flexibility of a programming language like Microsoft Visual C++ enables you to have one event handler process events from multiple objects.</span></span> <span data-ttu-id="f5bea-150">Например может иметь один процесс событий обработчик **Disconnect** событий от нескольких объектов **подключения** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-150">For example, you could have one **Disconnect** event handler process events from several **Connection** objects.</span></span> <span data-ttu-id="f5bea-151">Если одно из подключений завершился, вызывается обработчик событий **отключения** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-151">If one of the connections ended, the **Disconnect** event handler would be called.</span></span> <span data-ttu-id="f5bea-152">Чтобы сообщить какое подключение вызвала событие, так как параметр объекта обработчик событий должен быть установлен соответствующий объект **подключения** .</span><span class="sxs-lookup"><span data-stu-id="f5bea-152">You could tell which connection caused the event because the event-handler object parameter would be set to the corresponding **Connection** object.</span></span>

> [!NOTE]
> <span data-ttu-id="f5bea-153">Этот метод не может использоваться в Visual Basic, так как этот язык можно сопоставить только один объект, который требуется обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="f5bea-153">This technique cannot be used in Visual Basic because that language can correlate only one object to an event handler.</span></span>



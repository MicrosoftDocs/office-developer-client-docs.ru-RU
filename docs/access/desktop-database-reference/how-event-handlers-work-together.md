---
title: Взаимодействие обработчиков событий
TOCTitle: How event handlers work together
ms:assetid: 02122824-881e-0bb8-cba1-c963024790ae
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248788(v=office.15)
ms:contentKeyID: 48542951
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e772e93f27d6bb5f30d865e3435d4bde6bdc5e73
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291924"
---
# <a name="how-event-handlers-work-together"></a><span data-ttu-id="67156-102">Взаимодействие обработчиков событий</span><span class="sxs-lookup"><span data-stu-id="67156-102">How event handlers work together</span></span>

<span data-ttu-id="67156-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="67156-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="67156-104">Если вы не программировали в Visual Basic, все обработчики событий для событий **Подключения** и **Recordset** должны быть реализованы независимо от того, обрабатываете ли вы все события.</span><span class="sxs-lookup"><span data-stu-id="67156-104">Unless you are programming in Visual Basic, all event handlers for **Connection** and **Recordset** events must be implemented, regardless of whether you actually process all of the events.</span></span> <span data-ttu-id="67156-105">Объем работы по реализации зависит от языка программирования.</span><span class="sxs-lookup"><span data-stu-id="67156-105">The amount of implementation work you have to do depends on your programming language.</span></span> <span data-ttu-id="67156-106">Дополнительные сведения см. в [сообщении ADO Event Instantiation by Language.](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/ado-event-instantiation-by-language-ado)</span><span class="sxs-lookup"><span data-stu-id="67156-106">For more information, see [ADO Event Instantiation by Language](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/ado-event-instantiation-by-language-ado).</span></span>

## <a name="paired-event-handlers"></a><span data-ttu-id="67156-107">Сопряженные обработчики событий</span><span class="sxs-lookup"><span data-stu-id="67156-107">Paired event handlers</span></span>

<span data-ttu-id="67156-108">Каждый обработник событий Will имеет связанный обработок событий Complete.</span><span class="sxs-lookup"><span data-stu-id="67156-108">Each Will event handler has an associated Complete event handler.</span></span> <span data-ttu-id="67156-109">Например, когда приложение меняет значение поля, обработник **событий WillChangeField** называется.</span><span class="sxs-lookup"><span data-stu-id="67156-109">For example, when your application changes the value of a field, the **WillChangeField** event handler is called.</span></span> <span data-ttu-id="67156-110">Если изменение допустимо, приложение оставляет параметр **adStatus** без изменений и операция выполняется.</span><span class="sxs-lookup"><span data-stu-id="67156-110">If the change is acceptable, your application leaves the **adStatus** parameter unchanged and the operation is performed.</span></span> <span data-ttu-id="67156-111">По завершению операции **событие FieldChangeComplete** сообщает приложению о том, что операция завершена.</span><span class="sxs-lookup"><span data-stu-id="67156-111">When the operation completes, a **FieldChangeComplete** event notifies your application that the operation has finished.</span></span> <span data-ttu-id="67156-112">Если оно успешно завершено, **adStatus содержит** **adStatusOK;** в **противном случае adStatus** содержит **adStatusErrorsOccurred,** и для определения причины ошибки необходимо проверить объект **Error.**</span><span class="sxs-lookup"><span data-stu-id="67156-112">If it completed successfully, **adStatus** contains **adStatusOK**; otherwise, **adStatus** contains **adStatusErrorsOccurred** and you must check the **Error** object to determine the cause of the error.</span></span>

<span data-ttu-id="67156-113">Когда **будет вызвано WillChangeField,** вы можете определить, что изменение не должно быть сделано.</span><span class="sxs-lookup"><span data-stu-id="67156-113">When **WillChangeField** is called, you might determine that the change should not be made.</span></span> <span data-ttu-id="67156-114">В этом случае установите **adStatus** **в adStatusCancel**.</span><span class="sxs-lookup"><span data-stu-id="67156-114">In that case, set **adStatus** to **adStatusCancel**.</span></span> <span data-ttu-id="67156-115">Операция отменяется, и **событие FieldChangeComplete** получает значение **adStatus adStatusErrorsOccurred.** </span><span class="sxs-lookup"><span data-stu-id="67156-115">The operation is canceled and the **FieldChangeComplete** event receives an **adStatus** value of **adStatusErrorsOccurred**.</span></span> <span data-ttu-id="67156-116">Объект **Error** содержит **adErrOperationCancelled,** чтобы обработщик **FieldChangeComplete** знал, что операция была отменена.</span><span class="sxs-lookup"><span data-stu-id="67156-116">The **Error** object contains **adErrOperationCancelled** so that your **FieldChangeComplete** handler knows that the operation was canceled.</span></span> <span data-ttu-id="67156-117">Однако перед его изменением необходимо проверить значение параметра **adStatus,** так как установка **adStatus** **в adStatusCancel** не влияет, если параметр был задан **для adStatusCantDeny** при входе в процедуру.</span><span class="sxs-lookup"><span data-stu-id="67156-117">However, you need to check the value of the **adStatus** parameter before changing it, because setting **adStatus** to **adStatusCancel** has no effect if the parameter was set to **adStatusCantDeny** on entry to the procedure.</span></span>

<span data-ttu-id="67156-118">Иногда операция может собрать несколько событий.</span><span class="sxs-lookup"><span data-stu-id="67156-118">Sometimes an operation can raise more than one event.</span></span> <span data-ttu-id="67156-119">Например, объект **Recordset имеет** сопряженные события для изменений **поля** и **записи.**</span><span class="sxs-lookup"><span data-stu-id="67156-119">For example, the **Recordset** object has paired events for **Field** changes and **Record** changes.</span></span> <span data-ttu-id="67156-120">Когда ваше приложение изменяет значение **поля,** обработник **событий WillChangeField** называется.</span><span class="sxs-lookup"><span data-stu-id="67156-120">When your application changes the value of a **Field**, the **WillChangeField** event handler is called.</span></span> <span data-ttu-id="67156-121">Если он определяет, что операция может продолжаться, также поднят обработник событий **WillChangeRecord.**</span><span class="sxs-lookup"><span data-stu-id="67156-121">If it determines that the operation can continue, the **WillChangeRecord** event handler is also raised.</span></span> <span data-ttu-id="67156-122">Если этот обработчик также позволяет продолжить событие, это изменение выполнено и вызваны обработчики событий **FieldChangeComplete** и **RecordChangeComplete.**</span><span class="sxs-lookup"><span data-stu-id="67156-122">If this handler also allows the event to continue, the change is made and the **FieldChangeComplete** and **RecordChangeComplete** event handlers are called.</span></span> <span data-ttu-id="67156-123">Порядок вызова обработчиков событий Will для определенной операции не определен, поэтому следует избегать написания кода, который зависит от обработчиков вызовов в определенной последовательности.</span><span class="sxs-lookup"><span data-stu-id="67156-123">The order in which the Will event handlers for a particular operation are called is not defined, so you should avoid writing code that depends on calling handlers in a particular sequence.</span></span>

<span data-ttu-id="67156-124">В случаях, когда будет поднято несколько событий Will, одно из событий может отменить ожидаемую операцию.</span><span class="sxs-lookup"><span data-stu-id="67156-124">In instances when multiple Will events are raised, one of the events might cancel the pending operation.</span></span> <span data-ttu-id="67156-125">Например, когда приложение меняет значение **поля,** обычно будут вызваны обработчики событий **WillChangeField** и **WillChangeRecord.**</span><span class="sxs-lookup"><span data-stu-id="67156-125">For example, when your application changes the value of a **Field**, both **WillChangeField** and **WillChangeRecord** event handlers would normally be called.</span></span> <span data-ttu-id="67156-126">Однако, если операция отменяется в первом обработщике событий, ее связанный обработщик Complete немедленно вызван **с помощью adStatusOperationCancelled.**</span><span class="sxs-lookup"><span data-stu-id="67156-126">However, if the operation is canceled in the first event handler, its associated Complete handler is immediately called with **adStatusOperationCancelled**.</span></span> <span data-ttu-id="67156-127">Второй обработок никогда не называется.</span><span class="sxs-lookup"><span data-stu-id="67156-127">The second handler is never called.</span></span> <span data-ttu-id="67156-128">Если, однако, обработник первого события позволяет продолжить событие, будет вызван другой обработник событий.</span><span class="sxs-lookup"><span data-stu-id="67156-128">If, however, the first event handler allows the event to proceed, the other event handler will be called.</span></span> <span data-ttu-id="67156-129">Если она отменит операцию, оба события Complete будут вызваны, как в предыдущих примерах.</span><span class="sxs-lookup"><span data-stu-id="67156-129">If it then cancels the operation, both Complete events will be called as in the earlier examples.</span></span>

## <a name="unpaired-event-handlers"></a><span data-ttu-id="67156-130">Неоплаченные обработчики событий</span><span class="sxs-lookup"><span data-stu-id="67156-130">Unpaired event handlers</span></span>

<span data-ttu-id="67156-131">До тех пор, пока статус, переданный событию, не **является adStatusCantDeny,** вы можете отключить уведомления о событиях для любого события, возвращая **adStatusUnwantedEvent** в *параметре Status.*</span><span class="sxs-lookup"><span data-stu-id="67156-131">As long as the status passed to the event is not **adStatusCantDeny**, you can turn off event notifications for any event by returning **adStatusUnwantedEvent** in the *Status* parameter.</span></span> <span data-ttu-id="67156-132">Например, когда обработитель событий Complete вызван в первый раз, можно вернуть **adStatusUnwantedEvent.**</span><span class="sxs-lookup"><span data-stu-id="67156-132">For example, when your Complete event handler is called the first time, you can return **adStatusUnwantedEvent**.</span></span> <span data-ttu-id="67156-133">Впоследствии вы будете получать только события Will.</span><span class="sxs-lookup"><span data-stu-id="67156-133">You will subsequently receive only Will events.</span></span> <span data-ttu-id="67156-134">Однако некоторые события можно запускать по нескольким причинам.</span><span class="sxs-lookup"><span data-stu-id="67156-134">However, some events can be triggered for more than one reason.</span></span> <span data-ttu-id="67156-135">В этом случае событие будет иметь параметр *Reason.*</span><span class="sxs-lookup"><span data-stu-id="67156-135">In that case, the event will have a *Reason* parameter.</span></span> <span data-ttu-id="67156-136">Когда вы возвращаете **adStatusUnwantedEvent,** вы прекратите получать уведомления для этого события только тогда, когда они происходят по этой конкретной причине.</span><span class="sxs-lookup"><span data-stu-id="67156-136">When you return **adStatusUnwantedEvent**, you will stop receiving notifications for that event only when they occur for that particular reason.</span></span> <span data-ttu-id="67156-137">Другими словами, вы потенциально будете получать уведомления по каждой возможной причине, по которой событие может быть вызвано.</span><span class="sxs-lookup"><span data-stu-id="67156-137">In other words, you will potentially receive notification for each possible reason that the event could be triggered.</span></span>

<span data-ttu-id="67156-138">Обработчики событий Single Will могут быть полезны при проверке параметров, которые будут использоваться в операции.</span><span class="sxs-lookup"><span data-stu-id="67156-138">Single Will event handlers can be useful when you want to examine the parameters that will be used in an operation.</span></span> <span data-ttu-id="67156-139">Эти параметры операции можно изменить или отменить.</span><span class="sxs-lookup"><span data-stu-id="67156-139">You can modify those operation parameters or cancel the operation.</span></span>

<span data-ttu-id="67156-140">Кроме того, оставьте включенное уведомление о событии Complete.</span><span class="sxs-lookup"><span data-stu-id="67156-140">Alternatively, leave Complete event notification enabled.</span></span> <span data-ttu-id="67156-141">Когда вызван первый обработитель событий Will, **верните adStatusUnwantedEvent**.</span><span class="sxs-lookup"><span data-stu-id="67156-141">When your first Will event handler is called, return **adStatusUnwantedEvent**.</span></span> <span data-ttu-id="67156-142">Впоследствии вы будете получать только полные события.</span><span class="sxs-lookup"><span data-stu-id="67156-142">You will subsequently receive only Complete events.</span></span>

<span data-ttu-id="67156-143">Обработчики событий Single Complete могут быть полезны для управления асинхронными операциями.</span><span class="sxs-lookup"><span data-stu-id="67156-143">Single Complete event handlers can be useful for managing asynchronous operations.</span></span> <span data-ttu-id="67156-144">Каждая асинхронная операция имеет соответствующее событие Complete.</span><span class="sxs-lookup"><span data-stu-id="67156-144">Each asynchronous operation has an appropriate Complete event.</span></span>

<span data-ttu-id="67156-145">Например, заполнение большого объекта [Recordset](recordset-object-ado.md) может занять много времени.</span><span class="sxs-lookup"><span data-stu-id="67156-145">For example, it can take a long time to populate a large [Recordset](recordset-object-ado.md) object.</span></span> <span data-ttu-id="67156-146">Если приложение правильно записано, можно начать операцию и продолжить другую обработку.</span><span class="sxs-lookup"><span data-stu-id="67156-146">If your application is appropriately written, you can start a operation and continue with other processing.</span></span> <span data-ttu-id="67156-147">В конечном итоге вы будете уведомлены, когда **набор recordset** заполняется **событием ExecuteComplete.**</span><span class="sxs-lookup"><span data-stu-id="67156-147">You will eventually be notified when the **Recordset** is populated by an **ExecuteComplete** event.</span></span>

## <a name="single-event-handlers-and-multiple-objects"></a><span data-ttu-id="67156-148">Обработчики одного события и несколько объектов</span><span class="sxs-lookup"><span data-stu-id="67156-148">Single event handlers and multiple objects</span></span>

<span data-ttu-id="67156-149">Гибкость языка программирования, например Microsoft Visual C++ позволяет иметь одно событие обработки событий из нескольких объектов.</span><span class="sxs-lookup"><span data-stu-id="67156-149">The flexibility of a programming language like Microsoft Visual C++ enables you to have one event handler process events from multiple objects.</span></span> <span data-ttu-id="67156-150">Например, может быть один обработник **событий Отключения** из нескольких объектов **Подключения.**</span><span class="sxs-lookup"><span data-stu-id="67156-150">For example, you could have one **Disconnect** event handler process events from several **Connection** objects.</span></span> <span data-ttu-id="67156-151">Если одно из подключений завершено, будет вызван обработок событий **Disconnect.**</span><span class="sxs-lookup"><span data-stu-id="67156-151">If one of the connections ended, the **Disconnect** event handler would be called.</span></span> <span data-ttu-id="67156-152">Можно сказать, какое подключение вызвало событие, так как параметр объекта обработки событий будет задан соответствующему **объекту Подключения.**</span><span class="sxs-lookup"><span data-stu-id="67156-152">You could tell which connection caused the event because the event-handler object parameter would be set to the corresponding **Connection** object.</span></span>

> [!NOTE]
> <span data-ttu-id="67156-153">Этот метод нельзя использовать в Visual Basic, так как этот язык может соотносить только один объект с обработить событие.</span><span class="sxs-lookup"><span data-stu-id="67156-153">This technique cannot be used in Visual Basic because that language can correlate only one object to an event handler.</span></span>



---
title: Как обработчики событий совместно действуют
TOCTitle: How Event Handlers Work Together
ms:assetid: 02122824-881e-0bb8-cba1-c963024790ae
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248788(v=office.15)
ms:contentKeyID: 48542951
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 19f60c196c110787eb7baf57646a9d5d4996fdf0
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "25877830"
---
# <a name="how-event-handlers-work-together"></a>Как обработчики событий совместно действуют


**Применимо к**: Access 2013, Office 2013



Если не программирования в Visual Basic все обработчики событий для события **подключения** и **записей** должен быть реализован, независимо от того, ли вы фактически обрабатывают все события. Объем работы реализации, что вам нужно сделать зависит от языка программирования. Для получения дополнительных сведений см [При создании экземпляра события ADO по языкам](https://msdn.microsoft.com/library/jj250244\(v=office.15\)).

## <a name="paired-event-handlers"></a>Обработчики событий парного

Каждый обработчик событий будет имеет связанные полный обработчик. Например при изменении значения поля приложения называется обработчика событий **WillChangeField** . Если изменить допустима, приложение покидает параметр **adStatus** без изменений и выполнения операции. После завершения операции, **FieldChangeComplete** событие уведомляет приложение, которое завершения операции. Если успешно завершена, **adStatus** содержит **adStatusOK**; в противном случае **adStatus** содержит **adStatusErrorsOccurred** и необходимо проверить объект **Error** , чтобы определить причину ошибки.

При вызове **WillChangeField** можно указать, что изменения не следует делать. В этом случае значение **adStatusCancel** **adStatus** . Операция отменена и события **FieldChangeComplete** получает значение **adStatus** **adStatusErrorsOccurred**. Объект **Error** содержит **adErrOperationCancelled** , чтобы обработчик **FieldChangeComplete** знала, что операция отменена. Тем не менее следует проверить значение параметра **adStatus** перед изменением, так как параметр **adStatus** для **adStatusCancel** не оказывает влияния, если параметр было задано значение **adStatusCantDeny** на запись к процедуре.

В некоторых случаях операции могут вызывать более одного события. Например объекта **набора записей** пару событий для изменения **поля** и изменения **записей** . Когда приложение изменяется значение **поля**, вызывает обработчик события **WillChangeField** . Если он определяет, что можно продолжить операцию, обработчик событий **WillChangeRecord** также вызывается. Если этот обработчик также позволяет событие продолжить, изменения и обработчики событий **FieldChangeComplete** и **RecordChangeComplete** . Порядок вызова обработчиков событий будет для конкретной операции не определен, поэтому следует избегать написания кода, который зависит от того, вызов обработчиков в определенной последовательности.

В случаях при возникновении событий нескольких будет, одного из событий может отменить ожидающие операции. Например когда изменяется значение **поля** **WillChangeField** и **WillChangeRecord** обработчиков событий обычно вызывается. Тем не менее если операция отменена в первом обработчика событий, его связанного полный обработчик сразу же вызывается с **adStatusOperationCancelled**. Второй обработчик никогда не производится. Если тем не менее, первый обработчик событий позволяет событие продолжить работу, будет вызываться обработчик событий. Если затем отменил операцию, как и в предыдущих примерах будет вызываться оба завершения события.

## <a name="unpaired-event-handlers"></a>Обработчики событий непарные

Поскольку состояние, переданное в событие не **adStatusCantDeny**, можно отключить уведомления о событиях для всех событий, возвращая **adStatusUnwantedEvent** с помощью параметра *состояние* . Например при вызове обработчика события Complete первый раз, можно вернуть **adStatusUnwantedEvent**. Затем вы получите только события будут. Тем не менее для более чем одной из причин может быть запущено некоторые события. В этом случае событие будет иметь параметр *причине* . При возврате **adStatusUnwantedEvent**будет прекратить получать уведомления для этого события только в том случае, когда они возникают по этой причине определенного. Другими словами потенциально будет получать уведомления для каждой из возможных причин может инициировать события.

Один будет обработчиков событий при можно использовать для просмотра параметров, которые будут использоваться в рамках одной операции. Можно изменить эти параметры операции или отменить операцию.

Кроме того оставьте завершения события уведомления включены. При вызове первого обработчик событий будет возвратите **adStatusUnwantedEvent**. Впоследствии будет получать только полная события.

Обработчики событий один полный можно использовать для управления асинхронной операции. Каждой асинхронной операции имеет соответствующий завершения события.

Например может потребоваться много времени для заполнения объекта большого [набора записей](recordset-object-ado.md) . Если приложение записывается должным образом, можно начать операцию и продолжить работу других обработки. Вы получите уведомление в конечном итоге при заполнении **набора записей** событие **ExecuteComplete** .

## <a name="single-event-handlers-and-multiple-objects"></a>Обработчики событий для одного и нескольких объектов

Гибкость языка программирования, таких как Microsoft Visual C++ позволяет использовать одну события процесса обработчик события из нескольких объектов. Например может иметь один процесс событий обработчик **Disconnect** событий от нескольких объектов **подключения** . Если одно из подключений завершился, вызывается обработчик событий **отключения** . Чтобы сообщить какое подключение вызвала событие, так как параметр объекта обработчик событий должен быть установлен соответствующий объект **подключения** .


> [!NOTE]
> <P>Этот метод не может использоваться в Visual Basic, так как этот язык можно сопоставить только один объект, который требуется обработчик событий.</P>



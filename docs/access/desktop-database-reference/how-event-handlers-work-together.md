---
title: Взаимодействие обработчиков событий
TOCTitle: How event handlers work together
ms:assetid: 02122824-881e-0bb8-cba1-c963024790ae
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248788(v=office.15)
ms:contentKeyID: 48542951
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e772e93f27d6bb5f30d865e3435d4bde6bdc5e73
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291924"
---
# <a name="how-event-handlers-work-together"></a>Взаимодействие обработчиков событий

**Область применения**: Access 2013, Office 2013

Если вы не программировали в Visual Basic, все обработчики событий для событий **Connection** и **Recordset** должны быть реализованы независимо от того, обрабатываете ли вы все события. Объем работы по реализации зависит от языка программирования. Дополнительные сведения [см.](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/ado-event-instantiation-by-language-ado)в этой теме.

## <a name="paired-event-handlers"></a>Сопряженные обработчики событий

Каждый обработок событий Will имеет связанный обработок события Complete. Например, когда ваше приложение изменяет значение поля, будет вызван обработок событий **WillChangeField.** Если изменение допустимо, приложение оставляет параметр **adStatus** без изменений и выполняется операция. После завершения операции событие **FieldChangeComplete** сообщает приложению, что операция завершена. Если оно успешно завершено, **adStatus** содержит **adStatusOK;** в **противном случае adStatus** содержит **adStatusErrorsOccurred,** и необходимо проверить объект **Error,** чтобы определить причину ошибки.

Когда **будет вызван WillChangeField,** можно определить, что изменение не следует внося. В этом случае установите **для adStatus** **adStatusCancel**. Операция отменяется, и событие **FieldChangeComplete** получает значение **adStatus** **adStatusErrorsOccurred.** Объект **Error** содержит **adErrOperationCancelled,** чтобы обработщик **FieldChangeComplete** знал, что операция была отменена. Однако перед изменением значения параметра **adStatus** необходимо проверить его, так как установка **значения adStatus** **в adStatusCancel** не действует, если для параметра было задано значение **adStatusCantDeny** при входе в процедуру.

Иногда операция вызывает несколько событий. Например, объект **Recordset имеет** сопряженные события для **изменений полей** и **записей.** Когда приложение изменяет значение **поля,** будет вызван обработок событий **WillChangeField.** Если он определяет, что операция может продолжиться, также вызывается обработок события **WillChangeRecord.** Если этот обработчик также разрешает продолжение события, внося изменения, и будут вызваны обработчики событий **FieldChangeComplete** и **RecordChangeComplete.** Порядок вызова обработчиков событий Will для определенной операции не определен, поэтому следует избегать написания кода, который зависит от обработчиков вызовов в определенной последовательности.

В случаях, когда вызывается несколько событий Will, одно из них может отменить ожидаемую операцию. Например, когда приложение изменяет значение **поля,** обычно будут вызваны обработчики событий **WillChangeField** и **WillChangeRecord.** Однако если операция отменена в первом обработщике событий, связанный с ней обработок Complete немедленно вызван с **помощью adStatusOperationCancelled.** Второй обработок никогда не будет вызван. Однако если первый обработок событий разрешает продолжить событие, будет вызван другой обработок событий. Если после этого операция будет отменена, будут вызваны оба события Complete, как в предыдущих примерах.

## <a name="unpaired-event-handlers"></a>Обработчики неоплаченных событий

Если состояние, переданное событию, не **adStatusCantDeny,** можно отключить уведомления о любом событии, возвращая **adStatusUnwantedEvent** в параметре *Status.* Например, когда обработитель события Complete вызван в первый раз, вы можете вернуть **adStatusUnwantedEvent.** В дальнейшем будут получаться только события Will. Однако некоторые события могут быть вызваны несколькими причинами. В этом случае событие будет иметь параметр *Reason.* Когда вы вернетесь **adStatusUnwantedEvent,** вы перестанете получать уведомления об этом событии только в том случае, если они происходят по определенной причине. Другими словами, вы можете получать уведомления по каждой возможной причине, по которой событие может быть инициировано.

Обработчики событий Single Will могут быть полезны при проверке параметров, которые будут использоваться в операции. Вы можете изменить эти параметры операции или отменить операцию.

Кроме того, оставьте уведомление о завершении включенным. Когда будет вызван первый обработитель событий Will, **вернетесь adStatusUnwantedEvent.** В дальнейшем будут получаться только события Complete.

Обработчики событий с одним завершением могут быть полезны для управления асинхронными операциями. Каждая асинхронная операция имеет соответствующее событие Complete.

Например, заполнение большого объекта [Recordset](recordset-object-ado.md) может занять много времени. Если приложение написано надлежащим образом, можно запустить операцию и продолжить другую обработку. Со временем вы будете уведомлены, когда **набор записей** будет заполнен **событием ExecuteComplete.**

## <a name="single-event-handlers-and-multiple-objects"></a>Обработчики одного события и несколько объектов

Гибкость языка программирования, например Microsoft Visual C++, позволяет использовать одно событие обработки событий из нескольких объектов. Например, можно иметь одно событие **обработки обработки** события Disconnect из нескольких **объектов Connection.** Если одно из подключений завершилось, будет вызван обработок события **Disconnect.** Можно было сообщить, какое подключение вызвало событие, так как для параметра объекта обработки событий будет задан соответствующий **объект Connection.**

> [!NOTE]
> Этот метод нельзя использовать в Visual Basic так как этот язык может сопоставляет только один объект с обработом событий.



---
title: Макрокоманда ImportExportText
TOCTitle: ImportExportText macro action
ms:assetid: 366fa095-6f09-7c22-e734-bfa585cfe79e
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192475(v=office.15)
ms:contentKeyID: 48544171
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm168097
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: a26b370e14dba68b0cbe686f4b23ae0db3fc1fea
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291868"
---
# <a name="importexporttext-macro-action"></a>Макрокоманда ImportExportText

**Область применения**: Access 2013, Office 2013

Вы можете использовать действие **импортекспорттекст** для импорта или экспорта текста между текущей базой данных Microsoft Access (MDB или ACCDB) или проектом Access (ADP) и текстовым файлом. Вы также можете связать данные в текстовом файле с текущей базой данных Access. Это позволит просматривать текстовые файлы через Access, при этом не теряя возможность работы с ними в текстовом редакторе. Вы также можете импортировать, экспортировать и связывать их с таблицей или списком в HTML-файле (\*HTML-файле).

> [!NOTE]
> Если вы связываетесь с данными в текстовом файле или HTML-файле, данные в Access доступны только для чтения. Эта макрокоманда доступна только для доверенных баз данных. 

## <a name="setting"></a>Параметры

Макрокоманда **импортекспорттекст** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Тип преобразования</strong></p></td>
<td><p>Нужный тип преобразования. Вы можете импортировать данные из текстовых или HTML-файлов с разделителями или полями фиксированного размера, экспортировать их в такие файлы или создать ссылку на них. Кроме того, вы можете экспортировать данные в файл данных слияния Microsoft Word, который можно использовать с функцией слияния почты Word для создания Объединенных документов, таких как буквы форм и почтовые наклейки. Выберите пункт <strong>Импорт разделителей</strong>, <strong>Импорт фиксированной ширины</strong>, <strong>Импорт HTML-кода</strong>, экспорт разделенных элементов, <strong>Фиксированная ширина</strong>, экспорт <strong>HTML</strong>, <strong>Экспорт Word для Windows</strong>, <strong>Разделитель ссылок</strong>, фиксированная <strong></strong> <strong>Ширина ссылки </strong>или свяжите его с <strong>HTML-кодом</strong> в поле <strong>тип передачи</strong> в разделе <strong>аргументы макрокоманды</strong> в области построителя макросов. По умолчанию используется <strong>Разделитель импорта</strong>.</p><p><strong>Note</strong>: в проекте Access (ADP) поддерживаются только <STRONG>разделители импорта</STRONG>, <STRONG>импортирование фиксированной ширины</STRONG>, <STRONG>Экспорт с разделителями</STRONG>, <STRONG>Фиксированная ширина экспорта</STRONG>или <STRONG>Экспорт Word для слияния Windows</STRONG> .</p></td>
</tr>
<tr class="even">
<td><p><strong>Название спецификации</strong></p></td>
<td><p>Имя спецификации для набора параметров, определяющих способ импорта или связывания текстового файла. Для текстового файла фиксированной ширины необходимо указать аргумент или использовать ini-файл схемы, который должен храниться в той же папке, что и импортированный или связанный текстовый файл.</p>
<p>Чтобы создать спецификацию для импорта или связывания текстового файла, выполните следующие действия.</p>
<ol>
<li><p>В диалоговом окне <strong>Получение внешних данных</strong> введите путь к исходному текстовому файлу в поле <strong>имя файла</strong> .</p></li>
<li><p>Выберите нужный параметр для сохранения данных (импорт, добавление или ссылка) и нажмите кнопку <strong>ОК</strong>.</p></li>
<li><p>В диалоговом окне " <strong>Импорт текста</strong> " нажмите кнопку <strong>Дополнительно</strong>.</p></li>
<li><p>Укажите необходимые параметры для этой спецификации, а затем нажмите кнопку <strong>Сохранить как</strong>.</p></li>
<li><p>Введите требуемое имя спецификации и нажмите кнопку <strong>ОК</strong>.</p></li>
<li><p>Вы можете управлять существующими спецификациями <strong></strong> , щелкнув спецификации в диалоговом окне Спецификация.</p></li>
<li><p>Нажмите кнопку <strong>ОК</strong> , чтобы закрыть диалоговое окно "Спецификация".</p></li>
</ol>
<p></p>
<p>После этого вы можете ввести имя спецификации в этом аргументе, если вы хотите импортировать или экспортировать один и тот же тип текстового файла. Вы можете импортировать, экспортировать и связывать текстовые файлы с разделителями, не вводя имя спецификации для этого аргумента. В этом случае Access использует параметры по умолчанию из диалогового окна мастера. Access использует предварительно определенный формат для файлов данных слияния, поэтому при экспорте этих типов файлов не требуется вводить имя спецификации для этого аргумента. Вы можете использовать спецификации импорта и экспорта с HTML-файлами, но единственной частью спецификации является спецификация форматирования типов данных.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя таблицы</strong></p></td>
<td><p>Имя таблицы Access для импорта текстовых данных, экспорта текстовых данных или связи с текстовыми данными. Кроме того, можно ввести имя запроса доступа, из которого будут экспортироваться данные. Обязательный аргумент. Если нажать кнопку <strong>импортировать разделители</strong>, <strong>импортировать фиксированную ширину</strong>или <strong>импортировать HTML-код</strong> в поле <strong>тип перемещения</strong> , Access добавляет в эту таблицу текстовые данные, если таблица уже существует. В противном случае Access создает новую таблицу с текстовыми данными. Вы не можете использовать инструкцию SQL, чтобы указать данные для экспорта при использовании действия <strong>импортекспорттекст</strong> . Вместо этого необходимо сначала создать запрос, а затем указать имя запроса в аргументе <strong>Имя таблицы</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя файла</strong></p></td>
<td><p>Имя текстового файла для импорта, экспорта или связи. Следует указывать полный путь. Обязательный аргумент. Access создает новый текстовый файл при экспорте данных из Access. Если имя файла совпадает с именем существующего текстового файла, Access заменяет существующий текстовый файл. Если требуется импортировать или связать определенную таблицу или список в HTML-файле, можно использовать аргумент <strong>имя таблицы HTML</strong> .</p></td>
</tr>
<tr class="odd">
<td><p><strong>С именами полей</strong></p></td>
<td><p>Указывает, содержит ли первая строка текстового файла имена полей. Если выбрано <strong>значение Да</strong>, при импорте или связывании текстовых данных Access использует имена, указанные в этой строке, в качестве имен полей в таблице Access. Если выбрано значение <strong>Нет</strong>, Access обрабатывает первую строку как обычную строку данных. По умолчанию используется значение <strong>Нет</strong>.<br/><br/>Access игнорирует этот аргумент для файлов данных слияния Word для Windows, так как первая строка должна содержать имена полей. При экспорте таблицы Access или запроса на выборку в текстовый файл с разделителями или с фиксированной шириной Access вставляет имена полей таблицы или запроса на выборку в первую строку текстового файла, если для этого аргумента выбрано <strong>значение Да</strong> .<br/><br/>При импорте или связывании текстового файла с фиксированной шириной и выборе параметра <strong>Да</strong> в этом поле Первая строка, содержащая имена полей, должна использовать набор разделителей полей в спецификации импорта и экспорта для разделения имен полей. При экспорте в текстовый файл с фиксированной шириной и выборе значения <strong>Да</strong> для этого аргумента Access вставляет имена полей в первую строку текстового файла с этим разделителем.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя таблицы HTML</strong></p></td>
<td><p>Имя таблицы или списка в HTML-файле, который необходимо импортировать или связать. Этот аргумент игнорируется, если для аргумента <strong>тип передачи</strong> не задано значение Import HTML или Link HTML. Если данный аргумент не задан, импортируется или связывается первая таблица или список в HTML-файле. <br/><br/>Имя таблицы или списка в HTML-файле определяется текстом, указанным &lt;тегом заголовка&gt; , если есть тег &lt;заголовка.&gt; Если тега &lt;CAPTION&gt; нет, имя определяется по тексту с тегом &lt;TITLE&gt;. Если несколько таблиц или списков имеют одно и то же имя, Access отличает их, добавляя число к концу каждого имени; Например, Employees1 и Employees2.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Кодовая страница</strong></p></td>
<td><p>Имя кодировки, используемой с кодовой страницей.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

Вы можете экспортировать данные запросов на выборку Access в текстовые файлы. Access экспортирует результирующий набор запроса так же, как таблицу.

Текстовые данные, добавляемые в существующую таблицу Access, должны быть совместимы с структурой таблицы.

- Каждое поле в тексте должно иметь тот же тип данных, что и соответствующее поле в таблице.

- Поля должны находиться в том же порядке (если для аргумента " **содержит имена полей** " задано значение **"Да"**, в этом случае имена полей в тексте должны совпадать с именами полей в таблице).

Это действие аналогично выбору **текстового файла** в группе **Импорт** или **Экспорт** на вкладке **Внешние данные** . Аргументы действия **импортекспорттекст** отражают параметры мастера, запущенного командой " **текстовый файл** ".

> [!TIP]
> Спецификация импорта и экспорта хранит сведения, необходимые для импорта, экспорта или связи с текстовым файлом. Сохраненные спецификации можно использовать для импорта, экспорта или связи текстовых данных с аналогичными текстовыми файлами. Например, вы можете получать еженедельные данные о продажах в текстовом файле с компьютера мэйнфрейма. Вы можете создать и сохранить спецификацию для данных этого типа, а затем использовать спецификацию при добавлении этих данных в базу данных Access.

> [!NOTE]
> Если вы запрашиваете или фильтруете связанный текстовый файл, в запросе или фильтре учитывается регистр.

Чтобы запустить действие **импортекспорттекст** в модуле Visual Basic для приложений (VBA), используйте метод **трансфертекст** объекта **DoCmd** .


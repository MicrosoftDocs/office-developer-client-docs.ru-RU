---
title: Макрокоманда ImportExportText
TOCTitle: ImportExportText macro action
ms:assetid: 366fa095-6f09-7c22-e734-bfa585cfe79e
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192475(v=office.15)
ms:contentKeyID: 48544171
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm168097
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: a26b370e14dba68b0cbe686f4b23ae0db3fc1fea
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291868"
---
# <a name="importexporttext-macro-action"></a>Макрокоманда ImportExportText

**Область применения**: Access 2013, Office 2013

Вы можете использовать действие **ImportExportText** для импорта или экспорта текста между текущей базой данных Microsoft Access (.mdb или .accdb) или проектом Access (.adp) и текстовым файлом. Вы также можете связать данные в текстовом файле с текущей базой данных Access. Это позволит просматривать текстовые файлы через Access, при этом не теряя возможность работы с ними в текстовом редакторе. Вы также можете импортировать, экспортировать и ссылаться на таблицу или список в HTML-файле \* (.html).

> [!NOTE]
> Если вы ссылались на данные в текстовом файле или HTML-файле, данные доступны только для чтения в Access. Эта макрокоманда доступна только для доверенных баз данных. 

## <a name="setting"></a>Параметр

Действие **ImportExportText имеет** следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Тип преобразования</strong></p></td>
<td><p>Нужный тип преобразования. Вы можете импортировать данные из текстовых или HTML-файлов с разделителями или полями фиксированного размера, экспортировать их в такие файлы или создать ссылку на них. Вы также можете экспортировать данные в Microsoft Word файл данных, который можно использовать с помощью функции слияния почты Word для создания объединенных документов, таких как письма форм и метки рассылки. Выберите Импорт делимитированные , Импорт фиксированной ширины , Импорт HTML <strong>,</strong>Экспорт Делимитированные <strong>,</strong>Экспорт фиксированной ширины , Экспорт <strong></strong> <strong>HTML</strong>, Экспорт word для <strong>Windows Слияние</strong> <strong>,</strong>Ссылка Делимитированный , Ссылка Фиксированной ширины , или ссылка <strong></strong> <strong></strong> <strong></strong> <strong>HTML</strong> в поле Типа передачи в разделе <strong>Аргументы</strong> действий в области макростроитель. <strong></strong> По умолчанию <strong>значение Import Delimited</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong>В проекте Access (.adp) поддерживаются только импортные делимитированные, импортируемые фиксированные ширины, экспортируемая фиксированная ширина или <STRONG>экспортное</STRONG> слово для Windows типы переноса слияния. <STRONG></STRONG> <STRONG></STRONG> <STRONG></STRONG> <STRONG></STRONG></p></td>
</tr>
<tr class="even">
<td><p><strong>Имя спецификации</strong></p></td>
<td><p>Имя спецификации для набора параметров, определяя, как импортируется или связан текстовый файл. Для текстового файла с фиксированной шириной необходимо указать аргумент или использовать schema.ini, который должен храниться в той же папке, что и импортируемый или связанный текстовый файл.</p>
<p>Чтобы создать спецификацию для импорта или привязки текстового файла:</p>
<ol>
<li><p>В <strong>диалоговом окне Get External Data</strong> введите путь источника текстового файла в поле Имя <strong>файла.</strong></p></li>
<li><p>Щелкните нужный параметр для хранения данных (импорт, приложение или ссылка) и нажмите <strong>кнопку ОК.</strong></p></li>
<li><p>В <strong>диалоговом окне Мастер импорта</strong> текста нажмите <strong>кнопку Advanced</strong>.</p></li>
<li><p>Укажите параметры, которые нужны для этой спецификации, а затем нажмите <strong>кнопку Сохранить Как</strong>.</p></li>
<li><p>Введите имя, необходимое для спецификации, а затем нажмите <strong>кнопку ОК</strong>.</p></li>
<li><p>Вы можете управлять существующими спецификациями, щелкнув <strong>спецификации</strong> в диалоговом окне спецификации.</p></li>
<li><p>Нажмите <strong>кнопку ОК,</strong> чтобы закрыть диалоговое окно спецификации.</p></li>
</ol>
<p></p>
<p>Затем в этом аргументе можно ввести имя спецификации всякий раз, когда необходимо импортировать или экспортировать один и тот же тип текстового файла. Вы можете импортировать, экспортировать или связывать делимитированные текстовые файлы, не введя имя спецификации для этого аргумента. В этом случае Access использует по умолчанию диалоговое окно мастера. Access использует заранее заранее заданной формат для файлов данных слияния почты, поэтому при экспорте этих типов файлов не требуется введите имя спецификации для этого аргумента. С HTML-файлами можно использовать спецификации импорта и экспорта, но применяется только спецификация для форматирования типов данных.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя таблицы</strong></p></td>
<td><p>Имя таблицы Access для импорта текстовых данных, экспорта текстовых данных из или ссылки текстовых данных. Вы также можете ввести имя запроса Access, из которого вы хотите экспортировать данные. Это обязательный аргумент. Если вы щелкните <strong>import Delimited,</strong> <strong>Import Fixed Width</strong>или Import <strong>HTML</strong> в поле <strong>Типа</strong> переноса, Access примеширует текстовые данные к этой таблице, если таблица уже существует. В противном случае Access создает новую таблицу, содержащую текстовые данные. Вы не можете использовать SQL для указания данных для экспорта при использовании <strong>действия ImportExportText.</strong> Вместо этого необходимо сначала создать запрос, а затем указать имя запроса в аргументе <strong>Имя таблицы</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя файла</strong></p></td>
<td><p>Имя текстового файла для импорта, экспорта или ссылки на. Следует указывать полный путь. Обязательный аргумент. Доступ создает новый текстовый файл при экспорте данных из Access. Если имя файла такое же, как и имя существующего текстового файла, Access заменяет существующий текстовый файл. Если вы хотите импортировать или связывать определенную таблицу или список в HTML-файле, можно использовать <strong>аргумент HTML Table Name.</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>С именами полей</strong></p></td>
<td><p>Указывает, содержит ли первая строка текстового файла имена полей. Если вы выбрали <strong>Да,</strong>access использует имена в этой строке в качестве имен полей в таблице Access при импорте или ссылке текстовых данных. Если выбрано значение <strong>Нет</strong>, Access обрабатывает первую строку как обычную строку данных. По умолчанию используется значение <strong>Нет</strong>.<br/><br/>Access игнорирует этот аргумент для Word для Windows файлов данных, так как первая строка должна содержать имена полей. При экспорте таблицы доступа или выбора запроса в текстовый файл с делимитируемой или фиксированной шириной Access вставляет имена <strong></strong> полей таблицы или выбирает запрос в первую строку текстового файла, если вы выбрали да для этого аргумента.<br/><br/>Если вы импортируете или связываете текстовый <strong></strong> файл с фиксированной шириной и выберите Да в этом поле, первая строка, содержащая имена полей, должна использовать набор делемитеров полей в спецификации импорта и экспорта, чтобы отделить имена полей. Если вы экспортируете в текстовый файл <strong></strong> с фиксированной шириной и выберите Да для этого аргумента, Access вставляет имена полей в первый ряд текстового файла с помощью этого делимитера.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя таблицы HTML</strong></p></td>
<td><p>Имя таблицы или списка в HTML-файле, который необходимо импортировать или ссылок. Этот аргумент игнорируется, если аргумент <strong>Типа</strong> передачи не заданной для импорта HTML или HTML ссылки. Если данный аргумент не задан, импортируется или связывается первая таблица или список в HTML-файле. <br/><br/>Имя таблицы или списка в HTML-файле определяется текстом, указанным тегом CAPTION, если есть тег &lt; &gt; &lt; &gt; CAPTION. Если тега &lt;CAPTION&gt; нет, имя определяется по тексту с тегом &lt;TITLE&gt;. Если несколько таблиц или списков имеют одно и то же имя, Access различает их, добавляя номер в конец каждого имени; например, Employees1 и Employees2.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Страница кода</strong></p></td>
<td><p>Имя набора символов, используемого на странице кода.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

Вы можете экспортировать данные запросов на выборку Access в текстовые файлы. Access экспортирует результирующий набор запроса так же, как таблицу.

Текстовые данные, которые вы примыкаете к существующей таблице доступа, должны быть совместимы со структурой таблицы.

- Каждое поле в тексте должно иметь тот же тип данных, что и соответствующее поле в таблице.

- Поля должны быть в том же порядке  (если не заказать аргумент "Имена полей" **да,** в этом случае имена полей в тексте должны соответствовать именам полей в таблице).

Это действие аналогично нажатию **текстового файла** в группе **Импорт** или **Экспорт** на вкладке **Внешние** данные. Аргументы действия **ImportExportText отражают** параметры мастера, запущенные командой **Text File.**

> [!TIP]
> Спецификация импорта и экспорта хранит сведения, необходимые для импорта, экспорта или ссылки на текстовый файл. Вы можете использовать сохраненные спецификации для импорта, экспорта или ссылки текстовых данных из или аналогичных текстовых файлов. Например, можно получать еженедельные данные о продажах в текстовом файле с компьютера mainframe. Вы можете создать и сохранить спецификацию для этого типа данных, а затем использовать спецификацию всякий раз, когда вы добавляете эти данные в базу данных Access.

> [!NOTE]
> Если вы запрашиваете или фильтруете связанный текстовый файл, запрос или фильтр чувствительны к делу.

Чтобы выполнить **действие ImportExportText** в модуле Visual Basic для приложений (VBA), используйте метод **TransferText** объекта **DoCmd.**


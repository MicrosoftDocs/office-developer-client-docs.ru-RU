---
title: Макрокоманда ImportExportText
TOCTitle: ImportExportText macro action
ms:assetid: 366fa095-6f09-7c22-e734-bfa585cfe79e
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192475(v=office.15)
ms:contentKeyID: 48544171
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm168097
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: a26b370e14dba68b0cbe686f4b23ae0db3fc1fea
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291868"
---
# <a name="importexporttext-macro-action"></a>Макрокоманда ImportExportText

**Область применения**: Access 2013, Office 2013

С помощью действия **ImportExportText** можно импортировать или экспортировать текст между текущей базой данных Microsoft Access (MDB или ACCDB) или проектом Access (ADP) и текстовым файлом. Вы также можете связать данные в текстовом файле с текущей базой данных Access. Это позволит просматривать текстовые файлы через Access, при этом не теряя возможность работы с ними в текстовом редакторе. Вы также можете импортировать, экспортировать и связать таблицу или список в HTML-файле \* (HTML).

> [!NOTE]
> При ссылке на данные в текстовом или HTML-файле данные доступны только для чтения в Access. Эта макрокоманда доступна только для доверенных баз данных. 

## <a name="setting"></a>Параметр

Действие **ImportExportText** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Тип преобразования</strong></p></td>
<td><p>Нужный тип преобразования. Вы можете импортировать данные из текстовых или HTML-файлов с разделителями или полями фиксированного размера, экспортировать их в такие файлы или создать ссылку на них. Вы также можете экспортировать данные в файл данных слияния почты Microsoft Word, который затем можно использовать с функцией слияния почты Word для создания объединенных документов, таких как буквы форм и метки рассылки. Select <strong>Import Delimited</strong>, <strong>Import Fixed Width</strong>, Import <strong>HTML</strong>, <strong>Export Delimited</strong>, Export Fixed Width , <strong>Export Fixed Width</strong>, <strong>Export</strong> <strong>Word for Windows Merge</strong>, <strong>Link Delimited</strong>, <strong>Link Fixed Width</strong>, or Link <strong>HTML</strong> in the <strong>Transfer Type</strong> box in the <strong>Action Arguments</strong> section of the Macro Builder pane. Значение по умолчанию <strong>: Import Delimited</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong>В проекте Access (ADP) поддерживаются только типы передачи import <STRONG>Delimited,</STRONG> <STRONG>Import Fixed Width</STRONG>, <STRONG>Export</STRONG> <STRONG>Fixed Width</STRONG>или Export Word for <STRONG>Windows Merge.</STRONG></p></td>
</tr>
<tr class="even">
<td><p><strong>Имя спецификации</strong></p></td>
<td><p>Имя спецификации для набора параметров, который определяет, как импортируется или связывается текстовый файл. Для текстового файла фиксированной ширины необходимо указать аргумент или использовать schema.ini, который должен храниться в той же папке, что и импортируемый или связанный текстовый файл.</p>
<p>Чтобы создать спецификацию для импорта или связывания текстового файла:</p>
<ol>
<li><p>В <strong>диалоговом</strong> окне "Получить внешние данные" введите путь к текстовому файлу источника в поле <strong>"Имя файла".</strong></p></li>
<li><p>Щелкните нужный параметр для хранения данных (импорт, приложение или ссылка) и нажмите кнопку <strong>"ОК".</strong></p></li>
<li><p>В <strong>диалоговом окне "Мастер импорта</strong> текста" нажмите кнопку <strong>"Дополнительные".</strong></p></li>
<li><p>Укажите нужные параметры для этой спецификации и нажмите кнопку <strong>"Сохранить как".</strong></p></li>
<li><p>Введите нужное имя спецификации и нажмите кнопку <strong>"ОК".</strong></p></li>
<li><p>Вы можете управлять существующими спецификациями, щелкнув <strong>"Спецификации"</strong> в диалоговом окне спецификаций.</p></li>
<li><p>Нажмите <strong>кнопку</strong> "ОК", чтобы закрыть диалоговое окно спецификации.</p></li>
</ol>
<p></p>
<p>Затем в этом аргументе можно ввести имя спецификации, чтобы импортировать или экспортировать текстовый файл одного типа. Вы можете импортировать, экспортировать или связать текстовые файлы с делегированием, не введя имя спецификации для этого аргумента. В этом случае Access использует значения по умолчанию в диалоговом окне мастера. Для файлов данных слияния почты в Access используется предопределный формат, поэтому при экспорте этих типов файлов не нужно ввести имя спецификации для этого аргумента. Спецификации импорта и экспорта можно использовать с HTML-файлами, но единственная применимая часть спецификации — это спецификация для форматирования типов данных.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя таблицы</strong></p></td>
<td><p>Имя таблицы Access для импорта текстовых данных, экспорта текстовых данных или связывать текстовые данные. Вы также можете ввести имя запроса Access, из которого вы хотите экспортировать данные. Это обязательный аргумент. Если в поле "Тип <strong></strong>переноса" щелкнуть "Импортировать с разметку", <strong></strong>"Импортировать фиксированную ширину" или "ИмпортИРОВАТЬ <strong>HTML-код",</strong> Access будет прикрепить текстовые данные к этой таблице, если таблица уже существует. <strong></strong> В противном случае Access создает таблицу, содержащую текстовые данные. Нельзя использовать SQL для указания экспортируемых данных при использовании действия <strong>ImportExportText.</strong> Вместо этого необходимо сначала создать запрос, а затем указать имя запроса в аргументе <strong>Имя таблицы</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя файла</strong></p></td>
<td><p>Имя текстового файла для импорта, экспорта или ссылки. Следует указывать полный путь. Обязательный аргумент. Access создает новый текстовый файл при экспорте данных из Access. Если имя файла такое же, как и имя существующего текстового файла, Access заменяет существующий текстовый файл. Если вы хотите импортировать или связать определенную таблицу или список в HTML-файле, можно использовать <strong>аргумент HTML Table Name.</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>С именами полей</strong></p></td>
<td><p>Указывает, содержит ли первая строка текстового файла имена полей. Если выбрано <strong>"Да",</strong>Access использует имена в этой строке в качестве имен полей в таблице Access при импорте или привязке текстовых данных. Если выбрано значение <strong>Нет</strong>, Access обрабатывает первую строку как обычную строку данных. По умолчанию используется значение <strong>Нет</strong>.<br/><br/>Access игнорирует этот аргумент для файлов данных слияния почты Windows в Word, так как первая строка должна содержать имена полей. При экспорте таблицы Access или выборе запроса в текстовый файл с заданной или фиксированной шириной Access вставляет имена полей <strong></strong> таблицы или выбирает запрос в первую строку текстового файла, если для этого аргумента выбрано "Да".<br/><br/>Если вы импортируете или связываете текстовый <strong></strong> файл фиксированной ширины и выбираете "Да" в этом поле, первая строка, содержащая имена полей, должна использовать разделительно полей, задав в спецификации импорта и экспорта, чтобы разделить имена полей. Если экспортируется в текстовый файл фиксированной <strong></strong> ширины и для этого аргумента выбрано "Да", Access вставляет имена полей в первую строку текстового файла с помощью этого замещения.</p></td>
</tr>
<tr class="even">
<td><p><strong>HTML-имя таблицы</strong></p></td>
<td><p>Имя таблицы или списка в HTML-файле, который необходимо импортировать или связать. Этот аргумент игнорируется, если для аргумента <strong>"Тип</strong> передачи" не установлено htmL-код импорта или HTML-код ссылки. Если данный аргумент не задан, импортируется или связывается первая таблица или список в HTML-файле. <br/><br/>Имя таблицы или списка в HTML-файле определяется текстом, указанным тегом CAPTION, если есть тег &lt; &gt; &lt; &gt; CAPTION. Если тега &lt;CAPTION&gt; нет, имя определяется по тексту с тегом &lt;TITLE&gt;. Если несколько таблиц или списков имеют одно и то же имя, Access различает их, добавляя число в конец каждого имени; например, Employees1 и Employees2.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Кодовая страница</strong></p></td>
<td><p>Имя набора символов, используемого со страницей кода.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Заметки

Вы можете экспортировать данные запросов на выборку Access в текстовые файлы. Access экспортирует результирующий набор запроса так же, как таблицу.

Текстовые данные, которые вы добавили в существующую таблицу Access, должны быть совместимы со структурой таблицы.

- Каждое поле в тексте должно иметь тот же тип данных, что и соответствующее поле в таблице.

- Поля должны быть в том же порядке (если для аргумента **"Has Field Names"** не установлено **"Да",** в этом случае имена полей в тексте должны совпадать с именами полей в таблице).

Это действие аналогично нажатию  **текстового файла** в группе импорта или экспорта на вкладке  **"Внешние данные".** Аргументы действия **ImportExportText** отражают параметры мастера, запущенные командой **"Текстовый файл".**

> [!TIP]
> В спецификации импорта и экспорта хранится информация, необходимая Access для импорта, экспорта или связываия текстового файла. Вы можете использовать сохраненные спецификации для импорта, экспорта или связываия текстовых данных из текстовых файлов или аналогичных текстовых файлов. Например, вы можете получать еженедельные показатели продаж в текстовом файле с главного компьютера. Вы можете создать и сохранить спецификацию для этого типа данных, а затем использовать спецификацию при добавлении этих данных в базу данных Access.

> [!NOTE]
> Если вы запрашиваете или фильтруете связанный текстовый файл, запрос или фильтр чувствительны к делу.

Чтобы запустить действие **ImportExportText** в модуле Visual Basic для приложений (VBA), используйте метод **TransferText** объекта **DoCmd.**


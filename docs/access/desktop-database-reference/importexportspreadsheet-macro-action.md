---
title: Макрокоманда ИмпортЭкспортЭлектроннойТаблицы
TOCTitle: ImportExportSpreadsheet macro action
ms:assetid: 526aef41-8329-5335-9d16-4d332542a297
ms:mtpsurl: https://msdn.microsoft.com/library/Ff193927(v=office.15)
ms:contentKeyID: 48544846
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm31446
f1_categories:
- Office.Version=v15
localization_priority: Priority
ms.openlocfilehash: f910393c6d7a64258e5afc7545641fc5c6778b03
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/18/2019
ms.locfileid: "28726010"
---
# <a name="importexportspreadsheet-macro-action"></a>Макрокоманда ИмпортЭкспортЭлектроннойТаблицы

**Область применения**: Access 2013, Office 2013

Макрокоманду **ИмпортЭкспортЭлектроннойТаблицы** можно использовать для импорта или экспорта данных между текущей базой данных Access (MDB или ACCDB) или проектом Access (ADP) и файлом электронной таблицы. Вы также можете связать данные в электронной таблице Microsoft Excel с текущей базой данных Microsoft Access. Это позволит просматривать и изменять данные электронной таблицы с помощью Access, при этом не теряя возможность полного доступа к ним в Excel. Кроме того, вы можете связать данные в файле электронной таблицы Lotus 1-2-3, но они будут доступны в Access только для чтения.

> [!NOTE]
> Эта макрокоманда доступна только для доверенных баз данных. 

## <a name="setting"></a>Параметры

Макрокоманда **TransferSpreadsheet** имеет указанные ниже аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Тип преобразования</strong></p></td>
<td><p>Нужный тип преобразования. В поле <strong>Тип преобразования</strong> в разделе <strong>Аргументы макрокоманды</strong> можно выбрать значение <strong>Импорт</strong>, <strong>Экспорт</strong> или <strong>Связь</strong>. Значение по умолчанию: <strong>Импорт</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong> Тип преобразования <STRONG>Связь</STRONG> не поддерживается для проектов Access (ADP).</p></td>
</tr>
<tr class="even">
<td><p><strong>Тип электронной таблицы</strong></p></td>
<td><p>Тип электронной таблицы для импорта, экспорта или связи. В этом поле можно выбрать один из типов электронной таблицы. Значение по умолчанию: <strong>Excel Workbook</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong> Можно импортировать данные из WK4-файлов Lotus или связать их (с доступом только для чтения), но нельзя экспортировать данные Access в этот формат. Кроме того, Access больше не поддерживает импорт, экспорт и связывание данных с помощью этой макрокоманды для WKS-файлов Lotus и электронных таблиц Excel версии 2.0. Если вы хотите импортировать или связать данные электронной таблицы в формате Excel версии 2.0 или Lotus WKS, необходимо преобразовать данные электронной таблицы в формат более поздней версии Excel или Lotus 1-2-3, прежде чем импортировать или связывать их.</p>
</td>
</tr>
<tr class="odd">
<td><p><strong>Имя таблицы</strong></p></td>
<td><p>Имя таблицы Access для импорта, экспорта или связывания данных электронной таблицы. Вы также можете ввести имя запроса на выборку Access, из которого следует экспортировать данные. Обязательный аргумент. Если для аргумента <strong>Тип преобразования</strong> выбрано значение <strong>Импорт</strong>, Access добавит данные электронной таблицы в указанную таблицу, если она уже существует. В противном случае Access создает новую таблицу для данных. При использовании в Access макрокоманды <strong>ИмпортЭкспортЭлектроннойТаблицы</strong> невозможно указать данные для экспорта с помощью инструкции SQL.  Вместо этого необходимо сначала создать запрос, а затем указать имя запроса в аргументе <strong>Имя таблицы</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя файла</strong></p></td>
<td><p>Имя файла электронной таблицы для импорта, экспорта или связи. Следует указывать полный путь. Обязательный аргумент. При экспорте данных из Access создается новая электронная таблица. Если имя файла совпадает с именем существующей электронной таблицы, Access заменяет ее, кроме случая экспорта в книгу Excel версии 5.0 или более поздней. В этом случае Access копирует экспортируемые данные в следующий доступный новый лист в книге. При импорте или связывании электронной таблицы Excel версии 5.0 или более поздней можно указать отдельный лист с помощью аргумента <strong>Диапазон</strong>.</p></td>
</tr>
<tr class="odd">
<td><p><strong>С именами полей</strong></p></td>
<td><p>Указывает, должна ли первая строка электронной таблицы содержать имена полей. Если выбрано значение <strong>Да</strong>, Access использует имена в этой строке как имена полей в таблице Access при импорте или связывании электронной таблицы. Если выбрано значение <strong>Нет</strong>, Access обрабатывает первую строку как обычную строку данных. По умолчанию используется значение <strong>Нет</strong>. При экспорте таблицы или запроса на выборку Access в электронную таблицу имена полей записываются в первую строку электронной таблицы независимо от значения этого аргумента.</p></td>
</tr>
<tr class="even">
<td><p><strong>Диапазон</strong></p></td>
<td><p>Диапазон ячеек для импорта или связи. Чтобы импортировать или связать электронную таблицу целиком, оставьте этот аргумент пустым. Вы можете ввести имя диапазона в электронной таблице или указать диапазон ячеек для импорта или связи, например А1:Е25 (обратите внимание, что синтаксис А1..Е25 не работает в Access 97 и более поздних версиях). При импорте или связывании электронной таблицы Excel версии 5.0 или более поздней можно добавить имя листа и восклицательный знак перед диапазоном, например Бюджет!А1:C7.</p><p><strong>ПРИМЕЧАНИЕ.</strong> При экспорте в электронную таблицу необходимо оставить этот аргумент пустым. Если ввести диапазон, экспорт завершится сбоем.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

Вы можете экспортировать данные запросов на выборку Access в электронные таблицы. Access экспортирует результирующий набор запроса, обрабатывая его так же, как таблицу.

Данные электронной таблицы, которые добавляются в существующую таблицу Access, должны соответствовать ее структуре.

- Каждое поле в электронной таблице должно иметь тот же тип данных, что и соответствующее поле в таблице Access.

- Поля должны следовать в том же порядке (за исключением случая, когда для аргумента **С именами полей** установлено значение **Да**: в этом случае названия полей в электронной таблице должны совпадать с именами полей в таблице Access).

Вызов данной макрокоманды аналогичен выбору **Excel** в группе **Импорт** или **Экспорт** на вкладке **Внешние данные**, а также выбору **Дополнительно** в группе **Импорт** или **Экспорт** с последующим щелчком варианта **Файл Lotus 1-2-3**. Вы можете использовать эти команды, чтобы выбрать источник данных, например базу данных Access или другого типа, электронную таблицу или текстовый файл. Если выбрана электронная таблица, на экране последовательно появляются диалоговые окна или запускается мастер Access, в котором можно указать имя электронной таблицы и другие параметры. Аргументы макрокоманды **ИмпортЭкспортЭлектроннойТаблицы** отражают параметры, заданные в этих диалоговых окнах или мастерах.

> [!NOTE]
> В запросах и фильтрах для связанной электронной таблицы учитывается регистр.

При связывании с электронной таблицей Excel, открытой в режиме редактирования, Access будет ждать окончания работы электронной таблицы Excel в этом режиме, чтобы завершить связывание; при этом нет ограничений по времени.

Чтобы выполнить макрокоманду **ИмпортЭкспортЭлектроннойТаблицы** в модуле Visual Basic для приложений (VBA), используйте метод **TransferSpreadsheet** объекта **DoCmd**.


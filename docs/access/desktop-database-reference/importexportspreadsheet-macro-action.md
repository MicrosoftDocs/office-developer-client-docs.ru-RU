---
title: Макрокоманда ImportExportSpreadsheet
TOCTitle: ImportExportSpreadsheet macro action
ms:assetid: 526aef41-8329-5335-9d16-4d332542a297
ms:mtpsurl: https://msdn.microsoft.com/library/Ff193927(v=office.15)
ms:contentKeyID: 48544846
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm31446
f1_categories:
- Office.Version=v15
ms.openlocfilehash: eaab9d43e85ee94c5e71d52399a92515cce94693
ms.sourcegitcommit: 1dd744993ecb4bed241ace874ad26edaef1778b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2018
ms.locfileid: "25997135"
---
# <a name="importexportspreadsheet-macro-action"></a><span data-ttu-id="d0eff-102">Макрокоманда ImportExportSpreadsheet</span><span class="sxs-lookup"><span data-stu-id="d0eff-102">ImportExportSpreadsheet macro action</span></span>

<span data-ttu-id="d0eff-103">**Применимо к**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="d0eff-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="d0eff-104">Действие **ImportExportSpreadsheet** можно использовать для импорта или экспорта данных между текущей базы данных Access (MDB- или .accdb) или проект Microsoft Access (файлы с расширением ADP) и файла электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-104">You can use the **ImportExportSpreadsheet** action to import or export data between the current Access database (.mdb or .accdb) or Access project (.adp) and a spreadsheet file.</span></span> <span data-ttu-id="d0eff-105">Также можно связать данные в электронную таблицу Microsoft Excel для текущей базы данных Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="d0eff-105">You can also link the data in a Microsoft Excel spreadsheet to the current Microsoft Access database.</span></span> <span data-ttu-id="d0eff-106">Связывания электронной таблицы можно просматривать и изменять данные электронной таблицы с доступом по-прежнему предоставляя полный доступ к данным из программы электронной таблицы Excel.</span><span class="sxs-lookup"><span data-stu-id="d0eff-106">With a linked spreadsheet, you can view and edit the spreadsheet data with Access while still allowing complete access to the data from your Excel spreadsheet program.</span></span> <span data-ttu-id="d0eff-107">Также можно связать с данным в файл электронной таблицы Lotus 1-2-3, но эти данные в доступа только для чтения.</span><span class="sxs-lookup"><span data-stu-id="d0eff-107">You can also link to data in a Lotus 1-2-3 spreadsheet file, but this data is read-only in Access.</span></span>

> [!NOTE]
> <span data-ttu-id="d0eff-108">Это действие не разрешено, если база данных не является доверенной.</span><span class="sxs-lookup"><span data-stu-id="d0eff-108">This action will not be allowed if the database is not trusted.</span></span> 

## <a name="setting"></a><span data-ttu-id="d0eff-109">Параметр</span><span class="sxs-lookup"><span data-stu-id="d0eff-109">Setting</span></span>

<span data-ttu-id="d0eff-110">**ПреобразоватьЭлектроннуюТаблицу** имеет следующие аргументы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-110">The **TransferSpreadsheet** action has the following arguments.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p><span data-ttu-id="d0eff-111">Аргумент макрокоманды</span><span class="sxs-lookup"><span data-stu-id="d0eff-111">Action argument</span></span></p></th>
<th><p><span data-ttu-id="d0eff-112">Описание</span><span class="sxs-lookup"><span data-stu-id="d0eff-112">Description</span></span></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><span data-ttu-id="d0eff-113"><strong>Тип передачи</strong></span><span class="sxs-lookup"><span data-stu-id="d0eff-113"><strong>Transfer Type</strong></span></span></p></td>
<td><p><span data-ttu-id="d0eff-114">Тип переноса, который требуется сделать.</span><span class="sxs-lookup"><span data-stu-id="d0eff-114">The type of transfer you want to make.</span></span> <span data-ttu-id="d0eff-115">Выберите <strong>Импорт</strong>, <strong>Экспорт</strong>или <strong>ссылку</strong> в поле <strong>Тип преобразования</strong> в разделе <strong>Действие аргументы</strong> в области построения макросов.</span><span class="sxs-lookup"><span data-stu-id="d0eff-115">Select <strong>Import</strong>, <strong>Export</strong>, or <strong>Link</strong> in the <strong>Transfer Type</strong> box in the <strong>Action Arguments</strong> section of the Macro Builder pane.</span></span> <span data-ttu-id="d0eff-116">Значение по умолчанию — <strong>Импорт</strong>.</span><span class="sxs-lookup"><span data-stu-id="d0eff-116">The default is <strong>Import</strong>.</span></span></p><p><span data-ttu-id="d0eff-117"><strong>Примечание</strong>: тип передачи <STRONG>связи</STRONG> не поддерживается для проектов Access (файлы с расширением ADP).</span><span class="sxs-lookup"><span data-stu-id="d0eff-117"><strong>NOTE</strong>: The <STRONG>Link</STRONG> transfer type is not supported for Access projects (.adp).</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="d0eff-118"><strong>Тип электронной таблицы</strong></span><span class="sxs-lookup"><span data-stu-id="d0eff-118"><strong>Spreadsheet Type</strong></span></span></p></td>
<td><p><span data-ttu-id="d0eff-119">Тип электронной таблицы для импорта, экспорта или ссылка на.</span><span class="sxs-lookup"><span data-stu-id="d0eff-119">The type of spreadsheet to import from, export to, or link to.</span></span> <span data-ttu-id="d0eff-120">В поле можно выбрать один из нескольких типов электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-120">You can select one of a number of spreadsheet types in the box.</span></span> <span data-ttu-id="d0eff-121">Значение по умолчанию — <strong>Книги Excel</strong>.</span><span class="sxs-lookup"><span data-stu-id="d0eff-121">The default is <strong>Excel Workbook</strong>.</span></span></p><p><span data-ttu-id="d0eff-122"><strong>Примечание</strong>: можно импортировать из и ссылка на Lotus (только для чтения). Файлы WK4, но не может экспортировать доступ к данным в данном формате электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-122"><strong>NOTE</strong>: You can import from and link (read-only) to Lotus .WK4 files, but you can't export Access data to this spreadsheet format.</span></span> <span data-ttu-id="d0eff-123">Access больше не поддерживает импорт, экспорт или связывание данных из Lotus. WKS или электронные таблицы Excel версии 2.0 с помощью этого действия.</span><span class="sxs-lookup"><span data-stu-id="d0eff-123">Access also no longer supports importing, exporting, or linking data from Lotus .WKS or Excel version 2.0 spreadsheets with this action.</span></span> <span data-ttu-id="d0eff-124">Если вы хотите импортировать из или ссылка на данные электронной таблицы в Excel версии 2.0 или Lotus. WKS форматирование, преобразование данных электронных таблиц в более поздней версии Excel или Lotus 1-2-3 перед Импорт или связывание данных в Access.</span><span class="sxs-lookup"><span data-stu-id="d0eff-124">If you want to import from or link to spreadsheet data in Excel version 2.0 or Lotus .WKS format, convert the spreadsheet data to a later version of Excel or Lotus 1-2-3 before importing or linking the data into Access.</span></span></p>
</td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="d0eff-125"><strong>Имя таблицы</strong></span><span class="sxs-lookup"><span data-stu-id="d0eff-125"><strong>Table Name</strong></span></span></p></td>
<td><p><span data-ttu-id="d0eff-126">Имя таблицы Access Импорт данных электронных таблиц для экспорта данных электронной таблицы из или связывание данных электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-126">The name of the Access table to import spreadsheet data to, export spreadsheet data from, or link spreadsheet data to.</span></span> <span data-ttu-id="d0eff-127">Также можно ввести имя доступа выберите запрос, который необходимо экспортировать данные из.</span><span class="sxs-lookup"><span data-stu-id="d0eff-127">You can also type the name of the Access select query you want to export data from.</span></span> <span data-ttu-id="d0eff-128">Обязательный аргумент.</span><span class="sxs-lookup"><span data-stu-id="d0eff-128">This is a required argument.</span></span> <span data-ttu-id="d0eff-129">При выборе <strong>импорта</strong> в аргументе <strong>Тип</strong> доступа добавляет данным электронных таблиц в этой таблице, если таблица уже существует.</span><span class="sxs-lookup"><span data-stu-id="d0eff-129">If you select <strong>Import</strong> in the <strong>Transfer Type</strong> argument, Access appends the spreadsheet data to this table if the table already exists.</span></span> <span data-ttu-id="d0eff-130">В противном случае создается новая таблица с данными электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-130">Otherwise, Access creates a new table containing the spreadsheet data.</span></span> <span data-ttu-id="d0eff-131">В клиенте нельзя использовать инструкции SQL для указания данных для экспорта при использовании <strong>ImportExportSpreadsheet</strong> действие.</span><span class="sxs-lookup"><span data-stu-id="d0eff-131">In Access, you can't use an SQL statement to specify data to export when you are using the <strong>ImportExportSpreadsheet</strong> action.</span></span> <span data-ttu-id="d0eff-132">Вместо использования инструкции SQL, необходимо сначала создать запрос и затем указать имя запроса в качестве аргумента <strong>Имя таблицы</strong> .</span><span class="sxs-lookup"><span data-stu-id="d0eff-132">Instead of using an SQL statement, you must first create a query and then specify the name of the query in the <strong>Table Name</strong> argument.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="d0eff-133"><strong>Имя файла</strong></span><span class="sxs-lookup"><span data-stu-id="d0eff-133"><strong>File Name</strong></span></span></p></td>
<td><p><span data-ttu-id="d0eff-134">Имя файла электронной таблицы для импорта, экспорта или ссылка на.</span><span class="sxs-lookup"><span data-stu-id="d0eff-134">The name of the spreadsheet file to import from, export to, or link to.</span></span> <span data-ttu-id="d0eff-135">Включите полный путь.</span><span class="sxs-lookup"><span data-stu-id="d0eff-135">Include the full path.</span></span> <span data-ttu-id="d0eff-136">Обязательный аргумент.</span><span class="sxs-lookup"><span data-stu-id="d0eff-136">This is a required argument.</span></span> <span data-ttu-id="d0eff-137">Access создает новую таблицу при экспорте данных из Access.</span><span class="sxs-lookup"><span data-stu-id="d0eff-137">Access creates a new spreadsheet when you export data from Access.</span></span> <span data-ttu-id="d0eff-138">Если имя файла совпадает с именем существующей электронной таблицы, Access заменяет существующей электронной таблицы, если не экспорте книги 5.0 или более поздней версии Excel.</span><span class="sxs-lookup"><span data-stu-id="d0eff-138">If the file name is the same as the name of an existing spreadsheet, Access replaces the existing spreadsheet, unless you're exporting to an Excel version 5.0 or later workbook.</span></span> <span data-ttu-id="d0eff-139">В этом случае Access копирует экспортируемых данных доступен следующий нового листа в книге.</span><span class="sxs-lookup"><span data-stu-id="d0eff-139">In that case, Access copies the exported data to the next available new worksheet in the workbook.</span></span> <span data-ttu-id="d0eff-140">При импорте из или ссылки на Excel версий 5.0 или более поздних версий, определенного рабочего листа можно указать с помощью аргумент <strong>диапазон</strong> .</span><span class="sxs-lookup"><span data-stu-id="d0eff-140">If you are importing from or linking to an Excel version 5.0 or later spreadsheet, you can specify a particular worksheet by using the <strong>Range</strong> argument.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="d0eff-141"><strong>Содержит имена полей</strong></span><span class="sxs-lookup"><span data-stu-id="d0eff-141"><strong>Has Field Names</strong></span></span></p></td>
<td><p><span data-ttu-id="d0eff-142">Указывает, содержит ли первой строки электронной таблицы имена полей.</span><span class="sxs-lookup"><span data-stu-id="d0eff-142">Specifies whether the first row of the spreadsheet contains the names of the fields.</span></span> <span data-ttu-id="d0eff-143">Если выбран вариант <strong>Да</strong>, Access использует имена в этой строке как имена полей таблицы Microsoft Access при Импорт или связывание данных электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-143">If you select <strong>Yes</strong>, Access uses the names in this row as field names in the Access table when you import or link the spreadsheet data.</span></span> <span data-ttu-id="d0eff-144">Если выбран вариант <strong>Нет</strong>, Access рассматривается как обычная строка данных первой строки.</span><span class="sxs-lookup"><span data-stu-id="d0eff-144">If you select <strong>No</strong>, Access treats the first row as a normal row of data.</span></span> <span data-ttu-id="d0eff-145">Значение по умолчанию: <strong>Нет</strong>.</span><span class="sxs-lookup"><span data-stu-id="d0eff-145">The default is <strong>No</strong>.</span></span> <span data-ttu-id="d0eff-146">При экспорте таблицы Microsoft Access или выборку в электронную таблицу имена полей вставляется в первую строку электронной таблицы независимо от того, вы выбираете в этот аргумент.</span><span class="sxs-lookup"><span data-stu-id="d0eff-146">When you export an Access table or select query to a spreadsheet, the field names are inserted into the first row of the spreadsheet no matter what you select in this argument.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="d0eff-147"><strong>Range</strong></span><span class="sxs-lookup"><span data-stu-id="d0eff-147"><strong>Range</strong></span></span></p></td>
<td><p><span data-ttu-id="d0eff-148">Диапазон ячеек для импорта.</span><span class="sxs-lookup"><span data-stu-id="d0eff-148">The range of cells to import or link.</span></span> <span data-ttu-id="d0eff-149">Оставьте данный аргумент пустым, чтобы импортировать или связать всей таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-149">Leave this argument blank to import or link the entire spreadsheet.</span></span> <span data-ttu-id="d0eff-150">Можно ввести имя диапазона в электронной таблице или указать диапазон ячеек для импорта, такие как A1:E25 (Обратите внимание, что A1.. Синтаксис E25 не работает в Microsoft Access 97 или более поздней версии).</span><span class="sxs-lookup"><span data-stu-id="d0eff-150">You can type the name of a range in the spreadsheet or specify the range of cells to import or link, such as A1:E25 (note that the A1..E25 syntax does not work in Access 97 or later).</span></span> <span data-ttu-id="d0eff-151">При импорте из или ссылки на Excel версий 5.0 или более поздних версий, можно перед именем диапазона имя листа и восклицательный знак; Например, бюджет! A1:C7.</span><span class="sxs-lookup"><span data-stu-id="d0eff-151">If you are importing from or linking to an Excel version 5.0 or later spreadsheet, you can prefix the range with the name of the worksheet and an exclamation point; for example, Budget!A1:C7.</span></span></p><p><span data-ttu-id="d0eff-152"><strong>Примечание</strong>: при экспорте в электронную таблицу, этот аргумент необходимо оставить пустым.</span><span class="sxs-lookup"><span data-stu-id="d0eff-152"><strong>NOTE</strong>: When you export to a spreadsheet, you must leave this argument blank.</span></span> <span data-ttu-id="d0eff-153">Если ввести диапазон, экспорт завершится с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="d0eff-153">If you enter a range, the export will fail.</span></span></p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a><span data-ttu-id="d0eff-154">Примечания</span><span class="sxs-lookup"><span data-stu-id="d0eff-154">Remarks</span></span>

<span data-ttu-id="d0eff-155">Можно экспортировать данные в запросах доступа электронных таблиц.</span><span class="sxs-lookup"><span data-stu-id="d0eff-155">You can export the data in Access select queries to spreadsheets.</span></span> <span data-ttu-id="d0eff-156">Microsoft Access экспортирует набор результатов запроса в виде таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-156">Access exports the result set of the query, treating it just like a table.</span></span>

<span data-ttu-id="d0eff-157">Данные электронной таблицы, добавляемые в существующую таблицу Access должны быть совместимы со структурой таблицы.</span><span class="sxs-lookup"><span data-stu-id="d0eff-157">Spreadsheet data that you append to an existing Access table must be compatible with the table's structure.</span></span>

- <span data-ttu-id="d0eff-158">Каждое поле в таблице должен быть типу данных, то соответствующее поле в таблице.</span><span class="sxs-lookup"><span data-stu-id="d0eff-158">Each field in the spreadsheet must be of the same data type as the corresponding field in the table.</span></span>

- <span data-ttu-id="d0eff-159">Поля должны быть в том же порядке (Если аргумент **Содержит имена полей** задано значение **Да**, в этом случае поле имена в электронной таблице должны совпадать имена полей в таблице).</span><span class="sxs-lookup"><span data-stu-id="d0eff-159">The fields must be in the same order (unless you set the **Has Field Names** argument to **Yes**, in which case the field names in the spreadsheet must match the field names in the table).</span></span>

<span data-ttu-id="d0eff-160">Это действие аналогично выбрав вкладку **Внешних данных** и и выбрав пункты **Excel** в **Импорт** или **Экспорт** группу или **несколько** в группе **Импорт** или **Экспорт** и щелкнув **Файл Lotus 1-2-3**.</span><span class="sxs-lookup"><span data-stu-id="d0eff-160">This action is similar to clicking the **External Data** tab and clicking **Excel** in the **Import** or **Export** group, or clicking **More** in the **Import** or **Export** group and clicking **Lotus 1-2-3 File**.</span></span> <span data-ttu-id="d0eff-161">Эти команды можно использовать для выбора источника данных, например Access или тип базы данных, электронную таблицу или текстовый файл.</span><span class="sxs-lookup"><span data-stu-id="d0eff-161">You can use these commands to select a source of data, such as Access or a type of database, spreadsheet, or text file.</span></span> <span data-ttu-id="d0eff-162">При выборе электронной таблице отображается ряд диалоговых окон или запускается мастер Microsoft Access, в котором выберите имя электронной таблицы и другие параметры.</span><span class="sxs-lookup"><span data-stu-id="d0eff-162">If you select a spreadsheet, a series of dialog boxes appear, or an Access wizard runs, in which you select the name of the spreadsheet and other options.</span></span> <span data-ttu-id="d0eff-163">Аргументы действие **ImportExportSpreadsheet** соответствуют параметрам этих диалоговых окон или мастера.</span><span class="sxs-lookup"><span data-stu-id="d0eff-163">The arguments of the **ImportExportSpreadsheet** action reflect the options in these dialog boxes or in the wizards.</span></span>

> [!NOTE]
> <span data-ttu-id="d0eff-164">Запроса и фильтрации связанной электронной таблице запроса или фильтра с учетом регистра.</span><span class="sxs-lookup"><span data-stu-id="d0eff-164">If you query or filter a linked spreadsheet, the query or filter is case-sensitive.</span></span>

<span data-ttu-id="d0eff-165">При связывании таблицы Excel, которая открыта в режиме редактирования Access будет ждать в электронной таблице Excel — режим редактирования перед завершением ссылок; нет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="d0eff-165">If you link to an Excel spreadsheet that is open in Edit mode, Access will wait until the Excel spreadsheet is out of Edit mode before completing the link; there's no time-out.</span></span>

<span data-ttu-id="d0eff-166">Чтобы выполнить действие **ImportExportSpreadsheet** в Visual Basic для приложений (VBA) модуль, используйте метод **ПреобразоватьЭлектроннуюТаблицу** **объекта** .</span><span class="sxs-lookup"><span data-stu-id="d0eff-166">To run the **ImportExportSpreadsheet** action in a Visual Basic for Applications (VBA) module, use the **TransferSpreadsheet** method of the **DoCmd** object.</span></span>


---
title: Макрокоманда ИмпортЭкспортЭлектроннойТаблицы
TOCTitle: ImportExportSpreadsheet macro action
ms:assetid: 526aef41-8329-5335-9d16-4d332542a297
ms:mtpsurl: https://msdn.microsoft.com/library/Ff193927(v=office.15)
ms:contentKeyID: 48544846
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm31446
f1_categories:
- Office.Version=v15
localization_priority: Priority
ms.openlocfilehash: f910393c6d7a64258e5afc7545641fc5c6778b03
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291875"
---
# <a name="importexportspreadsheet-macro-action"></a><span data-ttu-id="ddc55-102">Макрокоманда ИмпортЭкспортЭлектроннойТаблицы</span><span class="sxs-lookup"><span data-stu-id="ddc55-102">ImportExportSpreadsheet macro action</span></span>

<span data-ttu-id="ddc55-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="ddc55-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="ddc55-104">Макрокоманду **ИмпортЭкспортЭлектроннойТаблицы** можно использовать для импорта или экспорта данных между текущей базой данных Access (MDB или ACCDB) или проектом Access (ADP) и файлом электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="ddc55-104">You can use the **ImportExportSpreadsheet** action to import or export data between the current Access database (.mdb or .accdb) or Access project (.adp) and a spreadsheet file.</span></span> <span data-ttu-id="ddc55-105">Вы также можете связать данные в электронной таблице Microsoft Excel с текущей базой данных Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="ddc55-105">You can also link the data in a Microsoft Excel spreadsheet to the current Microsoft Access database.</span></span> <span data-ttu-id="ddc55-106">Это позволит просматривать и изменять данные электронной таблицы с помощью Access, при этом не теряя возможность полного доступа к ним в Excel.</span><span class="sxs-lookup"><span data-stu-id="ddc55-106">With a linked spreadsheet, you can view and edit the spreadsheet data with Access while still allowing complete access to the data from your Excel spreadsheet program.</span></span> <span data-ttu-id="ddc55-107">Кроме того, вы можете связать данные в файле электронной таблицы Lotus 1-2-3, но они будут доступны в Access только для чтения.</span><span class="sxs-lookup"><span data-stu-id="ddc55-107">You can also link to data in a Lotus 1-2-3 spreadsheet file, but this data is read-only in Access.</span></span>

> [!NOTE]
> <span data-ttu-id="ddc55-108">Эта макрокоманда доступна только для доверенных баз данных.</span><span class="sxs-lookup"><span data-stu-id="ddc55-108">This action will not be allowed if the database is not trusted.</span></span> 

## <a name="setting"></a><span data-ttu-id="ddc55-109">Параметры</span><span class="sxs-lookup"><span data-stu-id="ddc55-109">Setting</span></span>

<span data-ttu-id="ddc55-110">Макрокоманда **ПреобразоватьЭлектроннуюТаблицу** имеет указанные ниже аргументы.</span><span class="sxs-lookup"><span data-stu-id="ddc55-110">The **TransferSpreadsheet** action has the following arguments.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p><span data-ttu-id="ddc55-111">Аргумент макрокоманды</span><span class="sxs-lookup"><span data-stu-id="ddc55-111">Action argument</span></span></p></th>
<th><p><span data-ttu-id="ddc55-112">Описание</span><span class="sxs-lookup"><span data-stu-id="ddc55-112">Description</span></span></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><span data-ttu-id="ddc55-113"><strong>Тип преобразования</strong></span><span class="sxs-lookup"><span data-stu-id="ddc55-113"><strong>Transfer Type</strong></span></span></p></td>
<td><p><span data-ttu-id="ddc55-114">Нужный тип преобразования.</span><span class="sxs-lookup"><span data-stu-id="ddc55-114">The type of transfer you want to make.</span></span> <span data-ttu-id="ddc55-115">В поле <strong>Тип преобразования</strong> в разделе <strong>Аргументы макрокоманды</strong> можно выбрать значение <strong>Импорт</strong>, <strong>Экспорт</strong> или <strong>Связь</strong>.</span><span class="sxs-lookup"><span data-stu-id="ddc55-115">Select <strong>Import</strong>, <strong>Export</strong>, or <strong>Link</strong> in the <strong>Transfer Type</strong> box in the <strong>Action Arguments</strong> section of the Macro Builder pane.</span></span> <span data-ttu-id="ddc55-116">Значение по умолчанию: <strong>Импорт</strong>.</span><span class="sxs-lookup"><span data-stu-id="ddc55-116">The default is <strong>Import</strong>.</span></span></p><p><span data-ttu-id="ddc55-117"><strong>ПРИМЕЧАНИЕ.</strong> Тип преобразования <STRONG>Связь</STRONG> не поддерживается для проектов Access (ADP).</span><span class="sxs-lookup"><span data-stu-id="ddc55-117"><strong>NOTE</strong>: The <STRONG>Link</STRONG> transfer type is not supported for Access projects (.adp).</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="ddc55-118"><strong>Тип электронной таблицы</strong></span><span class="sxs-lookup"><span data-stu-id="ddc55-118"><strong>Spreadsheet Type</strong></span></span></p></td>
<td><p><span data-ttu-id="ddc55-119">Тип электронной таблицы для импорта, экспорта или связи.</span><span class="sxs-lookup"><span data-stu-id="ddc55-119">The type of spreadsheet to import from, export to, or link to.</span></span> <span data-ttu-id="ddc55-120">В этом поле можно выбрать один из типов электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="ddc55-120">You can select one of a number of spreadsheet types in the box.</span></span> <span data-ttu-id="ddc55-121">Значение по умолчанию: <strong>Книга Excel</strong>.</span><span class="sxs-lookup"><span data-stu-id="ddc55-121">The default is <strong>Excel Workbook</strong>.</span></span></p><p><span data-ttu-id="ddc55-122"><strong>ПРИМЕЧАНИЕ.</strong> Можно импортировать данные из WK4-файлов Lotus или связать их (с доступом только для чтения), но нельзя экспортировать данные Access в этот формат.</span><span class="sxs-lookup"><span data-stu-id="ddc55-122"><strong>NOTE</strong>: You can import from and link (read-only) to Lotus .WK4 files, but you can't export Access data to this spreadsheet format.</span></span> <span data-ttu-id="ddc55-123">Кроме того, Access больше не поддерживает импорт, экспорт и связывание данных с помощью этой макрокоманды для WKS-файлов Lotus и электронных таблиц Excel версии 2.0.</span><span class="sxs-lookup"><span data-stu-id="ddc55-123">Access also no longer supports importing, exporting, or linking data from Lotus .WKS or Excel version 2.0 spreadsheets with this action.</span></span> <span data-ttu-id="ddc55-124">Если вы хотите импортировать или связать данные электронной таблицы в формате Excel версии 2.0 или Lotus WKS, необходимо преобразовать данные электронной таблицы в формат более поздней версии Excel или Lotus 1-2-3, прежде чем импортировать или связывать их.</span><span class="sxs-lookup"><span data-stu-id="ddc55-124">If you want to import from or link to spreadsheet data in Excel version 2.0 or Lotus .WKS format, convert the spreadsheet data to a later version of Excel or Lotus 1-2-3 before importing or linking the data into Access.</span></span></p>
</td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="ddc55-125"><strong>Имя таблицы</strong></span><span class="sxs-lookup"><span data-stu-id="ddc55-125"><strong>Table Name</strong></span></span></p></td>
<td><p><span data-ttu-id="ddc55-126">Имя таблицы Access для импорта, экспорта или связывания данных электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="ddc55-126">The name of the Access table to import spreadsheet data to, export spreadsheet data from, or link spreadsheet data to.</span></span> <span data-ttu-id="ddc55-127">Вы также можете ввести имя запроса на выборку Access, из которого следует экспортировать данные.</span><span class="sxs-lookup"><span data-stu-id="ddc55-127">You can also type the name of the Access select query you want to export data from.</span></span> <span data-ttu-id="ddc55-128">Обязательный аргумент.</span><span class="sxs-lookup"><span data-stu-id="ddc55-128">This is a required argument.</span></span> <span data-ttu-id="ddc55-129">Если для аргумента <strong>Тип преобразования</strong> выбрано значение <strong>Импорт</strong>, Access добавит данные электронной таблицы в указанную таблицу, если она уже существует.</span><span class="sxs-lookup"><span data-stu-id="ddc55-129">If you select <strong>Import</strong> in the <strong>Transfer Type</strong> argument, Access appends the spreadsheet data to this table if the table already exists.</span></span> <span data-ttu-id="ddc55-130">В противном случае Access создает новую таблицу для данных.</span><span class="sxs-lookup"><span data-stu-id="ddc55-130">Otherwise, Access creates a new table containing the spreadsheet data.</span></span> <span data-ttu-id="ddc55-131">При использовании в Access макрокоманды <strong>ИмпортЭкспортЭлектроннойТаблицы</strong> невозможно указать данные для экспорта с помощью инструкции SQL. </span><span class="sxs-lookup"><span data-stu-id="ddc55-131">In Access, you can't use an SQL statement to specify data to export when you are using the <strong>ImportExportSpreadsheet</strong> action.</span></span> <span data-ttu-id="ddc55-132">Вместо этого необходимо сначала создать запрос, а затем указать имя запроса в аргументе <strong>Имя таблицы</strong>.</span><span class="sxs-lookup"><span data-stu-id="ddc55-132">Instead of using an SQL statement, you must first create a query and then specify the name of the query in the <strong>Table Name</strong> argument.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="ddc55-133"><strong>Имя файла</strong></span><span class="sxs-lookup"><span data-stu-id="ddc55-133"><strong>File Name</strong></span></span></p></td>
<td><p><span data-ttu-id="ddc55-134">Имя файла электронной таблицы для импорта, экспорта или связи.</span><span class="sxs-lookup"><span data-stu-id="ddc55-134">The name of the spreadsheet file to import from, export to, or link to.</span></span> <span data-ttu-id="ddc55-135">Следует указывать полный путь.</span><span class="sxs-lookup"><span data-stu-id="ddc55-135">Include the full path.</span></span> <span data-ttu-id="ddc55-136">Обязательный аргумент.</span><span class="sxs-lookup"><span data-stu-id="ddc55-136">This is a required argument.</span></span> <span data-ttu-id="ddc55-137">При экспорте данных из Access создается новая электронная таблица.</span><span class="sxs-lookup"><span data-stu-id="ddc55-137">Access creates a new spreadsheet when you export data from Access.</span></span> <span data-ttu-id="ddc55-138">Если имя файла совпадает с именем существующей электронной таблицы, Access заменяет ее, кроме случая экспорта в книгу Excel версии 5.0 или более поздней.</span><span class="sxs-lookup"><span data-stu-id="ddc55-138">If the file name is the same as the name of an existing spreadsheet, Access replaces the existing spreadsheet, unless you're exporting to an Excel version 5.0 or later workbook.</span></span> <span data-ttu-id="ddc55-139">В этом случае Access копирует экспортируемые данные в следующий доступный новый лист в книге.</span><span class="sxs-lookup"><span data-stu-id="ddc55-139">In that case, Access copies the exported data to the next available new worksheet in the workbook.</span></span> <span data-ttu-id="ddc55-140">При импорте или связывании электронной таблицы Excel версии 5.0 или более поздней можно указать отдельный лист с помощью аргумента <strong>Диапазон</strong>.</span><span class="sxs-lookup"><span data-stu-id="ddc55-140">If you are importing from or linking to an Excel version 5.0 or later spreadsheet, you can specify a particular worksheet by using the <strong>Range</strong> argument.</span></span></p></td>
</tr>
<tr class="odd">
<td><p><span data-ttu-id="ddc55-141"><strong>С именами полей</strong></span><span class="sxs-lookup"><span data-stu-id="ddc55-141"><strong>Has Field Names</strong></span></span></p></td>
<td><p><span data-ttu-id="ddc55-142">Указывает, должна ли первая строка электронной таблицы содержать имена полей.</span><span class="sxs-lookup"><span data-stu-id="ddc55-142">Specifies whether the first row of the spreadsheet contains the names of the fields.</span></span> <span data-ttu-id="ddc55-143">Если выбрано значение <strong>Да</strong>, Access использует имена в этой строке как имена полей в таблице Access при импорте или связывании электронной таблицы.</span><span class="sxs-lookup"><span data-stu-id="ddc55-143">If you select <strong>Yes</strong>, Access uses the names in this row as field names in the Access table when you import or link the spreadsheet data.</span></span> <span data-ttu-id="ddc55-144">Если выбрано значение <strong>Нет</strong>, Access обрабатывает первую строку как обычную строку данных.</span><span class="sxs-lookup"><span data-stu-id="ddc55-144">If you select <strong>No</strong>, Access treats the first row as a normal row of data.</span></span> <span data-ttu-id="ddc55-145">По умолчанию используется значение <strong>Нет</strong>.</span><span class="sxs-lookup"><span data-stu-id="ddc55-145">The default is <strong>No</strong>.</span></span> <span data-ttu-id="ddc55-146">При экспорте таблицы или запроса на выборку Access в электронную таблицу имена полей записываются в первую строку электронной таблицы независимо от значения этого аргумента.</span><span class="sxs-lookup"><span data-stu-id="ddc55-146">When you export an Access table or select query to a spreadsheet, the field names are inserted into the first row of the spreadsheet no matter what you select in this argument.</span></span></p></td>
</tr>
<tr class="even">
<td><p><span data-ttu-id="ddc55-147"><strong>Диапазон</strong></span><span class="sxs-lookup"><span data-stu-id="ddc55-147"><strong>Range</strong></span></span></p></td>
<td><p><span data-ttu-id="ddc55-148">Диапазон ячеек для импорта или связи.</span><span class="sxs-lookup"><span data-stu-id="ddc55-148">The range of cells to import or link.</span></span> <span data-ttu-id="ddc55-149">Чтобы импортировать или связать электронную таблицу целиком, оставьте этот аргумент пустым.</span><span class="sxs-lookup"><span data-stu-id="ddc55-149">Leave this argument blank to import or link the entire spreadsheet.</span></span> <span data-ttu-id="ddc55-150">Вы можете ввести имя диапазона в электронной таблице или указать диапазон ячеек для импорта или связи, например А1:Е25 (обратите внимание, что синтаксис А1..Е25 не работает в Access 97 и более поздних версиях).</span><span class="sxs-lookup"><span data-stu-id="ddc55-150">You can type the name of a range in the spreadsheet or specify the range of cells to import or link, such as A1:E25 (note that the A1..E25 syntax does not work in Access 97 or later).</span></span> <span data-ttu-id="ddc55-151">При импорте или связывании электронной таблицы Excel версии 5.0 или более поздней можно добавить имя листа и восклицательный знак перед диапазоном, например Бюджет!А1:C7.</span><span class="sxs-lookup"><span data-stu-id="ddc55-151">If you are importing from or linking to an Excel version 5.0 or later spreadsheet, you can prefix the range with the name of the worksheet and an exclamation point; for example, Budget!A1:C7.</span></span></p><p><span data-ttu-id="ddc55-152"><strong>ПРИМЕЧАНИЕ.</strong> При экспорте в электронную таблицу необходимо оставить этот аргумент пустым.</span><span class="sxs-lookup"><span data-stu-id="ddc55-152"><strong>NOTE</strong>: When you export to a spreadsheet, you must leave this argument blank.</span></span> <span data-ttu-id="ddc55-153">Если ввести диапазон, экспорт завершится сбоем.</span><span class="sxs-lookup"><span data-stu-id="ddc55-153">If you enter a range, the export will fail.</span></span></p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a><span data-ttu-id="ddc55-154">Примечания</span><span class="sxs-lookup"><span data-stu-id="ddc55-154">Remarks</span></span>

<span data-ttu-id="ddc55-155">Вы можете экспортировать данные запросов на выборку Access в электронные таблицы.</span><span class="sxs-lookup"><span data-stu-id="ddc55-155">You can export the data in Access select queries to spreadsheets.</span></span> <span data-ttu-id="ddc55-156">Access экспортирует результирующий набор запроса так же, как таблицу.</span><span class="sxs-lookup"><span data-stu-id="ddc55-156">Access exports the result set of the query, treating it just like a table.</span></span>

<span data-ttu-id="ddc55-157">Данные электронной таблицы, которые добавляются в существующую таблицу Access, должны соответствовать ее структуре.</span><span class="sxs-lookup"><span data-stu-id="ddc55-157">Spreadsheet data that you append to an existing Access table must be compatible with the table's structure.</span></span>

- <span data-ttu-id="ddc55-158">Каждое поле в электронной таблице должно иметь тот же тип данных, что и соответствующее поле в таблице Access.</span><span class="sxs-lookup"><span data-stu-id="ddc55-158">Each field in the spreadsheet must be of the same data type as the corresponding field in the table.</span></span>

- <span data-ttu-id="ddc55-159">Поля должны следовать в том же порядке (за исключением случая, когда для аргумента **С именами полей** установлено значение **Да**: в этом случае названия полей в электронной таблице должны совпадать с именами полей в таблице Access).</span><span class="sxs-lookup"><span data-stu-id="ddc55-159">The fields must be in the same order (unless you set the **Has Field Names** argument to **Yes**, in which case the field names in the spreadsheet must match the field names in the table).</span></span>

<span data-ttu-id="ddc55-160">Вызов данной макрокоманды аналогичен выбору **Excel** в группе **Импорт** или **Экспорт** на вкладке **Внешние данные**, а также выбору **Дополнительно** в группе **Импорт** или **Экспорт** с последующим щелчком варианта **Файл Lotus 1-2-3**.</span><span class="sxs-lookup"><span data-stu-id="ddc55-160">This action is similar to clicking the **External Data** tab and clicking **Excel** in the **Import** or **Export** group, or clicking **More** in the **Import** or **Export** group and clicking **Lotus 1-2-3 File**.</span></span> <span data-ttu-id="ddc55-161">Вы можете использовать эти команды, чтобы выбрать источник данных, например базу данных Access или другого типа, электронную таблицу или текстовый файл.</span><span class="sxs-lookup"><span data-stu-id="ddc55-161">You can use these commands to select a source of data, such as Access or a type of database, spreadsheet, or text file.</span></span> <span data-ttu-id="ddc55-162">Если выбрана электронная таблица, на экране последовательно появляются диалоговые окна или запускается мастер Access, в котором можно указать имя электронной таблицы и другие параметры.</span><span class="sxs-lookup"><span data-stu-id="ddc55-162">If you select a spreadsheet, a series of dialog boxes appear, or an Access wizard runs, in which you select the name of the spreadsheet and other options.</span></span> <span data-ttu-id="ddc55-163">Аргументы макрокоманды **ИмпортЭкспортЭлектроннойТаблицы** отражают параметры, заданные в этих диалоговых окнах или мастерах.</span><span class="sxs-lookup"><span data-stu-id="ddc55-163">The arguments of the **ImportExportSpreadsheet** action reflect the options in these dialog boxes or in the wizards.</span></span>

> [!NOTE]
> <span data-ttu-id="ddc55-164">В запросах и фильтрах для связанной электронной таблицы учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="ddc55-164">If you query or filter a linked spreadsheet, the query or filter is case-sensitive.</span></span>

<span data-ttu-id="ddc55-165">При связывании с электронной таблицей Excel, открытой в режиме редактирования, Access будет ждать окончания работы электронной таблицы Excel в этом режиме, чтобы завершить связывание; при этом нет ограничений по времени.</span><span class="sxs-lookup"><span data-stu-id="ddc55-165">If you link to an Excel spreadsheet that is open in Edit mode, Access will wait until the Excel spreadsheet is out of Edit mode before completing the link; there's no time-out.</span></span>

<span data-ttu-id="ddc55-166">Чтобы выполнить макрокоманду **ИмпортЭкспортЭлектроннойТаблицы** в модуле Visual Basic для приложений (VBA), используйте метод **TransferSpreadsheet** объекта **DoCmd**.</span><span class="sxs-lookup"><span data-stu-id="ddc55-166">To run the **ImportExportSpreadsheet** action in a Visual Basic for Applications (VBA) module, use the **TransferSpreadsheet** method of the **DoCmd** object.</span></span>


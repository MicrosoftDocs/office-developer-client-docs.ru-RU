---
title: Раздел "Данные" (справочник по базам данных Access для настольных ПК)
TOCTitle: Data section
ms:assetid: fd8d31aa-af13-a52f-5e91-20225b8df175
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250303(v=office.15)
ms:contentKeyID: 48548920
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 1b8e3baf4d147edcc739e59933da4697c08cdef0
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295046"
---
# <a name="data-section"></a>Раздел данных

**Область применения**: Access 2013, Office 2013

В разделе данных определяются данные наборов строк, а также ожидающих обновлений, вставки или удаления. Раздел данных может содержать ноль или больше строк. Он может содержать данные только из одного ряда строк, в котором строка определена схемой. Кроме того, как было отмечено ранее, столбцы без данных могут быть пропущены. Если атрибут или подэлемент используется в разделе данных и эта конструкция не определена в разделе схемы, она игнорируется автоматически.

## <a name="string"></a>String

Зарезервированные символы XML в текстовых данных должны быть заменены соответствующими сущностями символов. Например, в названии компании "Joe's Garage" один символ кавычка должен быть заменен сущностью. Фактическая строка будет выглядеть так:

```xml  
<z:row CompanyName="Joe&apos;s Garage"/> 
```

Следующие символы зарезервированы в XML и должны быть заменены сущностями символов: {',",&, \< \> }.

## <a name="binary"></a>Binary

Двоичные данные закодированы в двоичном коде bin.hex (то есть один byte соподержется с двумя символами, по одному символу на каждый прихожий).

## <a name="datetime"></a>DateTime

Формат VT DATE варианта не поддерживается \_ напрямую XML-Data типами данных. Правильный формат дат с компонентом данных и времени — yyyy-mm-dd **T** чч:мм:сс.

Дополнительные сведения о форматах дат, указанных в XML, см. в заметке [W3C XMLData.](https://www.w3.org/TR/1998/NOTE-XML-data-0105/)

Если спецификация XML-Data определяет два эквивалентных типа данных (например, i4 == int), ADO запишет удобное имя, но прочитает оба.

## <a name="managing-pending-changes"></a>Управление ожидающие изменения

Набор **записей можно** открыть в режиме немедленного или пакетного обновления. При отложенном режиме пакетного обновления с помощью клиентских курсоров все изменения, внесенные в **набор записей,** находятся в состоянии ожидания до тех пор, пока не будет вызван метод **UpdateBatch.** Ожидающих изменений также сохраняются при **сохраняемом наборе** записей. В XML они представлены использованием элементов "update", определенных в urn:schemas-microsoft-com:rowset. Кроме того, если можно обновить набор строк, для обновляемого свойства должно быть установлено true в определении строки. Например, чтобы определить, что таблица Shippers содержит ожидающих изменений, определение строки будет выглядеть следующим образом:

```xml 
<s:ElementType name="row" content="eltOnly" updatable="true"> 
  <s:attribute type="ShipperID"/> 
  <s:attribute type="CompanyName"/> 
  <s:attribute type="Phone"/> 
  <s:extends type="rs:rowbase"/> 
</s:ElementType> 
```

Это сообщает поставщику сохраняемости для передачи данных, чтобы ADO можно было создать updatable **объект Recordset.**

В следующих примерах данных показано, как вставки, изменения и удаления выглядят в файле сохраняемом файле:

```xml 
<rs:data> 
  <z:row ShipperID="2" CompanyName="United Package"  
    Phone="(503) 555-3199"/> 
<rs:update> 
  <rs:original> 
    <z:row ShipperID="3" CompanyName="Federal Shipping"  
      Phone="(503) 555-9931"/> 
  </rs:original> 
  <z:row Phone="(503) 552-7134"/> 
</rs:update> 
<rs:insert> 
  <z:row ShipperID="12" CompanyName="Lightning Shipping"  
    Phone="(505) 111-2222"/> 
  <z:row ShipperID="13" CompanyName="Thunder Overnight"  
    Phone="(505) 111-2222"/> 
  <z:row ShipperID="14" CompanyName="Blue Angel Air Delivery"  
    Phone="(505) 111-2222"/> 
</rs:insert> 
<rs:delete> 
  <z:row ShipperID="1" CompanyName="Speedy Express" Phone="(503) 555-9831"/> 
</rs:delete> 
</rs:data> 
```

Обновление всегда содержит все исходные данные строки, за которыми следуют измененные данные строки. Измененная строка может содержать все столбцы или только те столбцы, которые были фактически изменены. В предыдущем примере строка для Shipper 2 не меняется, тогда как только столбец Phone изменил значения для Shipper 3 и поэтому является единственным столбцом, включенным в измененную строку. Вставленные строки для shippers 12, 13 и 14 объединяется в один тег rs:insert. Обратите внимание, что удаленные строки также могут быть вместе, хотя это не показано выше.


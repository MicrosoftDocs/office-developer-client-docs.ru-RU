---
title: Раздел Данные (Ссылка на настольные базы данных)
TOCTitle: Data section
ms:assetid: fd8d31aa-af13-a52f-5e91-20225b8df175
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250303(v=office.15)
ms:contentKeyID: 48548920
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 1b8e3baf4d147edcc739e59933da4697c08cdef0
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295046"
---
# <a name="data-section"></a>Раздел данных

**Область применения**: Access 2013, Office 2013

В разделе данных определяются данные ряда, а также все ожидающих обновлений, вставок или удалений. Раздел данных может содержать ноль или несколько строк. Он может содержать только данные из одной строки, где строка определяется схемой. Кроме того, как отмечалось ранее, столбцы без каких-либо данных могут быть опущены. Если атрибут или подстройка используются в разделе данных и эта конструкция не определена в разделе схемы, она игнорируется безмолвно.

## <a name="string"></a>String

Зарезервированные символы XML в текстовых данных должны быть заменены соответствующими сущностями символов. Например, в названии компании "Гараж Джо" один символ цитаты должен быть заменен объектом. Фактическая строка будет выглядеть так:

```xml  
<z:row CompanyName="Joe&apos;s Garage"/> 
```

Следующие символы зарезервированы в XML и должны быть заменены сущностями символов: {,", \< &, \> }.

## <a name="binary"></a>В двоичном формате

Двоичные данные закодированы bin.hex (то есть один byte maps to two characters, one character per nibble).

## <a name="datetime"></a>DateTime

Формат VT DATE не поддерживается непосредственно \_ XML-Data типами данных. Правильный формат дат с компонентом данных и времени — это yyyy-mm-dd **T** hh:mm:ss.

Дополнительные сведения о форматах дат, указанных XML, см. в заметке [W3C XMLData.](https://www.w3.org/TR/1998/NOTE-XML-data-0105/)

Когда спецификация XML-Data определяет два эквивалентных типа данных (например, i4 == int), ADO выпишет удобное имя, но прочитает в обоих.

## <a name="managing-pending-changes"></a>Управление ожидающих изменений

Набор **записей** можно открыть в режиме немедленного или пакетного обновления. После открытия в режиме пакетного обновления с помощью курсоров на стороне клиента все изменения, внесенные в **Набор** записей, находятся в состоянии ожидания до тех пор, пока не будет вызван метод **UpdateBatch.** При сохраняемом наборе **записей** также сохраняются ожидающих изменений. В XML они представлены использованием элементов обновления, определенных в urn:schemas-microsoft-com:rowset. Кроме того, если строка может быть обновлена, в определении строки необходимо установить верное свойство updatable. Например, чтобы определить, что таблица грузоотправителей содержит ожидающих изменений, определение строки будет выглядеть следующим образом:

```xml 
<s:ElementType name="row" content="eltOnly" updatable="true"> 
  <s:attribute type="ShipperID"/> 
  <s:attribute type="CompanyName"/> 
  <s:attribute type="Phone"/> 
  <s:extends type="rs:rowbase"/> 
</s:ElementType> 
```

Это указывает поставщику сохраняемости на поверхности данных, чтобы ADO можно было создать updatable **объект Recordset.**

В следующих примерах показано, как выглядят вставки, изменения и удаления в сохраняемом файле:

```xml 
<rs:data> 
  <z:row ShipperID="2" CompanyName="United Package"  
    Phone="(503) 555-3199"/> 
<rs:update> 
  <rs:original> 
    <z:row ShipperID="3" CompanyName="Federal Shipping"  
      Phone="(503) 555-9931"/> 
  </rs:original> 
  <z:row Phone="(503) 552-7134"/> 
</rs:update> 
<rs:insert> 
  <z:row ShipperID="12" CompanyName="Lightning Shipping"  
    Phone="(505) 111-2222"/> 
  <z:row ShipperID="13" CompanyName="Thunder Overnight"  
    Phone="(505) 111-2222"/> 
  <z:row ShipperID="14" CompanyName="Blue Angel Air Delivery"  
    Phone="(505) 111-2222"/> 
</rs:insert> 
<rs:delete> 
  <z:row ShipperID="1" CompanyName="Speedy Express" Phone="(503) 555-9831"/> 
</rs:delete> 
</rs:data> 
```

Обновление всегда содержит все исходные данные строки, за которыми следуют измененные данные строки. Измененная строка может содержать все столбцы или только те столбцы, которые действительно изменились. В предыдущем примере строка для shipper 2 не меняется, а только столбец Телефон изменил значения для shipper 3 и поэтому является единственным столбцом, включенным в измененную строку. Вставленные строки для грузоотправителей 12, 13 и 14 пакетных пакетов в одном теге rs:insert. Обратите внимание, что удаленные строки также могут быть пакетными, хотя это не показано выше.


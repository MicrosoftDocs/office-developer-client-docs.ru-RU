---
title: Раздел Data (Справочник по базам данных Access на компьютере)
TOCTitle: Data section
ms:assetid: fd8d31aa-af13-a52f-5e91-20225b8df175
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250303(v=office.15)
ms:contentKeyID: 48548920
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 1b8e3baf4d147edcc739e59933da4697c08cdef0
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295046"
---
# <a name="data-section"></a>Раздел данных

**Область применения**: Access 2013, Office 2013

Раздел Data определяет данные набора строк вместе с ожидающими обновлениями, вставками или удалением. Раздел Data может содержать ноль или более строк. Он может содержать только данные из одного набора, где строка определяется схемой. Кроме того, как отмечалось ранее, столбцы без данных могут быть опущены. Если в разделе данных используется атрибут или подэлемент, и эта конструкция не определена в разделе схемы, она игнорируется без уведомления.

## <a name="string"></a>String

Зарезервированные XML-символы в текстовых данных должны быть заменены соответствующими сущностями знаков. Например, в названии компании Джо "Джо", символ одинарной кавычки должен быть заменен на сущность. Фактическая строка будет выглядеть следующим образом:

```xml  
<z:row CompanyName="Joe&apos;s Garage"/> 
```

Следующие символы зарезервированы в XML и должны быть заменены сущностями символов: {",", &\<,\>}.

## <a name="binary"></a>Binary

Двоичные данные имеют кодировку bin. hex (то есть один байт сопоставляется с двумя символами, по одному символу на каждую штуку).

## <a name="datetime"></a>DateTime

Формат Variant VT\_не поддерживается ТИПАМИ данных XML-данных. Правильный формат для дат с компонентом данных и временем — гггг-мм-дд**T**чч: мм: СС.

Для получения дополнительных сведений о форматах дат, заданных в формате XML, ознакомьтесь со статьей [W3C XMLDATA Note](https://www.w3.org/TR/1998/NOTE-XML-data-0105/).

Когда спецификация XML-Data определяет два эквивалентных типа данных (например, I4 = = int), ADO записывает понятное имя, но прочитает их в обоих случаях.

## <a name="managing-pending-changes"></a>Управление ожидающими изменениями

Объект **Recordset** можно открыть в режиме немедленных или пакетных обновлений. При открытии в режиме пакетного обновления с клиентскими курсорами все изменения, внесенные в **набор записей** , находятся в состоянии ожидания, пока не будет вызван метод **UpdateBatch** . Ожидающие изменения также сохраняются при сохранении объекта **Recordset** . В XML они представлены с помощью элементов "Update", определенных в urn: schemas-microsoft-com: Rowset. Кроме того, если набор строк можно обновить, свойство с возможностью обновления должно иметь значение true в определении строки. Например, чтобы определить, что таблица грузоотправителей содержит ожидающие изменения, определение строки будет выглядеть следующим образом:

```xml 
<s:ElementType name="row" content="eltOnly" updatable="true"> 
  <s:attribute type="ShipperID"/> 
  <s:attribute type="CompanyName"/> 
  <s:attribute type="Phone"/> 
  <s:extends type="rs:rowbase"/> 
</s:ElementType> 
```

При этом поставщик сохраняемости покажет данные, чтобы ADO мог создать обновляемый объект **Recordset** .

В следующих примерах данных показано, как при вставке, изменении и удалении отображаются в материализованном файле:

```xml 
<rs:data> 
  <z:row ShipperID="2" CompanyName="United Package"  
    Phone="(503) 555-3199"/> 
<rs:update> 
  <rs:original> 
    <z:row ShipperID="3" CompanyName="Federal Shipping"  
      Phone="(503) 555-9931"/> 
  </rs:original> 
  <z:row Phone="(503) 552-7134"/> 
</rs:update> 
<rs:insert> 
  <z:row ShipperID="12" CompanyName="Lightning Shipping"  
    Phone="(505) 111-2222"/> 
  <z:row ShipperID="13" CompanyName="Thunder Overnight"  
    Phone="(505) 111-2222"/> 
  <z:row ShipperID="14" CompanyName="Blue Angel Air Delivery"  
    Phone="(505) 111-2222"/> 
</rs:insert> 
<rs:delete> 
  <z:row ShipperID="1" CompanyName="Speedy Express" Phone="(503) 555-9831"/> 
</rs:delete> 
</rs:data> 
```

Обновление всегда содержит данные исходной строки целиком, за которыми следуют измененные данные строки. В измененной строке могут содержаться все столбцы или только те столбцы, которые действительно изменились. В предыдущем примере строка для грузоотправителя 2 не изменяется, а только столбец Phone имеет измененные значения для грузоотправителя 3, и поэтому в измененной строке включен единственный столбец. Вставленные строки для грузоотправителей 12, 13 и 14 объединяются в один RS: INSERT Tag. Обратите внимание, что удаленные строки также могут быть объединены в пакет, хотя это не показано выше.


---
title: Подсчет строк (Справочник по для настольных баз данных Access)
TOCTitle: Counting rows
ms:assetid: ff684c5e-7f41-0dae-beea-f5c71f79bd84
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250312(v=office.15)
ms:contentKeyID: 48548963
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2388978185ac29149f7f15150ccfdbc559cc910f
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28701104"
---
# <a name="counting-rows"></a>Подсчет строк


**Применимо к**: Access 2013, Office 2013

Свойство **RecordCount** возвращает значение типа **Long** , показывает, сколько записей в **набор записей**. Используйте свойство **RecordCount** , чтобы узнать, сколько записей, в объекте **набора записей** . Это свойство возвращает значение -1 при ADO не может определить число записей, или если поставщик или тип курсора не поддерживает **RecordCount**. Чтение свойства **RecordCount** на закрытой **набора записей** приводит к ошибке.

Свойство **RecordCount** зависит от возможностей поставщика и тип курсора. Свойство **RecordCount** возвращает значение -1 для последовательный курсор, фактическое количество для статического или курсор набора ключей, а также значение -1 или фактический количество для динамического курсора, в зависимости от источника данных.

Пример **набора записей** , введенные в [Анализ данных](chapter-3-examining-data.md) возвратит – 1, так как последовательный курсор был открыт. Чтобы использовать свойство **RecordCount** , необходимо открыть **набора записей** с помощью более сложных текущей позиции (static или набора ключей).

В некоторых случаях поставщик или текущей позиции смогут для предоставления значения **RecordCount** без получения все записи из источника данных. Чтобы принудительно этот тип выборки, вызовите метод **MoveLast** **записей** до вызова метода **RecordCount**.

При необходимости замените строку кода, вызывающего метод **Open** **записей** со следующими:

```vb 
 
oRs.Open sSQL, sCnStr, adOpenStatic, adLockOptimistic, adCmdText 
```

Используйте свойство **RecordCount** , так как статические курсоры с [Поставщик Microsoft OLE DB для SQL Server](microsoft-ole-db-provider-for-sql-server.md) поддерживает **RecordCount**смогут. Например следующий код будет распечатать число записей, возвращаемых с помощью команды в окно отладки, если предположить, что курсор поддерживает свойство **RecordCount** :

```vb 
 
Debug.Print oRs.RecordCount ' Output: 4 
```

С этого момента предполагается, что эти более производительные (но более дорогое) курсор и блокировки типа используются параметры.


---
title: Подсчет строк (ссылка на настольные базы данных)
TOCTitle: Counting rows
ms:assetid: ff684c5e-7f41-0dae-beea-f5c71f79bd84
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250312(v=office.15)
ms:contentKeyID: 48548963
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2388978185ac29149f7f15150ccfdbc559cc910f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295417"
---
# <a name="counting-rows"></a>Подсчет строк


**Область применения**: Access 2013, Office 2013

Свойство **RecordCount** возвращает **длинное** значение, которое указывает количество записей в **Наборе записей.** Чтобы узнать, сколько записей находится в объекте **Recordset,** используйте свойство **RecordCount.** Свойство возвращает -1, когда ADO не может определить количество записей или если поставщик или тип курсора не поддерживает **RecordCount.** Чтение свойства **RecordCount** в закрытом **наборе записей** вызывает ошибку.

Свойство **RecordCount** зависит от возможностей поставщика и типа курсора. Свойство **RecordCount** возвращает -1 для курсора только вперед, фактическое количество для статического или курсора наборов ключей, а также значение -1 или фактическое число динамического курсора в зависимости от источника данных.

Пример **Recordset,** введенный в [Examining Data,](chapter-3-examining-data.md) возвращается в режиме "1", так как открыт курсор только для форвардной передачи. Чтобы использовать свойство **RecordCount,** необходимо открыть **Набор** записей с помощью более сложного курсора (статический или набор ключей).

В некоторых случаях поставщик или курсор может не предоставить значение **RecordCount** без первого получения всех записей из источника данных. Чтобы заставить этот тип получения, перед вызовом **RecordCount** вызываем метод **Recordset** **MoveLast.**

Если вы замените строку кода, которая вызывает метод **Recordset** **Open,** следующим образом:

```vb 
 
oRs.Open sSQL, sCnStr, adOpenStatic, adLockOptimistic, adCmdText 
```

вы сможете использовать свойство **RecordCount,** так как статические курсоры с поставщиком [DB Microsoft OLE](microsoft-ole-db-provider-for-sql-server.md) для SQL Server **recordCount**. Например, в следующем коде будет распечатываться число записей, возвращаемых командой в окно отлажений, если курсор поддерживает свойство **RecordCount:**

```vb 
 
Debug.Print oRs.RecordCount ' Output: 4 
```

С этого момента предположим, что используются эти более способные (но более дорогие) параметры типа курсора и блокировки.


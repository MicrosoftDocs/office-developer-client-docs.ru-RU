---
title: Подсчет строк (Справочник по базам данных Access на компьютере)
TOCTitle: Counting rows
ms:assetid: ff684c5e-7f41-0dae-beea-f5c71f79bd84
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250312(v=office.15)
ms:contentKeyID: 48548963
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2388978185ac29149f7f15150ccfdbc559cc910f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295417"
---
# <a name="counting-rows"></a>Подсчет строк


**Область применения**: Access 2013, Office 2013

Свойство **RecordCount** возвращает значение **типа Long** , которое указывает количество записей в **наборе записей**. Используйте свойство **RecordCount** , чтобы узнать, сколько записей находится в объекте **Recordset** . Свойство возвращает значение (1), если ADO не удается определить число записей или тип поставщика или курсора не поддерживает **RecordCount**. При чтении свойства **RecordCount** в закрытом **наборе записей** возникает ошибка.

Свойство **RecordCount** зависит от возможностей поставщика и типа курсора. Свойство **RecordCount** возвращает значение "– 1" для однонаправленного курсора, фактического числа для статического курсора или курсора набора ключей, а также значение по оси 1 или фактическое количество для динамического курсора в зависимости от источника данных.

Пример **набора записей** , представленный в разделе [исследование данных](chapter-3-examining-data.md) , возвратит – 1, так как был открыт однонаправленный курсор. Чтобы использовать свойство **RecordCount** , вам потребуется открыть объект **Recordset** с более сложным курсором (static или KEYSET).

В некоторых случаях поставщик или курсор могут не предоставлять значение **RecordCount** , не выполняя предварительную загрузку всех записей из источника данных. Чтобы принудительно выполнить этот тип, вызовите метод **MoveLast** для объекта **Recordset** перед вызовом **RecordCount**.

Если необходимо заменить строку кода, вызывающую метод **Open** **Recordset** , следующим образом:

```vb 
 
oRs.Open sSQL, sCnStr, adOpenStatic, adLockOptimistic, adCmdText 
```

Вы сможете использовать свойство **RecordCount** , так как статические курсоры с [поставщиком Microsoft OLE DB для SQL Server](microsoft-ole-db-provider-for-sql-server.md) поддерживают **RecordCount**. Например, следующий код распечатает количество записей, возвращаемых командой, в окно Отладка, предполагая, что курсор поддерживает свойство **RecordCount** :

```vb 
 
Debug.Print oRs.RecordCount ' Output: 4 
```

На этом шаге предполагается, что используются следующие параметры (но более дорогие) курсор и тип блокировки.


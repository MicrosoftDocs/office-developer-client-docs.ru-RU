---
title: The Fields Collection
TOCTitle: The Fields Collection
ms:assetid: 3bda8e5d-eceb-9605-c4d7-c1f4cc00ce6b
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249154(v=office.15)
ms:contentKeyID: 48544297
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: ce08ac5952151471ce74afd9a8a49600d8e8f633
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28705584"
---
# <a name="fields-collection"></a>Коллекция Fields


**Применимо к**: Access 2013, Office 2013

Коллекции **полей** — это один из встроенных ADO семейств сайтов. Коллекция — это упорядоченный набор элементов, которые может называться блоком.

Коллекция **полей** содержит объект **поля** для каждого поля (столбца) в **набор записей**. Как все коллекции ADO имеет свойства **Count** и **элементов** , а также методы **добавления** и **обновления** . Он также имеет **CancelUpdate**, **удаления**, **выполнить повторную синхронизацию**и методов **обновления** , не являющихся другим семействам ADO.

## <a name="examining-the-fields-collection"></a>Проверка коллекции полей

Рассмотрите возможность коллекции **полей** , **записей** , представленные в этой главе примера. Пример **набора записей** является производным от инструкции SQL

```sql 
 
SELECT ProductID, ProductName, UnitPrice FROM Products WHERE CategoryID = 7 
```

Таким образом можно найти, что семейство **набора записей** **поля** содержит три поля.

```vb 
 
'BeginWalkFields 
 Dim objFields As ADODB.Fields 
 
 objRs.Open strSQL, strConnStr, adOpenForwardOnly, adLockReadOnly, adCmdText 
 
 Set objFields = objRs.Fields 
 
 For intLoop = 0 To (objFields.Count - 1) 
 Debug.Print objFields.Item(intLoop).Name 
 Next 
'EndWalkFields 
```

Этот код определяет число объектов **поля** в коллекцию **полей** , с помощью свойства **Count** и выполняется цикл по коллекции, возврат значения свойства **Name** для каждого объекта **поля** . Многие другие свойства **поля** можно использовать для получения сведений о поле. Дополнительные сведения о запросе на **поле** [Объекта поля](the-field-object.md)см.

## <a name="counting-columns"></a>Подсчет столбцов

Как можно было бы ожидать, свойство **Count** возвращает число объектов **поля** в коллекции **полей** . Поскольку нумерация для элементов коллекции начинается с нуля, всегда должны кода циклов, начиная с нуля элемента и заканчивая значение свойства **Count** минус 1. Если используется Microsoft Visual Basic и хотите выполняют цикл по элементам коллекции без проверки свойство **Count** , используйте **для** **каждого... Далее** команды.

Если свойство **Count** равно нулю, нет объектов в коллекции.

## <a name="getting-to-the-field"></a>Приступая к полю

Как с любой коллекции ADO свойство **Item** является свойством по умолчанию коллекции. Возвращает отдельный объект **поля** , указанного по имени или индекса, переданным в него. Таким образом следующие инструкции для образца **набора записей**эквивалентны:

```vb 
 
objField = objRecordset.Fields.Item("ProductID") 
objField = objRecordset.Fields("ProductID") 
objField = objRecordset.Fields.Item(0) 
objField = objRecordset.Fields(0) 
```

Если эти методы эквивалентны, который лучше всего подходит? Смотря как. Использования индекса, чтобы извлечь **поля** из коллекции, работает быстрее, так как он получает доступ к **поля** напрямую, без необходимости выполнять поиск строки. С другой стороны порядок **полей** в коллекции должно быть известно, и при изменении порядка ссылку на индекс **поля** придется изменить везде, где оно становится. Хотя несколько медленнее, более гибкий с помощью имени **поля** , так как он не зависит от порядка **полей** в коллекции.

## <a name="using-the-refresh-method"></a>С помощью метода обновления

В отличие от некоторые другие коллекции ADO с помощью метода **обновления** на коллекции **полей** не действует видимым. Чтобы извлечь изменения из базовой структуры базы данных, необходимо использовать либо метод **повторный запрос** , или если объект **набора записей** не поддерживает закладки, метод **MoveFirst** , который будет отображено команду для выполнения Поставщик еще раз.

## <a name="adding-fields-to-a-recordset"></a>Добавление полей в наборе записей

Метод **Append** используется для добавления поля **набора записей**.

Метод **Append** используется для программного создания **записей** без открытия подключения к источнику данных. При вызове метода **Append** на коллекцию **полей** open **записей** или **набора записей** , где было установлено свойство **ActiveConnection** произойдет ошибка во время выполнения. После добавления поля только для **записей** , не открыт и еще не был подключен к источнику данных. Тем не менее чтобы указать значения для добавленного **полей**, **записей** необходимо открыть.

Разработчики часто требуется место для временного хранения некоторые данные или некоторые данные действовать как если бы он поступил от сервера, он может принимать участие в привязке данных в пользовательском интерфейсе. ADO (в сочетании с помощью [Службы Microsoft курсора для OLE DB](microsoft-cursor-service-for-ole-db-ado-service-component.md)) позволяет разработчикам создавать **пустой Recordset** , указав сведения о столбце и вызова метода **Open**. В следующем примере трех новых полей присоединяются к новый объект **набора записей** . Затем открывается **набор записей** , добавлены два новых записей и **записей** сохраняется в файл. (Дополнительные сведения о сохранения **записей** можно [Глава 5: обновления и сохранение данных](chapter-5-updating-and-persisting-data.md).)

```vb 
 
 'BeginFabricate 
 Dim objRs As New ADODB.Recordset 
 
 With objRs.Fields 
 .Append "StudentID", adChar, 11, adFldUpdatable 
 .Append "FullName", adVarChar, 50, adFldUpdatable 
 .Append "PhoneNmbr", adVarChar, 20, adFldUpdatable 
 End With 
 
 With objRs 
 .Open 
 
 .AddNew 
 .Fields(0) = "123-45-6789" 
 .Fields(1) = "John Doe" 
 .Fields(2) = "(425) 555-5555" 
 .Update 
 
 .AddNew 
 .Fields(0) = "123-45-6780" 
 .Fields(1) = "Jane Doe" 
 .Fields(2) = "(615) 555-1212" 
 .Update 
 End With 
 
 objRs.Save App.Path & "\FabriTest.adtg", adPersistADTG 
 
 objRs.Close 
 'EndFabricate 
```

Использование метода **Append** **поля** отличается от объекта **набора записей** и объект **записи** . Дополнительные сведения об объекте **записи** можно [Глава 10: записей и потоков](chapter-10-records-and-streams.md).


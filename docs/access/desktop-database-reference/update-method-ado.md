---
title: Метод Update (ADO)
TOCTitle: Update method (ADO)
ms:assetid: fc88cab6-c379-bb4f-530c-da08107924e0
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250294(v=office.15)
ms:contentKeyID: 48548893
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f077634abea6fadfe5c4305fc25b28e6d57bf13e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32306239"
---
# <a name="update-method-ado"></a>Метод Update (ADO)

**Область применения**: Access 2013, Office 2013

Сохраняет все изменения, внесенные в текущую строку объекта [Recordset](recordset-object-ado.md) , или коллекцию [Fields](fields-collection-ado.md) объекта [Record](record-object-ado.md) .

## <a name="syntax"></a>Синтаксис

*набор записей*. Обновление*полей*, *значений*

*запись*. *Поля*. Исправления

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Fields* |Необязательное. **Variant** , представляющий одно имя, или массив **Variant** , представляющий имена или порядковые номера поля или полей, которые требуется изменить.|
|*Значения* |Необязательное. **Variant** , представляющий одно значение, или массив **Variant** , представляющий значения для поля или полей в новой записи.|

## <a name="remarks"></a>Примечания

### <a name="recordset"></a>Recordset

Используйте метод **Update** , чтобы сохранить изменения, внесенные в текущую запись объекта **Recordset** , с момента вызова метода [AddNew](addnew-method-ado.md) или с помощью изменения любых значений полей в существующей записи. Объект **Recordset** должен поддерживать обновления.

Чтобы задать значения полей, выполните одно из следующих действий:

- Присвойте значения свойству [value](value-property-ado.md) объекта [field](field-object-ado.md) и вызовите метод **Update** .

- Передайте имя поля и значение в качестве аргументов с вызовом **обновления** .

- Передайте массив имен полей и массив значений с помощью вызова **Update** .

При использовании массивов полей и значений должно быть одинаковое число элементов в обоих массивах. Кроме того, порядок имен полей должен отличаться от порядка значений полей. Если число и порядок полей и значений не совпадают, возникает ошибка.

Если объект **Recordset** поддерживает пакетное обновление, можно кэшировать несколько изменений в одну или несколько записей локально, пока не будет вызван метод [UpdateBatch](updatebatch-method-ado.md) . Если вы редактируете текущую запись или добавляете новую запись при вызове метода **UpdateBatch** , ADO автоматически вызывает метод **Update** для сохранения всех ожидающих изменений в текущей записи, прежде чем передавать пакетные изменения поставщику.

Если вы перейдете из записи, которую вы добавляете или редактируете перед вызовом метода **Update** , ADO автоматически выполнит вызов **Update** , чтобы сохранить изменения. Если вы хотите отменить все изменения, внесенные в текущую запись или удалить новую запись, необходимо вызвать метод [CancelUpdate](cancelupdate-method-ado.md) .

Текущая запись остается текущей, когда вы вызываете метод **Update** .

### <a name="record"></a>Record

Метод **Update** завершает Добавление, удаление и обновление полей в коллекции [Fields](fields-collection-ado.md) объекта **Record** .

Например, поля, удаленные с помощью метода **Delete** , помечаются для удаления немедленно, но оставались в коллекции. Необходимо вызвать метод **Update** , чтобы фактически удалить эти поля из коллекции поставщика.


---
title: Метод обновления (ADO)
TOCTitle: Update method (ADO)
ms:assetid: fc88cab6-c379-bb4f-530c-da08107924e0
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250294(v=office.15)
ms:contentKeyID: 48548893
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: f077634abea6fadfe5c4305fc25b28e6d57bf13e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32306239"
---
# <a name="update-method-ado"></a>Метод обновления (ADO)

**Область применения**: Access 2013, Office 2013

Сохраняет все изменения, внесенные в текущую строку объекта [Recordset](recordset-object-ado.md) или коллекцию [Полей](fields-collection-ado.md) объекта [Record.](record-object-ado.md)

## <a name="syntax"></a>Синтаксис

*набор записей.* Поля *обновления*, *значения*

*запись*. *Поля*. Обновление

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Fields* |Необязательный параметр. **Вариант,** который представляет одно имя, или массив **Variant,** который представляет имена или расположение полей или полей, которые вы хотите изменить.|
|*Values* |Необязательный параметр. **Вариант,** который представляет единое значение, или массив **Variant,** который представляет значения для поля или полей в новой записи.|

## <a name="remarks"></a>Примечания

### <a name="recordset"></a>Recordset

Используйте метод **Update,** чтобы сохранить все изменения, внесенные в текущую запись объекта **Recordset** после вызова метода [AddNew](addnew-method-ado.md) или после изменения каких-либо значений поля в существующей записи. Объект **Recordset** должен поддерживать обновления.

Чтобы установить значения поля, сделайте одно из следующих:

- Назначение значений свойству [Значение](field-object-ado.md) объекта [Field](value-property-ado.md) и вызов метода **Update.**

- Передай имя поля и значение в качестве аргументов с вызовом **Update.**

- Передай массив имен полей и массив значений с помощью вызова **Update.**

При использовании массивов полей и значений в обоих массивах должно быть одинаковое количество элементов. Кроме того, порядок имен полей должен соответствовать порядку значений поля. Если число и порядок полей и значений не совпадают, возникает ошибка.

Если объект **Recordset поддерживает** пакетное обновление, можно кэшировать несколько изменений в одну или несколько записей локально до вызова метода [UpdateBatch.](updatebatch-method-ado.md) При редактировании текущей записи или добавлении новой записи при вызове метода **UpdateBatch** ADO будет автоматически вызывать метод Update, чтобы сохранить все ожидающие изменения текущей записи перед передачей пакетных изменений поставщику. 

При переходе из записи, добавляемой или редактируемой перед вызовом метода **Update,** ADO автоматически вызывает **обновление,** чтобы сохранить изменения. Чтобы отменить изменения, внесенные в текущую запись, или отменить добавленную запись, необходимо вызвать метод [CancelUpdate.](cancelupdate-method-ado.md)

Текущая запись остается текущей после вызова метода **Update.**

### <a name="record"></a>Record

Метод **Update** завершает добавления, удаления и обновления полей в коллекции [Fields](fields-collection-ado.md) объекта **Record.**

Например, поля, удаленные методом **Delete,** сразу же помечены для удаления, но остаются в коллекции. Метод **Update** должен быть вызван для удаления этих полей из коллекции поставщика.


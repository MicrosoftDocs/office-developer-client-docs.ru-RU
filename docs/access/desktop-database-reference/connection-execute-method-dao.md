---
title: Метод Connection. Execute (DAO)
TOCTitle: Execute Method
ms:assetid: d6140d4e-fa14-6455-525e-49d8aab3dff7
ms:mtpsurl: https://msdn.microsoft.com/library/Ff835040(v=office.15)
ms:contentKeyID: 48547978
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 8140dbe9bc0c68d467c011d77bc0c00cec7ad560
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295914"
---
# <a name="connectionexecute-method-dao"></a>Метод Connection. Execute (DAO)

**Область применения**: Access 2013, Office 2013

Выполняет запрос на изменение или выполняет инструкцию SQL для указанного объекта.

## <a name="syntax"></a>Синтаксис

*Expression* . Выполнение (***запрос***, ***Параметры***)

*Expression (выражение* ) Переменная, представляющая объект **Connection** .

## <a name="parameters"></a>Параметры

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя</p></th>
<th><p>Обязательно/необязательно</p></th>
<th><p>Тип данных</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>Query</em></p></td>
<td><p>Обязательный</p></td>
<td><p><strong>String</strong></p></td>
<td><p><strong>Строка</strong> , которая является оператором SQL или значением свойства <strong>имени</strong> объекта <strong>QueryDef</strong> .</p></td>
</tr>
<tr class="even">
<td><p><em>Options</em></p></td>
<td><p>Необязательный</p></td>
<td><p><strong>Variant</strong></p></td>
<td><p>Константа или сочетание констант, определяющих характеристики целостности данных запроса, как указано в параметрах.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

Для параметров можно использовать следующие константы **[RecordsetOptionEnum](recordsetoptionenum-enumeration-dao.md)** .

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Константа</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>dbDenyWrite</strong></p></td>
<td><p>Запрещает разрешение на запись для других пользователей (только для рабочих областей Microsoft Access).</p></td>
</tr>
<tr class="even">
<td><p><strong>dbInconsistent</strong></p></td>
<td><p>Умолчани Выполняет несогласованные обновления (только для рабочих областей Microsoft Access).</p></td>
</tr>
<tr class="odd">
<td><p><strong>dbConsistent</strong></p></td>
<td><p>Выполняет согласованные обновления (только для рабочих областей Microsoft Access).</p></td>
</tr>
<tr class="even">
<td><p><strong>dbSQLPassThrough</strong></p></td>
<td><p>Выполняет запрос к серверу SQL Server. При установке этого параметра инструкция SQL передается в базу данных ODBC для обработки (только для рабочих областей Microsoft Access).</p></td>
</tr>
<tr class="odd">
<td><p><strong>dbFailOnError</strong></p></td>
<td><p>Откат обновлений при возникновении ошибки (только для рабочих областей Microsoft Access).</p></td>
</tr>
<tr class="even">
<td><p><strong>dbSeeChanges</strong></p></td>
<td><p>Создает ошибку во время выполнения, если другой пользователь изменяет редактируемые данные (только для рабочих областей Microsoft Access).</p></td>
</tr>
<tr class="odd">
<td><p><strong>dbRunAsync</strong></p></td>
<td><p>Асинхронно выполняет запрос (только объекты подключения ODBCDirect и объекты QueryDef).</p></td>
</tr>
<tr class="even">
<td><p><strong>dbExecDirect</strong></p></td>
<td><p>Выполняет оператор без первого вызова функции API ODBC Склпрепаре (только для соединений и объектов QueryDef).</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> Рабочие области ODBCDirect не поддерживаются в Microsoft Access 2013. Используйте ADO, если вы хотите получить доступ к внешним источникам данных без использования ядра СУБД Microsoft Access.

> [!NOTE]
> Константы **дбконсистент** и **дбинконсистент** являются взаимоисключающими. Можно использовать один или другой, но не то и другое в данном экземпляре **OpenRecordset**. Использование как **дбконсистент** , так и **дбинконсистент** приводит к ошибке.

Метод **EXECUTE** действителен только для запросов на изменение. Если вы используете **EXECUTE** с другим типом запроса, возникнет ошибка. Так как запрос на изменение не возвращает какие-либо записи, **выполнение** не возвращает **набор записей**. (При выполнении запроса к серверу SQL в рабочей области ODBCDirect не возвращается сообщение об ошибке, если **набор записей** не возвращается.)

Используйте свойство **рекордсаффектед** объекта **Connection**, **Database**или **QueryDef** , чтобы определить количество записей, затронутых последним методом **EXECUTE** . Например, **рекордсаффектед** содержит число записей, удаленных, обновленных или вставленных при выполнении запроса на изменение. При использовании метода **EXECUTE** для запуска запроса свойство **рекордсаффектед** объекта **QueryDef** устанавливается равным количеству затронутых записей.

В рабочей области Microsoft Access, если вы задаете синтаксическую правильную инструкцию SQL и обладаете соответствующими разрешениями, метод **EXECUTE** не будет выполняться, даже если не удается изменить или удалить одну строку. Поэтому всегда используйте параметр **дбфаилонеррор** при использовании метода **EXECUTE** для выполнения запроса на обновление или удаление. Этот параметр создает ошибку времени выполнения и выполняет откат всех успешных изменений, если какие затронутые записи заблокированы и не могут быть обновлены или удалены.

В более ранних версиях ядра базы данных Microsoft Jet инструкции SQL были автоматически внедрены в неявные транзакции. Если часть оператора, выполняемого с помощью **дбфаилонеррор** , завершилась с ошибкой, будет выполнен откат всего оператора. Для повышения производительности эти неявные транзакции были удалены начиная с версии 3,5. Если вы обновляете старые коды DAO, не забудьте использовать явные транзакции для операторов **EXECUTE** .

Для лучшей производительности в рабочей области Microsoft Access, особенно в многопользовательской среде, вложите метод **EXECUTE** в транзакцию. Используйте метод **BeginTrans** для текущего объекта **Workspace** , затем используйте метод **EXECUTE** и завершите транзакцию с помощью метода **CommitTrans** в **рабочей области**. Это сохраняет изменения на диске и освобождает все блокировки, включенные во время выполнения запроса.


---
title: Указание числа потоков на процессор в IIS
TOCTitle: Specifying threads per processor on IIS
ms:assetid: 12889d7b-5415-8077-2ca0-1c3a96fb89ec
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248898(v=office.15)
ms:contentKeyID: 48543344
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 57e4b6228588af7f0d58caf53d3e093e824c7854
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308591"
---
# <a name="specifying-threads-per-processor-on-iis"></a>Указание числа потоков на процессор в IIS


**Область применения**: Access 2013, Office 2013

При использовании RDS со службами Internet Information Services 4.0 или более поздней, количество потоков, созданных для каждого процессора, можно контролировать с помощью реестра на веб-сервере. Число потоков на процессор может влиять на производительность в условиях высокого трафика или при низком трафике с большими размерами запросов. Для наилучших результатов пользователю следует поэкспериментировать.

Метод, используемый для определения и изменения значения по умолчанию для этого параметра, зависит от конфигурации сервера IIS 4.0.

При установке MDAC 2.1.2.4202.3 или более поздней установки на сервер IIS RDS использует те же службы компонентов (или службы транзакций Майкрософт, если вы используете пул потоков Windows NT), что и сценарии ASP. Значение по умолчанию для числа потоков на процессор — 10. Чтобы изменить значение по умолчанию, необходимо добавить следующий ключ в реестр серверов:

```vb 
 
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\InetInfo\Parameters\MaxPoolThreads
```

где *MaxPoolThreads* — это REG \_ DWORD. *MaxPoolThreads* не появляется в реестре, если он специально не добавлен. Допустимые значения: от 5 до рекомендуемого максимума 20. Если значение, указанное в ключе реестра, больше значения ключа *PoolThreadLimit* (расположено по тому же пути), используется значение *PoolThreadLimit.*

Кроме того, если MDAC 2.1 2.1.1.3711.11 или более ранней установки установлен на сервер IIS, значение по умолчанию для числа потоков на процессор составляет 6. Чтобы изменить значение по умолчанию, необходимо добавить следующий ключ в реестр на сервере IIS:

```vb 
 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\ADCThreads
```

где *ADCThreads* — это REG \_ DWORD. *ADCThreads* не появляется в реестре, если он специально не добавлен. Диапазон допустимого значения — от 1 до 50. Если значение, указанное в ключе реестра, превышает 50, используется максимальное значение (50).


---
title: Указание числа потоков на процессор в IIS
TOCTitle: Specifying threads per processor on IIS
ms:assetid: 12889d7b-5415-8077-2ca0-1c3a96fb89ec
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248898(v=office.15)
ms:contentKeyID: 48543344
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 57e4b6228588af7f0d58caf53d3e093e824c7854
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308591"
---
# <a name="specifying-threads-per-processor-on-iis"></a>Указание числа потоков на процессор в IIS


**Область применения**: Access 2013, Office 2013

При использовании RDS с службы IIS 4.0 или более поздним числом потоков, созданных для каждого процессора, можно управлять, манипулируя реестром на веб-сервере. Количество потоков на процессор может повлиять на производительность в высокой ситуации с трафиком или в ситуациях с низким трафиком с большими размерами запросов. Пользователю следует поэкспериментировать для наилучших результатов.

Метод, используемый для определения и изменения значения по умолчанию для этого параметра, зависит от конфигурации сервера IIS 4.0.

С помощью MDAC 2.1.2.4202.3 (GA) или более поздней установки на сервере IIS, RDS использует те же службы компонентов (или службы транзакций Майкрософт, если вы используете Windows NT) пул потоков, как и скрипты ASP. Значение по умолчанию для количества потоков в процессоре — 10. Чтобы изменить значение по умолчанию, необходимо добавить в реестр серверов следующий ключ:

```vb 
 
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\InetInfo\Parameters\MaxPoolThreads
```

где *MaxPoolThreads* — это \_ DWORD REG. *MaxPoolThreads* не появляется в реестре, если он не добавлен специально. Допустимые значения варьируются от 5 до рекомендуемого максимума 20. Если значение, указанное ключом реестра, превышает значение *ключа PoolThreadLimit* (расположено по тому же пути), то используется *значение PoolThreadLimit.*

Кроме того, если на сервере IIS установленО значение MDAC 2.1 2.1.1.1.3711.11 (GA) или ранее, значение по умолчанию для количества потоков на процессоре составляет 6. Чтобы изменить значение по умолчанию, необходимо добавить в реестр на сервере IIS следующий ключ:

```vb 
 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\ADCThreads
```

где *ADCThreads* — это \_ DWORD REG. *ADCThreads* не отображаются в реестре, если они не будут специально добавлены. Диапазон допустимого значения составляет от 1 до 50. Если значение, указанное ключом реестра, превышает 50, то используется максимальное значение (50).


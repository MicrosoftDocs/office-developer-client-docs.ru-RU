---
title: Метод Open (записей ADO)
TOCTitle: Open Method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: bf40fa501c24af3433dde1bf2b0686fd3854acf2
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "25884291"
---
# <a name="open-method-ado-recordset"></a><span data-ttu-id="f9e98-102">Метод Open (записей ADO)</span><span class="sxs-lookup"><span data-stu-id="f9e98-102">Open Method (ADO Recordset)</span></span>


<span data-ttu-id="f9e98-103">**Применимо к**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="f9e98-103">**Applies to**: Access 2013, Office 2013</span></span>


<span data-ttu-id="f9e98-104">Открывается курсор.</span><span class="sxs-lookup"><span data-stu-id="f9e98-104">Opens a cursor.</span></span>

## <a name="syntax"></a><span data-ttu-id="f9e98-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="f9e98-105">Syntax</span></span>

<span data-ttu-id="f9e98-106">*набор записей*. Откройте*исходный*, *ActiveConnection*, *CursorType*, *LockType для*, *Параметры*</span><span class="sxs-lookup"><span data-stu-id="f9e98-106">*recordset*.Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*</span></span>

## <a name="parameters"></a><span data-ttu-id="f9e98-107">Параметры</span><span class="sxs-lookup"><span data-stu-id="f9e98-107">Parameters</span></span>

  - <span data-ttu-id="f9e98-108">*Source*</span><span class="sxs-lookup"><span data-stu-id="f9e98-108">*Source*</span></span>

  - <span data-ttu-id="f9e98-109">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f9e98-109">Optional.</span></span> <span data-ttu-id="f9e98-110">**Variant** , которое оценивается как допустимый объект [команды](command-object-ado.md) , инструкции SQL, имя таблицы, вызов хранимой процедуры, URL-адрес или имя файла или [потока](stream-object-ado.md) object, содержащий постоянно хранимых [набора записей](recordset-object-ado.md).</span><span class="sxs-lookup"><span data-stu-id="f9e98-110">A **Variant** that evaluates to a valid [Command](command-object-ado.md) object, an SQL statement, a table name, a stored procedure call, a URL, or the name of a file or [Stream](stream-object-ado.md) object containing a persistently stored [Recordset](recordset-object-ado.md).</span></span>

  - <span data-ttu-id="f9e98-111">*ActiveConnection*</span><span class="sxs-lookup"><span data-stu-id="f9e98-111">*ActiveConnection*</span></span>

  - <span data-ttu-id="f9e98-112">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f9e98-112">Optional.</span></span> <span data-ttu-id="f9e98-113">**Variant** , которое оценивается как допустимое имя переменной объекта [подключения](connection-object-ado.md) , либо **строку** , содержащую параметры [ConnectionString](connectionstring-property-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="f9e98-113">Either a **Variant** that evaluates to a valid [Connection](connection-object-ado.md) object variable name, or a **String** that contains [ConnectionString](connectionstring-property-ado.md) parameters.</span></span>

  - <span data-ttu-id="f9e98-114">*CursorType*</span><span class="sxs-lookup"><span data-stu-id="f9e98-114">*CursorType*</span></span>

  - <span data-ttu-id="f9e98-115">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f9e98-115">Optional.</span></span> <span data-ttu-id="f9e98-116">[CursorTypeEnum](cursortypeenum.md) значение, определяющее тип курсора, поставщик должен использовать при открытии **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-116">A [CursorTypeEnum](cursortypeenum.md) value that determines the type of cursor that the provider should use when opening the **Recordset**.</span></span> <span data-ttu-id="f9e98-117">Значение по умолчанию — **adOpenForwardOnly**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-117">The default value is **adOpenForwardOnly**.</span></span>

  - <span data-ttu-id="f9e98-118">*LockType для*</span><span class="sxs-lookup"><span data-stu-id="f9e98-118">*LockType*</span></span>

  - <span data-ttu-id="f9e98-119">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f9e98-119">Optional.</span></span> <span data-ttu-id="f9e98-120">[LockTypeEnum](locktypeenum.md) значение, определяющее тип блокировки (одновременно) поставщика следует использовать при открытии **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-120">A [LockTypeEnum](locktypeenum.md) value that determines what type of locking (concurrency) the provider should use when opening the **Recordset**.</span></span> <span data-ttu-id="f9e98-121">Значение по умолчанию — **adLockReadOnly**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-121">The default value is **adLockReadOnly**.</span></span>

  - <span data-ttu-id="f9e98-122">*Варианты*</span><span class="sxs-lookup"><span data-stu-id="f9e98-122">*Options*</span></span>

  - <span data-ttu-id="f9e98-123">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="f9e98-123">Optional.</span></span> <span data-ttu-id="f9e98-124">**Длинное** значение, которое указывает, как поставщик необходимо решить *исходный* аргумент, если он представляет элемент отличный от объекта **команды** или **набора записей** должен быть восстановлен из файла, в котором он был сохранен ранее.</span><span class="sxs-lookup"><span data-stu-id="f9e98-124">A **Long** value that indicates how the provider should evaluate the *Source* argument if it represents something other than a **Command** object, or that the **Recordset** should be restored from a file where it was previously saved.</span></span> <span data-ttu-id="f9e98-125">Может быть один или несколько [CommandTypeEnum](commandtypeenum.md) или [ExecuteOptionEnum](executeoptionenum.md) значения, которые может использоваться совместно с оператор AND.</span><span class="sxs-lookup"><span data-stu-id="f9e98-125">Can be one or more [CommandTypeEnum](commandtypeenum.md) or [ExecuteOptionEnum](executeoptionenum.md) values, which can be combined with a bitwise AND operator.</span></span>


> [!NOTE]
> <P><span data-ttu-id="f9e98-126">При открытии <STRONG>набора записей</STRONG> из <STRONG>потока</STRONG> , содержащий постоянных <STRONG>набора записей</STRONG>с помощью значение <STRONG>ExecuteOptionEnum</STRONG> <STRONG>adAsyncFetchNonBlocking</STRONG> не будет иметь эффекта. Выборка будет синхронная и блокировки.</span><span class="sxs-lookup"><span data-stu-id="f9e98-126">If you open a <STRONG>Recordset</STRONG> from a <STRONG>Stream</STRONG> containing a persisted <STRONG>Recordset</STRONG>, using an <STRONG>ExecuteOptionEnum</STRONG> value of <STRONG>adAsyncFetchNonBlocking</STRONG> will not have an effect; the fetch will be synchronous and blocking.</span></span></P>



<span data-ttu-id="f9e98-127">Значения **ExecuteOpenEnum** **adExecuteNoRecords** или **adExecuteStream** не должны использоваться с **Open**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-127">The **ExecuteOpenEnum** values of **adExecuteNoRecords** or **adExecuteStream** should not be used with **Open**.</span></span>

## <a name="remarks"></a><span data-ttu-id="f9e98-128">Замечания</span><span class="sxs-lookup"><span data-stu-id="f9e98-128">Remarks</span></span>

<span data-ttu-id="f9e98-129">По умолчанию курсор для набора **записей** ADO является только вперед, только для чтения на сервере.</span><span class="sxs-lookup"><span data-stu-id="f9e98-129">The default cursor for an ADO **Recordset** is a forward-only, read-only cursor located on the server.</span></span>

<span data-ttu-id="f9e98-130">С помощью метода **Open** **целиком** открывается курсор, который представляет записей из базовой таблицы, результаты запроса или ранее сохраненных **записей**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-130">Using the **Open** method on a **Recordset** object opens a cursor that represents records from a base table, the results of a query, or a previously saved **Recordset**.</span></span>

<span data-ttu-id="f9e98-131">Используйте необязательный аргумент *источник* , чтобы указать источник данных, с помощью одного из следующих значений: переменной объекта **команды** , инструкции SQL, хранимую процедуру, имя таблицы, URL-адрес или полный путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="f9e98-131">Use the optional *Source* argument to specify a data source using one of the following: a **Command** object variable, an SQL statement, a stored procedure, a table name, a URL, or a complete file path name.</span></span> <span data-ttu-id="f9e98-132">Если *источник* — это путь к файлу, он может быть полный путь ("c:\\dir\\file.rst»), относительный путь (».. \\file.rst»), или URL-адрес (»https://files/file.rst«).</span><span class="sxs-lookup"><span data-stu-id="f9e98-132">If *Source* is a file path name, it can be a full path ("c:\\dir\\file.rst"), a relative path ("..\\file.rst"), or a URL ("https://files/file.rst").</span></span>

<span data-ttu-id="f9e98-133">Не рекомендуется использовать *исходный* аргумент методу **Open** для выполнения запроса, который не возвращает записей, так как нет возможности легко определить, является ли вызов завершился успешно.</span><span class="sxs-lookup"><span data-stu-id="f9e98-133">It is not a good idea to use the *Source* argument of the **Open** method to perform an action query that doesnt return records because there is no easy way to determine whether the call succeeded.</span></span> <span data-ttu-id="f9e98-134">**Набор записей** , возвращаемых такой запрос будет закрыто.</span><span class="sxs-lookup"><span data-stu-id="f9e98-134">The **Recordset** returned by such a query will be closed.</span></span> <span data-ttu-id="f9e98-135">Вызовите метод [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) объекта **Command** или метода [Execute](https://msdn.microsoft.com/library/jj249832\(v=office.15\)) объекта **подключения** вместо этого для выполнения запроса, например инструкцию SQL INSERT, который не возвращает записей.</span><span class="sxs-lookup"><span data-stu-id="f9e98-135">Call the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method of a **Command** object or the [Execute](https://msdn.microsoft.com/library/jj249832\(v=office.15\)) method of a **Connection** object instead to perform a query that, such as a SQL INSERT statement, that doesnt return records.</span></span>

<span data-ttu-id="f9e98-136">Аргумент *ActiveConnection* соответствует свойству [ActiveConnection](activeconnection-property-ado.md) и указывает соединений для открытия **набора записей** объекта.</span><span class="sxs-lookup"><span data-stu-id="f9e98-136">The *ActiveConnection* argument corresponds to the [ActiveConnection](activeconnection-property-ado.md) property and specifies in which connection to open the **Recordset** object.</span></span> <span data-ttu-id="f9e98-137">Если передать определение подключения для этого аргумента ADO откроется новое подключение с помощью указанных параметров.</span><span class="sxs-lookup"><span data-stu-id="f9e98-137">If you pass a connection definition for this argument, ADO opens a new connection using the specified parameters.</span></span> <span data-ttu-id="f9e98-138">После открытия **набора записей** с курсором со стороны клиента (**CursorLocation** = **adUseClient**), можно изменить значение этого свойства для обновления другого поставщика.</span><span class="sxs-lookup"><span data-stu-id="f9e98-138">After opening the **Recordset** with a client-side cursor (**CursorLocation** = **adUseClient**), you can change the value of this property to send updates to another provider.</span></span> <span data-ttu-id="f9e98-139">Или этому свойству можно присвоено значение **Nothing** (в Microsoft Visual Basic) или значение NULL для отключения **записей** из любого поставщика.</span><span class="sxs-lookup"><span data-stu-id="f9e98-139">Or you can set this property to **Nothing** (in Microsoft Visual Basic) or NULL to disconnect the **Recordset** from any provider.</span></span> <span data-ttu-id="f9e98-140">Изменение **ActiveConnection** для курсора на сервере, приведет к ошибке, однако.</span><span class="sxs-lookup"><span data-stu-id="f9e98-140">Changing **ActiveConnection** for a server-side cursor generates an error, however.</span></span>

<span data-ttu-id="f9e98-141">Для других аргументов, которые соответствуют свойства объекта **набора записей** (*источник*, *CursorType*и *LockType для*) отношения аргументы для свойства выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="f9e98-141">For the other arguments that correspond directly to properties of a **Recordset** object (*Source*, *CursorType*, and *LockType*), the relationship of the arguments to the properties is as follows:</span></span>

  - <span data-ttu-id="f9e98-142">Чтение и запись является ли данное свойство перед открытием объекта **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="f9e98-142">The property is read/write before the **Recordset** object is opened.</span></span>

  - <span data-ttu-id="f9e98-143">Параметры свойства используются при выполнении метода **Open** передается соответствующих аргументов.</span><span class="sxs-lookup"><span data-stu-id="f9e98-143">The property settings are used unless you pass the corresponding arguments when executing the **Open** method.</span></span> <span data-ttu-id="f9e98-144">Если аргумент передается, переопределяет параметр соответствующего свойства и значение свойства обновляется значение аргумента.</span><span class="sxs-lookup"><span data-stu-id="f9e98-144">If you pass an argument, it overrides the corresponding property setting, and the property setting is updated with the argument value.</span></span>

  - <span data-ttu-id="f9e98-145">После открытия объекта **набора записей** эти свойства доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="f9e98-145">After you open the **Recordset** object, these properties become read-only.</span></span>


> [!NOTE]
> <P><span data-ttu-id="f9e98-146">Свойство <STRONG>ActiveConnection</STRONG> доступен для чтения только для объектов <STRONG>наборов записей</STRONG> , для свойства <A href="source-property-ado-recordset.md">источника</A> задано значение допустимого объекта <STRONG>команды</STRONG> , даже если объект <STRONG>набора записей</STRONG> не открыт.</span><span class="sxs-lookup"><span data-stu-id="f9e98-146">The <STRONG>ActiveConnection</STRONG> property is read only for <STRONG>Recordset</STRONG> objects whose <A href="source-property-ado-recordset.md">Source</A> property is set to a valid <STRONG>Command</STRONG> object, even if the <STRONG>Recordset</STRONG> object isn't open.</span></span></P>



<span data-ttu-id="f9e98-147">Если передается объект **команды** в аргументе *источника* и передавать аргумент *ActiveConnection* , возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="f9e98-147">If you pass a **Command** object in the *Source* argument and also pass an *ActiveConnection* argument, an error occurs.</span></span> <span data-ttu-id="f9e98-148">Свойство **ActiveConnection** объекта **команда** уже должно быть присвоено допустимый объект или подключения строка **подключения** .</span><span class="sxs-lookup"><span data-stu-id="f9e98-148">The **ActiveConnection** property of the **Command** object must already be set to a valid **Connection** object or connection string.</span></span>

<span data-ttu-id="f9e98-149">Если что-то отличного от объекта **команды** передается в аргументе *источник* , аргумента *Options* можно использовать для оптимизации ознакомительная версия *исходный* аргумент.</span><span class="sxs-lookup"><span data-stu-id="f9e98-149">If you pass something other than a **Command** object in the *Source* argument, you can use the *Options* argument to optimize evaluation of the *Source* argument.</span></span> <span data-ttu-id="f9e98-150">Если аргумент *Параметры* не определен, так как ADO необходимо принять вызовы поставщика, чтобы определить, является ли аргумент инструкции SQL, хранимую процедуру, URL-адрес или имя таблицы могут возникать снижение производительности.</span><span class="sxs-lookup"><span data-stu-id="f9e98-150">If the *Options* argument is not defined, you may experience diminished performance because ADO must make calls to the provider to determine if the argument is an SQL statement, a stored procedure, a URL, or a table name.</span></span> <span data-ttu-id="f9e98-151">Если вы знаете, какой тип *источника* вы используете, задание *параметров* аргумента указывает ADO перейти непосредственно к соответствующий код.</span><span class="sxs-lookup"><span data-stu-id="f9e98-151">If you know what *Source* type you're using, setting the *Options* argument instructs ADO to jump directly to the relevant code.</span></span> <span data-ttu-id="f9e98-152">Если аргумент *Параметры* не соответствует типу *источника* , возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="f9e98-152">If the *Options* argument does not match the *Source* type, an error occurs.</span></span>

<span data-ttu-id="f9e98-153">Если объект **потока** передается в аргументе *источник* , не должны передавать сведения в других аргументов.</span><span class="sxs-lookup"><span data-stu-id="f9e98-153">If you pass a **Stream** object in the *Source* argument, you should not pass information into the other arguments.</span></span> <span data-ttu-id="f9e98-154">Это приведет к ошибке.</span><span class="sxs-lookup"><span data-stu-id="f9e98-154">Doing so will generate an error.</span></span> <span data-ttu-id="f9e98-155">Сведения о **ActiveConnection** не сохраняются при открытии **набора записей** из **потока**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-155">The **ActiveConnection** information is not retained when a **Recordset** is opened from a **Stream**.</span></span>

<span data-ttu-id="f9e98-156">Значение по умолчанию для аргумента *Options* — **adCmdFile** , если подключение не связан с **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-156">The default for the *Options* argument is **adCmdFile** if no connection is associated with the **Recordset**.</span></span> <span data-ttu-id="f9e98-157">Обычно это будет История в пользу постоянно сохраненные объекты **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="f9e98-157">This will typically be the case for persistently stored **Recordset** objects.</span></span>

<span data-ttu-id="f9e98-158">Если источник данных не возвращает записи, Поставщик устанавливает свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) значение **True**, и текущей позиции записи не определен.</span><span class="sxs-lookup"><span data-stu-id="f9e98-158">If the data source returns no records, the provider sets both the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties to **True**, and the current record position is undefined.</span></span> <span data-ttu-id="f9e98-159">По-прежнему можно добавить новые данные на пустой объект **набора записей** , если позволяет тип курсора.</span><span class="sxs-lookup"><span data-stu-id="f9e98-159">You can still add new data to this empty **Recordset** object if the cursor type allows it.</span></span>

<span data-ttu-id="f9e98-160">Когда заключения операции вами через open объекта **набора записей** , используйте метод [Close](close-method-ado.md) чтобы освободить место на все связанные системные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="f9e98-160">When you have concluded your operations over an open **Recordset** object, use the [Close](close-method-ado.md) method to free any associated system resources.</span></span> <span data-ttu-id="f9e98-161">Закрытие объект не удаляется из памяти; можно изменить параметры его свойства и использовать метод **Open** для открытия попытку позже.</span><span class="sxs-lookup"><span data-stu-id="f9e98-161">Closing an object does not remove it from memory; you can change its property settings and use the **Open** method to open it again later.</span></span> <span data-ttu-id="f9e98-162">Чтобы полностью удалить объект из памяти, задайте объектной переменной значение *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="f9e98-162">To completely eliminate an object from memory, set the object variable to *Nothing*.</span></span>

<span data-ttu-id="f9e98-163">Перед свойству **ActiveConnection** вызовите **Open** с не операндов для создания экземпляра **набора записей** , созданных путем добавления поля в коллекцию [полей](fields-collection-ado.md) **набора записей** .</span><span class="sxs-lookup"><span data-stu-id="f9e98-163">Before the **ActiveConnection** property is set, call **Open** with no operands to create an instance of a **Recordset** created by appending fields to the **Recordset** [Fields](fields-collection-ado.md) collection.</span></span>

<span data-ttu-id="f9e98-164">Если выбрать свойство [CursorLocation](cursorlocation-property-ado.md) **adUseClient**можно извлечь строки асинхронно в одном из двух способов.</span><span class="sxs-lookup"><span data-stu-id="f9e98-164">If you have set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient**, you can retrieve rows asynchronously in one of two ways.</span></span> <span data-ttu-id="f9e98-165">Рекомендуется задать *Параметры* **adAsyncFetch**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-165">The recommended method is to set *Options* to **adAsyncFetch**.</span></span> <span data-ttu-id="f9e98-166">Кроме того можно использовать свойство динамических «Асинхронной обработке строк» в коллекции [свойств](properties-collection-ado.md) , но событий, связанных с извлеченных могут быть потеряны, если не значение параметра **Options** **adAsyncFetch**.</span><span class="sxs-lookup"><span data-stu-id="f9e98-166">Alternatively, you can use the "Asynchronous Rowset Processing" dynamic property in the [Properties](properties-collection-ado.md) collection, but related retrieved events can be lost if you do not set the **Options** parameter to **adAsyncFetch**.</span></span>


> [!NOTE]
> <P><span data-ttu-id="f9e98-167">Фон выборки в поставщике удаленного MS поддерживается только с помощью параметра <EM>Options</EM> метода <STRONG>Open</STRONG> .</span><span class="sxs-lookup"><span data-stu-id="f9e98-167">Background fetching in the MS Remote provider is supported only through the <STRONG>Open</STRONG> method's <EM>Options</EM> parameter.</span></span></P>


> [!NOTE]
> <span data-ttu-id="f9e98-168">URL-адреса, с помощью схемы http автоматически вызывает [Поставщик Microsoft OLE DB для публикации Интернет](microsoft-ole-db-provider-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="f9e98-168">URLs using the http scheme will automatically invoke the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="f9e98-169">Для получения дополнительных сведений см [абсолютных и относительных URL-адресов](absolute-and-relative-urls.md).</span><span class="sxs-lookup"><span data-stu-id="f9e98-169">For more information, see [Absolute and relative URLs](absolute-and-relative-urls.md).</span></span>



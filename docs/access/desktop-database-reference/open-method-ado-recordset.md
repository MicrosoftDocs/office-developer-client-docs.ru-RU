---
title: Open Method (ADO Recordset)
TOCTitle: Open Method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: dd5a956d5a978a374e10c85e7803715f81d48f2a
ms.sourcegitcommit: a49b77f4c8cec69f90656a86f0872cf34c35968e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2018
ms.locfileid: "25603080"
---
# <a name="open-method-ado-recordset"></a>Open Method (ADO Recordset)


**Применимо к**: Access 2013 | Office 2013


Открывается курсор.

## <a name="syntax"></a>Синтаксис

*набор записей*. Откройте*исходный*, *ActiveConnection*, *CursorType*, *LockType для*, *Параметры*

## <a name="parameters"></a>Параметры

  - *Source*

  - Необязательный параметр. **Variant** , которое оценивается как допустимый объект [команды](command-object-ado.md) , инструкции SQL, имя таблицы, вызов хранимой процедуры, URL-адрес или имя файла или [потока](stream-object-ado.md) object, содержащий постоянно хранимых [набора записей](recordset-object-ado.md).

  - *ActiveConnection*

  - Необязательный параметр. **Variant** , которое оценивается как допустимое имя переменной объекта [подключения](connection-object-ado.md) , либо **строку** , содержащую параметры [ConnectionString](connectionstring-property-ado.md) .

  - *CursorType*

  - Необязательный параметр. [CursorTypeEnum](cursortypeenum.md) значение, определяющее тип курсора, поставщик должен использовать при открытии **набора записей**. Значение по умолчанию — **adOpenForwardOnly**.

  - *LockType для*

  - Необязательный параметр. [LockTypeEnum](locktypeenum.md) значение, определяющее тип блокировки (одновременно) поставщика следует использовать при открытии **набора записей**. Значение по умолчанию — **adLockReadOnly**.

  - *Варианты*

  - Необязательный параметр. **Длинное** значение, которое указывает, как поставщик необходимо решить *исходный* аргумент, если он представляет элемент отличный от объекта **команды** или **набора записей** должен быть восстановлен из файла, в котором он был сохранен ранее. Может быть один или несколько [CommandTypeEnum](commandtypeenum.md) или [ExecuteOptionEnum](executeoptionenum.md) значения, которые может использоваться совместно с оператор AND.


> [!NOTE]
> <P>При открытии <STRONG>набора записей</STRONG> из <STRONG>потока</STRONG> , содержащий постоянных <STRONG>набора записей</STRONG>с помощью значение <STRONG>ExecuteOptionEnum</STRONG> <STRONG>adAsyncFetchNonBlocking</STRONG> не будет иметь эффекта. Выборка будет синхронная и блокировки.</P>



Значения **ExecuteOpenEnum** **adExecuteNoRecords** или **adExecuteStream** не должны использоваться с **Open**.

## <a name="remarks"></a>Замечания

По умолчанию курсор для набора **записей** ADO является только вперед, только для чтения на сервере.

С помощью метода **Open** **целиком** открывается курсор, который представляет записей из базовой таблицы, результаты запроса или ранее сохраненных **записей**.

Используйте необязательный аргумент *источник* , чтобы указать источник данных, с помощью одного из следующих значений: переменной объекта **команды** , инструкции SQL, хранимую процедуру, имя таблицы, URL-адрес или полный путь к файлу. Если *источник* — это путь к файлу, он может быть полный путь ("c:\\dir\\file.rst»), относительный путь (».. \\file.rst»), или URL-адрес (»https://files/file.rst«).

<<<<<<< HEAD не рекомендуется использовать *исходный* аргумент методу **Open** для выполнения запроса, который не возвращает записей, так как нет возможности легко определить, является ли вызов завершился успешно. **Набор записей** , возвращаемых такой запрос будет закрыто. Вызовите метод [Execute](https://msdn.microsoft.com/library/jj248785\(v=office.15\)) объекта **Command** или метода [Execute](https://msdn.microsoft.com/library/jj249832\(v=office.15\)) объекта **подключения** вместо этого для выполнения запроса, например инструкцию SQL INSERT, который не возвращает записей.
=== Не рекомендуется использовать *исходный* аргумент методу **Open** для выполнения запроса, который не возвращает записей, так как нет возможности легко определить, является ли вызов завершился успешно. **Набор записей** , возвращаемых такой запрос будет закрыто. Вызовите метод [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) объекта **Command** или метода [Execute](https://msdn.microsoft.com/library/jj249832\(v=office.15\)) объекта **подключения** вместо этого для выполнения запроса, например инструкцию SQL INSERT, который не возвращает записей.
>>>>>>> master

Аргумент *ActiveConnection* соответствует свойству [ActiveConnection](activeconnection-property-ado.md) и указывает соединений для открытия **набора записей** объекта. Если передать определение подключения для этого аргумента ADO откроется новое подключение с помощью указанных параметров. После открытия **набора записей** с курсором со стороны клиента (**CursorLocation** = **adUseClient**), можно изменить значение этого свойства для обновления другого поставщика. Или этому свойству можно присвоено значение **Nothing** (в Microsoft Visual Basic) или значение NULL для отключения **записей** из любого поставщика. Изменение **ActiveConnection** для курсора на сервере, приведет к ошибке, однако.

Для других аргументов, которые соответствуют свойства объекта **набора записей** (*источник*, *CursorType*и *LockType для*) отношения аргументы для свойства выглядит следующим образом:

  - Чтение и запись является ли данное свойство перед открытием объекта **набора записей** .

  - Параметры свойства используются при выполнении метода **Open** передается соответствующих аргументов. Если аргумент передается, переопределяет параметр соответствующего свойства и значение свойства обновляется значение аргумента.

  - После открытия объекта **набора записей** эти свойства доступны только для чтения.


> [!NOTE]
> <P>Свойство <STRONG>ActiveConnection</STRONG> доступен для чтения только для объектов <STRONG>наборов записей</STRONG> , для свойства <A href="source-property-ado-recordset.md">источника</A> задано значение допустимого объекта <STRONG>команды</STRONG> , даже если объект <STRONG>набора записей</STRONG> не открыт.</P>



Если передается объект **команды** в аргументе *источника* и передавать аргумент *ActiveConnection* , возникает ошибка. Свойство **ActiveConnection** объекта **команда** уже должно быть присвоено допустимый объект или подключения строка **подключения** .

Если что-то отличного от объекта **команды** передается в аргументе *источник* , аргумента *Options* можно использовать для оптимизации ознакомительная версия *исходный* аргумент. Если аргумент *Параметры* не определен, так как ADO необходимо принять вызовы поставщика, чтобы определить, является ли аргумент инструкции SQL, хранимую процедуру, URL-адрес или имя таблицы могут возникать снижение производительности. Если вы знаете, какой тип *источника* вы используете, задание *параметров* аргумента указывает ADO перейти непосредственно к соответствующий код. Если аргумент *Параметры* не соответствует типу *источника* , возникает ошибка.

Если объект **потока** передается в аргументе *источник* , не должны передавать сведения в других аргументов. Это приведет к ошибке. Сведения о **ActiveConnection** не сохраняются при открытии **набора записей** из **потока**.

Значение по умолчанию для аргумента *Options* — **adCmdFile** , если подключение не связан с **набора записей**. Обычно это будет История в пользу постоянно сохраненные объекты **набора записей** .

Если источник данных не возвращает записи, Поставщик устанавливает свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) значение **True**, и текущей позиции записи не определен. По-прежнему можно добавить новые данные на пустой объект **набора записей** , если позволяет тип курсора.

Когда заключения операции вами через open объекта **набора записей** , используйте метод [Close](close-method-ado.md) чтобы освободить место на все связанные системные ресурсы. Закрытие объект не удаляется из памяти; можно изменить параметры его свойства и использовать метод **Open** для открытия попытку позже. Чтобы полностью удалить объект из памяти, задайте объектной переменной значение *Nothing*.

Перед свойству **ActiveConnection** вызовите **Open** с не операндов для создания экземпляра **набора записей** , созданных путем добавления поля в коллекцию [полей](fields-collection-ado.md) **набора записей** .

Если выбрать свойство [CursorLocation](cursorlocation-property-ado.md) **adUseClient**можно извлечь строки асинхронно в одном из двух способов. Рекомендуется задать *Параметры* **adAsyncFetch**. Кроме того можно использовать свойство динамических «Асинхронной обработке строк» в коллекции [свойств](properties-collection-ado.md) , но событий, связанных с извлеченных могут быть потеряны, если не значение параметра **Options** **adAsyncFetch**.


> [!NOTE]
> <P>Фон выборки в поставщике удаленного MS поддерживается только с помощью параметра <EM>Options</EM> метода <STRONG>Open</STRONG> .</P>


<<<<<<< HEAD


> [!NOTE]
> <P>URL-адреса, с помощью схемы http автоматически вызывает <A href="microsoft-ole-db-provider-for-internet-publishing.md">Поставщик Microsoft OLE DB для публикации Интернет</A>. Для получения дополнительных сведений см <A href="absolute-and-relative-urls.md">абсолютного и относительных URL-адресов</A>.</P>
=======
> [!NOTE]
> URL-адреса, с помощью схемы http автоматически вызывает [Поставщик Microsoft OLE DB для публикации Интернет](microsoft-ole-db-provider-for-internet-publishing.md). Для получения дополнительных сведений см [абсолютных и относительных URL-адресов](absolute-and-relative-urls.md).
>>>>>>> master



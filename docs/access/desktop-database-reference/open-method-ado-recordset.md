---
title: Метод Open (объект Recordset ADO)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288408"
---
# <a name="open-method-ado-recordset"></a>Метод Open (объект Recordset ADO)

**Область применения**: Access 2013, Office 2013

Открывает курсор.

## <a name="syntax"></a>Синтаксис

*набор записей.* С *открытым исходным* кодом , *ActiveConnection*, *CursorType*, *LockType*, *Параметры*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Source* |Необязательный параметр. Вариант, который оценивает допустимый объект [Command,](command-object-ado.md) SQL, имя таблицы, вызов сохраненной процедуры, URL-адрес или имя файла или объекта [Stream,](stream-object-ado.md) содержащего постоянно хранимый [Набор записей.](recordset-object-ado.md) |
|*ActiveConnection* |Необязательный параметр. Либо **Вариант,** оценивающий допустимые имя переменной [объекта Подключения,](connection-object-ado.md) либо **строка,** [содержающая параметры ConnectionString.](connectionstring-property-ado.md)|
|*CursorType* |Необязательный параметр. Значение [CursorTypeEnum,](cursortypeenum.md) которое определяет тип курсора, который должен использовать поставщик при открытии **наборов записей.** По умолчанию значение **adOpenForwardOnly**.|
|*LockType* |Необязательный параметр. Значение [LockTypeEnum,](locktypeenum.md) определяющий тип блокировки (concurrency), который должен использовать поставщик при открытии **наборов записей.** По умолчанию значение **adLockReadOnly**.|
|*Options* |Необязательный параметр. **Длинное** значение, которое указывает, как поставщик должен оценивать аргумент *Source,* если он представляет нечто иное, чем объект **Command,** или что набор **записей** должен быть восстановлен из файла, в котором он был сохранен ранее. Может быть одно или несколько [значений CommandTypeEnum](commandtypeenum.md) или [ExecuteOptionEnum,](executeoptionenum.md) которые можно сочетать с оператором bitwise AND.|

> [!NOTE]
> Если вы  откроете набор  записей из потока, содержащего сохраняющийся набор записей, использование значения **ExecuteOptionEnum** **adAsyncFetchNonBlocking** не будет иметь эффекта; извлечение будет синхронным и блокированием.

Значения **ExecuteOpenEnum** **adExecuteNoRecords** или **adExecuteStream** не следует использовать в **Open.**

## <a name="remarks"></a>Примечания

Курсор по умолчанию для ADO **Recordset** — это курсор только для чтения, расположенный на сервере.

С помощью **метода Open** в объекте **Recordset** открывается курсор, представляюющий записи из базовой таблицы, результаты запроса или сохраненный ранее **набор записей.**

Используйте необязательный аргумент Source, чтобы указать  источник данных с помощью одного из следующих источников: переменной объекта Command, SQL, сохраненной процедуры, имени таблицы, URL-адреса или полного имени пути к файлу.  Если *Source* — это имя пути к файлу, это может быть полный путь ("c: \\ dir \\ file.rst"), относительный путь (".. \\ file.rst"), или URL-адрес https://files/file.rst ("").

Не стоит использовать аргумент Source  метода **Open** для выполнения запроса действий, который не возвращает записи, так как нет простого способа определить, удалось ли выполнить вызов. Набор **записей,** возвращенный таким запросом, будет закрыт. Для [выполнения](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) запроса, который, [](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) например,  SQL INSERT, не возвращает записи, вызывайте метод Выполнения объекта Command или метод Execute объекта Подключения. 

Аргумент *ActiveConnection* соответствует свойству [ActiveConnection](activeconnection-property-ado.md) и указывает, в какой связи открыть объект **Recordset.** Если вы передаете определение подключения для этого аргумента, ADO открывает новое подключение с использованием указанных параметров. После открытия **recordset** с помощью курсора на стороне клиента **(CursorLocation**  =  **adUseClient)** можно изменить значение этого свойства для отправки обновлений другому поставщику. Или вы можете установить это свойство **в Nothing** (в Microsoft Visual Basic) или NULL, чтобы отключить **Набор записей** от любого поставщика. Однако изменение **ActiveConnection** для курсора на стороне сервера создает ошибку.

Для других аргументов, непосредственно соответствующих свойствам объекта **Recordset** *(Source,* *CursorType* и *LockType),* отношение аргументов к свойствам следующим образом:

- Свойство читается или записи перед открытием объекта **Recordset.**

- Параметры свойств используются, если не передать соответствующие аргументы при выполнении **метода Open.** Если вы передаете аргумент, он переопределит соответствующий параметр свойства, и параметр свойства обновляется со значением аргумента.

- После открытия объекта **Recordset** эти свойства становятся только для чтения.

> [!NOTE]
> Свойство **ActiveConnection** считыно только [](source-property-ado-recordset.md) для объектов **Recordset,** для которых свойство Source настроено на допустимый объект **Command,** даже если объект **Recordset** не открыт.

Если вы передаете **объект Command** в *аргументе Source,* а также передаете аргумент *ActiveConnection,* возникает ошибка. Свойство **ActiveConnection** объекта **Command** уже должно быть настроено на допустимый объект **подключения** или строку подключения.

Если вы передаете что-то другое, кроме объекта **Command** в аргументе *Source,* вы можете использовать аргумент *Options* для оптимизации оценки *аргумента Source.* Если аргумент *Options* не определен, производительность может снизиться, так как ADO должна звонить поставщику, чтобы определить, является ли аргумент SQL, сохраненной процедурой, URL-адресом или именем таблицы. Если вы *знаете,* какой тип источника используется, задайте аргумент *Options,* который предписывает ADO перейти непосредственно к соответствующему коду. Если аргумент *Options* не соответствует типу *Source,* возникает ошибка.

Если вы передаете **объект Stream** в *аргументе Source,* не следует передавать сведения в другие аргументы. Это создает ошибку. Сведения **ActiveConnection** не сохраняются при открывлении **recordset** из **потока.**

По умолчанию для *аргумента Параметры* **adCmdFile,** если подключение не связано с **Набором записей.** Обычно это касается постоянно хранимых объектов **Recordset.**

Если источник данных не возвращает записи, поставщик задает свойства [boF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) **true,** и текущая позиция записи не определяется. Вы по-прежнему можете добавлять новые данные в этот пустой объект **Recordset,** если позволяет тип курсора.

Когда вы завершили операции по открытому объекту **Recordset,** используйте метод [Close,](close-method-ado.md) чтобы освободить все связанные системные ресурсы. Закрытие объекта не удаляет его из памяти; Вы можете изменить его параметры свойств и использовать метод **Open,** чтобы открыть его снова позже. Чтобы полностью исключить объект из памяти, установите переменную объекта *в Nothing*.

Перед **заданным** свойством ActiveConnection вызывайте Open без операндов, чтобы создать экземпляр набора записей, созданный при присоединении полей к коллекции   **Полей Recordset.** [](fields-collection-ado.md)

Если свойство [CursorLocation](cursorlocation-property-ado.md) установлено **в adUseClient,** вы можете получить строки асинхронно одним из двух способов. Рекомендуется установить *параметры* для **adAsyncFetch.** Кроме того, можно использовать динамическое свойство "Обработка асинхронных строк" в коллекции [Свойств,](properties-collection-ado.md) но связанные события с извлечением могут быть потеряны, если не задать параметр **Параметры** **adAsyncFetch**.

> [!NOTE]
> Фоновое извлечение в поставщике ms Remote поддерживается только с помощью параметра **Параметры** метода *Open.*

> [!NOTE]
> URL-адреса, использующие схему http, автоматически вызывают поставщика DB Microsoft [OLE для публикации в Интернете.](microsoft-ole-db-provider-for-internet-publishing.md) Дополнительные сведения см. в [url-адресах Absolute и relative.](absolute-and-relative-urls.md)



---
title: Метод Open (объект Recordset ADO)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288408"
---
# <a name="open-method-ado-recordset"></a><span data-ttu-id="0df0b-102">Метод Open (объект Recordset ADO)</span><span class="sxs-lookup"><span data-stu-id="0df0b-102">Open method (ADO Recordset)</span></span>

<span data-ttu-id="0df0b-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="0df0b-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="0df0b-104">Открывает курсор.</span><span class="sxs-lookup"><span data-stu-id="0df0b-104">Opens a cursor.</span></span>

## <a name="syntax"></a><span data-ttu-id="0df0b-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="0df0b-105">Syntax</span></span>

<span data-ttu-id="0df0b-106">*набор записей*. Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*</span><span class="sxs-lookup"><span data-stu-id="0df0b-106">*recordset*.Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*</span></span>

## <a name="parameters"></a><span data-ttu-id="0df0b-107">Параметры</span><span class="sxs-lookup"><span data-stu-id="0df0b-107">Parameters</span></span>

|<span data-ttu-id="0df0b-108">Параметр</span><span class="sxs-lookup"><span data-stu-id="0df0b-108">Parameter</span></span>|<span data-ttu-id="0df0b-109">Описание</span><span class="sxs-lookup"><span data-stu-id="0df0b-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="0df0b-110">*Source*</span><span class="sxs-lookup"><span data-stu-id="0df0b-110">*Source*</span></span> |<span data-ttu-id="0df0b-111">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="0df0b-111">Optional.</span></span> <span data-ttu-id="0df0b-112">Значение **Variant** , которое оценивается как допустимый объект [Command](command-object-ado.md) , оператор SQL, имя таблицы, вызов ХРАНИМОЙ процедуры, URL-адрес или имя объекта файла или [потока](stream-object-ado.md) , содержащего сохраняемый [набор записей](recordset-object-ado.md).</span><span class="sxs-lookup"><span data-stu-id="0df0b-112">A **Variant** that evaluates to a valid [Command](command-object-ado.md) object, an SQL statement, a table name, a stored procedure call, a URL, or the name of a file or [Stream](stream-object-ado.md) object containing a persistently stored [Recordset](recordset-object-ado.md).</span></span>|
|<span data-ttu-id="0df0b-113">*ActiveConnection*</span><span class="sxs-lookup"><span data-stu-id="0df0b-113">*ActiveConnection*</span></span> |<span data-ttu-id="0df0b-114">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="0df0b-114">Optional.</span></span> <span data-ttu-id="0df0b-115">Значение **Variant** , которое оценивается как допустимое имя переменной объекта [подключения](connection-object-ado.md) , или **строку** , которая содержит параметры [ConnectionString](connectionstring-property-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="0df0b-115">Either a **Variant** that evaluates to a valid [Connection](connection-object-ado.md) object variable name, or a **String** that contains [ConnectionString](connectionstring-property-ado.md) parameters.</span></span>|
|<span data-ttu-id="0df0b-116">*CursorType*</span><span class="sxs-lookup"><span data-stu-id="0df0b-116">*CursorType*</span></span> |<span data-ttu-id="0df0b-117">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="0df0b-117">Optional.</span></span> <span data-ttu-id="0df0b-118">Значение [курсортипинум](cursortypeenum.md) , определяющее тип курсора, который должен использовать поставщик при открытии объекта **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-118">A [CursorTypeEnum](cursortypeenum.md) value that determines the type of cursor that the provider should use when opening the **Recordset**.</span></span> <span data-ttu-id="0df0b-119">Значение по умолчанию — **адопенфорвардонли**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-119">The default value is **adOpenForwardOnly**.</span></span>|
|<span data-ttu-id="0df0b-120">*LockType*</span><span class="sxs-lookup"><span data-stu-id="0df0b-120">*LockType*</span></span> |<span data-ttu-id="0df0b-121">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="0df0b-121">Optional.</span></span> <span data-ttu-id="0df0b-122">Значение [LockTypeEnum](locktypeenum.md) , определяющее тип блокировки (параллелизма), который должен использоваться поставщиком при открытии объекта **Recordset**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-122">A [LockTypeEnum](locktypeenum.md) value that determines what type of locking (concurrency) the provider should use when opening the **Recordset**.</span></span> <span data-ttu-id="0df0b-123">Значение по умолчанию — **адлоккреадонли**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-123">The default value is **adLockReadOnly**.</span></span>|
|<span data-ttu-id="0df0b-124">*Options*</span><span class="sxs-lookup"><span data-stu-id="0df0b-124">*Options*</span></span> |<span data-ttu-id="0df0b-125">Необязательный атрибут.</span><span class="sxs-lookup"><span data-stu-id="0df0b-125">Optional.</span></span> <span data-ttu-id="0df0b-126">**Длинное** значение, указывающее, как поставщик должен оценивать аргумент *Source* , если он представляет нечто, отличное от объекта **Command** , или что **набор записей** должен быть восстановлен из файла, в котором он был ранее сохранен.</span><span class="sxs-lookup"><span data-stu-id="0df0b-126">A **Long** value that indicates how the provider should evaluate the *Source* argument if it represents something other than a **Command** object, or that the **Recordset** should be restored from a file where it was previously saved.</span></span> <span data-ttu-id="0df0b-127">Может быть одним или несколькими значениями [коммандтипинум](commandtypeenum.md) или [ексекутеоптионенум](executeoptionenum.md) , которые можно сочетать с помощью побитового оператора и.</span><span class="sxs-lookup"><span data-stu-id="0df0b-127">Can be one or more [CommandTypeEnum](commandtypeenum.md) or [ExecuteOptionEnum](executeoptionenum.md) values, which can be combined with a bitwise AND operator.</span></span>|

> [!NOTE]
> <span data-ttu-id="0df0b-128">Если вы откроете объект **Recordset** из **потока** , содержащего постоянный **набор записей**, использование значения **ексекутеоптионенум** для **адасинкфетчнонблоккинг** не приведет к применению. Извлечение будет синхронной и блокирующей.</span><span class="sxs-lookup"><span data-stu-id="0df0b-128">If you open a **Recordset** from a **Stream** containing a persisted **Recordset**, using an **ExecuteOptionEnum** value of **adAsyncFetchNonBlocking** will not have an effect; the fetch will be synchronous and blocking.</span></span>

<span data-ttu-id="0df0b-129">Значения **ексекутеопененум** для **адексекутенорекордс** или **Адексекутестреам** не следует использовать с **открытым**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-129">The **ExecuteOpenEnum** values of **adExecuteNoRecords** or **adExecuteStream** should not be used with **Open**.</span></span>

## <a name="remarks"></a><span data-ttu-id="0df0b-130">Замечания</span><span class="sxs-lookup"><span data-stu-id="0df0b-130">Remarks</span></span>

<span data-ttu-id="0df0b-131">Курсор по умолчанию для **набора записей** ADO — это расположенный только для чтения курсор, расположенный на сервере.</span><span class="sxs-lookup"><span data-stu-id="0df0b-131">The default cursor for an ADO **Recordset** is a forward-only, read-only cursor located on the server.</span></span>

<span data-ttu-id="0df0b-132">При использовании метода **Open** для объекта **Recordset** открывается курсор, представляющий записи из базовой таблицы, результаты запроса или ранее сохраненный **набор записей**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-132">Using the **Open** method on a **Recordset** object opens a cursor that represents records from a base table, the results of a query, or a previously saved **Recordset**.</span></span>

<span data-ttu-id="0df0b-133">Используйте необязательный аргумент *Source* для указания источника данных с помощью одного из следующих параметров: объектная переменная **команды** , инструкция SQL, хранимая процедура, имя таблицы, URL-адрес или полное имя пути к файлу.</span><span class="sxs-lookup"><span data-stu-id="0df0b-133">Use the optional *Source* argument to specify a data source using one of the following: a **Command** object variable, an SQL statement, a stored procedure, a table name, a URL, or a complete file path name.</span></span> <span data-ttu-id="0df0b-134">Если *Source* — это имя пути к файлу, это может быть полный путь ("c:\\dir\\. RST"), относительный путь (".. \\файл. RST ") или URL-адрес ("https://files/file.rst").</span><span class="sxs-lookup"><span data-stu-id="0df0b-134">If *Source* is a file path name, it can be a full path ("c:\\dir\\file.rst"), a relative path ("..\\file.rst"), or a URL ("https://files/file.rst").</span></span>

<span data-ttu-id="0df0b-135">Не рекомендуется использовать аргумент *Source* метода **Open** для выполнения запроса на изменение, не возвращающего записи, так как не существует простого способа определить, успешно ли выполнен вызов.</span><span class="sxs-lookup"><span data-stu-id="0df0b-135">It is not a good idea to use the *Source* argument of the **Open** method to perform an action query that doesnt return records because there is no easy way to determine whether the call succeeded.</span></span> <span data-ttu-id="0df0b-136">**Набор записей** , возвращенный таким запросом, будет закрыт.</span><span class="sxs-lookup"><span data-stu-id="0df0b-136">The **Recordset** returned by such a query will be closed.</span></span> <span data-ttu-id="0df0b-137">ВыЗовите метод [EXECUTE](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) объекта **Command** или метод [EXECUTE](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) объекта **Connection** вместо того, чтобы выполнить запрос, например инструкцию SQL INSERT, которая не возвращает записи.</span><span class="sxs-lookup"><span data-stu-id="0df0b-137">Call the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method of a **Command** object or the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) method of a **Connection** object instead to perform a query that, such as a SQL INSERT statement, that doesnt return records.</span></span>

<span data-ttu-id="0df0b-138">Аргумент *ActiveConnection* соответствует свойству [ActiveConnection](activeconnection-property-ado.md) и указывает, в каком подключении следует открыть объект **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0df0b-138">The *ActiveConnection* argument corresponds to the [ActiveConnection](activeconnection-property-ado.md) property and specifies in which connection to open the **Recordset** object.</span></span> <span data-ttu-id="0df0b-139">Если вы передаете определение подключения для этого аргумента, ADO открывает новое подключение, используя указанные параметры.</span><span class="sxs-lookup"><span data-stu-id="0df0b-139">If you pass a connection definition for this argument, ADO opens a new connection using the specified parameters.</span></span> <span data-ttu-id="0df0b-140">После открытия объекта **Recordset** с помощью клиентского курсора (**CursorLocation** = **адусеклиент**) можно изменить значение этого свойства, чтобы отправить обновления другому поставщику.</span><span class="sxs-lookup"><span data-stu-id="0df0b-140">After opening the **Recordset** with a client-side cursor (**CursorLocation** = **adUseClient**), you can change the value of this property to send updates to another provider.</span></span> <span data-ttu-id="0df0b-141">Кроме того, можно задать для этого свойства значение **Nothing** (в Microsoft Visual Basic) или null, чтобы отключить объект **Recordset** от любого поставщика.</span><span class="sxs-lookup"><span data-stu-id="0df0b-141">Or you can set this property to **Nothing** (in Microsoft Visual Basic) or NULL to disconnect the **Recordset** from any provider.</span></span> <span data-ttu-id="0df0b-142">Однако при изменении **ActiveConnection** для курсора на стороне сервера возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="0df0b-142">Changing **ActiveConnection** for a server-side cursor generates an error, however.</span></span>

<span data-ttu-id="0df0b-143">Для других аргументов, которые соответствуют непосредственно свойствам объекта **Recordset** (*Source*, *CursorType*и *LockType*), отношение аргументов к свойствам выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="0df0b-143">For the other arguments that correspond directly to properties of a **Recordset** object (*Source*, *CursorType*, and *LockType*), the relationship of the arguments to the properties is as follows:</span></span>

- <span data-ttu-id="0df0b-144">Свойство доступно для чтения и записи перед открытием объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0df0b-144">The property is read/write before the **Recordset** object is opened.</span></span>

- <span data-ttu-id="0df0b-145">Параметры свойства используются, если при выполнении метода **Open** не передаются соответствующие аргументы.</span><span class="sxs-lookup"><span data-stu-id="0df0b-145">The property settings are used unless you pass the corresponding arguments when executing the **Open** method.</span></span> <span data-ttu-id="0df0b-146">При передаче аргумента он переопределяет соответствующий параметр свойства, а параметр свойства обновляется значением аргумента.</span><span class="sxs-lookup"><span data-stu-id="0df0b-146">If you pass an argument, it overrides the corresponding property setting, and the property setting is updated with the argument value.</span></span>

- <span data-ttu-id="0df0b-147">После открытия объекта **Recordset** эти свойства становятся доступными только для чтения.</span><span class="sxs-lookup"><span data-stu-id="0df0b-147">After you open the **Recordset** object, these properties become read-only.</span></span>

> [!NOTE]
> <span data-ttu-id="0df0b-148">Свойство **ActiveConnection** доступно только для чтения для объектов **Recordset** , свойству [Source](source-property-ado-recordset.md) которых присвоено значение допустимого объекта **Command** , даже если объект **Recordset** не открыт.</span><span class="sxs-lookup"><span data-stu-id="0df0b-148">The **ActiveConnection** property is read only for **Recordset** objects whose [Source](source-property-ado-recordset.md) property is set to a valid **Command** object, even if the **Recordset** object isn't open.</span></span>

<span data-ttu-id="0df0b-149">Если передать объект **Command** в аргументе *Source* , а также передать аргумент *ActiveConnection* , возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="0df0b-149">If you pass a **Command** object in the *Source* argument and also pass an *ActiveConnection* argument, an error occurs.</span></span> <span data-ttu-id="0df0b-150">Для свойства **ActiveConnection** объекта **Command** должен быть уже задан допустимый объект **подключения** или строка подключения.</span><span class="sxs-lookup"><span data-stu-id="0df0b-150">The **ActiveConnection** property of the **Command** object must already be set to a valid **Connection** object or connection string.</span></span>

<span data-ttu-id="0df0b-151">Если вы передаете значение, отличное от объекта **Command** , в аргументе *Source* , можно использовать аргумент *Options* для оптимизации оценки *исходного* аргумента.</span><span class="sxs-lookup"><span data-stu-id="0df0b-151">If you pass something other than a **Command** object in the *Source* argument, you can use the *Options* argument to optimize evaluation of the *Source* argument.</span></span> <span data-ttu-id="0df0b-152">Если аргумент *Options* не определен, может наблюдаться снижение производительности, так как ADO должен совершать вызовы поставщику, чтобы определить, является ли аргумент оператором SQL, хранимой процедурой, URL-адресом или именем таблицы.</span><span class="sxs-lookup"><span data-stu-id="0df0b-152">If the *Options* argument is not defined, you may experience diminished performance because ADO must make calls to the provider to determine if the argument is an SQL statement, a stored procedure, a URL, or a table name.</span></span> <span data-ttu-id="0df0b-153">Если вы знаете, какой тип *источника* вы используете, задание аргумента *Options* указывает, что ADO будет переходить непосредственно к соответствующему коду.</span><span class="sxs-lookup"><span data-stu-id="0df0b-153">If you know what *Source* type you're using, setting the *Options* argument instructs ADO to jump directly to the relevant code.</span></span> <span data-ttu-id="0df0b-154">Если аргумент *Options* не отвечает типу *источника* , возникает ошибка.</span><span class="sxs-lookup"><span data-stu-id="0df0b-154">If the *Options* argument does not match the *Source* type, an error occurs.</span></span>

<span data-ttu-id="0df0b-155">Если передать объект **Stream** в аргументе *Source* , не следует передавать данные в другие аргументы.</span><span class="sxs-lookup"><span data-stu-id="0df0b-155">If you pass a **Stream** object in the *Source* argument, you should not pass information into the other arguments.</span></span> <span data-ttu-id="0df0b-156">При этом будет выдаваться сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="0df0b-156">Doing so will generate an error.</span></span> <span data-ttu-id="0df0b-157">Сведения о **ActiveConnection** не сохраняются при открытии объекта **Recordset** из **потока**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-157">The **ActiveConnection** information is not retained when a **Recordset** is opened from a **Stream**.</span></span>

<span data-ttu-id="0df0b-158">Значение по умолчанию для аргумента *Options* — **адкмдфиле** , если с набором **записей**не связано ни одно подключение.</span><span class="sxs-lookup"><span data-stu-id="0df0b-158">The default for the *Options* argument is **adCmdFile** if no connection is associated with the **Recordset**.</span></span> <span data-ttu-id="0df0b-159">Как правило, это будет иметь место для сохраняемых объектов **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="0df0b-159">This will typically be the case for persistently stored **Recordset** objects.</span></span>

<span data-ttu-id="0df0b-160">Если источник данных не возвращает записи, поставщик задает для свойств [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) **значение true**, а положение текущей записи — undefine.</span><span class="sxs-lookup"><span data-stu-id="0df0b-160">If the data source returns no records, the provider sets both the [BOF](bof-eof-properties-ado.md) and [EOF](bof-eof-properties-ado.md) properties to **True**, and the current record position is undefined.</span></span> <span data-ttu-id="0df0b-161">Вы по-прежнему можете добавлять новые данные в этот пустой объект **Recordset** , если это разрешено типом Cursor.</span><span class="sxs-lookup"><span data-stu-id="0df0b-161">You can still add new data to this empty **Recordset** object if the cursor type allows it.</span></span>

<span data-ttu-id="0df0b-162">Выполнив операции над открытым объектом **Recordset** , используйте метод [Close](close-method-ado.md) для освобождения связанных системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="0df0b-162">When you have concluded your operations over an open **Recordset** object, use the [Close](close-method-ado.md) method to free any associated system resources.</span></span> <span data-ttu-id="0df0b-163">При закрытии объекта его не удаляются из памяти; Вы можете изменить его параметры, а затем снова открыть его с помощью метода **Open** .</span><span class="sxs-lookup"><span data-stu-id="0df0b-163">Closing an object does not remove it from memory; you can change its property settings and use the **Open** method to open it again later.</span></span> <span data-ttu-id="0df0b-164">Чтобы полностью удалить объект из памяти, присвойте переменной объекта значение *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="0df0b-164">To completely eliminate an object from memory, set the object variable to *Nothing*.</span></span>

<span data-ttu-id="0df0b-165">Перед заданием свойства **ActiveConnection** вызовите метод **Open** без операндов, чтобы создать экземпляр объекта **Recordset** , созданного путем добавления полей в коллекцию полей **Recordset** [](fields-collection-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="0df0b-165">Before the **ActiveConnection** property is set, call **Open** with no operands to create an instance of a **Recordset** created by appending fields to the **Recordset** [Fields](fields-collection-ado.md) collection.</span></span>

<span data-ttu-id="0df0b-166">Если для свойства [CursorLocation](cursorlocation-property-ado.md) задано значение **адусеклиент**, можно асинхронно получать строки одним из двух способов.</span><span class="sxs-lookup"><span data-stu-id="0df0b-166">If you have set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient**, you can retrieve rows asynchronously in one of two ways.</span></span> <span data-ttu-id="0df0b-167">Рекомендуемый метод — задать для *параметра* **адасинкфетч**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-167">The recommended method is to set *Options* to **adAsyncFetch**.</span></span> <span data-ttu-id="0df0b-168">Кроме того, вы можете использовать динамическое свойство "Обработка асинхронных наборов строк" в коллекции [свойств](properties-collection-ado.md) , но связанные извлеченные события могут быть потеряны, если не задать для параметра **Options** значение **адасинкфетч**.</span><span class="sxs-lookup"><span data-stu-id="0df0b-168">Alternatively, you can use the "Asynchronous Rowset Processing" dynamic property in the [Properties](properties-collection-ado.md) collection, but related retrieved events can be lost if you do not set the **Options** parameter to **adAsyncFetch**.</span></span>

> [!NOTE]
> <span data-ttu-id="0df0b-169">Фоновая загрузка в поставщике MS Remote поддерживается только с помощью параметра *Options* метода **Open** .</span><span class="sxs-lookup"><span data-stu-id="0df0b-169">Background fetching in the MS Remote provider is supported only through the **Open** method's *Options* parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="0df0b-170">URL-адреса, использующие схему HTTP, автоматически будут вызывать [поставщик Microsoft OLE DB для публикации в Интернете](microsoft-ole-db-provider-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="0df0b-170">URLs using the http scheme will automatically invoke the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="0df0b-171">Для получения дополнительных сведений см [абсолютные и относительНые URL-адреса](absolute-and-relative-urls.md).</span><span class="sxs-lookup"><span data-stu-id="0df0b-171">For more information, see [Absolute and relative URLs](absolute-and-relative-urls.md).</span></span>



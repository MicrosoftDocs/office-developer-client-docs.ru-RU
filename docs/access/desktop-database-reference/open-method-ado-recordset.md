---
title: Метод Open (объект Recordset ADO)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288408"
---
# <a name="open-method-ado-recordset"></a>Метод Open (объект Recordset ADO)

**Область применения**: Access 2013, Office 2013

Открывает курсор.

## <a name="syntax"></a>Синтаксис

*набор записей*. Open*Source*, *ActiveConnection*, *CursorType*, *LockType*, *Options*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Source* |Необязательное. Значение **Variant** , которое оценивается как допустимый объект [Command](command-object-ado.md) , оператор SQL, имя таблицы, вызов хранимой процедуры, URL-адрес или имя объекта файла или [потока](stream-object-ado.md) , содержащего сохраняемый [набор записей](recordset-object-ado.md).|
|*ActiveConnection* |Необязательное. Значение **Variant** , которое оценивается как допустимое имя переменной объекта [подключения](connection-object-ado.md) , или **строку** , которая содержит параметры [ConnectionString](connectionstring-property-ado.md) .|
|*CursorType* |Необязательное. Значение [курсортипинум](cursortypeenum.md) , определяющее тип курсора, который должен использовать поставщик при открытии объекта **Recordset**. Значение по умолчанию — **адопенфорвардонли**.|
|*LockType* |Необязательное. Значение [LockTypeEnum](locktypeenum.md) , определяющее тип блокировки (параллелизма), который должен использоваться поставщиком при открытии объекта **Recordset**. Значение по умолчанию — **адлоккреадонли**.|
|*Параметры* |Необязательное. **Длинное** значение, указывающее, как поставщик должен оценивать аргумент *Source* , если он представляет нечто, отличное от объекта **Command** , или что **набор записей** должен быть восстановлен из файла, в котором он был ранее сохранен. Может быть одним или несколькими значениями [коммандтипинум](commandtypeenum.md) или [ексекутеоптионенум](executeoptionenum.md) , которые можно сочетать с помощью побитового оператора и.|

> [!NOTE]
> Если вы откроете объект **Recordset** из **потока** , содержащего постоянный **набор записей**, использование значения **ексекутеоптионенум** для **адасинкфетчнонблоккинг** не приведет к применению. Извлечение будет синхронной и блокирующей.

Значения **ексекутеопененум** для **адексекутенорекордс** или **Адексекутестреам** не следует использовать с **открытым**.

## <a name="remarks"></a>Примечания

Курсор по умолчанию для **набора записей** ADO — это расположенный только для чтения курсор, расположенный на сервере.

При использовании метода **Open** для объекта **Recordset** открывается курсор, представляющий записи из базовой таблицы, результаты запроса или ранее сохраненный **набор записей**.

Используйте необязательный аргумент *Source* для указания источника данных с помощью одного из следующих параметров: объектная переменная **команды** , инструкция SQL, хранимая процедура, имя таблицы, URL-адрес или полное имя пути к файлу. Если *Source* — это имя пути к файлу, это может быть полный путь ("c:\\dir\\. RST"), относительный путь (".. \\файл. RST ") или URL-адрес ("https://files/file.rst").

Не рекомендуется использовать аргумент *Source* метода **Open** для выполнения запроса на изменение, не возвращающего записи, так как не существует простого способа определить, успешно ли выполнен вызов. **Набор записей** , возвращенный таким запросом, будет закрыт. Вызовите метод [EXECUTE](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) объекта **Command** или метод [EXECUTE](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) объекта **Connection** вместо того, чтобы выполнить запрос, например инструкцию SQL INSERT, которая не возвращает записи.

Аргумент *ActiveConnection* соответствует свойству [ActiveConnection](activeconnection-property-ado.md) и указывает, в каком подключении следует открыть объект **Recordset** . Если вы передаете определение подключения для этого аргумента, ADO открывает новое подключение, используя указанные параметры. После открытия объекта **Recordset** с помощью клиентского курсора (**CursorLocation** = **адусеклиент**) можно изменить значение этого свойства, чтобы отправить обновления другому поставщику. Кроме того, можно задать для этого свойства значение **Nothing** (в Microsoft Visual Basic) или null, чтобы отключить объект **Recordset** от любого поставщика. Однако при изменении **ActiveConnection** для курсора на стороне сервера возникает ошибка.

Для других аргументов, которые соответствуют непосредственно свойствам объекта **Recordset** (*Source*, *CursorType*и *LockType*), отношение аргументов к свойствам выглядит следующим образом:

- Свойство доступно для чтения и записи перед открытием объекта **Recordset** .

- Параметры свойства используются, если при выполнении метода **Open** не передаются соответствующие аргументы. При передаче аргумента он переопределяет соответствующий параметр свойства, а параметр свойства обновляется значением аргумента.

- После открытия объекта **Recordset** эти свойства становятся доступными только для чтения.

> [!NOTE]
> Свойство **ActiveConnection** доступно только для чтения для объектов **Recordset** , свойству [Source](source-property-ado-recordset.md) которых присвоено значение допустимого объекта **Command** , даже если объект **Recordset** не открыт.

Если передать объект **Command** в аргументе *Source* , а также передать аргумент *ActiveConnection* , возникает ошибка. Для свойства **ActiveConnection** объекта **Command** должен быть уже задан допустимый объект **подключения** или строка подключения.

Если вы передаете значение, отличное от объекта **Command** , в аргументе *Source* , можно использовать аргумент *Options* для оптимизации оценки *исходного* аргумента. Если аргумент *Options* не определен, может наблюдаться снижение производительности, так как ADO должен совершать вызовы поставщику, чтобы определить, является ли аргумент оператором SQL, хранимой процедурой, URL-адресом или именем таблицы. Если вы знаете, какой тип *источника* вы используете, задание аргумента *Options* указывает, что ADO будет переходить непосредственно к соответствующему коду. Если аргумент *Options* не отвечает типу *источника* , возникает ошибка.

Если передать объект **Stream** в аргументе *Source* , не следует передавать данные в другие аргументы. При этом будет выдаваться сообщение об ошибке. Сведения о **ActiveConnection** не сохраняются при открытии объекта **Recordset** из **потока**.

Значение по умолчанию для аргумента *Options* — **адкмдфиле** , если с **набором записей**не связано ни одно подключение. Как правило, это будет иметь место для сохраняемых объектов **Recordset** .

Если источник данных не возвращает записи, поставщик задает для свойств [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) **значение true**, а положение текущей записи — undefine. Вы по-прежнему можете добавлять новые данные в этот пустой объект **Recordset** , если это разрешено типом Cursor.

Выполнив операции над открытым объектом **Recordset** , используйте метод [Close](close-method-ado.md) для освобождения связанных системных ресурсов. При закрытии объекта его не удаляются из памяти; Вы можете изменить его параметры, а затем снова открыть его с помощью метода **Open** . Чтобы полностью удалить объект из памяти, присвойте переменной объекта значение *Nothing*.

Перед заданием свойства **ActiveConnection** вызовите метод **Open** без операндов, чтобы создать экземпляр объекта **Recordset** , созданного путем добавления полей в коллекцию полей **Recordset** [Fields](fields-collection-ado.md) .

Если для свойства [CursorLocation](cursorlocation-property-ado.md) задано значение **адусеклиент**, можно асинхронно получать строки одним из двух способов. Рекомендуемый метод — задать для *параметра* **адасинкфетч**. Кроме того, вы можете использовать динамическое свойство "Обработка асинхронных наборов строк" в коллекции [свойств](properties-collection-ado.md) , но связанные извлеченные события могут быть потеряны, если не задать для параметра **Options** значение **адасинкфетч**.

> [!NOTE]
> Фоновая загрузка в поставщике MS Remote поддерживается только с помощью параметра *Options* метода **Open** .

> [!NOTE]
> URL-адреса, использующие схему HTTP, автоматически будут вызывать [поставщик Microsoft OLE DB для публикации в Интернете](microsoft-ole-db-provider-for-internet-publishing.md). Для получения дополнительных сведений см [абсолютные и относительные URL-адреса](absolute-and-relative-urls.md).



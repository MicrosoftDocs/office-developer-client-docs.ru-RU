---
title: Метод Open (объект Recordset ADO)
TOCTitle: Open method (ADO Recordset)
ms:assetid: 87ef19a4-28e1-dec7-ed33-4ae500b9c460
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249591(v=office.15)
ms:contentKeyID: 48546119
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e5f8dbdfa61a671e2efb9aac2596cfda5cd1727b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288408"
---
# <a name="open-method-ado-recordset"></a>Метод Open (объект Recordset ADO)

**Область применения**: Access 2013, Office 2013

Открывает курсор.

## <a name="syntax"></a>Синтаксис

*recordset*. Open *Source,* *ActiveConnection,* *CursorType,* *LockType*, *Options*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Source* |Необязательный параметр. Вариант, который оценивает допустимый объект [Command,](command-object-ado.md) SQL, имя таблицы, хранимый вызов процедуры, URL-адрес или имя файла или объекта [Stream,](stream-object-ado.md) содержащего постоянно хранимый набор  [записей.](recordset-object-ado.md)|
|*ActiveConnection* |Необязательный параметр. Переменная **Variant,** которая оценивается как допустимый имя переменной [объекта Connection,](connection-object-ado.md) или **строка,** [содержающая параметры ConnectionString.](connectionstring-property-ado.md)|
|*CursorType* |Необязательный параметр. Значение [CursorTypeEnum,](cursortypeenum.md) которое определяет тип курсора, который поставщик должен использовать при открытии **recordset.** Значение по умолчанию **— adOpenForwardOnly.**|
|*LockType* |Необязательный параметр. Значение [LockTypeEnum,](locktypeenum.md) которое определяет, какой тип блокировки (concurrency) должен использовать поставщик при открытии **recordset.** Значение по умолчанию **— adLockReadOnly.**|
|*Options* |Необязательный параметр. **Длинное** значение, которое указывает, как поставщик должен оценить аргумент *Source,* если он представляет что-то, кроме объекта **Command,** или что набор **recordset** следует восстановить из файла, в котором он был ранее сохранен. Может иметь одно или несколько [значений CommandTypeEnum](commandtypeenum.md) или [ExecuteOptionEnum,](executeoptionenum.md) которые можно объединить с по битовой стрелкой и оператором.|

> [!NOTE]
> Если открыть  набор записей  из потока, содержащего сохраняемого **recordset,** использование значения **ExecuteOptionEnum** **adAsyncFetchNonBlocking** не даст эффекта; извлечение будет синхронным и блокированием.

Значения **ExecuteOpenEnum** **adExecuteNoRecords** или **adExecuteStream** не следует использовать с **Open.**

## <a name="remarks"></a>Заметки

Курсор по умолчанию для ADO **Recordset** — это курсор только для чтения, расположенный на сервере.

Использование метода **Open** в **объекте Recordset** открывает курсор, который представляет записи из базовой таблицы, результатов запроса или ранее сохраненного объекта **Recordset.**

Используйте необязательный аргумент *Source,* чтобы указать источник данных с помощью одной из следующих переменных: переменной объекта **Command,** SQL, хранимой процедуры, имени таблицы, URL-адреса или полного имени пути к файлу. Если *source* — это имя пути к файлу, это может быть полный путь ("c: \\ dir \\ file.rst"), относительный путь (".. \\ file.rst) или URL-адрес (" https://files/file.rst ").

Не стоит использовать аргумент *Source* метода **Open** для выполнения запроса на действие, которое не возвращает записи, так как нет простого способа определить, был ли вызов выполнен успешно. Набор **записей,** возвращенный таким запросом, будет закрыт. Вызовите метод [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) объекта **Command** или [метод Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-connection) объекта **Connection,** чтобы выполнить запрос, который, например, SQL INSERT, не возвращает записи.

Аргумент *ActiveConnection* соответствует свойству [ActiveConnection](activeconnection-property-ado.md) и указывает, в котором необходимо открыть **объект Recordset.** Если передать определение подключения для этого аргумента, ADO открывает новое подключение с использованием указанных параметров. После открытия **объекта Recordset** с помощью клиентского курсора (**CursorLocation**  =  **adUseClient)** можно изменить значение этого свойства, чтобы отправлять обновления другому поставщику. Или можно установить для этого свойства свойство **Nothing** (в Microsoft Visual Basic) или NULL, чтобы отключить **recordset** от любого поставщика. Однако при **изменении ActiveConnection** для курсора на стороне сервера создается ошибка.

Для других аргументов, которые непосредственно соответствуют свойствам объекта **Recordset** (*Source,* *CursorType* и *LockType),* связь аргументов со свойствами будет следующим:

- Свойство считывать и записывать перед открытием объекта **Recordset.**

- Параметры свойств используются, если вы не передаете соответствующие аргументы при выполнении метода **Open.** Если передать аргумент, он переопределит соответствующий параметр свойства, и параметр свойства будет обновлен с помощью значения аргумента.

- После открытия объекта **Recordset** эти свойства становятся только для чтения.

> [!NOTE]
> Свойство **ActiveConnection** считчито только для объектов **Recordset,** свойство [Source](source-property-ado-recordset.md) которых имеет допустимый объект **Command,** даже если объект **Recordset** не открыт.

Если передать объект **Command** в *аргументе Source,* а также передать аргумент *ActiveConnection,* произойдет ошибка. Для **свойства ActiveConnection** объекта **Command** необходимо установить допустимый объект **Connection** или строку подключения.

Если в аргументе Source передается  что-то, кроме объекта **Command,** вы можете использовать аргумент *Options* для оптимизации оценки *аргумента Source.* Если аргумент *Options* не определен, производительность может снизиться, так как ADO должен звонить поставщику, чтобы определить, является ли аргумент оператором SQL, хранимой процедурой, URL-адресом или именем таблицы. Если вы *знаете,* какой тип источника вы используете, установка аргумента *Options* дает ADO указание перейти непосредственно к соответствующему коду. Если аргумент *Options* не соответствует типу *source,* возникает ошибка.

Если передать объект **Stream** в *аргументе Source,* не следует передавать сведения в другие аргументы. При этом будет выявить ошибку. Данные **ActiveConnection** не сохраняются при открытом наборе **записей** из **потока.**

Значение по умолчанию для *аргумента Options* **— adCmdFile,** если с набором **записей** не связано подключение. Обычно это касается постоянно хранимых объектов **Recordset.**

Если источник данных не возвращает записей, поставщик устанавливает свойства [BOF](bof-eof-properties-ado.md) и [EOF](bof-eof-properties-ado.md) в **true,** а текущая позиция записи не задана. Вы по-прежнему можете добавлять новые данные в этот пустой **объект Recordset,** если это допускается типом курсора.

После того как вы завершили операции с открытым объектом **Recordset,** используйте метод [Close,](close-method-ado.md) чтобы освободить все связанные системные ресурсы. Закрытие объекта не удаляет его из памяти; Вы можете изменить его параметры свойств и использовать метод **Open,** чтобы открыть его позже. Чтобы полностью исключить объект из памяти, установите для объектной переменной значение *Nothing.*

Перед тем как задано  свойство **ActiveConnection,** вызовите open  без операнда, чтобы создать экземпляр набора записей, созданного путем подключения полей к коллекции **полей набора** [записей.](fields-collection-ado.md)

Если для свойства [CursorLocation](cursorlocation-property-ado.md) установлено свойство **adUseClient,** вы можете получить строки асинхронно одним из двух способов. Рекомендуемый метод — установить *параметры* **adAsyncFetch.** Кроме того, можно использовать динамическое свойство "Asynchronous Rowset Processing" в коллекции [Properties,](properties-collection-ado.md) но связанные полученные события могут быть потеряны, если не установить для параметра **Options** параметр **adAsyncFetch**.

> [!NOTE]
> Фоновое извлечение данных в удаленном поставщике MS поддерживается только с помощью параметра **Options** метода *Open.*

> [!NOTE]
> URL-адреса, использующие схему HTTP, автоматически вызывают поставщика [Microsoft OLE DB для интернет-публикации.](microsoft-ole-db-provider-for-internet-publishing.md) Дополнительные сведения см. в [сведениях об абсолютных и относительных URL-адресах.](absolute-and-relative-urls.md)



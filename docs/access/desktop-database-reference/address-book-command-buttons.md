---
title: Кнопки адресной книги
TOCTitle: Address Book command buttons
ms:assetid: bcea6f53-3e36-b067-03c2-b157ed02d41d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249908(v=office.15)
ms:contentKeyID: 48547422
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 09f2513a3c541c76352e773f7f2a8f0c24f78850
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282480"
---
# <a name="address-book-command-buttons"></a>Кнопки адресной книги


**Область применения**: Access 2013, Office 2013


Приложение адресной книги содержит следующие командные кнопки:

- Кнопка " **найти** " для отправки запроса в базу данных.

- Кнопка **clear** , позволяющая очистить текстовые поля перед началом нового поиска.

- Кнопка **обновления профиля** для сохранения изменений в записи сотрудника.

- Кнопка **отменить изменения** , чтобы отменить изменения.

## <a name="find-button"></a>Кнопка "найти"

При нажатии кнопки **найти** активируется процедура поиска\_OnClick для VBScript, которая создает и отправляет запрос SQL. Нажатие этой кнопки заполняет сетку данных.

## <a name="building-the-sql-query"></a>Создание SQL запроса

В первой части процедуры поиска\_OnClick подписывается запрос SQL, по одной фразе с добавлением текстовых строк в глобальную инструкцию SQL SELECT. Она начинается с присвоения переменной инструкции SQL SELECT, которая запрашивает все строки данных из таблицы источника данных. Затем процедура Sub проверяет каждое из четырех полей ввода на странице.

Так как программа использует Word при создании инструкций SQL, запросы представляют собой поиск подстрок, а не точные совпадения.

Например, если поле **Last Name** содержит запись "Берже", а поле **Title** содержит запись "Диспетчер программ", инструкция SQL (значение) будет считаться следующим:

```vb 
 
Select FirstName, LastName, Title, Email, Building, Room, Phone from Employee where lastname like 'Berge%' and title like 'Program Manager%' 
```

Если запрос выполнен успешно, все лица с последним именем "Берже" (например, Берже и Бержер) и с заголовком, содержащим слова "Диспетчер программ" (например, диспетчер программ, дополнительные технологии), отображаются в сетке данных HTML.

## <a name="preparing-and-sending-the-query"></a>Подготовка и отправка запроса

Последняя часть процедуры поиска\_OnClick состоит из двух операторов. Первый оператор присваивает свойство SQL объекта RDS. Объект управления объектом, равный динамически созданному SQL запросу. Второй оператор вызывает **RDS. Объект DataObject** () для запроса к базе данных и отображения новых результатов запроса в сетке.

```vb 
 
Sub Find_OnClick 
 '... 
 DC1.SQL = myQuery 
 DC1.Refresh 
End Sub 
```

## <a name="update-profile-button"></a>Кнопка "Обновить профиль"

При нажатии кнопки **Обновить профиль** активируется процедура OnClick обновления\_VBScript, в которой выполняется RDS. Методы SubmitChanges и Refresh объекта DataObject ().

```vb 
 
Sub Update_OnClick 
 DC1.SubmitChanges 
 DC1.Refresh 
End Sub 
```

Когда DC1. SubmitChanges выполняет, удаленная служба данных упаковывает все сведения об обновлении и отправляет их на сервер через HTTP. Обновление все-или-нет; Если часть обновления завершается неудачно, никакие изменения не вносятся и возвращается сообщение о состоянии. выполняется, удаленная служба данных упаковывает все сведения об обновлении и отправляет их на сервер через HTTP. Обновление все-или-нет; Если часть обновления завершается неудачно, никакие изменения не вносятся и возвращается сообщение о состоянии. DC1. Обновление не требуется после **SubmitChanges** с удаленной службой данных, но гарантирует актуальность данных.

## <a name="cancel-changes-button"></a>Кнопка отмены изменений

При нажатии кнопки **Отмена изменений** активируется\_процедура отмены OnClick для VBScript, в которой выполняется RDS. Метод CancelUpdate объекта DataObject.

```vb 
 
Sub Cancel_OnClick 
 DC1.CancelUpdate 
End Sub 
```

При выполнении он отменяет любые изменения, внесенные пользователем в запись сотрудника в сетке данных с момента последнего запроса или обновления. Он восстанавливает исходные значения.


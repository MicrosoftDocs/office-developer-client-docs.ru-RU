---
title: Кнопки адресной книги
TOCTitle: Address Book command buttons
ms:assetid: bcea6f53-3e36-b067-03c2-b157ed02d41d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249908(v=office.15)
ms:contentKeyID: 48547422
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 09f2513a3c541c76352e773f7f2a8f0c24f78850
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282480"
---
# <a name="address-book-command-buttons"></a>Кнопки адресной книги


**Область применения**: Access 2013, Office 2013


Приложение адресной книги включает следующие кнопки команд:

- **Кнопка** "Найти" для отправки запроса в базу данных.

- Кнопка **"Очистить"** для очистки текстовых полей перед началом нового поиска.

- Кнопка **"Обновить профиль"** для сохранения изменений в записи сотрудника.

- Кнопка **отмены изменений** для отмены изменений.

## <a name="find-button"></a>Кнопка "Найти"

**Нажатие** кнопки "Найти" активирует процедуру VBScript Find OnClick Sub, которая создает и отправляет SQL \_ запроса. Нажатие этой кнопки заполняет сетку данных.

## <a name="building-the-sql-query"></a>Создание SQL запроса

Первая часть процедуры Find OnClick Sub создает запрос SQL по одной фразе за раз, привнося текстовые строки в глобальный SQL \_ SELECT. Она начинается с установки переменной SQL SELECT, которая запрашивает все строки данных из таблицы источника данных. Затем процедура Sub сканирует каждое из четырех полей ввода на странице.

Поскольку программа использует слово при создании SQL, запросы — это поиск подстроки, а не точные совпадения.

Например, если  поле "Фамилия" содержало запись "Berge", а поле "Заголовок" содержало запись "Program Manager", SQL (значение) будет читать: 

```vb 
 
Select FirstName, LastName, Title, Email, Building, Room, Phone from Employee where lastname like 'Berge%' and title like 'Program Manager%' 
```

В случае успешного выполнения запроса все люди с фамилией, содержащей текст "Berge" (например, Berge и Berger) и заголовком, содержащим слова "Program Manager" (например, Program Manager, Advanced Technologies), отображаются в сетке данных HTML.

## <a name="preparing-and-sending-the-query"></a>Подготовка и отправка запроса

Последняя часть процедуры Find \_ OnClick Sub состоит из двух заявлений. Первый выписка назначает SQL RDS. Объект DataControl, равный динамически SQL запросу. Вторая выписка вызывает **RDS. Объект DataControl** () для запроса базы данных и отображения новых результатов запроса в сетке.

```vb 
 
Sub Find_OnClick 
 '... 
 DC1.SQL = myQuery 
 DC1.Refresh 
End Sub 
```

## <a name="update-profile-button"></a>Кнопка обновления профиля

Нажатие **кнопки "Обновить профиль"** активирует процедуру ВУП обновления VBScript OnClick, которая выполняет \_ RDS. Методы SubmitChanges и Refresh объекта DataControl.

```vb 
 
Sub Update_OnClick 
 DC1.SubmitChanges 
 DC1.Refresh 
End Sub 
```

Когда DC1. SubmitChanges выполняется, удаленная служба данных упаковывает все сведения об обновлении и отправляет их на сервер по протоколу HTTP. Обновление является "все или ничего"; Если часть обновления не выполнена, никакие изменения не вносяся, и возвращается сообщение о состоянии. выполняется, удаленная служба данных упаковывает все сведения об обновлении и отправляет их на сервер по протоколу HTTP. Обновление является "все или ничего"; Если часть обновления не выполнена, никакие изменения не вносяся, и возвращается сообщение о состоянии. DC1. Обновление не требуется после **submitChanges** с удаленной службой данных, но обеспечивает новые данные.

## <a name="cancel-changes-button"></a>Кнопка отмены изменений

**Нажатие кнопки "Отмена** изменений" активирует процедуру VBScript Cancel \_ OnClick Sub, которая выполняет RDS. Объект DataControl ( Метод CancelUpdate.

```vb 
 
Sub Cancel_OnClick 
 DC1.CancelUpdate 
End Sub 
```

При выполнении он удаляет все изменения, которые пользователь внес в запись сотрудника в сетке данных с момента последнего запроса или обновления. Он восстанавливает исходные значения.


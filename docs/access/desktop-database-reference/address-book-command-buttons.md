---
title: Кнопки адресной книги
TOCTitle: Address Book command buttons
ms:assetid: bcea6f53-3e36-b067-03c2-b157ed02d41d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249908(v=office.15)
ms:contentKeyID: 48547422
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 09f2513a3c541c76352e773f7f2a8f0c24f78850
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282480"
---
# <a name="address-book-command-buttons"></a>Кнопки адресной книги


**Область применения**: Access 2013, Office 2013


Приложение Адресная книга содержит следующие кнопки команд:

- Кнопка **Найти** для отправки запроса в базу данных.

- Кнопка **Clear** для очистки текстовых полей перед началом нового поиска.

- Кнопка **Update Profile** для сохранения изменений в записи сотрудников.

- Кнопка **Отмена изменений,** чтобы отменить изменения.

## <a name="find-button"></a>Найдите кнопку

Нажав **кнопку Найти,** активирует процедуру VBScript Find OnClick Sub, которая создает и отправляет \_ SQL запрос. Нажатие этой кнопки заполняет сетку данных.

## <a name="building-the-sql-query"></a>Создание SQL запроса

В первой части процедуры Найти onClick Sub создается запрос SQL, одна фраза за раз, путем примещения текстовых строк к общему заявлению \_ SQL SELECT. Она начинается с настройки переменной в SQL SELECT, запрашивает все строки данных из таблицы источников данных. Далее процедура Sub сканирует каждый из четырех входных полей на странице.

Так как программа использует слово при создании SQL, запросы являются подстройки поиска, а не точные совпадения.

Например, если  в поле Фамилия содержится запись "Berge", а в поле **Title** содержится запись "Менеджер программы", в SQL (значение ) будет прочитано:

```vb 
 
Select FirstName, LastName, Title, Email, Building, Room, Phone from Employee where lastname like 'Berge%' and title like 'Program Manager%' 
```

Если запрос был успешным, все лица с фамилией, содержащей текст "Berge" (например, Berge и Berger) и с заголовком, содержащим слова "Менеджер программы" (например, Менеджер программы, Расширенные технологии) отображаются в htmL-сетке данных.

## <a name="preparing-and-sending-the-query"></a>Подготовка и отправка запроса

Последняя часть процедуры Find \_ OnClick Sub состоит из двух заявлений. Первое утверждение назначает SQL свойства RDS. Объект DataControl равен динамически построенной SQL запросу. Второе утверждение вызывает **RDS. Объект DataControl** () для запроса базы данных и отображения новых результатов запроса в сетке.

```vb 
 
Sub Find_OnClick 
 '... 
 DC1.SQL = myQuery 
 DC1.Refresh 
End Sub 
```

## <a name="update-profile-button"></a>Кнопка обновления профиля

Нажав **кнопку "Профиль** обновления", активирует процедуру обновления VBScript OnClick Sub, которая выполняет \_ RDS. Методы отправки и обновления объекта DataControl.

```vb 
 
Sub Update_OnClick 
 DC1.SubmitChanges 
 DC1.Refresh 
End Sub 
```

Когда DC1. SubmitChanges выполняется, служба удаленных данных упаковывает всю информацию об обновлении и отправляет ее на сервер через HTTP. Обновление является все или ничего; если часть обновления не выполнена, ни одно из изменений не выполнено, и сообщение о состоянии возвращается. выполняется, служба удаленных данных упаковывает всю информацию об обновлении и отправляет ее на сервер через HTTP. Обновление является все или ничего; если часть обновления не выполнена, ни одно из изменений не выполнено, и сообщение о состоянии возвращается. DC1. Обновление не требуется после **SubmitChanges** с удаленной службой данных, но оно обеспечивает свежие данные.

## <a name="cancel-changes-button"></a>Кнопка Отмена изменений

**Щелкнув кнопку Отмена** изменений, активирует процедуру отмены onClick Sub VBScript, которая \_ выполняет RDS. Объект DataControl (Метод CancelUpdate.

```vb 
 
Sub Cancel_OnClick 
 DC1.CancelUpdate 
End Sub 
```

При выполнении он удаляет все изменения, которые пользователь внес в запись сотрудника в сетке данных после последнего запроса или обновления. Восстанавливает исходные значения.


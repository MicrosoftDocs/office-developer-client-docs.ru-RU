---
title: Абсолютные и относительные URL-адреса
TOCTitle: Absolute and relative URLs
ms:assetid: 79a1f793-7154-1c13-7dfe-a1b8cd64e1ea
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249501(v=office.15)
ms:contentKeyID: 48545774
ms.date: 10/17/2018
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a488617dc7ba0d7d1f7e38391f8382fa1e7ed247
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282103"
---
# <a name="absolute-and-relative-urls"></a>Абсолютные и относительные URL-адреса

**Область применения**: Access 2013, Office 2013    

URL-адрес указывает расположение целевого объекта, хранящегося на локальном или сетевом компьютере, например файл, каталог, HTML-страница, изображение, программа и т. д. В этом обсуждении *абсолютНЫЙ URL-адрес* имеет вид:

*Scheme://Server/Path/Resource*

где:

|Имя |Описание|
|:----|:----------|
|*Схема*|Указывает способ доступа ** к ресурсу.|
|*server*|Указывает имя компьютера, на котором расположен *ресурс* .|
|*контура*|Указывает последовательность каталогов, ведущих к целевому элементу. Если *ресурс* не указан, целевым каталогом является последний каталог в *пути*.|
|*resource*|Если этот параметр включен, *ресурс* является целевым и обычно является именем файла. Это может быть *простой файл*, содержащий один двоичный поток байтов или *структурированный документ*, содержащий одно или несколько запоминающих устройств и двоичных потоков байтов.|

*АбсолютНЫЙ URL-адрес* содержит все сведения, необходимые для обнаружения ресурса.

Относительный *URL-адрес* определяет расположение ресурса, используя абсолютный URL-адрес в качестве отправной точки. По сути, "полный URL-адрес" целевого объекта указывается путем сцепления абсолютных и относительных URL-адресов. Относительный URL-адрес обычно состоит только из *пути*и (необязательно) *ресурса*, но без *схемы* или *сервера*.

## <a name="url-scheme-registration"></a>Регистрация схемы URL-адресов

Если поставщик поддерживает URL-адреса, он будет регистрироваться для одной или нескольких схем URL-адресов. Это означает, что любой URL-адрес, использующий эту схему, автоматически вызывает зарегистрированного поставщика. Например, схема *http* регистрируется в [ПОСТАВЩИКЕ Microsoft OLE DB для публикации в Интернете](microsoft-ole-db-provider-for-internet-publishing.md). В ADO предполагается, что все URL-адреса имеют префикс "http", представляющие собой веб-папки или файлы, которые должны использоваться у поставщика публикации в Интернете. Для получения сведений о схемах, зарегистрированных поставщиком, обратитесь к документации поставщика.

## <a name="defining-context-with-a-url"></a>Определение контекста с URL-АДРЕСом

Одной из функций открытого подключения, представленного объектом [Connection](connection-object-ado.md) , является ограничение последующих операций для источника данных, представленного этим подключением. То есть соединение определяет контекст для последующих операций.

При использовании ADO 2,5 абсолютный URL-адрес может также определять контекст. Например, когда объект [Record](record-object-ado.md) открыт с АБСОЛЮТНЫМ URL-адресом, объект **Connection** неявно создается для представления ресурса, УКАЗАННОГО с помощью URL-адреса.

Абсолютный URL-адрес, определяющий контекст, может быть указан в параметре *ActiveConnection* метода [Open](open-method-ado-record.md) объекта **Record** . Абсолютный `URL=` URL-адрес также может быть указан в качестве значения ключевого слова New в параметре Open ** метода [Open](open-method-ado-connection.md) объекта **Connection** , а метод [Open](open-method-ado-recordset.md) объекта [Recordset](recordset-object-ado.md) *ActiveConnection* параметр.

Контекст также может быть определен с помощью открытого элемента **записи** или объекта **Recordset** , представляющего каталог, так как у этих объектов уже есть неявно или явно объявленный объект **Connection** , задающий контекст.

## <a name="scoped-operations"></a>Операции с областями

Контекст одновременно определяет *область*(то есть каталог и его подкаталоги, которые могут участвовать в последующих операциях). Объект **Record** содержит несколько методов с областью действия, в том числе [CopyRecord](copyrecord-method-ado.md), [MoveRecord](moverecord-method-ado.md)и [DeleteRecord](deleterecord-method-ado.md), которые работают с каталогом и всеми его подкаталогами.

## <a name="relative-urls-as-command-text"></a>ОтНосительные URL-адреса в виде текста команды

Строка, определяющая команду, выполняемую для источника данных, может быть указана в параметре **EXECUTE** объекта **Connection** для метода *CommandText* и параметру *Source* объекта **Recordset** **Open** метода.

В параметре *CommandText* или *Source* можно указать относительный URL-адрес. Относительный URL-адрес фактически не указывает команду (например, команду SQL); Он просто задается в этих параметрах. Кроме того, контекст активного подключения должен быть абсолютным URL-АДРЕСом, а параметр *Option* должен иметь значение **адкмдтабледирект**.

Например, в файле Readme25. txt каталога winnt/system32 можно открыть объект **Recordset** следующим образом:

```vb
recordset.Open "system32/Readme25.txt", "URL=https://YourServer/Winnt/",,,adCmdTableDirect 
```

Абсолютный URL-адрес в строке подключения указывает сервер (Йоурсервер) и путь (Winnt). Этот URL-адрес также определяет контекст.

Относительный URL-адрес в тексте команды использует абсолютный URL-адрес в качестве начальной точки и указывает оставшуюся часть пути (System32) и открываемый файл (Readme25. txt).

Поле Options указывает на то, что тип команды — это относительный URL-адрес.

Другой пример: следующий код открывает объект **Recordset** для содержимого каталога:

```vb
recordset.Open "", "URL=https://YourServer/Winnt/",,,adCmdTableDirect 
```

## <a name="ole-db-provider-supplied-url-schemes"></a>Схемы URL-адресов, предоставленные поставщиком OLE DB

Ведущие часть полного URL-адреса — это *схема* , используемая для доступа к ресурсу, который определяется оставшейся частью URL-адреса. Примерами могут быть HTTP (протокол передачи гипертекста) и FTP (протокол передачи файлов).

ADO поддерживает поставщиков OLE DB, распознающих собственные схемы URL-адресов. Например, [поставщик Microsoft OLE DB для публикации в Интернете](microsoft-ole-db-provider-for-internet-publishing.md), который получает доступ к опубликованным файлам Windows 2000, распознает СУЩЕСТВУЮЩУЮ схему HTTP.


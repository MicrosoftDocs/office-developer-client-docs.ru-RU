---
title: Макрокоманда FindRecord
TOCTitle: FindRecord macro action
ms:assetid: 379e3dda-cb7d-a294-29b1-c6ce9a62ba8a
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192494(v=office.15)
ms:contentKeyID: 48544199
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm7496
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: 086993095daef3ff4ad87aed9f572a09124a9d31
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292378"
---
# <a name="findrecord-macro-action"></a>Макрокоманда FindRecord

**Область применения**: Access 2013, Office 2013

С помощью действия **FindRecord** можно найти первый экземпляр данных, который соответствует критериям, заданным аргументами **FindRecord.** Эти данные могут быть в текущей записи, в успешной или предыдущей записи или в первой записи. Записи можно найти в таблице активных таблиц, таблицах данных запросов, таблицах форм или формах.

## <a name="setting"></a>Setting

Действие **FindRecord** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Найти</strong></p></td>
<td><p>Указывает данные, которые необходимо найти в записи. Введите текст, номер или дату, которую вы хотите найти, или введите выражение, перед которым стоит знак равного (), в поле "Найти что" в разделе "Аргументы действий" области построитель <strong>=</strong> макроса. <strong></strong> <strong></strong> Можно использовать поддиаными знаками. Это обязательный аргумент.</p></td>
</tr>
<tr class="even">
<td><p><strong>Match</strong></p></td>
<td><p>Указывает, где находятся данные в поле. Вы можете указать поиск данных в любой<strong></strong>части поля (любая часть поля) для данных, заполнять все поле<strong>(целое</strong>поле) или данные, расположенные в начале поля (начало<strong>поля).</strong> Значение по умолчанию — <strong>"Целое поле".</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>Учитывать регистр</strong></p></td>
<td><p>Указывает, является ли поиск чувствительным к делу. Нажмите <strong>кнопку "Да"</strong> (проведение поиска с конфиденциальным регистром) или <strong>"Нет"</strong> (поиск без точного совпадения верхних и нижних регистров). По умолчанию используется значение <strong>Нет</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Поиск</strong></p></td>
<td><p>Указывает, продолжается ли поиск от текущей записи до начала записей<strong>(вверх);</strong> вниз до конца записей (<strong>вниз);</strong> или вниз до конца записей, а затем от начала записей до текущей записи, поэтому поиск ведется для всех записей (<strong>All).</strong> Значение по умолчанию — <strong>All</strong>.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Поиск в формате</strong></p></td>
<td><p>Указывает, включает ли поиск форматированные данные. Нажмите кнопку "Да" <strong>(Microsoft Office</strong> Access 2007 выполняет поиск данных в том виде, в котором они отформатированы и отображаются в поле) или <strong>"Нет"</strong> (Access выполняет поиск данных в том виде, в котором они хранятся в базе данных, что не всегда так, как они отображаются). По умолчанию используется значение <strong>Нет</strong>. С помощью этой функции можно ограничить поиск данными в определенном формате. Например, нажмите кнопку <strong>"Да"</strong> и введите <strong>1234</strong> в аргументе <strong>"Найти</strong> что", чтобы найти значение 1234 в поле в формате, включив запятую. Нажмите <strong>кнопку</strong> "Нет", если нужно ввести <strong>1234</strong> для поиска данных в этом поле. Чтобы найти даты, нажмите кнопку <strong>"Да",</strong> чтобы найти дату точно так, как она отформатирована, например 08-07-2003. Если нажать <strong>кнопку "Нет",</strong>введите дату для аргумента <strong>"Найти</strong> какой" в формате, установленном в региональных параметрах панели управления Windows. Этот формат отображается в поле <strong>"Краткий формат даты"</strong> на вкладке <strong>"Дата"</strong> в региональных параметрах. Например, если <strong></strong> в поле "Краткий формат даты" установлено поле <strong>M/d/yyy,</strong>можно ввести 08.07.03, а Access найдет все записи в поле "Дата", соответствующие 8 июля 2003 г., независимо от формата этого поля.</p>
<p><strong>ПРИМЕЧАНИЕ.</strong>Аргумент <strong>"Поиск</strong> в формате" вступает в силу только в том случае, если текущее поле является привязанным, аргумент <strong>Match</strong> имеет состояние <strong>"Целое</strong>поле", <strong>аргументу Only Current Field</strong> — <strong>"Да",</strong>а аргументу <strong>Match Case</strong> — <strong>"Нет".</strong></p>
<p>Если для <strong>match Case</strong> <strong></strong> установлено <strong>"Да"</strong> или "Нет" только текущего <strong>поля,</strong>необходимо также установить для поля <strong>"Поиск в формате"</strong> <strong>"Да".</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>Только текущее поле</strong></p></td>
<td><p>Указывает, ограничивается ли поиск текущим полем в каждой записи или включает все поля в каждой записи. Поиск в текущем поле быстрее. Нажмите <strong>кнопку "Да"</strong> (ограничить поиск текущим полем) или <strong>"Нет"</strong> (поиск во всех полях каждой записи). Значение по умолчанию <strong>— Да.</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>Найти в первую очередь</strong></p></td>
<td><p>Указывает, начинается ли поиск с первой или текущей записи. Нажмите <strong>кнопку "Да"</strong> (начать с первой записи) или <strong>"Нет"</strong> (начать с текущей записи). Значение по умолчанию <strong>— Да.</strong></p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Заметки

Когда макрос выполняет действие **FindRecord,** Access выполняет поиск указанных данных в записях (порядок поиска определяется параметром аргумента **поиска).** Когда Access находит указанные данные, данные выбираются в записи.

Действие **FindRecord** эквивалентно нажатию  кнопки "Найти" на вкладке "Главная", а его аргументы такие же, как и у параметров в диалоговом окне "Найти и заменить".   Если вы установите **аргументы FindRecord** в области построитель макроса, а затем запустите  макрос, при нажатии кнопки "Найти" в диалоговом окне "Найти и заменить" будут выбраны соответствующие **параметры.**

Access сохраняет последние аргументы **FindRecord** во время сеанса базы данных, поэтому вам не нужно повторно вводить те же критерии, что и при выполнении последующих операций с действием **FindRecord.** Если оставить аргумент пустым, Access использует последний параметр для этого аргумента, задав его  в предыдущем действии **FindRecord** или в диалоговом окне "Найти и заменить".

Если требуется найти запись с помощью макроса, используйте действие **FindRecord,** а не **действие RunMenuCommand** с установленным аргументом для запуска команды **Find.**

> [!NOTE]
> Хотя действие **FindRecord** соответствует  команде "Найти" на вкладке "Главная" для таблиц, запросов и форм,  оно не соответствует команде "Найти" в меню "Правка" в окне "Код".   Действие **FindRecord** нельзя использовать для поиска текста в модулях.

Если выбранный в данный момент текст является тем же, что и текст поиска во время действия **FindRecord,** поиск начинается сразу после выделения в том же поле, что и выделение, и в той же записи. В противном случае поиск начинается с начала текущей записи. Это позволяет найти несколько экземпляров одного условия поиска, которые могут отображаться в одной записи.

Однако обратите внимание, что если вы используете кнопку для запуска макроса, содержащего действие **FindRecord,** первый экземпляр условия поиска будет найден несколько раз. Это происходит потому, что нажатие кнопки команды удаляет фокус из поля, содержащего совпадающее значение. Затем **действие FindRecord** начнет поиск с начала записи. Чтобы избежать этой проблемы, запустите макрос, используя метод, который не меняет фокус, например пользовательскую кнопку панели инструментов или сочетание клавиш, определенное в макросе AutoKeys, или установите фокус макроса на поле, содержащее условия поиска, перед тем как выполнять действие **FindRecord.**

<table>
<thead>
<tr class="header">
<th><img src="media/access-alert-security.gif" title="Заметка о безопасности" alt="Security note" /><strong>Заметка о безопасности</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Избегайте использования оператора <strong>SendKeys</strong> или макроса AutoKeys с конфиденциальной или секретной информацией. Злоумышленники могут выполнить перехват нажатий клавиш и нарушить безопасность компьютера и данных.</td>
</tr>
</tbody>
</table>

Такое же поведение происходит, если вы используете кнопку команды для запуска макроса, содержащего действие **FindNext.**

Чтобы запустить действие **FindRecord** в модуле Visual Basic для приложений (VBA), используйте метод **FindRecord** объекта **DoCmd.**

Для более сложного поиска можно использовать макрокомационную **макрокомакс SearchForRecord.**


---
title: Макрокоманда FindRecord
TOCTitle: FindRecord macro action
ms:assetid: 379e3dda-cb7d-a294-29b1-c6ce9a62ba8a
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192494(v=office.15)
ms:contentKeyID: 48544199
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm7496
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: 086993095daef3ff4ad87aed9f572a09124a9d31
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292378"
---
# <a name="findrecord-macro-action"></a>Макрокоманда FindRecord

**Область применения**: Access 2013, Office 2013

Вы можете использовать **действие FindRecord,** чтобы найти первый экземпляр данных, отвечающий критериям, указанным аргументами **FindRecord.** Эти данные могут быть в текущей записи, в успешной или предыдущей записи или в первой записи. Записи можно найти в таблице данных активной таблицы, таблице данных запросов, таблице данных форм или форме.

## <a name="setting"></a>Параметр

Действие **FindRecord имеет** следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Найти</strong></p></td>
<td><p>Указывает данные, которые необходимо найти в записи. Введите текст, номер или дату, которые необходимо найти или ввести выражение, которому предшествует равный знак (), в поле Find What в разделе Аргументы действий области <strong>=</strong> Macro Builder. <strong></strong> <strong></strong> Можно использовать символы под диктовки. Это обязательный аргумент.</p></td>
</tr>
<tr class="even">
<td><p><strong>Match</strong></p></td>
<td><p>Указывает, где находятся данные в поле. Можно указать поиск данных в любой части<strong></strong>поля (любая часть поля), для данных, заполняемой всем полем<strong>(Whole Field),</strong>или для данных, расположенных в начале поля<strong>(Начало поля).</strong> По умолчанию — <strong>целое поле.</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>Учитывать регистр</strong></p></td>
<td><p>Указывает, является ли поиск чувствительным к делу. Щелкните <strong>Да</strong> (проводите поиск, чувствительный к делу) или <strong>Нет</strong> (поиск без точного совпадения букв верхнего и нижнего шкафа). По умолчанию используется значение <strong>Нет</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Поиск</strong></p></td>
<td><p>Указывает, продолжается ли поиск от текущей записи до начала записей<strong>(Up);</strong> до конца записей<strong>(вниз);</strong> или до конца записей, а затем от начала записей до текущей записи, поэтому все записи будут искаться<strong>(Все).</strong> По умолчанию <strong>все</strong>.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Поиск в формате</strong></p></td>
<td><p>Указывает, включает ли поиск отформатированные данные. <strong>Щелкните</strong> Да (Microsoft Office Access 2007 выполняет поиск данных по мере их форматирований и отображения в поле) или <strong>Нет</strong> (Access ищет данные, хранимые в базе данных, которые не всегда отображаются). По умолчанию используется значение <strong>Нет</strong>. Эту функцию можно использовать для ограничения поиска данными в определенном формате. Например, нажмите кнопку <strong>Да</strong> и введите <strong>1234</strong> в аргументе <strong>Find What,</strong> чтобы найти значение 1234 в поле, отформатированный для включив запятые. Щелкните <strong>Нет,</strong> если вы хотите ввести <strong>1234</strong> для поиска данных в этом поле. Чтобы найти даты, щелкните <strong>Да,</strong> чтобы найти дату точно так, как она отформатирована, например 08-Июль-2003. При нажатии <strong>кнопки "Нет"</strong>введите дату аргумента <strong>Find What</strong> в формате, за набором региональных параметров в Windows панели управления. Этот формат показан в поле <strong>Формат коротких дат,</strong> найденном на вкладке <strong>Date</strong> в региональных параметрах. Например, если <strong></strong> поле формата "Короткие даты" заданной для <strong>M/d/yy,</strong>можно ввести 7/8/03, и Access найдет все записи в поле Date, соответствующие 8 июля 2003 г., независимо от формата этого поля.</p>
<p><strong>ПРИМЕЧАНИЕ.</strong>Аргумент Search <strong>As Formatted</strong> вступает в силу только <strong></strong> в том случае, если <strong></strong> текущее поле является связанным управлением, аргумент Match за набором для <strong>всего</strong>поля, только текущий аргумент поля засвещен <strong>да,</strong>а аргумент Match <strong>Case</strong> — <strong>нет</strong>.</p>
<p>Если вы установите <strong></strong> <strong>"Да"</strong> или "Только текущее поле" на <strong>"Нет",</strong>необходимо также установить <strong>"Поиск в формате</strong> <strong>да".</strong> <strong></strong></p></td>
</tr>
<tr class="even">
<td><p><strong>Только текущее поле</strong></p></td>
<td><p>Указывает, ограничивается ли поиск текущим полем в каждой записи или включает все поля в каждой записи. Поиск в текущем поле быстрее. Щелкните <strong>Да</strong> (ограничив поиск текущим полем) или <strong>Нет</strong> (поиск во всех полях каждой записи). По умолчанию — <strong>Да.</strong></p></td>
</tr>
<tr class="odd">
<td><p><strong>Найти первое</strong></p></td>
<td><p>Указывает, начинается ли поиск с первой записи или с текущей записи. Нажмите <strong>кнопку Да</strong> (начните с первой записи) или <strong>Нет</strong> (начните с текущей записи). По умолчанию — <strong>Да.</strong></p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

Когда макрос выполняет действие **FindRecord,** Access ищет указанные данные в записях (порядок поиска определяется параметром **аргумента Поиска).** Когда Access находит указанные данные, данные выбираются в записи.

Действие **FindRecord** эквивалентно нажатию Найдите на вкладке **Главная,** а его аргументы такие же, как и параметры в диалоговом окне Найти и **заменить.**  Если вы задайте **аргументы FindRecord** в области Macro Builder и запустите макрос,  вы увидите соответствующие параметры, выбранные в диалоговом окне Найти и заменить при нажатии кнопки **Найти**.

Доступ сохраняет последние аргументы **FindRecord** во время сеанса базы данных, чтобы вам не нужно вводить те же критерии, что и при выполнении последующих операций с действием **FindRecord.** Если оставить аргумент пустым, Access использует последний параметр аргумента, задав его в предыдущем действии **FindRecord** или в диалоговом окне Find **and Replace.**

Если вы хотите найти запись с помощью макроса, используйте действие **FindRecord,** а не **действие RunMenuCommand** с набором аргументов для запуска команды **Find.**

> [!NOTE]
> Хотя действие **FindRecord** соответствует команде **Find** на вкладке **Главная** для таблиц, запросов и форм,  оно не соответствует команде Найти в меню **Изменить** в окне Кода. Вы не можете использовать **действие FindRecord** для поиска текста в модулях.

Если выбранный в настоящее время текст является таким же, как текст поиска во время действия **FindRecord,** поиск начинается сразу после выбора в том же поле, что и выбор, и в той же записи. В противном случае поиск начинается в начале текущей записи. Это позволяет находить несколько экземпляров тех же критериев поиска, которые могут отображаться в одной записи.

Однако обратите внимание, что при использовании кнопки команды для запуска макроса, содержащего действие **FindRecord,** первый экземпляр критериев поиска будет найден повторно. Такое поведение возникает из-за того, что нажатие кнопки команды удаляет фокус из поля, содержащего совпадающее значение. Затем **действие FindRecord** начнет поиск с самого начала записи. Чтобы избежать этой проблемы, запустите макрос, используя метод, который не меняет фокус, например настраиваемую кнопку панели инструментов или комбинацию ключей, определенных в макросе AutoKeys, или установите фокус макроса на поле, содержащее критерии поиска, прежде чем выполнять действие **FindRecord.**

<table>
<thead>
<tr class="header">
<th><img src="media/access-alert-security.gif" title="Заметка о безопасности" alt="Security note" /><strong>Заметка о безопасности</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Избегайте использования оператора <strong>SendKeys</strong> или макроса AutoKeys с конфиденциальной или секретной информацией. Злоумышленники могут выполнить перехват нажатий клавиш и нарушить безопасность компьютера и данных.</td>
</tr>
</tbody>
</table>

Такое же поведение также происходит при использовании кнопки команды для запуска макроса, содержащего **действие FindNext.**

Чтобы выполнить **действие FindRecord** в модуле Visual Basic для приложений (VBA), используйте метод **FindRecord** объекта **DoCmd.**

Для более сложных поисков можно использовать макрос **SearchForRecord.**


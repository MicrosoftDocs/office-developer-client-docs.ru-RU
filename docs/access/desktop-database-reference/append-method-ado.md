---
title: Метод Append (ADO)
TOCTitle: Append method (ADO)
ms:assetid: cca133af-2b95-877d-0488-0d99631623f2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250014(v=office.15)
ms:contentKeyID: 48547742
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a85faf900860dabb809a10a92985559b7a7cf2ef
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32297132"
---
# <a name="append-method-ado"></a>Метод Append (ADO)

**Область применения**: Access 2013, Office 2013

Добавляет объект в коллекцию. Если коллекция является [полями](fields-collection-ado.md), новый объект [field](field-object-ado.md) можно создать перед добавлением в коллекцию.

## <a name="syntax"></a>Синтаксис

*коллекция*. Добавление *объекта*

*поля*. *Имя*для добавления, *Тип*, *DefinedSize*, *attrib*, *FieldValue*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*.* |Объект Collection.|
|*fields* |Коллекция **Fields** .|
|*object* |Объектная переменная, представляющая объект, который требуется добавить.|
|*имя* |**Строковое** значение, которое содержит имя нового объекта **field** и не должно совпадать с именем любого другого объекта в *полях*.|
|*Тип* |Значение [DataTypeEnum](datatypeenum.md) , для которого по умолчанию задано значение **адемпти**, указывающее тип данных нового поля. Следующие типы данных не поддерживаются в ADO, и их не следует использовать при добавлении новых полей в объект **Recordset**: **адидиспатч**, **адиункновн**, **адвариант**.|
|*DefinedSize* |Необязательное. **Длинное** значение, представляющее заданный размер (в символах или байтах) нового поля. Значение этого параметра по умолчанию является производным от *типа*. Поля с DefinedSize размером более 255 байт и рассматриваются как столбцы переменной длины. (Значение по умолчанию *DefinedSize* не задано.)|
|*Атрибут* |Необязательное. Значение [фиелдаттрибутинум](fieldattributeenum.md) , для которого по умолчанию задано значение **адфлддефаулт**, определяющее атрибуты для нового поля. Если это значение не указано, поле будет содержать атрибуты, производные от *типа*.|
|*FieldValue* |Необязательное. **Variant** , представляющий значение нового поля. Если этот параметр не указан, в поле добавляется значение null.|

## <a name="remarks"></a>Примечания

### <a name="parameters-collection"></a>Коллекция Parameters

Необходимо задать свойство [Type](type-property-ado.md) объекта [Parameter](parameter-object-ado.md) перед добавлением его в коллекцию **Parameters** . Если выбран тип данных переменной длины, необходимо также задать для свойства [size](size-property-ado.md) значение больше нуля.

Описание параметров самостоятельно сокращает число вызовов поставщика и, соответственно, повышает производительность при использовании хранимых процедур или параметризованных запросов. Тем не менее, необходимо знать свойства параметров, связанных с хранимой процедурой или параметризованным запросом, которые необходимо вызвать.

Используйте метод [CreateParameter](createparameter-method-ado.md) для создания объектов **Parameter** с соответствующими параметрами свойства и используйте метод **append** , чтобы добавить их в коллекцию [Parameters](parameters-collection-ado.md) . Это позволяет задавать и возвращать значения параметров, не выполняя вызов поставщика для сведений о параметре. При записи в поставщик, который не предоставляет сведения о параметрах, необходимо использовать этот метод, чтобы вручную заполнить коллекцию **Parameters** , чтобы использовать параметры вообще.

### <a name="fields-collection"></a>Коллекция Fields

Параметр *FieldValue* является допустимым только при добавлении объекта **field** в объект [Record](record-object-ado.md) , а не в объект **Recordset** . С помощью объекта **Record** вы можете добавлять поля и вводить значения одновременно. При наличии объекта **Recordset** необходимо создать поля, когда **набор записей** закрыт, затем открыть **набор записей** и присвоить значения полям.


> [!NOTE]
> Для новых объектов **field** , добавленных в коллекцию **Fields** объекта **Record** , свойство [value](value-property-ado.md) должно быть задано до того, как можно будет указать другие свойства **поля** . Во-первых, в коллекции **Fields** должно быть назначено и [Обновлено](update-method-ado.md) определенное значение свойства **value** . Затем можно получить доступ к другим свойствам, таким как [Type](type-property-ado.md) или [Attributes](attributes-property-ado.md) .


Объекты **field** из следующих типов данных (**DataTypeEnum**) не могут быть добавлены в коллекцию **Fields** и возникнет ошибка: **адаррай**, **адчаптер**, **адемпти**, **адпропвариант**и **адусердефинед**. Кроме того, ADO не поддерживает следующие типы данных: **адидиспатч**, **адиункновн**и **адивариант**. Для этих типов при добавлении ошибки не произойдет, но использование может привести к непредсказуемым результатам, включая утечки памяти.

### <a name="recordset"></a>Recordset

Если не задать свойство [CursorLocation](cursorlocation-property-ado.md) перед вызовом метода **append** , то для **CursorLocation** будет автоматически задано значение **адусеклиент** (значение [курсорлокатионенум](cursorlocationenum.md) ) при вызове метода [Open](open-method-ado-recordset.md) объекта [Recordset](recordset-object-ado.md) .

Если метод **append** вызывается для коллекции **Fields** открытого **набора записей**или для объекта **Recordset** , где было задано свойство [ActiveConnection](activeconnection-property-ado.md) , произойдет ошибка времени выполнения. Можно добавлять только поля в **набор записей** , который не открыт и еще не был подключен к источнику данных. Обычно это ситуация, когда объект **Recordset** создается с помощью метода [CreateRecordset](createrecordset-method-rds.md) или назначается объектной переменной.

### <a name="record"></a>Record

При вызове метода **append** для коллекции **Fields** открытой **записи**возникает ошибка времени выполнения. Новое поле будет добавлено в коллекцию **Fields** объекта **Record** . Если **запись** была получена из объекта **Recordset**, то новое поле не будет отображаться в коллекции **Fields** объекта **Recordset** .

Несуществующее поле можно создать и добавить в коллекцию **Fields** , назначив значение для объекта Field, как если бы оно уже существовало в коллекции. Назначение будет инициировать автоматическое создание и добавление объекта **field** , после чего назначение будет завершено.

После добавления **поля** в коллекцию **Fields** объекта **Record** вызовите метод **Update** коллекции **Fields** , чтобы сохранить изменения.


---
title: Метод Append (ADO)
TOCTitle: Append method (ADO)
ms:assetid: cca133af-2b95-877d-0488-0d99631623f2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250014(v=office.15)
ms:contentKeyID: 48547742
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a85faf900860dabb809a10a92985559b7a7cf2ef
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32297132"
---
# <a name="append-method-ado"></a><span data-ttu-id="110f9-102">Метод Append (ADO)</span><span class="sxs-lookup"><span data-stu-id="110f9-102">Append method (ADO)</span></span>

<span data-ttu-id="110f9-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="110f9-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="110f9-104">Привносимый объект в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="110f9-104">Appends an object to a collection.</span></span> <span data-ttu-id="110f9-105">Если коллекция является [Fields,](fields-collection-ado.md) [перед](field-object-ado.md) его приложением в коллекцию может быть создан новый объект Field.</span><span class="sxs-lookup"><span data-stu-id="110f9-105">If the collection is [Fields](fields-collection-ado.md), a new [Field](field-object-ado.md) object may be created before it is appended to the collection.</span></span>

## <a name="syntax"></a><span data-ttu-id="110f9-106">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="110f9-106">Syntax</span></span>

<span data-ttu-id="110f9-107">*collection*. Объект *Append*</span><span class="sxs-lookup"><span data-stu-id="110f9-107">*collection*.Append *object*</span></span>

<span data-ttu-id="110f9-108">*fields .* Имя *приложения,* *Тип,* *DefinedSize,* *Attrib,* *FieldValue*</span><span class="sxs-lookup"><span data-stu-id="110f9-108">*fields*.Append *Name*, *Type*, *DefinedSize*, *Attrib*, *FieldValue*</span></span>

## <a name="parameters"></a><span data-ttu-id="110f9-109">Параметры</span><span class="sxs-lookup"><span data-stu-id="110f9-109">Parameters</span></span>

|<span data-ttu-id="110f9-110">Параметр</span><span class="sxs-lookup"><span data-stu-id="110f9-110">Parameter</span></span>|<span data-ttu-id="110f9-111">Описание</span><span class="sxs-lookup"><span data-stu-id="110f9-111">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="110f9-112">*.*</span><span class="sxs-lookup"><span data-stu-id="110f9-112">*collection*</span></span> |<span data-ttu-id="110f9-113">Объект коллекции.</span><span class="sxs-lookup"><span data-stu-id="110f9-113">A collection object.</span></span>|
|<span data-ttu-id="110f9-114">*fields*</span><span class="sxs-lookup"><span data-stu-id="110f9-114">*fields*</span></span> |<span data-ttu-id="110f9-115">Коллекция **Fields.**</span><span class="sxs-lookup"><span data-stu-id="110f9-115">A **Fields** collection.</span></span>|
|<span data-ttu-id="110f9-116">*object*</span><span class="sxs-lookup"><span data-stu-id="110f9-116">*object*</span></span> |<span data-ttu-id="110f9-117">Объектная переменная, представляюная объект, который необходимо к этому объекту.</span><span class="sxs-lookup"><span data-stu-id="110f9-117">An object variable that represents the object to be appended.</span></span>|
|<span data-ttu-id="110f9-118">*Название*</span><span class="sxs-lookup"><span data-stu-id="110f9-118">*Name*</span></span> |<span data-ttu-id="110f9-119">**Строковая** строка, которая содержит имя нового объекта **Field** и не должна быть тем же именем, что и любой другой объект в *полях.*</span><span class="sxs-lookup"><span data-stu-id="110f9-119">A **String** value that contains the name of the new **Field** object, and must not be the same name as any other object in *fields*.</span></span>|
|<span data-ttu-id="110f9-120">*Тип*</span><span class="sxs-lookup"><span data-stu-id="110f9-120">*Type*</span></span> |<span data-ttu-id="110f9-121">Значение [DataTypeEnum,](datatypeenum.md) значение по умолчанию — **adEmpty,** которое указывает тип данных нового поля.</span><span class="sxs-lookup"><span data-stu-id="110f9-121">A [DataTypeEnum](datatypeenum.md) value, whose default value is **adEmpty**, that specifies the data type of the new field.</span></span> <span data-ttu-id="110f9-122">Следующие типы данных не поддерживаются ADO и не должны использоваться при подавке новых полей в **recordset:** **adIDispatch,** **adIUnknown,** **adVariant.**</span><span class="sxs-lookup"><span data-stu-id="110f9-122">The following data types are not supported by ADO, and should not be used when appending new fields to a **Recordset**: **adIDispatch**, **adIUnknown**, **adVariant**.</span></span>|
|<span data-ttu-id="110f9-123">*DefinedSize*</span><span class="sxs-lookup"><span data-stu-id="110f9-123">*DefinedSize*</span></span> |<span data-ttu-id="110f9-124">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="110f9-124">Optional.</span></span> <span data-ttu-id="110f9-125">**Длинное** значение, которое представляет определенный размер нового поля (в символах или в ветвях).</span><span class="sxs-lookup"><span data-stu-id="110f9-125">A **Long** value that represents the defined size, in characters or bytes, of the new field.</span></span> <span data-ttu-id="110f9-126">Значение по умолчанию для этого параметра является производным от *Type*.</span><span class="sxs-lookup"><span data-stu-id="110f9-126">The default value for this parameter is derived from *Type*.</span></span> <span data-ttu-id="110f9-127">Поля с значением DefinedSize больше 255 bytes и обрабатываются как столбцы переменной длины.</span><span class="sxs-lookup"><span data-stu-id="110f9-127">Fields with a DefinedSize greater than 255 bytes, and treated as variable length columns.</span></span> <span data-ttu-id="110f9-128">(Значение *по умолчанию DefinedSize* не определено.)</span><span class="sxs-lookup"><span data-stu-id="110f9-128">(The default *DefinedSize* is unspecified.)</span></span>|
|<span data-ttu-id="110f9-129">*Attrib*</span><span class="sxs-lookup"><span data-stu-id="110f9-129">*Attrib*</span></span> |<span data-ttu-id="110f9-130">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="110f9-130">Optional.</span></span> <span data-ttu-id="110f9-131">Значение [FieldAttributeEnum,](fieldattributeenum.md) значением по умолчанию которого является **adFldDefault,** которое указывает атрибуты для нового поля.</span><span class="sxs-lookup"><span data-stu-id="110f9-131">A [FieldAttributeEnum](fieldattributeenum.md) value, whose default value is **adFldDefault**, that specifies attributes for the new field.</span></span> <span data-ttu-id="110f9-132">Если это значение не указано, поле будет содержать атрибуты, производные от *Type.*</span><span class="sxs-lookup"><span data-stu-id="110f9-132">If this value is not specified, the field will contain attributes derived from *Type*.</span></span>|
|<span data-ttu-id="110f9-133">*FieldValue*</span><span class="sxs-lookup"><span data-stu-id="110f9-133">*FieldValue*</span></span> |<span data-ttu-id="110f9-134">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="110f9-134">Optional.</span></span> <span data-ttu-id="110f9-135">**Вариант,** который представляет значение для нового поля.</span><span class="sxs-lookup"><span data-stu-id="110f9-135">A **Variant** that represents the value for the new field.</span></span> <span data-ttu-id="110f9-136">Если значение не указано, к полю будет добавлено значение null.</span><span class="sxs-lookup"><span data-stu-id="110f9-136">If not specified, then the field is appended with a null value.</span></span>|

## <a name="remarks"></a><span data-ttu-id="110f9-137">Заметки</span><span class="sxs-lookup"><span data-stu-id="110f9-137">Remarks</span></span>

### <a name="parameters-collection"></a><span data-ttu-id="110f9-138">Коллекция Parameters</span><span class="sxs-lookup"><span data-stu-id="110f9-138">Parameters collection</span></span>

<span data-ttu-id="110f9-139">Перед его [](type-property-ado.md) приложением к коллекции [Parameters](parameter-object-ado.md) необходимо установить свойство Type объекта **Parameter.**</span><span class="sxs-lookup"><span data-stu-id="110f9-139">You must set the [Type](type-property-ado.md) property of a [Parameter](parameter-object-ado.md) object before appending it to the **Parameters** collection.</span></span> <span data-ttu-id="110f9-140">При выборе типа данных переменной длины необходимо также установить для свойства [Size](size-property-ado.md) значение больше нуля.</span><span class="sxs-lookup"><span data-stu-id="110f9-140">If you select a variable-length data type, you must also set the [Size](size-property-ado.md) property to a value greater than zero.</span></span>

<span data-ttu-id="110f9-141">Самостоятельное описание параметров минимизирует вызовы поставщика и, следовательно, повышает производительность при использовании хранимой процедуры или параметровизованного запроса.</span><span class="sxs-lookup"><span data-stu-id="110f9-141">Describing parameters yourself minimizes calls to the provider and consequently improves performance when using stored procedures or parameterized queries.</span></span> <span data-ttu-id="110f9-142">Однако необходимо знать свойства параметров, связанных с хранимой процедурой или параметризованный запрос, который требуется вызвать.</span><span class="sxs-lookup"><span data-stu-id="110f9-142">However, you must know the properties of the parameters associated with the stored procedure or parameterized query that you want to call.</span></span>

<span data-ttu-id="110f9-143">Используйте метод [CreateParameter](createparameter-method-ado.md) для создания объектов **Parameter** с соответствующими параметрами свойств и с помощью метода **Append** добавьте их в коллекцию [Parameters.](parameters-collection-ado.md)</span><span class="sxs-lookup"><span data-stu-id="110f9-143">Use the [CreateParameter](createparameter-method-ado.md) method to create **Parameter** objects with the appropriate property settings and use the **Append** method to add them to the [Parameters](parameters-collection-ado.md) collection.</span></span> <span data-ttu-id="110f9-144">Это позволяет устанавливать и возвращать значения параметров без вызова поставщика для сведений о параметре.</span><span class="sxs-lookup"><span data-stu-id="110f9-144">This lets you set and return parameter values without having to call the provider for the parameter information.</span></span> <span data-ttu-id="110f9-145">Если вы пишете поставщику, который не передает сведения о параметрах, необходимо использовать этот метод для заполнения коллекции **parameters** вручную, чтобы использовать параметры вообще.</span><span class="sxs-lookup"><span data-stu-id="110f9-145">If you are writing to a provider that does not supply parameter information, you must use this method to manually populate the **Parameters** collection in order to use parameters at all.</span></span>

### <a name="fields-collection"></a><span data-ttu-id="110f9-146">Коллекция Fields</span><span class="sxs-lookup"><span data-stu-id="110f9-146">Fields collection</span></span>

<span data-ttu-id="110f9-147">Параметр *FieldValue* действителен только при добавлении объекта **Field** к объекту [Record,](record-object-ado.md) а не **к объекту Recordset.**</span><span class="sxs-lookup"><span data-stu-id="110f9-147">The *FieldValue* parameter is only valid when adding a **Field** object to a [Record](record-object-ado.md) object, not to a **Recordset** object.</span></span> <span data-ttu-id="110f9-148">С помощью **объекта Record** можно одновременно дополировать поля и предоставить значения.</span><span class="sxs-lookup"><span data-stu-id="110f9-148">With a **Record** object, you may append fields and provide values at the same time.</span></span> <span data-ttu-id="110f9-149">С помощью **объекта Recordset** необходимо создать поля, когда набор **записей** закрыт, а затем открыть **набор** записей и назначить значения полям.</span><span class="sxs-lookup"><span data-stu-id="110f9-149">With a **Recordset** object, you must create fields while the **Recordset** is closed, then open the **Recordset** and assign values to the fields.</span></span>


> [!NOTE]
> <span data-ttu-id="110f9-150">Для новых объектов **Field,** которые были добавлены в коллекцию **Fields** объекта **Record,**  свойство [Value](value-property-ado.md) должно быть задано до того, как могут быть указаны другие свойства Field.</span><span class="sxs-lookup"><span data-stu-id="110f9-150">For new **Field** objects that have been appended to the **Fields** collection of a **Record** object, the [Value](value-property-ado.md) property must be set before any other **Field** properties can be specified.</span></span> <span data-ttu-id="110f9-151">Во-первых, должно быть назначено определенное [](update-method-ado.md) значение для свойства **Value** и вызвано обновление коллекции **Fields.**</span><span class="sxs-lookup"><span data-stu-id="110f9-151">First, a specific value for the **Value** property must have been assigned and [Update](update-method-ado.md) on the **Fields** collection called.</span></span> <span data-ttu-id="110f9-152">Затем можно получить доступ к другим свойствам, таким как [Type](type-property-ado.md) или [Attributes.](attributes-property-ado.md)</span><span class="sxs-lookup"><span data-stu-id="110f9-152">Then, other properties such as [Type](type-property-ado.md) or [Attributes](attributes-property-ado.md) can be accessed.</span></span>


<span data-ttu-id="110f9-153"> Объекты полей следующих типов данных (**DataTypeEnum)** нельзя прикрепить к коллекции **Fields** и вызвать ошибку: **adArray**, **adChapter**, **adEmpty**, **adPropVariant** и **adUserDefined**.</span><span class="sxs-lookup"><span data-stu-id="110f9-153">**Field** objects of the following data types (**DataTypeEnum**) cannot be appended to the **Fields** collection and will cause an error to occur: **adArray**, **adChapter**, **adEmpty**, **adPropVariant**, and **adUserDefined**.</span></span> <span data-ttu-id="110f9-154">Кроме того, ADO не поддерживает следующие типы данных: **adIDispatch,** **adIUnknown** и **adIVariant.**</span><span class="sxs-lookup"><span data-stu-id="110f9-154">Also, the following data types are not supported by ADO: **adIDispatch**, **adIUnknown**, and **adIVariant**.</span></span> <span data-ttu-id="110f9-155">Для этих типов при их использовании ошибки не возникают, но использование может привести к непредсказуемым результатам, включая утечку памяти.</span><span class="sxs-lookup"><span data-stu-id="110f9-155">For these types, no error will occur when appended, but usage can produce unpredictable results including memory leaks.</span></span>

### <a name="recordset"></a><span data-ttu-id="110f9-156">Recordset</span><span class="sxs-lookup"><span data-stu-id="110f9-156">Recordset</span></span>

<span data-ttu-id="110f9-157">Если перед вызовом метода **Append** свойство [CursorLocation](cursorlocation-property-ado.md) не задано, при вызове метода [Open](open-method-ado-recordset.md) объекта [Recordset](recordset-object-ado.md) для свойства **CursorClient** автоматически устанавливается значение **adUseClient** (значение [CursorLocationEnum).](cursorlocationenum.md)</span><span class="sxs-lookup"><span data-stu-id="110f9-157">If you do not set the [CursorLocation](cursorlocation-property-ado.md) property before calling the **Append** method, **CursorLocation** will be set to **adUseClient** (a [CursorLocationEnum](cursorlocationenum.md) value) automatically when the [Recordset](recordset-object-ado.md) object's [Open](open-method-ado-recordset.md) method is called.</span></span>

<span data-ttu-id="110f9-158">Ошибка во время работы возникает, если метод **Append** вызван в коллекции **Fields** открытого набора записей **или** в объекте **Recordset,** где задано свойство [ActiveConnection.](activeconnection-property-ado.md)</span><span class="sxs-lookup"><span data-stu-id="110f9-158">A run-time error will occur if the **Append** method is called on the **Fields** collection of an open **Recordset**, or on a **Recordset** where the [ActiveConnection](activeconnection-property-ado.md) property has been set.</span></span> <span data-ttu-id="110f9-159">К набору записей  можно только приместь поля, которые еще не открыты и еще не подключены к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="110f9-159">You can only append fields to a **Recordset** that is not open and has not yet been connected to a data source.</span></span> <span data-ttu-id="110f9-160">Обычно это происходит при создании объекта **Recordset** с помощью метода [CreateRecordset](createrecordset-method-rds.md) или присвоении объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="110f9-160">This is typically the case when a **Recordset** object is fabricated with the [CreateRecordset](createrecordset-method-rds.md) method or assigned to an object variable.</span></span>

### <a name="record"></a><span data-ttu-id="110f9-161">Record</span><span class="sxs-lookup"><span data-stu-id="110f9-161">Record</span></span>

<span data-ttu-id="110f9-162">Ошибка во время работы не возникает, если метод **Append** вызван в коллекции **Fields** открытой **записи.**</span><span class="sxs-lookup"><span data-stu-id="110f9-162">A run-time error will not occur if the **Append** method is called on the **Fields** collection of an open **Record**.</span></span> <span data-ttu-id="110f9-163">Новое поле будет добавлено в коллекцию **Fields** объекта **Record.**</span><span class="sxs-lookup"><span data-stu-id="110f9-163">The new field will be added to the **Record** object's **Fields** collection.</span></span> <span data-ttu-id="110f9-164">Если запись **была** производным от **объекта Recordset,** новое поле не будет отображаться в коллекции Fields объекта **Recordset.** </span><span class="sxs-lookup"><span data-stu-id="110f9-164">If the **Record** was derived from a **Recordset**, then the new field will not appear in the **Recordset** object's **Fields** collection.</span></span>

<span data-ttu-id="110f9-165">Несуществующее поле может быть создано и добавлено в коллекцию **Fields,** назначив объекту поля значение, как если бы оно уже существовало в коллекции.</span><span class="sxs-lookup"><span data-stu-id="110f9-165">A non-existent field can be created and appended to the **Fields** collection by assigning a value to the field object as if it already existed in the collection.</span></span> <span data-ttu-id="110f9-166">Назначение активирует автоматическое создание и приложение объекта **Field,** после чего назначение будет завершено.</span><span class="sxs-lookup"><span data-stu-id="110f9-166">The assignment will trigger the automatic creation and appending of the **Field** object, then the assignment will be completed.</span></span>

<span data-ttu-id="110f9-167">После того как поле **будет** в  коллекцию Fields объекта **Record,** вызовите метод **Update** коллекции **Fields,** чтобы сохранить изменение.</span><span class="sxs-lookup"><span data-stu-id="110f9-167">After appending a **Field** to a **Record** object's **Fields** collection, call the **Update** method of the **Fields** collection to save the change.</span></span>


---
title: Метод Append (ADO)
TOCTitle: Append method (ADO)
ms:assetid: cca133af-2b95-877d-0488-0d99631623f2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250014(v=office.15)
ms:contentKeyID: 48547742
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a85faf900860dabb809a10a92985559b7a7cf2ef
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32297132"
---
# <a name="append-method-ado"></a><span data-ttu-id="b91f6-102">Метод Append (ADO)</span><span class="sxs-lookup"><span data-stu-id="b91f6-102">Append method (ADO)</span></span>

<span data-ttu-id="b91f6-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="b91f6-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="b91f6-104">Добавляет объект в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="b91f6-104">Appends an object to a collection.</span></span> <span data-ttu-id="b91f6-105">Если коллекция является [полями](fields-collection-ado.md), новый объект [field](field-object-ado.md) можно создать перед добавлением в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="b91f6-105">If the collection is [Fields](fields-collection-ado.md), a new [Field](field-object-ado.md) object may be created before it is appended to the collection.</span></span>

## <a name="syntax"></a><span data-ttu-id="b91f6-106">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="b91f6-106">Syntax</span></span>

<span data-ttu-id="b91f6-107">*коллекция*. Добавление *объекта*</span><span class="sxs-lookup"><span data-stu-id="b91f6-107">*collection*.Append *object*</span></span>

<span data-ttu-id="b91f6-108">*поля*. *Имя*для добавления, *Тип*, *DefinedSize*, *attrib*, *FieldValue*</span><span class="sxs-lookup"><span data-stu-id="b91f6-108">*fields*.Append *Name*, *Type*, *DefinedSize*, *Attrib*, *FieldValue*</span></span>

## <a name="parameters"></a><span data-ttu-id="b91f6-109">Параметры</span><span class="sxs-lookup"><span data-stu-id="b91f6-109">Parameters</span></span>

|<span data-ttu-id="b91f6-110">Параметр</span><span class="sxs-lookup"><span data-stu-id="b91f6-110">Parameter</span></span>|<span data-ttu-id="b91f6-111">Описание</span><span class="sxs-lookup"><span data-stu-id="b91f6-111">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="b91f6-112">*.*</span><span class="sxs-lookup"><span data-stu-id="b91f6-112">*collection*</span></span> |<span data-ttu-id="b91f6-113">Объект Collection.</span><span class="sxs-lookup"><span data-stu-id="b91f6-113">A collection object.</span></span>|
|<span data-ttu-id="b91f6-114">*fields*</span><span class="sxs-lookup"><span data-stu-id="b91f6-114">*fields*</span></span> |<span data-ttu-id="b91f6-115">Коллекция **Fields** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-115">A **Fields** collection.</span></span>|
|<span data-ttu-id="b91f6-116">*object*</span><span class="sxs-lookup"><span data-stu-id="b91f6-116">*object*</span></span> |<span data-ttu-id="b91f6-117">Объектная переменная, представляющая объект, который требуется добавить.</span><span class="sxs-lookup"><span data-stu-id="b91f6-117">An object variable that represents the object to be appended.</span></span>|
|<span data-ttu-id="b91f6-118">*имя*</span><span class="sxs-lookup"><span data-stu-id="b91f6-118">*Name*</span></span> |<span data-ttu-id="b91f6-119">**Строковое** значение, которое содержит имя нового объекта **field** и не должно совпадать с именем любого другого объекта в *полях*.</span><span class="sxs-lookup"><span data-stu-id="b91f6-119">A **String** value that contains the name of the new **Field** object, and must not be the same name as any other object in *fields*.</span></span>|
|<span data-ttu-id="b91f6-120">*Тип*</span><span class="sxs-lookup"><span data-stu-id="b91f6-120">*Type*</span></span> |<span data-ttu-id="b91f6-121">Значение [DataTypeEnum](datatypeenum.md) , для которого по умолчанию задано значение **адемпти**, указывающее тип данных нового поля.</span><span class="sxs-lookup"><span data-stu-id="b91f6-121">A [DataTypeEnum](datatypeenum.md) value, whose default value is **adEmpty**, that specifies the data type of the new field.</span></span> <span data-ttu-id="b91f6-122">Следующие типы данных не поддерживаются в ADO, и их не следует использовать при добавлении новых полей в объект **Recordset**: **адидиспатч**, **адиункновн**, **адвариант**.</span><span class="sxs-lookup"><span data-stu-id="b91f6-122">The following data types are not supported by ADO, and should not be used when appending new fields to a **Recordset**: **adIDispatch**, **adIUnknown**, **adVariant**.</span></span>|
|<span data-ttu-id="b91f6-123">*DefinedSize*</span><span class="sxs-lookup"><span data-stu-id="b91f6-123">*DefinedSize*</span></span> |<span data-ttu-id="b91f6-124">Необязательное.</span><span class="sxs-lookup"><span data-stu-id="b91f6-124">Optional.</span></span> <span data-ttu-id="b91f6-125">**Длинное** значение, представляющее заданный размер (в символах или байтах) нового поля.</span><span class="sxs-lookup"><span data-stu-id="b91f6-125">A **Long** value that represents the defined size, in characters or bytes, of the new field.</span></span> <span data-ttu-id="b91f6-126">Значение этого параметра по умолчанию является производным от *типа*.</span><span class="sxs-lookup"><span data-stu-id="b91f6-126">The default value for this parameter is derived from *Type*.</span></span> <span data-ttu-id="b91f6-127">Поля с DefinedSize размером более 255 байт и рассматриваются как столбцы переменной длины.</span><span class="sxs-lookup"><span data-stu-id="b91f6-127">Fields with a DefinedSize greater than 255 bytes, and treated as variable length columns.</span></span> <span data-ttu-id="b91f6-128">(Значение по умолчанию *DefinedSize* не задано.)</span><span class="sxs-lookup"><span data-stu-id="b91f6-128">(The default *DefinedSize* is unspecified.)</span></span>|
|<span data-ttu-id="b91f6-129">*Атрибут*</span><span class="sxs-lookup"><span data-stu-id="b91f6-129">*Attrib*</span></span> |<span data-ttu-id="b91f6-130">Необязательное.</span><span class="sxs-lookup"><span data-stu-id="b91f6-130">Optional.</span></span> <span data-ttu-id="b91f6-131">Значение [фиелдаттрибутинум](fieldattributeenum.md) , для которого по умолчанию задано значение **адфлддефаулт**, определяющее атрибуты для нового поля.</span><span class="sxs-lookup"><span data-stu-id="b91f6-131">A [FieldAttributeEnum](fieldattributeenum.md) value, whose default value is **adFldDefault**, that specifies attributes for the new field.</span></span> <span data-ttu-id="b91f6-132">Если это значение не указано, поле будет содержать атрибуты, производные от *типа*.</span><span class="sxs-lookup"><span data-stu-id="b91f6-132">If this value is not specified, the field will contain attributes derived from *Type*.</span></span>|
|<span data-ttu-id="b91f6-133">*FieldValue*</span><span class="sxs-lookup"><span data-stu-id="b91f6-133">*FieldValue*</span></span> |<span data-ttu-id="b91f6-134">Необязательное.</span><span class="sxs-lookup"><span data-stu-id="b91f6-134">Optional.</span></span> <span data-ttu-id="b91f6-135">**Variant** , представляющий значение нового поля.</span><span class="sxs-lookup"><span data-stu-id="b91f6-135">A **Variant** that represents the value for the new field.</span></span> <span data-ttu-id="b91f6-136">Если этот параметр не указан, в поле добавляется значение null.</span><span class="sxs-lookup"><span data-stu-id="b91f6-136">If not specified, then the field is appended with a null value.</span></span>|

## <a name="remarks"></a><span data-ttu-id="b91f6-137">Примечания</span><span class="sxs-lookup"><span data-stu-id="b91f6-137">Remarks</span></span>

### <a name="parameters-collection"></a><span data-ttu-id="b91f6-138">Коллекция Parameters</span><span class="sxs-lookup"><span data-stu-id="b91f6-138">Parameters collection</span></span>

<span data-ttu-id="b91f6-139">Необходимо задать свойство [Type](type-property-ado.md) объекта [Parameter](parameter-object-ado.md) перед добавлением его в коллекцию **Parameters** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-139">You must set the [Type](type-property-ado.md) property of a [Parameter](parameter-object-ado.md) object before appending it to the **Parameters** collection.</span></span> <span data-ttu-id="b91f6-140">Если выбран тип данных переменной длины, необходимо также задать для свойства [size](size-property-ado.md) значение больше нуля.</span><span class="sxs-lookup"><span data-stu-id="b91f6-140">If you select a variable-length data type, you must also set the [Size](size-property-ado.md) property to a value greater than zero.</span></span>

<span data-ttu-id="b91f6-141">Описание параметров самостоятельно сокращает число вызовов поставщика и, соответственно, повышает производительность при использовании хранимых процедур или параметризованных запросов.</span><span class="sxs-lookup"><span data-stu-id="b91f6-141">Describing parameters yourself minimizes calls to the provider and consequently improves performance when using stored procedures or parameterized queries.</span></span> <span data-ttu-id="b91f6-142">Тем не менее, необходимо знать свойства параметров, связанных с хранимой процедурой или параметризованным запросом, которые необходимо вызвать.</span><span class="sxs-lookup"><span data-stu-id="b91f6-142">However, you must know the properties of the parameters associated with the stored procedure or parameterized query that you want to call.</span></span>

<span data-ttu-id="b91f6-143">Используйте метод [CreateParameter](createparameter-method-ado.md) для создания объектов **Parameter** с соответствующими параметрами свойства и используйте метод **append** , чтобы добавить их в коллекцию [Parameters](parameters-collection-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="b91f6-143">Use the [CreateParameter](createparameter-method-ado.md) method to create **Parameter** objects with the appropriate property settings and use the **Append** method to add them to the [Parameters](parameters-collection-ado.md) collection.</span></span> <span data-ttu-id="b91f6-144">Это позволяет задавать и возвращать значения параметров, не выполняя вызов поставщика для сведений о параметре.</span><span class="sxs-lookup"><span data-stu-id="b91f6-144">This lets you set and return parameter values without having to call the provider for the parameter information.</span></span> <span data-ttu-id="b91f6-145">При записи в поставщик, который не предоставляет сведения о параметрах, необходимо использовать этот метод, чтобы вручную заполнить коллекцию **Parameters** , чтобы использовать параметры вообще.</span><span class="sxs-lookup"><span data-stu-id="b91f6-145">If you are writing to a provider that does not supply parameter information, you must use this method to manually populate the **Parameters** collection in order to use parameters at all.</span></span>

### <a name="fields-collection"></a><span data-ttu-id="b91f6-146">Коллекция Fields</span><span class="sxs-lookup"><span data-stu-id="b91f6-146">Fields collection</span></span>

<span data-ttu-id="b91f6-147">Параметр *FieldValue* является допустимым только при добавлении объекта **field** в объект [Record](record-object-ado.md) , а не в объект **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-147">The *FieldValue* parameter is only valid when adding a **Field** object to a [Record](record-object-ado.md) object, not to a **Recordset** object.</span></span> <span data-ttu-id="b91f6-148">С помощью объекта **Record** вы можете добавлять поля и вводить значения одновременно.</span><span class="sxs-lookup"><span data-stu-id="b91f6-148">With a **Record** object, you may append fields and provide values at the same time.</span></span> <span data-ttu-id="b91f6-149">При наличии объекта **Recordset** необходимо создать поля, когда **набор записей** закрыт, затем открыть **набор записей** и присвоить значения полям.</span><span class="sxs-lookup"><span data-stu-id="b91f6-149">With a **Recordset** object, you must create fields while the **Recordset** is closed, then open the **Recordset** and assign values to the fields.</span></span>


> [!NOTE]
> <span data-ttu-id="b91f6-150">Для новых объектов **field** , добавленных в коллекцию **Fields** объекта **Record** , свойство [value](value-property-ado.md) должно быть задано до того, как можно будет указать другие свойства **поля** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-150">For new **Field** objects that have been appended to the **Fields** collection of a **Record** object, the [Value](value-property-ado.md) property must be set before any other **Field** properties can be specified.</span></span> <span data-ttu-id="b91f6-151">Во-первых, в коллекции **Fields** должно быть назначено и [Обновлено](update-method-ado.md) определенное значение свойства **value** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-151">First, a specific value for the **Value** property must have been assigned and [Update](update-method-ado.md) on the **Fields** collection called.</span></span> <span data-ttu-id="b91f6-152">Затем можно получить доступ к другим свойствам, таким как [Type](type-property-ado.md) или [Attributes](attributes-property-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="b91f6-152">Then, other properties such as [Type](type-property-ado.md) or [Attributes](attributes-property-ado.md) can be accessed.</span></span>


<span data-ttu-id="b91f6-153">Объекты **field** из следующих типов данных (**DataTypeEnum**) не могут быть добавлены в коллекцию **Fields** и возникнет ошибка: **адаррай**, **адчаптер**, **адемпти**, **адпропвариант**и **адусердефинед**.</span><span class="sxs-lookup"><span data-stu-id="b91f6-153">**Field** objects of the following data types (**DataTypeEnum**) cannot be appended to the **Fields** collection and will cause an error to occur: **adArray**, **adChapter**, **adEmpty**, **adPropVariant**, and **adUserDefined**.</span></span> <span data-ttu-id="b91f6-154">Кроме того, ADO не поддерживает следующие типы данных: **адидиспатч**, **адиункновн**и **адивариант**.</span><span class="sxs-lookup"><span data-stu-id="b91f6-154">Also, the following data types are not supported by ADO: **adIDispatch**, **adIUnknown**, and **adIVariant**.</span></span> <span data-ttu-id="b91f6-155">Для этих типов при добавлении ошибки не произойдет, но использование может привести к непредсказуемым результатам, включая утечки памяти.</span><span class="sxs-lookup"><span data-stu-id="b91f6-155">For these types, no error will occur when appended, but usage can produce unpredictable results including memory leaks.</span></span>

### <a name="recordset"></a><span data-ttu-id="b91f6-156">Recordset</span><span class="sxs-lookup"><span data-stu-id="b91f6-156">Recordset</span></span>

<span data-ttu-id="b91f6-157">Если не задать свойство [CursorLocation](cursorlocation-property-ado.md) перед вызовом метода **append** , то для **CursorLocation** будет автоматически задано значение **адусеклиент** (значение [курсорлокатионенум](cursorlocationenum.md) ) при вызове метода [Open](open-method-ado-recordset.md) объекта [Recordset](recordset-object-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="b91f6-157">If you do not set the [CursorLocation](cursorlocation-property-ado.md) property before calling the **Append** method, **CursorLocation** will be set to **adUseClient** (a [CursorLocationEnum](cursorlocationenum.md) value) automatically when the [Recordset](recordset-object-ado.md) object's [Open](open-method-ado-recordset.md) method is called.</span></span>

<span data-ttu-id="b91f6-158">Если метод **append** вызывается для коллекции **Fields** открытого **набора записей**или для объекта **Recordset** , где было задано свойство [ActiveConnection](activeconnection-property-ado.md) , произойдет ошибка времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="b91f6-158">A run-time error will occur if the **Append** method is called on the **Fields** collection of an open **Recordset**, or on a **Recordset** where the [ActiveConnection](activeconnection-property-ado.md) property has been set.</span></span> <span data-ttu-id="b91f6-159">Можно добавлять только поля в **набор записей** , который не открыт и еще не был подключен к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="b91f6-159">You can only append fields to a **Recordset** that is not open and has not yet been connected to a data source.</span></span> <span data-ttu-id="b91f6-160">Обычно это ситуация, когда объект **Recordset** создается с помощью метода [CreateRecordset](createrecordset-method-rds.md) или назначается объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="b91f6-160">This is typically the case when a **Recordset** object is fabricated with the [CreateRecordset](createrecordset-method-rds.md) method or assigned to an object variable.</span></span>

### <a name="record"></a><span data-ttu-id="b91f6-161">Record</span><span class="sxs-lookup"><span data-stu-id="b91f6-161">Record</span></span>

<span data-ttu-id="b91f6-162">При вызове метода **append** для коллекции **Fields** открытой **записи**возникает ошибка времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="b91f6-162">A run-time error will not occur if the **Append** method is called on the **Fields** collection of an open **Record**.</span></span> <span data-ttu-id="b91f6-163">Новое поле будет добавлено в коллекцию **Fields** объекта **Record** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-163">The new field will be added to the **Record** object's **Fields** collection.</span></span> <span data-ttu-id="b91f6-164">Если **запись** была получена из объекта **Recordset**, то новое поле не будет отображаться в коллекции **Fields** объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="b91f6-164">If the **Record** was derived from a **Recordset**, then the new field will not appear in the **Recordset** object's **Fields** collection.</span></span>

<span data-ttu-id="b91f6-165">Несуществующее поле можно создать и добавить в коллекцию **Fields** , назначив значение для объекта Field, как если бы оно уже существовало в коллекции.</span><span class="sxs-lookup"><span data-stu-id="b91f6-165">A non-existent field can be created and appended to the **Fields** collection by assigning a value to the field object as if it already existed in the collection.</span></span> <span data-ttu-id="b91f6-166">Назначение будет инициировать автоматическое создание и добавление объекта **field** , после чего назначение будет завершено.</span><span class="sxs-lookup"><span data-stu-id="b91f6-166">The assignment will trigger the automatic creation and appending of the **Field** object, then the assignment will be completed.</span></span>

<span data-ttu-id="b91f6-167">После добавления **поля** в коллекцию **Fields** объекта **Record** вызовите метод **Update** коллекции **Fields** , чтобы сохранить изменения.</span><span class="sxs-lookup"><span data-stu-id="b91f6-167">After appending a **Field** to a **Record** object's **Fields** collection, call the **Update** method of the **Fields** collection to save the change.</span></span>


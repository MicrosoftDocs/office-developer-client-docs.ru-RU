---
title: Метод Append (ADO)
TOCTitle: Append method (ADO)
ms:assetid: cca133af-2b95-877d-0488-0d99631623f2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250014(v=office.15)
ms:contentKeyID: 48547742
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a85faf900860dabb809a10a92985559b7a7cf2ef
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28706081"
---
# <a name="append-method-ado"></a>Метод Append (ADO)

**Применимо к**: Access 2013, Office 2013

Добавляет объект в коллекцию. Если семейство [полей](fields-collection-ado.md), могут быть созданы новый объект [поля](field-object-ado.md) перед добавлением в коллекцию.

## <a name="syntax"></a>Синтаксис

*семейства сайтов*. Добавьте *объект*

*поля*. Добавьте *имя*, *Тип*, *DefinedSize*, *атрибуты*, *FieldValue*

## <a name="parameters"></a>Parameters

|Параметр|Описание|
|:--------|:----------|
|*семейства сайтов* |Объект collection.|
|*fields* |Коллекция **полей** .|
|*object* |Объектная переменная, представляющий объект, который будет добавляться.|
|*Name* |**Строковое** значение, которое содержит имя новый объект **поля** , а не должны быть одинаковыми имя как любой другой объект в *полях*.|
|*Type* |Значение [DataTypeEnum](datatypeenum.md) , чье значение по умолчанию — это **adEmpty**, определяющее тип данных нового поля. Следующие типы данных не поддерживаются ADO и должны не будет использоваться при добавления новых полей **набора записей**: **adIDispatch**, **adIUnknown**, **adVariant**.|
|*DefinedSize* |Необязательно. **Длинное** значение, представляющее определенный размер, в байтах нового поля или символов. Значение по умолчанию для этого параметра является производным от *типа*. Поля со DefinedSize больше, чем 255 байт и обрабатываются как столбцы переменной длины. (По умолчанию *DefinedSize* не определено.)|
|*Атрибуты* |Необязательно. Значение [FieldAttributeEnum](fieldattributeenum.md) , чье значение по умолчанию — это **adFldDefault**, который определяет атрибуты для нового поля. Если это значение не указан, поле будет содержать атрибуты, производные от *типа*.|
|*FieldValue* |Необязательно. **Variant** , который представляет значение для нового поля. Если не указан, то поле добавляется нулевое значение.|

## <a name="remarks"></a>Замечания

### <a name="parameters-collection"></a>Коллекция Parameters

Перед добавлением в коллекцию **параметров** , необходимо установить свойство [типа](type-property-ado.md) объекта [параметров](parameter-object-ado.md) . Если выбран тип данных переменной длины, вам необходимо также установить свойство [Size](size-property-ado.md) значение больше нуля.

Описание параметров самостоятельно минимизирует вызовы к поставщику и поэтому улучшает производительность при использовании хранимых процедур или параметризованные запросы. Тем не менее необходимо знать свойства параметров, связанных с хранимую процедуру или параметризованный запрос, который требуется позвонить.

Метод [CreateParameter](createparameter-method-ado.md) используется для создания объектов **параметров** с соответствующими параметрами свойств и метод **Append** используется для добавления их в коллекцию [параметров](parameters-collection-ado.md) . Это позволяет задать и возвращаемые значения параметра без вызова поставщика для получения параметров. При создании поставщика, который не предоставляет сведений о параметрах необходимо использовать этот метод для вручную заполнить коллекцию **параметров** для использования на всех параметров.

### <a name="fields-collection"></a>Коллекция Fields

Параметр *FieldValue* действителен только в том случае, при добавлении объекта **поля** объект [записи](record-object-ado.md) , а не для объекта **набора записей** . С объектом **записи** можно добавить поля и указывать значения в то же время. С объектом **набора записей** необходимо создать поля закрытой **набора записей** , затем открыть **записей** и назначить значения поля.


> [!NOTE]
> Для нового **поля** объектов, к коллекции **полей** объекта **записи** свойство [Value](value-property-ado.md) необходимо установить перед можно указать любые другие свойства **поля** . Во-первых определенного значения для свойства **Value** должна быть назначена и вызове [Update](update-method-ado.md) в коллекции **полей** . Затем осуществляется другие свойства, такие как [Тип](type-property-ado.md) или [атрибуты](attributes-property-ado.md) .


Объекты **поля** из следующих типов данных (**DataTypeEnum**) не может быть добавлен к коллекции **полей** и приведет к возникновению ошибки: **adArray**, **adChapter**, **adEmpty**, **adPropVariant**и ** adUserDefined**. Кроме того, следующие типы данных не поддерживаются ADO: **adIDispatch**, **adIUnknown**и **adIVariant**. Для этих типов то ошибки не возникает при добавлении, но использование может привести к непредсказуемым последствиям, включая утечки памяти.

### <a name="recordset"></a>Recordset

Если свойство [CursorLocation](cursorlocation-property-ado.md) не задано до вызова метода **Append** , **CursorLocation** будет иметь значение **adUseClient** (значение [CursorLocationEnum](cursorlocationenum.md) ) автоматически при объекта [набора](recordset-object-ado.md) [ Открыть](open-method-ado-recordset.md) вызывается метод.

При вызове метода **Append** коллекцию **полей** open **записей**, либо на **набор записей** , где было установлено свойство [ActiveConnection](activeconnection-property-ado.md) произойдет ошибка во время выполнения. Только добавлением полей **набора записей** , который не был открыт и еще не был подключен к источнику данных. Обычно это регистр при объект **набора записей** с помощью метода [CreateRecordset](createrecordset-method-rds.md) с целью или назначается объектную переменную.

### <a name="record"></a>Record

Ошибка во время выполнения не возникает, если для коллекции **полей** open **записи**вызывается метод **Append** . Новое поле будет добавлен к коллекции **полей** объект **записи** . Если **запись** был получен из **набора записей**, нового поля не отображаются в коллекции **полей** объекта **набора записей** .

Поля несуществующий создаются и добавляются в коллекцию **полей** , назначив значение объекта поля, как если бы он уже существует в коллекции. Назначение запустит автоматического создания и добавления объекта **поля** , а затем назначения будет завершена.

После добавления **поля** в коллекцию **полей** объект **записи** , вызовите метод **Update** коллекции **полей** , чтобы сохранить изменения.


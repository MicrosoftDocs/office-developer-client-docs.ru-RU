---
title: Метод Append (ADO)
TOCTitle: Append method (ADO)
ms:assetid: cca133af-2b95-877d-0488-0d99631623f2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250014(v=office.15)
ms:contentKeyID: 48547742
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a85faf900860dabb809a10a92985559b7a7cf2ef
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32297132"
---
# <a name="append-method-ado"></a>Метод Append (ADO)

**Область применения**: Access 2013, Office 2013

Привносимый объект в коллекцию. Если коллекция является [Fields,](fields-collection-ado.md) [перед](field-object-ado.md) его приложением в коллекцию может быть создан новый объект Field.

## <a name="syntax"></a>Синтаксис

*collection*. Объект *Append*

*fields .* Имя *приложения,* *Тип,* *DefinedSize,* *Attrib,* *FieldValue*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*.* |Объект коллекции.|
|*fields* |Коллекция **Fields.**|
|*object* |Объектная переменная, представляюная объект, который необходимо к этому объекту.|
|*Название* |**Строковая** строка, которая содержит имя нового объекта **Field** и не должна быть тем же именем, что и любой другой объект в *полях.*|
|*Тип* |Значение [DataTypeEnum,](datatypeenum.md) значение по умолчанию — **adEmpty,** которое указывает тип данных нового поля. Следующие типы данных не поддерживаются ADO и не должны использоваться при подавке новых полей в **recordset:** **adIDispatch,** **adIUnknown,** **adVariant.**|
|*DefinedSize* |Необязательный параметр. **Длинное** значение, которое представляет определенный размер нового поля (в символах или в ветвях). Значение по умолчанию для этого параметра является производным от *Type*. Поля с значением DefinedSize больше 255 bytes и обрабатываются как столбцы переменной длины. (Значение *по умолчанию DefinedSize* не определено.)|
|*Attrib* |Необязательный параметр. Значение [FieldAttributeEnum,](fieldattributeenum.md) значением по умолчанию которого является **adFldDefault,** которое указывает атрибуты для нового поля. Если это значение не указано, поле будет содержать атрибуты, производные от *Type.*|
|*FieldValue* |Необязательный параметр. **Вариант,** который представляет значение для нового поля. Если значение не указано, к полю будет добавлено значение null.|

## <a name="remarks"></a>Заметки

### <a name="parameters-collection"></a>Коллекция Parameters

Перед его [](type-property-ado.md) приложением к коллекции [Parameters](parameter-object-ado.md) необходимо установить свойство Type объекта **Parameter.** При выборе типа данных переменной длины необходимо также установить для свойства [Size](size-property-ado.md) значение больше нуля.

Самостоятельное описание параметров минимизирует вызовы поставщика и, следовательно, повышает производительность при использовании хранимой процедуры или параметровизованного запроса. Однако необходимо знать свойства параметров, связанных с хранимой процедурой или параметризованный запрос, который требуется вызвать.

Используйте метод [CreateParameter](createparameter-method-ado.md) для создания объектов **Parameter** с соответствующими параметрами свойств и с помощью метода **Append** добавьте их в коллекцию [Parameters.](parameters-collection-ado.md) Это позволяет устанавливать и возвращать значения параметров без вызова поставщика для сведений о параметре. Если вы пишете поставщику, который не передает сведения о параметрах, необходимо использовать этот метод для заполнения коллекции **parameters** вручную, чтобы использовать параметры вообще.

### <a name="fields-collection"></a>Коллекция Fields

Параметр *FieldValue* действителен только при добавлении объекта **Field** к объекту [Record,](record-object-ado.md) а не **к объекту Recordset.** С помощью **объекта Record** можно одновременно дополировать поля и предоставить значения. С помощью **объекта Recordset** необходимо создать поля, когда набор **записей** закрыт, а затем открыть **набор** записей и назначить значения полям.


> [!NOTE]
> Для новых объектов **Field,** которые были добавлены в коллекцию **Fields** объекта **Record,**  свойство [Value](value-property-ado.md) должно быть задано до того, как могут быть указаны другие свойства Field. Во-первых, должно быть назначено определенное [](update-method-ado.md) значение для свойства **Value** и вызвано обновление коллекции **Fields.** Затем можно получить доступ к другим свойствам, таким как [Type](type-property-ado.md) или [Attributes.](attributes-property-ado.md)


 Объекты полей следующих типов данных (**DataTypeEnum)** нельзя прикрепить к коллекции **Fields** и вызвать ошибку: **adArray**, **adChapter**, **adEmpty**, **adPropVariant** и **adUserDefined**. Кроме того, ADO не поддерживает следующие типы данных: **adIDispatch,** **adIUnknown** и **adIVariant.** Для этих типов при их использовании ошибки не возникают, но использование может привести к непредсказуемым результатам, включая утечку памяти.

### <a name="recordset"></a>Recordset

Если перед вызовом метода **Append** свойство [CursorLocation](cursorlocation-property-ado.md) не задано, при вызове метода [Open](open-method-ado-recordset.md) объекта [Recordset](recordset-object-ado.md) для свойства **CursorClient** автоматически устанавливается значение **adUseClient** (значение [CursorLocationEnum).](cursorlocationenum.md)

Ошибка во время работы возникает, если метод **Append** вызван в коллекции **Fields** открытого набора записей **или** в объекте **Recordset,** где задано свойство [ActiveConnection.](activeconnection-property-ado.md) К набору записей  можно только приместь поля, которые еще не открыты и еще не подключены к источнику данных. Обычно это происходит при создании объекта **Recordset** с помощью метода [CreateRecordset](createrecordset-method-rds.md) или присвоении объектной переменной.

### <a name="record"></a>Record

Ошибка во время работы не возникает, если метод **Append** вызван в коллекции **Fields** открытой **записи.** Новое поле будет добавлено в коллекцию **Fields** объекта **Record.** Если запись **была** производным от **объекта Recordset,** новое поле не будет отображаться в коллекции Fields объекта **Recordset.** 

Несуществующее поле может быть создано и добавлено в коллекцию **Fields,** назначив объекту поля значение, как если бы оно уже существовало в коллекции. Назначение активирует автоматическое создание и приложение объекта **Field,** после чего назначение будет завершено.

После того как поле **будет** в  коллекцию Fields объекта **Record,** вызовите метод **Update** коллекции **Fields,** чтобы сохранить изменение.


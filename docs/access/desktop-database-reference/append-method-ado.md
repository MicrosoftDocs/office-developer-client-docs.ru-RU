---
title: Метод приложения (ADO)
TOCTitle: Append method (ADO)
ms:assetid: cca133af-2b95-877d-0488-0d99631623f2
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250014(v=office.15)
ms:contentKeyID: 48547742
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a85faf900860dabb809a10a92985559b7a7cf2ef
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32297132"
---
# <a name="append-method-ado"></a><span data-ttu-id="24e9c-102">Метод приложения (ADO)</span><span class="sxs-lookup"><span data-stu-id="24e9c-102">Append method (ADO)</span></span>

<span data-ttu-id="24e9c-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="24e9c-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="24e9c-104">Придает объект коллекции.</span><span class="sxs-lookup"><span data-stu-id="24e9c-104">Appends an object to a collection.</span></span> <span data-ttu-id="24e9c-105">Если коллекция [полей,](fields-collection-ado.md)новый [объект Field](field-object-ado.md) может быть создан, прежде чем он будет придан в коллекцию.</span><span class="sxs-lookup"><span data-stu-id="24e9c-105">If the collection is [Fields](fields-collection-ado.md), a new [Field](field-object-ado.md) object may be created before it is appended to the collection.</span></span>

## <a name="syntax"></a><span data-ttu-id="24e9c-106">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="24e9c-106">Syntax</span></span>

<span data-ttu-id="24e9c-107">*коллекция*. Объект *Append*</span><span class="sxs-lookup"><span data-stu-id="24e9c-107">*collection*.Append *object*</span></span>

<span data-ttu-id="24e9c-108">*поля*. Имя *приложения*, *Тип*, *DefinedSize*, *Attrib*, *FieldValue*</span><span class="sxs-lookup"><span data-stu-id="24e9c-108">*fields*.Append *Name*, *Type*, *DefinedSize*, *Attrib*, *FieldValue*</span></span>

## <a name="parameters"></a><span data-ttu-id="24e9c-109">Параметры</span><span class="sxs-lookup"><span data-stu-id="24e9c-109">Parameters</span></span>

|<span data-ttu-id="24e9c-110">Параметр</span><span class="sxs-lookup"><span data-stu-id="24e9c-110">Parameter</span></span>|<span data-ttu-id="24e9c-111">Описание</span><span class="sxs-lookup"><span data-stu-id="24e9c-111">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="24e9c-112">*коллекция*</span><span class="sxs-lookup"><span data-stu-id="24e9c-112">*collection*</span></span> |<span data-ttu-id="24e9c-113">Объект коллекции.</span><span class="sxs-lookup"><span data-stu-id="24e9c-113">A collection object.</span></span>|
|<span data-ttu-id="24e9c-114">*fields*</span><span class="sxs-lookup"><span data-stu-id="24e9c-114">*fields*</span></span> |<span data-ttu-id="24e9c-115">Коллекция **Полей.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-115">A **Fields** collection.</span></span>|
|<span data-ttu-id="24e9c-116">*object*</span><span class="sxs-lookup"><span data-stu-id="24e9c-116">*object*</span></span> |<span data-ttu-id="24e9c-117">Переменная объекта, которая представляет объект, который должен быть придан.</span><span class="sxs-lookup"><span data-stu-id="24e9c-117">An object variable that represents the object to be appended.</span></span>|
|<span data-ttu-id="24e9c-118">*Имя*</span><span class="sxs-lookup"><span data-stu-id="24e9c-118">*Name*</span></span> |<span data-ttu-id="24e9c-119">Значение **String,** содержаще имя нового объекта **Field** и не должно быть таким же именем, как любой другой объект в *полях.*</span><span class="sxs-lookup"><span data-stu-id="24e9c-119">A **String** value that contains the name of the new **Field** object, and must not be the same name as any other object in *fields*.</span></span>|
|<span data-ttu-id="24e9c-120">*Тип*</span><span class="sxs-lookup"><span data-stu-id="24e9c-120">*Type*</span></span> |<span data-ttu-id="24e9c-121">Значение [DataTypeEnum,](datatypeenum.md) значение которого по умолчанию **— adEmpty,** которое указывает тип данных нового поля.</span><span class="sxs-lookup"><span data-stu-id="24e9c-121">A [DataTypeEnum](datatypeenum.md) value, whose default value is **adEmpty**, that specifies the data type of the new field.</span></span> <span data-ttu-id="24e9c-122">Следующие типы данных не поддерживаются ADO и не должны использоваться при приложении новых полей к **Recordset:** **adIDispatch,** **adIUnknown,** **adVariant**.</span><span class="sxs-lookup"><span data-stu-id="24e9c-122">The following data types are not supported by ADO, and should not be used when appending new fields to a **Recordset**: **adIDispatch**, **adIUnknown**, **adVariant**.</span></span>|
|<span data-ttu-id="24e9c-123">*DefinedSize*</span><span class="sxs-lookup"><span data-stu-id="24e9c-123">*DefinedSize*</span></span> |<span data-ttu-id="24e9c-124">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="24e9c-124">Optional.</span></span> <span data-ttu-id="24e9c-125">**Длинное** значение, представляюще определенный размер в символах или bytes нового поля.</span><span class="sxs-lookup"><span data-stu-id="24e9c-125">A **Long** value that represents the defined size, in characters or bytes, of the new field.</span></span> <span data-ttu-id="24e9c-126">Значение по умолчанию для этого параметра происходит из *Type*.</span><span class="sxs-lookup"><span data-stu-id="24e9c-126">The default value for this parameter is derived from *Type*.</span></span> <span data-ttu-id="24e9c-127">Поля с значением DefinedSize более 255 bytes и рассматриваются как столбцы переменной длины.</span><span class="sxs-lookup"><span data-stu-id="24e9c-127">Fields with a DefinedSize greater than 255 bytes, and treated as variable length columns.</span></span> <span data-ttu-id="24e9c-128">(По умолчанию *DefinedSize* не определено.)</span><span class="sxs-lookup"><span data-stu-id="24e9c-128">(The default *DefinedSize* is unspecified.)</span></span>|
|<span data-ttu-id="24e9c-129">*Attrib*</span><span class="sxs-lookup"><span data-stu-id="24e9c-129">*Attrib*</span></span> |<span data-ttu-id="24e9c-130">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="24e9c-130">Optional.</span></span> <span data-ttu-id="24e9c-131">Значение [FieldAttributeEnum,](fieldattributeenum.md) значение которого по умолчанию **— adFldDefault,** которое указывает атрибуты для нового поля.</span><span class="sxs-lookup"><span data-stu-id="24e9c-131">A [FieldAttributeEnum](fieldattributeenum.md) value, whose default value is **adFldDefault**, that specifies attributes for the new field.</span></span> <span data-ttu-id="24e9c-132">Если это значение не указано, поле будет содержать атрибуты, полученные из *Type*.</span><span class="sxs-lookup"><span data-stu-id="24e9c-132">If this value is not specified, the field will contain attributes derived from *Type*.</span></span>|
|<span data-ttu-id="24e9c-133">*FieldValue*</span><span class="sxs-lookup"><span data-stu-id="24e9c-133">*FieldValue*</span></span> |<span data-ttu-id="24e9c-134">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="24e9c-134">Optional.</span></span> <span data-ttu-id="24e9c-135">**Вариант,** представляюще значение для нового поля.</span><span class="sxs-lookup"><span data-stu-id="24e9c-135">A **Variant** that represents the value for the new field.</span></span> <span data-ttu-id="24e9c-136">Если не указано, то поле будет добавлено со значением null.</span><span class="sxs-lookup"><span data-stu-id="24e9c-136">If not specified, then the field is appended with a null value.</span></span>|

## <a name="remarks"></a><span data-ttu-id="24e9c-137">Примечания</span><span class="sxs-lookup"><span data-stu-id="24e9c-137">Remarks</span></span>

### <a name="parameters-collection"></a><span data-ttu-id="24e9c-138">Коллекция Parameters</span><span class="sxs-lookup"><span data-stu-id="24e9c-138">Parameters collection</span></span>

<span data-ttu-id="24e9c-139">Необходимо задать [свойство Type](type-property-ado.md) объекта [Parameter](parameter-object-ado.md) перед его примесями к коллекции **Параметры.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-139">You must set the [Type](type-property-ado.md) property of a [Parameter](parameter-object-ado.md) object before appending it to the **Parameters** collection.</span></span> <span data-ttu-id="24e9c-140">Если выбран тип данных переменной длины, необходимо также установить значение [Размер,](size-property-ado.md) большее нуля.</span><span class="sxs-lookup"><span data-stu-id="24e9c-140">If you select a variable-length data type, you must also set the [Size](size-property-ado.md) property to a value greater than zero.</span></span>

<span data-ttu-id="24e9c-141">Описание параметров позволяет свести к минимуму вызовы поставщику и, следовательно, повысить производительность при использовании сохраненных процедур или параметризированных запросов.</span><span class="sxs-lookup"><span data-stu-id="24e9c-141">Describing parameters yourself minimizes calls to the provider and consequently improves performance when using stored procedures or parameterized queries.</span></span> <span data-ttu-id="24e9c-142">Однако необходимо знать свойства параметров, связанных с хранимой процедурой или параметризированным запросом, который необходимо вызвать.</span><span class="sxs-lookup"><span data-stu-id="24e9c-142">However, you must know the properties of the parameters associated with the stored procedure or parameterized query that you want to call.</span></span>

<span data-ttu-id="24e9c-143">Используйте метод [CreateParameter](createparameter-method-ado.md) для создания объектов **Параметры** с соответствующими параметрами свойств и используйте метод **Append,** чтобы добавить их в коллекцию [Параметры.](parameters-collection-ado.md)</span><span class="sxs-lookup"><span data-stu-id="24e9c-143">Use the [CreateParameter](createparameter-method-ado.md) method to create **Parameter** objects with the appropriate property settings and use the **Append** method to add them to the [Parameters](parameters-collection-ado.md) collection.</span></span> <span data-ttu-id="24e9c-144">Это позволяет устанавливать и возвращать значения параметров, не вызывая поставщика для получения сведений о параметрах.</span><span class="sxs-lookup"><span data-stu-id="24e9c-144">This lets you set and return parameter values without having to call the provider for the parameter information.</span></span> <span data-ttu-id="24e9c-145">Если вы пишете поставщику, который не поставляет сведения о параметрах,  необходимо использовать этот метод, чтобы вручную заполнить коллекцию параметров, чтобы использовать параметры вообще.</span><span class="sxs-lookup"><span data-stu-id="24e9c-145">If you are writing to a provider that does not supply parameter information, you must use this method to manually populate the **Parameters** collection in order to use parameters at all.</span></span>

### <a name="fields-collection"></a><span data-ttu-id="24e9c-146">Коллекция Fields</span><span class="sxs-lookup"><span data-stu-id="24e9c-146">Fields collection</span></span>

<span data-ttu-id="24e9c-147">Параметр *FieldValue* действителен только при добавлении объекта **Field** к объекту [Record,](record-object-ado.md) а не **объекту Recordset.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-147">The *FieldValue* parameter is only valid when adding a **Field** object to a [Record](record-object-ado.md) object, not to a **Recordset** object.</span></span> <span data-ttu-id="24e9c-148">С помощью **объекта Record** можно одновременно придать поля и предоставить значения.</span><span class="sxs-lookup"><span data-stu-id="24e9c-148">With a **Record** object, you may append fields and provide values at the same time.</span></span> <span data-ttu-id="24e9c-149">С **объектом Recordset** необходимо создать поля, пока **набор записей** закрыт, а затем открыть набор записей и назначить значения полям. </span><span class="sxs-lookup"><span data-stu-id="24e9c-149">With a **Recordset** object, you must create fields while the **Recordset** is closed, then open the **Recordset** and assign values to the fields.</span></span>


> [!NOTE]
> <span data-ttu-id="24e9c-150">Для новых объектов **Field,** которые были добавлены в коллекцию **Полей** объекта  **Record,** свойство [Value](value-property-ado.md) должно быть задано до того, как могут быть указаны другие свойства поля.</span><span class="sxs-lookup"><span data-stu-id="24e9c-150">For new **Field** objects that have been appended to the **Fields** collection of a **Record** object, the [Value](value-property-ado.md) property must be set before any other **Field** properties can be specified.</span></span> <span data-ttu-id="24e9c-151">Во-первых, должно быть назначено определенное значение для свойства **Value** и обновление [коллекции](update-method-ado.md) **Полей.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-151">First, a specific value for the **Value** property must have been assigned and [Update](update-method-ado.md) on the **Fields** collection called.</span></span> <span data-ttu-id="24e9c-152">Затем можно получить доступ к другим свойствам, таким как [Type](type-property-ado.md) или [Attributes.](attributes-property-ado.md)</span><span class="sxs-lookup"><span data-stu-id="24e9c-152">Then, other properties such as [Type](type-property-ado.md) or [Attributes](attributes-property-ado.md) can be accessed.</span></span>


<span data-ttu-id="24e9c-153"> Объекты полей следующих типов данных **(DataTypeEnum)** не могут быть примещены к коллекции **Fields** и могут вызывать ошибку: **adArray,** **adChapter,** **adEmpty,** **adPropVariant** и **adUserDefined.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-153">**Field** objects of the following data types (**DataTypeEnum**) cannot be appended to the **Fields** collection and will cause an error to occur: **adArray**, **adChapter**, **adEmpty**, **adPropVariant**, and **adUserDefined**.</span></span> <span data-ttu-id="24e9c-154">Кроме того, следующие типы данных не поддерживаются ADO: **adIDispatch,** **adIUnknown** и **adIVariant**.</span><span class="sxs-lookup"><span data-stu-id="24e9c-154">Also, the following data types are not supported by ADO: **adIDispatch**, **adIUnknown**, and **adIVariant**.</span></span> <span data-ttu-id="24e9c-155">Для этих типов при приложении ошибки не будет, но использование может привести к непредсказуемым результатам, включая утечку памяти.</span><span class="sxs-lookup"><span data-stu-id="24e9c-155">For these types, no error will occur when appended, but usage can produce unpredictable results including memory leaks.</span></span>

### <a name="recordset"></a><span data-ttu-id="24e9c-156">Recordset</span><span class="sxs-lookup"><span data-stu-id="24e9c-156">Recordset</span></span>

<span data-ttu-id="24e9c-157">Если перед вызовом метода Приложения свойство [](open-method-ado-recordset.md) [CursorLocation](cursorlocation-property-ado.md) не задано, **cursorLocation** будет автоматически задан **adUseClient** (значение [CursorLocationEnum)](cursorlocationenum.md) при вызове метода Open объекта [Recordset.](recordset-object-ado.md) </span><span class="sxs-lookup"><span data-stu-id="24e9c-157">If you do not set the [CursorLocation](cursorlocation-property-ado.md) property before calling the **Append** method, **CursorLocation** will be set to **adUseClient** (a [CursorLocationEnum](cursorlocationenum.md) value) automatically when the [Recordset](recordset-object-ado.md) object's [Open](open-method-ado-recordset.md) method is called.</span></span>

<span data-ttu-id="24e9c-158">Ошибка при запуске произойдет, если метод **Append** вызван в коллекцию **Полей** открытого набора записей **или** в наборе записей, где задано свойство [ActiveConnection.](activeconnection-property-ado.md) </span><span class="sxs-lookup"><span data-stu-id="24e9c-158">A run-time error will occur if the **Append** method is called on the **Fields** collection of an open **Recordset**, or on a **Recordset** where the [ActiveConnection](activeconnection-property-ado.md) property has been set.</span></span> <span data-ttu-id="24e9c-159">Можно только приложения полей к **набору Recordset,** который еще не открыт и еще не подключен к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="24e9c-159">You can only append fields to a **Recordset** that is not open and has not yet been connected to a data source.</span></span> <span data-ttu-id="24e9c-160">Обычно это происходит, когда объект **Recordset** сфабрикован методом [CreateRecordset](createrecordset-method-rds.md) или назначен объектной переменной.</span><span class="sxs-lookup"><span data-stu-id="24e9c-160">This is typically the case when a **Recordset** object is fabricated with the [CreateRecordset](createrecordset-method-rds.md) method or assigned to an object variable.</span></span>

### <a name="record"></a><span data-ttu-id="24e9c-161">Record</span><span class="sxs-lookup"><span data-stu-id="24e9c-161">Record</span></span>

<span data-ttu-id="24e9c-162">Ошибка во время запуска не произойдет, если метод **Приложения** вызван в коллекцию **Полей** открытой **записи.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-162">A run-time error will not occur if the **Append** method is called on the **Fields** collection of an open **Record**.</span></span> <span data-ttu-id="24e9c-163">Новое поле будет добавлено в коллекцию **Поля** объекта **Record.**</span><span class="sxs-lookup"><span data-stu-id="24e9c-163">The new field will be added to the **Record** object's **Fields** collection.</span></span> <span data-ttu-id="24e9c-164">Если запись **была** получена из **наборов записей,** новое поле не будет отображаться в коллекции Поля объекта **Recordset.** </span><span class="sxs-lookup"><span data-stu-id="24e9c-164">If the **Record** was derived from a **Recordset**, then the new field will not appear in the **Recordset** object's **Fields** collection.</span></span>

<span data-ttu-id="24e9c-165">Несуществующее поле может быть создано и добавлено в коллекцию **Fields,** назначив объекту поля значение, как если бы оно уже существовало в коллекции.</span><span class="sxs-lookup"><span data-stu-id="24e9c-165">A non-existent field can be created and appended to the **Fields** collection by assigning a value to the field object as if it already existed in the collection.</span></span> <span data-ttu-id="24e9c-166">Назначение вызовет автоматическое создание и придание объекта **Field,** после чего задание будет выполнено.</span><span class="sxs-lookup"><span data-stu-id="24e9c-166">The assignment will trigger the automatic creation and appending of the **Field** object, then the assignment will be completed.</span></span>

<span data-ttu-id="24e9c-167">Применив **поле к** коллекции **Полей** объекта Записи, позвоните методу  **Update** коллекции **Fields,** чтобы сохранить изменение.</span><span class="sxs-lookup"><span data-stu-id="24e9c-167">After appending a **Field** to a **Record** object's **Fields** collection, call the **Update** method of the **Fields** collection to save the change.</span></span>


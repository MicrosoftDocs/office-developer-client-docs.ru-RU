---
title: Макроблок Если... То... Иначе
TOCTitle: If...Then...Else macro block
ms:assetid: 0c4a4b7a-4fdb-9dbc-a94e-939a2ff1c0e5
ms:mtpsurl: https://msdn.microsoft.com/library/Ff845158(v=office.15)
ms:contentKeyID: 48543188
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Priority
ms.openlocfilehash: fb6cbd6cc925a3e4841d9e7d6d77332cc36c7a03
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291896"
---
# <a name="ifthenelse-macro-block"></a>Макроблок Если... То... Иначе


**Область применения**: Access 2013, Office 2013

Вы можете использовать макроблок **Если**, чтобы выполнять группы макрокоманд в зависимости от значения выражения.

```vb
    If expression Then 
     Insert macro actions here ... 
    Else If expression 
     Insert macro actions here ... 
    Else 
     Insert macro actions here ... 
    End If
```

## <a name="setting"></a>Настройка

Как для макроблока **Если**, так и для макроблока **Иначе если** необходимо задать следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Expression</strong></p></td>
<td><p>Условие, истинность которого должна проверяться. Принимает значение ИСТИНА или ЛОЖЬ.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Примечания

При выборе макроблока **Если** появляется поле для ввода выражения, представляющего собой условие, истинность которого будет в дальнейшем проверяться. Кроме того, доступно поле со списком, в которое можно добавить макрокоманду. Под ним автоматически отображается текст "Конец блока "Если" Поля "Если" и "Конец блока "Если" ограничивают область, в которую можно добавить группу (блок) макрокоманд. Макрокоманды блока будут выполнены лишь в случае, если введенное выражение примет значение ИСТИНА.

Для проверки истинности другого выражения в случае ложности первого вы можете выбрать команду **Добавить блок "Иначе если"**, чтобы вставить необязательный блок **Иначе если**. Необходимо ввести выражение, принимающее значение ИСТИНА или ЛОЖЬ. Добавленный блок будет выполнен только в случае истинности этого выражения и ложности первого.

К блоку "Если" можно добавить любое число блоков **Иначе если**.

Вы можете выбрать команду **Добавить блок "Иначе"**, чтобы вставить необязательный блок **Иначе**. В этом случае макрокоманды, добавленные под формой **Иначе**, сформируют блок **Иначе**, который будет выполнен только в случае ложности выражений в блоках "Если" и "Иначе если". К каждому блоку **Если** можно добавить один блок **Иначе**.

В представленном ниже примере кода макрокоманды первого блока выполняются, если параметр \[Status\] принимает положительное значение. Если значение параметра \[Status\] отрицательно или равно нулю, оценивается истинность выражения в блоке **Иначе если**. Макрокоманды блока **Иначе если** выполняются, если параметр \[Status\] равен нулю. Наконец, если ложны выражения как в первом, так и во втором блоке, выполняются макрокоманды блока **Иначе**.

```vb
    If [Status] > 0 Then 
     Insert macro actions here ... 
    Else If [Status] = 0 
     Insert macro actions here ... 
    Else 
     Insert macro actions here ... 
    End If
```

Вы можете вкладывать блоки **Если** друг в друга. Один блок **Если** можно вложить в другой, если в случае истинности первого выражения нужно оценить второе. В представленном ниже примере кода внутренний блок **Если** выполняется только если значение параметра \[Status\] положительно *и* больше 100.

```vb
    If [Status] > 0 Then 
     Insert macro actions here ... 
     If [Status] > 100 
     Insert macro actions here ... 
     EndifEnd If
```

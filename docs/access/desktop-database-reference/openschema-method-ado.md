---
title: Метод OpenSchema (ADO)
TOCTitle: OpenSchema method (ADO)
ms:assetid: 57771163-a14e-207a-2942-849acb79a9a1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249294(v=office.15)
ms:contentKeyID: 48544970
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 43ca69b9d761629d42138780517f8de806ed7e8c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288338"
---
# <a name="openschema-method-ado"></a>Метод OpenSchema (ADO)

**Область применения**: Access 2013, Office 2013

Получает сведения о схеме базы данных от поставщика.

## <a name="syntax"></a>Синтаксис

**Set * * ** = *Подключение к*набору записей. OpenSchema (* куеритипе *, *условия*, *SchemaID*)

## <a name="return-values"></a>Возвращаемые значения

Возвращает объект [Recordset](recordset-object-ado.md) , содержащий сведения о схеме. **Набор записей** будет открыт как статический курсор, предназначенный только для чтения. *Куеритипе* определяет, какие столбцы отображаются в **наборе записей**.

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*QueryType* |Любое значение [счемаенум](schemaenum.md) , представляющее тип выполняемого запроса схемы.|
|*Criteria* |Необязательное. Массив ограничений запроса для каждого параметра *куеритипе* , как показано в **счемаенум**.|
|*SchemaID* |GUID запроса поставщика — схемы, не определенного спецификацией OLE DB. Этот параметр является обязательным, если для *куеритипе* задано значение **адсчемапровидерспеЦифик**; в противном случае он не используется.|

## <a name="remarks"></a>Примечания

Метод **OpenSchema** возвращает сведения об источнике данных, например о таблицах, которые находятся в источнике данных, столбцах в таблицах и типах данных, которые поддерживаются.

Аргумент *куеритипе* — это идентификатор GUID, который указывает, что возвращаются столбцы (схемы). Спецификация OLE DB содержит полный список схем.

Аргумент *условия_отбора* позволяет ограничить результаты запроса схемы. *Условие* определяет массив значений, которые должны присутствовать в соответствующем подмножестве столбцов, называемых *столбцами ограничений*, в результирующем **наборе записей**.

Константа **адсчемапровидерспеЦифик** используется для аргумента *куеритипе* , если поставщик определяет собственные нестандартные запросы схемы за пределом, указанным выше. При использовании этой константы аргумент *SchemaID* необходим для передачи GUID выполняемого запроса схемы. Если для *куеритипе* задано значение **АдсчемапровидерспеЦифик** , но *SchemaID* не указано, возникнет ошибка.

Поставщики не являются обязательными для поддержки всех запросов стандартных схем OLE DB. В частности, спецификации OLE DB требуются только **адсчематаблес**, **адсчемаколумнс**и **адсчемапровидертипес** . Тем не менее, поставщику не требуется поддерживать ограничения *критериев* , указанные выше для этих запросов схемы.

**Использование удаленной службы данных** Метод **OpenSchema** недоступен для объекта [подключения](connection-object-ado.md) на стороне клиента.

> [!NOTE]
> В Visual Basic столбцы, которые содержат 4-разрядное целое число без знака (DBTYPE UI4) в **наборе записей** , возвращенном из метода **OpenSchema** в объекте **Connection** , не могут сравниваться с другими переменными. Дополнительные сведения о типах данных OLE DB приведены в главе 13 и приложении A *Справочника программиста Microsoft OLE DB*.



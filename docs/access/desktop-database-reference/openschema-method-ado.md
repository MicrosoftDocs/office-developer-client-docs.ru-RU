---
title: Метод OpenSchema (ADO)
TOCTitle: OpenSchema method (ADO)
ms:assetid: 57771163-a14e-207a-2942-849acb79a9a1
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249294(v=office.15)
ms:contentKeyID: 48544970
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 43ca69b9d761629d42138780517f8de806ed7e8c
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288338"
---
# <a name="openschema-method-ado"></a>Метод OpenSchema (ADO)

**Область применения**: Access 2013, Office 2013

Получает сведения о схеме базы данных от поставщика.

## <a name="syntax"></a>Синтаксис

**Set****recordset*  =  *connection .* OpenSchema (* QueryType*, *Criteria*, *SchemaID*)

## <a name="return-values"></a>Возвращаемые значения

Возвращает объект [Recordset,](recordset-object-ado.md) содержащий сведения о схеме. Набор **записей** будет открыт в качестве статического курсора только для чтения. *QueryType* определяет, какие столбцы отображаются в **наборе записей.**

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*QueryType* |Любое [значение SchemaEnum,](schemaenum.md) которое представляет тип запроса схемы для запуска.|
|*Criteria* |Необязательный параметр. Массив ограничений запроса для каждого *параметра QueryType,* как указано **в SchemaEnum.**|
|*SchemaID* |GUID для запроса схемы поставщика, не определенного спецификацией OLE DB. Этот параметр обязален, если *параметр QueryType* имеет тип **adSchemaProviderSpecific;** в противном случае он не используется.|

## <a name="remarks"></a>Заметки

Метод **OpenSchema** возвращает самоописательные сведения об источнике данных, такие как таблицы в источнике данных, столбцы в таблицах и поддерживаемые типы данных.

Аргумент *QueryType* — это GUID, который указывает возвращенные столбцы (схемы). Спецификация OLE DB имеет полный список схем.

Аргумент *Criteria* ограничивает результаты запроса схемы. *Условия* заданы массив значений, которые должны быть в соответствующем подмножество столбцов, называемых столбцы ограничения *,* в итоговом **наборе записей**.

**Константа adSchemaProviderSpecific** используется для аргумента *QueryType,* если поставщик определяет собственные нестандартные запросы схемы за пределами перечисленных выше. Если используется эта константа, для выполнения запроса схемы требуется аргумент *SchemaID.* Если *для QueryType* заданы данные **adSchemaProviderSpecific,** но *SchemaID* не предоставлен, будет выдана ошибка.

Поставщики не обязаны поддерживать все запросы стандартной схемы OLE DB. В частности, спецификация OLE DB требует только **adSchemaTables,** **adSchemaColumns** и **adSchemaProviderTypes.** Однако поставщик не обязан поддерживать указанные выше ограничения критериев для этих запросов схемы. 

**Использование удаленной службы данных** Метод **OpenSchema** не доступен для объекта подключения на [стороне](connection-object-ado.md) клиента.

> [!NOTE]
> В Visual Basic столбцы с четырехбайтным неподписаным значением (DBTYPE UI4) в наборе записей, возвращаемом методом **OpenSchema** в объекте  **Connection,** нельзя сравнить с другими переменными. Дополнительные сведения о типах данных OLE DB см. в главе 13 и приложении A справочника по программисту *Microsoft OLE DB.*



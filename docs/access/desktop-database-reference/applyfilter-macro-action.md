---
title: Макрокоманда ApplyFilter
TOCTitle: ApplyFilter macro action
ms:assetid: c63988c4-4506-cc51-98f7-478d1f3fe668
ms:mtpsurl: https://msdn.microsoft.com/library/Ff823130(v=office.15)
ms:contentKeyID: 48547623
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm79035
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: e79ab56778f9429e7f1a985f0f81864ae4363606
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296999"
---
# <a name="applyfilter-macro-action"></a>Макрокоманда ApplyFilter

**Область применения**: Access 2013, Office 2013

Действие **ApplyFilter** можно использовать для применения фильтра, запроса или предложения SQL WHERE к таблице, форме или отчету, чтобы ограничить или отсортировать записи в таблице или записях из таблицы или запроса формы или отчета. Для отчетов это действие можно использовать только в макросах, указанных свойством события **OnOpen** отчета.

> [!NOTE]
> Это действие можно использовать для применения SQL WHERE только при применении фильтра сервера. К источнику записей хранимой процедуры нельзя применить фильтр сервера.

## <a name="setting"></a>Setting

Действие **ApplyFilter** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Имя фильтра</p></td>
<td><p>Имя фильтра или запроса, ограничивающего или сортировать записи таблицы, формы или отчета. Можно ввести имя существующего запроса или фильтра, сохраненного <strong></strong> в качестве запроса, в поле "Имя фильтра" в разделе "Аргументы действий" области <strong></strong> <strong>построитель</strong> макроса.</p><p><strong>ПРИМЕЧАНИЕ.</strong>При использовании этого действия для применения фильтра сервера аргумент "Имя фильтра" должен быть пустым.</p></td>
</tr>
<tr class="even">
<td><p>Where Condition</p></td>
<td><p>Допустимый SQL WHERE (без слова WHERE) или выражение, ограничивающее записи таблицы, формы или отчета.</p>
<p><b>ПРИМЕЧАНИЕ.</b>В выражении аргумента Where Condition левая сторона выражения обычно содержит имя поля из таблицы или запроса формы или отчета. Правая сторона выражения обычно содержит критерии, которые необходимо применить к этому полю для ограничения или сортировки записей. Например, критерием может быть имя управления в другой форме, содержа содержа которое должно совпадать со значениями, которые должны соответствовать записям в первой форме. Имя этого управления должно быть полностью квалифицировано, например:</p>
<p><strong>Формы!</strong> <em>formname</em>! <em>controlname</em> Имена полей должны быть окружяться двойными кавычками, а строки литералов должны быть окружяться одиночными кавычками. Максимальная длина аргумента Where Condition составляет 255 символов. Если требуется ввести более SQL where, используйте метод <strong>ApplyFilter</strong> объекта <strong>DoCmd</strong> в модуле Visual Basic для приложений (VBA). В VBA SQL ввести заявления о предложении WHERE до 32 768 символов.</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> Аргумент "Имя фильтра" можно использовать, если вы уже определили фильтр, который предоставляет соответствующие данные. Вы можете использовать аргумент Where Condition, чтобы ввести критерии ограничения напрямую. Если вы используете оба аргумента, Microsoft Office Access 2007 применяет предложение WHERE к результатам фильтра. Необходимо использовать один или оба аргумента.

## <a name="remarks"></a>Заметки

Вы можете применить фильтр или запрос к форме в представлении формы или в представлении таблицы.

Применяемое условие фильтра и WHERE становится параметром свойства **Filter** или **ServerFilter** формы или отчета.

Для таблиц и форм это действие аналогично нажатию кнопки **"Применить фильтр",** "Сортировка" или "Применить **серверный фильтр"** в меню **"Записи".** Команда меню применяет к таблице или форме последний созданный фильтр, а действие **ApplyFilter** применяет указанный фильтр или запрос.

Если в базе данных Access  после  запуска действия **ApplyFilter** нажать кнопку "Фильтр" в меню "Записи", а затем щелкнуть "Расширенный **фильтр/сортировка",** в окне "Расширенный фильтр/сортировка" будут показаны критерии фильтра, выбранные с помощью этого действия.

Чтобы удалить фильтр и отобразить все записи для таблицы или формы в базе данных Office Access 2007, можно использовать  действие **ShowAllRecords** или команду "Удалить **фильтр/сортировку"** в меню "Записи". Чтобы удалить фильтр в проекте Access (ADP), можно вернуться в окно "Фильтр сервера  по форме"  и удалить все критерии фильтрации, а затем щелкнуть "Применить фильтр сервера" в меню "Записи" на панели инструментов или установить для свойства **ServerFilterByForm** свойство **False** (0).

При сохранения таблицы или формы Access сохраняет любой фильтр, определенный в настоящее время в этом объекте, но не применяет его автоматически при следующем открытом объекте (хотя он автоматически применяет любую сортировку, примененную к объекту до его сохранения). Если вы хотите применить фильтр автоматически при первом открытие формы, укажите макрос, содержащий действие **ApplyFilter** или процедуру события, содержащую метод **ApplyFilter** объекта **DoCmd** в качестве параметра свойства события **OnOpen** формы. Вы также можете применить фильтр с помощью действия **OpenForm** или **OpenReport** или соответствующих им методов. Чтобы автоматически применить фильтр при первом открытие таблицы, можно открыть таблицу с помощью макроса, содержащего действие **OpenTable,** а затем сразу же последует действие **ApplyFilter.**

## <a name="example"></a>Пример

В следующем примере показано, как использовать действие ApplyFilter для фильтрации формы frmFoods при ее открытие.

**Пример кода из** [справочника программиста Microsoft Access 2010](https://www.amazon.com/Microsoft-Access-2010-Programmers-Reference/dp/8126528125).

```vb
    OpenForm
        Form Name sfrmFoods
        View Form
        Filter Name
        Where Condition
        Data Mode
        Window Mode Normal
    
    ApplyFilter
        Filter Name
        Where Condition=[display_name] Link "*cheese*"
        Control Name
```




---
title: Макрокоманда ApplyFilter
TOCTitle: ApplyFilter macro action
ms:assetid: c63988c4-4506-cc51-98f7-478d1f3fe668
ms:mtpsurl: https://msdn.microsoft.com/library/Ff823130(v=office.15)
ms:contentKeyID: 48547623
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm79035
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: e79ab56778f9429e7f1a985f0f81864ae4363606
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296999"
---
# <a name="applyfilter-macro-action"></a>Макрокоманда ApplyFilter

**Область применения**: Access 2013, Office 2013

Действие **ApplyFilter** можно использовать для применения фильтра, запроса или положения SQL WHERE к таблице, форме или отчету для ограничения или сортировки записей в таблице или записей из таблицы или запроса формы или отчета. Для отчетов это действие можно использовать только в макросе, указанном свойством **событий OnOpen** отчета.

> [!NOTE]
> Это действие можно использовать для применения пункта SQL WHERE только при применении фильтра сервера. Серверный фильтр не может применяться к источнику записей сохраненной процедуры.

## <a name="setting"></a>Параметр

Действие **ApplyFilter** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Имя фильтра</p></td>
<td><p>Имя фильтра или запроса, который ограничивает или сортит записи таблицы, формы или отчета. Вы можете ввести имя существующего запроса или фильтра, сохраненного в поле <strong>Имя</strong> фильтра в разделе <strong>Аргументы</strong> действий области <strong>Macro Builder.</strong></p><p><strong>ПРИМЕЧАНИЕ.</strong>При использовании этого действия для применения фильтра сервера аргумент Filter Name должен быть пустым.</p></td>
</tr>
<tr class="even">
<td><p>Где состояние</p></td>
<td><p>Допустимый SQL WHERE (без слова WHERE) или выражение, ограничивающее записи таблицы, формы или отчета.</p>
<p><b>ПРИМЕЧАНИЕ.</b>В выражении аргумента Where Condition левая сторона выражения обычно содержит имя поля из таблицы или запроса формы или отчета. Правая сторона выражения обычно содержит критерии, которые необходимо применить к этому полю для ограничения или сортировки записей. Например, критериями может быть имя управления в другой форме, содержа содержа которое содержит необходимое значение записей в первой форме для соответствия. Имя управления должно быть полностью квалифицировано, например:</p>
<p><strong>Формы</strong>! <em>formname!</em> <em>имя управления</em> Имена полей должны быть окружены двойными кавычками, а строковая буква должна быть окружена одними кавычками. Максимальная длина аргумента Where Condition — 255 символов. Если вам необходимо ввести более длинную оговорку SQL WHERE, используйте метод <strong>ApplyFilter</strong> объекта <strong>DoCmd</strong> в модуле Visual Basic для приложений (VBA). Вы можете ввести SQL, где в VBA можно ввести утверждения о клаузулах до 32 768 знаков.</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> Вы можете использовать аргумент Filter Name, если вы уже определили фильтр, который предоставляет соответствующие данные. Для прямого ввода критериев ограничения можно использовать аргумент Where Condition. Если вы используете оба аргумента, Microsoft Office Access 2007 применяет пункт WHERE к результатам фильтра. Необходимо использовать один или оба аргумента.

## <a name="remarks"></a>Примечания

Вы можете применить фильтр или запрос к форме в представлении формы или представлении таблицы данных.

Фильтр и условия WHERE, которые вы применяете, становятся параметром свойства Фильтр формы или отчета **или** **ServerFilter.**

Для таблиц и форм это действие аналогично нажатию применить **фильтр/сортировку** или применить серверный фильтр **в** меню **Records.** Команда меню применяет недавно созданный фильтр к таблице или форме, в то время как действие **ApplyFilter** применяет указанный фильтр или запрос.

В базе данных Доступа,  если вы указываете на фильтр в меню **Records,** а затем щелкните Расширенный **фильтр/Сортировка** после запуска действия **ApplyFilter,** в окне Advanced Filter/Sort показаны критерии фильтра, выбранные с помощью этого действия.

Чтобы удалить фильтр и отобразить все записи для таблицы или формы в базе данных Office Access 2007, можно использовать действие **ShowAllRecords** или команду **Remove Filter/Sort** в меню **Records.** Чтобы удалить фильтр в проекте Access (.adp), можно вернуться в окно Фильтр сервера  по форме и удалить все критерии фильтра, а затем нажмите кнопку Применить фильтр сервера в меню **Records** на панели инструментов или задать свойство **ServerFilterByForm** false  (0).

При сохранения таблицы или формы Access сохраняет любой фильтр, определенный в настоящее время в этом объекте, но не будет применять фильтр автоматически при следующем открываемом объекте (хотя он автоматически применяет любой вид, примененный к объекту до его сохранения). Если требуется автоматически применять фильтр при первом открывлении формы, укажите макрос, содержащий действие **ApplyFilter,** или процедуру событий, содержащую метод **ApplyFilter** объекта **DoCmd** в качестве параметра свойства **события OnOpen** формы. Фильтр также можно применить с помощью **действия OpenForm** или **OpenReport** или соответствующих методов. Чтобы автоматически применить фильтр при первом вскрытии таблицы, можно открыть таблицу с помощью макроса, содержащего действие **OpenTable,** а затем сразу же последует действие **ApplyFilter.**

## <a name="example"></a>Пример

В следующем примере показано, как использовать действие ApplyFilter для фильтрации формы frmFoods по мере ее открытия.

**Пример кода из** [справочника программиста Microsoft Access 2010](https://www.amazon.com/Microsoft-Access-2010-Programmers-Reference/dp/8126528125).

```vb
    OpenForm
        Form Name sfrmFoods
        View Form
        Filter Name
        Where Condition
        Data Mode
        Window Mode Normal
    
    ApplyFilter
        Filter Name
        Where Condition=[display_name] Link "*cheese*"
        Control Name
```




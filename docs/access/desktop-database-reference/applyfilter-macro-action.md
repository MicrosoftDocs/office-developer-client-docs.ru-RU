---
title: Макрокоманда ApplyFilter
TOCTitle: ApplyFilter macro action
ms:assetid: c63988c4-4506-cc51-98f7-478d1f3fe668
ms:mtpsurl: https://msdn.microsoft.com/library/Ff823130(v=office.15)
ms:contentKeyID: 48547623
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm79035
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: e79ab56778f9429e7f1a985f0f81864ae4363606
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296999"
---
# <a name="applyfilter-macro-action"></a>Макрокоманда ApplyFilter

**Область применения**: Access 2013, Office 2013

Макрокоманду **ПрименитьФильтр** можно использовать для применения фильтра, запроса или предложения WHERE SQL к таблице, форме или отчету, чтобы ограничить или отсортировать записи в таблице, или записи из базовой таблицы или запроса формы или отчета. Для отчетов это действие можно использовать только в макросе, указанном в свойстве события **OnOpen** отчета.

> [!NOTE]
> Это действие можно использовать для применения предложения WHERE в SQL только при применении серверного фильтра. Фильтр сервера нельзя применить к источнику записи хранимой процедуры.

## <a name="setting"></a>Параметр

Макрокоманда **ПрименитьФильтр** использует следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Имя фильтра</p></td>
<td><p>Имя фильтра или запроса, которые ограничивают или отсортирует записи таблицы, формы или отчета. Можно ввести имя существующего запроса или фильтра, сохраненного в виде запроса, в поле <strong>имя фильтра</strong> в разделе <strong>аргументы макрокоманды</strong> в области <strong>построителя макросов</strong> .</p><p><strong>Примечание</strong>. при использовании этого действия для применения серверного фильтра аргумент "имя фильтра" должен быть пустым.</p></td>
</tr>
<tr class="even">
<td><p>Условие отбора</p></td>
<td><p>Допустимое предложение WHERE (SQL) (без слова WHERE) или выражение, которое ограничит записи таблицы, формы или отчета.</p>
<p><b>Примечание</b>. в выражении аргумента WHERE в выражении левая часть выражения обычно содержит имя поля из базовой таблицы или запроса для формы или отчета. Правая часть выражения обычно содержит критерии, которые необходимо применить к этому полю, чтобы ограничить или отсортировать записи. Например, критерием может быть имя элемента управления в другой форме, которое содержит значение, которое должно совпадать с записями в первой форме. Имя элемента управления должно быть полным, например:</p>
<p><strong>Формы</strong>! <em>FormName</em>! <em>контролнаме</em> Имена полей должны быть заключены в двойные кавычки, а строковые литералы должны быть заключены в одинарные кавычки. Максимальная длина аргумента условия WHERE — 255 символов. Если необходимо ввести более длинное предложение WHERE SQL, используйте метод <strong>ApplyFilter</strong> объекта <strong>DoCmd</strong> в модуле Visual Basic для приложений (VBA). Вы можете ввести инструкции SQL WHERE, содержащие до 32 768 символов в VBA.</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> Вы можете использовать аргумент имя фильтра, если вы уже определили фильтр, который предоставляет соответствующие данные. Аргумент условия WHERE можно использовать для непосредственного ввода критериев ограничения. Если вы используете оба аргумента, Microsoft Office Access 2007 применяет предложение WHERE к результатам фильтра. Необходимо использовать один или оба аргумента.

## <a name="remarks"></a>Примечания

Вы можете применить фильтр или запрос к форме в режиме формы или таблицы.

Фильтр и условие, в котором вы хотите применить, становятся значением **фильтра** формы или отчета или свойства **ServerFilter** .

Для таблиц и форм это действие аналогично нажатию кнопки **Применить фильтр/сортировка** или **Применить фильтр сервера** в меню **записи** . Команда меню применяет последний созданный фильтр к таблице или форме, а Макрокоманда **ПрименитьФильтр** применяет указанный фильтр или запрос.

Если в базе данных Access навести указатель мыши на пункт **Фильтр** в меню **записи** , а затем выбрать команду **Расширенный фильтр/сортировка** после выполнения макрокоманды **ПрименитьФильтр** , в поле Расширенная фильтрация/сортировка отображаются условия фильтрации, выбранные с этим действием.

Чтобы удалить фильтр и отобразить все записи таблицы или формы в базе данных Office Access 2007, вы можете использовать действие **шоваллрекордс** или команду **удалить фильтр/сортировку** в меню **записи** . Чтобы удалить фильтр в проекте Access (ADP), можно вернуться в окно "серверный фильтр" и удалить все условия фильтра, а затем щелкнуть **Применить фильтр сервера** в меню **записи** на панели инструментов или задать для свойства **серверфилтербиформ** **значение false** (0).

При сохранении таблицы или формы Access сохраняет все фильтры, определенные в этом объекте, но не применяет фильтр автоматически при следующем открытии объекта (хотя он автоматически применяет любые виды сортировки, примененные к объекту перед его сохранением). Если вы хотите применить фильтр автоматически при первом открытии формы, укажите макрос, содержащий макрокоманду **ПрименитьФильтр** , или процедуру обработки события, содержащую метод **ApplyFilter** объекта **DoCmd** , в качестве значения свойства события **OnOpen** формы. Фильтр можно также применить с помощью макрокоманды « **ОткрытьФорму** » или « **ОткрытьОтчет** » или соответствующих методов. Чтобы применить фильтр автоматически при первом открытии таблицы, можно открыть таблицу с помощью макроса, содержащего действие **опентабле** , за которым следует действие **ПрименитьФильтр** сразу же.

## <a name="example"></a>Пример

В приведенном ниже примере показано, как с помощью макрокоманды ПрименитьФильтр отфильтровать форму Фрмфудс при ее открытии.

**Пример кода из** [справочника программиста Microsoft Access 2010](https://www.amazon.com/Microsoft-Access-2010-Programmers-Reference/dp/8126528125).

```vb
    OpenForm
        Form Name sfrmFoods
        View Form
        Filter Name
        Where Condition
        Data Mode
        Window Mode Normal
    
    ApplyFilter
        Filter Name
        Where Condition=[display_name] Link "*cheese*"
        Control Name
```




---
title: Глава 10. Записи и потоки
TOCTitle: 'Chapter 10: Records and streams'
ms:assetid: 74862096-2273-3b61-f89c-06554ccf42cd
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249477(v=office.15)
ms:contentKeyID: 48545663
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 1a47ac1f850905546651ffbdd708887bf7d74940
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296495"
---
# <a name="chapter-10-records-and-streams"></a><span data-ttu-id="75c6b-102">Глава 10. Записи и потоки</span><span class="sxs-lookup"><span data-stu-id="75c6b-102">Chapter 10: Records and streams</span></span>

<span data-ttu-id="75c6b-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="75c6b-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="75c6b-104">В настоящее время ADO предоставляет объект[Recordset](recordset-object-ado.md) в качестве основного способа доступа к информации в источниках данных, таких как реляционные базы данных.</span><span class="sxs-lookup"><span data-stu-id="75c6b-104">ADO currently provides the[Recordset](recordset-object-ado.md) object as the primary means of accessing information in data sources, such as relational databases.</span></span> <span data-ttu-id="75c6b-105">Однако некоторые поставщики поддерживают объекты [Record](record-object-ado.md) и [Stream](stream-object-ado.md) в качестве альтернативных или дополнительных объектов, с которыми могут работать данные от поставщиков.</span><span class="sxs-lookup"><span data-stu-id="75c6b-105">However, some providers support the [Record](record-object-ado.md) and [Stream](stream-object-ado.md) objects as alternative or complementary objects with which data from providers can be manipulated.</span></span> <span data-ttu-id="75c6b-106">Конкретные сведения о поведении **записей** можно найти в документации по поставщику.</span><span class="sxs-lookup"><span data-stu-id="75c6b-106">For specifics on **Record** behavior, see your provider's documentation.</span></span>

## <a name="records"></a><span data-ttu-id="75c6b-107">Запис</span><span class="sxs-lookup"><span data-stu-id="75c6b-107">Records</span></span>

<span data-ttu-id="75c6b-108">**Записи** объектов, по сути, работают как одноСтрочный **набор записей**s.</span><span class="sxs-lookup"><span data-stu-id="75c6b-108">**Record** objects essentially function as one-row **Recordset**s.</span></span> <span data-ttu-id="75c6b-109">Однако **записи** имеют ограниченные функциональные возможности по сравнению с **наборами записей** и имеют различные свойства и методы. Источником данных в объекте **Record** может быть команда, возвращающая одну строку данных от поставщика.</span><span class="sxs-lookup"><span data-stu-id="75c6b-109">However, **Records** have limited functionality compared to **Recordsets** and they have different properties and methods.The source for the data in a **Record** object can be a command which returns one row of data from the provider.</span></span> <span data-ttu-id="75c6b-110">Использование объектов **Record** , а не объектов **Recordset** для получения результатов из запроса, возвращающего одну строку данных, позволяет избежать издержек при создании экземпляра более сложного объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="75c6b-110">Using **Record** objects rather than **Recordset** objects to receive the results from a query that returns one row of data eliminates the overhead of instantiating the more complex **Recordset** object.</span></span>

<span data-ttu-id="75c6b-111">Объекты **Record** могут служить другой целью, особенно с поставщиками для источников данных, отличных от традиционных реляционных баз данных, таких как [поставщик Microsoft OLE DB для публикации в Интернете](microsoft-ole-db-provider-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="75c6b-111">**Record** objects can serve another purpose, particularly with providers for data sources other than traditional relational databases, such as the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="75c6b-112">Значительная часть информации, которая должна быть обработана, а не в виде таблиц в базах данных, а в современных файловых системах — сообщениям в системах электронной почты и файлах.</span><span class="sxs-lookup"><span data-stu-id="75c6b-112">Much of the information that must be processed exists, not as tables in databases, but as messages in electronic mail systems and files in modern file systems.</span></span> <span data-ttu-id="75c6b-113">Объекты **Record** и **Stream** упрощают доступ к данным, хранящимся в источниках, не связанных с реляционными базами данных.</span><span class="sxs-lookup"><span data-stu-id="75c6b-113">The **Record** and **Stream** objects facilitate access to information stored in sources other than relational databases.</span></span>

<span data-ttu-id="75c6b-114">Объект **Record** может представлять и управлять данными, такими как каталоги и файлы в файловой системе или папками и сообщениями в системе электронной почты.</span><span class="sxs-lookup"><span data-stu-id="75c6b-114">The **Record** object can represent and manage data such as directories and files in a file system or folders and messages in an email system.</span></span> <span data-ttu-id="75c6b-115">Для этих целей источник **записи** может быть текущей строкой открытого **набора записей**, АБСОЛЮТным URL-адресом или ОТНОСИТЕЛЬным URL-адресом в сочетании с открытым объектом [Connection](connection-object-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="75c6b-115">For these purposes, the source for the **Record** can be the current row of an open **Recordset**, an absolute URL, or a relative URL in conjunction with an open [Connection](connection-object-ado.md) object.</span></span>

<span data-ttu-id="75c6b-116">Как правило, объект **Recordset** можно использовать для представления контейнера или родительского элемента в иерархии, например в папке или каталоге.</span><span class="sxs-lookup"><span data-stu-id="75c6b-116">Typically, a **Recordset** can be used to represent a container or parent in a hierarchy such as a folder or directory.</span></span> <span data-ttu-id="75c6b-117">**Запись** можно использовать для возврата определенных сведений о одном узле в родительском контейнере, например файла или документа.</span><span class="sxs-lookup"><span data-stu-id="75c6b-117">A **Record** can be used to return specific information about one node in the parent container, such as a file or document.</span></span> <span data-ttu-id="75c6b-118">**Записи** основных причин, которые используются для представления этого типа информации, это то, что эти источники данных являются хетероженаус.</span><span class="sxs-lookup"><span data-stu-id="75c6b-118">The primary reason **Records** are used to represent this type of information is that these sources of data are heterogenous.</span></span> <span data-ttu-id="75c6b-119">Это означает, что каждая **запись** может иметь разный набор полей и число полей.</span><span class="sxs-lookup"><span data-stu-id="75c6b-119">This means that each **Record** may have a different set and number of fields.</span></span> <span data-ttu-id="75c6b-120">Традиционные **наборы записей** , содержащие строки из базы данных, являются однородными, что означает, что каждая строка имеет одинаковое число и тип полей.</span><span class="sxs-lookup"><span data-stu-id="75c6b-120">Traditional **Recordsets** containing rows from a database are homogenous, which means that each row has the same number and type of fields.</span></span>

<span data-ttu-id="75c6b-121">Дополнительные сведения об использовании объекта **Record** для обработки гетерогенных данных от поставщиков, таких как поставщик публикации в Интернете, приведены в статье [Использование ADO для публикации в Интернете](using-ado-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="75c6b-121">For more information about using the **Record** object for processing this heterogeneous data from providers such as the Internet Publishing Provider, see [Using ADO for Internet Publishing](using-ado-for-internet-publishing.md).</span></span>

## <a name="streams"></a><span data-ttu-id="75c6b-122">Представлений</span><span class="sxs-lookup"><span data-stu-id="75c6b-122">Streams</span></span>

<span data-ttu-id="75c6b-123">Объект **Stream** предоставляет средства для чтения, записи и управления потоком байтов.</span><span class="sxs-lookup"><span data-stu-id="75c6b-123">The **Stream** object provides the means to read, write, and manage a stream of bytes.</span></span> <span data-ttu-id="75c6b-124">Этот байтовый поток может быть текстовым или двоичным, и его размер ограничен только системными ресурсами.</span><span class="sxs-lookup"><span data-stu-id="75c6b-124">This byte stream may be text or binary and is limited in size only by system resources.</span></span> <span data-ttu-id="75c6b-125">Как правило, объекты **потоков** ADO используются в следующих целях:</span><span class="sxs-lookup"><span data-stu-id="75c6b-125">Typically, ADO **Stream** objects are used for the following purposes:</span></span>

- <span data-ttu-id="75c6b-126">Содержит текст или байты файла или сообщения, которые обычно используются с поставщиками, такими как Microsoft OLE DB Provider для публикации в Интернете.</span><span class="sxs-lookup"><span data-stu-id="75c6b-126">To contain the text or bytes that comprise a file or message, typically used with providers such as the Microsoft OLE DB Provider for Internet Publishing.</span></span> <span data-ttu-id="75c6b-127">Более подробную информацию об использовании объектов **Stream** можно узнать [в статье Использование ADO для публикации в Интернете](using-ado-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="75c6b-127">For more information about this use of **Stream** objects, see [Using ADO for Internet Publishing](using-ado-for-internet-publishing.md).</span></span>

<span data-ttu-id="75c6b-128">Объект **Stream** можно открыть в:</span><span class="sxs-lookup"><span data-stu-id="75c6b-128">A **Stream** object can be opened on:</span></span>

- <span data-ttu-id="75c6b-129">Простой файл, заданный с помощью URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="75c6b-129">A simple file specified with a URL.</span></span>

- <span data-ttu-id="75c6b-130">Поле **записи** или **набора записей** , содержащее объект **Stream** .</span><span class="sxs-lookup"><span data-stu-id="75c6b-130">A field of a **Record** or **Recordset** containing a **Stream** object.</span></span>

- <span data-ttu-id="75c6b-131">Поток по умолчанию **записи** или объекта **Recordset** , представляющий каталог или составной файл.</span><span class="sxs-lookup"><span data-stu-id="75c6b-131">The default stream of a **Record** or **Recordset** object representing a directory or compound file.</span></span>

- <span data-ttu-id="75c6b-132">Поле ресурса, содержащее URL-адрес простого файла.</span><span class="sxs-lookup"><span data-stu-id="75c6b-132">A resource field containing the URL of a simple file.</span></span>

- <span data-ttu-id="75c6b-133">Нет определенного источника вообще.</span><span class="sxs-lookup"><span data-stu-id="75c6b-133">No particular source at all.</span></span> <span data-ttu-id="75c6b-134">В этом случае объект **Stream** открывается в памяти.</span><span class="sxs-lookup"><span data-stu-id="75c6b-134">In this case, a **Stream** object is opened in memory.</span></span> <span data-ttu-id="75c6b-135">Данные могут быть записаны и сохранены в другом потоке \*\*\*\* или файле.</span><span class="sxs-lookup"><span data-stu-id="75c6b-135">Data can be written to it and then saved in another **Stream** or file.</span></span>

- <span data-ttu-id="75c6b-136">Поле BLOB-объекта в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="75c6b-136">A BLOB field in a **Recordset**.</span></span>

<span data-ttu-id="75c6b-137">В этой главе рассматриваются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="75c6b-137">This chapter covers the following topics:</span></span>

- [<span data-ttu-id="75c6b-138">Потоки и сохраняемость</span><span class="sxs-lookup"><span data-stu-id="75c6b-138">Streams and persistence</span></span>](streams-and-persistence.md)
- [<span data-ttu-id="75c6b-139">Записи и поля от поставщика</span><span class="sxs-lookup"><span data-stu-id="75c6b-139">Records and provider-supplied fields</span></span>](records-and-provider-supplied-fields.md)
- [<span data-ttu-id="75c6b-140">Абсолютные и относительные URL-адреса</span><span class="sxs-lookup"><span data-stu-id="75c6b-140">Absolute and relative URLs</span></span>](absolute-and-relative-urls.md)
- [<span data-ttu-id="75c6b-141">Использование ADO для публикации в Интернете (ADO)</span><span class="sxs-lookup"><span data-stu-id="75c6b-141">Using ADO for Internet publishing (ADO)</span></span>](using-ado-for-internet-publishing.md)

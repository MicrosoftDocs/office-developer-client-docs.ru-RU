---
title: Глава 10. Записи и потоки
TOCTitle: 'Chapter 10: Records and streams'
ms:assetid: 74862096-2273-3b61-f89c-06554ccf42cd
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249477(v=office.15)
ms:contentKeyID: 48545663
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 1a47ac1f850905546651ffbdd708887bf7d74940
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32296495"
---
# <a name="chapter-10-records-and-streams"></a><span data-ttu-id="d1c6d-102">Глава 10. Записи и потоки</span><span class="sxs-lookup"><span data-stu-id="d1c6d-102">Chapter 10: Records and streams</span></span>

<span data-ttu-id="d1c6d-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="d1c6d-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="d1c6d-104">ADO в настоящее время предоставляет объект[Recordset](recordset-object-ado.md) в качестве основного средства доступа к информации в источниках данных, таких как реляционные базы данных.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-104">ADO currently provides the[Recordset](recordset-object-ado.md) object as the primary means of accessing information in data sources, such as relational databases.</span></span> <span data-ttu-id="d1c6d-105">Однако некоторые поставщики поддерживают объекты [Record](record-object-ado.md) и [Stream](stream-object-ado.md) в качестве альтернативных или взаимодополняющих объектов, с которыми можно манипулировать данными от поставщиков.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-105">However, some providers support the [Record](record-object-ado.md) and [Stream](stream-object-ado.md) objects as alternative or complementary objects with which data from providers can be manipulated.</span></span> <span data-ttu-id="d1c6d-106">Подробнее о поведении **записи** см. в документации поставщика.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-106">For specifics on **Record** behavior, see your provider's documentation.</span></span>

## <a name="records"></a><span data-ttu-id="d1c6d-107">Записи</span><span class="sxs-lookup"><span data-stu-id="d1c6d-107">Records</span></span>

<span data-ttu-id="d1c6d-108">**Записывая** объекты, по сути, функционируют как однорядные **recordset** s.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-108">**Record** objects essentially function as one-row **Recordset** s.</span></span> <span data-ttu-id="d1c6d-109">Однако **записи имеют** ограниченные функциональные возможности по сравнению с **recordsets** и имеют различные свойства и методы. Источником данных в объекте **Record** может быть команда, которая возвращает один ряд данных от поставщика.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-109">However, **Records** have limited functionality compared to **Recordsets** and they have different properties and methods.The source for the data in a **Record** object can be a command which returns one row of data from the provider.</span></span> <span data-ttu-id="d1c6d-110">Использование **объектов Record,** а не **объектов Recordset** для получения результатов из запроса, возвращающего один ряд данных, устраняет накладную часть моментации более сложного объекта **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="d1c6d-110">Using **Record** objects rather than **Recordset** objects to receive the results from a query that returns one row of data eliminates the overhead of instantiating the more complex **Recordset** object.</span></span>

<span data-ttu-id="d1c6d-111">**Объекты** записи могут служить другой цели, особенно с поставщиками источников данных, помимо традиционных реляционных баз данных, таких как Поставщик DB Microsoft OLE для [публикации в Интернете.](microsoft-ole-db-provider-for-internet-publishing.md)</span><span class="sxs-lookup"><span data-stu-id="d1c6d-111">**Record** objects can serve another purpose, particularly with providers for data sources other than traditional relational databases, such as the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="d1c6d-112">Большая часть информации, которую необходимо обрабатывать, существует не в виде таблиц в базах данных, а в виде сообщений в системах электронной почты и файлах в современных файловой системе.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-112">Much of the information that must be processed exists, not as tables in databases, but as messages in electronic mail systems and files in modern file systems.</span></span> <span data-ttu-id="d1c6d-113">Объекты **Record** и **Stream** облегчают доступ к сведениям, хранимым в источниках, помимо реляционных баз данных.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-113">The **Record** and **Stream** objects facilitate access to information stored in sources other than relational databases.</span></span>

<span data-ttu-id="d1c6d-114">Объект **Record** может представлять и управлять данными, такими как каталоги и файлы в файловой системе или папках и сообщениях в системе электронной почты.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-114">The **Record** object can represent and manage data such as directories and files in a file system or folders and messages in an email system.</span></span> <span data-ttu-id="d1c6d-115">Для этих целей источником  записи может быть текущая строка open **Recordset,** абсолютный URL-адрес или относительный URL-адрес в сочетании с объектом open [Connection.](connection-object-ado.md)</span><span class="sxs-lookup"><span data-stu-id="d1c6d-115">For these purposes, the source for the **Record** can be the current row of an open **Recordset**, an absolute URL, or a relative URL in conjunction with an open [Connection](connection-object-ado.md) object.</span></span>

<span data-ttu-id="d1c6d-116">Как правило, **набор Recordset можно** использовать для представления контейнера или родителя в иерархии, например папки или каталога.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-116">Typically, a **Recordset** can be used to represent a container or parent in a hierarchy such as a folder or directory.</span></span> <span data-ttu-id="d1c6d-117">Запись **может** использоваться для возврата определенных сведений об одном узле родительского контейнера, например файле или документе.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-117">A **Record** can be used to return specific information about one node in the parent container, such as a file or document.</span></span> <span data-ttu-id="d1c6d-118">Основная **причина, по** которой записи используются для представления данных этого типа, заключается в том, что эти источники данных являются разнородными.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-118">The primary reason **Records** are used to represent this type of information is that these sources of data are heterogenous.</span></span> <span data-ttu-id="d1c6d-119">Это означает, что **у каждой записи** может быть свой набор и количество полей.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-119">This means that each **Record** may have a different set and number of fields.</span></span> <span data-ttu-id="d1c6d-120">Традиционные **записи,** содержащие строки из базы данных, однородны, что означает, что каждая строка имеет одинаковое число и тип полей.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-120">Traditional **Recordsets** containing rows from a database are homogenous, which means that each row has the same number and type of fields.</span></span>

<span data-ttu-id="d1c6d-121">Дополнительные сведения об использовании объекта **Record** для обработки этих разнородных данных от поставщиков, таких как поставщик публикаций в Интернете, см. в публикации ["Использование ADO для интернет-публикации".](using-ado-for-internet-publishing.md)</span><span class="sxs-lookup"><span data-stu-id="d1c6d-121">For more information about using the **Record** object for processing this heterogeneous data from providers such as the Internet Publishing Provider, see [Using ADO for Internet Publishing](using-ado-for-internet-publishing.md).</span></span>

## <a name="streams"></a><span data-ttu-id="d1c6d-122">Потоки</span><span class="sxs-lookup"><span data-stu-id="d1c6d-122">Streams</span></span>

<span data-ttu-id="d1c6d-123">Объект **Stream** предоставляет средства для чтения, записи и управления потоком bytes.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-123">The **Stream** object provides the means to read, write, and manage a stream of bytes.</span></span> <span data-ttu-id="d1c6d-124">Этот поток byte может быть текстовым или двоичным и ограничен размером только системных ресурсов.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-124">This byte stream may be text or binary and is limited in size only by system resources.</span></span> <span data-ttu-id="d1c6d-125">Как правило, объекты ADO **Stream** используются для следующих целей:</span><span class="sxs-lookup"><span data-stu-id="d1c6d-125">Typically, ADO **Stream** objects are used for the following purposes:</span></span>

- <span data-ttu-id="d1c6d-126">Чтобы содержать текст или bytes, которые составляют файл или сообщение, обычно используется с поставщиками, такими как Поставщик DB Microsoft OLE для интернет-публикации.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-126">To contain the text or bytes that comprise a file or message, typically used with providers such as the Microsoft OLE DB Provider for Internet Publishing.</span></span> <span data-ttu-id="d1c6d-127">Дополнительные сведения об использовании объектов **Stream** см. в публикации ["Использование ADO для интернет-публикации".](using-ado-for-internet-publishing.md)</span><span class="sxs-lookup"><span data-stu-id="d1c6d-127">For more information about this use of **Stream** objects, see [Using ADO for Internet Publishing](using-ado-for-internet-publishing.md).</span></span>

<span data-ttu-id="d1c6d-128">Объект **Stream** можно открыть по:</span><span class="sxs-lookup"><span data-stu-id="d1c6d-128">A **Stream** object can be opened on:</span></span>

- <span data-ttu-id="d1c6d-129">Простой файл, указанный с URL-адресом.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-129">A simple file specified with a URL.</span></span>

- <span data-ttu-id="d1c6d-130">Поле Record **или** **Recordset, содержащее** **объект Stream.**</span><span class="sxs-lookup"><span data-stu-id="d1c6d-130">A field of a **Record** or **Recordset** containing a **Stream** object.</span></span>

- <span data-ttu-id="d1c6d-131">Поток объекта Record **или** **Recordset** по умолчанию, представляющего каталог или сложный файл.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-131">The default stream of a **Record** or **Recordset** object representing a directory or compound file.</span></span>

- <span data-ttu-id="d1c6d-132">Поле ресурсов, содержащее URL-адрес простого файла.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-132">A resource field containing the URL of a simple file.</span></span>

- <span data-ttu-id="d1c6d-133">Нет конкретного источника вообще.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-133">No particular source at all.</span></span> <span data-ttu-id="d1c6d-134">В этом случае объект **Stream** открывается в памяти.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-134">In this case, a **Stream** object is opened in memory.</span></span> <span data-ttu-id="d1c6d-135">Данные можно написать в него, а затем сохранить в другом **потоке** или файле.</span><span class="sxs-lookup"><span data-stu-id="d1c6d-135">Data can be written to it and then saved in another **Stream** or file.</span></span>

- <span data-ttu-id="d1c6d-136">BLOB-поле в **наборе записей.**</span><span class="sxs-lookup"><span data-stu-id="d1c6d-136">A BLOB field in a **Recordset**.</span></span>

<span data-ttu-id="d1c6d-137">В этой главе освещают следующие темы:</span><span class="sxs-lookup"><span data-stu-id="d1c6d-137">This chapter covers the following topics:</span></span>

- [<span data-ttu-id="d1c6d-138">Потоки и сохраняемость</span><span class="sxs-lookup"><span data-stu-id="d1c6d-138">Streams and persistence</span></span>](streams-and-persistence.md)
- [<span data-ttu-id="d1c6d-139">Записи и поля от поставщика</span><span class="sxs-lookup"><span data-stu-id="d1c6d-139">Records and provider-supplied fields</span></span>](records-and-provider-supplied-fields.md)
- [<span data-ttu-id="d1c6d-140">Абсолютные и относительные URL-адреса</span><span class="sxs-lookup"><span data-stu-id="d1c6d-140">Absolute and relative URLs</span></span>](absolute-and-relative-urls.md)
- [<span data-ttu-id="d1c6d-141">Использование ADO для публикации в Интернете (ADO)</span><span class="sxs-lookup"><span data-stu-id="d1c6d-141">Using ADO for Internet publishing (ADO)</span></span>](using-ado-for-internet-publishing.md)

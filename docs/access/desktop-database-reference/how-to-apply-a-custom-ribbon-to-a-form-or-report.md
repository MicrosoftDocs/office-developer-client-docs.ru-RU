---
title: Применение пользовательской ленты к форме или отчету
TOCTitle: Apply a custom ribbon to a form or report
description: Узнайте, как применять пользовательские ленты при загрузке формы или отчета в Access 2013.
ms:assetid: 7dcdfa42-3eaa-43f9-b99d-56b2cac97f84
ms:mtpsurl: https://msdn.microsoft.com/library/Ff196428(v=office.15)
ms:contentKeyID: 48545865
ms.date: 10/16/2018
mtps_version: v=office.15
localization_priority: Priority
ms.openlocfilehash: 329f184a1bcd3c856ccfd0b15c3fa92bc6230c98
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28704002"
---
# <a name="apply-a-custom-ribbon-to-a-form-or-report"></a>Применение пользовательской ленты к форме или отчету

**Область применения**: Access 2013, Office 2013

На ленте используется текстовая, декларативная разметка XML, которая упрощает создание и настройку ленты. С помощью нескольких строк кода XML вы можете создать идеально подходящий для пользователя интерфейс. В Access доступны широкие возможности настройки пользовательского интерфейса ленты. 

Например, разметку для настройки можно сохранить в таблице, внедрить в процедуру VBA или сохранить в другой базе данных Access. На нее также можно сослаться с листа Excel. В этой статье описывается применение пользовательских лент при загрузке формы или отчета.

## <a name="make-the-ribbon-customization-xml-available"></a>Предоставление доступа к коду XML для настройки ленты

### <a name="store-ribbon-extensibility-xml-in-a-table"></a>Сохранение кода XML для расширения ленты в таблице

Один из способов предоставления доступа к настройкам ленты — сохранить их в таблице. Сохранив настройки в таблице **USysRibbons**, их можно реализовать без использования макросов и кода VBA.

**USysRibbons** — это созданная пользователем системная таблица. Таблицу необходимо создать с использованием конкретных имен столбцов для реализуемых настроек ленты. 

В приведенной ниже таблице перечислены параметры, используемые при создании таблицы **USysRibbons**.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя столбца</p></th>
<th><p>Тип данных</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>RibbonName</strong></p></td>
<td><p>Текст</p></td>
<td><p>Содержит имя пользовательской ленты, которая будет связана с этой настройкой.</p></td>
</tr>
<tr class="even">
<td><p><strong>RibbonXML</strong></p></td>
<td><p>Заметка</p></td>
<td><p>Содержит код XML для расширения ленты (RibbonX), определяющий настройку ленты.</p></td>
</tr>
</tbody>
</table>


### <a name="load-ribbon-extensibility-xml-programmatically"></a>Программная загрузка кода XML для расширения ленты

Вы можете использовать метод **[LoadCustomUI](https://docs.microsoft.com/office/vba/api/Access.Application.LoadCustomUI)** для загрузки настроек ленты программным образом. Как правило, чтобы создать ленту и сделать ее доступной приложению, необходимо сначала создать модуль в базе данных с помощью процедуры, вызывающей метод **LoadCustomUI**, передав имя ленты в разметку настройки XML.

Разметка XML может быть взята из объекта **Recordset**, созданного с помощью таблицы, из источника за пределами базы данных, например XML-файла, преобразованного в строку, или из разметки XML, внедренной непосредственно в процедуру. Вы можете создавать различные ленты с помощью нескольких вызовов метода **LoadCustomUI**, передавая разную разметку XML, при условии что имя каждой ленты и атрибуты **id** вкладок, из которых состоит лента, будут уникальными.

По завершении процедуры можно создать макрос AutoExec, вызывающий процедуру с помощью действия RunCode. Таким образом, при запуске приложения автоматически выполняется метод **LoadCustomUI**, а приложению предоставляется доступ ко всем пользовательским лентам.

## <a name="assign-custom-ribbons-to-forms-or-reports"></a>Назначение пользовательских лент формам и отчетам

1.  Выполните описанные выше действия, чтобы сделать настроенную ленту доступной приложению.

2.  Откройте форму или отчет в режиме конструктора.

3.  На вкладке "Конструктор" выберите элемент **Страница свойств**.

4.  На вкладке **Все** окна свойств выберите список **Имя ленты**, а затем выберите ленту.

5.  Сохраните, закройте и заново откройте форму или отчет. Появится выбранный пользовательский интерфейс ленты.


> [!NOTE]
> Вкладки пользовательского интерфейса ленты является аддитивными. Это означает, что если вкладки не скрыты явным образом, а для атрибута *Начать с нуля* не задано значения **True**, то вкладки, отображаемые в пользовательском интерфейсе ленты для формы или отчета, будут добавлены к имеющимся вкладкам.

> [!NOTE]
> Дополнительные сведения о пользовательском интерфейсе ленты в других приложениях Office см. в статье [Обзор ленты Office Fluent](https://docs.microsoft.com/office/vba/Library-Reference/Concepts/overview-of-the-office-fluent-ribbon).



---
title: Параметры события (Справочник по базам данных Access на компьютере)
TOCTitle: Event parameters
ms:assetid: 626de9b1-4d45-d77e-ccf2-23f2ea31c043
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249371(v=office.15)
ms:contentKeyID: 48545239
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: dd4a99ec24a05084a2ae137ded3219c2997f8cf3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32293317"
---
# <a name="event-parameters"></a>Параметры событий

**Область применения**: Access 2013, Office 2013

Каждый обработчик событий имеет параметр status, который управляет обработчиком событий. Для полных событий этот параметр также используется для указания на успешное или неудачное выполнение операции, создавшей событие. Большинство полных событий также содержат параметр Error для предоставления сведений о любой произошедшей ошибке, а также один или несколько параметров объекта, которые ссылаются на объекты ADO, используемые для выполнения операции. Например, событие [событие executecomplete](executecomplete-event-ado.md) включает параметры объекта для **команды**, **набора записей**и объектов **подключения** , связанных с событием. В приведенном ниже примере Microsoft Visual Basic можно просмотреть объекты Пкомманд, a и Пконнектион, представляющие **команды**, записи и объекты **подключения** , используемые методом **EXECUTE** . ****

```vb 
 
Private Sub connEvent_ExecuteComplete(ByVal RecordsAffected As Long, _ 
 ByVal pError As ADODB.Error, _ 
 adStatus As ADODB.EventStatusEnum, _ 
 ByVal pCommand As ADODB.Command, _ 
 ByVal pRecordset As ADODB.Recordset, _ 
 ByVal pConnection As ADODB.Connection) 
```

За исключением объекта **Error** , событиям будут переданы те же параметры. Это дает возможность проверить каждый объект, который будет использоваться в операции ожидания, и определить, следует ли выполнить операцию.

У некоторых обработчиков событий есть параметр *Reason* , который предоставляет дополнительные сведения о причине возникновения события. Например, события **события WillMove** и **MoveComplete** могут возникать из-за того, что один из методов навигации (**MoveNext**, **MovePrevious**и т. д.) вызывается или как результат запроса Requery.

## <a name="status-parameter"></a>Параметр Status

При вызове процедуры обработчика событий для параметра *Status* задается одно из следующих значений.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Адстатусок</strong></p></td>
<td><p>ПереДается обоим событиям. Это значение указывает на то, что операция, вызвавшая событие, успешно завершена.</p></td>
</tr>
<tr class="even">
<td><p><strong>Адстатусеррорсоккурред</strong></p></td>
<td><p>ПереДается только для завершения событий. Это значение означает, что операция, вызвавшая событие, была неудачной, или событие будет отменено при выполнении операции. Для получения дополнительных сведений обратитесь к параметру <em>Error</em> .</p></td>
</tr>
<tr class="odd">
<td><p><strong>Адстатускантдени</strong></p></td>
<td><p>ПереДается только событиям. Это значение указывает на то, что операция не может быть отменена событием. Его необходимо выполнить.</p></td>
</tr>
</tbody>
</table>


Если вы определили, что в случае события будет продолжаться операция, оставьте параметр *Status* без изменений. Однако, если параметру Status Status не присвоено значение **адстатускантдени**, вы можете отменить эту операцию, изменив *состояние* на **адстатусканцел**. При этом для события Complete, связанного с операцией, для параметра *Status* задано значение **адстатусеррорсоккурред**. Объект **Error** , переданный в событие complete, содержит значение **адерроператионканцеллед**.

Если вы больше не хотите обрабатывать событие, можно установить для него *состояние* **адстатусунвантедевент** , и ваше приложение больше не будет получать уведомления о событии. Однако помните, что некоторые события могут вызываться по более чем одной причине. В этом случае необходимо указать **адстатусунвантедевент** по каждой из возможных причин. Например, чтобы прекратить получение уведомлений о незавершенных событиях **рекордчанже** , необходимо задать для параметра *Status* значение **адстатусунвантедевент** для **адрснадднев**, **адрснделете**, **адрснупдате**, ** Адрснундаупдате**, **адрснундоадднев**, **адрснундоделете**и **адрснфирстчанже** по мере их появления.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Адстатусунвантедевент</strong></p></td>
<td><p>Запрос на получение дальнейших уведомлений этим обработчиком событий.</p></td>
</tr>
<tr class="even">
<td><p><strong>Адстатусканцел</strong></p></td>
<td><p>ЗаПросите отмену операции, которая будет выполняться.</p></td>
</tr>
</tbody>
</table>


## <a name="error-parameter"></a>Параметр error

Параметр *Error* является ссылкой на объект [ошибки](error-object-ado.md) ADO. Если для параметра *Status* задано значение **Адстатусеррорсоккурред**, объект **Error** содержит сведения о причине сбоя операции. Если событие, связанное с событием Complete, отменило операцию, присвоив параметру *Status* значение **адстатусканцел**, объект Error всегда будет иметь значение **адерроператионканцеллед**.

## <a name="object-parameter"></a>Параметр объекта

Каждое событие получает один или несколько объектов, представляющих объекты, вовлеченные в операцию. Например, событие **событие executecomplete** получает объект **Command** , объект **Recordset** и объект **Connection** .

## <a name="reason-parameter"></a>Параметр Reason

Параметр *Reason* , *адреасон*, предоставляет дополнительные сведения о причине возникновения события. События с параметром *адреасон* могут быть вызваны несколько раз, даже для одной и той же операции, по разным причинам. Например, обработчик событий **события willchangerecord** вызывается для тех операций, которые будут выполняться или отменены при вставке, удалении или изменении записи. Если вы хотите обработать событие, только когда оно происходит по определенной причине, можно использовать параметр *адреасон* для фильтрации ненужных экземпляров. Например, если вы хотите обрабатывать события изменения записей только в том случае, если они появлялись из-за добавления записи, можно выполнить следующие действия:

```vb 
 
' BeginEventExampleVB01 
Private Sub rsTest_WillChangeRecord(ByVal adReason As ADODB.EventReasonEnum, ByVal cRecords As Long, adStatus As ADODB.EventStatusEnum, ByVal pRecordset As ADODB.Recordset) 
 If adReason = adRsnAddNew Then 
 ' Process event 
 '... 
 Else 
 ' Cancel event notification for all 
 ' other possible adReason values. 
 adStatus = adStatusUnwantedEvent 
 End If 
End Sub 
' EndEventExampleVB01 
```

В этом случае уведомления могут возникать по другим причинам. Однако он будет повторяться по одной из причин. После получения уведомления по каждой из причин вы получите уведомление только о добавлении новой записи.

В отличие от этого, необходимо установить *адстатус* в **адстатусунвантедевент** только один раз, чтобы запросить, чтобы обработчик событий без параметра **адреасон** больше не получать уведомления о событиях.


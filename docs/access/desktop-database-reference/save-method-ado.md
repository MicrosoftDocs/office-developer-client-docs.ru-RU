---
title: Сохранение метода — ActiveX объектов данных (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 0a3762c3d4fdb8cc833259b0435b225690d677ce
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308920"
---
# <a name="save-method-ado"></a>Метод сохранения (ADO)

**Область применения**: Access 2013, Office 2013

Сохраняет набор [записей в](recordset-object-ado.md) файле или [объекте Stream.](stream-object-ado.md)

## <a name="syntax"></a>Синтаксис

*набор записей.* Сохранение *назначения*, *PersistFormat*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Destination* |Необязательный параметр. **Вариант,** который представляет полное имя пути файла, в котором должен быть сохранен **Набор** записей, или ссылку на объект **Stream.**|
|*PersistFormat* |Необязательный параметр. Значение [PersistFormatEnum,](persistformatenum.md) которое указывает формат,  в котором будет сохранен набор записей (XML или ADTG). По умолчанию значение **adPersistADTG**.|

## <a name="remarks"></a>Примечания

Метод **Сохранить** можно вызывать только в открытом **наборе записей.** Используйте метод [Open](open-method-ado-recordset.md) для более позднего восстановления **наборов записей** из *назначения.*

Если свойство [Filter](filter-property-ado.md) действует для **recordset,** сохраняются только строки, доступные под фильтром. Если набор **записей** иерархичен, то  текущий набор записей ребенка и его дети сохраняются, в том числе родительский **Набор записей.** Если называется **метод** Сохранить  набор записей для ребенка, ребенок и все его дети сохраняются, но родитель — нет.

При первом сохранения **наборов записей** необязательно указывать *назначение.* Если упустить *назначение,* будет создан новый файл с именем, за набором имени к значению свойства [Source](source-property-ado-recordset.md) **в Recordset.**

Omit *Destination,* когда вы впоследствии вызываете **Сохранить** после первого сохранения, или произойдет ошибка времени запуска. Если впоследствии вы вызываете **Сохранить** с помощью нового *назначения,* **набор записей** сохраняется в новом пункте назначения. Однако новое назначение и исходное назначение будут открыты.

**Сохранение** не закрывает **набор записей** или *назначения,* поэтому вы можете продолжить работу с **набором записей** и сохранить последние изменения. *Пункт назначения* остается открытым до закрытия **Recordset.**

По соображениям безопасности метод **Save** позволяет использовать только низкие и настраиваемые параметры безопасности из сценария, выполненного Microsoft Internet Explorer. Дополнительные сведения о проблемах безопасности см. в статье "Проблемы безопасности ADO и RDS в Microsoft Internet Explorer" в статье ActiveX Объекты данных (ADO) в технических статьях Microsoft Data Access.

Если метод **Сохранить** вызван, пока выполняется асинхронная операция извлечения,  выполнения или обновления, сохраните ожидание завершения асинхронной операции. 

Записи сохраняются начиная с первого ряда **наборов записей.** По **завершению** метода Сохранить текущая позиция строки перемещается в первую строку **наборов Записей.**

Для наилучших результатов задайте [свойство CursorLocation](cursorlocation-property-ado.md) **adUseClient** с **сохранением**. Если поставщик не поддерживает все функции, необходимые для сохранения объектов **Recordset,** служба Cursor предоставит эти функции.

При **сохраняемом** наборе записей с свойством **CursorLocation,** задаваемом **adUseServer,** возможности обновления **для набора записей** ограничены. Как правило, допускаются только одностоловые обновления, вставки и удаления (в зависимости от функциональности поставщика). Метод [Resync](resync-method-ado.md) также недоступен в этой конфигурации.

> [!NOTE]
> Сохранение **наборов записей** с полями типа **adVariant,** **adIDispatch** или **adIUnknown** не поддерживается ADO и может привести к непредсказуемым результатам. 

Только **фильтры** в виде строк Критериев (например, OrderDate \> '12/31/1999') влияют на содержимое сохраняемого **наборов записей.** Фильтры, созданные  с помощью массива закладок или с помощью значения **filterGroupEnum,** не влияют на содержимое сохраняемого **Набор записей.** Эти правила применяются к **записям,** созданным с помощью курсоров на стороне клиента или сервера.

Так как *параметр Destination* может принимать любой объект, который поддерживает интерфейс IStream OLE DB, можно сохранить набор **Записей** непосредственно к объекту asP Response. Дополнительные сведения см. в [XML-сценарии сохранения записей.](xml-recordset-persistence-scenario.md)

Можно также сохранить набор **записей** в формате XML в экземпляре объекта MSXML DOM, как показано в следующем Visual Basic коде:

> [!NOTE]
> При сохранении иерархических наборов **записей** (форм данных) в формате XML применяются два ограничения. Невозможно сохранить XML, если иерархический **набор записей** содержит ожидающих обновлений, а параметризированный иерархический **набор записей** сохранить невозможно.

Сохраненный в формате XML набор записей сохранен с помощью формата UTF-8. Когда такой файл загружается в ADO Stream, объект Stream не будет пытаться открыть набор записей из потока, если свойство Charset потока не будет задано соответствующему значению для формата UTF-8.


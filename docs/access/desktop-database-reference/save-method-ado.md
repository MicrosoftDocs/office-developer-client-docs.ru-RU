---
title: Метод Save — объекты данных ActiveX (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 0a3762c3d4fdb8cc833259b0435b225690d677ce
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308920"
---
# <a name="save-method-ado"></a>Метод Save (ADO)

**Область применения**: Access 2013, Office 2013

Сохраняет [набор записей](recordset-object-ado.md) в объекте File или [Stream](stream-object-ado.md) .

## <a name="syntax"></a>Синтаксис

*набор записей*. *Место назначения*для сохранения, *персистформат*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Destination* |Необязательный атрибут. **Переменная типа Variant** , представляющая полный путь к файлу, в котором будет сохранен **набор записей** , или ссылку на объект **Stream** .|
|*Персистформат* |Необязательный атрибут. Значение [персистформатенум](persistformatenum.md) , задающее формат, в котором будет сохранен **набор записей** (XML или адтг). Значение по умолчанию — **адперсистадтг**.|

## <a name="remarks"></a>Замечания

Метод **Save** может вызываться только для открытого **набора записей**. Используйте метод [Open](open-method-ado-recordset.md) , чтобы позже восстановить **набор записей** из *места назначения*.

Если свойство [Filter](filter-property-ado.md) применяется для объекта **Recordset**, сохраняются только те строки, которые доступны в фильтре. Если объект **Recordset** является иерархический, то текущий доЧерний **набор записей** и его дочерние элементы сохраняются, в том числе родительский **набор записей**. При вызове метода **Save** дочернего объекта **Recordset** , дочерний объект и все его дочерние элементы сохраняются, а родитель — нет.

При первом сохранении объекта **Recordset**необязательно указывать *назначение*. Если параметр *Destination*опущен, будет создан новый файл с именем, равным значению свойства [Source](source-property-ado-recordset.md) объекта **Recordset**.

Не указывайте *назначение* при последующем вызове **Save** после первого сохранения или при возникновении ошибки времени выполнения. Если вы затем вызываете метод **Save** с новым *пунктом назначения*, то **набор записей** сохраняется в новом месте. Тем не менее, будет открыто новое место назначения и исходное место назначения.

При **сохранении** не закрываетСя объект **Recordset** или *Destination*, поэтому вы можете продолжить работу с **набором записей** и сохранить последние изменения. *Назначение* остается открытым до закрытия **набора записей** .

В целях безопасности метод **Save** позволяет использовать только нестандартные параметры безопасности из скрипта, выполняемого Microsoft Internet Explorer. Более подробное описание вопросов безопасности приведено в статьях "вопросы безопасности ADO и RDS в Microsoft Internet Explorer" в статье Data Object Data Objects (ADO Data Objects) в статье Data Data Objects (ADO) в технической статье Microsoft Data Access.

Если метод **Save** вызывается во время выполнения асинхронной операции получения, выполнения или обновления **набора записей** , то функция **сохранения** ждет, пока не завершится асинхронная операция.

Записи сохраняются начиная с первой строки **набора записей**. После завершения метода **Save** текущая позиция строки перемещается в первую строку **набора записей**.

Для получения лучших результатов установите для свойства [CursorLocation](cursorlocation-property-ado.md) значение **адусеклиент** с параметром **Save**. Если ваш поставщик не поддерживает все функции, необходимые для сохранения объектов **Recordset** , Служба курсора предоставит эту функцию.

Если для **** свойства **CursorLocation** задано значение **Адусесервер**, возможность обновления для **набора записей** ограничена. Как правило, допускается только обновление, вставка и удаление с использованием одной таблицы (зависит от функциональных возможностей поставщика). Метод [Resync](resync-method-ado.md) также недоступен в этой конфигурации.

> [!NOTE]
> Сохранение **набора записей** с **полями** типа **адвариант**, **адидиспатч**или **адиункновн** не поддерживается ADO и может привести к непредсказуемым результатам.

Только **фильтры** в форме строк условий (например, OrderDate \> ' 12/31/1999 ') влияют на Содержимое материализованного **набора записей**. Фильтры, созданные с помощью массива **закладок** или значения из **филтерграупенум** , не влияют на Содержимое материализованного **набора записей**. Эти правила применяются к **наборАм записей** , созданным с помощью клиентских или серверных курсоров.

Так как параметр *Destination* может принимать любой объект, поддерживающий интерфейс ISTREAM OLE DB, можно сохранить объект **Recordset** непосредственно в ответном объекте ASP. Более подробную информацию можно узнать в [сценарии сохраняемости в XML Recordset](xml-recordset-persistence-scenario.md).

Вы также можете сохранить **набор записей** в формате XML в экземпляре объекта MSXML DOM, как показано в следующем примере кода Visual Basic:

> [!NOTE]
> При сохранении иерархических **наборов записей** (форм данных) в формате XML применяются два ограничения. Невозможно сохранить в XML, если иерархический **набор записей** содержит ожидающие обновления, и вы не можете сохранить параметризованный иерархический **набор записей**.

Набор записей, сохраненный в формате XML, сохраняется в формате UTF-8. Когда такой файл загружается в поток ADO, объект Stream не будет пытаться открыть объект Recordset из потока, если для свойства charset потока не задано соответствующее значение для формата UTF-8.


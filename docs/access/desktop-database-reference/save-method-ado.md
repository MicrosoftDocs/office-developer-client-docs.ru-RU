---
title: Метод Save — ActiveX Data Objects (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 0a3762c3d4fdb8cc833259b0435b225690d677ce
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308920"
---
# <a name="save-method-ado"></a>Метод Save (ADO)

**Область применения**: Access 2013, Office 2013

Сохраняет набор [записей в](recordset-object-ado.md) файле или [объекте Stream.](stream-object-ado.md)

## <a name="syntax"></a>Синтаксис

*recordset*. Сохранение *назначения*, *PersistFormat*

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|:--------|:----------|
|*Destination* |Необязательный параметр. **Вариант,** который представляет полный путь к файлу, в котором будет сохранен набор записей, или ссылку на объект **Stream.** |
|*PersistFormat* |Необязательный параметр. Значение [PersistFormatEnum,](persistformatenum.md) которое указывает формат, в котором необходимо сохранить набор **записей** (XML или ADTG). Значение по умолчанию **— adPersistADTG.**|

## <a name="remarks"></a>Заметки

Метод **Save** можно вызвать только в открытом **наборе записей.** Используйте метод [Open,](open-method-ado-recordset.md) чтобы позднее восстановить **набор записей** из *назначения.*

Если свойство [Filter](filter-property-ado.md) действует для **объекта Recordset,** сохраняются только строки, доступные в фильтре. Если набор **записей иерархичен,** то текущий потомок **Recordset** и его потомки сохраняются, включая родительский **набор записей.** Если вызван **метод Save** для child **Recordset,** то он и все его потомки сохраняются, а родительский — нет.

При первом сохранения **recordset** указывать назначение *необязательно.* Если опустить *destination,* будет создан новый файл со значением свойства [Source](source-property-ado-recordset.md) объекта **Recordset.**

Опустить *пункт назначения* при последующем вызове "Сохранить" после первого сохранения или при этом произойдет ошибка во время запуска.  При последующем вызове **функции "Сохранить** с новым назначением" набор  **записей** сохраняется в новом месте назначения. Однако новое и исходное назначения будут открыты.

**Сохранение** не закрывает набор **записей** или *назначение,* поэтому вы можете продолжать работать с **набором записей** и сохранять последние изменения. *Назначение* остается открытым, пока **набор записей не** будет закрыт.

В целях безопасности метод **Save** позволяет использовать только параметры низкой и настраиваемой безопасности из сценария, выполненного Microsoft Internet Explorer. Более подробное описание проблем безопасности см. в статье "ADO and RDS Security Issues in Microsoft Internet Explorer" статьи ActiveX Data Objects (ADO) Technical Articles in Microsoft Data Access Technical Articles.

Если метод **Save** вызван во время  выполнения асинхронной операции получения, выполнения  или обновления наборов записей, сохранение будет выполняться до завершения асинхронной операции.

Записи сохраняются, начиная с первой строки **наборов записей.** После завершения работы метода **Save** текущая позиция строки перемещается в первую строку **recordset.**

Для наилучших результатов задайте для свойства [CursorLocation](cursorlocation-property-ado.md) свойство **adUseClient** с **сохранением.** Если поставщик не поддерживает все функции, необходимые для сохранения объектов **Recordset,** служба курсоров предоставляет эту функцию.

Если набор **записей** сохраняется со свойством **CursorLocation,** установленным для **adUseServer,** возможность обновления для **набора записей** ограничена. Как правило, разрешены только обновления, вставки и удаления из одной таблицы (в зависимости от функциональности поставщика). Метод [Resync](resync-method-ado.md) также недоступен в этой конфигурации.

> [!NOTE]
> Сохранение **recordset** с **полями** типа **adVariant,** **adIDispatch** или **adIUnknown** не поддерживается ADO и может привести к непредсказуемым результатам.

Только **фильтры** в виде строк условий (например, OrderDate \> '12/31/1999') влияют на содержимое сохраняемого **recordset**. Фильтры, созданные  с помощью массива закладок или использования значения **из FilterGroupEnum,** не влияют на содержимое сохраняемого **recordset.** Эти правила применяются **к записям,** созданным с помощью клиентских или серверных курсоров.

Так как *параметр Destination* может принимать любой объект, который поддерживает интерфейс OLE DB IStream, можно сохранить **объект Recordset** непосредственно в объекте ответа ASP. Дополнительные сведения см. в сценарии [сохраняемости наборов записей XML.](xml-recordset-persistence-scenario.md)

Можно также сохранить объект **Recordset** в формате XML в экземпляре MSXML DOM, как показано в следующем Visual Basic коде:

> [!NOTE]
> При сохранении иерархических наборов **записей** (фигур данных) в формате XML действуют два ограничения. Невозможно сохранить в XML, если иерархический набор **записей** содержит ожидающих обновлений и нельзя сохранить параметризованный **иерархический набор записей.**

Набор записей, сохраненный в формате XML, сохраняются в формате UTF-8. Когда такой файл загружается в поток ADO, объект Stream не будет пытаться открыть набор записей из потока, если для свойства Charset потока не будет установлено соответствующее значение для формата UTF-8.


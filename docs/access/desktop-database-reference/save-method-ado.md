---
title: Метод - Save ActiveX Data Objects (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 0a3762c3d4fdb8cc833259b0435b225690d677ce
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28712143"
---
# <a name="save-method-ado"></a>Метод Save (ADO)

**Применимо к**: Access 2013, Office 2013

Сохранение [набора записей](recordset-object-ado.md) в файл или объект [Stream](stream-object-ado.md) .

## <a name="syntax"></a>Синтаксис

*набор записей*. Сохранение*назначения*, *PersistFormat*

## <a name="parameters"></a>Parameters

|Параметр|Описание|
|:--------|:----------|
|*Destination* |Необязательно. **Variant** , представляющий полный путь файла, в которых будут сохраняться **записей** или ссылку на объект **Stream** .|
|*PersistFormat* |Необязательно. [PersistFormatEnum](persistformatenum.md) значение, указывающее формат, в котором должен быть сохранен (XML или ADTG) **набора записей** . Значение по умолчанию — **adPersistADTG**.|

## <a name="remarks"></a>Замечания

Метод **Save** можно вызвать только на открытие **набора записей**. Используйте метод [Open](open-method-ado-recordset.md) позднее восстановление **набора записей** из *места назначения*.

Если **записей**не свойство [фильтра](filter-property-ado.md) , будут сохранены только строки, доступных в группе фильтр. Если иерархических **записей** , затем дочерние текущего **набора записей** и его дочерние элементы сохраняются, включая родительского **набора записей**. Метод **Save** дочернего вызванный **записей** , дочерних и все его дочерние элементы сохраняются, но родительский не.

При первом сохранении **набора записей**, он не является обязательным для указания *назначения*. Если параметр *результат*не задан, будет создан новый файл с именем, задайте значение свойства [источника](source-property-ado-recordset.md) **записей**.

Параметр *результат* не задан, при последовательном вызове **Сохранить** после первого сохранить или произойдет ошибка во время выполнения. При последующем вызове **Сохранить** с нового *назначения*, **записей** сохраняется в новое место назначения. Тем не менее новые назначения и конечный оба будет открыть.

**Сохранить** не закрывается **записей** или *назначения*, поэтому можно продолжать работать с **набора записей** и сохраните изменения. *Назначение* остается открытым до закрытия **набора записей** .

По соображениям безопасности метод **Save** разрешает использование безопасности низкой и пользовательские параметры из сценарий, выполняемый с Microsoft Internet Explorer. Более подробное описание проблемы безопасности в разделе «ADO и RDS безопасности проблемы в Microsoft Internet Explorer» в разделе ActiveX Data Objects (ADO) технические статьи в технические статьи доступа к данным Microsoft.

Если метод **Save** вызывается при асинхронное извлечение **записей** , execute или обновить операция находится в стадии разработки, а затем **Сохраните** ожидает до завершения асинхронной операции.

Записи сохраняются, начиная с первой строки текущего **набора записей**. После завершения метода **Save** первой строки текущего **набора записей**перемещаются текущей позиции строки.

Для достижения наилучших результатов присвойте свойству [CursorLocation](cursorlocation-property-ado.md) значение **adUseClient** с **Сохранить**. Если ваш поставщик поддерживает все функциональные возможности, необходимые для сохранения **записей** объекты, службы курсора будет предоставлять функциональные возможности.

После сохранения **записей** со свойством **CursorLocation** , задайте значение **adUseServer**ограничено возможность обновления для **набора записей** . Как правило только для одной таблицы обновления, вставки и удаления могут (зависит от функциональности поставщика). Метод [выполнить повторную синхронизацию](resync-method-ado.md) также недоступен в этой конфигурации.

> [!NOTE]
> Сохранение **набора записей** с **полей** типа **adVariant**, **adIDispatch**или **adIUnknown** ADO не поддерживается и может привести к непредсказуемым последствиям.

Только **фильтры** в виде строки критерии (например OrderDate \> "12/31/1999") влияет на содержимое постоянных **набора записей**. Фильтры, созданные с помощью массива **закладки** или с использованием значения из **FilterGroupEnum** не влияет на содержимое постоянных **набора записей**. Эти правила применяются к **наборов записей** , созданных с помощью курсоры со стороны клиента или на сервере.

Так как параметр *назначения* может принимать любой объект, который поддерживает интерфейс OLE DB IStream, можно сохранить **записей** непосредственно к объекту ASP ответа. Дополнительные сведения можно найти в [Сценарии хранение записей XML](xml-recordset-persistence-scenario.md).

Можно также сохранить **набора записей** в формате XML в экземпляр объекта MSXML DOM, как показано в следующем коде Visual Basic:

> [!NOTE]
> Два ограничения при сохранении иерархические **наборы записей** (данные фигуры) в формате XML. Не удается сохранить в XML, если иерархических **записей** содержит ожидающие обновления и не могут сохранять параметризованный иерархических **набора записей**.

Записей, сохраненных в формате XML сохраняется в формате UTF-8. При такой файл загружается в ADO Stream, объект Stream не будет предпринята попытка открытия набора записей в потоке, если свойство Charset потока не установлен в соответствующее значение формат UTF-8.


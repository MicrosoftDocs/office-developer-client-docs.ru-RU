---
title: Сохранение метода — ActiveX объектов данных (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 0a3762c3d4fdb8cc833259b0435b225690d677ce
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32308920"
---
# <a name="save-method-ado"></a><span data-ttu-id="fcb60-102">Метод сохранения (ADO)</span><span class="sxs-lookup"><span data-stu-id="fcb60-102">Save method (ADO)</span></span>

<span data-ttu-id="fcb60-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="fcb60-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="fcb60-104">Сохраняет набор [записей в](recordset-object-ado.md) файле или [объекте Stream.](stream-object-ado.md)</span><span class="sxs-lookup"><span data-stu-id="fcb60-104">Saves the [Recordset](recordset-object-ado.md) in a file or [Stream](stream-object-ado.md) object.</span></span>

## <a name="syntax"></a><span data-ttu-id="fcb60-105">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="fcb60-105">Syntax</span></span>

<span data-ttu-id="fcb60-106">*набор записей.* Сохранение *назначения*, *PersistFormat*</span><span class="sxs-lookup"><span data-stu-id="fcb60-106">*recordset*.Save *Destination*, *PersistFormat*</span></span>

## <a name="parameters"></a><span data-ttu-id="fcb60-107">Параметры</span><span class="sxs-lookup"><span data-stu-id="fcb60-107">Parameters</span></span>

|<span data-ttu-id="fcb60-108">Параметр</span><span class="sxs-lookup"><span data-stu-id="fcb60-108">Parameter</span></span>|<span data-ttu-id="fcb60-109">Описание</span><span class="sxs-lookup"><span data-stu-id="fcb60-109">Description</span></span>|
|:--------|:----------|
|<span data-ttu-id="fcb60-110">*Destination*</span><span class="sxs-lookup"><span data-stu-id="fcb60-110">*Destination*</span></span> |<span data-ttu-id="fcb60-111">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="fcb60-111">Optional.</span></span> <span data-ttu-id="fcb60-112">**Вариант,** который представляет полное имя пути файла, в котором должен быть сохранен **Набор** записей, или ссылку на объект **Stream.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-112">A **Variant** that represents the complete path name of the file where the **Recordset** is to be saved, or a reference to a **Stream** object.</span></span>|
|<span data-ttu-id="fcb60-113">*PersistFormat*</span><span class="sxs-lookup"><span data-stu-id="fcb60-113">*PersistFormat*</span></span> |<span data-ttu-id="fcb60-114">Необязательный параметр.</span><span class="sxs-lookup"><span data-stu-id="fcb60-114">Optional.</span></span> <span data-ttu-id="fcb60-115">Значение [PersistFormatEnum,](persistformatenum.md) которое указывает формат,  в котором будет сохранен набор записей (XML или ADTG).</span><span class="sxs-lookup"><span data-stu-id="fcb60-115">A [PersistFormatEnum](persistformatenum.md) value that specifies the format in which the **Recordset** is to be saved (XML or ADTG).</span></span> <span data-ttu-id="fcb60-116">По умолчанию значение **adPersistADTG**.</span><span class="sxs-lookup"><span data-stu-id="fcb60-116">The default value is **adPersistADTG**.</span></span>|

## <a name="remarks"></a><span data-ttu-id="fcb60-117">Примечания</span><span class="sxs-lookup"><span data-stu-id="fcb60-117">Remarks</span></span>

<span data-ttu-id="fcb60-118">Метод **Сохранить** можно вызывать только в открытом **наборе записей.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-118">The **Save** method can only be invoked on an open **Recordset**.</span></span> <span data-ttu-id="fcb60-119">Используйте метод [Open](open-method-ado-recordset.md) для более позднего восстановления **наборов записей** из *назначения.*</span><span class="sxs-lookup"><span data-stu-id="fcb60-119">Use the [Open](open-method-ado-recordset.md) method to later restore the **Recordset** from *Destination*.</span></span>

<span data-ttu-id="fcb60-120">Если свойство [Filter](filter-property-ado.md) действует для **recordset,** сохраняются только строки, доступные под фильтром.</span><span class="sxs-lookup"><span data-stu-id="fcb60-120">If the [Filter](filter-property-ado.md) property is in effect for the **Recordset**, then only the rows accessible under the filter are saved.</span></span> <span data-ttu-id="fcb60-121">Если набор **записей** иерархичен, то  текущий набор записей ребенка и его дети сохраняются, в том числе родительский **Набор записей.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-121">If the **Recordset** is hierarchical, then the current child **Recordset** and its children are saved, including the parent **Recordset**.</span></span> <span data-ttu-id="fcb60-122">Если называется **метод** Сохранить  набор записей для ребенка, ребенок и все его дети сохраняются, но родитель — нет.</span><span class="sxs-lookup"><span data-stu-id="fcb60-122">If the **Save** method of a child **Recordset** is called, the child and all its children are saved, but the parent is not.</span></span>

<span data-ttu-id="fcb60-123">При первом сохранения **наборов записей** необязательно указывать *назначение.*</span><span class="sxs-lookup"><span data-stu-id="fcb60-123">The first time you save the **Recordset**, it is optional to specify *Destination*.</span></span> <span data-ttu-id="fcb60-124">Если упустить *назначение,* будет создан новый файл с именем, за набором имени к значению свойства [Source](source-property-ado-recordset.md) **в Recordset.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-124">If you omit *Destination*, a new file will be created with a name set to the value of the [Source](source-property-ado-recordset.md) property of the **Recordset**.</span></span>

<span data-ttu-id="fcb60-125">Omit *Destination,* когда вы впоследствии вызываете **Сохранить** после первого сохранения, или произойдет ошибка времени запуска.</span><span class="sxs-lookup"><span data-stu-id="fcb60-125">Omit *Destination* when you subsequently call **Save** after the first save, or a run-time error will occur.</span></span> <span data-ttu-id="fcb60-126">Если впоследствии вы вызываете **Сохранить** с помощью нового *назначения,* **набор записей** сохраняется в новом пункте назначения.</span><span class="sxs-lookup"><span data-stu-id="fcb60-126">If you subsequently call **Save** with a new *Destination*, the **Recordset** is saved to the new destination.</span></span> <span data-ttu-id="fcb60-127">Однако новое назначение и исходное назначение будут открыты.</span><span class="sxs-lookup"><span data-stu-id="fcb60-127">However, the new destination and the original destination will both be open.</span></span>

<span data-ttu-id="fcb60-128">**Сохранение** не закрывает **набор записей** или *назначения,* поэтому вы можете продолжить работу с **набором записей** и сохранить последние изменения.</span><span class="sxs-lookup"><span data-stu-id="fcb60-128">**Save** does not close the **Recordset** or *Destination*, so you can continue to work with the **Recordset** and save your most recent changes.</span></span> <span data-ttu-id="fcb60-129">*Пункт назначения* остается открытым до закрытия **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-129">*Destination* remains open until the **Recordset** is closed.</span></span>

<span data-ttu-id="fcb60-130">По соображениям безопасности метод **Save** позволяет использовать только низкие и настраиваемые параметры безопасности из сценария, выполненного Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="fcb60-130">For reasons of security, the **Save** method permits only the use of low and custom security settings from a script executed by Microsoft Internet Explorer.</span></span> <span data-ttu-id="fcb60-131">Дополнительные сведения о проблемах безопасности см. в статье "Проблемы безопасности ADO и RDS в Microsoft Internet Explorer" в статье ActiveX Объекты данных (ADO) в технических статьях Microsoft Data Access.</span><span class="sxs-lookup"><span data-stu-id="fcb60-131">For a more detailed explanation of security issues, see "ADO and RDS Security Issues in Microsoft Internet Explorer" under ActiveX Data Objects (ADO) Technical Articles in Microsoft Data Access Technical Articles.</span></span>

<span data-ttu-id="fcb60-132">Если метод **Сохранить** вызван, пока выполняется асинхронная операция извлечения,  выполнения или обновления, сохраните ожидание завершения асинхронной операции. </span><span class="sxs-lookup"><span data-stu-id="fcb60-132">If the **Save** method is called while an asynchronous **Recordset** fetch, execute, or update operation is in progress, then **Save** waits until the asynchronous operation is complete.</span></span>

<span data-ttu-id="fcb60-133">Записи сохраняются начиная с первого ряда **наборов записей.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-133">Records are saved beginning with the first row of the **Recordset**.</span></span> <span data-ttu-id="fcb60-134">По **завершению** метода Сохранить текущая позиция строки перемещается в первую строку **наборов Записей.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-134">When the **Save** method is finished, the current row position is moved to the first row of the **Recordset**.</span></span>

<span data-ttu-id="fcb60-135">Для наилучших результатов задайте [свойство CursorLocation](cursorlocation-property-ado.md) **adUseClient** с **сохранением**.</span><span class="sxs-lookup"><span data-stu-id="fcb60-135">For best results, set the [CursorLocation](cursorlocation-property-ado.md) property to **adUseClient** with **Save**.</span></span> <span data-ttu-id="fcb60-136">Если поставщик не поддерживает все функции, необходимые для сохранения объектов **Recordset,** служба Cursor предоставит эти функции.</span><span class="sxs-lookup"><span data-stu-id="fcb60-136">If your provider does not support all of the functionality necessary to save **Recordset** objects, the Cursor Service will provide that functionality.</span></span>

<span data-ttu-id="fcb60-137">При **сохраняемом** наборе записей с свойством **CursorLocation,** задаваемом **adUseServer,** возможности обновления **для набора записей** ограничены.</span><span class="sxs-lookup"><span data-stu-id="fcb60-137">When a **Recordset** is persisted with the **CursorLocation** property set to **adUseServer**, the update capability for the **Recordset** is limited.</span></span> <span data-ttu-id="fcb60-138">Как правило, допускаются только одностоловые обновления, вставки и удаления (в зависимости от функциональности поставщика).</span><span class="sxs-lookup"><span data-stu-id="fcb60-138">Typically, only single-table updates, insertions, and deletions are allowed (dependant upon provider functionality).</span></span> <span data-ttu-id="fcb60-139">Метод [Resync](resync-method-ado.md) также недоступен в этой конфигурации.</span><span class="sxs-lookup"><span data-stu-id="fcb60-139">The [Resync](resync-method-ado.md) method is also unavailable in this configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="fcb60-140">Сохранение **наборов записей** с полями типа **adVariant,** **adIDispatch** или **adIUnknown** не поддерживается ADO и может привести к непредсказуемым результатам. </span><span class="sxs-lookup"><span data-stu-id="fcb60-140">Saving a **Recordset** with **Fields** of type **adVariant**, **adIDispatch**, or **adIUnknown** is not supported by ADO and can cause unpredictable results.</span></span>

<span data-ttu-id="fcb60-141">Только **фильтры** в виде строк Критериев (например, OrderDate \> '12/31/1999') влияют на содержимое сохраняемого **наборов записей.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-141">Only **Filters** in the form of Criteria Strings (e.g. OrderDate \> '12/31/1999') affect the contents of a persisted **Recordset**.</span></span> <span data-ttu-id="fcb60-142">Фильтры, созданные  с помощью массива закладок или с помощью значения **filterGroupEnum,** не влияют на содержимое сохраняемого **Набор записей.**</span><span class="sxs-lookup"><span data-stu-id="fcb60-142">Filters created with an Array of **Bookmarks** or using a value from the **FilterGroupEnum** will not affect the contents of the persisted **Recordset**.</span></span> <span data-ttu-id="fcb60-143">Эти правила применяются к **записям,** созданным с помощью курсоров на стороне клиента или сервера.</span><span class="sxs-lookup"><span data-stu-id="fcb60-143">These rules apply to **Recordsets** created with either client-side or server-side cursors.</span></span>

<span data-ttu-id="fcb60-144">Так как *параметр Destination* может принимать любой объект, который поддерживает интерфейс IStream OLE DB, можно сохранить набор **Записей** непосредственно к объекту asP Response.</span><span class="sxs-lookup"><span data-stu-id="fcb60-144">Because the *Destination* parameter can accept any object that supports the OLE DB IStream interface, you can save a **Recordset** directly to the ASP Response object.</span></span> <span data-ttu-id="fcb60-145">Дополнительные сведения см. в [XML-сценарии сохранения записей.](xml-recordset-persistence-scenario.md)</span><span class="sxs-lookup"><span data-stu-id="fcb60-145">For more details, please see the [XML Recordset Persistence Scenario](xml-recordset-persistence-scenario.md).</span></span>

<span data-ttu-id="fcb60-146">Можно также сохранить набор **записей** в формате XML в экземпляре объекта MSXML DOM, как показано в следующем Visual Basic коде:</span><span class="sxs-lookup"><span data-stu-id="fcb60-146">You can also save a **Recordset** in XML format to an instance of an MSXML DOM object, as is shown in the following Visual Basic code:</span></span>

> [!NOTE]
> <span data-ttu-id="fcb60-147">При сохранении иерархических наборов **записей** (форм данных) в формате XML применяются два ограничения.</span><span class="sxs-lookup"><span data-stu-id="fcb60-147">Two limitations apply when saving hierarchical **Recordsets** (data shapes) in XML format.</span></span> <span data-ttu-id="fcb60-148">Невозможно сохранить XML, если иерархический **набор записей** содержит ожидающих обновлений, а параметризированный иерархический **набор записей** сохранить невозможно.</span><span class="sxs-lookup"><span data-stu-id="fcb60-148">You cannot save into XML if the hierarchical **Recordset** contains pending updates, and you cannot save a parameterized hierarchical **Recordset**.</span></span>

<span data-ttu-id="fcb60-149">Сохраненный в формате XML набор записей сохранен с помощью формата UTF-8.</span><span class="sxs-lookup"><span data-stu-id="fcb60-149">A Recordset saved in XML format is saved using UTF-8 format.</span></span> <span data-ttu-id="fcb60-150">Когда такой файл загружается в ADO Stream, объект Stream не будет пытаться открыть набор записей из потока, если свойство Charset потока не будет задано соответствующему значению для формата UTF-8.</span><span class="sxs-lookup"><span data-stu-id="fcb60-150">When such a file is loaded into an ADO Stream, the Stream object will not attempt to open a Recordset from the stream unless the Charset property of the stream is set to the appropriate value for UTF-8 format.</span></span>


---
title: Метод - Save ActiveX Data Objects (ADO)
TOCTitle: Save method (ADO)
ms:assetid: 02dab13b-f947-b96d-46ea-0def3ed8f28f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ248793(v=office.15)
ms:contentKeyID: 48542968
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: d779fc5cff955ca669635ca827456dafb8927d8a
ms.sourcegitcommit: d7248f803002b31cf7fc561b03530199a9b0a8fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/02/2018
ms.locfileid: "25919684"
---
# <a name="save-method-ado"></a>Метод Save (ADO)


**Применимо к**: Access 2013, Office 2013

Сохранение [набора записей](recordset-object-ado.md) в файл или объект [Stream](stream-object-ado.md) .

## <a name="syntax"></a>Синтаксис

*набор записей*. Сохранение*назначения*, *PersistFormat*

## <a name="parameters"></a>Параметры

  - *Назначения*

  - Необязательно указывать. **Variant** , представляющий полный путь файла, в которых будут сохраняться **записей** или ссылку на объект **Stream** .

  - *PersistFormat*

  - Необязательно указывать. [PersistFormatEnum](persistformatenum.md) значение, указывающее формат, в котором должен быть сохранен (XML или ADTG) **набора записей** . Значение по умолчанию — **adPersistADTG**.

## <a name="remarks"></a>Примечания

Метод **Save** можно вызвать только на открытие **набора записей**. Используйте метод [Open](open-method-ado-recordset.md) позднее восстановление **набора записей** из *места назначения*.

Если **записей**не свойство [фильтра](filter-property-ado.md) , будут сохранены только строки, доступных в группе фильтр. Если иерархических **записей** , затем дочерние текущего **набора записей** и его дочерние элементы сохраняются, включая родительского **набора записей**. Метод **Save** дочернего вызванный **записей** , дочерних и все его дочерние элементы сохраняются, но родительский не.

При первом сохранении **набора записей**, он не является обязательным для указания *назначения*. Если параметр *результат*не задан, будет создан новый файл с именем, задайте значение свойства [источника](source-property-ado-recordset.md) **записей**.

Параметр *результат* не задан, при последовательном вызове **Сохранить** после первого сохранить или произойдет ошибка во время выполнения. При последующем вызове **Сохранить** с нового *назначения*, **записей** сохраняется в новое место назначения. Тем не менее новые назначения и конечный оба будет открыть.

**Сохранить** не закрывается **записей** или *назначения*, поэтому можно продолжать работать с **набора записей** и сохраните изменения. *Назначение* остается открытым до закрытия **набора записей** .

По соображениям безопасности метод **Save** разрешает использование безопасности низкой и пользовательские параметры из сценарий, выполняемый с Microsoft Internet Explorer. Более подробное описание проблемы безопасности в разделе «ADO и RDS безопасности проблемы в Microsoft Internet Explorer» в разделе ActiveX Data Objects (ADO) технические статьи в технические статьи доступа к данным Microsoft.

Если метод **Save** вызывается при асинхронное извлечение **записей** , execute или обновить операция находится в стадии разработки, а затем **Сохраните** ожидает до завершения асинхронной операции.

Записи сохраняются, начиная с первой строки текущего **набора записей**. После завершения метода **Save** первой строки текущего **набора записей**перемещаются текущей позиции строки.

Для достижения наилучших результатов присвойте свойству [CursorLocation](cursorlocation-property-ado.md) значение **adUseClient** с **Сохранить**. Если ваш поставщик поддерживает все функциональные возможности, необходимые для сохранения **записей** объекты, службы курсора будет предоставлять функциональные возможности.

После сохранения **записей** со свойством **CursorLocation** , задайте значение **adUseServer**ограничено возможность обновления для **набора записей** . Как правило только для одной таблицы обновления, вставки и удаления могут (зависит от функциональности поставщика). Метод [выполнить повторную синхронизацию](resync-method-ado.md) также недоступен в этой конфигурации.


> [!NOTE]
> <P>Сохранение <STRONG>набора записей</STRONG> с <STRONG>полей</STRONG> типа <STRONG>adVariant</STRONG>, <STRONG>adIDispatch</STRONG>или <STRONG>adIUnknown</STRONG> ADO не поддерживается и может привести к непредсказуемым последствиям.</P>



Только **фильтры** в виде строки критерии (например OrderDate \> "12/31/1999") влияет на содержимое постоянных **набора записей**. Фильтры, созданные с помощью массива **закладки** или с использованием значения из **FilterGroupEnum** не влияет на содержимое постоянных **набора записей**. Эти правила применяются к **наборов записей** , созданных с помощью курсоры со стороны клиента или на сервере.

Так как параметр *назначения* может принимать любой объект, который поддерживает интерфейс OLE DB IStream, можно сохранить **записей** непосредственно к объекту ASP ответа. Дополнительные сведения можно найти в [Сценарии хранение записей XML](xml-recordset-persistence-scenario.md).

Можно также сохранить **набора записей** в формате XML в экземпляр объекта MSXML DOM, как показано в следующем коде Visual Basic:


> [!NOTE]
> <P>Два ограничения при сохранении иерархические <STRONG>наборы записей</STRONG> (данные фигуры) в формате XML. Не удается сохранить в XML, если иерархических <STRONG>записей</STRONG> содержит ожидающие обновления и не могут сохранять параметризованный иерархических <STRONG>набора записей</STRONG>.</P>



Записей, сохраненных в формате XML сохраняется в формате UTF-8. При такой файл загружается в ADO Stream, объект Stream не будет предпринята попытка открытия набора записей в потоке, если свойство Charset потока не установлен в соответствующее значение формат UTF-8.


---
title: Свойство ActiveConnection (ADO)
TOCTitle: ActiveConnection property (ADO)
ms:assetid: 5501b2d7-b62c-5fff-1edd-2b7efb3f8c4a
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249281(v=office.15)
ms:contentKeyID: 48544918
ms.date: 10/17/2018
mtps_version: v=office.15
f1_keywords:
- ado210.chm1231115
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: 037ae753f427c42f147972170dbb2e645b260623
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32282532"
---
# <a name="activeconnection-property-ado"></a><span data-ttu-id="a034f-102">Свойство ActiveConnection (ADO)</span><span class="sxs-lookup"><span data-stu-id="a034f-102">ActiveConnection property (ADO)</span></span>

<span data-ttu-id="a034f-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="a034f-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="a034f-104">Указывает, к какому объекту [подключения](connection-object-ado.md) принадлежит указанная [команда](command-object-ado.md), [набор записей](recordset-object-ado.md)или объект [Record](record-object-ado.md) , который в настоящее время принадлежит.</span><span class="sxs-lookup"><span data-stu-id="a034f-104">Indicates to which [Connection](connection-object-ado.md) object the specified [Command](command-object-ado.md), [Recordset](recordset-object-ado.md), or [Record](record-object-ado.md) object currently belongs.</span></span>

## <a name="settings-and-return-values"></a><span data-ttu-id="a034f-105">Параметры и возвращаемые значения</span><span class="sxs-lookup"><span data-stu-id="a034f-105">Settings and return values</span></span>

<span data-ttu-id="a034f-106">Задает или возвращает **строковое** значение, содержащее определение подключения, если соединение закрыто, или **переменная Variant** , содержащая текущий объект **Connection** , если подключение открыто.</span><span class="sxs-lookup"><span data-stu-id="a034f-106">Sets or returns a **String** value that contains a definition for a connection if the connection is closed, or a **Variant** containing the current **Connection** object if the connection is open.</span></span> <span data-ttu-id="a034f-107">Значение по умолчанию — пустая ссылка на объект.</span><span class="sxs-lookup"><span data-stu-id="a034f-107">Default is a null object reference.</span></span> <span data-ttu-id="a034f-108">Просмотрите свойство [ConnectionString](connectionstring-property-ado.md) .</span><span class="sxs-lookup"><span data-stu-id="a034f-108">See the [ConnectionString](connectionstring-property-ado.md) property.</span></span>

## <a name="remarks"></a><span data-ttu-id="a034f-109">Замечания</span><span class="sxs-lookup"><span data-stu-id="a034f-109">Remarks</span></span>

<span data-ttu-id="a034f-110">Используйте свойство **ActiveConnection** для определения объекта **подключения** , для которого будет выполняться указанный объект **команды** , или будет открыт указанный **набор записей** .</span><span class="sxs-lookup"><span data-stu-id="a034f-110">Use the **ActiveConnection** property to determine the **Connection** object over which the specified **Command** object will execute or the specified **Recordset** will be opened.</span></span>

### <a name="command"></a><span data-ttu-id="a034f-111">Command</span><span class="sxs-lookup"><span data-stu-id="a034f-111">Command</span></span>

<span data-ttu-id="a034f-112">Для объектов **Command** свойство **ActiveConnection** доступно для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="a034f-112">For **Command** objects, the **ActiveConnection** property is read/write.</span></span>

<span data-ttu-id="a034f-113">Если вы попытаетесь вызвать метод [EXECUTE](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) для объекта **Command** перед тем, как присвоить этому свойству объект открытого **подключения** или допустимую строку подключения, возникнет ошибка.</span><span class="sxs-lookup"><span data-stu-id="a034f-113">If you attempt to call the [Execute](https://docs.microsoft.com/office/vba/access/concepts/miscellaneous/execute-method-ado-command) method on a **Command** object before setting this property to an open **Connection** object or valid connection string, an error occurs.</span></span>

<span data-ttu-id="a034f-114">**Microsoft Visual Basic**: Установка для свойства **ActiveConnection** значения *Nothing* отменяет связь объекта **Command** с текущим **подключением** и заставляет поставщика освобождать все связанные ресурсы в данных. Source.</span><span class="sxs-lookup"><span data-stu-id="a034f-114">**Microsoft Visual Basic**: Setting the **ActiveConnection** property to *Nothing* disassociates the **Command** object from the current **Connection** and causes the provider to release any associated resources on the data source.</span></span> <span data-ttu-id="a034f-115">Затем вы можете связать объект **Command** с тем же или другим объектом **Connection** .</span><span class="sxs-lookup"><span data-stu-id="a034f-115">You can then associate the **Command** object with the same or another **Connection** object.</span></span> <span data-ttu-id="a034f-116">Некоторые поставщики позволяют изменить значение свойства с одного **подключения** на другое без необходимости устанавливать для свойства *значение Nothing*.</span><span class="sxs-lookup"><span data-stu-id="a034f-116">Some providers allow you to change the property setting from one **Connection** to another, without having to first set the property to *Nothing*.</span></span>

<span data-ttu-id="a034f-117">Если коллекция [Parameters](parameters-collection-ado.md) объекта **Command** содержит параметры, предоставляемые поставщиком, то коллекция очищается, если для свойства **ActiveConnection** задано значение *Nothing* или другое объект **Connection** .</span><span class="sxs-lookup"><span data-stu-id="a034f-117">If the [Parameters](parameters-collection-ado.md) collection of the **Command** object contains parameters supplied by the provider, the collection is cleared if you set the **ActiveConnection** property to *Nothing* or to another **Connection** object.</span></span> <span data-ttu-id="a034f-118">Если вы вручную создаете объекты [параметров](parameter-object-ado.md) и используете их для заполнения коллекции **Parameters** объекта **Command** , установка для свойства **ActiveConnection** значения *Nothing* или другого объекта **подключения** оставляет Коллекция **Parameters** не изменяется.</span><span class="sxs-lookup"><span data-stu-id="a034f-118">If you manually create [Parameter](parameter-object-ado.md) objects and use them to fill the **Parameters** collection of the **Command** object, setting the **ActiveConnection** property to *Nothing* or to another **Connection** object leaves the **Parameters** collection intact.</span></span>

<span data-ttu-id="a034f-119">При закрытии объекта **подключения** , с которым связан объект **Command** , свойству **ActiveConnection** присваивается *значение Nothing*.</span><span class="sxs-lookup"><span data-stu-id="a034f-119">Closing the **Connection** object with which a **Command** object is associated sets the **ActiveConnection** property to *Nothing*.</span></span> <span data-ttu-id="a034f-120">При задании этого свойства для закрытого объекта **подключения** возникнет ошибка.</span><span class="sxs-lookup"><span data-stu-id="a034f-120">Setting this property to a closed **Connection** object generates an error.</span></span>

### <a name="recordset"></a><span data-ttu-id="a034f-121">Recordset</span><span class="sxs-lookup"><span data-stu-id="a034f-121">Recordset</span></span>

<span data-ttu-id="a034f-122">Для объектов Open **Recordset** или объектов **Recordset** , свойству [Source](source-property-ado-recordset.md) которых присвоено значение допустимого объекта **Command** , свойство **ActiveConnection** доступно только для чтения.</span><span class="sxs-lookup"><span data-stu-id="a034f-122">For open **Recordset** objects or for **Recordset** objects whose [Source](source-property-ado-recordset.md) property is set to a valid **Command** object, the **ActiveConnection** property is read-only.</span></span> <span data-ttu-id="a034f-123">В противном случае он доступен для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="a034f-123">Otherwise, it is read/write.</span></span>

<span data-ttu-id="a034f-124">Этому свойству можно присвоить допустимый объект **подключения** или допустимую строку подключения.</span><span class="sxs-lookup"><span data-stu-id="a034f-124">You can set this property to a valid **Connection** object or to a valid connection string.</span></span> <span data-ttu-id="a034f-125">В этом случае поставщик создает новый объект **Connection** с помощью этого определения и открывает подключение.</span><span class="sxs-lookup"><span data-stu-id="a034f-125">In this case, the provider creates a new **Connection** object using this definition and opens the connection.</span></span> <span data-ttu-id="a034f-126">Кроме того, поставщик может задать для этого свойства новый объект **Connection** , чтобы предоставить доступ к объекту **Connection** для расширенных сведений об ошибках или выполнить другие команды.</span><span class="sxs-lookup"><span data-stu-id="a034f-126">Additionally, the provider may set this property to the new **Connection** object to give you a way to access the **Connection** object for extended error information or to execute other commands.</span></span>

<span data-ttu-id="a034f-127">Если вы используете аргумент *ActiveConnection* метода [Open](open-method-ado-recordset.md) , чтобы открыть объект **Recordset** , свойство **ActiveConnection** унаследует значение аргумента.</span><span class="sxs-lookup"><span data-stu-id="a034f-127">If you use the *ActiveConnection* argument of the [Open](open-method-ado-recordset.md) method to open a **Recordset** object, the **ActiveConnection** property will inherit the value of the argument.</span></span>

<span data-ttu-id="a034f-128">Если присвоить свойству **Source** объекта **Recordset** допустимую переменную объект **Command** , свойство **ActiveConnection** объекта **Recordset** наследует параметр \*\*\*\* \*\* Свойство ActiveConnection\*\* .</span><span class="sxs-lookup"><span data-stu-id="a034f-128">If you set the **Source** property of the **Recordset** object to a valid **Command** object variable, the **ActiveConnection** property of the **Recordset** inherits the setting of the **Command** object's **ActiveConnection** property.</span></span>

<span data-ttu-id="a034f-129">**Использование удаленной службы данных**: при использовании в объекте Recordset на стороне клиента это свойство можно задать только для строки подключения или (в Microsoft Visual Basic или Visual Basic, Scripting Edition) на *Nothing*.</span><span class="sxs-lookup"><span data-stu-id="a034f-129">**Remote Data Service Usage**: When used on a client-side Recordset object, this property can be set only to a connection string or (in Microsoft Visual Basic or Visual Basic, Scripting Edition) to *Nothing*.</span></span>

### <a name="record"></a><span data-ttu-id="a034f-130">Record</span><span class="sxs-lookup"><span data-stu-id="a034f-130">Record</span></span>

<span data-ttu-id="a034f-131">Это свойство доступно для чтения и записи, когда объект **Record** закрыт, и может содержать строку подключения или ссылку на открытый объект **подключения** .</span><span class="sxs-lookup"><span data-stu-id="a034f-131">This property is read/write when the **Record** object is closed, and may contain a connection string or reference to an open **Connection** object.</span></span> <span data-ttu-id="a034f-132">Это свойство доступно только для чтения, если открыт объект **Record** , и содержит ссылку на объект открытого **подключения** .</span><span class="sxs-lookup"><span data-stu-id="a034f-132">This property is read-only when the **Record** object is open, and contains a reference to an open **Connection** object.</span></span>

<span data-ttu-id="a034f-133">Объект **Connection** неявно создается при открытии объекта **Record** по URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="a034f-133">A **Connection** object is created implicitly when the **Record** object is opened from a URL.</span></span> <span data-ttu-id="a034f-134">Откройте **запись** с существующим объектом открытого **подключения** , назначив объект **Connection** этому свойству или используя объект **Connection** в качестве параметра в вызове метода [Open](open-method-ado-record.md) .</span><span class="sxs-lookup"><span data-stu-id="a034f-134">Open the **Record** with an existing, open **Connection** object by assigning the **Connection** object to this property, or using the **Connection** object as a parameter in the [Open](open-method-ado-record.md) method call.</span></span> <span data-ttu-id="a034f-135">Если **запись** открыта из существующей **записи** или [набора записей](recordset-object-ado.md), она автоматически связывается с этой записью \*\*\*\* или объектом **подключения** объекта **Recordset** .</span><span class="sxs-lookup"><span data-stu-id="a034f-135">If the **Record** is opened from an existing **Record** or [Recordset](recordset-object-ado.md), it is automatically associated with that **Record** or **Recordset** object's **Connection** object.</span></span>

> [!NOTE]
> <span data-ttu-id="a034f-136">URL-адреса, использующие схему HTTP, автоматически будут вызывать [поставщик Microsoft OLE DB для публикации в Интернете](microsoft-ole-db-provider-for-internet-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="a034f-136">URLs using the http scheme will automatically invoke the [Microsoft OLE DB Provider for Internet Publishing](microsoft-ole-db-provider-for-internet-publishing.md).</span></span> <span data-ttu-id="a034f-137">Для получения дополнительных сведений см [абсолютные и относительНые URL-адреса](absolute-and-relative-urls.md).</span><span class="sxs-lookup"><span data-stu-id="a034f-137">For more information, see [Absolute and relative URLs](absolute-and-relative-urls.md).</span></span>




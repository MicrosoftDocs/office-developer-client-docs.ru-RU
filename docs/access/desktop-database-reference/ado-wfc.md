---
title: Классы ADO для Windows Foundation (ADO/WFC)
TOCTitle: ADO/WFC
ms:assetid: 73206be8-6515-79e4-e904-cc2d0d59411d
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249468(v=office.15)
ms:contentKeyID: 48545628
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: df9def320274df0eb4636aa237deb566dd5725b7
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32281724"
---
# <a name="adowfc"></a>ADO/WFC


**Область применения**: Access 2013, Office 2013

Объекты ADO для Windows Foundation Classes (ADO/WFC) построены в модели событий ADO и представляют собой упрощенный интерфейс программирования приложений. Как правило, ADO/WFC перехватывает события ADO, консолидирует параметры события в один класс событий, а затем вызывает обработчик событий.

**Использование событий ADO в ADO/WFC**

1.  Определите собственный обработчик событий для обработки события. Например, если вы хотите обработать событие **события connectcomplete** в семействе **коннектионевент** , вы можете использовать следующий код:
    
    ```java 
     
    public void onConnectComplete(Object sender,ConnectionEvent e) 
    { 
        System.out.println("onConnectComplete:" + e); 
    } 
    ```

2.  Определите объект обработчика для представления обработчика событий. Объект Handler должен иметь тип данных **коннектевенсандлер** для события типа **коннектионевент**или типа данных **рекордсетевенсандлер** для события типа **рекордсетевент**. Например, для обработчика событий **события connectcomplete** выполните приведенный ниже код.
    
    ```java
        ConnectionEventHandler handler =  
                new ConnectionEventHandler(this, "onConnectComplete"); 
    ```

    Первый аргумент конструктора **коннектионевенсандлер** является ссылкой на класс, содержащий обработчик события, названный во втором аргументе. Компилятор Microsoft Visual J++ также поддерживает эквивалентный синтаксис:
    
    ```java 
     
        ConnectionEventHandler handler =  
            new ConnectionEventHandler(this, "onConnectComplete"); 
    ```
    
    ```java 
     
        ConnectionEventHandler handler =  
            new ConnectionEventHandler(this.onConnectComplete); 
    ```
    
    Первый аргумент конструктора **коннектионевенсандлер** является ссылкой на класс, содержащий обработчик события, названный во втором аргументе. Компилятор Microsoft Visual J++ также поддерживает эквивалентный синтаксис:
    
    ```java 
     
        ConnectionEventHandler handler =  
            new ConnectionEventHandler(this.onConnectComplete); 
    ```
    
    Единственный аргумент — это ссылка на желаемый класс (**this**) и метод в классе (**онконнекткомплете**).

3.  Добавьте обработчик событий в список обработчиков, предназначенных для обработки определенного типа события. Используйте метод с именем, таким как **надстройка * * * EventName*(*обработчик*).

4.  ADO/WFC внутренне реализует все обработчики событий ADO. Таким образом, событие, вызванное **подключением** **или** операцией записи, перехватывается обработчиком событий ADO/WFC. Обработчик событий ADO/WFC передает параметры ADO **коннектионевент** в экземпляре класса ADO/WFC **Коннектионевент** или параметры **рекордсетевент** ADO в экземпляре класса ADO/WFC **рекордсетевент** . Эти классы ADO/WFC объединяют параметры событий ADO; то есть каждый класс ADO/WFC содержит один элемент данных для каждого уникального параметра во всех методах ADO **коннектионевент** или **рекордсетевент** .

5.  Затем ADO/WFC вызывает обработчик события с помощью объекта события ADO/WFC. Например, обработчик **онконнекткомплете** имеет такую подпись:
    
    ```java 
     
        public void onConnectComplete(Object sender,ConnectionEvent e) 
    ```
    
    Первый аргумент — это тип объекта, который отправил событие ([Connection](connection-object-ado.md) или [Recordset](recordset-object-ado.md)), а второй аргумент — объект события ADO/WFC (**коннектионевент** или **рекордсетевент**). Подпись обработчика событий проще, чем событие ADO. Тем не менее, необходимо понимать модель событий ADO, чтобы узнать, какие параметры применяются к событию, и как реагировать на них.

6.  Вернитесь от обработчика событий к обработчику ADO/WFC для события ADO. ADO/WFC копирует соответствующие элементы данных события ADO/WFC обратно в параметры события ADO, а затем возвращает обработчик событий ADO.

7.  После завершения обработки удалите обработчик из списка обработчиков событий ADO/WFC. Используйте метод с именем **ремовеон * * * EventName*(*handler*).


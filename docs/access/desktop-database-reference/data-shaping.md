---
title: Shaping данных (Справочник по для настольных баз данных Access)
TOCTitle: Data Shaping
ms:assetid: 650571cc-6874-2cdb-dd76-0804d1cc4e38
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249390(v=office.15)
ms:contentKeyID: 48545305
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 8fc2e8ec2ceeefc670681a5aec43f03c86fd73d9
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "25868877"
---
# <a name="data-shaping"></a><span data-ttu-id="57e58-102">Формирование данных</span><span class="sxs-lookup"><span data-stu-id="57e58-102">Data Shaping</span></span>


<span data-ttu-id="57e58-103">**Применимо к**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="57e58-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="57e58-104">Формирования данных позволяет определить столбцы формы **записей**отношений между сущностями, представленные в столбцы и порядка, в котором выполняется заполнение **набора записей** с данными.</span><span class="sxs-lookup"><span data-stu-id="57e58-104">Data shaping enables you to define the columns of a shaped **Recordset**, the relationships between the entities represented by the columns, and the manner in which the **Recordset** is populated with data.</span></span>

<span data-ttu-id="57e58-105">Столбцы формы **набора записей** может содержать данные из поставщика данных, таких как Microsoft SQL Server, ссылки на другой **набор записей**, значения, производные от вычислений в одной строке **набора записей**, производного от операции над столбец всего **набора записей**; или они могут быть только что создано, пустой столбец.</span><span class="sxs-lookup"><span data-stu-id="57e58-105">Columns of a shaped **Recordset** may contain data from a data provider such as Microsoft SQL Server, references to another **Recordset**, values derived from a calculation on a single row of a **Recordset**, values derived from an operation over a column of an entire **Recordset**; or they may be a newly fabricated, empty column.</span></span>

<span data-ttu-id="57e58-106">При извлечении значения столбца, который содержит ссылку на другой **набор записей**ADO автоматически возвращает фактических **записей** представлены справочные материалы по.</span><span class="sxs-lookup"><span data-stu-id="57e58-106">When you retrieve the value of a column that contains a reference to another **Recordset**, ADO automatically returns the actual **Recordset** represented by the reference.</span></span> <span data-ttu-id="57e58-107">**Набор записей** , содержащий другого **набора записей** называется иерархических набора записей.</span><span class="sxs-lookup"><span data-stu-id="57e58-107">A **Recordset** that contains another **Recordset** is called a hierarchical recordset.</span></span> <span data-ttu-id="57e58-108">Иерархические наборы записей обладают отношения *родительских и дочерних* , используемые *родительского* содержащего записей и *дочерних* — это автономные набора записей.</span><span class="sxs-lookup"><span data-stu-id="57e58-108">Hierarchical recordsets exhibit a *parent-child* relationship, in which the *parent* is the containing recordset and the *child* is the contained recordset.</span></span> <span data-ttu-id="57e58-109">Ссылка на **набор записей** является ссылку к подмножеству дочерних, называется *главы*.</span><span class="sxs-lookup"><span data-stu-id="57e58-109">The reference to a **Recordset** is actually a reference to a subset of the child, called a *chapter*.</span></span> <span data-ttu-id="57e58-110">Один родительский может ссылаться на несколько дочерних **записей**.</span><span class="sxs-lookup"><span data-stu-id="57e58-110">A single parent may reference more than one child **Recordset**.</span></span>

<span data-ttu-id="57e58-111">Синтаксис команды фигуры позволяет программным путем создавать формы **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="57e58-111">The shape command syntax enables you to programmatically create a shaped **Recordset**.</span></span> <span data-ttu-id="57e58-112">Затем можно приступить к компоненты **записей** программно или с помощью соответствующего элемента управления visual.</span><span class="sxs-lookup"><span data-stu-id="57e58-112">You can then access the components of the **Recordset** programmatically or through an appropriate visual control.</span></span> <span data-ttu-id="57e58-113">Как и любой другой текст команды ADO будет выполнена команда фигуры.</span><span class="sxs-lookup"><span data-stu-id="57e58-113">A shape command is issued like any other ADO command text.</span></span>

<span data-ttu-id="57e58-114">Иерархическая объекты **набора записей** можно сделать двумя способами с синтаксисом фигуры.</span><span class="sxs-lookup"><span data-stu-id="57e58-114">You can make hierarchical **Recordset** objects in two ways with the shape command syntax.</span></span> <span data-ttu-id="57e58-115">Первый добавляет дочерних **записей** родительского **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="57e58-115">The first appends a child **Recordset** to a parent **Recordset**.</span></span> <span data-ttu-id="57e58-116">Родительских и дочерних обычно имеют по крайней мере один столбец общее: значение столбца в строке из родительского — это то же, что значение столбца в все строки дочерней.</span><span class="sxs-lookup"><span data-stu-id="57e58-116">The parent and child typically have at least one column in common: the value of the column in a row of the parent is the same as the value of the column in all rows of the child.</span></span>

<span data-ttu-id="57e58-117">Второй способ создает родительский **записей** из дочернего **набора записей**.</span><span class="sxs-lookup"><span data-stu-id="57e58-117">The second way generates a parent **Recordset** from a child **Recordset**.</span></span> <span data-ttu-id="57e58-118">Записи в дочерних **записей** сгруппированы, предложением по, и добавляется одна строка для родительского **набора записей** для каждой конечной группы в дочернем.</span><span class="sxs-lookup"><span data-stu-id="57e58-118">The records in the child **Recordset** are grouped, typically using the BY clause, and one row is added to the parent **Recordset** for each resulting group in the child.</span></span> <span data-ttu-id="57e58-119">Если по опущен, дочерних **записей** будет форме одну группу и родительских **записей** будет содержать только одну строку.</span><span class="sxs-lookup"><span data-stu-id="57e58-119">If the BY clause is omitted, the child **Recordset** will form a single group and the parent **Recordset** will contain exactly one row.</span></span> <span data-ttu-id="57e58-120">Этот метод подходит для вычисления «Итого» статистических данных по всей дочерних **записей**.</span><span class="sxs-lookup"><span data-stu-id="57e58-120">This is useful for computing "grand total" aggregates over the entire child **Recordset**.</span></span>

<span data-ttu-id="57e58-121">Независимо от того, какой способ родительский формирования **набора записей** , она будет содержать столбец, используемый для связи дочерних **записей**.</span><span class="sxs-lookup"><span data-stu-id="57e58-121">Regardless of which way the parent **Recordset** is formed, it will contain a chapter column that is used to relate it to a child **Recordset**.</span></span> <span data-ttu-id="57e58-122">Если вы хотите родительского **набора записей** также может содержать столбцы, содержащие статистические функции (SUM, MIN, MAX и т.д.) через дочерние строки.</span><span class="sxs-lookup"><span data-stu-id="57e58-122">If you wish, the parent **Recordset** may also have columns that contain aggregates (SUM, MIN, MAX, and so on) over the child rows.</span></span> <span data-ttu-id="57e58-123">Столбцы, содержащие выражения в строке, в **набор записей**, а также столбцы, которые являются новыми и изначально очистить возможно родительских и дочерних **записей** .</span><span class="sxs-lookup"><span data-stu-id="57e58-123">Both the parent and the child **Recordset** may have columns which contain an expression on the row in the **Recordset**, as well as columns which are new and initially empty.</span></span>

<span data-ttu-id="57e58-124">Можно вкладывать иерархических объектов **наборов записей** на любую глубину (то есть, создание дочерних объектов **набора записей** дочерних объектов **наборов записей** и т. п.).</span><span class="sxs-lookup"><span data-stu-id="57e58-124">You can nest hierarchical **Recordset** objects to any depth (that is, create child **Recordset** objects of child **Recordset** objects, and so on).</span></span>

<span data-ttu-id="57e58-125">Доступа к компонентам **записей** из формы **записей** программно или с помощью соответствующего элемента управления visual.</span><span class="sxs-lookup"><span data-stu-id="57e58-125">You can access the **Recordset** components of the shaped **Recordset** programmatically or through an appropriate visual control.</span></span>

<span data-ttu-id="57e58-126">Примеры команд формы и их итоговый иерархии, в разделе с помощью службы формирования данных для OLE DB: более подробно поиска.</span><span class="sxs-lookup"><span data-stu-id="57e58-126">For examples of shape commands and their resulting hierarchies, see Using the Data Shaping Service for OLE DB: A Closer Look.</span></span>

<span data-ttu-id="57e58-127">В этом разделе содержатся следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="57e58-127">This section includes the following topics:</span></span>

- [<span data-ttu-id="57e58-128">Изменение формы</span><span class="sxs-lookup"><span data-stu-id="57e58-128">Reshaping</span></span>](reshaping.md)

- [<span data-ttu-id="57e58-129">Статистические выражения с внучатыми элементами</span><span class="sxs-lookup"><span data-stu-id="57e58-129">Grandchild Aggregates</span></span>](grandchild-aggregates.md)

- [<span data-ttu-id="57e58-130">Команды с параметрами и промежуточными командами COMPUTE</span><span class="sxs-lookup"><span data-stu-id="57e58-130">Parameterized Commands with Intervening COMPUTE Commands</span></span>](parameterized-commands-with-intervening-compute-commands.md)

- [<span data-ttu-id="57e58-131">Сохранение иерархических наборов записей</span><span class="sxs-lookup"><span data-stu-id="57e58-131">Persisting Hierarchical Recordsets</span></span>](persisting-hierarchical-recordsets.md)
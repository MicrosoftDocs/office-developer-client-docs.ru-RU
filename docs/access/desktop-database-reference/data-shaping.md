---
title: Формирование данных (ссылка на настольные базы данных)
TOCTitle: Data shaping
ms:assetid: 650571cc-6874-2cdb-dd76-0804d1cc4e38
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249390(v=office.15)
ms:contentKeyID: 48545305
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: ad507ac8c963f1d6ead7bc3bf444e694d83f90e3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295039"
---
# <a name="data-shaping"></a>Формирование данных

**Область применения**: Access 2013, Office 2013

Формирование данных позволяет определить столбцы фигурного набора **записей,** связи между сущностями, представленными столбцами, и способ заполнения набором записей данными. 

Столбцы фигурного  набора записей могут содержать данные от поставщика данных, например Microsoft SQL Server, ссылки на другой набор записей, значения, полученные из расчета в одном ряду **recordset**, значения, полученные в результате операции над столбцом целого **наборов записей;** или это может быть только что сфабрикованный пустой столбец.

При извлечении значения столбца, содержаного ссылку на другой **Набор** записей, ADO автоматически возвращает фактический набор **записей,** представленный ссылкой. Набор **записей,** содержащий другой **набор записей,** называется иерархическим набором записей. Иерархические наборы записей демонстрируют отношения между  родителем и ребенком,  в которых родительский является набором записей, а ребенок — содержащимся набором записей.  Ссылка на **набор записей фактически** является ссылкой на подмножество ребенка, называемое *главой*. Один родитель может ссылаться на несколько детей **Recordset**.

Синтаксис команды фигуры позволяет программным образом создавать фигурный **набор записей.** Затем можно получить доступ к компонентам **recordset** программным образом или с помощью соответствующего визуального управления. Команда фигуры выдана, как и любой другой текст команды ADO.

Можно сделать иерархические объекты **Recordset** двумя способами с синтаксиса командной фигуры. Первое приложение ребенка **Recordset к** родительскому **набору записей.** Обычно у родительского и ребенка имеется по крайней мере один столбец: значение столбца в строке родительского является таким же, как и значение столбца во всех строках ребенка.

Второй способ создает родительский **набор записей** из детского **recordset**. Записи в детском наборе записей группуются, как правило, с помощью  оговорки BY, и одна строка добавляется в родительский набор записей для каждой группы в результате в ребенке.  Если предложение BY будет пропущено, ребенок **Recordset** сформировать одну группу, а родительский набор **записей** будет содержать ровно одну строку. Это полезно для вычисления совокупностей "общего общего числа" по всему детскому **набору записей.**

Независимо от того, каким образом **формируется** родительский набор записей, он будет содержать столбец главы, который используется для его соотноски с ребенком **Recordset**. При желании в родительском наборе **записей** также могут быть столбцы, содержащие сводки (SUM, MIN, MAX и так далее) над детскими строками. В родительском и  детском наборе записей могут быть столбцы, содержащие выражение строки в Наборе записей, а также столбцы, которые являются новыми и изначально пустыми.

Можно вложенные иерархические **объекты Recordset** в любую глубину (то есть создавать объекты детского **recordset** объектов child **Recordset** и так далее).

Вы можете получить доступ к компонентам **Recordset** фигурного **recordset** программным образом или с помощью соответствующего визуального управления.

Примеры команд фигур и их полученных иерархий см. в примере Using the Data Shaping Service for OLE DB: A Closer Look.

В этой статье содержатся следующие разделы:

- [Изменение формы](reshaping.md)
- [Статистические выражения с внучатыми элементами](grandchild-aggregates.md)
- [Параметризованные команды с промежуточными командами COMPUTE](parameterized-commands-with-intervening-compute-commands.md)
- [Сохранение иерархических наборов записей](persisting-hierarchical-recordsets.md)

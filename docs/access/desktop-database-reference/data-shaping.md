---
title: Формирование данных (справочник по базе данных Access для настольных ПК)
TOCTitle: Data shaping
ms:assetid: 650571cc-6874-2cdb-dd76-0804d1cc4e38
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249390(v=office.15)
ms:contentKeyID: 48545305
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: ad507ac8c963f1d6ead7bc3bf444e694d83f90e3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295039"
---
# <a name="data-shaping"></a><span data-ttu-id="6b7f8-102">Формирование данных</span><span class="sxs-lookup"><span data-stu-id="6b7f8-102">Data shaping</span></span>

<span data-ttu-id="6b7f8-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="6b7f8-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="6b7f8-104">Формирование данных позволяет определить столбцы фигурного набор записей, отношения между сущностями, представленными столбцами, и способ заполнения набором записей данными.  </span><span class="sxs-lookup"><span data-stu-id="6b7f8-104">Data shaping enables you to define the columns of a shaped **Recordset**, the relationships between the entities represented by the columns, and the manner in which the **Recordset** is populated with data.</span></span>

<span data-ttu-id="6b7f8-105">Столбцы фигурного  наборов записей могут содержать данные от поставщика данных, например Microsoft SQL Server, ссылки на другой набор записей **,** значения, производные от вычисления в одной строке **recordset**, значения, производные от операции над столбцом всего **набор записей;** или это может быть только что созданный пустой столбец.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-105">Columns of a shaped **Recordset** may contain data from a data provider such as Microsoft SQL Server, references to another **Recordset**, values derived from a calculation on a single row of a **Recordset**, values derived from an operation over a column of an entire **Recordset**; or they may be a newly fabricated, empty column.</span></span>

<span data-ttu-id="6b7f8-106">При извлечении значения столбца, который содержит ссылку на другой набор  **записей,** ADO автоматически возвращает фактический набор записей, представленный ссылкой.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-106">When you retrieve the value of a column that contains a reference to another **Recordset**, ADO automatically returns the actual **Recordset** represented by the reference.</span></span> <span data-ttu-id="6b7f8-107">Набор **записей,** содержащий другой **набор записей,** называется иерархическим набором записей.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-107">A **Recordset** that contains another **Recordset** is called a hierarchical recordset.</span></span> <span data-ttu-id="6b7f8-108">Иерархические наборы записей имеют отношение *"родительский-потомок",* в  котором родительский является содержащим набором записей, а потомок — содержащимся набором записей. </span><span class="sxs-lookup"><span data-stu-id="6b7f8-108">Hierarchical recordsets exhibit a *parent-child* relationship, in which the *parent* is the containing recordset and the *child* is the contained recordset.</span></span> <span data-ttu-id="6b7f8-109">Ссылка на набор **записей фактически** является ссылкой на подмножество детей, называемое *главой.*</span><span class="sxs-lookup"><span data-stu-id="6b7f8-109">The reference to a **Recordset** is actually a reference to a subset of the child, called a *chapter*.</span></span> <span data-ttu-id="6b7f8-110">Один родительский набор может ссылаться на несколько наборов **записей.**</span><span class="sxs-lookup"><span data-stu-id="6b7f8-110">A single parent may reference more than one child **Recordset**.</span></span>

<span data-ttu-id="6b7f8-111">Синтаксис команды фигуры позволяет программным образом создать фигурный **набор записей.**</span><span class="sxs-lookup"><span data-stu-id="6b7f8-111">The shape command syntax enables you to programmatically create a shaped **Recordset**.</span></span> <span data-ttu-id="6b7f8-112">Затем можно получить доступ к компонентам **recordset** программным путем или с помощью соответствующего визуального управления.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-112">You can then access the components of the **Recordset** programmatically or through an appropriate visual control.</span></span> <span data-ttu-id="6b7f8-113">Команда фигуры выдана так же, как любой другой текст команды ADO.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-113">A shape command is issued like any other ADO command text.</span></span>

<span data-ttu-id="6b7f8-114">Иерархические объекты **Recordset** можно сделать двумя способами с помощью синтаксиса команды фигуры.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-114">You can make hierarchical **Recordset** objects in two ways with the shape command syntax.</span></span> <span data-ttu-id="6b7f8-115">Первый шаг привнося в родительский набор **записей.** </span><span class="sxs-lookup"><span data-stu-id="6b7f8-115">The first appends a child **Recordset** to a parent **Recordset**.</span></span> <span data-ttu-id="6b7f8-116">Как правило, родительский и родительский столбцы имеют по крайней мере один столбец: значение столбца в строке родительского столбца такое же, как и значение столбца во всех строках потомка.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-116">The parent and child typically have at least one column in common: the value of the column in a row of the parent is the same as the value of the column in all rows of the child.</span></span>

<span data-ttu-id="6b7f8-117">Второй способ создает родительский набор **записей** из child **Recordset.**</span><span class="sxs-lookup"><span data-stu-id="6b7f8-117">The second way generates a parent **Recordset** from a child **Recordset**.</span></span> <span data-ttu-id="6b7f8-118">Записи в этом  наборе записей группироваться, как правило, с помощью предложения BY, и одна строка добавляется в родительский набор **записей** для каждой итоговой группы в потомке.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-118">The records in the child **Recordset** are grouped, typically using the BY clause, and one row is added to the parent **Recordset** for each resulting group in the child.</span></span> <span data-ttu-id="6b7f8-119">Если предложение BY опущено, то потомок **Recordset** будет сформировать одну группу, а родительский набор **записей** будет содержать ровно одну строку.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-119">If the BY clause is omitted, the child **Recordset** will form a single group and the parent **Recordset** will contain exactly one row.</span></span> <span data-ttu-id="6b7f8-120">Это полезно для вычисления итоговых итогов по всему набору **записей.**</span><span class="sxs-lookup"><span data-stu-id="6b7f8-120">This is useful for computing "grand total" aggregates over the entire child **Recordset**.</span></span>

<span data-ttu-id="6b7f8-121">Независимо от того, каким образом **формируется** родительский набор записей, он будет содержать столбец главы, который используется для его отношения к набору **записей.**</span><span class="sxs-lookup"><span data-stu-id="6b7f8-121">Regardless of which way the parent **Recordset** is formed, it will contain a chapter column that is used to relate it to a child **Recordset**.</span></span> <span data-ttu-id="6b7f8-122">При желании родительский набор записей также может содержать столбцы, которые содержат сводки (SUM, MIN, MAX и так далее) по этим строкам. </span><span class="sxs-lookup"><span data-stu-id="6b7f8-122">If you wish, the parent **Recordset** may also have columns that contain aggregates (SUM, MIN, MAX, and so on) over the child rows.</span></span> <span data-ttu-id="6b7f8-123">Как родительский,  так и родительский набор записей могут содержать столбцы, содержащие выражение в строке в наборе записей, а также новые и изначально пустые столбцы.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-123">Both the parent and the child **Recordset** may have columns which contain an expression on the row in the **Recordset**, as well as columns which are new and initially empty.</span></span>

<span data-ttu-id="6b7f8-124">Иерархические объекты **Recordset** можно вложены в любую глубину (то есть создавать объекты **child Recordset** для объектов **child Recordset** и так далее).</span><span class="sxs-lookup"><span data-stu-id="6b7f8-124">You can nest hierarchical **Recordset** objects to any depth (that is, create child **Recordset** objects of child **Recordset** objects, and so on).</span></span>

<span data-ttu-id="6b7f8-125">Доступ к **компонентам Recordset** фигурного  наборов записей можно получить программным путем или с помощью соответствующего визуального управления.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-125">You can access the **Recordset** components of the shaped **Recordset** programmatically or through an appropriate visual control.</span></span>

<span data-ttu-id="6b7f8-126">Примеры команд фигур и их итоговые иерархии см. в примере использования службы формирования данных для OLE DB: более детальное решение.</span><span class="sxs-lookup"><span data-stu-id="6b7f8-126">For examples of shape commands and their resulting hierarchies, see Using the Data Shaping Service for OLE DB: A Closer Look.</span></span>

<span data-ttu-id="6b7f8-127">В этой статье содержатся следующие разделы:</span><span class="sxs-lookup"><span data-stu-id="6b7f8-127">This section includes the following topics:</span></span>

- [<span data-ttu-id="6b7f8-128">Изменение формы</span><span class="sxs-lookup"><span data-stu-id="6b7f8-128">Reshaping</span></span>](reshaping.md)
- [<span data-ttu-id="6b7f8-129">Статистические выражения с внучатыми элементами</span><span class="sxs-lookup"><span data-stu-id="6b7f8-129">Grandchild aggregates</span></span>](grandchild-aggregates.md)
- [<span data-ttu-id="6b7f8-130">Параметризованные команды с промежуточными командами COMPUTE</span><span class="sxs-lookup"><span data-stu-id="6b7f8-130">Parameterized commands with intervening COMPUTE commands</span></span>](parameterized-commands-with-intervening-compute-commands.md)
- [<span data-ttu-id="6b7f8-131">Сохранение иерархических наборов записей</span><span class="sxs-lookup"><span data-stu-id="6b7f8-131">Persisting hierarchical Recordsets</span></span>](persisting-hierarchical-recordsets.md)

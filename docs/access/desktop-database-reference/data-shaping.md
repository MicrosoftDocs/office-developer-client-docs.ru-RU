---
title: Формирование данных (справочник по базе данных Access для настольных ПК)
TOCTitle: Data shaping
ms:assetid: 650571cc-6874-2cdb-dd76-0804d1cc4e38
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249390(v=office.15)
ms:contentKeyID: 48545305
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: ad507ac8c963f1d6ead7bc3bf444e694d83f90e3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295039"
---
# <a name="data-shaping"></a>Формирование данных

**Область применения**: Access 2013, Office 2013

Формирование данных позволяет определить столбцы фигурного набор записей, отношения между сущностями, представленными столбцами, и способ заполнения набором записей данными.  

Столбцы фигурного  наборов записей могут содержать данные от поставщика данных, например Microsoft SQL Server, ссылки на другой набор записей **,** значения, производные от вычисления в одной строке **recordset**, значения, производные от операции над столбцом всего **набор записей;** или это может быть только что созданный пустой столбец.

При извлечении значения столбца, который содержит ссылку на другой набор  **записей,** ADO автоматически возвращает фактический набор записей, представленный ссылкой. Набор **записей,** содержащий другой **набор записей,** называется иерархическим набором записей. Иерархические наборы записей имеют отношение *"родительский-потомок",* в  котором родительский является содержащим набором записей, а потомок — содержащимся набором записей.  Ссылка на набор **записей фактически** является ссылкой на подмножество детей, называемое *главой.* Один родительский набор может ссылаться на несколько наборов **записей.**

Синтаксис команды фигуры позволяет программным образом создать фигурный **набор записей.** Затем можно получить доступ к компонентам **recordset** программным путем или с помощью соответствующего визуального управления. Команда фигуры выдана так же, как любой другой текст команды ADO.

Иерархические объекты **Recordset** можно сделать двумя способами с помощью синтаксиса команды фигуры. Первый шаг привнося в родительский набор **записей.**  Как правило, родительский и родительский столбцы имеют по крайней мере один столбец: значение столбца в строке родительского столбца такое же, как и значение столбца во всех строках потомка.

Второй способ создает родительский набор **записей** из child **Recordset.** Записи в этом  наборе записей группироваться, как правило, с помощью предложения BY, и одна строка добавляется в родительский набор **записей** для каждой итоговой группы в потомке. Если предложение BY опущено, то потомок **Recordset** будет сформировать одну группу, а родительский набор **записей** будет содержать ровно одну строку. Это полезно для вычисления итоговых итогов по всему набору **записей.**

Независимо от того, каким образом **формируется** родительский набор записей, он будет содержать столбец главы, который используется для его отношения к набору **записей.** При желании родительский набор записей также может содержать столбцы, которые содержат сводки (SUM, MIN, MAX и так далее) по этим строкам.  Как родительский,  так и родительский набор записей могут содержать столбцы, содержащие выражение в строке в наборе записей, а также новые и изначально пустые столбцы.

Иерархические объекты **Recordset** можно вложены в любую глубину (то есть создавать объекты **child Recordset** для объектов **child Recordset** и так далее).

Доступ к **компонентам Recordset** фигурного  наборов записей можно получить программным путем или с помощью соответствующего визуального управления.

Примеры команд фигур и их итоговые иерархии см. в примере использования службы формирования данных для OLE DB: более детальное решение.

В этой статье содержатся следующие разделы:

- [Изменение формы](reshaping.md)
- [Статистические выражения с внучатыми элементами](grandchild-aggregates.md)
- [Параметризованные команды с промежуточными командами COMPUTE](parameterized-commands-with-intervening-compute-commands.md)
- [Сохранение иерархических наборов записей](persisting-hierarchical-recordsets.md)

---
title: Формирование данных (Справочник по базам данных Access на компьютере)
TOCTitle: Data shaping
ms:assetid: 650571cc-6874-2cdb-dd76-0804d1cc4e38
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249390(v=office.15)
ms:contentKeyID: 48545305
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: ad507ac8c963f1d6ead7bc3bf444e694d83f90e3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32295039"
---
# <a name="data-shaping"></a>Формирование данных

**Область применения**: Access 2013, Office 2013

Представление данных позволяет определять столбцы в объекте **Recordset**в форме, отношения между сущностями, представленные столбцами, и способ заполнения **набора** данных данными.

В столбцах объекта **Recordset** в форме могут содержаться данные от поставщика данных, например Microsoft SQL Server, ссылки на другой **набор записей**, производные от вычисления по одной строке **набора записей**, значения, полученные в результате операции над столбцом всего **набора записей**. или они могут быть созданным пустым столбцом.

При получении значения столбца, содержащего ссылку на другой **набор записей**, ADO автоматически возвращает реальный **набор записей** , представленный ссылкой. Объект **Recordset** , содержащий другой **набор записей** , называется иерархическим набором записей. В иерархических наборах записей представлено отношение " *родители-потомки* ", в котором *родительским объектом* является содержащийся набор записей, а *дочерним* — контейнерный набор. Ссылка на **набор записей** фактически является ссылкой на подмножество дочерних элементов, называемых *главой*. Один родительский элемент может ссылаться на более чем один дочерний **набор записей**.

Синтаксис команды Shape позволяет программным способом создавать **набор записей**в форме. После этого вы можете получить доступ к компонентам **набора записей** программным способом или с помощью соответствующего визуального элемента управления. Команда Shape выполняется как любой другой текст команды ADO.

С помощью синтаксиса команды Shape можно создавать иерархические объекты **Recordset** двумя способами. Первый добавляет дочерний объект **Recordset** в родительский **набор записей**. Родительский и дочерний, как правило, имеют по крайней мере один столбец: значение столбца в строке родителя совпадает со значением столбца во всех строках дочернего элемента.

Второй способ создает родительский **набор записей** из дочернего объекта **Recordset**. Записи в дочернем **наборе записей** группируются, как правило, с помощью предложения by, и одна строка добавляется в родительский **набор записей** для каждой результирующей группы в дочернем элементе. Если предложение BY опущено, дочерний **набор записей** будет состоять из одной группы, а родительский **набор записей** будет содержать ровно одну строку. Это полезно для вычисления статистических данных "общий итог" для всего дочернего объекта **Recordset**.

Независимо от способа формирования родительского **набора записей** он будет содержать столбец Chapter, который используется для связывания с дочерним **набором записей**. При желании у родительского **набора записей** также могут быть столбцы, содержащие статистические выражения (SUM, min, Max и т. д.), для дочерних строк. Как родительский, так и дочерний **набор записей** могут иметь столбцы, которые содержат выражение для строки в **наборе записей**, а также столбцы, которые являются новыми и изначально пусты.

Вы можете вкладывать иерархические объекты **Recordset** в любую глубину (то есть, создавать дочерние объекты **Recordset** для дочерних объектов **Recordset** и т. д.).

Можно получить доступ к **компонентам наборов записей** в **форме** программным способом или с помощью соответствующего визуального элемента управления.

Примеры команд Shape и их результирующих иерархий приведены в статье Использование службы формирования данных для OLE DB: подробное рассмотрение.

В этой статье содержатся следующие разделы:

- [Изменение формы](reshaping.md)
- [Статистические выражения с внучатыми элементами](grandchild-aggregates.md)
- [Параметризованные команды с промежуточными командами COMPUTE](parameterized-commands-with-intervening-compute-commands.md)
- [Сохранение иерархических наборов записей](persisting-hierarchical-recordsets.md)

---
title: Инициализация драйвера источника текстовых данных
TOCTitle: Initializing the Text Data Source driver
ms:assetid: cba0864e-5f94-bf43-4708-b1981e3acaff
ms:mtpsurl: https://msdn.microsoft.com/library/Ff834391(v=office.15)
ms:contentKeyID: 48547718
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- acmain11.chm1032166
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: 2e76cc7d6b5254f2347e2264b0588ee1df643d05
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291423"
---
# <a name="initializing-the-text-data-source-driver"></a>Инициализация драйвера источника текстовых данных

**Область применения**: Access 2013, Office 2013

Один и тот же драйвер базы данных используется как для текстовых источников данных, так и для источников данных HTML.

При установке драйвера базы данных для источника текстовых данных программа установки записывает набор значений по умолчанию в реестр Microsoft Windows в подразделах Engines и ISAM formats. Эти параметры не следует изменять напрямую; Используйте программу установки приложения, чтобы добавлять, удалять или изменять эти параметры. В следующих разделах описываются параметры инициализации и ISAM Format драйвера базы данных для источника текстовых данных.

## <a name="text-data-source-initialization-settings"></a>Параметры инициализации источника текстовых данных

В **папке ISAM formats\\\\подсистемы подключения Access** содержатся параметры инициализации драйвера ацеткст. dll, используемого для внешнего доступа к файлам текстовых данных. Типичные параметры записей в этой папке показаны в следующем примере.

```vb
    win32=<path>\ ACETXT.DLL 
    
    MaxScanRows=25 
    
    FirstRowHasNames=True 
    
    CharacterSet= ANSI 
    
    Format=CSVDelimited 
    
    Extensions= txt,csv,tab,asc 
    
    ExportCurrencySymbols=Yes
```

<br/>

Ядро СУБД Microsoft Access использует записи в папке Text, как показано ниже.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Введен</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>оригиналь</p></td>
<td><p>Расположение файла Ацеткст. dll. Полный путь определяется во время установки. Значения имеют тип REG_SZ.</p></td>
</tr>
<tr class="even">
<td><p>макссканровс</p></td>
<td><p>Количество строк, проверяемых при подборе типов столбцов. Если задано значение 0, поиск выполняется во всем файле. Значение по умолчанию — 25. Значения имеют тип REG_DWORD.</p></td>
</tr>
<tr class="odd">
<td><p>фирстровхаснамес</p></td>
<td><p>Двоичное значение, которое указывает, содержит ли первая строка таблицы имена столбцов. Значение 01 указывает, что во время импорта имена столбцов берутся из первой строки.</p></td>
</tr>
<tr class="even">
<td><p>CharacterSet</p></td>
<td><p>Индикатор того, как хранятся страницы текста. Возможные параметры:</p>
<p></p>
<ul>
<li><p>ANSI — кодовая страница ANSI компьютера. Преобразования Анситауникоде и Уникодетоанси выполнены.</p></li>
<li><p>OEM — кодовая страница OEM компьютера. Преобразования Оемтауникоде и Уникодетуем выполнены.</p></li>
<li><p>Юникод — преобразования кодовой страницы не выполнены.</p></li>
<li><p>&lt;десятичное&gt; число — номер кодовой страницы определенного набора символов. Выполняется преобразование в Юникод и из Юникода.</p></li>
</ul>
<p></p>
<p>Значение по умолчанию — ANSI. Значения имеют тип REG_SZ.</p></td>
</tr>
<tr class="odd">
<td><p>Format</p></td>
<td><p>Может быть любым из следующих элементов: Табделимитед, Ксвделимитед, с разделителями&lt;(один&gt;символ). Разделитель из одного символа в формате с разделителями может быть любым одиночным символом, кроме двойных кавычек (&quot;). Значение по умолчанию — Ксвделимитед. Значения имеют тип REG_SZ.</p></td>
</tr>
<tr class="even">
<td><p>Расширения</p></td>
<td><p>Расширение файлов, просматриваемых при поиске текстовых данных. Значение по умолчанию — TXT, CSV, TAB, ASC. Значения имеют тип REG_SZ.</p></td>
</tr>
<tr class="odd">
<td><p>експорткурренцисимболс</p></td>
<td><p>Двоичное значение, указывающее, включается ли соответствующий символ валюты при экспорте полей валюты. Значение 01 указывает, что символ включен. Значение 00 указывает на то, что экспортируются только числовые данные. Значение по умолчанию — 01. Значения имеют тип REG_BINARY.</p></td>
</tr>
</tbody>
</table>


## <a name="text-data-source-isam-formats"></a>Форматы ISAM для источника текстовых данных

В **текстовой папке\\ISAM formats\\модуля подключения к Access** содержатся следующие записи.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя записи</p></th>
<th><p>Тип</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Модул</p></td>
<td><p>REG_SZ</p></td>
<td><p>Текст</p></td>
</tr>
<tr class="even">
<td><p>експортфилтер</p></td>
<td><p>REG_SZ</p></td>
<td><p>Текстовые файлы (*. txt; *. csv; *. Tab; *. ASC)</p></td>
</tr>
<tr class="odd">
<td><p>импортфилтер</p></td>
<td><p>REG_SZ</p></td>
<td><p>Текстовые файлы (*. txt; *. csv; *. Tab; *. ASC)</p></td>
</tr>
<tr class="even">
<td><p>канлинк</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
<tr class="odd">
<td><p>онетаблеперфиле</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
<tr class="even">
<td><p>исамтипе</p></td>
<td><p>REG_DWORD</p></td>
<td><p>2</p></td>
</tr>
<tr class="odd">
<td><p>индексдиалог</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="even">
<td><p>креатедбонекспорт</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="odd">
<td><p>ресулттекстимпорт</p></td>
<td><p>REG_SZ</p></td>
<td><p>Импорт данных из внешнего файла в текущую базу данных. Изменение данных в текущей базе данных не приведет к изменению данных во внешнем файле.</p></td>
</tr>
<tr class="even">
<td><p>ресулттекстлинк</p></td>
<td><p>REG_SZ</p></td>
<td><p>Создайте в текущей базе данных таблицу, связанную с внешним файлом. Изменение данных в текущей базе данных приведет к изменению данных во внешнем файле.</p></td>
</tr>
<tr class="odd">
<td><p>ресулттекстекспорт</p></td>
<td><p>REG_SZ</p></td>
<td><p>Экспорт данных из текущей базы данных в текстовый файл. При этом данные будут перезаписаны при экспорте в существующий файл.</p></td>
</tr>
<tr class="even">
<td><p>суппортслонгнамес</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
</tbody>
</table>


> [!NOTE]
> При изменении параметров реестра Windows необходимо выйти и перезапустить ядро СУБД, чтобы новые параметры вступили в силу.

## <a name="html-import-isam-formats"></a>Форматы ISAM для импорта HTML-кода

Папка **импорта HTML-\\кода для\\модуля подключения к службе доступа ISAM formats** содержит следующие записи.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя записи</p></th>
<th><p>Тип</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Модул</p></td>
<td><p>REG_SZ</p></td>
<td><p>Текст</p></td>
</tr>
<tr class="even">
<td><p>импортфилтер</p></td>
<td><p>REG_SZ</p></td>
<td><p>HTML-файлы (*. HT*)</p></td>
</tr>
<tr class="odd">
<td><p>канлинк</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
<tr class="even">
<td><p>онетаблеперфиле</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="odd">
<td><p>исамтипе</p></td>
<td><p>REG_DWORD</p></td>
<td><p>2</p></td>
</tr>
<tr class="even">
<td><p>индексдиалог</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="odd">
<td><p>креатедбонекспорт</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="even">
<td><p>ресулттекстимпорт</p></td>
<td><p>REG_SZ</p></td>
<td><p>Импорт данных из внешнего файла в текущую базу данных. Изменение данных в текущей базе данных не приведет к изменению данных во внешнем файле.</p></td>
</tr>
<tr class="odd">
<td><p>ресулттекстлинк</p></td>
<td><p>REG_SZ</p></td>
<td><p>Создайте в текущей базе данных таблицу, связанную с внешним файлом. Изменение данных в текущей базе данных приведет к изменению данных во внешнем файле.</p></td>
</tr>
<tr class="even">
<td><p>суппортслонгнамес</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> При изменении параметров реестра Windows необходимо выйти и перезапустить ядро СУБД, чтобы новые параметры вступили в силу.

## <a name="html-export-isam-formats"></a>Форматы ISAM для экспорта HTML

В папке **экспорта\\\\HTML в HTML-папке экспорта подсистемы подключения Access** содержатся следующие записи.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Имя записи</p></th>
<th><p>Тип</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Модул</p></td>
<td><p>REG_SZ</p></td>
<td><p>Текст</p></td>
</tr>
<tr class="even">
<td><p>експортфилтер</p></td>
<td><p>REG_SZ</p></td>
<td><p>HTML-файлы (*. htm)</p></td>
</tr>
<tr class="odd">
<td><p>канлинк</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="even">
<td><p>онетаблеперфиле</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
<tr class="odd">
<td><p>исамтипе</p></td>
<td><p>REG_DWORD</p></td>
<td><p>2</p></td>
</tr>
<tr class="even">
<td><p>индексдиалог</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="odd">
<td><p>креатедбонекспорт</p></td>
<td><p>REG_BINARY</p></td>
<td><p>00</p></td>
</tr>
<tr class="even">
<td><p>ресулттекстекспорт</p></td>
<td><p>REG_SZ</p></td>
<td><p>Экспорт данных из текущей базы данных в текстовый файл. При этом данные будут перезаписаны при экспорте в существующий файл.</p></td>
</tr>
<tr class="odd">
<td><p>суппортслонгнамес</p></td>
<td><p>REG_BINARY</p></td>
<td><p>01</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> При изменении параметров реестра Windows необходимо выйти и перезапустить ядро СУБД, чтобы новые параметры вступили в силу.

## <a name="customizing-the-schemaini-file-for-text-and-html-data"></a>Настройка файла Schema. ini для текстовых и HTML-данных

Для чтения, импорта и экспорта текста и HTML-данных необходимо создать файл Schema. ini, который включает в себя сведения о тексте ISAM в ini-файле. Schema. ini содержит особенности источника данных: способ форматирования текстового файла, его чтение во время импорта, а также используемый по умолчанию формат экспорта для файлов. В приведенных ниже примерах показана структура для файла фиксированной ширины filename. txt:

```text
    [Filename.txt] 
    
    ColNameHeader=False 
    
    Format=FixedLength 
    
    FixedFormat= RaggedEdge 
    
    MaxScanRows=25 
    
    CharacterSet=OEM 
    
    Col1=columnname Char Width 24 
    
    Col2=columnname2 Date Width 9 
    
    Col3=columnname7 Float Width 10 
    
    Col4=columnname8 Integer Width 10 
    Col5=columnname9 LongChar Width 10
```

<br/>

Аналогично, формат для файла с разделителями задается следующим образом:

```text
    [Delimit.txt] 
    
    ColNameHeader=True 
    
    Format=Delimited() 
    
    MaxScanRows=0 
    
    CharacterSet=OEM 
    
    Col1=username char width 50 
    
    Col2=dateofbirth Date width 9
```

<br/>

При экспорте данных в текстовый файл с разделителями необходимо также указать формат этого файла:

```text
    [Export: My Special Export] 
    
    ColNameHeader=True 
    
    Format=TabDelimited 
    
    MaxScanRows=25 
    
    CharacterSet=OEM 
    
    DateTimeFormat=mm.dd.yy.hh.mm.ss 
    
    CurrencySymbol=Dm 
    
    CurrencyPosFormat=0 
    
    CurrencyDigits=2 
    
    CurrencyNegFormat=0 
    
    CurrencyThousandSymbol=, 
    
    CurrencyDecimalSymbol=. 
    
    DecimalSymbol=, 
    
    NumberDigits=2 
    
    NumberLeadingZeros=0 
    
    TextDelimeter="
```

<br/>

Пример "Мой экспорт" относится к конкретному параметру экспорта; во время подключения можно указать любой вариант экспортируемых параметров. Последний пример также соответствует имени источника данных (DSN), которое может быть дополнительно передано во время подключения. Все три раздела форматирования могут быть включены в один и тот же ini-файл.

Ядро СУБД Microsoft Access использует записи Schema. ini следующим образом.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Введен</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>колнамехеадер</p></td>
<td><p>Может иметь значение <strong>true</strong> (что означает, что первая запись данных указывает имена столбцов) или <strong>false</strong>.</p></td>
</tr>
<tr class="even">
<td><p>Format</p></td>
<td><p>Можно задать одно из следующих значений: Табделимитед, Ксвделимитед, с разделителями (&lt;один символ&gt;) или фикседленгс. Разделитель, указанный для формата файла с разделителями, может быть любым одиночным символом, кроме двойных кавычек&quot;().</p></td>
</tr>
<tr class="odd">
<td><p>фикседформат</p></td>
<td><p>Используется только в том случае, если используется формат Фикседленгс, для этого может быть задано одно из следующих значений: Рагжедедже или Труефикседленгс. Рагжедедже позволяет завершать строки символом возврата каретки. Для Труефикседленгс требуется, чтобы каждая строка была точным числом символов, а все символы возврата каретки, не равные границе строки, были внедрены в поле. Если этот параметр не указан, по умолчанию используется значение Рагжедедже.</p></td>
</tr>
<tr class="even">
<td><p>макссканровс</p></td>
<td><p>Указывает количество строк, проверяемых при выгадке типов данных столбца. Если для этого параметра задано значение 0, выполняется поиск по всему файлу.</p></td>
</tr>
<tr class="odd">
<td><p>CharacterSet</p></td>
<td><p>Может иметь значение OEM, ANSI, UNICODE или десятичное число допустимой кодовой страницы, а также указывает кодировку исходного файла.</p></td>
</tr>
<tr class="even">
<td><p>датетимеформат</p></td>
<td><p>Может быть задано значение типа String, указывающее даты и время. Эта запись должна быть указана, если все поля даты и времени в импорте/экспорте обрабатываются в том же формате. Поддерживаются все форматы ядра базы данных Microsoft Jet, кроме AM и PM. В случае отсутствия строки формата используются параметры времени и аватара на панели управления Windows.</p></td>
</tr>
<tr class="odd">
<td><p>CurrencySymbol</p></td>
<td><p>Указывает символ валюты, используемый для денежных значений в текстовом файле. Примеры включают знак доллара ($) и DM. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="even">
<td><p>курренципосформат</p></td>
<td><p>Может быть задано любое из следующих значений: префикс символа валюты без цветоделения ($1) $1 суффикс символа валюты без цветоделения () префикс символа валюты с одним символом разделения ($1), с одним символом ($1), если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="odd">
<td><p>CurrencyDigits</p></td>
<td><p>Указывает количество цифр, используемых для дробной части денежной суммы. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="even">
<td><p>курренцинегформат</p></td>
<td><p>Может принимать одно из следующих значений: ($1) – $1 $ – $1 1 – ($1) – $1 1 – $1 $ – $1 – $1 $1 – $1 – $ – 1 1 – $ ($1) ($1) знак доллара отображается для этого примера, но его следует заменить соответствующим значением Курренцисимбол в реальной программе. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="odd">
<td><p>курренцисаусандсимбол</p></td>
<td><p>Указывает символ, состоящего из одного символа, который используется для разделения значений денежных единиц на тысячах в текстовом файле. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="even">
<td><p>курренцидеЦималсимбол</p></td>
<td><p>Можно задать любой символ, который используется для отделения целого от дробной части денежной суммы. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="odd">
<td><p>деЦималсимбол</p></td>
<td><p>Можно задать любой символ, который используется для отделения целого числа от дробной части числа. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="even">
<td><p>нумбердигитс</p></td>
<td><p>Указывает количество десятичных цифр в дробной части числа. Если эта запись отсутствует, используется значение по умолчанию на панели управления Windows.</p></td>
</tr>
<tr class="odd">
<td><p>нумберлеадингзерос</p></td>
<td><p>Указывает, должны ли дробные значения меньше 1 и больше, чем – 1, должны содержать начальные нули; Это может быть значение false (без нулей в начале) или true.</p></td>
</tr>
<tr class="even">
<td><p>Столбец1, col2,...</p></td>
<td><p>Перечисляет столбцы в текстовом файле, которые необходимо прочитать. Этот параметр должен иметь следующий формат: <em>Колн</em>=<em>ColumnName</em> Type [width <em> #</em>] <em>ColumnName</em>: имена столбцов со встроенными пробелами должны быть заключены в кавычки. <em>тип</em>: может быть бит, Byte, Short, Long, Decimal, Currency, Single, Double, DateTime. Двоичный, OLE, Text или MEMO. Кроме того, поддерживаются следующие типы текстовых драйверов ODBC: char (то же, как текст) с плавающей запятой (то же, что и в виде текста) (то же, что и Short) (то же, что и Short) Лонгчар (то же, что и Short) (то же, что и Short) Дата в <em>формате</em> даты в случае с типом "Примечание". В случае десятичного типа следует использовать дополнительные маркеры формата [Scale #] Precision #].</p></td>
</tr>
<tr class="odd">
<td><p>текстделимитер</p></td>
<td><p>Можно задать любой символ, используемый для разграничения строк, содержащих любой из других специальных символов. Например, &quot;ABC&quot;,&quot;XYZ, ПКР&quot;,&quot;хиж&quot; если этот параметр отсутствует, разделителем по умолчанию является двойная кавычка. Если эта запись является строкой &quot;None&quot; (нет), символы не будут рассматриваться как разделители.</p></td>
</tr>
</tbody>
</table>

> [!NOTE]
> При изменении параметров файла Schema. ini необходимо выйти и перезапустить ядро СУБД, чтобы новые параметры вступили в силу.



---
title: Удаление записей с помощью метода Delete
TOCTitle: Deleting records using the Delete method
ms:assetid: 22917c33-4d14-ebab-d85c-2cbe7f68c560
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249003(v=office.15)
ms:contentKeyID: 48543708
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a476e9bc57224b0e46afb31bf092450c26de0a17
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32293968"
---
# <a name="deleting-records-using-the-delete-method"></a>Удаление записей с помощью метода Delete


**Область применения**: Access 2013, Office 2013

Метод **Delete** пометит текущую запись или группу записей в **объекте Recordset** для удаления. Если объект **Recordset** не разрешает удаление записей, возникает ошибка. Если вы находитесь в режиме немедленного обновления, немедленное удаление происходит в базе данных. Если запись не удается успешно удалить (например, из-за нарушений целостности базы данных), запись останется в режиме редактирования после вызова **"Обновить".** Это означает, что перед перемещением текущей записи (например, с помощью [close,](close-method-ado.md) [Move](move-method-ado.md)или [NextRecordset)](nextrecordset-method-ado.md)необходимо отменить обновление с помощью [CancelUpdate.](cancelupdate-method-ado.md)

Если вы находитесь в режиме пакетного обновления, записи помечаются для удаления из кэша, а фактическое удаление происходит при вызове метода **UpdateBatch.** (Чтобы просмотреть удаленные записи, задайте для свойства **Filter** свойство **adFilterAffectedRecords** после того, как **будет** вызван delete.)

При попытке получить значения полей из удаленной записи создается ошибка. После удаления текущей записи удаленная запись остается текущей, пока вы не перейдете к другой записи. После перемещения от удаленной записи она будет недоступна.

При вложении удалений в транзакцию можно восстановить удаленные записи с помощью метода **RollbackTrans.** Если вы находитесь в режиме пакетного обновления, вы можете отменить ожидающих удаления или группу ожидающих удаления с помощью метода **CancelBatch.**

Если попытка удалить записи не удалась из-за конфликта с данными, которые находятся в ее реализации (например, запись уже была удалена другим пользователем), поставщик возвращает предупреждения в коллекцию **ошибок,** но не останавливает выполнение программы. Ошибка во время запуска возникает только при конфликтах всех запрашиваемых записей.

Если за установлено динамическое свойство Unique **Table** и **recordset** является результатом выполнения операции JOIN в нескольких таблицах, метод **Delete** удалит строки только из таблицы, именуемой в свойстве **Unique Table.**

Метод **Delete** принимает необязательный аргумент, который позволяет указать, на какие записи влияет операция **Delete.** Единственные допустимые значения для этого аргумента — одна из следующих констант, в которые были добавлены значения ADO **AffectEnum:**

  - **adAffectCurrent** Влияет только на текущую запись.

  - **adAffectGroup** Влияет только на записи, удовлетворяющие текущему параметру свойства **Filter.** Для **использования** этого параметра свойство Filter должно иметь  значение **FilterGroupEnum** или массив закладок.

В следующем коде показан пример указания **adAffectGroup при** вызове метода **Delete.** В этом примере добавляются некоторые записи в пример **recordset** и обновляется база данных. Затем он фильтрует набор записей с помощью нумерованной константы фильтра **adFilterAffectedRecords,** которая оставляет только добавленные записи видимыми в **наборе записей.**  Наконец, он вызывает метод **Delete** и указывает, что все записи, удовлетворяющие текущему параметру свойства **Filter** (новые записи), должны быть удалены.

```vb 
 
'BeginDeleteGroup 
 'add some bogus records 
 With objRs1 
 For i = 0 To 8 
 .AddNew 
 .Fields("CompanyName") = "Shipper Number " & i + 1 
 .Fields("Phone") = "(425) 555-000" & (i + 1) 
 .Update 
 Next i 
 
 're-connect & update 
 .ActiveConnection = GetNewConnection 
 .UpdateBatch 
 
 'filter on newly added records 
 .Filter = adFilterAffectedRecords 
 Debug.Print "Deleting the " & .RecordCount & _ 
 " records you just added." 
 
 'delete the newly added bogus records 
 .Delete adAffectGroup 
 .Filter = adFilterNone 
 Debug.Print .RecordCount & " records remain." 
 
 .Close 
 End With 
'EndDeleteGroup 
```


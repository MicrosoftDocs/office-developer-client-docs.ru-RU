---
title: Удаление записей с помощью метода Delete
TOCTitle: Deleting records using the Delete method
ms:assetid: 22917c33-4d14-ebab-d85c-2cbe7f68c560
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249003(v=office.15)
ms:contentKeyID: 48543708
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a476e9bc57224b0e46afb31bf092450c26de0a17
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32293968"
---
# <a name="deleting-records-using-the-delete-method"></a>Удаление записей с помощью метода Delete


**Область применения**: Access 2013, Office 2013

С помощью метода **Delete** вы помечаете текущую запись или группу записей в объекте **Recordset** для удаления. Если объект **Recordset** не разрешает удаление записи, возникает ошибка. Если вы используете режим немедленного обновления, немедленное удаление происходит в базе данных. Если запись не может быть успешно удалена (например, из-за нарушений целостности базы данных), запись остается в режиме редактирования после вызова **Update**. Это означает, что необходимо отменить обновление с помощью [CancelUpdate](cancelupdate-method-ado.md) , прежде чем переходить к текущей записи (например, с помощью [Close](close-method-ado.md), [Move](move-method-ado.md)или [NextRecordset](nextrecordset-method-ado.md)).

Если вы используете режим пакетного обновления, записи помечаются для удаления из кэша, а фактическое удаление происходит при вызове метода **UpdateBatch** . (Чтобы просмотреть удаленные записи, установите свойство **Filter** в **Адфилтераффектедрекордс** после вызова **Delete** .)

При попытке получить значения полей из удаленной записи возникает ошибка. После удаления текущей записи удаленная запись остается текущей до тех пор, пока не будет перемещена на другую запись. После выхода из удаленной записи она становится недоступной.

При вложении удалений в транзакцию можно восстановить удаленные записи с помощью метода **RollbackTrans** . Если вы используете режим пакетного обновления, вы можете отменить ожидающее удаление или группу ожидающих удалений с помощью метода **CancelBatch** .

Если попытка удалить записи не удалась из-за конфликта с базовыми данными (например, запись уже была удалена другим пользователем), поставщик возвращает предупреждения в коллекцию **Errors** , но не приостанавливает выполнение программы. Ошибка во время выполнения возникает только в том случае, если имеются конфликты со всеми запрошенными записями.

Если задано динамическое свойство **Table** , а **набор записей** является результатом выполнения операции присоединения к нескольким таблицам, метод **Delete** удалит строки только из таблицы, имя которой указано в свойстве **UNIQUE Table** .

Метод **Delete** принимает необязательный аргумент, который позволяет указать, какие записи будут затронуты операцией **Delete** . Единственным допустимым значением для этого аргумента является одна из перечисленных констант **аффектенум** в ADO:

  - **адаффекткуррент** Влияет только на текущую запись.

  - **адаффектграуп** Влияет только на записи, которые соответствуют текущему значению свойства **Filter** . Для использования этого параметра свойству **Filter** должно быть присвоено значение **Филтерграупенум** или массив **закладок** .

В приведенном ниже коде показан пример указания **адаффектграуп** при вызове метода **Delete** . В этом примере показано, как добавить некоторые записи в образец **набора записей** и обновить базу данных. Затем он фильтрует **набор записей** с помощью перечислимой константы **адфилтераффектедрекордс** Filter, который оставляет только недавно добавленные записи, отображаемые в **наборе записей**. Наконец, вызывается метод **Delete** и задается, что все записи, которые соответствуют текущему значению свойства **Filter** (новые записи), должны быть удалены.

```vb 
 
'BeginDeleteGroup 
 'add some bogus records 
 With objRs1 
 For i = 0 To 8 
 .AddNew 
 .Fields("CompanyName") = "Shipper Number " & i + 1 
 .Fields("Phone") = "(425) 555-000" & (i + 1) 
 .Update 
 Next i 
 
 're-connect & update 
 .ActiveConnection = GetNewConnection 
 .UpdateBatch 
 
 'filter on newly added records 
 .Filter = adFilterAffectedRecords 
 Debug.Print "Deleting the " & .RecordCount & _ 
 " records you just added." 
 
 'delete the newly added bogus records 
 .Delete adAffectGroup 
 .Filter = adFilterNone 
 Debug.Print .RecordCount & " records remain." 
 
 .Close 
 End With 
'EndDeleteGroup 
```


---
title: Удаление записей с помощью метода Delete
TOCTitle: Deleting records using the Delete method
ms:assetid: 22917c33-4d14-ebab-d85c-2cbe7f68c560
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249003(v=office.15)
ms:contentKeyID: 48543708
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: a8f9097f791596f45f574749d98919b61f67cb4f
ms.sourcegitcommit: 558d09fad81f8d80b5ad0edd21934fc09c098f2c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2018
ms.locfileid: "25944496"
---
# <a name="deleting-records-using-the-delete-method"></a>Удаление записей с помощью метода Delete


**Применимо к**: Access 2013, Office 2013

С помощью метода **Delete** помечает текущую запись или группу из записей в объекте **набора записей** для удаления. Если объект **набора записей** не допускается удаление записи, возникает ошибка. Если вы используете режим немедленное обновление, удаление происходит в базе данных немедленно. Если запись не может успешно удалены (из-за нарушения целостности базы данных, например), запись будет оставаться в режиме редактирования после вызова **обновления**. Это означает, что необходимо отменить обновления с помощью [CancelUpdate](cancelupdate-method-ado.md) перед перемещением текущей записи (например, с помощью [Закрыть](close-method-ado.md), [Перемещение](move-method-ado.md)или [NextRecordset](nextrecordset-method-ado.md)).

Если вы используете режим пакетного обновления, записи помечаются для удаления из кэша и фактическое удаление происходит при вызове метода **UpdateBatch** . (Чтобы просмотреть список удаленных записей, значение свойства **фильтра** **adFilterAffectedRecords** после **удаления** вызова.)

Попытка получения значения полей из удаленной записи приводит к ошибке. После удаления текущей записи удаленной записи остается текущей до перехода к другой записи. Один раз удалении от удаленной записи, он больше не доступен.

Если вложить удалений в транзакции, можно восстановить удаленные записи с помощью метода **RollbackTrans** . Если вы используете режим пакетного обновления, можно отменить ожидающие удаления или группой ожидающих удалений с помощью метода **CancelBatch** .

Если происходит сбой попытки для удаления записей из-за конфликта с базовыми данными (например, запись уже была удалена другим пользователем), поставщик возвращает предупреждений в коллекцию **ошибок** , но не останавливается выполнение программы. Только в том случае, если все запрошенные записи конфликтуют возникает ошибка времени выполнения.

Если свойство **Уникальной таблицы** установлено и **записей** производится в результате выполнения операции СОЕДИНЕНИЯ на несколько таблиц, метод **Delete** приведет к удалению строк только из таблицы с именем в свойстве **Уникальной таблицы** .

Метод **удаления** принимает необязательный аргумент, который позволяет указать, какие записи затронуты операцию **удаления** . Только допустимые значения для этого аргумента: один из следующих констант перечисления ADO **AffectEnum** :

  - **adAffectCurrent** Влияет только текущей записи.

  - **adAffectGroup** Влияет только записи, которые удовлетворяют текущего значения свойства **фильтра** . Свойства **фильтра** должно быть присвоено значение **FilterGroupEnum** или массив **закладки** этот параметр.

Ниже показан пример указания **adAffectGroup** при вызове метода **Delete** . В этом примере добавляется несколько записей для примера **набора записей** и обновляет базу данных. Затем фильтр **набора записей** с помощью константа перечисления фильтра **adFilterAffectedRecords** , что делает видимой в **набор записей**только новые записи. И, наконец он вызывает метод **Delete** и указывает, что все записи, которые удовлетворяют текущего значения свойства **фильтра** (новые записи) должны быть удалены.

```vb 
 
'BeginDeleteGroup 
 'add some bogus records 
 With objRs1 
 For i = 0 To 8 
 .AddNew 
 .Fields("CompanyName") = "Shipper Number " & i + 1 
 .Fields("Phone") = "(425) 555-000" & (i + 1) 
 .Update 
 Next i 
 
 're-connect & update 
 .ActiveConnection = GetNewConnection 
 .UpdateBatch 
 
 'filter on newly added records 
 .Filter = adFilterAffectedRecords 
 Debug.Print "Deleting the " & .RecordCount & _ 
 " records you just added." 
 
 'delete the newly added bogus records 
 .Delete adAffectGroup 
 .Filter = adFilterNone 
 Debug.Print .RecordCount & " records remain." 
 
 .Close 
 End With 
'EndDeleteGroup 
```


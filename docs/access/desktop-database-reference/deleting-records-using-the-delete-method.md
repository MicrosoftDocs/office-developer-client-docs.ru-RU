---
title: Удаление записей с помощью метода Delete
TOCTitle: Deleting records using the Delete method
ms:assetid: 22917c33-4d14-ebab-d85c-2cbe7f68c560
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249003(v=office.15)
ms:contentKeyID: 48543708
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: a476e9bc57224b0e46afb31bf092450c26de0a17
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32293968"
---
# <a name="deleting-records-using-the-delete-method"></a>Удаление записей с помощью метода Delete


**Область применения**: Access 2013, Office 2013

Метод **Delete** отмечает текущую запись или группу записей в **объекте Recordset** для удаления. Если объект **Recordset** не разрешает удаление записей, возникает ошибка. Если вы находитесь в режиме немедленного обновления, в базе данных немедленно происходят удаления. Если запись не удается успешно удалить (например, из-за нарушений целостности базы данных), запись останется в режиме редактирования после вызова **обновления.** Это означает, что необходимо отменить обновление с помощью [CancelUpdate](cancelupdate-method-ado.md) перед отключением текущей записи (например, с помощью [Close,](close-method-ado.md) [Move](move-method-ado.md)или [NextRecordset).](nextrecordset-method-ado.md)

Если вы находитесь в режиме пакетного обновления, записи помечены для удаления из кэша, а фактическое удаление происходит при вызове метода **UpdateBatch.** (Чтобы просмотреть удаленные записи, установите свойство **Filter** **adFilterAffectedRecords** после того, как **будет** вызвано удаление.)

Попытка получить значения поля из удаленной записи создает ошибку. После удаления текущей записи удаленная запись остается текущей до тех пор, пока вы не перейдете к другой записи. После удаления от удаленной записи она больше недоступна.

При вложении удалений в транзакцию можно восстановить удаленные записи с помощью метода **RollbackTrans.** Если вы находитесь в режиме пакетного обновления, можно отменить ожидающих удаления или группу ожидающих удалений с помощью метода **CancelBatch.**

Если попытка удалить записи не удалась из-за конфликта с данными( например, запись уже удалена другим пользователем),  поставщик возвращает предупреждения в коллекцию Ошибок, но не прекращает выполнение программы. Ошибка во время запуска возникает только в том случае, если во всех запрашиваемых записях имеются конфликты.

Если **динамическое** свойство Unique Table установлено и **recordset** является результатом выполнения операции JOIN на нескольких таблицах, метод **Delete** удаляет строки только из таблицы, названной в свойстве **Unique Table.**

Метод **Delete** принимает необязательный аргумент, который позволяет указать, какие записи затронуты операцией **Delete.** Единственными допустимыми значениями для этого аргумента являются следующие константы ADO **AffectEnum:**

  - **adAffectCurrent** Влияет только на текущую запись.

  - **adAffectGroup** Влияет только на записи, удовлетворяющие текущему **параметру свойства Filter.** Для **использования** этого параметра необходимо заказать свойство **FilterGroupEnum** или массив закладок. 

В следующем коде показан пример указания **adAffectGroup** при вызове метода **Delete.** В этом примере добавляются некоторые записи в пример **Recordset** и обновляется база данных. Затем он фильтрует набор **записей** с помощью фильтра **adFilterAffectedRecords,** в котором фиксируется константа, которая оставляет только добавленные записи, видимые в **Наборе записей.** Наконец, он вызывает метод **Delete** и указывает, что все записи, удовлетворяющие текущему параметру свойства **Filter** (новые записи), должны быть удалены.

```vb 
 
'BeginDeleteGroup 
 'add some bogus records 
 With objRs1 
 For i = 0 To 8 
 .AddNew 
 .Fields("CompanyName") = "Shipper Number " & i + 1 
 .Fields("Phone") = "(425) 555-000" & (i + 1) 
 .Update 
 Next i 
 
 're-connect & update 
 .ActiveConnection = GetNewConnection 
 .UpdateBatch 
 
 'filter on newly added records 
 .Filter = adFilterAffectedRecords 
 Debug.Print "Deleting the " & .RecordCount & _ 
 " records you just added." 
 
 'delete the newly added bogus records 
 .Delete adAffectGroup 
 .Filter = adFilterNone 
 Debug.Print .RecordCount & " records remain." 
 
 .Close 
 End With 
'EndDeleteGroup 
```


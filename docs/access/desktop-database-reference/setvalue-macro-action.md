---
title: Действие SetValue макросов
TOCTitle: SetValue Macro Action
ms:assetid: a08be0c1-a053-45f9-b4ae-709fedc58e8b
ms:mtpsurl: https://msdn.microsoft.com/library/Ff820771(v=office.15)
ms:contentKeyID: 48546712
ms.date: 09/18/2015
mtps_version: v=office.15
ms.openlocfilehash: 36dd3e511a3ff252ca44aa6d10fd1be4acd5c5fb
ms.sourcegitcommit: c557bbcccf37a6011f89aae1ddd399dfe549d087
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "25878691"
---
# <a name="setvalue-macro-action"></a>Действие SetValue макросов


**Применимо к**: Access 2013, Office 2013


Действие **SetValue** можно использовать для установки значения поля Microsoft Access, элемента управления или свойства на форме, форма таблицы или отчета.


> [!NOTE]
> <P><STRONG>Макрокоманды</STRONG> нельзя использовать для задания значения свойства Access, которое возвращает объект.</P>




> [!NOTE]
> <P>
		Эта действие не разрешено, если база данных не является доверенной. Дополнительные сведения о включении макросов см. по ссылкам в разделе See Also этой статьи.
</P>



## <a name="setting"></a>Параметр

Действие **SetValue** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Элемент</strong></p></td>
<td><p>Имя поля, элемента управления или свойства, значение которого требуется установить. Введите имя поля, элемента управления или свойства в поле <strong>элемента</strong> в разделе <strong>Действие аргументы</strong> в области построения макросов. Необходимо использовать полный синтаксис для ссылки на элемент, например <em>ИмяЭлементаУправления</em> (для элемента управления в форму или отчет, из которого был вызван макрос) или <strong>форм</strong>! <em>имя_формы</em>! <em>ИмяЭлементаУправления</em>. Обязательный аргумент.</p></td>
</tr>
<tr class="even">
<td><p><strong>Выражение</strong></p></td>
<td><p>Выражение, которое доступа используется для задания значения для этого элемента. Всегда необходимо использовать полный синтаксис для ссылки на любые объекты в выражении. Например чтобы увеличить значение в элементе управления заработной платы в форме сотрудников на 10 процентов, используйте форм! Сотрудники! Заработной платы * 1.1. Обязательный аргумент.</p>

> [!NOTE]
> <P>Не следует использовать знак равенства (<STRONG>=</STRONG>) перед выражением в этот аргумент. В противном случае Access применяет выражение, а затем использует это значение как выражение в этом аргументе. Это может привести к непредсказуемым последствиям, если выражение — это строка.</P>


<p>Например, если ввести <strong> = &quot;String1&quot; </strong> для этого аргумента доступа сначала применяет выражение как String1. Затем String1 используется как выражение в этом аргументе, чтобы найти элемент управления или свойство с именем String1 в форму или отчет, который называется макрос.</p></td>
</tr>
</tbody>
</table>



> [!NOTE]
> <P>В базе данных Microsoft Access (MDB- или .accdb) нажмите кнопку <STRONG>Построить</STRONG> использовать построитель выражений для создания выражения для любого из этих аргументов.</P>



## <a name="remarks"></a>Замечания

Это действие можно использовать для задания значения для поля или элемента управления на форме, форма таблицы или отчета. Также можно задать значение для практически во всех элемента управления, формы и свойства отчета в любом представлении. Чтобы узнать, совместимо ли конкретному свойству можно задать с помощью макросов и представлений, к которым может быть задано, обратитесь к разделу справки для этого свойства в редакторе Visual Basic.

Также можно задать значение для поля в базовой таблице формы даже в том случае, если форма не содержит элемент управления, связанный с полем. Используйте синтаксис **форм**\!*имя_формы*\!*fieldname* в поле **элемента** , чтобы задать значение для такого поля. Можно найти на поле в базовой таблице отчета с помощью синтаксиса **отчеты**\!*имя_отчета*\!*fieldname*, но должен быть элемент управления для отчета, связанного с данным полем или поле должно быть описано в вычисляемый элемент управления в отчете.

Если значение элемента управления в форме **ЗадатьЗначение** не приводит к возникновению правил проверки на уровне формы элемента управления, но его выдача правил проверки на уровне таблицы базового поля, если элемент управления связанный элемент управления. Проверка условий **ЗадатьЗначение** , но пересчет может произойти не сразу. Для запуска немедленное обновление и принудительного повторного до завершения, используйте **ОбновитьОбъект** . Значение, заданное в элементе управления с помощью **макрокоманды** не также влияет маски ввода в элемент управления или базовым **Маска** поля.

Чтобы изменить значение элемента управления, можно использовать **макрокоманды** в макросе, указанном свойством события **AfterUpdate** элемента управления. Тем не менее нельзя использовать **макрокоманды** в макросе, указанном свойством событие **BeforeUpdate** элемента управления для изменения значения элемента управления (хотя **ЗадатьЗначение** можно использовать для изменения значения других элементов управления). Можно также использовать **макрокоманды** в макросе, указанном свойством **до обновления** или **после обновления** формы для изменения значения всех элементов управления в текущей записи.


> [!NOTE]
> <P><STRONG>Макрокоманды</STRONG> нельзя использовать для задания значения следующих элементов управления:</P>
> <UL>
> <LI>
> <P>Привязки элементов управления и вычисляемые элементы управления в отчетах.</P>
> <LI>
> <P>Вычисляемые элементы управления в формах.</P></LI></UL>




> [!TIP]
> <P>Чтобы скрыть или отобразить форму в представлении формы можно использовать <STRONG>макрокоманды</STRONG> . Введите <STRONG>форм</STRONG>! <EM>имя_формы</EM> <STRONG>. Отображается</STRONG> в поле <STRONG>элемента</STRONG> и <STRONG>No</STRONG> или <STRONG>Да</STRONG> в поле <STRONG>выражение</STRONG> . Установка для свойства <STRONG>Visible</STRONG> модальную форму <STRONG>No</STRONG> скрывает форму и делает ее немодальной. Для свойства значение <STRONG>Да</STRONG> отображает форму и снова делает ее модальной.</P>



При изменении значения или добавление новых данных в элементе управления с помощью **макрокоманды** в макросе не приводит к возникновению событиями, например **до обновления**, **до вставки**или **изменения** , возникающие при изменении или ввести данные в этих элементах управления в пользовательский интерфейс. Эти события также не возникают при установке значения элемента управления с помощью Visual Basic для приложений (VBA) модуля.

Это действие недоступно в модуле VBA. Задайте значение непосредственно в VBA.

## <a name="example"></a>Пример

**Задайте значение элемента управления с помощью макроса**

Следующий макрос открывает форму добавления продуктов с помощью кнопки на форме Поставщики. Демонстрируется использование **эхо**, **CloseWindow**, **ОткрытьФорму**, **SetValue**и **КЭлементуУправления** действий. Действие **SetValue** задает КодПоставщика управления на форме продуктов для текущего поставщика в форме Поставщики. **Затем КЭлементуУправления** перемещает фокус в поле Идентификатор категории, где можно вводить данные для нового продукта. Этот макрос должен быть связан с кнопкой Добавить продукты в форме Поставщики.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Действие</p></th>
<th><p>Аргументы: параметр</p></th>
<th><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Эхо</strong></p></td>
<td><p><strong>Вывод на экран</strong>: <strong>Нет</strong></p></td>
<td><p>Остановите обновление экрана в процессе выполнения макроса.</p></td>
</tr>
<tr class="even">
<td><p><strong>CloseWindow</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>FormObject имя</strong>: продукт списка <strong>Сохранить</strong>: <strong>Нет</strong></p></td>
<td><p>Закройте форму списка продуктов.</p></td>
</tr>
<tr class="odd">
<td><p><strong>ОткрытьФорму</strong></p></td>
<td><p><strong>Имя формы</strong>: продуктов <strong>представления</strong>: <strong>FormData режима</strong>: <strong>Режим AddWindow</strong>: <strong>Обычный</strong></p></td>
<td><p>Откройте форму продуктов.</p></td>
</tr>
<tr class="even">
<td><p><strong>SetValue</strong></p></td>
<td><p><strong>Элемент</strong>: [формы]! [Товары]! [Код поставщика] <strong>Выражение</strong>: КодПоставщика</p></td>
<td><p>Значение элемента управления КодПоставщика текущего поставщика в форме Поставщики.</p></td>
</tr>
<tr class="odd">
<td><p><strong>GoToControl</strong></p></td>
<td><p><strong>Имя элемента управления</strong>: идентификатор категории</p></td>
<td><p>Перейдите к элементу управления идентификатор категории.</p></td>
</tr>
</tbody>
</table>


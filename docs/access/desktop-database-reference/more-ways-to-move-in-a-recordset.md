---
title: Дополнительные способы перемещения по набору записей
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288864"
---
# <a name="more-ways-to-move-in-a-recordset"></a><span data-ttu-id="ece3b-102">Дополнительные способы перемещения по набору записей</span><span class="sxs-lookup"><span data-stu-id="ece3b-102">More ways to move in a Recordset</span></span>

<span data-ttu-id="ece3b-103">**Область применения**: Access 2013, Office 2013</span><span class="sxs-lookup"><span data-stu-id="ece3b-103">**Applies to**: Access 2013, Office 2013</span></span>

<span data-ttu-id="ece3b-104">Следующие четыре метода используются для перемещения по или прокрутке в **наборе записей**: [MoveFirst, MoveLast, MoveNext и MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md).</span><span class="sxs-lookup"><span data-stu-id="ece3b-104">The following four methods are used to move around, or scroll, in the **Recordset**: [MoveFirst, MoveLast, MoveNext, and MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md).</span></span> <span data-ttu-id="ece3b-105">(Некоторые из этих методов недоступны для последовательных курсоров.)</span><span class="sxs-lookup"><span data-stu-id="ece3b-105">(Some of these methods are unavailable on forward-only cursors.)</span></span>

<span data-ttu-id="ece3b-106">Параметр **MoveFirst** изменяет положение текущей записи на первую запись в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-106">**MoveFirst** changes the current record position to the first record in the **Recordset**.</span></span> <span data-ttu-id="ece3b-107">**MoveLast** изменяет положение текущей записи на последнюю запись в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-107">**MoveLast** changes the current record position to the last record in the **Recordset**.</span></span> <span data-ttu-id="ece3b-108">Чтобы использовать **MoveFirst** или **MoveLast**, объект **Recordset** должен поддерживать закладки или обратную передвижение курсора; в противном случае вызов метода создаст ошибку.</span><span class="sxs-lookup"><span data-stu-id="ece3b-108">To use **MoveFirst** or **MoveLast**, the **Recordset** object must support bookmarks or backward cursor movement; otherwise, the method call will generate an error.</span></span>

<span data-ttu-id="ece3b-109">**MoveNext** перемещает текущую позицию записи на одну позицию вперед.</span><span class="sxs-lookup"><span data-stu-id="ece3b-109">**MoveNext** moves the current record position one place forward.</span></span> <span data-ttu-id="ece3b-110">Если вы используете последнюю запись при вызове метода **MoveNext**, для **EOF** будет задано **значение true**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-110">If you are on the last record when you call **MoveNext**, **EOF** will be set to **True**.</span></span> <span data-ttu-id="ece3b-111">**MovePrevious** перемещает положение текущей записи на одну позицию назад.</span><span class="sxs-lookup"><span data-stu-id="ece3b-111">**MovePrevious** moves the current record position one place backward.</span></span> <span data-ttu-id="ece3b-112">Если вы используете первую запись при вызове **MovePrevious**, для **BOF** будет задано **значение true**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-112">If you are on the first record when you call **MovePrevious**, **BOF** will be set to **True**.</span></span> <span data-ttu-id="ece3b-113">Рекомендуется проверять свойства **EOF** и **BOF** при использовании этих методов и перемещать курсор обратно на допустимую позицию текущей записи, если вы перемещаете любой конец объекта **Recordset**, как показано ниже:</span><span class="sxs-lookup"><span data-stu-id="ece3b-113">It is wise to check the **EOF** and **BOF** properties when using these methods and to move the cursor back to a valid current record position if you move off either end of the **Recordset**, as shown here:</span></span>

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

<span data-ttu-id="ece3b-114">Или, в случае использования метода **MovePrevious** :</span><span class="sxs-lookup"><span data-stu-id="ece3b-114">Or, in the case of the **MovePrevious** method:</span></span>

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

<span data-ttu-id="ece3b-115">В случаях, когда **набор записей** фильтруется или сортируется и изменяются данные текущей записи, положение также может измениться.</span><span class="sxs-lookup"><span data-stu-id="ece3b-115">In cases where the **Recordset** has been filtered or sorted and the current record's data is changed, the position may also change.</span></span> <span data-ttu-id="ece3b-116">В таких случаях метод **MoveNext** работает нормально, но следует учитывать, что положение перемещается на одну запись вперед от новой позиции, а не из прежней позиции.</span><span class="sxs-lookup"><span data-stu-id="ece3b-116">In such cases the **MoveNext** method works normally, but be aware that the position is moved one record forward from the new position, not the old position.</span></span> <span data-ttu-id="ece3b-117">Например, изменение данных в текущей записи, в результате чего запись перемещается в конец отсортированного **набора записей**, означает, что при вызове **MoveNext** в ADO задается положение текущей записи после последней записи в **наборе записей** (**EOF** = **true**).</span><span class="sxs-lookup"><span data-stu-id="ece3b-117">For example, changing the data in the current record, such that the record is moved to the end of the sorted **Recordset**, would mean that calling **MoveNext** results in ADO setting the current record to the position after the last record in the **Recordset** (**EOF** = **True**).</span></span>

<span data-ttu-id="ece3b-118">Поведение различных методов Move объекта **Recordset** в некоторой степени зависит от данных в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-118">The behavior of the various Move methods of the **Recordset** object depends, to some extent, on the data within the **Recordset**.</span></span> <span data-ttu-id="ece3b-119">Новые записи, добавленные к **набору записей** , сначала добавляются в определенном порядке, который определяется источником данных и может быть косвенно зависимым или явным образом для данных в новой записи.</span><span class="sxs-lookup"><span data-stu-id="ece3b-119">New records added to the **Recordset** are initially added in a particular order, which is defined by the data source and may be dependent implicitly or explicitly on the data in the new record.</span></span> <span data-ttu-id="ece3b-120">Например, если сортировка или соединение выполняются в запросе, который заполняет **набор записей**, Новая запись вставляется в соответствующее место в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-120">For example, if a sort or a join is done within the query that populates the **Recordset**, the new record will be inserted in the appropriate place within the **Recordset**.</span></span> <span data-ttu-id="ece3b-121">Если при создании объекта **Recordset**порядок не указан явно, то изменения в реализации источника данных могут привести к непреднамеренному изменению порядка возвращаемых строк.</span><span class="sxs-lookup"><span data-stu-id="ece3b-121">If ordering is not explicitly specified when creating the **Recordset**, changes in the data source implementation may cause the ordering of the returned rows to change inadvertently.</span></span> <span data-ttu-id="ece3b-122">Кроме того, функции сортировки, фильтрации и редактирования объекта **Recordset** могут повлиять на порядок и, возможно, на то, какие строки в наборе записей будут отображаться.</span><span class="sxs-lookup"><span data-stu-id="ece3b-122">In addition, the sorting, filtering, and editing functions of the **Recordset** can affect the order and possibly which rows in the recordset will be visible.</span></span>

<span data-ttu-id="ece3b-123">Таким образом, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**и **Move** зависят от других операций, выполняемых с одним и тем же **набором записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-123">Therefore, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**, and **Move** are all sensitive to other operations performed on the same **Recordset**.</span></span> <span data-ttu-id="ece3b-124">ADO всегда будет пытаться поддерживать текущую позицию до явного перемещения, но иногда они затрудняют понимание последствий последующего перемещения.</span><span class="sxs-lookup"><span data-stu-id="ece3b-124">ADO will always try to maintain your current position until you explicitly move it, but sometimes intervening changes make it difficult to understand the effects of a subsequent move.</span></span> <span data-ttu-id="ece3b-125">Например, если вы назовите функцию **MoveFirst** для позиции в первой строке отсортированного **набора записей** и измените сортировку по возрастанию на убывающий порядок, вы по-прежнему располагаете в той же строке, но теперь это последняя строка в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-125">For example, if you call **MoveFirst** to position on the first row of a sorted **Recordset** and you change the sort from ascending order to descending order, you are still on the same row — but now it is the last row in the **Recordset**.</span></span> <span data-ttu-id="ece3b-126">**MoveFirst** переводит на другую строку (новую строку).</span><span class="sxs-lookup"><span data-stu-id="ece3b-126">**MoveFirst** will take you to a different row (the new first row).</span></span>

<span data-ttu-id="ece3b-127">Другой пример, если вы размещаете в определенной строке в середине **набора записей** **, а затем вызывается** метод **MoveNext**, теперь запись выполняется сразу после удаленной записи.</span><span class="sxs-lookup"><span data-stu-id="ece3b-127">As another example, if you are positioned on a particular row in the middle of a **Recordset** and you call **Delete** and then call **MoveNext**, you are now on the record immediately following the deleted record.</span></span> <span data-ttu-id="ece3b-128">Однако вызов **MovePrevious** создает запись, предшествующую той, что была удалена из текущей записи, так как удаленная запись больше не учитывается в активном членстве в **наборе записей**.</span><span class="sxs-lookup"><span data-stu-id="ece3b-128">But calling **MovePrevious** makes the record preceding the one you deleted the current record, because the deleted record is no longer counted in the active membership of the **Recordset**.</span></span>

<span data-ttu-id="ece3b-129">Особенно сложно определить согласованную семантику перемещения среди всех поставщиков для методов, которые перемещаются относительно текущей записи — **MovePrevious**, **MoveNext**и Move — на самом **месте** изменения данных в текущей записи.</span><span class="sxs-lookup"><span data-stu-id="ece3b-129">It is particularly difficult to define consistent move semantics across all providers for methods that move relative to the current record — **MovePrevious**, **MoveNext**, and **Move** — in the face of changing data in the current record.</span></span> <span data-ttu-id="ece3b-130">Например, при работе с отсортированным фильтруемым **набором записей**и изменении данных в текущей записи, чтобы она предполагалась перед всеми остальными записями, но измененные данные больше не будут соответствовать фильтру, не ясно, где должна выполняться операция **MoveNext** .</span><span class="sxs-lookup"><span data-stu-id="ece3b-130">For example, if you are working with a sorted, filtered **Recordset**, and you change the data in the current record so that it would precede all other records, but your changed data also no longer matches the filter, it is not clear where a **MoveNext** operation should take you.</span></span> <span data-ttu-id="ece3b-131">Самое надежное заключение заключается в том, что относительное перемещение в **наборе записей** рискиер, чем абсолютное движение (например, с использованием **MoveFirst** или **MoveLast**), когда данные изменяются при редактировании, добавлении или удалении записей.</span><span class="sxs-lookup"><span data-stu-id="ece3b-131">The safest conclusion is that relative movement within a **Recordset** is riskier than absolute movement (such as using **MoveFirst** or **MoveLast**) when the data is changing while records are being edited, added, or deleted.</span></span> <span data-ttu-id="ece3b-132">Сортировка и фильтрация должна основываться на первичном ключе или ИДЕНТИФИКАТОРе, так как этот тип значения не должен изменяться.</span><span class="sxs-lookup"><span data-stu-id="ece3b-132">Sorting and filtering should be based on a primary key or ID, because this type of value should not change.</span></span>


---
title: Дополнительные способы перемещения по набору записей
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28710575"
---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения по набору записей

**Применимо к**: Access 2013, Office 2013

Следующие четыре метода используются для перемещения или прокрутите список в **записей**: [MoveFirst, MoveLast, MoveNext и MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Некоторые из этих методов недоступны на курсоров.)

**MoveFirst** изменений положения текущей записи в первой записи в **набор записей**. **MoveLast** изменяет положение текущей записи последней записи в **набор записей**. Чтобы использовать **MoveFirst** или **MoveLast**, объекта **набора записей** должен поддерживать закладки или перемещение обратной курсора; в противном случае вызова метода в противном случае возникнет ошибка.

**MoveNext** переход текущего положения записи централизованно. Если вы находитесь на последней записи при вызове **MoveNext**, **EOF** будет присвоено **значение True**. **MovePrevious** перемещение текущего положения записи одну позицию назад. Если пользователь находится в первой записи при вызове **MovePrevious**, **BOF** устанавливается значение **True**. Рекомендуется для проверки свойства **EOF** и **BOF** при использовании этих методов и переместите курсор обратно к допустимым текущей позиции записи при перемещении выключить любой конец **набора записей**, как показано ниже:

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

Или, в случае метод **MovePrevious** :

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

В тех случаях, где **записей** фильтрации или сортировки и изменении текущей записи данных положения могут изменяться. В таких случаях метод **MoveNext** работает нормально, но быть виду, что положение Переместить вперед одной записи из новую позицию не старый положение. Например изменение данных в текущей записи таким образом, что запись перемещается в конец отсортированный **записей**означает, что вызывающий **MoveNext** приводит к ADO параметру текущей позиции после последней записи в ** Набор записей** (**EOF** = **значение True**).

Поведение различные методы перемещения объекта **набора записей** зависит от в некоторой степени, по данным в **набора записей**. Новые записи, добавленные **записей** изначально добавляются в произвольном порядке, которая определяется с источником данных и может быть зависимые неявно или явно данных в новую запись. Например если сортировки или объединение выполняется в запросе, которая заполняет **набора записей**, новую запись будет вставлена в соответствующее место в рамках **набора записей**. Порядок не задан явно при создании **записей**, изменения в реализации источник данных может привести к порядок возвращенных строк для изменения случайно. Кроме того сортировка, фильтрация и функции могут **записей** редактирования влияет на порядок и, возможно, какие строки в наборе записей будут отображаться.

Таким образом **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**и **переместить** все чувствительны к других операций, выполняемых на одном **набора записей**. ADO всегда пытается Ведение текущую позицию, пока явно перемещении, но в некоторых случаях промежуточных изменений затруднить понять эффекты последующих перемещения. К примеру, если вызов **MoveFirst** для размещения в первой строке отсортированный **записей** и изменить сортировку с возрастанию убывающем порядке, вы находитесь в той же строке, а теперь последней строки в **набор записей**. **MoveFirst** вы перейдете к другой строке (новый первой строки).

Например если расположены на этой строки в центре **записей** и вызов функции **Delete** и затем вызвать **MoveNext**вы находитесь на запись сразу после удаленной записи. Однако вызов **MovePrevious** преобразует запись, предшествующей удалена текущая запись, так как удаленная запись больше не учитывается в активной членство **набора записей**.

Особенно сложно определить семантика согласованные перемещение всех поставщиков для методов, которые перемещение относительно текущей записи — **MovePrevious** **MoveNext**и **Перемещение** — при изменении данных в текущей записи. Например если вы работаете с отсортированный, отфильтрованного **набора записей**и изменения данных в текущей записи, чтобы он должен предшествовать все записи, но измененных данных также больше не соответствует фильтру, не снимите этот флажок, если **MoveNext** Операция должно привести. Безопасный заключение является то, что относительное движение в пределах **набора записей** иная чем абсолютный перемещение (например, с помощью **MoveFirst** или **MoveLast**) во время изменения данных во время редактирования записей, добавлено или удалено. Сортировка и фильтрация должен быть основан первичный ключ или идентификатор, так как этот тип значение не следует изменять.


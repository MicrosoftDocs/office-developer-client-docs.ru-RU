---
title: Дополнительные способы перемещения по набору записей
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288864"
---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения по набору записей

**Область применения**: Access 2013, Office 2013

Следующие четыре метода используются для перемещения по или прокрутке в **наборе записей**: [MoveFirst, MoveLast, MoveNext и MovePrevious](movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Некоторые из этих методов недоступны для последовательных курсоров.)

Параметр **MoveFirst** изменяет положение текущей записи на первую запись в наборе **записей**. **MoveLast** изменяет положение текущей записи на последнюю запись в **наборе записей**. Чтобы использовать **MoveFirst** или **MoveLast**, объект **Recordset** должен поддерживать закладки или обратную передвижение курсора; в противном случае вызов метода создаст ошибку.

**MoveNext** перемещает текущую позицию записи на одну позицию вперед. Если вы используете последнюю запись при вызове метода **MoveNext**, для **EOF** будет задано **значение true**. **MovePrevious** перемещает положение текущей записи на одну позицию назад. Если вы используете первую запись при вызове **MovePrevious**, для **BOF** будет задано **значение true**. Рекомендуется проверять свойства **EOF** и **BOF** при использовании этих методов и перемещать курсор обратно на допустимую позицию текущей записи, если вы перемещаете любой конец объекта **Recordset**, как показано ниже:

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

Или, в случае использования метода **MovePrevious** :

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

В случаях, когда **набор записей** фильтруется или сортируется и изменяются данные текущей записи, положение также может измениться. В таких случаях метод **MoveNext** работает нормально, но следует учитывать, что положение перемещается на одну запись вперед от новой позиции, а не из прежней позиции. Например, изменение данных в текущей записи, в результате чего запись перемещается в конец отсортированного **набора записей**, означает, что при вызове **MoveNext** в ADO задается положение текущей записи после последней записи в элементе ** Recordset** (**EOF** = **имеет значение true**).

Поведение различных методов Move объекта **Recordset** в некоторой степени зависит от данных в **наборе записей**. Новые записи, добавленные к **набору записей** , сначала добавляются в определенном порядке, который определяется источником данных и может быть косвенно зависимым или явным образом для данных в новой записи. Например, если сортировка или соединение выполняются в запросе, который заполняет **набор записей**, Новая запись вставляется в соответствующее место в **наборе записей**. Если при создании объекта **Recordset**порядок не указан явно, то изменения в реализации источника данных могут привести к непреднамеренному изменению порядка возвращаемых строк. Кроме того, функции сортировки, фильтрации и редактирования объекта **Recordset** могут повлиять на порядок и, возможно, на то, какие строки в наборе записей будут отображаться.

Таким образом, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**и **Move** зависят от других операций, выполняемых с одним и тем же **набором записей**. ADO всегда будет пытаться поддерживать текущую позицию до явного перемещения, но иногда они затрудняют понимание последствий последующего перемещения. Например, если вы назовите функцию **MoveFirst** для позиции в первой строке отсортированного **набора записей** и измените сортировку по возрастанию на убывающий порядок, вы по-прежнему располагаете в той же строке, но теперь это последняя строка в наборе **записей**. **MoveFirst** переводит на другую строку (новую строку).

Другой пример, если вы размещаете в определенной строке в середине **набора записей** , а затем вызывается метод **MoveNext**, теперь запись выполняется сразу после удаленной записи. **** Однако вызов **MovePrevious** создает запись, предшествующую той, что была удалена из текущей записи, так как удаленная запись больше не учитывается в активном членстве в **наборе записей**.

Особенно сложно определить согласованную семантику перемещения среди всех поставщиков для методов, которые перемещаются относительно текущей записи — **MovePrevious**, **MoveNext**и Move — на самом **месте** изменения данных в текущей записи. Например, при работе с отсортированным фильтруемым **наборОм записей**и изменении данных в текущей записи, чтобы она предполагалась перед всеми остальными записями, но измененные данные больше не соответствуют фильтру, не ясно, где будет использоваться **MoveNext** . следует принять участие в этой операции. Самое надежное заключение заключается в том, что относительное перемещение в **наборе записей** рискиер, чем абсолютное движение (например, с использованием **MoveFirst** или **MoveLast**), когда данные изменяются при редактировании, добавлении или удалении записей. Сортировка и фильтрация должна основываться на первичном ключе или ИДЕНТИФИКАТОРе, так как этот тип значения не должен изменяться.


---
title: Дополнительные способы перемещения по набору записей
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288864"
---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения по набору записей

**Область применения**: Access 2013, Office 2013

Для перемещения или прокрутки в наборе **recordset** используются следующие четыре метода: [MoveFirst, MoveLast, MoveNext и MovePrevious.](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) (Некоторые из этих методов недоступны для курсоров".

**MoveFirst** изменяет текущее положение записи на первую запись в **наборе записей.** **MoveLast** изменяет текущую позицию записи на последнюю запись в **наборе записей.** Чтобы использовать **MoveFirst** или **MoveLast,** объект **Recordset** должен поддерживать закладки или движение курсора назад; в противном случае вызов метода создает ошибку.

**MoveNext** перемещает текущую запись на одно место вперед. Если вы находитесь в последней записи при вызове **MoveNext,** **EOF** будет иметь **true**. **MovePrevious** перемещает текущую запись на одно место назад. Если вы находитесь в первой записи при вызове **MovePrevious,** **boF** будет иметь true **.** При использовании этих методов целесообразно проверить свойства **EOF** и **BOF** и переместить курсор обратно в допустимую текущую позицию записи при переходе с любого конца объекта **Recordset,** как показано ниже:

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

Или, в случае метода **MovePrevious:**

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

Если набор **записей** был отфильтрован или отсортован, а данные текущей записи изменились, положение также может измениться. В таких случаях метод **MoveNext** работает нормально, но следует помнить, что позиция перемещается на одну запись вперед от новой позиции, а не от старой позиции. Например, изменение данных в текущей записи таким образом, чтобы запись была перемещена в конец отсортировали **набор** записей, означает, что вызов **MoveNext** приводит к тому, что ADO устанавливает текущую запись на позицию после последней записи в наборе записей **(** **EOF**  =  **True).**

Поведение различных методов Move объекта **Recordset** в некоторой степени зависит от данных в **объекте Recordset.** Новые записи,  добавленные в набор записей, изначально добавляются в определенном порядке, который определяется источником данных и может зависеть неявно или явно от данных в новой записи. Например, если в запросе, заполняемом набором **записей,** происходит сортировка или добавление, новая запись будет вставлена в соответствующее место в **наборе записей.** Если порядок не указан явным образом при создании **recordset,** изменения в реализации источника данных могут привести к случайному изменению порядка возвращаемой строки. Кроме того, функции сортировки, фильтрации и редактирования в наборе **записей** могут повлиять на порядок и, возможно, на то, какие строки в наборе записей будут видны.

Таким образом, **MoveNext,** **MovePrevious,** **MoveFirst,** **MoveLast** и **Move** чувствительны к другим операциям, выполняемых в том же **Наборе записей.** ADO всегда будет пытаться сохранить текущее положение, пока вы не переместите его явным образом, но иногда внесение изменений затрудняет понимание последствий последующего перемещения. Например, если вызвать **MoveFirst,** чтобы расположить его  в первой строке отсортировали набор записей и вы измените сортировку с возрастания на порядок убывающих, вы по-прежнему будете в той же строке, но теперь это последняя строка в **наборе записей.** **MoveFirst** переместит вас в другую строку (новую первую строку).

В качестве другого примера, если вы находитесь в определенной строке в середине **recordset** и вызовите **Delete,** а затем вызвать **MoveNext,** теперь вы находитесь в записи сразу после удаленной записи. Но при **вызове MovePrevious** запись, предшествующая удаляемой вами текущей записи, больше не учитывается в активном членстве **в наборе записей.**

Особенно трудно определить согласованную семантику перемещения во всех поставщиках для методов, которые перемещаются относительно текущей записи **— MovePrevious,** **MoveNext** и **Move** — перед изменением данных в текущей записи. Например, при работе с отсортованным отфильтрованным набором записей и изменением данных в текущей записи таким образом, чтобы они предшествули всем другим записям, но измененные данные также больше не совпадают с фильтром, будет не ясно, где должна отсутствуть операция **MoveNext.** Самый безопасный вывод заключается в том, что относительное перемещение в наборе **recordset** более рисковальнее, чем абсолютное перемещение (например, с помощью **MoveFirst** или **MoveLast),** когда данные изменяются при редактировании, добавлении или удалении записей. Сортировка и фильтрация должны основываться на первичном ключе или ИД, так как этот тип значения не должен меняться.


---
title: Дополнительные способы перемещения по набору записей
TOCTitle: More ways to move in a Recordset
ms:assetid: ae49b20e-0050-c44b-67e9-7e39de5098c4
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249822(v=office.15)
ms:contentKeyID: 48547067
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2d10a493aac39934a047c6fa311233fd6c9fac4e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32288864"
---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения по набору записей

**Область применения**: Access 2013, Office 2013

Для перемещения или прокрутки в Наборе записей используются следующие четыре **метода:** [MoveFirst, MoveLast, MoveNext и MovePrevious.](movefirst-movelast-movenext-and-moveprevious-methods-ado.md) (Некоторые из этих методов недоступны для курсоров только для нападающих.)

**MoveFirst** меняет текущее положение записи на первую запись в **Наборе записей.** **MoveLast** изменяет текущее положение записи на последнюю запись в **Наборе записей.** Чтобы использовать **MoveFirst** или **MoveLast,** объект **Recordset** должен поддерживать закладки или движение обратно курсора; в противном случае вызов метода создает ошибку.

**MoveNext перемещает** текущее положение записи на одно место вперед. Если вы находитесь на последней записи при вызове **MoveNext,** **EOF** будет настроено на **True**. **MovePrevious перемещает** текущее положение записи на одно место назад. Если вы находитесь на первой записи при вызове **MovePrevious,** **boF** будет настроен на **True**. Целесообразно проверить свойства **EOF** и **BOF** при использовании этих методов и переместить курсор обратно в допустимую текущую позицию записи, если вы переместите любой конец **recordset,** как показано здесь:

```vb
. . . 
oRs.MoveNext 
If oRs.EOF Then oRs.MoveLast 
. . . 
```

Или, в случае метода **MovePrevious:**

```vb
. . . 
oRs.MovePrevious 
If oRs.BOF Then oRs.MoveFirst 
. . . 
```

В случаях, когда **набор записей** фильтруется или сортироваться, а данные текущей записи изменяются, может также измениться положение. В таких случаях **метод MoveNext** работает нормально, но следует помнить, что позиция перемещается на одну запись вперед из новой позиции, а не из старой позиции. Например, изменение данных в текущей записи таким образом, что запись перемещается в конец отсортировали **Recordset**, будет означать, что вызов **MoveNext** приводит к тому, что ADO задает текущую запись позиции после последней записи в **Recordset** **(EOF**  =  **True).**

Поведение различных методов перемещения объекта **Recordset** в определенной степени зависит от данных в **Наборе записей.** Новые записи, добавленные в **Набор записей,** сначала добавляются в определенный порядок, который определяется источником данных и может быть неявно или явно зависит от данных в новой записи. Например, если в запросе, заполняемом **набором Recordset,** делается сортировка или добавление, новая запись будет вставлена в соответствующем месте в **Наборе записей.** Если при создании наборов **записей** не указано явное упорядочение, изменения в реализации источника данных могут привести к непреднамеренным изменениям порядка возвращаемой строки. Кроме того, функции сортировки, фильтрации и редактирования в **Наборе** записей могут повлиять на порядок и, возможно, какие строки в наборе записей будут видны.

Таким образом, **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast** и **Move** все чувствительны к другим операциям, выполняемых на том же **Наборе записей**. ADO всегда будет пытаться сохранить текущую позицию, пока вы явно не переместите ее, но иногда внося изменения затрудняет понимание последствий последующего шага. Например, если вы позвоните **MoveFirst** для позиции в первом ряду отсортировали **Recordset** и измените сортировку с восходящего порядка на порядок убывания, вы все еще находитесь в одной строке , но теперь это последняя строка в **Наборе записей**. **MoveFirst** отвести вас в другую строку (новая первая строка).

В качестве другого примера, если вы находитесь в определенной строке в середине **recordset** и вы вызывали **Delete,** а затем вызывали **MoveNext,** теперь вы находитесь на записи сразу после удаления записи. Но вызов **MovePrevious** делает запись, предшествующая удаляемой текущей записи, так как удаленная запись больше не учитывается в активном членстве **в Recordset**.

Особенно трудно определить последовательную семантику перемещения во всех поставщиках для методов, которые перемещаются относительно текущей записи — **MovePrevious,** **MoveNext** и **Move** — в условиях изменения данных в текущей записи. Например, если вы работаете с отсортованным фильтрованным набором записей **и** измените данные текущей записи так, чтобы они предшествовали всем другим записям, но измененные данные также больше не совпадают с фильтром, не ясно, куда должна взяться операция **MoveNext.** Самый безопасный вывод заключается в том, что относительное перемещение в **recordset** является более рискованным, чем абсолютное движение (например, с помощью **MoveFirst** или **MoveLast),** когда данные изменяются при редактировании, добавлении или удалении записей. Сортировка и фильтрация должны основываться на основном ключе или ID, так как этот тип значения не должен изменяться.


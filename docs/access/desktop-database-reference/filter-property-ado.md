---
title: Свойство Filter (ADO)
TOCTitle: Filter property (ADO)
ms:assetid: 5abc528a-a6ee-34de-5d44-a3249194b0a0
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249314(v=office.15)
ms:contentKeyID: 48545053
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 8cc5153d851a4dc17ef690421d1080ddf91fc3bf
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32292477"
---
# <a name="filter-property-ado"></a>Свойство Filter (ADO)


**Область применения**: Access 2013, Office 2013

Указывает фильтр для данных в наборе [записей](recordset-object-ado.md).

## <a name="settings-and-return-values"></a>Параметры и возвращаемые значения

Задает или возвращает значение **типа Variant** , которое может содержать один из следующих элементов:

  - **Строка условий** — строка, сопоставленная с одним или несколькими отдельными операторами **and** и or. ****

  - **Массив закладок** — массив уникальных значений закладок, указывающий на записи в объекте **Recordset** .

  - Значение [филтерграупенум](filtergroupenum.md) .

## <a name="remarks"></a>Замечания

Используйте свойство **Filter** для выборочного отображения записей в объекте **Recordset** . Отфильтрованный **набор записей** становится текущим курсором. Затронуты другие свойства, возвращающие значения на основе текущего курсора, такие как [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), [RecordCount](recordcount-property-ado.md)и [PageCount](pagecount-property-ado.md). Это связано с тем, что если задать для свойства **Filter** определенное значение, текущая запись будет перемещена в первую запись, которая соответствует новому значению.

Строка условия состоит из предложений в виде " *fieldname-operator-value* " (например, "LastName = ' Smith '). Можно создавать составные предложения, объединяя отдельные предложения с **and** (например, "LastName = ' Smith ' и FirstName = ' John '") или **или** (например,). Можно создавать составные предложения, объединяя отдельные предложения с **and** (например, "LastName = ' Smith ' и FirstName = ' John '") или **или** (например, "LastName = ' Smith ' или LastName = ' Иванов '"). Используйте следующие рекомендации для строк условий:

  - Значение *fieldname* должно быть допустимым именем поля из **набора записей**. Если имя поля содержит пробелы, его необходимо заключить в квадратные скобки.

  - *Оператор* должен быть одним из \<следующих:, \>, \<=, \>=, \< \>, = или **Like**.

  - *Value* — это значение, с которым сравниваются значения полей (например, ' Smith ', \#8/24/95\#, 12,345 или $50,00). Используйте одинарные кавычки со строками и\#знаками решетки () с датами. Для чисел можно использовать десятичные точки, знаки доллара и экспоненциальное представление. *Оператор* If имеет **такой вид**, *значение* может использовать подстановочные знаки. Только звездочка (\*) и знак процента (%) подстановочные знаки разрешены, и они должны быть последними символами в строке. *Значение* не может быть равно null.

    > [!NOTE]
    > Чтобы включить в значение фильтра одиночные кавычки ('), используйте два одинарных кавычка для обозначения одного. Например, для фильтрации по О'маллэй необходимо указать строку критерия "col1 = ' O ' ' Маллэй '". Чтобы включить одинарные кавычки в начале и конце значения фильтра, заключите строку в знаки фунта (#). Например, чтобы выполнить фильтрацию по "1", строка критериев должна иметь значение "col1 = #" 1 "#".

  - Нет приоритета между **and** и **or**. Предложения можно группировать в круглые скобки. Однако вы не можете группировать предложения, Соединенные с помощью оператора **or** , а затем присоединить группу к другому предложению с помощью оператора **and**, как показано ниже.

  - Вместо этого этот фильтр создается как

  - В предложении **Like** можно использовать подстановочные знаки в начале и конце шаблона (например, LastName, например, "\*MIT\*") или только в конце шаблона (например, LastName, например, "Смит\*").

Константы фильтра упрощают устранение конфликтов отдельных записей во время пакетного обновления, позволяя просматривать, например, только те записи, которые были затронуты при последнем вызове метода [UpdateBatch](updatebatch-method-ado.md) .

Установка свойства **Filter** может закончиться неуспешно из-за конфликта с базовыми данными (например, запись уже была удалена другим пользователем). В этом случае поставщик возвращает предупреждения в коллекцию Errors, [](errors-collection-ado.md) но не прерывает выполнение программы. Ошибка во время выполнения возникает только в том случае, если имеются конфликты со всеми запрошенными записями. Используйте свойство [Status](status-property-ado-recordset.md) для обнаружения записей с конфликтами.

Установка свойства **Filter** для строки нулевой длины ("") имеет тот же последствия, что и использование константы **адфилтерноне** .

Если задано свойство **Filter** , текущее положение текущей записи перемещается на первую запись в отфильтрованном подмножестве записей в **наборе**записей. Аналогично, когда свойство **Filter** очищается, положение текущей записи перемещается на первую запись в **наборе записей**.

В свойстве [Bookmark](bookmark-property-ado.md) представлено описание значений закладок, из которых можно создать массив для использования со свойством **Filter** .

Только **фильтры** в форме строк условий (например, OrderDate \> ' 12/31/1999 ') влияют на Содержимое материализованного **набора записей**. **Фильтры** , созданные с помощью массива **закладок** или значения из **филтерграупенум** , не влияют на Содержимое материализованного набора записей. Эти правила применяются к **наборАм записей** , созданным с помощью клиентских или серверных курсоров.

> [!NOTE]
> При применении флага **адфилтерпендингрекордс** к фильтруемому и измененному **набору записей** в режиме пакетНого обновления результирующий **набор записей** будет пустым, если фильтрация основана на ключевом поле таблицы с одним ключом, а изменение было выполняются на значениях ключевых полей. Результирующий **набор записей** не будет пустым, если выполняется одно из следующих условий:
> - Фильтрация основана на не ключевых полях в таблице с одним ключом.
> - Фильтрация основана на полях в таблице с несколькими ключами.
> - Изменения, внесенные в неключевые поля в таблице с одним ключом.
> - Изменения были внесены в любые поля в таблице с несколькими ключами.

В приведенной ниже таблице перечислены эффекты **адфилтерпендингрекордс** в различных сочетаниях фильтрации и модификаций. В левом столбце показаны возможные изменения; можно вносить изменения в любые поля без ключей, в поле ключа в таблице с одним ключом или в любом из ключевых полей таблицы с несколькими ключами. В верхней строке отображается критерий фильтрации; Фильтрация может основываться на любом из полей без ключей, ключевое поле в таблице с одним ключом или любые ключевые поля в таблице с несколькими ключами. В пересекающихся ячейках отображаются результаты: + означает, что результаты **адфилтерпендингрекордс** в непустой **набор записей**; **-** означает пустой **набор записей**.

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p><br />
</p></th>
<th><p>Не ключи</p></th>
<th><p>Один ключ</p></th>
<th><p>Несколько ключей</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Не ключи</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
</tr>
<tr class="even">
<td><p>Один ключ</p></td>
<td><p>+</p></td>
<td><p>-</p></td>
<td><p>Недоступно</p></td>
</tr>
<tr class="odd">
<td><p>Несколько ключей</p></td>
<td><p>+</p></td>
<td><p>Н/Д</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>


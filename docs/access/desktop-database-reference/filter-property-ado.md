---
title: Свойство Filter (ADO)
TOCTitle: Filter property (ADO)
ms:assetid: 5abc528a-a6ee-34de-5d44-a3249194b0a0
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249314(v=office.15)
ms:contentKeyID: 48545053
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 8cc5153d851a4dc17ef690421d1080ddf91fc3bf
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28701804"
---
# <a name="filter-property-ado"></a>Свойство Filter (ADO)


**Применимо к**: Access 2013, Office 2013

Указывает фильтр для данных в [набор записей](recordset-object-ado.md).

## <a name="settings-and-return-values"></a>Параметры и возвращаемые значения

Задает или возвращает значение **типа Variant** , который может содержать один из следующих:

  - **Строка условия** — string, состоящую из одного или нескольких отдельных предложений объединяется с операторами **AND** или **OR** .

  - **Массив закладки** — массив уникальный закладку значений текущего момента в записи в объекте **набора записей** .

  - Значение [FilterGroupEnum](filtergroupenum.md) .

## <a name="remarks"></a>Замечания

Используйте свойство **фильтра** выборочно пропускать записей в объекте **набора записей** . Отфильтрованного **набора записей** становится курсора. Другие свойства, возвращающие значения на основании текущей курсора влияет на, такие как [AbsolutePosition](absoluteposition-property-ado.md), [AbsolutePage](absolutepage-property-ado.md), [RecordCount](recordcount-property-ado.md)и [PageCount](pagecount-property-ado.md). Это связано с определенным значением свойства **фильтра** для первой записи, которая должна удовлетворять новое значение Перемещение текущей записи.

Строка условия включает в себя предложений в форме *FieldName оператор значение* (например, «LastName = 'Smith»»). Можно создать составные предложения, объединив отдельных предложений с **AND** (, например «LastName = 'Smith» "и" FirstName = «John»») или **OR** (например, «). Можно создать составные предложения, объединив отдельных предложений с **AND** (, например «LastName = 'Smith» "и" FirstName = «John»») или **OR** (, например «LastName = 'Smith» или LastName = «Jones»»). Используйте следующие рекомендации для строк с типом условия:

  - *FieldName* должно быть допустимое имя поля из **набора записей**. Если имя поля содержит пробелы, необходимо заключить имя в квадратные скобки.

  - *Оператор* должно быть одно из следующих значений: \<, \>, \<=, \>=, \< \>, =, либо **как**.

  - *Значение* — это значение, с которым будет сравнение значений полей (например, «Smith», \#8/24/95\#, 12.345 или $50,00). Использовать одинарные кавычки, строк и символов (\#) с датами. Для номеров можно использовать десятичные, знак доллара и научное обозначение. Если *оператор* **как** *значение* можно использовать подстановочные знаки. Только звездочки (\*) и знак процента (%) допускаются подстановочные, и они должны иметь последний символ в строке. Не может иметь *значение* null.

    > [!NOTE]
    > Чтобы включить в фильтр значение одинарные кавычки ('), используйте одинарные кавычки для представления одного. Например, чтобы отфильтровать O'Malley, критерии строка должна быть «Столбец1 = "O'' Malley"». Для включения одинарные кавычки в начале и конце значение фильтра, заключите строку с знаки решетки (#). Например, чтобы отфильтровать "1", критерии строка должна быть «Столбец1 = # "1" #».

  - Нет приоритетах **и** и **или**. Предложения можно разбить в скобки. Тем не менее невозможно групповой предложений в состав **или** и затем присоединиться к группе на другое предложение с **AND**, следующим образом:

  - Вместо этого можно построить этот фильтр как

  - В предложении **как** можно использовать подстановочный знак в начале и в конце сопоставляться с шаблоном (, например LastName Like '\*mit\*"), или только в конце сопоставляться с шаблоном (, например LastName Like" Smit\*").

Константы фильтра упростить конфликтов отдельных записей в режиме пакетного обновления, позволяя просматривать, к примеру, вызвать только записи, измененных во время последнего метода [UpdateBatch](updatebatch-method-ado.md) .

Свойства **фильтра** самого могут завершиться с ошибкой из-за конфликта с базовыми данными (например, запись уже была удалена другим пользователем). В этом случае поставщик возвращает предупреждений в коллекцию [ошибок](errors-collection-ado.md) , но не останавливается выполнение программы. Только в том случае, если все запрошенные записи конфликтуют возникает ошибка времени выполнения. Используйте свойство [состояние](status-property-ado-recordset.md) для поиска записей с конфликтами.

Свойства **фильтра** в строку нулевой длины ("») имеет тот же эффект, что и использование **adFilterNone** константу.

При использовании свойства **фильтра** , в настоящее время записи перемещает первой записи в отфильтрованное подмножество записей в **набора записей**. Аналогично Если свойство **Фильтр** установлен, положение текущей записи перемещает первой записи в **набор записей**.

В разделе свойства [Bookmark](bookmark-property-ado.md) описание закладку значения, из которых можно создавать массивы для использования с помощью свойства **фильтра** .

Только **фильтры** в виде строки критерии (например OrderDate \> "12/31/1999") влияет на содержимое постоянных **набора записей**. **Фильтры** , созданные с помощью массива **закладки** или с использованием значения из **FilterGroupEnum** не влияет на содержимое постоянных набора записей. Эти правила применяются к **наборов записей** , созданных с помощью курсоры со стороны клиента или на сервере.

> [!NOTE]
> При применении флаг **adFilterPendingRecords** отфильтрованные и изменения **записей** в пакетном режиме обновления результирующего **набора записей** пуст, если фильтрация основана на ключевое поле с ключом одной таблицы, и была изменения внесены значений ключевых полей. Результирующий **набор записей** будет пустым при выполнении одного из следующих:
> - Фильтрация была основанный на полях не ключи в таблице манипуляции single.
> - Фильтрация была на основе всех полей в таблице несколько манипуляции.
> - Изменения были внесены на полях не ключи в таблице манипуляции single.
> - На всех полей в таблице манипуляции несколькими внесены изменения.

В следующей таблице перечислены эффекты **adFilterPendingRecords** в разные сочетания фильтрации и изменения. В левом столбце отображаются возможные изменения. можно внести изменения на любой из полей не манипуляции, ключевое поле в таблице манипуляции single, либо на любое из ключевых поля в таблице манипуляции несколько. Верхняя строка показывает критерий фильтрации; Фильтрация может быть основана на любой из полей не манипуляции ключевое поле в таблице манипуляции single или любое из ключевых поля в таблице манипуляции несколько. Пересекающиеся ячеек показывают результаты: + означает, что применение **adFilterPendingRecords** приводит к непустые **набора записей**; **-** означает, что пустые **набора записей**.

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p><br />
</p></th>
<th><p>Не ключи</p></th>
<th><p>Один ключ</p></th>
<th><p>Несколько ключей</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Не ключи</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
</tr>
<tr class="even">
<td><p>Один ключ</p></td>
<td><p>+</p></td>
<td><p>-</p></td>
<td><p>Н/Д</p></td>
</tr>
<tr class="odd">
<td><p>Несколько ключей</p></td>
<td><p>+</p></td>
<td><p>Н/Д</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>


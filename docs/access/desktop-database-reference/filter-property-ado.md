---
description: Свойство Filter
title: Свойство Filter (ADO)
TOCTitle: Filter property (ADO)
ms:assetid: 5abc528a-a6ee-34de-5d44-a3249194b0a0
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249314(v=office.15)
ms:contentKeyID: 48545053
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 9d3234f1d5f41fd9f07b8d98bf3df395067780ae
ms.sourcegitcommit: 0419850d5c1b3439d9da59070201fb4952ca5d07
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/28/2020
ms.locfileid: "49734198"
---
# <a name="filter-property-ado"></a>Свойство Filter (ADO)


**Область применения**: Access 2013, Office 2013

Указывает фильтр для данных в [наборе записей.](recordset-object-ado.md)

## <a name="settings-and-return-values"></a>Параметры и возвращаемые значения

Задает или возвращает значение **Variant,** которое может содержать одно из следующих значений:

  - **Строка** условий — строка, которая состоит из одного или более отдельных предложений, совмещенных с операторами **AND** или **OR.**

  - **Массив закладок** — массив уникальных значений закладок, которые указывают на записи в **объекте Recordset.**

  - Значение [FilterGroupEnum.](filtergroupenum.md)

## <a name="remarks"></a>Заметки

Используйте свойство **Filter,** чтобы выборочно отфильтровать записи в **объекте Recordset.** Отфильтрованный **набор записей становится** текущим курсором. Другие свойства, возвращающиеся значения на основе текущего курсора, влияют на такие свойства, как [AbsolutePosition,](absoluteposition-property-ado.md) [AbsolutePage,](absolutepage-property-ado.md) [RecordCount](recordcount-property-ado.md)и [PageCount.](pagecount-property-ado.md) Это необходимо потому, что при установке для свойства **Filter** определенного значения текущая запись перемещается в первую запись, которая удовлетворяет новому значению.

Строка условия состоит из предложений в виде *FieldName-Operator-Value* (например, "LastName = 'Smith'"). Составные предложения можно создать, соединив отдельные предложения с **И** (например, "LastName = 'Smith' AND FirstName = 'John'") или **OR** (например, "). Составные предложения можно создать, соединив отдельные предложения с **И** (например, "LastName = 'Smith' AND FirstName = 'John'") или **OR** (например, "LastName = 'Smith' OR LastName = 'Jones'"). Используйте следующие рекомендации для строк условий:

  - *FieldName* должно быть допустимым именем поля из **recordset.** Если имя поля содержит пробелы, его необходимо заключить в квадратные скобки.

  - *Оператор* должен быть одним из следующих: \<, \> , \<=, \> =, \<\> = или **LIKE**.

  - *Значение* — это значение, с которым будут сравниваться значения полей (например, "Smith", \# 8/24/95, \# 12.345 или $50.00). Используйте одиночковые кавычка со строками и знаками с знаками с знаками \# () с датами. Для чисел можно использовать десятичных знаков, знаки доллара и научной нотации. Если *оператор* имеет **значение LIKE,** *значение может* использовать под wildcards. Только звездочка \* () и знак процента (%) разрешены поддиамные карточки, и они должны быть последними символами в строке. *Значение* не может быть null.

    > [!NOTE]
    > Чтобы включить одиночная кавычка (') в значение фильтра, используйте две одиночные кавычка для представления одной. Например, для фильтрации по O'Malley строка условий должна быть "col1 = "O''Malley'". Чтобы включить одиночная кавычка в начале и конце значения фильтра, заключив строку с знаками с помощью знака знака (#). Например, для фильтрации по "1" строка условий должна быть "col1 = #'1'#".

-   Между AND и **OR** нет **приоритета.** Предложения можно сгруппить в скобки. Однако вы не можете группировать предложения, присоединимые к **OR,** а затем присоединять группу к другому предложению с помощью **AND,** как по следующему фрагменту кода:  
 `(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'`  
  
-   Вместо этого этот фильтр необходимо создать как  
 `(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')`  

  - В **предложении LIKE** можно использовать под шаблон в начале и конце шаблона (например, LastName Like ' mit ') или только в конце шаблона \* \* (например, LastName Like 'Smit \* ').

Константы фильтра упрощают разрешение конфликтов отдельных записей в режиме пакетного обновления, позволяя просматривать, например, только те записи, которые были затронуты во время последнего вызова метода [UpdateBatch.](updatebatch-method-ado.md)

Установка самого **свойства Filter** может привести к сбойу из-за конфликта с данными в среде (например, запись уже была удалена другим пользователем). В этом случае поставщик возвращает предупреждения в коллекцию [errors,](errors-collection-ado.md) но не останавливает выполнение программы. Ошибка во время запуска возникает только при конфликтах всех запрашиваемых записей. Используйте свойство [Status](status-property-ado-recordset.md) для поиска записей с конфликтами.

Установка для **свойства Filter** строки нулевой длины ("") имеет тот же эффект, что и использование константы **adFilterNone.**

Всякий раз, когда за установлено свойство **Filter,** текущая позиция записи перемещается к первой записи в отфильтрованной подмножество записей в **наборе записей.** Аналогично, при **очистке** свойства Filter текущая позиция записи перемещается к первой записи в **наборе записей.**

Описание значений закладок, из которых можно создать массив для использования со свойством **Filter,** см. в свойстве [Bookmark.](bookmark-property-ado.md)

Только **фильтры** в виде строк условий (например, OrderDate \> '12/31/1999') влияют на содержимое сохраняемого **recordset**. **Фильтры,** созданные  с помощью массива закладок или использования значения **из FilterGroupEnum,** не влияют на содержимое сохраняемого наборов записей. Эти правила применяются **к записям,** созданным с помощью клиентских или серверных курсоров.

> [!NOTE]
> При применении флага **adFilterPendingRecords** к отфильтрованным и измененным набору  записей в режиме пакетного обновления итоговая область записей пуста, если фильтрация основана на ключевом поле таблицы с одним ключом и изменены значения полей ключей.  Итоговая **набор записей** будет непустым, если имеется одно из следующих результатов:
> - Фильтрация была основана на полях без ключей в таблице с одним ключом.
> - Фильтрация основана на любых полях в таблице с несколькими ключами.
> - В таблицу с одним ключом были внесены изменения в поля, не ключевых.
> - Изменения были внесены в любые поля в таблице с несколькими ключами.

В следующей таблице скомпилирован результат **работы adFilterPendingRecords** в различных сочетаниях фильтрации и изменений. В левом столбце показаны возможные изменения; изменения можно внести в любое из полей без ключей, в ключевом поле в таблице с одним ключом или в любом из ключевых полей в таблице с несколькими ключами. В верхней строке показан критерий фильтрации; фильтрация может быть основана на любом из полей без ключей, поле ключа в таблице с одним ключом или на любом из ключевых полей в таблице с несколькими ключами. Пересекающиеся ячейки показывают результаты: +означает, что применение **adFilterPendingRecords** приводит к непустой **записи;** **-** означает пустой **набор записей.**

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p><br />
</p></th>
<th><p>Без клавиш</p></th>
<th><p>Один ключ</p></th>
<th><p>Несколько ключей</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Без клавиш</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
</tr>
<tr class="even">
<td><p>Один ключ</p></td>
<td><p>+</p></td>
<td><p>-</p></td>
<td><p>Недоступно</p></td>
</tr>
<tr class="odd">
<td><p>Несколько ключей</p></td>
<td><p>+</p></td>
<td><p>Н/Д</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>


---
description: Свойство Filter
title: Свойство Filter (ADO)
TOCTitle: Filter property (ADO)
ms:assetid: 5abc528a-a6ee-34de-5d44-a3249194b0a0
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249314(v=office.15)
ms:contentKeyID: 48545053
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 9d3234f1d5f41fd9f07b8d98bf3df395067780ae
ms.sourcegitcommit: 0419850d5c1b3439d9da59070201fb4952ca5d07
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/28/2020
ms.locfileid: "49734198"
---
# <a name="filter-property-ado"></a>Свойство Filter (ADO)


**Область применения**: Access 2013, Office 2013

Указывает фильтр для данных в [Наборе записей.](recordset-object-ado.md)

## <a name="settings-and-return-values"></a>Параметры и значения возврата

Задает или возвращает значение **Variant,** которое может содержать одно из следующих значений:

  - **Строка** Критериев — строка, выполненная из одного или более отдельных положений, согласуется с **операторами AND** или **OR.**

  - **Массив закладок** — массив уникальных значений закладки, которые указывают на записи в **объекте Recordset.**

  - Значение [FilterGroupEnum.](filtergroupenum.md)

## <a name="remarks"></a>Примечания

Используйте свойство **Filter,** чтобы выборочно отсеить записи в **объекте Recordset.** Фильтрованный **набор записей** становится текущим курсором. Другие свойства, возвращающиеся значения на основе текущего курсора, затронуты, например [AbsolutePosition,](absoluteposition-property-ado.md) [AbsolutePage,](absolutepage-property-ado.md) [RecordCount](recordcount-property-ado.md)и [PageCount.](pagecount-property-ado.md) Это потому, что при настройке свойства **Filter** к определенному значению текущая запись будет перемещаться к первой записи, удовлетворяемой новому значению.

Строка критериев состоит из оговорок в форме *FieldName-Operator-Value* (например, "LastName = "Smith"). Можно создавать сложные положения, согласовывая отдельные положения с **AND** (например, "LastName = "Smith" и FirstName = "John") или **OR** (например, "). Можно создавать сложные положения, согласовывая отдельные положения с **AND** (например, "LastName = "Smith" и FirstName = "John" или **OR** (например, "LastName = "Smith" или LastName = "Jones"). Используйте следующие рекомендации для строк критериев:

  - *Имя fieldName* должно быть допустимым именем поля из **Recordset.** Если имя поля содержит пробелы, необходимо включить имя в квадратные скобки.

  - *Оператор* должен быть одним из следующих: \<, \> \<=, \> =, \<\> =, =, или **LIKE**.

  - *Значение* — это значение, с которым вы будете сравнивать значения поля (например, "Smith", \# 8/24/95, \# 12.345 или $50.00). Используйте одиночные кавычка со строками и знаками фунта \# () с датами. Для чисел можно использовать десятичных точек, знаки доллара и научные нотации. Если *оператор* **является LIKE,** *значение может* использовать подкарды. Только знак звездочки \* () и процентный знак (%) wild cards are allowed, and they must be the last character in the string. *Значение* не может быть null.

    > [!NOTE]
    > Чтобы включить одиночные кавычка (') в значение фильтра, используйте два одиночных кавычка для представления одного. Например, чтобы фильтровать O'Malley, строка критериев должна быть "col1 = "O'Malley"". Чтобы включить одиночные кавычка как в начале, так и в конце значения фильтра, заключив строку с знаками фунта (#). Например, чтобы отфильтровать строку "1", строка критериев должна быть "col1 = #'1'#".

-   Между AND и **OR** нет **приоритета.** Клаузула можно сгруппить в скобки. Однако нельзя группировать клаузули, к которые присоединяется **or,** а затем присоединяться к группе к другому пункту с **И,** как в следующем фрагменте кода:  
 `(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'`  
  
-   Вместо этого можно создать этот фильтр в качестве  
 `(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')`  

  - В пункте **LIKE** можно использовать под диктовку в начале и конце шаблона (например, LastName Like ' mit'), или только в конце шаблона \* \* (например, LastName Like \* 'Smit').

Константы фильтра упрощают разрешение отдельных конфликтов записей в режиме пакетного обновления, позволяя просматривать, например, только те записи, которые были затронуты во время последнего вызова метода [UpdateBatch.](updatebatch-method-ado.md)

Сама настройка **свойства Filter** может привести к сбой из-за конфликта с данными( например, запись уже удалена другим пользователем). В этом случае поставщик возвращает предупреждения в коллекцию [Ошибок,](errors-collection-ado.md) но не останавливает выполнение программы. Ошибка во время запуска возникает только в том случае, если во всех запрашиваемых записях имеются конфликты. Используйте свойство [Status](status-property-ado-recordset.md) для обнаружения записей с конфликтами.

Настройка свойства **Filter** для строки нулевой длины ("") имеет тот же эффект, что и использование **константы adFilterNone.**

При **застановлении** свойства Filter текущая позиция записи перемещается к первой записи в отфильтрованной подмножество записей **в Наборе записей.** Аналогично, когда свойство **Filter** очищается, текущая позиция записи перемещается к первой записи в **Наборе записей.**

Описание значений закладок, из которых можно создать массив для использования с свойством **Filter,** см. в свойстве [Bookmark.](bookmark-property-ado.md)

Только **фильтры** в виде строк Критериев (например, OrderDate \> '12/31/1999') влияют на содержимое сохраняемого **наборов записей.** **Фильтры,** созданные  с помощью массива закладок или с использованием значения **filterGroupEnum,** не влияют на содержимое сохраняемого Набор записей. Эти правила применяются к **записям,** созданным с помощью курсоров на стороне клиента или сервера.

> [!NOTE]
> При применении **флага adFilterPendingRecords** к фильтрованным и измененным набором записей в режиме пакетного обновления результат **recordset** пуст, если фильтрация была основана на ключевом поле таблицы с одним ключом, а изменение было сделано на значениях ключевого поля.  Результат **recordset не** будет пустым, если одно из следующих данных является верным:
> - Фильтрация была основана на неявных полях в таблице с одним ключом.
> - Фильтрация основана на любых полях в таблице с несколькими ключами.
> - Изменения были внесены на неключевых полях в таблице с одним ключом.
> - Изменения были внесены в любые поля в таблице с несколькими ключами.

В следующей таблице подводятся итоги воздействия **adFilterPendingRecords** в различных сочетаниях фильтрации и изменений. В левом столбце показаны возможные изменения; Изменения могут быть внесены в любое из неявных полей, на ключевое поле в таблице с одним ключом или на любом из ключевых полей в таблице с несколькими ключами. В верхней строке показан критерий фильтрации; Фильтрация может быть основана на любом из ненаключевых полей, ключевом поле в таблице с одним ключом или любом из ключевых полей в таблице с несколькими ключами. Пересекающиеся ячейки показывают результаты: + означает, что применение **adFilterPendingRecords** приводит к непустой **набору записей;** **-** означает пустой **Набор записей.**

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><p><br />
</p></th>
<th><p>Не клавиши</p></th>
<th><p>Одиночный ключ</p></th>
<th><p>Несколько ключей</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Не клавиши</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
</tr>
<tr class="even">
<td><p>Одиночный ключ</p></td>
<td><p>+</p></td>
<td><p>-</p></td>
<td><p>Н/Д</p></td>
</tr>
<tr class="odd">
<td><p>Несколько ключей</p></td>
<td><p>+</p></td>
<td><p>Н/Д</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>


---
title: Макрокоманда SearchForRecord
TOCTitle: SearchForRecord macro action
ms:assetid: a3483c41-adb5-5923-55f4-1a3c4f60cb2f
ms:mtpsurl: https://msdn.microsoft.com/library/Ff821023(v=office.15)
ms:contentKeyID: 48546781
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm118713
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: efa763a77250e1d5c617358f31421804c772468b
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: Auto
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28702112"
---
# <a name="searchforrecord-macro-action"></a>Макрокоманда SearchForRecord


**Применимо к**: Access 2013, Office 2013

Можно использовать действие **ПоискЗаписи** поиск определенной записи в таблице, запрос, форму или отчет.

## <a name="setting"></a>Setting

Действие **ПоискЗаписи** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Тип объекта</strong></p></td>
<td><p>Введите или выберите тип объекта базы данных выполняется поиск в. Можно выбрать <strong>таблицы</strong>, <strong>запроса</strong>, <strong>формы</strong>или <strong>отчета</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Имя объекта</strong></p></td>
<td><p>Введите или выберите объект, содержащий записи для поиска. Раскрывающемся списке содержит все объекты базы данных, выбранного для аргумента <strong>Тип объекта</strong> типа.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Record</strong></p></td>
<td><p>Укажите начальную точку и направление поиска.</p>
<div class="tableSection">
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Параметр</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Previous</strong></p></td>
<td><p>Поиска в обратном направлении от текущей записи.</p></td>
</tr>
<tr class="even">
<td><p><strong>Next</strong></p></td>
<td><p>Поиск вперед из текущей записи.</p></td>
</tr>
<tr class="odd">
<td><p><strong>First</strong></p></td>
<td><p>Поиск вперед из первой записи. Это значение по умолчанию для этого аргумента.</p></td>
</tr>
<tr class="even">
<td><p><strong>Last</strong></p></td>
<td><p>Поиска в обратном направлении от последней записи.</p></td>
</tr>
</tbody>
</table>

</div></td>
</tr>
<tr class="even">
<td><p><strong>Условие отбора</strong></p></td>
<td><p>Введите условия поиска, используя тот же синтаксис как предложение SQL WHERE только без слова &quot;ГДЕ&quot;. Например:</p>
<p>`Description = "Beverages"`</p>
<p>Чтобы создать условия, которое содержит значение из текстового поля в форме, необходимо создать выражение, которое объединяет первая часть критерий с именем текстовое поле, содержащее значение для поиска. Например следующий критерий выполняет поиск поле Описание для значения в текстовом поле с именем txtDescription на форму с именем frmCategories. Обратите внимание, знак равенства (<strong>=</strong>) в начале выражения и использование по обеим сторонам от ссылку текстовое поле в одинарные кавычки (<strong></strong>'):</p>
<p>`="Description = ' " & Forms![frmCategories]![txtDescription] & "'"`</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

- В случаях, когда несколько записей совпадает критерии в аргументе **Условие** влияют следующие факторы найдено записей:
    
  - **Значение аргумента записи** В разделе таблицы в разделе Параметры Дополнительные сведения о **записи** аргумента.
    
  - **Порядок сортировки записей** Например если аргумент **запись** имеет значение **первой**, изменение порядка сортировки записей может изменяться найдено записей.

- Объект, указанный в аргументе **Имя объекта** необходимо открыть перед выполнением этой операции. В противном случае возникает ошибка.

- Если критерии в аргументе **Условие** не выполняются, ошибка не происходит, и фокус остается на текущей записи.

- При поиске для записи предыдущему или следующему поиска не «переносится» при достижении конца данных. Если нет дополнительных записей, которые соответствуют условиям, ошибка не происходит, и фокус остается на текущей записи. Чтобы убедиться в том, что было найдено, введите условие для следующего действия и сделать условие то же, что критерии в аргументе **Условие** .

- Чтобы выполнить действие **ПоискЗаписи** в модуле VBA, используйте метод **ПоискЗаписи** **объекта** .

- Действие **ПоискЗаписи** аналогична **[НайтиЗапись](findrecord-macro-action.md)** , но **ПоискЗаписи** имеет более мощные функциональные возможности поиска. **НайтиЗапись** в основном используется для поиска строк и дублирует функциональные возможности диалогового окна **Найти** . Действие **ПоискЗаписи** использует критерии, по которым наиболее точно параметрам фильтра или запрос SQL. Перечисленные ниже показано несколько действий, которые можно делать с **ПоискЗаписи** действие:
    
  - Можно использовать константы в аргументе **Условие** , такие как
        
    `Description = "Beverages" and CategoryID = 11`
    
  - Можно обратиться к полям, которые находятся в источника записей в форму или отчет, но не отображаются на форму или отчет. В предыдущем примере описание ни идентификатор категории должны отображаться на форму или отчет в качестве условия для работы.
    
  - Можно использовать логические операторы, такие как **\<**, **\>**, **и**, **или**и **BETWEEN**. **НайтиЗапись** соответствует только строк, равно, начать с или содержат строку, поиск.

## <a name="example"></a>Пример

Следующий макрос сначала открывается в таблице категорий с помощью **ОткрытьТаблицу** . Макрос использует действие **ПоискЗаписи** для поиска первой записи в таблице где поле Описание = «Напитки».

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Action</p></th>
<th><p>Arguments</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>OpenTable</strong></p></td>
<td><p><strong>Имя таблицы</strong>: категории<strong>представление</strong>: <strong>Режим DatasheetData</strong>: <strong>Редактирование</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>SearchForRecord</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>Имя TableObject</strong>: категорий<strong>запись</strong>: <strong>Условие FirstWhere</strong>: описание = &quot;Напитки&quot;</p></td>
</tr>
</tbody>
</table>


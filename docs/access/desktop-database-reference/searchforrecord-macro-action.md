---
title: Макрокоманда SearchForRecord
TOCTitle: SearchForRecord macro action
ms:assetid: a3483c41-adb5-5923-55f4-1a3c4f60cb2f
ms:mtpsurl: https://msdn.microsoft.com/library/Ff821023(v=office.15)
ms:contentKeyID: 48546781
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm118713
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: efa763a77250e1d5c617358f31421804c772468b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314646"
---
# <a name="searchforrecord-macro-action"></a>Макрокоманда SearchForRecord


**Область применения**: Access 2013, Office 2013

Вы можете использовать действие **сеарчфоррекорд** для поиска конкретной записи в таблице, запросе, форме или отчете.

## <a name="setting"></a>Параметр

Макрокоманда **сеарчфоррекорд** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Object Type</strong></p></td>
<td><p>Введите или выберите тип объекта базы данных, в котором выполняется поиск. Можно выбрать <strong>таблицу</strong>, <strong>запрос</strong>, <strong>форму</strong>или <strong>отчет</strong>.</p></td>
</tr>
<tr class="even">
<td><p><strong>Object Name</strong></p></td>
<td><p>Введите или выберите определенный объект, содержащий запись для поиска. В раскрывающемся списке отображаются все объекты базы данных выбранного типа для аргумента " <strong>тип объекта</strong> ".</p></td>
</tr>
<tr class="odd">
<td><p><strong>Record</strong></p></td>
<td><p>Указание начальной точки и направления поиска.</p>
<div class="tableSection">
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Параметр</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Previous</strong></p></td>
<td><p>Поиск в обратном направлении от текущей записи.</p></td>
</tr>
<tr class="even">
<td><p><strong>Next</strong></p></td>
<td><p>Поиск вперед от текущей записи.</p></td>
</tr>
<tr class="odd">
<td><p><strong>First</strong></p></td>
<td><p>Поиск вперед от первой записи. Это значение используется по умолчанию для этого аргумента.</p></td>
</tr>
<tr class="even">
<td><p><strong>Last</strong></p></td>
<td><p>Поиск назад от последней записи.</p></td>
</tr>
</tbody>
</table>

</div></td>
</tr>
<tr class="even">
<td><p><strong>Условие отбора</strong></p></td>
<td><p>Введите критерии поиска, используя тот же синтаксис, что и в предложении WHERE языка SQL, без слова &quot;Where&quot;. For example,</p>
<p>`Description = "Beverages"`</p>
<p>Чтобы создать условие, включающее значение из текстового поля формы, необходимо создать выражение, которое сцепляет первую часть критерия с именем текстового поля, содержащего значение для поиска. Например, следующий критерий будет искать значение в поле Description (описание) в текстовом поле с именем Ткстдескриптион в форме Фрмкатегориес. Обратите внимание на знак<strong>=</strong>равенства () в начале выражения и использование одинарных кавычек (<strong>'</strong>) с любой стороны ссылки на текстовое поле:</p>
<p>`="Description = ' " & Forms![frmCategories]![txtDescription] & "'"`</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

- В случаях, когда несколько записей соответствуют условиям в аргументе **условия WHERE** , следующие факторы определяют, какая запись найдена:
    
  - **Параметр записи аргумента** Дополнительные сведения об аргументе **Record** содержатся в таблице в разделе Параметры.
    
  - **Порядок сортировки записей** Например, если для аргумента **Record** задано значение **First**, изменение порядка сортировки записей может привести к изменению записи, которая будет найдена.

- Перед выполнением этого действия должен быть открыт объект, указанный в аргументе **имя объекта** . В противном случае возникает ошибка.

- Если условия в аргументе **условия WHERE** не выполнены, ошибка не возникнет и фокус остается на текущей записи.

- При поиске предыдущей или следующей записи при достижении конца данных поиск не переносится. Если другие записи, удовлетворяющие критериям, отсутствуют, то ошибка не возникнет и фокус остается на текущей записи. Чтобы убедиться в том, что найдено совпадение, можно ввести условие для следующего действия и сделать условие таким же, как в аргументе **условие** отбора.

- Чтобы выполнить действие **сеарчфоррекорд** в модуле VBA, используйте метод **сеарчфоррекорд** объекта **DoCmd** .

- Действие **сеарчфоррекорд** аналогично действию **[НайтиЗапись](findrecord-macro-action.md)** , но **сеарчфоррекорд** имеет более широкие возможности поиска. Макрокоманда " **НайтиЗапись** " используется в основном для поиска строк и дублирует функциональные возможности диалогового окна " **найти** ". Действие **сеарчфоррекорд** использует условия, которые являются более похожими на фильтры или запросы SQL. В следующем списке показаны некоторые действия, которые можно выполнить с действием **сеарчфоррекорд** :
    
  - В аргументе **условие WHERE** можно использовать сложные условия, такие как
        
    `Description = "Beverages" and CategoryID = 11`
    
  - Вы можете ссылаться на поля, которые находятся в источнике записей формы или отчета, но не отображаются в форме или отчете. В предыдущем примере ни описание, ни CategoryID не должны отображаться в форме или отчете, чтобы критерии работало.
    
  - Можно использовать логические операторы, **\<** такие как, **\>**, **и**, **или**и **между**. Макрокоманда **НайтиЗапись** соответствует только строкам, которые равны, начинаются с или содержат строку, в которой выполняется поиск.

## <a name="example"></a>Пример

Следующий макрос сначала открывает таблицу Categories с помощью действия **опентабле** . Затем макрос использует действие **сеарчфоррекорд** для поиска первой записи в таблице, в которой поле Description имеет значение "напитки".

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Действие</p></th>
<th><p>Аргументы</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>OpenTable</strong></p></td>
<td><p><strong>Имя таблицы</strong>:<strong>представление</strong>Categories: <strong>режим даташитдата</strong>: <strong>Редактирование</strong></p></td>
</tr>
<tr class="even">
<td><p><strong>SearchForRecord</strong></p></td>
<td><p><strong>Тип объекта</strong>: <strong>TableObject имя</strong>:<strong>запись</strong>категорий: <strong>фирствхере условие</strong>: Описание = &quot;напитки&quot;</p></td>
</tr>
</tbody>
</table>


---
title: Предложение Compute команды Shape
TOCTitle: Shape Compute clause
ms:assetid: f4fee4a6-ec9e-c0b6-40e0-258f76c4696f
ms:mtpsurl: https://msdn.microsoft.com/library/JJ250245(v=office.15)
ms:contentKeyID: 48548699
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: eadc448d59814f0573a959c6c1038f9c4afdbac9
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32306456"
---
# <a name="shape-compute-clause"></a>Предложение Compute команды Shape

**Область применения**: Access 2013, Office 2013

Предложение COMPUTE для Shape создает родительский объект **Recordset**, столбцы которого состоят из ссылки на доЧерний **набор записей**; необязательные столбцы, содержимое которых — это глава, новые или вычисляемые столбцы, а также результат выполнения статистических функций в дочернем **наборе записей** или ранее фигурном **наборе записей**. и все столбцы из дочернего **набора записей** , перечисленные в дополнительном предложении by.

## <a name="syntax"></a>Синтаксис

```vb 
 
SHAPE child-command [AS] child-alias 
   COMPUTE child-alias [[AS] name], [appended-column-list] 
   [BY grp-field-list] 
```

## <a name="description"></a>Описание

Ниже приведен список частей этого предложения.

- *Дочерняя команда*

  - Состоит из одного из следующих элементов:
    
    - Команда запроса в фигурных скобках ("{}"), которая возвращает дочерний объект **Recordset** . Команда выдается базовому поставщику данных, а его синтаксис зависит от требований этого поставщика. Как правило, это язык SQL, хотя для ADO не требуется определенный язык запросов.
    
    - Имя существующего **набора записей**в форме.
    
    - Другая команда "Фигура".
    
    - Ключевое слово TABLE, за которым следует имя таблицы в поставщике данных.

- *дочерний псевдоним*

  - Псевдоним, используемый для ссылки на **набор записей** , возвращенный *дочерней командой.* В списке столбцов в выражении COMPUTE должен быть указан дочерний *псевдоним* и определено отношение между родительским и дочерним объектами **Recordset** .

- *добавленный список столбцов*

  - Список, в котором каждый элемент определяет столбец в созданном родительском объекте. Каждый элемент содержит столбец раздела, новый столбец, вычисляемый столбец или значение, полученное в результате статистической функции в дочернем **наборе записей**.

- *GRP — список полей*

  - Список столбцов в родительских и дочерних объектах **Recordset** , указывающих способ группировки строк в дочернем элементе. Для каждого столбца в *списке GRP-Field* присутствует соответствующий столбец в дочерних и родительских объектах **Recordset** . Для каждой строки в родительском **наборе записей**столбцы *списка GRP* имеют уникальные значения, а дочерний **набор записей** , на который ссылается родительская строка, состоит только из дочерних строк, у которых столбцы "GRP" и " *список* " имеют те же значения, что и родительская строка.

Если включено предложение BY, строки дочернего **набора записей**будут сгруппированы на основе столбцов в предложении COMPUTE. Родительский **набор записей** будет содержать по одной строке для каждой группы строк в доЧернем **наборе записей**.

Если предложение BY опущено, весь дочерний **набор записей** обрабатывается как единственная группа, а родительский **набор записей** будет содержать ровно одну строку. Эта строка будет ссылаться на весь дочерний **набор записей**. Пропуск предложения BY позволяет вычислять статистические значения "Общая сумма" для всего дочернего объекта **Recordset**.

Пример:

```vb
    SHAPE {select * from Orders} AS orders
       COMPUTE orders, SUM(orders.OrderAmount) as TotalSales
```

Независимо от способа формирования родительского **набора записей** (с помощью COMPUTE или using Append), он будет содержать столбец Chapter, который используется для связывания с доЧерним **набором записей**. При желании родительский **набор записей** также может содержать столбцы, содержащие статистические выражения (SUM, min, Max и т. д.), над дочерними строками. Как родительский, так и дочерний **набор записей** могут содержать столбцы, которые содержат выражение для строки в **наборе записей**, а также столбцы, которые являются новыми и изначально пусты.

## <a name="operation"></a>Operation

Для поставщика отправляется дочерняя *команда* , которая возвращает доЧерний **набор записей**.

Предложение COMPUTE указывает столбцы родительского объекта **Recordset**, которые могут быть ссылками на доЧерний **набор записей**, одно или несколько статистических выражений, вычисляемых выражений или новых столбцов. При наличии предложения BY столбцы, которые он определяет, также добавляются в родительский **набор записей**. Предложение BY определяет, как группируются строки дочернего **набора записей** .

Например, предположим, что у вас есть таблица — демографические сведения, состоящие из полей "штат", "город" и "Заполнение" (для иллюстрации используются только цифры заполнения).

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Состояние</p></th>
<th><p>Город</p></th>
<th><p>Установки</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>ШТАТ</p></td>
<td><p>Seattle</p></td>
<td><p>700 000</p></td>
</tr>
<tr class="even">
<td><p>OR</p></td>
<td><p>Медфорд</p></td>
<td><p>200 000</p></td>
</tr>
<tr class="odd">
<td><p>OR</p></td>
<td><p>Портленд</p></td>
<td><p>400,000</p></td>
</tr>
<tr class="even">
<td><p>ЦЕНТРОВ</p></td>
<td><p>Лос, Лос</p></td>
<td><p>800 000</p></td>
</tr>
<tr class="odd">
<td><p>ЦЕНТРОВ</p></td>
<td><p>Сан Диего</p></td>
<td><p>600 000</p></td>
</tr>
<tr class="even">
<td><p>ШТАТ</p></td>
<td><p>Такома</p></td>
<td><p>500 000</p></td>
</tr>
<tr class="odd">
<td><p>OR</p></td>
<td><p>Корваллис</p></td>
<td><p>300 000</p></td>
</tr>
</tbody>
</table>


Теперь выполните следующую команду фигуры:

```vb 
 
rst.Open  "SHAPE {select * from demographics} AS rs "  & _ 
          "COMPUTE rs, SUM(rs.population) BY state", _ 
           objConnection 
```

Эта команда открывает объект **Recordset** в форме с двумя уровнями. Родительский уровень — это созданный **набор записей** со столбцом статистической обработки (SUM (RS. Population)), столбцом, ссылающимся на дочерний объект **Recordset** (RS), и столбцом для группирования дочернего объекта **Recordset** (State). Дочерний уровень — это **набор записей** , возвращенный командой запроса (), столбец, ссылающийся на дочерний объект **Recordset** (RS), и столбец для группирования дочернего объекта **Recordset** (State). Дочерний уровень — это **набор записей** , возвращенный командой запроса \* (выберите из демографических данных).

Строки сведений о дочернем **наборе записей** группируются по состоянию, но в противном случае нет определенного порядка. То есть группы не будут отображаться в алфавитном или числовом порядке. Если требуется упорядочить родительский **набор записей** , можно использовать метод **сортировки** **Recordset** , чтобы упорядочить родительский **набор записей**.

Теперь вы можете перейти на открытый родительский **набор записей** и получить доступ к дочерним объектам **Recordset** . Более подробную информацию можно узнать [в статье доступ к строкам в иерархическом наборе записей](accessing-rows-in-a-hierarchical-recordset.md).

**Результирующие наборы записей результирующего родительского и доЧернего элементов**

**Parent**

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>SUM (RS. Установки</p></th>
<th><p>кабел</p></th>
<th><p>Состояние</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>1 300 000</p></td>
<td><p>Ссылка на child1</p></td>
<td><p>ЦЕНТРОВ</p></td>
</tr>
<tr class="even">
<td><p>1 200 000</p></td>
<td><p>Ссылка на Child2</p></td>
<td><p>ШТАТ</p></td>
</tr>
<tr class="odd">
<td><p>1 100 000</p></td>
<td><p>Ссылка на child3</p></td>
<td><p>OR</p></td>
</tr>
</tbody>
</table>


**Child1**

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Состояние</p></th>
<th><p>Город</p></th>
<th><p>Установки</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>ЦЕНТРОВ</p></td>
<td><p>Лос, Лос</p></td>
<td><p>800 000</p></td>
</tr>
<tr class="even">
<td><p>ЦЕНТРОВ</p></td>
<td><p>Сан Диего</p></td>
<td><p>600 000</p></td>
</tr>
</tbody>
</table>


**Child2**

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Состояние</p></th>
<th><p>Город</p></th>
<th><p>Установки</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>ШТАТ</p></td>
<td><p>Seattle</p></td>
<td><p>700 000</p></td>
</tr>
<tr class="even">
<td><p>ШТАТ</p></td>
<td><p>Такома</p></td>
<td><p>500 000</p></td>
</tr>
</tbody>
</table>


**Child3**

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Состояние</p></th>
<th><p>Город</p></th>
<th><p>Установки</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>OR</p></td>
<td><p>Медфорд</p></td>
<td><p>200 000</p></td>
</tr>
<tr class="even">
<td><p>OR</p></td>
<td><p>Портленд</p></td>
<td><p>400,000</p></td>
</tr>
<tr class="odd">
<td><p>OR</p></td>
<td><p>Корваллис</p></td>
<td><p>300 000</p></td>
</tr>
</tbody>
</table>


---
title: Объект Field (Справочник по базам данных Access на компьютере)
TOCTitle: The Field object
ms:assetid: 55531e04-d74f-6394-df64-1660e5d572ca
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249284(v=office.15)
ms:contentKeyID: 48544926
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2cbd5752399e5a14f08b7eb944e3a028ba53f561
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314023"
---
# <a name="field-object"></a>Объект Field

**Область применения**: Access 2013, Office 2013

Каждый объект **field** обычно соответствует столбцу в таблице базы данных. Однако **поле** также может представлять указатель на другой **набор записей**, который называется главой. Исключения, например столбцы глав, будут рассмотрены далее в этом руководстве.

Используйте свойство **value** объектов **field** , чтобы задать или вернуть данные для текущей записи. В зависимости от функциональных возможностей, предоставляемых поставщиком, некоторые коллекции, методы или свойства объекта **field** могут быть недоступны.

В коллекциях, методах и свойствах объекта **field** можно выполнить следующие действия:

- Возврат имени поля с помощью свойства **Name** .

- Просмотрите или измените данные в поле, используя свойство **value** . **Value** является свойством по умолчанию объекта **field** .

- ВозВращайте основные характеристики поля, используя свойства **Type**, **Precision**и **NumericScale** .

- Возврат объявленного размера поля с помощью свойства **DefinedSize** .

- Возвращает фактический размер данных в заданном поле с помощью свойства **ActualSize** .

- Определите, какие типы функций поддерживаются для данного поля, с помощью свойства **Attributes** и коллекции **свойств** .

- Управлять значениями полей с длинными двоичными или длинными символьными данными с помощью методов **** **AppendChunk** и.

- РазРешите несоответствия в значениях полей во время пакетного обновления с помощью свойств **originalValue** и **UnderlyingValue** , если поставщик поддерживает пакетное обновление.

## <a name="describing-a-field"></a>Описание поля

В следующих статьях будут обсуждаться свойства объекта [field](field-object-ado.md) , представляющие собой сведения, описывающие объект **field** (то есть, метаданные для поля). Эти сведения можно использовать для определения большого объема схемы **набора записей**. К этим свойствам относятся **Type**, **DefinedSize** и **ActualSize**, **Name**и **NumericScale** , а также **точность**.

## <a name="discovering-the-data-type"></a>Обнаружение типа данных

Свойство **Type** указывает тип данных поля. Перечислимые константы с типом данных, которые поддерживаются ADO, описаны в разделе [DataTypeEnum](datatypeenum.md) в справочнике программиста по *ADO*.

Для числовых типов с плавающей запятой, таких как **аднумерик**, вы можете получить дополнительные сведения. Свойство **NumericScale** указывает, сколько цифр справа от десятичной точки будет использоваться для представления значений для **поля**. Свойство **Precision** указывает максимальное количество цифр, используемых для представления значений для **поля**.

## <a name="determining-field-size"></a>Определение размера поля

Используйте свойство **DefinedSize** для определения емкости данных объекта **field** .

Используйте свойство **ActualSize** , чтобы возвратить фактическую длину значения объекта **field** . Для всех полей свойство **ActualSize** доступно только для чтения. Если ADO не удается определить длину значения объекта **field** , свойство **ActualSize** возвращает **адункновн**.

Свойства **DefinedSize** и **ActualSize** имеют разные цели. Например, рассмотрим объект **field** с объявляемым типом **адварчар** и значением свойства **DefinedSize** , равным 50, с одним символом. Возвращаемое значение свойства **ActualSize** — это длина в байтах одного символа.

## <a name="determining-field-contents"></a>Определение содержимого поля

Идентификатор столбца из источника данных представлен свойством **Name** **поля**. Свойство **value** объекта **field** Возвращает или задает фактическое содержимое данных поля. Это свойство по умолчанию.

Чтобы изменить данные в поле, присвойте свойству **value значение** , равное новому значению соответствующего типа. Тип курсора должен поддерживать обновления для изменения содержимого поля. Проверка базы данных не выполняется в пакетном режиме, поэтому при вызове **UpdateBatch** в таком случае необходимо будет проверять наличие ошибок. Некоторые поставщики также поддерживают свойства **UnderlyingValue** и **ORIGINALVALUE** объекта **поля** ADO, помогающие устранять конфликты при попытке выполнить пакетное обновление. Дополнительные сведения о разрешении таких конфликтов приведены в [главе 4: Редактирование данных](chapter-4-editing-data.md).

> [!NOTE]
> Значения **полей набора записей** не могут быть заданы при добавлении новых **полей** в **набор записей**. Вместо этого новые **поля** можно добавлять в закрытый **набор записей**. Затем должен быть открыт **набор записей** , а этим **полям**могут быть назначены только значения.

## <a name="getting-more-field-information"></a>Извлечение дополнительных сведений о полях

Объекты ADO имеют два типа свойств: встроенные и динамические. К этому моменту были рассмотрены только встроенные свойства объекта **field** .

Встроенные свойства — это свойства, реализованные в ADO и сразу доступные для любого нового объекта с помощью синтаксиса. Они не отображаются как объекты **свойств** в коллекции **свойств** объекта.

Динамические свойства определяются базовым поставщиком данных и отображаются в коллекции **свойств** для соответствующего объекта ADO. Например, свойство, относящееся к поставщику, может указывать на то, поддерживает ли объект **Recordset** транзакции или обновление. Эти дополнительные свойства будут отображаться в виде объектов **Property** в коллекции **свойств** объекта **Recordset** . На динамические свойства можно ссылаться только через коллекцию, используя синтаксис MyObject. Properties (0) или или MyObject. Properties ("Name").

Вы не можете удалить любой тип свойства.

Объект динамического **Свойства** имеет четыре встроенных свойства:

- Свойство **Name** — это строка, идентифицирующая свойство.

- Свойство **Type** — это целое число, определяющее тип данных свойства.

- Свойство **value** является вариантом, который содержит параметр свойства. **Value** является свойством по умолчанию для объекта **Property** .

- Свойство **Attributes** — это **длинное** значение, которое указывает характеристики свойства, характерного для поставщика.

Коллекция **Properties** для объекта **field** содержит дополнительные метаданные о поле. Содержимое этой коллекции зависит от поставщика. В приведенном ниже примере кода показана проверка коллекции **свойств** примера объекта **Recordset** , представленного в начале этой главы. Сначала он просматривает содержимое коллекции. В этом коде используется [поставщик OLE DB для SQL Server](microsoft-ole-db-provider-for-sql-server.md), поэтому коллекция **Properties** содержит сведения, относящиеся к этому поставщику.

```vb 
 
'BeginFieldProps 
 Dim objProp As ADODB.Property 
 
 For intLoop = 0 To (objFields.Count - 1) 
 Debug.Print objFields.Item(intLoop).Name 
 
 For Each objProp In objFields(intLoop).Properties 
 Debug.Print vbTab & objProp.Name & " = " & objProp.Value 
 Next objProp 
 Next intLoop 
'EndFieldProps 
```

## <a name="dealing-with-binary-data"></a>Работа с двоичными данными

Используйте метод [AppendChunk](appendchunk-method-ado.md) для объекта **field** , чтобы заполнить его длинными двоичными или символьными данными. В ситуациях, когда ограничена системная память, можно использовать метод **AppendChunk** для управления длинными значениями в частях, а не целиком.

Если для бита **адфлдлонг** в свойстве **Attribute** объекта **field** задано **значение true**, можно использовать метод **AppendChunk** для этого поля.

Первый вызов **AppendChunk** для объекта **field** записывает данные в поле, перезаписывая существующие данные. Последующие вызовы **AppendChunk** добавляются к существующим данным. Если вы добавляете данные в одно поле, а затем задаете или просматриваете значение другого поля в текущей записи, ADO считает, что вы завершили добавление данных в первое поле. Если вызвать метод **AppendChunk** для первого поля еще раз, ADO интерпретирует вызов как новую операцию **AppendChunk** и перезаписывает существующие данные. Доступ к полям в других объектах **Recordset** , которые не являются клонами первого объекта **Recordset** , не приводит к нарушению операций **AppendChunk** .

Используйте метод **** GetObject для объекта **field** , чтобы извлечь часть или все его длинные двоичные или символьные данные. В ситуациях, когда ограничена системная память, можно использовать метод методомического **блока** для управления длинными значениями в частях, а не целиком.

Данные, возвращаемые вызовом функции- **блока** , назначаются *переменной*. Если *Размер* больше остальных данных, метод IsEmpty возвращает только **** оставшиеся данные без *переменной* заполнения с пустыми пробелами. Если поле не заполнено, метод **блока** данных возвращает значение null.

Каждый последующий вызов метода возвращает данные, начиная с того места, где предыдущий вызов **блока** . **** Однако при получении данных из одного поля и последующем установке или считывании значения другого поля в текущей записи, ADO предполагается, что вы завершили извлечение данных из первого поля. При повторном вызове метода переФрагмента для первого поля, ADO интерпретирует вызов как новую операцию, а **** затем начинает чтение с начала данных. **** Доступ к полям в других объектах **Recordset** , которые не являются клонами первого объекта **Recordset** , не приводит к нарушению операций с **блоком** .

Если для бита **адфлдлонг** в свойстве **Attribute** объекта **field** задано **значение true**, можно использовать метод GetObject для этого **** поля.

Если при использовании метода GetObject или **AppendChunk** для объекта **field** отсутствует текущая запись, возникает ошибка 3021 (нет текущей записи). ****

Пример использования этих методов для работы с двоичными данными приведен в примерах [методов](appendchunk-method-ado.md) и методов [](getchunk-method-ado.md) AppendChunk в справочнике программиста по *ADO*.


---
title: Объект Field (справочник по базе данных access для настольных ПК)
TOCTitle: The Field object
ms:assetid: 55531e04-d74f-6394-df64-1660e5d572ca
ms:mtpsurl: https://msdn.microsoft.com/library/JJ249284(v=office.15)
ms:contentKeyID: 48544926
ms.date: 09/18/2015
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 2cbd5752399e5a14f08b7eb944e3a028ba53f561
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32314023"
---
# <a name="field-object"></a>Объект Field

**Область применения**: Access 2013, Office 2013

Каждый **объект Field** обычно соответствует столбцу в таблице базы данных. Однако поле **также может** представлять указатель на другой набор **записей,** называемый главой. Исключения, такие как столбцы глав, будут освещаться далее в этом руководстве.

Используйте свойство **Value** объектов **Field,** чтобы установить или вернуть данные для текущей записи. В зависимости от функциональных возможностей, доступных поставщиком, некоторые коллекции, методы или свойства объекта **Field** могут быть недоступны.

С помощью коллекций, методов и свойств объекта **Field** можно сделать следующее:

- Возвращает имя поля с помощью свойства **Name.**

- Просмотр или изменение данных в поле с помощью свойства **Value.** **Значение** является свойством по умолчанию объекта **Field.**

- Возврат основных характеристик поля с помощью свойств **Type,** **Precision** и **NumericScale.**

- Возвращает объявленный размер поля с помощью свойства **DefinedSize.**

- Возвращает фактический размер данных в заданное поле с помощью **свойства ActualSize.**

- Определите, какие типы функций поддерживаются для данного поля, с помощью свойства **Attributes** и **коллекции свойств.**

- Манипулировать значениями полей, содержащих длинные двоичные или длинные данные символов, с помощью методов **AppendChunk** и **GetChunk.**

- Разрешать несоответствия в значениях полей во время пакетного обновления с помощью свойств **OriginalValue** и **UnderlyingValue,** если поставщик поддерживает пакетные обновления.

## <a name="describing-a-field"></a>Описание поля

В последующих подраздах будут рассмотрены свойства объекта [Field,](field-object-ado.md) которые представляют сведения, описывая сам объект **Field,** то есть метаданные о поле. Эти сведения можно использовать для определения значительной части схемы **наборов записей.** К этим свойствам относятся **Type,** **DefinedSize** и **ActualSize,** **Name** и **NumericScale** и **Precision.**

## <a name="discovering-the-data-type"></a>Обнаружение типа данных

Свойство **Type** указывает тип данных поля. The data type enumerated constants that are supported by ADO are described in [DataTypeEnum](datatypeenum.md) in the *ADO programmer's reference*.

Дополнительные сведения о числовом типе с плавающей за точкой, таких как **adNumeric,** можно получить. Свойство **NumericScale** указывает, сколько цифр справа от десятичной точки будет использоваться для представления значений **поля.** Свойство **Precision** указывает максимальное число цифр, используемых для представления значений **поля.**

## <a name="determining-field-size"></a>Определение размера поля

Используйте свойство **DefinedSize** для определения емкости данных объекта **Field.**

Используйте свойство **ActualSize** для возврата фактической длины значения объекта **Field.** Для всех полей свойство **ActualSize** имеет только чтение. Если ADO не удается определить длину значения **объекта Field,** свойство **ActualSize** возвращает **adUnknown**.

Свойства **DefinedSize** и **ActualSize** имеют разные цели. Например, рассмотрим объект **Field** с объявленным типом **adVarChar** и значением свойства **DefinedSize** 50, содержащим один символ. Возвращаемая величина свойства **ActualSize** — это длина в ветвях одного символа.

## <a name="determining-field-contents"></a>Определение содержимого поля

Идентификатор столбца из источника данных представлен свойством **Name** **поля.** Свойство **Value** объекта **Field** возвращает или задает фактическое содержимое данных поля. Это свойство по умолчанию.

Чтобы изменить данные в поле, установите для свойства **Value** значение нового значения правильного типа. Тип курсора должен поддерживать обновления для изменения содержимого поля. Проверка базы данных в этом режиме не проводится в пакетном режиме, поэтому при вызове **UpdateBatch** в таком случае вам потребуется проверить ошибки. Некоторые поставщики также поддерживают свойства **UnderlyingValue** и **OriginalValue** объекта Поля **ADO,** чтобы помочь в устранении конфликтов при попытке выполнить пакетное обновление. Сведения о том, как устранить такие конфликты, см. в главе [4 "Изменение данных".](chapter-4-editing-data.md)

> [!NOTE]
> **Значения поля набора** записей нельзя установить при добавлении новых полей **в** **набор записей.** Вместо этого новые **поля** можно примедить к закрытому **набору записей.** Затем необходимо **открыть набор** записей, и только после этого можно будет на назначены значения для этих **полей.**

## <a name="getting-more-field-information"></a>Получение дополнительных сведений о полях

У объектов ADO есть два типа свойств: встроенные и динамические. На данный момент обсуждаются только встроенные свойства объекта **Field.**

Встроенные свойства — это свойства, реализованные в ADO и сразу же доступные любому новому объекту с использованием синтаксиса. Они не отображаются как **объекты Property** в коллекции **свойств** объекта.

Динамические свойства определяются поставщиком данных и отображаются в коллекции **свойств** соответствующего объекта ADO. Например, свойство, определенное поставщику, может указывать, поддерживает ли объект **Recordset** транзакции или обновление. Эти дополнительные свойства будут отображаться как **объекты Property** в коллекции **свойств** этого объекта **Recordset.** На динамические свойства можно ссылаться только через коллекцию, используя синтаксис MyObject.Properties(0) или MyObject.Properties("Name") .

Нельзя удалить свойство любого типа.

**Динамический объект Property** имеет четыре собственных встроенных свойства:

- Свойство **Name** — это строка, определяемая свойством.

- Свойство **Type** — это integer, которое указывает тип данных свойства.

- Свойство **Value** — это вариант, содержащий параметр свойства. **Значение** является свойством по умолчанию для объекта **Property.**

- Свойство **Attributes** — **это** длинное значение, которое указывает характеристики свойства, характерного для поставщика.

Коллекция **Properties** для объекта **Field** содержит дополнительные метаданные о поле. Содержимое этой коллекции зависит от поставщика. В следующем примере кода проверяется коллекция **свойств** образца **объекта Recordset,** представленная в начале этой главы. Сначала он рассматривает содержимое коллекции. В этом коде используется [поставщик OLE DB](microsoft-ole-db-provider-for-sql-server.md)для SQL Server, поэтому коллекция **свойств** содержит сведения, релевантные для этого поставщика.

```vb 
 
'BeginFieldProps 
 Dim objProp As ADODB.Property 
 
 For intLoop = 0 To (objFields.Count - 1) 
 Debug.Print objFields.Item(intLoop).Name 
 
 For Each objProp In objFields(intLoop).Properties 
 Debug.Print vbTab & objProp.Name & " = " & objProp.Value 
 Next objProp 
 Next intLoop 
'EndFieldProps 
```

## <a name="dealing-with-binary-data"></a>Работа с двоичными данными

Используйте метод [AppendChunk](appendchunk-method-ado.md) в **объекте Field,** чтобы заполнить его длинными двоичными или символьными данными. В случаях, когда системная память ограничена, можно использовать метод **AppendChunk** для управления длинными значениями по частям, а не полностью.

Если бит **adFldLong** в свойстве **Attributes** объекта **Field** имеет свойство **True,** можно использовать метод **AppendChunk** для этого поля.

Первый вызов **AppendChunk** для объекта **Field** записывает данные в поле, переописав все существующие данные. Последующие **вызовы AppendChunk** добавляются к существующим данным. Если вы при добавлении данных в одно поле и затем установили или считыали значение другого поля в текущей записи, ADO предполагает, что вы завершили добавление данных в первое поле. При повторном вызове метода **AppendChunk** в первом поле ADO интерпретирует вызов как новую операцию **AppendChunk** и переоценит существующие данные. Доступ к полям в других **объектах Recordset,** которые не являются клонами первого объекта **Recordset,** не нарушит операции **AppendChunk.**

Используйте метод **GetChunk** для объекта **Field,** чтобы получить часть или все длинные двоичные или символьные данные. В ситуациях, когда системная память ограничена, можно использовать метод **GetChunk** для управления длинными значениями по частям, а не полностью.

Данные, возвращаемые вызовом **GetChunk,** назначены *переменной.* Если *размер* больше остальных данных, метод **GetChunk** возвращает только оставшиеся данные без переменной заполнения *с* пустыми пробелами. Если поле пустое, метод **GetChunk** возвращает значение null.

Каждый **последующий вызов GetChunk** извлекает данные, начиная с того места, где был отключен предыдущий вызов **GetChunk.** Однако если вы искомые данные из одного поля, а затем задайте или считайте значение другого поля в текущей записи, ADO предполагает, что вы завершили искомые данные из первого поля. При повторном вызове метода **GetChunk** в первом поле ADO интерпретирует вызов как новую операцию **GetChunk** и начинает чтение с начала данных. Доступ к полям в других **объектах Recordset,** которые не являются клонами первого объекта **Recordset,** не нарушит операции **GetChunk.**

Если бит **adFldLong** в свойстве **Attributes** объекта **Field** имеет свойство **True,** можно использовать метод **GetChunk** для этого поля.

Если при использовании метода **GetChunk** или **AppendChunk** для объекта **Field** нет текущей записи, возникает ошибка 3021 (текущая запись не возникает).

Пример использования этих методов для управления двоичными данными см. в примерах [appendChunk Method](appendchunk-method-ado.md) и [GetChunk Method](getchunk-method-ado.md) в справочнике *программиста ADO.*


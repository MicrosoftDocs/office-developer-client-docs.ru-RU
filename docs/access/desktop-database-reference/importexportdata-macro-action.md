---
title: Макрокоманда ImportExportData
TOCTitle: ImportExportData macro action
ms:assetid: 2cbde873-8a3d-b15c-4aab-405cddf44cea
ms:mtpsurl: https://msdn.microsoft.com/library/Ff192107(v=office.15)
ms:contentKeyID: 48543961
ms.date: 09/18/2015
mtps_version: v=office.15
f1_keywords:
- vbaac10.chm51789
f1_categories:
- Office.Version=v15
localization_priority: Normal
ms.openlocfilehash: e0cdf85461276d26005bc3066a387031a1086691
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32291889"
---
# <a name="importexportdata-macro-action"></a>Макрокоманда ImportExportData

**Область применения**: Access 2013, Office 2013

Вы можете использовать действие **импортекспортдата** для импорта или экспорта данных из текущей базы данных Access (MDB или ACCDB) или проекта Access (ADP) и другой базы данных. Для баз данных Microsoft Access можно также связать таблицу с текущей базой данных Access из другой базы данных. Связь таблицы дает возможность получать доступ к данным в ней, хотя сама таблица остается в другой базе данных.

> [!NOTE]
> Эта макрокоманда доступна только для доверенных баз данных. 

## <a name="settings"></a>Параметры

Макрокоманда **импортекспортдата** имеет следующие аргументы.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Аргумент макрокоманды</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Тип преобразования</strong></p></td>
<td><p>Нужный тип преобразования. В поле <strong>Тип преобразования</strong> в разделе <strong>Аргументы макрокоманды</strong> можно выбрать значение <strong>Импорт</strong>, <strong>Экспорт</strong> или <strong>Связь</strong>. Значение по умолчанию: <strong>Импорт</strong>.</p><p><strong>ПРИМЕЧАНИЕ.</strong> Тип преобразования <strong>Связь</strong> не поддерживается для проектов Access (ADP).</p></td>
</tr>
<tr class="even">
<td><p><strong>Тип базы данных</strong></p></td>
<td><p>Тип базы данных для импорта, экспорта или связи. В поле <strong>тип базы данных</strong> можно выбрать <strong>Microsoft Access</strong> или один из нескольких других типов базы данных. По умолчанию используется <strong>Microsoft Access</strong>.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Имя базы данных</strong></p></td>
<td><p>Имя базы данных для импорта, экспорта или связи. Следует указывать полный путь. Обязательный аргумент. Для типов баз данных, использующих отдельные файлы для каждой таблицы, например FoxPro, Paradox и dBASE, введите каталог, содержащий файл. Введите имя файла в аргументе <strong>Source</strong> (для импорта или ссылки) или в аргументе <strong>Destination</strong> (для экспорта). Для баз данных ODBC введите строку подключения к полному открытому подключению баз данных (ODBC).</p>
<p>Чтобы увидеть пример строки подключения, свяжите внешнюю таблицу с Access:</p>
<ol>
<li><p>В диалоговом окне <strong>Получение внешних данных</strong> введите путь к исходной базе данных в поле <strong>имя файла</strong> .</p></li>
<li><p>Щелкните <strong>ссылку связать с источником данных путем создания связанной таблицы</strong>и нажмите кнопку <strong>ОК</strong>.</p></li>
<li><p>Выберите таблицу в диалоговом окне <strong>ссылки на таблицы</strong> и нажмите кнопку <strong>ОК</strong>.</p></li>
</ol>
<p>Откройте новую связанную таблицу в режиме конструктора и просмотрите свойства таблицы, щелкнув <strong>лист свойств</strong> на вкладке <strong>конструктор</strong> в разделе <strong>Сервис</strong>. Текст в параметре свойства <strong>Description</strong> является строкой подключения для этой таблицы.</p>
<p>Для получения дополнительных сведений о строках подключения ODBC обратитесь к справочному файлу или другой документации для драйвера ODBC этого типа базы данных ODBC.</p></td>
</tr>
<tr class="even">
<td><p><strong>Object Type</strong></p></td>
<td><p>Тип объекта для импорта или экспорта. Если для аргумента <strong>тип базы данных</strong> выбрано значение <strong>Microsoft Access</strong> , можно выбрать <strong>Таблица</strong>, <strong>запрос</strong>, <strong>форма</strong>, <strong>отчет</strong>, <strong>макрос</strong>, <strong>модуль</strong>, <strong>Страница доступа к данным</strong>, <strong>представление сервера</strong> <strong> Схема</strong>, <strong>хранимая процедура</strong>или <strong>функция</strong> в поле <strong>тип объекта</strong> . Значение по умолчанию: <strong>Table</strong>. При выборе другого типа базы данных или при выборе <strong>ссылки</strong> в поле <strong>тип передачи</strong> этот аргумент игнорируется. При экспорте запроса на выборку в базу данных Access установите флажок <strong>Таблица</strong> в этом аргументе, чтобы экспортировать результирующий набор запроса, и выберите <strong>запрос</strong> , чтобы экспортировать сам запрос. При экспорте запроса на выборку в базу данных другого типа этот аргумент игнорируется и экспортируется набор результатов запроса.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Source</strong></p></td>
<td><p>Имя таблицы, запроса на выборку или объекта Access, который требуется импортировать, экспортировать или связать. Для некоторых типов баз данных, таких как FoxPro, Paradox или dBASE, это имя файла. Укажите расширение имени файла (например,. dbf) в имени файла. Обязательный аргумент.</p></td>
</tr>
<tr class="even">
<td><p><strong>Destination</strong></p></td>
<td><p>Имя импортированной, экспортированной или связанной таблицы, запроса на выборку или объекта Access в целевой базе данных. Для некоторых типов баз данных, таких как FoxPro, Paradox или dBASE, это имя файла. Укажите расширение имени файла (например,. dbf) в имени файла. Обязательный аргумент. Если выбрать параметр <strong>Импорт</strong> в аргументе <strong>тип передачи</strong> и <strong>Таблица</strong> в аргументе <strong>тип объекта</strong> , Access создаст новую таблицу, содержащую данные в импортированной таблице. Если импортируется таблица или другой объект, Access добавляет к имени номер, если он вступает в противоречие с существующим именем. Например, если вы импортируете сотрудников и сотрудников, Access переименовывает импортированную таблицу или другой объект Employees1. При экспорте в базу данных Access или другую базу данных Access автоматически заменяет все существующие таблицы или другие объекты с одинаковыми именами.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Только структура</strong></p></td>
<td><p>Указывает, следует ли импортировать или экспортировать только структуру таблицы базы данных без каких бы то ни было данных. Выберите <strong>Да</strong> или <strong>нет</strong>. По умолчанию используется значение <strong>Нет</strong>.</p></td>
</tr>
</tbody>
</table>


## <a name="remarks"></a>Замечания

Можно импортировать и экспортировать таблицы между Access и базами данных другого типа. Вы также можете экспортировать запросы на выборку Access к другим типам баз данных. Access экспортирует результирующий набор запроса в виде таблицы. Если обе базы данных являются базами данных Access, можно импортировать и экспортировать любые объекты базы данных Access.

При импорте таблицы из другой базы данных Access (MDB или ACCDB), которая является связанной таблицей в этой базе данных, она по-прежнему будет связана после импорта. То есть импортируется связь, а не сама таблица.

Если для доступа к базе данных требуется пароль, то при запуске макроса появится диалоговое окно. Введите пароль в этом диалоговом окне.

Действие **импортекспортдата** аналогично командам на вкладке **Внешние данные** в разделе **Импорт** или **Экспорт**. С помощью этих команд можно выбрать источник данных, например базу данных Access или другой тип базы данных, электронную таблицу или текстовый файл. При выборе базы данных отображаются одно или несколько диалоговых окон, в которых выбирается тип объекта для импорта или экспорта (для баз данных Access), имя объекта и другие параметры в зависимости от базы данных, из которой выполняется импорт или экспорт или связывание. Аргументы действия **импортекспортдата** соответствуют параметрам в этих диалоговых окнах.

Если вы хотите предоставить сведения о индексе связанной таблицы dBASE, сначала свяжите таблицу:

1.  Щелкните **файл dBASE**.

2.  В диалоговом окне **Получение внешних данных** введите путь к файлу dBASE в поле **имя файла** .

3.  Щелкните **ссылку на источник данных, чтобы создать связанную таблицу**, а затем нажмите кнопку **ОК**.

4.  Укажите индексы в диалоговых окнах для этой команды. Служба Access сохраняет сведения об индексах в особом информационном файле (INF-файле), расположенном в папке Microsoft Office.

5.  Затем можно удалить ссылку на связанную таблицу.

В следующий раз, когда вы используете действие **импортекспортдата** для связывания этой таблицы dBASE, Access использует данные индекса, которые вы указали.

> [!NOTE]
> Если вы запрашиваете или фильтруете связанную таблицу, в запросе или фильтре учитывается регистр.

Чтобы запустить действие **импортекспортдата** в модуле Visual Basic для приложений (VBA), используйте метод **трансфердатабасе** объекта **DoCmd** .


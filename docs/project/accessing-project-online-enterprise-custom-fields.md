---
title: Доступ к корпоративным настраиваемым полям Project Online
manager: soliver
ms.date: 11/08/2016
ms.audience: Developer
ms.assetid: 25509631-fa14-49d8-b594-cfacf5355c38
description: Project Online — это служба Office 365, возможности которой компании могут расширить, чтобы удовлетворить свои бизнес-потребности. Одна из областей расширения — корпоративные настраиваемые поля (ECF). Они представляют собой поля со значениями типов, которые можно добавлять к проектам, ресурсам и задачам. В приведенной ниже таблице перечислены корпоративные настраиваемые поля, которые можно связать с проектами, ресурсами и задачами, а также примеры значений для соответствующих экземпляров этих полей.
localization_priority: Priority
ms.openlocfilehash: 9f754f1446890ae021bf6f7000ffba11e2a2df33
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32355085"
---
# <a name="accessing-project-online-enterprise-custom-fields"></a><span data-ttu-id="c9fa4-106">Доступ к корпоративным настраиваемым полям Project Online</span><span class="sxs-lookup"><span data-stu-id="c9fa4-106">Accessing Project Online enterprise custom fields</span></span>

<span data-ttu-id="c9fa4-107">Project Online — это служба Office 365, возможности которой компании могут расширить, чтобы удовлетворить свои бизнес-потребности.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-107">Project Online is an Office 365 service that companies can extend to meet business needs.</span></span> <span data-ttu-id="c9fa4-108">Одна из областей расширения — корпоративные настраиваемые поля (ECF).</span><span class="sxs-lookup"><span data-stu-id="c9fa4-108">One extension area is Enterprise Custom Fields (ECFs).</span></span> <span data-ttu-id="c9fa4-109">Они представляют собой поля со значениями типов, которые можно добавлять к проектам, ресурсам и задачам.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-109">ECFs are typed value fields that can be added to projects, resources, and tasks.</span></span> <span data-ttu-id="c9fa4-110">В приведенной ниже таблице перечислены корпоративные настраиваемые поля, которые можно связать с проектами, ресурсами и задачами, а также примеры значений для соответствующих экземпляров этих полей.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-110">The following table lists ECFs that associate with projects, resources, and tasks, and provides an example of a value for an instance of that ECF:</span></span>
  
|<span data-ttu-id="c9fa4-111">Имя поля ECF</span><span class="sxs-lookup"><span data-stu-id="c9fa4-111">ECF Name</span></span>|<span data-ttu-id="c9fa4-112">Тип поля ECF</span><span class="sxs-lookup"><span data-stu-id="c9fa4-112">ECF Type</span></span>|<span data-ttu-id="c9fa4-113">Связь</span><span class="sxs-lookup"><span data-stu-id="c9fa4-113">Association</span></span>|<span data-ttu-id="c9fa4-114">Пример значения</span><span class="sxs-lookup"><span data-stu-id="c9fa4-114">Example Value</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="c9fa4-115">Обоснование</span><span class="sxs-lookup"><span data-stu-id="c9fa4-115">Justification</span></span>  <br/> |<span data-ttu-id="c9fa4-116">TEXT</span><span class="sxs-lookup"><span data-stu-id="c9fa4-116">TEXT</span></span>  <br/> |<span data-ttu-id="c9fa4-117">Проект</span><span class="sxs-lookup"><span data-stu-id="c9fa4-117">Project</span></span>  <br/> |<span data-ttu-id="c9fa4-118">Пользователь может записать ключевые данные о статистике и работоспособности с результатами, которые включают оценку работоспособности и персонализированный план действий, направленный на улучшение работоспособности.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-118">An end user can record vital statistics and health data, with results that include a health evaluation and an individualized action plan towards better health.</span></span>  <br/> |
|<span data-ttu-id="c9fa4-119">Оценка рисков</span><span class="sxs-lookup"><span data-stu-id="c9fa4-119">Risk Rating</span></span>  <br/> |<span data-ttu-id="c9fa4-120">TEXT</span><span class="sxs-lookup"><span data-stu-id="c9fa4-120">TEXT</span></span>  <br/> |<span data-ttu-id="c9fa4-121">Проект</span><span class="sxs-lookup"><span data-stu-id="c9fa4-121">Project</span></span>  <br/> |<span data-ttu-id="c9fa4-122">Низкая</span><span class="sxs-lookup"><span data-stu-id="c9fa4-122">Low</span></span>  <br/> |
|<span data-ttu-id="c9fa4-123">Рентабельность инвестиций</span><span class="sxs-lookup"><span data-stu-id="c9fa4-123">ROI</span></span>  <br/> |<span data-ttu-id="c9fa4-124">NUMBER</span><span class="sxs-lookup"><span data-stu-id="c9fa4-124">NUMBER</span></span>  <br/> |<span data-ttu-id="c9fa4-125">Проект</span><span class="sxs-lookup"><span data-stu-id="c9fa4-125">Project</span></span>  <br/> |<span data-ttu-id="c9fa4-126">2,10</span><span class="sxs-lookup"><span data-stu-id="c9fa4-126">2.10</span></span>  <br/> |
|<span data-ttu-id="c9fa4-127">Общие затраты</span><span class="sxs-lookup"><span data-stu-id="c9fa4-127">Total Cost</span></span>  <br/> |<span data-ttu-id="c9fa4-128">COST</span><span class="sxs-lookup"><span data-stu-id="c9fa4-128">COST</span></span>  <br/> |<span data-ttu-id="c9fa4-129">Проект</span><span class="sxs-lookup"><span data-stu-id="c9fa4-129">Project</span></span>  <br/> |<span data-ttu-id="c9fa4-130">1 031 514 долл. США</span><span class="sxs-lookup"><span data-stu-id="c9fa4-130">$1,031,514</span></span>  <br/> |
|<span data-ttu-id="c9fa4-131">Ответственные за выпуск</span><span class="sxs-lookup"><span data-stu-id="c9fa4-131">Launch Team</span></span>  <br/> |<span data-ttu-id="c9fa4-132">TEXT</span><span class="sxs-lookup"><span data-stu-id="c9fa4-132">TEXT</span></span>  <br/> |<span data-ttu-id="c9fa4-133">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="c9fa4-133">Resources</span></span>  <br/> |<span data-ttu-id="c9fa4-134">Да</span><span class="sxs-lookup"><span data-stu-id="c9fa4-134">Yes</span></span>  <br/> |
|<span data-ttu-id="c9fa4-135">Роль должности</span><span class="sxs-lookup"><span data-stu-id="c9fa4-135">Position Role</span></span>  <br/> |<span data-ttu-id="c9fa4-136">TEXT</span><span class="sxs-lookup"><span data-stu-id="c9fa4-136">TEXT</span></span>  <br/> |<span data-ttu-id="c9fa4-137">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="c9fa4-137">Resources</span></span>  <br/> |<span data-ttu-id="c9fa4-138">Тест-инженер</span><span class="sxs-lookup"><span data-stu-id="c9fa4-138">Tester</span></span>  <br/> |
|<span data-ttu-id="c9fa4-139">Состояние флага</span><span class="sxs-lookup"><span data-stu-id="c9fa4-139">Flag Status</span></span>  <br/> |<span data-ttu-id="c9fa4-140">FLAG</span><span class="sxs-lookup"><span data-stu-id="c9fa4-140">FLAG</span></span>  <br/> |<span data-ttu-id="c9fa4-141">Задача</span><span class="sxs-lookup"><span data-stu-id="c9fa4-141">Task</span></span>  <br/> |<span data-ttu-id="c9fa4-142">Нет</span><span class="sxs-lookup"><span data-stu-id="c9fa4-142">No</span></span>  <br/> |
|<span data-ttu-id="c9fa4-143">Работоспособность</span><span class="sxs-lookup"><span data-stu-id="c9fa4-143">Health</span></span>  <br/> |<span data-ttu-id="c9fa4-144">TEXT</span><span class="sxs-lookup"><span data-stu-id="c9fa4-144">TEXT</span></span>  <br/> |<span data-ttu-id="c9fa4-145">Задача</span><span class="sxs-lookup"><span data-stu-id="c9fa4-145">Task</span></span>  <br/> |<span data-ttu-id="c9fa4-146">Не указано</span><span class="sxs-lookup"><span data-stu-id="c9fa4-146">Not specified</span></span>  <br/> |
   
<span data-ttu-id="c9fa4-147">Корпоративные настраиваемые поля определяются в экземпляре веб-приложения Project (PWA), который является внешним по отношению к любому проекту, ресурсу или задаче.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-147">ECFs are defined at the Project Web Application (PWA) instance, external from any project, resource, or task.</span></span> <span data-ttu-id="c9fa4-148">Их все же можно связать с проектом, ресурсом или задачей.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-148">Yet, they can become associated with a project, resource, or task.</span></span> <span data-ttu-id="c9fa4-149">В этой статье представлено вводное описание настраиваемых полей на примере приложения, а также подробно рассматривается, как извлечь значения корпоративных настраиваемых полей.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-149">This article provides an introductory look at custom fields using a sample application and focuses on retrieving ECF values.</span></span> 
  
<span data-ttu-id="c9fa4-150">Готовый пример можно скачать здесь: https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-150">You can download the complete sample at https://github.com/OfficeDev/Project-CSOM-Read-Enterprise-CustomFields.</span></span>
  
<span data-ttu-id="c9fa4-151">Кроме того, Project Online поддерживает локальные настраиваемые поля в качестве доступных только для чтения сущностей, характерных для конкретного проекта, ресурса или задачи.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-151">Additionally, Project Online supports local custom fields as read-only entities specific to the specific project, resource, or task.</span></span> <span data-ttu-id="c9fa4-152">Дополнительные сведения о локальных настраиваемых полях см. в примере по адресу https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-152">For more information on local custom fields, see the sample https://github.com/OfficeDev/Project-CSOM-Read-Local-CustomFields\.</span></span>
  
## <a name="background-materials"></a><span data-ttu-id="c9fa4-153">Материалы с общими сведениями</span><span class="sxs-lookup"><span data-stu-id="c9fa4-153">Background materials</span></span>

<span data-ttu-id="c9fa4-154">В предыдущей статье [Разработка приложений для Project Online с помощью клиентской объектной модели](developing-a-project-online-application-using-the-client-side-object-model.md) представлены общие сведения о начале разработки приложений с помощью модели CSOM.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-154">A previous article, [Developing a Project Online application using the client-side object model](developing-a-project-online-application-using-the-client-side-object-model.md), provides background and the initial orientation for developing applications using CSOM.</span></span> <span data-ttu-id="c9fa4-155">Обратитесь к этой статье, чтобы получить следующую информацию:</span><span class="sxs-lookup"><span data-stu-id="c9fa4-155">Refer to this article for the following items:</span></span>
  
- <span data-ttu-id="c9fa4-156">общие сведения о Project, а также автономных и облачных выпусках;</span><span class="sxs-lookup"><span data-stu-id="c9fa4-156">Background information about Project, stand-alone and cloud-based editions</span></span> 
    
- <span data-ttu-id="c9fa4-157">сведения о среде разработки (выпуски Visual Studio и библиотеки программного обеспечения);</span><span class="sxs-lookup"><span data-stu-id="c9fa4-157">Development environment (Visual Studio editions and software libraries)</span></span>
    
- <span data-ttu-id="c9fa4-158">сведения о настройке проекта Visual Studio для приложения .NET с помощью библиотеки CSOM;</span><span class="sxs-lookup"><span data-stu-id="c9fa4-158">Visual Studio project setup for a .NET application using the CSOM library</span></span>
    
- <span data-ttu-id="c9fa4-159">сведения о подключении к службе Project Online.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-159">Connecting to the Project Online service</span></span>
    
## <a name="preliminaries-class-level-declarations"></a><span data-ttu-id="c9fa4-160">Предварительные компоненты (объявления на уровне классов)</span><span class="sxs-lookup"><span data-stu-id="c9fa4-160">Preliminaries (class-level declarations)</span></span>

<span data-ttu-id="c9fa4-161">Класс для этого приложения определяет два элемента данных: контекст проекта и словарь pwaECF.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-161">The class for this application defines two data items: the project context and the pwaECF dictionary.</span></span>
  
<span data-ttu-id="c9fa4-162">Объект контекста проекта входит в модель CSOM Project и подключает приложение к экземпляру PWA.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-162">The project context object is part of the Project CSOM, and connects the application and the PWA instance.</span></span> <span data-ttu-id="c9fa4-163">Контекст проекта используется во всех запросах к службе.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-163">All requests to the service use the project context.</span></span>
  
```cs
private static ProjectContext projContext = 
     new ProjectContext("https://Contoso216.sharepoint.com/sites/pwa");

```

<span data-ttu-id="c9fa4-164">Для создания экземпляра в приложении контексту требуется конечная точка подключения.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-164">The context needs the connection endpoint to create an instance in an application.</span></span> <span data-ttu-id="c9fa4-165">Конечная точка подключения представляет собой URL-адрес экземпляра PWA.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-165">The connection endpoint is the URL of your PWA instance.</span></span> 
  
<span data-ttu-id="c9fa4-166">Словарь pwaECF сохраняет корпоративные настраиваемые поля проекта, определенные на уровне PWA.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-166">The pwaECF dictionary stores the project ECFs defined at the PWA level.</span></span> <span data-ttu-id="c9fa4-167">Словарь использует ECF.InternalName в качестве ключа, а объект CustomField — в качестве значения.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-167">The dictionary uses the ECF.InternalName as the key, and the CustomField object as the value.</span></span> <span data-ttu-id="c9fa4-168">Словарь заполняется в методе ListPWACustomFields, а затем используется в качестве ссылки в методе Main.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-168">The dictionary is populated in the ListPWACustomFields method, and then used as a reference in the Main method.</span></span> 
  
```cs
    //Dictionary of ECFs
        static Dictionary<String, CustomField> pwaECF = new Dictionary<string, CustomField>();

```

## <a name="main-method"></a><span data-ttu-id="c9fa4-169">Метод Main</span><span class="sxs-lookup"><span data-stu-id="c9fa4-169">Main method</span></span>

<span data-ttu-id="c9fa4-170">Метод Main управляет блок-схемой приложения.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-170">The Main method manages the application flow.</span></span> <span data-ttu-id="c9fa4-171">Как и другие приложения, в которых используется модель CSOM Project Online, метод Main инициализирует контекст проекта.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-171">As with other applications that use the Project Online CSOM, Main initializes the project context.</span></span> 
  
1. <span data-ttu-id="c9fa4-172">Извлечение и перечисление корпоративных настраиваемых полей в PWA Project Online.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-172">Retrieve and list the ECFs in the Project Online PWA.</span></span>
    
   <span data-ttu-id="c9fa4-173">Эта функция реализована в методе ListPWACustomFields.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-173">This functionality is implemented in the ListPWACustomFields method.</span></span>
    
2. <span data-ttu-id="c9fa4-174">Извлечение проектов с настраиваемыми и ненастраиваемыми полями.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-174">Retrieve projects with custom fields and non-custom fields.</span></span>
    
   <span data-ttu-id="c9fa4-175">Для извлечения проектов с корпоративными настраиваемыми полями запрос в службу Project Online должен включать следующие элементы:</span><span class="sxs-lookup"><span data-stu-id="c9fa4-175">When retrieving projects with ECFs, the query request to the Project Online service needs to include the following items:</span></span> 
    
   - <span data-ttu-id="c9fa4-176">**IncludeCustomFields.** Этот элемент отправляет в службу запрос на возврат коллекции PublishedProjects, в которой каждый опубликованный проект включает расширение, поддерживающее настраиваемые поля.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-176">**IncludeCustomFields** &ndash; This item requests the service to return a collection of PublishedProjects where each published project includes an extension that supports custom fields.</span></span> <span data-ttu-id="c9fa4-177">Если этот элемент не указан, Project Online возвращает объекты PublishedProject, которые не содержат данных настраиваемых полей.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-177">Unless this item is specified, Project Online returns PublishedProject objects that do not include Custom Field data.</span></span>
    
   - <span data-ttu-id="c9fa4-178">**IncludeCustomFields.CustomFields.** Этот элемент отправляет в службу запрос на заполнение объектов PublishedProject данными CustomFields.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-178">**IncludeCustomFields.CustomFields** &ndash; This item requests the service to populate the PublishedProject objects with CustomFields data.</span></span>
    
   <span data-ttu-id="c9fa4-179">Приведенный ниже запрос задает идентификатор и имя проекта, а также расширение объекта для настраиваемых полей и их значений.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-179">The following request specifies the project Id and Name, as well as the object extension for custom fields and the custom field values.</span></span>
    
   ```cs
        var projBlk = projContext.LoadQuery(
        projContext.Projects.Include(
            p => p.Id, 
            p => p.Name,
            p => p.IncludeCustomFields,
            p => p.IncludeCustomFields.CustomFields
        ));
    
   ```

3. <span data-ttu-id="c9fa4-180">Проверка каждого проекта.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-180">Examine each project.</span></span>
    
   <span data-ttu-id="c9fa4-181">Объекты проектов, используемые в этом приложении, имеют тип PublishedProject, так как значения извлекаются и отображаются.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-181">The project objects used in this application are the PublishedProject type because the values are retrieved and displayed.</span></span> 
    
   <span data-ttu-id="c9fa4-182">Если вам нужно обновить значения данных в одном или нескольких проектах, обновляемый проект необходимо извлечь. Затем приложение с помощью объекта DraftProject извлечет значения и обновит проект.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-182">If you need to update data values in one or more projects, the project undergoing the update would be checked out and the application would use a DraftProject object to retrieve the values and update the project.</span></span>
    
4. <span data-ttu-id="c9fa4-183">Получение доступа к записям корпоративных настраиваемых полей для проекта.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-183">Accessing the ECF entries for a project</span></span>
    
   <span data-ttu-id="c9fa4-184">Каждый экземпляр корпоративного настраиваемого поля отделяет значение поля от других сведений корпоративного настраиваемого поля.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-184">Each ECF instance separates the field value from the rest of the ECF information.</span></span> <span data-ttu-id="c9fa4-185">Значение поля сохраняется как часть пары "ключ-значение".</span><span class="sxs-lookup"><span data-stu-id="c9fa4-185">The field value is stored as part of a key/value pair.</span></span> <span data-ttu-id="c9fa4-186">Остальные сведения сохраняются в объекте CustomField.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-186">The rest of the information is stored in a CustomField object.</span></span>
    
   <span data-ttu-id="c9fa4-187">Получение доступа к значениям корпоративных настраиваемых полей выполняется в два этапа:</span><span class="sxs-lookup"><span data-stu-id="c9fa4-187">Accessing ECF values in a project consists of two parts:</span></span>
    
   - <span data-ttu-id="c9fa4-188">циклический просмотр коллекции CustomFields;</span><span class="sxs-lookup"><span data-stu-id="c9fa4-188">Cycling through the CustomFields collection</span></span>
    
   - <span data-ttu-id="c9fa4-189">получение доступа к нужной записи с использованием двух конструкций.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-189">Accessing the proper entry using two constructs.</span></span>
    
   <span data-ttu-id="c9fa4-190">Каждый проект сохраняет связанные записи корпоративных настраиваемых полей в двух расположениях: в перечисляемой коллекции CustomFields и в значениях полей в составе пар "ключ-значение".</span><span class="sxs-lookup"><span data-stu-id="c9fa4-190">Each project stores associated ECF entries in two places, a CustomFields collection that is enumerable and and the field values as part of key/value pairs.</span></span> <span data-ttu-id="c9fa4-191">В парах "ключ-значение" ключом является internalName, а значением — значение поля.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-191">In the key/value pairs, the internalName is the key and the field value is the value.</span></span> <span data-ttu-id="c9fa4-192">Для сохранения значений полей и доступа к ним используйте словарь.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-192">Use a dictionary to hold and access the field values.</span></span> 
    
   <span data-ttu-id="c9fa4-193">Свойства корпоративных настраиваемых полей, отличные от значений полей, хранятся в объектах CustomField (по одному объекту на проект).</span><span class="sxs-lookup"><span data-stu-id="c9fa4-193">The ECF properties, other than the field values, are stored in CustomField objects, one object per project.</span></span> <span data-ttu-id="c9fa4-194">Используйте коллекцию CustomFields, чтобы получить доступ к корпоративным настраиваемым полям, связанным с отдельным проектом.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-194">Use a CustomFields collection to access the ECFs associated with an individual project.</span></span> 
    
5. <span data-ttu-id="c9fa4-195">В каждом проекте связанные корпоративные настраиваемые поля хранятся в коллекции, в которой каждая запись корпоративного настраиваемого поля состоит из ключа (внутреннего имени этого поля) и объекта, в котором хранится значение корпоративного настраиваемого поля.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-195">Each project stores the associated ECFs in a collection where each ECF entry consists of a key--the internal name of the ECF--and an object that holds the value of the ECF.</span></span> <span data-ttu-id="c9fa4-196">Перенесите коллекцию в словарь, чтобы получить доступ к отдельным записям.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-196">Transfer the collection to a dictionary to access individual entries.</span></span> <span data-ttu-id="c9fa4-197">Ниже представлено соответствующее объявление.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-197">The declaration follows.</span></span>
    
   ```cs
    Dictionary<string, object> projDict = pubProj.IncludeCustomFields.FieldValues;
    
   ```

   <span data-ttu-id="c9fa4-198">Значение в записи словаря соответствует типу данных корпоративного настраиваемого поля.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-198">The value in a dictionary entry corresponds to the data type of the ECF.</span></span> <span data-ttu-id="c9fa4-199">Объект для каждого корпоративного настраиваемого поля сопоставляется с одним из множества типов.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-199">The object for each ECF maps to one of a variety of types.</span></span> <span data-ttu-id="c9fa4-200">В большинстве корпоративных настраиваемых полей используются простые типы, поддерживающие стандартные переменные.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-200">Most ECFs use simple types that fit into standard variables.</span></span> <span data-ttu-id="c9fa4-201">В следующем фрагменте показано, что использование нескольких типов подразумевает обработку в минимальном объеме:</span><span class="sxs-lookup"><span data-stu-id="c9fa4-201">The following fragment shows that minimal processing is involved for several types:</span></span>
    
   ```cs
    switch (cf.FieldType)
    {
        case CustomFieldType.COST:
            decimal costValue = (decimal)oVal;
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                costValue.ToString("C"));
            break;
        case CustomFieldType.DATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FINISHDATE:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.DURATION:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.FLAG:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
        case CustomFieldType.NUMBER:
            Console.WriteLine("\tFieldType:\t{0}\n\tValue:\t{1}", cf.FieldType, 
                oVal.ToString());
            break;
    
   ```

   <span data-ttu-id="c9fa4-202">Однако для таблицы подстановки значений TEXT требуется дополнительная обработка.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-202">The lookup table of TEXT values, however, requires additional processing.</span></span> <span data-ttu-id="c9fa4-203">Приложение извлекает соответствующую таблицу подстановки из службы и выводит экземпляр корпоративного настраиваемого поля (с одним или несколькими значениями) путем обхода таблицы подстановки.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-203">The application retrieves the appropriate lookup table from the service, and outputs the ECF instance (with single or multiple values) by traversing the lookup table.</span></span> <span data-ttu-id="c9fa4-204">В приведенном ниже фрагменте кода показано, как обрабатываются корпоративные настраиваемые поля типа TEXT, в том числе поля с простыми значениями и поля, в которых используются таблицы подстановки.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-204">The following code fragment shows processing of TEXT ECFs, including those with simple values and those using lookup tables:</span></span> 
    
   ```cs
    case CustomFieldType.TEXT:
        if (!cf.LookupTable.ServerObjectIsNull.HasValue ||
            (cf.LookupTable.ServerObjectIsNull.HasValue && 
            cf.LookupTable.ServerObjectIsNull.Value))
        { //No lookup table
            Console.WriteLine("\tFieldType:\t{0}\n\tText:\t{1}", cf.FieldType, 
                oVal.ToString());
        }
        else
        { //Lookup table
            Console.WriteLine("\tFieldType:\t{0} - using Lookup Table", cf.FieldType);
            String[] entries = (String[])oVal;
            foreach (String entry in entries)
            {
                var luEntry = projContext.LoadQuery(cf.LookupTable.Entries
                    .Where(e => e.InternalName == entry));
                projContext.ExecuteQuery();
                Console.WriteLine("\tLookup Value:\t{0}", luEntry.First().FullValue);  
            }
        }
        break;
    
   ```

   <span data-ttu-id="c9fa4-205">Это приложение просто выводит значения. Однако с помощью значений данных можно получить и другие данные.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-205">This application simply outputs the value(s); however, it is possible to get more meaning from the data value(s).</span></span>
    
## <a name="listpwacustomfields"></a><span data-ttu-id="c9fa4-206">ListPWACustomFields</span><span class="sxs-lookup"><span data-stu-id="c9fa4-206">ListPWACustomFields</span></span>

<span data-ttu-id="c9fa4-207">Метод ListPWACustomFields извлекает и перечисляет корпоративные настраиваемые поля, связанные с проектами.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-207">The ListPWACustomFields method retrieves and lists the ECFs associated with projects.</span></span> <span data-ttu-id="c9fa4-208">Этот метод перечисляет корпоративные настраиваемые поля, зарегистрированные в экземпляре PWA, которые можно связать с отдельными проектами.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-208">This method lists the ECFs registered on the PWA instance that can be associated with individual projects.</span></span> <span data-ttu-id="c9fa4-209">В точке входа для доступа к корпоративным настраиваемым полям используется элемент CustomFields контекста проекта, как показано на примере следующего запроса:</span><span class="sxs-lookup"><span data-stu-id="c9fa4-209">The entry point for accessing the ECFs uses the CustomFields element of the project context, as in the following query request:</span></span>
  
```cs
// Project ECFs
    var allECFields = 
            projContext.LoadQuery(projContext.CustomFields.Include(
            qp => qp.InternalName,
            qp => qp.Name
        ));
    projContext.ExecuteQuery();

```

<span data-ttu-id="c9fa4-210">Этот метод не позволяет проверить, используется ли в проекте определенное корпоративное настраиваемое поле.</span><span class="sxs-lookup"><span data-stu-id="c9fa4-210">The method does not check to see whether a project uses a specific ECF.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="c9fa4-211">См. также</span><span class="sxs-lookup"><span data-stu-id="c9fa4-211">See also</span></span>

- [<span data-ttu-id="c9fa4-212">Портал разработки для Project</span><span class="sxs-lookup"><span data-stu-id="c9fa4-212">Project Development Portal</span></span>](https://developer.microsoft.com/ru-RU/project)
- <span data-ttu-id="c9fa4-213">
  [Обзор: корпоративные настраиваемые поля и таблицы подстановки](https://support.office.com/en-us/article/overview-enterprise-custom-fields-and-lookup-tables-f99db553-0b33-4648-93c0-f6a74637d790?ui=en-us&rs=en-us&ad=us)</span><span class="sxs-lookup"><span data-stu-id="c9fa4-213">[Overview: Enterprise custom fields and lookup tables](https://support.office.com/en-us/article/overview-enterprise-custom-fields-and-lookup-tables-f99db553-0b33-4648-93c0-f6a74637d790?ui=en-us&rs=en-us&ad=us)</span></span>
- <span data-ttu-id="c9fa4-214">[Локальные и корпоративные настраиваемые поля](https://msdn.microsoft.com/library/office/ms447495(v=office.14).aspx)</span><span class="sxs-lookup"><span data-stu-id="c9fa4-214">[Local and Enterprise Custom Fields](https://msdn.microsoft.com/library/office/ms447495(v=office.14).aspx)</span></span>
- [<span data-ttu-id="c9fa4-215">Добавление и редактирование корпоративных настраиваемых полей в Project Server 2013</span><span class="sxs-lookup"><span data-stu-id="c9fa4-215">Add or edit enterprise custom fields in Project Server 2013</span></span>](https://docs.microsoft.com/project/add-or-edit-enterprise-custom-fields-in-project-server)
    


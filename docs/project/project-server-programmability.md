---
title: Возможности программирования в Project Server
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
f1_keywords:
- events
- PDS
- PDS compatibility
- Project Server databases
- Project Server events
- Project Server Interface
- Project Server workflow
- Project workflow
- PSI
- PSI limitations
- PSI uses
- SharePoint Services
- WF
- workflow
- Workflow Foundation
- WSS
keywords:
- Архитектура и программирование PSI, проекты, версии, Project 2013 программирования, Project Server, PSI, ограничения, интерфейс Project Server неподдерживаемыми универсальный совместимости, интерфейс Project Server, компоненты, интерфейс Project Server PDS (en), Project Server, project версии, версии, проектов Project Server, базы данных, Project 2013, платформы, интерфейс Project Server, используйте события сценариев, Project Server, Project Server, данных службы Project, совместимость с PSI, Project Server Интерфейс
localization_priority: Normal
ms.assetid: a93d2153-5132-4289-af51-69350471e248
description: Узнайте о возможностях основные возможности программирования в Project Server 2013. Данная статья содержит сведения о переносе приложений, которые были созданы для предыдущих версий Project Server.
ms.openlocfilehash: c2c03da1e0b7c010d4cad8801f98c0c0cf0b1883
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19813064"
---
# <a name="project-server-programmability"></a>Возможности программирования для Project Server

Узнайте о возможностях основные возможности программирования в Project Server 2013. Данная статья содержит сведения о переносе приложений, которые были созданы для предыдущих версий Project Server.

Project Server 2013 предназначено для использования большинства приложений, предназначенных для Project Server 2010 и новые решения для нескольких платформ, где приложения оба доступны через Интернет и локальных установок Project Server. Использование клиентской объектной модели (CSOM) или интерфейса Project Server (PSI) необходимо изменен приложений и расширений, разработанных для Project Server 2003 и более ранних версий. Приложения, разработанные для Office Project Server 2007 или Project Server 2010 может потребоваться некоторые изменения и повторной компиляции для использования PSI; Чтобы использовать CSOM, изменение топологии корпоративного поиска необходимой для этих приложений.
  
Платформа Project Server позволяет высокого уровня производительности при создании приложений путем создания в SharePoint Server 2013, .NET Framework 4 и протокола OData с помощью CSOM. Разработчики могут расширить Project Web App с помощью приложения, части приложения и веб-частей, определение рабочих процессов с помощью SharePoint Designer 2013 и принудительное применение бизнес-правил с помощью удаленных приемников событий для событий Project Server.
  
## <a name="project-server-and-sharepoint-server"></a>Project Server и SharePoint Server
<a name="pj15_Programmability_MOSS"> </a>

Project Web App построен SharePoint Server 2013 и использует главные страницы и веб-частей для упрощения создания настраиваемых приложений и решений для Project Web App. Project Server 2013 глубоко интегрированы с SharePoint Server 2013 как платформа для совместной работы проектов, отчетов, Администрирование веб-сайтов, безопасности и управление рабочими процессами.
  
Сайты проектов можно найти дополнительные сведения и параметры совместной работы для участников группы, где вы можете добавлять приложения по умолчанию, включая списки SharePoint сводки, специализированные для выполнения задач с временной шкалы, трассировки проблемы, риски, связанные с проекта, project конечные результаты и Календарь группы, наряду с обсуждения рабочая группа и библиотеки документов. Настраиваемые приложения для Project Server 2013 представлены расширения и гибкие возможности для совместной работы группы. Также можно добавить части приложения для настройки приложения, используя тот же механизм для добавления и изменения веб-частей при редактировании страницы. Можно найти сайтов проектов в любом месте внутри фермы SharePoint, где установлен Project Server. Для использования других основных служб SharePoint Server 2013, таких как службы Excel и поиска в корпоративной среде, администратор может включить и настроить службы. 
  
При установке Project Server 2013 подготовить приложение-служба Project на сайте SharePoint веб-служб. Приложение-служба Project включает в себя локальные службы Windows Communication Foundation (WCF) и веб-службы ASMX для PSI. Другие примеры приложений-служб: поиска SharePoint и управления документами SharePoint. Для получения дополнительных сведений см. в документации для разработчиков SharePoint Server 2013.
  
Приложение-служба Project — это логические поставщиком, который можно управлять несколько экземпляров Project Web App. Подготовка Project Server создается конкретного сайта Project Web App в пределах веб-приложения SharePoint. На домашней странице Project Web App содержит ссылки на странице "Центр проектов", страница центра ресурсов и страницы центра бизнес-аналитики для создания отчетов, а также страницы, в котором перечислены дополнительные стандартные приложения. На рисунке 1 показана команда **Изменить страницу** в раскрывающемся списке **Принудительный** на домашней странице Project Web App, которое позволяет добавить или изменить веб-части. 
  
> [!NOTE]
> Некоторые административные страницы в Project Web App, таких как страницы параметров веб-клиента Project — недоступны для редактирования, а не показывать команду **Изменить страницу** . Project Web App не разрешать изменение страниц с помощью SharePoint Designer 2013. Вы можете изменить страниц сайта проекта с помощью SharePoint Designer 2013. 
  
**Рис. 1. Использование меню "Изменить страницу" в Project Web App**

![Изменение домашней страницы в веб-клиента Project] (media/pj15_Programmability_PWAHome.gif "Изменение домашней страницы в веб-клиента Project")
  
Для доступа к странице "Параметры узла" в Project Web App, выберите значок **Параметры** в правом верхнем углу страницы. На странице Параметры сайта ( `http://ServerName/ProjectServerName/_layouts/15/settings.aspx`) позволяет изменять внешний вид и функции и темы сайта, Добавление настраиваемых веб-частей и изменение или создание главные страницы для сайтов проектов.
  
Настройки кода в ASPX-страницы или настройки главных страниц Project Web App с помощью SharePoint Designer 2013 не поддерживается. Настройка кода на страницах Project Web App может вызвать проблемы с Project Server обновления и пакеты обновлений. 
  
### <a name="customization-of-project-web-app-with-sharepoint-packages"></a>Настройка Project Web App с помощью пакетов SharePoint
<a name="pj15_Programmability_CustomizationOfPWA"> </a>

Поскольку Project Web App — это приложение SharePoint, и сайтами проектов, сайты SharePoint, можно добавить настраиваемые приложения, веб-части, обработчиков событий, настраиваемые поля и других функций с помощью пакетов SharePoint (WSP-файлы) или приложений SharePoint (.spapp-файлы). Пакет SharePoint или пакет приложения может включать несколько сущности Project Server, где определений сущностей указаны в файле elements.xml в пакете.
  
Для Project Online можно добавить кнопки на ленте Project Web App, но нельзя удалить или переименовать существующие кнопки продукта и не удается создать новые вкладки ленты. Дополнительные сведения можно [создать настраиваемые действия для развертывания с помощью приложения для SharePoint](http://msdn.microsoft.com/en-us/library/office/apps/jj163954%28v=office.15%29.aspx).
  
> [!CAUTION]
> При установке пакета SharePoint или пакета приложения типы сущностей Project Server должны появляться в порядке, заданном схемой PSEntityProvision.xsd, иначе проверка схемы пакета завершится неудачно, и установка не будет завершена. 
  
Файл схемы PSEntityProvision.xsd доступна в пакет SDK для Project 2013 для загрузки, в `Documentation\Schemas\AppProvisioning` подкаталог. На рисунке 2 показано представление обозревателя XML-схемы в Visual Studio **PSEntityProvision** схемы, где развернута в последовательности **LookupTable** . 
  
**Рисунок 2. Представление Visual Studio схемы подготовки сущностей Project Server**

![Представление схемы сущности Project Server] (media/pj15_Programmability_EntitySchema.gif "Представление схемы сущности Project Server")
  
Пакеты SharePoint, которые устанавливают компоненты для Project Server, могут содержать один или несколько файлов elements.xml, придерживающихся схемы **PSEntityProvision**. Сущности Project Server в одном XML-файле должны появляться в следующем порядке: 
  
1. этапы рабочего процесса;
    
2. таблицы подстановки;
    
3. настраиваемые поля;
    
4. стадии рабочего процесса;
    
5. типы корпоративных проектов;
    
6. обработчики событий.
    
При создании пакета SharePoint, содержащего сущности Project Server, возможно поместить определения сущностей в несколько файлов elements.xml. Каждый XML-файл может проходить проверку схемы, но сущности во всем пакете могут не находиться в правильном порядке. Например, сущность "настраиваемое поле" в первом XML-файле может ссылаться на таблицу подстановки во втором XML-файле. Во время установки это настраиваемое поле не удастся создать, поскольку еще не будет создана таблица подстановки.
  
В случае сбоя установки пакета объектов, которые были созданы, остаются в Project Web App, но не полностью устанавливает пакет. Переустановка пакета может работать, но, который не является удобство для пользователей. После определения сущностей охватывать несколько файлов elements.xml, упорядочить сущности Project Server в пакете всей SharePoint, чтобы убедиться, что, если установка выполнена правильном порядке. С помощью схемы PSEntityProvision.xsd в пакет SDK для Project 2013 для загрузки можно разрабатывать это средство, которое проверяет наличие предписанный порядке сущности в XML-файлах.
  
## <a name="upgrading-applications-with-the-project-server-apis"></a>Обновление приложений с помощью интерфейсов API Project Server
<a name="pj15_Programmability_APIs"> </a>

При обновлении приложения, разработанного для предыдущей версии Project Server, можно использовать в качестве программного интерфейса, включающего методы для создания, чтения, обновления и удаления сущностей проекта (операции CRUD), либо CSOM, либо PSI. Хотя CSOM внутренним образом вызывает PSI, она полностью не заменяет все методы PSI. Сценарии и ограничения PSI и CSOM см. в статьях [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) и [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).
  
> [!NOTE]
> Если CSOM включает функциональных возможностей, рекомендуется обновить приложения для использования CSOM. CSOM позволяет приложениям использовать для локальных и интерактивной установки Project Server 2013. 
  
Если приложение в основном считывает данные из Project Server, можно использовать отчетности таблиц и представлений в базе данных Project Server для локального сценария. Если планируется использовать в приложении с Project Online, можно использовать протокол OData для службы **ProjectData** , содержащей локальной и оперативный доступ к данным отчетов. Для получения дополнительных сведений см [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/en-us/library/office/jj163015.aspx)
  
### <a name="using-the-psi"></a>Использование PSI
<a name="pj15_Programmability_PSI"> </a>

PSI позволяет с полным доверием клиентских приложений, включая приложения Project Professional 2013, Project Web App и LOB, для доступа к данным Project Server в ферме SharePoint. Построения PSI и использовать совместно с .NET Framework 4 и предоставляет преимущества, такие как среда известных разработки с встроенные функции безопасности, обработку ошибок и сборки мусора.
  
PSI осуществляется с помощью служб WCF или ASMX веб-служб. Интерфейс ASMX на основе WCF. Каждой службы PSI обычно содержит базовый класс с методами CRUD для элементов внутри этого класса. Элементы определены в связанных с ними классов **наборов данных** . Например служба **настраиваемых полей** содержит класс **настраиваемых полей** с методы, такие как [CreateCustomFields2](https://msdn.microsoft.com/library/WebSvcCustomFields.CustomFields.CreateCustomFields2.aspx) . Данные для одного или нескольких корпоративных настраиваемых полей указаны в **CustomFieldDataSet**.
  
> [!NOTE]
> Интерфейс ASMX веб-служб из PSI, удаленные в Project Server 2013. Несмотря на то, что интерфейс ASMX по-прежнему доступен, новых приложений, использующих PSI следует использовать интерфейс WCF или, если это возможно, новые приложения должны использовать CSOM вместо PSI. Обновление существующих приложений на основе ASMX с помощью WCF интерфейса PSI или CSOM потребует будущих версий Project Server. 
  
Существует 22 public, задокументированные службы PSI, которые повторяются в интерфейсе WCF и интерфейс ASMX. PSI также включает в себя восемь частный, недокументированного службы. Project Web App и Project Professional использовать общедоступные службы PSI и частных службы PSI. PSI обычно добавляется в соответствии с бизнес-объектов. То есть каждого метода PSI связан с бизнес-объектом, например **календаря** или **ресурса**. PSI — это основной интерфейс и бизнес-объектов. Так как бизнес-слой предоставляет для повторного использования бизнес-логики компонентов, различных приложений, которые взаимодействуют с данными Project Server используйте же бизнес-логики.
  
Методы PSI, асинхронно взаимодействовать с Project Server имеют имена, начинающиеся с **очередью**. Каждый метод PSI реализована отдельный интерфейс, что используется строго типизированных данных. Например с помощью метода **QueueCreateProject** в службу **Project** Server принимает параметр _набор данных_ **ProjectDataSet**типа. Класс **ProjectDataSet** является производным от типа **набора данных** . Проверка выполнения .NET Framework и контрольные списки IntelliSense в Visual Studio Справка, чтобы уменьшить количество ошибок при разработке с помощью PSI типа. Общие сведения о подробные ссылка для пространства имен PSI, классы, методы, свойства, события и связанные сборки содержатся в разделе [Общие сведения о Project PSI](project-psi-reference-overview.md).
  
Project Server 2013 использует обработку исключений платформы .NET Framework. Все ошибки регистрируются на сервере, в верхней части стека PSI. Некоторые ошибки отправки простого отчета клиенту, например, объект **SoapException** для интерфейс ASMX или объект **FaultException** для интерфейса WCF. Исключения можно записать в журнал событий приложений и некоторые ошибки также записать подробный отчет на сервере в журналы трассировки единой службы ведения журналов (ULS). 
  
Для локальных приложений с полным доверием PSI также может расширяться. Можно добавить сборку .NET со службой, предоставляющей новую функциональность, использующей туже инфраструктуру безопасности Project Server и вызывающей другие методы PSI или наследующей от классов PSI. Расширение PSI может также предоставлять бизнес-логику и доступ к базе данных, которые необходимы для новой функциональности.
  
### <a name="using-the-csom"></a>Использование CSOM
<a name="pj15_Programmability_CSOM"> </a>

С помощью CSOM вы можете создавать приложения, которые обращаются Project Online и локальной установки Project Server 2013. Приложения можно распространять в общедоступном магазине Office или в частном каталоге приложений. CSOM разработан для использования API, который использует напрямую или предоставляет данные по имени с помощью запросов LINQ, а не путем передачи наборов данных и создание _changeXml_ параметры или параметры _фильтра_ XML. CSOM реализует основные функциональные возможности из интерфейса Project Server (PSI) для основной сущности, например **проект**, **Задача**, **EnterpriseResource**и **назначения**. CSOM включает в себя множество новых сущностей, таких как **CustomField**, **LookupTable**, **WorkflowActivities**, **обработчик событий**и **QueueJob**, которые поддерживают другие общие функциональные возможности Project Server.
  
CSOM может использоваться путем копирования следующих ресурсов на локальный компьютер разработки.
  
- Разработка для платформы .NET Framework 4, скопируйте `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` сборки. 
    
  Документация по CSOM классы и члены пространства имен [Microsoft.ProjectServer.Client](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.aspx) см. Пример приложения в разделе [Приступая к работе с CSOM и .NET](getting-started-with-the-project-server-csom-and-net.md).
    
- Разработка для Microsoft Silverlight, скопируйте `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` сборки. 
    
- Для разработки приложений для Windows Phone 8, скопируйте `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` сборки. 
    
- Чтобы использовать JavaScript для разработки веб-приложений и приложений для других устройств, скопируйте `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` файл и `PS.debug.js` файл. Пример приложения web в разделе [Приступая к работе с объектной моделью Project Server 2013 JavaScript](getting-started-with-the-project-server-2013-javascript-object-model.md).
    
CSOM во внутренней сети вызывает PSI; Таким образом Если PSI не может выполнять задание, не могут CSOM. Ограничения CSOM [что CSOM делает и не имеет](what-the-csom-does-and-does-not-do.md) и [что PSI делает и не имеет](what-the-psi-does-and-does-not-do.md)см. Дополнительные сведения о разработке с использованием CSOM можно [обновления в Project 2013 для разработчиков](updates-for-developers-in-project-2013.md) и [объектной модели со стороны клиента (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md).
  
### <a name="porting-applications-built-for-project-server-2003"></a>Перенос приложений, построенных для Project Server 2003
<a name="pj15_Programmability_Porting2003"> </a>

В Project Server 2003 многие данные и функциональные возможности доступны только с помощью Project Professional 2003 или путем прямого доступа к базе данных. PSI, появившийся в Project Server 2007, устраняет большую часть этих ограничений. В отличие от Project Data Service (PDS) в Project Server 2003, PSI и CSOM предоставляют полные интерфейсы к бизнес-объектам в Project Server.
  
Приложения, разработанные для PDS несовместимы с последующими версиями Project Server. CSOM и PSI предоставляют функциональный эквивалент для PDS, но не соответствуют методам и параметрам PDS.
  
> [!NOTE]
> Так как приложения PDS необходимо полностью переработана для Project Server 2013, мы рекомендуем использовать CSOM. 
  
Дополнительные сведения о совместимости PDS и рекомендации по переносу расширений PDS в PSI см. в статье [PDS Parity in PSI Web Services](http://msdn.microsoft.com/library/61a0b0c7-9b74-46d1-87ed-66ffdd8017f8%28Office.15%29.aspx).
  
### <a name="porting-applications-built-for-project-server-2007-and-project-server-2010"></a>Перенос приложений, построенных для Project Server 2007 и Project Server 2010
<a name="pj15_Programmability_Porting2007"> </a>

PSI в Project Server 2013 является расширением PSI объектной модели в Office Project Server 2007 и Project Server 2010. Многие приложения, созданные для двух предыдущих версий Project Server продолжить работу в локальном локальных установок с полным доверием, Project Server 2013. Тем не менее следующие виды приложений требуются обновления или изменение топологии корпоративного поиска:
  
- Используйте CSOM для приложений, которые являются адаптировать для использования с Project Online.
    
- Используйте CSOM для приложений, адаптированных для использования на мобильных устройствах и планшетных компьютерах.
    
- Используйте CSOM для приложений, которые доступны в виде приложения в магазин Office или в частном каталоге приложений.
    
- Для приложений, изменения расписания проекта используйте CSOM или изменить приложение, чтобы использовать метод [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) PSI. 
    
- Локальный или веб-приложений, войдите в систему пользователям различных экземпляров Project Web App следует использовать программных параметров для конечных точек WCF PSI или CSOM. Методы являются устаревшими. Приложения должны использовать проверку подлинности OAuth вместо проверки подлинности форм и для использования с Project Online. Для получения дополнительных сведений см [авторизация и проверка подлинности для приложений в SharePoint 2013](http://msdn.microsoft.com/en-us/library/fp142384%28office.15%29.aspx#FileName_uniquekeyword1).
    
- Приложения, которые зависят от конкретных параметров безопасности Project Server или изменяют их.
    
  > [!NOTE]
  > По умолчанию локальной установки Project Server 2013 использует режим разрешений SharePoint, где параметры безопасности Project Server не доступны через интерфейс PSI. Чтобы изменить режим разрешений Project, см в разделе *Режим разрешений SharePoint* в [возможности впервые для ИТ-специалистов в Project Server 2013](http://technet.microsoft.com/en-us/library/ff631142%28office.15%29.aspx#section13). 
  
- Для многих настраиваемых рабочих процессов Project Server можно использовать для создания декларативных рабочих процессов SharePoint Designer 2013. Для настраиваемых рабочих процессов, которые требуют дополнительного программирования, следует *не* непосредственно использование классов и членов в пространстве имен **Microsoft.Office.Project.Server.Workflow** . Используйте класс [Microsoft.ProjectServer.Client.WorkflowActivities](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.WorkflowActivities.aspx) в CSOM. 
    
- Как правило приложения, использующие олицетворение следует переписать использование WCF интерфейса PSI. Приложения, которые обновления простого состояния для других пользователей, не требуют олицетворения. Они могут использовать метод [StatusAssignment.SubmitStatusUpdates](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.StatusAssignment.SubmitStatusUpdates.aspx) в CSOM или с помощью метода [Statusing.SubmitStatusForResource](https://msdn.microsoft.com/library/WebSvcStatusing.Statusing.SubmitStatusForResource.aspx) в PSI. 
    
- Компоненты промежуточного программного обеспечения, которые запускаются на сервере Project Server может устанавливаться только для локального использования и необходимо использовать WCF интерфейс PSI. Например программный компонент, который использует ASMX интерфейс для обмена данными между Project Web App в локальной и приложение внешнего расписания придется переопределяются для использования WCF интерфейса PSI. Для работы с Project Online компонент необходимо реализовать приложения и использовать CSOM.
    
### <a name="migration-and-compatibility-of-custom-solutions"></a>Миграция и совместимость пользовательских решений
<a name="pj15_Programmability_CustomSolutions"> </a>

Классы и элементы в общедоступных ASMX и WCF интерфейсы PSI, совпадают. Однако число столбцов и размер таблиц данных, используемые или возвращаются методами PSI может быть различие между Project Server 2013 и два предыдущих версий Project Server. Существуют также различия в отчетности таблиц и представлений, по сравнению с базы данных отчетов в предыдущих версиях.
  
> [!IMPORTANT]
> Мы настоятельно рекомендуем тщательной проверки решения в тестовой установке Project Server 2013 перед их развертыванием на рабочем сервере. 
  
При переходе на Project Server 2013 решение или решение не работает должным образом, вам необходимо по меньшей мере выполните следующее:
  
- Обновление решения, откройте в Visual Studio 2012. Некоторые решения также можно использовать Visual Studio 2010.
    
- Укажите в качестве платформы .NET Framework 4.
    
- Изменение ссылок на сборки для использования Project Server 2013 сборки, такие как Microsoft.Office.Project.Server.Library.dll и Microsoft.Office.Project.Server.Events.Receivers.dll.
    
- Создать список веб-ссылок ASMX или ссылок на службу WCF и имен пространства имен, а затем удалить ссылки Project Server.
    
- Добавьте сборку ProjectServerServices.dll прокси-сервера, что можно создать из исходного файла WCF прокси-сервера в загружаемого пакета Project 2013 SDK или добавить прокси-сервера исходных файлов для служб WCF. Для службы ASMX интерфейсных ссылки веб-службы ASMX еще раз добавьте, с помощью такие же имена пространство имен; или Добавление сборки ProjectServerServices.dll прокси-сервера, в которой можно построить из источников WSDL в пакет SDK для Project 2013 для загрузки.
    
  > [!NOTE]
  > Пространства имен в источнике прокси-сервера. в пакет SDK для Project 2013 для загрузки, файлы начинаются с *Svc* . Например пространство имен службы **ресурсов** в файле прокси-сервера WCF и в файле ASMX прокси-сервера — **SvcResource**. > Если приложение использует различные пространства имен, можно повторно компилировать сборки прокси-сервера для использования на пространства имен или изменить пространств имен PSI в приложении. Например можно изменить сценарий CompileWCFProxyAssembly.cmd и перекомпилировать ProjectServerServices.dll из исходного файла прокси-сервера в пакет SDK для загрузки. 
  
- Если изменить с помощью интерфейса WCF ASMX интерфейса PSI, можно инициализировать классов клиента программно или с помощью конечных точек WCF в файле app.config. Используйте программный инициализации при наличии быстро перейти в различных экземпляров Project Web App или при разработке веб-части, которая использует интерфейс PSI.
    
- Существует несколько новых методов и наборов данных в службах PSI в Project Server 2013 и несколько классов **DataRow** содержит новые свойства. Например с помощью метода [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) в PSI использует ядра планирования Project Server для настройки расписания обновленный проект не требуется открыть проект в Project Professional 2013 и также позволяет добавлять или удалять объектов проекта в одного вызова. 
    
- Скомпилировать и протестировать решение.
    
## <a name="project-scheduling-on-the-server"></a>Планирование проекта на сервере
<a name="pj15_Programmability_Scheduling"> </a>

Project Server 2013 имеет два ядра планирования. Файлы более новых механизм планирования совпадает с механизм планирования в Project Professional 2013. После внесения изменений в планирования и публикация изменений с помощью веб-часть планирования (страница сведений о проекте) в Project Web App или сайта проекта или с помощью CSOM расчет даты, затраты, длительность, оставшиеся трудозатраты, исходных значений и другие изменения, связанные с для планирования совпадают с внесенные изменения и публикации проекта с помощью Project Professional 2013. Тем не менее за исключением метода [QueueUpdateProject2](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject2.aspx) методы PSI использовать старые механизм планирования, которые были перенесены из Project Server 2010. Причина заключается в том, чтобы убедиться, что устаревшие приложения ведут себя одинаково в Project Server 2013, как они ранее. 
  
> [!NOTE]
> Чтобы использовать обновленный механизм планирования в Project Server 2013, приложения могут использовать CSOM. 
  
И старый, и новый механизмы планирования имеют следующие ограничения.
  
- **Планирование только одного проекта** Планирование влияет на текущий проект, при изменении через обновлений состояния задачи с помощью PSI или CSOM или с Project Web App. Если текущий проект содержит ссылки на другие проекты, подпроекты или главные проекты, связанные проекты не изменяются. 
    
- **Суммарные задачи** Суммарные задачи обычно только для чтения в Project Server. Например назначения для суммарной задачи не могут создаваться и процент выполнения не могут быть изменены. Тем не менее Project Server поддерживает редактирование дат и длительности суммарных задач, запланированных вручную. 
    
    Фактические данные в Project Server не добавляются в назначение суммарной задачи автоматически, поскольку таки образом обходился бы процесс утверждения в Project Server. При добавлении фактических данных в подзадачу в Project Professional эти фактические данные также добавляются для назначения в суммарную задачу. Эта разница в поведении может ввести пользователя в заблуждение.
    
    Project Server удаляет фактические данные в назначении суммарной задачи, если сокращается длительность подзадачи или изменяется дата окончания.
    
    > [!CAUTION]
    > Хотя Project Professional может это делать, рекомендуется не выполнять назначения в суммарных задачах. 
  
Далее приводятся проблемы и ограничения при программировании PSI с использованием старого механизма планирования Project Server.
  
- **Изменение активных состояние задачи** Старые механизм планирования Project Server можно отобразить несогласованные Пуск или при использовании метода [QueueUpdateProject](https://msdn.microsoft.com/library/WebSvcProject.Project.QueueUpdateProject.aspx) изменение активных состояние задачи, если существует несколько изменений в объекте **ProjectDataSet** для _времени окончания набор данных_ параметр. Если свойство **TASK_IS_ACTIVE** является единственным изменений в параметре _набора данных_ **QueueUpdateProject**, можно обновить проект.
    
    Дополнительные сведения о Неактивные задачи и старые механизм планирования можно блога статьи, посвященные [Использование Неактивные задачи в Project 2010](http://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) и [Project Server 2010: планирование в Интернете, PSI и Project профессиональный](http://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0). Сравнение планирование в Project профессиональный 2010 и Project Web App в Project Server 2010 в разделе [сравнения управление веб - расписанию](http://www.microsoft.com/project/en/us/project-server-2010-editions.aspx).
    
- **Не вычисляется значение освоенного объема** Старые механизм планирования вычисления поля освоенного объема: ФСВР, БПЗ, БСВР, БСЗР, знаков на ДЮЙМ, Резюме, Резюме %, Центр администрирования Exchange, SPI, SV, SV %, ПЭВ, ПЕРЕМЕННОГО, Отклонение длительности, отклонение начала, Отклонение окончания, отклонение стоимости и трудозатратам. Если в проекте имеется значения следующих полей и проект обновляется с помощью метода **QueueUpdateProject** , не изменяйте значения полей. Чтобы избежать проблем, используйте метод **QueueUpdateProject2** . 
    
Ограничения планирования PSI можно обойти следующими способами.
  
- Если в CSOM имеются методы, необходимые для приложения, используйте CSOM вместо PSI.
    
- Открывайте проекты в Project Professional и сохраняйте их обратно в Project Server.
    
- Не включайте в отчетах поля, которые PSI не обновляет.
    
- Добавляйте в отчеты примечание о данных, которые могут быть устаревшими.
    
В таблицах отчетов и кубах имеются флаги, помогающие заметить, когда некоторые данные не обновляются. Данные отчетов в таблице MSP_EpmProject и в MSP_EpmProject_UserView содержат следующие поля. 
  
-  _СДР проекта устарела_ &ndash; Указывает, является ли устаревших декомпозиции работ (иерархии структуры задач). 
    
-  _Освоенные объемы проекта устарели_ &ndash; Указывает поля освоенного устарели. 
    
-  _ProjectRollupsAreStale_ &ndash; Указывает, что подпроекты обновляется в базу данных черновиков, но не обновляются главный проект. Сведенные значения из подпроектов устарели. 
    
-  _Иерархия проекта не синхронизована_ &ndash; Главного проекта не синхронизируются с его дочерние элементы. Это происходит, когда дочерних проектов не опубликован явным образом, не входящего в состав публикация главного проекта. 
    
-  _Расчеты проекта устарели_ &ndash; Project Professional сохранения проекта без расчета календарного (то есть, режим пересчета имеет значение **вручную** на вкладке **расписание** в диалоговом окне **Параметры проекта** ). 
    
-  _Скрытая задача проекта устарела_ &ndash; Аналогичен _Иерархия проекта не синхронизована_, но предупреждение о том, с использованием данных связи между проектами. Возможна главных проекта еще не существует, что данные проекта с одной стороны ссылки новее с другой стороны.
    
## <a name="about-accessing-the-project-server-database"></a>О доступе к базе данных Project Server
<a name="pj15_Programmability_Databases"> </a>

При наличии разрешения в Microsoft SQL Server для доступа к базе данных Project Server могут читать отчетов таблицы и представления. При наличии необходимых разрешений Project Server можно считывания данных из таблицы отчетов с помощью запросов OData. Разработчики не рекомендуется прямой доступ к черновиков, опубликованных проектов, или архивировать таблиц с помощью запросов SQL Server в базе данных Project Server. Прямого изменения во всех таблиц в базе данных Project Server повреждении целостность данных, а в конфликт с доступа к базе данных через службы очередей Project Server.
  
> [!IMPORTANT]
> Ничто не препятствует использованию прямого программного доступа к базе данных для обновления данных. Следует помнить, что кэш, опубликованные таблицы и таблицы отчетов Project Professional зависят от протокола синхронизации кэша, который может быть поврежден в результате прямого изменения данных. Если вы повредили базу данных Project Server или испортили клиентские кэши Project Professional, используя прямой доступ для изменения данных, то техническая поддержка по продукту не сможет вам помочь! 
  
Приложения, которые прямого доступа к черновик, публикации или архивировать таблиц и представлений, также зависят от схемы базы данных, которые можно изменить в пакетами обновления или более поздних версий Project Server 2013. Приложения, которые прямого доступа к базам данных также теряют встроенные функции безопасности Project Server, распространенные бизнес-логики, отслеживания, аудит, проверка ошибок, отчетов, рабочих процессов и других функций. Скорее всего, следует переопределить такого приложения после обновления Project Server 2013. 
  
Для всех этих причин Project Professional и Project Web App не сделать прямых вызовов черновиков, опубликованных проектов, или заархивируйте таблиц; не следует любого другого приложения, интегрированного с Project Server.
  
Схемы для черновиков, опубликованных проектов, и не описаны таблицы архива. Отчетные таблицы можно использовать для создания отчетов и задокументировано схемы для работы с отчетами таблиц и представлений в пакет SDK для Project 2013 для загрузки. Схема OData данных отчетов в разделе [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/en-us/library/office/jj163015.aspx).
  
## <a name="see-also"></a>См. также

- [Обновления для разработчиков в Project 2013](updates-for-developers-in-project-2013.md)    
- [Project Server 2013 architecture](project-server-2013-architecture.md)    
- [Какие задачи PSI выполняет, а какие — нет](what-the-psi-does-and-does-not-do.md)   
- [Какие задачи CSOM выполняет, а какие — нет](what-the-csom-does-and-does-not-do.md)    
- [Клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md)    
- [Начало разработки рабочих процессов Project Server](getting-started-developing-project-server-workflows.md)    
- [Справочные материалы по программированию Project 2013](project-2013-programming-references.md)    
- [Справочный обзор PSI Project](project-psi-reference-overview.md)    
- [Создание настраиваемого действия для развертывания с приложениями для SharePoint](http://msdn.microsoft.com/en-us/library/office/apps/jj163954%28v=office.15%29.aspx)    
- [Краткие сведения о Неактивные задачи в Project 2010](http://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)    
- [Project Server 2010: Планирование на веб-сайта, PSI и Project профессиональный](http://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0)
- [Сравнение управления веб-расписание](http://www.microsoft.com/project/en/us/project-server-2010-editions.aspx)
    


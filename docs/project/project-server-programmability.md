---
title: Возможности программирования для Project Server
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
f1_keywords:
- events
- PDS
- PDS compatibility
- Project Server databases
- Project Server events
- Project Server Interface
- Project Server workflow
- Project workflow
- PSI
- PSI limitations
- PSI uses
- SharePoint Services
- WF
- workflow
- Workflow Foundation
- WSS
keywords:
- project 2013, архитектура и поддержка программирования, PSI, проекты, версии, поддержка программирования, Project Server, PSI, ограничения, интерфейс Project Server, неподдерживаемые возможности, интерфейс Project Server, совместимость с PDS, интерфейс Project Server, настройка, Project Server, версии проектов, версии, проекты, Project Server, базы данных, Project 2013, платформа, интерфейс Project Server, использование сценариев, Project Server, события, Project Server, службы данных проекта, совместимость с PSI, интерфейс Project Server
ms.assetid: a93d2153-5132-4289-af51-69350471e248
description: Узнайте о наиболее важных функциях программирования в Project Server 2013. В этой статье содержатся сведения о переносе приложений, созданных для предыдущих версий Project Server.
localization_priority: Priority
ms.openlocfilehash: e6991712b87291e90c6b4f277db84686aab384e7
ms.sourcegitcommit: 31b0a7373ff74fe1d6383c30bc67d7675b73d283
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2020
ms.locfileid: "41773731"
---
# <a name="project-server-programmability"></a><span data-ttu-id="9fd02-105">Возможности программирования для Project Server</span><span class="sxs-lookup"><span data-stu-id="9fd02-105">Project Server programmability</span></span>

<span data-ttu-id="9fd02-106">Узнайте о наиболее важных функциях программирования в Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-106">Learn about the major programmability features in Project Server 2013.</span></span> <span data-ttu-id="9fd02-107">В этой статье содержатся сведения о переносе приложений, созданных для предыдущих версий Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-107">This article includes information about porting applications that were built for previous versions of Project Server.</span></span>

<span data-ttu-id="9fd02-108">Project Server 2013 предназначен для поддержки большинства приложений, которые были разработаны для Project Server 2010, и новых решений для разных платформ, в которых доступ к приложениям можно получать онлайн и из локальных экземпляров Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-108">Project Server 2013 is designed to support most applications that were developed for Project Server 2010 and new solutions for multiple platforms, where apps can access both online and on-premises Project Server installations.</span></span> <span data-ttu-id="9fd02-109">Для использования клиентской объектной модели (CSOM) или интерфейса Project Server интерфейс (PSI) необходимо изменить приложения и расширения, которые были разработаны для Project Server 2003 или более ранней версии.</span><span class="sxs-lookup"><span data-stu-id="9fd02-109">Applications and extensions that were developed for Project Server 2003 or earlier must be redesigned to use the client-side object model (CSOM) or the Project Server Interface (PSI).</span></span> <span data-ttu-id="9fd02-110">Приложения, которые были разработаны для Office Project Server 2007 или Project Server 2010, могут потребовать некоторых изменений и повторной компиляции для использования PSI. Чтобы использовать CSOM, эти приложения нужно изменить.</span><span class="sxs-lookup"><span data-stu-id="9fd02-110">Applications that were developed for Office Project Server 2007 or Project Server 2010 may require some changes and recompiling to use the PSI; to use the CSOM, those applications require a redesign.</span></span>
  
<span data-ttu-id="9fd02-111">Платформа Project Server позволяет программистам добиться высокой продуктивности за счет использования SharePoint Server 2013, .NET Framework 4 и протокола OData с CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-111">The Project Server platform enables high levels of programmer productivity by building on SharePoint Server 2013, .NET Framework 4, and the OData protocol with the CSOM.</span></span> <span data-ttu-id="9fd02-112">Разработчики могут расширить Project Web App с помощью приложений, частей приложений и веб-частей, определить рабочие процессы с помощью SharePoint Designer 2013 и принудительно применить бизнес-правила с помощью удаленных приемников событий Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-112">Developers can extend Project Web App with apps, app parts, and Web Parts, define workflows by using SharePoint Designer 2013, and enforce business rules by using remote event receivers for Project Server events.</span></span>
  
## <a name="project-server-and-sharepoint-server"></a><span data-ttu-id="9fd02-113">Project Server и SharePoint Server</span><span class="sxs-lookup"><span data-stu-id="9fd02-113">Project Server and SharePoint Server</span></span>
<span data-ttu-id="9fd02-114"><a name="pj15_Programmability_MOSS"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-114"><a name="pj15_Programmability_MOSS"> </a></span></span>

<span data-ttu-id="9fd02-115">Приложение Project Web App создано на основе SharePoint Server 2013 и использует эталонные страницы и веб-части, что упрощает создание пользовательских приложений и решений Project Web App.</span><span class="sxs-lookup"><span data-stu-id="9fd02-115">Project Web App is built upon SharePoint Server 2013, and uses master pages and Web Parts to make it easier to build custom apps and Project Web App solutions.</span></span> <span data-ttu-id="9fd02-116">Project Server 2013 тесно интегрируется с SharePoint Server 2013 как платформа для совместной работы над проектом, отчетности, администрирования сайтов, безопасности и управления рабочими процессами.</span><span class="sxs-lookup"><span data-stu-id="9fd02-116">Project Server 2013 integrates deeply with SharePoint Server 2013 as the platform for project collaboration, reporting, site administration, security, and workflow management.</span></span>
  
<span data-ttu-id="9fd02-117">Сайты проектов включают дополнительные сведения и параметры совместной работы для участников группы, здесь можно добавить стандартные приложения, которые включают сводку по проекту, специальные списки SharePoint для задач с временной шкалой, отслеживание вопросов, риски, конечные результаты проекта и календарь группы, а также библиотеку документов и коллективные обсуждения.</span><span class="sxs-lookup"><span data-stu-id="9fd02-117">The project sites include more information and collaboration options for team members, where you can add default apps that include a project summary, specialized SharePoint lists for tasks with a timeline, tracking issues, risks, project deliverables, and the team calendar, along with the document library and team discussions.</span></span> <span data-ttu-id="9fd02-118">Пользовательские приложения для Project Server 2013 содержат расширения и предоставляют гибкие возможности для совместной работы участников группы.</span><span class="sxs-lookup"><span data-stu-id="9fd02-118">Custom apps for Project Server 2013 provide extensions and flexibility for team collaboration.</span></span> <span data-ttu-id="9fd02-119">Можно также настраивать приложения, добавляя их части с помощью того же механизма, который используется для добавления и изменения веб-частей при редактировании страницы.</span><span class="sxs-lookup"><span data-stu-id="9fd02-119">You can also add app parts to customize an app, by using the same mechanism to add and edit Web Parts when you edit a page.</span></span> <span data-ttu-id="9fd02-120">Вы можете разместить сайты проектов в любом месте фермы SharePoint, где установлен Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-120">You can locate project sites anywhere within the SharePoint farm where Project Server is installed.</span></span> <span data-ttu-id="9fd02-121">Чтобы использовать другие основные службы SharePoint Server 2013, например службы Excel и поиск в корпоративной среде, администратор может включить и настроить службы.</span><span class="sxs-lookup"><span data-stu-id="9fd02-121">To use other core services of SharePoint Server 2013, such as Excel Services and Enterprise Search, an administrator can enable and configure the services.</span></span> 
  
<span data-ttu-id="9fd02-122">Во время установки Project Server 2013 подготавливается приложение-служба Project на сайте веб-служб SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9fd02-122">When you install Project Server 2013, you provision the Project Service Application in the SharePoint Web Services site.</span></span> <span data-ttu-id="9fd02-123">Приложение-служба Project содержит локальные службы Windows Communication Foundation (WCF) и веб-службы ASMX для PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-123">The Project Service Application includes the local Windows Communication Foundation (WCF) services and ASMX web services for the PSI.</span></span> <span data-ttu-id="9fd02-124">Другие примеры приложений-служб: поиск SharePoint и управление документами SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9fd02-124">Other examples of service applications include SharePoint Search and SharePoint Document Management.</span></span> <span data-ttu-id="9fd02-125">Дополнительные сведения см. в документации SharePoint Server 2013 для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="9fd02-125">For more information, see the SharePoint Server 2013 developer documentation.</span></span>
  
<span data-ttu-id="9fd02-126">Приложение службы Project — это поставщик логической службы, которая может управлять несколькими экземплярами Project Web App.</span><span class="sxs-lookup"><span data-stu-id="9fd02-126">The Project Service Application is a logical service provider that can manage multiple instances of Project Web App.</span></span> <span data-ttu-id="9fd02-127">Во время подготовки Project Server создается определенный сайт Project Web App в веб-приложении SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9fd02-127">Project Server provisioning creates a specific Project Web App site within a SharePoint web application.</span></span> <span data-ttu-id="9fd02-128">Домашняя страница Project Web App содержит ссылки на страницу центра проектов, страницу центра ресурсов и страницу центра бизнес-аналитики для отчетности, а также страницу, которая содержит список дополнительных стандартных приложений.</span><span class="sxs-lookup"><span data-stu-id="9fd02-128">The Home page of Project Web App contains links to the Project Center page, Resource Center page, and the Business Intelligence Center page for reporting, plus a page that contains a list of additional standard apps.</span></span> <span data-ttu-id="9fd02-129">На рис. 1 показана команда **Изменить страницу** в раскрывающемся списке **Параметры** на домашней странице Project Web App, где можно добавить или изменить веб-части.</span><span class="sxs-lookup"><span data-stu-id="9fd02-129">Figure 1 shows the **Edit Page** command in the **Setttings** drop-down list on the Home page of Project Web App, which allows you to add or edit Web Parts.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="9fd02-130">Некоторые административные страницы в Project Web App, например страницу "Параметры PWA", изменить невозможно, на них не отображается команда **Изменить страницу**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-130">Some administrative pages in Project Web App—such as the PWA Settings page—are not editable, and do not show the **Edit Page** command.</span></span> <span data-ttu-id="9fd02-131">Project Web App не позволяет редактировать страницы с помощью SharePoint Designer 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-131">Project Web App does not allow you to edit pages by using SharePoint Designer 2013.</span></span> <span data-ttu-id="9fd02-132">Редактировать страницы на сайте проекта можно с помощью SharePoint Designer 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-132">You can edit project site pages with SharePoint Designer 2013.</span></span> 
  
<span data-ttu-id="9fd02-133">**Рис. 1. Использование меню "Изменить страницу" в Project Web App**</span><span class="sxs-lookup"><span data-stu-id="9fd02-133">**Figure 1. Using the Edit Page menu in Project Web App**</span></span>

<span data-ttu-id="9fd02-134">![Редактирование домашней страницы в Project Web Access](media/pj15_Programmability_PWAHome.gif "Редактирование домашней страницы в Project Web Access")</span><span class="sxs-lookup"><span data-stu-id="9fd02-134">![Editing the Home page in Project Web Access](media/pj15_Programmability_PWAHome.gif "Editing the Home page in Project Web Access")</span></span>
  
<span data-ttu-id="9fd02-135">Чтобы получить доступ к странице "Параметры сайта" в Project Web App, выберите значок **Параметры** в правом верхнем углу страницы.</span><span class="sxs-lookup"><span data-stu-id="9fd02-135">To access the Site Settings page in Project Web App, choose the **Settings** icon in the top-right corner of the page.</span></span> <span data-ttu-id="9fd02-136">Страница "Параметры сайта" (`https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) позволяет изменять внешний вид, функции и тему сайта, добавлять пользовательские веб-части, а также изменять или создавать эталонные страницы для сайтов проектов.</span><span class="sxs-lookup"><span data-stu-id="9fd02-136">The Site Settings page (  `https://ServerName/ProjectServerName/_layouts/15/settings.aspx`) enables changing the look and feel and the site theme, adding custom Web Parts, and modifying or creating master pages for project sites.</span></span>
  
<span data-ttu-id="9fd02-137">Настройка кода на ASPX-страницах и настройка эталонных страниц Project Web App с помощью SharePoint Designer 2013 не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="9fd02-137">Customization of the code in ASPX pages, or customization of Project Web App master pages with SharePoint Designer 2013, is not supported.</span></span> <span data-ttu-id="9fd02-138">Настройка кода на страницах Project Web App может привести к проблемам с обновлениями Project Server и пакетов обновления.</span><span class="sxs-lookup"><span data-stu-id="9fd02-138">Customization of the code in Project Web App pages can cause problems with Project Server updates and service packs.</span></span> 
  
### <a name="customization-of-project-web-app-with-sharepoint-packages"></a><span data-ttu-id="9fd02-139">Настройка Project Web App с помощью пакетов SharePoint</span><span class="sxs-lookup"><span data-stu-id="9fd02-139">Customization of Project Web App with SharePoint packages</span></span>
<span data-ttu-id="9fd02-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-140"><a name="pj15_Programmability_CustomizationOfPWA"> </a></span></span>

<span data-ttu-id="9fd02-141">Так как Project Web App — это приложение SharePoint, а сайты проектов — это сайты SharePoint, можно добавлять пользовательские приложения, веб-части, обработчики событий, настраиваемые поля и другие функции с помощью пакетов SharePoint (файлов WSP) или приложений SharePoint (файлов SPAPP).</span><span class="sxs-lookup"><span data-stu-id="9fd02-141">Because Project Web App is a SharePoint application, and project sites are SharePoint sites, you can add custom apps, Web Parts, event handlers, custom fields, and other features by using SharePoint packages (.wsp files) or SharePoint apps (.spapp files).</span></span> <span data-ttu-id="9fd02-142">Пакет SharePoint или пакет приложения может содержать несколько сущностей Project Server, где определения сущности приведены в файле elements.xml из пакета.</span><span class="sxs-lookup"><span data-stu-id="9fd02-142">A SharePoint package or an app package can include multiple Project Server entities, where entity definitions are specified in an elements.xml file within the package.</span></span>
  
<span data-ttu-id="9fd02-143">Для использования Microsoft Project Online можно добавить кнопки на ленту Project Web App, но невозможно удалить или переименовать существующие кнопки продукта, как и создать новые вкладки ленты.</span><span class="sxs-lookup"><span data-stu-id="9fd02-143">For Project Online, you can add buttons to the Project Web App ribbon, but you can't remove or rename existing product buttons, and you can't create new ribbon tabs.</span></span> <span data-ttu-id="9fd02-144">Дополнительные сведения см. в статье [Выполнение пользовательских действий для развертывания приложений для SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span><span class="sxs-lookup"><span data-stu-id="9fd02-144">For more information, see [Create custom actions to deploy with apps for SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins).</span></span>
  
> [!CAUTION]
> <span data-ttu-id="9fd02-145">При установке пакета SharePoint или пакета приложения типы сущностей Project Server должны появляться в порядке, заданном схемой PSEntityProvision.xsd, иначе проверка схемы пакета завершится неудачно, и установка не будет завершена.</span><span class="sxs-lookup"><span data-stu-id="9fd02-145">When you install a SharePoint package or an app package, the types of Project Server entities must appear in the order that the PSEntityProvision.xsd schema specifies or schema validation of the package fails and installation is not completed.</span></span> 
  
<span data-ttu-id="9fd02-146">Файл схемы PSEntityProvision.xsd доступен в загружаемом пакете SDK Project 2013 в подкаталоге `Documentation\Schemas\AppProvisioning`.</span><span class="sxs-lookup"><span data-stu-id="9fd02-146">The PSEntityProvision.xsd schema file is available in the Project 2013 SDK download, in the  `Documentation\Schemas\AppProvisioning` subdirectory.</span></span> <span data-ttu-id="9fd02-147">На рис. 2 показано представление проводника схемы XML в Visual Studio из схемы **PSEntityProvision**, где развернута последовательность **LookupTable**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-147">Figure 2 shows the XML Schema Explorer view in Visual Studio of the **PSEntityProvision** schema, where the **LookupTable** sequence is expanded.</span></span> 
  
<span data-ttu-id="9fd02-148">**Рис. 2. Представление Visual Studio схемы подготовки сущностей Project Server**</span><span class="sxs-lookup"><span data-stu-id="9fd02-148">**Figure 2. Visual Studio view of the Project Server entity provisioning schema**</span></span>

<span data-ttu-id="9fd02-149">![Представление схемы сущности Project Server](media/pj15_Programmability_EntitySchema.gif "Представление схемы сущности Project Server")</span><span class="sxs-lookup"><span data-stu-id="9fd02-149">![View of the Project Server entity schema](media/pj15_Programmability_EntitySchema.gif "View of the Project Server entity schema")</span></span>
  
<span data-ttu-id="9fd02-p115">Пакеты SharePoint, которые устанавливают компоненты для Project Server, могут содержать один или несколько файлов elements.xml, придерживающихся схемы **PSEntityProvision**. Сущности Project Server в одном XML-файле должны появляться в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="9fd02-p115">SharePoint packages that install features for Project Server can contain one or more elements.xml files that follow the **PSEntityProvision** schema. The Project Server entities in a single XML file must appear in the following order:</span></span> 
  
1. <span data-ttu-id="9fd02-152">этапы рабочего процесса;</span><span class="sxs-lookup"><span data-stu-id="9fd02-152">Workflow phases</span></span>
    
2. <span data-ttu-id="9fd02-153">таблицы подстановки;</span><span class="sxs-lookup"><span data-stu-id="9fd02-153">Lookup tables</span></span>
    
3. <span data-ttu-id="9fd02-154">настраиваемые поля;</span><span class="sxs-lookup"><span data-stu-id="9fd02-154">Custom fields</span></span>
    
4. <span data-ttu-id="9fd02-155">стадии рабочего процесса;</span><span class="sxs-lookup"><span data-stu-id="9fd02-155">Workflow stages</span></span>
    
5. <span data-ttu-id="9fd02-156">типы корпоративных проектов;</span><span class="sxs-lookup"><span data-stu-id="9fd02-156">Enterprise project types</span></span>
    
6. <span data-ttu-id="9fd02-157">обработчики событий.</span><span class="sxs-lookup"><span data-stu-id="9fd02-157">Event handlers</span></span>
    
<span data-ttu-id="9fd02-p116">При создании пакета SharePoint, содержащего сущности Project Server, возможно поместить определения сущностей в несколько файлов elements.xml. Каждый XML-файл может проходить проверку схемы, но сущности во всем пакете могут не находиться в правильном порядке. Например, сущность "настраиваемое поле" в первом XML-файле может ссылаться на таблицу подстановки во втором XML-файле. Во время установки это настраиваемое поле не удастся создать, поскольку еще не будет создана таблица подстановки.</span><span class="sxs-lookup"><span data-stu-id="9fd02-p116">When you create a SharePoint package that contains Project Server entities, it is possible to put the entity definitions in multiple elements.xml files. Each XML file could pass the schema validation, but the entities in the whole package might not be in the correct order. For example, a custom field entity in the first XML file could refer to a lookup table in the second XML file. During installation, the custom field cannot be created because the lookup table has not yet been created.</span></span>
  
<span data-ttu-id="9fd02-162">Если установить пакет не удается, объекты, которые были созданы, остаются в Project Web App, но полная установка пакета не выполняется.</span><span class="sxs-lookup"><span data-stu-id="9fd02-162">If a package installation fails, objects that have been created remain in Project Web App, but the package does not install completely.</span></span> <span data-ttu-id="9fd02-163">Переустановка пакета может принести нужный результат, но впечатления клиентов при этом ухудшатся.</span><span class="sxs-lookup"><span data-stu-id="9fd02-163">Reinstalling the package can work, but that is not a good experience for customers.</span></span> <span data-ttu-id="9fd02-164">Если определения сущности охватывают несколько файлов elements.xml, нужно упорядочить сущности Project Server во всем пакете SharePoint, чтобы убедиться, что установка выполняется в правильном порядке.</span><span class="sxs-lookup"><span data-stu-id="9fd02-164">When the entity definitions span multiple elements.xml files, organize the Project Server entities in the entire SharePoint package to ensure that installation follows the correct order.</span></span> <span data-ttu-id="9fd02-165">С помощью схемы PSEntityProvision.xsd из загружаемого пакета SDK Project 2013 поддерживается разработка инструмента, который проверяет предписанный порядок сущностей в XML-файлах.</span><span class="sxs-lookup"><span data-stu-id="9fd02-165">With the PSEntityProvision.xsd schema in the Project 2013 SDK download, it is possible to develop a tool that checks for the prescribed order of entities in the XML files.</span></span>
  
## <a name="upgrading-applications-with-the-project-server-apis"></a><span data-ttu-id="9fd02-166">Обновление приложений с помощью интерфейсов API Project Server</span><span class="sxs-lookup"><span data-stu-id="9fd02-166">Upgrading applications with the Project Server APIs</span></span>
<span data-ttu-id="9fd02-167"><a name="pj15_Programmability_APIs"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-167"><a name="pj15_Programmability_APIs"> </a></span></span>

<span data-ttu-id="9fd02-p118">При обновлении приложения, разработанного для предыдущей версии Project Server, можно использовать в качестве программного интерфейса, включающего методы для создания, чтения, обновления и удаления сущностей проекта (операции CRUD), либо CSOM, либо PSI. Хотя CSOM внутренним образом вызывает PSI, она полностью не заменяет все методы PSI. Сценарии и ограничения PSI и CSOM см. в статьях [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) и [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).</span><span class="sxs-lookup"><span data-stu-id="9fd02-p118">When you upgrade an application that was developed for a previous version of Project Server, you can choose to use either the CSOM or the PSI for a programmatic interface that includes methods to create, read, update, and delete project entities (the CRUD operations). Although the CSOM internally calls the PSI, it does not fully replace all PSI methods. For scenarios and limitations of the PSI and of the CSOM, see [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md) and [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md).</span></span>
  
> [!NOTE]
> <span data-ttu-id="9fd02-171">Если CSOM включает необходимые вам функции, рекомендуем обновить приложения для использования CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-171">If the CSOM includes the functionality you require, we recommend that you upgrade applications to use the CSOM.</span></span> <span data-ttu-id="9fd02-172">CSOM позволяет использовать приложения, предназначенные для локальных и онлайновых экземпляров Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-172">The CSOM enables applications to be used for both on-premises and online installations of Project Server 2013.</span></span> 
  
<span data-ttu-id="9fd02-173">Если ваше приложение главным образом считывает данные из Project Server, вы можете использовать представления и таблицы отчетов в базе данных Project Server для сценария локального развертывания.</span><span class="sxs-lookup"><span data-stu-id="9fd02-173">If your application primarily reads data from Project Server, you can use the reporting tables and views in the Project Server database for an on-premises scenario.</span></span> <span data-ttu-id="9fd02-174">Если вы планируете использовать приложение с Microsoft Project Online, можно использовать протокол OData для службы **ProjectData**, которая предоставляет доступ к локальным и онлайновым данным отчетов.</span><span class="sxs-lookup"><span data-stu-id="9fd02-174">If you intend to use the application with Project Online, you can use the OData protocol for the **ProjectData** service, which provides both on-premises and online access to the reporting data.</span></span> <span data-ttu-id="9fd02-175">Дополнительные сведения см. в статье [Справочник по службе ProjectData](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="9fd02-175">For more information, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15))</span></span>
  
### <a name="using-the-psi"></a><span data-ttu-id="9fd02-176">Использование PSI</span><span class="sxs-lookup"><span data-stu-id="9fd02-176">Using the PSI</span></span>
<span data-ttu-id="9fd02-177"><a name="pj15_Programmability_PSI"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-177"><a name="pj15_Programmability_PSI"> </a></span></span>

<span data-ttu-id="9fd02-178">PSI поддерживает клиентские приложения с полным доверием, включая Project профессиональный 2013, Project Web App и бизнес-приложения, для доступа к данным Project Server в ферме SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9fd02-178">The PSI enables full-trust client applications, including Project Professional 2013, Project Web App, and LOB applications, to access Project Server data within a SharePoint farm.</span></span> <span data-ttu-id="9fd02-179">PSI создан и используется с .NET Framework 4 и предоставляет такие преимущества, как хорошо знакомая среда разработки со встроенными средствами безопасности, обработкой ошибок и сбором мусора.</span><span class="sxs-lookup"><span data-stu-id="9fd02-179">The PSI is built and used with .NET Framework 4 and provides advantages such as a well-known development environment with built-in security, error handling, and garbage collection.</span></span>
  
<span data-ttu-id="9fd02-180">Доступ к PSI осуществляется с помощью служб WCF или веб-служб ASMX.</span><span class="sxs-lookup"><span data-stu-id="9fd02-180">The PSI is accessed through WCF services or ASMX web services.</span></span> <span data-ttu-id="9fd02-181">Интерфейс ASMX основан на WCF.</span><span class="sxs-lookup"><span data-stu-id="9fd02-181">The ASMX interface is based on WCF.</span></span> <span data-ttu-id="9fd02-182">Каждая служба PSI обычно содержит базовый класс с методами CRUD для элементов в пределах этого класса.</span><span class="sxs-lookup"><span data-stu-id="9fd02-182">Each PSI service typically contains a base class with CRUD methods for items within that class.</span></span> <span data-ttu-id="9fd02-183">Элементы определены с помощью связанных классов **DataSet**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-183">Items are specified by related **DataSet** classes.</span></span> <span data-ttu-id="9fd02-184">Например, служба **CustomFields** содержит класс **CustomFields** с такими методами, как [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)).</span><span class="sxs-lookup"><span data-stu-id="9fd02-184">For example, the **CustomFields** service contains the **CustomFields** class with methods such as [CreateCustomFields2](https://docs.microsoft.com/previous-versions/office/ee767959(v=office.14)) .</span></span> <span data-ttu-id="9fd02-185">Данные для одного или нескольких корпоративных настраиваемых полей указаны в **CustomFieldDataSet**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-185">Data for one or more enterprise custom fields are specified in the **CustomFieldDataSet**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="9fd02-186">Интерфейс PSI веб-служб ASMX не рекомендуется в Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-186">The ASMX web services interface of the PSI is deprecated in Project Server 2013.</span></span> <span data-ttu-id="9fd02-187">Хотя интерфейс ASMX все еще доступен, в новых приложениях, использующих PSI, следует использовать интерфейс WCF или, если это возможно, CSOM вместо PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-187">Although the ASMX interface is still available, new applications that use the PSI should use the WCF interface, or if possible, new applications should use the CSOM instead of the PSI.</span></span> <span data-ttu-id="9fd02-188">Для будущих версий Project Server понадобится обновить существующие приложения на базе ASMX, чтобы использовать интерфейс PSI WCF или CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-188">Future versions of Project Server will require an upgrade of existing ASMX-based applications to use the WCF interface of the PSI or to use the CSOM.</span></span> 
  
<span data-ttu-id="9fd02-189">Существует 22 общедоступные и задокументированные службы PSI, которые дублируются в интерфейсах WCF и ASMX.</span><span class="sxs-lookup"><span data-stu-id="9fd02-189">There are 22 public, documented PSI services, which are duplicated in the WCF interface and the ASMX interface.</span></span> <span data-ttu-id="9fd02-190">PSI включает также восемь закрытых, не задокументированных служб.</span><span class="sxs-lookup"><span data-stu-id="9fd02-190">The PSI also includes eight private, undocumented services.</span></span> <span data-ttu-id="9fd02-191">В Project Web App и Project профессиональный используются общедоступные и закрытые службы PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-191">Project Web App and Project Professional use the public PSI services and the private PSI services.</span></span> <span data-ttu-id="9fd02-192">PSI обычно учитываются в соответствии с бизнес-объектами.</span><span class="sxs-lookup"><span data-stu-id="9fd02-192">The PSI is generally factored to match the business objects.</span></span> <span data-ttu-id="9fd02-193">Иными словами, каждый метод PSI связан с бизнес-объектом, примером которых может быть **Календарь** или **Ресурс**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-193">That is, each PSI method is associated with a business object such as **Calendar** or **Resource**.</span></span> <span data-ttu-id="9fd02-194">PSI — это основной интерфейс для бизнес-объектов.</span><span class="sxs-lookup"><span data-stu-id="9fd02-194">The PSI is the primary interface to the business objects.</span></span> <span data-ttu-id="9fd02-195">Так как уровень бизнеса сдержит компоненты бизнес-логики для повторного использования, различные приложения, взаимодействующие с данными Project Server, используют одну и ту же бизнес-логику.</span><span class="sxs-lookup"><span data-stu-id="9fd02-195">Because the business layer provides reusable business logic components, different applications that interact with Project Server data use the same business logic.</span></span>
  
<span data-ttu-id="9fd02-196">Имена методов PSI, асинхронно взаимодействующих с Project Server, начинаются с **Queue**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-196">PSI methods that asynchronously interact with Project Server have names that begin with **Queue**.</span></span> <span data-ttu-id="9fd02-197">Каждый метод PSI внедрен с отдельным интерфейсом, в котором используются данные, строго разделенные по типам.</span><span class="sxs-lookup"><span data-stu-id="9fd02-197">Each PSI method is implemented with a separate interface that uses strongly typed data.</span></span> <span data-ttu-id="9fd02-198">Например, метод **QueueCreateProject** в службе **Project** принимает параметр _dataset_ типа **ProjectDataSet**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-198">For example, the **QueueCreateProject** method in the **Project** service accepts the  _dataset_ parameter of type **ProjectDataSet**.</span></span> <span data-ttu-id="9fd02-199">Класс **ProjectDataSet** — производный от типа **DataSet**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-199">The **ProjectDataSet** class is derived from the **DataSet** type.</span></span> <span data-ttu-id="9fd02-200">Проверка типов в .NET Framework и IntelliSense в справке Visual Studio помогает уменьшить ошибки при разработке PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-200">Type checking in the .NET Framework and IntelliSense completion in Visual Studio help to reduce errors in development with the PSI.</span></span> <span data-ttu-id="9fd02-201">Общие сведения с подробной справкой о пространстве имен, классах, методах, свойствах, событиях и связанных сборках PSI см. в статье [Общий справочник по Project PSI](project-psi-reference-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9fd02-201">For an introduction to the detailed reference for PSI namespaces, classes, methods, properties, events, and related assemblies, see [Project PSI reference overview](project-psi-reference-overview.md).</span></span>
  
<span data-ttu-id="9fd02-202">В Project Server 2013 используется обработка исключений .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="9fd02-202">Project Server 2013 uses the exception handling of the .NET Framework.</span></span> <span data-ttu-id="9fd02-203">Все ошибки записываются на сервере, в верхней части стека PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-203">All errors are logged in the server, at the top of the PSI stack.</span></span> <span data-ttu-id="9fd02-204">Некоторые ошибки отправляют простой отчет клиенту, например объект **SoapException** для интерфейса ASMX или объект **FaultException** для интерфейса WCF.</span><span class="sxs-lookup"><span data-stu-id="9fd02-204">Some errors send a simple report to the client, such as a **SoapException** object for the ASMX interface or a **FaultException** object for the WCF interface.</span></span> <span data-ttu-id="9fd02-205">Исключения можно записывать в журнале событий приложения, а в случае некоторых ошибок записывается также подробный отчет на сервер в журналы трассировки единой службы ведения журналов (ULS).</span><span class="sxs-lookup"><span data-stu-id="9fd02-205">Exceptions can be recorded in the application event log, and some errors also record a detailed report on the server in the Unified Logging Service (ULS) trace logs.</span></span> 
  
<span data-ttu-id="9fd02-p127">Для локальных приложений с полным доверием PSI также может расширяться. Можно добавить сборку .NET со службой, предоставляющей новую функциональность, использующей туже инфраструктуру безопасности Project Server и вызывающей другие методы PSI или наследующей от классов PSI. Расширение PSI может также предоставлять бизнес-логику и доступ к базе данных, которые необходимы для новой функциональности.</span><span class="sxs-lookup"><span data-stu-id="9fd02-p127">For local full-trust applications, the PSI is also extensible. You can add a .NET assembly with a service that provides new functionality, uses the same Project Server security infrastructure, and calls other PSI methods or inherits from PSI classes. A PSI extension can also provide the business logic and database access required for new functionality.</span></span>
  
### <a name="using-the-csom"></a><span data-ttu-id="9fd02-209">Использование CSOM</span><span class="sxs-lookup"><span data-stu-id="9fd02-209">Using the CSOM</span></span>
<span data-ttu-id="9fd02-210"><a name="pj15_Programmability_CSOM"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-210"><a name="pj15_Programmability_CSOM"> </a></span></span>

<span data-ttu-id="9fd02-211">С помощью CSOM можно разрабатывать приложения, которые получают доступ к Microsoft Project Online или Project Server 2013 на локальных ресурсах.</span><span class="sxs-lookup"><span data-stu-id="9fd02-211">With the CSOM, you can develop apps that access Project Online or an on-premises Project Server 2013 installation.</span></span> <span data-ttu-id="9fd02-212">Приложения можно распространять через общедоступный Магазин Office или каталог частных приложений.</span><span class="sxs-lookup"><span data-stu-id="9fd02-212">Apps can be distributed in a public Office Store or a private app catalog.</span></span> <span data-ttu-id="9fd02-213">CSOM — это легкий в использовании интерфейс API, который непосредственно получает или предоставляет данные по имени с помощью запросов LINQ, а не путем передачи наборов данных и создания параметров _changeXml_ или _фильтра_ XML.</span><span class="sxs-lookup"><span data-stu-id="9fd02-213">The CSOM is designed to be an easy-to-use API that directly consumes or provides data by name with LINQ queries, rather than by passing datasets and constructing  _changeXml_ parameters or XML  _filter_ parameters.</span></span> <span data-ttu-id="9fd02-214">CSOM реализует основные функциональные возможности интерфейса Project Server (PSI) для основных сущностей, таких как **Project**, **Task**, **EnterpriseResource** и \*\* Assignment\*\*.</span><span class="sxs-lookup"><span data-stu-id="9fd02-214">The CSOM implements the main functionality of the Project Server Interface (PSI) for the primary entities such as **Project**, **Task**, **EnterpriseResource**, and **Assignment**.</span></span> <span data-ttu-id="9fd02-215">CSOM включает множество дополнительных сущностей, таких как **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler** и **QueueJob**, которые поддерживают другие распространенные функциональные возможности Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-215">The CSOM includes many additional entities such as **CustomField**, **LookupTable**, **WorkflowActivities**, **EventHandler**, and **QueueJob**, which support other common Project Server functionality.</span></span>
  
<span data-ttu-id="9fd02-216">CSOM может использоваться путем копирования указанных ниже ресурсов на локальный компьютер разработки.</span><span class="sxs-lookup"><span data-stu-id="9fd02-216">The CSOM can be used by copying the following resources to your local development computer:</span></span>
  
- <span data-ttu-id="9fd02-217">Для разработки в .NET Framework 4 необходимо скопировать сборку `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll`.</span><span class="sxs-lookup"><span data-stu-id="9fd02-217">For .NET Framework 4 development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\ISAPI\Microsoft.ProjectServer.Client.dll` assembly.</span></span> 
    
  <span data-ttu-id="9fd02-218">Для получения документации о классах и членах CSOM см. пространство имен [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="9fd02-218">For documentation of the CSOM classes and members, see the [Microsoft.ProjectServer.Client](https://docs.microsoft.com/previous-versions/office/dn529530(v=office.15)) namespace.</span></span> <span data-ttu-id="9fd02-219">Пример приложения см. в статье [Начало работы с CSOM и .NET](getting-started-with-the-project-server-csom-and-net.md).</span><span class="sxs-lookup"><span data-stu-id="9fd02-219">For an example application, see [Getting started with the CSOM and .NET](getting-started-with-the-project-server-csom-and-net.md).</span></span>
    
- <span data-ttu-id="9fd02-220">Для разработки в Microsoft Silverlight скопируйте сборку `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll`.</span><span class="sxs-lookup"><span data-stu-id="9fd02-220">For Microsoft Silverlight development, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Silverlight.dll` assembly.</span></span> 
    
- <span data-ttu-id="9fd02-221">Для разработки приложений для Windows Phone 8 скопируйте сборку `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll`.</span><span class="sxs-lookup"><span data-stu-id="9fd02-221">To develop apps for Windows Phone 8, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\ClientBin\Microsoft.ProjectServer.Client.Phone.dll` assembly.</span></span> 
    
- <span data-ttu-id="9fd02-222">Чтобы использовать JavaScript для разработки веб-приложений и приложений для других устройств, скопируйте файлы `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` и `PS.debug.js`.</span><span class="sxs-lookup"><span data-stu-id="9fd02-222">To use JavaScript for developing web apps and apps for other devices, copy the  `%ProgramFiles%\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS\PS.js` file and the  `PS.debug.js` file.</span></span> <span data-ttu-id="9fd02-223">Пример веб-приложения см. в статье [Начало работы с объектной моделью JavaScript Project Server 2013](getting-started-with-the-project-server-2013-javascript-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="9fd02-223">For an example web app, see [Getting started with the Project Server 2013 JavaScript object model](getting-started-with-the-project-server-2013-javascript-object-model.md).</span></span>
    
<span data-ttu-id="9fd02-224">CSOM выполняет внутренний вызов PSI, поэтому если PSI не сможет выполнить задание, CSOM тоже не сможет.</span><span class="sxs-lookup"><span data-stu-id="9fd02-224">The CSOM internally calls the PSI; therefore, if the PSI cannot do a job, neither can the CSOM.</span></span> <span data-ttu-id="9fd02-225">Ограничения CSOM см. в статьях [Какие задачи CSOM выполняет, а какие — нет](what-the-csom-does-and-does-not-do.md) и [Какие задачи PSI выполняет, а какие — нет](what-the-psi-does-and-does-not-do.md).</span><span class="sxs-lookup"><span data-stu-id="9fd02-225">For limitations of the CSOM, see [What the CSOM does and does not do](what-the-csom-does-and-does-not-do.md) and [What the PSI does and does not do](what-the-psi-does-and-does-not-do.md).</span></span> <span data-ttu-id="9fd02-226">Дополнительные сведения о разработке с помощью CSOM см. в статьях [Обновления для разработчиков решений в Project 2013](updates-for-developers-in-project-2013.md) и [Клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md).</span><span class="sxs-lookup"><span data-stu-id="9fd02-226">For more information about developing with the CSOM, see [Updates for developers in Project 2013](updates-for-developers-in-project-2013.md) and [Client-side object model (CSOM) for Project 2013](client-side-object-model-csom-for-project-2013.md).</span></span>
  
### <a name="porting-applications-built-for-project-server-2003"></a><span data-ttu-id="9fd02-227">Перенос приложений, построенных для Project Server 2003</span><span class="sxs-lookup"><span data-stu-id="9fd02-227">Porting applications built for Project Server 2003</span></span>
<span data-ttu-id="9fd02-228"><a name="pj15_Programmability_Porting2003"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-228"><a name="pj15_Programmability_Porting2003"> </a></span></span>

<span data-ttu-id="9fd02-p132">В Project Server 2003 многие данные и функциональные возможности доступны только с помощью Project Professional 2003 или путем прямого доступа к базе данных. PSI, появившийся в Project Server 2007, устраняет большую часть этих ограничений. В отличие от Project Data Service (PDS) в Project Server 2003, PSI и CSOM предоставляют полные интерфейсы к бизнес-объектам в Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-p132">In Project Server 2003, much data and functionality is available only with Project Professional 2003 or by direct database access. The PSI, introduced in Project Server 2007, removes much of that restriction. Unlike the Project Data Service (PDS) in Project Server 2003, the PSI and the CSOM provide comprehensive interfaces to business objects in Project Server.</span></span>
  
<span data-ttu-id="9fd02-p133">Приложения, разработанные для PDS несовместимы с последующими версиями Project Server. CSOM и PSI предоставляют функциональный эквивалент для PDS, но не соответствуют методам и параметрам PDS.</span><span class="sxs-lookup"><span data-stu-id="9fd02-p133">Applications developed for the PDS are not compatible with later versions of Project Server. The CSOM and the PSI provide functional parity for the PDS, but do not match PDS methods or parameters.</span></span>
  
> [!NOTE]
> <span data-ttu-id="9fd02-234">Поскольку конструкции приложений PDS должны полностью перерабатываться для Project Server 2013, рекомендуется использовать CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-234">Because PDS applications must be completely redesigned for Project Server 2013, we recommend that you use the CSOM.</span></span> 
  
<span data-ttu-id="9fd02-235">Дополнительные сведения о совместимости PDS и рекомендации по переносу расширений PDS в PSI см. в статье [Четность PDS в веб-службах PSI](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12)).</span><span class="sxs-lookup"><span data-stu-id="9fd02-235">For more information about PDS compatibility and guidelines for porting PDS extensions to the PSI, see [PDS Parity in PSI Web Services](https://docs.microsoft.com/previous-versions/office/developer/office-2007/ms197081(v=office.12)).</span></span>
  
### <a name="porting-applications-built-for-project-server-2007-and-project-server-2010"></a><span data-ttu-id="9fd02-236">Перенос приложений, созданных для Project Server 2007 и Project Server 2010</span><span class="sxs-lookup"><span data-stu-id="9fd02-236">Porting applications built for Project Server 2007 and Project Server 2010</span></span>
<span data-ttu-id="9fd02-237"><a name="pj15_Programmability_Porting2007"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-237"><a name="pj15_Programmability_Porting2007"> </a></span></span>

<span data-ttu-id="9fd02-238">PSI в Project Server 2013 является подмножеством объектной модели PSI в Office Project Server 2007 и Project Server 2010.</span><span class="sxs-lookup"><span data-stu-id="9fd02-238">The PSI in Project Server 2013 is a superset of the PSI object model in Office Project Server 2007 and Project Server 2010.</span></span> <span data-ttu-id="9fd02-239">Многие приложения, созданные для двух предыдущих версий Project Server, продолжают работать на локальных экземплярах Project Server 2013 с полным доверием.</span><span class="sxs-lookup"><span data-stu-id="9fd02-239">Many applications built for the two previous versions of Project Server continue to work in local full-trust, on-premises installations of Project Server 2013.</span></span> <span data-ttu-id="9fd02-240">Тем не менее указанные ниже виды приложений необходимо обновить или изменить.</span><span class="sxs-lookup"><span data-stu-id="9fd02-240">However, the following kinds of applications require updates or redesign:</span></span>
  
- <span data-ttu-id="9fd02-241">Используйте CSOM для приложений, адаптированных для Microsoft Project Online.</span><span class="sxs-lookup"><span data-stu-id="9fd02-241">Use the CSOM for applications that are adapted for use with Project Online.</span></span>
    
- <span data-ttu-id="9fd02-242">Используйте CSOM для приложений, адаптированных для мобильных устройств и планшетных компьютеров.</span><span class="sxs-lookup"><span data-stu-id="9fd02-242">Use the CSOM for applications that are adapted for use on mobile devices and tablet computers.</span></span>
    
- <span data-ttu-id="9fd02-243">Используйте CSOM для приложений, доступных как приложения в Магазине Office или в частном каталоге приложений.</span><span class="sxs-lookup"><span data-stu-id="9fd02-243">Use the CSOM for applications that are available as apps in the Office Store or a private app catalog.</span></span>
    
- <span data-ttu-id="9fd02-244">Для приложений, изменяющих планирование проекта, используйте CSOM или применяйте метод PSI [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) в самом приложении.</span><span class="sxs-lookup"><span data-stu-id="9fd02-244">For applications that modify project scheduling, use the CSOM, or change the application to use the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) PSI method.</span></span> 
    
- <span data-ttu-id="9fd02-245">В локальных или веб-приложениях, с помощью которых пользователи входят в разные экземпляры Project Web App, следует использовать программные параметры для конечных точек WCF CSOM или PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-245">Local or web applications that log on users to different instances of Project Web App should use programmatic settings for WCF endpoints of the CSOM or the PSI.</span></span> <span data-ttu-id="9fd02-246">Эти методы устарели.</span><span class="sxs-lookup"><span data-stu-id="9fd02-246">The methods are deprecated.</span></span> <span data-ttu-id="9fd02-247">В приложениях следует использовать проверку подлинности OAuth вместо проверки подлинности форм, а также для Microsoft Project Online.</span><span class="sxs-lookup"><span data-stu-id="9fd02-247">Apps should use OAuth authentication in place of Forms authentication and for use with Project Online.</span></span> <span data-ttu-id="9fd02-248">Дополнительные сведения см. в статье [Авторизация и проверка подлинности приложений для SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins).</span><span class="sxs-lookup"><span data-stu-id="9fd02-248">For more information, see [Authorization and authentication for apps in SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/authorization-and-authentication-of-sharepoint-add-ins).</span></span>
    
- <span data-ttu-id="9fd02-249">Приложения, которые зависят от конкретных параметров безопасности Project Server или изменяют их.</span><span class="sxs-lookup"><span data-stu-id="9fd02-249">Applications that rely on or modify specific Project Server security settings.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="9fd02-250">По умолчанию на локальном сервере Project Server 2013 используется режим разрешений SharePoint, где параметры безопасности Project Server не доступны через PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-250">A default on-premises installation of Project Server 2013 uses the SharePoint permission mode, where Project Server security settings are not accessible through the PSI.</span></span> <span data-ttu-id="9fd02-251">Сведения о переходе в режим разрешений Project см. в разделе *Режим разрешений SharePoint* статьи [Новые возможности для ИТ-специалистов в Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).</span><span class="sxs-lookup"><span data-stu-id="9fd02-251">To change to the Project permission mode, see the  *SharePoint Permission Mode*  section in [What's new for IT pros in Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).</span></span> 
  
- <span data-ttu-id="9fd02-252">Для многих пользовательских бизнес-процессов Project Server можно создавать декларативные бизнес-процессы с помощью SharePoint Designer 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-252">For many custom Project Server workflows, you can use SharePoint Designer 2013 to create declarative workflows.</span></span> <span data-ttu-id="9fd02-253">Для пользовательских рабочих процессов, требующих дополнительного программирования, *не* следует непосредственно использовать классы или члены в пространстве имен **Microsoft.Office.Project.Server.Workflow**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-253">For custom workflows that require additional programming, you should  *not*  directly use classes or members in the **Microsoft.Office.Project.Server.Workflow** namespace.</span></span> <span data-ttu-id="9fd02-254">Вместо этого используйте класс [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) в CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-254">Instead, use the [Microsoft.ProjectServer.Client.WorkflowActivities](https://docs.microsoft.com/previous-versions/office/mt780562(v=office.15)) class in the CSOM.</span></span> 
    
- <span data-ttu-id="9fd02-255">Как правило, приложения, использующие олицетворение, следует переписывать для применения интерфейса PSI WCF.</span><span class="sxs-lookup"><span data-stu-id="9fd02-255">In general, applications that use impersonation should be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="9fd02-256">Приложения, которые просто обновляют статус для других пользователей, не требуют олицетворения.</span><span class="sxs-lookup"><span data-stu-id="9fd02-256">Applications that do simple status updates for other users do not require impersonation.</span></span> <span data-ttu-id="9fd02-257">Они могут использовать метод [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) в CSOM или метод [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) в PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-257">They can use the [StatusAssignment.SubmitStatusUpdates](https://docs.microsoft.com/previous-versions/office/project-class/jj235883(v=office.15)) method in the CSOM or the [Statusing.SubmitStatusForResource](https://docs.microsoft.com/previous-versions/office/ee755393(v=office.14)) method in the PSI.</span></span> 
    
- <span data-ttu-id="9fd02-258">Компоненты промежуточного слоя, которые выполняются на компьютере с Project Server, можно установить только для локального использования, в них нужно применять интерфейс PSI WCF.</span><span class="sxs-lookup"><span data-stu-id="9fd02-258">Middleware components that run on the Project Server computer can be installed only for on-premises use, and must use the WCF interface of the PSI.</span></span> <span data-ttu-id="9fd02-259">Например, компонент промежуточного слоя, который использует интерфейс ASMX для обмена данными между локальным Project Web App и внешним приложением расписания, придется переписать для применения интерфейса PSI WCF.</span><span class="sxs-lookup"><span data-stu-id="9fd02-259">For example, a middleware component that uses the ASMX interface to exchange data between Project Web App on-premises and an external timesheet application would have to be rewritten to use the WCF interface of the PSI.</span></span> <span data-ttu-id="9fd02-260">Для работы с Microsoft Project Online компонент необходимо изменить, сделав его приложением, и использовать CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-260">To work with Project Online, the component would have to be redesigned as an app and use the CSOM.</span></span>
    
### <a name="migration-and-compatibility-of-custom-solutions"></a><span data-ttu-id="9fd02-261">Миграция и совместимость пользовательских решений</span><span class="sxs-lookup"><span data-stu-id="9fd02-261">Migration and compatibility of custom solutions</span></span>
<span data-ttu-id="9fd02-262"><a name="pj15_Programmability_CustomSolutions"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-262"><a name="pj15_Programmability_CustomSolutions"> </a></span></span>

<span data-ttu-id="9fd02-263">Классы и члены общедоступных интерфейсов PSI ASMX и WCF идентичны.</span><span class="sxs-lookup"><span data-stu-id="9fd02-263">Classes and members in the public ASMX and WCF interfaces of the PSI are identical.</span></span> <span data-ttu-id="9fd02-264">Однако количество столбцов и размер таблиц данных, используемых или возвращаемых методами PSI в Project Server 2013, могут быть не такими, как в двух предыдущих версиях Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-264">But, the number of columns and size of datatables used or returned by PSI methods can be different between Project Server 2013 and the two previous Project Server versions.</span></span> <span data-ttu-id="9fd02-265">Кроме того, существуют отличия в таблицах отчетов и представлениях по сравнению с базой данных отчетов в предыдущих версиях.</span><span class="sxs-lookup"><span data-stu-id="9fd02-265">There are also differences in the reporting tables and views, compared with the Reporting database in previous versions.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="9fd02-266">Мы настоятельно рекомендуем тщательно тестировать решения в тестовой установке Project Server 2013 перед их развертыванием на рабочем сервере.</span><span class="sxs-lookup"><span data-stu-id="9fd02-266">We strongly recommend that you thoroughly test solutions on a non-production installation of Project Server 2013 before deploying them to a production server.</span></span> 
  
<span data-ttu-id="9fd02-267">Если решение переносят на Project Server 2013 или если оно не работает должным образом, следует как минимум выполнить указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="9fd02-267">When you migrate a solution to Project Server 2013, or if a solution does not work as expected, you should at a minimum do the following:</span></span>
  
- <span data-ttu-id="9fd02-268">Обновите решение, открыв его в Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="9fd02-268">Update the solution by opening it in Visual Studio 2012.</span></span> <span data-ttu-id="9fd02-269">Некоторые решения также могут использовать Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="9fd02-269">Some solutions can also use Visual Studio 2010.</span></span>
    
- <span data-ttu-id="9fd02-270">Измените целевой объект на .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="9fd02-270">Change the target to .NET Framework 4.</span></span>
    
- <span data-ttu-id="9fd02-271">Измените ссылки на сборку, чтобы использовались сборки Project Server 2013, такие как Microsoft.Office.Project.Server.Library.dll и Microsoft.Office.Project.Server.Events.Receivers.dll.</span><span class="sxs-lookup"><span data-stu-id="9fd02-271">Change assembly references to use the Project Server 2013 assemblies, such as Microsoft.Office.Project.Server.Library.dll and Microsoft.Office.Project.Server.Events.Receivers.dll.</span></span>
    
- <span data-ttu-id="9fd02-272">Создайте список веб-ссылок ASMX или ссылок на службу WCF и имен пространства имен, а затем удалите ссылки Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-272">Make a list of the ASMX web references or the WCF service references and namespace names, and then delete the Project Server references.</span></span>
    
- <span data-ttu-id="9fd02-273">Добавьте сборку прокси-класса ProjectServerServices.dll, которую можно создать из исходных файлов прокси WCF в загружаемом пакете SDK Project 2013, или добавьте исходные файлы прокси для необходимых служб WCF.</span><span class="sxs-lookup"><span data-stu-id="9fd02-273">Add the ProjectServerServices.dll proxy assembly that you can build from the WCF proxy source files in the Project 2013 SDK download, or add the proxy source files for the required WCF services.</span></span> <span data-ttu-id="9fd02-274">Для служб ASMX добавьте ссылки на интерфейсные веб-службы ASMX еще раз, используя имена того же пространства имен, или добавьте сборку прокси-класса ProjectServerServices.dll, которую можно создать из источников WSDL в загружаемом пакете SDK Project 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-274">For ASMX services, add the front-end ASMX web service references again, by using the same namespace names; or add the ProjectServerServices.dll proxy assembly that you can build from the WSDL sources in the Project 2013 SDK download.</span></span>
    
  > [!NOTE]
  > <span data-ttu-id="9fd02-275">В загружаемом пакете SDK Project 2013 все пространства имен в исходных файлах прокси начинаются с *Svc*.</span><span class="sxs-lookup"><span data-stu-id="9fd02-275">In the Project 2013 SDK download, the namespaces in the proxy source files all start with  *Svc*  .</span></span> <span data-ttu-id="9fd02-276">Например, пространство имен **Resource** в файлах прокси WCF и ASMX — **SvcResource**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-276">For example, the **Resource** service namespace in the WCF proxy file and in the ASMX proxy file is **SvcResource**.</span></span> <span data-ttu-id="9fd02-277">> Если ваше приложение использует имена из другого пространства имен, вы можете или перекомпилировать сборку прокси-класса для использования вашего пространства имен или изменить пространства имен PSI в приложении.</span><span class="sxs-lookup"><span data-stu-id="9fd02-277">> If your application uses different namespace names, you can either recompile the proxy assembly to use your namespaces, or change the PSI namespaces in your application.</span></span> <span data-ttu-id="9fd02-278">Например, можно изменить скрипт CompileWCFProxyAssembly.cmd и перекомпилировать ProjectServerServices.dll из исходных файлов прокси, находящихся в загружаемом пакете SDK.</span><span class="sxs-lookup"><span data-stu-id="9fd02-278">For example, you can modify the CompileWCFProxyAssembly.cmd script and recompile ProjectServerServices.dll from the proxy source files in the SDK download.</span></span> 
  
- <span data-ttu-id="9fd02-279">При переходе от использования интерфейса ASMX PSI к интерфейсу WCF можно инициализировать клиентские классы либо программными средствами, либо с помощью конечных точек WCF в app.config. Применяйте инициализацию программными средствами, когда необходимо быстро переключиться на другие экземпляры Project Web App или когда разрабатывается веб-часть, использующая PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-279">If you change from using the ASMX interface of the PSI to the WCF interface, you can initialize the client classes either programmatically or by using WCF endpoints in app.config. Use programmatic initialization when you have to quickly switch to different instances of Project Web App, or when you are developing a web part that uses the PSI.</span></span>
    
- <span data-ttu-id="9fd02-280">Существует несколько новых методов и наборов данных в службах PSI в Project Server 2013, некоторые классы **DataRow** содержат новые свойства.</span><span class="sxs-lookup"><span data-stu-id="9fd02-280">There are several new methods and datasets in the PSI services in Project Server 2013 and some **DataRow** classes contain new properties.</span></span> <span data-ttu-id="9fd02-281">Например, метод [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) в PSI использует механизм планирования Project Server для повторного планирования обновленного проекта без необходимости открытия проекта в Project профессиональный 2013, а также позволяет добавлять или удалять сущности проекта в одном и том же вызове.</span><span class="sxs-lookup"><span data-stu-id="9fd02-281">For example, the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method in the PSI uses the Project Server scheduling engine to reschedule an updated project without you having to open the project in Project Professional 2013, and also allows adding or deleting project entities in the same call.</span></span> 
    
- <span data-ttu-id="9fd02-282">Скомпилируйте и протестируйте решение.</span><span class="sxs-lookup"><span data-stu-id="9fd02-282">Compile and test the solution.</span></span>
    
## <a name="project-scheduling-on-the-server"></a><span data-ttu-id="9fd02-283">Планирование проекта на сервере</span><span class="sxs-lookup"><span data-stu-id="9fd02-283">Project scheduling on the server</span></span>
<span data-ttu-id="9fd02-284"><a name="pj15_Programmability_Scheduling"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-284"><a name="pj15_Programmability_Scheduling"> </a></span></span>

<span data-ttu-id="9fd02-285">В Project Server 2013 два механизма планирования.</span><span class="sxs-lookup"><span data-stu-id="9fd02-285">Project Server 2013 has two scheduling engines.</span></span> <span data-ttu-id="9fd02-286">Более новый механизм планирования такой же, как и тот, что используется в Project профессиональный 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-286">The newer scheduling engine is the same as the scheduling engine in Project Professional 2013.</span></span> <span data-ttu-id="9fd02-287">Если внести изменения в план и опубликовать их с помощью веб-части "Планирование" (на странице "Сведения о проекте") в Project Web App или на сайте проекта либо с помощью CSOM, вычисление значений даты, затрат, длительности, оставшихся трудозатрат, базовых показателей и другие изменения, связанные с планированием, будут такими же, как если бы вы внесли изменения и опубликовали проект с помощью Project профессиональный 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-287">When you make scheduling changes and publish the changes by using the Scheduling web part (Project Details page) in Project Web App or a project site, or by using the CSOM, the calculation of dates, costs, duration, remaining work, baselines, and other changes related to scheduling are the same as if you made the changes and published the project by using Project Professional 2013.</span></span> <span data-ttu-id="9fd02-288">Тем не менее в методах PSI, за исключением [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)), используется более старый механизм планирования, перенесенный из Project Server 2010.</span><span class="sxs-lookup"><span data-stu-id="9fd02-288">However, except for the [QueueUpdateProject2](https://docs.microsoft.com/previous-versions/office/project-class/jj236245(v=office.15)) method, PSI methods use the older scheduling engine that was migrated from Project Server 2010.</span></span> <span data-ttu-id="9fd02-289">Причина в том, что поведение устаревших приложений в Project Server 2013 не должно измениться.</span><span class="sxs-lookup"><span data-stu-id="9fd02-289">The reason is to ensure that legacy applications behave the same in Project Server 2013 as they previously did.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="9fd02-290">Для применения обновленного механизма планирования в Project Server 2013 приложения могут использовать CSOM.</span><span class="sxs-lookup"><span data-stu-id="9fd02-290">To use the updated scheduling engine in Project Server 2013, applications can use the CSOM.</span></span> 
  
<span data-ttu-id="9fd02-291">И старый, и новый механизмы планирования имеют перечисленные ниже ограничения.</span><span class="sxs-lookup"><span data-stu-id="9fd02-291">Both the older and the newer scheduling engines have the following limitations:</span></span>
  
- <span data-ttu-id="9fd02-292">**Планирование только одного проекта.** Планирование влияет только на текущий проект, когда изменения вносятся через обновления состояния задач с помощью PSI, CSOM или Project Web App.</span><span class="sxs-lookup"><span data-stu-id="9fd02-292">**Single project scheduling only** Scheduling affects only the current project, when changes are made through task status updates with the PSI or the CSOM, or with Project Web App.</span></span> <span data-ttu-id="9fd02-293">Если в текущем проекте есть ссылки на другие проекты, подпроекты или главные проекты, связанные проекты не меняются.</span><span class="sxs-lookup"><span data-stu-id="9fd02-293">If the current project has links to other projects, subprojects, or master projects, the linked projects are not changed.</span></span> 
    
- <span data-ttu-id="9fd02-294">**Суммарные задачи.** Суммарные задачи на Project Server обычно доступны только для чтения.</span><span class="sxs-lookup"><span data-stu-id="9fd02-294">**Summary tasks** Summary tasks are generally read-only on Project Server.</span></span> <span data-ttu-id="9fd02-295">Например, невозможно создать назначения для суммарных задач и изменить процент выполнения.</span><span class="sxs-lookup"><span data-stu-id="9fd02-295">For example, assignments for summary tasks cannot be created, and percent completion cannot be modified.</span></span> <span data-ttu-id="9fd02-296">Тем не менее Project Server поддерживает редактирование дат и длительности суммарных задач, запланированных вручную.</span><span class="sxs-lookup"><span data-stu-id="9fd02-296">However, Project Server does support editing the dates and duration of manually scheduled summary tasks.</span></span> 
    
    <span data-ttu-id="9fd02-p148">Фактические данные в Project Server не добавляются в назначение суммарной задачи автоматически, поскольку таки образом обходился бы процесс утверждения в Project Server. При добавлении фактических данных в подзадачу в Project Professional эти фактические данные также добавляются для назначения в суммарную задачу. Эта разница в поведении может ввести пользователя в заблуждение.</span><span class="sxs-lookup"><span data-stu-id="9fd02-p148">Actuals on Project Server are not added automatically to a summary task assignment, because that would bypass the approval process in Project Server. In Project Professional, when you add actuals to a subtask, the actuals are also added for an assignment on the summary task. The difference in behavior can be confusing for a user.</span></span>
    
    <span data-ttu-id="9fd02-300">Project Server удаляет фактические данные в назначении суммарной задачи, если сокращается длительность подзадачи или изменяется дата окончания.</span><span class="sxs-lookup"><span data-stu-id="9fd02-300">Project Server deletes actuals on a summary task assignment if the subtask duration shortens or the finish date is changed.</span></span>
    
    > [!CAUTION]
    > <span data-ttu-id="9fd02-301">Хотя Project Professional может это делать, рекомендуется не выполнять назначения в суммарных задачах.</span><span class="sxs-lookup"><span data-stu-id="9fd02-301">Although Project Professional can do it, we recommend that you do not make assignments on summary tasks.</span></span> 
  
<span data-ttu-id="9fd02-302">Далее приводятся проблемы и ограничения при программировании PSI с использованием старого механизма планирования Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-302">Following are issues and limitations of PSI programming with the older Project Server scheduling engine:</span></span>
  
- <span data-ttu-id="9fd02-303">**Изменение активного состояния задачи.** Старый механизм планирования Project Server может показывать несогласованное время начала или окончания при использовании метода [QueueUpdateProject](https://docs.microsoft.com/previous-versions/office/ms471014(v=office.14)) для изменения активного состояния задачи, если есть несколько изменений в объекте **ProjectDataSet** для параметра _dataset_.</span><span class="sxs-lookup"><span data-stu-id="9fd02-303">**Changing the active status of a task** The older Project Server scheduling engine can show inconsistent start or finish times when you use the [QueueUpdateProject](https://docs.microsoft.com/previous-versions/office/ms471014(v=office.14)) method to change the active status of a task, if there are multiple changes in the **ProjectDataSet** object for the  _dataset_ parameter.</span></span> <span data-ttu-id="9fd02-304">Если изменено только свойство **TASK_IS_ACTIVE** в параметре _dataset_ **QueueUpdateProject**, проект можно обновить.</span><span class="sxs-lookup"><span data-stu-id="9fd02-304">If the **TASK_IS_ACTIVE** property is the only change in the  _dataset_ parameter of **QueueUpdateProject**, you can update the project.</span></span>
    
    <span data-ttu-id="9fd02-305">Дополнительные сведения о неактивных задачах и старом механизме планирования см. в статьях блога [Общие сведения о неактивных задачах в Project 2010](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) и [Project Server 2010: планирование в Интернете, PSI и Project профессиональный](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span><span class="sxs-lookup"><span data-stu-id="9fd02-305">For more information about inactive tasks and the older scheduling engine, see the blog articles [Introducing inactive tasks in Project 2010](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx) and [Project Server 2010: Scheduling on the web, the PSI and Project Professional](https://blogs.msdn.com/b/brismith/archive/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional.aspx?wa=wsignin1.0).</span></span> <span data-ttu-id="9fd02-306">Сравнение планирования в Project профессиональный 2010 и Project Web App в Project Server 2010 см. на странице [Сравнение управления планированием через Интернет](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/).</span><span class="sxs-lookup"><span data-stu-id="9fd02-306">For a comparison of scheduling in Project Professional 2010 and Project Web App in Project Server 2010, see [Web-based schedule management comparison](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/).</span></span>
    
- <span data-ttu-id="9fd02-307">**Освоенный объем не вычисляется.** Старый механизм планирования не вычисляет поля освоенного объема: ФСВР, БПЗ, БСВР, БСЗР, ИОС, ОПС, ОПС%, РС, ИОКП, ОКП, ОКП%, ПЭВ, ОПЗ, Отклонение длительности, Отклонение начала, Отклонение окончания, Отклонение стоимости и Отклонение по трудозатратам.</span><span class="sxs-lookup"><span data-stu-id="9fd02-307">**Earned value not calculated** The older scheduling engine does not calculate the earned value fields: ACWP, BAC, BCWP, BCWS, CPI, CV, CV%, EAC, SPI, SV, SV%, TCPI, VAC, Duration Variance, Start Variance, Finish Variance, Cost Variance, and Work Variance.</span></span> <span data-ttu-id="9fd02-308">Если в проекте имеются значения для этих полей и проект обновляется с помощью метода **QueueUpdateProject**, значения полей не изменяются.</span><span class="sxs-lookup"><span data-stu-id="9fd02-308">If a project has values for these fields and the project is updated by using the **QueueUpdateProject** method, the field values do not change.</span></span> <span data-ttu-id="9fd02-309">Чтобы эта проблема не возникала, используйте метод **QueueUpdateProject2**.</span><span class="sxs-lookup"><span data-stu-id="9fd02-309">To avoid the problem, use the **QueueUpdateProject2** method.</span></span> 
    
<span data-ttu-id="9fd02-310">Ограничения планирования PSI можно обойти указанными ниже способами.</span><span class="sxs-lookup"><span data-stu-id="9fd02-310">You can handle the PSI scheduling limitations in the following ways:</span></span>
  
- <span data-ttu-id="9fd02-311">Если в CSOM имеются методы, необходимые для приложения, используйте CSOM вместо PSI.</span><span class="sxs-lookup"><span data-stu-id="9fd02-311">If the CSOM has the methods the application requires, use the CSOM instead of the PSI.</span></span>
    
- <span data-ttu-id="9fd02-312">Открывайте проекты в Project Professional и сохраняйте их обратно в Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-312">Open projects in Project Professional and save them back to Project Server.</span></span>
    
- <span data-ttu-id="9fd02-313">Не включайте в отчетах поля, которые PSI не обновляет.</span><span class="sxs-lookup"><span data-stu-id="9fd02-313">In reports, do not include fields that the PSI does not update.</span></span>
    
- <span data-ttu-id="9fd02-314">Добавляйте в отчеты примечание о данных, которые могут быть устаревшими.</span><span class="sxs-lookup"><span data-stu-id="9fd02-314">Add a note in reports about data that may be stale.</span></span>
    
<span data-ttu-id="9fd02-p152">В таблицах отчетов и кубах имеются флаги, помогающие заметить, когда некоторые данные не обновляются. Данные отчетов в таблице MSP_EpmProject и в MSP_EpmProject_UserView содержат следующие поля.</span><span class="sxs-lookup"><span data-stu-id="9fd02-p152">There are flags in the reporting tables and the cubes that help you detect when some project data is not updated. The reporting data in the MSP_EpmProject table and in MSP_EpmProject_UserView includes the following fields:</span></span> 
  
-  <span data-ttu-id="9fd02-317">_ProjectWbsIsStale_ указывает, не устарела ли структурная декомпозиция работ (иерархическая структура задач).</span><span class="sxs-lookup"><span data-stu-id="9fd02-317">_ProjectWbsIsStale_ &ndash; Indicates whether the work breakdown structure (task outline hierarchy) is stale.</span></span> 
    
-  <span data-ttu-id="9fd02-318">_ProjectEarnedValueIsStale_ указывает, что поля освоенного объема устарели.</span><span class="sxs-lookup"><span data-stu-id="9fd02-318">_ProjectEarnedValueIsStale_ &ndash; Indicates the earned value fields are stale.</span></span> 
    
-  <span data-ttu-id="9fd02-319">_ProjectRollupsAreStale_ указывает, что в базе данных черновиков подпроект обновлен, а главный проект — нет.</span><span class="sxs-lookup"><span data-stu-id="9fd02-319">_ProjectRollupsAreStale_ &ndash; Indicates that a subproject is updated in the draft database, but the master project is not updated.</span></span> <span data-ttu-id="9fd02-320">Сведенные значения из подпроекта устарели.</span><span class="sxs-lookup"><span data-stu-id="9fd02-320">The rolled-up values from the subproject are stale.</span></span> 
    
-  <span data-ttu-id="9fd02-321">_ProjectHierarchyNotSynchronized_ указывает, что главный проект не синхронизирован с дочерними.</span><span class="sxs-lookup"><span data-stu-id="9fd02-321">_ProjectHierarchyNotSynchronized_ &ndash; The master project is not synchronized with its children.</span></span> <span data-ttu-id="9fd02-322">Это происходит, когда дочерние проекты публикуются явно, а не как часть публикации главного проекта.</span><span class="sxs-lookup"><span data-stu-id="9fd02-322">This happens when the child projects are published explicitly, not as part of the master project publishing.</span></span> 
    
-  <span data-ttu-id="9fd02-323">_ProjectCalculationsAreStale_ указывает, что Project профессиональный сохранил проект без вычисления плана (то есть для режима расчета на вкладке **План** в диалоговом окне **Параметры проекта** установлено значение **Вручную**).</span><span class="sxs-lookup"><span data-stu-id="9fd02-323">_ProjectCalculationsAreStale_ &ndash; Project Professional saved a project without calculating the schedule (that is, the calculation mode is set to **Manual** on the **Schedule** tab in the **Project Options** dialog box).</span></span> 
    
-  <span data-ttu-id="9fd02-324">_ProjectGhostTaskAreStale_ аналогичен _ProjectHierarchyNotSynchronized_, но предупреждает о данных связи между задачами проектов.</span><span class="sxs-lookup"><span data-stu-id="9fd02-324">_ProjectGhostTaskAreStale_ &ndash; Similar to  _ProjectHierarchyNotSynchronized_, but warns on cross-project link data.</span></span> <span data-ttu-id="9fd02-325">Возможно, главный проект не существует, но данные проекта с одной стороны связи свежее, чем данные с другой стороны.</span><span class="sxs-lookup"><span data-stu-id="9fd02-325">It is possible that no master project exists, but the project data on one side of the link is newer than on the other side.</span></span>
    
## <a name="about-accessing-the-project-server-database"></a><span data-ttu-id="9fd02-326">О доступе к базе данных Project Server</span><span class="sxs-lookup"><span data-stu-id="9fd02-326">About accessing the Project Server database</span></span>
<span data-ttu-id="9fd02-327"><a name="pj15_Programmability_Databases"> </a></span><span class="sxs-lookup"><span data-stu-id="9fd02-327"><a name="pj15_Programmability_Databases"> </a></span></span>

<span data-ttu-id="9fd02-328">Если у вас есть разрешения Microsoft SQL Server для доступа к базе данных Project Server, вы можете считывать таблицы и представления отчетов.</span><span class="sxs-lookup"><span data-stu-id="9fd02-328">If you have permissions in Microsoft SQL Server to access the Project Server database, you can read the reporting tables and views.</span></span> <span data-ttu-id="9fd02-329">Если у вас есть необходимые разрешения Project Server, вы также можете считывать данные из таблиц отчетов с помощью запросов OData.</span><span class="sxs-lookup"><span data-stu-id="9fd02-329">If you have the necessary Project Server permissions, you can also read data from the reporting tables by using OData queries.</span></span> <span data-ttu-id="9fd02-330">Разработчикам настоятельно не рекомендуется выполнять прямой доступ к таблицам черновиков, опубликованным или архивным таблицам через запросы SQL Server в базу данных Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-330">Developers are strongly discouraged from directly accessing the draft, published, or archive tables through SQL Server queries in the Project Server database.</span></span> <span data-ttu-id="9fd02-331">Внесение прямых изменений в любую таблицу базы данных Project Server может привести к повреждению целостности данных и создать помехи для доступа к базе данных через службу очереди Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-331">Making direct changes in any of the tables in the Project Server database can damage referential integrity and interfere with database access through the Project Server Queuing Service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="9fd02-p157">Ничто не препятствует использованию прямого программного доступа к базе данных для обновления данных. Следует помнить, что кэш, опубликованные таблицы и таблицы отчетов Project Professional зависят от протокола синхронизации кэша, который может быть поврежден в результате прямого изменения данных. Если вы повредили базу данных Project Server или испортили клиентские кэши Project Professional, используя прямой доступ для изменения данных, то техническая поддержка по продукту не сможет вам помочь!</span><span class="sxs-lookup"><span data-stu-id="9fd02-p157">There is nothing to actively prevent you from using direct programmatic database access to update data. You should be aware that the Project Professional cache, the published tables, and the reporting tables all rely on a cache synchronization protocol that can be disrupted by direct data editing. If you damage your Project Server database or corrupt Project Professional client-side caches by using direct access to change data, be warned that product support won't be able to help!</span></span> 
  
<span data-ttu-id="9fd02-335">Приложения, которые напрямую получают доступ к таблицам и представлениям черновиков, опубликованным или архивным таблицам и представлениям, также зависят от схем базы данных, которые могут измениться в пакетах обновления или более поздних версиях Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-335">Applications that directly access the draft, published, or archive tables and views are also dependent on the database schemas, which can change in service packs or later versions of Project Server 2013.</span></span> <span data-ttu-id="9fd02-336">Кроме того, приложения, которые непосредственно получают доступ к базам данных, теряют встроенные средства безопасности Project Server, общую бизнес-логику, отслеживание, аудит, проверку на ошибки, отчетность, рабочий процесс и другие функции.</span><span class="sxs-lookup"><span data-stu-id="9fd02-336">Applications that directly access the databases also lose the built-in Project Server security, common business logic, tracking, audits, error checking, reporting, workflow, and other features.</span></span> <span data-ttu-id="9fd02-337">Скорее всего, вам придется переписать такие приложения после обновления Project Server 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-337">You would likely have to rewrite such an application after Project Server 2013 updates.</span></span> 
  
<span data-ttu-id="9fd02-338">По всем этим причинам Project профессиональный и Project Web App не выполняют прямые вызовы таблиц черновиков, опубликованных или архивных таблиц; это не должно делать никакое другое приложение, интегрированное с Project Server.</span><span class="sxs-lookup"><span data-stu-id="9fd02-338">For all of these reasons, Project Professional and Project Web App do not make direct calls to the draft, published, or archive tables; neither should any other application that integrates with Project Server.</span></span>
  
<span data-ttu-id="9fd02-339">Схемы для таблиц черновиков, опубликованных и архивных таблиц не задокументированы.</span><span class="sxs-lookup"><span data-stu-id="9fd02-339">The schemas for the draft, published, and archive tables are not documented.</span></span> <span data-ttu-id="9fd02-340">Таблицы отчетов упрощают создание отчетов, а схемы для таблиц и представлений отчетов задокументированы в загружаемом SDK Project 2013.</span><span class="sxs-lookup"><span data-stu-id="9fd02-340">You can use the reporting tables to help generate reports, and the schema for the reporting tables and views is documented in the Project 2013 SDK download.</span></span> <span data-ttu-id="9fd02-341">Для получения информации о схеме данных отчета OData см. статью [ProjectData — Справочник по службе Project OData](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span><span class="sxs-lookup"><span data-stu-id="9fd02-341">For the OData schema of the reporting data, see [ProjectData - Project OData service reference](https://docs.microsoft.com/previous-versions/office/project-odata/jj163015(v=office.15)).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="9fd02-342">См. также</span><span class="sxs-lookup"><span data-stu-id="9fd02-342">See also</span></span>

- [<span data-ttu-id="9fd02-343">Обновления для разработчиков решений в Project 2013</span><span class="sxs-lookup"><span data-stu-id="9fd02-343">Updates for developers in Project 2013</span></span>](updates-for-developers-in-project-2013.md)    
- [<span data-ttu-id="9fd02-344">Архитектура Project Server 2013</span><span class="sxs-lookup"><span data-stu-id="9fd02-344">Project Server 2013 architecture</span></span>](project-server-2013-architecture.md)    
- [<span data-ttu-id="9fd02-345">Какие задачи PSI выполняет, а какие — нет</span><span class="sxs-lookup"><span data-stu-id="9fd02-345">What the PSI does and does not do</span></span>](what-the-psi-does-and-does-not-do.md)   
- [<span data-ttu-id="9fd02-346">Какие задачи CSOM выполняет, а какие — нет</span><span class="sxs-lookup"><span data-stu-id="9fd02-346">What the CSOM does and does not do</span></span>](what-the-csom-does-and-does-not-do.md)    
- [<span data-ttu-id="9fd02-347">Клиентская объектная модель (CSOM) для Project 2013</span><span class="sxs-lookup"><span data-stu-id="9fd02-347">Client-side object model (CSOM) for Project 2013</span></span>](client-side-object-model-csom-for-project-2013.md)    
- [<span data-ttu-id="9fd02-348">Начало разработки рабочих процессов Project Server</span><span class="sxs-lookup"><span data-stu-id="9fd02-348">Getting started developing Project Server workflows</span></span>](getting-started-developing-project-server-workflows.md)    
- [<span data-ttu-id="9fd02-349">Руководства по программированию в Project 2013</span><span class="sxs-lookup"><span data-stu-id="9fd02-349">Project 2013 programming references</span></span>](project-2013-programming-references.md)    
- [<span data-ttu-id="9fd02-350">Обзор справочника по Project PSI</span><span class="sxs-lookup"><span data-stu-id="9fd02-350">Project PSI reference overview</span></span>](project-psi-reference-overview.md)    
- [<span data-ttu-id="9fd02-351">Выполнение пользовательских действий для развертывания приложений для SharePoint</span><span class="sxs-lookup"><span data-stu-id="9fd02-351">Create custom actions to deploy with apps for SharePoint</span></span>](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/create-custom-actions-to-deploy-with-sharepoint-add-ins)    
- [<span data-ttu-id="9fd02-352">Общие сведения о неактивных задачах в Project 2010</span><span class="sxs-lookup"><span data-stu-id="9fd02-352">Introducing Inactive Tasks in Project 2010</span></span>](https://blogs.msdn.com/b/project/archive/2010/06/10/introducing-inactive-tasks-in-project-2010.aspx)    
- [<span data-ttu-id="9fd02-353">Project Server 2010: планирование в Интернете, PSI и Project профессиональный</span><span class="sxs-lookup"><span data-stu-id="9fd02-353">Project Server 2010: Scheduling on the Web, the PSI and Project Professional</span></span>](https://blogs.msdn.microsoft.com/brismith/2010/09/10/project-server-2010-scheduling-on-the-web-the-psi-and-project-professional/)


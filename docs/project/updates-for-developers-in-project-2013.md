---
title: Обновления для разработчиков в Project
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5b2b22cd-6e28-43a8-9092-b411da8bfb53
description: Новые возможности включают клиентскую объектную модель (CSOM), интерфейсы REST, службу OData для отчетов, удаленных приемников событий, декларативных рабочих процессов и надстроек области задач для клиентов проектов.
ms.openlocfilehash: c2bc0b475639a8582422b2091169116428367c60
ms.sourcegitcommit: 37080eb0087261320e24e6f067e5f434a812b2d2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "39819282"
---
# <a name="updates-for-developers-in-project"></a>Обновления для разработчиков в Project

Функции расширения в Project Server 2013 работают с надстройками для Project Online и локальными установками. Новые возможности включают клиентскую объектную модель (CSOM), интерфейсы REST, службу OData для отчетов, удаленных приемников событий, декларативных рабочих процессов и надстроек области задач для клиентов проектов. Кроме того, Узнайте о устаревших функциях, которые не следует использовать для новых разработок.
  
Project Server 2013 строится на платформе, представленной в Microsoft Office Project Server 2007, и расширена сервером Project Server 2010. Project Server 2013 добавляет клиентскую объектную модель (CSOM), которая будет оптимизирована и упрощена из интерфейса Project Server (PSI), и включает библиотеку JavaScript и библиотеки .NET Framework 4 для приложений Windows, Windows Phone 8 и Microsoft Silverlight. CSOM предназначен для разработки для Project Online, а также для работы с локальной установкой Project Server. 

Базы данных Project Server объединены в одну базу данных; доступ к электронным таблицам отчетов и представлениям можно получить через службу OData. CSOM и служба OData включают интерфейс REST (RESTing State Transfer). Рабочие процессы Project Server можно создавать с помощью SharePoint Designer 2013. Project профессиональный 2013 может интегрироваться с данными отчетов Project Server, списками задач SharePoint и другим внешним контентом с помощью модели расширения надстроек Office для областей задач. Project Стандартный 2013 может использовать надстройки области задач для интеграции с общим внешним содержимым.
  
Схемы и дополнительные сведения о значительных изменениях в Project Server 2013 приведены в статье [Project server 2013 Architecture](project-server-2013-architecture.md).
  
> [!NOTE]
> Project Server 2013 создан на основе платформы SharePoint Server 2013, и большая часть инфраструктуры Project 2013 ничем не отличается от других приложений Office 2013. Документация по модели для надстроек SharePoint, рабочих процессов на основе SharePoint, веб-частей, разработки с другими функциями SharePoint и документация по надстройкам Office приведена в разделе [надстройки SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins), надстройки [Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)и [общие сведения о разработке SharePoint 2013](https://msdn.microsoft.com/library/jj164084%28office.15%29.aspx). 
  
## <a name="major-new-features-in-project-2013"></a>Основные новые компоненты в Project 2013
<a name="pj15_WhatsNew_MajorNewFeatures"> </a>

Новые функции в Project Standard 2013 и Project профессиональный 2013 включают Улучшенный пользовательский интерфейс, который соответствует другим приложениям 2013 Office XP и поддерживает современный пользовательский интерфейс в Windows 8, интеграция с объектами Office Art для отчетов, отчетов о выработки и новых возможностей программирования для отчетов. Project профессиональный 2013 обеспечивает более широкие возможности совместного использования и синхронизации проектов в SharePoint Server 2013, а также надстройки области задач, реализованные в других приложениях Office 2013, таких как Word, Excel и Outlook.
  
В Project Server 2013 существует множество новых функций. У некоторых нет основной статьи о программировании, например новой временной шкалы в Project Web App. Эти компоненты будут задокументированы в справке продукта и в документации для конечных пользователей на веб-сайте Microsoft Office Online, а также в статьях, предназначенных для администраторов и ИТ-специалистов, на портале Microsoft TechNet. Другие новые компоненты, такие как улучшенные расписания, упрощают сторонним разработчикам взаимодействие с расписаниями и получение информации о состоянии через интерфейс Project Server (PSI).
  
Добавление Project Online и магазина Office (https://office.microsoft.com/store) для надстроек Project значительно приближается к изменениям, где доступ к Project Server предоставляется через Microsoft Azure). На облачном доступе к Project Server используется клиентская объектная модель (CSOM) для разработки надстроек с помощью Microsoft .NET Framework, Microsoft Silverlight, Windows Phone и веб-приложений, использующих JavaScript. Требование Project Online состоит в том, что четыре базы данных Project Server из предыдущих версий объединены в одну базу данных.
  
Производительность и масштабируемость Project Server 2013 улучшена во многих областях, таких как состояние задачи, расписания и управление проектом. Рабочие процессы Project Server перерабатываются с помощью версии 4 Windows Workflow Foundation (WF4). Использование .NET Framework 4 и Windows Communication Foundation (WCF) с PSI повышает безопасность, производительность и масштабируемость. Например, можно изменить протокол транспорта приложений, основанных на WCF, с помощью файлов конфигурации, не изменяя код приложения и не проводя перекомпилирование. Project Web App кэширует множество вызовов PSI, в которых данные не меняются значительно.
  
> [!NOTE]
> Для разработки с помощью Project Server 2013 вы можете использовать Visual Studio с расширениями средств Office и SharePoint, которые изначально могут создавать надстройки для продуктов Office 2013. Project Server 2013 требует, чтобы Visual Studio полностью включил разработку таких функций, как страницы сведений о проекте и приложения на основе WCF. Расширения средств SharePoint в Visual Studio могут развертывать веб-части и другие функции SharePoint непосредственно в Project Web App и других сайтах SharePoint. 
>
> Visual Studio больше не требуется для разработки рабочих процессов Project Server, использующих настраиваемые поля, этапы, фазы и типы корпоративных проектов, которыми можно управлять в Project Web App. Несмотря на то что вы можете использовать Visual Studio для разработки рабочих процессов, их зачастую проще и быстрее создать с помощью SharePoint Designer. Visual Studio можно использовать для рабочих процессов, требующих доступа к модели CSOM или другим внешним API. 
  
### <a name="project-add-ins"></a>Надстройки Project
<a name="pj15_WhatsNew_Apps"> </a>

Распространение и маркетинг программного обеспечения с помощью концепции надстройки. В Project 2013 надстройки можно сделать доступными для приобретения и загрузки из общедоступного магазина Office или из частного каталога в SharePoint. Как правило, надстройка является автономной интерактивной программой, которая выполняет небольшое количество связанных задач. Надстройка Project может быть надстройкой области задач для клиентов Project Стандартный 2013 или Project Стандартный 2013 или надстройка для Project Server 2013 или Project Online.
  
Дополнительные сведения о надстройках для настольных клиентов Project можно найти [в разделе надстройки области задач в Project](#pj15_WhatsNew_Agave). Пример для Project Server 2013 можно найти [в статье Создание надстройки Project Server с размещением в SharePoint](create-a-sharepoint-hosted-project-server-add-in.md). Кроме статей в [пакете SDK для надстроек Office и SharePoint](https://msdn.microsoft.com/library/fp161507.aspx), в [блоге Office](https://blogs.office.com/dev/) существует много сообщений, которые также важны для Project 2013 и Project Online. 
  
Надстройка для Project Server 2013 может работать как в локальной установке, так и в Project Online. Надстройки Project Server могут включать веб-части, Удаленные приемники событий и бизнес-логику. Доступ к объектной модели Project Server в надстройке осуществляется с помощью CSOM, а не PSI. Хранение данных может быть основано на облачных средах, например с SQL Azure, внешним, например, с помощью Microsoft Business Connectivity Services (BCS), внутренним образом с локальной базой данных или смешанной.
  
#### <a name="add-in-security"></a>Безопасность надстроек

В общем случае действия, выполняемые надстройкой, выполняются от имени пользователя, запускающего надстройку; Вы не используете олицетворение или указывает, кто может запускать надстройку. Действия не могут превышать уровень разрешений пользователя, запускающего надстройку. 
  
В средствах разработчика Office для Visual Studio 2012 файл Аппманифекст. XML содержит графический редактор, в котором можно задать область запроса разрешений. Например, чтобы создать надстройку, позволяющую руководителям проектов обновлять свои проекты, на вкладке **разрешения** области конструктора **AppManifest. XML** выберите **несколько проектов** для области и **напишите** разрешение. Если у пользователя надстройки есть разрешения руководителя проекта, она может запустить надстройку для проектов, которыми она управляет. Код файла AppManifest.xml может содержать следующие команды: 
  
```XML
  <AppPermissionRequests>
    <AppPermissionRequest Scope="https://sharepoint/projectserver/projects" Right="Write" />
  </AppPermissionRequests>
```

**Таблица 1. Области запросов разрешений для надстроек Project Server**

|Scope|Разрешения|
|:-----|:-----|
|**Project Server** <br/> |**Управление** (Требуются разрешения администратора Project Server.)  <br/> |
|**Несколько проектов** <br/> |**Чтение**, **Запись** (Для некоторых операций требуются разрешения руководителя проекта; для базовых операций чтения, таких как назначения проекта, требуются разрешения члена группы проекта.)  <br/> |
|**Один проект** <br/> |**Чтение**, **Запись** (Требуются разрешения минимум члена группы проекта; доступ к некоторым данным в проекте зависит от других уровней разрешений.)  <br/> |
|**Корпоративные ресурсы** <br/> |**Чтение**, **Запись** (Требуются разрешения руководителя ресурсов.)  <br/> |
|**Statusing** <br/> |**Отправка состояния** (Требуется разрешение на отправку состояния проектов.)  <br/> |
|**Создание отчетов** <br/> |**Чтение** (Требуется разрешение на вход в Project Server.)  <br/> |
|**Рабочий процесс** <br/> |**Повышение прав** (Требуется разрешение на запуск рабочих процессов. Надстройка работает с повышенными разрешениями, позволяя переходить от стадии к стадии в рабочем процессе. Бизнес-логика в переходах на стадиях управления надстройками.)  <br/> |
   
> [!NOTE]
> Project Server 2013 и Project Online не используют модель проверки подлинности "только для приложений" в SharePoint 2013 (см. [типы политик авторизации надстроек в sharepoint 2013](https://msdn.microsoft.com/library/124879c7-a746-4c10-96a7-da76ad5327f0%28Office.15%29.aspx)). 
  
Сведения о разработке, распределении, размещении и управлении надстройками можно найти в статье надстройки [SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins) и надстройки [Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins), а также связанные темы в документации для разработчиков SharePoint Server 2013 и Office 2013. Сведения об области запросов разрешений для других надстроек SharePoint приведены [в статье разрешения надстроек в sharepoint 2013](https://msdn.microsoft.com/library/5f7a8440-3c09-4cf8-83ec-c236bfa2d6c4%28Office.15%29.aspx).
  
### <a name="integrating-with-sharepoint-server"></a>Интеграция с SharePoint Server
<a name="pj15_WhatsNew_IntegrationWSS"> </a>

Многие функции в Project Web App требуют новой инфраструктуры в SharePoint Server 2013, таких как проверка подлинности OAuth и проверка подлинности на основе утверждений, авторизация и разрешения Project Server с помощью групп SharePoint, синхронизация проектов со списками задач SharePoint и декларативные рабочие процессы Project Server. Приложение-службу Project можно связать с любым семейством сайтов в ферме SharePoint. Синхронизация Project может осуществляться со списком задач SharePoint, когда SharePoint поддерживает проект. Корпоративный проект можно также синхронизировать со списком задач SharePoint, когда Project Server поддерживает полное управление. Архитектурные схемы и пояснения по синхронизации проектов приведены в статье [Project Server 2013 Architecture](project-server-2013-architecture.md).
  
В SharePoint Server 2013 существует множество новых функций. Для получения дополнительных сведений обратитесь [к разделу SharePoint for Developers](https://msdn.microsoft.com/sharepoint).
  
### <a name="integrating-with-workflows"></a>Интеграция с рабочими процессами
<a name="pj15_WhatsNew_Workflow"> </a>

Рабочие процессы являются базовым компонентом в управлении портфелем проектов. Жизненный цикл проекта может включать в себя длительные процессы, проходящие через множество фаз. Фазы управления содержат проектные предложения, анализ влияния на бизнес, а также выбор, создание, планирование, управление и отслеживание проектов.
  
Рабочие процессы Project Server 2013 создаются на платформе рабочих процессов SharePoint 2013, использующей WF4. В отличие от предыдущих версий, декларативные рабочие процессы для Project Server 2013 можно создать с помощью SharePoint Designer 2013 и доступны как для локального, так и для оперативного использования. Рабочие процессы Project Server используют модель безопасности рабочих процессов SharePoint с OAuth и могут быть установлены на сайте Project Web App. На рисунке 1 показано, что SharePoint Designer 2013 может добавлять стадии в рабочий процесс сайта для управления запросами, в котором стадии определяются в Project Web App.
  
**Рис. 1. Использование SharePoint Designer для добавления стадии в рабочий процесс веб-приложения Project**

![Добавление стадии рабочего процесса в SPD](media/pj15_CreateWorkflowSPD_AddStageInSPD.gif "Добавление стадии рабочего процесса в SPD")

<br/>

Декларативный рабочий процесс создается путем добавления стадий рабочего процесса, действий, условий и других элементов в средстве разработки, которые могут быть как SharePoint Designer 2013, так и Visual Studio 2012. Средство разработки затем сохраняет рабочий процесс в виде XAML-кода, интерпретируемого в среде выполнения. Декларативные рабочие процессы можно запускать как в Project Server 2013 локально, так и в Project Online. С помощью Visual Studio 2012 можно также создавать настраиваемые действия и формы для дополнительного контроля и сохранять шаблоны рабочих процессов для повторного использования с несколькими экземплярами Project Web App. SharePoint Designer 2013 может использовать настраиваемые действия, созданные в Visual Studio 2012.
  
Рабочий процесс Project Server 2013 действует как приложение, в котором администратор с разрешениями на разработку для Project Web App — может публиковать декларативный рабочий процесс и связывать его с типом корпоративного проекта (EPT). Тип корпоративных проектов должен быть задан для корпоративного проекта, в котором Project Server осуществляет полное управление. Список задач SharePoint не может использовать рабочий процесс Project Server. 
  
Служба OAuth позволяет руководителям проектов, имеющим разрешения на создание проектов, вызвать рабочий процесс без применения олицетворения. Вызовы Project Server рабочим процессом, например для чтения значения настраиваемого поля с целью определения следующего перехода, выполняются от имени руководителя проекта. Чтобы запретить руководителю проекта создавать рабочий процесс, который автоматически переходит на следующую стадию, вызов перехода на следующую стадию запускается от имени автора рабочего процесса (администратора). В отличие от того, пользователи устаревших рабочих процессов Project Server 2010 выполняют олицетворенные вызовы с помощью учетной записи-посредника рабочего процесса, чтобы получить доступ к администраторам во всем рабочем процессе.
  
Несмотря на то, что Project Server 2013 локально может использовать скомпилированные рабочие процессы на основе WF 3.5, рекомендуется обновлять старые рабочие процессы на основе WF4. Эта новая технология лучше масштабируется и более надежна. Бизнес-аналитики и сотрудники PMO могут создавать и обновлять макеты рабочих процессов с помощью Visio 2013 и внедрять рабочие процессы Project Server без написания кода с помощью SharePoint Designer 2013.
  
Сведения о создании декларативного рабочего процесса для Project Web App вы найдете в статье [Начало разработки рабочих процессов Project Server](getting-started-developing-project-server-workflows.md). Сравнение SharePoint Designer и возможностей Visual Studio для рабочих процессов показано в статье [Разработка рабочих процессов sharepoint 2013 с помощью Visual Studio](https://msdn.microsoft.com/library/office/jj163199.aspx).
  
### <a name="client-side-object-model"></a>Клиентская объектная модель
<a name="pj15_WhatsNew_CSOM"> </a>

Для программного доступа к Project Online требуется CSOM, построенный на CSOM SharePoint. Проверка подлинности Project Online будет выполняться с помощью OAuth с использованием идентификатора Windows Live ID, а не проверки подлинности на основе форм Project Server или Windows.
  
Ниже приведены принципы и функции CSOM в Project Server 2013:
  
- Модель CSOM разработана для простоты использования. Например, методы и свойства непосредственно используют или предоставляют данные по имени, а не требуют большого числа идентификаторов GUID, параметров _changeXml_ или передаваемых по наборам данных. 
    
- В модели CSOM Project Server реализуется поднабор функциональности PSI, основанный на наиболее общих требованиях для сторонних решений.
    
- CSOM выполняет внутренние вызовы PSI, но сформирован по-другому. Например, обновления всех изменений отчетов о состоянии осуществляются с помощью метода **StatusAssignmentCollection.SubmitAllStatusUpdates**, а не с помощью метода PSI **Statusing.SubmitStatus** для пользователя или метода **SubmitStatusForResource** для других ресурсов. 
    
- Модель CSOM доступна через одну службу WCF (Client.svc), а не через 22 общедоступные службы PSI.
    
- Инициализация сервера Project Server CSOM напрямую через класс [ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx) с URL-адресом Project Web App, а не с помощью сборки справочника или прокси-сервера WCF. 
    
- В CSOM реализовано несколько клиентских библиотек и интерфейсов, которые поддерживаются внутренней инфраструктурой CSOM SharePoint. В число клиентских библиотек и интерфейсов входят следующие:
    
  - Клиентская библиотека Microsoft .NET в сборке Microsoft.ProjectServer.Client.dll.
    
  - Библиотека Silverlight в сборке Microsoft. Project. Client. Silverlight. dll
    
  - Библиотека Windows Phone 8 в сборке Microsoft.ProjectServer.Client.Phone.dll.
    
  - Библиотека JavaScript для веб-приложений в файле PS. js или PS. Debug. js
    
  - Конечные точки REST для доступа с помощью протокола OData.
    
  - Встроенная поддержка для запросов LINQ с фильтрацией, чтобы ограничивать объем возвращаемых данных.
    
- CSOM можно использовать как для решений Project Online, так и для локальных решений независимо от PSI и других сборок Project Server, таких как Microsoft. Office. Project. Server. Library. dll.
    
- Дополнительные возможности Project Server 2013 CSOM могут быть учтены в накопительных пакетах обновления и пакетах обновления на основе запросов от партнеров Project Server и сообщества разработчиков.
    
> [!NOTE]
> CSOM является предпочтительным интерфейсом для сторонних разработчиков Project Server. Мы рекомендуем использовать CSOM для разработки новых приложений, если CSOM содержит функциональность, которая требуется приложению. 
  
Сведения о разработке с помощью CSOM можно найти в статье [клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md). Сведения о интерфейсе REST в приложениях SharePoint можно найти в статье *программирование с помощью службы REST SharePoint* в документации для разработчиков SharePoint 2013. 
  
### <a name="changes-in-the-reporting-database"></a>Изменения в базе данных отчетов
<a name="pj15_WhatsNew_RDBChanges"> </a>

Четыре базы данных в Project Server 2010 объединены в одну базу данных Project в Project Server 2013. Имя базы данных Project по умолчанию — ProjectService. Таблицы и представления отчетов сохраняют свои предыдущие имена, а таблицы и представления из баз данных черновиков, опубликованных и архивных версий содержат `draft`префиксы `pub`и `ver` в базе данных прожектсервице. Например, таблица опубликованных отчетов имеет имя pub.MSP_PROJECTS. 
  
> [!IMPORTANT]
> Прямой доступ не поддерживается для таблиц и представлений "`draft` черновик (префикс)"`pub`, "опубликованные"`ver`и "Архивные" (). В отчетах должны использоваться только таблицы и представления отчетов, которые имеют `dbo` префикс. Например, таблица dbo. MSP_EpmProject таблица содержит список проектов в экземпляре Project Web App. 
>
> Не предусмотрено никаких средств активного предупреждения прямого программного доступа к базам данных для обновления данных в таблицах и представлениях базы данных Project. Следует иметь в виду, что кэш в Project профессиональный, таблицы черновиков и опубликованных данных, а также таблицы отчетов, зависят от протокола синхронизации кэша, который может быть нарушен в результате прямого редактирования данных. Если базы данных Project Server или клиентские кэши Project профессиональный повреждены в результате прямого доступа для изменения данных, необходимо знать, что служба технической поддержки продукта не сможет помочь! 
  
В Project Server 2013 вводится служба OData для интерактивного и локального доступа. Облачные таблицы и представления отчетов доступны только через интерфейс OData; для локального использования можно применять интерфейс OData или прямой доступ к таблицам и представлениям отчетов в базе данных ProjectService в ферме SharePoint. Project Online не поддерживает базу данных клиентов. То есть несколько экземпляров Project Web App имеют собственную базу данных Project. Служба OData внутренне запускает запросы SQL для таблиц и представлений отчетов, а затем предоставляет данные XML или JSON. Введение в службу OData для создания отчетов в Project Server 2013 и справочные материалы по схеме **ProjectData** можно найти в статье [ProjectData to Project OData Service Reference](https://msdn.microsoft.com/library/office/jj163015.aspx).
  
Общие сведения о запросах OData приведены в разделе [OData: соглашения об URI](https://www.odata.org/documentation/). Например, вы можете просмотреть все проекты в локальном экземпляре Project Web App, где имя проекта начинается с "Test", используя следующий запрос в браузере. Щелкните правой кнопкой мыши на странице браузера, а затем выберите пункт **Просмотр HTML-кода**.
  
```html
https://ServerName /ProjectServerName /_api/ProjectData/Projects?$filter=startswith(ProjectName, 'Test') eq true
```

Чтобы импортировать данные проекта в PowerPivot в Excel 2013, на ленте DATA выберите **из веб-канала данных OData** в раскрывающемся меню **из других источников** . В диалоговом окне **Мастер подключения данных** введите https://ServerName/ProjectServerName/_api/ProjectData/ в поле Расположение веб-канала данных, нажмите кнопку **Далее**, а затем выберите таблицу **проекты** на странице **Выбор таблиц** в мастере. Присвойте имя и сохраните ODC-файл, а затем нажмите кнопку **Готово**. В диалоговом окне **Импорт данных** выберите пункт **Отчет сводной таблицы**. На листе Excel выберите поля для строк и столбцов сводной таблицы, которые следует отобразить.
  
Локальные пользователи Project Server, у которых есть соответствующие разрешения, могут напрямую получать доступ к таблицам и представлениям отчетов с помощью Microsoft SQL Server для создания отчетов, как в Project Server 2010. В Project Server 2013 пользователи также могут получать доступ к локальным таблицам отчетности через интерфейс OData. Можно запросить данные Project Server из облачной или локальной установки через конечные точки REST для службы OData. Например, таблица dbo.MSP_PROJECT и представление dbo.MSP_EpmProject_UserView могут использоваться для отчетов. Все таблицы и представления с префиксом `draft`( `pub`), `ver` или префикс предназначены только для внутреннего использования только в Project Server и не предназначены для использования в отчетах. Например, таблица draft.MSP_TASKS и представление pub.MSP_PROJECTS_WORKING_VIEW не задокументированы и предназначены только для внутреннего использования. 
  
> [!NOTE]
> Можно расширить локальные средства составления отчетов, добавив таблицы, представления, поля и хранимые процедуры в отдельную базу данных. Не следует изменять существующие таблицы и представления отчетов в базе данных Project Server. 
  
Таблицы отчетов, представления и поля в базе данных Project будут задокументированы в файле HTML Help в следующем обновлении загружаемого пакета SDK 2013 для Project. Документация по XML-схеме OData для службы **ProjectData** приведена в статье [ProjectData-Project OData Service Reference](https://msdn.microsoft.com/library/office/jj163015.aspx). Запросы таблиц отчетов и представлений, созданных для Project Server 2010, в большинстве случаев работают с базой данных Project в Project Server 2013. Локальные пользователи могут получать доступ к кубам OLAP Project Server в службах SQL Server Analysis Services, как они делают это сейчас. В Project Online Кубы OLAP недоступны.
  
### <a name="task-pane-add-ins-in-project"></a>Надстройки области задач в Project
<a name="pj15_WhatsNew_Agave"> </a>

Надстройки области задач для Project Standard 2013 и Project профессиональный 2013 поддерживают надстройки области задач, которые можно использовать для интеграции и отображения внешнего контента на веб-странице. В области задач отображается содержимое веб-страниц с доступом с помощью JavaScript для задач, ресурсов, представлений и общих данных проекта. Объектная модель JavaScript для Project позволяет получать сведения о выбранной задаче или ресурсе, а также получать данные в выбранной ячейке в сетке для таких представлений, как диаграмма Ганта. Надстройки области задач для Project также могут реализовывать обработчики событий для событий изменения выделения задач, ресурсов или просмотра. 
  
На рисунке 2 показана надстройка области задач **Hello ProjectData** , которая запрашивает службу **ProjectData** , а затем сравнивает данные в текущем проекте со средними для всех проектов. Загрузка пакета SDK для Project 2013 включает полный исходный код для надстройки. 
  
**Рис. 2. Надстройка области задач в Project Professional может получать доступ к данным в Project Server**

![Сравнение текущего проекта со всеми проектами](media/pj15_RestQueryApp_CompareProject.gif "Сравнение текущего проекта со всеми проектами")
  
> [!NOTE]
> Project Стандартный 2013 не может напрямую интегрироваться с Project Server 2013 через надстройки области задач. 
  
Надстройки области задач в Project Professional могут поддерживать веб-части, созданные для Project Server 2013, поэтому разработчики могут создавать расширения, выполняемые с помощью Project Web App и Project профессиональный. Общие надстройки области задач, разработанные для других продуктов Office 2013, также можно использовать с Project Стандартный 2013 и Project профессиональный 2013. Для получения дополнительных сведений см [область задач надстройки для Project](task-pane-add-ins-for-project.md).
  
### <a name="project-server-event-receivers"></a>Приемники событий Project Server
<a name="pj15_WhatsNew_Events"> </a>

В ферме SharePoint, которая включает приложение-службу Project Server, может быть несколько серверов Project Web App (также называемых интерфейсными веб-серверами или интерфейсных веб). Приемники событий могут также называться обработчиками событий. Локальные обработчики событий можно реализовать с помощью кода полного доверия и развернуть на всех серверах WFE для локальной установки Project Server. Удаленные приемники событий можно реализовать в веб-службах на локальных или удаленных серверах и организовать к ним доступ нескольких серверов WFE и нескольких установок Project Server. Project Online может использовать только удаленные приемники событий.
  
Обработчики событий Project Server управляются SharePoint для каждого экземпляра Project Web App, а не на странице параметров Project Web App. В приложении центра администрирования SharePoint выберите **Общие параметры приложения**, выберите **Управление** в разделе **Параметры PWA**, а затем выберите экземпляр в раскрывающемся списке **экземпляр Project Web App** на странице Параметры PWA. Чтобы добавить локальный обработчик событий или удаленный приемник событий, выберите **Обработчики событий на сервере**.
  
Для локальной установки Project Server можно создать удаленный приемник событий в качестве компонента SharePoint, использующего класс [Microsoft. Project. Client. евенсандлеркреатионинформатион](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM, а затем программным способом управлять приемником событий с помощью методов в классе [евенсандлерколлектион](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCollection.aspx) . Для удаленных приемников событий, предварительные события синхронны, последующие события асинхронны, а также имеется пороговое время ожидания для случаев, когда удаленный приемник событий не возвращает данные. 
  
> [!NOTE]
> Центр администрирования SharePoint доступен только для локальных установок. Для Project Online и SharePoint Online можно добавлять и удалять Удаленные приемники событий с помощью пакета приложений на основе CSOM. 
  
На странице обработчики событий на стороне сервера процесс добавления локального обработчика событий для локальной установки Project Server практически не отличается от процесса, описанного в [обработчике событий Create a Project Server, и заносить в журнал подраздел о событии](https://msdn.microsoft.com/library/gg615466.aspx) для Project Server 2010. Различие состоит в том, что новая страница обработчика событий имеет дополнительные параметры. Например, выберите **Создание проекта** в списке **события** , а затем нажмите кнопку **создать обработчик событий**. На странице Создание обработчика событий только два обязательных поля — **имя** и **порядок** (см. рис. 3). При добавлении локального обработчика событий с полным доверием добавьте поле **имя сборки** и поле **имя класса** ; Оставьте пустым **URL-адрес конечной точки** . Если добавляется удаленный приемник событий, добавьте **URL-адрес конечной точки**и оставьте **имя сборки** и **имя класса** пустыми. 
  
> [!CAUTION]
> Если *вы укажете* имя сборки или имя класса, а URL-адрес конечной точки, Project Server вызывает только локальный обработчик событий (локальный). Удаленный приемник событий игнорируется. 
> 
> Если создать два обработчика событий для одного события, когда один обработчик событий является локальным, а другой является удаленным приемником событий, при этом значение поля **Порядок** одинаково, Project Server игнорирует удаленный приемник событий. 
  
**Рис. 3. Добавление локального обработчика событий или удаленного приемника событий**

![Настройка обработчика событий или приемника событий](media/pj15_EventHandlers_NewEventHandler.gif "Настройка обработчика событий или приемника событий")
    
Если для локального обработчика событий требуется доступ к наборам данных PSI, можно скопировать сборку Microsoft. Office. Project. Schema. dll из каталога [Windows] \Микрософт.нет\ассембли\гак\_msil\microsoft.Office.Project.schema\v4.0_15.0.0.0__71e9bce111e9429c. 

Вместо PSI мы рекомендуем использовать классы событий в пространстве имен **Microsoft.ProjectServer.Client**; разработка с применением CSOM не требует манипуляции с наборами данных. Чтобы разработать Удаленные приемники событий для Project Online, необходимо использовать класс [event](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.Event.aspx) и класс [евенсандлеркреатионинформатион](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM. 
  
Перед развертыванием обработчика событий Project Server, установите и тщательно протестируйте этот обработчик событий на тестовой установке Project Server. Если вы добавляете локальный обработчик событий в процессе установки локального сервера Project Server, то служба событий Project Server 2013 не сможет загрузить другие допустимые обработчики событий. В этом случае необходимо удалить неисправный обработчик событий и перезапустить службу событий.
  
> [!NOTE]
> Для локальной установки Project Server мы рекомендуем перейти на удаленные приемники событий, используя CSOM для разработки приемников событий. Так как удаленные приемники событий не содержат стороннего кода, выполняющегося в службе событий Project Server, удаленные приемники событий более стабильны. Локальные администраторы освобождаются от поддержки службы событий Project Server. 
  
Общие сведения о событиях можно найти [в статье обработка событий в приложениях для SharePoint](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx). 
  
## <a name="deprecated-features"></a>Устаревшие компоненты
<a name="pj15_WhatsNew_Deprecated"> </a>

> [!NOTE]
> Сведения о возможностях и интерфейсах API, которые устарели или удалены в Project Server 2016 Preview, приведены [в статье устаревшие или удаленные функции Project server 2016 Preview](https://docs.microsoft.com/project/what-s-deprecated-or-removed-in-project-server-2016). 
  
Устаревшие функции по-прежнему доступны в Project 2013 для некоторых решений, но их не следует использовать для новой разработки. Большинство следующих функций и рекомендаций не работают с Project Online или с локальной установкой Project Server 2013 по умолчанию в режиме разрешений SharePoint. Существующие решения, использующие эти функции, могут не работать при обновлении Project Server 2010 до Project Server 2013. Несмотря на то, что решения, использующие устаревшие компоненты, могут продолжать работать в некоторых случаях, они не полностью поддерживаются для всех установок Project 2013.
  
Если в ваших решениях используются устаревшие компоненты, перед развертыванием таких решений их следует тщательно протестировать и по возможности изменить для использования поддерживаемых компонентов. Сведения о настройке локальной системы безопасности Project Server 2013 для режима разрешений Project можно найти в разделе *режим разрешений SharePoint* в разделе [новые возможности для ИТ-специалистов в Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).
  
- **Extensions** [Сценарии расширения PSI](https://docs.microsoft.com/previous-versions/office/developer/office-2010/ff843378(v=office.14)) расширений устарели и не будут поддерживаться в будущих выпусках. Для этих локальных сценариев Project Server 2013 включена интеграция с использованием пользовательских служб Windows Communication Foundation (WCF). 
  
- **PSI Project** [Класс Project](https://docs.microsoft.com/office/client-developer/project/project-psi-reference-overview) в PSI является устаревшим. Для всех новых разработок используйте [проект CSOM](client-side-object-model-csom-for-project-2013.md). Приложения Project Server 2013, использующие Project PSI, продолжат работу, но приложения Project Online должны заменить все методы PSI класса Project на эквивалентные методы CSOM.
  
- **План ресурсов PSI** Не рекомендуется использовать в [плане ресурсов PSI](https://docs.microsoft.com/previous-versions/office/project-class/gg240019(v=office.15)) . Он по прежнему будет поддерживаться для разработки Project 2013, но не будет поддерживаться в будущих выпусках. 
  
- **Интерфейс ASMX для PSI** PSI включает дублированные интерфейсы для разработки локальных расширений Project Server. Интерфейс веб-служб ASMX впервые появился в первой реализации PSI в Office Project Server 2007. В Project Server 2010 добавлен интерфейс служб WCF, в котором объектная модель дублирует веб-службы ASMX. Несмотря на то, что Project Server 2013 продолжает поддерживать как ASMX, так и WCF, новые решения, требующие PSI, должны использовать службы WCF. Если возможно, новые решения должны быть написаны с применением CSOM. 
  
  Веб-службы ASMX интерфейса PSI устарели в Project Server 2013. Для работы в последующих версиях Project Server решения, использующие веб-службы ASMX, должны быть переписаны с применением либо служб WCF, либо CSOM. Дополнительные сведения можно найти в разделе *Обновление приложений с помощью API Project Server* в разделе [программирование Project Server](project-server-programmability.md).
  
- **Поставщик ссылок на объекты (ОЛП)** В предыдущих версиях Project Server служба **обжектлинкпровидер** в psi (см. [вебсвкобжектлинкпровидер](https://docs.microsoft.com/previous-versions/office/ms481347(v=office.14)) предоставляет способ управления ссылками на веб-объекты между задачами корпоративного проекта и специализированными списками SharePoint на сайте проекта для вопросов, рисков, конечных результатов и документов. В Project Server 2013 ОЛП является устаревшим. 
  
  С помощью класса **[pushnotificationsubscriber](https://docs.microsoft.com/previous-versions/office/sharepoint-server/jj168020(v=office.15))** в SharePoint CSOM можно создавать, читать и удалять ссылки на веб-объекты между элементами в списке задач и другими списками на сайте проекта. Например, чтобы добавить ссылку из элемента задачи в задачу, можно использовать метод **[аддсинглелинк](https://docs.microsoft.com/previous-versions/office/sharepoint-server/jj166451(v=office.15))** или один из двух похожих методов, **аддсинглелинкфромурл** или **аддсинглелинктаурл**. Класс **RelatedItemManager** также содержит методы для удаления ссылки на веб-объект и чтения связанных элементов. Для эквивалентного класса в JSOM (объектная модель JavaScript), ознакомьтесь со статьей [SP. Объект Pushnotificationsubscriber (SP. js)](https://docs.microsoft.com/previous-versions/office/sharepoint-visio/jj838582(v=office.15)).
  
  Мы рекомендуем использовать CSOM SharePoint для создания приложений ОЛП-Type для локальной установки Project Server 2013 и Project Online. Пространство имен [Microsoft. SharePoint](https://docs.microsoft.com/previous-versions/office/sharepoint-server/ms464984(v=office.15)) не включает класс **pushnotificationsubscriber** * * * *. 
  
- **Настраиваемые разрешения** Пользовательские разрешения безопасности для доступа к определенным функциям или расширениям Project Server поддерживались в Office Project Server 2007, где в статье пакета SDK описано, как их создавать путем непосредственного изменения опубликованной базы данных. В Project Server 2010 пользовательские разрешения по-прежнему работают, но являются устаревшими. В Project Server 2013 настраиваемые разрешения не работают с режимом разрешений SharePoint по умолчанию для локальных установок. Для режима разрешений Project настраиваемые разрешения поддерживаются. В Project Online прямой доступ к базе данных невозможен. 
  
- **Олицетворение** Олицетворение в приложениях на основе PSI, где пользователь приложения может предполагать, что разрешения безопасности другого пользователя Project Server не рекомендуются в Project Server 2013. Как было указано ранее, установленный по умолчанию локальный проект Project Server 2013 использует режим разрешений SharePoint, который не разрешает олицетворение в группах безопасности Project Server. Дополнительные сведения см в статье [Проверка подлинности, авторизация и безопасность в SharePoint 2013](https://docs.microsoft.com/sharepoint/dev/general-development/authentication-authorization-and-security-in-sharepoint).
  
  Состояние приложений — типичные расширения, которые могут использовать олицетворение в предыдущих версиях Project Server. В Project Server 2010 появился метод **реадстатусфорресаурце** и метод **субмитстатусфорресаурце** в PSI вместе с глобальным разрешением **статусброкерпермиссион** , что устраняет необходимость в олицетворении считывать и обновлять состояние от имени другого пользователя. CSOM в Project Server 2013 использует базовую PSI для прозрачного включения расширений состояния и может использоваться как в Project Online, так и в локальной установке. 
  
- **Расширения баз данных отчетов** Добавление настраиваемых таблиц и представлений в базу данных отчетов является распространенной практикой с предыдущими версиями Project Server. Поскольку Project Server 2013 объединяет четыре базы данных предыдущих версий в одну базу данных, обновления не переносят настраиваемые таблицы, представления или Спрокс в таблицы отчетов в базе данных Project Server 2013. 
  
  Мы рекомендуем использовать SQL Azure или отдельную базу данных SQL Server для настраиваемых таблиц отчетов и представлений, где можно управлять резервным копированием и обновлениями баз данных. Для Project Online это необходимо.
  
- **Создание отчетов** Локальные таблицы отчетов и представления в базе данных Project Server и Кубы OLAP *не* являются устаревшими и полностью поддерживаются. Однако таблицы отчетов и представления (база данных отчетов в предыдущих версиях Project Server) недоступны в Project Online. Аналогично, Кубы OLAP доступны только в локальных установках Project Server 2013. Для приложений отчетов в Project Online можно использовать службу **ProjectData** с помощью запросов REST с протоколом OData. 
  
- **Руководство по проекту** Консультант является стандартным компонентом для настольных приложений Office Project 2007, где HTML-и JavaScript-контент в области задач содержит интерактивные рекомендации по созданию проектов и управлению ими. В Project 2010 Руководство по проектам недоступно для установки по умолчанию, но его можно включить с помощью VBA или надстройки VSTO. Пакет SDK для Project 2010 содержит измененные файлы руководства по проектам. 
  
  Объектная модель VBA и объектная модель **Microsoft. Office. Interop. мспрожект** в Project 2013 по-прежнему включают в себя 22 члена класса **Application** и класс **Project** , которые могут управлять консультантом. Однако приложения области задач Project 2013 могут конфликтовать с действиями в области задач руководства по проектам и содержимым руководства по проектам и не могут быть легко распределены или проданы в магазине Office. Мы настоятельно рекомендуем разрабатывать решения области задач Project с помощью надстроек Office, а не настраиваемого контента руководства по проектам. Для получения дополнительных сведений о руководстве по проекту обратитесь к [документации по пакету SDK для project 2010](https://msdn.microsoft.com/library/ms512767.aspx).
  
## <a name="comparing-project-server-on-premises-with-project-online"></a>Сравнение локального сервера Project Server с Project Online
<a name="pj15_WhatsNew_Comparing"> </a>

Чтобы решить, следует ли использовать локальный сервер Project Server или Project Online, а также какие типы расширений можно разрабатывать в любом случае, в таблице 2 сравниваются Расширяемые функции локальной установки Project Server 2013 с Project Online. В таблице 2 не учитываются различия в развертывании, администрировании или использовании. Дополнительные сведения о Project Online и Project Server 2013 можно найти в статье [project 2013 for Developers](https://developer.microsoft.com/project/docs) and [Project Online](https://developer.microsoft.com/project).
  
**Таблица 2. Расширяемость локального проекта Project Server и Project Online**

| Компонент |Локальная среда Project Server | Project Online |
|:-----|:-----|:-----|
|**Программирования** <br/> |Приложения на основе CSOM; Постоянная модель программирования  <br/>— Библиотеки клиентов .NET, Silverlight, Windows Phone  <br/>-Библиотека JavaScript для настраиваемых страниц, веб-частей и расширений ленты  <br/>— Протоколы OData и REST<br/><br/> Приложения, основанные на PSI; сложная модель программирования, может также создавать приложения для администрирования, анализа портфелей, уведомлений, безопасности режима проекта, системы очередей и других областей.<br/><br/>Расширения PSI  <br/><br/>Настраиваемые разрешения с безопасностью в режиме проекта (не рекомендуется)  <br/><br/>Олицетворение с помощью PSI (не рекомендуется)  <br/><br/>Код с полным доверием; Установка расширений в ферме SharePoint  <br/> |Приложения на основе CSOM; Постоянная модель программирования  <br/>— Библиотеки клиентов .NET, Silverlight, Windows Phone<br/>-Библиотека JavaScript для настраиваемых страниц, веб-частей и расширений ленты<br/>— Протоколы OData и REST<br/><br/>Можно использовать PSI, но не поддерживается: без OAuth и без подключений между службами<br/><br/>Нет расширений API CSOM<br/><br/>Нет настраиваемых разрешений<br/><br/>Нет олицетворения<br/><br/>Нет кода с полным доверием  <br/> |
|**Пользовательские базы данных** <br/> |— SQL Azure  <br/>-SQL Server (изменение таблиц отчетов и представлений в базе данных Project Server не поддерживается)  <br/> |— SQL Azure  <br/>-SQL Server (изменение таблиц отчетов и представлений в базе данных Project Server не поддерживается)  <br/> |
|**Создание отчетов** <br/> |- Служба **ProjectData** ; Протоколы OData и REST  <br/>— Таблицы и представления отчетов в базе данных Project Server<br/>— База данных OLAP  <br/> |- Служба **ProjectData** ; Протоколы OData и REST  <br/> |
|**обработчики событий.** <br/> |— Приемники удаленных событий, доступные через конечные точки WCF<br/>-Обработчики событий с полным доверием, установленные в ферме SharePoint  <br/> | — Приемники удаленных событий, доступные через конечные точки WCF  <br/> |
|**Рабочие процессы** <br/> |Декларативные рабочие процессы, созданные с помощью SharePoint Designer 2013<br/>— Используйте только в определенном экземпляре Project Web App.<br/>— Возможность импортировать проект рабочего процесса из Visio 2013<br/>— Может импортировать и использовать дополнительные действия<br/><br/> Декларативные рабочие процессы, созданные с помощью Visual Studio 2012<br/>-Создание приложения, которое может включать рабочие процессы<br/>-Создайте пакет решения SharePoint (WSP), который может включать рабочие процессы<br/>-Создание шаблонов рабочих процессов для повторного использования<br/>Создание и использование настраиваемых действий  <br/><br/>Можно использовать устаревшие скомпилированные рабочие процессы, созданные с помощью WF 3.5 (рекомендуется обновление до декларативного рабочего процесса WF4)  <br/> |Декларативные рабочие процессы, созданные с помощью SharePoint Designer 2013<br/>— Используйте только в определенном экземпляре Project Web App.<br/>— Возможность импортировать проект рабочего процесса из Visio 2013<br/>— Может импортировать и использовать дополнительные действия  <br/><br/>Декларативные рабочие процессы, созданные с помощью Visual Studio 2012<br/>-Создание приложения, которое может включать рабочие процессы  <br/>-Создайте пакет решения SharePoint (WSP), который может включать рабочие процессы<br/>-Создание шаблонов рабочих процессов для повторного использования <br/>Создание и использование настраиваемых действий  <br/> |
|**Распространяется** <br/> |— Магазин Office (для приложений на основе CSOM)<br/>— Частный каталог приложений в SharePoint<br/>— Файловый ресурс интрасети  <br/> |— Магазин Office<br/>— Частный каталог приложений в SharePoint  <br/> |

   
## <a name="conclusion"></a>Заключение
<a name="pj15_WhatsNew_Conclusion"> </a>

Project Server 2013 предоставляет множество новых возможностей разработки и сценариев, которые партнеры и клиенты могут использовать для адаптации и расширения возможностей Project Server на больших предприятиях и в небольших организациях. Инфраструктуру для Office 2013 и SharePoint 2013 можно использовать для создания и распространения приложений для Project 2013, которые могут значительно увеличить рынок и использовать пользовательские приложения. Некоторые функции расширяемости и рекомендации по предыдущим версиям не рекомендуются в Project 2013, в частности веб-службам ASMX интерфейса PSI и функциях, которые включают олицетворение или прямые изменения базы данных, которые не могут использоваться в Project Online.
  
Введение CSOM обеспечивает программный доступ к Project Online для широкого спектра устройств и использование JavaScript в веб-приложениях. CSOM предоставляет более согласованную модель программирования по сравнению с PSI. Доступ к данным Project Server можно получить множеством способов, чем в предыдущих версиях, в том числе через службу онлайн OData и конечные точки REST для отчетов в базе данных Project. Существующие отчеты по-прежнему работают так же, как для локального использования; новые отчеты имеют большую гибкость.
  
Надстройки Office предоставляют новые функции для продажи решений и интеграции Project Стандартный 2013 с веб-контентом и другими продуктами Office 2013. Кроме того, вы можете создавать новые способы интеграции Project профессиональный 2013 с данными Project Server и списками SharePoint с помощью надстроек Office в области задач.
  
Дополнительные сведения о разработке приложений, а также о возможностях программирования и CSOM SharePoint Server 2013 можно найти в статье [SharePoint for Developers](https://docs.microsoft.com/sharepoint/dev/) and [Office for Developers](https://developer.microsoft.com/office/docs).
  
## <a name="see-also"></a>Дополнительные ресурсы

- [Архитектура Project Server 2013](project-server-2013-architecture.md)  
- [Задачи программирования Project](project-programming-tasks.md) 
- [Клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md) 
- [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/library/office/jj163015.aspx)  
- [Надстройки области задач для Project](task-pane-add-ins-for-project.md)   
- [OData: соглашения об URI](https://www.odata.org/documentation/uri-conventions#FilterSystemQueryOption)    
- [SharePoint для разработчиков](https://msdn.microsoft.com/sharepoint)    
- [Office для разработчиков](https://msdn.microsoft.com/office)   
- [Обработка событий в приложениях для SharePoint](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx)   
- [AppSource](https://appsource.microsoft.com/marketplace/apps?product=office)   
- [Project Online](https://developer.microsoft.com/project)
    


---
title: Обновления для разработчиков в Project
manager: soliver
ms.date: 09/29/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5b2b22cd-6e28-43a8-9092-b411da8bfb53
description: Новые возможности для клиентов Project включают клиентской объектной модели (CSOM), интерфейсы REST, службе OData для отчетов, удаленных приемников событий, декларативные рабочие процессы и надстройки для области задач.
ms.openlocfilehash: 0c4c3f9b4bb5852f2a620b2695c15de390ac9d78
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25401764"
---
# <a name="updates-for-developers-in-project"></a>Обновления для разработчиков в Project

Функции-расширения в Project Server 2013 работать с надстройками для Project Online и локальных установок. Новые возможности для клиентов Project включают клиентской объектной модели (CSOM), интерфейсы REST, службе OData для отчетов, удаленных приемников событий, декларативные рабочие процессы и надстройки для области задач. Кроме того, сведения о устаревшие компоненты, которые не должны использоваться для разработки новых приложений.
  
Project Server 2013 построена на framework, представленной в Microsoft Office Project Server 2007 и расширить с Project Server 2010. Project Server 2013 добавляет клиентской объектной модели (CSOM), который оптимизирован и упрощенный из интерфейса Project Server (PSI) и включает в себя библиотеку JavaScript и библиотек .NET Framework 4 для приложений Windows, Windows Phone 8 и Microsoft Silverlight. CSOM предназначен для разработки для Project Online, а также работает с локальной установкой Project Server. 

Базы данных Project Server объединены в одну базу данных; online отчетов таблицы и представления доступны по службе OData. CSOM и службы OData содержит интерфейс представлений состояния (REST). Рабочих процессов Project Server могут быть созданы с помощью SharePoint Designer 2013. С помощью отчетов данные, списки задач SharePoint и другие внешнего контента с помощью модели расширяемости надстроек Office для области задач Project Server можно интегрировать Project профессиональный 2013. Project Стандартный 2013 можно использовать надстройки для области задач для интеграции с общие внешнего контента.
  
Схемы и Дополнительные сведения об основных изменениях в Project Server 2013 в разделе [Архитектура Project Server 2013](project-server-2013-architecture.md).
  
> [!NOTE]
> Project Server 2013 построен на платформе SharePoint Server 2013 и Project 2013 включает в себя значительная часть той же инфраструктуры, что и другие приложения Office 2013. Документация по модели для SharePoint Add-ins, рабочих процессов на основе SharePoint, веб-части, разработка с помощью других компонентов SharePoint и документация по Office Add-ins, иллюстрация [SharePoint Add-ins](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins), [надстроек Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)и [SharePoint Общие сведения о разработке 2013](https://msdn.microsoft.com/library/jj164084%28office.15%29.aspx). 
  
## <a name="major-new-features-in-project-2013"></a>Основные новые компоненты в Project 2013
<a name="pj15_WhatsNew_MajorNewFeatures"> </a>

Новые возможности в Project Стандартный 2013 и Project Professional 2013 включают улучшенный пользовательский интерфейс, который соответствует других приложений Office 2013 и поддерживает современный стиль пользовательского интерфейса в Windows 8, интеграция с объектами графические объекты Office для отчетов "Выполнение" отчеты и новые возможности программирования для отчетов. Project Professional 2013 включается поддержка расширенных общего доступа и синхронизация проектов в SharePoint Server 2013, а также задач области надстроек, также реализован в других приложениях Office 2013, таких как Word, Excel и Outlook.
  
Существует множество новых функций в Project Server 2013. Некоторые не содержат сценариев основных программирования, таких как новые временной шкалы в Project Web App. Эти функции будет описано в документации справки и конечных пользователей в Microsoft Office Online и в разделах предназначены для администраторов и ИТ-специалистов на портале Microsoft TechNet. Другие новые компоненты, такие как улучшенная расписания, упростить сторонними разработчиками для взаимодействия с расписаниями и отчеты о состоянии через интерфейс Project Server (PSI).
  
Добавление Project Online и Office Store (https://office.microsoft.com/store) для надстройки Project — далеко идущие изменений, где Project Server доступен через Microsoft Azure. Доступ на основе облака в Project Server с помощью клиентской объектной модели (CSOM) при разработке надстроек с помощью платформы Microsoft .NET Framework, Microsoft Silverlight, Windows Phone и веб-приложений, использующих JavaScript для. Требования Project Online — объединить четыре базы данных Project Server из предыдущих версий в одну базу данных.
  
Повышение масштабируемости и производительности Project Server 2013 во многих областях, такие как состояние задачи, расписаний и управление проектами. Рабочих процессов Project Server изменен, версия 4 Windows Workflow Foundation (WF4). Использование платформы .NET Framework 4 и Windows Communication Foundation (WCF) с помощью PSI улучшает безопасности, производительности и масштабируемости. Например можно изменить транспортный протокол приложений на основе WCF с помощью файлов конфигурации без изменения кода приложения или повторной компиляции. Project Web App кэширует многие из вызовов PSI, где данные не существенно.
  
> [!NOTE]
> Для разработки с Project Server 2013 можно использовать Visual Studio с помощью средств расширения Office и SharePoint, которые изначально могут создавать надстройки для продуктов Office 2013. Project Server 2013 требуется Visual Studio для обеспечения полной разработки компонентов, таких как страницы сведений о проекте и приложений на основе WCF. Расширения средств SharePoint в Visual Studio можно развернуть веб-частей и других компонентов SharePoint непосредственно в Project Web App и другие веб-сайты SharePoint. 
>
> Visual Studio больше не требуется для разработки рабочих процессов Project Server, использующих настраиваемые поля, стадий, этапов и типы корпоративных проектов, которыми можно управлять в Project Web App. Несмотря на то, что можно использовать Visual Studio для разработки рабочих процессов, они обычно быстрее и проще создавать с помощью SharePoint Designer. Visual Studio можно использовать для рабочих процессов, которым требуется доступ к CSOM или других внешних API. 
  
### <a name="project-add-ins"></a>Надстройки Project
<a name="pj15_WhatsNew_Apps"> </a>

Концепция надстройка были революционизировал рассылки и marketing программного обеспечения. Для Project 2013 надстроек можно сделать доступным для приобретения и загрузки из общего хранилища Office или распределенного в частном каталоге на SharePoint. Надстройка — это обычно автономные и интерактивная программа, выполняющая небольшое число задач, связанных с. Проект надстройки может быть задач области в программе Project Стандартный 2013 или Project Стандартный 2013 клиентов или надстройки уровня приложения для Project Server 2013 или Project Online.
  
Для получения сведений о надстройках для настольных клиентов Project видеть [задач области надстроек в проекте](#pj15_WhatsNew_Agave). Пример Project Server 2013 видеть [надстройки SharePoint хостингом Create Project Server](create-a-sharepoint-hosted-project-server-add-in.md). В дополнение к статьи в разделе [Office и SharePoint надстройки SDK](https://msdn.microsoft.com/library/fp161507.aspx) [Блог по Office](https://blogs.office.com/dev/) имеет много записей, которые также относится к Project 2013 и Project Online. 
  
Add-in Project Server 2013 может работать как локальная установка, и Project Online. Надстройки Server проект может включать веб-частей, удаленные приемники событий и бизнес-логики. Доступ к объектной модели Project Server в надстройку осуществляется через CSOM, не PSI. Хранилище данных может быть облачная такие как с SQL Azure, внешние таких как через Microsoft Business Connectivity Services (BCS), внутренний с локальной базы данных или смешанных.
  
#### <a name="add-in-security"></a>Добавление в систему безопасности

Как правило действия, которые надстройка принимает выполняются от имени пользователя, который запускает надстройки; не были явно использовать олицетворение или указать, кто может выполнять надстройки. Действия не может превышать уровень разрешений пользователя, который запускает надстройки. 
  
В Office Developer Tools для Visual Studio 2012 AppManifext.xml имеет графический редактор которых можно задать область запроса разрешений. Например для создания надстройки, руководители проектов могут обновлять свои проекты, на вкладке **разрешения** в области конструктора **AppManifest.xml** выберите **Несколько проектов** для области действия и **записи** для разрешения. Если надстройку пользователь имеет разрешения руководитель проекта, она может работать надстройка для проектов, с которыми она управляет. Код в файле AppManifest.xml бы относятся следующие: 
  
```XML
  <AppPermissionRequests>
    <AppPermissionRequest Scope="https://sharepoint/projectserver/projects" Right="Write" />
  </AppPermissionRequests>
```

**В таблице 1. Области запроса разрешений для надстройки Project Server**

|Область действия|Разрешения|
|:-----|:-----|
|**Project Server** <br/> |**Управление** (Требуются разрешения администратора Project Server.)  <br/> |
|**Несколько проектов** <br/> |**Чтение**, **Запись** (Для некоторых операций требуются разрешения руководителя проекта; для базовых операций чтения, таких как назначения проекта, требуются разрешения члена группы проекта.)  <br/> |
|**Один проект** <br/> |**Чтение**, **Запись** (Требуются разрешения минимум члена группы проекта; доступ к некоторым данным в проекте зависит от других уровней разрешений.)  <br/> |
|**Корпоративные ресурсы** <br/> |**Чтение**, **Запись** (Требуются разрешения руководителя ресурсов.)  <br/> |
|**Отчеты о состоянии** <br/> |**Отправка состояния** (Требуется разрешение на отправку состояния проектов.)  <br/> |
|**Reporting** <br/> |**Чтение** (Требуется разрешение на вход в Project Server.)  <br/> |
|**Рабочий процесс** <br/> |**Повысить уровень** (Требуется разрешение для запуска рабочих процессов. Надстройка выполняется с повышенным уровнем разрешений для включения переходы движения в рабочем процессе. Бизнес-логики в надстройку управляет рабочей области переходов).  <br/> |
   
> [!NOTE]
> Project Server 2013 и Project Online не использовать модель проверки подлинности только для приложений в SharePoint 2013 ( [Add-in типы политик авторизации в SharePoint 2013](https://msdn.microsoft.com/library/124879c7-a746-4c10-96a7-da76ad5327f0%28Office.15%29.aspx)см). 
  
Сведения о разработке распределения, размещения и управление надстройками, просматривать [надстройки SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins) и [надстроек Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)и щелкните ссылку в документации разработчика по SharePoint Server 2013 и Office 2013. Сведения о область запроса разрешений для других SharePoint надстроек содержатся в разделе [разрешения Add-in в SharePoint 2013](https://msdn.microsoft.com/library/5f7a8440-3c09-4cf8-83ec-c236bfa2d6c4%28Office.15%29.aspx).
  
### <a name="integrating-with-sharepoint-server"></a>Интеграция с SharePoint Server
<a name="pj15_WhatsNew_IntegrationWSS"> </a>

Многие функции в Project Web App требуют новой инфраструктуры в SharePoint Server 2013 такие как OAuth и проверки подлинности на основе утверждений, авторизации Project Server и разрешениями с помощью групп SharePoint, синхронизации проектов с помощью задач SharePoint списки и декларативных рабочих процессов Project Server. Приложение-служба Project, можно сопоставить с любого семейства сайтов в ферме SharePoint. Синхронизация проекта может быть со списком задач SharePoint, которой осуществляет проекта SharePoint. Корпоративный проект можно синхронизировать со списком задач SharePoint, где Project Server поддерживает полный доступ. Архитектурные диаграммы и объяснение синхронизации проекта в разделе [Архитектура Project Server 2013](project-server-2013-architecture.md).
  
Существует множество новых функций в SharePoint Server 2013. Дополнительные сведения см в [SharePoint для разработчиков](https://msdn.microsoft.com/sharepoint).
  
### <a name="integrating-with-workflows"></a>Интеграция с рабочими процессами
<a name="pj15_WhatsNew_Workflow"> </a>

Рабочие процессы являются базовым компонентом в управлении портфелем проектов. Жизненный цикл проекта может включать в себя длительные процессы, проходящие через множество фаз. Фазы управления содержат проектные предложения, анализ влияния на бизнес, а также выбор, создание, планирование, управление и отслеживание проектов.
  
Платформа рабочих процессов SharePoint 2013, который использует WF4 создаются рабочих процессов Project Server 2013. В отличие от и в случае в предыдущих версиях декларативных рабочих процессов для Project Server 2013 могут быть созданы с помощью SharePoint Designer 2013 и доступны для локальных и использования в сети. Рабочих процессов Project Server используется модель безопасности рабочих процессов SharePoint с помощью OAuth и может быть установлена на сайт Project Web App. На рисунке 1 показано, что SharePoint Designer 2013 можно добавить стадии рабочего процесса сайта для управления запросами, где определены стадии в Project Web App.
  
**Рис. 1. Использование SharePoint Designer для добавления стадии в рабочий процесс веб-приложения Project**

![Добавление стадии рабочего процесса в SPD] (media/pj15_CreateWorkflowSPD_AddStageInSPD.gif "Добавление стадии рабочего процесса в SPD")

<br/>

Декларативный рабочий процесс построения путем добавления стадии рабочего процесса, действия, условия и другие элементы в средство разработки, который может быть SharePoint Designer 2013 или Visual Studio 2012. Средства создания затем сохраняет рабочего процесса в виде кода XAML, который обрабатывается во время выполнения. Декларативные рабочие процессы можно запустить в Project Server 2013 в локальной или в Project Online. С помощью Visual Studio 2012, можно также создавать настраиваемые действия и форм для дополнительных элементов управления и сохраните шаблоны рабочих процессов для повторного использования с несколько экземпляров Project Web App. SharePoint Designer 2013 может использовать настраиваемые действия, которые созданы в Visual Studio 2012.
  
Рабочий процесс Project Server 2013 выступает в качестве приложения, где администратор, кто имеет разрешения на разработку для Project Web App — можно опубликовать декларативный рабочий процесс и связать его с типом корпоративного проекта (типа корпоративного проекта). Для корпоративного проекта, где Project Server поддерживает полный доступ, должен быть типа корпоративного проекта. Список задач SharePoint нельзя использовать рабочий процесс Project Server. 
  
OAuth позволяет руководителям проектов, имеющих разрешения на создание проекта для запуска рабочего процесса без использования олицетворения. Вызовы рабочего процесса в Project Server, например для чтения значения настраиваемых полей в том, какие филиала для выполнения, выполняются от имени руководителя проекта. Чтобы предотвратить создание рабочего процесса, который автоматически переходит на следующий этап руководитель проекта, звонок по перемещению на следующий этап рабочего процесса выполняется как автор рабочего процесса (администратор). С другой стороны пользователи устаревших рабочих процессов Project Server 2010 звонков олицетворенным по учетной записи-посредника рабочего процесса для получения доступа администратора протяжении всего рабочего процесса.
  
Хотя Project Server 2013 в локальной можно использовать скомпилированной рабочих процессов на основе WF3.5, рекомендуется обновить устаревшие рабочие процессы для декларативных рабочих процессов на основании WF4. Новая технология более масштабируемой и надежным. Бизнес-аналитики и персонала отдела управления Проектами можно создать или обновить разработки рабочего процесса с помощью Visio 2013 и реализации рабочих процессов Project Server без написания кода с помощью SharePoint Designer 2013.
  
Сведения о создании декларативного рабочего процесса для Project Web App можно [Приступая к разработке рабочих процессов Project Server](getting-started-developing-project-server-workflows.md). Сравнение возможностей Visual Studio для рабочих процессов и SharePoint Designer в разделе [Разработка SharePoint 2013 рабочих процессов с помощью Visual Studio](https://msdn.microsoft.com/library/office/jj163199.aspx).
  
### <a name="client-side-object-model"></a>Объектная модель клиента
<a name="pj15_WhatsNew_CSOM"> </a>

Программный доступ к Project Online требует CSOM, построенный на SharePoint CSOM. Проверка подлинности Project Online будет с OAuth с помощью идентификатора Windows Live ID, не проверки подлинности Project Server форм или проверка подлинности Windows.
  
Ниже приведены принципы и функции CSOM в Project Server 2013.
  
- CSOM предназначен для удобства использования. Например методы и свойства непосредственно использовать, или предоставлять данные по имени, а не требуется много GUID, параметры _changeXml_ или передача вокруг наборов данных. 
    
- В модели CSOM Project Server реализуется поднабор функциональности PSI, основанный на наиболее общих требованиях для сторонних решений.
    
- CSOM выполняет внутренние вызовы PSI, но сформирован по-другому. Например, обновления всех изменений отчетов о состоянии осуществляются с помощью метода **StatusAssignmentCollection.SubmitAllStatusUpdates**, а не с помощью метода PSI **Statusing.SubmitStatus** для пользователя или метода **SubmitStatusForResource** для других ресурсов. 
    
- Модель CSOM доступна через одну службу WCF (Client.svc), а не через 22 общедоступные службы PSI.
    
- Инициализация Project Server CSOM не непосредственно через класс [ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx) с Project Web App URL-адрес, с помощью WCF ссылку или прокси-сервер сборки. 
    
- В CSOM реализовано несколько клиентских библиотек и интерфейсов, которые поддерживаются внутренней инфраструктурой CSOM SharePoint. В число клиентских библиотек и интерфейсов входят следующие:
    
  - Клиентская библиотека Microsoft .NET в сборке Microsoft.ProjectServer.Client.dll.
    
  - Библиотека Silverlight в сборке Microsoft.ProjectServer.Client.Silverlight.dll
    
  - Библиотека Windows Phone 8 в сборке Microsoft.ProjectServer.Client.Phone.dll.
    
  - Библиотеки JavaScript для веб-приложений в PS.js или PS.debug.js-файла
    
  - Конечные точки REST для доступа с помощью протокола OData.
    
  - Встроенная поддержка для запросов LINQ с фильтрацией, чтобы ограничивать объем возвращаемых данных.
    
- CSOM можно использовать для решения для Project Online и локальных решений, независимо от PSI и других сборок Project Server, например Microsoft.Office.Project.Server.Library.dll.
    
- Дополнительные возможности Project Server 2013 CSOM может рассматриваться как для накопительных пакетов обновления и пакеты обновления, на основе запросов с партнерами Project Server и сообщества разработчиков.
    
> [!NOTE]
> CSOM является предпочтительным интерфейсом для сторонних разработчиков Project Server. Мы рекомендуем использовать CSOM для разработки новых приложений, если CSOM содержит функциональность, которая требуется приложению. 
  
Сведения о разработке с использованием CSOM можно [со стороны клиента объектной модели (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md). Сведения об интерфейсе REST в приложениях SharePoint см *по программированию с помощью службы SharePoint REST* в документации разработчика SharePoint 2013. 
  
### <a name="changes-in-the-reporting-database"></a>Изменения в базе данных отчетов
<a name="pj15_WhatsNew_RDBChanges"> </a>

Четыре базы данных в Project Server 2010 объединяются в одну базу данных проекта в Project Server 2013. Имя базы данных Project по умолчанию — ProjectService. Таблицы и представления сохраняют предыдущей имена и таблиц и представлений из баз данных черновиков, опубликованных проектов и архивов имеют префиксы отчетов `draft`, `pub`, и `ver` в базе данных ProjectService. Например в таблице опубликованных проектов будет pub. MSP_PROJECTS. 
  
> [!IMPORTANT]
> Прямой доступ не поддерживается для черновика (`draft` префикс), опубликованных (`pub`) и архивов (`ver`) таблицы и представления. Отчеты о следует использовать только отчетности таблиц и представлений, которые имеют `dbo` префикса. Например dbo. Таблица MSP_EpmProject содержит список проектов в экземпляр Project Web App. 
>
> Не предусмотрено никаких средств активного предупреждения прямого программного доступа к базам данных для обновления данных в таблицах и представлениях базы данных Project. Следует иметь в виду, что кэш в Project профессиональный, таблицы черновиков и опубликованных данных, а также таблицы отчетов, зависят от протокола синхронизации кэша, который может быть нарушен в результате прямого редактирования данных. Если базы данных Project Server или клиентские кэши Project профессиональный повреждены в результате прямого доступа для изменения данных, необходимо знать, что служба технической поддержки продукта не сможет помочь! 
  
Project Server 2013 представлены службе OData для online и локальной доступа. Online отчетов таблицы и представления доступны только в интерфейсе OData; для локального использования можно использовать интерфейс OData или прямого доступа к отчетности таблиц и представлений в базе данных ProjectService в ферме SharePoint. Project Online не поддерживает обслуживания базы данных. То есть несколько экземпляров Project Web App каждого имеют собственные базы данных проекта. Службы OData во внутренней сети выполняет запросы SQL для работы с отчетами таблиц и представлений и доставляет полезных данных XML или JSON. Введение в службы OData для создания отчетов в Project Server 2013 и для ссылки на схему **ProjectData** в разделе [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/library/office/jj163015.aspx).
  
Общие сведения о запросов OData можно [OData: соглашения по URI](https://www.odata.org/documentation/). Например можно увидеть все проекты в локальный экземпляр Project Web App, где имя проекта начинается с «Test» с помощью следующего запроса в браузере. Щелкните правой кнопкой мыши в браузере страница и нажмите кнопку **просмотреть исходный код**.
  
```html
https://ServerName /ProjectServerName /_api/ProjectData/Projects?$filter=startswith(ProjectName, 'Test') eq true
```

Чтобы импортировать данные проекта в PowerPivot в Excel 2013 на ленте данных, выберите **веб-канала данных OData из** в раскрывающемся меню **Из других источников** . В диалоговом окне **Мастера подключения данных** введите https://ServerName/ProjectServerName/_api/ProjectData/ в данных веб-канала расположение, нажмите кнопку **Далее**и выберите таблица **проектов** на странице **Выбор таблиц** в мастере. Имя и сохраните ODC-файл и нажмите кнопку **Готово**. В диалоговом окне **Импорт данных** выберите **Отчет сводной таблицы**. На листе Excel выберите поля сводной таблицы строк и столбцов, которые требуется отобразить.
  
Пользователей локального сервера Project Server, для которых имеют необходимые разрешения, могут прямого доступа к отчетности таблиц и представлений через Microsoft SQL Server для создания отчетов, как в Project Server 2010. В Project Server 2013 пользователи также могут отчетов таблиц access для локальной через интерфейс OData. Вы можете получить данные Project Server через Интернет или локальной через конечные точки REST для службы OData. Например dbo. В таблице MSP_PROJECT и dbo. Просмотр MSP_EpmProject_UserView можно использовать для отчетов. Все таблицы или представления, которые имеют `draft`, `pub`, или `ver` префикс, только для внутреннего использования с Project Server и не предназначены для использования отчетов. Например черновиков. В таблице MSP_TASKS и pub. Просмотр MSP_PROJECTS_WORKING_VIEW не документированы и являются только для внутреннего использования. 
  
> [!NOTE]
> Можно расширить локальные средства составления отчетов, добавив таблицы, представления, поля и хранимые процедуры в отдельную базу данных. Не следует изменять существующие таблицы и представления отчетов в базе данных Project Server. 
  
В файле HTML-справки в более поздней версии загружаемого пакета Project 2013 SDK будут документированы отчетов таблиц, представлений и полей в базе данных Project. Документация по OData XML-схемы для службы **ProjectData** в разделе [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/library/office/jj163015.aspx). Запросы отчетов таблиц и представлений, которые были созданы для Project Server 2010 в большинстве случаев работают с базой данных проекта в Project Server 2013. Локальные пользователи можно получить доступ к кубов Project Server OLAP в SQL Server Analysis Services, как в текущий момент. В Project Online кубов OLAP недоступны.
  
### <a name="task-pane-add-ins-in-project"></a>Задача области надстроек в Project
<a name="pj15_WhatsNew_Agave"> </a>

Project Стандартный 2013 и Project Professional 2013 поддерживает задач области надстройки, которые можно использовать для интеграции с и отображение внешнего контента в веб-страницы. В области задач отображается содержимое веб-страницы, которая имеет доступ через JavaScript для задач, ресурсов, представлений и данных Общие проекта. Объектная модель JavaScript для проекта можно получить сведения о выбранных задач или ресурсов и можно получить данные в выбранной ячейки в сетке для представления, такие как диаграммы Ганта. Задачи области надстроек для проекта можно реализовать обработчики событий для задач, ресурсов, или просмотреть события изменения выделенного фрагмента. 
  
На рисунке 2 показано **Hello ProjectData** задач области надстройки, которая запрашивает службу **ProjectData** , а затем сравнивает данные в текущий проект с средние значения для всех проектов. Загрузить пакет SDK Project 2013 включает в себя полный исходный код для надстройки. 
  
**На рисунке 2. Задачи области надстройки в Project Professional можно работать с данными Project Server**

![Сравнение текущего проекта со всеми проектами] (media/pj15_RestQueryApp_CompareProject.gif "Сравнение текущего проекта со всеми проектами")
  
> [!NOTE]
> Project Стандартный 2013 нельзя непосредственно интеграции с Project Server 2013 через надстроек области задач. 
  
Задача области надстроек в Project Professional может поддерживать веб-частей, которые создаются для Project Server 2013, поэтому разработчики могут создавать расширения после, которое будет выполняться с помощью Project Web App и Project Professional. Общие задачи области надстроек, разработанных для других продуктов Office 2013 можно также с помощью Project Стандартный 2013 и Project Professional 2013. Для получения дополнительных сведений см [задач области надстроек для проекта](task-pane-add-ins-for-project.md).
  
### <a name="project-server-event-receivers"></a>Приемники событий Project Server
<a name="pj15_WhatsNew_Events"> </a>

В ферме SharePoint, которая включает в себя приложение-служба Project серверной может быть несколько серверов Project Web App (также называемая веб-серверах переднего плана или интерфейсных веб-серверах). Приемники событий можно также вызвать обработчиков событий. Обработчики событий локального можно реализовать в код с полным доверием и развернут на всех интерфейсных веб-серверах для локальной установки Project Server. Удаленных приемников событий можно реализовать в веб-служб на локальный или удаленный и доступны для нескольких интерфейсных веб-серверах и конфигурации с несколькими Project Server. Project Online можно использовать только удаленных приемников событий.
  
Обработчики событий Project Server управляются SharePoint для каждого экземпляра Project Web App, а не с определенной страницы параметры Project Web App. В приложения центра администрирования SharePoint выберите **Общие параметры приложения**, выберите **Управление** в разделе **Параметры веб-клиента Project**и затем выберите экземпляр в раскрывающемся списке **Экземпляр Project Web App** на странице Параметры веб-клиента Project страница. Чтобы добавить обработчик событий локальный или удаленный приемник событий, выберите **Обработчики событий на стороне сервера**.
  
Для локальной установки Project Server, можно создать удаленный приемник событий как компонент SharePoint, который используется класс [Microsoft.ProjectServer.Client.EventHandlerCreationInformation](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM и управление программным образом приемник событий с помощью методов в классе [EventHandlerCollection](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCollection.aspx) . Для удаленных приемников событий, перед событиями являются синхронными, после события — асинхронный и нет времени ожидания для случаев, где не возвращает приемника удаленных событий. 
  
> [!NOTE]
> Центр администрирования SharePoint доступен только для локальных установок. Для Project Online и SharePoint Online вы можете добавить или удалить удаленных приемников событий с использованием пакета приложения на основе CSOM. 
  
На странице "обработчики событий на сервере" процесс, чтобы добавить обработчик событий локального для локальной установки Project Server — это почти то же, что действия, описанные в разделе [Создание обработчика событий Project Server и регистрации событий](https://msdn.microsoft.com/library/gg615466.aspx) для Project Server 2010. Разница в том, что на странице нового обработчика событий имеет дополнительные параметры. Например выберите **Создание проекта** из списка **событий** и выберите **Новый ОБРАБОТЧИК СОБЫТИЙ**. На странице новое событие обработчик только два обязательные поля, **имя** и **порядок** (см). При добавлении обработчика локального событий с полным доверием, добавьте в поле **Имя сборки** и в поле **Имя класса** ; Оставьте в поле **URL-адрес конечной точки** пустым. При добавлении приемника удаленных событий, добавьте **URL-адрес конечной точки**и оставить пустым **Имя сборки** и **Имя класса** . 
  
> [!CAUTION]
> Если указан *как* имя класса/имя сборки и URL-адрес конечной точки, Project Server вызывает local (локальный) обработчик событий. Игнорируется в удаленный приемник событий. 
> 
> Если создать два обработчика событий для одного события, когда один обработчик событий является локальным, а другой является удаленным приемником событий, при этом значение поля **Порядок** одинаково, Project Server игнорирует удаленный приемник событий. 
  
**Рис. 3. Добавление локального обработчика событий или удаленного приемника событий**

![Настройка обработчика событий или приемника событий] (media/pj15_EventHandlers_NewEventHandler.gif "Настройка обработчика событий или приемника событий")
    
Если требуется доступ к наборам данных PSI для обработчика событий локального можно скопировать сборки, Microsoft.Office.Project.Schema.dll [Windows]\Microsoft.NET\assembly\GAC\_MSIL\Microsoft.Office.Project.Schema\v4.0_15.0.0.0__ каталог 71e9bce111e9429c. 

Вместо PSI мы рекомендуем использовать классы событий в пространстве имен **Microsoft.ProjectServer.Client** ; Разработка с помощью CSOM не требуется выполнение различных операций наборов данных. Чтобы разработать удаленных приемников событий для Project Online, необходимо использовать класс [события](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.Event.aspx) и класс [EventHandlerCreationInformation](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM. 
  
Перед развертыванием обработчика событий Project Server, Установка и тестирование обработчика событий тщательно на установку test Project Server. Для локальной установки Project Server если обработчика событий локального, добавлении становится неработоспособен, служба событий Project Server 2013 не удается загрузить другой допустимый пользовательские обработчики событий. В этом случае необходимо удалить обработчик событий проблемы и перезапустите службы событий.
  
> [!NOTE]
> Для локальной установки Project Server мы рекомендуем перейти на удаленные приемники событий, используя CSOM для разработки приемников событий. Так как удаленные приемники событий не содержат стороннего кода, выполняющегося в службе событий Project Server, удаленные приемники событий более стабильны. Локальные администраторы освобождаются от поддержки службы событий Project Server. 
  
Общие сведения о событиях см [в приложениях для SharePoint](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx). 
  
## <a name="deprecated-features"></a>Устаревшие компоненты
<a name="pj15_WhatsNew_Deprecated"> </a>

> [!NOTE]
> Сведения о функциях и API, которые будут удалены или в предварительной версии Project Server 2016 видеть, [что удалены или в предварительной версии Project Server 2016](https://technet.microsoft.com/library/mt422816%28v=office.16%29.aspx). 
  
Устаревшие компоненты, по-прежнему доступны в Project 2013 для некоторых решений, но не следует использовать для разработки новых приложений. Большая часть следующие функции и методы не работают с Project Online или с помощью локальной установки по умолчанию Project Server 2013 в режиме разрешений SharePoint. Существующие решения, использующие эти функции могут не работать для обновления Project Server 2010 до Project Server 2013. Хотя решений, использующих устаревшие функции могут продолжать работать в некоторых случаях, они не полностью поддерживаются для всех установок Project 2013.
  
Если решений использовать устаревшие компоненты, перед развертыванием они должны быть полностью проверить, и их следует изменять поддерживается использование функций, как только возможности. Сведения о настройке безопасности Project Server 2013 в локальной для режим разрешений Project обратитесь к разделу *Режим разрешений SharePoint* в [возможности впервые для ИТ-специалистов в Project Server 2013](https://technet.microsoft.com/en-us/library/ff631142%28office.15%29.aspx).
  
- **Расширения** [Сценарии расширения PSI](https://msdn.microsoft.com/library/office/ff843378%28v=office.14%29.aspx) устарели и не будет поддерживаться в будущих выпусках. Эти сценарии Project Server 2013 в локальной включить интеграцию с помощью настраиваемые службы Windows Communication Foundation (WCF). 
  
- **Project PSI (en)** [Класс проекта](https://docs.microsoft.com/office/client-developer/project/project-psi-reference-overview) из PSI является устаревшим. Для всех новых проектов можно используйте [Project CSOM](client-side-object-model-csom-for-project-2013.md). Project Server 2013 приложений, использующих PSI проекта будет продолжать работать, но Project Online приложений потребуется заменить все методы класса проекта PSI их эквивалентные методы CSOM.
  
- **План ресурсов PSI (en)** Устаревшие [PSI планирование ресурсов](https://msdn.microsoft.com/library/office/websvcresourceplan_di_pj14mref.aspx) . Будет поддерживаться для разработки Project 2013, но не будут поддерживаться в будущих выпусках. 
  
- **Интерфейс ASMX для PSI (en)** PSI включает в себя повторяющихся интерфейсы для разработки расширений локального сервера Project Server. Интерфейс веб-служб ASMX была введена в первой реализации PSI в Office Project Server 2007. Project Server 2010 добавлена интерфейс служб WCF, где объектной модели по сути дублирует веб-службы ASMX. Хотя Project Server 2013 продолжает поддерживать ASMX и WCF, новые решения, которые требуют PSI следует использовать службы WCF. Если это возможно новые решения должны быть написаны с помощью CSOM. 
  
  Веб-службы ASMX из PSI являются устаревшими в Project Server 2013. Для работы в будущих версий Project Server, необходимо переписать решений, использующих веб-службы ASMX для использования службы WCF или CSOM. Для получения дополнительных сведений обратитесь к разделу *обновление приложений с помощью интерфейсов API Project Server* в [Project Server программирования](project-server-programmability.md).
  
- **Объект ссылок поставщика (OLP)** В предыдущих версиях сервера Project Server службы **ObjectLinkProvider** в PSI ( [WebSvcObjectLinkProvider](https://msdn.microsoft.com/library/WebSvcObjectLinkProvider.aspx) см) предоставляет способ управления веб-объект ссылки между задачами проекта корпоративного и специализированных списки SharePoint на сайте проекта проблемы, риски, связанные с, конечные результаты и документы. В Project Server 2013 OLP является устаревшим. 
  
  Можно используйте класс **[RelatedItemManager](https://msdn.microsoft.com/library/microsoft.sharepoint.client.relateditemmanager.aspx)** SharePoint CSOM для создания, чтения и удаление ссылок на объекты web между элементами в список задач и другие списки на сайте проекта. Например добавление ссылки из элемента задачи в проблему, можно использовать метод **[AddSingleLink](https://msdn.microsoft.com/library/office/microsoft.sharepoint.client.relateditemmanager.addsinglelink.aspx)** или одного из двух методов аналогичные, **AddSingleLinkFromUrl** или **AddSingleLinkToUrl**. Класс **RelatedItemManager** также включает в себя методы для удаления ссылки на объект web и чтение связанных элементов. Эквивалентный класс в JSOM (объектная модель JavaScript) в разделе [SP. RelatedItemManager object (sp.js)](https://msdn.microsoft.com/library/jj838582.aspx).
  
  Рекомендуется использовать SharePoint CSOM для создания типа OLP для локальной установки Project Server 2013 и Project Online. Пространство имен [Microsoft.SharePoint](https://msdn.microsoft.com/library/microsoft.sharepoint.aspx) не включает **RelatedItemManager** *** класса. 
  
- **Настраиваемые разрешения** Настраиваемые разрешения на доступ к отдельным функциям Project Server или расширений поддерживаются в Office Project Server 2007, где SDK статьи описано создание их путем прямого изменения базы данных опубликованных проектов. В Project Server 2010 настраиваемые разрешения по-прежнему работают, но являются устаревшими. В Project Server 2013 пользовательских разрешений не работают с режимом разрешений SharePoint по умолчанию для локальных установок. Режим разрешений Project поддерживаются настраиваемые разрешения. С Project Online прямой базы данных access не поддерживается. 
  
- **Олицетворение** Олицетворение в приложениях на основе интерфейса PSI, где пользователя приложения можно допустить разрешения безопасности другого пользователя Project Server, рекомендуется использовать в Project Server 2013. Как указано ранее по умолчанию в локальной установки Project Server 2013 использует режим разрешений SharePoint, которая не позволяет олицетворения в группах безопасности Project Server. Для получения дополнительных сведений см [проверки подлинности, авторизации и безопасности в SharePoint 2013](https://msdn.microsoft.com/library/ms457529%28office.15%29.aspx).
  
  Отчеты о состоянии приложений, типичные расширения, которые могут использовать олицетворения в предыдущих версиях сервера Project Server. Project Server 2010 появился метод **ReadStatusForResource** и с помощью метода **SubmitStatusForResource** в PSI (en), а также глобальные разрешения **StatusBrokerPermission** , что избавляет олицетворения для чтения и обновление состояния от имени другого пользователя. CSOM в Project Server 2013 использует базовый PSI чтобы прозрачно расширения отчеты о состоянии и может использоваться для Project Online и локальных установок. 
  
- **Расширения базы данных отчетов** Добавление настраиваемых таблиц и представлений в базе данных отчетов будет принято с предыдущими версиями сервера Project Server. Так как Project Server 2013 объединяет четыре базы данных из предыдущей версии в одну базу данных, обновления не перенос настраиваемых таблиц, представлений или писать хранимые процедуры для работы с отчетами таблиц в базе данных Project Server 2013. 
  
  Мы рекомендуем использовать SQL Azure или отдельной базы данных SQL Server для настраиваемых отчетов таблиц и представлений, где можно управлять резервных копий баз данных и обновления. Для Project Online это необходимо.
  
- **Отчеты** Локальный отчетов таблиц и представлений в базе данных Project Server и кубов OLAP, *не* рекомендуется к использованию и оставаться полностью поддерживаемая. Тем не менее отчетности таблиц и представлений (базы данных отчетов в предыдущих версий Project Server) не доступны в Project Online. Аналогично кубов OLAP доступны только при использовании локальных установок Project Server 2013. Для создания отчетов приложений с помощью Project Online, можно использовать службы **ProjectData** , с помощью запросов REST с помощью протокола OData. 
  
- **Руководство по Project** Руководство по Project является стандартным средством в настольных приложений Microsoft Office Project 2007, где HTML и JavaScript контента в область задач предоставляет интерактивное руководство по Создание и управление проектами. В Project 2010 консультант доступна не во время установки по умолчанию, но можно включить в VBA или надстройка VSTO. Загрузить пакет SDK для Project 2010 включает в себя измененные файлы консультанта. 
  
  Объектной модели VBA и объектной моделью **Microsoft.Office.Interop.MSProject** в Project 2013 по-прежнему добавить 22 членов класса **приложения** и класс **Project** , можно управлять консультант. Тем не менее Project 2013, приложения области задач могут конфликтовать с действиями в области задач консультант и содержимое консультанта не могут легко распределенного или продается в магазине Office. Настоятельно рекомендуется разрабатывать решения области задач проекта с использованием надстроек Office, не настраиваемые консультанта. Дополнительные сведения о консультант обратитесь к [Документации SDK Project 2010](https://msdn.microsoft.com/library/ms512767.aspx).
  
## <a name="comparing-project-server-on-premises-with-project-online"></a>Сравнение Project Server для локального развертывания и Project Online
<a name="pj15_WhatsNew_Comparing"> </a>

Чтобы помочь вам решить, следует ли использовать Project Server в локальной или Project Online и какие виды расширений, вы можете создавать в любом случае, в таблице 2 сравнивает функциональных возможностей для локальной установки Project Server 2013 с Project Online. В таблице 2 не включает различия в развертывание, администрирование или использования. Дополнительные сведения о Project Online и Project Server 2013 можно [Project 2013 для разработчиков](https://msdn.microsoft.com/office/fp161502) и [Project Online](https://developer.microsoft.com/en-us/project).
  
**Таблица 2. Возможности расширения Project Server для локального развертывания и Project Online**

| Компонент |Project Server для локального развертывания | Project Online |
|:-----|:-----|:-----|
|**Возможности программирования** <br/> |Приложения на основе CSOM; однородная модель программирования  <br/>-.NET, Silverlight, клиентские библиотеки Windows Phone  <br/>— Библиотеки JavaScript для настраиваемых страниц, веб-частей и расширения ленты  <br/>-Протоколы OData и REST<br/><br/> Приложения на основе PSI; сложная модель программирования, можно создавать приложения для администрирования, анализа портфеля, уведомлений, безопасности в режиме Project, системы очередей и других областей.<br/><br/>Расширения PSI  <br/><br/>Настраиваемые разрешения с применением безопасности в режиме Project (не рекомендуется)  <br/><br/>Олицетворение с помощью PSI (не рекомендуется)  <br/><br/>Код полного доверия; установка расширений в ферме SharePoint  <br/> |Приложения на основе CSOM; однородная модель программирования  <br/>-.NET, Silverlight, клиентские библиотеки Windows Phone<br/>— Библиотеки JavaScript для настраиваемых страниц, веб-частей и расширения ленты<br/>-Протоколы OData и REST<br/><br/>Может использовать PSI, но нет поддержки: нет OAuth и подключений между службами<br/><br/>Нет расширений API CSOM<br/><br/>Нет настраиваемых разрешений<br/><br/>Нет олицетворения<br/><br/>Нет кода полного доверия  <br/> |
|**Настраиваемые базы данных** <br/> |-SQL Azure  <br/>-SQL Server (изменение отчетов таблиц и представлений в Project Server, базы данных не поддерживается)  <br/> |-SQL Azure  <br/>-SQL Server (изменение отчетов таблиц и представлений в Project Server, базы данных не поддерживается)  <br/> |
|**Reporting** <br/> |- Служба **ProjectData** ; Протоколы OData и REST  <br/>-Отчетов таблиц и представлений в базе данных Project Server<br/>-Базы данных OLAP  <br/> |- Служба **ProjectData** ; Протоколы OData и REST  <br/> |
|**обработчики событий.** <br/> |-Удаленных приемников событий, доступным с помощью конечных точек WCF<br/>— Обработчики событий с полным доверием, установленные в ферме SharePoint  <br/> | -Удаленных приемников событий, доступным с помощью конечных точек WCF  <br/> |
|**Рабочие процессы** <br/> |Декларативные рабочие процессы, созданные с помощью SharePoint Designer 2013<br/>-Используйте только для конкретного экземпляра Project Web App<br/>-Можно импортировать разработки рабочего процесса из Visio 2013<br/>-Можно импортировать и использовать настраиваемые действия<br/><br/> Декларативные рабочие процессы, созданные с помощью Visual Studio 2012<br/>-Создание приложения, которое может содержать рабочих процессов<br/>-Создайте пакет решения SharePoint (WSP-файл), который может содержать рабочих процессов<br/>-Создания шаблонов рабочих процессов для повторного использования<br/>-Создавать и использовать настраиваемые действия  <br/><br/>Возможно использование старых скомпилированных рабочих процессов, созданных с применением WF3.5 (рекомендуется обновление до декларативных рабочих процессов WF4)  <br/> |Декларативные рабочие процессы, созданные с помощью SharePoint Designer 2013<br/>-Используйте только для конкретного экземпляра Project Web App<br/>-Можно импортировать разработки рабочего процесса из Visio 2013<br/>-Можно импортировать и использовать настраиваемые действия  <br/><br/>Декларативные рабочие процессы, созданные с помощью Visual Studio 2012<br/>-Создание приложения, которое может содержать рабочих процессов  <br/>-Создайте пакет решения SharePoint (WSP-файл), который может содержать рабочих процессов<br/>-Создания шаблонов рабочих процессов для повторного использования <br/>-Создавать и использовать настраиваемые действия  <br/> |
|**Распространение** <br/> |-Office Store (для приложений на основе CSOM)<br/>-Частном каталоге приложений в SharePoint<br/>-Файловый ресурс интрасети  <br/> |-Магазин office<br/>-Частном каталоге приложений в SharePoint  <br/> |

   
## <a name="conclusion"></a>Заключение
<a name="pj15_WhatsNew_Conclusion"> </a>

Project Server 2013 предоставляет множество новых возможностей разработки и сценарии, в которых партнеров и клиентов можно использовать адаптировать и расширить возможности и полезность Project Server в крупных организациях и в небольших организаций. Инфраструктуры для Office 2013 и SharePoint 2013 можно использовать для создания и распространения приложений для Project 2013, можно существенно расширить конкурентоспособность и использование пользовательских приложений. Некоторые функции-расширения и практические рекомендации для предыдущих версий поддерживаются в Project 2013, особенно ASMX веб-службы PSI и функций, в которых используются олицетворения или изменения прямой базы данных, которые не может использоваться с Project Online.
  
Введение в CSOM обеспечивает программный доступ к Project Online для самых разных устройств и с помощью JavaScript в веб-приложений. CSOM обеспечивает более согласованную модель программирования, по сравнению с PSI. Доступ к данным Project Server может различными способами более чем в предыдущих версиях, в том числе через Интернет-службы OData и конечные точки REST для работы с отчетами данные в базе данных Project. Существующие отчеты по-прежнему работает так же, как для локального использования; новые отчеты имеют большую гибкость.
  
Надстройки Office содержат новый способ по продаже решений и интеграции Project Стандартный 2013 с веб-содержимым и других продуктов Office 2013. Можно также создать новые способы интеграции Project Professional 2013 с данными Project Server и списки SharePoint через область задач надстроек Office.
  
Дополнительные сведения о разработке приложений и использование возможностей программирования и CSOM SharePoint Server 2013 можно [SharePoint для разработчиков (en)](https://msdn.microsoft.com/sharepoint) и [Office для разработчиков](https://msdn.microsoft.com/office).
  
## <a name="see-also"></a>См. также

- [Project Server 2013 architecture](project-server-2013-architecture.md)  
- [Задачи программирования Project](project-programming-tasks.md) 
- [Клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md) 
- [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/library/office/jj163015.aspx)  
- [Надстройки области задач для Project](task-pane-add-ins-for-project.md)   
- [OData: Соглашения по URI](https://www.odata.org/documentation/uri-conventions#FilterSystemQueryOption)    
- [SharePoint для разработчиков](https://msdn.microsoft.com/sharepoint)    
- [Office для разработчиков (en)](https://msdn.microsoft.com/office)   
- [Обработка событий в приложениях для SharePoint](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx)   
- [Магазин Office](https://office.microsoft.com/en-us/store/)   
- [Project Online](https://developer.microsoft.com/en-us/project)
    


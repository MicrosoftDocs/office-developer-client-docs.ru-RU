---
title: Обновления для разработчиков в Project
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5b2b22cd-6e28-43a8-9092-b411da8bfb53
description: Новые функции включают клиентскую объектную модель (CSOM), интерфейсы REST, службу OData для отчетности, приемники удаленных событий, декларативные рабочий процессы и надстройки области задач для Project клиентов.
ms.openlocfilehash: c2bc0b475639a8582422b2091169116428367c60
ms.sourcegitcommit: 37080eb0087261320e24e6f067e5f434a812b2d2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "39819282"
---
# <a name="updates-for-developers-in-project"></a>Обновления для разработчиков в Project

Функции extensibility Project Server 2013 работают с надстройки для Project Online и с локальной установкой. Новые функции включают клиентскую объектную модель (CSOM), интерфейсы REST, службу OData для отчетности, приемники удаленных событий, декларативные рабочий процессы и надстройки области задач для Project клиентов. Кроме того, узнайте о неподготовленных функций, которые не следует использовать для новой разработки.
  
Project Сервер 2013 строится на основе фреймворка, представленного Microsoft Office Project Server 2007 и расширенного Project Server 2010. Project Сервер 2013 добавляет клиентскую объектную модель (CSOM), которая рефакторируется и упрощается из интерфейса Project Server (PSI), и включает библиотеку JavaScript и платформа .NET Framework 4 библиотеки для Windows приложений, Windows Phone 8 и Microsoft Silverlight. CSOM предназначен для разработки Project Online, а также работает с локальной установкой Project Server. 

Базы Project серверов объединяются в одну базу данных; вы можете получить доступ к таблицам и представлениям онлайн-отчетов через службу OData. CSOM и служба OData включают интерфейс переноса состояния представления (REST). Project Рабочий процесс сервера можно создать с помощью SharePoint Designer 2013. Project профессиональный 2013 г. можно интегрировать с данными Project Server, списками задач SharePoint и другим внешним контентом с помощью Office надстройки для области задач. Project стандартный 2013 г. можно использовать надстройки области задач для интеграции с общим внешним контентом.
  
Дополнительные сведения о крупных изменениях в Project Server 2013 см. в Project [Server 2013.](project-server-2013-architecture.md)
  
> [!NOTE]
> Project Server 2013 создан на основе платформы SharePoint Server 2013, и большая часть инфраструктуры Project 2013 ничем не отличается от других приложений Office 2013. Документация по модели для надстройок SharePoint, SharePoint, веб-части, разработки с другими функциями SharePoint и документации надстройок Office см. в [](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins)SharePoint надстройки, [Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)надстройки и обзор SharePoint [2013](https://msdn.microsoft.com/library/jj164084%28office.15%29.aspx)г. . 
  
## <a name="major-new-features-in-project-2013"></a>Основные новые компоненты в Project 2013
<a name="pj15_WhatsNew_MajorNewFeatures"> </a>

Новые функции Project стандартный 2013 и Project профессиональный 2013 г. включают улучшенный пользовательский интерфейс, который соответствует другим приложениям Office 2013 г. и поддерживает современный пользовательский интерфейс стиля в Windows 8, интеграцию с объектами Office Art для отчетов, отчетов об ожогах и новые функции программируемости для отчетов. Project профессиональный 2013 г. включает более обширные совместное использование и синхронизацию проектов на SharePoint Server 2013, а также надстройки области задач, которые также реализованы в других приложениях Office 2013 г., таких как Word, Excel и Outlook.
  
В Project Server 2013 есть много новых функций. Некоторые из них не имеют основной истории программируемости, например новой временной шкалы в Project Web App. Эти компоненты будут задокументированы в справке продукта и в документации для конечных пользователей на веб-сайте Microsoft Office Online, а также в статьях, предназначенных для администраторов и ИТ-специалистов, на портале Microsoft TechNet. Другие новые компоненты, такие как улучшенные расписания, упрощают сторонним разработчикам взаимодействие с расписаниями и получение информации о состоянии через интерфейс Project Server (PSI).
  
Добавление Project Online и Office Store (для Project надстройки — это далеко идущие изменения, в которых Project Server доступен через https://office.microsoft.com/store) Microsoft Azure. Облачный доступ к Project Server использует клиентскую объектную модель (CSOM) для разработки надстройок с microsoft платформа .NET Framework, Microsoft Silverlight, Windows Phone и веб-приложениями, использующими JavaScript. Требованием Project Online является то, что четыре Project серверных баз данных предыдущих версий объединены в одну базу данных.
  
Project Производительность и масштабируемость сервера 2013 улучшены во многих областях, таких как состояние задач, таблицы и управление проектами. Project Рабочий процесс сервера переработан с помощью версии 4 Windows рабочего процесса (WF4). Использование платформа .NET Framework 4 и Windows связи (WCF) с PSI повышает безопасность, производительность и масштабируемость. Например, можно изменить протокол транспорта приложений, основанных на WCF, с помощью файлов конфигурации, не изменяя код приложения и не проводя перекомпилирование. Project Web App многих вызовов PSI, в которых данные существенно не изменяются.
  
> [!NOTE]
> Для разработки Project Server 2013 можно использовать Visual Studio с расширениями Office и SharePoint, которые могут создавать надстройки для продуктов Office 2013 г. Project Сервер 2013 Visual Studio полностью включить разработку таких функций, как страницы с подробными данными о проекте и приложения на основе WCF. Расширения SharePoint в Visual Studio могут развертывать веб-части и другие SharePoint непосредственно Project Web App и другие SharePoint сайты. 
>
> Visual Studio больше не требуется разрабатывать Project Server, которые используют настраиваемые поля, этапы, этапы и типы корпоративных проектов, которые можно управлять Project Web App. Хотя вы можете Visual Studio для разработки рабочих процессов, их часто проще и быстрее создавать с помощью SharePoint Designer. Visual Studio можно использовать для рабочих процессов, требующих доступа к модели CSOM или другим внешним API. 
  
### <a name="project-add-ins"></a>Надстройки Project
<a name="pj15_WhatsNew_Apps"> </a>

Распространение и маркетинг программного обеспечения были революционизированы с помощью концепции надстройки. За Project 2013 г. надстройки можно сделать доступными для покупки и скачивания из общего Office Store или распространять в частном каталоге на SharePoint. Надстройка обычно является самостоятельной интерактивной программой, которая выполняет небольшое количество связанных задач. Надстройка Project может быть надстройка области задач для клиентов Project стандартный или Project стандартный 2013 года или надстройка для Project Server 2013 или Project Online.
  
Сведения о надстройки для Project настольных компьютеров см. в [Project.](#pj15_WhatsNew_Agave) Пример Project Server 2013 см. в SharePoint надстройки Project [Server.](create-a-sharepoint-hosted-project-server-add-in.md) В дополнение к статьям в Office и SharePoint надстроек [SDK,](https://msdn.microsoft.com/library/fp161507.aspx) [блог Office](https://blogs.office.com/dev/) имеет много сообщений, которые также имеют отношение к Project 2013 и Project Online. 
  
Надстройка для Project Server 2013 может работать как с локальной установкой, так и с Project Online. Project Надстройки сервера могут включать веб-части, приемники удаленных событий и бизнес-логику. Доступ к объектной Project Server в надстройке имеется через CSOM, а не PSI. Хранилище данных может быть облачным, например с SQL Azure, внешним, например Microsoft Business Connectivity Services (BCS), внутренним с локальной базой данных или смешанным.
  
#### <a name="add-in-security"></a>Безопасность надстройки

Как правило, действия, которые принимает надстройка, выполняются от имени пользователя, который запускает надстройку; вы явно не используете обезличение или не указываете, кто может запустить надстройку. Действия не могут превышать уровень разрешений пользователя, который запускает надстройки. 
  
В Office developer Tools for Visual Studio 2012 AppManifext.xml файл имеет графический редактор, в котором можно установить область запроса разрешений. Например, чтобы создать надстройку, которая позволяет руководителям проектов обновлять свои проекты, на вкладке  **Permissions** области **AppManifest.xml** конструктора выберите несколько проектов для области и напишите для разрешения.  Если пользователь надстройки имеет разрешения диспетчера проектов, он может запустить надстройку для проектов, которые она управляет. Код файла AppManifest.xml может содержать следующие команды: 
  
```XML
  <AppPermissionRequests>
    <AppPermissionRequest Scope="https://sharepoint/projectserver/projects" Right="Write" />
  </AppPermissionRequests>
```

**Таблица 1. Области запросов разрешений для надстройок Project Server**

|Область|Разрешения|
|:-----|:-----|
|**Project Server** <br/> |**Управление** (Требуются разрешения администратора Project Server.)  <br/> |
|**Несколько проектов** <br/> |**Чтение**, **Запись** (Для некоторых операций требуются разрешения руководителя проекта; для базовых операций чтения, таких как назначения проекта, требуются разрешения члена группы проекта.)  <br/> |
|**Один проект** <br/> |**Чтение**, **Запись** (Требуются разрешения минимум члена группы проекта; доступ к некоторым данным в проекте зависит от других уровней разрешений.)  <br/> |
|**Корпоративные ресурсы** <br/> |**Чтение**, **Запись** (Требуются разрешения руководителя ресурсов.)  <br/> |
|**Statusing** <br/> |**Отправка состояния** (Требуется разрешение на отправку состояния проектов.)  <br/> |
|**Создание отчетов** <br/> |**Чтение** (Требуется разрешение на вход в Project Server.)  <br/> |
|**Рабочий процесс** <br/> |**Повышение прав** (Требуется разрешение на запуск рабочих процессов. Надстройка запускается с повышенными разрешениями, чтобы включить переходы от стадии к этапу в рабочий процесс. Бизнес-логика в переходах этапов элементов управления надстройки.)  <br/> |
   
> [!NOTE]
> Project Server 2013 и Project Online не используют модель проверки подлинности только для приложений в SharePoint 2013 г. (см. типы политики авторизации надстройки в [SharePoint 2013](https://msdn.microsoft.com/library/124879c7-a746-4c10-96a7-da76ad5327f0%28Office.15%29.aspx)г.). 
  
Сведения о разработке, распространении, размещении и управлении [](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins) надстройки см. в SharePoint надстройки и надстройки [Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)и смежные темы в документации разработчиков SharePoint Server 2013 и Office 2013 г. Сведения о области запросов разрешений для других надстройок SharePoint см. в SharePoint [2013 г.](https://msdn.microsoft.com/library/5f7a8440-3c09-4cf8-83ec-c236bfa2d6c4%28Office.15%29.aspx).
  
### <a name="integrating-with-sharepoint-server"></a>Интеграция с SharePoint Server
<a name="pj15_WhatsNew_IntegrationWSS"> </a>

Многие функции Project Web App требуют новой инфраструктуры в SharePoint Server 2013, например проверки подлинности на основе OAuth и утверждений, авторизации и разрешений Project Server через группы SharePoint, синхронизации проектов с SharePoint списками задач и декларативными процессами Project Server. Приложение-службу Project можно связать с любым семейством сайтов в ферме SharePoint. Синхронизация Project может осуществляться со списком задач SharePoint, когда SharePoint поддерживает проект. Корпоративный проект можно также синхронизировать со списком задач SharePoint, когда Project Server поддерживает полное управление. Архитектурные схемы и объяснение синхронизации проектов см. в Project [Server 2013.](project-server-2013-architecture.md)
  
В SharePoint Server 2013 существует множество новых функций. Дополнительные сведения см. [в SharePoint для разработчиков.](https://msdn.microsoft.com/sharepoint)
  
### <a name="integrating-with-workflows"></a>Интеграция с рабочими процессами
<a name="pj15_WhatsNew_Workflow"> </a>

Рабочие процессы являются базовым компонентом в управлении портфелем проектов. Жизненный цикл проекта может включать в себя длительные процессы, проходящие через множество фаз. Фазы управления содержат проектные предложения, анализ влияния на бизнес, а также выбор, создание, планирование, управление и отслеживание проектов.
  
Project Рабочий процесс Server 2013 построен на платформе рабочего процесса SharePoint 2013 г., которая использует WF4. В отличие от предыдущих версий, декларативные процессы для Project Server 2013 могут быть созданы с помощью SharePoint Designer 2013 и доступны как для локального, так и для использования в Интернете. Project Рабочий процесс сервера использует SharePoint модели безопасности рабочего процесса с OAuth и может быть установлен на Project Web App сайте. На рисунке 1 показано, что SharePoint Designer 2013 может добавлять этапы в рабочий процесс сайта для управления запросами, где этапы определяются в Project Web App.
  
**Рис. 1. Использование SharePoint Designer для добавления стадии в рабочий процесс веб-приложения Project**

![Добавление стадии рабочего процесса в SPD](media/pj15_CreateWorkflowSPD_AddStageInSPD.gif "Добавление стадии рабочего процесса в SPD")

<br/>

Вы создаете декларативный рабочий процесс путем добавления этапов рабочего процесса, действий, условий и других элементов в средство разработки, которое может быть SharePoint Designer 2013 или Visual Studio 2012. Средство разработки затем сохраняет рабочий процесс в виде XAML-кода, интерпретируемого в среде выполнения. Декларативные процессы могут работать как в локальной Project Server 2013, так и в Project Online. Используя Visual Studio 2012 г., вы также можете создавать настраиваемые действия и формы для дополнительного управления и сохранять шаблоны рабочего процесса для повторного использования с несколькими Project Web App экземплярами. SharePoint Конструктор 2013 может использовать настраиваемые действия, созданные в Visual Studio 2012.
  
Рабочий процесс Project Server 2013 действует как приложение, в котором администратор, у которого есть разрешения на разработку Project Web App, может опубликовать декларативный рабочий процесс и связать его с типом корпоративного проекта (EPT). Тип корпоративных проектов должен быть задан для корпоративного проекта, в котором Project Server осуществляет полное управление. Список задач SharePoint не может использовать рабочий процесс Project Server. 
  
Служба OAuth позволяет руководителям проектов, имеющим разрешения на создание проектов, вызвать рабочий процесс без применения олицетворения. Вызовы Project Server рабочим процессом, например для чтения значения настраиваемого поля с целью определения следующего перехода, выполняются от имени руководителя проекта. Чтобы запретить руководителю проекта создавать рабочий процесс, который автоматически переходит на следующую стадию, вызов перехода на следующую стадию запускается от имени автора рабочего процесса (администратора). Напротив, пользователи устаревших Project Server 2010 делают выверенные вызовы через учетную запись прокси-пользователя workflow, чтобы получить доступ администратора во всем рабочего процесса.
  
Хотя Project Server 2013 на локальной основе может использовать компиляторные рабочий процессы на основе WF3.5, рекомендуется обновить устаревшие рабочий процессы до декларативных процессов на основе WF4. Эта новая технология лучше масштабируется и более надежна. Бизнес-аналитики и сотрудники PMO могут создавать или обновлять проекты рабочих процессов с помощью Visio 2013 г. и внедрять рабочие процессы Project Server без кодирования с помощью SharePoint Designer 2013.
  
Сведения о создании декларативного рабочего процесса для Project Web App см. в Project [Server.](getting-started-developing-project-server-workflows.md) Для сравнения возможностей SharePoint и Visual Studio для рабочего процесса см. в SharePoint [2013](https://msdn.microsoft.com/library/office/jj163199.aspx)Visual Studio .
  
### <a name="client-side-object-model"></a>Клиентская объектная модель
<a name="pj15_WhatsNew_CSOM"> </a>

Программный доступ к Project Online требует CSOM, который построен на SharePoint CSOM. Project Online проверки подлинности будет работать с OAuth с помощью Windows Live ID, а не Project проверки подлинности или Windows проверки подлинности.
  
Ниже представлены принципы и функции CSOM в Project Server 2013:
  
- Модель CSOM разработана для простоты использования. Например, методы и свойства непосредственно используют или предоставляют данные по имени, а не требуют многих GUID-интерфейсов,  _параметров changeXml_ или передачи наборов данных. 
    
- В модели CSOM Project Server реализуется поднабор функциональности PSI, основанный на наиболее общих требованиях для сторонних решений.
    
- CSOM выполняет внутренние вызовы PSI, но сформирован по-другому. Например, обновления всех изменений отчетов о состоянии осуществляются с помощью метода **StatusAssignmentCollection.SubmitAllStatusUpdates**, а не с помощью метода PSI **Statusing.SubmitStatus** для пользователя или метода **SubmitStatusForResource** для других ресурсов. 
    
- Модель CSOM доступна через одну службу WCF (Client.svc), а не через 22 общедоступные службы PSI.
    
- Инициализация CSOM Project сервера непосредственно через класс [ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx) с URL-адресом Project Web App, а не с помощью ссылки или прокси-сборки WCF. 
    
- В CSOM реализовано несколько клиентских библиотек и интерфейсов, которые поддерживаются внутренней инфраструктурой CSOM SharePoint. В число клиентских библиотек и интерфейсов входят следующие:
    
  - Клиентская библиотека Microsoft .NET в сборке Microsoft.ProjectServer.Client.dll.
    
  - Библиотека Silverlight в сборке Microsoft.ProjectServer.Client.Silverlight.dll
    
  - Библиотека Windows Phone 8 в сборке Microsoft.ProjectServer.Client.Phone.dll.
    
  - Библиотека JavaScript для веб-приложений в PS.js или PS.debug.js файле
    
  - Конечные точки REST для доступа с помощью протокола OData.
    
  - Встроенная поддержка для запросов LINQ с фильтрацией, чтобы ограничивать объем возвращаемых данных.
    
- CSOM можно использовать как для Project Online, так и для локального решения независимо от сборки PSI и других Project Server, таких как Microsoft.Office.Project.Server.Library.dll.
    
- Дополнительные функции CSOM Project Server 2013 могут быть рассмотрены для накопительных обновлений и пакетов служб на основе запросов партнеров Project Server и сообщества разработчиков.
    
> [!NOTE]
> CSOM является предпочтительным интерфейсом для сторонних разработчиков Project Server. Мы рекомендуем использовать CSOM для разработки новых приложений, если CSOM содержит функциональность, которая требуется приложению. 
  
Сведения о разработке с CSOM см. в примере клиентской объектной модели [(CSOM) за Project 2013 г.](client-side-object-model-csom-for-project-2013.md) Сведения об интерфейсе REST в SharePoint приложениях см. в SharePoint *службы REST* в документации разработчика SharePoint 2013 г. 
  
### <a name="changes-in-the-reporting-database"></a>Изменения в базе данных отчетов
<a name="pj15_WhatsNew_RDBChanges"> </a>

Четыре базы данных в Project Server 2010 объединены в одну базу данных Project в Project Server 2013. Имя базы данных Project по умолчанию — ProjectService. Таблицы и представления отчетов сохраняют свои прежние имена, а таблицы и представления из баз данных Draft, Published и Archive имеют префиксы и в базе  `draft`  `pub` данных  `ver` ProjectService. Например, таблица опубликованных отчетов имеет имя pub.MSP_PROJECTS. 
  
> [!IMPORTANT]
> Прямой доступ не поддерживается для черновика `draft` (префикса), опубликованных () и `pub` архивных `ver` () таблиц и представлений. Отчеты должны использовать только таблицы отчетов и представления, которые имеют `dbo` префикс. Например, dbo. MSP_EpmProject содержит список проектов в экземпляре Project Web App. 
>
> Не предусмотрено никаких средств активного предупреждения прямого программного доступа к базам данных для обновления данных в таблицах и представлениях базы данных Project. Следует иметь в виду, что кэш в Project профессиональный, таблицы черновиков и опубликованных данных, а также таблицы отчетов, зависят от протокола синхронизации кэша, который может быть нарушен в результате прямого редактирования данных. Если базы данных Project Server или клиентские кэши Project профессиональный повреждены в результате прямого доступа для изменения данных, необходимо знать, что служба технической поддержки продукта не сможет помочь! 
  
Project Server 2013 представляет службу OData для доступа к интернету и локальному доступу. Облачные таблицы и представления отчетов доступны только через интерфейс OData; для локального использования можно применять интерфейс OData или прямой доступ к таблицам и представлениям отчетов в базе данных ProjectService в ферме SharePoint. Project Online не поддерживает многоступенчатую базу данных. То есть несколько экземпляров Project Web App имеют собственную Project базы данных. Служба OData внутренне запускает запросы SQL для таблиц и представлений отчетов, а затем предоставляет данные XML или JSON. Введение в службу OData для отчетов в Project Server 2013 и ссылку на схему **ProjectData** см. в справке [projectData - Project службы OData.](https://msdn.microsoft.com/library/office/jj163015.aspx)
  
Общие сведения о запросах OData см. в [oData: URI conventions.](https://www.odata.org/documentation/) Например, все проекты можно увидеть в локальном экземпляре Project Web App, где имя проекта начинается с "Test", используя следующий запрос в браузере. Щелкните правой кнопкой мыши на странице браузера, а затем выберите пункт **Просмотр HTML-кода**.
  
```html
https://ServerName /ProjectServerName /_api/ProjectData/Projects?$filter=startswith(ProjectName, 'Test') eq true
```

Чтобы импортировать данные проекта PowerPivot в Excel 2013 г., на ленте ДАННЫХ выберите из канала данных **OData** в выпадаемом меню From **Other Sources.** В **диалоговом** окне Мастер подключения к данным введите расположение канала данных, выберите Далее, а затем выберите таблицу Проекты на странице https://ServerName/ProjectServerName/_api/ProjectData/ **Выберите таблицы** мастера.   Присвойте имя и сохраните ODC-файл, а затем нажмите кнопку **Готово**. В диалоговом окне **Импорт данных** выберите пункт **Отчет сводной таблицы**. На листе Excel выберите поля для строк и столбцов сводной таблицы, которые следует отобразить.
  
Пользователи локального Project Server, у которых есть правильные разрешения, могут напрямую получать доступ к таблицам отчетов и представлениям через Microsoft SQL Server для создания отчетов, как это Project Server 2010. В Project Server 2013 пользователи также могут получать доступ к таблицам отчетности на локальной основе с помощью интерфейса OData. Можно запросить данные Project Server из облачной или локальной установки через конечные точки REST для службы OData. Например, таблица dbo.MSP_PROJECT и представление dbo.MSP_EpmProject_UserView могут использоваться для отчетов. Все таблицы или представления, которые имеют префикс , или префикс, используются только Project Server и не `draft` `pub` используются для `ver` отчетов. Например, таблица draft.MSP_TASKS и представление pub.MSP_PROJECTS_WORKING_VIEW не задокументированы и предназначены только для внутреннего использования. 
  
> [!NOTE]
> Можно расширить локальные средства составления отчетов, добавив таблицы, представления, поля и хранимые процедуры в отдельную базу данных. Не следует изменять существующие таблицы и представления отчетов в базе данных Project Server. 
  
Таблицы отчетов, представления и поля в базе данных Project будут задокументированы в файле HTML Справка в более позднем обновлении Project 2013 года загрузки SDK. Документация по схеме XML OData для **службы ProjectData** см. в справке [ProjectData - Project службы OData.](https://msdn.microsoft.com/library/office/jj163015.aspx) Запросы таблиц отчетов и представлений, созданных для Project Server 2010, в большинстве случаев будут работать с базой данных Project в Project Server 2013. Локальные пользователи могут получать доступ к кубам OLAP Project Server в службах SQL Server Analysis Services, как они делают это сейчас. В Project Online куба OLAP недоступны.
  
### <a name="task-pane-add-ins-in-project"></a>Надстройки области задач в Project
<a name="pj15_WhatsNew_Agave"> </a>

Как Project стандартный 2013, так и Project профессиональный 2013 г. поддерживают надстройки области задач, которые можно использовать для интеграции и отображения внешнего контента на веб-странице. В области задач показан контент веб-страницы, который имеет доступ через JavaScript к задачам, ресурсам, представлениям и общим данным проекта. Объектная модель JavaScript для Project может получать сведения о выбранной задаче или ресурсе, а также получать данные в выбранной ячейке в сетке для представлений, таких как диаграмма Gantt. Надстройки области задач для Project также могут реализовать обработчики событий для измененных событий, измененных в области задач, ресурсов или просмотра. 
  
На рисунке 2 показана надстройка области задач **Hello ProjectData,** которая запрашивает службу **ProjectData,** а затем сравнивает данные в текущем проекте со средними значениями для всех проектов. Загрузка Project 2013 года включает полный исходный код надстройки. 
  
**Рис. 2. Надстройка области задач в Project профессиональный доступ к данным в Project Server**

![Сравнение текущего проекта со всеми проектами](media/pj15_RestQueryApp_CompareProject.gif "Сравнение текущего проекта со всеми проектами")
  
> [!NOTE]
> Project стандартный 2013 г. не может напрямую интегрироваться с Project Server 2013 через надстройки области задач. 
  
Надстройки области задач в Project профессиональный могут поддерживать веб-части, которые построены для Project Server 2013, поэтому разработчики могут создавать расширение после того, как будет работать с Project Web App и Project профессиональный. Надстройки общей области задач, разработанные для других продуктов Office 2013 г., также можно использовать с Project стандартный 2013 г. и Project профессиональный 2013 г. Дополнительные сведения см. в [добавлении области](task-pane-add-ins-for-project.md)задач для Project.
  
### <a name="project-server-event-receivers"></a>Приемники событий Project Server
<a name="pj15_WhatsNew_Events"> </a>

Может быть несколько Project Web App серверов (также называемых веб-серверами переднего или WFEs) в ферме SharePoint, которая включает Project service Application. Приемники событий могут также называться обработчиками событий. Локальные обработчики событий можно реализовать с помощью кода полного доверия и развернуть на всех серверах WFE для локальной установки Project Server. Удаленные приемники событий можно реализовать в веб-службах на локальных или удаленных серверах и организовать к ним доступ нескольких серверов WFE и нескольких установок Project Server. Project Online могут использовать только удаленные приемники событий.
  
Project Обработчики событий сервера управляются SharePoint для каждого экземпляра Project Web App, а не определенной Project Web App Параметры страницей. В приложении SharePoint центра администрирования выберите общее приложение **Параметры,** выберите Управление под **PWA Параметры,** а затем выберите экземпляр в списке Project Web App  **экземпляра** на странице PWA Параметры. Чтобы добавить локальный обработчик событий или удаленный приемник событий, выберите **Обработчики событий на сервере**.
  
Для локальной установки Project Server можно создать удаленный приемник событий в качестве функции SharePoint, использующей класс [Microsoft.ProjectServer.Client.EventHandlerCreationInformation](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM, а затем программным образом управлять приемником событий с помощью методов в классе [EventHandlerCollection.](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCollection.aspx) Для удаленных приемников событий, предварительные события синхронны, последующие события асинхронны, а также имеется пороговое время ожидания для случаев, когда удаленный приемник событий не возвращает данные. 
  
> [!NOTE]
> Центр администрирования SharePoint доступен только для локальных установок. Для Project Online и SharePoint Online можно добавить или удалить приемники удаленных событий с помощью пакета приложений на основе CSOM. 
  
На странице Обработчики событий на стороне сервера процесс добавления локального обработчика событий для локальной установки Project Server почти такой же, как и процесс, описанный в обработчике событий [Project Server,](https://msdn.microsoft.com/library/gg615466.aspx) и журнал события для Project Server 2010. Разница в том, что на странице Обработник событий есть дополнительные параметры. Например, выберите **Project создание** в списке **Событий,** а затем выберите **ОБработник СОБЫТИЙ NEW**. На странице Обработник нового события только два необходимых поля : **Name** и **Order** (см. рис. 3). Если вы добавляете локальный обработник событий полного доверия, добавьте поле **Имя** сборки и поле **Имя класса;** оставьте **URL-адрес конечной точки** пустым. Если вы добавляете удаленный приемник событий, добавьте **URL-адрес конечной** точки и оставьте имя сборки **и** **имя класса** пустыми. 
  
> [!CAUTION]
> Если указать *имя* сборки или имя класса, а также URL-адрес конечной точки, Project Server вызывает только локальный обработник событий. Удаленный приемник событий игнорируется. 
> 
> Если создать два обработчика событий для одного события, когда один обработчик событий является локальным, а другой является удаленным приемником событий, при этом значение поля **Порядок** одинаково, Project Server игнорирует удаленный приемник событий. 
  
**Рис. 3. Добавление локального обработчика событий или удаленного приемника событий**

![Настройка обработчика событий или приемника событий](media/pj15_EventHandlers_NewEventHandler.gif "Настройка обработчика событий или приемника событий")
    
Если требуется доступ к набору данных PSI для локального обработца событий, можно скопировать сборку Microsoft.Office.Project.Schema.dll из [Windows]\Microsoft.NET\assembly\GAC \_ MSIL\Microsoft.Office. Project. Каталог Schema\v4.0_15.0.0.0_71e9bce11e9429c. 

Вместо PSI мы рекомендуем использовать классы событий в пространстве имен **Microsoft.ProjectServer.Client**; разработка с применением CSOM не требует манипуляции с наборами данных. Чтобы разработать удаленные приемники событий для Project Online, необходимо использовать класс Event и [класс EventHandlerCreationInformation](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM. [](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.Event.aspx) 
  
Перед развертыванием обработчика событий Project Server, установите и тщательно протестируйте этот обработчик событий на тестовой установке Project Server. Для локальной установки Project Server, если локальный обработчик событий, который вы добавляете, становится неоперативным, служба событий Project Server 2013 не загружает другие допустимые обработчики пользовательских событий. В этом случае необходимо удалить неисправный обработчик событий и перезапустить службу событий.
  
> [!NOTE]
> Для локальной установки Project Server мы рекомендуем перейти на удаленные приемники событий, используя CSOM для разработки приемников событий. Так как удаленные приемники событий не содержат стороннего кода, выполняющегося в службе событий Project Server, удаленные приемники событий более стабильны. Локальные администраторы освобождаются от поддержки службы событий Project Server. 
  
Общие сведения о событиях см. в сведениях [Об обработке событий в приложениях для SharePoint.](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx) 
  
## <a name="deprecated-features"></a>Устаревшие компоненты
<a name="pj15_WhatsNew_Deprecated"> </a>

> [!NOTE]
> Сведения о функций и API, которые не представлены или удалены в Project Server 2016 Preview, см. в Project Server 2016 [Preview.](https://docs.microsoft.com/project/what-s-deprecated-or-removed-in-project-server-2016) 
  
В 2013 г. для некоторых решений по-прежнему доступны Project, но не следует использовать для новой разработки. Большинство следующих функций и методов не работают с Project Online или с локальной установкой Project Server 2013 в режиме SharePoint разрешений. Существующие решения, которые используют эти функции, могут не работать для обновления Project Server 2010 Project Server 2013. Несмотря на то, что решения, которые используют неподготовленные функции, в некоторых случаях могут продолжать работать, они не полностью поддерживаются для всех установок Project 2013 г.
  
Если в ваших решениях используются устаревшие компоненты, перед развертыванием таких решений их следует тщательно протестировать и по возможности изменить для использования поддерживаемых компонентов. Сведения о настройке локальной безопасности Project Server 2013 для режима разрешений Project см. в разделе режим разрешения *SharePoint* в разделе Что нового для ИТ-специалистов в [Project Server 2013](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016).
  
- **Сценарии** [расширения PSI](https://docs.microsoft.com/previous-versions/office/developer/office-2010/ff843378(v=office.14)) расширений расширения расширений не будут поддерживаться в будущих выпусках. Эти собственные сценарии Project Server 2013 позволили интеграции с помощью пользовательских служб Windows Communication Foundation (WCF). 
  
- **Project PSI** Класс [Project](https://docs.microsoft.com/office/client-developer/project/project-psi-reference-overview) PSI обесценяется. Для всех новых разработок используйте [Project CSOM](client-side-object-model-csom-for-project-2013.md). Project Приложения Server 2013, которые используют Project PSI, будут продолжать работать, но Project Online приложениям потребуется заменить все методы PSI Project класса их эквивалентными методами CSOM.
  
- **PSI плана ресурсов** PSI [плана ресурсов](https://docs.microsoft.com/previous-versions/office/project-class/gg240019(v=office.15)) не является предопреставленным. Он будет по-прежнему поддерживаться для Project 2013 года, но не будет поддерживаться в будущих выпусках. 
  
- **Интерфейс ASMX для PSI** PSI включает дублирующиеся интерфейсы для разработки локального Project серверов. Интерфейс веб-служб ASMX был представлен с первой реализацией PSI в Office Project Server 2007. Project Сервер 2010 добавил интерфейс служб WCF, где объектная модель по сути дублирует веб-службы ASMX. Хотя Project Server 2013 продолжает поддерживать как ASMX, так и WCF, новые решения, которые требуют PSI, должны использовать службы WCF. Если возможно, новые решения должны быть написаны с применением CSOM. 
  
  Веб-службы ASMX PSI обесценяются в Project Server 2013. Для работы в последующих версиях Project Server решения, использующие веб-службы ASMX, должны быть переписаны с применением либо служб WCF, либо CSOM. Дополнительные сведения см. в разделе Обновление приложений с Project *API* сервера в [Project Server programmability.](project-server-programmability.md)
  
- **Поставщик ссылок на объекты (OLP)** В предыдущих версиях Project Server служба **ObjectLinkProvider** в PSI (см. [webSvcObjectLinkProvider](https://docs.microsoft.com/previous-versions/office/ms481347(v=office.14)) предоставляет способ управления веб-объектами связи между задачами корпоративных проектов и специализированными SharePoint списками на сайте проекта для проблем, рисков, доставки и документов. В Project Server 2013 OLP отстает. 
  
  Вы можете использовать класс **[RelatedItemManager](https://docs.microsoft.com/previous-versions/office/sharepoint-server/jj168020(v=office.15))** в SharePoint CSOM для создания, чтения и удаления ссылок веб-объектов между элементами в списке задач и другими списками на сайте проекта. Например, чтобы добавить ссылку из элемента задачи в проблему, можно использовать метод **[AddSingleLink](https://docs.microsoft.com/previous-versions/office/sharepoint-server/jj166451(v=office.15))** или один из двух аналогичных **методов, AddSingleLinkFromUrl** или **AddSingleLinkToUrl**. Класс **RelatedItemManager** также содержит методы для удаления ссылки на веб-объект и чтения связанных элементов. Для эквивалентного класса в JSOM (объектной модели JavaScript) [см. в примере SP. Объект RelatedItemManager (sp.js)](https://docs.microsoft.com/previous-versions/office/sharepoint-visio/jj838582(v=office.15)).
  
  Рекомендуется использовать SharePoint CSOM для создания приложений типа OLP для локальной установки Project Server 2013 и для Project Online. Пространство [имен Microsoft.SharePoint](https://docs.microsoft.com/previous-versions/office/sharepoint-server/ms464984(v=office.15)) не включает **класс RelatedItemManager** **** . 
  
- **Настраиваемые разрешения** Пользовательские разрешения безопасности для доступа к определенным функциям Project Server или расширениям поддерживались в Office Project Server 2007, где статья SDK объясняла, как их создать, непосредственно изменяя опубликованную базу данных. В Project Server 2010 пользовательские разрешения по-прежнему работают, но не работают. В Project Server 2013 пользовательские разрешения не работают с режимом SharePoint разрешений для локальной установки. Для режима разрешений Project настраиваемые разрешения поддерживаются. При Project Online прямой доступ к базе данных невозможен. 
  
- **Impersonation** В Project Server 2013 использование в приложениях на основе PSI, где пользователь приложения может принимать разрешения на безопасность другого пользователя Project Server. Как указывалось ранее, в локальной установке Project Server 2013 используется режим SharePoint разрешения, который не позволяет выдать себя за Project группы безопасности сервера. Дополнительные сведения см. в ок. Проверка подлинности, авторизация и [безопасность SharePoint 2013 г.](https://docs.microsoft.com/sharepoint/dev/general-development/authentication-authorization-and-security-in-sharepoint)
  
  Приложения с статусом — это типичные расширения, которые могли использовать обезличение в предыдущих версиях Project Server. Project Сервер 2010 представил метод **ReadStatusForResource** и метод **SubmitStatusForResource** в PSI, а также глобальное разрешение **StatusBrokerPermission,** которое устраняет необходимость в выдавливаемом имени для чтения и обновления состояния от имени другого пользователя. CSOM Project Server 2013 использует основе PSI, чтобы прозрачно включить расширения состояния, и может использоваться для Project Online или локальной установки. 
  
- **Расширение базы данных отчетов** Добавление пользовательских таблиц и представлений в базу данных отчетов — это распространенная практика с предыдущими версиями Project Server. Поскольку Project Server 2013 объединяет четыре базы данных предыдущих версий в одну базу данных, обновления не передают настраиваемые таблицы, представления или SPROCs в таблицы отчетов в базе данных Project Server 2013. 
  
  Рекомендуется использовать SQL Azure или отдельную базу данных SQL Server для настраиваемой таблицы отчетов и представлений, где можно управлять резервными копиями и обновлениями баз данных. Для Project Online это необходимо.
  
- **Отчеты** Локальные таблицы отчетов и представления в базе данных Project Server  и кубицы OLAP не обесценились и остаются полностью поддерживаемы. Однако таблицы и представления отчетов (база данных отчетов в предыдущих версиях Project Server) недоступны в Project Online. Кроме того, куби OLAP доступны только с локальной установкой Project Server 2013. Для отчетов о приложениях с Project Online можно использовать службу **ProjectData** с помощью запросов REST с протоколом OData. 
  
- **Project Руководство** Руководство Project является стандартной функцией в настольных приложениях Office Project 2007 г., где контент HTML и JavaScript в области задач предоставляет интерактивные рекомендации по созданию и управлению проектами. В Project 2010 г. руководство по Project не доступно в установке по умолчанию, но может быть включено через VBA или VSTO надстройки. Загрузка Project SDK 2010 включает в себя измененные Project руководства. 
  
  Объектная модель VBA и **Microsoft.Office. Объектная модель Interop.MSProject** в Project 2013 г. по-прежнему включает 22 члена класса Application и **Project** класса, которые могут управлять Project Guide.  Однако Project 2013 г. приложения области задач могут конфликтовать с действиями в области задач Project Guide, а содержимое руководства Project не может быть легко распространено или продано в Office Store. Настоятельно рекомендуем разрабатывать решения Project задач с помощью Office надстройок, а не настраиваемого Project руководства. Дополнительные сведения о руководстве Project см. в [Project документации SDK 2010](https://msdn.microsoft.com/library/ms512767.aspx)г.
  
## <a name="comparing-project-server-on-premises-with-project-online"></a>Сравнение локального Project Server с Project Online
<a name="pj15_WhatsNew_Comparing"> </a>

Чтобы помочь вам решить, следует ли использовать локальное Project Server или Project Online, и какие расширения можно разрабатывать в любом случае, в таблице 2 сравнивают дополнительные возможности локальной установки Project Server 2013 с Project Online. В таблице 2 не содержатся различия в развертывании, администрировании или использовании. Дополнительные сведения о Project Online и Project Server 2013 см. в Project [2013](https://developer.microsoft.com/project/docs) для [разработчиков и Project Online.](https://developer.microsoft.com/project)
  
**Таблица 2. Доступность локального Project Server и Project Online**

| Функция |Project Локальное серверное | Project Online |
|:-----|:-----|:-----|
|**Программируемость** <br/> |приложения на основе CSOM; последовательная модель программирования  <br/>- Клиентские библиотеки .NET, Silverlight, Windows Phone клиентские библиотеки  <br/>- Библиотека JavaScript для пользовательских страниц, веб-части и расширений ленты  <br/>- Протоколы OData и REST<br/><br/> приложения на основе PSI; сложная модель программирования также может создавать приложения для администрирования, анализа портфеля, уведомлений, Project режима, системы очередей и других областей.<br/><br/>Расширения PSI  <br/><br/>Настраиваемые разрешения с Project режима (неподготовленные)  <br/><br/>Impersonation with the PSI (deprecated)  <br/><br/>Код полного доверия; установка расширений в SharePoint ферме  <br/> |приложения на основе CSOM; последовательная модель программирования  <br/>- Клиентские библиотеки .NET, Silverlight, Windows Phone клиентские библиотеки<br/>- Библиотека JavaScript для пользовательских страниц, веб-части и расширений ленты<br/>- Протоколы OData и REST<br/><br/>Может использовать PSI, но не поддерживается: нет подключений OAuth и подключений к службе<br/><br/>Нет расширений API CSOM<br/><br/>Нет пользовательских разрешений<br/><br/>Без вымысления<br/><br/>Нет кода полного доверия  <br/> |
|**Настраиваемые базы данных** <br/> |- SQL Azure  <br/>- SQL Server (изменение таблиц отчетов и представлений в базе данных Project Server не поддерживается)  <br/> |- SQL Azure  <br/>- SQL Server (изменение таблиц отчетов и представлений в базе данных Project Server не поддерживается)  <br/> |
|**Создание отчетов** <br/> |- **Служба ProjectData;** OData и REST protocols  <br/>- Таблицы отчетов и представления в базе данных Project Server<br/>- база данных OLAP  <br/> |- **Служба ProjectData;** OData и REST protocols  <br/> |
|**обработчики событий.** <br/> |- Удаленные приемники событий, доступные с помощью конечных точек WCF<br/>- Обработчики событий с полным доверием, установленные в SharePoint ферме  <br/> | - Удаленные приемники событий, доступные с помощью конечных точек WCF  <br/> |
|**Рабочие процессы** <br/> |Декларативные процессы, созданные с SharePoint Designer 2013<br/>- Использование только в определенном экземпляре Project Web App<br/>- Может импортировать проект рабочего процесса из Visio 2013 г.<br/>- Может импортировать и использовать настраиваемые действия<br/><br/> Декларативные процессы, созданные с Visual Studio 2012 г.<br/>- Создание приложения, которое может включать рабочие процессы<br/>- Создание пакета SharePoint (WSP), который может включать рабочие процессы<br/>- Создание шаблонов рабочих процессов для повторного использования<br/>- Создание и использование настраиваемого действия  <br/><br/>Можно использовать устаревшие компилировать процессы, созданные с помощью WF3.5 (рекомендуется обновить до декларативного рабочего процесса WF4)  <br/> |Декларативные процессы, созданные с SharePoint Designer 2013<br/>- Использование только в определенном экземпляре Project Web App<br/>- Может импортировать проект рабочего процесса из Visio 2013 г.<br/>- Может импортировать и использовать настраиваемые действия  <br/><br/>Декларативные процессы, созданные с Visual Studio 2012 г.<br/>- Создание приложения, которое может включать рабочие процессы  <br/>- Создание пакета SharePoint (WSP), который может включать рабочие процессы<br/>- Создание шаблонов рабочих процессов для повторного использования <br/>- Создание и использование настраиваемого действия  <br/> |
|**Распределение** <br/> |- Office Store (для приложений на основе CSOM)<br/>- Частный каталог приложений на SharePoint<br/>- Доля файлов Intranet  <br/> |- Office Store<br/>- Частный каталог приложений на SharePoint  <br/> |

   
## <a name="conclusion"></a>Заключение
<a name="pj15_WhatsNew_Conclusion"> </a>

Project Сервер 2013 предоставляет множество новых возможностей и сценариев разработки, которые партнеры и клиенты могут использовать для адаптации и расширения возможностей и полезности Project Server на крупных предприятиях и в небольших организациях. Вы можете использовать инфраструктуру Office 2013 и SharePoint 2013 для создания и распространения приложений для Project 2013 г., которые могут значительно расширить доступность и использование настраиваемого приложения. В Project 2013 г. некоторые функции и практики предыдущих версий, в частности веб-службы ASMX PSI и функции, которые включают в себя обезличение или прямые изменения базы данных, которые нельзя использовать с Project Online.
  
Внедрение CSOM позволяет программным Project Online для широкого спектра устройств и с помощью JavaScript в веб-приложениях. CSOM обеспечивает более согласованную модель программирования по сравнению с PSI. Project Серверные данные можно получить гораздо больше способов, чем в предыдущих версиях, в том числе через онлайн-службу OData и конечные точки REST для представления данных в Project базе данных. Существующие отчеты по-прежнему работают таким же образом для локального использования; новые отчеты имеют больше гибкости.
  
Office Надстройки предоставляют новые возможности для продажи решений и интеграции Project стандартный 2013 г. с веб-контентом и другими продуктами Office 2013 г. Вы также можете создать новые способы интеграции Project профессиональный 2013 с данными Project Server и списками SharePoint через области задач Office надстройки.
  
Дополнительные сведения о разработке приложений и использовании функций программируемости и CSOM SharePoint Server [](https://docs.microsoft.com/sharepoint/dev/) 2013 см. в SharePoint для разработчиков и Office [для](https://developer.microsoft.com/office/docs)разработчиков.
  
## <a name="see-also"></a>Дополнительные ресурсы

- [Архитектура Project Server 2013](project-server-2013-architecture.md)  
- [Задачи программирования Project](project-programming-tasks.md) 
- [Клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md) 
- [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/library/office/jj163015.aspx)  
- [Надстройки области задач для Project](task-pane-add-ins-for-project.md)   
- [OData: конвенции URI](https://www.odata.org/documentation/uri-conventions#FilterSystemQueryOption)    
- [SharePoint для разработчиков](https://msdn.microsoft.com/sharepoint)    
- [Office для разработчиков](https://msdn.microsoft.com/office)   
- [Обработка событий в приложениях для SharePoint](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx)   
- [AppSource](https://appsource.microsoft.com/marketplace/apps?product=office)   
- [Project Online](https://developer.microsoft.com/project)
    


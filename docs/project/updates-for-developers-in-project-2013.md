---
title: Обновления для разработчиков в Project
manager: lindalu
ms.date: 12/03/2019
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5b2b22cd-6e28-43a8-9092-b411da8bfb53
description: Новые возможности включают клиентскую объектную модель (CSOM), интерфейсы REST, службу OData для отчетов, удаленные приемники событий, декларативные бизнес-процессы и надстройки области задач для клиентов Project.
ms.openlocfilehash: c2bc0b475639a8582422b2091169116428367c60
ms.sourcegitcommit: 37080eb0087261320e24e6f067e5f434a812b2d2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "39819282"
---
# <a name="updates-for-developers-in-project"></a>Обновления для разработчиков в Project

Функции extensibility в Project Server 2013 работают с надстройки для Project Online и с локальной установкой. Новые возможности включают клиентскую объектную модель (CSOM), интерфейсы REST, службу OData для отчетов, удаленные приемники событий, декларативные бизнес-процессы и надстройки области задач для клиентов Project. Также изучите неподготовленные функции, которые не следует использовать для новой разработки.
  
Project Server 2013 строится на основе структуры, которая была представлена в Microsoft Office Project Server 2007 и расширена в Project Server 2010. Project Server 2013 добавляет клиентскую объектную модель (CSOM), которая рефакторингуется и упрощается из интерфейса Project Server (PSI), а также включает библиотеку JavaScript и .NET Framework 4 для приложений для Windows, Windows Phone 8 и Microsoft Silverlight. CSOM предназначена для разработки для Project Online, а также работает с локальной установкой Project Server. 

Базы данных Project Server объединяются в одну базу данных; вы можете получить доступ к таблицам и представлениям отчетов в Интернете через службу OData. CSOM и служба OData включают интерфейс REST. Процессы Project Server можно создавать с помощью SharePoint Designer 2013. Project профессиональный 2013 может интегрироваться с данными отчетов Project Server, списками задач SharePoint и другим внешним контентом с помощью модели добавок Надстройки Office для области задач. Project стандартный 2013 может использовать надстройки области задач для интеграции с общим внешним содержимым.
  
Схемы и дополнительные сведения о существенных изменениях в Project Server 2013 см. в архитектуре [Project Server 2013.](project-server-2013-architecture.md)
  
> [!NOTE]
> Project Server 2013 создан на основе платформы SharePoint Server 2013, и большая часть инфраструктуры Project 2013 ничем не отличается от других приложений Office 2013. Документация по модели надстройки SharePoint, основанные на SharePoint процессы, веб-части, разработка с другими функциями SharePoint и документация по надстройки Office см. в обзоре надстройки [SharePoint,](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins)Надстройки [Office](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)и [SharePoint 2013](https://msdn.microsoft.com/library/jj164084%28office.15%29.aspx). 
  
## <a name="major-new-features-in-project-2013"></a>Основные новые компоненты в Project 2013
<a name="pj15_WhatsNew_MajorNewFeatures"> </a>

Новые функции Project Стандартный 2013 и Project профессиональный 2013 включают улучшенный пользовательский интерфейс, который соответствует другим приложениям Office 2013 и поддерживает современный пользовательский интерфейс в Windows 8, интеграцию с объектами Office Art для отчетов, отчеты об записях и новые функции программируемости для отчетов. Project профессиональный 2013 обеспечивает более широкий общий доступ и синхронизацию проектов в SharePoint Server 2013, а также надстройки области задач, которые также реализованы в других приложениях Office 2013, таких как Word, Excel и Outlook.
  
В Project Server 2013 имеется множество новых функций. Некоторые из них не имеют основной программируемости, например новая временная шкала в Project Web App. Эти компоненты будут задокументированы в справке продукта и в документации для конечных пользователей на веб-сайте Microsoft Office Online, а также в статьях, предназначенных для администраторов и ИТ-специалистов, на портале Microsoft TechNet. Другие новые компоненты, такие как улучшенные расписания, упрощают сторонним разработчикам взаимодействие с расписаниями и получение информации о состоянии через интерфейс Project Server (PSI).
  
Добавление Project Online и Магазина Office ( для надстройки Project — это далеко и те же изменения, в которых Project Server доступен через https://office.microsoft.com/store) Microsoft Azure. Облачный доступ к Project Server использует клиентскую объектную модель (CSOM) для разработки надстройки с помощью Microsoft .NET Framework, Microsoft Silverlight, Windows Phone и веб-приложений, которые используют JavaScript. Для Project Online необходимо объединить четыре базы данных Project Server предыдущих версий в одну базу данных.
  
Производительность и масштабируемость Project Server 2013 улучшены во многих областях, таких как состояние задач, таблицы и управление проектами. Процессы Project Server переработаны с помощью версии 4 Windows Workflow Foundation (WF4). Использование .NET Framework 4 и Windows Communication Foundation (WCF) с PSI повышает безопасность, производительность и масштабируемость. Например, можно изменить протокол транспорта приложений, основанных на WCF, с помощью файлов конфигурации, не изменяя код приложения и не проводя перекомпилирование. Project Web App кэшет многих вызовов PSI, в которых данные не изменяются значительно.
  
> [!NOTE]
> Для разработки с помощью Project Server 2013 можно использовать Visual Studio с расширениями инструментов Office и SharePoint, которые могут создавать надстройки для продуктов Office 2013. Project Server 2013 требует Visual Studio для полной разработки таких функций, как страницы с подробными данными о проекте и приложения на основе WCF. Расширения средств SharePoint в Visual Studio могут развертывать веб-части и другие функции SharePoint непосредственно на Project Web App и других сайтах SharePoint. 
>
> Visual Studio больше не требуется для разработки бизнес-процессов Project Server, которые используют настраиваемые поля, стадии, этапы и типы корпоративных проектов, которыми можно управлять в Project Web App. Хотя вы можете использовать Visual Studio для разработки рабочих процессов, их часто проще и быстрее создавать с помощью SharePoint Designer. Visual Studio можно использовать для рабочих процессов, требующих доступа к модели CSOM или другим внешним API. 
  
### <a name="project-add-ins"></a>Надстройки Project
<a name="pj15_WhatsNew_Apps"> </a>

Распространение и маркетинг программного обеспечения были переумышлена с помощью концепции надстройки. В Project 2013 надстройки можно приобрести и скачать в общедоступных Магазинах Office или распространять в частном каталоге SharePoint. Как правило, надстройка — это самодостаточная интерактивная программа, которая выполняет небольшое количество связанных задач. Надстройка Project может быть надстройка области задач для клиентов Project Стандартный 2013 или Project Стандартный 2013 или надстройка для Project Server 2013 или Project Online.
  
Сведения о надстройке для классических клиентов Project см. в надстройке области задач [в Project.](#pj15_WhatsNew_Agave) Пример Project Server 2013 см. в примере создания надстройки Project Server, которая находится в [SharePoint.](create-a-sharepoint-hosted-project-server-add-in.md) Помимо статей в SDK надстроек Office и [SharePoint,](https://msdn.microsoft.com/library/fp161507.aspx)в блоге [Office](https://blogs.office.com/dev/) есть множество записей, которые также важны для Project 2013 и Project Online. 
  
Надстройка для Project Server 2013 может работать как с локальной установкой, так и с Project Online. Надстройки Project Server могут включать веб-части, удаленные приемники событий и бизнес-логику. Доступ к объектной модели Project Server в надстройке можно получить с помощью CSOM, а не PSI. Хранилище данных может быть облачным, например с SQL Azure, внешним, например через Microsoft Business Connectivity Services (BCS), внутренним с локальной базой данных или смешанным.
  
#### <a name="add-in-security"></a>Безопасность надстройки

Как правило, действия надстройки выполняются от имени пользователя, который запускает надстройку; вы не используете явное использование поднастояния или не указываете, кто может запускать надстройку. Действия не могут превышать уровень разрешений пользователя, который запускает надстройки. 
  
В office Developer Tools for Visual Studio 2012 файл AppManifext.xml графический редактор, в котором можно настроить область запроса разрешений. Например, чтобы создать надстройку, которая позволяет руководителям проектов  обновлять свои проекты, на вкладке **"Разрешения"** области конструктора AppManifest.xmlвыберите несколько проектов для области и запишите разрешение.  Если у пользователя надстройки есть разрешения руководителя проектов, он может запускать надстройку для проектов, которые он управляет. Код файла AppManifest.xml может содержать следующие команды: 
  
```XML
  <AppPermissionRequests>
    <AppPermissionRequest Scope="https://sharepoint/projectserver/projects" Right="Write" />
  </AppPermissionRequests>
```

**Таблица 1. Области запроса разрешений для надстройки Project Server**

|Область|Permissions|
|:-----|:-----|
|**Project Server** <br/> |**Управление** (Требуются разрешения администратора Project Server.)  <br/> |
|**Несколько проектов** <br/> |**Чтение**, **Запись** (Для некоторых операций требуются разрешения руководителя проекта; для базовых операций чтения, таких как назначения проекта, требуются разрешения члена группы проекта.)  <br/> |
|**Один проект** <br/> |**Чтение**, **Запись** (Требуются разрешения минимум члена группы проекта; доступ к некоторым данным в проекте зависит от других уровней разрешений.)  <br/> |
|**Корпоративные ресурсы** <br/> |**Чтение**, **Запись** (Требуются разрешения руководителя ресурсов.)  <br/> |
|**Statusing** <br/> |**Отправка состояния** (Требуется разрешение на отправку состояния проектов.)  <br/> |
|**Создание отчетов** <br/> |**Чтение** (Требуется разрешение на вход в Project Server.)  <br/> |
|**Рабочий процесс** <br/> |**Повышение прав** (Требуется разрешение на запуск рабочих процессов. Надстройка работает с повышенными разрешениями, что позволяет перейти от стадии к стадии рабочего процесса. Бизнес-логика на этапах элементов управления надстройки.)  <br/> |
   
> [!NOTE]
> Project Server 2013 и Project Online не используют модель проверки подлинности только для приложений в SharePoint 2013 (см. типы политик авторизации надстройки в [SharePoint 2013).](https://msdn.microsoft.com/library/124879c7-a746-4c10-96a7-da76ad5327f0%28Office.15%29.aspx) 
  
Сведения о разработке, распространении, размещении и управлении надстройки см. в надстройки [SharePoint](https://docs.microsoft.com/sharepoint/dev/sp-add-ins/sharepoint-add-ins) и Надстройки [Office,](https://docs.microsoft.com/office/dev/add-ins/overview/office-add-ins)а также в соответствующих темах документации для разработчиков SharePoint Server 2013 и Office 2013. Сведения об области запроса разрешений для других надстройки SharePoint см. в сведениях о разрешениях надстройки [в SharePoint 2013.](https://msdn.microsoft.com/library/5f7a8440-3c09-4cf8-83ec-c236bfa2d6c4%28Office.15%29.aspx)
  
### <a name="integrating-with-sharepoint-server"></a>Интеграция с SharePoint Server
<a name="pj15_WhatsNew_IntegrationWSS"> </a>

Для многих функций Project Web App требуется новая инфраструктура в SharePoint Server 2013, например OAuth и проверка подлинности на основе утверждений, авторизация и разрешения Project Server через группы SharePoint, синхронизация проектов со списками задач SharePoint и декларативные процессы Project Server. Приложение-службу Project можно связать с любым семейством сайтов в ферме SharePoint. Синхронизация Project может осуществляться со списком задач SharePoint, когда SharePoint поддерживает проект. Корпоративный проект можно также синхронизировать со списком задач SharePoint, когда Project Server поддерживает полное управление. Архитектурные схемы и описание синхронизации проектов см. в архитектуре [Project Server 2013.](project-server-2013-architecture.md)
  
В SharePoint Server 2013 имеется множество новых функций. Дополнительные сведения см. в [sharePoint для разработчиков.](https://msdn.microsoft.com/sharepoint)
  
### <a name="integrating-with-workflows"></a>Интеграция с рабочими процессами
<a name="pj15_WhatsNew_Workflow"> </a>

Рабочие процессы являются базовым компонентом в управлении портфелем проектов. Жизненный цикл проекта может включать в себя длительные процессы, проходящие через множество фаз. Фазы управления содержат проектные предложения, анализ влияния на бизнес, а также выбор, создание, планирование, управление и отслеживание проектов.
  
Процессы Project Server 2013 построены на платформе рабочего процесса SharePoint 2013, которая использует WF4. В отличие от предыдущих версий, декларативные процессы для Project Server 2013 можно создавать с помощью SharePoint Designer 2013 и доступны как для локального, так и для интернет-использования. Рабочий процесс Project Server использует модель безопасности рабочего процесса SharePoint с OAuth и может быть установлен на Project Web App сайте. На рисунке 1 показано, что SharePoint Designer 2013 может добавлять стадии в рабочий процесс сайта для управления запросами, где стадии определены в Project Web App.
  
**Рис. 1. Использование SharePoint Designer для добавления стадии в рабочий процесс веб-приложения Project**

![Добавление стадии рабочего процесса в SPD](media/pj15_CreateWorkflowSPD_AddStageInSPD.gif "Добавление стадии рабочего процесса в SPD")

<br/>

Декларативный рабочий процесс создается путем добавления стадий рабочего процесса, действий, условий и других элементов в инструмент разработки, который может быть SharePoint Designer 2013 или Visual Studio 2012. Средство разработки затем сохраняет рабочий процесс в виде XAML-кода, интерпретируемого в среде выполнения. Декларативные процессы могут запускаться в локальной или локальной сети Project Server 2013. С помощью Visual Studio 2012 можно также создавать настраиваемые действия и формы для дополнительного управления и сохранять шаблоны рабочего процесса для повторного использования с несколькими Project Web App экземплярами. SharePoint Designer 2013 может использовать настраиваемые действия, созданные в Visual Studio 2012.
  
Рабочий процесс Project Server 2013 действует как приложение, где администратор с разрешениями на разработку Project Web App может опубликовать декларативный рабочий процесс и связать его с типом корпоративного проекта (EPT). Тип корпоративных проектов должен быть задан для корпоративного проекта, в котором Project Server осуществляет полное управление. Список задач SharePoint не может использовать рабочий процесс Project Server. 
  
Служба OAuth позволяет руководителям проектов, имеющим разрешения на создание проектов, вызвать рабочий процесс без применения олицетворения. Вызовы Project Server рабочим процессом, например для чтения значения настраиваемого поля с целью определения следующего перехода, выполняются от имени руководителя проекта. Чтобы запретить руководителю проекта создавать рабочий процесс, который автоматически переходит на следующую стадию, вызов перехода на следующую стадию запускается от имени автора рабочего процесса (администратора). С другой стороны, пользователи устаревших рабочего процесса Project Server 2010 делают вызовы с помощью учетной записи-посредника рабочего процесса, чтобы получить доступ администратора во всем рабочий процесс.
  
Хотя локальное решение Project Server 2013 может использовать скомпилируемые процессы на основе WF3.5, рекомендуется обновить устаревшие процессы до декларативных на основе WF4. Эта новая технология лучше масштабируется и более надежна. Бизнес-аналитики и сотрудники PMO могут создавать или обновлять макеты рабочих процессов с помощью Visio 2013 и реализовывать рабочие процессы Project Server без написания кода с помощью SharePoint Designer 2013.
  
Сведения о создании декларативного рабочего процесса для Project Web App см. в подпроекте "Начало разработки рабочих [процессов Project Server".](getting-started-developing-project-server-workflows.md) Сравнение возможностей SharePoint Designer и Visual Studio для бизнес-процессов см. в этой [Visual Studio.](https://msdn.microsoft.com/library/office/jj163199.aspx)
  
### <a name="client-side-object-model"></a>Клиентская объектная модель
<a name="pj15_WhatsNew_CSOM"> </a>

Для программного доступа к Project Online требуется CSOM, созданная на основе CSOM SharePoint. Проверка подлинности Project Online будет работать с OAuth с использованием Windows Live ID, а не проверки подлинности Project Server Forms или Windows.
  
Ниже представлены принципы и функции CSOM в Project Server 2013.
  
- Модель CSOM разработана для простоты использования. Например, методы и свойства напрямую используют или предоставляют данные по имени, вместо того чтобы требовать много GUID,  _параметров changeXml_ или передачи наборов данных. 
    
- В модели CSOM Project Server реализуется поднабор функциональности PSI, основанный на наиболее общих требованиях для сторонних решений.
    
- CSOM выполняет внутренние вызовы PSI, но сформирован по-другому. Например, обновления всех изменений отчетов о состоянии осуществляются с помощью метода **StatusAssignmentCollection.SubmitAllStatusUpdates**, а не с помощью метода PSI **Statusing.SubmitStatus** для пользователя или метода **SubmitStatusForResource** для других ресурсов. 
    
- Модель CSOM доступна через одну службу WCF (Client.svc), а не через 22 общедоступные службы PSI.
    
- Инициализация CSOM Project Server непосредственно через класс [ProjectContext](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.ProjectContext.aspx) с URL-адресом Project Web App, а не с помощью ссылки на WCF или сборки прокси. 
    
- В CSOM реализовано несколько клиентских библиотек и интерфейсов, которые поддерживаются внутренней инфраструктурой CSOM SharePoint. В число клиентских библиотек и интерфейсов входят следующие:
    
  - Клиентская библиотека Microsoft .NET в сборке Microsoft.ProjectServer.Client.dll.
    
  - Библиотека Silverlight в сборке Microsoft.ProjectServer.Client.Silverlight.dll
    
  - Библиотека Windows Phone 8 в сборке Microsoft.ProjectServer.Client.Phone.dll.
    
  - Библиотека JavaScript для веб-приложений в PS.js или PS.debug.js файла
    
  - Конечные точки REST для доступа с помощью протокола OData.
    
  - Встроенная поддержка для запросов LINQ с фильтрацией, чтобы ограничивать объем возвращаемых данных.
    
- CSOM можно использовать как для решений Project Online, так и для локального решения независимо от PSI и других сборок Project Server, таких как Microsoft.Office.Project.Server.Library.dll.
    
- Дополнительные функции CSOM Project Server 2013 могут быть рассмотрены для накопительных обновлений и пакетов обновления на основе запросов партнеров Project Server и сообщества разработчиков.
    
> [!NOTE]
> CSOM является предпочтительным интерфейсом для сторонних разработчиков Project Server. Мы рекомендуем использовать CSOM для разработки новых приложений, если CSOM содержит функциональность, которая требуется приложению. 
  
Сведения о разработке с помощью CSOM см. в клиентской объектной модели [(CSOM) для Project 2013.](client-side-object-model-csom-for-project-2013.md) Сведения об интерфейсе REST в приложениях SharePoint см. в документации разработчика SharePoint 2013 по программированию с помощью службы *REST SharePoint.* 
  
### <a name="changes-in-the-reporting-database"></a>Изменения в базе данных отчетов
<a name="pj15_WhatsNew_RDBChanges"> </a>

Четыре базы данных в Project Server 2010 объединяются в одну базу данных Project Server 2013. Имя базы данных Project по умолчанию — ProjectService. Таблицы и представления отчетов сохраняют свои прежние имена, а таблицы и представления из баз данных черновиков, опубликованных и архивных баз данных имеют префиксы и в базе  `draft`  `pub` данных  `ver` ProjectService. Например, таблица опубликованных отчетов имеет имя pub.MSP_PROJECTS. 
  
> [!IMPORTANT]
> Прямой доступ не поддерживается для таблиц и представлений черновиков `draft` (префикс), опубликованных () и `pub` архивных `ver` (). Отчеты должны использовать только таблицы и представления отчетов с `dbo` префиксом. Например, dbo. MSP_EpmProject таблица содержит список проектов в Project Web App экземпляре. 
>
> Не предусмотрено никаких средств активного предупреждения прямого программного доступа к базам данных для обновления данных в таблицах и представлениях базы данных Project. Следует иметь в виду, что кэш в Project профессиональный, таблицы черновиков и опубликованных данных, а также таблицы отчетов, зависят от протокола синхронизации кэша, который может быть нарушен в результате прямого редактирования данных. Если базы данных Project Server или клиентские кэши Project профессиональный повреждены в результате прямого доступа для изменения данных, необходимо знать, что служба технической поддержки продукта не сможет помочь! 
  
Project Server 2013 представляет службу OData для сетевого и локального доступа. Облачные таблицы и представления отчетов доступны только через интерфейс OData; для локального использования можно применять интерфейс OData или прямой доступ к таблицам и представлениям отчетов в базе данных ProjectService в ферме SharePoint. Project Online не поддерживает мультитенантную базу данных. То есть у нескольких экземпляров Project Web App есть собственная база данных Project. Служба OData внутренне запускает запросы SQL для таблиц и представлений отчетов, а затем предоставляет данные XML или JSON. Введение в службу OData для отчетов в Project Server 2013 и справочник по схеме **ProjectData** см. в справочнике по службе [ProjectData](https://msdn.microsoft.com/library/office/jj163015.aspx).
  
Общие сведения о запросах OData см. в [OData: соглашения об URI.](https://www.odata.org/documentation/) Например, вы можете увидеть все проекты в локальном экземпляре Project Web App где имя проекта начинается с "Test" с помощью следующего запроса в браузере. Щелкните правой кнопкой мыши на странице браузера, а затем выберите пункт **Просмотр HTML-кода**.
  
```html
https://ServerName /ProjectServerName /_api/ProjectData/Projects?$filter=startswith(ProjectName, 'Test') eq true
```

Чтобы импортировать данные проекта в PowerPivot Excel 2013, на ленте DATA выберите  "Из веб-канала данных **OData"** в выпадаемом меню "Из других источников". В **диалоговом** окне "Мастер подключения данных" введите расположение канала данных, выберите "Далее", а затем выберите таблицу "Проекты" на странице "Выбор таблиц" https://ServerName/ProjectServerName/_api/ProjectData/ мастера.    Присвойте имя и сохраните ODC-файл, а затем нажмите кнопку **Готово**. В диалоговом окне **Импорт данных** выберите пункт **Отчет сводной таблицы**. На листе Excel выберите поля для строк и столбцов сводной таблицы, которые следует отобразить.
  
Пользователи локального сервера Project Server с правильными разрешениями могут напрямую получать доступ к таблицам и представлениям отчетов через Microsoft SQL Server для создания отчетов, как в Project Server 2010. В Project Server 2013 пользователи также могут получать доступ к таблицам отчетов в локальной сети через интерфейс OData. Можно запросить данные Project Server из облачной или локальной установки через конечные точки REST для службы OData. Например, таблица dbo.MSP_PROJECT и представление dbo.MSP_EpmProject_UserView могут использоваться для отчетов. Все таблицы или представления с префиксом , , или только для внутреннего использования Project Server, и  `draft` не  `pub` для  `ver` отчетов. Например, таблица draft.MSP_TASKS и представление pub.MSP_PROJECTS_WORKING_VIEW не задокументированы и предназначены только для внутреннего использования. 
  
> [!NOTE]
> Можно расширить локальные средства составления отчетов, добавив таблицы, представления, поля и хранимые процедуры в отдельную базу данных. Не следует изменять существующие таблицы и представления отчетов в базе данных Project Server. 
  
Таблицы отчетов, представления и поля в базе данных Project будут задокументированы в HTML-файле справки в более позднем обновлении загружаемого SDK project 2013. Документацию по XML-схеме OData для службы **ProjectData** см. в справочнике по службе [ProjectData.](https://msdn.microsoft.com/library/office/jj163015.aspx) Запросы таблиц и представлений отчетов, созданных для Project Server 2010, в большинстве случаев будут работать с базой данных Project в Project Server 2013. Локальные пользователи могут получать доступ к кубам OLAP Project Server в службах SQL Server Analysis Services, как они делают это сейчас. В Project Online кубы OLAP недоступны.
  
### <a name="task-pane-add-ins-in-project"></a>Надстройки области задач в Project
<a name="pj15_WhatsNew_Agave"> </a>

Project стандартный 2013 и Project профессиональный 2013 поддерживают надстройки области задач, которые можно использовать для интеграции и отображения внешнего контента на веб-странице. В области задач показан контент веб-страницы, который имеет доступ через JavaScript к задачам, ресурсам, представлениям и общим данным проекта. Объектная модель JavaScript для Project может получать сведения о выбранной задаче или ресурсе и получать данные в выбранной ячейке сетки для представлений, таких как диаграмма Гэтта. Надстройки области задач для Project также могут реализовать обработчики событий для событий изменения выбора задачи, ресурса или представления. 
  
На рисунке 2 показана надстройка области задач **Hello ProjectData,** которая запрашивает службу **ProjectData,** а затем сравнивает данные в текущем проекте со средними значениями для всех проектов. Загрузка project 2013 SDK включает полный исходный код для надстройки. 
  
**Рисунок 2. Надстройка области задач в Project профессиональный может получать доступ к данным в Project Server**

![Сравнение текущего проекта со всеми проектами](media/pj15_RestQueryApp_CompareProject.gif "Сравнение текущего проекта со всеми проектами")
  
> [!NOTE]
> Project стандартный 2013 не может напрямую интегрироваться с Project Server 2013 через надстройки области задач. 
  
Надстройки области задач в Project профессиональный могут поддерживать веб-части, построенные для Project Server 2013, поэтому разработчики могут создать расширение, которое работает как с Project Web App, так и с Project professional. Общие надстройки области задач, разработанные для других продуктов Office 2013, также можно использовать с Project Стандартный 2013 и Project профессиональный 2013. Дополнительные сведения [см.](task-pane-add-ins-for-project.md)в надстройке области задач для Project.
  
### <a name="project-server-event-receivers"></a>Приемники событий Project Server
<a name="pj15_WhatsNew_Events"> </a>

В ферме SharePoint, которая включает серверное приложение-службу Project, может быть несколько Project Web App серверов (также называемых веб-серверами переднего уровня или веб-серверами). Приемники событий могут также называться обработчиками событий. Локальные обработчики событий можно реализовать с помощью кода полного доверия и развернуть на всех серверах WFE для локальной установки Project Server. Удаленные приемники событий можно реализовать в веб-службах на локальных или удаленных серверах и организовать к ним доступ нескольких серверов WFE и нескольких установок Project Server. Project Online может использовать только удаленные приемники событий.
  
Обработчики событий Project Server управляются SharePoint для каждого экземпляра Project Web App, а не определенной страницей Project Web App параметров. В приложении центра администрирования SharePoint выберите  "Общие параметры приложения", выберите "Управление в параметрах **PWA",** а затем выберите экземпляр в выпадаемом списке **Project Web App** "Экземпляр" на странице "Параметры PWA". Чтобы добавить локальный обработчик событий или удаленный приемник событий, выберите **Обработчики событий на сервере**.
  
Для локальной установки Project Server можно создать удаленный приемник событий в качестве функции SharePoint, использующей класс [Microsoft.ProjectServer.Client.EventHandlerCreationInformation](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM, а затем программным образом управлять приемником событий с помощью методов в классе [EventHandlerCollection.](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCollection.aspx) Для удаленных приемников событий, предварительные события синхронны, последующие события асинхронны, а также имеется пороговое время ожидания для случаев, когда удаленный приемник событий не возвращает данные. 
  
> [!NOTE]
> Центр администрирования SharePoint доступен только для локальных установок. Для Project Online и SharePoint Online можно добавлять или удалять удаленные приемники событий с помощью пакета приложения на основе CSOM. 
  
На странице "Обработчики событий на стороне сервера" процесс добавления локального обработчиков событий для локальной установки Project Server почти такой же, как процесс, описанный в разделе "Создание обработчиков событий [Project Server"](https://msdn.microsoft.com/library/gg615466.aspx) и записи в журнал раздела о событии для Project Server 2010. Разница заключается в том, что страница "Новый обработок событий" имеет дополнительные параметры. Например, выберите **"Создание проекта"** в списке **"События",** а затем выберите **"НОВЫЙ ОБРАБОТЕЦ СОБЫТИЙ".** На странице "Новый обработок событий" единственными  двумя требуми полями являются **"Имя"** и "Порядок" (см. рис. 3). При добавлении локального обработера событий с полным доверием добавьте поле **"Имя** сборки" и **"Имя класса";** оставьте **URL-адрес конечной точки** пустым. При добавлении удаленного приемник событий добавьте **URL-адрес** конечной точки и оставьте **имя** сборки и **имя класса** пустыми. 
  
> [!CAUTION]
> Если указать  *имя*  сборки или имя класса и URL-адрес конечной точки, Project Server вызывает только локальный обработец событий. Удаленный приемник событий игнорируется. 
> 
> Если создать два обработчика событий для одного события, когда один обработчик событий является локальным, а другой является удаленным приемником событий, при этом значение поля **Порядок** одинаково, Project Server игнорирует удаленный приемник событий. 
  
**Рис. 3. Добавление локального обработчика событий или удаленного приемника событий**

![Настройка обработчика событий или приемника событий](media/pj15_EventHandlers_NewEventHandler.gif "Настройка обработчика событий или приемника событий")
    
Если требуется доступ к наборам данных PSI для локального обработщика событий, можно скопировать сборку Microsoft.Office.Project.Schema.dll из каталога [Windows]\Microsoft.NET\assembly\GAC \_ MSIL\Microsoft.Office.Project.Schema\v4.0_15.0.0.0_71e9bce111e9429c. 

Вместо PSI мы рекомендуем использовать классы событий в пространстве имен **Microsoft.ProjectServer.Client**; разработка с применением CSOM не требует манипуляции с наборами данных. Для разработки удаленных приемников событий для Project Online необходимо использовать класс [Event](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.Event.aspx) и [класс EventHandlerCreationInformation](https://msdn.microsoft.com/library/Microsoft.ProjectServer.Client.EventHandlerCreationInformation.aspx) в CSOM. 
  
Перед развертыванием обработчика событий Project Server, установите и тщательно протестируйте этот обработчик событий на тестовой установке Project Server. В случае локальной установки Project Server, если добавляемый локальный обработчик событий становится неработоустойчивым, служба событий Project Server 2013 не загружает другие допустимые пользовательские обработчики событий. В этом случае необходимо удалить неисправный обработчик событий и перезапустить службу событий.
  
> [!NOTE]
> Для локальной установки Project Server мы рекомендуем перейти на удаленные приемники событий, используя CSOM для разработки приемников событий. Так как удаленные приемники событий не содержат стороннего кода, выполняющегося в службе событий Project Server, удаленные приемники событий более стабильны. Локальные администраторы освобождаются от поддержки службы событий Project Server. 
  
Общие сведения о событиях см. в раздел ["Обработка событий в приложениях для SharePoint".](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx) 
  
## <a name="deprecated-features"></a>Устаревшие компоненты
<a name="pj15_WhatsNew_Deprecated"> </a>

> [!NOTE]
> Сведения о неподготовленных или удаляемом API-серверах в Предварительной версии Project Server 2016 см. в предварительной версии [Project Server 2016.](https://docs.microsoft.com/project/what-s-deprecated-or-removed-in-project-server-2016) 
  
Неподготовленные функции по-прежнему доступны в Project 2013 для некоторых решений, но их не следует использовать для новой разработки. Большинство из следующих функций и методик не работают с Project Online или с локальной установкой Project Server 2013 по умолчанию в режиме разрешений SharePoint. Существующие решения, которые используют эти функции, могут не работать при обновлении Project Server 2010 до Project Server 2013. Хотя решения, которые используют неподдергленные функции, в некоторых случаях могут продолжать работать, они не полностью поддерживаются для всех установок Project 2013.
  
Если в ваших решениях используются устаревшие компоненты, перед развертыванием таких решений их следует тщательно протестировать и по возможности изменить для использования поддерживаемых компонентов. Сведения о настройке локальной безопасности Project Server 2013 для режима разрешений Project см. в разделе "Режим разрешений *SharePoint"* статьи "Новые возможности для ИТ-специалистов в [Project Server 2013".](https://docs.microsoft.com/project/what-s-new-for-it-pros-in-project-server-2016)
  
- **Сценарии** [расширения PSI](https://docs.microsoft.com/previous-versions/office/developer/office-2010/ff843378(v=office.14)) расширений расширений не поддерживаются и не будут поддерживаться в будущих выпусках. Эти сценарии локального Project Server 2013 позволяют интеграцию с помощью пользовательских служб Windows Communication Foundation (WCF). 
  
- **Project PSI** Класс [Project](https://docs.microsoft.com/office/client-developer/project/project-psi-reference-overview) PSI является неподготовленным. Для всех новых разработок используйте [модель CSOM Project.](client-side-object-model-csom-for-project-2013.md) Приложения Project Server 2013, которые используют Project PSI, продолжат работать, но приложениям Project Online потребуется заменить любые методы PSI класса Project эквивалентными методами CSOM.
  
- **PSI плана ресурсов** PSI [плана ресурсов](https://docs.microsoft.com/previous-versions/office/project-class/gg240019(v=office.15)) является неподготовленным. Он будет по-прежнему поддерживаться для разработки Project 2013, но не будет поддерживаться в будущих выпусках. 
  
- **Интерфейс ASMX для PSI** PSI включает дублирующиеся интерфейсы для разработки расширений локального project Server. Интерфейс веб-служб ASMX был представлен с первой реализацией PSI в Office Project Server 2007. В Project Server 2010 добавлен интерфейс служб WCF, в котором объектная модель фактически дублирует веб-службы ASMX. Хотя Project Server 2013 по-прежнему поддерживает asMX и WCF, новые решения, для работы с PSI должны использовать службы WCF. Если возможно, новые решения должны быть написаны с применением CSOM. 
  
  Веб-службы ASMX PSI являются неподготовленными в Project Server 2013. Для работы в последующих версиях Project Server решения, использующие веб-службы ASMX, должны быть переписаны с применением либо служб WCF, либо CSOM. Дополнительные сведения см. в разделе "Обновление приложений с помощью *API Project Server"* в разделе ["Программируемость Project Server".](project-server-programmability.md)
  
- **Поставщик ссылок на объекты (OLP)** В предыдущих версиях Project Server служба **ObjectLinkProvider** в PSI (см. раздел [WebSvcObjectLinkProvider)](https://docs.microsoft.com/previous-versions/office/ms481347(v=office.14)) предоставляет способ управления ссылками веб-объектов между задачами корпоративного проекта и специализированными списками SharePoint на сайте проекта для проблем, рисков, конечных результатов и документов. В Project Server 2013 OLP является неподготовленной. 
  
  Класс **[RelatedItemManager](https://docs.microsoft.com/previous-versions/office/sharepoint-server/jj168020(v=office.15))** в CSOM SharePoint можно использовать для создания, чтения и удаления ссылок веб-объектов между элементами в списке задач и другими списками на сайте проекта. Например, чтобы добавить ссылку из элемента задачи в проблему, можно использовать метод **[AddSingleLink](https://docs.microsoft.com/previous-versions/office/sharepoint-server/jj166451(v=office.15))** или один из двух аналогичных **методов, AddSingleLinkFromUrl** или **AddSingleLinkToUrl.** Класс **RelatedItemManager** также содержит методы для удаления ссылки на веб-объект и чтения связанных элементов. Эквивалентный класс в JSOM (объектной модели JavaScript) см. в [sp. Объект RelatedItemManager (sp.js).](https://docs.microsoft.com/previous-versions/office/sharepoint-visio/jj838582(v=office.15))
  
  Мы рекомендуем использовать CSOM SharePoint для создания приложений типа OLP для локальной установки Project Server 2013 и Project Online. Пространство [имен Microsoft.SharePoint](https://docs.microsoft.com/previous-versions/office/sharepoint-server/ms464984(v=office.15)) не включает класс **RelatedItemManager** ***** . 
  
- **Пользовательские разрешения** Пользовательские разрешения безопасности для доступа к определенным функциям или расширениям Project Server поддерживались в Office Project Server 2007, где в статье SDK объясняется, как создать их путем непосредственного изменения опубликованной базы данных. В Project Server 2010 настраиваемые разрешения по-прежнему работают, но являются неподготовленными. В Project Server 2013 настраиваемые разрешения не работают с режимом разрешений SharePoint по умолчанию для локальной установки. Для режима разрешений Project настраиваемые разрешения поддерживаются. В Project Online прямой доступ к базе данных невозможен. 
  
- **Подмекание** В Project Server 2013 не допускается использование подмены в приложениях на основе PSI, где пользователь приложения может получить разрешения безопасности другого пользователя Project Server. Как указывалось ранее, в локальной установке Project Server 2013 по умолчанию используется режим разрешений SharePoint, который не позволяет подстановки в группах безопасности Project Server. Дополнительные сведения см. в сведениях о [проверке подлинности, авторизации и безопасности в SharePoint 2013.](https://docs.microsoft.com/sharepoint/dev/general-development/authentication-authorization-and-security-in-sharepoint)
  
  Приложения с состоянием — это типичные расширения, которые могли использовать поднастояние в предыдущих версиях Project Server. В Project Server 2010 представлены методы **ReadStatusForResource** и **SubmitStatusForResource** в PSI, а также глобальное разрешение **StatusBrokerPermission,** что устраняет необходимость в подделывке для чтения и обновления состояния от имени другого пользователя. CSOM в Project Server 2013 использует PSI для прозрачного включить расширения состояния и может использоваться для Project Online или локальной установки. 
  
- **Расширения баз данных отчетов** Добавление пользовательских таблиц и представлений в базу данных отчетов — распространенная практика в предыдущих версиях Project Server. Так как Project Server 2013 объединяет четыре базы данных предыдущих версий в одну базу данных, обновления не переносят настраиваемые таблицы, представления или SPROCs в таблицы отчетов в базе данных Project Server 2013. 
  
  Рекомендуется использовать либо SQL Azure, либо отдельную базу данных SQL Server для настраиваемой таблиц и представлений отчетов, где можно управлять резервными копиями и обновлениями баз данных. Для Project Online это обязательно.
  
- **Отчеты** Локальные таблицы и представления отчетов в базе данных Project  Server и кубы OLAP не являются непрерывными и остаются полностью поддерживаемы. Однако таблицы и представления отчетов (база данных отчетов в предыдущих версиях Project Server) недоступны в Project Online. Аналогичным образом кубы OLAP доступны только при локальной установке Project Server 2013. Для отчетов о приложениях с помощью Project Online можно использовать службу **ProjectData** через запросы REST с протоколом OData. 
  
- **Руководство по проекту** Руководство по проекту — это стандартная функция классических приложений Office Project 2007, где содержимое HTML и JavaScript в области задач предоставляет интерактивное руководство по созданию проектов и управлению им. В Project 2010 руководство по проекту не доступно в установке по умолчанию, но его можно включить с помощью VBA или надстройки VSTO. Загрузка project 2010 SDK включает измененные файлы руководства по проекту. 
  
  Объектная модель VBA и объектная модель **Microsoft.Office.Interop.MSProject** в Project 2013 по-прежнему включают 22 члена класса **Application** и **класса Project,** которые могут управлять руководством по проекту. Однако приложения области задач Project 2013 могут конфликтовать с действиями в области задач "Руководство по проекту", а содержимое руководства по проекту нельзя легко распространять или продавать в Магазине Office. Настоятельно рекомендуется разрабатывать решения области задач Project с надстройки Office, а не с пользовательским содержимым руководства по проекту. Дополнительные сведения о руководстве по проекту см. в документации [по SDK для Project 2010.](https://msdn.microsoft.com/library/ms512767.aspx)
  
## <a name="comparing-project-server-on-premises-with-project-online"></a>Сравнение локального Сервера Project Server с Project Online
<a name="pj15_WhatsNew_Comparing"> </a>

В таблице 2 сравниваются возможности локальной установки Project Server 2013 с Project Online. В таблице 2 не содержатся различия в развертывании, администрировании и использовании. Дополнительные сведения о Project Online и Project Server 2013 см. в project [2013](https://developer.microsoft.com/project/docs) для разработчиков и [Project Online.](https://developer.microsoft.com/project)
  
**Таблица 2. Extensibility of Project Server on-premises and Project Online**

| Возможность |Локальное project Server | Project Online |
|:-----|:-----|:-----|
|**Программируемость** <br/> |Приложения на основе CSOM; согласованная модель программирования  <br/>- .NET, Silverlight, клиентские библиотеки Windows Phone  <br/>- Библиотека JavaScript для пользовательских страниц, расширений веб-части и ленты  <br/>- Протоколы OData и REST<br/><br/> Приложения на основе PSI; сложная модель программирования, также может создавать приложения для администрирования, анализа портфеля, уведомлений, безопасности режима Проекта, системы очередей и других областей<br/><br/>Расширения PSI  <br/><br/>Пользовательские разрешения с безопасностью режима Проекта (неподдержимые)  <br/><br/>Подмена с помощью PSI (неподдержденная)  <br/><br/>Код с полным доверием; установка расширений в ферме SharePoint  <br/> |Приложения на основе CSOM; согласованная модель программирования  <br/>- .NET, Silverlight, клиентские библиотеки Windows Phone<br/>- Библиотека JavaScript для пользовательских страниц, расширений веб-части и ленты<br/>- Протоколы OData и REST<br/><br/>Может использовать PSI, но не поддерживается: нет OAuth и подключения между службами<br/><br/>Без расширений API CSOM<br/><br/>Нет пользовательских разрешений<br/><br/>Без поднастояния<br/><br/>Нет кода с полным доверием  <br/> |
|**Пользовательские базы данных** <br/> |- SQL Azure  <br/>- SQL Server (изменение таблиц и представлений отчетов в базе данных Project Server не поддерживается)  <br/> |- SQL Azure  <br/>- SQL Server (изменение таблиц и представлений отчетов в базе данных Project Server не поддерживается)  <br/> |
|**Создание отчетов** <br/> |- **Служба ProjectData;** Протоколы OData и REST  <br/>- Таблицы и представления отчетов в базе данных Project Server<br/>- База данных OLAP  <br/> |- **Служба ProjectData;** Протоколы OData и REST  <br/> |
|**обработчики событий.** <br/> |- Удаленные приемники событий, доступные через конечные точки WCF<br/>- Обработчики событий с полным доверием, установленные в ферме SharePoint  <br/> | - Удаленные приемники событий, доступные через конечные точки WCF  <br/> |
|**Рабочие процессы** <br/> |Декларативные процессы, созданные с помощью SharePoint Designer 2013<br/>- Использовать только для определенного Project Web App экземпляра<br/>- Может импортировать проект рабочего процесса из Visio 2013<br/>- Может импортировать и использовать настраиваемые действия<br/><br/> Декларативные процессы, созданные с Visual Studio 2012<br/>- Создать приложение, которое может включать рабочие процессы<br/>– Создание пакета решения SharePoint (WSP), который может включать рабочие процессы<br/>- Создание шаблонов рабочих процессов для повторного использования<br/>- Создание и использование дополнительных действий  <br/><br/>Может использовать устаревшие скомпилировать рабочий процесс, созданный с помощью WF3.5 (рекомендуется обновить до декларативного рабочего процесса WF4)  <br/> |Декларативные процессы, созданные с помощью SharePoint Designer 2013<br/>- Использовать только для определенного Project Web App экземпляра<br/>- Может импортировать проект рабочего процесса из Visio 2013<br/>- Может импортировать и использовать настраиваемые действия  <br/><br/>Декларативные процессы, созданные с Visual Studio 2012<br/>- Создать приложение, которое может включать рабочие процессы  <br/>– Создание пакета решения SharePoint (WSP), который может включать рабочие процессы<br/>- Создание шаблонов рабочих процессов для повторного использования <br/>- Создание и использование дополнительных действий  <br/> |
|**Распространение** <br/> |- Магазин Office (для приложений на основе CSOM)<br/>- Частный каталог приложений в SharePoint<br/>- Файловая папка интрасети  <br/> |- Магазин Office<br/>- Частный каталог приложений в SharePoint  <br/> |

   
## <a name="conclusion"></a>Заключение
<a name="pj15_WhatsNew_Conclusion"> </a>

Project Server 2013 предоставляет множество новых возможностей и сценариев разработки, которые партнеры и клиенты могут использовать для адаптации и расширения возможностей и полезности Project Server на крупных предприятиях и в небольших организациях. Вы можете использовать инфраструктуру office 2013 и SharePoint 2013 для создания и распространения приложений для Project 2013, которые могут значительно расширить доступность и использование пользовательских приложений. Некоторые функции и методики, используемые в предыдущих версиях, не являются частью Project 2013, особенно веб-службы ASMX PSI и функций, которые включают подмену или непосредственные изменения базы данных, которые невозможно использовать с Project Online.
  
Внедрение CSOM обеспечивает программный доступ к Project Online для широкого спектра устройств и с помощью JavaScript в веб-приложениях. CSOM предоставляет более согласованную модель программирования по сравнению с PSI. Доступ к данным Project Server можно получить гораздо чаще, чем в предыдущих версиях, в том числе через веб-службу OData и конечные точки REST для отчетности данных в базе данных Project. Существующие отчеты по-прежнему работают таким же образом для локального использования; новые отчеты имеют большую гибкость.
  
Надстройки Office предоставляют новые возможности для продажи решений и интеграции Project Стандартный 2013 с веб-контентом и другими продуктами Office 2013. Вы также можете создать новые способы интеграции Project профессиональный 2013 с данными Project Server и списками SharePoint с помощью надстройки Office области задач.
  
Дополнительные сведения о разработке приложений и использовании функций программируемости и CSOM SharePoint Server 2013 см. в [sharePoint](https://docs.microsoft.com/sharepoint/dev/) для разработчиков и [Office для разработчиков.](https://developer.microsoft.com/office/docs)
  
## <a name="see-also"></a>Дополнительные ресурсы

- [Архитектура Project Server 2013](project-server-2013-architecture.md)  
- [Задачи программирования Project](project-programming-tasks.md) 
- [Клиентская объектная модель (CSOM) для Project 2013](client-side-object-model-csom-for-project-2013.md) 
- [ProjectData — Справочник по службе Project OData](https://msdn.microsoft.com/library/office/jj163015.aspx)  
- [Надстройки области задач для Project](task-pane-add-ins-for-project.md)   
- [OData: соглашения об URI](https://www.odata.org/documentation/uri-conventions#FilterSystemQueryOption)    
- [SharePoint для разработчиков](https://msdn.microsoft.com/sharepoint)    
- [Office для разработчиков](https://msdn.microsoft.com/office)   
- [Обработка событий в приложениях для SharePoint](https://msdn.microsoft.com/library/jj220048%28office.15%29.aspx)   
- [AppSource](https://appsource.microsoft.com/marketplace/apps?product=office)   
- [Project Online](https://developer.microsoft.com/project)
    


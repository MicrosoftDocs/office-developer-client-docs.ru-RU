---
title: Сведения о формулах
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251823
localization_priority: Normal
ms.assetid: ec0de3e1-21dc-c5d6-2c2a-d5fef80d89bd
description: Ключом к управлению действиями фигур является написание формул, определяющих требуемое поведение. Вы можете изменить формулу ячейки, чтобы изменить значение ячейки и, как следствие, изменить поведение конкретной фигуры. Например, ячейка Height в разделе Преобразование фигуры содержит формулу, которую можно изменить, чтобы изменить высоту фигуры.
ms.openlocfilehash: e8e1a2b77cc355e930af6f31f0b375dfba321e74
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426263"
---
# <a name="about-formulas"></a>Сведения о формулах

Ключом к управлению действиями фигур является написание формул, определяющих требуемое поведение. Вы можете изменить формулу ячейки, чтобы изменить значение ячейки и, как следствие, изменить поведение конкретной фигуры. Например, ячейка Height в разделе Преобразование фигуры содержит формулу, которую можно изменить, чтобы изменить высоту фигуры.
  
Формулы Microsoft Visio аналогичны типовым формулам электронных таблиц различными способами. Visio рассчитает что-либо в ячейке, даже если это числовое значение или ссылка на простую ячейку, как формула.
  
Формула в ячейке может быть унаследована от эквивалентной ячейки образца или стиля или определяться локально. Visio оценивает формулу, а затем преобразует результаты в соответствующее значение и соответствующие единицы измерения для ячейки. В окне таблицы свойств фигуры можно отобразить содержимое ячейки в виде формул или значений.
  
## <a name="elements-of-a-formula"></a>Элементы формулы

Формула всегда начинается со знака равенства, который вставляется автоматически. Формула может включать любой из следующих элементов:
  
- Числа
    
- Проверяем
    
- Логические значения
    
- Операторы
    
- Функции
    
- Строки
    
- Ссылки на ячейки
    
- Единицы измерения
    
## <a name="default-formulas"></a>Формулы по умолчанию

При создании фигуры Visio по умолчанию создает для нее формулы. Чтобы посмотреть, какие формулы используются по умолчанию, нарисуйте простую фигуру (например, прямоугольник, эллипс или прямую линию) и откройте окно таблицы свойств фигуры (на вкладке [разработчик](run-in-developer-mode-display-the-developer-tab.md) нажмите кнопку **Показать таблицу свойств фигуры**).
  
## <a name="inherited-formulas"></a>Наследуемые формулы

По мере возможности Visio наследует формулы. Вместо того чтобы создавать локальную копию каждой формулы в экземпляре, экземпляр наследует формулы из шаблона в наборе элементов документа и наследует форматирование из определения стиля, хранящегося в документе. Это приводит к уменьшению размера файлов, но также позволяет распространить изменения в формулах и определении стиля во все экземпляры.
  
Черный текст в ячейке указывает на наследуемую формулу.
  
## <a name="local-formulas"></a>Локальные формулы

При написании локальной формулы для экземпляра заменяется Наследуемая формула в ячейке с помощью локального переопределения. Будущие изменения этой ячейки в образце или стиле не повлияют на этот экземпляр, так как он заблокировал наследование для ячейки с локальным переопределением.
  
При применении стиля все локальные формулы удаляются из связанных ячеек, если для их защиты не используется функция GUARD.
  
Синий текст указывает на локальную формулу либо на результат редактирования формулы в окне таблицы свойств фигуры, либо на изменение фигуры, которая привела к сбросу формулы для этой ячейки в Visio.
  
## <a name="automatic-updates-to-formulas"></a>Автоматическое обновление формул

 Visio автоматически обновляет определенные ячейки при каждом изменении фигуры в документе. Это означает, что в некоторых случаях вводимые формулы можно заменить. Например, при перетаскивании углового маркера для изменения размера фигуры Visio сбрасывает формулы в ячейках PinX, PinY, Width и Height. 
  
При необходимости можно защитить формулы от изменений с помощью функции GUARD.
  


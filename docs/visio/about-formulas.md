---
title: О формулах
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251823
localization_priority: Normal
ms.assetid: ec0de3e1-21dc-c5d6-2c2a-d5fef80d89bd
description: Ключ к управлению действиями фигуры — это написание формул, определяющих нужное поведение. Вы можете изменить формулу ячейки, чтобы изменить значение ячейки и, как следствие, изменить поведение определенной фигуры. Например, ячейка Height в разделе Преобразование фигуры содержит формулу, которую можно изменить, чтобы изменить высоту фигуры.
ms.openlocfilehash: e8e1a2b77cc355e930af6f31f0b375dfba321e74
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426263"
---
# <a name="about-formulas"></a>О формулах

Ключ к управлению действиями фигуры — это написание формул, определяющих нужное поведение. Вы можете изменить формулу ячейки, чтобы изменить значение ячейки и, как следствие, изменить поведение определенной фигуры. Например, ячейка Height в разделе Преобразование фигуры содержит формулу, которую можно изменить, чтобы изменить высоту фигуры.
  
Формулы microsoft Visio похожи на типичные формулы таблиц во многих отношениях. Visio что-либо в ячейке, даже если это числовая ссылка или простая ссылка ячейки, в качестве формулы.
  
Формула в ячейке может быть унаследована от эквивалентной ячейки мастера или стиля или определена локально. Visio оценивает формулу, а затем преобразует результаты в соответствующее значение и соответствующие единицы для ячейки. В окне ShapeSheet содержимое ячейки можно отображать как формулы, так и значения.
  
## <a name="elements-of-a-formula"></a>Элементы формулы

Формула всегда начинается с равного знака, который вставляется автоматически. Формула может включать любой из следующих элементов:
  
- Числа
    
- Координаты
    
- Значения Boolean
    
- Операторы
    
- Functions
    
- Строки
    
- Ссылки на ячейки
    
- Единицы измерения
    
## <a name="default-formulas"></a>Формулы по умолчанию

При создании фигуры Visio формулы для нее по умолчанию. Чтобы узнать, что такое формулы по умолчанию, нарисуйте простую форму (например, прямоугольник, эллипс или [](run-in-developer-mode-display-the-developer-tab.md) прямая линия) и откройте окно ShapeSheet (на вкладке Разработчик щелкните **Show ShapeSheet).**
  
## <a name="inherited-formulas"></a>Унаследованные формулы

Visio наследует формулы по мере возможности. Вместо того, чтобы сделать локализованную копию каждой формулы в экземпляре, экземпляр наследует формулы своего мастера на трафарете документа и наследует форматирование из определения стиля, хранимого с помощью рисунка. Это поведение приводит к меньшему размеру файлов, но также позволяет распространять во все экземпляры изменения формул мастера или определения стиля.
  
Черный текст в ячейке указывает унаследованные формулы.
  
## <a name="local-formulas"></a>Локальные формулы

При написании локальной формулы экземпляра наследуемая формула в ячейке заменяется локальной переопределяемой. Будущие изменения в этой ячейке в мастере или стиле не влияют на этот экземпляр, так как он заблокировал наследование ячейки с локальным переопределить.
  
Применение стиля удаляет все локальные формулы в связанных ячейках, если только вы не используете функцию GUARD для их защиты.
  
Синий текст указывает локализованную формулу: либо результат редактирования формулы в окне ShapeSheet, либо изменение формы, из-за чего Visio для сброса формулы для этой ячейки.
  
## <a name="automatic-updates-to-formulas"></a>Автоматическое обновление формул

 Visio автоматически обновляет определенные ячейки при изменении фигуры в рисунке. Это означает, что при определенных обстоятельствах введите формулы можно заменить. Например, если перетаскивать угловую ручку для повторного размеров фигуры, Visio сбрасывает формулы в ячейках PinX, PinY, Width и Height. 
  
При необходимости можно защитить формулы от изменений с помощью функции GUARD.
  


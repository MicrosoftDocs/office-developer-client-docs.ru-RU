---
title: О формулах
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251823
localization_priority: Normal
ms.assetid: ec0de3e1-21dc-c5d6-2c2a-d5fef80d89bd
description: Ключ к управлению действиями фигуры — написание формул, определяющих нужное поведение. Формулу ячейки можно изменить, чтобы изменить значение ячейки и, в результате, изменить поведение определенной фигуры. Например, ячейка Height в разделе "Преобразование фигуры" содержит формулу, которую можно изменить, чтобы изменить высоту фигуры.
ms.openlocfilehash: e8e1a2b77cc355e930af6f31f0b375dfba321e74
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426263"
---
# <a name="about-formulas"></a>О формулах

Ключ к управлению действиями фигуры — написание формул, определяющих нужное поведение. Формулу ячейки можно изменить, чтобы изменить значение ячейки и, в результате, изменить поведение определенной фигуры. Например, ячейка Height в разделе "Преобразование фигуры" содержит формулу, которую можно изменить, чтобы изменить высоту фигуры.
  
Формулы Microsoft Visio во многом похожи на типичные формулы электронных таблиц. Visio рассматривает что-либо в ячейке, даже если это числовая ссылка или простая ссылка на ячейку, в качестве формулы.
  
Формула в ячейке может быть унаследована от эквивалентной ячейки хозяина или стиля или определена локально. Visio оценивает формулу, а затем преобразует результаты в соответствующее значение и соответствующие единицы для ячейки. В окне Таблицы фигур можно отображать содержимое ячейки в виде формул или значений.
  
## <a name="elements-of-a-formula"></a>Элементы формулы

Формула всегда начинается со знака равного, который вставляется автоматически. Формула может включать любой из следующих элементов:
  
- Числа
    
- Координаты
    
- Boolean values
    
- Операторы
    
- Функции
    
- Строки
    
- Ссылки на ячейки
    
- Единицы измерения
    
## <a name="default-formulas"></a>Формулы по умолчанию

При создании фигуры Visio создает формулы для нее по умолчанию. Чтобы увидеть формулы по умолчанию, нарисуйте простую фигуру (например, прямоугольник, эллипс или прямую линию) и откройте окно shapeSheet (на вкладке "Разработчик" щелкните "Показать таблицу **фигур").** [](run-in-developer-mode-display-the-developer-tab.md)
  
## <a name="inherited-formulas"></a>Унаследованные формулы

Visio наследует формулы, когда это возможно. Вместо того чтобы делать локализованную копию каждой формулы в экземпляре, экземпляр наследует формулы от своего хозяина в трафарете документа и наследует форматирование от определения стиля, сохраненного в документе. Это приводит к меньшему размеру файлов, но также позволяет распространять изменения в формулах хозяина или определении стиля на все экземпляры.
  
Черный текст в ячейке указывает на унаследованные формулы.
  
## <a name="local-formulas"></a>Локальные формулы

При написании локальной формулы для экземпляра наследуемая формула в ячейке заменяется локальным переопределением. Будущие изменения в этой ячейке в мастере или стиле не влияют на этот экземпляр, так как он блокирует наследование для ячейки с локальным переопределения.
  
Применение стиля удаляет все локальные формулы в связанных ячейках, если для их защиты не используется функция GUARD.
  
Синий текст указывает локализованную формулу, которая является результатом редактирования формулы в окне Таблицы фигур или каким-либо изменением фигуры, которая привела к сбросу формулы для этой ячейки в Visio.
  
## <a name="automatic-updates-to-formulas"></a>Автоматическое обновление формул

 Visio автоматически обновляет определенные ячейки при изменении фигуры в рисунке. Это означает, что при некоторых обстоятельствах введите формулы можно заменить. Например, если перетащить угловой лад, чтобы регулировать фигуру, Visio сбрасывает формулы в ячейках PinX, PinY, Width и Height. 
  
При необходимости можно защитить формулы от изменений с помощью функции GUARD.
  


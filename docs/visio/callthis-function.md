---
title: Функция CALLTHIS
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm82251403
localization_priority: Normal
ms.assetid: 461abfc1-d2cc-2354-1c2f-395c9e351a78
description: Вызывает процедуру в Microsoft Visual Basic для приложений (VBA) проект.
ms.openlocfilehash: 04065384453e55b745daa89273fb4c23b32fb90c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19813317"
---
# <a name="callthis-function"></a>Функция CALLTHIS

Вызывает процедуру в Microsoft Visual Basic для приложений (VBA) проект.
  
## <a name="syntax"></a>Синтаксис

CALLTHIS ("** *процедуры* **", ["** *project* **"], [** *arg1* **, ** *arg2* **,...]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Обязательный или необязательный**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _процедура_ <br/> |Обязательный  <br/> |**Строка** <br/> | Имя процедуры для вызова.  <br/> |
| _проекта_ <br/> |Optional  <br/> |**Строка** <br/> |Проект, содержащий процедуру.  <br/> |
| _Аргумент_ <br/> |Optional  <br/> |**Номер, строка, дата или валюта** <br/> |Передаются как параметры к процедуре.  <br/> |
   
## <a name="remarks"></a>Замечания

В проекте VBA *процедуры* определяется следующим образом: 
  
процедура (*vsoShape* как Visio.Shape [arg1 как тип arg2 как type...]) 
  
где *vsoShape* является ссылкой на объекта **Shape** , содержащий формулу CALLTHIS вычислением и _arg1_ *arg2* ... являются аргументов, указанных в формулу. 
  
Обратите внимание, что этот *vsoShape* очень похож «этот» аргумент, передаваемые в процедуру член C++; Поэтому имя «CALLTHIS». В результате могут читать ячейка, которая содержит формулу, которая включает в себя CALLTHIS как «Вызвать эту процедуру и передать его ссылку на Мои фигуры». 
  
Если _проект_ указан, Microsoft Visio сканирование всех открытых документов для одного содержащего _проекта_ и вызывает _процедуру_ в этом проекте. Если _проект_ является неправильных или значение null ("»), Visio предполагает _процедуры_ в проекте VBA документ, который содержит формулу CALLTHIS, которое было определено. 
  
Номера в _arg1_ _arg2..._ передаются в внешних единиц измерения. Например если передать значение высоту ячеек из формы, который является 3 см передается 3. Для передачи единиц с числом, используйте функцию FORMATEX или явно привести единиц измерения, добавив значение null, номер единицы пары, например 0 ft + высоту. 
  
Вторая запятая в функции CALLTHIS не является обязательным. Оно соответствует число дополнительных параметров, добавляемых в процедуру. Если вы не используете дополнительных параметров, за исключением `(vsoShape as Visio.Shape)` , не добавляйте второй запятой; с помощью CALLTHIS("",). Если вы добавляете два дополнительных параметра, например, используйте CALLTHIS("",,,). 
  
Функция CALLTHIS всегда имеет значение 0, и вызов _процедуры_ происходит во время простоя, после завершения процесса пересчета.  _Процедура_ может возвратить значение, но он игнорирует Visio.  _Процедура_ возвращает значение, которое может распознать Visio, задав формулу или результат другую ячейку в документе, но не ячейки, вызвавшей _процедуру_, если не перезаписать формула CALLTHIS.
  
Функция CALLTHIS отличается от функции RUNADDON, что проект документа не требуется ссылаться на другой проект для вызова этого проекта. 
  
> [!NOTE]
>  Код VBA, которая вызывается при экземпляр Visio оценивает функции CALLTHIS в формуле не следует закрыть документ, содержащий ячейки, с помощью функции, так как возникает ошибка приложения и завершает Visio. 
  
Если необходимо закрыть документ, содержащий ячейки, которая использует функцию CALLTHIS, используйте один из следующих методов: 
  
- Закройте документ, из кода, который не является VBA.
    
- Закройте документ из проекта не закрывается.
    
- Публиковать сообщения окна для закрытия окна в документе, а не закрытия документа.
    
Дополнительные сведения о запуске кода в Visio содержатся в разделе [о параметров безопасности и выполнить код в Visio](about-security-settings-and-running-code-in-visio-shapesheet.md) этот справочник по таблице свойств фигуры. 
  
## <a name="example-1"></a>Пример 1

CALLTHIS («p»,, FORMATEX (высота, "#.00 u",, "cm"))
  
Вызывает процедуру с именем p, расположенной в модуле и передает значение высоты в см, такие как 7,62 см.
  
## <a name="example-2"></a>Пример 2

CALLTHIS ("q",, 0 cm + высота, ширина)
  
Вызывает процедуру с именем q, расположенной в модуле и передает высоту ячеек в см и ширину в внутренних единиц измерения.
  
## <a name="example-3"></a>Пример 3

В модуле класса *ThisDocument* , используйте следующую процедуру. 
  
В ячейке EventDblClick фигуры с помощью приведенных выше процедурах используйте следующий синтаксис.
  
CALLTHIS("ThisDocument.A",)
  
CALLTHIS("ThisDocument.B",,"Click")
  
CALLTHIS ("ThisDocument.C",,"Click", "ОК".)
  


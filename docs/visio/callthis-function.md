---
title: Функция CALLTHIS
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm82251403
localization_priority: Normal
ms.assetid: 461abfc1-d2cc-2354-1c2f-395c9e351a78
description: Вызывает процедуру в проекте Microsoft Visual Basic для приложений (VBA).
ms.openlocfilehash: 7e0f0bafa39d6c1eb1fd39535506981c937ce8a1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413817"
---
# <a name="callthis-function"></a>Функция CALLTHIS

Вызывает процедуру в проекте Microsoft Visual Basic для приложений (VBA).
  
## <a name="syntax"></a>Синтаксис

CALLTHIS ("* * *процедура* * *", ["* * *проект* * *"], [* * *arg1* * *, * * *arg2* * *,...]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Необходимость**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _procedure_ <br/> |Обязательный  <br/> |**String** <br/> | Имя вызываемой процедуры.  <br/> |
| _Project_ <br/> |Необязательна  <br/> |**String** <br/> |Проект, содержащий процедуру.  <br/> |
| _й_ <br/> |Необязательна  <br/> |**Число, строка, дата или денежная единица** <br/> |Передается в качестве параметров в процедуру.  <br/> |
   
## <a name="remarks"></a>Примечания

В проекте VBA *процедура* определяется следующим образом: 
  
процедура (*всошапе* AS Visio. Shape [arg1 AS Type, arg2 AS Type...]) 
  
где *всошапе* — это ссылка на объект **Shape** , содержащий вычисляемую формулу CALLTHIS, и _arg1_, *arg2* ... — Это аргументы, указанные в формуле. 
  
Обратите внимание, что *всошапе* очень похож на аргумент "this", переданный в процедуру члена C++; Таким образом, имя "CALLTHIS". В сущности, ячейка, содержащая формулу, включающую CALLTHIS, может быть прочитана как "вызвать эту процедуру и передать ей ссылку на мою фигуру". 
  
Если указан _проект_ , Microsoft Visio сканирует все открытые документы для проекта, содержащего _проект_ , и вызывает _процедуру_ в этом проекте. Если _Project_ опущен или имеет значение null (""), предполагается, что в проекте VBA документа, содержащего вычисляемую формулу CALLTHIS, указана _процедура_ , указанная в Visio. 
  
Номера в _arg1_, _arg2..._ передаются во внешние единицы измерения. Например, если вы передаете значение ячейки Height из фигуры, равное 3 сантиметру, 3 передается. Чтобы передать различные единицы измерения с числом, используйте функцию FORMATEX или явное приведение типов, добавив нулевую цифровую единицу (например, 0 ФТ + Height). 
  
Вторая запятая в функции CALLTHIS является необязательной. Он соответствует количеству дополнительных параметров, добавленных в процедуру. Если никакие дополнительные параметры не используются, `(vsoShape as Visio.Shape)` не добавляйте вторую запятую. Используйте CALLTHIS (""). Если вы добавляете два дополнительных параметра, например, используйте CALLTHIS ("",,,). 
  
Функция CALLTHIS всегда вычисляется как 0, а вызов _процедуры_ происходит во время простоя после завершения процесса пересчета.  _Процедура_ может возвращать значение, но Visio игнорирует его.  _Процедура_ возвращает значение, которое Visio может распознать, задав формулу или результат другой ячейки в документе, а не ячейку, которая вызвала _процедуру_, если вы не хотите перезаписать формулу CALLTHIS.
  
Функция CALLTHIS отличается от функции RUNADDON в том, что в проекте документа не требуется ссылаться на другой проект, чтобы вызвать этот проект. 
  
> [!NOTE]
>  Код VBA, вызываемый при вычислении экземпляром Visio функции CALLTHIS в формуле, не должен закрывать документ, содержащий ячейку, с помощью функции, так как результат ошибки приложения и Visio завершает работу. 
  
Если вам нужно закрыть документ с ячейкой, использующей функцию CALLTHIS, используйте один из следующих методов: 
  
- Закройте документ из кода, который не является VBA.
    
- Закройте документ из проекта, отличного от закрывающего.
    
- Помещать сообщения окна, чтобы закрыть окна в документе, а не закрывать документ.
    
Дополнительные сведения о запуске кода в Visio можно найти в статье [о параметрах безопасности и выполнении кода в Visio](about-security-settings-and-running-code-in-visio-shapesheet.md) в этой ссылке на таблицу свойств фигуры. 
  
## <a name="example-1"></a>Пример 1

CALLTHIS ("p",, FORMATEX (высота, "#. 00 u", "cm"))
  
Вызывает процедуру с именем p, находящуюся в модуле, и передает значение высоты в сантиметрах, например 7,62 см.
  
## <a name="example-2"></a>Пример 2

CALLTHIS ("q",, 0 диспетчера подключений + высота, ширина)
  
Вызывает процедуру с именем q, расположенную в модуле, и передает высоту ячейки в сантиметрах и ширине во внутренних единицах.
  
## <a name="example-3"></a>Пример 3

Используйте следующую процедуру в модуле класс *ThisDocument* . 
  
Используйте любой из приведенных ниже синтаксисов в ячейке EventDblClick фигуры с предыдущими процедурами.
  
CALLTHIS ("ThisDocument. A",)
  
CALLTHIS ("ThisDocument. B", "Click")
  
CALLTHIS ("ThisDocument. C", "" щелкните "," ОК ".)
  


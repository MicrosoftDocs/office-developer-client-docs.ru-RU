---
title: Функция CALLTHIS
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm82251403
localization_priority: Normal
ms.assetid: 461abfc1-d2cc-2354-1c2f-395c9e351a78
description: Вызывает процедуру в проекте Microsoft Visual Basic для приложений (VBA).
ms.openlocfilehash: 7e0f0bafa39d6c1eb1fd39535506981c937ce8a1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413817"
---
# <a name="callthis-function"></a>Функция CALLTHIS

Вызывает процедуру в проекте Microsoft Visual Basic для приложений (VBA).
  
## <a name="syntax"></a>Синтаксис

CALLTHIS(" ** *procedure* ** ",[" ** *project* ** "],[ ** *arg1* **, ** *arg2* **,...]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Необходимость**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _procedure_ <br/> |Обязательно  <br/> |**Строка** <br/> | Имя вызываемой процедуры.  <br/> |
| _project_ <br/> |Необязательна  <br/> |**Строка** <br/> |Проект, содержащий процедуру.  <br/> |
| _arg_ <br/> |Необязательна  <br/> |**Число, строка, дата или валюта** <br/> |Передается в процедуру в качестве параметров.  <br/> |
   
## <a name="remarks"></a>Примечания

В проекте VBA процедура определяется следующим образом:  
  
procedure(*vsoShape*  As Visio.Shape [arg1 As type, arg2 As type...]) 
  
где  *vsoShape*  — это ссылка на объект **Shape,** содержащий оцениваемую формулу CALLTHIS, и  _arg1_,  *arg2*  ... аргументы, указанные в этой формуле. 
  
Обратите  *внимание, что vsoShape*  очень похож на аргумент "this", переданный процедуре-члену C++; следовательно, имя CALLTHIS. По сути, ячейку, содержаную формулу, которая включает CALLTHIS, можно прочитать как "Вызовите эту процедуру и передайте ссылку на мою фигуру". 
  
Если _указан_ проект, Microsoft Visio сканирует все открытые документы на тот, который содержит проект, и вызывает процедуру _в_ этом проекте.  Если _проект_ опущен или имеет null (""), Visio предполагает, что процедура находится в проекте VBA документа, который содержит формулу CALLTHIS, которая оценивается.  
  
Числа  _в arg1_,  _arg2..._ передаются во внешних единицах. Например, если передать значение ячейки Height из фигуры высотой 3 cm, передается 3. Чтобы передать разные единицы с числом, используйте функцию FORMATEX или явно привязите единицы, добавив нулевую пару "число-единица", например 0 ft + Height. 
  
Вторая запятая в функции CALLTHIS является необязательной. Он соответствует количеству дополнительных параметров, добавленных в процедуру. Если дополнительные параметры не используются, за исключением , не добавляйте вторую запятую; используйте  `(vsoShape as Visio.Shape)` CALLTHIS("",). При добавлении двух дополнительных параметров, например, используйте CALLTHIS("",,,). 
  
Функция CALLTHIS всегда оценивается как 0,  а вызов процедуры происходит во время простоя после завершения процесса пересчета.  _Процедура_ может возвращать значение, но Visio игнорирует его.  _Процедура_ возвращает значение, которое Visio может распознать, установив формулу или результат другой ячейки в документе, но не ячейку, которая вызвала процедуру, если вы не хотите перезаписать формулу CALLTHIS.
  
Функция CALLTHIS отличается от функции RUNADDON тем, что проекту документа не нужно ссылаться на другой проект для вызова этого проекта. 
  
> [!NOTE]
>  Код VBA, который вызывается, когда экземпляр Visio оценивает функцию CALLTHIS в формуле, не должен закрывать документ, содержащий ячейку, с помощью функции, так как ошибка приложения приводит к завершению Visio. 
  
Если необходимо закрыть документ, содержащий ячейку, использующую функцию CALLTHIS, используйте один из следующих методов: 
  
- Закроем документ из кода, который не является VBA.
    
- Закроем документ из проекта, который не закрывается.
    
- Сообщения в окне публикации, чтобы закрыть окна в документе, а не закрывать документ.
    
Дополнительные сведения о запуске кода в Visio см. в справочнике по настройкам безопасности и запуску кода [в Visio.](about-security-settings-and-running-code-in-visio-shapesheet.md) 
  
## <a name="example-1"></a>Пример 1

CALLTHIS("p",,FORMATEX(Height,"#.00 u","cm"))
  
Вызывает процедуру с именем p, расположенную в модуле, и передает значение Height в смах, например 7,62 cm.
  
## <a name="example-2"></a>Пример 2

CALLTHIS("q",0 cm+Height,Width)
  
Вызывает процедуру q, расположенную в модуле, и передает высоту ячейки в смесях и ширину во внутренних единицах.
  
## <a name="example-3"></a>Пример 3

Используйте следующую процедуру в модуле класса *ThisDocument.* 
  
Используйте любой из следующих синтаксис в ячейке EventDblClick фигуры с предыдущими процедурами.
  
CALLTHIS("ThisDocument.A",)
  
CALLTHIS("ThisDocument.B","Click")
  
CALLTHIS("ThisDocument.C","Click", "OK.")
  


---
title: Функция SETATREF
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm60113
localization_priority: Normal
ms.assetid: 1ecfdb05-2533-470a-006b-e554026944d8
description: Перенаправляет обновленные значения в результате действий в пользовательском интерфейсе (пользовательском интерфейсе) или автоматизации в другую ячейку.
ms.openlocfilehash: c4f5fe94aba90ce0a69983d6637a5399b6e42707
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416806"
---
# <a name="setatref-function"></a>Функция SETATREF

Перенаправляет обновленные значения в результате действий в пользовательском интерфейсе (пользовательском интерфейсе) или автоматизации в другую ячейку. 
  
## <a name="syntax"></a>Синтаксис

SETATREF (** *reference* ** [, ** *set_expression* ** [, ** *ignore_eval* ** ]]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Необходимость**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _reference_ <br/> |Обязательный  <br/> |**String** <br/> |Ссылка на ячейку, в которой перенаправляются обновления.  <br/> |
| _set_expression_ <br/> |Необязательный  <br/> |**String** <br/> |Выражение, назначенное _ссылкой._  <br/> |
| _ignore_eval_ <br/> |Необязательный  <br/> |**Логический** <br/> |Если ЗНАЧЕНИЕ TRUE, функция SETATREF оценивается до (0) ноль; если FALSE (по умолчанию) функция SETATREF оценивается до значения  _справки_.  <br/> |
   
## <a name="remarks"></a>Примечания

Если действие пользователя в окне рисования или метод автоматизации приводит к обновлению ячейки Visio содержащей формулу SETATREF, значение перенаправляется на ячейку, направляемую по формуле SETATREF _(ссылка)._ Формула в ячейке, содержащей функцию SETATREF, остается нетронутой.
  
Если  _set_expression_ опущен, значение, задатое в пользовательском интерфейсе или с помощью автоматизации, назначено на ссылаемую ячейку; в противном случае содержимое  _set_expression_ назначено со ссылкой на ячейку. Это позволяет изменять или изменять новое значение перед тем, как ему назначена эталонная ячейка. 
  
Функция SETATREF имеет две связанные функции: 
  
- Функция SETATREFEXPR, которую можно использовать для представления нового значения в _set_expression._ Например,  _set_expression_ SETATREFEXPR()-2. может использоваться для вычитания 2 дюймов из результата SETATREFEXPR. 
    
- Функция SETATREFEVAL, с помощью  _которой_ можно указать, что часть set_expression должна быть оценена и заменена ее результатом. 
    
Функция SETATREF предназначена для использования в ячейках, которые могут быть изменены действиями пользователя в окне рисования. Поддерживаются следующие ячейки:
  
- Раздел ShapeTransform — ячейки Ширина, Высота, Угол, PinX и PinY
    
- Раздел Преобразование текста— ячейки TxtWidth, TxtHeight, TxtAngle, TxtPinX и TxtPinY
    
- Раздел Конечные точки 1-D— ячейки BeginX, BeginY, EndX и EndY
    
- Раздел Элементы управления— ячейки Controls.X и Controls.Y
    
- Раздел "Данные фигуры"
    
Поскольку SETATREF изменяет расположение, в котором изменяются значения ячейки, это влияет на стрельбу события. Если ячейка содержит SETATREF, события **FormulaChanged** и **CellChanged** загорелись для ячейки, на которую ссылается SETATREF, а не ячейки, содержащей SETATREF. Если ячейка, содержащая SETATREF, также содержит SETATREFEXPR, событие **FormulaChanged** также включает ячейку, содержащую SETATREF, так как изменен параметр функции. 
  
Другие важные моменты, которые следует отметить в функции SETATREF, включают следующие:
  
- Функции SETATREF могут цепи до 10 ссылок на другие функции SETATREF. 
    
- Ячейки могут содержать другие выражения в дополнение к функции SETATREF, в том числе несколько случаев SETATREF в одной ячейке.
    
- Если фигуры приклеены, Visio цепочку ссылок SETATREF в том же листе и помещает формулы клея в ссылаемую ячейку. 
    
- Автоматизация распознает функцию SETATREF и следует по цепочке ссыланых ячеек. 
    
- Как и GUARD, SETATREF не защищает ячейки от изменений, внесенных с помощью функции SETF в ShapeSheet.
    
## <a name="example1"></a>Пример1

Предположим, что фигура имеет настраиваемое свойство Width и что ячейка Width в разделе Преобразование формы содержит следующую формулу:
  
=SETATREF (Prop.Width)
  
Если пользователь должен был изменить ширину формы в пользовательском интерфейсе, новое значение назначено ячейке Prop.Width, а не ячейке Width в разделе ShapeTransform; формула в ячейке Ширина остается неизменной. Ширину фигуры можно также установить с помощью данных фигуры.
  
## <a name="example2"></a>Example2

Visio решения часто имеют фигуры с иерархическими отношениями, требующие перемещения фигур ребенка при перемещении родительской фигуры. Ниже приводится пример управления этим отношением с помощью функции SETATREF в ShapeSheet. 
  
Следующие формулы содержатся в разделе Преобразование формы фигуры ребенка. Кроме того, мы определяем ячейки пользователей, называемые User.DeltaX и User.DeltaY, которые отслеживают смещение измерения из ParentShape. Это позволяет ребенку двигаться при перемещении родительской фигуры, а также сохранять иерархические отношения при перемещении фигуры ребенка.
  
PinX =SETATREF (User.DeltaX, SETATREFEVAL(SETATREFEXPR)-ParentShape! PinX)) + ParentShape! PinX
  
Piny =SETATREF (User.DeltaY, SETATREFEVAL(SETATREFEXPR() - ParentShape! PinY)) + ParentShape! PinY
  
При перемещении фигуры ребенка с помощью пользовательского интерфейса в функции SETATREFEXPR заданы новые значения PinX и PinY. Функция SETATREF оценивает формулу, заключенную в SETATREFEVAL, и заменяет результаты PinX и PinY, а затем выдаваемая формула назначена ячейкам пользователей, на которые ссылается функция SETATREF— User.DeltaX и User.DeltaY. Наконец, значения, возвращенные SETATREF (User.DeltaX или User.DeltaY), добавляются в расположение пин-кода ParentShape для вычисления расположения пин-кода фигуры ребенка.
  


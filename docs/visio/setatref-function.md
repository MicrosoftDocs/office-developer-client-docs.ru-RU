---
title: Функция SETATREF
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm60113
localization_priority: Normal
ms.assetid: 1ecfdb05-2533-470a-006b-e554026944d8
description: Перенаправляет обновленные значения, которые являются результатом действий в пользовательском интерфейсе или автоматизации, в другую ячейку.
ms.openlocfilehash: c4f5fe94aba90ce0a69983d6637a5399b6e42707
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416806"
---
# <a name="setatref-function"></a>Функция SETATREF

Перенаправляет обновленные значения, которые являются результатом действий в пользовательском интерфейсе или автоматизации, в другую ячейку. 
  
## <a name="syntax"></a>Синтаксис

SETATREF(** *reference* ** [, ** *set_expression* ** [, ** *ignore_eval* ** ]]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Необходимость**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _reference_ <br/> |Обязательно  <br/> |**Строка** <br/> |Ссылка на ячейку, в которой перенаправляются обновления.  <br/> |
| _set_expression_ <br/> |Необязательна  <br/> |**Строка** <br/> |Выражение, назначенное для _ссылки._  <br/> |
| _ignore_eval_ <br/> |Необязательный  <br/> |**Логический** <br/> |Если установлено значение TRUE, функция SETATREF оценивается как (0) ноль; Если задается значение FALSE (по умолчанию), функция SETATREF оценивается как значение _ссылки._  <br/> |
   
## <a name="remarks"></a>Примечания

Когда действие пользователя в окне рисования или метод автоматизации приводит к обновлению Microsoft Visio ячейки, содержащей формулу SETATREF, значение перенаправляется в ячейку, на которая ссылается формула SETATREF (ссылка). Формула в ячейке, содержащей функцию SETATREF, остается неизменной.
  
Если  _set_expression_ элементов опущен, значение, задамое в пользовательском интерфейсе или с помощью автоматизации, будет назначено ячейке, на который ссылается ссылка; в противном случае содержимое  _set_expression,_ назначенное ячейке, на который ссылается ссылка. Это позволяет изменять или преобразовывать новое значение перед присвоением ячейке, на который ссылается ссылка. 
  
Функция SETATREF имеет две связанные функции: 
  
- Функция SETATREFEXPR, которую можно использовать для представления нового значения  _в_ set_expression. Например,  _set_expression_ setATREFEXPR()-2 in. может использоваться для вычитания 2 дюйма из результата SETATREFEXPR. 
    
- Функция SETATREFEVAL, которую можно использовать, чтобы  указать, что некоторые части set_expression должны быть оценены и заменены ее результатом. 
    
Функция SETATREF предназначена для использования в ячейках, которые можно изменить с помощью действий пользователя в окне рисования. Поддерживаются следующие ячейки:
  
- Раздел ShapeTransform — ячейки Width, Height, Angle, PinX и PinY
    
- Раздел "Преобразование текста" — ячейки TxtWidth, TxtHeight, TxtAngle, TxtPinX и TxtPinY
    
- Раздел "1-D Endpoints" — ячейки BeginX, BeginY, EndX и EndY
    
- Раздел "Элементы управления" — ячейки Controls.X и Controls.Y
    
- Раздел "Данные фигуры"
    
Так как SETATREF изменяет расположение, в котором изменяются значения ячеей, это влияет на событие. Если ячейка содержит SETATREF, события **FormulaChanged** и **CellChanged** сгораются для ячейки, на которую ссылается SETATREF, а не для ячейки, содержащей SETATREF. Если ячейка, содержащая SETATREF, также содержит SETATREFEXPR, событие **FormulaChanged** также сгореет для ячейки, содержащей SETATREF, поскольку изменен параметр функции. 
  
К другим важным моментам, которые следует обратить внимание на функцию SETATREF, относятся следующие:
  
- Функции SETATREF могут сцеплять до 10 ссылок на другие функции SETATREF. 
    
- Ячейки могут содержать другие выражения в дополнение к функции SETATREF, включая несколько экземпляров SETATREF в одной ячейке.
    
- Если фигуры привязались, Visio следует цепочке ссылок SETATREF на том же листе и помещает формулы привязок в ячейку со ссылкой. 
    
- Автоматизация распознает функцию SETATREF и следует за цепочкой ячеек, на которые есть ссылка. 
    
- Как и GUARD, SETATREF не защищает ячейки от изменений, внесенных с помощью функции SETF в shapeSheet.
    
## <a name="example1"></a>Пример 1

Предположим, что фигура имеет настраиваемое свойство Width, а ячейка Width в разделе "Преобразование фигуры" содержит следующую формулу:
  
=SETATREF(Prop.Width)
  
Если пользователь должен изменить ширину фигуры в пользовательском интерфейсе, новое значение будет назначено ячейке Prop.Width, а не ячейке Width в разделе ShapeTransform; формула в ячейке Width остается неизменной. Вы также можете установить ширину фигуры с помощью данных фигуры.
  
## <a name="example2"></a>Пример 2

Решения Visio часто имеют фигуры с иерархической связью, требующие перемещения родительских фигур при перемещении. Ниже приводится пример управления этой связью с помощью функции SETATREF в shapeSheet. 
  
Следующие формулы содержатся в разделе "Преобразование фигуры" для этой фигуры. Кроме того, мы определяем ячейки пользователей User.DeltaX и User.DeltaY, которые отслеживают измерение смещения от ParentShape. Это позволяет переместить родительская фигура при перемещении родительской фигуры, а также сохранить иерархическую связь при перемещении этой фигуры.
  
PinX =SETATREF(User.DeltaX, SETATREFEVAL(SETATREFEXPR() - ParentShape! PinX)) + ParentShape! PinX
  
PinY =SETATREF(User.DeltaY, SETATREFEVAL(SETATREFEXPR() - ParentShape! PinY)) + ParentShape! PinY
  
При перемещении фигуры с помощью пользовательского интерфейса новые значения PinX и PinY устанавливаются в качестве параметра в функции SETATREFEXPR. Функция SETATREF оценивает формулу, заключенную в SETATREFEVAL, и заменяет PinX и PinY результатами, а затем итоговая формула назначена ячейкам пользователей, на которые ссылается функция SETATREF — User.DeltaX и User.DeltaY. Наконец, значения, возвращенные SETATREF (User.DeltaX или User.DeltaY), добавляются в расположение закрепления ParentShape для вычисления расположения контактов для фигуры.
  


---
title: Функция SETATREF
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm60113
localization_priority: Normal
ms.assetid: 1ecfdb05-2533-470a-006b-e554026944d8
description: Перенаправляет обновленные значения, полученные в результате действий в пользовательского интерфейса (UI) или автоматизации в другую ячейку.
ms.openlocfilehash: 69a9cb93ae3fbd807ef4f306be386f5389a6cfeb
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19814748"
---
# <a name="setatref-function"></a>Функция SETATREF

Перенаправляет обновленные значения, полученные в результате действий в пользовательского интерфейса (UI) или автоматизации в другую ячейку. 
  
## <a name="syntax"></a>Синтаксис

Функции SETATREF (** *ссылку* ** [, ** *set_expression* ** [, ** *ignore_eval* **]]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Обязательный или необязательный**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _Справочник по_ <br/> |Обязательный  <br/> |**Строка** <br/> |Ссылка на ячейку, куда перенаправляются обновлений.  <br/> |
| _Set_Expression_ <br/> |Optional  <br/> |**Строка** <br/> |Выражение, которое назначается _ссылка_.  <br/> |
| _ignore_eval_ <br/> |Optional  <br/> |**Boolean** <br/> |Если значение TRUE, функция функции SETATREF вычисляет (0) 0. Если задано значение FALSE (по умолчанию) ВЫРАЖЕНИЕ_МНОЖЕСТВА функции оценивается как значение _ссылки_.  <br/> |
   
## <a name="remarks"></a>Замечания

Когда действие пользователя в окне документа или метод автоматизации вызывает Microsoft Visio для обновления на ячейку, содержащую формулу ВЫРАЖЕНИЕ_МНОЖЕСТВА, значение вместо перенаправляется в ячейку, ссылается формула ВЫРАЖЕНИЕ_МНОЖЕСТВА ( _ссылки_). Формулу в ячейку, содержащую ВЫРАЖЕНИЕ_МНОЖЕСТВА функции не изменяется.
  
Если _set_expression_ указан, значением, заданным в пользовательском Интерфейсе или с помощью автоматизации назначается ссылкой; в противном случае содержимое _set_expression_ назначаются ссылкой. Это позволяет новое значение изменения или преобразовать перед, присваиваемое ссылкой. 
  
Функция ВЫРАЖЕНИЕ_МНОЖЕСТВА имеет две связанные функции: 
  
- Функция SETATREFEXPR, которая используется для присвоения нового значения в пределах _set_expression_. Например, _set_expression_ (SETATREFEXPR)-2 в. может использоваться для вычитания 2 дюйма от SETATREFEXPR результатов. 
    
- Функция SETATREFEVAL, который можно использовать для указания, что некоторые части _set_expression_ должен быть вычисляется и заменяется его результатом. 
    
Функция ВЫРАЖЕНИЕ_МНОЖЕСТВА предназначена для использования в ячейках, которые могут быть изменены действиями пользователя в окне документа. Поддерживаются следующие ячейки:
  
- Раздел ShapeTransform, Width, Height, угол, PinX и PinY ячеек
    
- Раздел Преобразование текст — ШиринаТекста, ВысотаТекста, TxtAngle, TxtPinX и TxtPinY ячеек
    
- Раздел 1 D конечных точек, BeginX, BeginY, EndX и EndY ячеек
    
- Элементы управления section—Controls.X и Controls.Y ячейки
    
- Раздел данных фигуры
    
Поскольку функции SETATREF изменяется местоположение, где изменение значений ячеек, влияет на события Click. Если ячейка содержит функции SETATREF, события **FormulaChanged** и **CellChanged** возникают для ячейки, на который ссылается ВЫРАЖЕНИЕ_МНОЖЕСТВА, не содержащий функции SETATREF ячейки. Если на ячейку, содержащую ВЫРАЖЕНИЕ_МНОЖЕСТВА также содержит SETATREFEXPR, событие **FormulaChanged** также запускается для ячейки, содержащий ВЫРАЖЕНИЕ_МНОЖЕСТВА из-за изменения параметра функции. 
  
Другие важные замечания о ВЫРАЖЕНИЕ_МНОЖЕСТВА функции относятся следующие:
  
- Функции SETATREF функции можно объединять до 10 ссылки на другие функции ВЫРАЖЕНИЕ_МНОЖЕСТВА. 
    
- Ячейки могут содержать другие выражения в дополнение к ВЫРАЖЕНИЕ_МНОЖЕСТВА функции, включая несколько вхождений ВЫРАЖЕНИЕ_МНОЖЕСТВА в одну ячейку.
    
- Если фигуры являются связан, Visio цепочка Справочник по функции SETATREF в том же листе и помещает связывающих формул в указанной ячейке. 
    
- Автоматизация распознает ВЫРАЖЕНИЕ_МНОЖЕСТВА функции и цепочка ссылок на ячейки. 
    
- Как УСЛОВИЕ функции SETATREF не обеспечивает защиту ячеек из изменения, внесенные с помощью функции SETF в таблице свойств фигуры.
    
## <a name="example1"></a>Example1

Предположим, фигуры на наличие настраиваемое свойство Width и ширина ячеек в разделе Преобразование фигуры содержит следующую формулу:
  
=SETATREF(prop.Width)
  
Если пользователь изменить ширину фигуры в пользовательском Интерфейсе, новое значение назначается Prop.Width ячейки, не следует ширину ячеек в разделе ShapeTransform; формулы в ячейке ширина не изменяется. Можно также задать ширину фигуры с помощью данных фигуры.
  
## <a name="example2"></a>Example2

Решения Visio часто имеют фигуры, которые имеют иерархическую связь, требующие дочерних фигуры, чтобы переместить при перемещении родительскую фигуру. Ниже приведен пример как вы управляете связь с помощью функции ВЫРАЖЕНИЕ_МНОЖЕСТВА в таблице свойств фигуры. 
  
В разделе Преобразование фигуры фигуры дочерних содержатся следующие формулы. Кроме того мы определить пользователя ячеек, User.DeltaX и User.DeltaY, что отслеживать смещения измерения из ParentShape. Это позволяет фигуры дочерних перемещение при перемещении родительскую фигуру и сохранить иерархической связи, при перемещении фигуры дочерних.
  
PinX = ВЫРАЖЕНИЕ_МНОЖЕСТВА (User.DeltaX, SETATREFEVAL(SETATREFEXPR() - ParentShape! PinX)) + ParentShape! PinX
  
PinY = ВЫРАЖЕНИЕ_МНОЖЕСТВА (User.DeltaY, SETATREFEVAL(SETATREFEXPR() - ParentShape! PinY)) + ParentShape! PinY
  
При перемещении фигуры дочерних с помощью пользовательского интерфейса в качестве параметра в функции SETATREFEXPR устанавливаются новые значения PinX и PinY. ВЫРАЖЕНИЕ_МНОЖЕСТВА функции оценивает формулу, заключенные в SETATREFEVAL и заменяет их результаты PinX и PinY, и затем Результирующая формула назначается ссылки в функции SETATREF function—User.DeltaX и User.DeltaY ячеек пользователя. И, наконец значения, возвращаемые функции SETATREF (User.DeltaX или User.DeltaY) добавляются к месту ПИН-код ParentShape для вычисления расположение фигуры дочерних ПИН-кода.
  


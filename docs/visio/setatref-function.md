---
title: Функция SETATREF
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm60113
localization_priority: Normal
ms.assetid: 1ecfdb05-2533-470a-006b-e554026944d8
description: Перенаправляет обновленные значения, полученные в результате действий в пользовательском интерфейсе или автоматизации, в другую ячейку.
ms.openlocfilehash: c4f5fe94aba90ce0a69983d6637a5399b6e42707
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32326021"
---
# <a name="setatref-function"></a>Функция SETATREF

Перенаправляет обновленные значения, полученные в результате действий в пользовательском интерфейсе или автоматизации, в другую ячейку. 
  
## <a name="syntax"></a>Синтаксис

SETATREF (* * *Reference* * * [, * * *Set_Expression* * * [, * * *игноре_евал* * *]]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Необходимость**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _reference_ <br/> |Обязательный  <br/> |**String** <br/> |Ссылка на ячейку, в которую перенаправлены обновления.  <br/> |
| _Set_Expression_ <br/> |Необязательный  <br/> |**String** <br/> |Выражение, которое присваивается _ссылке_.  <br/> |
| _игноре_евал_ <br/> |Необязательный  <br/> |**Boolean** <br/> |Если задано значение TRUE, функция SETATREF возвращает значение (0) ноль; Если задано значение FALSE (значение по умолчанию), функция SETATREF оценивается как _ссылка_.  <br/> |
   
## <a name="remarks"></a>Замечания

Если пользовательское действие в окне документа или метод автоматизации приводит к тому, что Microsoft Visio обновляет ячейку, содержащую формулу SETATREF, это значение перенаправляется в ячейку, на которую ссылается формула SETATREF ( _ссылка_). Формула в ячейке, содержащей функцию SETATREF, остается без изменений.
  
Если аргумент _Set_Expression_ опущен, значение, заданное в пользовательском интерфейсе или с помощью автоматизации, назначается указанной ячейке; в противном случае содержимое объекта _Set_Expression_ назначается указанной ячейке. Это позволяет изменить или преобразовать новое значение перед его присвоением указанной ячейке. 
  
Функция SETATREF имеет две связанные функции: 
  
- Функция SETATREFEXPR, которую можно использовать для представления нового значения в списке _Set_Expression_. Например, _SET_EXPRESSION_ SETATREFEXPR ()-2 в. может использоваться для вычитания 2 сантиметров из результатов SETATREFEXPR. 
    
- Функция SETATREFEVAL, которую можно использовать, чтобы указать, что часть аргумента _Set_Expression_ должна быть оценена и заменена на результат. 
    
Функция SETATREF предназначена для использования в ячейках, которые можно изменить с помощью действий пользователя в окне документа. Поддерживаются следующие ячейки:
  
- Раздел Шапетрансформ — ширина, высота, угол, PinX и PinY ячеек
    
- Раздел "преобразование текста" — TxtWidth, TxtHeight, TxtAngle, TxtPinX и TxtPinY ячейки
    
- раздел "1-D Endpoints" — BeginX, Begin, EndX и Енди Cells
    
- Раздел "элементы управления" — Controls. X и Controls. Y.
    
- Раздел "Данные фигуры"
    
Так как SETATREF изменяет расположение, в котором изменяются значения ячеек, оно влияет на срабатывание события. Если ячейка содержит SETATREF, события **формулачанжед** и **CellChanged** срабатывают для ячейки, на которую ссылается SETATREF, а не ячейки, содержащие SETATREF. Если ячейка, содержащая SETATREF, также содержит SETATREFEXPR, то событие **формулачанжед** также срабатывает для ячейки, содержащей SETATREF, так как параметр функции изменился. 
  
Кроме того, обратите внимание на следующие важные моменты, касающиеся функции SETATREF:
  
- Функции SETATREF могут создавать цепочки до 10 ссылок на другие функции SETATREF. 
    
- Ячейки могут содержать другие выражения в дополнение к функции SETATREF, в том числе несколько вхождений SETATREF в одной ячейке.
    
- Если фигуры привязываются, Visio обращается к цепочке ссылок SETATREF в пределах одного листа и размещает формулы приклеить в ячейке, на которую указывает ссылка. 
    
- Автоматизация распознает функцию SETATREF и соответствует цепочке ячеек, на которые указывают ссылки. 
    
- Как и в случае с ЗАЩИТой, SETATREF не защищает ячейки от изменений, выполненных с помощью функции SETF в таблице свойств фигуры.
    
## <a name="example1"></a>Example1

Предположим, что фигура имеет настраиваемое свойство Width, а ячейка Width в разделе Преобразование фигуры содержит следующую формулу:
  
= SETATREF (prop. Width)
  
Если пользователю необходимо изменить ширину фигуры в ПОЛЬЗОВАТЕЛЬСКОМ ИНТЕРФЕЙСе, то новое значение будет назначено ячейке prop. Width, а не ячейке Width в разделе Шапетрансформ. Формула в ячейке Width остается неизменной. Ширину фигуры также можно задать с помощью данных фигуры.
  
## <a name="example2"></a>Example2

В решениях Visio часто используются фигуры с иерархической связью, требующие перемещения дочерних фигур при перемещении родительской фигуры. Ниже приведен пример того, как можно управлять этой связью с помощью функции SETATREF в таблице свойств фигуры. 
  
Следующие формулы включены в раздел "Преобразование фигуры" дочерней фигуры. Кроме того, мы определяем пользовательские ячейки с именем user. Делтакс и User. Delta, которые отслеживают размер смещения из Парентшапе. Это позволяет перемещать дочернюю фигуру при перемещении родительской фигуры, а также сохранять иерархические отношения при перемещении дочерней фигуры.
  
PinX = SETATREF (User. Делтакс, SETATREFEVAL (SETATREFEXPR ()-Парентшапе! PinX)) + Парентшапе! PinX
  
PinY = SETATREF (User. Deltaing, SETATREFEVAL (SETATREFEXPR ()-Парентшапе! PinY)) + Парентшапе! PinY
  
Когда дочерняя фигура перемещается с помощью ПОЛЬЗОВАТЕЛЬСКОГО интерфейса, новые значения PinX и PinY задаются в качестве параметра в функции SETATREFEXPR. Функция SETATREF оценивает формулу, заключенную в SETATREFEVAL, и заменяет PinX и PinY на результаты, а затем результирующую формулу присваиваются ячейкам пользователей, на которые ссылается функция SETATREF — User. Делтакс и User. Delta. Наконец, значения, возвращаемые методом SETATREF (User. Делтакс или User. Delta), добавляются в расположение ПИН-кода Парентшапе для вычисления расположения ПИН-кода дочерней фигуры.
  


---
title: Ссылки на ячейки
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
f1_keywords:
- Vis_DSS.chm82251827
localization_priority: Normal
ms.assetid: e6a9aceb-90d7-fb53-eaf4-416a1ae2a98b
description: Для создания взаимозависимых элементов формул можно использовать ссылки на ячейки ShapeSheet. Ссылки на ячейки дают возможность вычислять значение для одной ячейки на основе значения другой ячейки. Например, ячейка Width фигуры может содержать формулу, которая вычисляет ширину фигуры, ссылаясь на значение ее ячейки Height, чтобы при вертикальном масштабе фигуры ее ширина оставалась пропорционально.
ms.openlocfilehash: a92bcc560c535dc012ec5cb79db72250e78364c7
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409806"
---
# <a name="about-cell-references"></a><span data-ttu-id="7fba5-105">Ссылки на ячейки</span><span class="sxs-lookup"><span data-stu-id="7fba5-105">About Cell References</span></span>

<span data-ttu-id="7fba5-106">Для создания взаимозависимых элементов формул можно использовать ссылки на ячейки ShapeSheet.</span><span class="sxs-lookup"><span data-stu-id="7fba5-106">You can create interdependencies among formulas by means of ShapeSheet cell references.</span></span> <span data-ttu-id="7fba5-107">Ссылки на ячейки дают возможность вычислять значение для одной ячейки на основе значения другой ячейки.</span><span class="sxs-lookup"><span data-stu-id="7fba5-107">Cell references give you the power to calculate a value for one cell based on another cell's value.</span></span> <span data-ttu-id="7fba5-108">Например, ячейка Width фигуры может содержать формулу, которая вычисляет ширину фигуры, ссылаясь на значение ее ячейки Height, чтобы при вертикальном масштабе фигуры ее ширина оставалась пропорционально.</span><span class="sxs-lookup"><span data-stu-id="7fba5-108">For example, a shape's Width cell might contain a formula that calculates the shape's width by referring to the value of its Height cell, so that when a user resizes the shape vertically, its width stays in proportion.</span></span>
  
<span data-ttu-id="7fba5-109">В формуле ячейки можно ссылаться на ячейку той же фигуры или другой объект, например документ или страницу, чтобы Microsoft Visio вычислял значение для одной ячейки на основе значения другой ячейки.</span><span class="sxs-lookup"><span data-stu-id="7fba5-109">In a cell's formula, you can refer to a cell of the same shape or another object, such as a document or page, so that Microsoft Visio calculates a value for one cell based on another cell's value.</span></span>
  
## <a name="what-cell-references-can-include"></a><span data-ttu-id="7fba5-110">Ссылки на ячейки</span><span class="sxs-lookup"><span data-stu-id="7fba5-110">What cell references can include</span></span>

<span data-ttu-id="7fba5-111">Ссылки на ячейки могут включать идентификаторы фигур или имена.</span><span class="sxs-lookup"><span data-stu-id="7fba5-111">Cell references can include shape identifiers (IDs) or names.</span></span> <span data-ttu-id="7fba5-112">Вы всегда можете ссылаться на любую фигуру на странице по ее ИД, независимо от того, является ли фигура именоваемой.</span><span class="sxs-lookup"><span data-stu-id="7fba5-112">You can always refer to any shape on the page by its ID, whether the shape is named or not.</span></span> <span data-ttu-id="7fba5-113">Если фигура не была названа, ее именем по умолчанию является Sheet.</span><span class="sxs-lookup"><span data-stu-id="7fba5-113">If a shape hasn't been named, its default name is Sheet.</span></span> <span data-ttu-id="7fba5-114">*i*  ,  *где i*  — это ИД фигуры.</span><span class="sxs-lookup"><span data-stu-id="7fba5-114">*i*  , where  *i*  is the shape ID.</span></span> <span data-ttu-id="7fba5-115">ИД будет назначен при формировании фигуры и не будет изменяться, пока фигура не будет перемещаться на другую страницу или документ.</span><span class="sxs-lookup"><span data-stu-id="7fba5-115">The ID is assigned when the shape is created and does not change unless you move the shape to another page or document.</span></span> <span data-ttu-id="7fba5-116">Если несколько фигур на странице имеет одно и то же имя, необходимо включить соответствующий ИД.</span><span class="sxs-lookup"><span data-stu-id="7fba5-116">If more than one shape on a page has the same name, you must include the assigned ID.</span></span> 
  
## <a name="cell-reference-syntax-and-examples"></a><span data-ttu-id="7fba5-117">Синтаксис ссылок на ячейки и примеры</span><span class="sxs-lookup"><span data-stu-id="7fba5-117">Cell reference syntax and examples</span></span>

<span data-ttu-id="7fba5-118">Синтаксис, который вы используете, и возможность ссылки на фигуру по имени зависят от связи между двумя объектами.</span><span class="sxs-lookup"><span data-stu-id="7fba5-118">The syntax you use and whether you can refer to a shape by name depend on the relationship between the two objects.</span></span> <span data-ttu-id="7fba5-119">Применяются указанные общие правила.</span><span class="sxs-lookup"><span data-stu-id="7fba5-119">These general rules apply:</span></span>
  
- <span data-ttu-id="7fba5-120">Если фигура является одноранговой частью фигуры, формулу которой вы редактируете, можно ссылаться на одноранговую фигуру по имени.</span><span class="sxs-lookup"><span data-stu-id="7fba5-120">If a shape is a peer of the shape whose formula you are editing, you can refer to the peer shape by name.</span></span> <span data-ttu-id="7fba5-121">Если одноранговая фигура является группой, вы можете сослаться на нее по имени, но не ее членов.</span><span class="sxs-lookup"><span data-stu-id="7fba5-121">If the peer shape is a group, you can refer by name to the group, but not its members.</span></span> <span data-ttu-id="7fba5-122">Нельзя также ссылаться по имени на родительский или родительский одноранговую фигуру.</span><span class="sxs-lookup"><span data-stu-id="7fba5-122">Neither can you refer by name to a shape's parent or its parent's peers.</span></span>
    
- <span data-ttu-id="7fba5-123">Синтаксис Sheet.ID для ссылки на любую фигуру на странице, независимо от того, находится ли фигура в группе или является родительским для фигуры.</span><span class="sxs-lookup"><span data-stu-id="7fba5-123">You can use Sheet.ID syntax to refer to any shape on the page, whether the shape is in a group or is a parent of a shape.</span></span>
    
- <span data-ttu-id="7fba5-124">Имена, содержащие нестандартные символы, должны быть заключены в одиночные кавычках.</span><span class="sxs-lookup"><span data-stu-id="7fba5-124">Names that contain nonstandard characters must be enclosed in single quotation marks.</span></span> <span data-ttu-id="7fba5-125">Одинарные символы кавычка в нестандартных именах должны быть префиксом одной кавычка.</span><span class="sxs-lookup"><span data-stu-id="7fba5-125">Single quotation mark characters in a nonstandard name must be prefixed by a single quotation mark.</span></span>
    
|<span data-ttu-id="7fba5-126">**Ссылка на ячейку**</span><span class="sxs-lookup"><span data-stu-id="7fba5-126">**To reference a cell of**</span></span>|<span data-ttu-id="7fba5-127">**Используйте этот синтаксис**</span><span class="sxs-lookup"><span data-stu-id="7fba5-127">**Use this syntax**</span></span>|<span data-ttu-id="7fba5-128">**Пример**</span><span class="sxs-lookup"><span data-stu-id="7fba5-128">**Example**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="7fba5-129">Та же фигура</span><span class="sxs-lookup"><span data-stu-id="7fba5-129">The same shape</span></span>  <br/> | <span data-ttu-id="7fba5-130">CellName</span><span class="sxs-lookup"><span data-stu-id="7fba5-130">CellName</span></span>  <br/> | <span data-ttu-id="7fba5-131">Width</span><span class="sxs-lookup"><span data-stu-id="7fba5-131">Width</span></span>  <br/> |
| <span data-ttu-id="7fba5-132">Фигура, группа или руководство</span><span class="sxs-lookup"><span data-stu-id="7fba5-132">A shape, group, or guide</span></span>  <br/> | <span data-ttu-id="7fba5-133">Shapename! CellName</span><span class="sxs-lookup"><span data-stu-id="7fba5-133">Shapename!CellName</span></span>  <br/> | <span data-ttu-id="7fba5-134">Звездочка! Angle</span><span class="sxs-lookup"><span data-stu-id="7fba5-134">Star!Angle</span></span>  <br/> |
| <span data-ttu-id="7fba5-135">Фигура, группа или руководство, в которых несколько фигур на одном уровне с одинаковым именем</span><span class="sxs-lookup"><span data-stu-id="7fba5-135">A shape, group, or guide in which more than one shape at the same level has the same name</span></span>  <br/> | <span data-ttu-id="7fba5-136">Shapename.ID! CellName</span><span class="sxs-lookup"><span data-stu-id="7fba5-136">Shapename.ID!CellName</span></span>  <br/> | <span data-ttu-id="7fba5-137">Executive.2! Height</span><span class="sxs-lookup"><span data-stu-id="7fba5-137">Executive.2!Height</span></span>  <br/> |
| <span data-ttu-id="7fba5-138">Именовательный столбец с индексными строками</span><span class="sxs-lookup"><span data-stu-id="7fba5-138">A named column with indexed rows</span></span>  <br/> | <span data-ttu-id="7fba5-139">Section.Column[index]</span><span class="sxs-lookup"><span data-stu-id="7fba5-139">Section.Column[index]</span></span>  <br/> | <span data-ttu-id="7fba5-140">Char.Font[3]</span><span class="sxs-lookup"><span data-stu-id="7fba5-140">Char.Font[3]</span></span>  <br/> |
| <span data-ttu-id="7fba5-141">Неименованный столбец с индексными строками</span><span class="sxs-lookup"><span data-stu-id="7fba5-141">An unnamed column with indexed rows</span></span>  <br/> | <span data-ttu-id="7fba5-142">Section.ColumnIndex</span><span class="sxs-lookup"><span data-stu-id="7fba5-142">Section.ColumnIndex</span></span>  <br/> | <span data-ttu-id="7fba5-143">Scratch.A5</span><span class="sxs-lookup"><span data-stu-id="7fba5-143">Scratch.A5</span></span>  <br/> |
| <span data-ttu-id="7fba5-144">Любая фигура, страница, хозяин или стиль</span><span class="sxs-lookup"><span data-stu-id="7fba5-144">Any shape, page, master, or style</span></span>  <br/> | <span data-ttu-id="7fba5-145">Sheet.ID! CellName</span><span class="sxs-lookup"><span data-stu-id="7fba5-145">Sheet.ID!CellName</span></span>  <br/> | <span data-ttu-id="7fba5-146">Лист.8! FillForegnd</span><span class="sxs-lookup"><span data-stu-id="7fba5-146">Sheet.8!FillForegnd</span></span>  <br/> |
| <span data-ttu-id="7fba5-147">Хозяин</span><span class="sxs-lookup"><span data-stu-id="7fba5-147">A master</span></span>  <br/> | <span data-ttu-id="7fba5-148">Masters[MasterName]! SheetName! CellReference</span><span class="sxs-lookup"><span data-stu-id="7fba5-148">Masters[MasterName]!SheetName!CellReference</span></span>  <br/> | <span data-ttu-id="7fba5-149">Masters[Gear]! Подавно! Geometry1.X1</span><span class="sxs-lookup"><span data-stu-id="7fba5-149">Masters[Gear]!Shaft!Geometry1.X1</span></span>  <br/> |
| <span data-ttu-id="7fba5-150">Страница или эта страница, на которой расположен объект</span><span class="sxs-lookup"><span data-stu-id="7fba5-150">The page or master page on which the object is located</span></span>  <br/> | <span data-ttu-id="7fba5-151">ThePage! CellReference</span><span class="sxs-lookup"><span data-stu-id="7fba5-151">ThePage!CellReference</span></span>  <br/> | <span data-ttu-id="7fba5-152">ThePage! User.Vanishing_Point</span><span class="sxs-lookup"><span data-stu-id="7fba5-152">ThePage!User.Vanishing_Point</span></span>  <br/> |
| <span data-ttu-id="7fba5-153">Другая страница в документе</span><span class="sxs-lookup"><span data-stu-id="7fba5-153">Another page in the document</span></span>  <br/> | <span data-ttu-id="7fba5-154">Pages[PageName]! SheetName! CellReference</span><span class="sxs-lookup"><span data-stu-id="7fba5-154">Pages[PageName]!SheetName!CellReference</span></span>  <br/> | <span data-ttu-id="7fba5-155">Pages[Page-3]! Лист.4! BeginX</span><span class="sxs-lookup"><span data-stu-id="7fba5-155">Pages[Page-3]!Sheet.4!BeginX</span></span>  <br/> |
| <span data-ttu-id="7fba5-156">Стиль</span><span class="sxs-lookup"><span data-stu-id="7fba5-156">A style</span></span>  <br/> | <span data-ttu-id="7fba5-157">Стили! SheetName! CellReference</span><span class="sxs-lookup"><span data-stu-id="7fba5-157">Styles!SheetName!CellReference</span></span>  <br/> | <span data-ttu-id="7fba5-158">Стили! Руководитель! LineColor</span><span class="sxs-lookup"><span data-stu-id="7fba5-158">Styles!Manager!LineColor</span></span>  <br/> |
| <span data-ttu-id="7fba5-159">Документ</span><span class="sxs-lookup"><span data-stu-id="7fba5-159">The document</span></span>  <br/> | <span data-ttu-id="7fba5-160">TheDoc! CellReference</span><span class="sxs-lookup"><span data-stu-id="7fba5-160">TheDoc!CellReference</span></span>  <br/> | <span data-ttu-id="7fba5-161">TheDoc! PreviewQuality</span><span class="sxs-lookup"><span data-stu-id="7fba5-161">TheDoc!PreviewQuality</span></span>  <br/> |
| <span data-ttu-id="7fba5-162">Фигура, страница, хозяин, документ или стиль с нестандартным именем.</span><span class="sxs-lookup"><span data-stu-id="7fba5-162">A shape, page, master, document, or style with a nonstandard name.</span></span>  <br/> | <span data-ttu-id="7fba5-163">'Sheetname'! CellName</span><span class="sxs-lookup"><span data-stu-id="7fba5-163">'Sheetname'!CellName</span></span>  <br/> | <span data-ttu-id="7fba5-164">'1-D'! LineColor</span><span class="sxs-lookup"><span data-stu-id="7fba5-164">'1-D'!LineColor</span></span>  <br/> |
   


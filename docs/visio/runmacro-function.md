---
title: Функция RUNMACRO
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm1033809
localization_priority: Normal
ms.assetid: 86b0f071-5e0b-56de-ff5b-63c114ad823a
description: Вызывает макрос в проекте Microsoft Visual Basic для приложений (VBA).
ms.openlocfilehash: 77045bd67fe9be9aab14e73199b33b93c6d70c2c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428090"
---
# <a name="runmacro-function"></a>Функция RUNMACRO

Вызывает макрос в проекте Microsoft Visual Basic для приложений (VBA). 
  
## <a name="syntax"></a>Синтаксис

ЗапускМакроса (* * *имяМакроса* * * [, * * *прожнаме_опт* * *]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Необходимость**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _макрос_ <br/> |Обязательный  <br/> |**String** <br/> |Имя вызываемого макроса.  <br/> |
| _прожнаме_опт_ <br/> |Необязательный  <br/> |**String** <br/> | Проект, содержащий макрос.  <br/> |
   
## <a name="remarks"></a>Примечания

Если указан проект, Microsoft Visio сканирует все открытые документы для элемента, содержащего _прожнаме_опт_ , и вызывает _макрос имяМакроса_ в этом проекте. Если _прожнаме_опт_ опущен или имеет значение null (""), предполагается, что _имяМакроса_ находится в проекте VBA документа, содержащего оцениваемую формулу ЗапускМакроса. 
  
Функция RUNMACRO отличается от функции CALLTHIS в том, что она не передает ссылку на фигуру, которой принадлежит формула, оцениваемую до _имяМакроса_. Как и в CALLTHIS, для вызова функции ЗАПУСКМАКРОСА не требуется ссылаться на _прожнаме_опт_ . 
  
 Код VBA, вызываемый, когда экземпляр Visio оценивает функцию ЗАПУСКМАКРОСА в формуле, не должно закрывать документ, содержащий ячейку, с помощью функции, так как результаты ошибки приложения и Visio завершает работу. 
  
Если вам нужно закрыть документ с ячейкой, использующей функцию ЗАПУСКМАКРОСА, используйте один из следующих способов:
  
- Закройте документ из кода, который не является VBA.
    
- Закройте документ из проекта, отличного от закрывающего.
    
- ПоМещать сообщения окна, чтобы закрыть окна в документе, а не закрывать документ.
    
Дополнительные сведения о запуске кода в Visio можно найти в статье [о параметрах безопасности и выполнении кода в Visio](about-security-settings-and-running-code-in-visio-shapesheet.md) в этой ссылке на таблицу свойств фигуры. 
  
## <a name="example"></a>Пример

В приведенном ниже примере вызывается макрос MyTest в модуле класса ThisDocument проекта VBA, содержащего формулу ЗАПУСКМАКРОСА. 
  
ЗАПУСКМАКРОСА ("ThisDocument. MyTest") 
  


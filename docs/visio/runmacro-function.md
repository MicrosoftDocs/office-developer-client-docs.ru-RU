---
title: Функция RUNMACRO
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
f1_keywords:
- Vis_DSS.chm1033809
localization_priority: Normal
ms.assetid: 86b0f071-5e0b-56de-ff5b-63c114ad823a
description: Вызывает макроса в Microsoft Visual Basic для приложений (VBA) проект.
ms.openlocfilehash: e3dd989956ce9c5f795ae3ef0d8535ab2776d6d7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19814717"
---
# <a name="runmacro-function"></a>Функция RUNMACRO

Вызывает макроса в Microsoft Visual Basic для приложений (VBA) проект. 
  
## <a name="syntax"></a>Синтаксис

ЗАПУСКМАКРОСА (** *имяМакроса* ** [, ** *projname_opt* **]) 
  
### <a name="parameters"></a>Параметры

|**Имя**|**Обязательный или необязательный**|**Тип данных**|**Описание**|
|:-----|:-----|:-----|:-----|
| _имяМакроса_ <br/> |Обязательный  <br/> |**Строка** <br/> |Имя макроса для вызова.  <br/> |
| _projname_opt_ <br/> |Optional  <br/> |**Строка** <br/> | Проект, содержащий макрос.  <br/> |
   
## <a name="remarks"></a>Замечания

Если проект указан, Microsoft Visio сканирование всех открытых документов для одного содержащего _projname_opt_ и вызовы _имяМакроса_ в проекте. Если _projname_opt_ неправильных или значение null ("»), _имяМакроса_ предполагается, что в проекте VBA документа, которая содержит формулу ЗАПУСКМАКРОСА вычислением. 
  
Функция ЗАПУСКМАКРОСА отличается от функции CALLTHIS, то есть не передает ссылку на фигуры, которому принадлежит вычислением _имяМакроса_формулу. Как CALLTHIS функция ЗАПУСКМАКРОСА не требуется ссылка на _projname_opt_ для его вызова. 
  
 Код VBA, которая вызывается при экземпляр Visio оценивает ЗАПУСКМАКРОСА функции в формуле не следует закрыть документ, содержащий ячейки, с помощью функции, так как возникает ошибка приложения и завершает Visio. 
  
Если необходимо закрыть документ, содержащий ячейки, которая использует функцию ЗАПУСКМАКРОСА, используйте один из следующих методов:
  
- Закройте документ, из кода, который не является VBA.
    
- Закройте документ из проекта не закрывается.
    
- Публиковать сообщения окна для закрытия окна в документе, а не закрытия документа.
    
Дополнительные сведения о запуске кода в Visio можно [о настройках безопасности и выполнение кода в Visio](about-security-settings-and-running-code-in-visio-shapesheet.md) в этом по таблице свойств фигуры. 
  
## <a name="example"></a>Пример

В следующем примере вызывается вызывает MyTest в модуле класса ThisDocument проекта VBA, содержащий формулу ЗАПУСКМАКРОСА макроса. 
  
ЗАПУСКМАКРОСА («ThisDocument.MyTest») 
  


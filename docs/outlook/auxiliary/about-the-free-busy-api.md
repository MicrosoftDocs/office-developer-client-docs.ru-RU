---
title: Сведения об API сведений о доступности
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 17c5e44e-ae56-8de7-3579-90171d996411
description: API сведений о доступности позволяет почтовым поставщикам предоставлять сведения о доступности для указанных учетных записей пользователей в указанном диапазоне времени.
ms.openlocfilehash: 1bcd191b57238771ede6f035216fe3997e82e03a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32317012"
---
# <a name="about-the-freebusy-api"></a>Сведения об API сведений о доступности

API сведений о доступности позволяет почтовым поставщикам предоставлять сведения о доступности для указанных учетных записей пользователей в указанном диапазоне времени. Сведения о занятости в календаре пользователя находятся на одном из следующих периодов: "нет на месте", "занято", "под вопросом" или "свободен".
  
## <a name="create-a-freebusy-provider"></a>Создание поставщика сведений о доступности

Чтобы предоставить пользователям почты доступ к сведениям о доступности, поставщик услуг электронной почты создает поставщика сведений о доступности и регистрирует его в Outlook. Поставщик сведений о доступности должен реализовывать следующие интерфейсы. Обратите внимание, что количество членов в этих интерфейсах не поддерживается и должно возвращать указанные возвращаемые значения. В частности, API сведений о доступности не поддерживает запись сведений о доступности и делегирование доступа к учетным записям.
  
- [Ифрибусисуппорт](ifreebusysupport.md) — этот интерфейс поддерживает спецификацию интерфейсов, которые обращаются к данным о занятости для указанных пользователей. Он использует [фбусер](fbuser.md) для идентификации пользователя. 
    
- [Ифрибусидата](ifreebusydata.md) — этот интерфейс получает и задает диапазон времени для заданного пользователя и возвращает интерфейс для перечисления блоков сведений о занятости для данных в пределах этого диапазона времени. Он использует относительное время для получения и задания этого диапазона времени. Дополнительные сведения см. [в разделе Использование относительного времени для доступа к данным о занятости](how-to-use-relative-time-to-access-free-busy-data.md).
    
- [Иенумфбблокк](ienumfbblock.md) — этот интерфейс поддерживает доступ и перечисление блоков сведений о занятости для пользователя в диапазоне времени. 
    
   > [!NOTE]
   > Перечисление содержит блоки сведений о занятости, которые указывают сведения о занятости периодов времени в календаре пользователя в диапазоне времени (указывается с помощью [ифрибусидата:: енумблоккс](ifreebusydata-enumblocks.md)). Элементы в календаре, такие как встречи и приглашения на собрания, блоки форм в перечислении. Элементы, расположенные рядом друг с другом в календаре и имеющие одинаковое состояние занятости, объединяются в один блок. Свободный период времени в календаре также образует блок. Поэтому никакие два последовательных блока в перечислении не будут иметь одинаковые сведения о доступности. Эти блоки не перекрываются по времени. При наличии перекрывающихся элементов в календаре Outlook выполняет слияние этих элементов для формирования неперекрывающихся блоков сведений о занятости в перечислении на основе следующего порядка приоритетов: "нет на месте", "занято" и "под вопросом". 
  
Чтобы зарегистрировать поставщика сведений о доступности в Outlook, Поставщик почты должен выполнить следующие действия:
  
1. ЗаРегистрируйте поставщик сведений о доступности в COM, предоставив CLSID, который предоставляет доступ к реализации поставщика **ифрибусисуппорт**. 
    
2. Сообщите Outlook, что существует поставщик сведений о доступности, задав следующий ключ (где `<xx.x>` представляет версию Outlook) в системном реестре: 
    
   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\<xx.x>\Outlook\SchedulingInformation\FreeBusySupport`
    
   Например, если поставщик транспорта является SMTP, для регистрации поставщика в Microsoft Outlook 2010 установите следующий ключ к данным в следующей таблице: 
    
   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\14.0\Outlook\SchedulingInformation\FreeBusySupport`
    
   |Имя |Тип |Значение |
   |:-----|:-----|:-----|
   |SMTP  |REG_SZ  |{CLSID для соответствующей реализации Ифрибусисуппорт  |
   
   В этом сценарии Outlook совместно создает COM-класс и использует его для получения сведений о занятости для всех почтовых пользователей SMTP.
    
Для поддержки адресной книги и поставщика транспорта, использующих тип записи адреса, отличный от SMTP, измените *имя* соответствующим образом. 
  
> [!NOTE]
> Во время установки поставщики сведений о доступности должны проверить, существует ли параметр реестра для того же типа записи адреса. Если это так, поставщик сведений о доступности должен перезаписать текущего поставщика для этого типа записи адреса и при удалении этого поставщика восстановить его. Тем не менее, если пользователь установил несколько поставщиков сведений о доступности для одного и того же типа записи адреса, пользователь должен удалить эти поставщики в обратном порядке по мере установки (то есть всегда удалять самого старого поставщика). В противном случае реестр может указать поставщика, который уже был удален. 
  
## <a name="api-components"></a>Компоненты API

API сведений о доступности включает следующие компоненты:
  
### <a name="definitions"></a>Определения

- [Константы (API сведений о доступности)](constants-free-busy-api.md)
    
### <a name="data-types"></a>Типы данных

- [FBBlock_1](fbblock_1.md)
- [FBStatus](fbstatus.md)
- [FBUser](fbuser.md)
    
### <a name="interfaces"></a>Интерфейсы

- [IEnumFBBlock](ienumfbblock.md)
- [IFreeBusyData](ifreebusydata.md)
- [IFreeBusySupport](ifreebusysupport.md)
    


---
title: Сведения об API сведений о доступности
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 17c5e44e-ae56-8de7-3579-90171d996411
description: API Free/Busy позволяет почтовым поставщикам предоставлять сведения о состоянии бесплатных и занятых для указанных учетных записей пользователей в указанном диапазоне времени.
ms.openlocfilehash: 1bcd191b57238771ede6f035216fe3997e82e03a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433761"
---
# <a name="about-the-freebusy-api"></a>Сведения об API сведений о доступности

API Free/Busy позволяет почтовым поставщикам предоставлять сведения о состоянии бесплатных и занятых для указанных учетных записей пользователей в указанном диапазоне времени. Состояние свободного или занятого блока времени в календаре пользователя является одним из следующих: вне офиса, занято, предварительно или бесплатно.
  
## <a name="create-a-freebusy-provider"></a>Создание бесплатного/занятого поставщика

Чтобы предоставить пользователям почты бесплатные и загруженные сведения, поставщик почты создает поставщика бесплатных и занятых и регистрирует его Outlook. Поставщик бесплатных и занятых услуг должен реализовать следующие интерфейсы. Обратите внимание, что ряд участников в этих интерфейсах не поддерживаются и должны возвращать указанные значения возврата. В частности, API Free/Busy не поддерживает запись доступа к бесплатным и загруженным сведениям и делегирует доступ к учетным записям.
  
- [IFreeBusySupport](ifreebusysupport.md) — этот интерфейс поддерживает спецификацию интерфейсов, которые имеют доступ к свободным и загруженным данным для указанных пользователей. Для [идентификации пользователя используется FBUser.](fbuser.md) 
    
- [IFreeBusyData](ifreebusydata.md) — этот интерфейс получает и задает диапазон времени для данного пользователя и возвращает интерфейс для записи бесплатных и загруженных блоков данных в этом диапазоне времени. Он использует относительное время для получения и набора этого диапазона времени. Дополнительные сведения см. в [см. в руб. Использование относительного времени для доступа к свободным и загруженным данным.](how-to-use-relative-time-to-access-free-busy-data.md)
    
- [IEnumFBBlock](ienumfbblock.md) — этот интерфейс поддерживает доступ к бесплатным и загруженным блокам данных для пользователя в диапазоне времени. 
    
   > [!NOTE]
   > В переумериях содержатся свободные и занятые блоки, которые указывают состояние свободного/занятого времени в календаре пользователя в пределах определенного периода времени (указанного [в IFreeBusyData::EnumBlocks).](ifreebusydata-enumblocks.md) Элементы календаря, такие как встречи и запросы на собрания, образуют блоки в переумериях. Элементы, которые находятся рядом друг с другом в календаре и имеют одинаковый статус свободного/занятого, объединяются в один блок. Свободный период времени в календаре также формирует блок. Таким образом, ни один из двух последовательных блоков в переумериях не будет иметь одинакового состояния свободного/занятого. Эти блоки не пересекаются во времени. Если в календаре есть перекрывающиеся элементы, Outlook объединяет эти элементы, чтобы сформировать не перекрывающиеся свободные и занятые блоки в переумериях на основе этого порядка приоритета: вне офиса, занят, предварительно. 
  
Чтобы зарегистрировать бесплатного или занятого поставщика в Outlook, поставщик почты должен сделать следующее:
  
1. Зарегистрируйте бесплатного/занятого поставщика в COM, предоставляя CLSID, который позволяет получить доступ к реализации **IFreeBusySupport.** 
    
2. Дайте Outlook, что поставщик бесплатных и занятых услуг существует, задав следующий ключ (где представлена версия Outlook) в `<xx.x>` реестре системы: 
    
   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\<xx.x>\Outlook\SchedulingInformation\FreeBusySupport`
    
   Например, если поставщиком транспорта является SMTP, чтобы зарегистрировать поставщика Microsoft Outlook 2010, русская версия, установите следующий ключ к данным в следующей таблице: 
    
   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\14.0\Outlook\SchedulingInformation\FreeBusySupport`
    
   |Имя |Тип |Значение |
   |:-----|:-----|:-----|
   |SMTP  |REG_SZ  |{CLSID для соответствующей реализации IFreeBusySupport}  |
   
   В этом сценарии Outlook создает класс COM и использует его для получения бесплатных и загруженных сведений для всех пользователей smTP-почты.
    
Чтобы поддерживать адресную книгу и поставщика транспорта, который использует тип записи адресов, кроме SMTP, измените  *имя* соответствующим образом. 
  
> [!NOTE]
> Во время установки поставщики бесплатных и занятых услуг должны проверить, существует ли параметр реестра для того же типа записи адресов. Если это так, поставщик бесплатных и занятых услуг должен переписать текущего поставщика для этого типа ввода адреса и восстановить этот поставщик при его отработке. Однако если пользователь установил несколько бесплатных и занятых поставщиков для одного типа записи адресов, он должен удалить этих поставщиков в обратном порядке в качестве установки (то есть всегда удалить последний поставщик). В противном случае реестр может указать на поставщика, который уже был неустановлен. 
  
## <a name="api-components"></a>Компоненты API

API Free/Busy включает следующие компоненты:
  
### <a name="definitions"></a>Определения

- [Константы (API free/busy)](constants-free-busy-api.md)
    
### <a name="data-types"></a>Типы данных

- [FBBlock_1](fbblock_1.md)
- [FBStatus](fbstatus.md)
- [FBUser](fbuser.md)
    
### <a name="interfaces"></a>Интерфейсы

- [IEnumFBBlock](ienumfbblock.md)
- [IFreeBusyData](ifreebusydata.md)
- [IFreeBusySupport](ifreebusysupport.md)
    


---
title: Сведения об API сведений о доступности
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 17c5e44e-ae56-8de7-3579-90171d996411
description: API сведений о занятости позволяет поставщикам почты предоставлять сведения о занятости для указанных учетных записей пользователей в заданный период времени.
ms.openlocfilehash: 1bcd191b57238771ede6f035216fe3997e82e03a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433761"
---
# <a name="about-the-freebusy-api"></a>Сведения об API сведений о доступности

API сведений о занятости позволяет поставщикам почты предоставлять сведения о занятости для указанных учетных записей пользователей в заданный период времени. Состояние занятости блока времени в календаре пользователя может быть одним из следующих: "нет на офисе", "занят", "под вопросом" или "свободен".
  
## <a name="create-a-freebusy-provider"></a>Создание поставщика услуг занятости

Чтобы предоставить пользователям почты сведения о занятости, поставщик почты создает поставщика услуг занятости и регистрирует его в Outlook. Поставщик услуг занятости должен реализовать следующие интерфейсы. Обратите внимание, что некоторые члены в этих интерфейсах не поддерживаются и должны возвращать указанные возвращаемые значения. В частности, API занятости не поддерживает доступ на запись к сведениям о доступности и делегирование доступа к учетным записям.
  
- [IFreeBusySupport](ifreebusysupport.md) — этот интерфейс поддерживает спецификацию интерфейсов, которые имеют доступ к сведениям о доступности для указанных пользователей. Для [идентификации пользователя используется FBUser.](fbuser.md) 
    
- [IFreeBusyData](ifreebusydata.md) — этот интерфейс получает и задает диапазон времени для данного пользователя и возвращает интерфейс для нумерации блоков данных о занятости в пределах этого диапазона времени. Для получения и применения этого диапазона времени используется относительное время. Дополнительные сведения см. в сведениях [об использовании относительного времени для доступа к сведениям о доступности.](how-to-use-relative-time-to-access-free-busy-data.md)
    
- [IEnumFBBlock](ienumfbblock.md) — этот интерфейс поддерживает доступ к блокам данных о доступности и их нумерации для пользователя в течение задающегося диапазона времени. 
    
   > [!NOTE]
   > Enumeration contains free/busy blocks that indicate the free/busy status of periods of time on a user's calendar, within a time range (specified by [IFreeBusyData::EnumBlocks).](ifreebusydata-enumblocks.md) Элементы в календаре, такие как встречи и запросы на собрания, блоки формы в этом нумерации. Элементы, которые находятся рядом друг с другом в календаре и имеют одинаковое состояние занятости, объединяются в один блок. Бесплатный период времени в календаре также формирует блок. Таким образом, два последовательных блока в нумерации не будут иметь одинаковое состояние занятости. Эти блоки не перекрываются во времени. Если в календаре имеются перекрывающиеся элементы, Outlook объединяет эти элементы для формирования не перекрывающихся блоков занятости и занятости в порядке приоритета: "нет на офисе", "занят", "под вопросом". 
  
Чтобы зарегистрировать поставщика услуг занятости в Outlook, поставщик почты должен сделать следующее:
  
1. Зарегистрируйте поставщика услуг занятости в COM, предоставив CLSID, который предоставляет доступ к реализации **IFreeBusySupport** поставщиком. 
    
2. Let Outlook know that the free/busy provider exists by setting the following key (where `<xx.x>` represents the version of Outlook) in the system registry: 
    
   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\<xx.x>\Outlook\SchedulingInformation\FreeBusySupport`
    
   Например, если поставщиком транспорта является SMTP, чтобы зарегистрировать его в Microsoft Outlook 2010, русская версия, установите следующий ключ для данных в следующей таблице: 
    
   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\14.0\Outlook\SchedulingInformation\FreeBusySupport`
    
   |Имя |Тип |Значение |
   |:-----|:-----|:-----|
   |SMTP  |REG_SZ  |{CLSID для соответствующей реализации IFreeBusySupport}  |
   
   В этом сценарии Outlook совместно создает класс COM и использует его для получения сведений о занятости для всех пользователей почты SMTP.
    
Для поддержки адресной книги и поставщика транспорта, которые используют тип записи адреса, кроме SMTP, измените  *имя* соответствующим образом. 
  
> [!NOTE]
> Во время установки поставщики услуг занятости должны проверить, существует ли параметр реестра для того же типа записи адреса. В этом случае поставщик услуг занятости должен переописать текущего поставщика для этого типа записи адреса и восстановить его при его восстановлении. Однако если пользователь установил несколько поставщиков услуг занятости для одного типа записи адреса, он должен удалить этих поставщиков в обратном порядке в качестве установки (то есть всегда удалить последнего поставщика). В противном случае реестр может указать на поставщика, который уже был установлен. 
  
## <a name="api-components"></a>Компоненты API

API занятости включает следующие компоненты:
  
### <a name="definitions"></a>Определения

- [Constants (Free/busy API)](constants-free-busy-api.md)
    
### <a name="data-types"></a>Типы данных

- [FBBlock_1](fbblock_1.md)
- [FBStatus](fbstatus.md)
- [FBUser](fbuser.md)
    
### <a name="interfaces"></a>Интерфейсы

- [IEnumFBBlock](ienumfbblock.md)
- [IFreeBusyData](ifreebusydata.md)
- [IFreeBusySupport](ifreebusysupport.md)
    


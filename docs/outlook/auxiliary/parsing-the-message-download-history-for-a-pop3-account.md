---
title: Анализ журнала скачивания сообщений для учетной записи POP3
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 394e1430-04d6-4d61-be13-eb695309fa73
description: В этом разделе описываются структуры BLOB POP3, представляющий журнала загрузки сообщений учетной записи POP3 для идентификации сообщения, которые загружаются или удалении для этой учетной записи.
ms.openlocfilehash: 44a799f6b6fbe2a2841522c18405149a470b0236
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25389010"
---
# <a name="parsing-the-message-download-history-for-a-pop3-account"></a>Анализ журнала скачивания сообщений для учетной записи POP3

В этом разделе описываются структуры BLOB POP3, представляющий журнала загрузки сообщений учетной записи POP3 для идентификации сообщения, которые загружаются или удалении для этой учетной записи.

<a name="OL15Con_AuxRef_ParsingMsgsHistory_WhyParseHistory"> </a>

## <a name="why-parse-the-message-download-history"></a>Почему синтаксический анализ журнала загрузки сообщений?

Поставщик протокол POP (Post Office) для Outlook позволяет пользователям для получения и загрузки новых сообщений электронной почты для своих локальных устройств и впоследствии оставьте или удалять эти сообщения электронной почты на почтовом сервере. При почтового клиента проверяет наличие новых сообщений для загрузки, она должна быть возможность определения и загружать только новые сообщения для этой папки "Входящие". Почтовый клиент делает это с помощью команды UIDL (уникальный идентификатор со списком) для получения карты каждого сообщения, когда-либо было доставлено для этой папки "Входящие" с уникальным идентификатором (UID). Клиент получает журнала загрузки сообщений для сообщений, которые загружаются или удалены для папки "Входящие" на клиента. С помощью сообщения UID карты и журнал загрузки, клиент может затем определите сообщения, отсутствующих в журнале как новый и, следовательно, необходимо загрузить.
  
Для получения журнала загрузки сообщений для папки "Входящие":
  
- Выполните действия, описанные в [Поиск сообщения журнала для учетной записи POP3 загрузки](locating-the-message-download-history-for-a-pop3-account.md) для поиска свойства [PidTagAttachDataBinary](https://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) , который содержит больших двоичных объектов (BLOB), который представляет журнал сообщений для учетной записи POP3. 
    
- Прочтите этот раздел, который описывает структуру больших двоичных ОБЪЕКТОВ и показан пример больших двоичных ОБЪЕКТОВ для идентификации сообщений, которые загружаются или удалены для папки "Входящие" учетной записи POP3.

<a name="OL15Con_AuxRef_ParsingMsgsHistory_BLOBStructure"> </a>

## <a name="pop-blob-structure"></a>Структура POP больших двоичных ОБЪЕКТОВ

POP больших двоичных ОБЪЕКТОВ, как описано в таблице 1 начинается с два поля, **версии** и **Count**, за которым следует номер **Count** тегов ресурсов, каждый из которых является символом null. 
  
**В таблице 1. Структура больших двоичных ОБЪЕКТОВ, представляющий сообщение загрузить журнал учетной записи POP3**

|**Поля в больших двоичных ОБЪЕКТОВ**|**Размер**|**Описание**|
|:-----|:-----|:-----|
|**Версия** <br/> |2 байта  <br/> |Должен быть 3 (**PBLOB_VERSION_NUM**).  <br/> |
|**Count** <br/> |2 байта  <br/> |Количество ресурсов теги в этом больших двоичных ОБЪЕКТОВ.  <br/> |
|Тег ресурса  <br/> |Переменная  <br/> |0 или более символом null строки UTF-8, кодирование теги ресурсов. Количество строк символом null должно соответствовать **Count**.  <br/> |
   
Каждый ресурс тег определяет операцию, которая применяется к сообщению некоторых метаданных даты и времени операции и кодировка ИД пользователя сообщения. Формат строки тега ресурсов разбита следующим образом и дальнейшей описываются в таблице 2. 
  
`Ocyyyymmddhhmmssuuu...`
  
**В таблице 2. Структура тега ресурсов**

|**Поля в теге ресурсов**|**Размер**|**Описание**|
|:-----|:-----|:-----|
| `O` <br/> |1 знак  <br/> |Операции в окне сообщения электронной почты. Значение должно быть «+», «-», или "&amp;«, который означает успешное get, удалить или операцию get-delete, соответственно.  <br/> |
| `c` <br/> |1 знак  <br/> |Часть содержимого сообщения, участвующих в данной операции. Значение должно быть "«, «h» или «b», который указывает содержимое none, или заголовков, соответственно.  <br/> |
| `yyyy` <br/> |4 символов  <br/> |Год из четырех цифр операции.  <br/> |
| `MM` <br/> |2 символов  <br/> |Месяца из двух цифр операции.  <br/> |
| `dd` <br/> |2 символов  <br/> |День из двух цифр операции.  <br/> |
| `hh` <br/> |2 символов  <br/> |Час из двух цифр операции.  <br/> |
| `mm` <br/> |2 символов  <br/> |Минуту из двух цифр операции.  <br/> |
| `ss` <br/> |2 символов  <br/> |Второй из двух цифр операции.  <br/> |
| `uuu…` <br/> |Переменной длины  <br/> |Закодированный уникальный идентификатор сообщения.  <br/> |

<a name="OL15Con_AuxRef_ParsingMsgsHistory_Example"> </a>

## <a name="example"></a>Пример

На рисунке 1 показан пример больших двоичных ОБЪЕКТОВ, представляющий журнала загрузки сообщений учетной записи POP. 
  
**На рисунке 1. Пример структуры больших двоичных ОБЪЕКТОВ для сообщения загрузить журнал учетной записи POP3**

![Большой двоичный объект для истории загрузки сообщений учетной записи POP3](media/OL15Con_AuxRef_ParsingMsgsHistory_Blob.gif)
  
На основе структуры описано в таблице 1 и 2, в этом больших двоичных ОБЪЕКТОВ представляет журнала загрузки 23 сообщений электронной почты.
  
Синтаксический анализ необработанного ИД пользователя в каждом теге ресурсов, необходимо учитывать, что UID исходя из кодировку: символов в UID являются преимущественно буквенно-цифровых символов и всех не являющиеся буквенно-цифровых символов предшествует ASCII символ «$» (0x24). Поэтому символов ASCII, значение 2d представляют, не являющиеся буквенно-цифровыми символ $ «-». На рисунке 2 показан пример сначала преобразование необработанного ИД пользователя в теге ресурсов 1 в ТЕКСТОВОМ виде, а затем преобразование любой не являющиеся буквенно-цифровых символов, начинаются с символа «$» для создания фактический ИД пользователя:
  
`0BC535DB-EA63-11E1-A75C-00215AD7BB74`
  
**На рисунке 2. Преобразование необработанного ИД пользователя в теге ресурсов в фактический ИД пользователя сообщения**

![Преобразование необработанного ИД пользователя в большом двоичном объекте в фактический ИД пользователя сообщения](media/OL15Con_AuxRef_ParsingMsgsHistory_BlobRscTag.gif)
  
Интерпретация ресурсов тег 1 в этом больших двоичных ОБЪЕКТОВ: сообщения с UID `0BC535DB-EA63-11E1-A75C-00215AD7BB74` был успешно извлечен на 6 сентября 2012 г., в 13:11:38. 
  
Аналогичным образом может проанализировать оставшиеся теги 22 ресурсов для этого больших двоичных ОБЪЕКТОВ.
  
## <a name="see-also"></a>См. также
<a name="OL15Con_AuxRef_ParsingMsgsHistory_AdditionalRsc"> </a>

- [Управление скачиванием сообщений для учетных записей POP3](managing-message-downloads-for-pop3-accounts.md)    
- [Поиск журнала скачивания сообщений для учетной записи POP3](locating-the-message-download-history-for-a-pop3-account.md)    
- [Синтаксический анализ журнала UIDL POP3](https://blogs.msdn.com/b/stephen_griffin/archive/2012/12/04/parsing-the-pop3-uidl-history.aspx)
    


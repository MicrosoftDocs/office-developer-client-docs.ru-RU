---
title: Синтаксический анализ журнала загрузки сообщений для учетной записи POP3
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 394e1430-04d6-4d61-be13-eb695309fa73
description: В этом разделе описываются структуры BLOB POP3, представляющий журнала загрузки сообщений учетной записи POP3 для идентификации сообщения, которые загружаются или удалении для этой учетной записи.
ms.openlocfilehash: ffed3178e4e8b45f17fc335575a7febd77d40902
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19807926"
---
# <a name="parsing-the-message-download-history-for-a-pop3-account"></a><span data-ttu-id="c89aa-103">Синтаксический анализ журнала загрузки сообщений для учетной записи POP3</span><span class="sxs-lookup"><span data-stu-id="c89aa-103">Parsing the message download history for a POP3 account</span></span>

<span data-ttu-id="c89aa-104">В этом разделе описываются структуры BLOB POP3, представляющий журнала загрузки сообщений учетной записи POP3 для идентификации сообщения, которые загружаются или удалении для этой учетной записи.</span><span class="sxs-lookup"><span data-stu-id="c89aa-104">This topic describes the structure of the POP3 BLOB that represents the message download history of a POP3 account, to identify the messages that have been downloaded or deleted on that account.</span></span>

<span data-ttu-id="c89aa-105"><a name="OL15Con_AuxRef_ParsingMsgsHistory_WhyParseHistory"> </a></span><span class="sxs-lookup"><span data-stu-id="c89aa-105"></span></span>

## <a name="why-parse-the-message-download-history"></a><span data-ttu-id="c89aa-106">Почему синтаксический анализ журнала загрузки сообщений?</span><span class="sxs-lookup"><span data-stu-id="c89aa-106">Why parse the message download history?</span></span>

<span data-ttu-id="c89aa-107">Поставщик протокол POP (Post Office) для Outlook позволяет пользователям для получения и загрузки новых сообщений электронной почты для своих локальных устройств и впоследствии оставьте или удалять эти сообщения электронной почты на почтовом сервере.</span><span class="sxs-lookup"><span data-stu-id="c89aa-107">The Post Office Protocol (POP) provider for Outlook allows users to retrieve and download new email messages on their local device, and subsequently to leave or delete these email messages on the mail server.</span></span> <span data-ttu-id="c89aa-108">При почтового клиента проверяет наличие новых сообщений для загрузки, она должна быть возможность определения и загружать только новые сообщения для этой папки "Входящие".</span><span class="sxs-lookup"><span data-stu-id="c89aa-108">When the mail client checks for new messages to download, it has to be able to identify and download only the new messages for that Inbox.</span></span> <span data-ttu-id="c89aa-109">Почтовый клиент делает это с помощью команды UIDL (уникальный идентификатор со списком) для получения карты каждого сообщения, когда-либо было доставлено для этой папки "Входящие" с уникальным идентификатором (UID).</span><span class="sxs-lookup"><span data-stu-id="c89aa-109">The mail client does this by first using the UIDL (Unique ID Listing) command to obtain a map of each message that has ever been delivered to that Inbox to a unique identifier (UID).</span></span> <span data-ttu-id="c89aa-110">Клиент получает журнала загрузки сообщений для сообщений, которые загружаются или удалены для папки "Входящие" на клиента.</span><span class="sxs-lookup"><span data-stu-id="c89aa-110">The client also gets the message download history for messages that have been downloaded or deleted for the Inbox on that client.</span></span> <span data-ttu-id="c89aa-111">С помощью сообщения UID карты и журнал загрузки, клиент может затем определите сообщения, отсутствующих в журнале как новый и, следовательно, необходимо загрузить.</span><span class="sxs-lookup"><span data-stu-id="c89aa-111">Using the message UID map and download history, the client can then identify those messages that are absent from the history as new and, hence, should be downloaded.</span></span>
  
<span data-ttu-id="c89aa-112">Для получения журнала загрузки сообщений для папки "Входящие":</span><span class="sxs-lookup"><span data-stu-id="c89aa-112">To get the messages download history for an Inbox:</span></span>
  
- <span data-ttu-id="c89aa-113">Выполните действия, описанные в [Поиск сообщения журнала для учетной записи POP3 загрузки](locating-the-message-download-history-for-a-pop3-account.md) для поиска свойства [PidTagAttachDataBinary](http://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) , который содержит больших двоичных объектов (BLOB), который представляет журнал сообщений для учетной записи POP3.</span><span class="sxs-lookup"><span data-stu-id="c89aa-113">Follow the steps in [Locating the message download history for a POP3 account](locating-the-message-download-history-for-a-pop3-account.md) to find the [PidTagAttachDataBinary](http://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) property, which contains a binary large object (BLOB) that represents the message history for a POP3 account.</span></span> 
    
- <span data-ttu-id="c89aa-114">Прочтите этот раздел, который описывает структуру больших двоичных ОБЪЕКТОВ и показан пример больших двоичных ОБЪЕКТОВ для идентификации сообщений, которые загружаются или удалены для папки "Входящие" учетной записи POP3.</span><span class="sxs-lookup"><span data-stu-id="c89aa-114">Read this topic, which describes the structure of the BLOB, and shows an example BLOB to identify messages that have been downloaded or deleted for the Inbox of the POP3 account.</span></span>

<span data-ttu-id="c89aa-115"><a name="OL15Con_AuxRef_ParsingMsgsHistory_BLOBStructure"> </a></span><span class="sxs-lookup"><span data-stu-id="c89aa-115"></span></span>

## <a name="pop-blob-structure"></a><span data-ttu-id="c89aa-116">Структура POP больших двоичных ОБЪЕКТОВ</span><span class="sxs-lookup"><span data-stu-id="c89aa-116">POP BLOB structure</span></span>

<span data-ttu-id="c89aa-117">POP больших двоичных ОБЪЕКТОВ, как описано в таблице 1 начинается с два поля, **версии** и **Count**, за которым следует номер **Count** тегов ресурсов, каждый из которых является символом null.</span><span class="sxs-lookup"><span data-stu-id="c89aa-117">The POP BLOB structure, as described in Table 1, begins with two fields, **Version** and **Count**, followed by a **Count** number of resource tags, each of which is null-terminated.</span></span> 
  
<span data-ttu-id="c89aa-118">**В таблице 1. Структура больших двоичных ОБЪЕКТОВ, представляющий сообщение загрузить журнал учетной записи POP3**</span><span class="sxs-lookup"><span data-stu-id="c89aa-118">**Table 1. Structure of the BLOB that represents the message download history of a POP3 account**</span></span>

|<span data-ttu-id="c89aa-119">**Поля в больших двоичных ОБЪЕКТОВ**</span><span class="sxs-lookup"><span data-stu-id="c89aa-119">**Field in BLOB**</span></span>|<span data-ttu-id="c89aa-120">**Размер**</span><span class="sxs-lookup"><span data-stu-id="c89aa-120">**Size**</span></span>|<span data-ttu-id="c89aa-121">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c89aa-121">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="c89aa-122">**Версия**</span><span class="sxs-lookup"><span data-stu-id="c89aa-122">**Version**</span></span> <br/> |<span data-ttu-id="c89aa-123">2 байта</span><span class="sxs-lookup"><span data-stu-id="c89aa-123">2 bytes</span></span>  <br/> |<span data-ttu-id="c89aa-124">Должен быть 3 (**PBLOB_VERSION_NUM**).</span><span class="sxs-lookup"><span data-stu-id="c89aa-124">Must be 3 (**PBLOB_VERSION_NUM**).</span></span>  <br/> |
|<span data-ttu-id="c89aa-125">**Count**</span><span class="sxs-lookup"><span data-stu-id="c89aa-125">**Count**</span></span> <br/> |<span data-ttu-id="c89aa-126">2 байта</span><span class="sxs-lookup"><span data-stu-id="c89aa-126">2 bytes</span></span>  <br/> |<span data-ttu-id="c89aa-127">Количество ресурсов теги в этом больших двоичных ОБЪЕКТОВ.</span><span class="sxs-lookup"><span data-stu-id="c89aa-127">The number of resource tags in this BLOB.</span></span>  <br/> |
|<span data-ttu-id="c89aa-128">Тег ресурса</span><span class="sxs-lookup"><span data-stu-id="c89aa-128">Resource tag</span></span>  <br/> |<span data-ttu-id="c89aa-129">Переменная</span><span class="sxs-lookup"><span data-stu-id="c89aa-129">Variable</span></span>  <br/> |<span data-ttu-id="c89aa-130">0 или более символом null строки UTF-8, кодирование теги ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c89aa-130">0 or more null-terminated UTF-8 strings that encode the resource tags.</span></span> <span data-ttu-id="c89aa-131">Количество строк символом null должно соответствовать **Count**.</span><span class="sxs-lookup"><span data-stu-id="c89aa-131">The number of null-terminated strings must match **Count**.</span></span>  <br/> |
   
<span data-ttu-id="c89aa-132">Каждый ресурс тег определяет операцию, которая применяется к сообщению некоторых метаданных даты и времени операции и кодировка ИД пользователя сообщения.</span><span class="sxs-lookup"><span data-stu-id="c89aa-132">Each resource tag specifies the operation that is applied to a message, some date-time metadata about the operation, and encodes the UID of the message.</span></span> <span data-ttu-id="c89aa-133">Формат строки тега ресурсов разбита следующим образом и дальнейшей описываются в таблице 2.</span><span class="sxs-lookup"><span data-stu-id="c89aa-133">The format of a resource tag string is broken down as follows, and is further explained in Table 2.</span></span> 
  
`Ocyyyymmddhhmmssuuu...`
  
<span data-ttu-id="c89aa-134">**В таблице 2. Структура тега ресурсов**</span><span class="sxs-lookup"><span data-stu-id="c89aa-134">**Table 2. Structure of a resource tag**</span></span>

|<span data-ttu-id="c89aa-135">**Поля в теге ресурсов**</span><span class="sxs-lookup"><span data-stu-id="c89aa-135">**Field in a resource tag**</span></span>|<span data-ttu-id="c89aa-136">**Размер**</span><span class="sxs-lookup"><span data-stu-id="c89aa-136">**Size**</span></span>|<span data-ttu-id="c89aa-137">**Описание**</span><span class="sxs-lookup"><span data-stu-id="c89aa-137">**Description**</span></span>|
|:-----|:-----|:-----|
| `O` <br/> |<span data-ttu-id="c89aa-138">1 знак</span><span class="sxs-lookup"><span data-stu-id="c89aa-138">1 character</span></span>  <br/> |<span data-ttu-id="c89aa-139">Операции в окне сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="c89aa-139">The operation performed on the email message.</span></span> <span data-ttu-id="c89aa-140">Значение должно быть «+», «-», или "&amp;«, который означает успешное get, удалить или операцию get-delete, соответственно.</span><span class="sxs-lookup"><span data-stu-id="c89aa-140">The value must be "+", "-", or "&amp;", which indicates a successful get, delete, or get-and-delete operation, respectively.</span></span>  <br/> |
| `c` <br/> |<span data-ttu-id="c89aa-141">1 знак</span><span class="sxs-lookup"><span data-stu-id="c89aa-141">1 character</span></span>  <br/> |<span data-ttu-id="c89aa-142">Часть содержимого сообщения, участвующих в данной операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-142">The part of the message content involved in the operation.</span></span> <span data-ttu-id="c89aa-143">Значение должно быть "«, «h» или «b», который указывает содержимое none, или заголовков, соответственно.</span><span class="sxs-lookup"><span data-stu-id="c89aa-143">The value must be " ", "h", or "b", which indicates the content of none, header, or body, respectively.</span></span>  <br/> |
| `yyyy` <br/> |<span data-ttu-id="c89aa-144">4 символов</span><span class="sxs-lookup"><span data-stu-id="c89aa-144">4 characters</span></span>  <br/> |<span data-ttu-id="c89aa-145">Год из четырех цифр операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-145">The four-digit year of the operation.</span></span>  <br/> |
| `MM` <br/> |<span data-ttu-id="c89aa-146">2 символов</span><span class="sxs-lookup"><span data-stu-id="c89aa-146">2 characters</span></span>  <br/> |<span data-ttu-id="c89aa-147">Месяца из двух цифр операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-147">The two-digit month of the operation.</span></span>  <br/> |
| `dd` <br/> |<span data-ttu-id="c89aa-148">2 символов</span><span class="sxs-lookup"><span data-stu-id="c89aa-148">2 characters</span></span>  <br/> |<span data-ttu-id="c89aa-149">День из двух цифр операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-149">The two-digit day of the operation.</span></span>  <br/> |
| `hh` <br/> |<span data-ttu-id="c89aa-150">2 символов</span><span class="sxs-lookup"><span data-stu-id="c89aa-150">2 characters</span></span>  <br/> |<span data-ttu-id="c89aa-151">Час из двух цифр операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-151">The two-digit hour of the operation.</span></span>  <br/> |
| `mm` <br/> |<span data-ttu-id="c89aa-152">2 символов</span><span class="sxs-lookup"><span data-stu-id="c89aa-152">2 characters</span></span>  <br/> |<span data-ttu-id="c89aa-153">Минуту из двух цифр операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-153">The two-digit minute of the operation.</span></span>  <br/> |
| `ss` <br/> |<span data-ttu-id="c89aa-154">2 символов</span><span class="sxs-lookup"><span data-stu-id="c89aa-154">2 characters</span></span>  <br/> |<span data-ttu-id="c89aa-155">Второй из двух цифр операции.</span><span class="sxs-lookup"><span data-stu-id="c89aa-155">The two-digit second of the operation.</span></span>  <br/> |
| `uuu…` <br/> |<span data-ttu-id="c89aa-156">Переменной длины</span><span class="sxs-lookup"><span data-stu-id="c89aa-156">Variable length</span></span>  <br/> |<span data-ttu-id="c89aa-157">Закодированный уникальный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="c89aa-157">The encoded UID of a message.</span></span>  <br/> |

<span data-ttu-id="c89aa-158"><a name="OL15Con_AuxRef_ParsingMsgsHistory_Example"> </a></span><span class="sxs-lookup"><span data-stu-id="c89aa-158"></span></span>

## <a name="example"></a><span data-ttu-id="c89aa-159">Пример</span><span class="sxs-lookup"><span data-stu-id="c89aa-159">Example</span></span>

<span data-ttu-id="c89aa-160">На рисунке 1 показан пример больших двоичных ОБЪЕКТОВ, представляющий журнала загрузки сообщений учетной записи POP.</span><span class="sxs-lookup"><span data-stu-id="c89aa-160">Figure 1 shows an example of a BLOB that represents the message download history of a POP account.</span></span> 
  
<span data-ttu-id="c89aa-161">**На рисунке 1. Пример структуры больших двоичных ОБЪЕКТОВ для сообщения загрузить журнал учетной записи POP3**</span><span class="sxs-lookup"><span data-stu-id="c89aa-161">**Figure 1. Example BLOB structure for the message download history of a POP3 account**</span></span>

![Большой двоичный объект для истории загрузки сообщений учетной записи POP3](media/OL15Con_AuxRef_ParsingMsgsHistory_Blob.gif)
  
<span data-ttu-id="c89aa-163">На основе структуры описано в таблице 1 и 2, в этом больших двоичных ОБЪЕКТОВ представляет журнала загрузки 23 сообщений электронной почты.</span><span class="sxs-lookup"><span data-stu-id="c89aa-163">Based on the structure described in Table 1 and Table 2, this BLOB represents the download history of 23 email messages.</span></span>
  
<span data-ttu-id="c89aa-164">Синтаксический анализ необработанного ИД пользователя в каждом теге ресурсов, необходимо учитывать, что UID исходя из кодировку: символов в UID являются преимущественно буквенно-цифровых символов и всех не являющиеся буквенно-цифровых символов предшествует ASCII символ «$» (0x24).</span><span class="sxs-lookup"><span data-stu-id="c89aa-164">To parse the raw UID in each resource tag, be aware that the UID follows this encoding: characters in a UID are mostly alphanumeric characters, and each non-alphanumeric character is preceded by the ASCII character "$" (0x24).</span></span> <span data-ttu-id="c89aa-165">Поэтому символов ASCII, значение 2d представляют, не являющиеся буквенно-цифровыми символ $ «-».</span><span class="sxs-lookup"><span data-stu-id="c89aa-165">So the ASCII characters $2d represent the non-alphanumeric character "-".</span></span> <span data-ttu-id="c89aa-166">На рисунке 2 показан пример сначала преобразование необработанного ИД пользователя в теге ресурсов 1 в ТЕКСТОВОМ виде, а затем преобразование любой не являющиеся буквенно-цифровых символов, начинаются с символа «$» для создания фактический ИД пользователя:</span><span class="sxs-lookup"><span data-stu-id="c89aa-166">Figure 2 shows an example of first converting the raw UID in resource tag 1 to the ASCII representation, then converting any non-alphanumeric character preceded by "$" to produce the actual UID:</span></span>
  
`0BC535DB-EA63-11E1-A75C-00215AD7BB74`
  
<span data-ttu-id="c89aa-167">**На рисунке 2. Преобразование необработанного ИД пользователя в теге ресурсов в фактический ИД пользователя сообщения**</span><span class="sxs-lookup"><span data-stu-id="c89aa-167">**Figure 2. Converting the raw UID in a resource tag to the actual message UID**</span></span>

![Преобразование необработанного ИД пользователя в большом двоичном объекте в фактический ИД пользователя сообщения](media/OL15Con_AuxRef_ParsingMsgsHistory_BlobRscTag.gif)
  
<span data-ttu-id="c89aa-169">Интерпретация ресурсов тег 1 в этом больших двоичных ОБЪЕКТОВ: сообщения с UID `0BC535DB-EA63-11E1-A75C-00215AD7BB74` был успешно извлечен на 6 сентября 2012 г., в 13:11:38.</span><span class="sxs-lookup"><span data-stu-id="c89aa-169">To interpret resource tag 1 in this BLOB: the message with the UID  `0BC535DB-EA63-11E1-A75C-00215AD7BB74` was successfully retrieved on September 6, 2012, at 13:11:38.</span></span> 
  
<span data-ttu-id="c89aa-170">Аналогичным образом может проанализировать оставшиеся теги 22 ресурсов для этого больших двоичных ОБЪЕКТОВ.</span><span class="sxs-lookup"><span data-stu-id="c89aa-170">You can similarly parse the remaining 22 resource tags for that BLOB.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="c89aa-171">См. также</span><span class="sxs-lookup"><span data-stu-id="c89aa-171">See also</span></span>
<span data-ttu-id="c89aa-172"><a name="OL15Con_AuxRef_ParsingMsgsHistory_AdditionalRsc"> </a></span><span class="sxs-lookup"><span data-stu-id="c89aa-172"></span></span>

- [<span data-ttu-id="c89aa-173">Загружаемые файлы для управления сообщения для учетных записей POP3</span><span class="sxs-lookup"><span data-stu-id="c89aa-173">Managing message downloads for POP3 accounts</span></span>](managing-message-downloads-for-pop3-accounts.md)    
- [<span data-ttu-id="c89aa-174">Поиск журнала загрузки сообщений для учетной записи POP3</span><span class="sxs-lookup"><span data-stu-id="c89aa-174">Locating the message download history for a POP3 account</span></span>](locating-the-message-download-history-for-a-pop3-account.md)    
- [<span data-ttu-id="c89aa-175">Синтаксический анализ журнала UIDL POP3</span><span class="sxs-lookup"><span data-stu-id="c89aa-175">Parsing the POP3 UIDL History</span></span>](http://blogs.msdn.com/b/stephen_griffin/archive/2012/12/04/parsing-the-pop3-uidl-history.aspx)
    


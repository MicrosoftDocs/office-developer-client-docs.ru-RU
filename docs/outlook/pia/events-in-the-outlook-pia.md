---
title: События в Outlook PIA
TOCTitle: Events in the Outlook PIA
ms:assetid: 1f9eafb3-6645-4e27-81fa-5d73bf94ae40
ms:mtpsurl: https://msdn.microsoft.com/library/office/bb644571(v=office.15)
ms:contentKeyID: 55119782
ms.date: 07/24/2014
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 29217a633c02390587a370847291ef62d5621ce8
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325792"
---
# <a name="events-in-the-outlook-pia"></a><span data-ttu-id="9802e-102">События в Outlook PIA</span><span class="sxs-lookup"><span data-stu-id="9802e-102">Events in the Outlook PIA</span></span>

<span data-ttu-id="9802e-p101">При просмотре основной сборки взаимодействия Outlook (PIA) можно заметить, что многие интерфейсы и делегаты событий названы в соответствии со знакомыми именами объектов и событий в объектной модели Outlook. В отличие от событий в библиотеке типов COM события в Outlook PIA не определены в том же самом интерфейсе как методы и свойства этого же объекта. Связанные с событием интерфейсы, делегаты и классы модуля поддержки приемника либо импортируются, либо создаются для поддержки событий в Outlook PIA. В этом разделе описываются эти связанные с событиями интерфейсы, делегаты и классы модуля поддержки приемника.</span><span class="sxs-lookup"><span data-stu-id="9802e-p101">Browsing the Outlook Primary Interop Assembly (PIA), you might notice that many interfaces and event delegates are named after familiar names of objects and events in the Outlook object model. Unlike events in the COM type library, events in the Outlook PIA are not defined in the same interface as methods and properties of the same object. Event-related interfaces, delegates, and sink helper classes are either imported or created to support events in the Outlook PIA. This topic describes these event-related interfaces, delegates, and sink helper classes.</span></span>

## <a name="where-do-the-event-interfaces-delegates-and-sink-helper-classes-come-from"></a><span data-ttu-id="9802e-107">Откуда появляются интерфейсы событий, делегаты и классы модуля поддержки приемника</span><span class="sxs-lookup"><span data-stu-id="9802e-107">Where do the event interfaces, delegates, and Sink Helper classes come from</span></span>

<span data-ttu-id="9802e-p102">Для создания Outlook PIA в Outlook используется программа импорта библиотек типов (TLBIMP) в среде .NET Framework, позволяющая преобразовывать определения типов в библиотеке типов COM в эквивалентные определения в сборке среды CLR. Для каждого объекта TLBIMP импортирует следующие два типа интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9802e-p102">To create the Outlook PIA, Outlook uses the Type Library Importer (TLBIMP) in the .NET Framework to convert type definitions in the COM type library into equivalent definitions in a common language runtime (CLR) assembly. TLBIMP imports the following two types of interfaces for each object:</span></span>

  - <span data-ttu-id="9802e-110">Основной интерфейс (например, интерфейс [\_Application](https://msdn.microsoft.com/library/bb611255\(v=office.15\)))</span><span class="sxs-lookup"><span data-stu-id="9802e-110">The primary interface (for example, the [\_Application](https://msdn.microsoft.com/library/bb611255\(v=office.15\)) interface)</span></span>

  - <span data-ttu-id="9802e-111">Интерфейс события (например, интерфейс [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)))</span><span class="sxs-lookup"><span data-stu-id="9802e-111">The event interface (for example, the [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)) interface)</span></span>

<span data-ttu-id="9802e-p103">TLBIMP обрабатывает импортированные интерфейсы и создает ряд интерфейсов, делегатов и классов, включая интерфейс .NET (например, интерфейс [Application](https://msdn.microsoft.com/library/bb646615\(v=office.15\)) ). Если у объекта есть события, создаются следующие сущности:</span><span class="sxs-lookup"><span data-stu-id="9802e-p103">TLBIMP processes the imported interfaces and creates a number of interfaces, delegates, and classes, including the .NET interface (for example, the [Application](https://msdn.microsoft.com/library/bb646615\(v=office.15\)) interface). If the object has events, the following are created:</span></span>

  - <span data-ttu-id="9802e-114">Интерфейс события .NET (например, интерфейс [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)))</span><span class="sxs-lookup"><span data-stu-id="9802e-114">The .NET event interface (for example, the [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)) interface)</span></span>

  - <span data-ttu-id="9802e-115">Делегат для каждого события (например, делегат [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)))</span><span class="sxs-lookup"><span data-stu-id="9802e-115">Delegate for each event (for example, the [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)) delegate)</span></span>

  - <span data-ttu-id="9802e-116">Класс модуля поддержки приемника (например, класс [ApplicationEvents\_11\_SinkHelper](https://msdn.microsoft.com/library/bb609842\(v=office.15\)))</span><span class="sxs-lookup"><span data-stu-id="9802e-116">Sink helper class (for example, [ApplicationEvents\_11\_SinkHelper](https://msdn.microsoft.com/library/bb609842\(v=office.15\)) class)</span></span>

### <a name="multiple-versions-of-events"></a><span data-ttu-id="9802e-117">Несколько версий событий</span><span class="sxs-lookup"><span data-stu-id="9802e-117">Multiple versions of events</span></span>

<span data-ttu-id="9802e-p104">У ряда объектов, существующих для нескольких версий Outlook, есть различные реализации событий для этих версий и дополнительные события, добавленные по мере выхода новых версий. Для поддержки событий, зависящих от различных версий, Outlook отличает эти связанные с событиями интерфейсы, делегаты и классы, добавляя к их именам номер версии. Например:</span><span class="sxs-lookup"><span data-stu-id="9802e-p104">Some objects that have existed for multiple versions of Outlook have different implementations of events over the versions, and have had additional events added as new versions are released. To support events that vary over multiple versions, Outlook distinguishes these event-related interfaces, delegates, and classes by adding a version number to their names. For example:</span></span>

  - <span data-ttu-id="9802e-121">В число импортированных интерфейсов событий для объекта **Application** входят:</span><span class="sxs-lookup"><span data-stu-id="9802e-121">The imported event interfaces of the **Application** object includes:</span></span>
    
      - <span data-ttu-id="9802e-122">Самая ранняя версия для Outlook 98 и Outlook 2000: интерфейс [ApplicationEvents](https://msdn.microsoft.com/library/bb644093\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-122">The earliest version for Outlook 98 and Outlook 2000: the [ApplicationEvents](https://msdn.microsoft.com/library/bb644093\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="9802e-123">Версия для Outlook 2002: интерфейс [ApplicationEvents\_10](https://msdn.microsoft.com/library/bb647702\(v=office.15\)) </span><span class="sxs-lookup"><span data-stu-id="9802e-123">The version for Outlook 2002: the [ApplicationEvents\_10](https://msdn.microsoft.com/library/bb647702\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="9802e-124">Версия для Outlook 2003 и более поздних версий: интерфейс [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-124">The version for Outlook 2003 and later releases: the [ApplicationEvents\_11](https://msdn.microsoft.com/library/bb609229\(v=office.15\)) interface</span></span>

  - <span data-ttu-id="9802e-125">В интерфейсы события .NET, созданные TLBIMP для объекта **Application**, входят:</span><span class="sxs-lookup"><span data-stu-id="9802e-125">The .NET event interfaces created by TLBIMP for the **Application** object includes:</span></span>
    
      - <span data-ttu-id="9802e-126">Самая ранняя версия для Outlook 98 и Outlook 2000: интерфейс [ApplicationEvents\_Event](https://msdn.microsoft.com/library/bb609380\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-126">The earliest version for Outlook 98 and Outlook 2000: the [ApplicationEvents\_Event](https://msdn.microsoft.com/library/bb609380\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="9802e-127">Версия для Outlook 2002: интерфейс [ApplicationEvents\_10\_Event](https://msdn.microsoft.com/library/bb610098\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-127">The version for Outlook 2002: the [ApplicationEvents\_10\_Event](https://msdn.microsoft.com/library/bb610098\(v=office.15\)) interface</span></span>
    
      - <span data-ttu-id="9802e-128">Версия для Outlook 2003 и более поздних версий: интерфейс [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-128">The version for Outlook 2003 and later releases: the [ApplicationEvents\_11\_Event](https://msdn.microsoft.com/library/bb622725\(v=office.15\)) interface</span></span>

  - <span data-ttu-id="9802e-129">Делегаты, создаваемые программой TLBIMP для каждого события в каждой версии объекта **Application**, например делегат для каждой версии события ItemSend:</span><span class="sxs-lookup"><span data-stu-id="9802e-129">The delegates that TLBIMP creates for each event in each version of the **Application** object, for example, a delegate for each version of the ItemSend event:</span></span>
    
      - <span data-ttu-id="9802e-130">Самая ранняя версия для Outlook 98 и Outlook 2000: делегат [ApplicationEvents\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb622515\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-130">The earliest version for Outlook 98 and Outlook 2000: the [ApplicationEvents\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb622515\(v=office.15\)) delegate</span></span>
    
      - <span data-ttu-id="9802e-131">Версия для Outlook 2002: делегат [ApplicationEvents\_10\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb646436\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-131">The version for Outlook 2002: the [ApplicationEvents\_10\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb646436\(v=office.15\)) delegate</span></span>
    
      - <span data-ttu-id="9802e-132">Версия для Outlook 2003 и более поздних версий: делегат [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\))</span><span class="sxs-lookup"><span data-stu-id="9802e-132">The version for Outlook 2003 and later releases: the [ApplicationEvents\_11\_ItemSendEventHandler](https://msdn.microsoft.com/library/bb610818\(v=office.15\)) delegate</span></span>

<span data-ttu-id="9802e-133">Логически рассуждая, события, добавленные в более позднюю версию, не появляются в интерфейсах событий более ранних версий, и соответствующие делегаты в более ранних версиях для них отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="9802e-133">Logically, events that are added to a later version do not appear in event interfaces of earlier versions and do not have corresponding delegates in earlier versions.</span></span> <span data-ttu-id="9802e-134">Например, событие [AttachmentSelectionChange](https://msdn.microsoft.com/library/ff184926\(v=office.15\)) было добавлено в объект [Explorer](https://msdn.microsoft.com/library/bb623678\(v=office.15\)) в Outlook 2010, следовательно, оно не является частью следующих более ранних интерфейсов события для объекта Explorer:</span><span class="sxs-lookup"><span data-stu-id="9802e-134">For example, the [AttachmentSelectionChange](https://msdn.microsoft.com/library/ff184926\(v=office.15\)) event was added to the [Explorer](https://msdn.microsoft.com/library/bb623678\(v=office.15\)) object in Outlook 2010, therefore, it is not part of these earlier event interfaces for the Explorer object:</span></span>

  - <span data-ttu-id="9802e-135">Интерфейс ExplorerEvents</span><span class="sxs-lookup"><span data-stu-id="9802e-135">ExplorerEvents interface</span></span>

  - <span data-ttu-id="9802e-136">Интерфейс ExplorerEvents\_Event</span><span class="sxs-lookup"><span data-stu-id="9802e-136">ExplorerEvents\_Event interface</span></span>

<span data-ttu-id="9802e-137">С другой стороны, можно найти это событие в самом недавнем интерфейсе события .NET, ExplorerEvents\_10\_Event, и его делегат для версии Outlook 2010, [ExplorerEvents\_10\_AttachmentSelectionChangeEventHandler](https://msdn.microsoft.com/library/ff185177\(v=office.15\)).</span><span class="sxs-lookup"><span data-stu-id="9802e-137">On the other hand, you can find the event in the most recent .NET event interface, ExplorerEvents\_10\_Event, and its delegate for the Outlook 2010 version, [ExplorerEvents\_10\_AttachmentSelectionChangeEventHandler](https://msdn.microsoft.com/library/ff185177\(v=office.15\)).</span></span>

## <a name="what-the-event-interfaces-delegates-and-sink-helper-classes-are-for"></a><span data-ttu-id="9802e-138">Для чего нужны интерфейсы событий, делегаты и классы модуля поддержки приемника</span><span class="sxs-lookup"><span data-stu-id="9802e-138">What the event interfaces, delegates, and Sink Helper classes are for</span></span>

<span data-ttu-id="9802e-139">С помощью объекта **Application** в качестве примера в этом разделе описывается содержание перечисленных выше интерфейсов и классов.</span><span class="sxs-lookup"><span data-stu-id="9802e-139">Using the **Application** object as an example, this section describes what each interface and class listed above contains:</span></span>

  - <span data-ttu-id="9802e-140">Основной интерфейс, \_Application, определяет все методы и свойства Application.</span><span class="sxs-lookup"><span data-stu-id="9802e-140">The primary interface, \_Application, defines all the methods and properties of Application.</span></span> <span data-ttu-id="9802e-141">Кроме условия, рассматриваемого ниже, этот интерфейс обычно не используется в коде.</span><span class="sxs-lookup"><span data-stu-id="9802e-141">Except for a condition discussed below, typically you do not use this interface in code.</span></span>

  - <span data-ttu-id="9802e-142">Интерфейсы событий, импортированные программой TLBIMP, такие как ApplicationEvents\_11 и ApplicationEvents\_10, определяют сопоставление методов событиям Application в соответствующей версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="9802e-142">The events interfaces imported by TLBIMP, such as ApplicationEvents\_11 and ApplicationEvents\_10, define methods mapping to events of Application in the corresponding version of Outlook.</span></span> <span data-ttu-id="9802e-143">Этот интерфейс не используется в коде.</span><span class="sxs-lookup"><span data-stu-id="9802e-143">You do not use this interface in code.</span></span>

  - <span data-ttu-id="9802e-144">Интерфейсы событий, созданные программой TLBIMP, такие как ApplicationEvents\_11\_Event и ApplicationEvents\_10\_Event, определяют все события Application в соответствующей версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="9802e-144">The events interfaces created by TLBIMP, such as ApplicationEvents\_11\_Event and ApplicationEvents\_10\_Event, define all the events of Application in the corresponding version of Outlook.</span></span> <span data-ttu-id="9802e-145">Обработчик события, разрабатываемый для конкретной версии, реализуется как метод, который связывается с событием, определенным в соответствующей версии интерфейса событий .NET.</span><span class="sxs-lookup"><span data-stu-id="9802e-145">When designing an event handler for an event in a specific version, you implement the event handler as a method and connect the method to the event defined in the corresponding version of the .NET events interface.</span></span> <span data-ttu-id="9802e-146">Кроме условия, рассматриваемого ниже, обычно не применяется ссылка на интерфейс событий в коде.</span><span class="sxs-lookup"><span data-stu-id="9802e-146">Except for a condition discussed below, typically you do not reference the events interface in code.</span></span>

  - <span data-ttu-id="9802e-147">Интерфейс .NET, Application, наследует интерфейсы \_Application и ApplicationEvents\_11\_Event.</span><span class="sxs-lookup"><span data-stu-id="9802e-147">The .NET interface, Application, inherits the \_Application interface and the ApplicationEvents\_11\_Event interface.</span></span> <span data-ttu-id="9802e-148">Обычно это и есть интерфейс, используемый в управляемом коде для доступа к объектам, методам, свойствам и новейшим членам события объекта **Application**.</span><span class="sxs-lookup"><span data-stu-id="9802e-148">Typically, this is the one interface you use in managed code to access the object, method, property, and the latest event members of the **Application** object.</span></span> <span data-ttu-id="9802e-149">Но есть два исключения, в которых для связи с событием используется не интерфейс .NET, а другой интерфейс:</span><span class="sxs-lookup"><span data-stu-id="9802e-149">There are however two exceptions where you would not use the .NET interface but a different interface to connect to an event:</span></span>
    
      - <span data-ttu-id="9802e-150">При доступе к событию, носящему то же имя, что и метод этого объекта, для связи с событием обращайтесь к соответствующему интерфейсу события.</span><span class="sxs-lookup"><span data-stu-id="9802e-150">When you access an event that shares the same name as a method of that object, cast to the appropriate event interface to connect to the event.</span></span> <span data-ttu-id="9802e-151">Например, для связи с событием [Quit](https://msdn.microsoft.com/library/bb622595\(v=office.15\)) обращайтесь к интерфейсу ApplicationEvents\_11\_Event.</span><span class="sxs-lookup"><span data-stu-id="9802e-151">For example, to connect to the [Quit](https://msdn.microsoft.com/library/bb622595\(v=office.15\)) event, you cast to the ApplicationEvents\_11\_Event interface.</span></span>
    
      - <span data-ttu-id="9802e-152">При подключении к более ранней версии события, которое затем было расширено в более поздней версии Outlook, подключайтесь к более ранней версии.</span><span class="sxs-lookup"><span data-stu-id="9802e-152">When you connect to an earlier version of an event that has been subsequently extended in a later version of Outlook, connect to the version of the event in the earlier interface.</span></span> <span data-ttu-id="9802e-153">Например, если требуется подключиться к версии события Quit для объекта **Application**, реализованного для Outlook 2002 вместо последней версии программы, подключитесь к событию [Quit](https://msdn.microsoft.com/library/bb609660\(v=office.15\)), определенному в интерфейсе ApplicationEvents\_10\_Event вместо того, чтобы подключаться к событию Quit, определенному в интерфейсе ApplicationEvents\_11\_Event.</span><span class="sxs-lookup"><span data-stu-id="9802e-153">For example, if you want to connect to the version of the Quit event of the **Application** object implemented for Outlook 2002 instead of the latest version, connect to the [Quit](https://msdn.microsoft.com/library/bb609660\(v=office.15\)) event defined in the ApplicationEvents\_10\_Event interface, instead of the Quit event defined in the ApplicationEvents\_11\_Event interface.</span></span>

  - <span data-ttu-id="9802e-154">Делегаты предоставляют платформу для создания настраиваемых обработчиков событий для определенных события в определенной версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="9802e-154">Delegates provide a framework for you to create custom event handlers for specific events in a specific version of Outlook.</span></span> <span data-ttu-id="9802e-155">Например, если нужно добавить проверку наличия строки темы в элементе Outlook непосредственно перед отправкой, реализуйте метод проверки в обратном вызове с такой же подписью, как у делегата ApplicationEvents\_11\_ItemSendEventHandler.</span><span class="sxs-lookup"><span data-stu-id="9802e-155">For example, if you want to add a check for the existence of a subject line in an Outlook item just before you send it, you implement the check in a callback method that has the same signature as the delegate, ApplicationEvents\_11\_ItemSendEventHandler.</span></span> <span data-ttu-id="9802e-156">Затем подключите метод обратного вызова в качестве обработчика события для события ItemSend, которое определено в интерфейсе ApplicationEvents\_11\_Event.</span><span class="sxs-lookup"><span data-stu-id="9802e-156">Then you hook up the callback method as an event handler for the ItemSend event that is defined in the ApplicationEvents\_11\_Event interface.</span></span> <span data-ttu-id="9802e-157">Дополнительные сведения о подключении метода обратного вызова в качестве обработчика события для объекта см. в статье [Подключение к настраиваемым обработчикам событий](connecting-to-custom-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="9802e-157">For more information about connecting the callback method as an event handler for an object, see [Connecting to custom event handlers](connecting-to-custom-event-handlers.md).</span></span>

  - <span data-ttu-id="9802e-158">Классы модуля поддержки приемника, созданные программой TLBIMP, например ApplicationEvents\_11\_SinkHelper и [ApplicationEvents\_10\_SinkHelper](https://msdn.microsoft.com/library/bb644070\(v=office.15\)), являются объектами обработчика события для событий Application в соответствующей версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="9802e-158">The sink helper classes created by TLBIMP, for example, ApplicationEvents\_11\_SinkHelper and [ApplicationEvents\_10\_SinkHelper](https://msdn.microsoft.com/library/bb644070\(v=office.15\)), are event helper objects for Application events in the corresponding version of Outlook.</span></span> <span data-ttu-id="9802e-159">Не используйте эти классы в коде.</span><span class="sxs-lookup"><span data-stu-id="9802e-159">Do not use these classes in code.</span></span>

## <a name="see-also"></a><span data-ttu-id="9802e-160">См. также</span><span class="sxs-lookup"><span data-stu-id="9802e-160">See also</span></span>

- [<span data-ttu-id="9802e-161">Связывание Outlook PIA с объектной моделью</span><span class="sxs-lookup"><span data-stu-id="9802e-161">Relating the Outlook PIA with the object model</span></span>](relating-the-outlook-pia-with-the-object-model.md)
- [<span data-ttu-id="9802e-162">Объекты в Outlook PIA</span><span class="sxs-lookup"><span data-stu-id="9802e-162">Objects in the Outlook PIA</span></span>](objects-in-the-outlook-pia.md)
- [<span data-ttu-id="9802e-163">Методы и свойства в Outlook PIA</span><span class="sxs-lookup"><span data-stu-id="9802e-163">Methods and properties in the Outlook PIA</span></span>](methods-and-properties-in-the-outlook-pia.md)
- [<span data-ttu-id="9802e-164">Разработка управляемых надстроек для Outlook с помощью Outlook PIA</span><span class="sxs-lookup"><span data-stu-id="9802e-164">Developing managed Outlook add-ins using the Outlook PIA</span></span>](developing-managed-outlook-add-ins-using-the-outlook-pia.md)


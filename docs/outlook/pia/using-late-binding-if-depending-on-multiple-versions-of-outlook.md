---
title: Использование позднего связывания при использовании нескольких версий Outlook
TOCTitle: Using late binding if depending on multiple versions of Outlook
ms:assetid: 4e5412a0-d0f8-4819-ba0f-f36ba885f8f6
ms:mtpsurl: https://msdn.microsoft.com/library/office/bb610234(v=office.15)
ms:contentKeyID: 55119791
ms.date: 07/24/2014
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: e4cca4d426e5e7e9fd06fa3a0c3af1158b7e6c2f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32357472"
---
# <a name="using-late-binding-if-depending-on-multiple-versions-of-outlook"></a><span data-ttu-id="35f10-102">Использование позднего связывания при использовании нескольких версий Outlook</span><span class="sxs-lookup"><span data-stu-id="35f10-102">Using late binding if depending on multiple versions of Outlook</span></span>

<span data-ttu-id="35f10-103">Управляемые надстройки Outlook, использующие основную сборку взаимодействия (PIA) Outlook, компилируются сведениями о типах, которые предоставляет PIA.</span><span class="sxs-lookup"><span data-stu-id="35f10-103">Managed Outlook add-ins that use the Outlook Primary Interop Assembly (PIA) are compiled with type information that the PIA provides.</span></span> <span data-ttu-id="35f10-104">Это **раннее связывание** сведений о типах для методов и свойств позволяет компилятору выполнять проверки типов и синтаксиса, чтобы гарантировать передачу в метод или свойство правильного количества и правильных типов параметров, а также принадлежность возвращаемого значения к ожидаемому типу.</span><span class="sxs-lookup"><span data-stu-id="35f10-104">This **early binding** of type information for methods and properties allows the compiler to perform type and syntax checks to ensure that the correct number and type of parameters are passed to the method or property, and that the returned value is of the expected type.</span></span> 

<span data-ttu-id="35f10-105">Но к недостаткам раннего связывания относится появление несовместимости версий, если для метода или свойства, вызываемых надстройкой, в более ранней версии используется другое объявление.</span><span class="sxs-lookup"><span data-stu-id="35f10-105">However, early binding has the disadvantage of introducing version incompatibility if a method or property that the add-in calls has a different declaration in an earlier version.</span></span> <span data-ttu-id="35f10-106">Например, добавление новых методов и свойств или изменение существующих членов объекта может изменить двоичную структуру объекта и вызвать проблемы в управляемой надстройке, использующей более новые сведения для автоматизации ранней версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="35f10-106">For example, adding new methods and properties or modifying existing members of an object can alter the binary layout of the object and cause problems with a managed add-in that uses the more recent type information to automate an earlier version of Outlook.</span></span> 

<span data-ttu-id="35f10-107">В подобных случаях при **позднем связывании** привязка вызовов свойств и методов к объектам выполняется во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="35f10-107">In such cases, **late binding** waits until run time to bind property and method calls to their objects.</span></span> <span data-ttu-id="35f10-108">Позднее связывание помогает избежать сложностей, вызванных типами, отличающимися в различных версиях Outlook, и особенно полезно при написании надстроек, опирающихся на несколько различных версий Outlook.</span><span class="sxs-lookup"><span data-stu-id="35f10-108">Late binding can help avoid complications from types that are different in different versions of Outlook, and is especially useful when writing add-ins that depend on multiple versions of Outlook.</span></span>

<span data-ttu-id="35f10-109">Позднее связывание включает вызов надстройкой интерфейса [IDispatch](https://docs.microsoft.com/windows/desktop/api/oaidl/nn-oaidl-idispatch), реализованного Outlook.</span><span class="sxs-lookup"><span data-stu-id="35f10-109">Late binding involves an add-in calling the [IDispatch](https://docs.microsoft.com/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface implemented by Outlook.</span></span> <span data-ttu-id="35f10-110">Для использования позднего связывания в Visual C\# применяйте метод [System.Type.InvokeMember](https://docs.microsoft.com/dotnet/api/system.type.invokemember?view=netframework-4.7.2).</span><span class="sxs-lookup"><span data-stu-id="35f10-110">To use late binding in Visual C\#, use the [System.Type.InvokeMember](https://docs.microsoft.com/dotnet/api/system.type.invokemember?view=netframework-4.7.2) method.</span></span> <span data-ttu-id="35f10-111">Этот метод вызывает [IDispatch::GetIDsOfNames](https://docs.microsoft.com/windows/desktop/api/oaidl/nf-oaidl-idispatch-getidsofnames) и [IDispatch::Invoke](https://docs.microsoft.com/windows/desktop/api/oaidl/nf-oaidl-idispatch-invoke), чтобы выполнить связывание с методами и свойствами Outlook.</span><span class="sxs-lookup"><span data-stu-id="35f10-111">This method calls [IDispatch::GetIDsOfNames](https://docs.microsoft.com/windows/desktop/api/oaidl/nf-oaidl-idispatch-getidsofnames) and [IDispatch::Invoke](https://docs.microsoft.com/windows/desktop/api/oaidl/nf-oaidl-idispatch-invoke) to bind to Outlook’s methods and properties.</span></span> <span data-ttu-id="35f10-112">Метод IDispatch::GetIdsOfNames позволяет Visual C\# опрашивать объект о поддерживаемых методах и свойствах, а метод IDispatch::Invoke затем позволяет Visual C\# вызывать эти методы и свойства.</span><span class="sxs-lookup"><span data-stu-id="35f10-112">The IDispatch::GetIDsOfNames method allows Visual C\# to interrogate an object about what methods and properties it supports and the IDispatch::Invoke method then allows Visual C\# to call those methods and properties.</span></span> 

<!-- PAGES 404 
For more information about using late binding in C\#, see [KB 302902: Binding for Office Automation Servers with Visual C\# .NET](https://go.microsoft.com/fwlink/?linkid=88971). For more information about using late binding in Visual Basic, see [KB 304661: How to Use Visual Basic .NET for Binding for Office Automation Servers](https://go.microsoft.com/fwlink/?linkid=88972).

Note that late binding requires obtaining a DispID for every method or property, so late binding generally does not perform as well as early binding. For more information about how early binding compares with late binding, see [KB 245115: Using Early Binding and Late Binding in Automation](https://go.microsoft.com/fwlink/?linkid=88973). -->

## <a name="see-also"></a><span data-ttu-id="35f10-113">См. также</span><span class="sxs-lookup"><span data-stu-id="35f10-113">See also</span></span>

- [<span data-ttu-id="35f10-114">Введение во взаимодействие между COM и .NET</span><span class="sxs-lookup"><span data-stu-id="35f10-114">Introduction to interoperability between COM and .NET</span></span>](introduction-to-interoperability-between-com-and-net.md)


---
title: One-Off таблиц
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: 'Last modified: November 08, 2011'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439529"
---
# <a name="one-off-tables"></a>One-Off таблиц

**Относится к**: Outlook 2013 | Outlook 2016 
  
В одностолбной таблице содержатся сведения о шаблонах, поддерживаемых поставщиком адресной книги для создания новых получателей. Разовые таблицы реализуются поставщиками адресных книг, отдельными контейнерами адресных книг и MAPI и могут быть постоянными или временными. 
  
> [!NOTE]
> Не путайте шаблоны в односерверных таблицах с идентификаторами шаблонов; хотя их цели похожи, их конструкции кода не похожи друг на друга. Шаблоны используются для создания получателей определенного типа, а идентификаторы шаблонов используются для привязки данных одного получателя, принадлежащих поставщику услуг хоста, с кодом для поддержки другого получателя, принадлежащего внешнему поставщику. 
  
Клиенты создают новых получателей:
  
- Добавление в список получателей исходяния сообщения.
    
- Добавление в один из контейнеров в адресной книге.
    
В обоих сценариях поставщику адресной книги будет предложено вернуть одностолевую таблицу. Поставщики адресных книг могут реализовать одну единую таблицу, которая будет использоваться в обеих ситуациях, или уникальную единую таблицу для каждой ситуации. 
  
Когда получатель будет включен в исходяние сообщение, MAPI вызывает метод [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) поставщика адресной книги, чтобы получить его разовую таблицу. В разных таблицах содержатся шаблоны, позволяющие пользователю вводить сведения, что приводит к созданию получателя с допустимым адресом. MAPI регистрируется для уведомлений в этой таблице, сохраняя ее открытой, чтобы изменения могли быть отражены для пользователя. MAPI освобождает таблицу, только если вызван метод [IMAPIStatus::ValidateState](imapistatus-validatestate.md) ее подсистемы или объекта состояния адресной книги. 
  
Когда получатель будет добавлен в контейнер, MAPI совершает другой вызов, вызывая метод [IMAPIProp::OpenProperty](imapiprop-openproperty.md) контейнера для получения его свойства **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates).](pidtagcreatetemplates-canonical-property.md) Набор шаблонов, включенных в эту разовую таблицу, представляет типы получателей, которые можно добавить в контейнер. Например, почтовые серверы часто используют по одному контейнеру для каждого установленного шлюза, поэтому каждый контейнер содержит только адреса, определенные для соответствующего шлюза.
  
MAPI предоставляет разовую таблицу, которая включает собственные шаблоны, а также шаблоны от каждого поставщика адресной книги в сеансе. MAPI предоставляет универсальный шаблон, который можно использовать для создания нового получателя для любого типа адреса, если пользователь знает его формат. Поставщики адресных книг используют эту одноразовую таблицу, вызывая [IMAPISupport::GetOneOffTable.](imapisupport-getoneofftable.md) Каждый шаблон, включенный в одностолевую таблицу MAPI, приводит к созданию получателей с допустимым адресом получателя.
  
Поставщики адресных книг обычно по одному шаблону для каждого поддерживаемого типа адресов. Однако поддержка шаблонов не требуется. Поставщики адресных книг, которые не позволяют создавать новые адреса, могут возвращать MAPI_E_NO_SUPPORT при вызове MAPI для запроса одностолбной таблицы. Поставщики адресных книг, которые позволяют создавать новые адреса, но не используют шаблоны, могут вызывать **IMAPISupport::GetOneOffTable для** использования шаблонов, перечисленных в одноразовой таблице MAPI. 
  
Следующие свойства составляют необходимый набор столбцов в разных таблицах:
  
- **PR_ADDRTYPE** ([PidTagAddressType)](pidtagaddresstype-canonical-property.md)
    
- **PR_DEPTH** ([PidTagDepth)](pidtagdepth-canonical-property.md)
    
- **PR_DISPLAY_NAME** ([PidTagDisplayName)](pidtagdisplayname-canonical-property.md)
    
- **PR_DISPLAY_TYPE** ([PidTagDisplayType)](pidtagdisplaytype-canonical-property.md)
    
- **PR_ENTRYID** ([PidTagEntryId)](pidtagentryid-canonical-property.md)
    
- **PR_INSTANCE_KEY** ([PidTagInstanceKey)](pidtaginstancekey-canonical-property.md)
    
- **PR_SELECTABLE** ([PidTagSelectable)](pidtagselectable-canonical-property.md)
    
 **PR_ADDRTYPE** указывает тип адреса, который может быть связан с новым получателем, созданным с помощью шаблона. 
  
 **PR_DISPLAY_NAME** и **PR_DISPLAY_TYPE** связать данные с новым получателем. **PR_DISPLAY_NAME** содержит строку символов, которая идентифицирует  нового получателя, а PR_DISPLAY_TYPE константу, которая определяет тип значка, отображаемого вместе со строкой. Шаблоны для пользователей сообщений **имеют** PR_DISPLAY_TYPE столбец DT_MAILUSER; для шаблонов списков рассылки PR_DISPLAY_TYPE **установлено** DT_DISTLIST. 
  
 **PR_ENTRYID** это идентификатор записи шаблона, который будет использоваться для создания нового получателя. Этот идентификатор записи можно передать в будущие вызовы [IAddrBook::NewEntry,](iaddrbook-newentry.md) [IAddrBook::OpenEntry](iaddrbook-openentry.md)и [IABContainer::CreateEntry.](iabcontainer-createentry.md) Контейнеры устанавливают для столбца **PR_ENTRYID** строки шаблона пользователя системы обмена сообщениями по умолчанию значение **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser),](pidtagdefcreatemailuser-canonical-property.md)а для столбца **PR_ENTRYID** строки шаблона списка рассылки по умолчанию — значение **PR_DEF_CREATE_DL** ([PidTagDefCreateDl).](pidtagdefcreatedl-canonical-property.md) 
  
 **PR_DEPTH** используется для поддержки иерархического отображения записей в одноуровневой таблице, указывая уровень отступа для шаблона. Хотя одноэтабные таблицы могут отображаться как в плоском списке, так и в иерархическому дисплее, последняя предпочтительна, и поставщики адресных книг должны поддерживать ее, **задав** столбец PR_DEPTH для каждой строки соответствующим образом. **PR_DEPTH** на основе нуля; строки со значением 0 в столбце PR_DEPTH **не** имеют отступа. Чем выше значение **PR_DEPTH,** тем больше отступов к строке. Например, строки  с PR_DEPTH 1 имеют отступ на одной вкладке, а строки с PR_DEPTH 3 имеют отступ три вкладки.  
  
 **PR_SELECTABLE** используется для того, чтобы указать, представляет ли строка в таблице шаблон, который можно выбрать и использовать для создания нового получателя. Хотя большинство строк в одностолбной таблице представляют шаблоны, поставщики могут включать не шаблонные строки. Например, поставщику может потребоваться упорядочить разную таблицу по типу шаблона, включая строку категории, которая отображается на экране, но не используется для создания получателей. 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


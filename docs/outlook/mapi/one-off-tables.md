---
title: Одноразовые таблицы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: 'Дата последнего изменения: 08 ноября 2011 г.'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439529"
---
# <a name="one-off-tables"></a>Одноразовые таблицы

**Относится к**: Outlook 2013 | Outlook 2016 
  
Одноразовая таблица содержит сведения о шаблонах, которые поддерживаются поставщиком адресных книг для создания новых получателей. Одноразовые таблицы реализуются поставщиками адресных книг, отдельными адресными книгами и MAPI и могут быть постоянными или временными. 
  
> [!NOTE]
> Не путайте шаблоны в одноразовых таблицах с идентификаторами шаблонов; так как их назначения похожи, их конструкции кода ничего не представляют. Шаблоны используются для создания получателей определенного типа, когда идентификаторы используются для связывания данных одного получателя, принадлежащего поставщику узла, с кодом для поддержки другого получателя, принадлежащего внешнему поставщику. 
  
Клиенты создают новых получателей:
  
- Для добавления в список получателей исходящего сообщения.
    
- Для добавления в один из контейнеров в адресной книге.
    
В обоих сценариях поставщику адресной книги предлагается возврат одноразовой таблицы. Поставщики адресных книг могут реализовать одну одноразовую таблицу, которая будет использоваться в обеих ситуациях, или отдельную одноразовую таблицу для каждой ситуации. 
  
Когда получатель будет включен в исходящее сообщение, MAPI вызывает метод [иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) поставщика адресной книги для получения ее одноразовой таблицы. В таблице одноразовых адресов содержатся шаблоны, которые позволяют пользователю вводить данные, что приводит к созданию получателя с допустимым адресом. Регистрирует регистры MAPI для уведомлений в этой таблице, не открывая ее, поэтому изменения могут быть отражаться у пользователя. MAPI освобождает таблицу только при вызове метода [имапистатус:: валидатестате](imapistatus-validatestate.md) в подсистеме или объекте состояния адресной книги. 
  
Когда получатель добавится в контейнер, MAPI выполняет другой вызов, вызывая метод контейнера [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) для получения свойства **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)). Набор шаблонов, включенных в эту односторонние таблицы, представляет типы получателей, которые могут быть добавлены в контейнер. Например, почтовые серверы часто предоставляют один контейнер для каждого установленного шлюза, чтобы каждый контейнер содержал только адреса соответствующего шлюза.
  
MAPI предоставляет одноразовую таблицу, включающую собственные шаблоны, а также шаблоны из каждого поставщика адресных книг в сеансе. MAPI предоставляет универсальный шаблон, который можно использовать для создания нового получателя для любого типа адреса, предполагая, что пользователь знает его формат. Поставщики адресных книг используют эту одноразовую таблицу, вызывая [имаписуппорт:: жетонеоффтабле](imapisupport-getoneofftable.md). Каждый из шаблонов, включенных в таблицу одноразовых MAPI, приводит к созданию получателей с действительными адресами получателей.
  
Поставщики адресных книг обычно предоставляют один шаблон для каждого поддерживаемого им типа адреса. Однако поддержка шаблонов не является обязательной. Поставщики адресных книг, которые не допускают создание новых адресов, могут возвращать MAPI_E_NO_SUPPORT при вызовах MAPI запроса к одноразовой таблице. Поставщики адресных книг, которые допускают создание нового адреса, но не предоставляют шаблоны, могут вызывать **имаписуппорт:: жетонеоффтабле** для использования шаблонов, перечисленных в таблице одноразовой MAPI. 
  
Следующие свойства составляют набор обязательных столбцов в одноразовых таблицах:
  
- **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))
    
- **PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))
    
- **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))
    
- **PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))
    
- **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))
    
- **PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))
    
- **PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md))
    
 **PR_ADDRTYPE** указывает тип адреса, который может быть связан с новым получателем, созданным с помощью шаблона. 
  
 **PR_DISPLAY_NAME** и **PR_DISPLAY_TYPE** связывания данных с новым получателем. **PR_DISPLAY_NAME** содержит строку символов, определяющую нового получателя и **PR_DISPLAY_TYPE** содержащую константу, определяющую тип значка, отображаемого со строкой. Для шаблонов для пользователей системы обмена сообщениями в столбцах **PR_DISPLAY_TYPE** задано значение DT_MAILUSER; для шаблонов списков рассылки для столбцов **PR_DISPLAY_TYPE** задано значение DT_DISTLIST. 
  
 **PR_ENTRYID** — это идентификатор элемента шаблона, который будет использоваться для создания нового получателя. Этот идентификатор записи можно передать в будущие [IAddrBook:: невентри](iaddrbook-newentry.md), [IAddrBook:: OpenEntry](iaddrbook-openentry.md)и [иабконтаинер:: креатинтри](iabcontainer-createentry.md) вызовы. Контейнеры задают **PR_ENTRYID** столбец строки для шаблона пользователя обмена сообщениями по умолчанию **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) и столбец **PR_ENTRYID** строки для шаблона списка рассылки по умолчанию **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)). 
  
 **PR_DEPTH** используется для поддержки иерархического отображения записей в одноразовой таблице путем указания уровня отступа для шаблона. Хотя односторонние таблицы могут отображаться в виде плоского списка или иерархического отображения, последние являются предпочтительными и поддерживаются поставщиками адресных книг путем установки столбца **PR_DEPTH** для каждой строки соответствующим образом. **PR_DEPTH** отсчитывается от нуля; строки со значением 0 в столбце **PR_DEPTH** не имеют отступов. Чем выше значение **PR_DEPTH**, тем больше строка отображается с отступом. Например, строки с **PR_DEPTH** , для которых задано значение 1, отображаются с отступом на одну вкладку, а в строках с **PR_DEPTH** , для которых задано значение 3, отображаются три вкладки. 
  
 **PR_SELECTABLE** используется для указания того, представляет ли строка в таблице шаблон, который можно выбрать и использовать для создания нового получателя. Несмотря на то, что большинство строк в одной таблице представляют шаблоны, поставщики могут включать строки, не являющиеся шаблонами. Например, поставщику может потребоваться упорядочить одноразовую таблицу по типу шаблона, включая строку категории, которая отображается на дисплее, но не используется для создания получателей. 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


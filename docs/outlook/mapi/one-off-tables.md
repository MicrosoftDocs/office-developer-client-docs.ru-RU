---
title: Одноразовые таблицы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: 'Дата последнего изменения: 08 ноября 2011 г.'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439529"
---
# <a name="one-off-tables"></a><span data-ttu-id="ae9b5-103">Одноразовые таблицы</span><span class="sxs-lookup"><span data-stu-id="ae9b5-103">One-Off Tables</span></span>

<span data-ttu-id="ae9b5-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ae9b5-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ae9b5-105">Одноразовая таблица содержит сведения о шаблонах, которые поддерживаются поставщиком адресных книг для создания новых получателей.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-105">A one-off table contains information about the templates that an address book provider supports for creating new recipients.</span></span> <span data-ttu-id="ae9b5-106">Одноразовые таблицы реализуются поставщиками адресных книг, отдельными адресными книгами и MAPI и могут быть постоянными или временными.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-106">One-off tables are implemented by address book providers, individual address book containers, and by MAPI, and can be persistent or temporary.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="ae9b5-107">Не путайте шаблоны в одноразовых таблицах с идентификаторами шаблонов; так как их назначения похожи, их конструкции кода ничего не представляют.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-107">Do not confuse the templates in one-off tables with template identifiers; while their purposes are similar, their code constructs are nothing alike.</span></span> <span data-ttu-id="ae9b5-108">Шаблоны используются для создания получателей определенного типа, когда идентификаторы используются для связывания данных одного получателя, принадлежащего поставщику узла, с кодом для поддержки другого получателя, принадлежащего внешнему поставщику.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-108">Templates are used to create recipients of a particular type while template identifiers are used to bind the data of one recipient that belong to a host provider with code to support another recipient that belong to a foreign provider.</span></span> 
  
<span data-ttu-id="ae9b5-109">Клиенты создают новых получателей:</span><span class="sxs-lookup"><span data-stu-id="ae9b5-109">Clients create new recipients:</span></span>
  
- <span data-ttu-id="ae9b5-110">Для добавления в список получателей исходящего сообщения.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-110">To add to the recipient list of an outgoing message.</span></span>
    
- <span data-ttu-id="ae9b5-111">Для добавления в один из контейнеров в адресной книге.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-111">To add to one of the containers in the address book.</span></span>
    
<span data-ttu-id="ae9b5-112">В обоих сценариях поставщику адресной книги предлагается возврат одноразовой таблицы.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-112">In both scenarios, an address book provider is asked to return a one-off table.</span></span> <span data-ttu-id="ae9b5-113">Поставщики адресных книг могут реализовать одну одноразовую таблицу, которая будет использоваться в обеих ситуациях, или отдельную одноразовую таблицу для каждой ситуации.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-113">Address book providers can implement either a single one-off table to be used in both situations or a unique one-off table for each situation.</span></span> 
  
<span data-ttu-id="ae9b5-114">Когда получатель будет включен в исходящее сообщение, MAPI вызывает метод [иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) поставщика адресной книги для получения ее одноразовой таблицы.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-114">When the recipient will be included with an outgoing message, MAPI calls the address book provider's [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) method to retrieve its one-off table.</span></span> <span data-ttu-id="ae9b5-115">В таблице одноразовых адресов содержатся шаблоны, которые позволяют пользователю вводить данные, что приводит к созданию получателя с допустимым адресом.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-115">The one-off table includes templates which enable a user to enter information resulting in the creation of a recipient with a valid address.</span></span> <span data-ttu-id="ae9b5-116">Регистрирует регистры MAPI для уведомлений в этой таблице, не открывая ее, поэтому изменения могут быть отражаться у пользователя.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-116">MAPI registers for notifications on this table, keeping it open so that changes can be reflected to the user.</span></span> <span data-ttu-id="ae9b5-117">MAPI освобождает таблицу только при вызове метода [имапистатус:: валидатестате](imapistatus-validatestate.md) в подсистеме или объекте состояния адресной книги.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-117">MAPI releases the table only when its subsystem or address book status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method is called.</span></span> 
  
<span data-ttu-id="ae9b5-118">Когда получатель добавится в контейнер, MAPI выполняет другой вызов, вызывая метод контейнера [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) для получения свойства **пр_креате_темплатес** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ae9b5-118">When the recipient will be added to a container, MAPI makes a different call, invoking the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to retrieve its **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property.</span></span> <span data-ttu-id="ae9b5-119">Набор шаблонов, включенных в эту односторонние таблицы, представляет типы получателей, которые могут быть добавлены в контейнер.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-119">The set of templates included in this one-off table represents the types of recipients that can be added to the container.</span></span> <span data-ttu-id="ae9b5-120">Например, почтовые серверы часто предоставляют один контейнер для каждого установленного шлюза, чтобы каждый контейнер содержал только адреса соответствующего шлюза.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-120">For example, mail servers often expose one container for every gateway that is installed so that each container only holds addresses specific to the corresponding gateway.</span></span>
  
<span data-ttu-id="ae9b5-121">MAPI предоставляет одноразовую таблицу, включающую собственные шаблоны, а также шаблоны из каждого поставщика адресных книг в сеансе.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-121">MAPI provides a one-off table that includes its own templates as well as templates from each of the address book providers in the session.</span></span> <span data-ttu-id="ae9b5-122">MAPI предоставляет универсальный шаблон, который можно использовать для создания нового получателя для любого типа адреса, предполагая, что пользователь знает его формат.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-122">MAPI provides a generic template that can be used to create a new recipient for any address type, assuming that the user knows its format.</span></span> <span data-ttu-id="ae9b5-123">Поставщики адресных книг используют эту одноразовую таблицу, вызывая [имаписуппорт:: жетонеоффтабле](imapisupport-getoneofftable.md).</span><span class="sxs-lookup"><span data-stu-id="ae9b5-123">Address book providers use this one-off table by calling [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span> <span data-ttu-id="ae9b5-124">Каждый из шаблонов, включенных в таблицу одноразовых MAPI, приводит к созданию получателей с действительными адресами получателей.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-124">Each of the templates included in the MAPI one-off table results in the creation of recipients with valid recipient addresses.</span></span>
  
<span data-ttu-id="ae9b5-125">Поставщики адресных книг обычно предоставляют один шаблон для каждого поддерживаемого им типа адреса.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-125">Address book providers typically supply one template for every address type they support.</span></span> <span data-ttu-id="ae9b5-126">Однако поддержка шаблонов не является обязательной.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-126">However, support for templates is not required.</span></span> <span data-ttu-id="ae9b5-127">Поставщики адресных книг, которые не разрешают создавать новые адреса, могут возвращать МАПИ_Е_НО_СУППОРТ при вызовах MAPI для запроса односторонней таблицы.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-127">Address book providers that do not allow the creation of new addresses can return MAPI_E_NO_SUPPORT when MAPI calls to request a one-off table.</span></span> <span data-ttu-id="ae9b5-128">Поставщики адресных книг, которые допускают создание нового адреса, но не предоставляют шаблоны, могут вызывать **имаписуппорт:: жетонеоффтабле** для использования шаблонов, перечисленных в таблице одноразовой MAPI.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-128">Address book providers that do allow new address creation but do not supply any templates can call **IMAPISupport::GetOneOffTable** to use the templates listed in the MAPI one-off table.</span></span> 
  
<span data-ttu-id="ae9b5-129">Следующие свойства составляют набор обязательных столбцов в одноразовых таблицах:</span><span class="sxs-lookup"><span data-stu-id="ae9b5-129">The following properties make up the required column set in one-off tables:</span></span>
  
- <span data-ttu-id="ae9b5-130">**Пр_аддртипе** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-130">**PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))</span></span>
    
- <span data-ttu-id="ae9b5-131">**Пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-131">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>
    
- <span data-ttu-id="ae9b5-132">**Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-132">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>
    
- <span data-ttu-id="ae9b5-133">**Пр_дисплай_типе** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-133">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>
    
- <span data-ttu-id="ae9b5-134">**Пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-134">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>
    
- <span data-ttu-id="ae9b5-135">**Пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-135">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>
    
- <span data-ttu-id="ae9b5-136">**Пр_селектабле** ([PidTagSelectable](pidtagselectable-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ae9b5-136">**PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md))</span></span>
    
 <span data-ttu-id="ae9b5-137">**Пр_аддртипе** указывает тип адреса, который может быть связан с новым получателем, созданным с помощью шаблона.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-137">**PR_ADDRTYPE** indicates the type of address that can be associated with the new recipient created with the template.</span></span> 
  
 <span data-ttu-id="ae9b5-138">**Пр_дисплай_наме** и **пр_дисплай_типе** связывают данные с новым получателем.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-138">**PR_DISPLAY_NAME** and **PR_DISPLAY_TYPE** associate data with the new recipient.</span></span> <span data-ttu-id="ae9b5-139">**Пр_дисплай_наме** содержит строку символов, определяющую нового получателя, и **пр_дисплай_типе** содержит константу, определяющую тип значка, отображаемого со строкой.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-139">**PR_DISPLAY_NAME** contains a character string that identifies the new recipient and **PR_DISPLAY_TYPE** contains a constant that identifies the type of icon to be displayed with the row.</span></span> <span data-ttu-id="ae9b5-140">Для шаблонов для пользователей обмена сообщениями в столбце **пр_дисплай_типе** задано значение дт_маилусер; в шаблонах для списков рассылки для столбца \*\*пр_дисплай_типе\*\* задано значение дт_дистлист.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-140">Templates for messaging users have their **PR_DISPLAY_TYPE** column set to DT_MAILUSER; templates for distribution lists have their **PR_DISPLAY_TYPE** column set to DT_DISTLIST.</span></span> 
  
 <span data-ttu-id="ae9b5-141">**Пр_ентрид** — это идентификатор элемента шаблона, который будет использоваться для создания нового получателя.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-141">**PR_ENTRYID** is the entry identifier of the template to be used to create a new recipient.</span></span> <span data-ttu-id="ae9b5-142">Этот идентификатор записи можно передать в будущие [IAddrBook:: невентри](iaddrbook-newentry.md), [IAddrBook:: OpenEntry](iaddrbook-openentry.md)и [иабконтаинер:: креатинтри](iabcontainer-createentry.md) вызовы.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-142">This entry identifier can be passed to future [IAddrBook::NewEntry](iaddrbook-newentry.md), [IAddrBook::OpenEntry](iaddrbook-openentry.md), and [IABContainer::CreateEntry](iabcontainer-createentry.md) calls.</span></span> <span data-ttu-id="ae9b5-143">Контейнеры задают столбец **пр_ентрид** в строке для шаблона пользователя обмена сообщениями по умолчанию равным **пр_деф_креате_маилусер** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) и столбцу **пр_ентрид** строки для списка рассылки по умолчанию шаблон в **пр_деф_креате_дл** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ae9b5-143">Containers set the **PR_ENTRYID** column of their row for the default messaging user template to **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and the **PR_ENTRYID** column of their row for the default distribution list template to **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)).</span></span> 
  
 <span data-ttu-id="ae9b5-144">**Пр_депс** используется для поддержки иерархического отображения записей в одноразовой таблице путем указания уровня отступа для шаблона.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-144">**PR_DEPTH** is used to support the hierarchical display of the entries in a one-off table by indicating the level of indentation for the template.</span></span> <span data-ttu-id="ae9b5-145">Хотя односторонние таблицы могут отображаться в виде плоского списка или иерархического отображения, последние являются предпочтительными и поддерживаются поставщиками адресных книг путем установки столбца **пр_депс** для каждой строки соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-145">Although one-off tables can be displayed either as a flat list or a hierarchical display, the latter is preferable and address book providers should support it by setting the **PR_DEPTH** column for each row appropriately.</span></span> <span data-ttu-id="ae9b5-146">**Пр_депс** отсчитывается от нуля; строки со значением 0 в столбце **пр_депс** не имеют отступов.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-146">**PR_DEPTH** is zero-based; rows with a value of 0 in their **PR_DEPTH** column are not indented.</span></span> <span data-ttu-id="ae9b5-147">Чем выше значение параметра **пр_депс**, тем больше строка будет иметь отступ.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-147">The higher the value of **PR_DEPTH**, the more the row is indented.</span></span> <span data-ttu-id="ae9b5-148">Например, строки с **пр_депс** , для которых задано значение 1, отображаются с отступом на одну вкладку, а в строках с **пр_депс** , для которых задано значение 3, отображаются три вкладки.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-148">For example, rows with **PR_DEPTH** set to 1 are indented one tab while rows with **PR_DEPTH** set to 3 are indented three tabs.</span></span> 
  
 <span data-ttu-id="ae9b5-149">**Пр_селектабле** используется для указания того, представляет ли строка в таблице шаблон, который можно выбрать и использовать для создания нового получателя.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-149">**PR_SELECTABLE** is used to indicate whether a row in the table represents a template that can be selected and used to create a new recipient.</span></span> <span data-ttu-id="ae9b5-150">Несмотря на то, что большинство строк в одной таблице представляют шаблоны, поставщики могут включать строки, не являющиеся шаблонами.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-150">Although most rows in a one-off table do represent templates, providers can include non-template rows.</span></span> <span data-ttu-id="ae9b5-151">Например, поставщику может потребоваться упорядочить одноразовую таблицу по типу шаблона, включая строку категории, которая отображается на дисплее, но не используется для создания получателей.</span><span class="sxs-lookup"><span data-stu-id="ae9b5-151">For example, a provider might want to organize the one-off table by template type, including a category row that appears in the display but is not used for recipient creation.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="ae9b5-152">См. также</span><span class="sxs-lookup"><span data-stu-id="ae9b5-152">See also</span></span>



[<span data-ttu-id="ae9b5-153">Таблицы MAPI</span><span class="sxs-lookup"><span data-stu-id="ae9b5-153">MAPI Tables</span></span>](mapi-tables.md)


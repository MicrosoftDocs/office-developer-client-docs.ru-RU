---
title: One-Off Таблицы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: 'Последнее изменение: 08 ноября 2011 г.'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439529"
---
# <a name="one-off-tables"></a>One-Off Таблицы

**Область применения**: Outlook 2013 | Outlook 2016 
  
Разовая таблица содержит сведения о шаблонах, которые поставщик адресных книг поддерживает для создания новых получателей. Разовые таблицы реализуются поставщиками адресных книг, отдельными контейнерами адресных книг и MAPI и могут быть постоянными или временными. 
  
> [!NOTE]
> Не путайте шаблоны в разовых таблицах с идентификаторами шаблонов; в то время как их цели похожи, их конструкции кода не похожи друг на друга. Шаблоны используются для создания получателей определенного типа, в то время как идентификаторы шаблонов используются для привязки данных одного получателя, принадлежащего принимающему поставщику, с кодом для поддержки другого получателя, принадлежащего иностранному поставщику. 
  
Клиенты создают новых получателей:
  
- Добавление в список получателей исходя из сообщения.
    
- Добавление в один из контейнеров в адресной книге.
    
В обоих случаях поставщику адресных книг будет предложено вернуть разовую таблицу. Поставщики адресных книг могут реализовать единую единую таблицу, которая будет использоваться в обеих ситуациях, или уникальную единую таблицу для каждой ситуации. 
  
Когда получатель будет включен с исходячим сообщением, MAPI вызывает метод [IABLogon::GetOneOffTable](iablogon-getoneofftable.md) поставщика адресной книги, чтобы получить его разовую таблицу. В разовую таблицу включены шаблоны, позволяющие пользователю вводить сведения, в результате которых создается получатель с допустимым адресом. MAPI регистрирует уведомления на этой таблице, сохраняя их открытыми, чтобы изменения могли отражаться на пользователе. MAPI выпускает таблицу только в том случае, если называется метод [IMAPIStatus::ValidateState](imapistatus-validatestate.md) ее подсистемы или объекта состояния адресной книги. 
  
Когда получатель будет добавлен в контейнер, MAPI делает другой вызов, вызывая метод [IMAPIProp::OpenProperty](imapiprop-openproperty.md) для получения свойства[PR_CREATE_TEMPLATES (PidTagCreateTemplates).](pidtagcreatetemplates-canonical-property.md)  Набор шаблонов, включенных в эту разовую таблицу, представляет типы получателей, которые можно добавить в контейнер. Например, почтовые серверы часто выставляют по одному контейнеру для каждого установленного шлюза, чтобы каждый контейнер вмещал только адреса, определенные соответствующему шлюзу.
  
MAPI предоставляет разовую таблицу, которая включает собственные шаблоны, а также шаблоны от каждого поставщика адресной книги в сеансе. MAPI предоставляет общий шаблон, который можно использовать для создания нового получателя для любого типа адресов, если пользователь знает его формат. Поставщики адресных книг используют эту разовую таблицу, вызывая [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md). Каждый из шаблонов, включенных в разовую таблицу MAPI, приводит к созданию получателей с действительными адресами получателей.
  
Поставщики адресных книг обычно поставляют по одному шаблону для каждого поддерживаемого типа адресов. Однако поддержка шаблонов не требуется. Поставщики адресных книг, которые не позволяют создавать новые адреса, могут возвращать MAPI_E_NO_SUPPORT, когда MAPI вызывает запрос на разовую таблицу. Поставщики адресных книг, которые позволяют создавать новые адреса, но не поставляют шаблоны, могут вызвать **IMAPISupport::GetOneOffTable** для использования шаблонов, перечисленных в единой таблице MAPI. 
  
Следующие свойства составляют необходимый столбец, установленный в разовых таблицах:
  
- **PR_ADDRTYPE** [(PidTagAddressType)](pidtagaddresstype-canonical-property.md)
    
- **PR_DEPTH** [(PidTagDepth)](pidtagdepth-canonical-property.md)
    
- **PR_DISPLAY_NAME** [(PidTagDisplayName)](pidtagdisplayname-canonical-property.md)
    
- **PR_DISPLAY_TYPE** [(PidTagDisplayType)](pidtagdisplaytype-canonical-property.md)
    
- **PR_ENTRYID** [(PidTagEntryId)](pidtagentryid-canonical-property.md)
    
- **PR_INSTANCE_KEY** [(PidTagInstanceKey)](pidtaginstancekey-canonical-property.md)
    
- **PR_SELECTABLE** [(PidTagSelectable)](pidtagselectable-canonical-property.md)
    
 **PR_ADDRTYPE** указывает тип адреса, который может быть связан с новым получателем, созданным с шаблоном. 
  
 **PR_DISPLAY_NAME** и **PR_DISPLAY_TYPE** связывать данные с новым получателем. **PR_DISPLAY_NAME** содержит строку символов, которая идентифицирует  нового получателя, а PR_DISPLAY_TYPE содержит константу, которая определяет тип значка, отображаемого в строке. Шаблоны для пользователей обмена сообщениями имеют **PR_DISPLAY_TYPE** столбец для DT_MAILUSER; шаблоны для списков **рассылки** имеют PR_DISPLAY_TYPE столбец для DT_DISTLIST. 
  
 **PR_ENTRYID** является идентификатором записи шаблона, который будет использоваться для создания нового получателя. Этот идентификатор записи можно передать будущим [вызовам IAddrBook::NewEntry,](iaddrbook-newentry.md) [IAddrBook::OpenEntry](iaddrbook-openentry.md)и [IABContainer::CreateEntry.](iabcontainer-createentry.md) Контейнеры задают столбец **PR_ENTRYID** строки для пользовательского шаблона сообщений по умолчанию **PR_DEF_CREATE_MAILUSER** [(PidTagDefCreateMailuser),](pidtagdefcreatemailuser-canonical-property.md)а столбец **PR_ENTRYID**  строки для шаблона списка рассылки по умолчанию — PR_DEF_CREATE_DL [(PidTagDefCreateDl).](pidtagdefcreatedl-canonical-property.md) 
  
 **PR_DEPTH** используется для поддержки иерархического отображения записей в разовой таблице, указав уровень отступа для шаблона. Хотя разовые таблицы можно отображать как плоский список или иерархический дисплей, последняя предпочтительна, и поставщики адресных книг должны поддерживать его, **задав** столбец PR_DEPTH для каждой строки соответствующим образом. **PR_DEPTH** нулевой основе; строки со значением 0 в столбце PR_DEPTH **не** имеют отступов. Чем выше значение **PR_DEPTH,** тем больше строка отступа. Например, строки с **PR_DEPTH** 1 имеют отступ одну вкладку,  а строки с PR_DEPTH 3 — три вкладки. 
  
 **PR_SELECTABLE** указывает, представляет ли строка в таблице шаблон, который можно выбрать и использовать для создания нового получателя. Хотя большинство строк в разной таблице представляют шаблоны, поставщики могут включать строки без шаблона. Например, поставщику может потребоваться организовать разовую таблицу по типу шаблона, включая строку категории, которая отображается на дисплее, но не используется для создания получателей. 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


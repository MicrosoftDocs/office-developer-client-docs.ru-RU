---
title: Одноразовые таблицы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0f2040b7-9b6c-4eae-aa68-29c4f7b8bd76
description: 'Дата последнего изменения: 08 ноября 2011 г.'
ms.openlocfilehash: 8719536efa9bffb1226f8fb665b912eb872227f1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439529"
---
# <a name="one-off-tables"></a>Одноразовые таблицы

**Относится к**: Outlook 2013 | Outlook 2016 
  
Одноразовая таблица содержит сведения о шаблонах, которые поддерживаются поставщиком адресных книг для создания новых получателей. Одноразовые таблицы реализуются поставщиками адресных книг, отдельными адресными книгами и MAPI и могут быть постоянными или временными. 
  
> [!NOTE]
> Не путайте шаблоны в одноразовых таблицах с идентификаторами шаблонов; так как их назначения похожи, их конструкции кода ничего не представляют. Шаблоны используются для создания получателей определенного типа, когда идентификаторы используются для связывания данных одного получателя, принадлежащего поставщику узла, с кодом для поддержки другого получателя, принадлежащего внешнему поставщику. 
  
Клиенты создают новых получателей:
  
- Для добавления в список получателей исходящего сообщения.
    
- Для добавления в один из контейнеров в адресной книге.
    
В обоих сценариях поставщику адресной книги предлагается возврат одноразовой таблицы. Поставщики адресных книг могут реализовать одну одноразовую таблицу, которая будет использоваться в обеих ситуациях, или отдельную одноразовую таблицу для каждой ситуации. 
  
Когда получатель будет включен в исходящее сообщение, MAPI вызывает метод [иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) поставщика адресной книги для получения ее одноразовой таблицы. В таблице одноразовых адресов содержатся шаблоны, которые позволяют пользователю вводить данные, что приводит к созданию получателя с допустимым адресом. Регистрирует регистры MAPI для уведомлений в этой таблице, не открывая ее, поэтому изменения могут быть отражаться у пользователя. MAPI освобождает таблицу только при вызове метода [имапистатус:: валидатестате](imapistatus-validatestate.md) в подсистеме или объекте состояния адресной книги. 
  
Когда получатель добавится в контейнер, MAPI выполняет другой вызов, вызывая метод контейнера [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) для получения свойства **пр_креате_темплатес** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)). Набор шаблонов, включенных в эту односторонние таблицы, представляет типы получателей, которые могут быть добавлены в контейнер. Например, почтовые серверы часто предоставляют один контейнер для каждого установленного шлюза, чтобы каждый контейнер содержал только адреса соответствующего шлюза.
  
MAPI предоставляет одноразовую таблицу, включающую собственные шаблоны, а также шаблоны из каждого поставщика адресных книг в сеансе. MAPI предоставляет универсальный шаблон, который можно использовать для создания нового получателя для любого типа адреса, предполагая, что пользователь знает его формат. Поставщики адресных книг используют эту одноразовую таблицу, вызывая [имаписуппорт:: жетонеоффтабле](imapisupport-getoneofftable.md). Каждый из шаблонов, включенных в таблицу одноразовых MAPI, приводит к созданию получателей с действительными адресами получателей.
  
Поставщики адресных книг обычно предоставляют один шаблон для каждого поддерживаемого им типа адреса. Однако поддержка шаблонов не является обязательной. Поставщики адресных книг, которые не разрешают создавать новые адреса, могут возвращать МАПИ_Е_НО_СУППОРТ при вызовах MAPI для запроса односторонней таблицы. Поставщики адресных книг, которые допускают создание нового адреса, но не предоставляют шаблоны, могут вызывать **имаписуппорт:: жетонеоффтабле** для использования шаблонов, перечисленных в таблице одноразовой MAPI. 
  
Следующие свойства составляют набор обязательных столбцов в одноразовых таблицах:
  
- **Пр_аддртипе** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))
    
- **Пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md))
    
- **Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))
    
- **Пр_дисплай_типе** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))
    
- **Пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md))
    
- **Пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))
    
- **Пр_селектабле** ([PidTagSelectable](pidtagselectable-canonical-property.md))
    
 **Пр_аддртипе** указывает тип адреса, который может быть связан с новым получателем, созданным с помощью шаблона. 
  
 **Пр_дисплай_наме** и **пр_дисплай_типе** связывают данные с новым получателем. **Пр_дисплай_наме** содержит строку символов, определяющую нового получателя, и **пр_дисплай_типе** содержит константу, определяющую тип значка, отображаемого со строкой. Для шаблонов для пользователей обмена сообщениями в столбце **пр_дисплай_типе** задано значение дт_маилусер; в шаблонах для списков рассылки для столбца **пр_дисплай_типе** задано значение дт_дистлист. 
  
 **Пр_ентрид** — это идентификатор элемента шаблона, который будет использоваться для создания нового получателя. Этот идентификатор записи можно передать в будущие [IAddrBook:: невентри](iaddrbook-newentry.md), [IAddrBook:: OpenEntry](iaddrbook-openentry.md)и [иабконтаинер:: креатинтри](iabcontainer-createentry.md) вызовы. Контейнеры задают столбец **пр_ентрид** в строке для шаблона пользователя обмена сообщениями по умолчанию равным **пр_деф_креате_маилусер** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) и столбцу **пр_ентрид** строки для списка рассылки по умолчанию шаблон в **пр_деф_креате_дл** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)). 
  
 **Пр_депс** используется для поддержки иерархического отображения записей в одноразовой таблице путем указания уровня отступа для шаблона. Хотя односторонние таблицы могут отображаться в виде плоского списка или иерархического отображения, последние являются предпочтительными и поддерживаются поставщиками адресных книг путем установки столбца **пр_депс** для каждой строки соответствующим образом. **Пр_депс** отсчитывается от нуля; строки со значением 0 в столбце **пр_депс** не имеют отступов. Чем выше значение параметра **пр_депс**, тем больше строка будет иметь отступ. Например, строки с **пр_депс** , для которых задано значение 1, отображаются с отступом на одну вкладку, а в строках с **пр_депс** , для которых задано значение 3, отображаются три вкладки. 
  
 **Пр_селектабле** используется для указания того, представляет ли строка в таблице шаблон, который можно выбрать и использовать для создания нового получателя. Несмотря на то, что большинство строк в одной таблице представляют шаблоны, поставщики могут включать строки, не являющиеся шаблонами. Например, поставщику может потребоваться упорядочить одноразовую таблицу по типу шаблона, включая строку категории, которая отображается на дисплее, но не используется для создания получателей. 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


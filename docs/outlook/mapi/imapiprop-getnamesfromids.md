---
title: Имапипропжетнамесфромидс
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.GetNamesFromIDs
api_type:
- COM
ms.assetid: 3efa4731-cf32-4a6c-9ba8-d059e58b0d98
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f6688afde9b36a7722eaaf768f091481c15b7308
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33423575"
---
# <a name="imapipropgetnamesfromids"></a>IMAPIProp::GetNamesFromIDs

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Предоставляет имена свойств, которые соответствуют одному или нескольким идентификаторам свойств.
  
```cpp
HRESULT GetNamesFromIDs(
  LPSPropTagArray FAR * lppPropTags,
  LPGUID lpPropSetGuid,
  ULONG ulFlags,
  ULONG FAR * lpcPropNames,
  LPMAPINAMEID FAR * FAR * lpppPropNames
);
```

## <a name="parameters"></a>Параметры

 _Лпппроптагс_
  
> [вход, выход] На входе указатель на структуру [спроптагаррай](sproptagarray.md) , содержащую массив тегов свойств; в противном случае — значение NULL, указывающее, что должны возвращаться все имена. Элемент **квалуес** для массива тегов свойств не может иметь значение 0. Если _лпппроптагс_ является допустимым указателем на входе, **жетнамесфромидс** возвращает имена для каждого идентификатора свойства, включенного в массив. 
    
 _Лппропсетгуид_
  
> возврата Указатель на GUID или структуру [GUID](guid.md) , определяющую набор свойств. Параметр _лппропсетгуид_ может указывать на допустимый набор свойств или может иметь значение null. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, указывающая тип возвращаемых имен. Можно использовать следующие флаги (если установлены оба флага, имена не возвращаются):
    
МАПИ_НО_ИДС 
  
> Возвращаются только те запросы, для которых возвращаются только имена, хранящиеся в виде строк Юникода. 
    
МАПИ_НО_СТРИНГС 
  
> Запросы, которые возвращаются только имена, хранящиеся как числовые идентификаторы. 
    
 _Лпкпропнамес_
  
> вышли Указатель на число указателей имени свойства в массиве, на которое указывает параметр _лпппропнамес_ . 
    
 _Лппппропнамес_
  
> вышли Указатель на массив указателей на структуры [мапинамеид](mapinameid.md) , которые содержат имена свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Имена свойств успешно возвращены. 
    
МАПИ_Е_НО_СУППОРТ 
  
> Объект не поддерживает именованные свойства. 
    
МАПИ_В_ЕРРОРС_РЕТУРНЕД 
  
> Вызов выполнен в целом, но имена одного или нескольких свойств не могут быть возвращены. Теги свойств для неисправного свойства имеют тип свойства **пт_еррор**. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md). 
    
МАПИ_Е_ИНВАЛИД_ПАРАМЕТЕР 
  
> Элемент **квалуес** одной или нескольких записей в массиве тегов свойств, на который указывает _лпппроптагс_ , имеет значение 0. 
    
## <a name="remarks"></a>Примечания

Несмотря на то, что доступ к большинству свойств осуществляется с помощью идентификатора свойства, к некоторым свойствам можно получить доступ по имени. Метод **IMAPIProp:: жетнамесфромидс** может быть вызван для выполнения следующих действий: 
  
- Получение имен для определенных идентификаторов свойств в определенном наборе свойств.
    
- Получение имен для определенных идентификаторов свойств в любом наборе свойств.
    
- Получение имен для всех именованных свойств, включенных в сопоставление объекта.
    
Если _лпппроптагс_ указывает на допустимый массив тегов свойств с одним или несколькими идентификаторами свойств, а _лппропсетгуид_ указывает на допустимый набор свойств, **жетнамесфромидс** игнорирует набор свойств и типы свойств и возвращают все имена , сопоставленные с указанными идентификаторами. 
  
Если _лпппроптагс_ указывает на допустимый массив тегов свойств с одним или несколькими идентификаторами свойств, а _ЛППРОПСЕТГУИД_ имеет значение null, **жетнамесфромидс** возвращает все имена, сопоставляемые с указанными идентификаторами. 
  
Если у указанного идентификатора нет имени, **жетнамесфромидс** ВОЗВРАЩАЕТ значение NULL в этом идентификаторе в структуре, возвращаемой в _лппппропнамес_ , а также возвращает мапи_в_еррорс_ретурнед. 
  
Если для обоих свойств _лппропсетгуид_ и _ЛПППРОПТАГС_ задано значение null, **жетнамесфромидс** выделяет новый массив тегов свойств и возвращает все имена всех именованных свойств объекта. 
  
Если нет возвращаемых имен, вероятно, из-за того, что в запрошенном наборе свойств нет свойств или все свойства имеют тип, исключенный с помощью флагов, **жетнамесфромидс** выполняет следующие действия: 
  
- Возвращает значение S_OK.
    
- Выделяет новую структуру **спроптагаррай** , устанавливая для члена **квалуес** значение 0. 
    
- Задает значение 0 для содержимого _лпкпропнамес_ . 
    
- Задает для содержимого _ЛППППРОПНАМЕС_ значение null. 
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если _лппропсетгуид_ указывает на допустимый набор свойств, а _ЛПППРОПТАГС_ имеет значение null, результат не определен. Можно использовать одну из следующих стратегий: 
  
- Игнорировать набор свойств и возвращать имена идентификаторов в массиве тегов свойств.
    
- Возвращает имена только для идентификаторов в массиве тегов свойств, принадлежащих указанному набору свойств.
    
- ПроизОшел отказ в вызове, возвращая МАПИ_Е_ИНВАЛИД_ПАРАМЕТЕР. 
    
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы получить все именованные свойства объекта, сначала необходимо вызвать метод объекта [IMAPIProp:: жетпроплист](imapiprop-getproplist.md) , а затем передать возвращенные идентификаторы, находящиеся выше диапазона 0x8000, в **жетнамесфромидс**.
  
Если вы передаете допустимый набор свойств, но не является допустимым массивом тегов свойств, будьте готовы к непредсказуемым результатам. Некоторые реализации **жетнамесфромидс** игнорируют набор свойств и возвращают имена идентификаторов в массиве тегов свойств. Некоторые реализации возвращают МАПИ_Е_ИНВАЛИД_ПАРАМЕТЕР. Остальные реализации возвращают имена для идентификаторов всех свойств в наборе свойств. Если свойство имеет значение ПС_ПУБЛИК_СТРИНГС, **жетнамесфромидс** может возвращать все ранее созданные имена. Хранит ли поставщик услуг свойство под идентификаторами, связанными с общедоступными строками, является нематериальным. 
  
По завершении работы с именами свойств проверьте содержимое параметра _лпкпропнамес_ , чтобы определить, были ли возвращены какие бы то ни было имена. В этом случае вызовите функцию [мапифрибуффер](mapifreebuffer.md) , чтобы освободить память, на которую указывает _Лпппроптагс_ , и _лппппропнамес_ , когда возвращается успешный результат. Для каждого параметра достаточно одного вызова **мапифрибуффер** ; нет необходимости проходить по массиву указателей и освобождать каждую структуру **мапинамеид** по отдельности. 
  
Более подробную информацию об именованных свойствах можно узнать в статье [свойства MAPI с именем](mapi-named-properties.md). 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Синглемапипроплистктрл. cpp  <br/> |Ксинглемапипроплистктрл:: Финдаллнамедпропс  <br/> |MFCMAPI использует метод **IMAPIProp:: жетнамесфромидс** для поиска именованных свойств, которые ранее были сопоставлены.  <br/> |
   
## <a name="see-also"></a>См. также



[GUID](guid.md)
  
[IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md)
  
[IMAPIProp::GetPropList](imapiprop-getproplist.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[MAPINAMEID](mapinameid.md)
  
[SPropTagArray](sproptagarray.md)
  
[IMAPIProp : IUnknown](imapipropiunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Именованные свойства MAPI](mapi-named-properties.md)
  
[Использование макросов для обработки ошибок](using-macros-for-error-handling.md)


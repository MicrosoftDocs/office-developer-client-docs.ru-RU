---
title: IMAPIPropGetNamesFromIDs
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.GetNamesFromIDs
api_type:
- COM
ms.assetid: 3efa4731-cf32-4a6c-9ba8-d059e58b0d98
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f6688afde9b36a7722eaaf768f091481c15b7308
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33423575"
---
# <a name="imapipropgetnamesfromids"></a>IMAPIProp::GetNamesFromIDs

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Предоставляет имена свойств, соответствующие одному или более идентификаторам свойств.
  
```cpp
HRESULT GetNamesFromIDs(
  LPSPropTagArray FAR * lppPropTags,
  LPGUID lpPropSetGuid,
  ULONG ulFlags,
  ULONG FAR * lpcPropNames,
  LPMAPINAMEID FAR * FAR * lpppPropNames
);
```

## <a name="parameters"></a>Parameters

 _lppPropTags_
  
> [in, out] На входе указатель на [структуру SPropTagArray,](sproptagarray.md) содержаную массив тегов свойств; в противном случае NULL указывает, что все имена должны быть возвращены. Член **cValues для** массива тегов свойств не может быть 0. Если  _lppPropTags_ является допустимым указателем на входе, **GetNamesFromID возвращает** имена для каждого идентификатора свойства, включенного в массив. 
    
 _lpPropSetGuid_
  
> [in] Указатель на структуру GUID или [GUID,](guid.md) которая определяет набор свойств. Параметр  _lpPropSetGuid может_ указать на допустимый набор свойств или может быть NULL. 
    
 _ulFlags_
  
> [in] Битмашка флагов, которая указывает тип имен, которые должны быть возвращены. Можно использовать следующие флаги (если оба флага установлены, имена не возвращаются):
    
MAPI_NO_IDS 
  
> Возвращаются запросы, в которых возвращаются только имена, хранимые как строки Юникод. 
    
MAPI_NO_STRINGS 
  
> Возвращаются запросы, в которых возвращаются только имена, хранимые в качестве числимые идентификаторы. 
    
 _lpcPropNames_
  
> [вышел] Указатель на количество указателей имен свойств в массиве, на который указывает параметр _lppPropNames._ 
    
 _lpppPropNames_
  
> [вышел] Указатель на массив указателей для [структур MAPINAMEID,](mapinameid.md) которые содержат имена свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Имена свойств были успешно возвращены. 
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает именимые свойства. 
    
MAPI_W_ERRORS_RETURNED 
  
> Вызов удался в целом, но имена одного или более свойств не удалось вернуть. Теги свойств для сбоя свойств имеют тип **свойства PT_ERROR**. Когда это предупреждение возвращается, вызов должен быть обработан как успешный. Чтобы проверить это предупреждение, используйте **HR_FAILED** макрос. Дополнительные сведения см. в [дополнительных сведениях Об использовании макроса для обработки ошибок.](using-macros-for-error-handling.md) 
    
MAPI_E_INVALID_PARAMETER 
  
> Для **члена cValues** одного или более записей в массиве тегов свойств, на которые указывает  _lppPropTags,_ установлено 0. 
    
## <a name="remarks"></a>Примечания

Хотя доступ к большинству свойств определяется идентификатором свойств, некоторые свойства можно получить по имени. Метод **IMAPIProp::GetNamesFromIDs** можно назвать следующим образом: 
  
- Извлечение имен для определенных идентификаторов свойств в определенном наборе свойств.
    
- Извлечение имен для определенных идентификаторов свойств в любом наборе свойств.
    
- Извлечение имен для всех названных свойств, включенных в сопоставление объекта.
    
Если  _lppPropTags_ указывает на допустимый массив тегов свойств с одним или более идентификаторами свойств, а  _lpPropSetGuid_ указывает на допустимый набор свойств, **getNamesFromIDs** игнорирует набор свойств и типы свойств и возвращает все имена, которые намечают указанные идентификаторы. 
  
Если  _lppPropTags_ указывает на допустимый массив тегов свойств с одним или более идентификаторами свойств, а  _lpPropSetGuid_ — NULL, **GetNamesFromIDs** возвращает все имена, которые отбираются в указанные идентификаторы. 
  
Если у указанного идентификатора нет имени, **GetNamesFromIDs** возвращает NULL в месте этого идентификатора в структуре, возвращаемой в  _lpppPropNames,_ а также возвращает MAPI_W_ERRORS_RETURNED. 
  
Если  _оба lpPropSetGuid_ и  _lppPropTags_ являются NULL, **GetNamesFromIDs** выделяет новый массив тегов свойств и возвращает все имена для всех названных свойств объекта. 
  
Если в наборе запрашиваемого свойства нет имен, возможно, из-за того, что в запрашиваемом наборе свойств нет свойств или все свойства имеют тип, исключаемый флагами, **GetNamesFromIDs** делает следующее: 
  
- Возвращает S_OK.
    
- Выделяет новую **структуру SPropTagArray,** установив для **члена cValues** 0. 
    
- Задает содержимое  _lpcPropNames_ до 0. 
    
- Задает содержимое  _lpppPropNames_ nULL. 
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если  _lpPropSetGuid_ указывает на допустимый набор свойств,  _а lppPropTags_ — NULL, результат неопределяется. Можно использовать одну из следующих стратегий: 
  
- Игнорируйте набор свойств и возвращайте имена идентификаторов в массиве тегов свойств.
    
- Возвращаем имена только для идентификаторов в массиве тегов свойств, которые относятся к указанному набору свойств.
    
- Не удается вызвать, возвращая MAPI_E_INVALID_PARAMETER. 
    
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы получить все названные свойства объекта, сначала необходимо вызвать метод [IMAPIProp::GetPropList](imapiprop-getproplist.md) объекта, а затем передать возвращенные идентификаторы, которые находятся выше 0x8000 диапазона, в **GetNamesFromIDs**.
  
Если вы передаете допустимый набор свойств, но не допустимый массив тегов свойств, будьте готовы к непредсказуемым результатам. Некоторые реализации **GetNamesFromID игнорируют** набор свойств и возвращают имена идентификаторов в массиве тегов свойств. Некоторые реализации возвращают MAPI_E_INVALID_PARAMETER. Другие реализации возвращают имена для идентификаторов всех свойств в наборе свойств. Если набор свойств PS_PUBLIC_STRINGS, **getNamesFromIDs** может вернуть все созданные имена. Сохраняет ли поставщик служб свойство под идентификаторами, связанными с общедоступными строками, несущественно. 
  
Когда вы закончите с именами свойств, проверьте содержимое параметра  _lpcPropNames,_ чтобы определить, были ли возвращены какие-либо имена. Если это так, позвоните в [функцию MAPIFreeBuffer,](mapifreebuffer.md) чтобы освободить память, на что указывают  _lppPropTags_ и  _lpppPropNames_ при возвращении успешного результата. Для каждого параметра достаточно одного вызова **в MAPIFreeBuffer;** вам не нужно пересекать массив указателей и освободить каждую **структуру MAPINAMEID** по отдельности. 
  
Дополнительные сведения о свойствах с именем см. в [см. в нем MAPI Named Properties.](mapi-named-properties.md) 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|SingleMAPIPropListCtrl.cpp  <br/> |CSingleMAPIPropListCtrl::FindAllNamedProps  <br/> |MFCMAPI использует метод **IMAPIProp::GetNamesFromIDs** для получения именных свойств, которые ранее были на карту.  <br/> |
   
## <a name="see-also"></a>См. также



[GUID](guid.md)
  
[IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md)
  
[IMAPIProp::GetPropList](imapiprop-getproplist.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[MAPINAMEID](mapinameid.md)
  
[SPropTagArray](sproptagarray.md)
  
[IMAPIProp : IUnknown](imapipropiunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Именованные свойства MAPI](mapi-named-properties.md)
  
[Использование макроса для обработки ошибок](using-macros-for-error-handling.md)


---
title: IMAPIPropGetNamesFromIDs
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.GetNamesFromIDs
api_type:
- COM
ms.assetid: 3efa4731-cf32-4a6c-9ba8-d059e58b0d98
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 186afd6a80d0ae3ae0a767456e60b2ebaaa579b9
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22574386"
---
# <a name="imapipropgetnamesfromids"></a>IMAPIProp::GetNamesFromIDs

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Содержит имена свойств, которые соответствуют один или несколько идентификаторов свойств.
  
```cpp
HRESULT GetNamesFromIDs(
  LPSPropTagArray FAR * lppPropTags,
  LPGUID lpPropSetGuid,
  ULONG ulFlags,
  ULONG FAR * lpcPropNames,
  LPMAPINAMEID FAR * FAR * lpppPropNames
);
```

## <a name="parameters"></a>Параметры

 _lppPropTags_
  
> [in, out] На входе указатель на структуру [SPropTagArray](sproptagarray.md) , который содержит массив теги свойства; в противном случае — значение NULL, указывающего на то, что все имена должны быть возвращены. Элемент **cValues** для массива тега свойства не может быть 0. Если _lppPropTags_ допустимый указатель на входные данные, **GetNamesFromIDs** возвращает имена для каждого свойства идентификатора, включенные в массиве. 
    
 _lpPropSetGuid_
  
> [in] Указатель на идентификатор GUID, или [идентификатор GUID](guid.md) структуры, определяющий набор свойств. Параметр _lpPropSetGuid_ можно сопоставить с набором свойство или может быть NULL. 
    
 _ulFlags_
  
> [in] Битовая маска флаги, указывающую тип имена которого требуется получить. Можно использовать следующие флаги (если заданы оба флаги, имена не будут возвращены):
    
MAPI_NO_IDS 
  
> Запросы, которые возвращены только имена, сохраненной в качестве строки Юникод. 
    
MAPI_NO_STRINGS 
  
> Запросы, которые возвращены только имена, сохраненной в качестве числовых идентификаторов. 
    
 _lpcPropNames_
  
> [out] Указатель на число указатели имя свойства в массиве указывает параметр _lppPropNames_ . 
    
 _lpppPropNames_
  
> [out] Указатель на массив указатели на [MAPINAMEID](mapinameid.md) структуры, содержащий имена свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Имена свойств были успешно возвращен. 
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает именованные свойства. 
    
MAPI_W_ERRORS_RETURNED 
  
> Вызов завершился успешно в целом, но не будут получены имена для одного или нескольких свойств. Свойство теги для свойств со сбоями имеют типа свойства **PT_ERROR**. При возвращении этого предупреждения вызова необходимо обрабатывать об успешном завершении. Чтобы проверить это предупреждение, используйте **HR_FAILED** макрос. Дополнительные сведения можно [С помощью макросов для обработки ошибок](using-macros-for-error-handling.md). 
    
MAPI_E_INVALID_PARAMETER 
  
> Член **cValues** одной или нескольких записей в массиве тег свойства, на который указывает _lppPropTags_ имеет значение 0. 
    
## <a name="remarks"></a>Замечания

Во время доступа к большинство свойств по идентификатору свойство некоторые свойства может осуществляться по имени. Метод **IMAPIProp::GetNamesFromIDs** может вызываться для выполнения следующих: 
  
- Извлечение имен идентификаторов определенное свойство в наборе определенное свойство.
    
- Извлечение имен идентификаторов определенное свойство в любой набор свойств.
    
- Извлечение имен для всех именованных свойств, которые включены в объект сопоставления.
    
Если значение _lppPropTags_ указывает на это свойство тег массив с один или несколько идентификаторов свойств, а _lpPropSetGuid_ указывает свойство, **GetNamesFromIDs** игнорирует набор свойств и типы свойств и возвращает все имена которые сопоставляются с идентификаторами указанного. 
  
При _lppPropTags_ указывает на массива тег допустимого свойства с помощью одного или нескольких идентификаторов свойств и _lpPropSetGuid_ значение NULL, **GetNamesFromIDs** возвращает все имена, которые сопоставляют указанного идентификаторами. 
  
Если указанный идентификатор не имеет имя, **GetNamesFromIDs** возвращает NULL на месте этот идентификатор в структуре, возвращаемых в _lpppPropNames_ и возвращает MAPI_W_ERRORS_RETURNED. 
  
Если _lpPropSetGuid_ и _lppPropTags_ значение NULL, **GetNamesFromIDs** выделяет новый массив свойство tag и возвращает все имена для всех именованных свойств для объекта. 
  
При наличии имена, не должно быть возвращено, возможно, так как нет свойств в наборе запрошенное свойство или все свойства, типа, исключены с флаги **GetNamesFromIDs** выполняет следующее. 
  
- Возвращает значение S_OK.
    
- Выделяет новые структуры **SPropTagArray** , **cValues** члену задается значение 0. 
    
- Задает содержимое _lpcPropNames_ 0. 
    
- Задает содержимое _lpppPropNames_ значение NULL. 
    
## <a name="notes-to-implementers"></a>Примечания для реализующих

Если _lpPropSetGuid_ указывает на свойство набора и _lppPropTags_ имеет значение NULL, результат является неопределенным. Можно использовать один из следующих стратегий: 
  
- Пропуск набор свойств и возвращают имена для идентификаторов в массиве тега свойства.
    
- Возвращает имена только идентификаторов в массиве тег свойств, относящихся к указанным набором свойств.
    
- Сбой вызова, возвращая MAPI_E_INVALID_PARAMETER. 
    
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы получить все именованные свойства для объекта, необходимо вызвать метод [IMAPIProp::GetPropList](imapiprop-getproplist.md) объекта и затем передайте возвращенные идентификаторы, над 0x8000 диапазона **GetNamesFromIDs**.
  
Если передать свойство набор, но не свойство tag массива быть подготовлено к непредсказуемым последствиям. Некоторые реализации **GetNamesFromIDs** игнорировать набор свойств и возвращает имена для идентификаторов в массиве тега свойства. Некоторые реализации возвращают MAPI_E_INVALID_PARAMETER. По-прежнему другими реализациями возвращать имена идентификаторов всех свойств в набор свойств. Если набор свойств PS_PUBLIC_STRINGS, **GetNamesFromIDs** может вернуть все имена, которые никогда не были созданы. Является ли поставщик услуг сохраняет свойства в разделе идентификаторы, связанные с общей строки несущественно. 
  
По окончании имена свойств, проверьте содержимое параметра _lpcPropNames_ , чтобы определить, были ли возвращены имена. Если Да, вызовите функцию [MAPIFreeBuffer](mapifreebuffer.md) , чтобы освободить память, на который указывает _lppPropTags_ и _lpppPropNames_ при возвращении успешный результат. Один вызов **MAPIFreeBuffer** является достаточным для каждого параметра; Нет необходимости проходят через массив указателей и сведениям каждой структуры **MAPINAMEID** по отдельности. 
  
Дополнительные сведения об именованных свойств в разделе [Свойства с именем MAPI](mapi-named-properties.md). 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|SingleMAPIPropListCtrl.cpp  <br/> |CSingleMAPIPropListCtrl::FindAllNamedProps  <br/> |Mfcmapi (en) использует метод **IMAPIProp::GetNamesFromIDs** для поиска именованных свойств, которые ранее были сопоставлены.  <br/> |
   
## <a name="see-also"></a>См. также



[GUID](guid.md)
  
[IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md)
  
[IMAPIProp::GetPropList](imapiprop-getproplist.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[MAPINAMEID](mapinameid.md)
  
[SPropTagArray](sproptagarray.md)
  
[IMAPIProp : IUnknown](imapipropiunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Именованные свойства MAPI](mapi-named-properties.md)
  
[Использование макросов для обработки ошибок](using-macros-for-error-handling.md)


---
title: Выбор папки получения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 144c7179-b390-479f-a2aa-324974f04eba
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 87f8b4f4011e405d9848f12b5cae56f27fff1ab8
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812222"
---
# <a name="selecting-a-receive-folder"></a>Выбор папки получения

  
  
**Относится к**: Outlook 
  
Получение папки — там, где размещены входящие сообщения определенного класса. IPM и связанных с ними отчет о сообщениях MAPI назначает папки «Входящие», как получить папку по умолчанию. Для производственных Издержек и связанных с ними отчет о сообщениях MAPI назначает корневую папку хранилища сообщений, как получение папки по умолчанию. Можно изменить эти назначения или внести дополнительные назначения для других классов сообщений. Внесения явные получать папки назначения для вашего клиента поддерживаемых сообщение классы является необязательным.
  
Классом входящие сообщения не содержит папку назначенных получения, поставщик хранения сообщений автоматически использует папку получения для класса, которая соответствует дольше возможные префикс входящих класса. Например, если клиент получает сообщение класса IPM. Получать Note.MyDocument и только в папке, где было установлено папки "Входящие" IPM сообщений, а это сообщение будет помещен в папке "Входящие", так как IPM. Note.MyDocument является производным от базового класса IPM.
  
При назначении папки приема сообщений производственных Издержек, никогда не использовать папку из поддерева IPM. Эти папки необходимо зарезервировать IPM только для сообщений. Вместо этого используйте в папку, которая находится в пределах корневой папки хранилища сообщений. 
  
 **Чтобы создать папку получения для класса сообщений IPM**
  
1. Вызов метода [IMAPIProp::GetProps](imapiprop-getprops.md) хранилище сообщений для получения свойства **PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md)). 
    
2. Вызов [IMsgStore::OpenEntry](imsgstore-openentry.md) с **PR_IPM_SUBTREE_ENTRYID** как идентификатор записи для открытия в корневую папку поддерева IPM в хранилище сообщений. 
    
3. Вызовите [IMAPIFolder::CreateFolder](imapifolder-createfolder.md) , чтобы создать папку получения. 
    
4. Вызов [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) для сопоставления на новую папку в класс сообщения IPM. 
    
 **Чтобы создать папку получения для классом сообщения производственных Издержек**
  
1. Вызов [IMsgStore::OpenEntry](imsgstore-openentry.md) с идентификатором запись значение null, чтобы открыть корневую папку хранилища сообщений. 
    
2. Вызовите [IMAPIFolder::CreateFolder](imapifolder-createfolder.md) , чтобы создать папку получения. 
    
3. Вызов [IMsgStore::SetReceiveFolder](imsgstore-setreceivefolder.md) для сопоставления на новую папку в класс сообщения производственных Издержек. 
    
Назначьте папку получения, которая используется для сообщений, для сообщений, связанных с ними отчета. Например, если клиент получает IPM. Примечание сообщения, настроить один получать папку для будущего IPM. Примечание сообщения и то же получать папку для последующих сообщений Report.IPM.Note.
  


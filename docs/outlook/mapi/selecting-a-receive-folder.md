---
title: Выбор папки получения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 144c7179-b390-479f-a2aa-324974f04eba
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9151b76f74dead5cac771dbdc091bbee03359aec
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428419"
---
# <a name="selecting-a-receive-folder"></a>Выбор папки получения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Папка получения — это папка, в которой размещаются входящие сообщения определенного класса. Для сообщений IPM и связанных отчетов MAPI назначает папку "Входящие" в качестве папки получения по умолчанию. Для IPC и связанных сообщений отчетов MAPI назначает корневую папку хранения сообщений в качестве папки получения по умолчанию. Вы можете изменить эти назначения или сделать дополнительные назначения для других классов сообщений. Явное назначение папок получения для поддерживаемых классов сообщений клиента является необязательным.
  
Если классу входящих сообщений не назначена папка получения, поставщик хранилище сообщений автоматически использует папку получения для класса, который соответствует максимальному возможному префиксу входящих классов. Например, если клиент получает сообщение об IPM класса. Note.MyDocument и единственная установленная папка получения — это папка "Входящие" для сообщений IPM. Это сообщение будет помещено в папку "Входящие" из-за IPM. Note.MyDocument является на основе базового класса IPM.
  
При назначении папки получения для сообщений IPC никогда не используйте папку из поддереба IPM. Эти папки следует резервировать только для сообщений IPM. Вместо этого используйте папку, которая находится в корневой папке хранения сообщений. 
  
 **Создание папки получения для класса сообщений IPM**
  
1. Вызовите метод [IMAPIProp::GetProps](imapiprop-getprops.md) в хранилище сообщений, чтобы получить **свойство PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId).](pidtagipmsubtreeentryid-canonical-property.md) 
    
2. Вызовите [IMsgStore::OpenEntry](imsgstore-openentry.md) **с** PR_IPM_SUBTREE_ENTRYID в качестве идентификатора записи, чтобы открыть корневую папку поддерево IPM в хранилище сообщений. 
    
3. Вызовите [IMAPIFolder::CreateFolder,](imapifolder-createfolder.md) чтобы создать папку получения. 
    
4. Вызовите [IMsgStore::SetReceiveFolder,](imsgstore-setreceivefolder.md) чтобы соотвести новую папку с классом сообщений IPM. 
    
 **Создание папки получения для класса сообщений IPC**
  
1. Вызовите [IMsgStore::OpenEntry](imsgstore-openentry.md) с идентификатором записи null, чтобы открыть корневую папку в хранилище сообщений. 
    
2. Вызовите [IMAPIFolder::CreateFolder,](imapifolder-createfolder.md) чтобы создать папку получения. 
    
3. Вызовите [IMsgStore::SetReceiveFolder,](imsgstore-setreceivefolder.md) чтобы соотвести новую папку с классом сообщений IPC. 
    
Назначьте папку получения, используемую для сообщений для связанных сообщений отчетов. Например, если клиент получает IPM. Обратите внимание на сообщения, настроив одну папку получения для будущего IPM. Обратите внимание на сообщения и ту же папку получения для будущих сообщений Report.IPM.Note.
  


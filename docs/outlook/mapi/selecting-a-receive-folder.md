---
title: Выбор папки получения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 144c7179-b390-479f-a2aa-324974f04eba
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9151b76f74dead5cac771dbdc091bbee03359aec
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428419"
---
# <a name="selecting-a-receive-folder"></a>Выбор папки получения

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Папка получения — это место, где размещаются входящие сообщения определенного класса. Для сообщений IPM и связанных отчетов MAPI назначает папку "Входящие" как папку получения по умолчанию. Для IPC и связанных сообщений отчетов MAPI назначает корневую папку магазина сообщений в качестве папки получения по умолчанию. Вы можете изменить эти назначения или сделать дополнительные назначения для других классов сообщений. Выполнение явных назначений папки получения для поддерживаемых классов сообщений клиента является необязательным.
  
Если в классе входящих сообщений нет назначенной папки получения, поставщик магазина сообщений автоматически использует папку получения для класса, который соответствует максимально длинной префиксу входящих классов. Например, если клиент получает сообщение об IPM класса. Note.MyDocument и единственная созданная папка для получения — это почтовый ящик для сообщений IPM, это сообщение будет помещено в папку "Входящие", так как IPM. Note.MyDocument происходит от IPM базового класса.
  
При назначении папки получения для сообщений IPC никогда не используйте папку из подтриба IPM. Эти папки должны быть зарезервированы только для сообщений IPM. Вместо этого используйте папку, которая содержится в корневой папке магазина сообщений. 
  
 **Создание папки получения для класса сообщений IPM**
  
1. Для получения свойства[PR_IPM_SUBTREE_ENTRYID (PidTagIpmSubtreeEntryId)](pidtagipmsubtreeentryid-canonical-property.md)вызываем метод [IMAPIProp::GetProps](imapiprop-getprops.md) в хранилище сообщений.  
    
2. Вызов [IMsgStore::OpenEntry](imsgstore-openentry.md) PR_IPM_SUBTREE_ENTRYID идентификатором входа, чтобы открыть корневую папку подтриба IPM в хранилище сообщений.  
    
3. Вызов [IMAPIFolder::CreateFolder](imapifolder-createfolder.md) для создания папки получения. 
    
4. Позвоните [в IMsgStore::SetReceiveFolder,](imsgstore-setreceivefolder.md) чтобы соотвести новую папку с классом сообщений IPM. 
    
 **Создание папки получения для класса сообщений IPC**
  
1. Вызов [IMsgStore::OpenEntry](imsgstore-openentry.md) с идентификатором записи null, чтобы открыть корневую папку магазина сообщений. 
    
2. Вызов [IMAPIFolder::CreateFolder](imapifolder-createfolder.md) для создания папки получения. 
    
3. Позвоните [в IMsgStore::SetReceiveFolder,](imsgstore-setreceivefolder.md) чтобы соотвести новую папку с классом сообщений IPC. 
    
Назначьте папку получения, используемую для сообщений для связанных сообщений отчетов. Например, если клиент получает IPM. Примечание сообщений, настройка одной папки получения для будущей IPM. Примечание сообщений и та же папка получения для будущих сообщений Report.IPM.Note.
  


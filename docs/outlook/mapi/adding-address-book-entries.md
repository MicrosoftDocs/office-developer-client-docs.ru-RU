---
title: Добавление записей адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63444a65-d56a-4dbd-9aa6-e60f18ba8104
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: adbfbb73ac0f5f1e1cba547fa7a91393891fdb1c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808005"
---
# <a name="adding-address-book-entries"></a>Добавление записей адресной книги

  
  
**Относится к**: Outlook 
  
Чтобы добавить обмена сообщениями пользователя или список рассылки в контейнер, вызовы клиента [IAddrBook::NewEntry](iaddrbook-newentry.md) или поставщиком вызывает [IMAPISupport::NewEntry](imapisupport-newentry.md) с идентификатором записи конечного контейнера с помощью параметра _lpEIDContainer_ . MAPI в свою очередь вызывает метод [IABContainer::CreateEntry](iabcontainer-createentry.md) контейнера для создания записи, с помощью шаблона одноразовых из одноразовых таблицы. Шаблон одноразовых позволяет клиентским для создания нового получателя определенного типа. Большая часть поля доступны для редактирования. Шаблон, на который указывает параметр _lpEntryID_ может быть, которая предоставляет поставщик или может быть шаблон от внешнего поставщика, если поставщик поддерживает внешнего шаблонов. Реализации **CreateEntry** для поставщиков, которые можно создать получателей из внешнего шаблона всегда являются более сложным, чем реализации для поставщиков, которые невозможно. 
  
 **Для реализации IABContainer::CreateEntry**
  
1. Определение типа записи идентификатор, указанный в параметре _lpEntryID_ . 
    
2. Если идентификатор записи представляет шаблон для обмена сообщениями пользователя, список рассылки или контейнер адресной книги, принадлежащие к поставщику:
    
1. Создание и инициализация подходящий объект. При желании к поставщику можно задать некоторые начальные свойства. Эти свойства зависят от типа создаваемого получателя. 
    
2. Возвращает указатель для реализации объекта в содержимое для параметра _lppMAPIPropEntry_ . 
    
3. Если идентификатор записи представляет шаблон для внешнего поставщика:
    
1. Вызовите [IMAPISupport::OpenEntry](imapisupport-openentry.md) , чтобы открыть внешнего объекта. 
    
2. Вызовите метод [IMAPIProp::GetProps](imapiprop-getprops.md) объекта, передав значение NULL для массива тега свойства, чтобы получить его свойства. 
    
3. Изменение массива значение свойства, возвращенные **GetProps** изменяя тег свойства PR_NULL для всех свойств, которые не будут применяться к новому объекту и не должны быть перемещены. 
    
4. Создайте запись идентификатор для этого нового объекта. 
    
5. Создание объекта соответствующего типа, либо обмена сообщениями пользователя или списку рассылки.
    
6. Инициализируйте новый объект путем установки свойства по умолчанию.
    
7. Проверьте, поддерживает ли внешний объект свойство **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)). 
    
8. Если внешний объект поддерживает **PR_TEMPLATEID**, вызовите [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) для извлечения интерфейса объекта свойство от внешнего поставщика и задать содержимое параметра _lppMAPIPropEntry_ внешнего свойства Реализация объекта. 
    
9. Если внешний объект не поддерживает **PR_TEMPLATEID**, необходимо задайте содержимое параметра _lppMAPIPropEntry_ для реализации поставщика нового объекта. 
    
10. Вызовите метод [IMAPIProp::SetProps](imapiprop-setprops.md) объект, указанный с помощью параметра _lppMAPIPropEntry_ , чтобы задать соответствующие свойства из внешнего объекта. 
    


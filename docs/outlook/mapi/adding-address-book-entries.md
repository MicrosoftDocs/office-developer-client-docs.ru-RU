---
title: Добавление записей адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63444a65-d56a-4dbd-9aa6-e60f18ba8104
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8dc82a99ee088d42c076ca9a3a75eac6553f7d35
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421342"
---
# <a name="adding-address-book-entries"></a>Добавление записей адресной книги

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Чтобы добавить пользователя обмена сообщениями или список рассылки в контейнер, клиент вызывает [IAddrBook::NewEntry](iaddrbook-newentry.md) или поставщик вызывает [IMAPISupport::NewEntry](imapisupport-newentry.md) с идентификатором записи целевого контейнера в параметре _lpEIDContainer._ MAPI, в свою очередь, вызывает метод [IABContainer::CreateEntry](iabcontainer-createentry.md) контейнера для создания записи с помощью односерверного шаблона из односерверной таблицы. Один из шаблонов позволяет клиенту создать получателя определенного типа. Большинство полей можно редактировать. Шаблон, на который указывает параметр  _lpEntryID,_ может быть поставщиком или шаблоном от внешнего поставщика, если поставщик поддерживает внешние шаблоны. Реализации **CreateEntry** для поставщиков, которые могут создавать получателей из внешнего шаблона, всегда сложнее, чем реализации для поставщиков, которые не могут. 
  
 **Реализация IABContainer::CreateEntry**
  
1. Определите тип идентификатора записи, заданного параметром _lpEntryID._ 
    
2. Если идентификатор записи представляет шаблон для пользователя обмена сообщениями, списка рассылки или контейнера адресной книги, владельцем котором является ваш поставщик:
    
1. Создание и инициализация соответствующего объекта. При желании поставщик может установить некоторые начальные свойства. Эти свойства зависят от типа создаемого получателя. 
    
2. Возвращает указатель на реализацию объекта в содержимом параметра _lppMAPIPropEntry._ 
    
3. Если идентификатор записи представляет шаблон для внешнего поставщика:
    
1. Вызов [IMAPISupport::OpenEntry для](imapisupport-openentry.md) открытия внешнего объекта. 
    
2. Вызовите метод [IMAPIProp::GetProps](imapiprop-getprops.md) объекта, передав NULL для массива тегов свойств, чтобы получить его свойства. 
    
3. Отредактируем массив значений свойств, возвращаемого **getProps,** изменив тег свойства на PR_NULL для всех свойств, которые не будут применяться к новому объекту и не должны быть перенесены. 
    
4. Создайте идентификатор записи для нового объекта. 
    
5. Создайте новый объект соответствующего типа, пользователь системы обмена сообщениями или список рассылки.
    
6. Инициализация нового объекта путем установки свойств по умолчанию.
    
7. Проверьте, поддерживает ли внешний объект **свойство PR_TEMPLATEID** ([PidTagTemplateid).](pidtagtemplateid-canonical-property.md) 
    
8. Если внешние объекты **поддерживают PR_TEMPLATEID,** вызовите [IMAPISupport::OpenTemplateID,](imapisupport-opentemplateid.md) чтобы получить интерфейс объекта свойства от внешнего поставщика и установить для содержимого параметра  _lppMAPIPropEntry_ реализацию объекта внешнего свойства. 
    
9. Если внешние объекты не **поддерживают** PR_TEMPLATEID, задайте для содержимого параметра  _lppMAPIPropEntry_ реализацию нового объекта поставщиком. 
    
10. Вызовите метод [IMAPIProp::SetProps](imapiprop-setprops.md) объекта, на который указывает параметр  _lppMAPIPropEntry,_ чтобы установить соответствующие свойства из внешнего объекта. 
    


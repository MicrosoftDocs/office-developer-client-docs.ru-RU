---
title: Добавление записей адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63444a65-d56a-4dbd-9aa6-e60f18ba8104
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8dc82a99ee088d42c076ca9a3a75eac6553f7d35
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421342"
---
# <a name="adding-address-book-entries"></a>Добавление записей адресной книги

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Чтобы добавить пользователя или список рассылки для обмена сообщениями в контейнер, клиент вызывает [IAddrBook:: невентри](iaddrbook-newentry.md) или поставщик вызывает [Имаписуппорт:: невентри](imapisupport-newentry.md) с идентификатором записи целевого контейнера в параметре _лпеидконтаинер_ . В свою очередь MAPI вызывает метод контейнера [иабконтаинер:: креатинтри](iabcontainer-createentry.md) , чтобы создать запись с помощью одноразового шаблона из одноразовой таблицы. Одноразовый шаблон позволяет клиенту создавать нового получателя определенного типа. Большинство полей можно редактировать. Шаблоном, на который указывает параметр _лпентрид_ , может быть один, который поставщик предоставил или может быть шаблоном от внешнего поставщика, если ваш поставщик поддерживает внешние шаблоны. Реализации **креатинтри** для поставщиков, которые могут создавать получателей из внешнего шаблона, всегда более сложны, чем реализации для поставщиков, которые не могут. 
  
 **Реализация Иабконтаинер:: Креатинтри**
  
1. Определите тип идентификатора записи, заданный параметром _лпентрид_ . 
    
2. Если идентификатор записи представляет шаблон для пользователя обмена сообщениями, списка рассылки или контейнера адресной книги, принадлежащего поставщику:
    
1. Создайте и инициализируйте соответствующий объект. При необходимости поставщик может задать некоторые начальные свойства. Эти свойства зависят от типа создаваемого получателя. 
    
2. Возвращает указатель на реализацию объекта в содержимом параметра _лппмапипропентри_ . 
    
3. Если идентификатор записи представляет шаблон для внешнего поставщика:
    
1. Call [имаписуппорт:: OpenEntry](imapisupport-openentry.md) , чтобы открыть внешний объект. 
    
2. ВыЗовите метод [IMAPIProp::](imapiprop-getprops.md) /PROPS объекта, ПЕРЕДАВ значение NULL для массива тегов свойств, чтобы получить его свойства. 
    
3. Измените массив значений свойства, возвращаемый **** методом Props, изменив тег свойства на пр_нулл для всех свойств, которые не будут применяться к новому объекту и не должны передаваться. 
    
4. Создание идентификатора записи для нового объекта. 
    
5. Создайте новый объект соответствующего типа: "пользователь обмена сообщениями" или "список рассылки".
    
6. Инициализируйте новый объект, устанавливая свойства по умолчанию.
    
7. Проверьте, поддерживает ли внешний объект свойство **пр_темплатеид** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)). 
    
8. Если внешний объект поддерживает **пр_темплатеид**, вызовите [Имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md) , чтобы получить интерфейс объекта свойства из внешнего поставщика и присвоить параметру _лппмапипропентри_ значение Foreign Property. Реализация объекта. 
    
9. Если внешний объект не поддерживает **пр_темплатеид**, задайте значение параметра _лппмапипропентри_ для реализации поставщика нового объекта. 
    
10. ВыЗовите метод [IMAPIProp:: SetProps](imapiprop-setprops.md) объекта, на который указывает параметр _лппмапипропентри_ , чтобы задать соответствующие свойства из внешнего объекта. 
    


---
title: Добавление записей адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63444a65-d56a-4dbd-9aa6-e60f18ba8104
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8dc82a99ee088d42c076ca9a3a75eac6553f7d35
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421342"
---
# <a name="adding-address-book-entries"></a>Добавление записей адресной книги

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Чтобы добавить пользователя обмена сообщениями или список рассылки в контейнер, клиент вызывает [IAddrBook::NewEntry](iaddrbook-newentry.md) или поставщик вызывает [IMAPISupport::NewEntry](imapisupport-newentry.md) с идентификатором входа целевого контейнера в параметре _lpEIDContainer._ MAPI, в свою очередь, вызывает метод [IABContainer::CreateEntry](iabcontainer-createentry.md) для создания записи с помощью разового шаблона из разовой таблицы. Разовая шаблона позволяет клиенту создать нового получателя определенного типа. Большинство полей можно изменить. Шаблон, на который указывает параметр  _lpEntryID,_ может быть шаблоном, который поставщик поставляет или может быть шаблоном от иностранного поставщика, если поставщик поддерживает иностранные шаблоны. Реализация **CreateEntry для** поставщиков, которые могут создавать получателей из иностранного шаблона, всегда сложнее реализации для поставщиков, которые не могут. 
  
 **Реализация IABContainer::CreateEntry**
  
1. Определите тип идентификатора записи, заданного _параметром lpEntryID._ 
    
2. Если идентификатор записи представляет шаблон для пользователя обмена сообщениями, списка рассылки или контейнера адресной книги, который принадлежит поставщику:
    
1. Создание и инициализация соответствующего объекта. При желании поставщик может установить некоторые начальные свойства. Эти свойства зависят от типа создаемого получателя. 
    
2. Верни указатель на реализацию объекта в содержимом параметра _lppMAPIPropEntry._ 
    
3. Если идентификатор записи представляет шаблон для иностранного поставщика:
    
1. Вызов [IMAPISupport::OpenEntry,](imapisupport-openentry.md) чтобы открыть иностранный объект. 
    
2. Чтобы получить его свойства, позвоните по методу [IMAPIProp::GetProps,](imapiprop-getprops.md) передав NULL для массива тегов свойств. 
    
3. Изменение массива значений свойств, возвращаемого **из GetProps,** изменив тег свойства на PR_NULL для всех свойств, которые не будут применяться к новому объекту и не должны быть переданы. 
    
4. Создайте идентификатор входа для нового объекта. 
    
5. Создание нового объекта соответствующего типа, пользователя обмена сообщениями или списка рассылки.
    
6. Инициализация нового объекта путем установки свойств по умолчанию.
    
7. Проверьте, поддерживает ли иностранный объект **свойство PR_TEMPLATEID** [(PidTagTemplateid).](pidtagtemplateid-canonical-property.md) 
    
8. Если иностранный объект поддерживает **PR_TEMPLATEID,** позвоните по телефону [IMAPISupport::OpenTemplateID,](imapisupport-opentemplateid.md) чтобы получить интерфейс объекта свойства у иностранного поставщика и задать содержимое параметра  _lppMAPIPropEntry_ для реализации объекта зарубежного свойства. 
    
9. Если иностранный объект не поддерживает **PR_TEMPLATEID,** установите содержимое параметра  _lppMAPIPropEntry_ для реализации нового объекта поставщиком. 
    
10. Вызов метода [IMAPIProp::SetProps](imapiprop-setprops.md) объекта, на который указывает параметр  _lppMAPIPropEntry,_ чтобы задать соответствующие свойства от внешнего объекта. 
    


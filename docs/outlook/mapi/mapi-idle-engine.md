---
title: Модуль бездействия MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 755d096a-2a61-44d2-a765-5d464a857756
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 9fdc254053c2d35c83866bd8a076279fd383db02
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583038"
---
# <a name="mapi-idle-engine"></a>Модуль бездействия MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
MAPI предоставляет несколько функций, которые называются idle модуля. Эти функции позволяют клиентов, поставщиками адресной книги и поставщиков хранилища сообщений для выполнения различных задач медленных периоды в сеансе или в ответ на медленных времени. К примеру клиентов и поставщиков услуг можно отложить медленных операций или закрыть файлы, которые остаются неиспользуемых в течение длительных. Поставщиками транспорта обычно не используется простоя модуль так как метод **IXPLogon::Idle** принимает его место. Для получения дополнительных сведений см [IXPLogon::Idle](ixplogon-idle.md).
  
Чтобы использовать простоя модуля, клиентов и поставщиков услуг создать функции обратного вызова, которая содержит задачи, которые должны происходить во время простоя в подсистеме MAPI. Когда MAPI обнаруживает время простоя, он вызывает эту функцию обратного вызова. Если функция обратного вызова выглядит следующим образом прототип **FNIDLE** , определены следующим образом: 
  
 `BOOL (STDAPICALLTYPE FNIDLE) (LPVOID lpvContext)`
  
Для получения дополнительных сведений см [FNIDLE](fnidle.md).
  
Функции, которые составляют простоя модуля являются:
  
[ChangeIdleRoutine](changeidleroutine.md)
  
[DeregisterIdleRoutine](deregisteridleroutine.md)
  
[EnableIdleRoutine](enableidleroutine.md)
  
[FtgRegisterIdleRoutine](ftgregisteridleroutine.md)
  
[MAPIDeInitIdle](mapideinitidle.md)
  
[MAPIInitIdle](mapiinitidle.md)
  
Чтобы зарегистрировать функцию обратного вызова, клиентов и поставщиков услуг вызовите функцию **FtgRegisterIdleRoutine** . Входные параметры включают необязательный приоритет, блок памяти, передаваемое в функции обратного вызова в качестве входных данных за период времени для использования в соответствующие, никаких уведомлений и набор параметр флагов. 
  
Клиенты и поставщиков услуг можно указать приоритет в параметре _priIdle_ , который определяет способ выполнения простоя функции или укажите ноль, если приоритет проблема не возникает. Так как отрицательные числа представляют более высокие приоритеты, чем положительными числами или ноль, сжатие и операций поиска должна быть назначена отрицательными числами. Задачи, выполняемые после должна быть назначена положительными числами. 
  
Отмена регистрации функцию active обратного вызова, клиентов и поставщиков услуг вызовите функцию **DeregisterIdleRoutine** . Так как **DeregisterIdleRoutine** выполняется в асинхронном режиме, возможно, для функции обратного вызова для вызова в любое время во время вызова deregister и возможно даже после возвращения **DeregisterIdleRoutine** . 
  
Чтобы изменить некоторые или все характеристики функции обратного вызова, клиентов и поставщиков услуг вызовите функцию **ChangeIdleRoutine** . **ChangeIdleRoutine** вносятся изменения в соответствии с как задать параметр флаги _ircIdle_ ; **ChangeIdleRoutine** можно изменить самой функции, его приоритета, установленного и входного параметра. 
  
MAPI определяет простоя же, как операционная система, при определении имеет операционная система. На Win32 MAPI создает поток с приоритетом простоя класс простоя заданий по расписанию. Данный поток отслеживает время и отправляет сообщение в поток, который является на выполнение задачи периода бездействия при поступлении время для выполнения. Win32 планирует потоки, не обрабатывает. Если задачи, которые имеют приоритет выше, чем приоритет простоя выполняются на рабочей станции, задачи периода бездействия следует не получите запланировать выполнение до завершения задачи. 
  
Выполните все задачи простоя в потоке, который называется **MAPIInitIdle**. MAPI имеет отдельный поток для планирования, но при простоя задач становится доступным, публикует сообщение обратно в поток инициализации, а также задачи периода бездействия существует. Последствия для различных типов клиентов, как показано ниже.
  
|**Потоковой модели**|**Импликации**|
|:-----|:-----|
|В одном потоке  <br/> |Ничего. Простоя функции выполняются на основной поток вашего клиента и сериализованным через цикл обработки сообщений.  <br/> |
|Свободных потоков  <br/> |Простоя функции должны быть потокобезопасными, но клиент уже имеет необходимую инфраструктуру. Клиент вообще не требуются простоя подсистемы MAPI.  <br/> |
|COM объектов  <br/> |Функция простоя имеет для выполнения в том же потоке, зарегистрировали его, если необходимо использовать MAPI, OLE или COM-интерфейсов. — Это самый простой способ для регистрации простоя функции MAPI, который публикует сообщение в правом поток и отправки функцию «настоящий» idle непосредственно из цикла обработки сообщений этого потока.  <br/> |
   


---
title: IMAPITableQueryRows
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.QueryRows
api_type:
- COM
ms.assetid: f26384f1-467e-4343-92b3-0425da9d2123
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 179d76b56c1ba9b40768c691d0b1555377f7adb7
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22595050"
---
# <a name="imapitablequeryrows"></a>IMAPITable::QueryRows

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Возвращает один или несколько строк из таблицы, начиная с текущей позиции курсора.
  
```cpp
HRESULT QueryRows(
LONG lRowCount,
ULONG ulFlags,
LPSRowSet FAR * lppRows
);
```

## <a name="parameters"></a>Параметры

 _lRowCount_
  
> [in] Максимальное число возвращаемых строк.
    
 _ulFlags_
  
> [in] Битовая маска флаги, определяющие, каким образом возвращенных строк. Можно задать следующий флаг:
    
TBL_NOADVANCE 
  
> Предотвращает переход из-за извлечения строк курсора. Если установлен флаг TBL_NOADVANCE, возвращаемые точек курсор в первую строку. Если флаг TBL_NOADVANCE не установлен, курсор указывает строка, следующая последней строки.
    
 _lppRows_
  
> [out] Указатель на указатель на структуру [SRowSet](srowset.md) руку строк таблицы. 
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Строки были успешно возвращен.
    
MAPI_E_BUSY 
  
> В, не позволяющей операции извлечения строк из запуск выполняется другой операции. В процессе выполнения операции должны выполнить либо должна быть остановлена.
    
MAPI_E_INVALID_PARAMETER 
  
> Параметр _IRowCount_ присваивается нулевое значение. 
    
## <a name="remarks"></a>Замечания

Метод **IMAPITable::QueryRows** получает один или несколько строк данных из таблицы. Значение параметра _IRowCount_ влияет на начальную точку для извлечения. При положительном _IRowCount_ строк считываются вперед, начиная с текущей позиции. Если отрицательно _IRowCount_ **QueryRows** сбрасывает начальной точки при перемещении назад на указанное число строк. После сброса курсор, строки считываются в очереди. 
  
Член **cRows** в структуре [SRowSet](srowset.md) указывает параметр _lppRows_ указывает число строк, возвращаемых. Если не возвращается ноль строки: 
  
- Курсор уже была находится в начале таблицы и значение _IRowCount_ является отрицательным. - Или - 
    
- Курсор уже была находится в конце таблицы и значение _IRowCount_ является положительным. 
    
Число столбцов и их порядок аналогична для каждой строки. Если свойство не существует для строки или Ошибка чтения свойство, структура **SPropValue** для свойства в строке содержит следующие значения: 
  
- PT_ERROR тип свойства в элементе **ulPropTag** . 
    
- MAPI_E_NOT_FOUND элемент **значения** . 
    
Объем памяти, используемый для структур [SPropValue](spropvalue.md) в наборе строк, на который указывает параметр _lppRows_ необходимо выделить отдельно и освободить для каждой строки. Используйте [MAPIFreeBuffer](mapifreebuffer.md) для освобождения структур значение свойства и чтобы освободить место на строку параметры. При вызове **QueryRows** возвращает нуль, тем не менее, указывающее начала или окончания в таблице только структура **SRowSet** самого должен освободить. Дополнительные сведения о том, как выделить и освободить память в структуре **SRowSet** можно [Памяти ADRLIST и SRowSet структур](managing-memory-for-adrlist-and-srowset-structures.md).
  
Строк, возвращаемых и порядок, в котором они возвращаются, зависят от того, является ли успешные вызовы были внесены [IMAPITable::Restrict](imapitable-restrict.md) и [IMAPITable::SortTable](imapitable-sorttable.md). **Ограничить** фильтр строк из представления, использование которых приводит **QueryRows** для возврата только строки, соответствующие критериям указанного в ограничении. **SortTable** устанавливает стандартный или порядок сортировки по категориям влияния на последовательности строк, возвращенных **QueryRows**. В порядке, указанном в структуре [SSortOrderSet](ssortorderset.md) , переданной в **SortTable**, возвращенных строк.
  
Для каждой строки, возвращаемой столбцов и порядок, в котором они возвращаются, зависят от того, является ли успешного вызова совершена [IMAPITable::SetColumns](imapitable-setcolumns.md). **Метода SetColumns** устанавливает набор столбцов Указание свойств, которые будут включены в столбцы в таблице и порядок, в котором они должны быть включены. Если выполнен вызов **метода SetColumns** , определенного столбцов в каждой строке и порядок их столбцов соответствует столбца, указанного в вызове набора. Если вызов **метода SetColumns** таблице возвращает его набор столбцов по умолчанию. 
  
Если ни один из них не выполнена, **QueryRows** возвращает все строки в таблице. Каждая строка содержит столбец по умолчанию, задайте в порядке, по умолчанию. 
  
При наборе столбцов установить в вызове [IMAPITable::SetColumns](imapitable-setcolumns.md) включает столбцы, задайте значение PR_NULL, [SPropValue](spropvalue.md) массив в наборе строк, возвращаемых в _lppRows_ будет содержать пустых ячеек. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Можно разрешить вызывающего для запроса не поддерживается столбцов должны быть включены в набор столбцов. При возникновении этой ошибки поместите PT_ERROR в свойство типа части свойство tag и MAPI_E_NOT_FOUND в значение свойства в столбце не поддерживается. 
  
Считать число строк запроса, а не является обязательным требованием. Вы можете вернуться в любом из строки, если нет ни одной строки в направлении запроса к номеру запрошено. 
  
Возвращает только строки, пользователь увидит при запросе строк из него по категориям, позволяя вызывающему допустимый допущений о области данных и избежать дополнительных действий. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Как правило, появятся числом строк, как было задано с помощью параметра _lRowCount_ . Тем не менее ограничения памяти или реализации проблемы и по достижении операции начала или окончания таблицы преждевременно, **QueryRows** возвращает меньше строк, чем запрошено. 
  
Если **QueryRows** возвращает MAPI_E_BUSY, вызовите метод [IMAPITable::WaitForCompletion](imapitable-waitforcompletion.md) и повторите попытку вызова **QueryRows** после завершения асинхронной операции. 
  
При вызове **QueryRows**, обратите внимание, что время асинхронного уведомления может вызвать набор строк, что можно получить из **QueryRows** не будет точно представлять базовые данные. Например задайте вызов **QueryRows** в таблице ниже содержимое папки что удаление сообщения, но до получения соответствующее уведомление приведет к удаленной строки должно быть возвращено в строке. Всегда ожидают уведомления поступать перед обновлением пользователя представление данных. 
  
Дополнительные сведения о получении строк из таблицы можно [Извлечение данных из строк таблицы](retrieving-data-from-table-rows.md).
  
## <a name="mfcmapi-reference"></a>Справочник по mfcmapi (en)

������ ���� mfcmapi (en) ���������� � ������� ����.
  
|**����**|**�������**|**�����������**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |DwThreadFuncLoadTable  <br/> |Mfcmapi (en) использует метод **IMAPITable::QueryRows** для извлечения строк таблицы для загрузки в представлении.  <br/> |
   
## <a name="see-also"></a>См. также



[ADRENTRY](adrentry.md)
  
[FreeProws](freeprows.md)
  
[HrQueryAllRows](hrqueryallrows.md)
  
[IMAPIProp::GetProps](imapiprop-getprops.md)
  
[IMAPITable::SetColumns](imapitable-setcolumns.md)
  
[IMAPITable::WaitForCompletion](imapitable-waitforcompletion.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[SRow](srow.md)
  
[SRowSet](srowset.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


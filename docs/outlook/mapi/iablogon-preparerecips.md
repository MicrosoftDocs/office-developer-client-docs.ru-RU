---
title: IABLogonPrepareRecips
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABLogon.PrepareRecips
api_type:
- COM
ms.assetid: 3c1845ea-e291-4855-9afd-51d2c64d7e85
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c42077528a4f7227321d8f987cc5dd0ccd4c966c
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22589744"
---
# <a name="iablogonpreparerecips"></a>IABLogon::PrepareRecips

**Применимо к**: Outlook 2013 | Outlook 2016 
  
Подготовка списка получателей для дальнейшего использования системой обмена сообщениями.
  
```cpp
HRESULT PrepareRecips(
  ULONG ulFlags,
  LPSPropTagArray lpPropTagArray,
  LPADRLIST lpRecipList
);
```

## <a name="parameters"></a>���������

_ulFlags_
  
> [in] Битовая маска флаги, определяющее тип текста в возвращенных строк. Можно задать следующий флаг:
    
  - MAPI_CACHE_ONLY: Для выполнения разрешения имен используйте автономной адресной книги. Например можно использовать этот флаг позволяет открыть глобальный список адресов (GAL) в режиме кэширования данных exchange и получить доступ к записи в этот список адресов из кэша без создания трафика между клиентом и сервером клиентского приложения. Этот флаг поддерживается только поставщик Exchange адресной книги.
    
_lpPropTagArray_
  
> [in] Указатель на структуру [SPropTagArray](sproptagarray.md) , который содержит массив тегов свойств, которые указывают свойства, которым требуется обновление, при их наличии. Параметр _lpPropTagArray_ может быть NULL. 
    
_lpRecipList_
  
> [in] Указатель на структуру [ADRLIST](adrlist.md) , в котором размещается список получателей. 
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Список получателей успешно подготовлен.
    
MAPI_E_NOT_FOUND 
  
> Один или несколько получателей с помощью параметра _lpRecipList_ не существует. 
    
## <a name="return-value"></a>������������ ��������

Клиент вызывает метод MAPI [IAddrBook::PrepareRecips](iaddrbook-preparerecips.md) , изменить или переместить набор свойств для одного или нескольких получателей. Получатели могут или не может быть частью списка получателей исходящих сообщений. MAPI передает этот вызов метода **IABLogon::PrepareRecips** поставщика адресных книг. 
  
**IABLogon::PrepareRecips** выполняет четырех основных задач: 
  
- Гарантирует, что всех получателей в списке адресов, на который указывает параметр _lpRecipList_ обеспечивает долгосрочного идентификатор записи. 
    
- Гарантирует, что всем получателям свойства, указанные в массиве значение свойства указывает параметр _lpPropTagArray_ . 
    
- Гарантирует, что прежде чем другие свойства, существовавшего до вызова отображаются свойства из массива значение свойства.
    
- Гарантирует, что порядок свойств в структуре [ADRENTRY](adrentry.md) каждого получателя в структуре **ADRLIST** совпадает со значением массива значение свойства. 
    
Структура **ADRENTRY** с помощью параметра _lpRecipList_ содержит одну структуру **ADRENTRY** для каждого получателя. Структура каждого **ADRENTRY** содержит массив структур [SPropValue](spropvalue.md) для описания свойства получателя. При возврате **IABLogon::PrepareRecips** массива **SPropValue** структуры для каждого получателя, включает в себя свойства из _lpPropTagArray_ , а затем другие свойства для получателя. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Реализация **IABLogon::PrepareRecips** включает в себя выравнивание свойства в определенном порядке, извлечение значения свойств и преобразование краткосрочных идентификаторы записей для долгосрочного идентификаторы записей. Свойства, которые запрашиваются с помощью параметра _lpPropTagArray_ должны быть в начале массива значение свойства, связанные со структурой **ADRENTRY** каждого получателя с помощью параметра _lpRecipList_ . Если значения этих свойств не существует, откройте связанного обмена сообщениями пользователя или список рассылки с помощью его идентификатор записи и извлечение отсутствующие значения свойств. 
  
Выделите каждый **SPropValue** структуры, переданного _lpRecipList_ отдельно, чтобы структур можно освободить по отдельности. Если необходимо выделить дополнительного места на диске для любого **SPropValue** структуры, например, для хранения данных, для свойства строки, функция [MAPIAllocateBuffer](mapiallocatebuffer.md) для выделения дополнительного места на диске для массива значение полного свойства. Используйте функцию [MAPIFreeBuffer](mapifreebuffer.md) , чтобы освободить место на исходный массив значение свойства и затем использовать функцию [MAPIAllocateMore](mapiallocatemore.md) распределения любой дополнительной памяти, который является обязательным. 
  
Чтобы реализовать **IABLogon::PrepareRecips**, используйте следующую процедуру:
  
1. Проверьте наличие записи с помощью параметра _lpPropTagArray_ . Если пустое значение массива свойства нет заданий для выполнения. Возвращает значения успеха. 
    
2. Обработать каждого получателя, с помощью параметра _lpRecipList_ . Существует один член **ADRENTRY** структуры для каждого получателя в списке. Пропуск следующие типы получателей: 
    
   - Получатели без идентификатора записи в элементе **rgPropVals** их **ADRENTRY** структуры (то есть, нерешенные получателей). 
    
   - Получатели с идентификатором записи, которая не относится к поставщику услуг. Эти получателей будет передан другой поставщик адресной книги.
    
3. Откройте получателя и извлечения свойств, которые уже задано для получателя.
    
4. Объединение массива значение свойства, указанного в _lpRecipList_ с массивом свойств, возвращенный из **GetProps**. Если же свойство возникает в обоих массивах свойство, используйте значение из _lpRecipList_.
    
5. Если массива значение свойства _lpRecipList_ размер все необходимые свойства, просто замените его с объединенными массива. Если массива значение свойства _lpRecipList_ не, замените его вновь выделенный массива. Убедитесь, что новый массив имеет обновленное значение в каждой из его члены **cValues** . 
    
6. Если вы не распознают одно или несколько свойств с помощью параметра _lpPropTagArray_ , необходимо задайте тип свойства в структуре **ADRENTRY** получателя PT_ERROR и значение свойства MAPI_E_NOT_FOUND или другое значение, которое обеспечивает более причины недоступности свойства. Сведения о PT_ERROR содержатся [Типы свойств](property-types.md).
    
> [!NOTE]
> Никогда не перемещать структура **ADRLIST** , передаваемый в **IABLogon::PrepareRecips** или измените его число записей. 
  
## <a name="see-also"></a>См. также

- [ADRLIST](adrlist.md)
- [IMAPIProp::GetProps](imapiprop-getprops.md)
- [Каноническое свойство PidTagEntryId](pidtagentryid-canonical-property.md)
- [SPropValue](spropvalue.md)
- [IABLogon : IUnknown](iablogoniunknown.md)


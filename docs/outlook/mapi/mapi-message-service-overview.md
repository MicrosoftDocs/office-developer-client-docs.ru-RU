---
title: Обзор службы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 58f36a6b-bcc5-4ebb-9761-6f420a718d97
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8973cdcee2b10346d0ba07033357b50f7e9a6a27
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406257"
---
# <a name="mapi-message-service-overview"></a>Обзор службы сообщений MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Служба сообщений определяет группу связанных поставщиков услуг, как правило, поставщиков услуг, которые работают с одной системой обмена сообщениями. В то время как поставщики услуг выполняют работу по обмену сообщениями между системами обмена сообщениями и подсистемой MAPI, службы сообщений выполняют взаимодействие между пользователем и поставщиками услуг, которые работают с общей системой обмена сообщениями.  
  
Службы сообщений упрощают установку и настройку поставщиков услуг для пользователей. Пользователи никогда не устанавливают и не настраивают поставщика услуг напрямую; Служба сообщений полностью обрабатывает установку и настройку каждого из поставщиков услуг, принадлежащих службе. Из-за этой функции пользователям не нужно быть знакомыми с определенными требованиями к конфигурации поставщика услуг. 
  
На следующем рисунке показана связь между клиентской приложением на основе обмена сообщениями и двумя службами сообщений.
  
**Установка и настройка почтовой службы**
  
![Установка и настройка службы](media/amapi_44.gif "сообщений") службы сообщений
  
Пользователь вызывает код установки каждой службы сообщений, чтобы добавить службу и ее поставщиков в профиль. В одной из служб сообщений, показанных на рисунке, имеется три поставщика услуг; в другой службе сообщений существует два поставщика услуг. Через некоторое время после завершения установки, как правило, во время работы с устройством, настраиваются поставщики услуг в каждой службе сообщений. Код конфигурации в каждой службе сообщений обрабатывает конфигурацию поставщиков в службе.
  
При установке службы сообщений программа установки копирует необходимые файлы из источника установки на локальный диск пользователя и обновляет файл конфигурации Mapisvc.inf. Файл Mapisvc.inf содержит параметры конфигурации для всех служб сообщений и поставщиков служб, которые можно установить на компьютере. Она организована в иерархические разделы со ссылками между каждым разделом на каждом уровне. Раздел на верхнем уровне содержит сведения, релевантные для подсистемы MAPI, например список всех доступных служб сообщений, а также сведения об установке справки в Интернете. На следующем уровне есть разделы для каждой службы сообщений с такими сведениями, как имя файла DLL службы сообщений и имя функции точки входа конфигурации. Третий уровень имеет разделы с данными конфигурации для каждого поставщика службы в службе сообщений. 
  
Для обработки конфигурации служба сообщений реализует функцию точки входа, которая соответствует прототипу, определенному MAPI, и диалоговое окно с вкладками, известное как лист свойств. MAPI вызывает функцию точки входа для запросов клиентов службы, которые относятся к управлению профилями и управлению поставщиками услуг в службе сообщений. Листы свойств используются для просмотра и изменения свойств конфигурации службы сообщений и поставщика служб. 
  
## <a name="see-also"></a>См. также

- [Функции и архитектура MAPI](mapi-features-and-architecture.md)


---
title: Обзор службы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 58f36a6b-bcc5-4ebb-9761-6f420a718d97
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8973cdcee2b10346d0ba07033357b50f7e9a6a27
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406257"
---
# <a name="mapi-message-service-overview"></a><span data-ttu-id="a9f3e-103">Обзор службы сообщений MAPI</span><span class="sxs-lookup"><span data-stu-id="a9f3e-103">MAPI message service overview</span></span>
  
<span data-ttu-id="a9f3e-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a9f3e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a9f3e-105">Служба сообщений определяет группу связанных поставщиков услуг, как правило, поставщиков услуг, которые работают с одной и той же системой обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-105">A message service defines a group of related service providers, typically service providers that work with the same messaging system.</span></span> <span data-ttu-id="a9f3e-106">В то время как поставщики услуг выполняют работу по связи между системами обмена сообщениями и подсистемой MAPI, службы сообщений выполняют работу взаимодействия между пользователем и поставщиками услуг, которые работают с общей системой обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-106">Whereas service providers perform the work of communicating between messaging systems and the MAPI subsystem, message services perform the work of interfacing between the user and service providers that work with a common messaging system.</span></span>  
  
<span data-ttu-id="a9f3e-107">Службы сообщений существуют для упростить установку и настройку поставщиков услуг для пользователей.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-107">Message services exist to make the installation and configuration of service providers easier for users.</span></span> <span data-ttu-id="a9f3e-108">Пользователи никогда напрямую не устанавливают и не настраивают поставщика услуг; служба сообщений полностью обрабатывает установку и конфигурацию каждого из поставщиков услуг, которые относятся к службе.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-108">Users never directly install or configure a service provider; the message service completely handles the installation and configuration of each of the service providers that belong to the service.</span></span> <span data-ttu-id="a9f3e-109">Из-за этой функции пользователям не нужно быть знакомыми с определенными требованиями к конфигурации поставщика услуг.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-109">Because of this feature, users do not need to be familiar with specific service provider configuration requirements.</span></span> 
  
<span data-ttu-id="a9f3e-110">На следующем рисунке показана связь между клиентом на основе обмена сообщениями и двумя службами сообщений.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-110">The following figure shows the relationship between a messaging-based client application and two message services.</span></span>
  
<span data-ttu-id="a9f3e-111">**Установка и настройка почтовой службы**</span><span class="sxs-lookup"><span data-stu-id="a9f3e-111">**Message service installation and configuration**</span></span>
  
<span data-ttu-id="a9f3e-112">![Установка службы сообщений и настройка](media/amapi_44.gif "установки и конфигурации службы сообщений")</span><span class="sxs-lookup"><span data-stu-id="a9f3e-112">![Message service installation and configuration](media/amapi_44.gif "Message service installation and configuration")</span></span>
  
<span data-ttu-id="a9f3e-113">Пользователь вызывает код установки каждой службы сообщений, чтобы добавить службу и ее поставщиков услуг в профиль.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-113">The user invokes the installation code of each message service to add the service and its service providers to a profile.</span></span> <span data-ttu-id="a9f3e-114">В одной из служб сообщений, показанных на рисунке, существует три поставщика услуг; в другой службе сообщений существует два поставщика услуг.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-114">In one of the message services shown in the figure, there are three service providers; in the other message service, there are two service providers.</span></span> <span data-ttu-id="a9f3e-115">В более позднее время после завершения установки, как правило, во время логоса настраиваются поставщики услуг в каждой службе сообщений.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-115">At some later time after installation is complete, typically at logon time, the service providers in each message service are configured.</span></span> <span data-ttu-id="a9f3e-116">Код конфигурации в каждой службе сообщений обрабатывает конфигурацию поставщиков в службе.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-116">The configuration code in each message service handles the configuration of the providers in the service.</span></span>
  
<span data-ttu-id="a9f3e-117">При установке службы сообщений программа установки копирует необходимые файлы из источника установки на локальный диск пользователя и обновляет файл конфигурации Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-117">When a message service is installed, its installation program copies necessary files from the installation source to the user's local disk and updates a configuration file, Mapisvc.inf.</span></span> <span data-ttu-id="a9f3e-118">Файл Mapisvc.inf содержит параметры конфигурации для всех служб и поставщиков сообщений, которые можно установить на компьютере.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-118">The Mapisvc.inf file contains configuration settings for all of the message services and service providers that can be installed on the computer.</span></span> <span data-ttu-id="a9f3e-119">Она организована в иерархических разделах с ссылками между каждым разделом на каждом уровне.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-119">It is organized in hierarchical sections, with links between each section at each level.</span></span> <span data-ttu-id="a9f3e-120">В разделе на верхнем уровне содержатся сведения, релевантные для подсистемы MAPI, например список всех доступных служб сообщений, а также для установки справки в Интернете.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-120">The section at the top level contains information that is relevant for the MAPI subsystem, such as a list of all available message services, and for the online Help installation.</span></span> <span data-ttu-id="a9f3e-121">На следующем уровне есть разделы для каждой службы сообщений с такими сведениями, как имя файла DLL службы сообщений и имя ее функции точки входа конфигурации.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-121">The next level has sections for each message service, with information such as the DLL file name of the message service and the name of its configuration entry point function.</span></span> <span data-ttu-id="a9f3e-122">На третьем уровне есть разделы с данными конфигурации для каждого поставщика услуг в службе сообщений.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-122">The third level has sections with configuration data for each service provider in the message service.</span></span> 
  
<span data-ttu-id="a9f3e-123">Для обработки конфигурации служба сообщений реализует функцию точки входа, которая соответствует прототипу, определенному MAPI, и диалоговое окно на вкладке, известное как лист свойств.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-123">To handle configuration, a message service implements an entry point function that complies with a prototype defined by MAPI, and a tabbed dialog box known as a property sheet.</span></span> <span data-ttu-id="a9f3e-124">MAPI вызывает функцию точки входа для обслуживания клиентских запросов, которые относятся к управлению профилем и управлению поставщиками услуг в службе сообщений.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-124">MAPI calls the entry point function to service client requests that relate to profile management and the management of service providers in the message service.</span></span> <span data-ttu-id="a9f3e-125">Листы свойств используются для просмотра и изменения свойств службы сообщений и конфигурации поставщика услуг.</span><span class="sxs-lookup"><span data-stu-id="a9f3e-125">Property sheets are used for viewing and changing message service and service provider configuration properties.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="a9f3e-126">См. также</span><span class="sxs-lookup"><span data-stu-id="a9f3e-126">See also</span></span>

- [<span data-ttu-id="a9f3e-127">Функции и архитектура MAPI</span><span class="sxs-lookup"><span data-stu-id="a9f3e-127">MAPI Features and Architecture</span></span>](mapi-features-and-architecture.md)


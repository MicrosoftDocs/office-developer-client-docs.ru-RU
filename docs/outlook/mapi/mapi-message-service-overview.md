---
title: Общие сведения о службе сообщения MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 58f36a6b-bcc5-4ebb-9761-6f420a718d97
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: fc444725aae20e7321fa287a90cf7d3e13b7ffb4
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809764"
---
# <a name="mapi-message-service-overview"></a><span data-ttu-id="3552c-103">Общие сведения о службе сообщения MAPI</span><span class="sxs-lookup"><span data-stu-id="3552c-103">MAPI message service overview</span></span>
  
<span data-ttu-id="3552c-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="3552c-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="3552c-105">Служба сообщений определяет группу поставщиков услуг связанных с ними, обычно поставщиков услуг, которые работают с той же системе обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="3552c-105">A message service defines a group of related service providers, typically service providers that work with the same messaging system.</span></span> <span data-ttu-id="3552c-106">В то время как поставщиков услуг выполнить взаимодействия между систем обмена сообщениями и подсистемы MAPI, службы сообщений выполняют взаимодействия между пользователем и поставщиков услуг, которые работают с распространенных системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="3552c-106">Whereas service providers perform the work of communicating between messaging systems and the MAPI subsystem, message services perform the work of interfacing between the user and service providers that work with a common messaging system.</span></span>  
  
<span data-ttu-id="3552c-107">Службы сообщений существует для упрощения установки и настройки поставщиков услуг для пользователей.</span><span class="sxs-lookup"><span data-stu-id="3552c-107">Message services exist to make the installation and configuration of service providers easier for users.</span></span> <span data-ttu-id="3552c-108">Пользователи никогда не напрямую установки и настройки поставщика услуг; Служба сообщений полностью выполняет установку и настройку каждой из поставщиков услуг, относящихся к службе.</span><span class="sxs-lookup"><span data-stu-id="3552c-108">Users never directly install or configure a service provider; the message service completely handles the installation and configuration of each of the service providers that belong to the service.</span></span> <span data-ttu-id="3552c-109">Из-за этот компонент пользователям не нужно знать требования к конфигурации поставщика службы.</span><span class="sxs-lookup"><span data-stu-id="3552c-109">Because of this feature, users do not need to be familiar with specific service provider configuration requirements.</span></span> 
  
<span data-ttu-id="3552c-110">На следующем рисунке показана связь между приложением клиентов на основе системы обмена сообщениями и две службы сообщений.</span><span class="sxs-lookup"><span data-stu-id="3552c-110">The following figure shows the relationship between a messaging-based client application and two message services.</span></span>
  
<span data-ttu-id="3552c-111">**Установка и настройка почтовой службы**</span><span class="sxs-lookup"><span data-stu-id="3552c-111">**Message service installation and configuration**</span></span>
  
<span data-ttu-id="3552c-112">![Сообщение Установка и настройка службы] (media/amapi_44.gif "Сообщение Установка и настройка службы")</span><span class="sxs-lookup"><span data-stu-id="3552c-112">![Message service installation and configuration](media/amapi_44.gif "Message service installation and configuration")</span></span>
  
<span data-ttu-id="3552c-113">Пользователь вызывает кода установки каждой службы сообщений для добавления в профиль службы и его поставщиков услуг.</span><span class="sxs-lookup"><span data-stu-id="3552c-113">The user invokes the installation code of each message service to add the service and its service providers to a profile.</span></span> <span data-ttu-id="3552c-114">В одной из служб сообщение показано на рисунке существует три поставщиков услуг; в сообщении службы существует два поставщиков услуг.</span><span class="sxs-lookup"><span data-stu-id="3552c-114">In one of the message services shown in the figure, there are three service providers; in the other message service, there are two service providers.</span></span> <span data-ttu-id="3552c-115">Впоследствии по завершении установки, обычно во время входа поставщиков услуг в каждой службы сообщения будут настроены.</span><span class="sxs-lookup"><span data-stu-id="3552c-115">At some later time after installation is complete, typically at logon time, the service providers in each message service are configured.</span></span> <span data-ttu-id="3552c-116">Код конфигурации в каждой службы сообщений обрабатывает конфигурации поставщиков в службе.</span><span class="sxs-lookup"><span data-stu-id="3552c-116">The configuration code in each message service handles the configuration of the providers in the service.</span></span>
  
<span data-ttu-id="3552c-117">При установке службы сообщений программой установки копирует необходимые файлы из источника установки на локальный диск компьютера пользователя и обновляет файл конфигурации Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="3552c-117">When a message service is installed, its installation program copies necessary files from the installation source to the user's local disk and updates a configuration file, Mapisvc.inf.</span></span> <span data-ttu-id="3552c-118">Файла Mapisvc.inf содержит параметры конфигурации для всех служб сообщений и поставщиков услуг, которые могут быть установлены на компьютере.</span><span class="sxs-lookup"><span data-stu-id="3552c-118">The Mapisvc.inf file contains configuration settings for all of the message services and service providers that can be installed on the computer.</span></span> <span data-ttu-id="3552c-119">Организованы в иерархической разделы, содержащие связи между каждого раздела на каждом уровне.</span><span class="sxs-lookup"><span data-stu-id="3552c-119">It is organized in hierarchical sections, with links between each section at each level.</span></span> <span data-ttu-id="3552c-120">Раздел верхнего уровня содержит сведения, которые относятся к подсистемы MAPI, например списка всех служб, доступных сообщение, а для установки интерактивной справки.</span><span class="sxs-lookup"><span data-stu-id="3552c-120">The section at the top level contains information that is relevant for the MAPI subsystem, such as a list of all available message services, and for the online Help installation.</span></span> <span data-ttu-id="3552c-121">Следующий уровень имеет разделы для каждой службы сообщение со сведениями, такие как имя файла библиотеки DLL службы сообщений и имя функции точки входа его конфигурации.</span><span class="sxs-lookup"><span data-stu-id="3552c-121">The next level has sections for each message service, with information such as the DLL file name of the message service and the name of its configuration entry point function.</span></span> <span data-ttu-id="3552c-122">Третьего уровня имеет разделы с данные конфигурации для каждого поставщика услуг службы сообщений.</span><span class="sxs-lookup"><span data-stu-id="3552c-122">The third level has sections with configuration data for each service provider in the message service.</span></span> 
  
<span data-ttu-id="3552c-123">Обработка конфигурации службы сообщений реализует функцию, совместимый с прототипа определяется MAPI и диалоговом окне известных как на листе свойств.</span><span class="sxs-lookup"><span data-stu-id="3552c-123">To handle configuration, a message service implements an entry point function that complies with a prototype defined by MAPI, and a tabbed dialog box known as a property sheet.</span></span> <span data-ttu-id="3552c-124">MAPI вызывает функцию точки входа для обслуживания клиентов, влияющие на управление профилями и управление поставщиков услуг службы сообщений.</span><span class="sxs-lookup"><span data-stu-id="3552c-124">MAPI calls the entry point function to service client requests that relate to profile management and the management of service providers in the message service.</span></span> <span data-ttu-id="3552c-125">Страницы свойств используются для просмотра и изменения свойства конфигурации поставщика службы и службы сообщений.</span><span class="sxs-lookup"><span data-stu-id="3552c-125">Property sheets are used for viewing and changing message service and service provider configuration properties.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="3552c-126">См. также</span><span class="sxs-lookup"><span data-stu-id="3552c-126">See also</span></span>

- [<span data-ttu-id="3552c-127">Функции MAPI и архитектура</span><span class="sxs-lookup"><span data-stu-id="3552c-127">MAPI Features and Architecture</span></span>](mapi-features-and-architecture.md)


---
title: Таблицы отображения
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c314ff6d-3e60-4b81-87ac-6ca6753ff633
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 1b94b0ea69237be3675e1ea02fc3e2bfac337025
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406222"
---
# <a name="display-tables"></a>Таблицы отображения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В таблице показано, как отобразить определенный тип диалогового окна, в котором есть одна или несколько страниц свойств с вкладками, выделенных для отображения и, возможно, редактирования одного или нескольких свойств. Связанная со всеми таблицами отображения — это [IMAPIProp:](imapipropiunknown.md) реализация интерфейса IUnknown. Реализация **IMAPIProp** поддерживает данные свойства, представленные в диалоговом окне. 
  
Строки в таблице отображения представляют элементы управления или объекты пользовательского интерфейса, которые отображаются в диалоговом окне. MAPI определяет многие типы элементов управления, некоторые со статическими значениями и некоторые с динамическими значениями, которые пользователь может изменять. Большинство элементов управления могут быть связаны со свойствами, которые поддерживаются реализацией **IMAPIProp** . Когда пользователь изменяет значение изменяемого элемента управления, соответствующее свойство обновляется. 
  
Поставщики услуг реализуют таблицы отображения и интерфейс **IMAPIProp** . Создание таблицы отображения аналогично написанию программы с использованием языка сценариев. Поставщики услуг могут создать таблицу отображения, выполнив следующие действия: 
  
- Вызов функции [буилддисплайтабле](builddisplaytable.md) . 
    
    - Также
    
- Включает настраиваемый код, который заполняет таблицу отображения непосредственно с помощью объекта данных таблицы — объекта, который поддерживает интерфейс [итабледата: IUnknown](itabledataiunknown.md) . 
    
Функция **буилддисплайтабле** объединяет информацию из структуры таблицы с визуальными элементами из ресурса диалогового окна для создания строк отображаемых таблиц. Функция возвращает указатель на метод [IMAPITable:](imapitableiunknown.md) реализация интерфейса IUnknown и, при запросе, указатель на реализацию интерфейса **итабледата** . 
  
Использование **буилддисплайтабле** для создания таблицы отображения является простым и упрощает обслуживание при изменении визуальных элементов. Однако поставщики услуг, которые предпочитают не использовать **буилддисплайтабле** , могут создать таблицу отображения с настраиваемым кодом, использующим методы **итабледата**. Например, поставщики услуг, у которых есть существующая структура шаблонов для страниц свойств, могут создать пользовательский код, а не использовать **буилддисплайтабле**.
  
Существует множество способов, которые поставщики услуг могут реализовать интерфейс свойств для своей таблицы отображения. Эти решения перечислены ниже.
  
- Предоставление стандартной [IMAPIProp: реализация IUnknown](imapipropiunknown.md) . 
    
- Предоставление упакованной реализации **IMAPIProp** , которая включает специальную обработку перед совершением стандартных вызовов. 
    
- Предоставление реализации [ипропдата: IMAPIProp](ipropdataimapiprop.md) . 
    
Тип реализации зависит от характеристик отображаемых данных и ответственного поставщика услуг. Например, если существует неявная связь между данными в двух элементах управления редактирования и одним из элементов управления, то реализация **IMAPIProp** должна соответствующим образом изменить значение другого элемента управления. 
  
Отображаемые таблицы имеют следующие свойства в требуемом наборе столбцов:
  
|||
|:-----|:-----|
|**PR_XPOS** ([PidTagXCoordinate](pidtagxcoordinate-canonical-property.md))  <br/> |**PR_YPOS** ([пидтагикурдинате](pidtagycoordinate-canonical-property.md))  <br/> |
|**PR_DELTAX** ([PidTagDeltaX](pidtagdeltax-canonical-property.md))  <br/> |**PR_DELTAY** ([PidTagDeltaY](pidtagdeltay-canonical-property.md))  <br/> |
|**PR_CONTROL_TYPE** ([PidTagControlType](pidtagcontroltype-canonical-property.md))  <br/> |**PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md))  <br/> |
|**PR_CONTROL_STRUCTURE** ([PidTagControlStructure](pidtagcontrolstructure-canonical-property.md))  <br/> |**PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md))  <br/> |
   
 **PR_XPOS** и **PR_YPOS** укажите координаты X и Y левого верхнего угла элемента управления. Горизонтальные единицы измерения — 1/4 в базовой ширине диалогового окна; вертикальные единицы измерения — 1/8 в базовой высоте диалогового окна. Windows вычисляет базовые единицы измерения для текущего диалогового окна на основе высоты и ширины текущего системного шрифта. Координаты отсчитываются относительно источника области страницы свойств. Размер страниц свойств ограничен приблизительно 200 на 180 единиц диалогового окна. 
  
 **PR_DELTAX** и **PR_DELTAY** — ширина и высота элемента управления. Это значения ULONG. Единицы измерения ширины — 1/4 в базовой единице измерения ширины диалогового окна; единицы измерения высоты — 1/8 в базовой высоте диалогового окна. Координаты отсчитываются относительно начала координат элемента управления. 
  
Остальные четыре свойства описывают различные характеристики элемента управления. **PR_CONTROL_TYPE** указывает тип элемента управления. MAPI определяет двенадцать типов элементов управления, каждый из которых имеет разный набор атрибутов. Эти атрибуты описаны в свойстве flags, **PR_CONTROL_FLAGS**. Примеры атрибутов включают, является ли элемент управления редактируемым или обязательным. 
  
Структура управления, **PR_CONTROL_STRUCTURE**, содержит сведения, относящиеся к определенному типу элемента управления. Каждый тип элемента управления описывается с помощью другой структуры. Например, элементы управления редактированием описываются с помощью структуры [дтбледит](dtbledit.md) . Структуры **дтбледит** содержат элементы, в которых перечислены количество и определенные типы символов, которые можно поместить в элемент управления, и тег свойства, определяющий свойство, значение которого должно отображаться в элементе управления. **PR_CONTROL_STRUCTURE** хранится в виде двоичного свойства. 
  
Идентификатор элемента управления **PR_CONTROL_ID**уникально определяет элемент управления в диалоговом окне, описанном в таблице отображения. **PR_CONTROL_ID** задается на основе значений, расположенных в членах *лпбнотиф* и *кбнотиф* структуры [дтктл](dtctl.md) , которая используется **буилддисплайтабле** для создания таблицы отображения. Так как MAPI иногда объединяет таблицы отображения, идентификатор в **PR_CONTROL_ID** всегда должен быть уникальным. Как правило, поставщики назначают структуру [GUID](guid.md) **PR_CONTROL_ID** , чтобы обеспечить ее уникальность. Свойство **PR_CONTROL_ID** включается в структуру [TABLE_NOTIFICATION](table_notification.md) при создании уведомления для таблицы отображения. 
  
Дополнительные сведения о таблицах отображения можно узнать в статье [Реализация](display-table-implementation.md) и отображение табличных [уведомлений](about-display-table-notifications.md). 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


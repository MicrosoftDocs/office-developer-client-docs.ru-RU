---
title: Таблицы отображения
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c314ff6d-3e60-4b81-87ac-6ca6753ff633
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 1b94b0ea69237be3675e1ea02fc3e2bfac337025
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406222"
---
# <a name="display-tables"></a>Таблицы отображения

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
В таблице отображения описывается отображение определенного типа диалогового окна, на одном из них имеется одна или несколько страниц свойств вкладок, посвященных отображированию и, возможно, редактированию одного или более свойств. С каждой таблицей отображения связана реализация [интерфейса IMAPIProp: IUnknown.](imapipropiunknown.md) Реализация **IMAPIProp** поддерживает данные свойств, представленные в диалоговом окне. 
  
Строки в таблице отображения представляют элементы управления или объекты пользовательского интерфейса, которые отображаются в диалоговом окне. MAPI определяет многие типы элементов управления, некоторые из них со статичными значениями, а некоторые с динамическими значениями, которые пользователь может изменить. Большинство элементов управления можно связывать со свойствами, поддерживаемыми с **реализацией IMAPIProp.** Если пользователь изменяет значение модификуемого управления, соответствующее свойство обновляется. 
  
Поставщики услуг реализуют таблицы отображения и **интерфейс IMAPIProp.** Создание таблицы отображения аналогично написанию программы с языком скриптов. Поставщики услуг могут создать таблицу отображения с помощью: 
  
- Вызов [функции BuildDisplayTable.](builddisplaytable.md) 
    
    - Или -
    
- В том числе пользовательский код, который заполняет таблицу отображения непосредственно с помощью объекта данных таблицы — объекта, поддерживаюного [интерфейс ITableData: IUnknown.](itabledataiunknown.md) 
    
Функция **BuildDisplayTable объединяет** сведения из структур таблицы отображения с визуальными элементами из ресурса диалоговых полей для создания строк таблицы отображения. Функция возвращает указатель на [реализацию интерфейса IMAPITable : IUnknown](imapitableiunknown.md) и, если требуется, указатель на реализацию интерфейса **ITableData.** 
  
Использование **BuildDisplayTable** для создания таблицы отображения является простым и упрощает обслуживание при изменении визуальных элементов дисплея. Однако поставщики услуг, которые предпочитают не использовать **BuildDisplayTable,** могут создать таблицу отображения с настраиваемым кодом, использующим методы **ITableData.** Например, поставщикам услуг, имеющим существующую структуру шаблонов для страниц свойств, может потребоваться создать настраиваемый код, а не **использовать BuildDisplayTable.**
  
Поставщики услуг могут реализовать интерфейс свойств для своей таблицы отображения. Эти решения перечислены ниже.
  
- Поставка стандартной [реализации IMAPIProp: IUnknown.](imapipropiunknown.md) 
    
- Поставка упакованной **реализации IMAPIProp,** которая включает специальную обработку перед выполнением стандартных вызовов. 
    
- Поставка [реализации IPropData : IMAPIProp.](ipropdataimapiprop.md) 
    
Тип реализации зависит от характеристик отображаемой информации и ответственного поставщика услуг. Например, если между данными в двух элементов управления редактирования и одним из элементов управления существует неявная связь, реализация **IMAPIProp** должна соответствующим образом изменить значение другого управления. 
  
Таблицы отображения имеют следующие свойства в требуемом наборе столбцов:
  
|||
|:-----|:-----|
|**PR_XPOS** [(PidTagXCoordinate)](pidtagxcoordinate-canonical-property.md)  <br/> |**PR_YPOS** [(PidTagYCoordinate)](pidtagycoordinate-canonical-property.md)  <br/> |
|**PR_DELTAX** [(PidTagDeltaX)](pidtagdeltax-canonical-property.md)  <br/> |**PR_DELTAY** [(PidTagDeltaY)](pidtagdeltay-canonical-property.md)  <br/> |
|**PR_CONTROL_TYPE** [(PidTagControlType)](pidtagcontroltype-canonical-property.md)  <br/> |**PR_CONTROL_FLAGS** [(PidTagControlFlags)](pidtagcontrolflags-canonical-property.md)  <br/> |
|**PR_CONTROL_STRUCTURE** [(PidTagControlStructure)](pidtagcontrolstructure-canonical-property.md)  <br/> |**PR_CONTROL_ID** [(PidTagControlId)](pidtagcontrolid-canonical-property.md)  <br/> |
   
 **PR_XPOS** **и PR_YPOS** координаты X и Y в верхнем левом углу управления. Горизонтальные единицы — это 1/4 блока ширины базы диалогов; вертикальные единицы 1/8 из блока высоты базы диалогов. Windows вычисляет текущие базовые блоки диалогов с высоты и ширины текущего системного шрифта. Координаты относительно происхождения области страницы свойства. Размер страниц свойств ограничен примерно 200 180 диалогами. 
  
 **PR_DELTAX** **и PR_DELTAY** — это ширина и высота управления. Это значения ULONG. Единицы ширины 1/4 блока ширины базы диалогов; единицы высоты 1/8 из блока высоты базы диалогов. Координаты относительно происхождения управления. 
  
В остальных четырех свойствах описываются различные характеристики управления. **PR_CONTROL_TYPE** указывает тип управления. MAPI определяет двенадцать типов элементов управления, каждый из которых имеет другой набор атрибутов. Эти атрибуты описаны в свойстве флагов, **PR_CONTROL_FLAGS**. Примеры атрибутов включают, является ли управление редактируемым или требуемым. 
  
Структура управления, **PR_CONTROL_STRUCTURE,** содержит сведения, соответствующие определенному типу управления. Каждый тип управления описывается с другой структурой. Например, элементы управления редактированием описаны в [структуре DTBLEDIT.](dtbledit.md) **Структуры DTBLEDIT** содержат членов, которые перечисляют количество и конкретные типы символов, которые можно поместить на пульт управления, и тег свойства, который определяет свойство, значение которого должно отображаться в области управления. **PR_CONTROL_STRUCTURE** хранится как двоичное свойство. 
  
Идентификатор управления, **PR_CONTROL_ID,** однозначно определяет управление в диалоговом окне, описанного в таблице отображения. **PR_CONTROL_ID** устанавливается из значений, размещенных в  *lpbNotif*  и  *cbNotif*  в структуре [DTCTL,](dtctl.md) используемой **BuildDisplayTable** для создания таблицы отображения. Так как MAPI иногда объединяет таблицы отображения, идентификатор в PR_CONTROL_ID **всегда** должен быть уникальным. Как правило, поставщики назначают структуру [GUID](guid.md) для PR_CONTROL_ID **для** обеспечения ее уникальности. Свойство **PR_CONTROL_ID** включено в структуру TABLE_NOTIFICATION [при](table_notification.md) сгенерировании уведомления таблицы отображения. 
  
Дополнительные сведения о таблицах отображения см. в [таблицах "Реализация таблиц отображения"](display-table-implementation.md) и "Уведомления о таблице [отображения".](about-display-table-notifications.md) 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


---
title: Роль поставщика транспорта в подсистеме MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424058"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a>Роль поставщика транспорта в подсистеме MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Библиотеки динамических ссылок поставщика транспорта (DLLs) предоставляют интерфейс между spooler MAPI и частью системы обмена сообщениями, ответственной за отправку и получение сообщений. Spooler MAPI и поставщик транспорта работают вместе, чтобы справиться с обязанностями отправки сообщения или получения сообщения. Шпалер MAPI загружает DLL поставщика транспорта при первом его использования и освобождает его, когда он больше не требуется. Несколько поставщиков транспорта могут быть установлены в одной системе, но MAPI поставляет один пулер, необходимый.
  
Клиентские приложения обычно не взаимодействуют напрямую с поставщиком транспорта. Вместо этого клиенты отправляют сообщения через поставщика магазинов, а spooler MAPI отправляет исходяющие сообщения соответствующему поставщику транспорта и доставляет входящие сообщения в соответствующий хранилище сообщений. Spooler MAPI делает свою работу и вызывает поставщиков транспорта, когда приложения переднего плана простаивают. После необязательного отображения диалоговых ящиков при первом входе поставщика транспорта поставщики транспорта работают в фоновом режиме, если клиент не вызвал их для очистки отправки и получения очередей. 
  
Поставщики транспорта несут следующие обязанности в системе обмена сообщениями MAPI:
  
- Зарегистрируйте типы адресов, которые они могут принять в spooler MAPI, чтобы шпалер MAPI может отправлять сообщения соответствующему поставщику транспорта в зависимости от адреса назначения сообщений. Один поставщик транспорта может зарегистрировать несколько типов адресов. Поставщики транспорта также могут зарегистрировать адреса определенных получателей в шпалере MAPI. Сообщения, адресованные одному из этих адресов, будут отправлены поставщику транспорта, который зарегистрировал адрес с помощью шпалеров MAPI. Дополнительные сведения см. в [примере Transport Provider и MAPI Spooler Operational Model.](transport-provider-and-mapi-spooler-operational-model.md)
    
- Доставка входящих сообщений в шпалер MAPI. В зависимости от характера системы обмена сообщениями поставщик транспорта может либо напрямую уведомлять пульпер MAPI о прибытии нового сообщения, либо запрашивать периодический опрос поставщика транспорта для проверки новых сообщений.
    
- Преобразование свойств сообщений MAPI в свойства сообщений, которые являются родными для системы обмена сообщениями, и из них. Например, поставщику транспорта может потребоваться преобразовать адреса отправитель и получатель в исходячее сообщение в форму, приемлемую для системы обмена сообщениями. Некоторые системы обмена сообщениями не поддерживают все свойства сообщений MAPI. Дополнительные сведения о сохранении свойств сообщений MAPI при доставке сообщений в систему обмена сообщениями см. в TNEF-Enabled [поставщика транспорта.](developing-a-tnef-enabled-transport-provider.md)
    
- Регистрация сообщений и параметров получателей, определенных поставщику транспорта.
    
- Выполните проверку учетных данных, необходимых для системы обмена сообщениями.
    
- Доступ к исходящие сообщения с помощью объекта сообщения, переданного ему spooler MAPI.
    
- Перевод формата сообщений, как того требует система обмена сообщениями.
    
- Уведомите шпалер **MAPI,** получатели исходячего сообщения, которое поставщик транспорта принял на себя за обработку, установив свойство [PR_RESPONSIBILITY (PidTagResponsibility)](pidtagresponsibility-canonical-property.md)для этих получателей.
    
- Сообщите шпалеру MAPI, когда необходимо обрабатывать входящие сообщения.
    
- Передай входящие данные сообщения в шпалер MAPI с помощью объектов сообщений.
    
- Назначение значений для всех необходимых свойств сообщений MAPI для входящих сообщений.
    
- Удалите сообщение из системы обмена сообщениями после доставки, если это необходимо.
    
- Предоставление сведений о состоянии для пулера MAPI и клиентских приложений.
    
На следующем рисунке показана роль поставщика транспорта по отношению к другим компонентам архитектуры MAPI.
  
**Роль поставщика транспорта в системе обмена сообщениями**
  
![Роль поставщика транспорта в роли]поставщика транспортных сообщений в системе обмена(media/xp01.gif "сообщениями")
  


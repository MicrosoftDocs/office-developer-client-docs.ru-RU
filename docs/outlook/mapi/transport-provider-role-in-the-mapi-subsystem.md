---
title: Роль поставщика транспорта в подсистеме MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424058"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a>Роль поставщика транспорта в подсистеме MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Библиотеки динамической компоновки поставщика транспорта (DLL) предоставляют интерфейс между диспетчером очереди MAPI и частью системы обмена сообщениями, ответственной за отправку и получение сообщений. Диспетчер очереди MAPI и поставщик транспорта работают вместе для обработки обязанностей отправки сообщения или получения сообщения. Диспетчер очереди MAPI загружает БИБЛИОТЕКУ поставщика транспорта при первом использовании и освобождает ее, когда он больше не нужен. Несколько поставщиков транспорта можно установить в одной системе, но MAPI предоставляет один и тот же диспетчер очереди.
  
Клиентские приложения обычно не связываются напрямую с поставщиком транспорта. Вместо этого клиенты отправляют сообщения через поставщика магазина, а диспетчер очереди MAPI отправляет исходящие сообщения соответствующему поставщику транспорта и доставляет входящие сообщения в соответствующее хранилище сообщений. Диспетчер очереди MAPI выполняет свою работу и выполняет звонки поставщикам транспорта, когда фоновые приложения простаивают. После необязательного отображения диалоговых окон при первом входе в систему поставщика транспорта, поставщики транспорта работают в фоновом режиме, если клиент не вызывает сброс очередей отправки и получения. 
  
Поставщики транспорта имеют следующие обязанности в системе обмена сообщениями MAPI:
  
- ЗаРегистрируйте типы адресов, которые они могут принимать с помощью диспетчера очереди MAPI, чтобы диспетчер очереди MAPI мог передавать сообщения соответствующему поставщику транспорта в зависимости от адреса назначения сообщений. Один поставщик транспорта может зарегистрировать несколько типов адресов. Поставщики транспорта также могут регистрировать адреса определенных получателей с помощью диспетчера очереди MAPI. Сообщения, адресованные одному из этих адресов, отправляются в поставщик транспорта, который зарегистрирует адрес с помощью диспетчера очереди MAPI. Для получения дополнительных сведений см [](transport-provider-and-mapi-spooler-operational-model.md).
    
- Доставка входящих сообщений в Диспетчер очереди MAPI. В зависимости от природы системы обмена сообщениями поставщик транспорта может напрямую уведомить Диспетчер очереди MAPI о поступлении нового сообщения или запросить, чтобы диспетчер очереди MAPI мог периодически опрашивать поставщик транспорта для проверки наличия новых сообщений.
    
- Преобразование свойств сообщения MAPI в собственные свойства сообщения в систему обмена сообщениями. Например, поставщику транспорта может потребоваться преобразовать адреса отправителя и получателя в исходящих сообщениях в форму, допустимую для системы обмена сообщениями. Некоторые системы обмена сообщениями не поддерживают все свойства сообщений MAPI. Дополнительные сведения о том, как сохранить свойства сообщений MAPI при доставке сообщений в систему обмена сообщениями, можно узнать в статье [Разработка поставщика транспорта с поддержкой TNEF](developing-a-tnef-enabled-transport-provider.md).
    
- ЗаРегистрируйте параметры сообщений и получателей, относящиеся к поставщику транспорта.
    
- Выполните проверку учетных данных, необходимых для системы обмена сообщениями.
    
- Получать доступ к исходящим сообщениям, используя объект Message, переданный им с помощью диспетчера очереди MAPI.
    
- Перевести Формат сообщений в соответствии с требованиями базовой системы обмена сообщениями.
    
- Уведомите Диспетчер очереди MAPI, какие получатели исходящего сообщения от поставщика транспорта приняли ответственность за обработку путем установки свойства **пр_респонсибилити** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) для этих получателей.
    
- Сообщите о почтовых сообщениях MAPI о необходимости обработки входящего сообщения.
    
- Передача данных входящих сообщений в Диспетчер очереди MAPI с помощью объектов Message.
    
- Назначьте значения всем необходимым свойствам сообщения MAPI для входящих сообщений.
    
- При необходимости удалите сообщение из базовой системы обмена сообщениями после доставки.
    
- Предоставьте сведения о состоянии для диспетчера очереди MAPI и клиентских приложений.
    
На следующем рисунке показана роль поставщика транспорта по отношению к другим компонентам архитектуры MAPI.
  
**Роль поставщика транспорта в системе обмена сообщениями**
  
![Роль поставщика транспорта в системе обмена сообщениями] (media/xp01.gif "Роль поставщика транспорта в системе обмена сообщениями")
  


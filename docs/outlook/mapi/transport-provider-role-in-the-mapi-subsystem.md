---
title: Роль поставщика транспорта в подсистеме MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424058"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a>Роль поставщика транспорта в подсистеме MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Библиотеки динамической ссылки поставщика транспорта предоставляют интерфейс между пулом MAPI и частью системы обмена сообщениями, ответственной за отправку и получение сообщений. Пулер MAPI и поставщик транспорта совместно обрабатывают обязанности по отправке или получении сообщения. Пулер MAPI загружает DLL поставщика транспорта при первом его использования и отпускает его, когда это больше не требуется. В одной системе можно установить несколько поставщиков транспорта, но MAPI обеспечивает один необходимый пул.
  
Клиентские приложения обычно не взаимодействуют напрямую с поставщиком транспорта. Вместо этого клиенты отправляют сообщения через поставщика магазина, а пулер MAPI отправляет исходяющие сообщения соответствующему поставщику транспорта и доставляет входящие сообщения в соответствующее хранилище сообщений. Пулер MAPI делает свою работу и вызывает поставщиков транспорта, когда приложения переднего плана простаивают. После отображения диалоговых окно при первом входе поставщика транспорта поставщики транспорта работают в фоновом режиме, если клиент не вызвал их для очистки очередей отправки и получения. 
  
Поставщики транспорта несут следующие обязанности в системе обмена сообщениями MAPI:
  
- Зарегистрируйте типы адресов, которые они могут принять в пуле MAPI, чтобы пулер MAPI может отправлять сообщения соответствующему поставщику транспорта в зависимости от адреса назначения сообщений. Один поставщик транспорта может зарегистрировать несколько типов адресов. Поставщики транспорта также могут зарегистрировать адреса определенных получателей в пуле MAPI. Сообщения, адресованные одному из этих адресов, будут отправляться поставщику транспорта, который зарегистрировал адрес в пуле MAPI. Дополнительные сведения см. в рабочих модели поставщика транспорта и [пула MAPI.](transport-provider-and-mapi-spooler-operational-model.md)
    
- Доставка входящих сообщений в пул MAPI. В зависимости от характера системы обмена сообщениями поставщик транспорта может либо напрямую уведомить пульер MAPI при поступления нового сообщения, либо запросить у поставщика транспорта периодическое оповещение о новых сообщениях.
    
- Преобразуем свойства сообщений MAPI в свойства сообщений и из них в систему обмена сообщениями. Например, поставщику транспорта может потребоваться преобразовать адреса отправитель и получатель в исходяном сообщении в форму, приемлемую для системы обмена сообщениями. Некоторые системы обмена сообщениями не поддерживают все свойства сообщений MAPI. Дополнительные сведения о сохранении свойств сообщений MAPI при доставке сообщений в систему обмена сообщениями см. в TNEF-Enabled [Transport Provider.](developing-a-tnef-enabled-transport-provider.md)
    
- Регистрация параметров сообщений и получателей, характерных для поставщика транспорта.
    
- Выполните проверку учетных данных, необходимых для системы обмена сообщениями.
    
- Доступ к исходящие сообщения с помощью объекта сообщения, переданного ему пулом MAPI.
    
- Преобразуем формат сообщений в соответствии с требуемой системой обмена сообщениями.
    
- Сообщите пулу MAPI, какие получатели исходячего сообщения поставщик транспорта принял на себя ответственность за обработку, **задав** свойство PR_RESPONSIBILITY ([PidTagResponsibility)](pidtagresponsibility-canonical-property.md)для этих получателей.
    
- Сообщите пулу MAPI, когда необходимо обработать входящие сообщения.
    
- Передав данные входящих сообщений в пул MAPI с помощью объектов сообщений.
    
- Назначьте значения всем требующимся свойствам сообщений MAPI для входящих сообщений.
    
- При необходимости удалите сообщение из системы обмена сообщениями.
    
- Предоставление сведений о состоянии для пула MAPI и клиентских приложений.
    
На следующем рисунке показана роль поставщика транспорта в отношении других компонентов архитектуры MAPI.
  
**Роль поставщика транспорта в системе обмена сообщениями**
  
![Роль поставщика транспорта в роли поставщика транспорта системы]обмена сообщениями в системе обмена(media/xp01.gif "сообщениями")
  


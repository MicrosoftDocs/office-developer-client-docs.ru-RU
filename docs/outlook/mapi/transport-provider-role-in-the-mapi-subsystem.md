---
title: Роль поставщика транспорта в подсистеме MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424058"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="e47bc-103">Роль поставщика транспорта в подсистеме MAPI</span><span class="sxs-lookup"><span data-stu-id="e47bc-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="e47bc-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e47bc-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e47bc-105">Библиотеки динамической компоновки поставщика транспорта (DLL) предоставляют интерфейс между диспетчером очереди MAPI и частью системы обмена сообщениями, ответственной за отправку и получение сообщений.</span><span class="sxs-lookup"><span data-stu-id="e47bc-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="e47bc-106">Диспетчер очереди MAPI и поставщик транспорта работают вместе для обработки обязанностей отправки сообщения или получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="e47bc-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="e47bc-107">Диспетчер очереди MAPI загружает БИБЛИОТЕКУ поставщика транспорта при первом использовании и освобождает ее, когда он больше не нужен.</span><span class="sxs-lookup"><span data-stu-id="e47bc-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="e47bc-108">Несколько поставщиков транспорта можно установить в одной системе, но MAPI предоставляет один и тот же диспетчер очереди.</span><span class="sxs-lookup"><span data-stu-id="e47bc-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="e47bc-109">Клиентские приложения обычно не связываются напрямую с поставщиком транспорта.</span><span class="sxs-lookup"><span data-stu-id="e47bc-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="e47bc-110">Вместо этого клиенты отправляют сообщения через поставщика магазина, а диспетчер очереди MAPI отправляет исходящие сообщения соответствующему поставщику транспорта и доставляет входящие сообщения в соответствующее хранилище сообщений.</span><span class="sxs-lookup"><span data-stu-id="e47bc-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="e47bc-111">Диспетчер очереди MAPI выполняет свою работу и выполняет звонки поставщикам транспорта, когда фоновые приложения простаивают.</span><span class="sxs-lookup"><span data-stu-id="e47bc-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="e47bc-112">После необязательного отображения диалоговых окон при первом входе в систему поставщика транспорта, поставщики транспорта работают в фоновом режиме, если клиент не вызывает сброс очередей отправки и получения.</span><span class="sxs-lookup"><span data-stu-id="e47bc-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="e47bc-113">Поставщики транспорта имеют следующие обязанности в системе обмена сообщениями MAPI:</span><span class="sxs-lookup"><span data-stu-id="e47bc-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="e47bc-114">ЗаРегистрируйте типы адресов, которые они могут принимать с помощью диспетчера очереди MAPI, чтобы диспетчер очереди MAPI мог передавать сообщения соответствующему поставщику транспорта в зависимости от адреса назначения сообщений.</span><span class="sxs-lookup"><span data-stu-id="e47bc-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="e47bc-115">Один поставщик транспорта может зарегистрировать несколько типов адресов.</span><span class="sxs-lookup"><span data-stu-id="e47bc-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="e47bc-116">Поставщики транспорта также могут регистрировать адреса определенных получателей с помощью диспетчера очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="e47bc-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="e47bc-117">Сообщения, адресованные одному из этих адресов, отправляются в поставщик транспорта, который зарегистрирует адрес с помощью диспетчера очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="e47bc-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="e47bc-118">Для получения дополнительных сведений см [](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="e47bc-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="e47bc-119">Доставка входящих сообщений в Диспетчер очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="e47bc-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="e47bc-120">В зависимости от природы системы обмена сообщениями поставщик транспорта может напрямую уведомить Диспетчер очереди MAPI о поступлении нового сообщения или запросить, чтобы диспетчер очереди MAPI мог периодически опрашивать поставщик транспорта для проверки наличия новых сообщений.</span><span class="sxs-lookup"><span data-stu-id="e47bc-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="e47bc-121">Преобразование свойств сообщения MAPI в собственные свойства сообщения в систему обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="e47bc-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="e47bc-122">Например, поставщику транспорта может потребоваться преобразовать адреса отправителя и получателя в исходящих сообщениях в форму, допустимую для системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="e47bc-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="e47bc-123">Некоторые системы обмена сообщениями не поддерживают все свойства сообщений MAPI.</span><span class="sxs-lookup"><span data-stu-id="e47bc-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="e47bc-124">Дополнительные сведения о том, как сохранить свойства сообщений MAPI при доставке сообщений в систему обмена сообщениями, можно узнать в статье [Разработка поставщика транспорта с поддержкой TNEF](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="e47bc-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="e47bc-125">ЗаРегистрируйте параметры сообщений и получателей, относящиеся к поставщику транспорта.</span><span class="sxs-lookup"><span data-stu-id="e47bc-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="e47bc-126">Выполните проверку учетных данных, необходимых для системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="e47bc-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="e47bc-127">Получать доступ к исходящим сообщениям, используя объект Message, переданный им с помощью диспетчера очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="e47bc-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="e47bc-128">Перевести Формат сообщений в соответствии с требованиями базовой системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="e47bc-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="e47bc-129">Уведомите Диспетчер очереди MAPI, какие получатели исходящего сообщения от поставщика транспорта приняли ответственность за обработку путем установки свойства **пр_респонсибилити** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) для этих получателей.</span><span class="sxs-lookup"><span data-stu-id="e47bc-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="e47bc-130">Сообщите о почтовых сообщениях MAPI о необходимости обработки входящего сообщения.</span><span class="sxs-lookup"><span data-stu-id="e47bc-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="e47bc-131">Передача данных входящих сообщений в Диспетчер очереди MAPI с помощью объектов Message.</span><span class="sxs-lookup"><span data-stu-id="e47bc-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="e47bc-132">Назначьте значения всем необходимым свойствам сообщения MAPI для входящих сообщений.</span><span class="sxs-lookup"><span data-stu-id="e47bc-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="e47bc-133">При необходимости удалите сообщение из базовой системы обмена сообщениями после доставки.</span><span class="sxs-lookup"><span data-stu-id="e47bc-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="e47bc-134">Предоставьте сведения о состоянии для диспетчера очереди MAPI и клиентских приложений.</span><span class="sxs-lookup"><span data-stu-id="e47bc-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="e47bc-135">На следующем рисунке показана роль поставщика транспорта по отношению к другим компонентам архитектуры MAPI.</span><span class="sxs-lookup"><span data-stu-id="e47bc-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="e47bc-136">**Роль поставщика транспорта в системе обмена сообщениями**</span><span class="sxs-lookup"><span data-stu-id="e47bc-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="e47bc-137">![Роль поставщика транспорта в системе обмена сообщениями] (media/xp01.gif "Роль поставщика транспорта в системе обмена сообщениями")</span><span class="sxs-lookup"><span data-stu-id="e47bc-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  


---
title: Структура потока TNEF
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8eda1251-3858-4832-ac43-d817b4a7ea59
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0fcd1c79d1c0debfb18d270dc0e40de42842c6d9
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812500"
---
# <a name="tnef-stream-structure"></a>Структура потока TNEF

  
  
**Относится к**: Outlook 
  
Поток TNEF начинается с подписью 32-разрядная версия, которая идентифицирует поток как поток TNEF. После подписи — это 16-разрядное целое число без знака, используемый в качестве ключа для перекрестная ссылка вложения на их расположение в текст с тегами сообщения. В оставшейся части потока — это последовательность атрибутов TNEF. Атрибуты сообщений отображаются первый в поток TNEF и следуйте атрибуты вложения. Атрибуты, относящихся к конкретной вложения сгруппированы, Приступая к работе с помощью атрибута **attAttachRenddata** . 
  
Большинство констант, используемых в формате TNEF потоков определены в формате TNEF. Файл заголовка. Прежде всего **TNEF_SIGNATURE**, **LVL_MESSAGE**, **LVL_ATTACHMENT**и идентификаторы TNEF атрибута определены в этот файл. Другие константы имеют значения, указанный в параметре их обработку для компилятора языка C. Как правило такие константы используются для предоставления размеры следующий элемент. Например, **sizeof(ULONG)** в определении элемента указывает целое число, представляющее размер следующие длинное целое, которые должны появиться в этой позиции в потоке TNEF. 
  
Все целые числа в поток TNEF хранятся в двоичном формате с прямым, но в шестнадцатеричном представлении в этом разделе представлены. Контрольная сумма значений, просто 16-разрядный целых чисел, которые являются суммы по модулю 65536 байт данных, к которому применяется контрольной суммой. Все значения длины ключа атрибута: длинные целые числа без знака, включая символы прерывающие null.
  
Ключ — это отличное от нуля, 16-разрядный неподписанных целое число, означающую начального значения разделов ссылку вложения. Ключи ссылку вложения назначаются для каждого вложения, последовательно Приступая к работе с начального значения, которое передается в функцию [OpenTnefStream](opentnefstream.md) с поставщиком, который использует TNEF. Поставщик услуг должен создавать в случайном порядке начального значения для ключа для сведения к минимуму вероятность, что два сообщения использовать тот же ключ. 
  
Реализация TNEF использует идентификаторы атрибута для сопоставления атрибутов их соответствующие свойства MAPI. Идентификатор атрибута является 32-разрядное целое число без знака состоит из двух значений word. Word высокого приоритета указывает тип данных, таких как строка или двоичные данные, и низкого приоритета word идентифицирует определенный атрибут. Типы данных в word старших являются:
  
|**Тип**|**Значение**|
|:-----|:-----|
|atpTriples  <br/> |0x0000  <br/> |
|atpString  <br/> |0x0001  <br/> |
|atpText  <br/> |0x0002  <br/> |
|atpDate  <br/> |0x0003  <br/> |
|atpShort  <br/> |0x0004  <br/> |
|atpLong  <br/> |0x0005  <br/> |
|atpByte  <br/> |0x0006  <br/> |
|atpWord  <br/> |0x0007  <br/> |
|atpDword  <br/> |0x0008  <br/> |
|atpMax  <br/> |0x0009  <br/> |
   
Значения word низкого приоритета для каждого атрибута определены в формате TNEF. Файл заголовка.
  


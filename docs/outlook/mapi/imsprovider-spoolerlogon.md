---
title: Имспровидерспулерлогон
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMSProvider.SpoolerLogon
api_type:
- COM
ms.assetid: 79d5af23-efad-4013-a330-56babfb2bb0f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 794674df38266743cac8c947ec93dc1fcfff438b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32309739"
---
# <a name="imsproviderspoolerlogon"></a>IMSProvider::SpoolerLogon

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
ЗаНосит в журнал Диспетчер очереди MAPI в хранилище сообщений.
  
```cpp
HRESULT SpoolerLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulFlags,
  LPCIID lpInterface,
  ULONG cbSpoolSecurity,
  LPBYTE lpbSpoolSecurity,
  LPMAPIERROR FAR * lppMAPIError,
  LPMSLOGON FAR * lppMSLogon,
  LPMDB FAR * lppMDB     
);
```

## <a name="parameters"></a>Параметры

 _Лпмаписуп_
  
> возврата Указатель на объект поддержки MAPI для хранилища сообщений.
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна любых диалоговых окон или окон, которые отображает этот метод. 
    
 _Лпсзпрофиленаме_
  
> возврата Указатель на строку, содержащую имя профиля, используемого для входа в систему диспетчера очереди MAPI. Эта строка может отображаться в диалоговых окнах, записанных в файл журнала или просто игнорироваться. Он должен быть в формате Юникод, если в параметре _ulFlags_ ЗАДАН флаг мапи_уникоде. 
    
 _Кбентрид_
  
> возврата Размер (в байтах) идентификатора записи, на который указывает параметр _лпентрид_ . 
    
 _Лпентрид_
  
> возврата Указатель на идентификатор записи для хранилища сообщений. При передаче значения NULL в параметре _лпентрид_ показывается, что хранилище сообщений еще не выбрано, а также отображаются диалоговые окна, позволяющие пользователю выбрать хранилище сообщений. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющая способ выполнения входа. Можно задать следующие флаги:
    
МАПИ_ДЕФЕРРЕД_ЕРРОРС 
  
> Вызов может быть выполнен, даже если базовый объект недоступен для вызывающей реализации. Если объект недоступен, последующий вызов объекта может вызвать ошибку.
    
MAPI_UNICODE 
  
> Переданные строки имеют формат Юникод. Если МАПИ_УНИКОДЕ не задано, строки представлены в формате ANSI.
    
МДБ_НО_ДИАЛОГ 
  
> Запрещает отображение диалоговых окон входа в систему. Если этот флаг установлен, значение ошибки МАПИ_Е_ЛОГОН_ФАИЛЕД возвращается в случае неудачного входа. Если этот флаг не установлен, поставщик хранилища сообщений может предложить пользователю исправить имя или пароль, вставить диск или выполнить другие действия, необходимые для установки подключения к хранилищу.
    
МДБ_ВРИТЕ 
  
> ЗаПрашивает разрешение на чтение и запись.
    
 _Лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID) для подключения к хранилищу сообщений. Передача значения NULL указывает, что возвращается интерфейс MAPI для хранилища сообщений ([IMsgStore](imsgstoreimapiprop.md)). Для параметра _лпинтерфаце_ также можно задать идентификатор соответствующего интерфейса для хранилища сообщений (например, Иид_иункновн или иид_имапипроп). 
    
 _Кбспулсекурити_
  
> возврата Указатель на размер проверочных данных (в байтах) в параметре _лппбспулсекурити_ . 
    
 _Лпбспулсекурити_
  
> возврата Указатель на указатель на проверочные данные. Метод **спулерлогон** использует эти данные для входа в систему БУФЕРИЗАЦИи MAPI в то же хранилище, что и поставщик хранилища сообщений, ранее вошедшего в систему, с помощью метода [Функцииimsprovider:: logon](imsprovider-logon.md) . 
    
 _Лппмапиеррор_
  
> вышли Указатель на указатель на возвращенную структуру [мапиеррор](mapierror.md) (при наличии), содержащую сведения о версии, компоненте и контексте ошибки. Параметр _лппмапиеррор_ может иметь значение null, если структура **мапиеррор** для возврата отсутствует. 
    
 _Лппмслогон_
  
> вышли Указатель на указатель на объект входа хранилища сообщений для входа MAPI.
    
 _Лппмдб_
  
> вышли Указатель на указатель на объект хранилища сообщений для системы буферизации MAPI и клиентских приложений для входа в.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������.
    
МАПИ_Е_УНКОНФИГУРЕД 
  
> Профиль не содержит достаточно сведений для завершения входа. Когда возвращается это значение, MAPI вызывает функцию точки входа службы сообщений поставщика хранилища сообщений.
    
МАПИ_В_ЕРРОРС_РЕТУРНЕД 
  
> Вызов выполнен успешно, но у поставщика хранилища сообщений есть доступные сведения об ошибке. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md). Чтобы получить сведения об ошибке от поставщика, вызовите метод [IMAPISession:: GetLastError](imapisession-getlasterror.md) . 
    
## <a name="remarks"></a>Замечания

Диспетчер очереди MAPI вызывает метод **функцииimsprovider:: спулерлогон** для входа в хранилище сообщений. Диспетчер очереди MAPI должен использовать объект хранилища сообщений, возвращенный поставщиком хранилища сообщений, в параметре _лппмдб_ во время и после входа. 
  
Для обеспечения совместимости с методом [функцииimsprovider:: logon](imsprovider-logon.md) поставщик также возвращает объект входа в хранилище сообщений в параметре _лппмслогон_ . Использование объекта Store и объекта logon одинаково для обычного входа в систему хранения; между объектом logon и объектом Store должно быть отношение "один к одному", чтобы объекты действовали так, как если бы они были одним объектом, который предоставляет два интерфейса. Два объекта создаются вместе и освобождаются вместе. 
  
Поставщик магазина должен внутренним образом пометить возвращенный объект хранилища сообщений, чтобы указать, что хранилище используется диспетчером MAPI. Некоторые методы для этого объекта хранилища ведут себя иначе, чем для объекта хранилища сообщений, предоставленного клиентским приложениям. Хранение этой внутренней метки является самым распространенным способом запуска поведения, характерного для диспетчера очереди MAPI.
  
## <a name="see-also"></a>См. также



[IMSProvider::Logon](imsprovider-logon.md)
  
[MAPIERROR](mapierror.md)
  
[IMSProvider : IUnknown](imsprovideriunknown.md)


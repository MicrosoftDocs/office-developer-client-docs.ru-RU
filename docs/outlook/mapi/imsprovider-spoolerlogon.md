---
title: IMSProviderSpoolerLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMSProvider.SpoolerLogon
api_type:
- COM
ms.assetid: 79d5af23-efad-4013-a330-56babfb2bb0f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 794674df38266743cac8c947ec93dc1fcfff438b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33430576"
---
# <a name="imsproviderspoolerlogon"></a>IMSProvider::SpoolerLogon

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Занося в журнал пул MAPI в хранилище сообщений.
  
```cpp
HRESULT SpoolerLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulFlags,
  LPCIID lpInterface,
  ULONG cbSpoolSecurity,
  LPBYTE lpbSpoolSecurity,
  LPMAPIERROR FAR * lppMAPIError,
  LPMSLOGON FAR * lppMSLogon,
  LPMDB FAR * lppMDB     
);
```

## <a name="parameters"></a>Параметры

 _lpMAPISup_
  
> [in] Указатель на объект поддержки MAPI для хранения сообщений.
    
 _ulUIParam_
  
> [in] Handle to the parent window of any dialog boxes or windows this method displays. 
    
 _lpszProfileName_
  
> [in] Указатель на строку, содержаную имя профиля, используемого для имени пула MAPI. Эта строка может отображаться в диалоговом окне, записана в файл журнала или просто игнорируется. Он должен быть в формате Юникод, MAPI_UNICODE флага в _параметре ulFlags._ 
    
 _cbEntryID_
  
> [in] Размер идентификатора записи в вайтах, на который указывает параметр _lpEntryID._ 
    
 _lpEntryID_
  
> [in] Указатель на идентификатор записи для хранения сообщений. Передача NULL в  _параметре lpEntryID_ означает, что хранилище сообщений еще не выбрано и могут быть представлены диалоговые окна, позволяющие пользователю выбрать хранилище сообщений. 
    
 _ulFlags_
  
> [in] Битоваяmas флагов, которая управляет выполнением выполнения для этого. Можно установить следующие флаги:
    
MAPI_DEFERRED_ERRORS 
  
> Вызов может быть успешным даже в том случае, если его объект недопустим для реализации вызова. Если объект не доступен, последующий вызов объекта может вызвать ошибку.
    
MAPI_UNICODE 
  
> Переданные строки имеют формат Юникод. Если MAPI_UNICODE не установлен, строки будут в формате ANSI.
    
MDB_NO_DIALOG 
  
> Предотвращает отображение диалогов для логотипа. Если этот флаг установлен, значение ошибки MAPI_E_LOGON_FAILED возвращается в случае ошибки при запуске. Если этот флаг не установлен, поставщик store сообщений может отправить пользователю запрос на исправление имени или пароля, вставить диск или выполнить другие действия, необходимые для установления подключения к магазину.
    
MDB_WRITE 
  
> Запрашивает разрешение на чтение и записи.
    
 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса для входа в хранилище сообщений. Передача NULL означает, что возвращается интерфейс MAPI для хранения сообщений[(IMsgStore).](imsgstoreimapiprop.md) Параметру  _lpInterface_ также можно присвоить идентификатор для соответствующего интерфейса для хранения сообщений (например, IID_IUnknown или IID_IMAPIProp). 
    
 _cbSpoolSecurity_
  
> [in] Указатель на размер данных проверки в параметре  _lppbSpoolSecurity_ (в bytes). 
    
 _lpbSpoolSecurity_
  
> [in] Указатель на указатель на данные проверки. Метод **SpoolerLogon** использует эти данные для входа пула MAPI в то же хранилище, в которое ранее входил поставщик store сообщений с помощью метода [IMSProvider::Logon.](imsprovider-logon.md) 
    
 _lppMAPIError_
  
> [out] Указатель на указатель на возвращенную структуру [MAPIERROR](mapierror.md) (если таковые есть), которая содержит сведения о версии, компоненте и контексте для ошибки. Для _параметра lppMAPIError_ можно установить NULL, если не существует возвращаемой структуры **MAPIERROR.** 
    
 _lppMSLogon_
  
> [out] Указатель на указатель на объект входа в хранилище сообщений для входа в MAPI.
    
 _lppMDB_
  
> [out] Указатель на указатель на объект хранения сообщений для входа в пул MAPI и клиентских приложений.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������.
    
MAPI_E_UNCONFIGURED 
  
> Профиль не содержит достаточно сведений для завершения работы с данными. При возврате этого значения MAPI вызывает функцию точки входа службы сообщений поставщика службы сообщений.
    
MAPI_W_ERRORS_RETURNED 
  
> Вызов был успешным, но у поставщика хранения сообщений есть сведения об ошибке. При возврате этого предупреждения вызов должен быть обработан как успешный. Чтобы проверить это предупреждение, используйте **макрос HR_FAILED.** Дополнительные сведения см. в теме ["Использование макроса для обработки ошибок".](using-macros-for-error-handling.md) Чтобы получить сведения об ошибке от поставщика, вызовите метод [IMAPISession::GetLastError.](imapisession-getlasterror.md) 
    
## <a name="remarks"></a>Примечания

Пулер MAPI вызывает метод **IMSProvider::SpoolerLogon** для входа в хранилище сообщений. Пулер MAPI должен использовать объект банка сообщений, возвращенный поставщиком банка сообщений в параметре  _lppMDB_ во время и после этого. 
  
Для согласованности с методом [IMSProvider::Logon](imsprovider-logon.md) поставщик также возвращает объект для логотипа для хранения сообщений в _параметре lppMSLogon._ Использование объекта store и объекта для логотипа идентично обычному окну для логотипа магазина; между объектом для логотипа и объектом хранения должно быть соответствие "один к одному", чтобы объекты действовали так, будто они являются одним объектом, который предоставляет два интерфейса. Эти два объекта создаются вместе и вместе освобождены. 
  
Поставщик магазина должен внутренне пометить возвращенный объект, чтобы указать, что хранилище используется пулером MAPI. Некоторые методы для этого объекта store ведут себя иначе, чем для объекта хранения сообщений, предоставляемого клиентские приложения. Сохранение этой внутренней метки является наиболее распространенным способом запуска поведения, характерного для пула MAPI.
  
## <a name="see-also"></a>См. также



[IMSProvider::Logon](imsprovider-logon.md)
  
[MAPIERROR](mapierror.md)
  
[IMSProvider : IUnknown](imsprovideriunknown.md)


---
title: Модель отправки сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4bcd19f6-c225-43ac-8c27-c46388e9097a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 090a765fd6c758e5f146caa0e7f36276b052f69e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356877"
---
# <a name="message-submission-model"></a>Модель отправки сообщений

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Отправка сообщений выполняется с помощью ряда вызовов от диспетчера очереди MAPI к поставщику транспорта. Звонки упорядочены следующим образом:
  
1. Диспетчер очереди MAPI вызывает [иксплогон:: субмитмессаже](ixplogon-submitmessage.md), передавая экземпляр [iMessage: IMAPIProp](imessageimapiprop.md) , чтобы приступить к процессу. 
    
2. Затем поставщик транспорта помещает значение ссылки (идентификатор, определенный транспортом), используемый в дальнейших ссылках на это сообщение, в расположении, указанном в **субмитмессаже**.
    
3. Поставщик транспорта получает доступ к данным сообщения с помощью передаваемого экземпляра **iMessage** . Для каждого получателя в переданном **iMessage** , для которого он принимает ответственность, поставщик транспорта задает свойство **пр_респонсибилити** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)), а затем возвращает.
    
4. Поставщик транспорта может использовать метод [имаписуппорт:: статусреЦипс](imapisupport-statusrecips.md) , чтобы определить, распознают ли они тех получателей, которые не могут быть доставлены, или создать стандартный отчет о доставке. **СтатусреЦипс** — это удобство для поставщиков транспорта, которые определили, что некоторые из получателей не могут быть доставлены или получали сведения о доставке от своей базовой системы обмена сообщениями, которую может выполнять пользователь или клиентское приложение. получите полезную возможность. 
    
5. Вызов [иксплогон:: ендмессаже](ixplogon-endmessage.md) — это последняя ответственность за отправку сообщений от очереди MAPI к поставщику транспорта. 
    
6. Диспетчер очереди MAPI может использовать [иксплогон:: транспортнотифи](ixplogon-transportnotify.md) для отмены обработки сообщений во время вызовов **субмитмессаже** или **ендмессаже** . 
    


---
title: Тесно связанные поставщики хранилищ сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413229"
---
# <a name="tightly-coupled-message-store-providers"></a>Тесно связанные поставщики хранилищ сообщений

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщики хранилищ сообщений можно тесно присвоить с помощью поставщика транспорта. Тесное связывание поставщиков служб MAPI означает реализацию двух поставщиков, которые могут связываться с поставщиком услуг хранения и поставщиком транспорта, чтобы сделать процесс отправки и получения сообщений более эффективным. Преимуществом этого является то, что улучшения производительности могут возникать, когда два поставщика услуг могут взаимодействовать друг с другом напрямую, а не с помощью диспетчера очереди MAPI. Чтобы тесно присвоить поставщику услуг хранения сообщений поставщику транспорта, поставщик транспорта должен поместить идентификатор записи поставщика хранилища сообщений в свойство **пр_овн_сторе_ентрид** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) объекта поставщика транспорта строка в таблице состояния MAPI. Это позволяет диспетчеру очереди MAPI подключить поставщик хранилища к поставщику транспорта.
  
Нет необходимости, чтобы поставщик хранилища сообщений был тесно связан с любым другим поставщиком услуг. Самый распространенный поставщик услуг, тесно связанный с поставщиком хранилища сообщений, это поставщик транспорта. Это обычно делается для того, чтобы отправку и получение сообщений можно было не с помощью диспетчера очереди MAPI. Например, когда пользователь отправляет исходящее сообщение, поставщик хранилища сообщений и поставщик транспорта могут отправлять его напрямую. Объединенным поставщикам услуг не требуется сначала уведомлять Диспетчер очереди MAPI о том, что требуется обработать новое сообщение, а затем подождать, пока диспетчер очереди сообщений попытается запустить процесс передачи сообщения от поставщика хранилища сообщений поставщику транспорта. Это имеет определенные преимущества при использовании серверного хранилища сообщений путем минимизации сетевого трафика между компьютером пользователя и сервером.
  
Как правило, для тесной связи между поставщиками служб не существует строго заданных процедур. Однако необходимо придерживаться следующих рекомендаций:
  
- Если причиной тесной связи между поставщиками служб является производительность, следует помнить о том, что соединение принимает части подсистемы MAPI из процессов, в которых обычно вовлечены эти части. Это означает, что отдельные части в Объединенном поставщике услуг должны взаимодействовать друг с другом, чтобы имитировать взаимодействие, которое обычно имеет те же части подсистемы MAPI, которые не используются.
    
- Когда тесно связанные поставщики услуг взаимодействуют с другими компонентами MAPI, они по-прежнему должны взаимодействовать с ними именно так, как если бы они не были тесно связаны. Например, если пользователь использует комбинированный поставщик хранилища сообщений и поставщик транспорта в качестве хранилища сообщений по умолчанию, но использует отдельный поставщик транспорта для отправки сообщений, как это может произойти, когда пользователь принимает компьютер в дороге и переключается на удаленный транспорт овидер — часть хранилища сообщений в тесно связанном поставщике услуг по-прежнему должна взаимодействовать с диспетчером очереди MAPI так же, как если бы это был отдельный поставщик хранилища сообщений.
    
## <a name="see-also"></a>См. также



[Разработка поставщика хранилища сообщений MAPI](developing-a-mapi-message-store-provider.md)


---
title: Тесно совмещение поставщиков store сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413229"
---
# <a name="tightly-coupled-message-store-providers"></a>Тесно совмещение поставщиков store сообщений

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщики store сообщений могут быть тесно совмещение с поставщиком транспорта. Тесное связывание поставщиков услуг MAPI означает реализацию двух поставщиков, чтобы поставщик и поставщик транспорта могли взаимодействовать друг с другом, чтобы сделать процесс отправки и получения сообщений более эффективным. Преимущество этого в том, что повышение производительности может привести к прямому взаимодействию двух поставщиков услуг, а не с помощью пула MAPI. Чтобы тесно прикрепить поставщика хранилищ сообщений к поставщику транспорта, поставщик транспорта должен разместить идентификатор записи поставщика хранилищ сообщений в свойстве **PR_OWN_STORE_ENTRYID** [(PidTagOwnStoreEntryId)](pidtagownstoreentryid-canonical-property.md)в строке поставщика транспорта в таблице состояния MAPI. Это позволяет поставщику услуг хранения MAPI подключаться к поставщику транспорта.
  
Не требуется, чтобы поставщик store сообщений всегда был тесно совмещением с любым другим поставщиком услуг. Наиболее распространенным поставщиком услуг для тесной связи с поставщиком store сообщений является поставщик транспорта. Обычно это делается для того, чтобы отправлять и получать сообщения без использования пула MAPI. Например, когда пользователь отправляет исходяное сообщение, объединенный поставщик и поставщик транспорта может отправить его напрямую. Объединенные поставщики услуг не должны сначала уведомлять поставщика mapI о том, что есть новое сообщение для обработки, а затем ждать, пока пулер MAPI инициирует процесс передачи сообщения от поставщика store сообщений поставщику транспорта. Это имеет определенные преимущества, если используется серверное хранилище сообщений за счет минимизации сетевого трафика между компьютером пользователя и сервером.
  
В общем, нет точно заданных процедур для тесного связи поставщиков услуг. Однако следует использовать следующие рекомендации:
  
- Если причиной тесного связи поставщиков услуг является производительность, следует помнить, что при этом части подсистемы MAPI вытеснены из процессов, в которых эти части обычно участвуют. Это означает, что отдельные части в объединенном поставщике услуг должны взаимодействовать друг с другом таким образом, чтобы имитировать взаимодействие, которое они обычно имеют с частями подсистемы MAPI, которые не используются.
    
- Если поставщики услуг тесно взаимодействуют с другими компонентами MAPI, они должны взаимодействовать с ними точно так же, как если бы они не были тесно связи. Например, если пользователь использует комбинированное хранилище сообщений и поставщика транспорта как хранилище сообщений по умолчанию, но для отправки сообщений используется отдельный поставщик транспорта, как это может произойти, когда пользователь переходит на удаленный транспортный поставщик, часть этого поставщика службы по-прежнему должна взаимодействовать с поставщиком службы MAPI так же, как если бы он был отдельным поставщиком.
    
## <a name="see-also"></a>См. также



[Разработка поставщика хранилища сообщений MAPI](developing-a-mapi-message-store-provider.md)


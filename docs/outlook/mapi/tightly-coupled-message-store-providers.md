---
title: Поставщики магазинов сообщений с тесной парой
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c9996dad1e9aa8c291f1cd593d9651994d86141
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413229"
---
# <a name="tightly-coupled-message-store-providers"></a>Поставщики магазинов сообщений с тесной парой

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщики магазинов сообщений могут быть тесно вместе с поставщиком транспорта. Тесное связывание поставщиков услуг MAPI означает реализацию этих двух поставщиков, чтобы поставщик магазинов и поставщик транспорта могли общаться, чтобы сделать процесс отправки и получения сообщений более эффективным. Преимуществом этого является то, что повышение производительности может привести к взаимодействию двух поставщиков услуг непосредственно друг с другом, а не с помощью пулера MAPI. Чтобы тесно прикрепить поставщика хранения сообщений к поставщику транспорта, поставщик транспорта должен разместить идентификатор входа поставщика в хранилище сообщений в свойстве **PR_OWN_STORE_ENTRYID** [(PidTagOwnStoreEntryId)](pidtagownstoreentryid-canonical-property.md)в строке поставщика транспорта в таблице состояния MAPI. Это позволяет шпалеру MAPI подключать поставщика магазинов к поставщику транспорта.
  
Не требуется, чтобы поставщик хранения сообщений когда-либо был тесно совмещение с любым другим поставщиком услуг. Наиболее распространенным поставщиком услуг для тесной связи с поставщиком магазина сообщений является поставщик транспорта. Обычно это делается для того, чтобы отправка и получение сообщений могли выполняться без участия пульпера MAPI. Например, когда пользователь отправляет исходяние сообщения, поставщик и поставщик транспортных сообщений могут отправлять его напрямую. Объединенные поставщики услуг не должны сначала уведомлять шпалер MAPI о том, что для обработки необходимо новое сообщение, а затем ждать, пока spooler MAPI начнет процесс передачи сообщения от поставщика хранения сообщений поставщику транспорта. Это имеет особые преимущества, когда серверный хранилище сообщений используется путем минимизации сетевого трафика между компьютером пользователя и сервером.
  
Как правило, для поставщиков тесного связи не существует определенных процедур. Однако следует использовать следующие рекомендации:
  
- Если причиной тесного связи поставщиков служб является производительность, следует помнить, что связь принимает части подсистемы MAPI из процессов, в которых обычно участвуют эти части. Это означает, что отдельные части в объединенном поставщике услуг должны взаимодействовать друг с другом таким образом, чтобы имитировать взаимодействие, которое обычно имеется с частями подсистемы MAPI, которые не используются.
    
- Если поставщики услуг тесно взаимодействуют с другими компонентами MAPI, они по-прежнему должны взаимодействовать с ними таким образом, как если бы они не были тесно совмедомы. Например, если пользователь использует поставщика комбинированных сообщений и поставщика транспорта в качестве магазина сообщений по умолчанию, но использует отдельного поставщика транспорта для отправки сообщений, как это может произойти, когда пользователь берет компьютер на дорогу и переключается на поставщика удаленного транспорта , часть магазина сообщений поставщика тесной связи должна по-прежнему взаимодействовать с поставщиком сообщений MAPI так же, как если бы он был автономным поставщиком сообщений.
    
## <a name="see-also"></a>См. также



[Разработка поставщика хранилища сообщений MAPI](developing-a-mapi-message-store-provider.md)


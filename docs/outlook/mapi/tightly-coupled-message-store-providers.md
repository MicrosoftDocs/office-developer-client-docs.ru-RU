---
title: Тесно связанные поставщики хранилищ сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2eb493d7-bbd1-45b2-bd82-2bc452b2deab
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 83ebb739302ca0e12604b9eaf854f273554826ad
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812478"
---
# <a name="tightly-coupled-message-store-providers"></a><span data-ttu-id="ff5bf-103">Тесно связанные поставщики хранилищ сообщений</span><span class="sxs-lookup"><span data-stu-id="ff5bf-103">Tightly Coupled Message Store Providers</span></span>

  
  
<span data-ttu-id="ff5bf-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="ff5bf-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="ff5bf-105">Поставщики хранилища сообщений может быть тесно связаны с помощью поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-105">Message store providers can be tightly coupled with a transport provider.</span></span> <span data-ttu-id="ff5bf-106">Устанавливается связь между MAPI службы поставщиков означает, что реализация двух поставщиков таким образом, чтобы сделать процесс отправки и получения сообщений более эффективно обмениваться данными поставщика хранилища и поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-106">Tightly coupling MAPI service providers means implementing the two providers such that the store provider and transport provider can communicate to make the process of sending and receiving messages more efficient.</span></span> <span data-ttu-id="ff5bf-107">Это преимущество —, что повышение производительности может возникнуть, когда два поставщиков услуг могут взаимодействовать друг с другом напрямую, а не с помощью диспетчера очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-107">The benefit of doing this is that performance improvements can result when two service providers can interact with each other directly rather than by means of MAPI spooler.</span></span> <span data-ttu-id="ff5bf-108">Тесно связать поставщика хранилища сообщений для поставщика транспорта, поставщика транспорта необходимо установить идентификатор поставщика хранилища сообщений запись в свойство **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) в поставщика транспорта Строка в таблице состояния MAPI.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-108">To tightly couple a message store provider to a transport provider, the transport provider must place the message store provider's entry identifier in the **PR_OWN_STORE_ENTRYID** ([PidTagOwnStoreEntryId](pidtagownstoreentryid-canonical-property.md)) property in the transport provider's row in the MAPI status table.</span></span> <span data-ttu-id="ff5bf-109">Это позволяет диспетчер очереди MAPI для подключения к поставщика транспорта поставщика хранилища.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-109">This enables MAPI spooler to connect the store provider to the transport provider.</span></span>
  
<span data-ttu-id="ff5bf-110">Нет необходимости в том, что поставщик хранения сообщений когда-либо быть тесно связаны с другим поставщиком услуг.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-110">There is no requirement that a message store provider ever be tightly coupled with any other service provider.</span></span> <span data-ttu-id="ff5bf-111">Наиболее распространенные поставщика услуг для тесно связать с поставщиком хранилища сообщений — это поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-111">The most common service provider to tightly couple with a message store provider is a transport provider.</span></span> <span data-ttu-id="ff5bf-112">Обычно это делается, таким образом, отправка и получение сообщений можно выполнить без привлечения диспетчер очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-112">This is usually done so that sending and receiving messages can be accomplished without involving the MAPI spooler.</span></span> <span data-ttu-id="ff5bf-113">Например при отправке исходящих сообщений поставщика хранилища объединенный сообщения и поставщика транспорта можно отправить его непосредственно.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-113">For example, when the user submits an outgoing message, the combined message store provider and transport provider can send it directly.</span></span> <span data-ttu-id="ff5bf-114">Поставщиков услуг объединенный не нужно получить уведомление диспетчер очереди MAPI, что является новое сообщение для обработки и подождите, пока диспетчер очереди MAPI начать процесс передачи сообщения от поставщика хранилища сообщений поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-114">The combined service providers do not have to first notify MAPI spooler that there is a new message to process and then wait for MAPI spooler to initiate the process of transferring the message from the message store provider to the transport provider.</span></span> <span data-ttu-id="ff5bf-115">Это дает определенный ряд преимуществ при использовании хранилища сообщений на основе сервера путем минимизации сетевого трафика между компьютером пользователя и сервером.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-115">This has particular benefits when a server-based message store is being used by minimizing network traffic between the user's computer and the server.</span></span>
  
<span data-ttu-id="ff5bf-116">Как правило существует не хорошо указанного процедур устанавливается связь между поставщиками услуг.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-116">In general, there are no well-specified procedures for tightly coupling service providers.</span></span> <span data-ttu-id="ff5bf-117">Тем не менее следует использовать следующие рекомендации:</span><span class="sxs-lookup"><span data-stu-id="ff5bf-117">However, you should use the following guidelines:</span></span>
  
- <span data-ttu-id="ff5bf-118">Если причина устанавливается связь между поставщиками услуг производительности, обратите внимание, что связь принимает части подсистемы MAPI из него процессами, составляющих обычно будет принимать участие в.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-118">If the reason for tightly coupling service providers is performance, be aware that the coupling takes parts of the MAPI subsystem out of the processes that those parts would normally be involved in.</span></span> <span data-ttu-id="ff5bf-119">Это означает, что отдельных частей в поставщик услуг объединенный должны взаимодействовать друг с другом, чтобы моделирует взаимодействие, которое обычно бы части подсистемы MAPI, которые не используются.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-119">This implies that the individual parts in the combined service provider should interact with each other in a way that simulates the interaction they would normally have with the parts of the MAPI subsystem that are not being used.</span></span>
    
- <span data-ttu-id="ff5bf-120">При взаимодействии поставщиков услуг тесно связанных с другими компонентами MAPI, они должны по-прежнему работать с ними точно так, если они не были тесно связанными.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-120">When tightly coupled service providers do interact with other MAPI components, they must still interact with them in exactly the way they would if they were not tightly coupled.</span></span> <span data-ttu-id="ff5bf-121">Например, если пользователь использует поставщик транспорта и поставщика хранилища объединенный сообщение как их хранилища сообщений по умолчанию, но с использованием поставщика отдельные транспорта для отправки сообщений, как может произойти, если пользователь принимает компьютера в пути и переключает пр удаленного транспорта ovider — часть хранилища сообщений поставщика услуг тесно связанных по-прежнему необходимо взаимодействовать с диспетчер очереди MAPI, так же, как если бы поставщика хранилища сообщений автономных.</span><span class="sxs-lookup"><span data-stu-id="ff5bf-121">For example, if a user is using a combined message store provider and transport provider as their default message store but is using a separate transport provider to send messages — as can happen when a user takes a computer on the road and switches to a remote transport provider — the message store portion of the tightly coupled service provider must still interact with MAPI spooler just as if it were a standalone message store provider.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="ff5bf-122">См. также</span><span class="sxs-lookup"><span data-stu-id="ff5bf-122">See also</span></span>



[<span data-ttu-id="ff5bf-123">���������� ���������� ��������� ��������� MAPI</span><span class="sxs-lookup"><span data-stu-id="ff5bf-123">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)


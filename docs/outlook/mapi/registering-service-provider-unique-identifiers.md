---
title: Регистрация уникальных идентификаторов поставщиков служб
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 964fceb4-8a1c-46c1-98e1-a325c9259f8b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9f4acbb06f85a88a6c057da263ae95e09f72e0bb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410177"
---
# <a name="registering-service-provider-unique-identifiers"></a>Регистрация уникальных идентификаторов поставщиков служб

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Адресная книга, хранилище сообщений и поставщики транспорта используют уникальный идентификатор, который называется [мапиуид](mapiuid.md) для регистрации в объектах обслуживания различных типов. **Мапиуид** — это 16-байтовый идентификатор, который содержит GUID. Вы можете создать **мапиуид** с помощью следующей процедуры: 
  
1. Определите константу.
    
2. Запустите средство Visual Studio*CREATE GUID**. 
    
Например, у поставщика адресных книг может быть следующая константа в файле заголовка для определения объекта **мапиуид**:
  
 `#define AB_UID_PROVIDER { 0Xe3, 0x3c, 0x67, 0xa0, \ 0xc8, 0x1f, 0x11, 0xce, \ 0xb2, 0xe4, 0x0, 0xaa, \ 0x0, 0x51, 0xe, 0x3b }`
  
 **Регистрация МАПИУИД, если поставщик является адресной книгой или поставщиком хранилища сообщений**
  
1. Call [имаписуппорт:: сетпровидеруид](imapisupport-setprovideruid.md).
    
2. ЗаРегистрируйте **мапиуид** для каждого объекта входа, который вы создаете, и включите этот **мапиуид** в первые 16 байт элемента **AB** каждого идентификатора записи, который вы создаете. Для связи объектов с поставщиками службы MAPI использует структуры **мапиуид** . Когда клиент вызывает метод [IMAPISession:: OpenEntry](imapisession-openentry.md) для открытия объекта, MAPI проверяет часть идентификатора записи **мапиуид** , сопоставляя ее с зарегистрированным **мапиуид**, чтобы определить, какой объект входа должен получать Открытый Request.
    
3. Если ваш поставщик является транспортом, зарегистрируйте одну или несколько структур **мапиуид** , когда MAPI вызывает метод **Иксплогон:: аддресстипес** . MAPI использует структуры **мапиуид** , зарегистрированные поставщиками транспорта, для назначения ответственных за доставку сообщений. 
    
Хотя поставщики услуг обычно регистрируют один **мапиуид**, вы можете зарегистрировать несколько структур **мапиуид** . Если ваша адресная книга или поставщик хранилища сообщений поддерживает несколько объектов входа в систему, возможно, путем добавления нескольких экземпляров поставщика в свой профиль, может потребоваться реализация разных **мапиуид** для каждого объекта logon. Существует несколько других причин для поддержки более одного **мапиуид**:
  
- Необходимо поддерживать более одной версии поставщика, и идентификаторы записей должны представлять соответствующую версию. Назначьте разные **мапиуид** для каждой версии. 
    
- Необходимо различать типы поддерживаемых объектов. Например, поставщику адресной книги может понадобиться зарегистрировать один **мапиуид** для использования в идентификаторах записей для объектов-пользователей обмена сообщениями и другой **мапиуид** для использования в списках рассылки. 
    
При наличии нескольких одновременно активных объектов входа имеет смысл иметь уникальные структуры **мапиуид** для каждого из них. Это повышает точность, с которой MAPI сопоставляет идентификаторы записей с поставщиками услуг и сохраняет некоторую работу. Когда каждый объект logon имеет собственный уникальный идентификатор, MAPI может гарантировать, что любой запрос, переданный в объект logon, может обрабатываться этим объектом. Когда объекты входа совместно используют структуры **мапиуид** , MAPI направляет запрос в первый объект logon, идентифицированный параметром **мапиуид**. Если один из ваших объектов входа получает запрос, который не может быть обработан, так как он не обрабатывает идентификатор записи, перед возвращением ошибки перед возвращением запроса передается в следующий объект logon.
  
## <a name="see-also"></a>См. также



[Реализация входа у поставщика услуг](implementing-service-provider-logon.md)


---
title: Регистрация уникальных идентификаторов поставщиков служб
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 964fceb4-8a1c-46c1-98e1-a325c9259f8b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bde7ff73f58c8809d2dd6467daea28461e7c6ef7
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22586272"
---
# <a name="registering-service-provider-unique-identifiers"></a>Регистрация уникальных идентификаторов поставщиков служб

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Адресной книги, хранилища сообщений и поставщиками транспорта использование уникального идентификатора, называемого [MAPIUID](mapiuid.md) для регистрации в службе объекты различных типов. **MAPIUID** является идентификатором 16-битное, содержащая GUID. **MAPIUID** можно создать с помощью следующей процедуры: 
  
1. Определите константу.
    
2. Вызов Visual Studio*Создать GUID** средство. 
    
Например поставщика адресных книг может включать следующие константы в файл заголовка для определения **MAPIUID**:
  
 `#define AB_UID_PROVIDER { 0Xe3, 0x3c, 0x67, 0xa0, \ 0xc8, 0x1f, 0x11, 0xce, \ 0xb2, 0xe4, 0x0, 0xaa, \ 0x0, 0x51, 0xe, 0x3b }`
  
 **Чтобы зарегистрировать MAPIUID, если ваш поставщик является поставщик адресной книги или сообщения хранилища**
  
1. Вызов [IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md).
    
2. Регистрация **MAPIUID** для каждого входа создания экземпляра и включить в этом **MAPIUID** в первых 16 байтов **ab** членом каждый идентификатор записи, создаваемого объектов. MAPI использует **MAPIUID** структуры для связи с поставщиками услуг объекты. Если клиент вызывает метод [IMAPISession::OpenEntry](imapisession-openentry.md) , чтобы открыть объект MAPI проверяет **MAPIUID** часть идентификатор записи, сравнение с зарегистрированным **MAPIUID**, чтобы определить, какой объект входа в систему следует направить open запрос.
    
3. Если ваш поставщик транспорта, зарегистрируйте структуры один или несколько **MAPIUID** при MAPI вызывает метод **IXPLogon::AddressTypes** . MAPI использует **MAPIUID** структуры, зарегистрированные поставщиками транспорта для назначения ответственности для доставки сообщений. 
    
Хотя для поставщиков услуг обычно зарегистрировать одного **MAPIUID**, можно регистрировать несколько структур **MAPIUID** . Если адресной книги или сообщения хранить поставщик поддерживает несколько объектов входа в систему, возможно, позволяя пользователям добавлять несколько экземпляров поставщика для своего профиля, можно реализовать различные **MAPIUID** для каждого объекта входа в систему. Существует несколько других причин для поддержки нескольких **MAPIUID**:
  
- Должен поддерживать несколько версий поставщика и идентификаторы записей должен представлять соответствующую версию. Назначьте разные **MAPIUID** для каждой из версий. 
    
- Вы хотите различать типы объектов, которые вы поддерживаете. Например поставщика адресных книг может потребоваться регистрации одной **MAPIUID** для использования в идентификаторах запись обмена сообщениями объектов пользователей и различных **MAPIUID** для списков рассылки. 
    
При наличии нескольких объектов входа в систему, одновременно активны, имеет смысл иметь уникальные **MAPIUID** структуры для каждого из них. Это повышает точность, с которым MAPI сопоставляет идентификаторы записей для поставщиков услуг и сохраняет определенные операции. Когда каждый объект входа имеет свой собственный уникальный идентификатор, MAPI можно гарантирует, что любые запросить маршрутов объект входа могут быть обработаны этого объекта. После входа в систему объекты совместно используют **MAPIUID** структуры, MAPI направляет запрос первый объект входа в систему, который идентифицируется средством **MAPIUID**. Если один из объектов входа получает запрос, который он не может обработать, так как он не обрабатывает идентификатор записи, передайте запрос к следующему объекту входа в систему перед сообщение об ошибке.
  
## <a name="see-also"></a>См. также



[Реализация входа для поставщика службы](implementing-service-provider-logon.md)


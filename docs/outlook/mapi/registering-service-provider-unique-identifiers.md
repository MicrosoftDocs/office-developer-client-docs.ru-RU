---
title: Регистрация уникальных идентификаторов поставщика услуг
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 964fceb4-8a1c-46c1-98e1-a325c9259f8b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9f4acbb06f85a88a6c057da263ae95e09f72e0bb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410177"
---
# <a name="registering-service-provider-unique-identifiers"></a>Регистрация уникальных идентификаторов поставщика услуг

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщики адресной книги, магазина сообщений и транспорта используют уникальный идентификатор [MAPIUID](mapiuid.md) для регистрации объектов обслуживания различных типов. **MAPIUID** — это идентификатор 16-byte, содержащий GUID. Вы можете создать **MAPIUID с** помощью следующей процедуры: 
  
1. Определение константы.
    
2. Вызов средства Visual Studio *GUID** 
    
Например, поставщик адресных книг может включить следующую константу в файл заголовки для определения **MAPIUID:**
  
 `#define AB_UID_PROVIDER { 0Xe3, 0x3c, 0x67, 0xa0, \ 0xc8, 0x1f, 0x11, 0xce, \ 0xb2, 0xe4, 0x0, 0xaa, \ 0x0, 0x51, 0xe, 0x3b }`
  
 **Регистрация MAPIUID, если поставщик является поставщиком адресной книги или магазина сообщений**
  
1. Вызов [IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md).
    
2. Зарегистрируйте **MAPIUID** для каждого объекта с логотипом, который вы мгновенно создаете, и  включите этот **MAPIUID** в первые 16 bytes аб-участника каждого создаемого идентификатора записи. MapI использует **структуры MAPIUID** для связывать объекты с поставщиками услуг. Когда клиент вызывает метод [IMAPISession::OpenEntry](imapisession-openentry.md) для открытия объекта, MAPI проверяет часть **MAPIUID** идентификатора входа, соотнося ее с зарегистрированным **MAPIUID,** чтобы определить, какой объект с логотипом должен получать открытый запрос.
    
3. Если поставщик является транспортным средством, зарегистрируйте одну или несколько структур **MAPIUID** при вызове метода **MAPI IXPLogon::AddressTypes.** MAPI использует структуры **MAPIUID,** зарегистрированные поставщиками транспорта, для назначения ответственности за доставку сообщений. 
    
Хотя поставщики услуг обычно регистрируют один **MAPIUID,** можно зарегистрировать несколько **структур MAPIUID.** Если поставщик адресной книги или магазина сообщений поддерживает несколько объектов с логотипом, возможно, разрешив пользователю добавить несколько экземпляров поставщика в свой профиль, может потребоваться реализовать другой **MAPIUID** для каждого объекта с логотипом. Существует несколько других причин для поддержки нескольких **MAPIUID:**
  
- Необходимо поддерживать несколько версий поставщика, а идентификаторы записи должны представлять соответствующую версию. Назначение другого **MAPIUID для** каждой версии. 
    
- Необходимо различать типы поддерживаемых объектов. Например, поставщику адресных книг может потребоваться зарегистрировать один **MAPIUID** для использования в идентификаторах входа объектов пользователей обмена сообщениями, а другой **MAPIUID** для использования в списках рассылки. 
    
При одновременной активности нескольких объектов с логотипами имеет смысл иметь уникальные структуры **MAPIUID** для каждого из них. Это повышает точность, с которой MAPI соответствует идентификаторам входа поставщикам услуг и сохраняет некоторые работы. Если каждый объект с логотипом имеет свой уникальный идентификатор, MAPI может гарантировать, что любой запрос, который он передает в объект logon, может быть обработан этим объектом. Когда объекты с логотипом разделяют структуры **MAPIUID,** MAPI передает запрос первому объекту с логотипом, идентифицированным **MAPIUID.** Если один из объектов логона получает запрос, который он не может обрабатывать, так как не обрабатывает идентификатор входа, перед возвращением ошибки передайте запрос следующему объекту logon.
  
## <a name="see-also"></a>См. также



[Реализация logon поставщика услуг](implementing-service-provider-logon.md)


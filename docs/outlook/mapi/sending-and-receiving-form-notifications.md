---
title: Отправка и получение уведомлений формы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4374728-e2bc-47d9-8b03-ba09545a38d8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 4ee47b51a98cf732f4e9af2a87fa1734a7250208
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431857"
---
# <a name="sending-and-receiving-form-notifications"></a>Отправка и получение уведомлений формы

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Уведомления форм используются в MAPI для упрощения взаимодействия как из формы с вашим средством просмотра, так и с вашего средства просмотра с формой.
  
Формы отправляют уведомления вашему зрителю при одном из следующих событий:
  
- Форма закрыта.
    
- В форме загружается новое сообщение.
    
- Операция сохранения завершена.
    
- Отправляется сообщение.
    
Каждый из этих типов событий соответствует определенному методу [в IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md)— одному из интерфейсов, которые должно реализовать ваше представление форм. Когда происходит событие, форма вызывает соответствующий метод **IMAPIViewAdviseSink** в приемнике консультации вашего просматриваемого. Например, когда поступает новое сообщение, которое ваше представление должно включить в свое отображение, форма вызывает метод [IMAPIViewAdviseSink::OnNewMessage.](imapiviewadvisesink-onnewmessage.md) 
  
Реализуйте тонущий совет в представлении так, чтобы это было логично для вашего зрителя; стандартная реализация не существует. Например, в **OnNewMessage** можно обновить представление таблицы содержимого текущей папки, включив только что созданное сообщение. В [IMAPIViewAdviseSink::OnSubmitted](imapiviewadvisesink-onsubmitted.md)метод, который будет вызван при отправке события сообщения, можно скопировать отправленное сообщение в папку "Отправленные".
  
Формы получают уведомления от просматривающих, когда происходит изменение, которое влияет на форму, и при загрузке нового сообщения. Чтобы уведомить форму, вызовите один из методов **IMAPIFormAdviseSink**: [IMAPIFormAdviseSink::OnChange](imapiformadvisesink-onchange.md) или [IMAPIFormAdviseSink::OnActivateNext](imapiformadvisesink-onactivatenext.md). Вызовите **OnChange,** чтобы сообщить о состоянии. Например, если форма отображает последний элемент в папке при поступления нового сообщения, вызовите **OnChange** с флагом VCSTATUS_NEXT, чтобы сообщить форме, что теперь существует следующий элемент. 
  
Вызовите **OnActivateNext, чтобы** предупредить форму о поступлении нового сообщения, которое может отображаться или не отображаться. Передав класс сообщения в **OnActivateNext.** 
  
Уведомления объектом формы для клиентского приложения обрабатываются интерфейсом **IMAPIViewAdviseSink клиентского** приложения. Дополнительные сведения см. в [подразделе IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md).
  


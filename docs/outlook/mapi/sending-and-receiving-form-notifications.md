---
title: Отправка и получение уведомлений формы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4374728-e2bc-47d9-8b03-ba09545a38d8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 4ee47b51a98cf732f4e9af2a87fa1734a7250208
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431857"
---
# <a name="sending-and-receiving-form-notifications"></a>Отправка и получение уведомлений формы

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Уведомления формы используются в MAPI для упрощения взаимодействия между формой и средством просмотра, а также от средства просмотра в форме.
  
Формы отправляют уведомления средству просмотра при возникновении одного из следующих событий:
  
- Форма будет закрыта.
    
- В форме загружается новое сообщение.
    
- Операция сохранения завершена.
    
- Отправляется сообщение.
    
Каждый из этих типов событий соответствует определенному методу в [имапивиевадвисесинк: IUnknown](imapiviewadvisesinkiunknown.md), одному из интерфейсов, которые должны быть реализованы в средстве просмотра форм. При возникновении события форма вызывает соответствующий метод **имапивиевадвисесинк** в приемнике уведомлений средства просмотра. Например, когда новое сообщение поступает о том, что средство просмотра должно включать его отображение, форма вызывает метод [имапивиевадвисесинк:: онневмессаже](imapiviewadvisesink-onnewmessage.md) . 
  
Реализуйте приемник уведомлений о просмотре способом, который имеет смысл для средства просмотра; Стандартная реализация отсутствует. Например, в **онневмессаже** вы можете обновить представление таблицы содержимого текущей папки, чтобы включить вновь полученное сообщение. В [имапивиевадвисесинк::](imapiviewadvisesink-onsubmitted.md)OnSubmitted, метод, вызываемый при получении события отправленного сообщения, можно скопировать отправленное сообщение в папку "Отправленные".
  
Формы получают уведомление от средства просмотра при возникновении изменений, влияющих на форму, и при загрузке нового сообщения. Чтобы уведомить форму, вызовите один из методов объекта **имапиформадвисесинк**: [имапиформадвисесинк:: OnChange](imapiformadvisesink-onchange.md) или [имапиформадвисесинк:: онактиватенекст](imapiformadvisesink-onactivatenext.md). Вызовите метод **onChange** , чтобы сообщить о состоянии. Например, если в форме отображается последний элемент в папке при поступлении нового сообщения, вызовите метод **onChange** с установленным флагом VCSTATUS_NEXT, чтобы сообщить форме, что теперь используется следующий элемент. 
  
Вызов **онактиватенекст** для оповещения формы о поступлении нового сообщения о том, что оно может быть недоступно для отображения. Передайте класс сообщения в **онактиватенекст**. 
  
Уведомления от объекта формы к клиентскому приложению обрабатываются интерфейсом **имапивиевадвисесинк** клиентского приложения. Дополнительные сведения см. в статье [имапивиевадвисесинк: IUnknown](imapiviewadvisesinkiunknown.md).
  


---
title: Проверка и инициализация хранилища сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 74f0a1fe-2a79-4b32-ab88-85a8839a2639
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 77b3f707fc36a868de5acd7c7ba4642a1da4e3c9
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433691"
---
# <a name="validating-and-initializing-a-message-store"></a>Проверка и инициализация хранилища сообщений

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
При открытии хранилища сообщений с помощью метода [IMAPISession:: опенмсгсторе](imapisession-openmsgstore.md) без установки флага MDB_NO_MAIL MAPI создает несколько папок и назначает им имена по умолчанию и роли. Служба MAPI отвечает за создание этих папок, чтобы избежать несовместимости, которые неизбежно возникать, если клиенты или поставщики хранилища сообщений несут ответственность за создание. 
  
Иногда необходимо убедиться, что созданы соответствующие папки, и что они действительны. Для этой цели доступна функция [хрвалидатеипмсубтри](hrvalidateipmsubtree.md) . При проверке хранилища сообщений по умолчанию передайте флаг MAPI_FULL_IPM_TREE. Для хранилища сообщений по умолчанию создается более обширная группа папок. Когда **хрвалидатеипмсубтри** получает флаг MAPI_FULL_IPM_TREE, он проверяет наличие следующих папок: 
  
- Корневая папка для поддерева IPM
    
- Папка "Удаленные" в корневой папке IPM
    
- Папка "Входящие" в корневой папке IPM
    
- Папка "Исходящие" в корневой папке IPM
    
- Папка "Отправленные" в корневой папке IPM
    
- Представления папки в корневой папке хранилища сообщений
    
- Общие представления в корневой папке хранилища сообщений
    
- Папка поиска в корневой папке хранилища сообщений
    
Если хранилище сообщений не является значением по умолчанию, можно установить или не устанавливать флаг MAPI_FULL_IPM_TREE. Если этот флаг не задан, **хрвалидатеипмсубтри** проверяет только корневую папку для поддерева, папки "Удаленные" и корневой папки для результатов поиска хранилища сообщений. 
  
Чтобы инициализировать хранилище сообщений, сохраните следующие свойства в памяти, чтобы они были доступны для совместного доступа:
  
- **PR_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md))
    
- **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md))
    
Эти свойства представляют собой битовые маски, описывающие функции хранилища сообщений. В **PR_VALID_FOLDER_MASK** для каждой специальной папки, которая существует в хранилище сообщений, задан один бит, а также назначен допустимый идентификатор записи. Дополнительные сведения о доступе к этим папкам и их идентификаторам записей можно узнать [в разделе Открытие папки хранилища сообщений](opening-a-message-store-folder.md). 
  
 Для каждого компонента, поддерживаемого в банке сообщений, в **PR_STORE_SUPPORT_MASK** установлен один бит. Например, если хранилище сообщений поддерживает уведомление и форматированный текст, для его **PR_STORE_SUPPORT_MASK** будут заданы STORE_NOTIFY_OK и STORE_RTF_OK BITS. 
  
К другим свойствам, которые должны храниться локально, относятся идентификаторы для папок, которые в качестве свойства **PR_VALID_FOLDER_MASK** описывает допустимые. Каждый из этих специальных папок, за исключением папки "Входящие", имеет связанное с ним свойство идентификатора записи. Например, идентификатором записи для папки "Исходящие" является свойство **PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)). Так как эти папки представляют собой папки, которые будут открываться часто, рекомендуется иметь общедоступные идентификаторы записей.
  


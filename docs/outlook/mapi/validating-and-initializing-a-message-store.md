---
title: Проверка и инициализация хранилища сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 74f0a1fe-2a79-4b32-ab88-85a8839a2639
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 77b3f707fc36a868de5acd7c7ba4642a1da4e3c9
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329584"
---
# <a name="validating-and-initializing-a-message-store"></a>Проверка и инициализация хранилища сообщений

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Когда вы открываете хранилище сообщений с помощью метода [IMAPISession:: опенмсгсторе](imapisession-openmsgstore.md) без установки флага МДБ_НО_МАИЛ, MAPI создает несколько папок и назначает им имена по умолчанию и роли. Служба MAPI отвечает за создание этих папок, чтобы избежать несовместимости, которые неизбежно возникать, если клиенты или поставщики хранилища сообщений несут ответственность за создание. 
  
Иногда необходимо убедиться, что созданы соответствующие папки, и что они действительны. Для этой цели доступна функция [хрвалидатеипмсубтри](hrvalidateipmsubtree.md) . При проверке хранилища сообщений по умолчанию передайте флаг МАПИ_ФУЛЛ_ИПМ_ТРИ. Для хранилища сообщений по умолчанию создается более обширная группа папок. Когда **хрвалидатеипмсубтри** получает флаг мапи_фулл_ипм_три, он проверяет наличие следующих папок: 
  
- Корневая папка для поддерева IPM
    
- Папка "Удаленные" в корневой папке IPM
    
- Папка "Входящие" в корневой папке IPM
    
- Папка "исХодящие" в корневой папке IPM
    
- Папка "Отправленные" в корневой папке IPM
    
- Представления папки в корневой папке хранилища сообщений
    
- Общие представления в корневой папке хранилища сообщений
    
- Папка поиска в корневой папке хранилища сообщений
    
Если хранилище сообщений не является значением по умолчанию, можно задать или не устанавливать флаг МАПИ_ФУЛЛ_ИПМ_ТРИ. Если этот флаг не задан, **хрвалидатеипмсубтри** проверяет только корневую папку для поддерева, папки "Удаленные" и корневой папки для результатов поиска хранилища сообщений. 
  
Чтобы инициализировать хранилище сообщений, сохраните следующие свойства в памяти, чтобы они были доступны для совместного доступа:
  
- **Пр_валид_фолдер_маск** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md))
    
- **Пр_сторе_суппорт_маск** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md))
    
Эти свойства представляют собой битовые маски, описывающие функции хранилища сообщений. **Пр_валид_фолдер_маск** имеет один бит для каждой специальной папки, которая существует в хранилище сообщений и имеет допустимый идентификатор записи. Дополнительные сведения о доступе к этим папкам и их идентификаторам записей можно узнать [в разделе Открытие папки хранилища сообщений](opening-a-message-store-folder.md). 
  
 Для каждого компонента, поддерживаемого в банке сообщений, в **пр_сторе_суппорт_маск** установлен один бит. Например, если хранилище сообщений поддерживает уведомление и форматированный текст, для его **пр_сторе_суппорт_маск** будут заданы биты СТОРЕ_НОТИФИ_ОК и сторе_ртф_ок. 
  
К другим свойствам, которые должны храниться локально, относятся идентификаторы для папок, которые свойство **пр_валид_фолдер_маск** описывает как допустимое. Каждый из этих специальных папок, за исключением папки "Входящие", имеет связанное с ним свойство идентификатора записи. Например, идентификатором записи для папки "исХодящие" является свойство **пр_ипм_аутбокс_ентрид** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)). Так как эти папки представляют собой папки, которые будут открываться часто, рекомендуется иметь общедоступные идентификаторы записей.
  


---
title: IMAPIFolderCreateMessage
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CreateMessage
api_type:
- COM
ms.assetid: e0222afa-c148-4735-a603-cac7be6c91f9
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4d38648f5e3084c8342fca8d18f0bd3efc915155
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412634"
---
# <a name="imapifoldercreatemessage"></a>IMAPIFolder::CreateMessage

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает новое сообщение.
  
```cpp
HRESULT CreateMessage(
  LPCIID lpInterface,
  ULONG ulFlags,
  LPMESSAGE FAR * lppMessage
);
```

## <a name="parameters"></a>Параметры

 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса ( IID), который представляет интерфейс, который будет использоваться для доступа к новому сообщению. Допустимые идентификаторы интерфейса: IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer и IID_IMAPIFolder. Передача NULL приводит к возврату поставщиком магазина сообщений стандартного интерфейса [сообщения IMessage : IMAPIProp.](imessageimapiprop.md) 
    
 _ulFlags_
  
> [in] Битоваяmas флагов, которая управляет процессом создания сообщения. Можно установить следующие флаги:
    
ITEMPROC_FORCE
  
> Указывает хранилище личных папок (PST), что сообщение имеет право на обработку правил, прежде чем магазин извещение любого клиента прослушивания о поступлении нового сообщения. Обработка правил применяется только к новым сообщениям, созданным на сервере, который не является Microsoft Exchange Server, так как Exchange Server обрабатывает правила для сообщений на сервере. Таким образом, поставщик или клиент, создав сообщение, должны передать этот флаг в сочетании с сохранением сообщения с помощью [IMAPIPProp::SaveChanges](imapiprop-savechanges.md) с помощью NON_EMS_XP_SAVE, что означает, что сервер не является Exchange Server. 
    
MAPI_ASSOCIATED 
  
> Сообщение, которое необходимо создать, должно быть включено в связанную таблицу содержимого, а не в стандартную таблицу содержимого. Связанные сообщения скрыты от взаимодействия с пользователем.
    
MAPI_DEFERRED_ERRORS 
  
> **CreateMessage** может быть выполнен успешно, даже если операция создания еще не завершена полностью. Это означает, что новое сообщение может быть не сразу доступно вызываемой. 
    
 _lppMessage_
  
> [out] Указатель на указатель на созданное сообщение.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщение успешно создано.
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder::CreateMessage** создает новое сообщение с универсальным или связанным содержимым и назначает идентификатор записи. Идентификатор записи состоит из части, которая представляет поставщика хранения сообщений, и части, которая представляет отдельное сообщение. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Можно выбрать, следует ли устанавливать все необходимые свойства сообщения в **CreateMessage** или в методе [IMAPIProp::SaveChanges](imapiprop-savechanges.md) сообщения. Эти свойства можно сделать доступными только после успешного сохранения. 
  
Дополнительные сведения о работе со связанными сведениями см. в таблицах и таблицах содержимого, связанных с [папками.](contents-tables.md) [](folder-associated-information-tables.md) 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Некоторые поставщики store сообщений позволяют получить идентификатор записи нового сообщения сразу после возврата **CreateMessage;** другие поставщики store сообщений задерживают ее доступность, пока сообщение не будет сохранено. Так как не все поставщики store сообщений создают идентификатор записи для нового сообщения, пока вы не вызываете метод **IMAPIProp::SaveChanges** сообщения, вы можете не получить доступ к идентификатору записи при возвращении **CreateMessage.** Кроме того, новое сообщение может не быть включено в таблицу содержимого папки, пока не произойдет сохранение. 
  
Ожидается, что идентификатор записи, присвоенный новому сообщению, будет уникальным не только в текущем хранилище сообщений, но и, скорее всего, во всех хранилищах сообщений, которые открываются одновременно. Одно исключение из этого правила возникает, когда в профиле появляется несколько записей для хранения сообщений. В результате хранилище сообщений открывается несколько раз, а идентификаторы записей дублируются. 
  
Чтобы создать исходящие сообщения, вызовите метод **IMAPIFolder::CreateMessage** папки "Исходящие". 
  
При удалении папки с новым сообщением перед его с сохранением результаты будут неопределенными.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|FolderDlg.cpp  <br/> |CFolder::OnNewMessage  <br/> |MFCMAPI использует метод **IMAPIFolder::CreateMessage** для создания и сохранения нового сообщения.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


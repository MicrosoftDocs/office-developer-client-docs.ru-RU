---
title: IMAPIFolderCreateMessage
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CreateMessage
api_type:
- COM
ms.assetid: e0222afa-c148-4735-a603-cac7be6c91f9
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e740e86fc25307457119aabf6e2aa0c42a9d69b9
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22568226"
---
# <a name="imapifoldercreatemessage"></a>IMAPIFolder::CreateMessage

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Создает новое сообщение.
  
```cpp
HRESULT CreateMessage(
  LPCIID lpInterface,
  ULONG ulFlags,
  LPMESSAGE FAR * lppMessage
);
```

## <a name="parameters"></a>Параметры

 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса (ИД интерфейса), который представляет интерфейс, который будет использоваться для доступа к нового сообщения. Идентификаторы допустимого интерфейса включают IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer и IID_IMAPIFolder. Значение NULL вызывает поставщика хранилища сообщений для возврата интерфейс стандартные сообщения [IMessage: IMAPIProp](imessageimapiprop.md). 
    
 _ulFlags_
  
> [in] Битовая маска флаги, который определяет, каким образом создается сообщение. Можно задать следующие флажки:
    
ITEMPROC_FORCE
  
> Указывает, чтобы в хранилище личных папок (PST), что сообщение подходит для правила обработки перед хранилище уведомляет любого прослушивания клиента о получении нового сообщения. Правила обработки только применяется для новых сообщений, созданных на сервере, который не является Microsoft Exchange Server, так как Exchange Server обрабатывает правила для сообщений на сервере. Таким образом поставщика или клиента при создании сообщения должен пройти этот флаг в сочетании с сохранением сообщение с [IMAPIPProp::SaveChanges](imapiprop-savechanges.md) с помощью NON_EMS_XP_SAVE, это означает, что сервер не является сервером Exchange. 
    
MAPI_ASSOCIATED 
  
> Сообщение будет создан должно быть включено в связанное содержимое таблицы, а не в таблице стандартных содержимое. Связанные сообщения скрыты от взаимодействия с пользователем.
    
MAPI_DEFERRED_ERRORS 
  
> **CreateMessage** может даже в том случае, если операция создания выполнена не полностью. Это означает, что новое сообщение не может быть сразу становятся доступными для вызывающего абонента. 
    
 _lppMessage_
  
> [out] Указатель на указатель на только что созданный сообщения.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Сообщение было успешно создано.
    
## <a name="remarks"></a>Замечания

Метод **IMAPIFolder::CreateMessage** создает новое сообщение с универсальный или связанный контент и назначает идентификатор записи. Идентификатор записи состоит из части, который представляет поставщика хранилища сообщений и, представляющий отдельных сообщений. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Можно ли задать все свойства необходимые сообщения в **CreateMessage** или в метод [IMAPIProp::SaveChanges](imapiprop-savechanges.md) сообщений. Необходимо внести эти свойства доступны только после успешного сохранения произошла. 
  
Дополнительные сведения о работе с связанные сведения см [сведения о Folder-Associated](folder-associated-information-tables.md) и [Содержимое таблицы](contents-tables.md). 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Некоторые поставщики хранилища сообщений разрешить запись идентификатор нового сообщения будут доступны сразу же после возвращает **CreateMessage** ; прочие службы хранилища сообщений отложить его доступность до сохранения сообщения. Так как не все поставщики хранилища сообщений создающего запись идентификатор нового сообщения до вызова метода **IMAPIProp::SaveChanges** сообщение, не удается получить доступ к идентификатор записи при возврате **CreateMessage** . Кроме того новое сообщение могут отсутствовать в таблице содержимое папки до сохранения. 
  
Ожидается, что запись идентификатор, назначенный новое сообщение быть уникальными не только в хранилище текущего сообщения, но скорее всего, во всех хранилищ сообщений, которые открыты в то же время. Одно исключение из этого правила происходит, когда несколько записей для хранения сообщений отображаются в профиле. После этого хранилища сообщений для открытия несколько раз и идентификаторы записей дублирование. 
  
Чтобы создать исходящих сообщений, вызовите метод **IMAPIFolder::CreateMessage** папке Исходящие. 
  
Если удалить папку, содержащую нового сообщения перед сохранением сообщения, результаты не определены.
  
## <a name="mfcmapi-reference"></a>Справочник по mfcmapi (en)

������ ���� mfcmapi (en) ���������� � ������� ����.
  
|**����**|**�������**|**�����������**|
|:-----|:-----|:-----|
|FolderDlg.cpp  <br/> |CFolder::OnNewMessage  <br/> |Mfcmapi (en) использует метод **IMAPIFolder::CreateMessage** для создания и сохранения нового сообщения.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


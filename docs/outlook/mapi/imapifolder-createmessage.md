---
title: имапифолдеркреатемессаже
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CreateMessage
api_type:
- COM
ms.assetid: e0222afa-c148-4735-a603-cac7be6c91f9
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4d38648f5e3084c8342fca8d18f0bd3efc915155
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412634"
---
# <a name="imapifoldercreatemessage"></a>IMAPIFolder::CreateMessage

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает новое сообщение.
  
```cpp
HRESULT CreateMessage(
  LPCIID lpInterface,
  ULONG ulFlags,
  LPMESSAGE FAR * lppMessage
);
```

## <a name="parameters"></a>Параметры

 _лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к новому сообщению. Допустимые идентификаторы интерфейса: IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer и IID_IMAPIFolder. При передаче значения NULL поставщик хранилища сообщений возвращает стандартный интерфейс сообщений [iMessage: IMAPIProp](imessageimapiprop.md). 
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих способ создания сообщения. Можно задать следующие флаги:
    
ITEMPROC_FORCE
  
> Указывает на хранение личных папок (PST), которое может быть доступно для обработки правил, прежде чем хранилище уведомит любой клиент, который ожидает поступление нового сообщения. Обработка правил применяется только к новым сообщениям, созданным на сервере, который не является сервером Microsoft Exchange, так как Exchange Server обрабатывает правила для сообщений на сервере. Поэтому поставщик или клиент, создающий сообщение, должен передать этот флаг в сочетании с сохранением сообщения с [имапиппроп:: SaveChanges](imapiprop-savechanges.md) с использованием NON_EMS_XP_SAVE, что означает, что сервер не является сервером Exchange. 
    
MAPI_ASSOCIATED 
  
> Создаваемое сообщение должно быть включено в связанную таблицу содержимого, а не в стандартную таблицу содержимого. Связанные сообщения скрыты от взаимодействия с пользователем.
    
MAPI_DEFERRED_ERRORS 
  
> **CreateMessage** может выполняться, даже если операция создания не полностью завершена. Это означает, что новое сообщение может быть недоступно сразу для вызывающего абонента. 
    
 _лппмессаже_
  
> вышли Указатель на указатель на вновь созданное сообщение.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщение успешно создано.
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder:: CreateMessage** создает новое сообщение с универсальным или связанным контентом и назначает идентификатор записи. Идентификатор записи состоит из части, представляющей поставщика хранилища сообщений, и части, представляющей отдельное сообщение. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Вы можете выбрать, следует ли задать все требуемые свойства сообщения в **CreateMessage** или в методе [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) сообщения. Необязательно делать эти свойства доступными, пока не будет выполнено успешное сохранение. 
  
Дополнительные сведения о работе со связанными сведениями можно найти в статье таблицы и [оглавления](contents-tables.md), [связанные с папками](folder-associated-information-tables.md) . 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Некоторые поставщики хранилищ сообщений позволяют идентификатору записи нового сообщения быть доступны сразу после возврата **CreateMessage** ; доступность других поставщиков хранилищ сообщений задерживает его доступность, пока сообщение не будет сохранено. Так как не все поставщики хранилищ сообщений создают идентификатор записи для нового сообщения, пока не будет вызван метод **IMAPIProp:: SaveChanges** , может оказаться невозможным получить доступ к идентификатору записи, когда **CreateMessage** возвращает значение. Кроме того, новое сообщение может быть не включено в таблицу содержимого папки до тех пор, пока не будет сохранен. 
  
Предполагается, что идентификатор записи, присвоенный новому сообщению, уникален не только в текущем хранилище сообщений, но скорее всего, для всех хранилищ сообщений, которые открыты одновременно. Одно исключение из этого правила возникает, когда в профиле отображается несколько записей для хранилища сообщений. Это приводит к тому, что хранилище сообщений открывается несколько раз, а идентификаторы записей дублируются. 
  
Чтобы создать исходящее сообщение, вызовите метод **IMAPIFolder:: CreateMessage** папки "Исходящие". 
  
Если вы удаляете папку, содержащую новое сообщение, перед сохранением сообщения, результаты не задаются.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Фолдердлг. cpp  <br/> |Кфолдер:: Онневмессаже  <br/> |MFCMAPI использует метод **IMAPIFolder:: CreateMessage** для создания и сохранения нового сообщения.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: IMAPIFolderCreateMessage
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CreateMessage
api_type:
- COM
ms.assetid: e0222afa-c148-4735-a603-cac7be6c91f9
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4d38648f5e3084c8342fca8d18f0bd3efc915155
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412634"
---
# <a name="imapifoldercreatemessage"></a>IMAPIFolder::CreateMessage

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Создает новое сообщение.
  
```cpp
HRESULT CreateMessage(
  LPCIID lpInterface,
  ULONG ulFlags,
  LPMESSAGE FAR * lppMessage
);
```

## <a name="parameters"></a>Parameters

 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса (IID), который представляет интерфейс, который будет использоваться для доступа к новому сообщению. Допустимые идентификаторы интерфейса включают IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer и IID_IMAPIFolder. Передача NULL заставляет поставщика хранения сообщений возвращать стандартный интерфейс [сообщения IMessage : IMAPIProp](imessageimapiprop.md). 
    
 _ulFlags_
  
> [in] Битмаски флагов, которые контролируют, как создается сообщение. Можно установить следующие флаги:
    
ITEMPROC_FORCE
  
> Указывает в личный магазин папок (PST) о том, что сообщение имеет право на обработку правил до того, как магазин извещение любого подслушавшего клиента о прибытии нового сообщения. Обработка правил применяется только к новым сообщениям, созданным на сервере, который не является Microsoft Exchange Server, так как Exchange Server обрабатывает правила для сообщений на сервере. Поэтому поставщик или клиент, создавав сообщение, должен передать этот флаг в сочетании с сохранением сообщения с [помощью IMAPIPProp::SaveChanges](imapiprop-savechanges.md) с помощью NON_EMS_XP_SAVE, что указывает на то, что сервер не является Exchange Server. 
    
MAPI_ASSOCIATED 
  
> Созданное сообщение должно быть включено в связанную таблицу содержимого, а не в стандартную таблицу содержимого. Связанные сообщения скрыты от взаимодействия с пользователем.
    
MAPI_DEFERRED_ERRORS 
  
> **CreateMessage** можно добиться успеха, даже если операция создания не выполнена полностью. Это означает, что новое сообщение может быть не сразу доступно вызываемой. 
    
 _lppMessage_
  
> [вышел] Указатель на указатель на вновь созданное сообщение.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщение было успешно создано.
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder::CreateMessage** создает новое сообщение с общим или связанным содержимым и назначает идентификатор записи. Идентификатор записи состоит из части, которая представляет поставщика магазина сообщений, и части, которая представляет отдельное сообщение. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Вы можете выбрать, следует ли устанавливать все необходимые свойства сообщений в **CreateMessage** или в [методе IMAPIProp::SaveChanges.](imapiprop-savechanges.md) Не нужно делать эти свойства доступными до тех пор, пока не произошел успешный сохранения. 
  
Дополнительные сведения о работе с связанной информацией см. в таблицах и таблицах содержимого, связанных с [папками.](contents-tables.md) [](folder-associated-information-tables.md) 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Некоторые поставщики магазинов сообщений позволяют сразу после возвращения **CreateMessage** получить идентификатор записи нового сообщения; другие поставщики хранения сообщений задерживают его доступность до сберегания сообщения. Так как не все поставщики хранения сообщений создают идентификатор входа для нового сообщения, пока вы не вызвали метод **IMAPIProp::SaveChanges,** вы можете не получить доступ к идентификатору записи при возвращении **CreateMessage.** Кроме того, новое сообщение не может быть включено в таблицу содержимого папки до тех пор, пока не произойдет сохранение. 
  
Ожидайте, что идентификатор записи, присвоенный новому сообщению, будет уникальным не только в текущем хранилище сообщений, но и, скорее всего, во всех открытых одновременно хранилищах сообщений. Исключение из этого правила возникает, когда в профиле отображаются несколько записей для магазина сообщений. В результате хранилище сообщений открывается несколько раз, а идентификаторы записей дублируются. 
  
Чтобы создать исходящие сообщения, вызовите метод **IMAPIFolder::CreateMessage** папки исходящие папки. 
  
Если вы удалите папку, содержаную новое сообщение перед тем, как сообщение будет сохранено, результаты будут неопределенными.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|FolderDlg.cpp  <br/> |CFolder::OnNewMessage  <br/> |MFCMAPI использует **метод IMAPIFolder::CreateMessage** для создания и сохранения нового сообщения.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


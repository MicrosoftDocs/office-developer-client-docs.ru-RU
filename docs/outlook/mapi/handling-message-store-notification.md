---
title: Обработка уведомлений хранилища сообщений
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 898f8b6ff3d0b0dd42a670596b54171f18b4a5e3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808564"
---
# <a name="handling-message-store-notification"></a>Обработка уведомлений хранилища сообщений
  
**Относится к**: Outlook 
  
Для регистрации уведомлений хранилища сообщений, вызовите метод либо [IMAPISession::Advise](imapisession-advise.md) , либо [IMsgStore::Advise](imsgstore-advise.md) и укажите хранилище сообщений, папки или идентификатор записи сообщения в содержимое параметра _lpEntryID_ . Поставщики хранилища сообщений поддерживает объект и таблицы уведомлений. Регистрация объектов хранилища конкретное сообщение, которые описывают эти объекты таблиц иерархии и содержимое папок или оба объекта и таблиц, зависит от уведомлений, согласно прогнозу, будут видеть, звонки, сделать для выполнения операций, и способ поставщик хранения сообщений поддерживает уведомления. 
  
MAPI обеспечивает гибкость в поддержке уведомления поставщиков, обратите внимание, что вы не всегда получают одного типа уведомлений в ответ на определенном событии из всех поставщиков хранилища сообщений. Некоторые поставщики хранилища сообщений не поддерживают уведомления вообще. Чтобы определить, поддерживает ли хранилище сообщений, которые вы используете уведомлений внешнего вида для STORE_NOTIFY_OK бит в своем свойстве **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)).
  
На одном конце спектра хранилища сообщений поставщики, которые поддерживают уведомлений, поставщики, которые создают «расширенный» уведомления; Эти поставщики отправлять описания уведомления для всех зарегистрированных уведомить источников. С другой стороны, сообщение поставщиков хранилища, которые поддерживают уведомления; Эти поставщики отправлять общие уведомления для ограниченного числа источников уведомлений. 
  
Например если скопировать сообщение в папку с помощью которой вы зарегистрированы в качестве получателей копируются как объект и объект перемещен уведомлений, может или не получают уведомления объекта, скопированного. Ли вы получаете зависит от:
  
- Метод, который вызывается для выполнения копирования. Это может быть [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md)или [IMAPIProp::CopyProps](imapiprop-copyprops.md).
    
- Как сообщения хранилища реализует поставщик способа копирования.
    
- Ли поставщик хранения сообщений поддерживает уведомления объекта, скопированного в папках.
    
Из-за что поставщиков хранилищ не строгие рекомендации, которые описывают способы реализации уведомления для сообщений, клиенты не могут привести согласованность работы. MAPI рекомендует для хранения как сообщение уведомления о событиях реализация поставщиков и в следующей таблице приведено ниже рекомендациям. Чтение таблицы следующим образом: после выполнения операции в первый столбец, согласно прогнозу, будут получать уведомления о списке во втором столбце, если вы зарегистрированы для этого типа с помощью объекта, указанный в столбце третий тип. Например после создания папки, вы получите уведомление о _fnevObjectCreated_ только в том случае, если вы зарегистрировали _fnevObjectCreated_ уведомлений с хранилища сообщений. 
  
|**Операция**|**Тип события**|**Уведомить источник**|
|:-----|:-----|:-----|
|Создайте папку  <br/> | _fnevObjectCreated_ <br/> |Хранение сообщений  <br/> |
|Удаление папки  <br/> | _fnevObjectDeleted_ <br/> |Хранение сообщений удаленные папки  <br/> |
|Перемещение папки из одной папки в другую  <br/> | _fnevObjectMoved_ <br/> |Сообщение хранения папки перемещено  <br/> |
|Скопируйте папки из одной папки в другую  <br/> | _fnevObjectCopied_ <br/> |Сообщение хранения и копирования папки ( _fnevObjectCreated_ уведомление не отправлено для новой копии папки)  <br/> |
|Изменения в свойстве вычисляемого папки (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)) **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))  <br/> | _fnevObjectModified_ <br/> |Сообщение хранения Changed папки (без уведомления для родительской папки)  <br/> |
|Создание сообщения.  <br/> | _fnevObjectCreated_ <br/> |Хранение сообщений  <br/> |
|Удалить сообщение, вызывающие изменения в родительском свойство **PR_CONTENT_COUNT** папки  <br/> | _fnevObjectDeleted_ <br/> |Хранение сообщений удаленные сообщения  <br/> |
|Переместить сообщение из одной папки  <br/> | _fnevObjectMoved_ <br/> |Сообщение перемещено хранения сообщений  <br/> |
|Копирование сообщения из одной папки в другую  <br/> | _fnevObjectCopied_ <br/> |Хранение сообщений сообщение скопировано (не _fnevObjectCreated_ уведомления о новой копии сообщения)  <br/> |
|Сохраните сообщение, вызывающие изменения в родительском свойство **PR_CONTENT_COUNT** папки  <br/> | _fnevObjectCreated_ <br/> |Хранение сообщений при первой только сохранение  <br/> |
|Сохраните сообщение  <br/> | _fnevObjectModified_ <br/> |Хранение сообщений на сохранение после первого сохранить Changed сообщения (без уведомления для родительской папки)  <br/> |
|Выполните операцию поиска  <br/> | _fnevSearchComplete_ <br/> |Сообщение хранить папки поиска  <br/> |
|Новое сообщение  <br/> | _fnevNewMail_ <br/> |Хранение сообщений  <br/> |
   
> [!NOTE]
> При получении уведомления изменения объекта не забывайте, что свойство tag массива часть структуры [OBJECT_NOTIFICATION](object_notification.md) , указывает параметр _lpNotifications_ в вызове **OnNotify** может или не может быть NULL. Поставщики хранения сообщения не требуется вставить сведения о свойствах этого массива и наиболее не. Убедитесь в том, что метод **OnNotify** может обрабатывать случая, где указатель _lpPropTagArray_ имеет значение NULL. 
  
Для большинства Если не все объекта уведомления, обновите представление папки и папки.
  


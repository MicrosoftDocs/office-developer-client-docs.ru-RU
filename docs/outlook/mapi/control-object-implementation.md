---
title: Реализация объекта Control
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4ad62ff0-c527-4e75-a2af-b5906a7588e8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8304021565638f8a5893d0be8cd6a94ed62a8d95
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422609"
---
# <a name="control-object-implementation"></a>Реализация объекта Control

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Объекты управления или объекты, которые поддерживают интерфейс [имапиконтрол: IUnknown](imapicontroliunknown.md) , реализуются поставщиками для добавления функциональных возможностей кнопки, которая отображается в диалоговом окне MAPI. Объекты Control могут быть реализованы только для кнопок. 
  
 В **имапиконтрол** есть три метода: [GetLastError](imapicontrol-getlasterror.md), и [Activate](imapicontrol-activate.md). [](imapicontrol-getstate.md) 
  
MAPI вызывает метод/ **State** , чтобы определить, следует ли отключить кнопку. Метод- **State** вызывается в следующих ситуациях: 
  
- При первом отображении диалогового окна, в котором отображается кнопка.
    
- Когда для кнопки выдается уведомление о таблице. 
    
ПриСвойте параметру _Лпулстате_ значение мапи_дисаблед, если пользователь не может взаимодействовать с кнопкой и мапи_енаблед, если пользователь может взаимодействовать. 
  
Когда пользователь нажимает кнопку, активируется вызов **** MAPI. **Активировать** выполняет задачу, связанную с кнопкой. Эта задача может быть любой, что подходит для вашего поставщика, например отображение диалогового окна или обновление свойства. Если задача завершается неудачно, так как пользователь отменил ее, возвращается МАПИ_Е_УСЕР_КАНЦЕЛ. Для других причин сбоя возвращает соответствующее значение ошибки. 
  
Если задача выполнена успешно и связана с изменением свойства, которое отражается в другом элементе управления в диалоговом окне, вызовите метод [итабледата:: хрнотифи](itabledata-hrnotify.md). **Хрнотифи** вызывается для выпуска уведомления таблицы отображения с помощью свойства **пр_контрол_ид** ([PidTagControlId](pidtagcontrolid-canonical-property.md)) свойства Changed в структуре [табле_нотификатион](table_notification.md) . Не помещайте новое значение свойства в структуру; Вместо этого возвращается этот метод, когда вызывается метод [IMAPIProp::](imapiprop-getprops.md) -PROPS. Хотя обычно уведомления в таблице отображения нельзя использовать для отключения или включения элемента управления, его можно использовать с кнопкой. MAPI обновит измененный элемент управления, чтобы он отвечал на уведомление. 
  
MAPI вызывает метод **GetLastError** элемента управления, если функция **Activate** возвращает ошибку, отличную от мапи_е_усер_канцел. Если **GetLastError** размещает расширенные сведения об ошибке в структуре [мапиеррор](mapierror.md) , возвращаемой в содержимом параметра _лппмапиеррор_ , MAPI отображает его для пользователя. 
  
## <a name="see-also"></a>См. также



[Поставщики службы MAPI](mapi-service-providers.md)


---
title: Загрузка сообщения в форму
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4bdbe021-d694-4967-a105-4b24f1eebc44
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: afecd3b334dd2cf7b2953916872982e6459a8434
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412417"
---
# <a name="loading-a-message-into-a-form"></a>Загрузка сообщения в форму

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Чтобы загрузить существующее сообщение в форму с помощью сервера форм, используйте одну из следующих стратегий.
  
- Call [IMAPISession::P репареформ](imapisession-prepareform.md) для создания маркера, а затем [IMAPISession:: шовформ](imapisession-showform.md) для отображения формы. 
    
- Call [имапиформмгр:: лоадформ](imapiformmgr-loadform.md). 
    
Использование стратегии **препареформ** и **шовформ** сравнительно упрощается, но это приводит к отображению форм, которые являются модальными по отношению к вашему клиенту. Это вызвано тем, что вызов **шовформ** не возвращается, пока форма не будет закрыта. Если вам требуется асинхронная обработка форм, не используйте эту стратегию. 
  
Использование стратегии **лоадформ** усложняется, так как метод требует несколько параметров. Эти параметры указывают диспетчеру форм на необходимость запуска соответствующего сервера форм в правильном контексте и отображения соответствующего сообщения. Если сервер форм уже запущен, Диспетчер форм загружает сообщение на сервер форм без запуска нового экземпляра сервера форм. 
  
Чтобы указать, какой сервер формы необходимо запустить, передайте класс сообщения, обрабатываемый целевым сервером, в содержимое параметра _лпсзмессажекласс_ . Соответствующий класс сообщения можно определить, получив свойство **пр_мессаже_класс** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) сообщения, которое необходимо загрузить. Иногда для указанного класса сообщений отсутствует сервер форм, а только сервер форм, который обрабатывает сообщения, принадлежащие суперклассу этого сообщения. Если вы хотите, чтобы сообщение загружалось только сервером форм, специально предназначенным для обработки сообщений этого класса, установите флаг МАПИФОРМ_ЕКСАКТМАТЧ в вызове **лоадформ** . Дополнительные сведения см. [](mapi-message-classes.md)
  
 **Лоадформ** также требует указатель на сайт сообщений и контекст представления средства просмотра и значение **пр_мсг_статус** целевого сообщения ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md)) и **пр_мессаже_флагс** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)). параметры.
  


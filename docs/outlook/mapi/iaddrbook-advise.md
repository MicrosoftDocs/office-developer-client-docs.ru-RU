---
title: иаддрбукадвисе
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IAddrBook.Advise
api_type:
- COM
ms.assetid: 2def89ed-e4ce-446a-8b80-132d11ae8f8b
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 7abafafd3d4bd9618d85a7dac34e4556545167bb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406278"
---
# <a name="iaddrbookadvise"></a>IAddrBook::Advise

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Регистрирует клиента или поставщика услуг для получения уведомлений об изменениях в одной или нескольких записях в адресной книге.
  
```cpp
HRESULT Advise(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulEventMask,
  LPMAPIADVISESINK lpAdviseSink,
  ULONG_PTR lpulConnection
);
```

## <a name="parameters"></a>Параметры

 _кбентрид_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _лпентрид_
  
> возврата Указатель на идентификатор записи контейнера адресной книги, пользователя обмена сообщениями или списка рассылки, который будет создавать уведомление при изменении типа или типов, описанных в параметре _улевентмаск_ . 
    
 _улевентмаск_
  
> возврата Одно или несколько событий уведомления, регистрируемых абонентом для получения. Каждое событие связано с определенной структурой уведомлений, которая содержит сведения о произошедших изменениях. В следующей таблице приведены допустимые значения для _улевентмаск_ и соответствующие им структуры. 
    
|**Событие уведомления**|**Соответствующая структура**|
|:-----|:-----|
|**фневкритикалеррор** <br/> |[ERROR_NOTIFICATION](error_notification.md) <br/> |
|**фневобжекткреатед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**фневобжектделетед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**фневобжектмодифиед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**фневобжекткопиед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**фневобжектмовед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**фневтаблемодифиед** <br/> |[TABLE_NOTIFICATION](table_notification.md) <br/> |
   
 _лпадвисесинк_
  
> возврата Указатель на объект приемника уведомлений, вызываемый при возникновении события, для которого было запрошено уведомление.
    
 _лпулконнектион_
  
> вышли Указатель на ненулевый номер подключения, представляющий регистрацию уведомления.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Успешная регистрация уведомления.
    
MAPI_E_INVALID_ENTRYID 
  
> Поставщик адресной книги, отвечающий за идентификатор записи, переданный в _лпентрид_ , не смог зарегистрировать уведомление для соответствующей записи. 
    
MAPI_E_NO_SUPPORT 
  
> Уведомление не поддерживается поставщиком адресных книг, который отвечает за объект, указанный с помощью идентификатора записи, переданного в параметре _лпентрид_ . 
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Идентификатор записи, переданный в _лпентрид_ , не может быть обработан ни одним из поставщиков адресных книг в профиле. 
    
## <a name="remarks"></a>Примечания

Клиенты и поставщики услуг вызывают метод **advise** для регистрации определенного типа или типов уведомлений в записи адресной книги. Типы уведомлений обозначаются маской события, переданной с помощью параметра _улевентмаск_ . 
  
MAPI пересылает этот **рекомендуемый** вызов поставщику адресной книги, который отвечает за запись, как указано в параметре _лпентрид_ . Поставщик адресных книг либо обрабатывает регистрацию, либо вызывает метод поддержки, [имаписуппорт:: Subscribe](imapisupport-subscribe.md), чтобы запросить MAPI для регистрации абонента. Для представления успешной регистрации возвращается ненулевой номер подключения.
  
При каждом изменении записи типа, указанного с помощью регистрации уведомлений, поставщик адресной книги вызывает метод [имапиадвисесинк:: OnNotify](imapiadvisesink-onnotify.md) для объекта приемника уведомлений, указанного в параметре _лпадвисесинк_ . Метод **OnNotify** включает структуру [уведомлений](notification.md) в качестве входного параметра, который содержит данные для описания события. 
  
В зависимости от поставщика адресных книг вызов **OnNotify** может выполняться сразу после изменения зарегистрированного объекта или позже. В системах, поддерживающих несколько потоков выполнения, вызов **OnNotify** может выполняться в любом потоке. Клиенты могут запрашивать, что эти уведомления происходят в определенном потоке, вызывая функцию [хрсиссреададвисесинк](hrthisthreadadvisesink.md) для создания объекта приемника уведомлений, который передается в предложение **advise**. 
  
Так как поставщик адресных книг может освободить объект приемника уведомлений, переданный клиентами, в любой момент после успешного завершения вызова **advise** и до вызова [IAddrBook:: unadvise](iaddrbook-unadvise.md) для отмены уведомления, клиенты должны освободить объекты приемника **уведомлений при** возврате. 
  
Дополнительные сведения о процессе уведомления можно найти в статье [уведомление о событии в MAPI](event-notification-in-mapi.md).
  
## <a name="see-also"></a>См. также



[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)
  
[IAddrBook::Unadvise](iaddrbook-unadvise.md)
  
[IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)
  
[�����������](notification.md)
  
[IAddrBook : IMAPIProp](iaddrbookimapiprop.md)


---
title: Удаление сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9ed166b4-6b7b-478f-bbe5-4115bb818ac0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 663eebfcd1b8862b22d8c822957024c4f31499de
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433166"
---
# <a name="deleting-a-message"></a>Удаление сообщения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиент может удалить сообщение, когда оно открыто и пользователь его просматривает, или когда он закрывается, и пользователь просматривает таблицу содержимого. Чтобы предотвратить случайное удаление сообщения пользователем, MAPI определяет удаление сообщения в ходе выполнения двух этапов:
  
1. Пометить сообщение для удаления, переместив его в папку, которая была назначена в качестве папки "Удаленные" — папка, идентификатор записи которой хранится в свойстве **PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md)). 
    
2. Удалите сообщение, вызвав метод [IMAPIFolder::D елетемессажес](imapifolder-deletemessages.md) . 
    
Когда пользователь выбирает удаление сообщения из папки, отличной от папки "Удаленные", помечайте ее для удаления. Только когда пользователь выбирает сообщения из папки "Удаленные", должны ли сообщения физически удаляться с рабочей станции. Вы можете предложить пользователю подтвердить, что пользователь действительно предназначен для выполнения удаления.
  
 **Удаление сообщения**
  
1. Выясните у пользователя, что преднамеренное удаление преднамерено.
    
2. Определите родительский объект удаляемой папки. Если это папка "Удаленные" или вложенная папка в папке "Удаленные", вызовите [IMAPIFolder::D елетемессажес](imapifolder-deletemessages.md) , чтобы удалить сообщение. 
    
3. Если папка не находится в папке "Удаленные", вызовите [IMAPIFolder:: копимессажес](imapifolder-copymessages.md) с установленным флагом MESSAGE_MOVE, чтобы переместить сообщение в папку "Удаленные". 
    


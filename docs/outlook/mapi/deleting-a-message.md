---
title: Удаление сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9ed166b4-6b7b-478f-bbe5-4115bb818ac0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 663eebfcd1b8862b22d8c822957024c4f31499de
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433166"
---
# <a name="deleting-a-message"></a>Удаление сообщения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиент может удалить сообщение, когда оно открыто и пользователь читает его, или если оно закрыто и пользователь просматривает таблицу содержимого. Чтобы защитить пользователя от случайного удаления сообщения, MAPI определяет удаление сообщения как двухшаговую процедуру:
  
1. Пометить сообщение для удаления, перемещая его в папку, назначенную в качестве папки "Удаленные", — папку, идентификатор записи которой хранится в свойстве **PR_IPM_WASTEBASKET_ENTRYID** [(PidTagIpmWastebasketEntryId).](pidtagipmwastebasketentryid-canonical-property.md) 
    
2. Удалите сообщение, вызывая метод [IMAPIFolder::D eleteMessages.](imapifolder-deletemessages.md) 
    
Когда пользователь выбирает удаление сообщения в папке, не вложенной в папку "Удаленные", пометите его для удаления. Только если пользователь выбирает сообщения из папки "Удаленные", они должны быть физически удалены с рабочей станции. Вы можете побудить пользователя убедиться, что пользователь действительно намерен выполнить удаление.
  
 **Удаление сообщения**
  
1. Подтвердим пользователю, что предстоящее удаление является преднамеренным.
    
2. Определите родительский родитель папки, которая должна быть удалена. Если это папка "Удаленные" или вложенная папка в папке "Удаленные", вызовите [IMAPIFolder::D eleteMessages,](imapifolder-deletemessages.md) чтобы удалить сообщение. 
    
3. Если папка не находится в папке "Удаленные", вызовите [IMAPIFolder::CopyMessages](imapifolder-copymessages.md) с флагом MESSAGE_MOVE, чтобы переместить сообщение в папку "Удаленные". 
    


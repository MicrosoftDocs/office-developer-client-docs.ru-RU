---
title: Удаление сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9ed166b4-6b7b-478f-bbe5-4115bb818ac0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 663eebfcd1b8862b22d8c822957024c4f31499de
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433166"
---
# <a name="deleting-a-message"></a>Удаление сообщения

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиент может удалить сообщение, когда оно открыто и пользователь читает его, или когда оно закрывается и пользователь просматривает таблицу содержимого. Чтобы защитить пользователя от непреднамеренного удаления сообщения, MAPI определяет удаление сообщения как двухшаговой процесс:
  
1. Пометить сообщение для удаления, перемещая его в папку, назначенную как папка "Удаленные элементы" — папку, идентификатор записи которой хранится в свойстве **PR_IPM_WASTEBASKET_ENTRYID** [(PidTagIpmWastebasketEntryId).](pidtagipmwastebasketentryid-canonical-property.md) 
    
2. Удалите сообщение, позвонив по методу [IMAPIFolder::D eleteMessages.](imapifolder-deletemessages.md) 
    
Если пользователь выбирает удаление сообщения в папке, помимо папки "Удаленные элементы", пометите его для удаления. Только если пользователь выбирает сообщения из папки "Удаленные элементы", они будут физически удалены с рабочей станции. Вы можете побудить пользователя проверить, действительно ли пользователь намеревался выполнить удаление.
  
 **Удаление сообщения**
  
1. Подтвердим с пользователем, что предстоящее удаление является преднамеренным.
    
2. Определите родитель папки, которая будет удалена. Если это папка "Удаленные элементы" или подмостки в папке "Удаленные элементы", позвоните [в IMAPIFolder::D eleteMessages,](imapifolder-deletemessages.md) чтобы удалить сообщение. 
    
3. Если папка не содержится в папке "Удаленные элементы", позвоните [в IMAPIFolder::CopyMessages](imapifolder-copymessages.md) с флагом MESSAGE_MOVE, чтобы переместить сообщение в папку "Удаленные элементы". 
    


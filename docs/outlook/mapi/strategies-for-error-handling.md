---
title: Стратегии обработки ошибок
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: be941efd-04b3-48d0-9b9c-8195ad2bb58d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e778df216d0fe9b901cd9f7136c8014a6b8f0d0a
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812391"
---
# <a name="strategies-for-error-handling"></a>Стратегии обработки ошибок

  
  
**Относится к**: Outlook 
  
Как виртуальные методы интерфейса не поддерживается знаете, как вызывающего абонента, полный набор значений, которые можно получить из любого один звонок. Реализация метода может вернуть пять значения; другое может возвращать восемь. Список записей ссылку в документации по MAPI несколько значений, которые могут быть возвращены для каждого метода. Это значения, которые можно искать и обработать, так как они особое значение вашего клиента или поставщика. Другие значения могут быть возвращены, но поскольку они не удобной для восприятия, специальные код для обработки тех не требуется. Простой поиск успешное или неудачное достаточное количество.
  
Некоторые из методов интерфейса возврата предупреждения. Если метод, который вызывает вашего клиента или поставщика можно вернуть предупреждения, используйте макрос **HR_FAILED** для тестирования возвращаемого значения, а не выполняется проверка для нуля или отличное от нуля. Предупреждения, хотя ненулевое значение, отличаются от коды ошибок в том, что у них нет высокой бит. Если ваш поставщик клиента или службы не использует макрос, скорее всего, что предупреждение может означает сбой. 
  
Хотя большинство методов интерфейса и функции, возвращаемые значения HRESULT, некоторые функции возвращают неподписанных длинные значения. Кроме того некоторые методы, используемые в среде MAPI поступают из COM и возвращают COM ошибочные значения, а не значения ошибка MAPI. При выполнении вызовов учитывайте следующие рекомендации:
  
- Никогда не зависеть от или возвращаемого значения из **IUnknown::AddRef** или **функции IUnknown::Release**. Эти значения будут возвращены только в целях диагностики. 
    
- **IUnknown::QueryInterface** всегда возвращает универсальный ошибки COM, где — это средство FACILITY_NULL или FACILITY_RPC, а не ошибки MAPI. 
    
- Все другие методы интерфейса возвращает ошибки интерфейса MAPI с помощью средства FACILITY_ITF или FACILITY_RPC или FACILITY_NULL ошибки.
    
При вызове не поддерживается методу MAPI могут быть возвращены одним из четырех возможных ошибок: 
  
MAPI_E_NO_SUPPORT
  
MAPI_E_INTERFACE_NOT_SUPPORTED
  
MAPI_E_INVALID_PARAMETER
  
MAPI_E_VERSION. 
  


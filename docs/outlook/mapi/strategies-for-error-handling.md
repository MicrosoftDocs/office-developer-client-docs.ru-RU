---
title: Стратегии обработки ошибок
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: be941efd-04b3-48d0-9b9c-8195ad2bb58d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9e76ae3f292d8348b9dc64cb54bffae96b96e871
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424149"
---
# <a name="strategies-for-error-handling"></a>Стратегии обработки ошибок

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Так как методы интерфейса являются виртуальными, невозможно знать, как вызывающий, полный набор значений, которые можно возвратить из любого из одного вызова. Одна реализация метода может вернуть пять значений; другой может вернуть восемь. В справочных записях в документации по MAPI перечислено несколько значений, которые можно возвратить для каждого метода; Это значения, которые клиент или поставщик услуг может проверить и обработать, так как у них есть особые значения. Другие значения могут быть возвращены, но так как они не являются значимыми, Специальный код для их обработки не требуется. Простая проверка на успешность или сбой является достаточной.
  
Некоторые из методов интерфейса возвращают предупреждения. Если метод, который вызывает клиент или поставщик услуг, может возвращать предупреждение, используйте макрос **HR_FAILED** , чтобы проверить возвращаемое значение, а не проверку на ноль или ненулевое значение. Предупреждения, хотя ненулевые, отличаются от кодов ошибок тем, что для них не задана Высокая скорость. Если ваш клиент или поставщик услуг не используют макросы, то, скорее всего, предупреждение об ошибке может быть ошибочным. 
  
Хотя большинство методов и функций интерфейса возвращают значения HRESULT, некоторые функции возвращают неподписанные длинные значения. Кроме того, некоторые методы, используемые в среде MAPI, поступают из COM и возвращают значения ошибок COM, а не значения ошибок MAPI. При совершении вызовов учитывайте следующие рекомендации:
  
- Никогда не полагайтесь на и не используйте значения возврата от **IUnknown:: AddRef** или **IUnknown:: Release**. Эти возвращаемые значения предназначены только для диагностики. 
    
- **IUnknown:: QueryInterface** всегда возвращает общие ошибки COM, в которых FACILITY_NULL или FACILITY_RPC, а не ошибки MAPI. 
    
- Все остальные методы интерфейса возвращают ошибки интерфейса MAPI с помощью FACILITY_ITF, а также FACILITY_RPC или FACILITY_NULL ошибок.
    
При вызове неподдерживаемого метода MAPI может возвращаться одна из четырех возможных ошибок: 
  
MAPI_E_NO_SUPPORT
  
MAPI_E_INTERFACE_NOT_SUPPORTED
  
MAPI_E_INVALID_PARAMETER
  
MAPI_E_VERSION. 
  


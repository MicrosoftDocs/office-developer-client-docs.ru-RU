---
title: Стратегии обработки ошибок
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: be941efd-04b3-48d0-9b9c-8195ad2bb58d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9e76ae3f292d8348b9dc64cb54bffae96b96e871
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424149"
---
# <a name="strategies-for-error-handling"></a>Стратегии обработки ошибок

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поскольку методы интерфейса виртуальные, невозможно узнать как вызываемого пользователя полный набор значений, которые можно вернуть с одного вызова. Одна реализация метода может вернуть пять значений; другой может вернуть восемь. Справочные записи в документации MAPI перечисляют несколько значений, которые можно вернуть для каждого метода; это значения, которые клиент или поставщик услуг может проверять и обрабатывать, так как они имеют особые значения. Другие значения могут быть возвращены, но так как они не являются значимыми, специальный код для обработки этих значений не требуется. Достаточно простой проверки на успех или сбой.
  
Некоторые из методов интерфейса возвращают предупреждения. Если метод, который клиент или поставщик услуг вызывает, может вернуть предупреждение, **используйте макрос** HR_FAILED для проверки возвращаемого значения, а не проверки на ноль или незеро. Предупреждения, хотя и не являются незеро, отличаются от кодов ошибок тем, что они не имеют высокого бита. Если ваш клиент или поставщик услуг не использует макрос, скорее всего, предупреждение может быть ошибочно принято за сбой. 
  
Хотя большинство методов и функций интерфейса возвращают значения HRESULT, некоторые функции возвращают неподписаные длинные значения. Кроме того, некоторые методы, используемые в среде MAPI, приходят из com и возвращают значения ошибок COM, а не значения ошибок MAPI. Помните о следующих рекомендациях при вызове:
  
- Никогда не используйте значения возврата из **IUnknown::AddRef** или **IUnknown::Release.** Эти значения возвращаются только для диагностических целей. 
    
- **IUnknown::QueryInterface** всегда возвращает общие ошибки COM, в которых объект FACILITY_NULL или FACILITY_RPC, а не ошибки MAPI. 
    
- Все другие методы интерфейса возвращают ошибки интерфейса MAPI с FACILITY_ITF, FACILITY_RPC или FACILITY_NULL ошибок.
    
При вызове на неподтвердимый метод MAPI может быть возвращена одна из четырех возможных ошибок: 
  
MAPI_E_NO_SUPPORT
  
MAPI_E_INTERFACE_NOT_SUPPORTED
  
MAPI_E_INVALID_PARAMETER
  
MAPI_E_VERSION. 
  


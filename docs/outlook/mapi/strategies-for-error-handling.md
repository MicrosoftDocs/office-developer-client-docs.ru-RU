---
title: Стратегии обработки ошибок
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: be941efd-04b3-48d0-9b9c-8195ad2bb58d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9e76ae3f292d8348b9dc64cb54bffae96b96e871
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424149"
---
# <a name="strategies-for-error-handling"></a>Стратегии обработки ошибок

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поскольку методы интерфейса являются виртуальными, невозможно узнать как вызываемого пользователя полный набор значений, которые могут быть возвращены при любом вызове. Одна реализация метода может возвращать пять значений; другой может возвращать восемь. В справочных записях в документации MAPI есть несколько значений, которые могут быть возвращены для каждого метода; это значения, которые клиент или поставщик услуг может проверять и обрабатывать, так как они имеют особое значение. Другие значения могут быть возвращены, но так как они не имеют смысла, специальный код для их обработки не требуется. Достаточно простой проверки на успешность или неудачу.
  
Некоторые методы интерфейса возвращают предупреждения. Если метод, который клиент или поставщик услуг вызывает, может возвращать предупреждение, используйте **макрос** HR_FAILED для проверки возвращаемого значения, а не для проверки на нулевое или ненуровное значение. Предупреждения, хотя и не имеют номера, отличаются от кодов ошибок тем, что они не имеют высокого бита. Если ваш клиент или поставщик услуг не использует макрос, скорее всего, при сбое может возникнуть ошибка. 
  
Хотя большинство методов и функций интерфейса возвращают значения HRESULT, некоторые функции возвращают неподписаные длинные значения. Кроме того, некоторые методы, используемые в среде MAPI, приходят из com и возвращают значения ошибок COM, а не значения ошибок MAPI. При вызове следует помнить о следующих рекомендациях:
  
- Никогда не полагайтесь на возвращаемые значения **IUnknown::AddRef** или **IUnknown::Release.** Эти возвращаемое значение предназначено только для диагностики. 
    
- **IUnknown::QueryInterface** всегда возвращает универсальные ошибки COM, в которых объект FACILITY_NULL или FACILITY_RPC, а не ошибки MAPI. 
    
- Все другие методы интерфейса возвращают ошибки интерфейса MAPI с возможностью FACILITY_ITF, FACILITY_RPC ошибки FACILITY_NULL интерфейса.
    
При вызове неподтвердимого метода MAPI может быть возвращена одна из четырех возможных ошибок: 
  
MAPI_E_NO_SUPPORT
  
MAPI_E_INTERFACE_NOT_SUPPORTED
  
MAPI_E_INVALID_PARAMETER
  
MAPI_E_VERSION. 
  


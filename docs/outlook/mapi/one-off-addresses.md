---
title: Одноразовые адреса
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9224c694-b26f-42c7-9404-ee2dd832cfbb
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e6bda55951d8df5c5da272750c631ec105b2ccf2
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409113"
---
# <a name="one-off-addresses"></a>Одноразовые адреса

**Область применения**: Outlook 2013 | Outlook 2016 
  
Разовый адрес используется для отправки сообщений для разных получателей, получателей, которые не имеют соответствующей записи ни в одном из контейнеров адресной книги сеанса. Клиенты могут создавать разовые адреса при добавлении новых записей в адресную книгу или новых получателей в список получателей исходя из сообщения. В любой контейнер, который можно модификовать, можно добавлять разные адреса.
  
Для создания разового адреса клиенты используют специальный шаблон, содержащий элементы управления изменением, для ввода всей информации, которая составляет разовую адрес. Разовые адреса, например адреса других типов, используют предопределяемую форму. Формат разового адреса определяется MAPI следующим образом:
  
`Display name[Address type:Email address]`
  
В этом формате шесть компонентов и некоторые правила процитирования символов. Компоненты описаны в следующей таблице.
  
|**Компонент**|**Использование**|**Описание**|
|:-----|:-----|:-----|
|Отображаемое имя  <br/> |Необязательный  <br/> |Если его нет, **IAddrBook::ResolveName** использует видимую часть адреса электронной почты в качестве отображаемого имени. Может включать пробелы. Дополнительные сведения см. [в книге IAddrBook::ResolveName.](iaddrbook-resolvename.md)  <br/> |
|[  <br/> |Обязательный  <br/> |Разграничит начало типа и адресной информации.  <br/> |
|]  <br/> |Обязательный  <br/> |Разграничит конец типа и адресной информации. Если за этим персонажем следует что-либо, кроме белого пространства, запись не рассматривается как настраиваемый получатель.  <br/> |
|Тип адреса  <br/> |Обязательный  <br/> |Тип адреса; карты определенного формата адресов. Дополнительные сведения см. в [дополнительных сведениях о типах адресов MAPI.](mapi-address-types.md)  <br/> |
|:  <br/> |Обязательный  <br/> |Отделяет тип адреса от адреса электронной почты.  <br/> |
|Адрес электронной почты  <br/> |Обязательный  <br/> |����� ����������. Может включать пробелы.  <br/> |
   
MAPI использует определенные наборы цитирования символов, чтобы позволить адресам содержать специальные символы, такие как запятая (,), левая скобка ([) и двоеточие (:) и некоторые нетипимые символы, такие как возвращение вагона или лента строки или любой другой гексадецимальный эквивалент. Символ цитирования — это backslash ( \) . Поэтому, если клиенты или поставщики должны вставить ответную сетку в адрес, они должны предустановить его с помощью символа цитирования \\ ("").
  
Клиенты и поставщики услуг могут использовать этот метод цитирования в любом из нефиксируемых типовых полей. Например, следующая запись переводит Билла Ли в качестве отображаемого имени, MSPEER — как тип адреса, а \\ billll\in — как адрес электронной почты:
  
`Bill Lee[MSPEER:\\\\billl\in]`

Чтобы вставить специальные нетипимые символы, клиенты и поставщики услуг используют символ цитирования, за которым следуют х и две гексадецимальные цифры для представления их гексадецимального эквивалента. Например, если адрес имеет нетипимый символ, приравниваемый к возврату вагона, (\0d) в hexadecimal, клиент вводит его как:
  
`Fax Recipient[fax:recipient\x0dbuilding\x0doffice\x0d555-1212\x0d]`

**IAddrBook::ResolveName** также автоматически обновляет большинство SMTP-адресов, ищем адреса в следующем формате: 
  
`XXX@YYY.ZZZ`

Хотя не все возможные форматы RFC822 обрабатываются, эта автоматическая размывка является адекватной для большинства пользователей. **ResolveName** включает эту функцию, чтобы пользователи могли вводить SMTP-адреса непосредственно в сообщение и отправлять это сообщение пользователю Интернета. Компоненты XXX, YYY и ZZZ адреса могут быть одним или более символов. Входной (@) не может быть включен в компоненты адресов XXX, YYY или ZZZ, а компонент YYY также не может включать этот период. Так как следующие символы являются специальными символами в SMTP-адресах, MAPI автоматически преобразует имя отображения, содержащее эти символы, в один разный адрес: 
  
- \>\>
    
- @
    
- \<\>
    
- .
    
Каждому разовому адресу назначен соответствующий идентификатор разовой записи. Чтобы сделать это назначение, клиенты звонят **в IAddrBook::CreateOneOff,** а поставщики транспорта **— IMAPISupport::CreateOneOff**. Дополнительные сведения см. [в книге IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md). При обработке входящих сообщений транспортные поставщики создают идентификаторы разовой записи для адресов шлюза и для адресов, которые не могут обрабатываться связанными поставщиками адресных книг транспорта. Поставщики транспорта проверяют тип каждого адреса в сообщении, чтобы определить, может ли он обрабатываться поставщиком адресной книги, связанным с транспортом. Если это невозможно, поставщики транспорта звонят **по адресу IMAPISupport::CreateOneOff,** чтобы связать адрес с идентификатором одноразовой записи. 
  
Идентификаторы разовой записи включают следующие сведения в следующем порядке:
  
1. **MAPIUID**
    
2. Версия
    
3. Flags
    
4. Отображаемое имя
    
5. Тип адреса
    
6. Адрес электронной почты
    
В вызовах **в IAddrBook::CreateOneOff** и **IMAPISupport::CreateOneOff** клиенты и поставщики транспорта могут установить флаг, который указывает, может ли получатель, представленный разовым адресом, обрабатывать форматированный текст или встроенные объекты OLE. Чтобы указать, что получатель может обрабатывать отформатированные текстовые и OLE-объекты, клиенты и поставщики транспорта устанавливают флаг MAPI_SEND_NO_RICH_INFO в параметре _ulFlags._ Затем MAPI задает свойство one-off **recipient's PR_SEND_RICH_INFO** [(PidTagSendRichInfo)](pidtagsendrichinfo-canonical-property.md)false. Если этот флаг не установлен,  MAPI задает PR_SEND_RICH_INFO true, если разовая адресная адреса не интерпретируется как SMTP-адрес. В этом случае **PR_SEND_RICH_INFO** значение FALSE. 
  
## <a name="see-also"></a>См. также

- [IAddrBook::ResolveName](iaddrbook-resolvename.md)


---
title: Одноразовые адреса
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9224c694-b26f-42c7-9404-ee2dd832cfbb
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e6bda55951d8df5c5da272750c631ec105b2ccf2
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409113"
---
# <a name="one-off-addresses"></a>Одноразовые адреса

**Относится к**: Outlook 2013 | Outlook 2016 
  
Разовый адрес используется для отправки сообщений разных получателям, получателям, которые не имеют соответствующей записи ни в одном из контейнеров адресной книги сеанса. Клиенты могут создавать разротные адреса при добавлении новых записей в адресную книгу или новых получателей в список получателей исходяющих сообщений. В любой контейнер, который можно модификовать, можно добавить один раз в один раз.
  
Для создания разового адреса клиенты используют специальный шаблон, содержащий элементы управления редактированием, для ввода всей информации, которая составляет один раз. Для одноразовых адресов, например адресов других типов, используется предопределный формат. Формат разных адресов определяется MAPI следующим образом:
  
`Display name[Address type:Email address]`
  
В этом формате имеется шесть компонентов и некоторые правила для ключевых символов. Эти компоненты описаны в следующей таблице.
  
|**Компонент**|**Использование**|**Описание**|
|:-----|:-----|:-----|
|Отображаемое имя  <br/> |Необязательна  <br/> |Если его нет, **IAddrBook::ResolveName** использует видимую часть адреса электронной почты в качестве отображаемого имени. Может включать пустые. Дополнительные сведения см. в [книге IAddrBook::ResolveName.](iaddrbook-resolvename.md)  <br/> |
|[  <br/> |Обязательна  <br/> |Разграничит начало типа и адресной информации.  <br/> |
|]  <br/> |Обязательна  <br/> |Разграничит конец типа и сведений об адресе. Если за этим символом следует только пробел, запись не будет рассматриваться как настраиваемый получатель.  <br/> |
|Тип адреса  <br/> |Обязательна  <br/> |Тип адреса; сопо карте определенному формату адреса. Дополнительные сведения см. в [поддоме "Типы адресов MAPI".](mapi-address-types.md)  <br/> |
|:  <br/> |Обязательна  <br/> |Отделяет тип адреса от адреса электронной почты.  <br/> |
|адрес электронной почты;  <br/> |Обязательна  <br/> |����� ����������. Может включать пустые.  <br/> |
   
MAPI использует определенные наборы знаков кворума, чтобы разрешить адресам содержать специальные символы, такие как запятая (,), левая скобка ([) и двоеточие (:) и некоторые нетипимые символы, такие как возврат каретки, канал строки или любой другой эквивалент. Символ кавычка — это знак backslash ( \) . Таким образом, если клиентам или поставщикам необходимо вставить в адрес знаки "назад", они должны добавить к ней символ кворума (" \\ ").
  
Клиенты и поставщики услуг могут использовать эту методику коэффициента в любых непечатаемых, типируемых полях. Например, следующая запись преобразуется в Bill Lee в качестве отображаемого имени, MSPEER в качестве типа адреса и billll\in в качестве адреса \\ электронной почты:
  
`Bill Lee[MSPEER:\\\\billl\in]`

Чтобы вставить специальные нетипимые символы, клиенты и поставщики услуг используют символы х и 2, чтобы представлять их адептические эквиваленты. Например, если адрес имеет нетипимый символ, который приравнивается к возврату каретки (\0d) в качестве знака каретки, клиент вводит его как:
  
`Fax Recipient[fax:recipient\x0dbuilding\x0doffice\x0d555-1212\x0d]`

**IAddrBook::ResolveName** также автоматически ищет адреса в следующем формате: 
  
`XXX@YYY.ZZZ`

Хотя не все возможные форматы RFC822 обрабатываются, такой автоматический разбиение достаточно для большинства пользователей. **ResolveName** включает эту функцию, чтобы пользователи могли вводить SMTP-адреса непосредственно в сообщение и отправлять это сообщение пользователю Интернета. Компоненты XXX, YYY и ZZZ адреса могут иметь один или несколько символов. Знак @не может быть включен в компоненты адреса XXX, YYY или ZZZ, а компонент YYY также не может включать период. Так как следующие символы являются специальными символами в SMTP-адресах, MAPI автоматически преобразует отображаемую именем, содержащую эти символы, в один разный адрес: 
  
- \>\>
    
- @
    
- \<\>
    
- .
    
Каждому разовому адресу назначен соответствующий идентификатор однораховой записи. Чтобы сделать это назначение, клиенты звонят по телефону **IAddrBook::CreateOneOff,** а поставщики транспорта **— IMAPISupport::CreateOneOff.** Дополнительные сведения см. в книге [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff.](imapisupport-createoneoff.md) При обработке входящих сообщений поставщики транспорта создают идентификаторы разных записей для адресов шлюзов и адресов, которые не могут обрабатываться поставщиками связанных с транспортом адресных книг. Поставщики транспорта проверяют тип каждого адреса в сообщении, чтобы определить, может ли он обрабатываться поставщиком адресной книги, связанным с транспортом. Если это невозможно, поставщики транспорта **вызовут IMAPISupport::CreateOneOff,** чтобы связать адрес с идентификатором одноразовой записи. 
  
Идентификаторы разных записей включают следующие сведения в следующем порядке:
  
1. **MAPIUID**
    
2. Версия
    
3. Flags
    
4. Отображаемое имя
    
5. Тип адреса
    
6. адрес электронной почты;
    
В вызовах **IAddrBook::CreateOneOff** и **IMAPISupport::CreateOneOff** клиенты и поставщики транспорта могут установить флаг, который указывает, может ли получатель, представленный одноразовым адресом, обрабатывать форматированный текст или внедренные объекты OLE. Чтобы указать, что получатель может обрабатывать форматированный текст и объекты OLE, клиенты и поставщики транспорта устанавливают флаг MAPI_SEND_NO_RICH_INFO в параметре _ulFlags._ ЗАТЕМ MAPI устанавливает для свойства PR_SEND_RICH_INFO **получателя** [(PidTagSendRichInfo)](pidtagsendrichinfo-canonical-property.md)false. Если этот флаг не установлен, MAPI задает PR_SEND_RICH_INFO **true,** если только один разный адрес не интерпретируется как SMTP-адрес. В этом случае PR_SEND_RICH_INFO **значение** false. 
  
## <a name="see-also"></a>См. также

- [IAddrBook::ResolveName](iaddrbook-resolvename.md)


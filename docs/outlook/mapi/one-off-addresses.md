---
title: Одноразовые адреса
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9224c694-b26f-42c7-9404-ee2dd832cfbb
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e6bda55951d8df5c5da272750c631ec105b2ccf2
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409113"
---
# <a name="one-off-addresses"></a>Одноразовые адреса

**Относится к**: Outlook 2013 | Outlook 2016 
  
Один адрес используется для отправки сообщений отправителям, получателям, у которых нет соответствующей записи ни в одном из контейнеров адресной книги сеанса. Клиенты могут создавать одноразовые адреса при добавлении новых записей в адресную книгу или новых получателей в список получателей исходящих сообщений. В любой контейнер можно добавить один или несколько адресов.
  
Для создания одноразового адреса клиенты используют специальный шаблон, содержащий элементы управления для редактирования, для ввода всех сведений, которые составляют один адрес. Для одноразовых адресов, например адресов других типов, используется предварительно определенный формат. Формат адреса для одноразового адреса определяется MAPI следующим образом:
  
`Display name[Address type:Email address]`
  
Этот формат состоит из шести компонентов и некоторых правил заключения в них символов. Компоненты описаны в приведенной ниже таблице.
  
|**Компонент**|**Использование**|**Описание**|
|:-----|:-----|:-----|
|Различающееся имя (DN)  <br/> |Необязательна  <br/> |Если этот параметр отсутствует, **IAddrBook:: ресолвенаме** использует видимую часть адреса электронной почты в качестве отображаемого имени. Может содержать пробелы. Дополнительные сведения см. в статье [IAddrBook:: ресолвенаме](iaddrbook-resolvename.md).  <br/> |
|[  <br/> |Обязательна  <br/> |Выделяют начало типа и адреса.  <br/> |
|]  <br/> |Обязательна  <br/> |Выделяют конец типа и адреса. Если за этим символом следует любое значение, отличное от пробела, то запись не будет считаться настраиваемым получателем.  <br/> |
|Тип адреса  <br/> |Обязательна  <br/> |Тип адреса; сопоставление с определенным форматом адреса. Дополнительные сведения приведены в разделе [типы адресов MAPI](mapi-address-types.md).  <br/> |
|:  <br/> |Обязательна  <br/> |Отделяет тип адреса от адреса электронной почты.  <br/> |
|Адрес электронной почты  <br/> |Обязательна  <br/> |����� ����������. Может содержать пробелы.  <br/> |
   
MAPI использует определенные наборы символов для заключения в кавычки, чтобы разрешить адресам содержать специальные символы, такие как запятая (,), левая квадратная скобка ([) и двоеточие (:) и некоторые нетипизированные символы, такие как возврат каретки или строка перевода строки или любой другой шестнадцатеричный эквивалент. Символ заключения — это обратная косая\)черта (. Таким образом, если клиенты или поставщики должны вставить обратную косую черту в адрес, они должны прецеед их символом "\\" ".
  
Клиенты и поставщики услуг могут использовать этот метод заключения текста в любом из нефиксированных полей. Например, следующая запись переводится в Билл в качестве отображаемого имени, МСПИР в качестве типа адреса и \\билллл\ин в качестве адреса электронной почты:
  
`Bill Lee[MSPEER:\\\\billl\in]`

Чтобы вставить специальные нетипизированные символы, клиенты и поставщики услуг используют символ заключения знака, а затем x и две шестнадцатеричные цифры для представления их шестнадцатеричных эквивалентов. Например, если в адресе есть нетипизированный символ, который соответствует символу возврата каретки (\0d) в шестнадцатеричном виде, клиент введет их как:
  
`Fax Recipient[fax:recipient\x0dbuilding\x0doffice\x0d555-1212\x0d]`

**IAddrBook:: ресолвенаме** также автоматически выполняет синтаксический анализ большинства SMTP-адресов с поиском адресов в следующем формате: 
  
`XXX@YYY.ZZZ`

Несмотря на то что не все возможные форматы RFC822 обрабатываются, этот автоматический анализ подходит для большинства пользователей. **Ресолвенаме** включает эту функцию, чтобы позволить пользователям вводить SMTP-адреса непосредственно в сообщение и поступать с этим сообщением в Интернет-пользователя. Компоненты Address XXX, YYY и ZZZ могут иметь один или несколько символов. Символ "@" не может быть включен в компоненты адреса XXX, YYY или ZZZ, а компонент YYY также не может включать точку. Так как следующие символы являются специальными символами в SMTP-адресах, MAPI автоматически преобразует отображаемое имя, содержащее эти символы, в один адрес: 
  
- \>\>
    
- @
    
- \<\>
    
- .
    
Каждому одноразовому адресу назначается соответствующий идентификатор одноразовой записи. Чтобы сделать это назначение, клиенты вызывают **IAddrBook:: креатеонеофф** и Transport providers Call **Имаписуппорт:: креатеонеофф**. Дополнительные сведения см. в статье [IAddrBook:: креатеонеофф](iaddrbook-createoneoff.md) and [Имаписуппорт:: креатеонеофф](imapisupport-createoneoff.md). При обработке входящих сообщений поставщики транспорта создают одноразовые идентификаторы записей для адресов шлюза и для адресов, которые не могут быть обработаны поставщиками адресных книг, связанными с транспортом. Поставщики транспорта проверяют тип каждого адреса в сообщении, чтобы определить, может ли он обрабатываться поставщиком адресной книги, связанным с транспортом. Если это невозможно, поставщики транспорта вызывают **имаписуппорт:: креатеонеофф** , чтобы связать адрес с идентификатором одноразовой записи. 
  
Одноразовые идентификаторы записей включают следующие сведения в следующем порядке:
  
1. **MAPIUID**
    
2. Версия
    
3. Flags
    
4. Различающееся имя (DN)
    
5. Тип адреса
    
6. Адрес электронной почты
    
В разделе Calls to **IAddrBook:: креатеонеофф** and **Имаписуппорт:: креатеонеофф**, clients and Transport providers можно установить флаг, указывающий, может ли получатель, представленный одним адресом, обрабатывать форматированный текст или внедренные объекты OLE. Чтобы указать, что получатель может обрабатывать форматированный текст и объекты OLE, клиенты и поставщики транспорта устанавливают флаг MAPI_SEND_NO_RICH_INFO в параметре _ulFlags_ . Затем MAPI задает для свойства **PR_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) одноразового получателя значение false (ложь). Если этот флаг не задан, MAPI устанавливает **PR_SEND_RICH_INFO** в значение true, если только один адрес не интерпретируется как SMTP-адрес. В этом случае **PR_SEND_RICH_INFO** умолчанию ЗАДАНО значение false. 
  
## <a name="see-also"></a>См. также

- [IAddrBook::ResolveName](iaddrbook-resolvename.md)


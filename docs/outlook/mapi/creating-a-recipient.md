---
title: Создание получателя
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429588"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="ebc7f-103">Создание получателя</span><span class="sxs-lookup"><span data-stu-id="ebc7f-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="ebc7f-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ebc7f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ebc7f-105">Клиенты создают получателей при адресации сообщений и добавлении записей в изменяемые контейнеры адресных книг.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="ebc7f-106">MAPI предоставляет три метода создания получателей:</span><span class="sxs-lookup"><span data-stu-id="ebc7f-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="ebc7f-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="ebc7f-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="ebc7f-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="ebc7f-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="ebc7f-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="ebc7f-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="ebc7f-110">Call **IAddrBook:: креатеонеофф** при создании получателей, которые будут использоваться для адресации сообщений.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="ebc7f-111">**Креатеонеофф** создает особым образом отформатированный идентификатор записи, который будет связан с адресом определенного типа адресов.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="ebc7f-112">Дополнительные сведения об односторонных и одноразовых идентификаторах записей приведены в разделе [одноразовые адреса](one-off-addresses.md) и [одноразовые идентификаторы записей](one-off-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="ebc7f-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="ebc7f-113">Call **IAddrBook:: невентри** при создании получателей, которые будут использоваться либо для адресации сообщений, либо для добавления в контейнер.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="ebc7f-114">**Невентри** состоит из трех пар параметров, содержащих идентификаторы записей.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="ebc7f-115">Эти параметры описаны ниже.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="ebc7f-116">**Комбинация параметра**</span><span class="sxs-lookup"><span data-stu-id="ebc7f-116">**Parameter pair**</span></span>|<span data-ttu-id="ebc7f-117">**Описание**</span><span class="sxs-lookup"><span data-stu-id="ebc7f-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="ebc7f-118">_кбеидконтаинер_ и _лпеидконтаинер_</span><span class="sxs-lookup"><span data-stu-id="ebc7f-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="ebc7f-119">Идентификатор элемента контейнера, в который следует поместить новую запись.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="ebc7f-120">_кбеидневентритпл_ и _лпеидневентритпл_</span><span class="sxs-lookup"><span data-stu-id="ebc7f-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="ebc7f-121">Идентификатор записи для шаблона, который будет использоваться для создания новой записи.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="ebc7f-122">_лпкбеидневентри_ и _лппеидневентри_</span><span class="sxs-lookup"><span data-stu-id="ebc7f-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="ebc7f-123">Идентификатор записи для новой записи.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="ebc7f-124">Чтобы создать получателя для исходящего сообщения, задайте для параметра _кбеидконтаинер_ значение 0, а _лпеидконтаинер_ — null.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="ebc7f-125">**Невентри** создает получателя с идентификатором записи, который соответствует одноразовому формату, тот же тип получателя, который создается при вызове **IAddrBook:: креатеонеофф**.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="ebc7f-126">Чтобы создать получателя, который будет вставлен в определенный контейнер, задайте для параметра _лпеидконтаинер_ идентификатор записи контейнера и _кбеидконтаинер_ число байтов в идентификаторе записи контейнера.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="ebc7f-127">Чтобы использовать шаблон для создания получателя, задайте для параметра _лпеидневентритпл_ идентификатор записи используемого шаблона и _кбеидневентритпл_ число байтов в этом идентификаторе записи.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="ebc7f-128">Большинство изменяемых контейнеров адресных книг поддерживают один или несколько шаблонов для создания записей определенного типа.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="ebc7f-129">Одноразовые шаблоны обычно, но не всегда, отображаются в диалоговых окнах.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="ebc7f-130">Ввод данных в шаблон создает получателя с адресом, который правильно отформатирован для типа.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="ebc7f-131">Получите идентификатор записи шаблона из одного из следующих вариантов:</span><span class="sxs-lookup"><span data-stu-id="ebc7f-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="ebc7f-132">Столбец **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) в односторонней таблице контейнера, к которому можно получить доступ, вызвав метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) и указав **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) в качестве тега свойства и IID_IMAPITable в качестве идентификатора интерфейса.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="ebc7f-133">Свойства **PR_DEF_CREATE_MAILUSER** поставщика адресных книг ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) и **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)), которые содержат идентификаторы элементов пользователя для обмена сообщениями и шаблоны списка рассылки поставщика.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="ebc7f-134">Не путайте идентификатор записи нового шаблона записей с другим типом идентификатора записи, который называется идентификатором шаблона.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="ebc7f-135">Идентификатор шаблона используется только поставщиками для поддержки записей, скопированных из других поставщиков; Он никогда не используется клиентами и не используется для создания новых записей.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="ebc7f-136">Чтобы разрешить пользователю определять тип создаваемой записи, передайте ноль для _кбеидневентритпл_ и значение NULL для _лпеидневентритпл_.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="ebc7f-137">В этом случае **невентри** отображает общее диалоговое окно, созданное из одностороннего таблицы MAPI — иерархический список всех шаблонов, поддерживаемых каждым поставщиком адресных книг в профиле.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="ebc7f-138">Если тип адреса определен с помощью параметра _лпеидневентритпл_ или выбора пользователя из таблицы с отсчетом отправителя, **невентри** отображает соответствующий шаблон с помощью таблицы отображения.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="ebc7f-139">Все новые шаблоны записей поддерживают свойство **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="ebc7f-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="ebc7f-140">Чтобы **невентри** возвращал идентификатор созданной записи, передайте допустимый адрес для параметров _лпкбеидневентри_ и _лппеидневентри_ .</span><span class="sxs-lookup"><span data-stu-id="ebc7f-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="ebc7f-141">MAPI помещает новый идентификатор записи по адресу, на который указывает _лппеидневентри_ , и число байтов нового идентификатора записи по адресу, на который указывает _лпкбеидневентри_.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="ebc7f-142">Call [иабконтаинер:: креатинтри](iabcontainer-createentry.md) , чтобы создать получателя и сохранить его в определенном контейнере адресной книги.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="ebc7f-143">Этот метод можно использовать только с изменяемыми контейнерами — контейнерами, для которых в свойстве **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) задано значение флага AB_MODIFIABLE.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="ebc7f-144">Поставщики адресных книг с неизменяемыми контейнерами не поддерживают этот метод.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="ebc7f-145">Укажите идентификатор записи шаблона для создания записи требуемого типа в параметре _лпентрид_ .</span><span class="sxs-lookup"><span data-stu-id="ebc7f-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="ebc7f-146">В параметре _улкреатефлагс_ укажите тип проверки дублирующего элемента, а также следует ли заменить существующие записи новыми.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="ebc7f-147">Если **креатинтри** не удается создать новый объект из-за проверки повторяющихся записей, накладываемых поставщиком, не ожидается, что выводится сообщение об ошибке или предупреждение.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="ebc7f-148">В этих условиях поставщики возвращают код успешного выполнения.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="ebc7f-149">Если вы работаете непосредственно с контейнером и знаете, какие типы адресов могут создаваться контейнером, можно вызвать **иабконтаинер:: креатинтри** и передать идентификатор записи для соответствующего шаблона.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="ebc7f-150">Поставщик адресных книг задает некоторые начальные свойства по умолчанию; Вы можете вызвать **SetProps** , чтобы задать другие.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="ebc7f-151">Пользователь никогда не участвует.</span><span class="sxs-lookup"><span data-stu-id="ebc7f-151">The user is never involved.</span></span> 
  


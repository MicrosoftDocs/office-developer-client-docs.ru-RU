---
title: Создание получателя
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332958"
---
# <a name="creating-a-recipient"></a>Создание получателя

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиенты создают получателей при адресации сообщений и добавлении записей в изменяемые контейнеры адресных книг. MAPI предоставляет три метода создания получателей:
  
- [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
    
- [IAddrBook::NewEntry](iaddrbook-newentry.md)
    
- [IABContainer::CreateEntry](iabcontainer-createentry.md)
    
Call **IAddrBook:: креатеонеофф** при создании получателей, которые будут использоваться для адресации сообщений. **Креатеонеофф** создает особым образом отформатированный идентификатор записи, который будет связан с адресом определенного типа адресов. Дополнительные сведения об односторонных и одноразовых идентификаторах записей приведены в разделе [одноразовЫе адреса](one-off-addresses.md) и одноразовые [идентификаторы записей](one-off-entry-identifiers.md).
  
Call **IAddrBook:: невентри** при создании получателей, которые будут использоваться либо для адресации сообщений, либо для добавления в контейнер. **Невентри** состоит из трех пар параметров, содержащих идентификаторы записей. Эти параметры описаны ниже. 
  
|**Комбинация параметра**|**Описание**|
|:-----|:-----|
| _кбеидконтаинер_ и _лпеидконтаинер_ <br/> |Идентификатор элемента контейнера, в который следует поместить новую запись.  <br/> |
| _кбеидневентритпл_ и _лпеидневентритпл_ <br/> |Идентификатор записи для шаблона, который будет использоваться для создания новой записи.  <br/> |
| _лпкбеидневентри_ и _лппеидневентри_ <br/> |Идентификатор записи для новой записи.  <br/> |
   
Чтобы создать получателя для исходящего сообщения, задайте для параметра _кбеидконтаинер_ значение 0, а _лпеидконтаинер_ — null. **Невентри** создает получателя с идентификатором записи, который соответствует одноразовому формату, тот же тип получателя, который создается при вызове **IAddrBook:: креатеонеофф**. 
  
Чтобы создать получателя, который будет вставлен в определенный контейнер, задайте для параметра _лпеидконтаинер_ идентификатор записи контейнера и _кбеидконтаинер_ число байтов в идентификаторе записи контейнера. 
  
Чтобы использовать шаблон для создания получателя, задайте для параметра _лпеидневентритпл_ идентификатор записи используемого шаблона и _кбеидневентритпл_ число байтов в этом идентификаторе записи. Большинство изменяемых контейнеров адресных книг поддерживают один или несколько шаблонов для создания записей определенного типа. Одноразовые шаблоны обычно, но не всегда, отображаются в диалоговых окнах. Ввод данных в шаблон создает получателя с адресом, который правильно отформатирован для типа. 
  
Получите идентификатор записи шаблона из одного из следующих вариантов:
  
- Столбец **пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)) в односторонней таблице контейнера, доступ к которому осуществляется с помощью метода контейнера [IMAPIProp:: Опенпроперти](imapiprop-openproperty.md) и с указанием **пр_креате_темплатес** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) AS тег свойства и Иид_имапитабле в качестве идентификатора интерфейса. 
    
- Свойства **пр_деф_креате_маилусер** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) и **пр_деф_креате_дл** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) для поставщика адресных книг, содержащие идентификаторы записей для объекта пользователя обмена сообщениями поставщика и шаблоны списков рассылки. 
    
> [!NOTE]
> Не путайте идентификатор записи нового шаблона записей с другим типом идентификатора записи, который называется идентификатором шаблона. Идентификатор шаблона используется только поставщиками для поддержки записей, скопированных из других поставщиков; Он никогда не используется клиентами и не используется для создания новых записей. 
  
Чтобы разрешить пользователю определять тип создаваемой записи, передайте ноль для _кбеидневентритпл_ и значение NULL для _лпеидневентритпл_. В этом случае **невентри** отображает общее диалоговое окно, созданное из одностороннего таблицы MAPI — иерархический список всех шаблонов, поддерживаемых каждым поставщиком адресных книг в профиле. 
  
Если тип адреса определен с помощью параметра _лпеидневентритпл_ или выбора пользователя из таблицы с отсчетом отправителя, **невентри** отображает соответствующий шаблон с помощью таблицы отображения. Все новые шаблоны записей поддерживают свойство **пр_детаилс_табле** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)). 
  
Чтобы **невентри** возвращал идентификатор созданной записи, передайте допустимый адрес для параметров _лпкбеидневентри_ и _лппеидневентри_ . MAPI помещает новый идентификатор записи по адресу, на который указывает _лппеидневентри_ , и число байтов нового идентификатора записи по адресу, на который указывает _лпкбеидневентри_.
  
Call [иабконтаинер:: креатинтри](iabcontainer-createentry.md) , чтобы создать получателя и сохранить его в определенном контейнере адресной книги. Этот метод можно использовать только с изменяемыми контейнерами — контейнерами, для которых установлен флаг АБ_МОДИФИАБЛЕ в свойстве **пр_контаинер_флагс** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)). Поставщики адресных книг с неизменяемыми контейнерами не поддерживают этот метод. Укажите идентификатор записи шаблона для создания записи требуемого типа в параметре _лпентрид_ . 
  
В параметре _улкреатефлагс_ укажите тип проверки дублирующего элемента, а также следует ли заменить существующие записи новыми. Если **креатинтри** не удается создать новый объект из-за проверки повторяющихся записей, накладываемых поставщиком, не ожидается, что выводится сообщение об ошибке или предупреждение. В этих условиях поставщики возвращают код успешного выполнения. 
  
Если вы работаете непосредственно с контейнером и знаете, какие типы адресов могут создаваться контейнером, можно вызвать **иабконтаинер:: креатинтри** и передать идентификатор записи для соответствующего шаблона. Поставщик адресных книг задает некоторые начальные свойства по умолчанию; Вы можете вызвать **SetProps** , чтобы задать другие. Пользователь никогда не участвует. 
  


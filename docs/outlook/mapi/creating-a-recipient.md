---
title: Создание получателя
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429588"
---
# <a name="creating-a-recipient"></a>Создание получателя

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиенты создают получателей при обращении к сообщениям и при добавлении записей в изменяемые контейнеры адресной книги. MAPI предоставляет три метода создания получателей:
  
- [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
    
- [IAddrBook::NewEntry](iaddrbook-newentry.md)
    
- [IABContainer::CreateEntry](iabcontainer-createentry.md)
    
Вызов **IAddrBook::CreateOneOff** при создании получателей, которые будут использоваться для адресов сообщений. **CreateOneOff** создает специально отформатированный идентификатор разной записи, связанный с адресом определенного типа адресов. Дополнительные сведения об идентификаторах разных и одноавтных записей см. в документе [One-Off Addresses](one-off-addresses.md) и [One-Off Entry Identifiers.](one-off-entry-identifiers.md)
  
Вызов **IAddrBook::NewEntry** при создании получателей, которые будут использоваться для адресов сообщений или добавления в контейнер. **NewEntry** имеет три пары параметров, содержащих идентификаторы записей. Эти параметры описаны следующим образом: 
  
|**Пара параметров**|**Описание**|
|:-----|:-----|
| _cbEidContainer_ и  _lpEidContainer_ <br/> |Идентификатор входа для контейнера, в который должна быть помещена новая запись.  <br/> |
| _cbEidNewEntryTpl_ и  _lpEidNewEntryTpl_ <br/> |Идентификатор входа для шаблона, который будет использоваться для создания новой записи.  <br/> |
| _lpcbEidNewEntry_ и  _lppEidNewEntry_ <br/> |Идентификатор входа для новой записи.  <br/> |
   
Чтобы создать получателя для исходячего сообщения, установите  _значение cbEidContainer_ до нуля и  _lpEidContainer_ nULL. **NewEntry** создает получателя с идентификатором записи, который соответствует разовом формату, такому же типу получателя, который создается по вызову **в IAddrBook::CreateOneOff**. 
  
Чтобы создать получателя, вставленного в определенный контейнер, установите  _идентификатор входа lpEidContainer_ и  _cbEidContainer_ количеством bytes в идентификаторе входа контейнера. 
  
Чтобы использовать шаблон для создания получателя, задайте  _lpEidNewEntryTpl_ идентификатору входа используемого шаблона и  _cbEidNewEntryTpl_ для подсчета bytes в этом идентификаторе записи. Большинство изменяемых контейнеров адресных книг поддерживают один или несколько шаблонов для создания записей определенного типа. Разовые шаблоны обычно, но не всегда, диалоговые окна. Ввод сведений в шаблон создает получателя с правильно отформатированным для этого типа адресом. 
  
Получение идентификатора записи шаблона из:
  
- Столбец **PR_ENTRYID** [(PidTagEntryId)](pidtagentryid-canonical-property.md)в одноразовой таблице контейнера, к нему можно звать метод [IMAPIProp::OpenProperty](imapiprop-openproperty.md) и указать **PR_CREATE_TEMPLATES** [(PidTagCreateTemplates)](pidtagcreatetemplates-canonical-property.md)в качестве тега свойства и IID_IMAPITable в качестве идентификатора интерфейса. 
    
- Свойства поставщика адресных **книг PR_DEF_CREATE_MAILUSER** [(PidTagDefCreateMailuser)](pidtagdefcreatemailuser-canonical-property.md)и **PR_DEF_CREATE_DL** [(PidTagDefCreateDl),](pidtagdefcreatedl-canonical-property.md)которые удерживают идентификаторы записей для объектов пользователей и шаблонов списков рассылки сообщений поставщика. 
    
> [!NOTE]
> Не путайте идентификатор записи нового шаблона записи с другим типом идентификатора записи, который называется идентификатором шаблона. Идентификатор шаблона используется только поставщиками для поддержания записей, скопированные у других поставщиков; он никогда не используется клиентами и не используется для создания новых записей. 
  
Чтобы позволить пользователю определить тип создаваемой записи, переведите ноль  _для cbEidNewEntryTpl_ и NULL для  _lpEidNewEntryTpl_. При этом **в NewEntry** отображается общее диалоговое окно, построенное из единой таблицы MAPI — иерархический список всех шаблонов, поддерживаемых каждым поставщиком адресных книг в профиле. 
  
Если тип адреса определен либо с помощью параметра  _lpEidNewEntryTpl,_ либо путем выбора пользователем из разового отображения таблицы, **NewEntry** отображает соответствующий шаблон с помощью таблицы отображения. Все новые шаблоны записи поддерживают **свойство PR_DETAILS_TABLE** [(PidTagDetailsTable).](pidtagdetailstable-canonical-property.md) 
  
Чтобы **NewEntry** вернул идентификатор записи созданной записи, передай допустимый адрес для параметров _lpcbEidNewEntry_ и _lppEidNewEntry._ MAPI помещает новый идентификатор записи по адресу, на который указывает _lppEidNewEntry,_ и количество byte нового идентификатора записи по адресу, на который указывает _lpcbEidNewEntry._
  
Вызов [IABContainer::CreateEntry,](iabcontainer-createentry.md) чтобы создать получателя и сохранить его в определенном контейнере адресной книги. Этот метод можно использовать только с помощью модификационных контейнеров —  контейнеров с AB_MODIFIABLE флагом в свойстве[PR_CONTAINER_FLAGS (PidTagContainerFlags).](pidtagcontainerflags-canonical-property.md) Поставщики адресных книг с немодификируемыми контейнерами не поддерживают этот метод. Укажите идентификатор записи шаблона для создания записи нужного типа в _параметре lpEntryID._ 
  
В  _параметре ulCreateFlags_ укажите тип необходимой проверки дублирующихся записей и следует ли заменять новые записи существующими. Если **CreateEntry** не удается создать новый объект из-за дублирующей проверки входа, введенной поставщиком, не ожидайте возврата ошибки или предупреждения. В этих условиях поставщики возвращают код успеха. 
  
Если вы работаете непосредственно с контейнером и точно знаете типы адресов, которые может создать контейнер, вы можете вызвать **IABContainer::CreateEntry** и передать идентификатор записи для соответствующего шаблона. Поставщик адресных книг задает некоторые начальные свойства по умолчанию; Вы можете вызвать **SetProps,** чтобы установить другие. Пользователь никогда не участвует. 
  


---
title: Создание получателя
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4d4777077dae5effed9f233dd020628ee0dcfed5
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22578047"
---
# <a name="creating-a-recipient"></a>Создание получателя

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Клиенты создавать получателям, когда они адресации сообщений и при их добавление записей можно изменить адрес книги контейнеров. MAPI предоставляет три способа создания получателей:
  
- [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
    
- [IAddrBook::NewEntry](iaddrbook-newentry.md)
    
- [IABContainer::CreateEntry](iabcontainer-createentry.md)
    
Вызов **IAddrBook::CreateOneOff** при создании получателей, которые будут использоваться для адресации сообщений. **CreateOneOff** создает идентификатор специально форматированные единичных записей, необходимо связать с адресом адрес определенного типа. Дополнительные сведения о one-offs и идентификаторы единичных записей можно [Одноразовых адресов](one-off-addresses.md) и [Одноразовых идентификаторы записей](one-off-entry-identifiers.md).
  
Вызов **IAddrBook::NewEntry** при создании получатели используется один адрес сообщения или добавить в контейнер. **NewEntry** имеет три пары параметров, которые содержат идентификаторы записей. Ниже приведено описание этих параметров: 
  
|**Пара параметр**|**Описание**|
|:-----|:-----|
| _cbEidContainer_ и _lpEidContainer_ <br/> |Идентификатор записи для контейнера, в котором необходимо разместить новую запись.  <br/> |
| _cbEidNewEntryTpl_ и _lpEidNewEntryTpl_ <br/> |Идентификатор записи для шаблона, который будет использоваться для создания новой записи.  <br/> |
| _lpcbEidNewEntry_ и _lppEidNewEntry_ <br/> |Идентификатор записи для новой записи.  <br/> |
   
Чтобы создать получателя для исходящих сообщений, задайте _cbEidContainer_ и _lpEidContainer_ значение NULL. **NewEntry** создает получателя с идентификатором запись, которая соответствует одноразовых формат тот же тип получателя, который создается с помощью вызова **IAddrBook::CreateOneOff**. 
  
Для создания получателя для вставки в конкретным контейнером значение _lpEidContainer_ идентификатор записи и _cbEidContainer_ число байтов в идентификатор записи контейнера контейнера. 
  
Чтобы использовать шаблон для создания получателя, значение _lpEidNewEntryTpl_ идентификатор записи шаблона для использования и _cbEidNewEntryTpl_ количество байт в этот идентификатор записи. Наиболее изменяемые контейнеры книги адрес поддерживают один или несколько шаблонов для создания записи определенного типа. Одноразовых шаблонов не как правило, но не всегда, диалоговые окна. Ввод данных в шаблоне создает получателя с адреса, который правильный формат для типа. 
  
Получите идентификатор записи шаблона с помощью одной:
  
- Столбец **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) в одноразовых таблицу контейнера, доступ путем вызова метода [IMAPIProp::OpenProperty](imapiprop-openproperty.md) контейнера и указание **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) в качестве Свойство tag и IID_IMAPITable идентификатор интерфейса. 
    
- В адресной книге поставщика **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) и **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) свойства, которые содержат идентификаторы записей для обмена сообщениями объекта пользователя поставщика и шаблоны списков рассылки. 
    
> [!NOTE]
> Не следует путать идентификатор записи новый шаблон запись с другого типа идентификатор записи называется идентификатор шаблона. Идентификатор шаблона используется только поставщиков для Ведение записей, скопированные из других поставщиков; никогда не используется с клиентами и не используется для создания новых записей. 
  
Чтобы включить пользователей для определения типа записи будет создан, передайте ноль для _cbEidNewEntryTpl_ и значение NULL для _lpEidNewEntryTpl_. В этом случае **NewEntry** отображает стандартным диалоговым окном, построенная на основе MAPI в одноразовых таблице — иерархический список всех шаблонов, поддерживаемых каждой поставщик адресной книги в профиле. 
  
Когда тип адреса будет определено, либо через значения параметра _lpEidNewEntryTpl_ или выбора пользователем отображении одноразовых таблицы **NewEntry** отображает соответствующий шаблон с помощью его отображения таблицы. Все новые шаблоны запись поддерживает свойство **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)). 
  
Чтобы **NewEntry** возврата запись идентификатор созданного элемента, передайте допустимый адрес параметров _lpcbEidNewEntry_ и _lppEidNewEntry_ . MAPI по адресу, на который указывает _lppEidNewEntry_ и количество байтов новый идентификатор записи по адресу, на который указывает _lpcbEidNewEntry_помещает новый идентификатор записи.
  
Вызов [IABContainer::CreateEntry](iabcontainer-createentry.md) для создания получателя и сохраните его в контейнер определенный адресной книги. Этот метод можно использовать только с изменяемым контейнеров — контейнеры, которые имеют AB_MODIFIABLE помечает set в своем свойстве **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)). Этот метод не поддерживают поставщиками адресной книги с неизменяемые контейнеров. Укажите идентификатор записи шаблона для создания записи требуемого типа с помощью параметра _lpEntryID_ . 
  
С помощью параметра _ulCreateFlags_ укажите тип дубликат проверка обязательные и ли новые записи необходимо заменить существующие. В случае сбоя **CreateEntry** для создания нового объекта из-за поставщика проверки дубликат не ожидать сообщение об ошибке или предупреждение возвращаются. В этих условиях поставщики возвращают код успешного завершения. 
  
Если вы работаете непосредственно с контейнером и знать точно типы адреса, которые можно создать контейнер, можно вызвать **IABContainer::CreateEntry** и передать идентификатор записи на соответствующий шаблон. Поставщик адресной книги задает некоторые свойства по умолчанию; можно вызвать **SetProps** установка других пользователей. Никогда не участвует пользователь. 
  


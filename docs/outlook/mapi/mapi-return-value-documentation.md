---
title: Документация о возврате значения MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c32ee53c-b063-4a00-a6bf-75ce5e07f56a
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5bbafe9fda479d951bb20175ab904dc6e241226a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429693"
---
# <a name="mapi-return-value-documentation"></a>Документация о возврате значения MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Эталонные записи в этом справочном документе только те возвращающие значения, которые требуют определенной обработки в клиентских приложениях. Значения возврата, которые указывают общие условия ошибки и могут быть выявимы путем проверки на сбой, не включаются в документацию. Например, многие методы интерфейса могут MAPI_E_INVALID_PARAMETER, если звонячий указывает неправильное значение для параметра ввода. Это значение обычно не указано в наборе ожидаемых значений возврата, так как нет необходимости искать конкретно MAPI_E_INVALID_PARAMETER и не нужно обрабатывать его по-другому от любой другой ошибки. С другой стороны, некоторые поставщики услуг не поддерживают уведомление о событиях и возвращают MAPI_E_NO_SUPPORT методу Advise, который делают клиенты с помощью **IMAPISession.**  Поскольку клиентам необходимо явно проверить это значение и предоставить код для обработки условия, которое оно представляет, если оно произойдет, MAPI_E_NO_SUPPORT включено в список возвращающихся значений [для IMAPISession::Advise](imapisession-advise.md).
  
В следующей таблице описываются значения ошибок, которые обычно возвращаются из методов и функций и требуют явной обработки со стороны клиента или поставщика услуг. Эти значения подпадают под четыре категории: значения, которые указывают недействительные входные данные, значения, которые указывают на проблемы с ресурсами, значения, которые указывают на несовместимость набора символов, и значения, которые указывают на сбой неизвестного происхождения.
  
|**Возвращаемое значение**|**Описание**|
|:-----|:-----|
|MAPI_E_INVALID_PARAMETER  <br/> |Один или несколько параметров, переданных в метод или функции, были не допустимы.  <br/> |
|MAPI_E_UNKNOWN_FLAGS  <br/> |Одно или несколько значений для параметра флагов были не допустимы.  <br/> |
|MAPI_E_DISK_ERROR  <br/> |Возникла проблема со записью или чтением с диска.  <br/> |
|MAPI_E_NOT_ENOUGH_DISK  <br/> |Для завершения операции было доступно недостаточно дискового пространства.  <br/> |
|MAPI_E_NOT_ENOUGH_MEMORY  <br/> |Для завершения операции было доступно недостаточно памяти.  <br/> |
|MAPI_E_NOT_ENOUGH_RESOURCES  <br/> |Для завершения операции было недостаточно ресурсов системы.  <br/> |
|MAPI_E_BAD_CHARWIDTH  <br/> |Несовместимость существует в наборах символов, поддерживаемых вызываемой и реализацией.  <br/> |
|MAPI_E_CALL_FAILED  <br/> |Произошла ошибка неожиданного или неизвестного происхождения.  <br/> |
   
Константы, которые представляют значения возврата MAPI, перечислены в MAPICODE. Файл заглавной папки H. Некоторые из констант на карте Win32 ошибок; сопоставление этих констант с числными значениями можно найти в заглавном файле Win32 WINERROR.H.
  
Ошибки в отношении недействительных данных, переданных вызываемой стороной, можно определить с помощью функций API проверки параметров, предоставляемых MAPI, или набора макрос. 
  
Несовместимость набора символов возникает при любой из следующих ситуаций:
  
- Клиент или поставщик услуг задает флаг MAPI_UNICODE для вызова метода или функции, и реализация не поддерживает Юникод. Настройка MAPI_UNICODE указывает на то, что строки символов, переданные в качестве ввода, являются строками Юникод и что строки символов передаются обратно по мере вывода, как ожидается, будут строками Юникод.
    
- Клиент или поставщик услуг не MAPI_UNICODE флаг метода или функции, и реализация поддерживает только Юникод.
    


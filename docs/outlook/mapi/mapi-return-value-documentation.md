---
title: Документация о возвращаемом значении MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c32ee53c-b063-4a00-a6bf-75ce5e07f56a
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5bbafe9fda479d951bb20175ab904dc6e241226a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429693"
---
# <a name="mapi-return-value-documentation"></a>Документация о возвращаемом значении MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Эталонные записи в этом справочном документе возвращают только те значения, которые требуют обработки клиентских приложений. Возвращаемые значения, которые указывают распространенные ошибки и могут быть выявимы при проверке на сбои, не включаются в документацию. Например, многие методы интерфейса могут возвращать MAPI_E_INVALID_PARAMETER, если звонячий указывает неправильное значение для входного параметра. Как правило, это значение не указано в наборе ожидаемых возвращаемых значений, так как нет необходимости искать конкретное MAPI_E_INVALID_PARAMETER и не нужно обрабатывать его по-разному от других ошибок. С другой стороны, некоторые поставщики услуг не поддерживают уведомление о событиях и MAPI_E_NO_SUPPORT **методу Advise,** выполненного клиентами через **IMAPISession.** Так как клиентам необходимо явным образом проверить это значение и предоставить код для обработки условия, которое оно представляет, MAPI_E_NO_SUPPORT включен в список возвращаемого значения [для IMAPISession::Advise](imapisession-advise.md).
  
В следующей таблице описываются значения ошибок, которые обычно возвращаются из методов и функций и требуют явной обработки со стороны клиента или поставщика услуг. Эти значения подпадают под четыре категории: значения, которые указывают недопустимые входные данные, значения, которые указывают на проблемы с ресурсом, значения, которые указывают на несовместимость набора символов, и значения, которые указывают на сбой неизвестного источника.
  
|**Возвращаемое значение**|**Описание**|
|:-----|:-----|
|MAPI_E_INVALID_PARAMETER  <br/> |Один или несколько параметров, переданных в метод или функции, были не допустимы.  <br/> |
|MAPI_E_UNKNOWN_FLAGS  <br/> |Одно или несколько значений для параметра flags были не допустимы.  <br/> |
|MAPI_E_DISK_ERROR  <br/> |Возникла проблема с записью на диск или чтением с него.  <br/> |
|MAPI_E_NOT_ENOUGH_DISK  <br/> |Недостаточно места на диске для завершения операции.  <br/> |
|MAPI_E_NOT_ENOUGH_MEMORY  <br/> |Недостаточно памяти для завершения операции.  <br/> |
|MAPI_E_NOT_ENOUGH_RESOURCES  <br/> |Недостаточно системных ресурсов для выполнения операции.  <br/> |
|MAPI_E_BAD_CHARWIDTH  <br/> |Несовместимость существует в наборах символов, поддерживаемых вызываемой и реализацией.  <br/> |
|MAPI_E_CALL_FAILED  <br/> |Произошла ошибка непредвиденного или неизвестного источника.  <br/> |
   
Константы, которые представляют возвращаемые значения MAPI, перечислены в MAPICODE. Файл h-загона. Некоторые константы со картой ошибок Win32; Сопоставление этих констант с числами можно найти в файле загона Win32 WINERROR.H.
  
Ошибки, касающиеся недопустимых данных, переданных вызываемой стороной, можно определить с помощью функций API проверки параметров, предоставляемых MAPI, или с помощью набора макросов. 
  
Несовместимость набора символов возникает в любой из следующих ситуаций:
  
- Клиент или поставщик услуг устанавливает флаг MAPI_UNICODE для вызова метода или функции, и реализация не поддерживает Юникод. Настройка MAPI_UNICODE указывает, что строки символов, переданные в качестве входных данных, являются строками Юникода, а строки символов, переданные в качестве выходных данных, должны быть строками Юникода.
    
- Клиент или поставщик услуг не устанавливают флаг MAPI_UNICODE для вызова метода или функции, и реализация поддерживает только Юникод.
    


---
title: MAPILogonEx
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPILogonEx
api_type:
- HeaderDef
ms.assetid: 98091e5b-1abd-4814-9c7a-583b420ee11d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: db76dfec27100a22785082580da70ecc2c10fc45
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22579986"
---
# <a name="mapilogonex"></a>MAPILogonEx

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Журналы клиентского приложения на сеанс с системой обмена сообщениями. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapix.h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения  <br/> |
   
```cpp
HRESULT MAPILogonEx(
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  LPSTR lpszPassword,
  FLAGS flFlags,
  LPMAPISESSION FAR * lppSession
);
```

## <a name="parameters"></a>Параметры

 _ulUIParam_
  
> [in] Дескриптор окна, к которому модальное диалоговое окно входа в систему. Если появится диалоговое окно не во время вызова, параметр _ulUIParam_ игнорируется. Этот параметр может быть равно нулю. 
    
 _lpszProfileName_
  
> [in] Указатель на строку, содержащую имя профиля, который будет использоваться при входе в систему. Эта строка ограничена 64 символов.
    
 _lpszPassword_
  
> [in] Указатель на строку, содержащую пароль профиля. Параметр _lpszPassword_ должен иметь значение NULL. 
    
 _flFlags_
  
> [in] Битовая маска флаги, используемые для управления, как выполнять вход в систему. Можно задать следующие флажки:
    
MAPI_ALLOW_OTHERS 
  
> Совместный сеанс должно быть возвращено, что позволяет более поздней версии клиентов для получения сеанса не вводя учетные данные любого пользователя. 
    
MAPI_BG_SESSION
  
> Вход в сеанс и выполнять любые операции в фоновом режиме. В целом если клиент планирует обработки в фоновом потоке, или в отдельном процессе, таким образом, чтобы выделялся основной поток, его вызова с флагом MAPI_BG_SESSION. Клиентское приложение, например механизм индексирования или открытие личных папок файлов (PST) для фона тип доступа приведены некоторые примеры того, где можно использовать MAPI_BG_SESSION. MAPILogonEx.
    
MAPI_EXPLICIT_PROFILE 
  
> Профиль по умолчанию не должен использоваться и должны должен предоставить в профиль пользователя. 
    
MAPI_EXTENDED 
  
> Выполните вход с помощью расширенных возможностей. Этот флаг всегда должно иметь значение.
    
MAPI_FORCE_DOWNLOAD 
  
> Предпринята попытка следует загрузить все сообщения пользователя перед возвращением. Если флаг MAPI_FORCE_DOWNLOAD не установлен, сообщения можно загрузить в фоновом режиме после обращения к MAPILogonEx. 
    
MAPI_LOGON_UI 
  
> Диалоговое окно должно отображаться для запроса пользователя для входа в систему сведения при необходимости. Когда флаг MAPI_LOGON_UI не установлен, вызывающего клиента не отображает диалоговое окно входа в систему и возвращает ошибку, если пользователь не вошел в систему.
    
MAPI_NEW_SESSION 
  
> Предпринята попытка следует создать новый сеанс MAPI вместо приобретение совместный сеанс. Если флаг MAPI_NEW_SESSION не установлен, MAPILogonEx использует существующий совместный сеанс даже в том случае, если параметр _lpszprofileName_ не может быть NULL. 
    
MAPI_NO_MAIL 
  
> MAPI не сообщает о диспетчер очереди MAPI существования сеанса. Результатом является, что сообщения не может быть отправку и получение в сеансе, за исключением того, через тесно связанных хранения и передачи пары. Вызывающего клиента задает этот флаг, если она используется в качестве агента, если необходимо выполнить работу конфигурации, или если клиент просматривает хранилищ доступных сообщений. 
    
MAPI_NT_SERVICE 
  
> Звонящий выполняется как служба Windows. Вызывающие объекты, которые не выполняется как служба Windows не следует устанавливать этот флаг; вызывающие объекты, на которых выполняется как служба необходимо установить этот флаг. 
    
MAPI_SERVICE_UI_ALWAYS 
  
> MAPILogonEx должны отображать диалоговое окно настройки для каждой службы сообщений в профиле. Диалоговые окна отображаются после решила профиля, но до любых сообщений о службе вошел в систему. MAPI обычное диалоговое окно для входа в систему также содержит флажок, для которого запрашивается той же операции. 
    
MAPI_TIMEOUT_SHORT 
  
> Вход в систему не выполняется, если заблокировано на несколько секунд. 
    
MAPI_UNICODE 
  
> Строки переданное хранятся в формате Юникод. Если флаг MAPI_UNICODE не установлен, они в формате ANSI. 
    
MAPI_USE_DEFAULT 
  
> Подсистема обмена сообщениями необходимо заменить имя профиля по умолчанию для параметра _lpszProfileName_ . Флаг MAPI_EXPLICIT_PROFILE используется только _lpszProfileName_ имеет значение NULL или пуст. 
    
 _lppSession_
  
> [out] Указатель на указатель на интерфейс сеанса MAPI.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вход в систему успешно завершен.
    
MAPI_E_LOGON_FAILED 
  
> Вход в систему не удалось выполнить, так как один или несколько параметров, чтобы MAPILogonEx недопустимы или из-за слишком большого числа сеансов open уже.
    
MAPI_E_TIMEOUT 
  
> MAPI выполняет сериализацию всех имен входа через семафора. Возвращается, если был установлен флажок MAPI_TIMEOUT_SHORT и другой поток проведенных семафора. 
    
MAPI_E_USER_CANCEL 
  
> Пользователь отменил операцию, как правило, нажмите кнопку **Отмена** в диалоговом окне. 
    
## <a name="remarks"></a>Замечания

Клиентские приложения MAPI вызовите функцию MAPILogonEx войти в сеанс с системой обмена сообщениями. Все строки, переданного и возвращаются в и из вызовов MAPI с символом null и должно быть указано в текущий набор символов или кодовая страница вызывающего клиента или поставщика операционной системы.
  
Параметр _lpszProfileName_ игнорируется, если имеется существующий предыдущего сеанса, который называется MapiLogonEx с установленным флагом MAPI_ALLOW_OTHERS и флаг MAPI_NEW_SESSION не установлен. Если параметр _lpszProfileName_ имеет значение NULL или указывает на пустую строку, а параметр _flFlags_ включает флаг MAPI_LOGON_UI, функция MAPILogonEx создает диалоговое окно входа в систему с пустым полем для имени профиля. 
  
При входе в определенный профиль, клиент должен передать флаг MAPI_NEW_SESSION в MAPILogonEx в дополнение к имени профиля. В противном случае — если другого клиентского соединения, войдите в систему с MAPI_ALLOW_OTHERS сеанс клиента будет войти в сеанс с общим доступом вместо к профилю запрошено. 
  
Флаг MAPI_EXPLICIT_PROFILE не привести к имени профиля по умолчанию для использования при _lpszProfileName_ имеет значение NULL или пустая, если не указан также флаг MAPI_USE_DEFAULT. 
  
Флаг MAPI_NO_MAIL имеет несколько эффекты, которые не используется диспетчер очереди MAPI привести к следующему:
  
- Сообщения не могут отправленных или диспетчер очереди MAPI, предоставляемых во время данного сеанса. Только тесно связанных поставщиков хранилища и транспорта можно отправлять и доставлять сообщения. 
    
- Сервер на основе хранилища по-прежнему могут отправить или доставлять сообщения. 
    
- Сообщения, отправленные или доставки с сервера на основе хранилища не обрабатываются все поставщики обработчик. 
    
- Параметры каждого сообщения и каждого получателя для транспортировки недоступны. 
    
- В таблице состояния не содержит записи для поставщиков транспорта и функциональные возможности транспорта зависит от состояния объекты (например, конфигурации) недоступен. 
    
- Строка очереди сообщений в таблице состояния содержит значение STATUS_FAILURE. 
    
- Разрешены пополняется очередь входов в систему, но эти входы в систему, не приводят к предыдущей входа на получение обновлений состояния объекта. 
    
Службы всегда должны войти в систему с использованием флага MAPI_NO_MAIL. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|MAPIObjects.cpp  <br/> |CMapiObjects::MAPILogonEx  <br/> |Mfcmapi (en) использует метод MAPILogonEx войдите в систему MAPI.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md)
  
[IMAPISession::OpenMsgStore](imapisession-openmsgstore.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: IMAPITableSeekRow
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SeekRow
api_type:
- COM
ms.assetid: 93ac63ae-f254-45e1-a9b1-347d69d2ed9f
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: fbc990a8c962883aa07987b200d1d2fd55434f93
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413047"
---
# <a name="imapitableseekrow"></a>IMAPITable::SeekRow

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Перемещает курсор на определенную позицию в таблице.
  
```cpp
HRESULT SeekRow(
BOOKMARK bkOrigin,
LONG lRowCount,
LONG FAR * lplRowsSought
);
```

## <a name="parameters"></a>Параметры

 _bkOrigin_
  
> [in] Закладка, определяя начальное положение операции поиска. Закладку можно создать с помощью метода [IMAPITable::CreateBookmark](imapitable-createbookmark.md) или передать одно из следующих предварительно заранее задаваемых значений. 
    
BOOKMARK_BEGINNING 
  
> Запускает операцию поиска с начала таблицы. 
    
BOOKMARK_CURRENT 
  
> Запускает операцию поиска из строки в таблице, в которой расположен курсор. 
    
BOOKMARK_END 
  
> Запускает операцию поиска из конца таблицы. 
    
 _lRowCount_
  
> [in] Подписанное число строк для перемещения, начиная с закладки, заданной _параметром bkOrigin._ 
    
 _lplRowsSought_
  
> [out] Если  _lRowCount_ — это допустимый указатель на входе,  _lplRowsS processed_ указывает на количество строк, обработанных в операции поиска, знак которого указывает направление поиска, вперед или назад. Если  _lRowCount_ имеет отрицательный результат,  _lplRowsSа —_ отрицательное. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция поиска прошла успешно.
    
MAPI_E_BUSY 
  
> В настоящее время идет другая операция, которая не позволяет начать операцию поиска строк. Либо операция должна быть завершена, либо она должна быть остановлена.
    
MAPI_E_INVALID_BOOKMARK 
  
> Закладка, указанная в параметре  _bkOrigin,_ недействительна, так как она была удалена или находится за пределами последней запрашиваемой строки. 
    
MAPI_W_POSITION_CHANGED 
  
> Вызов был успешным, но закладка, указанная в параметре  _bkOrigin,_ больше не задана в той же строке, что и при последнем вызове. Если закладка не использовалась, она больше не находится в том же положении, что и при ее создания. При возврате этого предупреждения вызов должен быть обработан как успешный. Чтобы проверить это предупреждение, используйте **макрос HR_FAILED.** Дополнительные сведения см. в [теме "Использование макроса для обработки ошибок".](using-macros-for-error-handling.md)
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::SeekRow** BOOKMARK_CURRENT положение курсора. Параметр  _lRowCount_ указывает количество строк, которые перемещает курсор, и направление движения. 
  
Если итоговая позиция находится за последней строкой таблицы, курсор находится после последней строки. Если итоговая позиция находится перед первой строкой таблицы, курсор находится в начале первой строки. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если строка, на которую указывает  _bkOrigin,_ больше не существует в таблице и вы не можете установить новое положение для закладки, MAPI_E_INVALID_BOOKMARK. Если строка, на которую указывает  _bkOrigin,_ больше не существует и вы можете установить новую позицию для закладки, MAPI_W_POSITION_CHANGED. 
  
По-прежнему можно использовать закладку, указываемую на свернутую строку в представлении таблицы. Если звонячая пытается переместить курсор в такую закладку, переместим курсор в следующую видимую строку и MAPI_W_POSITION_CHANGED. 
  
Можно переместить закладки для позиций, свернутые из представления, во время использования или во время свернутой строки. Если закладка перемещается во время свернутой строки, оохраняемую закладки, которая указывает, была ли закладка перемещена с момента последнего использования или, если она никогда не использовалась, с момента ее создания.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы указать обратное перемещение **для SeekRow,** передав отрицательное значение _в lRowCount._ Чтобы найти в начале таблицы, передав ноль  _в lRowCount_ и значение BOOKMARK_BEGINNING  _в bkOrigin_. 
  
Если в таблице много строк, операция **SeekRow** может быть медленной. Производительность также может быть затронута, если требуется вернуть количество строк в содержимом параметра _lplRowsS affected._ 
  
 **SeekRow** возвращает количество строк, в которые фактически был велись поиск ( положительные или отрицательные) в переменной, на которая указывает _lRowCount._ В обычной операции он должен возвращать то же значение  _для lplRowsSов,_ что и для  _lRowCount,_ если поиск не достиг начала или конца таблицы. 
  
Не устанавливаем  _для lRowCount_ число больше 50. Чтобы найти больше строк, используйте метод [IMAPITable::SeekRowApprox.](imapitable-seekrowapprox.md) 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|MAPIProcessor.cpp  <br/> |CMAPIProcessor::P rocessMailboxTable  <br/> |MFCMAPI использует метод **IMAPITable::SeekRow** для поиска начала таблицы перед обработкой.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[IMAPITable::FindRow](imapitable-findrow.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::SeekRowApprox](imapitable-seekrowapprox.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


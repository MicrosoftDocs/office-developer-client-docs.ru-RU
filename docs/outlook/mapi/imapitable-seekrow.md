---
title: IMAPITableSeekRow
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SeekRow
api_type:
- COM
ms.assetid: 93ac63ae-f254-45e1-a9b1-347d69d2ed9f
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: fbc990a8c962883aa07987b200d1d2fd55434f93
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413047"
---
# <a name="imapitableseekrow"></a>IMAPITable::SeekRow

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Перемещает курсор в определенное положение в таблице.
  
```cpp
HRESULT SeekRow(
BOOKMARK bkOrigin,
LONG lRowCount,
LONG FAR * lplRowsSought
);
```

## <a name="parameters"></a>Parameters

 _bkOrigin_
  
> [in] Закладки, определяющие исходное положение для операции поиска. Закладки можно создать с помощью [метода IMAPITable::CreateBookmark](imapitable-createbookmark.md) или передать одно из следующих предопределяемых значений. 
    
BOOKMARK_BEGINNING 
  
> Начинает операцию поиска с начала таблицы. 
    
BOOKMARK_CURRENT 
  
> Запускает операцию поиска из строки в таблице, где расположен курсор. 
    
BOOKMARK_END 
  
> Запускает операцию поиска с конца таблицы. 
    
 _lRowCount_
  
> [in] Подписанный подсчет числа строк для перемещения, начиная с закладки, выделенной _параметром bkOrigin._ 
    
 _lplRowsSought_
  
> [вышел] Если  _lRowCount_ является допустимым указателем ввода,  _lplRowsSought_ указывает на количество строк, обработанных в операции поиска, знак которого указывает направление поиска, вперед или назад. Если  _lRowCount_ является отрицательным,  _то lplRowsSought —_ отрицательным. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция поиска прошла успешно.
    
MAPI_E_BUSY 
  
> В настоящее время продолжается другая операция, которая не позволяет начать операцию поиска строки. Либо операция должна быть разрешена к завершению, либо она должна быть остановлена.
    
MAPI_E_INVALID_BOOKMARK 
  
> Закладки, указанные в  _параметре bkOrigin,_ недействительны, так как она была удалена или находится за пределами последней строки, запрашиваемой. 
    
MAPI_W_POSITION_CHANGED 
  
> Вызов удался, но закладки, указанные в параметре  _bkOrigin,_ больше не заданы в том же ряду, что и в последний раз. Если закладка не была использована, она больше не находится в том же положении, что и при ее создания. Когда это предупреждение возвращается, вызов должен быть обработан как успешный. Чтобы проверить это предупреждение, используйте **HR_FAILED** макрос. Дополнительные сведения см. в [дополнительных сведениях Об использовании макроса для обработки ошибок.](using-macros-for-error-handling.md)
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::SeekRow** устанавливает новое BOOKMARK_CURRENT для курсора. Параметр  _lRowCount_ указывает количество строк, которые перемещает курсор, и направление движения. 
  
Если итоговая позиция находится за последней строкой таблицы, курсор находится после последней строки. Если итоговая позиция находится перед первым ряду таблицы, курсор находится в начале первого ряда. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если строка, на которую указывает  _bkOrigin,_ больше не существует в таблице и вы не можете установить новую позицию для закладки, MAPI_E_INVALID_BOOKMARK. Если строка, на которую указывает  _bkOrigin,_ больше не существует и можно установить новую позицию для закладки, верни MAPI_W_POSITION_CHANGED. 
  
Закладки, указывающие на строку, которая рухнула из представления таблицы, по-прежнему можно использовать. Если вызыватель пытается переместить курсор в такую закладку, переместить курсор в следующую видимую строку и MAPI_W_POSITION_CHANGED. 
  
Вы можете переместить закладки для позиций, схвастимые из виду, либо во время использования, либо во время обрушения строки. Если закладки перемещаются при обрушении строки, держите немного в закладке, которая указывает, переместилась ли закладка с момента последнего использования или, если она никогда не использовалась, с момента ее создания.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы указать обратный ход **для SeekRow,** передай отрицательное значение _в lRowCount._ Чтобы найти в начале таблицы, передай ноль  _в lRowCount_ и значение BOOKMARK_BEGINNING  _в bkOrigin_. 
  
Если в таблице много строк, операция **SeekRow** может быть медленной. Производительность также может быть затронута, если требуется вернуть количество строк в содержимом _параметра lplRowsSought._ 
  
 **SeekRow** возвращает количество строк, которые на самом деле искали в переменной  _lRowCount,_ положительное или отрицательное. В обычной операции оно должно возвращать то же значение  _для lplRowsSought,_ что и для  _lRowCount,_ если поиск не достиг начала или конца таблицы. 
  
Не установите  _lRowCount_ на число больше 50. Чтобы найти больше строк, используйте метод [IMAPITable::SeekRowApprox.](imapitable-seekrowapprox.md) 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|MAPIProcessor.cpp  <br/> |CMAPIProcessor::P rocessMailboxTable  <br/> |MFCMAPI использует **метод IMAPITable::SeekRow** для определения начала таблицы перед обработкой.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[IMAPITable::FindRow](imapitable-findrow.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::SeekRowApprox](imapitable-seekrowapprox.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


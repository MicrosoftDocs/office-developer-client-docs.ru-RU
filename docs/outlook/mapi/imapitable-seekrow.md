---
title: имапитаблесикров
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SeekRow
api_type:
- COM
ms.assetid: 93ac63ae-f254-45e1-a9b1-347d69d2ed9f
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: fbc990a8c962883aa07987b200d1d2fd55434f93
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413047"
---
# <a name="imapitableseekrow"></a>IMAPITable::SeekRow

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Перемещает курсор к определенному положению в таблице.
  
```cpp
HRESULT SeekRow(
BOOKMARK bkOrigin,
LONG lRowCount,
LONG FAR * lplRowsSought
);
```

## <a name="parameters"></a>Параметры

 _бкоригин_
  
> возврата Закладка, указывающая начальную позицию для операции поиска. Можно создать закладку с помощью метода [IMAPITable:: креатебукмарк](imapitable-createbookmark.md) или одного из следующих предварительно заданных значений. 
    
BOOKMARK_BEGINNING 
  
> Начинает операцию поиска с начала таблицы. 
    
BOOKMARK_CURRENT 
  
> Начинает операцию поиска из строки в таблице, в которой находится курсор. 
    
BOOKMARK_END 
  
> Начинает операцию поиска с конца таблицы. 
    
 _лровкаунт_
  
> возврата Число подписанных строк, которые необходимо переместить, начиная с закладки, указанной параметром _бкоригин_ . 
    
 _лплровссаугхт_
  
> вышли Если _лровкаунт_ является допустимым указателем на входе, _лплровссаугхт_ указывает на количество строк, обработанных в операции поиска, знак, указывающий направление поиска, вперед или назад. Если _лровкаунт_ отрицательно, то _лплровссаугхт_ является отрицательным. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция поиска выполнена успешно.
    
MAPI_E_BUSY 
  
> Выполняется другая операция, которая не позволяет запустить операцию поиска строк. Выполнение выполняемой операции должно быть разрешено или остановлено.
    
MAPI_E_INVALID_BOOKMARK 
  
> Закладка, указанная в параметре _бкоригин_ , является недопустимой, так как она была удалена или находится за пределами последней запрошенной строки. 
    
MAPI_W_POSITION_CHANGED 
  
> Вызов выполнен успешно, но закладка, указанная в параметре _бкоригин_ , больше не задается в той же строке, что и при ее последнем использовании. Если закладка не использовалась, она больше не находится в той же позиции, что и при ее создании. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **HR_FAILED** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable:: сикров** устанавливает новое положение BOOKMARK_CURRENT курсора. Параметр _лровкаунт_ указывает количество строк, на которые курсор перемещается и направление движения. 
  
Если полученная позиция находится за пределами последней строки таблицы, курсор помещается после последней строки. Если полученная позиция находится перед первой строкой таблицы, курсор помещается в начало первой строки. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если строка, на которую указывает _бкоригин_ , больше не существует в таблице, и вы не можете установить новую позицию для закладки, возвращайте MAPI_E_INVALID_BOOKMARK. Если строка, на которую указывает _бкоригин_ , больше не существует, и вы можете задать новую позицию для закладки, возвращайте MAPI_W_POSITION_CHANGED. 
  
По-прежнему можно использовать закладку, указывающую на строку, свернутую в представлении таблицы. Если вызывающий объект пытается переместить курсор на такую закладку, переместите курсор на следующую видимую строку и возвратите MAPI_W_POSITION_CHANGED. 
  
Можно переместить закладки для элементов, свернутых в представлении, в момент использования или во время свертывания строки. Если закладка перемещается в то время, когда строка свернута, сохраните бит в закладку, которая указывает на то, была ли эта закладка перемещена с момента ее последнего использования, или, если она никогда не использовалась, с момента ее создания.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы указать обратное перемещение для **сикров**, передайте отрицательное значение в _лровкаунт_. Чтобы выполнить поиск в начале таблицы, в _лровкаунт_ передается ноль и значение BOOKMARK_BEGINNING в _бкоригин_. 
  
Если в таблице много строк, операция **сикров** может быть медленной. Кроме того, если необходимо вернуть количество строк в содержимом параметра _лплровссаугхт_ , это может повлиять на производительность. 
  
 **Сикров** возвращает количество строк, на которые фактически выполнялось Поиск, положительное или отрицательное, в переменной, на которую указывает _лровкаунт_. В обычной операции она должна возвращать одно и то же значение для _лплровссаугхт_ , как было передано в _лровкаунт_, если поиск не достиг начала или конца таблицы. 
  
Не присвойте параметру _лровкаунт_ значение больше 50. Чтобы выполнить поиск по большему количеству строк, используйте метод [IMAPITable:: сикроваппрокс](imapitable-seekrowapprox.md) . 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мапипроцессор. cpp  <br/> |Кмапипроцессор::P Роцессмаилбокстабле  <br/> |MFCMAPI использует метод **IMAPITable:: сикров** для обнаружения начала таблицы перед обработкой.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[IMAPITable::FindRow](imapitable-findrow.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::SeekRowApprox](imapitable-seekrowapprox.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: Реализация объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b1ee2533-8077-4976-846b-d42d148bf8c6
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c0d67d10d54591de926724cbf594a44f17e9ea14
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310173"
---
# <a name="implementing-mapi-objects"></a>Реализация объектов MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Объекты MAPI можно реализовать с помощью классов C++ или структур данных C в зависимости от языка и набора API, используемого клиентом или поставщиком услуг. Поставщики услуг можно писать в C или C++ с помощью интерфейса поставщика службы MAPI; клиентские приложения также могут использовать C или C++. Если это возможно, клиенты и поставщики услуг, использующие объектно ориентированный интерфейс программирования, должны использовать C++. 
  
Язык C++ предпочтительнее, так как MAPI является объектно-ориентированной технологией, а C++ в объектно-ориентированной разработке. Полученный код проще и упрощает обслуживание. Документация по MAPI записывается преимущественно разработчикам C++; все описания синтаксиса для методов интерфейса MAPI в этой ссылке представлены в C++.
  
Разработчики могут использовать Microsoft Visual Studio и сторонние средства разработки для разработки решений, вызывающих MAPI. Обратите внимание, что разработчики должны использовать C или неуправляемый C++, но не управляемые C++ для написания решений MAPI.
  
Когда объект MAPI реализован, клиент или поставщик услуг создает код для всех методов интерфейса, кода для всех частных методов, характерных для реализации, и кода для поддержки закрытых элементов данных для поддержания сведений о состоянии. Код методов интерфейса должен соответствовать спецификациям, опубликованным MAPI, в котором ожидается поведение Document. 
  
В файле заголовка MAPIDEFS. h и файлах заголовков OLE существует множество макросов, которые могут использоваться клиентами и поставщиками служб на любом языке, чтобы помочь им в определениях объектов MAPI. Например, существует макрос, определяющий методы каждого интерфейса MAPI. Макрос, определяющий методы интерфейса [IUnknown](https://msdn.microsoft.com/library/ms680509%28v=VS.85%29.aspx) , отображается в MAPIDEFS. h следующим образом: 
  
```cpp
#define MAPI_IUNKNOWN_METHODS(IPURE)          \
    MAPIMETHOD(QueryInterface)                \
        (THIS_ REFIID riid, LPVOID FAR * ppvObj) IPURE;    \
    MAPIMETHOD_(ULONG,AddRef)  (THIS) IPURE;               \
    MAPIMETHOD_(ULONG,Release) (THIS) IPURE;   \
 
```

## <a name="see-also"></a>См. также



[Общие сведения об объекте и интерфейсе MAPI](mapi-object-and-interface-overview.md)


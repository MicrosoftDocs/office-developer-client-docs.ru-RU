---
title: Реализация объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b1ee2533-8077-4976-846b-d42d148bf8c6
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: d65ccec0ab270a59252c8a3ae94bdeca839fa807
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22582366"
---
# <a name="implementing-mapi-objects"></a>Реализация объектов MAPI

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Объекты MAPI можно реализовать с помощью классов C++ или C структуры данных, в зависимости от языка и API Настройка клиента или с помощью поставщика услуг. Поставщиков услуг может быть написан на C или C++ с помощью интерфейса поставщика службы MAPI; клиентские приложения также можно использовать C или C++. Если это возможно клиентов и поставщиков услуг, использующих интерфейс программирования объектно ориентированные следует использовать C++. 
  
C++ является предпочтительным вариантом, потому что MAPI — это технология объектно ориентированные и C++ могут работать легче в объектно ориентированные разработки. Такой код более простой и более простые, что упрощает обслуживание. Документация по MAPI, записывается в основном для разработчиков C++; все описания синтаксиса для методов интерфейса MAPI в этой справке, в C++.
  
Разработчики могут использовать Microsoft Visual Studio и средства сторонних производителей разработки для разработки решений, которые могут вызывать MAPI. Обратите внимание на то, что следует использовать C или C++ неуправляемые разработчиков (en), но не управляемый C++ для записи решений MAPI.
  
При реализации объект MAPI клиента или поставщика создает код для всех методов интерфейса, код для объявления частных методы, которые специфичны для реализации и код для поддержки личных данных участников по обслуживанию сведения о состоянии. Код для методов интерфейса должны соответствовать спецификации издательством MAPI, которые документов поведению. 
  
Существует множество макросов в файл заголовка Mapidefs.h и OLE файлы заголовков, которые клиенты и поставщики услуг на любом языке можно использовать для справки при их определения объектов MAPI. Например такое макрос для определения методов каждого интерфейса MAPI. Макрос для определения методов интерфейс [IUnknown](http://msdn.microsoft.com/en-us/library/ms680509%28v=VS.85%29.aspx) в Mapidefs.h бы выглядел следующим образом: 
  
```cpp
#define MAPI_IUNKNOWN_METHODS(IPURE)          \
    MAPIMETHOD(QueryInterface)                \
        (THIS_ REFIID riid, LPVOID FAR * ppvObj) IPURE;    \
    MAPIMETHOD_(ULONG,AddRef)  (THIS) IPURE;               \
    MAPIMETHOD_(ULONG,Release) (THIS) IPURE;   \
 
```

## <a name="see-also"></a>См. также



[Обзор интерфейса и объект MAPI](mapi-object-and-interface-overview.md)


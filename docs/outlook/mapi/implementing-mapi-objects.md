---
title: Реализация объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b1ee2533-8077-4976-846b-d42d148bf8c6
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c0d67d10d54591de926724cbf594a44f17e9ea14
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310173"
---
# <a name="implementing-mapi-objects"></a>Реализация объектов MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Объекты MAPI можно реализовать с помощью классов C++ или структур данных C в зависимости от языка и набора API, которые использует клиент или поставщик услуг. Поставщики услуг могут быть написаны на C или C++ с помощью интерфейса поставщика служб MAPI; клиентские приложения также могут использовать C или C++. По возможности клиенты и поставщики услуг, которые используют объектно-ориентированный программный интерфейс, должны использовать C++. 
  
C++ является предпочтительным вариантом, так как MAPI является объектно-ориентированной технологией, и C++ предоставляет себя более легко для объектно-ориентированной разработки. В результате код становится проще и проще, что упрощает обслуживание. Документация по MAPI предназначена в основном для разработчиков C++; все описания синтаксиса для методов интерфейса MAPI в этом справочнике находятся на C++.
  
Разработчики могут использовать microsoft Visual Studio и сторонние средства разработки для разработки решений, которые называют MAPI. Обратите внимание, что для написания решений MAPI разработчикам следует использовать C или неугодный C++, но не управляемый C++.
  
При реализации объекта MAPI клиент или поставщик услуг создает код для всех методов интерфейса, код для любых частных методов, которые являются специфическими для реализации, и код для поддержки частных членов данных для поддержки сведений о состоянии. Код методов интерфейса должен следовать спецификациям, опубликованным MAPI, в соответствии с ожидаемым поведением документа. 
  
В файле заголовок Mapidefs.h и файлах заголовок OLE имеется много макроов, которые клиенты и поставщики служб на любом языке могут использовать для определения объектов MAPI. Например, существует макрос для определения методов каждого интерфейса MAPI. Макрос для определения методов интерфейса [IUnknown](https://msdn.microsoft.com/library/ms680509%28v=VS.85%29.aspx) отображается в mapidefs.h следующим образом: 
  
```cpp
#define MAPI_IUNKNOWN_METHODS(IPURE)          \
    MAPIMETHOD(QueryInterface)                \
        (THIS_ REFIID riid, LPVOID FAR * ppvObj) IPURE;    \
    MAPIMETHOD_(ULONG,AddRef)  (THIS) IPURE;               \
    MAPIMETHOD_(ULONG,Release) (THIS) IPURE;   \
 
```

## <a name="see-also"></a>См. также



[Общие сведения об объектах и интерфейсах MAPI](mapi-object-and-interface-overview.md)


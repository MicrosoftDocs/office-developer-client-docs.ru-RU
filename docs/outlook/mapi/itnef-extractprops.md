---
title: Итнефекстрактпропс
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ITnef.ExtractProps
api_type:
- COM
ms.assetid: 9169a5be-21dd-4938-8db3-522bea165c92
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5a01c65bbec061248537558257c66d1a90128b5e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32348652"
---
# <a name="itnefextractprops"></a>ITnef::ExtractProps

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Извлекает свойства из инкапсуляции TNEF. 
  
```cpp
HRESULT ExtractProps(
  ULONG ulFlags,
  LPSPropTagArray lpPropList,
  LPSTnefProblemArray FAR * lpProblems
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> возврата Битовая маска флагов, определяющих способ декодирования свойств. Можно задать следующие флаги:
    
ТНЕФ_ПРОП_ЕКСКЛУДЕ 
  
> Декодирует все свойства, которые не указаны в параметре _лппроплист_ . 
    
ТНЕФ_ПРОП_ИНКЛУДЕ 
  
> Декодирует все свойства, указанные в _лппроплист_.
    
 _Лппроплист_
  
> возврата Указатель на список свойств, которые необходимо включить в операцию декодирования или исключить из нее.
    
 _Лппроблемс_
  
> вышли Указатель на указатель на возвращаемую структуру [стнефпроблемаррай](stnefproblemarray.md) . Структура **стнефпроблемаррай** указывает, какие свойства не кодируются должным образом. Если параметр _лппроблемс_ переДАЕТСЯ значение null, массив проблем свойств не возвращается. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вызов выполнен успешно и вернул ожидаемое значение или значения.
    
МАПИ_Е_КОРРУПТ_ДАТА 
  
> Данные, декодированные в поток, повреждены.
    
## <a name="remarks"></a>Примечания

Поставщики транспорта, поставщики хранилищ сообщений и шлюзы вызывают метод Итнеф:: Екстрактпропс для извлечения свойств из инкапсуляции сообщения или вложения, переданного в функцию [опентнефстреам](opentnefstream.md) , в методе **::** . Поставщик или шлюз вызова может указать список свойств для декодирования. Поставщики и шлюзы также могут использовать **екстрактпропс** для предоставления сведений о специальной обработке вложений. 
  
 **Екстрактпропс** заполняет исходное сообщение, переданное в **опентнефстреам** , с помощью раскодированных свойств. Последующие вызовы **екстрактпропс** вернитесь к сообщению и извлеките новый список свойств. 
  
В отличие от метода [итнеф:: аддпропс](itnef-addprops.md) , который ставит в очередь запрошенные действия до вызова метода **Итнеф:: Finish** , метод **екстрактпропс** декодирует инкапсулированные свойства сразу же после его вызова. По этой причине конечное сообщение для декодирования инкапсуляции должно быть относительно пустым. Существующие свойства в целевом сообщении перезаписываются инкапсулированными свойствами. 
  
 **Екстрактпропс** поддерживается только для объектов, открытых с флагом тнеф_декоде для функции **опентнефстреам** или [опентнефстреамекс](opentnefstreamex.md) . 
  
Реализация TNEF сообщает о неполадках кодирования потока TNEF без остановки процесса **екстрактпропс** . Структура [стнефпроблемаррай](stnefproblemarray.md) , возвращаемая в _лппроблемс_ , указывает, какие АТРИБУТЫ TNEF или свойства MAPI, если они есть, не могут быть обработаны. Значение, возвращаемое элементом **SCODE** одной из структур **стнефпроблем** , включенных в **стнефпроблемаррай** , указывает на конкретную проблему. Поставщик или шлюз могут работать в предположении, что все свойства или атрибуты, для которых **екстрактпропс** не возвращает отчет о проблеме, были успешно обработаны. 
  
> [!NOTE]
> Если свойство в блоке инкапсуляции MAPI не может быть обработано и оставляет поток ненадежным во время декодирования потока TNEF, декодирование блока инкапсуляции останавливается и сообщает о проблеме. Массив проблем для этого типа проблемы содержит 0L для члена **улпроптаг** , `attMAPIProps` или `attAttachment` для члена **улаттрибуте** , и мапи_е_унабле_то_комплете для члена **SCODE** . Обратите внимание, что декодирование потока не приостанавливается, просто декодированием блока инкапсуляции MAPI. Декодирование потока продолжается с использованием следующего блока атрибута. 
  
Если поставщик или шлюз не работают с неисправной массивом, он может передавать значение NULL в _лпппроблемс_; в этом случае массив проблем не возвращается. 
  
Значение, возвращаемое в _лппроблемс_ , является допустимым только в том случае, если вызов ВОЗВРАЩАЕТ значение S_OK. Когда возвращается значение S_OK, поставщик или шлюз должны проверить значения, возвращаемые в структуре **стнефпроблемаррай** . Если при вызове возникает ошибка, структура **стнефпроблемаррай** не заполняется, а поставщик или шлюз вызова не должен использовать или освобождать структуру. Если при вызове не возникнет ошибок, поставщик или шлюз вызова выосвобождают память для структуры **стнефпроблемаррай** , вызвав функцию [мапифрибуффер](mapifreebuffer.md) . 
  
## <a name="see-also"></a>См. также



[ITnef::AddProps](itnef-addprops.md)
  
[ITnef::Finish](itnef-finish.md)
  
[ITnef::SetProps](itnef-setprops.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[OpenTnefStream](opentnefstream.md)
  
[OpenTnefStreamEx](opentnefstreamex.md)
  
[STnefProblemArray](stnefproblemarray.md)
  
[ITnef : IUnknown](itnefiunknown.md)


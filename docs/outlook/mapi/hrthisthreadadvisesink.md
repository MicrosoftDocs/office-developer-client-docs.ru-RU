---
title: HrThisThreadAdviseSink
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.HrThisThreadAdviseSink
api_type:
- COM
ms.assetid: 12c07302-472f-4e4f-8087-1bdf0dc09a5a
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0fb867d662064dfe5ff7759dba4b36a4635a2914
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427731"
---
# <a name="hrthisthreadadvisesink"></a>HrThisThreadAdviseSink

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает приемник уведомлений, который упаковывает существующий приемник уведомлений для обеспечения безопасности потоков. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Мапиутил. h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения  <br/> |
   
```cpp
HrThisThreadAdviseSink(
  LPMAPIADVISESINK lpAdviseSink,
  LPMAPIADVISESINK FAR * lppAdviseSink
);
```

## <a name="parameters"></a>Параметры

 _лпадвисесинк_
  
> возврата Указатель на приемник уведомлений, который необходимо обернуть. 
    
 _лппадвисесинк_
  
> вышли Указатель на указатель на новый приемник уведомлений, который создает оболочку для приемника уведомлений, на который указывает параметр _лпадвисесинк_ . 
    
## <a name="return-value"></a>Возвращаемое значение

Нет.
  
## <a name="remarks"></a>Примечания

Цель оболочки — убедиться в том, что уведомление вызывается в том же потоке, который вызвал функцию **хрсиссреададвисесинк** . Эта функция используется для защиты обратных вызовов уведомлений, которые должны выполняться в определенном потоке. 
  
Клиентские приложения должны использовать **хрсиссреададвисесинк** для ограничения времени создания уведомлений, то есть при вызове метода [имапиадвисесинк:: OnNotify](imapiadvisesink-onnotify.md) объекта приемника уведомлений, переданного клиентом в **предыдущем вызове** метода. Если уведомления разрешено создавать произвольным образом, при реализации уведомления клиент может принудительно выполнить многопотоковую операцию, если это не будет уместно. Например, клиент может использовать библиотеку, например одну из библиотек классов Microsoft Foundation, которая не поддерживает многопоточные вызовы. Уведомления в другом потоке затрудняют тестирование и подвержены ошибкам. 
  
 **Хрсиссреададвисесинк** гарантирует, что вызовы **OnNotify** происходят только в указанное время: 
  
- Во время обработки вызова любого метода MAPI. 
    
- Во время обработки сообщений Windows. 
    
При реализации **хрсиссреададвисесинк** любые вызовы нового метода **OnNotify** приемника уведомлений в любом потоке приводят к выполнению исходного метода уведомления в потоке, в котором был вызван **хрсиссреададвисесинк** . 
  
Дополнительные сведения об уведомлениях и приемниках уведомлений содержатся [в статье уведомление о событии в MAPI](event-notification-in-mapi.md) и [Реализация объекта приемника](implementing-an-advise-sink-object.md)уведомлений. 
  


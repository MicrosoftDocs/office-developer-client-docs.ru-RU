---
title: Использование объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e342c1bd-8bee-4b02-a93f-e3941f4716c1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: d732efe5276f4756f43b4aca46e1c33d6f103844
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329681"
---
# <a name="using-mapi-objects"></a>Использование объектов MAPI

**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиенты и поставщики услуг используют объекты MAPI, вызывая методы в реализации интерфейса. Это единственный способ использования объектов MAPI; методы, реализуемые объектом вне интерфейса MAPI, недоступны для общего реализации. Так как все интерфейсы объекта связаны по наследству, пользователь объекта может вызывать методы в базовом интерфейсе или одном из унаследованных интерфейсов, как если бы они принадлежат к одному интерфейсу. 
  
Если пользователь объекта хочет сделать вызов методу и этот объект реализует несколько интерфейсов, связанных с наследованием, пользователю не нужно знать, к каков интерфейсу относится метод. Пользователь может вызвать любой из методов на любом из интерфейсов с одним указателем на объект. Например, на следующем рисунке показано, как клиентские приложения используют объект папки. Объекты папок реализуют интерфейс [IMAPIFolder : IMAPIContainer,](imapifolderimapicontainer.md) который наследуется от [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) косвенно через [IMAPIProp: IUnknown](imapipropiunknown.md) и [IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md). Клиент может вызвать один из методов **IMAPIProp,** таких как [IMAPIProp::GetProps,](imapiprop-getprops.md)и один из методов [IMAPIFolder: IMAPIContainer,](imapifolderimapicontainer.md) таких как [IMAPIFolder::CreateMessage,](imapifolder-createmessage.md)таким же образом с тем же указателем объекта. Клиент не знает о том, что эти вызовы принадлежат разным интерфейсам или на них влияет.
  
**Использование объекта папки клиентом**
  
![Клиентская использование объекта папки Клиент](media/amapi_40.gif "использует объект папки")
  
Эти вызовы переводятся в код по-разному в зависимости от того, записан ли клиент, который делает вызовы, на C или C++. Перед любым вызовом метода необходимо получить указатель на реализацию интерфейса. Указатели интерфейса можно получить следующим образом:
  
- Вызов метода на другом объекте.
    
- Вызов функции API.
    
- Вызов [метода IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) на целевом объекте. 
    
MAPI предоставляет несколько методов и функций API, возвращающих указатели для реализации интерфейса. Например, клиенты могут вызвать [метод IMAPISession::GetMsgStoresTable,](imapisession-getmsgstorestable.md) чтобы получить указатель на объект таблицы, который предоставляет доступ к данным поставщика хранения сообщений через интерфейс [IMAPITable: IUnknown.](imapitableiunknown.md) Поставщики услуг могут вызвать функцию API [CreateTable](createtable.md) для получения указателя на объект данных таблицы. Если нет функции или метода, а клиенты или поставщики услуг уже имеют указатель на объект, они могут вызвать метод **QueryInterface** объекта, чтобы получить указатель на другой из реализации интерфейса объекта. 
  
## <a name="see-also"></a>См. также

- [Обзор объектов и интерфейсов MAPI](mapi-object-and-interface-overview.md)


---
title: Использование объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e342c1bd-8bee-4b02-a93f-e3941f4716c1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: d732efe5276f4756f43b4aca46e1c33d6f103844
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329681"
---
# <a name="using-mapi-objects"></a>Использование объектов MAPI

**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиенты и поставщики услуг используют объекты MAPI, вызывая методы в их реализациях интерфейса. Это единственный способ, с помощью которого можно использовать объекты MAPI; методы, реализованные объектом вне интерфейса MAPI, недоступны для общего доступа. Так как все интерфейсы объекта связаны через наследование, пользователь объекта может вызывать методы либо в базовом интерфейсе, либо на одном из наследуемых интерфейсов, как если бы они принадлежали к одному и тому же интерфейсу. 
  
Когда пользователь объекта хочет совершить вызов метода, и этот объект реализует несколько интерфейсов, связанных с помощью наследования, пользователю не нужно знать, к какому интерфейсу относится этот метод. Пользователь может вызывать любой из методов любого из интерфейсов с одним указателем на объект. Например, на следующем рисунке показано, как клиентское приложение использует объект Folder. Объекты Folder реализуют интерфейс [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) , который наследуется от [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) опосредованно через [IMAPIProp: IUnknown](imapipropiunknown.md) и [IMAPIContainer: IMAPIProp](imapicontainerimapiprop.md). Клиент может вызвать один из методов **IMAPIProp** , таких как [IMAPIProp:: PROPS](imapiprop-getprops.md), и один из методов [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) , таких как [IMAPIFolder:: CreateMessage](imapifolder-createmessage.md), так же, как и один и тот же указатель объекта. Клиент не знает или не влияет на то, что эти вызовы относятся к различным интерфейсам.
  
**Использование объекта папки клиентом**
  
![Клиентское использование объекта Folder клиентом объекта]Folder(media/amapi_40.gif "для объекта Folder")
  
Эти вызовы переводятся в код по-разному в зависимости от того, записывается ли клиент, выполняющий вызовы, в C или C++. Перед вызовом метода необходимо получить указатель на реализацию интерфейса. Указатели интерфейса можно получить следующими способами:
  
- Вызов метода для другого объекта.
    
- Вызов функции API.
    
- Вызов метода [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) целевого объекта. 
    
MAPI предоставляет несколько методов и функций API, возвращающих указатели на реализации интерфейсов. Например, клиенты могут вызывать метод [IMAPISession:: жетмсгсторестабле](imapisession-getmsgstorestable.md) для получения указателя на объект Table, предоставляющий доступ к сведениям о поставщике хранилища сообщений через интерфейс [IMAPITable: IUnknown](imapitableiunknown.md) . Поставщики услуг могут вызывать функцию API [креатетабле](createtable.md) для получения указателя на объект данных таблицы. Если нет доступных функций или методов, а клиенты или поставщики услуг уже имеют указатель на объект, они могут вызвать метод **QueryInterface** объекта, чтобы получить указатель на другую реализацию интерфейса объекта. 
  
## <a name="see-also"></a>См. также

- [Общие сведения об объекте и интерфейсе MAPI](mapi-object-and-interface-overview.md)


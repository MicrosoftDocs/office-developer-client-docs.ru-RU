---
title: Использование объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e342c1bd-8bee-4b02-a93f-e3941f4716c1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2b66b450318c802e773c2f2c47e4a39500c582d6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22592774"
---
# <a name="using-mapi-objects"></a><span data-ttu-id="9e7a7-103">Использование объектов MAPI</span><span class="sxs-lookup"><span data-stu-id="9e7a7-103">Using MAPI objects</span></span>

<span data-ttu-id="9e7a7-104">**Применимо к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9e7a7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9e7a7-105">Клиенты и поставщики услуг используйте объекты MAPI с помощью методов в их реализации интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-105">Clients and service providers use MAPI objects by calling the methods in their interface implementations.</span></span> <span data-ttu-id="9e7a7-106">Это является единственным способом, можно использовать объекты MAPI; методы, реализованных с помощью объекта за пределами интерфейса MAPI не общего доступа.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-106">This is the only way that MAPI objects can be used; methods that are implemented by an object outside of a MAPI interface are not publicly accessible.</span></span> <span data-ttu-id="9e7a7-107">Так как все интерфейсы объекта связаны через наследование, объекта пользователя можно вызвать методы в основной интерфейс или из наследуемых интерфейсов, как если бы они принадлежат тот же интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-107">Because all of an object's interfaces are related through inheritance, an object's user can call methods in either the base interface or one of the inherited interfaces as if they belong to the same interface.</span></span> 
  
<span data-ttu-id="9e7a7-108">При объекта пользователю необходимо вызвать метод и этот объект реализует несколько интерфейсов, связанных с помощью наследования, пользователь не требуется знать, интерфейс, который принадлежит метод.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-108">When an object's user wants to make a call to a method and that object implements several interfaces related through inheritance, the user need not know to which interface the method belongs.</span></span> <span data-ttu-id="9e7a7-109">Можно использовать любой из способов на любом из интерфейсов с одним указатель на объект.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-109">The user can call any of the methods on any of the interfaces with a single pointer to the object.</span></span> <span data-ttu-id="9e7a7-110">Например на следующем рисунке показана как клиентское приложение использует объект folder.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-110">For example, the following illustration shows how a client application uses a folder object.</span></span> <span data-ttu-id="9e7a7-111">Реализация объектов папок [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) интерфейс, который наследует от [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) косвенно через [IMAPIProp: IUnknown](imapipropiunknown.md) и [IMAPIContainer: IMAPIProp](imapicontainerimapiprop.md).</span><span class="sxs-lookup"><span data-stu-id="9e7a7-111">Folder objects implement the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) interface, which inherits from [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) indirectly through [IMAPIProp : IUnknown](imapipropiunknown.md) and [IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md).</span></span> <span data-ttu-id="9e7a7-112">Клиент может вызвать один из методов **IMAPIProp** , такие как [IMAPIProp::GetProps](imapiprop-getprops.md)и один из [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) методы, такие как [IMAPIFolder::CreateMessage](imapifolder-createmessage.md), так же, как с помощью одной указателя на объект.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-112">A client can call one of the **IMAPIProp** methods, such as [IMAPIProp::GetProps](imapiprop-getprops.md), and one of the [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) methods, such as [IMAPIFolder::CreateMessage](imapifolder-createmessage.md), in the same way with the same object pointer.</span></span> <span data-ttu-id="9e7a7-113">Клиент не принять во внимание или степени зависит от того, что эти вызовы принадлежащих разных интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-113">A client is not aware of or affected by the fact that these calls belong to different interfaces.</span></span>
  
<span data-ttu-id="9e7a7-114">**Использование объекта папки клиентом**</span><span class="sxs-lookup"><span data-stu-id="9e7a7-114">**Client use of a folder object**</span></span>
  
<span data-ttu-id="9e7a7-115">![Использование клиентского объекта папки] (media/amapi_40.gif "Использование клиентского объекта папки")</span><span class="sxs-lookup"><span data-stu-id="9e7a7-115">![Client use of a folder object](media/amapi_40.gif "Client use of a folder object")</span></span>
  
<span data-ttu-id="9e7a7-116">Эти вызовы преобразования в коде по-разному в зависимости от написана ли клиента, выполнение вызовов в C или C++.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-116">These calls translate into code differently depending on whether the client making the calls is written in C or C++.</span></span> <span data-ttu-id="9e7a7-117">Прежде чем будет выполнено любой вызов метода, должны быть получены указатель реализации интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-117">Before any call to a method can be made, a pointer to the interface implementation must be retrieved.</span></span> <span data-ttu-id="9e7a7-118">Указатели интерфейса можно получить следующими способами:</span><span class="sxs-lookup"><span data-stu-id="9e7a7-118">Interface pointers can be obtained in the following ways:</span></span>
  
- <span data-ttu-id="9e7a7-119">Вызов метода на другой объект.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-119">Calling a method on a different object.</span></span>
    
- <span data-ttu-id="9e7a7-120">Вызов функции API.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-120">Calling an API function.</span></span>
    
- <span data-ttu-id="9e7a7-121">Вызов метода [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) на целевой объект.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-121">Calling the [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) method on the target object.</span></span> 
    
<span data-ttu-id="9e7a7-122">MAPI предоставляет несколько методов и функций API, которые возвращают указатели для реализации интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-122">MAPI provides several methods and API functions that return pointers to interface implementations.</span></span> <span data-ttu-id="9e7a7-123">Например, клиенты могут вызывать метод [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) для извлечения указателя на объект в таблице, который предоставляет доступ к информации поставщика хранилища сообщений через [IMAPITable: IUnknown](imapitableiunknown.md) интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-123">For example, clients can call the [IMAPISession::GetMsgStoresTable](imapisession-getmsgstorestable.md) method to retrieve a pointer to a table object that provides access to message store provider information through the [IMAPITable : IUnknown](imapitableiunknown.md) interface.</span></span> <span data-ttu-id="9e7a7-124">Поставщиков услуг можно вызвать функцию API [CreateTable](createtable.md) получить указатель на объект данных в таблице.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-124">Service providers can call the API function [CreateTable](createtable.md) to retrieve a pointer to a table data object.</span></span> <span data-ttu-id="9e7a7-125">Если нет функция или метод доступен с клиентами или поставщиками услуг уже указателя на объект, они могут вызывать метод **QueryInterface** объекта для извлечения указатель на другой объект реализации интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9e7a7-125">When there is no function or method available and clients or service providers already have a pointer to an object, they can call the object's **QueryInterface** method to retrieve a pointer to another of the object's interface implementations.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="9e7a7-126">См. также</span><span class="sxs-lookup"><span data-stu-id="9e7a7-126">See also</span></span>

- [<span data-ttu-id="9e7a7-127">Обзор интерфейса и объект MAPI</span><span class="sxs-lookup"><span data-stu-id="9e7a7-127">MAPI Object and Interface Overview</span></span>](mapi-object-and-interface-overview.md)


---
title: Таблицы иерархии
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b8aa6b36-d6e5-4e1f-8ac5-5d6a78a70bf8
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 2a1461f0c7196cd425d9736f5837b742bedd4fb5
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32344579"
---
# <a name="hierarchy-tables"></a>Таблицы иерархии

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Иерархическая таблица содержит сведения о папках в хранилище сообщений или контейнерах в контейнере адресной книги. Каждая строка таблицы иерархий содержит набор столбцов со сведениями о одной папке или адресной книге. Таблицы иерархий в основном используются клиентами и реализуются поставщиками хранилищ сообщений для отображения дерева папок и вложенных папок, а также реализованных поставщиками адресных книг для отображения дерева контейнеров в адресной книге. Контейнеры, которые не могут содержать подконтейнеры, как указано в свойстве **пр_контаинер_флагс** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), как указано в отсутствии флага аб_субконтаинерс, не реализуйте таблицу иерархий.
  
Доступ к таблице иерархий можно получить с помощью вызова:
  
- [IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md).
    
    - Также
    
- [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) передает **пр_контаинер_хиерарчи** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) в качестве тега свойства и иид_имапитабле в качестве идентификатора интерфейса.
    
Контейнеры и папки должны поддерживать оба способа извлечения свойств таблицы. Он неприемлемо для поставщиков услуг, чтобы поддерживать только один способ доступа к этим таблицам, так как клиенты ожидают выбора. 
  
> [!IMPORTANT]
> Поставщики хранилища не гарантируют соблюдение порядка сортировки, указанного для таблиц иерархии. 
  
Вызов **IMAPIProp:: опенпроперти** включает доступ к таблице иерархии, открывая соответствующее свойство **пр_контаинер_хиерарчи**. Несмотря на то что **пр_контаинер_хиерарчи** невозможно получить с помощью метода [IMAPIProp::](imapiprop-getprops.md) -PROPS папки или контейнера, он включается в массив тегов свойств, который возвращается методом [IMAPIProp:: жетпроплист](imapiprop-getproplist.md) . 
  
 **Пр_контаинер_хиерарчи** также можно использовать для включения или исключения таблицы иерархии из операции копирования. Если клиент указывает **пр_контаинер_хиерарчи** в параметре *лпексклудепропс* для [IMAPIProp:: CopyTo](imapiprop-copyto.md) в операции копирования, Новая папка или контейнер не будет поддерживать таблицу иерархии исходной папки или контейнера. 
  
Следующие свойства составляют обязательный набор столбцов в таблице иерархий:
  
|||
|:-----|:-----|
|**Пр_коммент** ([PidTagComment](pidtagcomment-canonical-property.md))  <br/> |**Пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md))  <br/> |
|**Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))  <br/> |**Пр_дисплай_типе** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))  <br/> |
|**Пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md))  <br/> |**Пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))  <br/> |
|**Пр_обжект_типе** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))  <br/> |**Пр_статус** ([PidTagStatus](pidtagstatus-canonical-property.md))  <br/> |
   
 **Пр_дисплай_наме** содержит имя контейнера или папки, которые должны отображаться в иерархии. 
  
 **Пр_ентрид** — это идентификатор записи, связанный с этим контейнером или папкой. Он должен быть долгосрочным идентификатором записи. Клиенты и MAPI могут передать этот идентификатор записи в **OpenEntry** , чтобы открыть контейнер или папку и просмотреть ее содержимое, вызвав [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md). 
  
 **Пр_депс** — это числовое значение, указывающее уровень отступа для этого контейнера или папки с нулевым значением верхнего уровня. На более глубоком уровне в иерархии контейнер или папка находится более высокое значение свойства **пр_депс** . Клиенты используют свойство **пр_депс** для отображения таблицы иерархии соответствующим образом, чтобы пользователи могли ясно видеть родительские и дочерние связи. Глубина контейнера или папки всегда относится к контейнеру или папке, реализующей таблицу иерархии. 
  
 **Пр_обжект_типе** всегда имеет значение мапи_абконт для таблиц иерархии адресных книг и мапи_фолдер для таблиц иерархии папок. 
  
 **Пр_дисплай_типе** это числовое значение, которое относится к способу отображения контейнера или папки в таблице иерархий. Он используется в основном для отображения, чтобы визуально различать типы контейнеров или папок. Многие поставщики хранилищ сообщений и адресных книг используют значки для различных типов дисплеев. Поставщик должен предоставить эти значки. MAPI не предоставляет значения по умолчанию. 
  
MAPI определяет множество значений для **пр_дисплай_типе**, которые являются допустимыми для папок и других элементов, используемых с таблицами иерархии контейнеров адресных книг. Как правило, **пр_дисплай_типе** папки имеет значение дт_фолдер, указывающее значок папки по умолчанию, дт_фолдер_линк, чтобы указать значок, представляющий ссылку на другую папку, или дт_фолдер_спеЦиал, чтобы указать значок, зависящий от конкретного приложения. ДТ_ФОЛДЕР_ЛИНК используется с папками результатов поиска. 
  
В дополнение к этим обязательным столбцам таблицы иерархии адресных книг должны включать свойство **пр_контаинер_флагс** . **Пр_контаинер_флагс** указывает различные атрибуты контейнера в иерархии и используется для различения одного контейнера от другого. 
  
Необязательное свойство для таблиц иерархии адресных книг — это свойство **пр_аб_провидер_ид** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)).
  
В таблицах иерархий хранилища сообщений эти свойства включаются в обязательный набор столбцов:
  
- **Пр_фолдер_типе** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))
    
- **Пр_субфолдерс** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))
    
- **Пр_контент_каунт** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))
    
- **Пр_контент_унреад** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))
    
Поставщики адресных книг должны поддерживать следующие методы **IMAPITable** в своих реализациях таблиц иерархии, так как они необходимы для встроенной АДРЕСНОЙ книги MAPI: 
  
|||
|:-----|:-----|
|[IMAPITable::QueryColumns](imapitable-querycolumns.md) <br/> |[IMAPITable::QueryPosition](imapitable-queryposition.md) <br/> |
|[IMAPITable::SeekRow](imapitable-seekrow.md) <br/> |[IMAPITable::SeekRowApprox](imapitable-seekrowapprox.md) <br/> |
|[IMAPITable::FindRow](imapitable-findrow.md) <br/> |[IMAPITable::Restrict](imapitable-restrict.md) <br/> |
|[IMAPITable::CreateBookmark](imapitable-createbookmark.md) <br/> |[IMAPITable::FreeBookmark](imapitable-freebookmark.md) <br/> |
|[IMAPITable::QueryRows](imapitable-queryrows.md) <br/> | <br/> |
   
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


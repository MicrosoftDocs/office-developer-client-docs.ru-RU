---
title: Таблицы иерархии
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b8aa6b36-d6e5-4e1f-8ac5-5d6a78a70bf8
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 2a1461f0c7196cd425d9736f5837b742bedd4fb5
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32344579"
---
# <a name="hierarchy-tables"></a><span data-ttu-id="7e9aa-103">Таблицы иерархии</span><span class="sxs-lookup"><span data-stu-id="7e9aa-103">Hierarchy Tables</span></span>

  
  
<span data-ttu-id="7e9aa-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="7e9aa-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="7e9aa-105">Иерархическая таблица содержит сведения о папках в хранилище сообщений или контейнерах в контейнере адресной книги.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-105">A hierarchy table contains information about the folders in a message store or the containers in an address book container.</span></span> <span data-ttu-id="7e9aa-106">Каждая строка таблицы иерархий содержит набор столбцов со сведениями о одной папке или адресной книге.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-106">Each row of a hierarchy table contains a set of columns with information about one folder or address book container.</span></span> <span data-ttu-id="7e9aa-107">Таблицы иерархий в основном используются клиентами и реализуются поставщиками хранилищ сообщений для отображения дерева папок и вложенных папок, а также реализованных поставщиками адресных книг для отображения дерева контейнеров в адресной книге.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-107">Hierarchy tables are primarily used by clients and implemented by message store providers to show a tree of folders and subfolders and implemented by address book providers to show a tree of containers in the address book.</span></span> <span data-ttu-id="7e9aa-108">Контейнеры, которые не могут содержать подконтейнеры, как указано в свойстве **пр_контаинер_флагс** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), как указано в отсутствии флага аб_субконтаинерс, не реализуйте таблицу иерархий.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-108">Containers that cannot hold subcontainers, as indicated by the absence of the AB_SUBCONTAINERS flag in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property, do not implement a hierarchy table.</span></span>
  
<span data-ttu-id="7e9aa-109">Доступ к таблице иерархий можно получить с помощью вызова:</span><span class="sxs-lookup"><span data-stu-id="7e9aa-109">A hierarchy table can be accessed by calling:</span></span>
  
- <span data-ttu-id="7e9aa-110">[IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md).</span><span class="sxs-lookup"><span data-stu-id="7e9aa-110">[IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md).</span></span>
    
    - <span data-ttu-id="7e9aa-111">Также</span><span class="sxs-lookup"><span data-stu-id="7e9aa-111">Or -</span></span>
    
- <span data-ttu-id="7e9aa-112">[IMAPIProp:: опенпроперти](imapiprop-openproperty.md) передает **пр_контаинер_хиерарчи** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) в качестве тега свойства и иид_имапитабле в качестве идентификатора интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-112">[IMAPIProp::OpenProperty](imapiprop-openproperty.md) passing **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span>
    
<span data-ttu-id="7e9aa-113">Контейнеры и папки должны поддерживать оба способа извлечения свойств таблицы.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-113">Containers and folders must support both techniques for retrieving table properties.</span></span> <span data-ttu-id="7e9aa-114">Он неприемлемо для поставщиков услуг, чтобы поддерживать только один способ доступа к этим таблицам, так как клиенты ожидают выбора.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-114">It is unacceptable for service providers to support only one way to access these tables because clients expect to have the choice.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="7e9aa-115">Поставщики хранилища не гарантируют соблюдение порядка сортировки, указанного для таблиц иерархии.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-115">Store providers are not guaranteed to honor the sort order set specified for hierarchy tables.</span></span> 
  
<span data-ttu-id="7e9aa-116">Вызов **IMAPIProp:: опенпроперти** включает доступ к таблице иерархии, открывая соответствующее свойство **пр_контаинер_хиерарчи**.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-116">The call to **IMAPIProp::OpenProperty** involves accessing the hierarchy table by opening its corresponding property, **PR_CONTAINER_HIERARCHY**.</span></span> <span data-ttu-id="7e9aa-117">Несмотря на то что **пр_контаинер_хиерарчи** невозможно получить с помощью метода [IMAPIProp::](imapiprop-getprops.md) -PROPS папки или контейнера, он включается в массив тегов свойств, который возвращается методом [IMAPIProp:: жетпроплист](imapiprop-getproplist.md) .</span><span class="sxs-lookup"><span data-stu-id="7e9aa-117">Although **PR_CONTAINER_HIERARCHY** cannot be retrieved through a folder or container's [IMAPIProp::GetProps](imapiprop-getprops.md) method, it is included in the property tag array that is returned by the [IMAPIProp::GetPropList](imapiprop-getproplist.md) method.</span></span> 
  
 <span data-ttu-id="7e9aa-118">**Пр_контаинер_хиерарчи** также можно использовать для включения или исключения таблицы иерархии из операции копирования.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-118">**PR_CONTAINER_HIERARCHY** can also be used to include or exclude a hierarchy table from a copy operation.</span></span> <span data-ttu-id="7e9aa-119">Если клиент указывает **пр_контаинер_хиерарчи** в параметре *лпексклудепропс* для [IMAPIProp:: CopyTo](imapiprop-copyto.md) в операции копирования, Новая папка или контейнер не будет поддерживать таблицу иерархии исходной папки или контейнера.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-119">If a client specifies **PR_CONTAINER_HIERARCHY** in the  *lpExcludeProps*  parameter for [IMAPIProp::CopyTo](imapiprop-copyto.md) in a copy operation, the new folder or container will not support the hierarchy table of the original folder or container.</span></span> 
  
<span data-ttu-id="7e9aa-120">Следующие свойства составляют обязательный набор столбцов в таблице иерархий:</span><span class="sxs-lookup"><span data-stu-id="7e9aa-120">The following properties make up the required column set in a hierarchy table:</span></span>
  
|||
|:-----|:-----|
|<span data-ttu-id="7e9aa-121">**Пр_коммент** ([PidTagComment](pidtagcomment-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-121">**PR_COMMENT** ([PidTagComment](pidtagcomment-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="7e9aa-122">**Пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-122">**PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="7e9aa-123">**Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-123">**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="7e9aa-124">**Пр_дисплай_типе** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-124">**PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="7e9aa-125">**Пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-125">**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="7e9aa-126">**Пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-126">**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="7e9aa-127">**Пр_обжект_типе** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-127">**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="7e9aa-128">**Пр_статус** ([PidTagStatus](pidtagstatus-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-128">**PR_STATUS** ([PidTagStatus](pidtagstatus-canonical-property.md))</span></span>  <br/> |
   
 <span data-ttu-id="7e9aa-129">**Пр_дисплай_наме** содержит имя контейнера или папки, которые должны отображаться в иерархии.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-129">**PR_DISPLAY_NAME** contains the name for the container or folder that should appear in the display of the hierarchy.</span></span> 
  
 <span data-ttu-id="7e9aa-130">**Пр_ентрид** — это идентификатор записи, связанный с этим контейнером или папкой.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-130">**PR_ENTRYID** is the entry identifier associated with this container or folder.</span></span> <span data-ttu-id="7e9aa-131">Он должен быть долгосрочным идентификатором записи.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-131">It is expected to be a long-term entry identifier.</span></span> <span data-ttu-id="7e9aa-132">Клиенты и MAPI могут передать этот идентификатор записи в **OpenEntry** , чтобы открыть контейнер или папку и просмотреть ее содержимое, вызвав [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md).</span><span class="sxs-lookup"><span data-stu-id="7e9aa-132">Clients and MAPI can pass this entry identifier to **OpenEntry** to open the container or folder and view its contents by calling [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> 
  
 <span data-ttu-id="7e9aa-133">**Пр_депс** — это числовое значение, указывающее уровень отступа для этого контейнера или папки с нулевым значением верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-133">**PR_DEPTH** is a numeric value that indicates the level of indentation for this container or folder with zero being the top level.</span></span> <span data-ttu-id="7e9aa-134">На более глубоком уровне в иерархии контейнер или папка находится более высокое значение свойства **пр_депс** .</span><span class="sxs-lookup"><span data-stu-id="7e9aa-134">The deeper in the hierarchy a container or folder resides, the higher the value for its **PR_DEPTH** property.</span></span> <span data-ttu-id="7e9aa-135">Клиенты используют свойство **пр_депс** для отображения таблицы иерархии соответствующим образом, чтобы пользователи могли ясно видеть родительские и дочерние связи.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-135">Clients use the **PR_DEPTH** property to display a hierarchy table appropriately so that users can clearly see parent and child relationships.</span></span> <span data-ttu-id="7e9aa-136">Глубина контейнера или папки всегда относится к контейнеру или папке, реализующей таблицу иерархии.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-136">Container or folder depth is always relative to the container or folder implementing the hierarchy table.</span></span> 
  
 <span data-ttu-id="7e9aa-137">**Пр_обжект_типе** всегда имеет значение мапи_абконт для таблиц иерархии адресных книг и мапи_фолдер для таблиц иерархии папок.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-137">**PR_OBJECT_TYPE** is always set to MAPI_ABCONT for address book hierarchy tables and MAPI_FOLDER for folder hierarchy tables.</span></span> 
  
 <span data-ttu-id="7e9aa-138">**Пр_дисплай_типе** это числовое значение, которое относится к способу отображения контейнера или папки в таблице иерархий.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-138">**PR_DISPLAY_TYPE** is a numeric value that relates to how a container or folder is displayed in the hierarchy table.</span></span> <span data-ttu-id="7e9aa-139">Он используется в основном для отображения, чтобы визуально различать типы контейнеров или папок.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-139">It is mainly used for display purposes, to differentiate visually between types of containers or folders.</span></span> <span data-ttu-id="7e9aa-140">Многие поставщики хранилищ сообщений и адресных книг используют значки для различных типов дисплеев.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-140">Many message store and address book providers use icons for the different display types.</span></span> <span data-ttu-id="7e9aa-141">Поставщик должен предоставить эти значки. MAPI не предоставляет значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-141">It is up to the provider to supply these icons; MAPI does not supply defaults.</span></span> 
  
<span data-ttu-id="7e9aa-142">MAPI определяет множество значений для **пр_дисплай_типе**, которые являются допустимыми для папок и других элементов, используемых с таблицами иерархии контейнеров адресных книг.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-142">MAPI defines many values for **PR_DISPLAY_TYPE**, some that are valid for folders and others that are used with the hierarchy tables of address book containers.</span></span> <span data-ttu-id="7e9aa-143">Как правило, **пр_дисплай_типе** папки имеет значение дт_фолдер, указывающее значок папки по умолчанию, дт_фолдер_линк, чтобы указать значок, представляющий ссылку на другую папку, или дт_фолдер_спеЦиал, чтобы указать значок, зависящий от конкретного приложения.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-143">Typically, a folder's **PR_DISPLAY_TYPE** is set to DT_FOLDER to indicate a default folder icon, DT_FOLDER_LINK to indicate an icon that represents a link to another folder, or DT_FOLDER_SPECIAL to indicate an icon that is application-specific.</span></span> <span data-ttu-id="7e9aa-144">ДТ_ФОЛДЕР_ЛИНК используется с папками результатов поиска.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-144">DT_FOLDER_LINK is used with search-results folders.</span></span> 
  
<span data-ttu-id="7e9aa-145">В дополнение к этим обязательным столбцам таблицы иерархии адресных книг должны включать свойство **пр_контаинер_флагс** .</span><span class="sxs-lookup"><span data-stu-id="7e9aa-145">In addition to these required columns, address book hierarchy tables must include the **PR_CONTAINER_FLAGS** property.</span></span> <span data-ttu-id="7e9aa-146">**Пр_контаинер_флагс** указывает различные атрибуты контейнера в иерархии и используется для различения одного контейнера от другого.</span><span class="sxs-lookup"><span data-stu-id="7e9aa-146">**PR_CONTAINER_FLAGS** indicates various attributes about a container in the hierarchy and is used to distinguish one container from another.</span></span> 
  
<span data-ttu-id="7e9aa-147">Необязательное свойство для таблиц иерархии адресных книг — это свойство **пр_аб_провидер_ид** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="7e9aa-147">An optional property for address book hierarchy tables is the **PR_AB_PROVIDER_ID** ([PidTagAbProviderId](pidtagabproviderid-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="7e9aa-148">В таблицах иерархий хранилища сообщений эти свойства включаются в обязательный набор столбцов:</span><span class="sxs-lookup"><span data-stu-id="7e9aa-148">Message-store hierarchy tables include these properties in their required column set:</span></span>
  
- <span data-ttu-id="7e9aa-149">**Пр_фолдер_типе** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-149">**PR_FOLDER_TYPE** ([PidTagFolderType](pidtagfoldertype-canonical-property.md))</span></span>
    
- <span data-ttu-id="7e9aa-150">**Пр_субфолдерс** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-150">**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md))</span></span>
    
- <span data-ttu-id="7e9aa-151">**Пр_контент_каунт** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-151">**PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>
    
- <span data-ttu-id="7e9aa-152">**Пр_контент_унреад** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="7e9aa-152">**PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))</span></span>
    
<span data-ttu-id="7e9aa-153">Поставщики адресных книг должны поддерживать следующие методы **IMAPITable** в своих реализациях таблиц иерархии, так как они необходимы для встроенной АДРЕСНОЙ книги MAPI:</span><span class="sxs-lookup"><span data-stu-id="7e9aa-153">Address book providers must support the following **IMAPITable** methods in their hierarchy table implementations because they are required by the MAPI integrated address book:</span></span> 
  
|||
|:-----|:-----|
|[<span data-ttu-id="7e9aa-154">IMAPITable::QueryColumns</span><span class="sxs-lookup"><span data-stu-id="7e9aa-154">IMAPITable::QueryColumns</span></span>](imapitable-querycolumns.md) <br/> |[<span data-ttu-id="7e9aa-155">IMAPITable::QueryPosition</span><span class="sxs-lookup"><span data-stu-id="7e9aa-155">IMAPITable::QueryPosition</span></span>](imapitable-queryposition.md) <br/> |
|[<span data-ttu-id="7e9aa-156">IMAPITable::SeekRow</span><span class="sxs-lookup"><span data-stu-id="7e9aa-156">IMAPITable::SeekRow</span></span>](imapitable-seekrow.md) <br/> |[<span data-ttu-id="7e9aa-157">IMAPITable::SeekRowApprox</span><span class="sxs-lookup"><span data-stu-id="7e9aa-157">IMAPITable::SeekRowApprox</span></span>](imapitable-seekrowapprox.md) <br/> |
|[<span data-ttu-id="7e9aa-158">IMAPITable::FindRow</span><span class="sxs-lookup"><span data-stu-id="7e9aa-158">IMAPITable::FindRow</span></span>](imapitable-findrow.md) <br/> |[<span data-ttu-id="7e9aa-159">IMAPITable::Restrict</span><span class="sxs-lookup"><span data-stu-id="7e9aa-159">IMAPITable::Restrict</span></span>](imapitable-restrict.md) <br/> |
|[<span data-ttu-id="7e9aa-160">IMAPITable::CreateBookmark</span><span class="sxs-lookup"><span data-stu-id="7e9aa-160">IMAPITable::CreateBookmark</span></span>](imapitable-createbookmark.md) <br/> |[<span data-ttu-id="7e9aa-161">IMAPITable::FreeBookmark</span><span class="sxs-lookup"><span data-stu-id="7e9aa-161">IMAPITable::FreeBookmark</span></span>](imapitable-freebookmark.md) <br/> |
|[<span data-ttu-id="7e9aa-162">IMAPITable::QueryRows</span><span class="sxs-lookup"><span data-stu-id="7e9aa-162">IMAPITable::QueryRows</span></span>](imapitable-queryrows.md) <br/> | <br/> |
   
## <a name="see-also"></a><span data-ttu-id="7e9aa-163">См. также</span><span class="sxs-lookup"><span data-stu-id="7e9aa-163">See also</span></span>



[<span data-ttu-id="7e9aa-164">Таблицы MAPI</span><span class="sxs-lookup"><span data-stu-id="7e9aa-164">MAPI Tables</span></span>](mapi-tables.md)


---
title: Одноразовые идентификаторы записей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 741d21ae-f14a-4b7f-80aa-91d0f0ff3f34
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: abe52cb45e13e6713d28fffe379e245e2483bffa
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411045"
---
# <a name="one-off-entry-identifiers"></a>Одноразовые идентификаторы записей
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Одноразовые идентификаторы записей создаются MAPI в методе **IAddrBook:: креатеонеофф** и компонентах, у которых нет доступа к подсистеме MAPI, например, к компонентам шлюза. For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md). На следующем рисунке показан формат идентификатора одноразовой записи.
  
**Формат идентификатора единичных записей**
  
![Формат идентификатора одноразовой записи] (media/amapi_69.gif "Формат идентификатора одноразовой записи")
  
Первое поле — это особая структура [мапиуид](mapiuid.md) , определяющая идентификатор записи, представляющий настраиваемого получателя. Этой структуре **мапиуид** должно быть присвоено значение константы мапи_оне_офф_уид. МАПИ_ОНЕ_ОФФ_УИД определен в файле заголовка MAPIDEFS. Высоты. 
  
Поля Version и flags — это 16 разрядные слова в порядке байтов Intel. Поле Version должно иметь нулевое значение. Для поля Flags можно задать следующие значения:
  
МАПИ_ОНЕ_ОФФ_НО_РИЧ_ИНФО
  
МАПИ_ОНЕ_ОФФ_УНИКОДЕ
  
Флаг МАПИ_ОНЕ_ОФФ_НО_РИЧ_ИНФО устанавливается, если получатель не должен получать содержимое сообщения в формате TNEF, нейтральном к трансПорту. Этот флаг задается, когда МАПИ_СЕНД_НО_РИЧ_ИНФО передается в метод [IAddrBook:: креатеонеофф](iaddrbook-createoneoff.md) . 
  
Если отображаемое имя и адрес электронной почты являются строками в Юникоде, устанавливается флаг МАПИ_ОНЕ_ОФФ_УНИКОДЕ. Этот флаг задается, когда МАПИ_УНИКОДЕ передается в **IAddrBook:: креатеонеофф**. Если флаг МАПИ_УНИКОДЕ не передается в **креатеонеофф**, MAPI предполагает, что отображаемое имя и строки адреса электронной почты находятся в текущем наборе знаков ANSI на рабочей станции. Строки ANSI обычно плохо работают в сообщениях, которые передаются между платформами с использованием разных наборов символов, так как кодовая страница не кодируется в идентификаторе записи. Чтобы защититься от этого потенциально несовместимости, многие типы адресов ограничены только теми символами, которые являются общими для нескольких наборов символов. Тем не менее, чтобы обеспечить совместимость набора символов и платформы, клиенты должны использовать Юникод для символьных строк в сообщениях.
  
Отображаемое имя — это строка с завершающим нулем, которая соответствует свойству **пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) получателя и параметру _лпсзнаме_ , переданному в **IAddrBook:: креатеонеофф**. Кодировка Unicode, если установлен флаг МАПИ_ОНЕ_ОФФ_УНИКОДЕ и ANSI, если он является понятным. 
  
Тип адреса — это строка с завершающим нулем, которая соответствует свойству **пр_аддртипе** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) получателя и параметру _лпсзадртипе_ , переданному в **IAddrBook:: креатеонеофф**. 
  
Адрес электронной почты это строка с завершающим нулем, которая соответствует свойству **пр_емаил_аддресс** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) получателя и параметру _лпсзаддресс_ , переданному в **IAddrBook:: креатеонеофф**. 
  
> [!NOTE]
> В непустых структурах идентификаторов записей нет внутреннего поля; байты упаковываются точно так, как показано выше, а длина идентификатора записи не должна содержать байты за завершающим нулевым символом в адресе электронной почты. 
  
Для клиентов и поставщиков адресных книг, которые вручную создают одноразовые идентификаторы записей, может также потребоваться создать значения для свойств **пр_рекорд_кэй** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) и **пр_сеарч_кэй** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)). Ключ записи идентичен идентификатору записи. Ключ поиска должен быть сформирован путем сцепления следующих полей в следующем порядке:
  
1. Тип адреса, преобразованный в верхний регистр.
    
2. Двоеточие (:).
    
3. Адрес электронной почты, преобразованный в верхний регистр.
    
4. Завершающий символ null.
    
Не следует выполнять преобразование набора символов при создании ключа поиска.
  


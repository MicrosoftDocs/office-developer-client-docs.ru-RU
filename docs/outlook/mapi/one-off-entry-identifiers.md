---
title: Идентификаторы единичных записей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 741d21ae-f14a-4b7f-80aa-91d0f0ff3f34
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3a086d1b9bcc1eae620b2f0a5ce96a545ce68342
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22585537"
---
# <a name="one-off-entry-identifiers"></a>Идентификаторы единичных записей
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Идентификаторы единичных записей создается путем MAPI в методе **IAddrBook::CreateOneOff** и компонентов, которые не имеют доступа к подсистеме MAPI, такие как шлюз компонентов. For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md). На следующем рисунке показана формат идентификатора единичных записей.
  
**Формат идентификатора единичных записей**
  
![Формат идентификатора единичных записей] (media/amapi_69.gif "Формат идентификатора единичных записей")
  
Первое поле — это специальные структура [MAPIUID](mapiuid.md) , который определяет идентификатор записи как представление настраиваемого получателя. Эта структура **MAPIUID** должен иметь значение константы MAPI_ONE_OFF_UID. MAPI_ONE_OFF_UID определяется в файле заголовка MAPIDEFS. З. 
  
Поля версии и флаги, 16-разрядный слова в байтовом формате Intel. Поле версии должно быть установлено равным нулю. В поле флаги можно задать следующие значения:
  
MAPI_ONE_OFF_NO_RICH_INFO
  
MAPI_ONE_OFF_UNICODE
  
Флаг MAPI_ONE_OFF_NO_RICH_INFO устанавливается, если получатель не должны получать содержимое сообщения в транспорта Neutral Encapsulation формата TNEF. Этот флаг устанавливается при MAPI_SEND_NO_RICH_INFO передается методу [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) . 
  
Флаг MAPI_ONE_OFF_UNICODE установлен отображаемое имя и адрес электронной почты выполняются строк в кодировке Юникод. Этот флаг устанавливается при передаче MAPI_UNICODE **IAddrBook::CreateOneOff**. Когда флаг MAPI_UNICODE **CreateOneOff**не передается, MAPI предполагается, что отображаемое имя и адрес электронной почты адрес они на рабочей станции текущий набор символов ANSI. Обычно строки ANSI не работают в сообщения, отправленные между платформ, при использовании различных наборов символов, так как кодовая страница не кодируются в идентификатор записи. Чтобы избежать этой потенциальных проблем несовместимости, множество типов адресов ограничены только тех знаков, которые являются общими для нескольких наборов знаков. Тем не менее для обеспечения совместимости платформы и набор знаков, клиенты следует использовать Юникод для строк в сообщения.
  
Отображаемое имя — это строка символом null, соответствует свойству получателя **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)), а параметр _lpszName_ , передаваемый **IAddrBook::CreateOneOff**. Набор символов — Юникод, если флаг MAPI_ONE_OFF_UNICODE set и ANSI, если он не установлен. 
  
Тип адреса — это строка символом null, соответствует свойству получателя **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)), а параметр _lpszAdrType_ , передаваемый **IAddrBook::CreateOneOff**. 
  
Адрес электронной почты — это строка символом null, соответствует свойству получателя **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)), а параметр _lpszAddress_ , передаваемый **IAddrBook::CreateOneOff**. 
  
> [!NOTE]
> Нет без заполнения структуры идентификатора единичных записей; байты упакованы так же, как указано выше, и длина идентификатор элемента не должен содержать любые байт за прерывающие символом null адреса электронной почты. 
  
Клиенты и поставщиками адресных книг, которые вручную создания идентификаторов единичных записей также может потребоваться создать значения для свойства **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) и **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)). Ключ записи совпадает с идентификатором записи. Клавиша поиска следует созданных путем объединения следующие поля в следующем порядке:
  
1. Тип адреса преобразованы в верхний регистр.
    
2. Двоеточие (:).
    
3. Адрес электронной почты, преобразуется в верхний регистр.
    
4. Завершающий знак null.
    
При создании ключа поиска необходимо выполнить преобразование набора символов.
  


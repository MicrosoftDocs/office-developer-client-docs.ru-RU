---
title: Одноразовые идентификаторы записей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 741d21ae-f14a-4b7f-80aa-91d0f0ff3f34
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: abe52cb45e13e6713d28fffe379e245e2483bffa
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411045"
---
# <a name="one-off-entry-identifiers"></a>Одноразовые идентификаторы записей
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Одноразовые идентификаторы записей создаются MAPI в методе **IAddrBook:: креатеонеофф** и компонентах, у которых нет доступа к подсистеме MAPI, например, к компонентам шлюза. For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md). На следующем рисунке показан формат идентификатора одноразовой записи.
  
**Формат идентификатора единичных записей**
  
![Одноразовый](media/amapi_69.gif "One-off entry identifier format") формат идентификатора записи с одноразовым входом
  
Первое поле — это особая структура [мапиуид](mapiuid.md) , определяющая идентификатор записи, представляющий настраиваемого получателя. Этой структуре **мапиуид** должно быть присвоено значение константы MAPI_ONE_OFF_UID. MAPI_ONE_OFF_UID задается в файле заголовка MAPIDEFS. Высоты. 
  
Поля Version и flags — это 16 разрядные слова в порядке байтов Intel. Поле Version должно иметь нулевое значение. Для поля Flags можно задать следующие значения:
  
MAPI_ONE_OFF_NO_RICH_INFO
  
MAPI_ONE_OFF_UNICODE
  
Флаг MAPI_ONE_OFF_NO_RICH_INFO задается, если получатель не должен получать содержимое сообщения в формате TNEF, нейтральном к транспорту. Этот флаг задается, когда MAPI_SEND_NO_RICH_INFO передается в метод [IAddrBook:: креатеонеофф](iaddrbook-createoneoff.md) . 
  
Флаг MAPI_ONE_OFF_UNICODE задается, если отображаемое имя и адрес электронной почты являются строками в Юникоде. Этот флаг задается, когда MAPI_UNICODE передается в **IAddrBook:: креатеонеофф**. Если флаг MAPI_UNICODE не передается в **креатеонеофф**, MAPI предполагает, что отображаемое имя и строки адреса электронной почты находятся в текущем наборе знаков ANSI на рабочей станции. Строки ANSI обычно плохо работают в сообщениях, которые передаются между платформами с использованием разных наборов символов, так как кодовая страница не кодируется в идентификаторе записи. Чтобы защититься от этого потенциально несовместимости, многие типы адресов ограничены только теми символами, которые являются общими для нескольких наборов символов. Тем не менее, чтобы обеспечить совместимость набора символов и платформы, клиенты должны использовать Юникод для символьных строк в сообщениях.
  
Отображаемое имя — это строка с завершающим нулем, которая соответствует свойству **PR_DISPLAY_NAME** получателя ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) и параметру _лпсзнаме_ , переданному в **IAddrBook:: креатеонеофф**. Кодировка Юникод, если установлен флаг MAPI_ONE_OFF_UNICODE и ANSI, если он является понятным. 
  
Тип адреса — это строка с завершающим нулем, которая соответствует свойству **PR_ADDRTYPE** получателя ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) и параметру _лпсзадртипе_ , переданному в **IAddrBook:: креатеонеофф**. 
  
Адрес электронной почты — это строка с завершающим нулем, которая соответствует свойству **PR_EMAIL_ADDRESS** получателя ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) и параметру _лпсзаддресс_ , переданному в **IAddrBook:: креатеонеофф**. 
  
> [!NOTE]
> В непустых структурах идентификаторов записей нет внутреннего поля; байты упаковываются точно так, как показано выше, а длина идентификатора записи не должна содержать байты за завершающим нулевым символом в адресе электронной почты. 
  
Для клиентов и поставщиков адресных книг, которые вручную создают одноразовые идентификаторы записей, может также потребоваться создать значения для свойств **PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md)) и **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)). Ключ записи идентичен идентификатору записи. Ключ поиска должен быть сформирован путем сцепления следующих полей в следующем порядке:
  
1. Тип адреса, преобразованный в верхний регистр.
    
2. Двоеточие (:).
    
3. Адрес электронной почты, преобразованный в верхний регистр.
    
4. Завершающий символ null.
    
Не следует выполнять преобразование набора символов при создании ключа поиска.
  


---
title: Поддержка настройки службы сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bb6ab537-2876-474b-be7a-84734ace2bae
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: aa1a433e90eda24f1199783bc604e047deb03ecd
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418997"
---
# <a name="supporting-message-service-configuration"></a>Поддержка настройки службы сообщений
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Для поддержки конфигурации службы сообщений используйте следующую процедуру.
  
1. Реализуйте функцию точки входа, которая соответствует прототипу [мсгсервицеентри](msgserviceentry.md) . Функции точки входа службы сообщений управляют доступом к данным конфигурации и вызываются в следующих обстоятельствах: 
    
   - Когда клиент входит в систему для получения сведений о настройке службы сообщений.
    
   - Когда клиент хочет просмотреть или изменить свойство конфигурации. 
    
   Несмотря на то, что большинство служб сообщений предоставляют точки входа, они, как правило, не являются строго обязательными. Службы сообщений могут предоставлять доступ к данным конфигурации другими способами. Однако использование функции точки входа стандартизации и упрощает процесс настройки.
    
   MAPI ожидает, что все функции точки входа службы сообщений будут иметь возможность сохранять и извлекать свойства из разделов профиля, связанных со службой сообщений. Вы можете поддерживать эту функцию в интерактивном режиме, программно или в интерактивном режиме, и программным способом.
    
   Для поддержки интерактивной конфигурации предоставьте страницу свойств, в которой отображаются свойства, используемые при настройке службы сообщений. В качестве параметра можно также указать страницы свойств для каждого настраиваемого поставщика. Некоторые службы сообщений ограничивают пользователям представление свойств конфигурации, доступное только для чтения; другие службы сообщений позволяют пользователям вносить изменения.
    
   Для поддержки программной конфигурации функция точки входа службы сообщений должна иметь возможность работать без вмешательства пользователя. Если служба сообщений может вызываться мастером профилей, необходимо поддерживать программную конфигурацию. Если служба сообщений не позволяет настраивать конфигурацию с помощью мастера профилей, вы можете выбрать, следует ли поддерживать программную конфигурацию.
    
   Дополнительные сведения о поддержке конфигурации в функции точки входа службы сообщений можно найти в разделе [мсгсервицеентри](msgserviceentry.md).
    
2. Опубликуйте имя функции точки входа службы сообщений в файле конфигурации Mapisvc. INF, включив следующую запись в раздел Служба сообщений:
    
   `PR_SERVICE_ENTRY_NAME=<name of message service>`
    
3. Создайте одно или несколько диалоговых окон страницы свойств для отображения данных конфигурации.
    
4. Если вы хотите разрешить мастеру профилей настраивать службу сообщений, выполните следующие действия:
    
   - Реализуйте функцию точки входа, которая соответствует прототипу [визардентри](wizardentry.md) . 
    
   - Реализуйте стандартную процедуру диалогового окна Windows, которая соответствует прототипу [сервицевизарддлгпрок](servicewizarddlgproc.md) . 
    
   - Улучшите функцию точки входа службы сообщений, чтобы реагировать на дополнительные события.
    
## <a name="see-also"></a>См. также

- [Реализация службы сообщений](message-service-implementation.md)


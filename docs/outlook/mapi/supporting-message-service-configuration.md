---
title: Поддержка настройки службы сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bb6ab537-2876-474b-be7a-84734ace2bae
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: aa1a433e90eda24f1199783bc604e047deb03ecd
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418997"
---
# <a name="supporting-message-service-configuration"></a>Поддержка настройки службы сообщений
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Чтобы поддерживать конфигурацию службы сообщений, используйте следующую процедуру:
  
1. Реализация функции точки входа, соответствующей прототипу [MSGSERVICEENTRY.](msgserviceentry.md) Функции точки входа службы сообщений управляют доступом к данным конфигурации и вызваны в следующих обстоятельствах: 
    
   - Когда клиент входит в систему для получения сведений для настройки службы сообщений.
    
   - Если клиент хочет просмотреть или изменить свойство конфигурации. 
    
   Хотя большинство служб сообщений предоставляют функции точеки входа, как и по необходимости, эти функции не требуются строго. Службы сообщений могут предоставлять доступ к данным конфигурации другими способами. Однако использование функции точки входа стандартизирует и упрощает процесс настройки.
    
   MAPI ожидает, что все функции точки входа службы сообщений смогут хранить и извлекать свойства из разделов профилей, связанных с их службой сообщений. Эту функцию можно поддерживать интерактивно, программным или интерактивным и программным образом.
    
   Чтобы поддерживать интерактивную конфигурацию, устройте лист свойств, отображающий свойства, связанные с настройкой службы сообщений. В качестве параметра можно также предоставить листы свойств для каждого настраиваемого поставщика. Некоторые службы сообщений ограничивают пользователей просмотром свойств конфигурации только для чтения; другие службы сообщений позволяют пользователям вносить изменения.
    
   Чтобы поддерживать программную конфигурацию, ваша функция точки входа службы сообщений должна работать без вмешательства пользователя. Если служба сообщений может быть вызвана мастером профилей, необходимо поддерживать программную конфигурацию. Если служба сообщений не позволяет настраивать себя с помощью мастера профилей, вы можете выбрать, следует ли поддерживать программную конфигурацию.
    
   Дополнительные сведения о поддержке конфигурации в функции точки входа службы сообщений см. в [сообщении MSGSERVICEENTRY.](msgserviceentry.md)
    
2. Опубликуйте имя функции точки входа службы сообщений в файле конфигурации Mapisvc.inf, включив следующую запись в раздел служба сообщений:
    
   `PR_SERVICE_ENTRY_NAME=<name of message service>`
    
3. Создайте один или несколько диалоговых ящиков листа свойств для отображения данных конфигурации.
    
4. Выполните следующие задачи, если вы хотите разрешить мастеру профилей настроить службу сообщений:
    
   - Реализация функции точки входа, соответствующей [прототипу WIZARDENTRY.](wizardentry.md) 
    
   - Реализуйте стандартную процедуру Windows диалоговом окне, которая соответствует прототипу [SERVICEWIZARDDLGPROC.](servicewizarddlgproc.md) 
    
   - Расширение функции точки входа службы сообщений для реагирования на дополнительные события.
    
## <a name="see-also"></a>См. также

- [Реализация службы сообщений](message-service-implementation.md)


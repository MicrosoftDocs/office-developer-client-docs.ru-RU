---
title: Поддержка настройки службы сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bb6ab537-2876-474b-be7a-84734ace2bae
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: aa1a433e90eda24f1199783bc604e047deb03ecd
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418997"
---
# <a name="supporting-message-service-configuration"></a>Поддержка настройки службы сообщений
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Для поддержки конфигурации службы сообщений используйте следующую процедуру:
  
1. Реализуют функцию точки входа, которая соответствует [прототипу MSGSERVICEENTRY.](msgserviceentry.md) Функции точки входа службы сообщений управляют доступом к данным конфигурации и вызваны в следующих случаях: 
    
   - Когда клиент входит в систему, чтобы получить сведения для настройки службы сообщений.
    
   - Когда клиент хочет просмотреть или изменить свойство конфигурации. 
    
   Хотя большинство служб сообщений предоставляют функции точки входа, они не являются строгой обязательной. Службы сообщений могут предоставлять доступ к данным конфигурации другими способами. Однако использование функции точки входа стандартизирует и упрощает процесс настройки.
    
   MAPI ожидает, что все функции точки входа службы сообщений смогут хранить и извлекать свойства из разделов профиля, связанных со службой сообщений. Вы можете поддерживать эту функцию в интерактивном, программных или как интерактивном, так и в программных рамках.
    
   Для поддержки интерактивной конфигурации необходимо предоставить лист свойств, отображающий свойства, участвующие в настройке службы сообщений. В качестве варианта можно также предоставить листы свойств для каждого настраиваемого поставщика. Некоторые службы сообщений ограничивают пользователей представлением свойств конфигурации только для чтения; другие службы сообщений позволяют пользователям вносить изменения.
    
   Для поддержки программной конфигурации функция точки входа службы сообщений должна работать без вмешательства пользователя. Если служба сообщений может быть вызвана мастером профилей, необходимо поддерживать программную настройку. Если служба сообщений не позволяет настраивать себя с помощью мастера профилей, можно выбрать, следует ли поддерживать программную конфигурацию.
    
   Дополнительные сведения о поддержке конфигурации в функции точки входа службы сообщений см. в [msGSERVICEENTRY.](msgserviceentry.md)
    
2. Опубликуйте имя функции точки входа службы сообщений в файле конфигурации Mapisvc.inf, включив следующую запись в раздел службы сообщений:
    
   `PR_SERVICE_ENTRY_NAME=<name of message service>`
    
3. Создайте одно или несколько диалоговых окно листа свойств для отображения данных конфигурации.
    
4. Чтобы разрешить мастеру профилей настраивать службу сообщений, выполните следующие задачи:
    
   - Реализуют функцию точки входа, которая соответствует [прототипу WIZARDENTRY.](wizardentry.md) 
    
   - Реализуйте стандартную процедуру диалоговых окон Windows, которая соответствует прототипу [SERVICEWIZARDDLGPROC.](servicewizarddlgproc.md) 
    
   - Улучшайте функцию точки входа службы сообщений для реагирования на дополнительные события.
    
## <a name="see-also"></a>См. также

- [Реализация службы сообщений](message-service-implementation.md)


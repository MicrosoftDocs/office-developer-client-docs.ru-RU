---
title: Расширенные ошибки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e5bffa0753e3d8c86e737a96cfd303be7bcd97f3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405613"
---
# <a name="mapi-extended-errors"></a>Расширенные ошибки MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Реализующие методы интерфейса могут просто возвращать успешные (S_OK) и сбои (MAPI_E_CALL_FAILED) или различать условия ошибки, возвращая как можно больше значений ошибок в ситуации. В большинстве ситуаций можно использовать одно из значений ошибок, определенных MAPI в MAPICODE. Файл h-загона. Однако в ситуациях, которые не охвачены предопределяемого значения, можно использовать MAPI_E_EXTENDED_ERROR значение. MAPI_E_EXTENDED_ERROR указывает вызываемой, что доступны дополнительные сведения об ошибке. Вызываемая стороны извлекает дополнительные сведения, вызывая метод **GetLastError** для того же объекта, который MAPI_E_EXTENDED_ERROR. 
  
 **GetLastError** можно использовать для получения сведений о любом коде ошибки, а не только MAPI_E_EXTENDED_ERROR. Многие объекты MAPI реализуют интерфейсы, которые включают **метод GetLastError.** **GetLastError** возвращает единую структуру **MAPIERROR,** которая теоретически включает в себя совмещение всех ошибок, созданных предыдущим вызовом метода. Дополнительные сведения см. в [mapIERROR.](mapierror.md) Как звонячему не стоит зависеть от того, есть ли эта дополнительная информация об ошибке, так как для ее предоставления не требуются средства реализации объектов. Однако настоятельно рекомендуется, чтобы каждый раз, когда MAPI_E_EXTENDED_ERROR возвращал ошибку, вызывателям была возможность получить структуру **MAPIERROR** с полезной информацией об ошибке. 
  
Поскольку **GetLastError** также является функцией API, которая входит в состав Windows SDK, можно легко забыть, что в MAPI **Метод GetLastError** является методом интерфейса и может быть вызван только для объектов MAPI. Еще одна простая ошибка — вызов **GetLastError в** неправильном объекте. **GetLastError** должен быть вызван для объекта, который вызвал ошибку. Например, если клиент совершает вызов сеанса, а MAPI переадреает вызов поставщику услуг для работы, клиент не должен вызывать **GetLastError** в объекте поставщика услуг. **Правильный вызов: IMAPISession::GetLastError;** **GetLastError** должен быть вызван в объекте сеанса. Дополнительные сведения см. в [подразделе IMAPISession::GetLastError.](imapisession-getlasterror.md)
  


---
title: Расширенные ошибки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e5bffa0753e3d8c86e737a96cfd303be7bcd97f3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405613"
---
# <a name="mapi-extended-errors"></a>Расширенные ошибки MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Реализующие методы интерфейса могут просто возвращать успех (S_OK) и сбой (MAPI_E_CALL_FAILED) или различать условия ошибок, возвращая столько значений ошибок, сколько имеет смысл для ситуации. В большинстве ситуаций можно использовать одно из значений ошибок, определенных MAPI в MAPICODE. Файл заглавной папки H. Однако для ситуаций, не охваченных заранее заранее, можно использовать MAPI_E_EXTENDED_ERROR значение. MAPI_E_EXTENDED_ERROR указывает вызываемой, что дополнительные сведения об ошибке доступны. Вызыватель извлекает дополнительные сведения, позвонив **методу GetLastError** на том же объекте, который MAPI_E_EXTENDED_ERROR. 
  
 **GetLastError можно** использовать для получения сведений о любом коде ошибок, а не только MAPI_E_EXTENDED_ERROR. Многие объекты MAPI реализуют интерфейсы, которые включают **метод GetLastError.** **GetLastError** возвращает одну структуру **MAPIERROR,** которая теоретически включает конкатепацию всех ошибок, созданных предыдущим вызовом метода. Дополнительные сведения см. в [mapIERROR.](mapierror.md) В качестве вызываемой меры целесообразно не зависеть от предоставления этой дополнительной информации об ошибках, так как для ее предоставления не требуются объектные реализации. Однако настоятельно рекомендуется, чтобы всякий раз MAPI_E_EXTENDED_ERROR когда MAPI_E_EXTENDED_ERROR, вызыватели могли получить структуру **MAPIERROR** с полезной информацией об ошибке. 
  
Поскольку **GetLastError** также является функцией API, которая является частью Windows SDK, можно легко забыть, что в MAPI **GetLastError** — это метод интерфейса, который может быть вызван только на объектах MAPI. Еще одна простая ошибка — вызов **GetLastError на** неправильном объекте. **GetLastError должен** быть вызван на объект, который вызвал ошибку. Например, если клиент совершает сеанс, и MAPI передает вызов поставщику услуг для работы, клиент не должен вызывать **GetLastError** на объекте поставщика услуг. **IMAPISession::GetLastError** — правильный вызов; На объекте сеанса следует вызвать **GetLastError.** Дополнительные сведения см. [в iMAPISession::GetLastError](imapisession-getlasterror.md).
  


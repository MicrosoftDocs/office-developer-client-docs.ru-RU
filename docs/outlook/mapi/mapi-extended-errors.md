---
title: Расширенных ошибки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5a9499e2a980cbc00eb11c5199bb7329b255c7b2
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22592663"
---
# <a name="mapi-extended-errors"></a><span data-ttu-id="a298f-103">Расширенных ошибки MAPI</span><span class="sxs-lookup"><span data-stu-id="a298f-103">MAPI Extended Errors</span></span>

  
  
<span data-ttu-id="a298f-104">**Применимо к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a298f-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a298f-105">Реализации методов интерфейса можно выбрать только для возвращения (S_OK) успеха и неудачи (MAPI_E_CALL_FAILED) или различать условия ошибок, возврат столько ошибочные значения как смысла ситуации.</span><span class="sxs-lookup"><span data-stu-id="a298f-105">Implementers of interface methods can choose to simply return success (S_OK) and failure (MAPI_E_CALL_FAILED) or differentiate between error conditions, returning as many error values as make sense for the situation.</span></span> <span data-ttu-id="a298f-106">Большинстве ситуаций можно использовать одно из значений ошибок, определенных в MAPI в MAPICODE. Файл заголовка.</span><span class="sxs-lookup"><span data-stu-id="a298f-106">Most situations can use one of the error values defined by MAPI in the MAPICODE.H header file.</span></span> <span data-ttu-id="a298f-107">Тем не менее для ситуаций, которые не принадлежат предварительно определенные значения, значение, которое можно использовать MAPI_E_EXTENDED_ERROR.</span><span class="sxs-lookup"><span data-stu-id="a298f-107">However, for situations that are not covered by a predefined value, the value MAPI_E_EXTENDED_ERROR can be used.</span></span> <span data-ttu-id="a298f-108">MAPI_E_EXTENDED_ERROR указывает вызывающему, что Дополнительные сведения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="a298f-108">MAPI_E_EXTENDED_ERROR indicates to the caller that more information about the error is available.</span></span> <span data-ttu-id="a298f-109">Дополнительные сведения о извлекает вызывающего путем вызова метода **GetLastError** на тот же объект, возвращенный MAPI_E_EXTENDED_ERROR.</span><span class="sxs-lookup"><span data-stu-id="a298f-109">The caller retrieves the additional information by calling the **GetLastError** method on the same object that returned MAPI_E_EXTENDED_ERROR.</span></span> 
  
 <span data-ttu-id="a298f-110">Для получения сведений о любой код ошибки, не только MAPI_E_EXTENDED_ERROR может быть вызван **GetLastError** .</span><span class="sxs-lookup"><span data-stu-id="a298f-110">**GetLastError** can be called to retrieve information about any error code, not only MAPI_E_EXTENDED_ERROR.</span></span> <span data-ttu-id="a298f-111">Количество объектов MAPI реализовать интерфейсы, которые включают метод **GetLastError** .</span><span class="sxs-lookup"><span data-stu-id="a298f-111">Many MAPI objects implement interfaces that include the **GetLastError** method.</span></span> <span data-ttu-id="a298f-112">**Код последней ошибки** возвращается один структура **MAPIERROR** , теоретически включает объединение все ошибки, созданные путем вызова метода в предыдущей.</span><span class="sxs-lookup"><span data-stu-id="a298f-112">**GetLastError** returns a single **MAPIERROR** structure that, in theory, includes a concatenation of all the errors generated by the previous method call.</span></span> <span data-ttu-id="a298f-113">Для получения дополнительных сведений см [MAPIERROR](mapierror.md).</span><span class="sxs-lookup"><span data-stu-id="a298f-113">For more information, see [MAPIERROR](mapierror.md).</span></span> <span data-ttu-id="a298f-114">Как вызывающего абонента рекомендуется не зависят от необходимости Дополнительные сведения об этой недоступны из-за специалистов по внедрению объект не являются обязательными для предоставления его.</span><span class="sxs-lookup"><span data-stu-id="a298f-114">As a caller, it is wise not to depend on having this extra error information available because object implementers are not required to provide it.</span></span> <span data-ttu-id="a298f-115">Тем не менее настоятельно рекомендуется, что каждый раз, когда специалистов по внедрению возврата MAPI_E_EXTENDED_ERROR, они позволяют для вызывающих объектов для извлечения структура **MAPIERROR** полезную информацию об ошибке.</span><span class="sxs-lookup"><span data-stu-id="a298f-115">However, it is strongly recommended that whenever implementers return MAPI_E_EXTENDED_ERROR, they make it possible for callers to retrieve a **MAPIERROR** structure with useful information about the error.</span></span> 
  
<span data-ttu-id="a298f-116">Поскольку **GetLastError** также функции API, входящий в состав пакета Windows SDK, можно отложить, что в MAPI, **GetLastError** — это метод интерфейса и может быть вызван только для объектов MAPI.</span><span class="sxs-lookup"><span data-stu-id="a298f-116">Because **GetLastError** is also an API function that is part of the Windows SDK, it can be easy to forget that in MAPI, **GetLastError** is an interface method and can only be called on MAPI objects.</span></span> <span data-ttu-id="a298f-117">Другой простой ошибку, чтобы сделать вызывает **GetLastError** на нужный объект.</span><span class="sxs-lookup"><span data-stu-id="a298f-117">Another easy mistake to make is calling **GetLastError** on the wrong object.</span></span> <span data-ttu-id="a298f-118">Может быть вызвана **GetLastError** на объекте, вызвавшей ошибку.</span><span class="sxs-lookup"><span data-stu-id="a298f-118">**GetLastError** must be called on the object that generated the error.</span></span> <span data-ttu-id="a298f-119">К примеру Если клиент делает вызова сеанса MAPI пересылает вызов поставщика услуг для работы в, вашего клиента не должен вызывать **GetLastError** объект поставщика службы.</span><span class="sxs-lookup"><span data-stu-id="a298f-119">For example, if your client makes a session call, and MAPI forwards the call to a service provider to do the work, your client should not call **GetLastError** on the service provider object.</span></span> <span data-ttu-id="a298f-120">**IMAPISession::GetLastError** — это правильный вызов; Вызов **GetLastError** должен на объекте сеанса.</span><span class="sxs-lookup"><span data-stu-id="a298f-120">**IMAPISession::GetLastError** is the correct call; **GetLastError** should be invoked on the session object.</span></span> <span data-ttu-id="a298f-121">Для получения дополнительных сведений см [IMAPISession::GetLastError](imapisession-getlasterror.md).</span><span class="sxs-lookup"><span data-stu-id="a298f-121">For more information, see [IMAPISession::GetLastError](imapisession-getlasterror.md).</span></span>
  


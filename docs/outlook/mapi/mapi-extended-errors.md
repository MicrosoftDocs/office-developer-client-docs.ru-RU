---
title: Расширенные ошибки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e5bffa0753e3d8c86e737a96cfd303be7bcd97f3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32351557"
---
# <a name="mapi-extended-errors"></a><span data-ttu-id="59cc0-103">Расширенные ошибки MAPI</span><span class="sxs-lookup"><span data-stu-id="59cc0-103">MAPI Extended Errors</span></span>

  
  
<span data-ttu-id="59cc0-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="59cc0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="59cc0-105">Разработчики методов интерфейса могут просто возвратить сообщение об успешном завершении (S_OK) и ошибке (МАПИ_Е_КАЛЛ_ФАИЛЕД) или различать условия ошибок, возвращая как можно больше значений ошибок, как это имеет смысл для ситуации.</span><span class="sxs-lookup"><span data-stu-id="59cc0-105">Implementers of interface methods can choose to simply return success (S_OK) and failure (MAPI_E_CALL_FAILED) or differentiate between error conditions, returning as many error values as make sense for the situation.</span></span> <span data-ttu-id="59cc0-106">Большинство ситуаций могут использовать одно из значений ошибок, определенных MAPI, в МАПИКОДЕ. H файл заголовка.</span><span class="sxs-lookup"><span data-stu-id="59cc0-106">Most situations can use one of the error values defined by MAPI in the MAPICODE.H header file.</span></span> <span data-ttu-id="59cc0-107">Тем не менее, для ситуаций, не охваченных предварительно определенным значением, можно использовать значение МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР.</span><span class="sxs-lookup"><span data-stu-id="59cc0-107">However, for situations that are not covered by a predefined value, the value MAPI_E_EXTENDED_ERROR can be used.</span></span> <span data-ttu-id="59cc0-108">МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР указывает абоненту, что доступны дополнительные сведения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="59cc0-108">MAPI_E_EXTENDED_ERROR indicates to the caller that more information about the error is available.</span></span> <span data-ttu-id="59cc0-109">Вызывающий абонент получает дополнительные сведения, вызывая метод **GetLastError** для того же объекта, который вернул мапи_е_екстендед_еррор.</span><span class="sxs-lookup"><span data-stu-id="59cc0-109">The caller retrieves the additional information by calling the **GetLastError** method on the same object that returned MAPI_E_EXTENDED_ERROR.</span></span> 
  
 <span data-ttu-id="59cc0-110">**GetLastError** может вызываться для получения сведений о любом коде ошибки, а не только мапи_е_екстендед_еррор.</span><span class="sxs-lookup"><span data-stu-id="59cc0-110">**GetLastError** can be called to retrieve information about any error code, not only MAPI_E_EXTENDED_ERROR.</span></span> <span data-ttu-id="59cc0-111">Многие объекты MAPI реализуют интерфейсы, которые включают метод **GetLastError** .</span><span class="sxs-lookup"><span data-stu-id="59cc0-111">Many MAPI objects implement interfaces that include the **GetLastError** method.</span></span> <span data-ttu-id="59cc0-112">**GetLastError** возвращает одну структуру **мапиеррор** , которая в теории включает сцепление всех ошибок, созданных предыдущим вызовом метода.</span><span class="sxs-lookup"><span data-stu-id="59cc0-112">**GetLastError** returns a single **MAPIERROR** structure that, in theory, includes a concatenation of all the errors generated by the previous method call.</span></span> <span data-ttu-id="59cc0-113">Дополнительные сведения см. в разделе [мапиеррор](mapierror.md).</span><span class="sxs-lookup"><span data-stu-id="59cc0-113">For more information, see [MAPIERROR](mapierror.md).</span></span> <span data-ttu-id="59cc0-114">В качестве абонента разумно не зависеть от того, есть ли эти дополнительные сведения об ошибке, так как они не являются обязательными для реализации объекта.</span><span class="sxs-lookup"><span data-stu-id="59cc0-114">As a caller, it is wise not to depend on having this extra error information available because object implementers are not required to provide it.</span></span> <span data-ttu-id="59cc0-115">Тем не менее, настоятельно рекомендуется, чтобы методы, которые разработчики возвращают МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР, могли получить структуру **мапиеррор** со полезной информацией об ошибке.</span><span class="sxs-lookup"><span data-stu-id="59cc0-115">However, it is strongly recommended that whenever implementers return MAPI_E_EXTENDED_ERROR, they make it possible for callers to retrieve a **MAPIERROR** structure with useful information about the error.</span></span> 
  
<span data-ttu-id="59cc0-116">Так как **GetLastError** также является функцией API, которая входит в состав Windows SDK, можно легко забыть, что в MAPI, **GetLastError** является методом интерфейса и может вызываться только для объектов MAPI.</span><span class="sxs-lookup"><span data-stu-id="59cc0-116">Because **GetLastError** is also an API function that is part of the Windows SDK, it can be easy to forget that in MAPI, **GetLastError** is an interface method and can only be called on MAPI objects.</span></span> <span data-ttu-id="59cc0-117">Еще одной простой ошибкой является вызов **GetLastError** для неправильного объекта.</span><span class="sxs-lookup"><span data-stu-id="59cc0-117">Another easy mistake to make is calling **GetLastError** on the wrong object.</span></span> <span data-ttu-id="59cc0-118">Для объекта, вызвавшего ошибку, должен быть вызван **GetLastError** .</span><span class="sxs-lookup"><span data-stu-id="59cc0-118">**GetLastError** must be called on the object that generated the error.</span></span> <span data-ttu-id="59cc0-119">Например, если клиент выполняет вызов сеанса, а MAPI пересылает вызов поставщику услуг для выполнения работы, клиент не должен вызывать **GetLastError** для объекта поставщика услуг.</span><span class="sxs-lookup"><span data-stu-id="59cc0-119">For example, if your client makes a session call, and MAPI forwards the call to a service provider to do the work, your client should not call **GetLastError** on the service provider object.</span></span> <span data-ttu-id="59cc0-120">**IMAPISession:: GetLastError** — правильный вызов; **GetLastError** следует вызывать для объекта Session.</span><span class="sxs-lookup"><span data-stu-id="59cc0-120">**IMAPISession::GetLastError** is the correct call; **GetLastError** should be invoked on the session object.</span></span> <span data-ttu-id="59cc0-121">Дополнительные сведения см. в статье [IMAPISession:: GetLastError](imapisession-getlasterror.md).</span><span class="sxs-lookup"><span data-stu-id="59cc0-121">For more information, see [IMAPISession::GetLastError](imapisession-getlasterror.md).</span></span>
  


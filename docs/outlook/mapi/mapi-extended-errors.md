---
title: Расширенных ошибки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: '���� ���������� ���������: 23 ���� 2011 �.'
ms.openlocfilehash: 38e9418d5d9559b67bd79536635359ffaa3f724d
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809722"
---
# <a name="mapi-extended-errors"></a>Расширенных ошибки MAPI

  
  
**Применимо к**: Outlook 
  
Реализации методов интерфейса можно выбрать только для возвращения (S_OK) успеха и неудачи (MAPI_E_CALL_FAILED) или различать условия ошибок, возврат столько ошибочные значения как смысла ситуации. Большинстве ситуаций можно использовать одно из значений ошибок, определенных в MAPI в MAPICODE. Файл заголовка. Тем не менее для ситуаций, которые не принадлежат предварительно определенные значения, значение, которое можно использовать MAPI_E_EXTENDED_ERROR. MAPI_E_EXTENDED_ERROR указывает вызывающему, что Дополнительные сведения об ошибке. Дополнительные сведения о извлекает вызывающего путем вызова метода **GetLastError** на тот же объект, возвращенный MAPI_E_EXTENDED_ERROR. 
  
 Для получения сведений о любой код ошибки, не только MAPI_E_EXTENDED_ERROR может быть вызван **GetLastError** . Количество объектов MAPI реализовать интерфейсы, которые включают метод **GetLastError** . **Код последней ошибки** возвращается один структура **MAPIERROR** , теоретически включает объединение все ошибки, созданные путем вызова метода в предыдущей. Для получения дополнительных сведений см [MAPIERROR](mapierror.md). Как вызывающего абонента рекомендуется не зависят от необходимости Дополнительные сведения об этой недоступны из-за специалистов по внедрению объект не являются обязательными для предоставления его. Тем не менее настоятельно рекомендуется, что каждый раз, когда специалистов по внедрению возврата MAPI_E_EXTENDED_ERROR, они позволяют для вызывающих объектов для извлечения структура **MAPIERROR** полезную информацию об ошибке. 
  
Поскольку **GetLastError** также функции API, входящий в состав пакета Windows SDK, можно отложить, что в MAPI, **GetLastError** — это метод интерфейса и может быть вызван только для объектов MAPI. Другой простой ошибку, чтобы сделать вызывает **GetLastError** на нужный объект. Может быть вызвана **GetLastError** на объекте, вызвавшей ошибку. К примеру Если клиент делает вызова сеанса MAPI пересылает вызов поставщика услуг для работы в, вашего клиента не должен вызывать **GetLastError** объект поставщика службы. **IMAPISession::GetLastError** — это правильный вызов; Вызов **GetLastError** должен на объекте сеанса. Для получения дополнительных сведений см [IMAPISession::GetLastError](imapisession-getlasterror.md).
  


---
title: Расширенные ошибки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0a9fc55-f4ab-45d8-98cc-b040f9ef6aa4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e5bffa0753e3d8c86e737a96cfd303be7bcd97f3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32351557"
---
# <a name="mapi-extended-errors"></a>Расширенные ошибки MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Разработчики методов интерфейса могут просто возвратить сообщение об успешном завершении (S_OK) и ошибке (МАПИ_Е_КАЛЛ_ФАИЛЕД) или различать условия ошибок, возвращая как можно больше значений ошибок, как это имеет смысл для ситуации. Большинство ситуаций могут использовать одно из значений ошибок, определенных MAPI, в МАПИКОДЕ. H файл заголовка. Тем не менее, для ситуаций, не охваченных предварительно определенным значением, можно использовать значение МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР. МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР указывает абоненту, что доступны дополнительные сведения об ошибке. Вызывающий абонент получает дополнительные сведения, вызывая метод **GetLastError** для того же объекта, который вернул мапи_е_екстендед_еррор. 
  
 **GetLastError** может вызываться для получения сведений о любом коде ошибки, а не только мапи_е_екстендед_еррор. Многие объекты MAPI реализуют интерфейсы, которые включают метод **GetLastError** . **GetLastError** возвращает одну структуру **мапиеррор** , которая в теории включает сцепление всех ошибок, созданных предыдущим вызовом метода. Дополнительные сведения см. в разделе [мапиеррор](mapierror.md). В качестве абонента разумно не зависеть от того, есть ли эти дополнительные сведения об ошибке, так как они не являются обязательными для реализации объекта. Тем не менее, настоятельно рекомендуется, чтобы методы, которые разработчики возвращают МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР, могли получить структуру **мапиеррор** со полезной информацией об ошибке. 
  
Так как **GetLastError** также является функцией API, которая входит в состав Windows SDK, можно легко забыть, что в MAPI, **GetLastError** является методом интерфейса и может вызываться только для объектов MAPI. Еще одной простой ошибкой является вызов **GetLastError** для неправильного объекта. Для объекта, вызвавшего ошибку, должен быть вызван **GetLastError** . Например, если клиент выполняет вызов сеанса, а MAPI пересылает вызов поставщику услуг для выполнения работы, клиент не должен вызывать **GetLastError** для объекта поставщика услуг. **IMAPISession:: GetLastError** — правильный вызов; **GetLastError** следует вызывать для объекта Session. Дополнительные сведения см. в статье [IMAPISession:: GetLastError](imapisession-getlasterror.md).
  


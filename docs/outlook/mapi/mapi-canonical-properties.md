---
title: Каноническое свойство MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 29151beb-7436-401a-8072-58d4facd8458
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2fc605c57936765f43d7a6941dcc8d40d058db2f
ms.sourcegitcommit: e7b38e37a9d79becfd679e10420a19890165606d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "34540478"
---
# <a name="mapi-canonical-properties"></a><span data-ttu-id="35f69-103">Каноническое свойство MAPI</span><span class="sxs-lookup"><span data-stu-id="35f69-103">MAPI Canonical Properties</span></span>

  
  
<span data-ttu-id="35f69-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="35f69-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="35f69-105">Каноническое свойство является виртуальным свойством, представляющим свойство MAPI, или несколькими свойствами MAPI, определенными с одинаковым идентификатором свойства.</span><span class="sxs-lookup"><span data-stu-id="35f69-105">A canonical property is a virtual property that represents a MAPI property, or multiple MAPI properties defined with the same property identifier.</span></span> <span data-ttu-id="35f69-106">Канонические свойства предназначены только для согласованной идентификации свойств MAPI в обсуждениях или в документации вне кода.</span><span class="sxs-lookup"><span data-stu-id="35f69-106">Canonical properties are only intended to facilitate consistent identification of MAPI properties in discussions or documentation outside of code.</span></span> <span data-ttu-id="35f69-107">В отличие от MAPI, заданных в именах именованных свойств, каноническое имя свойства не определено как глобальные константы в файлах заголовков MAPI.</span><span class="sxs-lookup"><span data-stu-id="35f69-107">Unlike MAPI-defined tagged property names, canonical property names are not defined as global constants in MAPI header files.</span></span>
  
## <a name="naming-conventions"></a><span data-ttu-id="35f69-108">Соглашения об именовании</span><span class="sxs-lookup"><span data-stu-id="35f69-108">Naming Conventions</span></span>

<span data-ttu-id="35f69-109">Каноническое имя свойства начинается с префикса, "PID", представляющего "идентификатор свойства".</span><span class="sxs-lookup"><span data-stu-id="35f69-109">Canonical property names begin with a prefix, "Pid", which represents "property identifier."</span></span> <span data-ttu-id="35f69-110">В зависимости от того, является ли свойство размеченым свойством, именованным свойством с числовым идентификатором или именованным свойством с именем строки, префикс дополняется как "Пидтаг", "Пидлид" и "Пиднаме" соответственно.</span><span class="sxs-lookup"><span data-stu-id="35f69-110">Depending on whether the property is a tagged property, a named property with a numerical identifier, or a named property with a string name, the prefix is further qualified as "PidTag," "PidLid," and "PidName" respectively.</span></span> <span data-ttu-id="35f69-111">Например, [PidTagAccount](pidtagaccount-canonical-property.md) представляет свойства с тегами, **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), **PR_ACCOUNT_A** ([PidTagAccount](pidtagaccount-canonical-property.md)) и **PR_ACCOUNT_W** ([PidTagAccount](pidtagaccount-canonical-property.md)), которые указывают имя учетной записи получателя; [PidLidContacts](pidlidcontacts-canonical-property.md) представляет свойство **диспидконтактс** , именованное свойство с числовым идентификатором и определяющее имя контактов, связанных с сообщением; и [PidNamePhishingStamp](pidnamephishingstamp-canonical-property.md) представляет "http://schemas.microsoft.com/outlook/phishingstamp," именованное свойство, которое содержит строковое имя, а также указывает сообщения с пометкой строки, которые, скорее всего, являются фишингом.</span><span class="sxs-lookup"><span data-stu-id="35f69-111">For example, [PidTagAccount](pidtagaccount-canonical-property.md) represents the tagged properties, **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), **PR_ACCOUNT_A** ([PidTagAccount](pidtagaccount-canonical-property.md)), and **PR_ACCOUNT_W** ([PidTagAccount](pidtagaccount-canonical-property.md)), that specify a recipient's account name; [PidLidContacts](pidlidcontacts-canonical-property.md) represents the **dispidContacts** property, a named property that has a numerical identifier and that specifies the name of contacts associated with a message; and [PidNamePhishingStamp](pidnamephishingstamp-canonical-property.md) represents "http://schemas.microsoft.com/outlook/phishingstamp," a named property that has a string name, and that specifies the string marking messages that are likely to be phishing.</span></span> 
  
## <a name="representing-similar-properties-using-one-canonical-property"></a><span data-ttu-id="35f69-112">Представление похожих свойств с помощью одного канонического свойства</span><span class="sxs-lookup"><span data-stu-id="35f69-112">Representing Similar Properties Using One Canonical Property</span></span>

### <a name="identifying-properties-in-mapi"></a><span data-ttu-id="35f69-113">Определение свойств в MAPI</span><span class="sxs-lookup"><span data-stu-id="35f69-113">Identifying Properties in MAPI</span></span>

<span data-ttu-id="35f69-114">Все свойства в MAPI идентифицируются по идентификатору свойства, которое является 16-битным значением без знака.</span><span class="sxs-lookup"><span data-stu-id="35f69-114">All properties in MAPI are identified by a property identifier that is an unsigned 16-bit value.</span></span> <span data-ttu-id="35f69-115">Идентификатор свойства и тип свойства (другое 16-разрядное значение без знака) составляют тег свойства для свойства.</span><span class="sxs-lookup"><span data-stu-id="35f69-115">The property identifier and the property type (another unsigned 16-bit value) constitute a property tag for the property.</span></span> 
  
<span data-ttu-id="35f69-116">MAPI использует тег свойства, чтобы определить свойства уникальным образом.</span><span class="sxs-lookup"><span data-stu-id="35f69-116">MAPI uses a property tag to uniquely define properties.</span></span> <span data-ttu-id="35f69-117">Свойства, имеющие один и тот же тег свойства, такие как **PR_BUSINESS2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber](pidtagbusiness2telephonenumber-canonical-property.md)) и **PR_OFFICE2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber](pidtagbusiness2telephonenumber-canonical-property.md)), считаются идентичными свойствами в MAPI.</span><span class="sxs-lookup"><span data-stu-id="35f69-117">Properties that have the same property tag, like **PR_BUSINESS2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber](pidtagbusiness2telephonenumber-canonical-property.md)) and **PR_OFFICE2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber](pidtagbusiness2telephonenumber-canonical-property.md)), are considered identical properties in MAPI.</span></span> <span data-ttu-id="35f69-118">Список тегов свойств, определенных MAPI для собственных свойств, представлен в файле заголовка MAPI, Мапитагс. h.</span><span class="sxs-lookup"><span data-stu-id="35f69-118">For a list of property tags that MAPI has defined for its own properties, see the MAPI header file, Mapitags.h.</span></span>
  
<span data-ttu-id="35f69-119">Обратите внимание, что MAPI разделяет идентификаторы свойств на диапазоны.</span><span class="sxs-lookup"><span data-stu-id="35f69-119">Note that MAPI divides property identifiers into ranges.</span></span> <span data-ttu-id="35f69-120">Где идентификатор попадает в диапазон, указывающий на его использование и владение.</span><span class="sxs-lookup"><span data-stu-id="35f69-120">Where an identifier falls in the range indicates its use and ownership.</span></span> <span data-ttu-id="35f69-121">Идентификаторы свойств с тегами попадают в диапазон от 0x0001 до 0x7FFF.</span><span class="sxs-lookup"><span data-stu-id="35f69-121">The property identifiers of tagged properties fall in the range of 0x0001 to 0x7FFF.</span></span> <span data-ttu-id="35f69-122">В этом диапазоне находятся идентификаторы свойств, заданных MAPI, которые попадают в диапазон от 0x0001 до 0x3FFF.</span><span class="sxs-lookup"><span data-stu-id="35f69-122">Within this range are the property identifiers of MAPI-defined properties, which fall in the range of 0x0001 to 0x3FFF.</span></span> <span data-ttu-id="35f69-123">Идентификаторы свойств именованных свойств могут находиться в диапазоне от 0x8000 до 0x8FFF.</span><span class="sxs-lookup"><span data-stu-id="35f69-123">The property identifiers of named properties fall in the range from 0x8000 to 0x8FFF.</span></span> 
  
<span data-ttu-id="35f69-124">Именованные свойства дополнительно задаются набором свойств, а также длинным ИДЕНТИФИКАТОРом (крышка), который является 32-битным значением без знака или строкой.</span><span class="sxs-lookup"><span data-stu-id="35f69-124">Named properties are additionally attributed by a property set, and either a long ID (LID), which is an unsigned 32-bit value, or a string.</span></span> <span data-ttu-id="35f69-125">Набор свойств — это идентификатор GUID, который определяет группу именованных свойств с аналогичным предназначением.</span><span class="sxs-lookup"><span data-stu-id="35f69-125">A property set is a GUID that identifies a group of named properties with a similar purpose.</span></span> <span data-ttu-id="35f69-126">Набор свойств и имя для закрытия или строки используются для получения или задания именованного свойства.</span><span class="sxs-lookup"><span data-stu-id="35f69-126">The property set and LID or string name are used to get or set the named property.</span></span>
  
### <a name="property-type"></a><span data-ttu-id="35f69-127">Тип свойства</span><span class="sxs-lookup"><span data-stu-id="35f69-127">Property Type</span></span>

<span data-ttu-id="35f69-128">Помимо идентификаторов, свойство имеет тип данных, определяющий тип значений, допустимых для этого свойства.</span><span class="sxs-lookup"><span data-stu-id="35f69-128">Aside from identifiers, a property is attributed by a data type that specifies the type of values allowed for that property.</span></span>
  
<span data-ttu-id="35f69-129">Для свойств, которые относятся к строковому типу, в зависимости от поддержки Юникода в базовой платформе, свойство может иметь тип PT_STRING8 (8-разрядная строка символов, заканчивающаяся нулем) или PT_UNICODE (строка Юникода, заканчивающаяся нулем).</span><span class="sxs-lookup"><span data-stu-id="35f69-129">For properties that are of the string type, depending on the support for Unicode in the underlying platform, the property can be of type PT_STRING8 (null-terminated 8-bit character string) or PT_UNICODE (null-terminated Unicode string).</span></span> <span data-ttu-id="35f69-130">Свойство может быть определено с типом PT_TSTRING, в зависимости от параметров компиляции, PT_TSTRING умолчаний для строк Юникода для платформ, поддерживающих Юникод, или для PT_STRING8ной строки для платформ, поддерживающих ANSI или DBCS.</span><span class="sxs-lookup"><span data-stu-id="35f69-130">A property can be defined with the PT_TSTRING type, and depending on compilation settings, PT_TSTRING defaults to a Unicode string for platforms that support Unicode, or to a PT_STRING8 string for platforms that support ANSI or DBCS.</span></span> <span data-ttu-id="35f69-131">Обычно свойство с типом String обозначается тремя похожими именами, такими как **PR_ACCOUNT**, **PR_ACCOUNT_A**и **PR_ACCOUNT_W**, которые относятся к типу PT_TSTRING, PT_STRING8 и PT_UNICODE соответственно.</span><span class="sxs-lookup"><span data-stu-id="35f69-131">It is common that a string-typed property is identified by three similar names, such as **PR_ACCOUNT**, **PR_ACCOUNT_A**, and **PR_ACCOUNT_W**, which are of the type PT_TSTRING, PT_STRING8, and PT_UNICODE respectively.</span></span>
  
<span data-ttu-id="35f69-132">Дополнительные сведения о типах свойств и макросах, связанных с типами, приведены в файле заголовка MAPI, MAPIDEFS. h.</span><span class="sxs-lookup"><span data-stu-id="35f69-132">For more information on property types and macros related to types, see the MAPI header file, Mapidefs.h.</span></span>
  
### <a name="identifying-similar-properties"></a><span data-ttu-id="35f69-133">Определение похожих свойств</span><span class="sxs-lookup"><span data-stu-id="35f69-133">Identifying Similar Properties</span></span>

<span data-ttu-id="35f69-134">В текущей ориентации свойства MAPI невозможно обнаружить, что свойство было предоставлено в различных именах свойств, которые определены с одинаковым идентификатором свойства.</span><span class="sxs-lookup"><span data-stu-id="35f69-134">In the current MAPI property landscape, it is not uncommon to find that a property has been exposed under different property names, all of which are defined with the same property identifier.</span></span> <span data-ttu-id="35f69-135">Например, свойства с тегами, **PR_BUSINESS2_TELEPHONE_NUMBER** и **PR_OFFICE2_TELEPHONE_NUMBER**, определяются в мапитагс. h, чтобы иметь одинаковый идентификатор и тип свойства.</span><span class="sxs-lookup"><span data-stu-id="35f69-135">For example, the tagged properties, **PR_BUSINESS2_TELEPHONE_NUMBER** and **PR_OFFICE2_TELEPHONE_NUMBER**, are defined in Mapitags.h to have the same property identifier and type.</span></span> <span data-ttu-id="35f69-136">Тесное отношение с этими двумя свойствами:</span><span class="sxs-lookup"><span data-stu-id="35f69-136">Closely related to these two properties are:</span></span>
  
- <span data-ttu-id="35f69-137">**PR_BUSINESS2_TELEPHONE_NUMBER_A**</span><span class="sxs-lookup"><span data-stu-id="35f69-137">**PR_BUSINESS2_TELEPHONE_NUMBER_A**</span></span>
    
- <span data-ttu-id="35f69-138">**PR_BUSINESS2_TELEPHONE_NUMBER_W**</span><span class="sxs-lookup"><span data-stu-id="35f69-138">**PR_BUSINESS2_TELEPHONE_NUMBER_W**</span></span>
    
- <span data-ttu-id="35f69-139">**PR_OFFICE2_TELEPHONE_NUMBER_A**</span><span class="sxs-lookup"><span data-stu-id="35f69-139">**PR_OFFICE2_TELEPHONE_NUMBER_A**</span></span>
    
- <span data-ttu-id="35f69-140">**PR_OFFICE2_TELEPHONE_NUMBER_W**</span><span class="sxs-lookup"><span data-stu-id="35f69-140">**PR_OFFICE2_TELEPHONE_NUMBER_W**</span></span>
    
<span data-ttu-id="35f69-141">Свойства с суффиксом "_A" имеют тип PT_STRING8, а для имен с суффиксом "_W" задано значение PT_UNICODE.</span><span class="sxs-lookup"><span data-stu-id="35f69-141">The properties with the "_A" suffix are typed as PT_STRING8, and those with the "_W" suffix are typed as PT_UNICODE.</span></span>
  
<span data-ttu-id="35f69-142">В этом примере каноническое свойство **PidTagBusiness2TelephoneNumber** используется для упрощения ссылок на строгое связанное свойство MAPI с использованием одного идентификатора и согласованным способом (с использованием префикса "PID") во всех свойствах MAPI.</span><span class="sxs-lookup"><span data-stu-id="35f69-142">The purpose of a canonical property, **PidTagBusiness2TelephoneNumber** in this example, is to facilitate referencing such closely affiliated MAPI properties using one identifier, and in a consistent way (using the "Pid" prefix) across all MAPI properties.</span></span> <span data-ttu-id="35f69-143">Чтобы найти свойства реального времени, которые представляет каноническое свойство, ознакомьтесь со статьей [сопоставление имен канонических свойств с именами MAPI](mapping-canonical-property-names-to-mapi-names.md).</span><span class="sxs-lookup"><span data-stu-id="35f69-143">To find which real MAPI properties a canonical property represents, see [Mapping Canonical Property Names to MAPI Names](mapping-canonical-property-names-to-mapi-names.md).</span></span> <span data-ttu-id="35f69-144">Чтобы найти каноническое свойство, с которым связано свойство MAPI, ознакомьтесь со статьей [сопоставление имен MAPI с каноническими именами свойств](mapping-mapi-names-to-canonical-property-names.md).</span><span class="sxs-lookup"><span data-stu-id="35f69-144">To find the canonical property that a MAPI property is associated with, see [Mapping MAPI Names to Canonical Property Names](mapping-mapi-names-to-canonical-property-names.md).</span></span>
  
## <a name="mapi-support-of-canonical-property-names"></a><span data-ttu-id="35f69-145">Поддержка MAPI имен канонических свойств</span><span class="sxs-lookup"><span data-stu-id="35f69-145">MAPI Support of Canonical Property Names</span></span>

<span data-ttu-id="35f69-146">Поскольку канонические свойства не являются реальными свойствами и не определены в файлах заголовков MAPI, не следует использовать каноническое имя свойства в коде; Вместо этого следует использовать точные имена свойств MAPI в коде.</span><span class="sxs-lookup"><span data-stu-id="35f69-146">Because canonical properties are not real properties and are not defined in MAPI header files, you should not use canonical property names in code; instead, you should continue to use the exact MAPI property names in code.</span></span> <span data-ttu-id="35f69-147">Например, вы можете ссылаться на **PR_BUSINESS2_TELEPHONE_NUMBER** и **PR_OFFICE2_TELEPHONE_NUMBER** вне кода как **PidTagBusiness2TelephoneNumber**и использовать **PR_BUSINESS2_TELEPHONE_NUMBER** или **PR_OFFICE2_TELEPHONE_NUMBER** в коде.</span><span class="sxs-lookup"><span data-stu-id="35f69-147">For example, you can refer **PR_BUSINESS2_TELEPHONE_NUMBER** and **PR_OFFICE2_TELEPHONE_NUMBER** outside of code as **PidTagBusiness2TelephoneNumber**, and use either **PR_BUSINESS2_TELEPHONE_NUMBER** or **PR_OFFICE2_TELEPHONE_NUMBER** in code.</span></span> 
  
<span data-ttu-id="35f69-148">Если необходимо использовать каноническое имя свойства в коде, необходимо сначала определить их в собственных файлах заголовков.</span><span class="sxs-lookup"><span data-stu-id="35f69-148">If you must use canonical property names in your code, you must first define them in your own header files.</span></span>
  
## <a name="canonical-property-names-and-exchange-protocol-specifications"></a><span data-ttu-id="35f69-149">Каноническое имя свойства и спецификации протокола Exchange</span><span class="sxs-lookup"><span data-stu-id="35f69-149">Canonical Property Names and Exchange Protocol Specifications</span></span>

<span data-ttu-id="35f69-150">Канонические имена указываются в спецификациях протокола Microsoft Exchange Server, которые используются Exchange Server для связи с другими продуктами корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="35f69-150">Canonical names are referenced in Microsoft Exchange Server protocol specifications that are used by Exchange Server to communicate with other Microsoft products.</span></span> <span data-ttu-id="35f69-151">Дополнительные сведения о свойствах объектов сообщений, на которые ссылаются спецификации протокола Exchange, приведены в разделе [[MS — окспропс]](https://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="35f69-151">For more information about message object properties referenced by Exchange protocol specifications, see [[MS-OXPROPS]](https://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="35f69-152">См. также</span><span class="sxs-lookup"><span data-stu-id="35f69-152">See also</span></span>



[<span data-ttu-id="35f69-153">Теги свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="35f69-153">MAPI Property Tags</span></span>](mapi-property-tags.md)
  
[<span data-ttu-id="35f69-154">Обзор идентификаторов свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="35f69-154">MAPI Property Identifier Overview</span></span>](mapi-property-identifier-overview.md)
  
[<span data-ttu-id="35f69-155">Обзор типов свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="35f69-155">MAPI Property Type Overview</span></span>](mapi-property-type-overview.md)


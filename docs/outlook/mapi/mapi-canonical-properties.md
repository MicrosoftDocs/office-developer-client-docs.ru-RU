---
title: Каноническое свойство MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 29151beb-7436-401a-8072-58d4facd8458
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2fc605c57936765f43d7a6941dcc8d40d058db2f
ms.sourcegitcommit: e7b38e37a9d79becfd679e10420a19890165606d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "34540478"
---
# <a name="mapi-canonical-properties"></a>Каноническое свойство MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каноническое свойство является виртуальным свойством, представляющим свойство MAPI, или несколькими свойствами MAPI, определенными с одинаковым идентификатором свойства. Канонические свойства предназначены только для согласованной идентификации свойств MAPI в обсуждениях или в документации вне кода. В отличие от MAPI, заданных в именах именованных свойств, каноническое имя свойства не определено как глобальные константы в файлах заголовков MAPI.
  
## <a name="naming-conventions"></a>Соглашения об именовании

Каноническое имя свойства начинается с префикса, "PID", представляющего "идентификатор свойства". В зависимости от того, является ли свойство размеченым свойством, именованным свойством с числовым идентификатором или именованным свойством с именем строки, префикс дополняется как "Пидтаг", "Пидлид" и "Пиднаме" соответственно. Например, [PidTagAccount](pidtagaccount-canonical-property.md) представляет свойства с тегами, **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), **PR_ACCOUNT_A** ([PidTagAccount](pidtagaccount-canonical-property.md)) и **PR_ACCOUNT_W** ([PidTagAccount](pidtagaccount-canonical-property.md)), которые указывают имя учетной записи получателя; [PidLidContacts](pidlidcontacts-canonical-property.md) представляет свойство **диспидконтактс** , именованное свойство с числовым идентификатором и определяющее имя контактов, связанных с сообщением; и [PidNamePhishingStamp](pidnamephishingstamp-canonical-property.md) представляет "http://schemas.microsoft.com/outlook/phishingstamp," именованное свойство, которое содержит строковое имя, а также указывает сообщения с пометкой строки, которые, скорее всего, являются фишингом. 
  
## <a name="representing-similar-properties-using-one-canonical-property"></a>Представление похожих свойств с помощью одного канонического свойства

### <a name="identifying-properties-in-mapi"></a>Определение свойств в MAPI

Все свойства в MAPI идентифицируются по идентификатору свойства, которое является 16-битным значением без знака. Идентификатор свойства и тип свойства (другое 16-разрядное значение без знака) составляют тег свойства для свойства. 
  
MAPI использует тег свойства, чтобы определить свойства уникальным образом. Свойства, имеющие один и тот же тег свойства, такие как **PR_BUSINESS2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber](pidtagbusiness2telephonenumber-canonical-property.md)) и **PR_OFFICE2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber](pidtagbusiness2telephonenumber-canonical-property.md)), считаются идентичными свойствами в MAPI. Список тегов свойств, определенных MAPI для собственных свойств, представлен в файле заголовка MAPI, Мапитагс. h.
  
Обратите внимание, что MAPI разделяет идентификаторы свойств на диапазоны. Где идентификатор попадает в диапазон, указывающий на его использование и владение. Идентификаторы свойств с тегами попадают в диапазон от 0x0001 до 0x7FFF. В этом диапазоне находятся идентификаторы свойств, заданных MAPI, которые попадают в диапазон от 0x0001 до 0x3FFF. Идентификаторы свойств именованных свойств могут находиться в диапазоне от 0x8000 до 0x8FFF. 
  
Именованные свойства дополнительно задаются набором свойств, а также длинным ИДЕНТИФИКАТОРом (крышка), который является 32-битным значением без знака или строкой. Набор свойств — это идентификатор GUID, который определяет группу именованных свойств с аналогичным предназначением. Набор свойств и имя для закрытия или строки используются для получения или задания именованного свойства.
  
### <a name="property-type"></a>Тип свойства

Помимо идентификаторов, свойство имеет тип данных, определяющий тип значений, допустимых для этого свойства.
  
Для свойств, которые относятся к строковому типу, в зависимости от поддержки Юникода в базовой платформе, свойство может иметь тип PT_STRING8 (8-разрядная строка символов, заканчивающаяся нулем) или PT_UNICODE (строка Юникода, заканчивающаяся нулем). Свойство может быть определено с типом PT_TSTRING, в зависимости от параметров компиляции, PT_TSTRING умолчаний для строк Юникода для платформ, поддерживающих Юникод, или для PT_STRING8ной строки для платформ, поддерживающих ANSI или DBCS. Обычно свойство с типом String обозначается тремя похожими именами, такими как **PR_ACCOUNT**, **PR_ACCOUNT_A**и **PR_ACCOUNT_W**, которые относятся к типу PT_TSTRING, PT_STRING8 и PT_UNICODE соответственно.
  
Дополнительные сведения о типах свойств и макросах, связанных с типами, приведены в файле заголовка MAPI, MAPIDEFS. h.
  
### <a name="identifying-similar-properties"></a>Определение похожих свойств

В текущей ориентации свойства MAPI невозможно обнаружить, что свойство было предоставлено в различных именах свойств, которые определены с одинаковым идентификатором свойства. Например, свойства с тегами, **PR_BUSINESS2_TELEPHONE_NUMBER** и **PR_OFFICE2_TELEPHONE_NUMBER**, определяются в мапитагс. h, чтобы иметь одинаковый идентификатор и тип свойства. Тесное отношение с этими двумя свойствами:
  
- **PR_BUSINESS2_TELEPHONE_NUMBER_A**
    
- **PR_BUSINESS2_TELEPHONE_NUMBER_W**
    
- **PR_OFFICE2_TELEPHONE_NUMBER_A**
    
- **PR_OFFICE2_TELEPHONE_NUMBER_W**
    
Свойства с суффиксом "_A" имеют тип PT_STRING8, а для имен с суффиксом "_W" задано значение PT_UNICODE.
  
В этом примере каноническое свойство **PidTagBusiness2TelephoneNumber** используется для упрощения ссылок на строгое связанное свойство MAPI с использованием одного идентификатора и согласованным способом (с использованием префикса "PID") во всех свойствах MAPI. Чтобы найти свойства реального времени, которые представляет каноническое свойство, ознакомьтесь со статьей [сопоставление имен канонических свойств с именами MAPI](mapping-canonical-property-names-to-mapi-names.md). Чтобы найти каноническое свойство, с которым связано свойство MAPI, ознакомьтесь со статьей [сопоставление имен MAPI с каноническими именами свойств](mapping-mapi-names-to-canonical-property-names.md).
  
## <a name="mapi-support-of-canonical-property-names"></a>Поддержка MAPI имен канонических свойств

Поскольку канонические свойства не являются реальными свойствами и не определены в файлах заголовков MAPI, не следует использовать каноническое имя свойства в коде; Вместо этого следует использовать точные имена свойств MAPI в коде. Например, вы можете ссылаться на **PR_BUSINESS2_TELEPHONE_NUMBER** и **PR_OFFICE2_TELEPHONE_NUMBER** вне кода как **PidTagBusiness2TelephoneNumber**и использовать **PR_BUSINESS2_TELEPHONE_NUMBER** или **PR_OFFICE2_TELEPHONE_NUMBER** в коде. 
  
Если необходимо использовать каноническое имя свойства в коде, необходимо сначала определить их в собственных файлах заголовков.
  
## <a name="canonical-property-names-and-exchange-protocol-specifications"></a>Каноническое имя свойства и спецификации протокола Exchange

Канонические имена указываются в спецификациях протокола Microsoft Exchange Server, которые используются Exchange Server для связи с другими продуктами корпорации Майкрософт. Дополнительные сведения о свойствах объектов сообщений, на которые ссылаются спецификации протокола Exchange, приведены в разделе [[MS — окспропс]](https://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx).
  
## <a name="see-also"></a>См. также



[Теги свойств MAPI](mapi-property-tags.md)
  
[Обзор идентификаторов свойств MAPI](mapi-property-identifier-overview.md)
  
[Обзор типов свойств MAPI](mapi-property-type-overview.md)


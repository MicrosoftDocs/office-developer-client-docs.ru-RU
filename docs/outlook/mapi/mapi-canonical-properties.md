---
title: Канонические свойства MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 29151beb-7436-401a-8072-58d4facd8458
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2fc605c57936765f43d7a6941dcc8d40d058db2f
ms.sourcegitcommit: e7b38e37a9d79becfd679e10420a19890165606d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "34540478"
---
# <a name="mapi-canonical-properties"></a>Канонические свойства MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каноническое свойство — это виртуальное свойство, которое представляет свойство MAPI или несколько свойств MAPI, определенных с помощью одного идентификатора свойства. Канонические свойства предназначены только для упрощения согласованной идентификации свойств MAPI в обсуждениях или документации за пределами кода. В отличие от имен свойств, определенных в MAPI, имена канонических свойств не определяются как глобальные константы в файлах заголовок MAPI.
  
## <a name="naming-conventions"></a>Соглашения об именово-именовом имени

Имена канонических свойств начинаются с префикса Pid, который представляет "идентификатор свойства". В зависимости от того, является ли свойство помеченным, именованное свойство с числовым идентификатором или именованное свойство со строковым именем, префикс будет квалифицироваться как "PidTag", "PidLid" и "PidName" соответственно. Например, [PidTagAccount](pidtagaccount-canonical-property.md) представляет помеченные свойства **PR_ACCOUNT** ([PidTagAccount),](pidtagaccount-canonical-property.md) **PR_ACCOUNT_A** ([PidTagAccount)](pidtagaccount-canonical-property.md)и **PR_ACCOUNT_W** ([PidTagAccount),](pidtagaccount-canonical-property.md)которые указывают имя учетной записи получателя; [PidLidContacts](pidlidcontacts-canonical-property.md) представляет свойство **dispidContacts** , именуемого свойства, которое имеет числового идентификатора и указывает имя контактов, связанных с сообщением; и [PidNamePhishingStamp](pidnamephishingstamp-canonical-property.md) представляет "," именуемого свойства, которое имеет строковое имя и которое указывает строку пометки сообщений, которые могут быть http://schemas.microsoft.com/outlook/phishingstamp фишингом. 
  
## <a name="representing-similar-properties-using-one-canonical-property"></a>Представление похожих свойств с помощью одного канонического свойства

### <a name="identifying-properties-in-mapi"></a>Определение свойств в MAPI

Все свойства в MAPI идентифицируются идентификатором свойства, который является неподписаным 16-битным значением. Идентификатор свойства и тип свойства (другое неподписаное 16-битное значение) составляют тег свойства. 
  
MAPI использует тег свойства для уникального определения свойств. Свойства с одинаковыми тегами свойств, например **PR_BUSINESS2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber)](pidtagbusiness2telephonenumber-canonical-property.md)и **PR_OFFICE2_TELEPHONE_NUMBER** ([PidTagBusiness2TelephoneNumber),](pidtagbusiness2telephonenumber-canonical-property.md)считаются идентичными свойствами в MAPI. Список тегов свойств, определенных MAPI для собственных свойств, см. в файле загона MAPI Mapitags.h.
  
Обратите внимание, что MAPI делит идентификаторы свойств на диапазоны. Место, в котором идентификатор попадает в диапазон, указывает на его использование и право собственности. Идентификаторы свойств помеченных свойств попадают в диапазоне 0x0001 0x7FFF. В этом диапазоне находятся идентификаторы свойств, определяемого MAPI, которые находятся в диапазоне от 0x0001 до 0x3FFF. Идентификаторы именуемого свойства попадают в диапазон от 0x8000 до 0x8FFF. 
  
Именуются также набором свойств, а также длинным именем (32-битным значением, неподписаным 32-битным) или строкой. Набор свойств — это GUID, который идентифицирует группу именуемых свойств с аналогичной целью. Набор свойств и имя строки ИЛИ ЛИД используются для получения или задайте именуемую свойство.
  
### <a name="property-type"></a>Тип свойства

Помимо идентификаторов, свойство связано с типом данных, который указывает тип значений, разрешенных для этого свойства.
  
Для свойств, которые имеют тип строки, в зависимости от поддержки Юникод в платформе, свойство может иметь тип PT_STRING8 (8-битовая строка с нулью) или PT_UNICODE (строка Юникод с нулью). Свойство может быть определено с помощью типа PT_TSTRING, и в зависимости от параметров компиляции PT_TSTRING по умолчанию имеет строку Юникода для платформ, которые поддерживают Юникод, или строку PT_STRING8 для платформ, поддерживаюющих ANSI или DBCS. Как правило, свойство строки идентифицировано тремя похожими именами, такими как **PR_ACCOUNT,** **PR_ACCOUNT_A** и **PR_ACCOUNT_W,** которые имеют тип PT_TSTRING, PT_STRING8 и PT_UNICODE соответственно.
  
Дополнительные сведения о типах свойств и макросах, связанных с типами, см. в файле загона MAPI Mapidefs.h.
  
### <a name="identifying-similar-properties"></a>Определение похожих свойств

В текущей среде свойств MAPI часто можно обнаружить, что свойство было выявлено под разными именами свойств, все из которых определены с одним идентификатором свойства. Например, помеченные свойства, **PR_BUSINESS2_TELEPHONE_NUMBER** **и PR_OFFICE2_TELEPHONE_NUMBER**, определяются в Mapitags.h таким же идентификатором и типом свойства. С этими двумя свойствами тесно связаны:
  
- **PR_BUSINESS2_TELEPHONE_NUMBER_A**
    
- **PR_BUSINESS2_TELEPHONE_NUMBER_W**
    
- **PR_OFFICE2_TELEPHONE_NUMBER_A**
    
- **PR_OFFICE2_TELEPHONE_NUMBER_W**
    
Свойства с суффиксом _A введите как PT_STRING8, а свойства с суффиксом _W — как PT_UNICODE.
  
В этом примере каноническое свойство **PidTagBusiness2TelephoneNumber** предназначено для упрощения ссылки на такие близко связанные свойства MAPI с помощью одного идентификатора и согласованного (с использованием префикса Pid) всех свойств MAPI. Чтобы узнать, какие реальные свойства MAPI представляет каноническое свойство, см. в поддомене Сопоставление имен канонических свойств [с именами MAPI.](mapping-canonical-property-names-to-mapi-names.md) Чтобы найти каноническое свойство, с которое связано свойство MAPI, см. "Сопоставление имен [MAPI с каноническими именами свойств".](mapping-mapi-names-to-canonical-property-names.md)
  
## <a name="mapi-support-of-canonical-property-names"></a>MAPI Support of Canonical Property Names

Поскольку канонические свойства не являются реальными свойствами и не определены в файлах заголовок MAPI, имена канонических свойств не следует использовать в коде; вместо этого следует продолжать использовать точные имена свойств MAPI в коде. Например, вы можете  ссылаться на PR_BUSINESS2_TELEPHONE_NUMBER и **PR_OFFICE2_TELEPHONE_NUMBER** за пределами кода как **PidTagBusiness2TelephoneNumber,** а также использовать PR_BUSINESS2_TELEPHONE_NUMBER или PR_OFFICE2_TELEPHONE_NUMBER **в** коде.  
  
Если в коде необходимо использовать имена канонических свойств, необходимо сначала определить их в собственных файлах заголовок.
  
## <a name="canonical-property-names-and-exchange-protocol-specifications"></a>Имена канонических свойств и спецификации протокола Exchange

На канонические имена ссылается Microsoft Exchange Server протоколов, которые используются Exchange Server для связи с другими продуктами Майкрософт. Дополнительные сведения о свойствах объектов сообщений, на которые ссылается спецификация протокола Exchange, см. [в [MS-OXPROPS]](https://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx).
  
## <a name="see-also"></a>См. также



[Теги свойств MAPI](mapi-property-tags.md)
  
[Обзор идентификаторов свойств MAPI](mapi-property-identifier-overview.md)
  
[Обзор типов свойств MAPI](mapi-property-type-overview.md)


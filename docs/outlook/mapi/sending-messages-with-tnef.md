---
title: Отправка сообщений с помощью TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6e2df265-b9dd-4e19-8ca5-3e31804e9120
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7ff7f79b5e74412e9bbb4b4882c6a7d45e50fe6a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32338495"
---
# <a name="sending-messages-with-tnef"></a>Отправка сообщений с помощью TNEF

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Многие поставщики транспорта автоматически отправляют все исходящие сообщения с помощью формата TNEF, не зависящем от транспорта. ФОРМАТ TNEF используется для передачи форматированного текста, поддерживаемого многими клиентами и поставщиками хранилищ сообщений в сообщениях, вложениями различных типов и пользовательскими свойствами для пользовательских классов сообщений. Несмотря на то, что режим по умолчанию для большинства поставщиков транспорта предназначен для отправки исходящих сообщений в формате TNEF, некоторые поставщики транспорта их не поддерживают. Недостаток поддержки формата TNEF не является причиной для стандартных клиентов обмена сообщениями, которые отправляют и получают сообщения IPM. Тем не менее, для клиентов на основе форм или клиентов, которым требуются настраиваемые свойства, использование формата TNEF является обязательным. Разработчикам клиентов, использующих формы или настраиваемые свойства, необходимо знать о возможностях используемых ими поставщиков транспорта.
  
Получатели сообщения могут управлять тем, передает ли поставщик транспорта сообщения в формате TNEF, задав свойство **пр_сенд_рич_инфо** . Дополнительные сведения см. в статье **пр_сенд_рич_инфо** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)). Если свойство **пр_сенд_рич_инфо** получателя имеет значение true, то поставщик транспорта, ПОДДЕРЖИВАЮЩИЙ формат TNEF, передает его вместе с сообщением. Если для этого свойства задано значение FALSE, форматирование отбрасывается. Если **пр_сенд_рич_инфо** не существует, то поставщик транспорта может выбрать стандартный курс действий. 
  
Когда клиенты и поставщики услуг создают настраиваемый получатель, они могут влиять на значение свойства **пр_сенд_рич_инфо** , ПЕРЕДАВ флаг мапи_сенд_но_рич_инфо в параметре _ulFlags_ в **IAddrBook:: креатеонеофф** или ** Имаписуппорт:: Креатеонеофф** Call. Дополнительные сведения см. в статье [IAddrBook:: креатеонеофф](iaddrbook-createoneoff.md) and [Имаписуппорт:: креатеонеофф](imapisupport-createoneoff.md). Передача МАПИ_СЕНД_НО_РИЧ_ИНФО приводит к тому, что для свойства **пр_сенд_рич_инфо** пользовательского получателя устанавливается значение false; в большинстве случаев передача флага приводит к тому, что MAPI присвойте свойству значение TRUE. Единственным исключением является то, что пользовательский адрес получателя интерпретируется как Интернет-адрес. В этом случае MAPI устанавливает для **ПР_СЕНД_РИЧ_ИНФО** значение false. 
  


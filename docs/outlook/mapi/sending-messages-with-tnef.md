---
title: Отправка сообщений с помощью TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6e2df265-b9dd-4e19-8ca5-3e31804e9120
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7ff7f79b5e74412e9bbb4b4882c6a7d45e50fe6a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33420852"
---
# <a name="sending-messages-with-tnef"></a>Отправка сообщений с помощью TNEF

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Многие поставщики транспорта автоматически отправляют все исходящие сообщения с помощью формата TNEF, не зависящем от транспорта. Формат TNEF используется для передачи форматированного текста, поддерживаемого многими клиентами и поставщиками хранилищ сообщений в сообщениях, вложениями различных типов и пользовательскими свойствами для пользовательских классов сообщений. Несмотря на то, что режим по умолчанию для большинства поставщиков транспорта предназначен для отправки исходящих сообщений в формате TNEF, некоторые поставщики транспорта их не поддерживают. Недостаток поддержки формата TNEF не является причиной для стандартных клиентов обмена сообщениями, которые отправляют и получают сообщения IPM. Тем не менее, для клиентов на основе форм или клиентов, которым требуются настраиваемые свойства, использование формата TNEF является обязательным. Разработчикам клиентов, использующих формы или настраиваемые свойства, необходимо знать о возможностях используемых ими поставщиков транспорта.
  
Получатели сообщения могут управлять тем, передает ли поставщик транспорта сообщения в формате TNEF, задав свойство **PR_SEND_RICH_INFO** . Дополнительные сведения см **PR_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)). Если для свойства **PR_SEND_RICH_INFO** получателя ЗАДАНО значение true, то поставщик транспорта, ПОДДЕРЖИВАЮЩИЙ формат TNEF, передает его вместе с сообщением. Если для этого свойства задано значение FALSE, форматирование отбрасывается. Если **PR_SEND_RICH_INFO** не существует, то поставщик транспорта может выбрать стандартный курс действий. 
  
Когда клиенты и поставщики услуг создают настраиваемый получатель, они могут влиять на значение его свойства **PR_SEND_RICH_INFO** , передав флаг MAPI_SEND_NO_RICH_INFO в параметре _ulFlags_ в **IAddrBook:: Креатеонеофф** или **имаписуппорт:: креатеонеофф** Call. Дополнительные сведения см. в статье [IAddrBook:: креатеонеофф](iaddrbook-createoneoff.md) and [Имаписуппорт:: креатеонеофф](imapisupport-createoneoff.md). Передача MAPI_SEND_NO_RICH_INFO приводит к тому, что для свойства **PR_SEND_RICH_INFO** пользовательского получателя устанавливается значение false; в большинстве случаев передача флага приводит к тому, что MAPI присвойте свойству значение TRUE. Единственным исключением является то, что пользовательский адрес получателя интерпретируется как Интернет-адрес. В этом случае MAPI задает для **PR_SEND_RICH_INFO** значение false. 
  


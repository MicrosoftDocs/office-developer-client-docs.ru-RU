---
title: Отправка сообщений с помощью TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6e2df265-b9dd-4e19-8ca5-3e31804e9120
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7ff7f79b5e74412e9bbb4b4882c6a7d45e50fe6a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33420852"
---
# <a name="sending-messages-with-tnef"></a>Отправка сообщений с помощью TNEF

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Многие поставщики транспорта автоматически отправляют все исходяющие сообщения в формате TNEF. Формат TNEF используется для передачи форматированный текст, поддерживаемый многими клиентами и поставщиками store сообщений в сообщениях, вложениях различных типов и настраиваемые свойства для настраиваемого класса сообщений. Хотя режим по умолчанию для большинства поставщиков транспорта — отправка исходяющих сообщений с помощью TNEF, некоторые поставщики транспорта не поддерживают его. Отсутствие поддержки TNEF не является проблемой для стандартных клиентов обмена сообщениями, которые отправляют и получают сообщения IPM. Однако для клиентов на основе форм, которые требуют настраиваемые свойства, важно использовать формат TNEF. Разработчики клиентов, которые используют формы или настраиваемые свойства, должны знать о возможностях поставщиков транспорта, которые они используют.
  
Получатели сообщений могут контролировать, передает ли поставщик транспорта сообщения с помощью TNEF, **PR_SEND_RICH_INFO** свойства. Дополнительные сведения **см. в PR_SEND_RICH_INFO** ([PidTagSendRichInfo).](pidtagsendrichinfo-canonical-property.md) Если для свойства **PR_SEND_RICH_INFO** получателя установлено true, поставщик транспорта, который поддерживает TNEF, передает его вместе с сообщением. Если для свойства установлено false, форматирование удаляется. Если **PR_SEND_RICH_INFO** не существует, поставщик транспорта может выбрать курс действий по умолчанию. 
  
Когда клиенты и поставщики услуг создают настраиваемого получателя, они могут повлиять на значение свойства **PR_SEND_RICH_INFO,** передав флаг MAPI_SEND_NO_RICH_INFO в _параметре ulFlags_ в **вызов IAddrBook::CreateOneOff** или **IMAPISupport::CreateOneOff.** Дополнительные сведения см. в книге [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff.](imapisupport-createoneoff.md) Передача MAPI_SEND_NO_RICH_INFO заставляет MAPI установить для свойства PR_SEND_RICH_INFO пользовательского получателя **PR_SEND_RICH_INFO** false; В большинстве случаев при не передаче флага MAPI задает свойству true. Исключением является, если адрес настраиваемой получателя интерпретируется как адрес Интернета. В этой ситуации MAPI **PR_SEND_RICH_INFO** false. 
  


---
title: Структура потока FieldDefinition
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 93acdbc8-381f-45d5-be6c-0cad066269fe
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 98584e450bb820dbce05b0f8d2c6d15551586130
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334897"
---
# <a name="fielddefinition-stream-structure"></a>Структура потока FieldDefinition

**Область применения**: Outlook 2013 | Outlook 2016 
  
Структура потока FieldDefinition содержит либо определение поля, заданное пользователем, либо набор параметров привязки к данным для встроенного поля.
  
Можно программно управлять структурой потока FieldDefinition, если структура содержит определение поля, определяемого пользователем. Не следует попытаться создать или изменить структуру FieldDefinition программным способом, если структура содержит параметры для встроенного поля. Используйте конструктор форм Microsoft Outlook, чтобы поддерживать такие параметры для встроенных полей.
  
> [!NOTE]
> Outlook поддерживает два формата определений полей: PropDefV1 и PropDefV2. Формат PropDefV1 определений полей содержит следующие элементы данных: flags, VT, DISPID, Нмиднамеленгс, Нмиднаме, Намеанси, Формулаанси, Валидатионрулеанси, Валидатионтекстанси и ErrorANSI. Формат PropDefV2 содержит одни и те же элементы, а также элементы Интерналтипе и Скипблоккс. 
>
> Outlook не поддерживает версию Юникода для элементов данных Формулаанси, Валидатионрулеанси и Валидатионтекстанси в формате определения поля PropDefV2. Если эти элементы содержат символы, не входящие в набор ASCII, эти символы могут интерпретироваться в зависимости от кодовой страницы ANSI компьютера, на котором выполняется Outlook. Поэтому для этих элементов данных следует использовать только строковые значения, состоящие из символов ASCII целиком. 
  
Элементы данных в этом потоке хранятся в порядке байтов с прямым порядком байтов, сразу после друг друга в порядке, указанном ниже.
  
- Flags: DWORD (4 байта), сочетание нулевого или большего числа флагов, значения и значения которых перечислены в следующей таблице.
    
    |**Имя флага**|**Value**|**Описание**|
    |:-----|:-----|:-----|
    |ПДО_ИС_КУСТОМ  <br/> |0x00000001  <br/> |Структура FieldDefinition содержит определение определяемого пользователем поля.  <br/> |
    |ПДО_РЕКУИРЕД  <br/> |0x00000002  <br/> |Для элемента управления формы, привязанного к этому полю, для **этого поля необходимо указать значение** , установленное на вкладке " **Проверка** " диалогового окна " **Свойства** ".  <br/> |
    |ПДО_ПРИНТ_САВЕАС  <br/> |0x00000004  <br/> |Для элемента управления формы, привязанного к этому полю, установите флажок **включить это поле для печати и сохранить как** на вкладке " **Проверка** " диалогового окна " **Свойства** ".  <br/> |
    |ПДО_КАЛК_АУТО  <br/> |0x00000008  <br/> |Для элемента управления формы, привязанного к этому полю, установите флажок **вычислить эту формулу автоматически** на вкладке " **значение** " диалогового окна " **Свойства** ".  <br/> |
    |ПДО_ФТ_КОНКАТ  <br/> |0x00000010  <br/> |Это поле с типом " **комбинация** ", в котором есть **присоединяемые поля и фрагменты текста с другими** параметрами, выбранными в диалоговом окне " **комбинирование поля формулы** ".  <br/> |
    |ПДО_ФТ_СВИТЧ  <br/> |0x00000020  <br/> |Это поле имеет тип **комбинация** и **отображает только первое непустое поле,** в диалоговОм окне **комбинированной формулы** выбран параметр, игнорирующий последующие.  <br/> |
    |ПДО_ПРИНТ_САВЕАС_ДЕФ  <br/> |0x00000040  <br/> |Этот флаг не используется в Outlook, но он включен для всех пользовательских определений полей.  <br/> |
   
- VT: WORD (2 байта), тип данных поля, который является константой из перечисления [варенум](https://msdn.microsoft.com/library/system.runtime.interopservices.varenum.aspx) . 
    
- DISPID: DWORD (4 байта), идентификатор диспетчеризации поля. Для определенного пользователем поля значение равно 0.
    
- Нмиднамеленгс: WORD (2 байта), количество элементов в массиве Нмиднаме.
    
- Нмиднаме: массив типа WCHAR. Для определения поля, определяемого пользователем, это представление в Юникоде (UTF-16) имени поля. Количество этого массива равно Нмиднамеленгс.
    
- Намеанси: структура потока [PackedAnsiString](packedansistring-stream-structure.md) . Это представление имени поля в формате ANSI. 
    
- Формулаанси: структура потока PackedAnsiString. Это представление формулы вычисления для поля в формате ANSI. Он отображается в разделе " **начальНое значение** " вкладки " **значение** " диалогового окна **свойств** элемента управления формы, связанного с этим полем. 
    
- Валидатионрулеанси: структура потока PackedAnsiString. Это представление формулы проверки поля в формате ANSI. Он отображается в текстовом поле **формулы проверки** на вкладке " **Проверка** " диалогового окна **свойств** элемента управления формы, связанного с этим полем. 
    
- Валидатионтекстанси: структура потока PackedAnsiString. Это представление текста ошибки проверки поля в формате ANSI. Он отображается в текстовом поле для **отображения этого сообщения, если проверка не удалась** на вкладке " **Проверка** " диалогового окна **свойств** элемента управления формы, связанного с этим полем. 
    
- Ерроранси: структура потока PackedAnsiString. Outlook не использует этот элемент; для этого элемента необходимо задать пустую строку.
    
- Интерналтипе: DWORD (4 байта), внутренний тип поля. Этот элемент Data присутствует, только если формат определения поля — PropDefV2. Внутренний тип — это одно из следующих значений, каждое из которых соответствует типу в диалоговом окне " **Создание поля** " для полей, определяемых пользователем. 
    
    |**Внутреннее имя типа**|**Значение**|**Соответствующий тип в диалоговом окне " **Создание поля** "**|
    |:-----|:-----|:-----|
    |Итипестринг  <br/> |нуль  <br/> |**Text** <br/> |
    |Итипенумбер  <br/> |1,1  <br/> |**Number** <br/> |
    |Итипеперцент  <br/> |2  <br/> |**Percent** <br/> |
    |Денежный  <br/> |4  <br/> |**Currency** <br/> |
    |Итипебул  <br/> |SP4  <br/> |**Да или нет** <br/> |
    |Итипедатетиме  <br/> |17:00  <br/> |**Дата и время** <br/> |
    |Итипедуратион  <br/> |ICMPv6  <br/> |**Duration** <br/> |
    |Итипекомбинатион  <br/> |см  <br/> |****, При этом в диалоговом окне **комбинация поля формулы** выбран параметр **, игнорирующий все последующие непустые поля** .  <br/> |
    |Итипеформула  <br/> |8,5  <br/> |**Formula** <br/> |
    |Итипересулт  <br/> |10  <br/> |Этот тип не используется для полей, определяемых пользователем.  <br/> |
    |Итипевариант  <br/> |десяти  <br/> |Этот тип не используется для полей, определяемых пользователем.  <br/> |
    |Итипефлоатресулт  <br/> |-11:00  <br/> |Этот тип не используется для полей, определяемых пользователем.  <br/> |
    |Итипеконкат  <br/> |12  <br/> |**Комбинацию**, с **полями присоединения и текстовыми фрагментами с другими** параметрами, выбранными в диалоговом окне **комбинация поля формулы** .  <br/> |
    |Итипекэйвордс  <br/> |13  <br/> |**Недопустим** <br/> |
    |Итипеинтежер  <br/> |14  <br/> |**Integer** <br/> |
   
- Скипблоккс: ряд из одной или нескольких структур потоков [SkipBlock](skipblock-stream-structure.md) . Этот элемент Data присутствует, только если формат определения поля — PropDefV2. Если в качестве формата определения поля задано значение PropDefV2, ряд должен содержать по крайней мере одну структуру SkipBlock, SkipBlock структуру, в которой элемент данных size равен 0, а ряд должен начинаться и завершаться с помощью этой структуры SkipBlock. 
    
   Цель структуры SkipBlock зависит от ее относительного положения в ряду Скипблоккс. Если определение поля имеет формат PropDefV2 и первая структура не является завершающей (элемент данных size больше 0), то в Outlook предполагается, что первая структура SkipBlock указывает имя поля в Юникоде (UTF-16). 
    
   > [!IMPORTANT]
   > Если первый SkipBlock является завершающей структурой, элемент данных Намеанси используется для определения имени поля. Если эта строка содержит какие-либо символы, не входящие в набор ASCII, эти символы могут интерпретироваться в зависимости от кодовой страницы ANSI компьютера, на котором выполняется Outlook. Чтобы предотвратить подобные несоответствия, обязательно указывайте первый SkipBlock в создаваемых определениях полей, по крайней мере, если имя поля содержит символы, не входящие в набор ASCII. 
  
   Если в будущей версии формата определения поля вводятся дополнительные фрагменты данных в потоке FieldDefinition, эти данные могут храниться в виде дополнительных структур потока SkipBlock в серии Скипблоккс перед завершающей структурой SkipBlock с Размер элемента данных равен 0. Более ранние версии Outlook могут спокойно игнорировать эти дополнительные структуры SkipBlock вплоть до структуры завершения SkipBlock и правильно обрабатывать все поддерживаемые ими блоки.
    
## <a name="see-also"></a>См. также

- [Элементы и поля Outlook](outlook-items-and-fields.md)
- [Структуры потока](stream-structures.md)
- [Структура потока PropertyDefinition](propertydefinition-stream-structure.md)


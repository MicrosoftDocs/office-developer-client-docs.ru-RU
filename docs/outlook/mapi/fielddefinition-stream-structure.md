---
title: Структура потока FieldDefinition
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 93acdbc8-381f-45d5-be6c-0cad066269fe
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 98584e450bb820dbce05b0f8d2c6d15551586130
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334897"
---
# <a name="fielddefinition-stream-structure"></a>Структура потока FieldDefinition

**Относится к**: Outlook 2013 | Outlook 2016 
  
Структура потока FieldDefinition содержит определение поля, определяемого пользователем, или набор параметров привязки данных для встроенного поля.
  
Вы можете программным образом управлять структурой потока FieldDefinition, если она содержит определение поля пользовательского поля. Не следует пытаться программным образом создать или изменить структуру FieldDefinition, если структура содержит параметры для встроенного поля. Для поддержки таких параметров для встроенных полей следует использовать конструктор форм Microsoft Outlook.
  
> [!NOTE]
> Outlook поддерживает два формата определений полей: PropDefV1 и PropDefV2. Формат определений полей PropDefV1 содержит следующие элементы данных: Flags, VT, DispId, NmidNameLength, NmidName, NameANSI, FormulaANSI, ValidationRuleANSI, ValidationTextANSI и ErrorANSI. Формат PropDefV2 содержит те же элементы и элементы InternalType и SkipBlocks. 
>
> Outlook не поддерживает версию Юникода для элементов данных FormulaANSI, ValidationRuleANSI и ValidationTextANSI в формате определения поля PropDefV2. Если эти элементы содержат символы, не содержащие символы ASCII, эти символы могут быть интерпретируются несогласованно в зависимости от кодовой страницы ANSI компьютера, на котором работает Outlook. Поэтому для этих элементов данных следует использовать только строки, состоящие исключительно из символов ASCII. 
  
Элементы данных в этом потоке хранятся в порядок с небольшим набором элементов, сразу же после друг друга в указанном ниже порядке.
  
- Flags: DWORD (4 bytes), сочетание нулевого или нескольких флагов, значения и значения которых перечислены в следующей таблице.
    
    |**Имя флага**|**Значение**|**Описание**|
    |:-----|:-----|:-----|
    |PDO_IS_CUSTOM  <br/> |0x00000001  <br/> |Структура FieldDefinition содержит определение пользовательского поля.  <br/> |
    |PDO_REQUIRED  <br/> |0x00000002  <br/> |Для объекта управления формы, привязанного к этому полю, для этого поля  на вкладке  "Проверка" диалогового окна "Свойства" должен быть выбран значение **A.**  <br/> |
    |PDO_PRINT_SAVEAS  <br/> |0x00000004  <br/> |Для объекта управления формы, привязанного к  этому полю, на вкладке "Проверка" диалоговое  окно "Свойства" будет выбрано поле "Включить" для печати и "Сохранить как".   <br/> |
    |PDO_CALC_AUTO  <br/> |0x00000008  <br/> |Для объекта управления формы, привязанного к  этому полю, на вкладке "Значение" диалоговых окна "Свойства" автоматически выбирается значение этой формулы.    <br/> |
    |PDO_FT_CONCAT  <br/> |0x00000010  <br/> |Это поле типа **"Комбинация",**  в диалоговом окне "Сочетание полей  формулы" выбраны поля "Присоединение" и все фрагменты текста.  <br/> |
    |PDO_FT_SWITCH  <br/> |0x00000020  <br/> |Это поле имеет тип **Combination** и содержит только первое непустые **поля,** игнорируя последующие параметры, выбранные в диалоговом окне **"Сочетание поля** формулы".  <br/> |
    |PDO_PRINT_SAVEAS_DEF  <br/> |0x00000040  <br/> |Этот флаг не используется в Outlook, но он включен для всех пользовательских определений полей.  <br/> |
   
- VT: WORD (2 байта), тип данных поля, который является константой из enumeration [VARENUM.](https://msdn.microsoft.com/library/system.runtime.interopservices.varenum.aspx) 
    
- DispId: DWORD (4 bytes), идентификатор отправки поля. Для поля, определяемого пользователем, значением является 0.
    
- NmidNameLength: WORD (2 bytes), количество элементов в массиве NmidName.
    
- NmidName: массив WCHAR. Для определения поля, определяемого пользователем, это представление имени поля в коде Юникод (UTF-16). Количество массивов равно NmidNameLength.
    
- NameANSI: структура [потока PackedAnsiString.](packedansistring-stream-structure.md) Это представление имени поля в anSI. 
    
- FormulaANSI: структура потока PackedAnsiString. Это anSI-представление формулы вычислений для поля. Оно отображается в разделе **"Начальное** значение"  вкладки **"Значение"** диалоговых окна "Свойства" для объекта управления формы, привязанного к этому полю. 
    
- ValidationRuleANSI: структура потока PackedAnsiString. Это anSI-представление формулы проверки поля. Оно отображается в текстовом поле **"Формула** проверки" на вкладке "Проверка" диалогового **окна** "Свойства" для объекта управления формы, привязанного к этому полю.  
    
- ValidationTextANSI: структура потока PackedAnsiString. Это an ANSI-представление текста сбоя проверки поля. Оно отображается в текстовом поле для отображения этого сообщения, если не  удается получить проверку на вкладке "Проверка" диалогового окна "Свойства" привязанного к этому полю объекта управления формы.   
    
- ErrorANSI: структура потока PackedAnsiString. Outlook не использует этот элемент; Следует установить для этого элемента пустую строку.
    
- InternalType: DWORD (4 bytes), внутренний тип поля. Этот элемент данных присутствует, только если формат определения поля — PropDefV2. Внутренний тип — это одно из следующих значений, каждое из которых соответствует типу в диалоговом окне "Новое поле" для пользовательских полей.  
    
    |**Имя внутреннего типа**|**Значение**|**Соответствующий тип в **диалоговом окне "Новое** поле"**|
    |:-----|:-----|:-----|
    |iTypeString  <br/> |0  <br/> |**Text** <br/> |
    |iTypeNumber  <br/> |1   <br/> |**Number** <br/> |
    |iTypePercent  <br/> |2   <br/> |**Percent** <br/> |
    |Валюта  <br/> |3   <br/> |**Currency** <br/> |
    |iTypeBool  <br/> |4   <br/> |**Да или нет** <br/> |
    |iTypeDateTime  <br/> |5   <br/> |**Дата/время** <br/> |
    |iTypeDuration  <br/> |6   <br/> |**Duration** <br/> |
    |iTypeCombination  <br/> |7   <br/> |**Сочетание**, с отображением только первого **непустого поля,** игнорируя последующие параметры, выбранные в диалоговом окне **"Поле** комбинации формул".  <br/> |
    |iTypeFormula  <br/> |8   <br/> |**Formula** <br/> |
    |iTypeResult  <br/> |9   <br/> |Этот тип не используется для пользовательских полей.  <br/> |
    |iTypeVariant  <br/> |10   <br/> |Этот тип не используется для пользовательских полей.  <br/> |
    |iTypeFloatResult  <br/> |11  <br/> |Этот тип не используется для пользовательских полей.  <br/> |
    |iTypeConcat  <br/> |12   <br/> |**Сочетание** с полями присоединения и **любыми** фрагментами текста друг с другом, выбранными в диалоговом окне **"Поле** формулы сочетания".  <br/> |
    |iTypeKeywords  <br/> |13   <br/> |**Ключевое слово** <br/> |
    |iTypeInteger  <br/> |14   <br/> |64-разрядное целое число. <br/> |
   
- SkipBlocks: серия из одной или более структур [потока SkipBlock.](skipblock-stream-structure.md) Этот элемент данных присутствует, только если формат определения поля — PropDefV2. Если формат определения поля — PropDefV2, ряд должен содержать по крайней мере одну структуру SkipBlock, структуру SkipBlock с элементом данных Size, равным 0, и ряд должен начинаться и заканчиваться этой структурой SkipBlock. 
    
   Назначение структуры SkipBlock зависит от относительного положения в серии SkipBlocks. Если определение поля имеет формат PropDefV2 и первая структура не является структурой прерывания (элемент данных Size больше 0), Outlook предполагает, что первая структура SkipBlock указывает имя поля в Юникоде (UTF-16). 
    
   > [!IMPORTANT]
   > Если первый SkipBlock является завершающими структурами, для определения имени поля используется элемент данных NameANSI. Если эта строка содержит какие-либо символы, не относимые к ASCII, эти символы могут быть интерпретируются несогласованно в зависимости от кодовой страницы ANSI компьютера, на котором запущен Outlook. Чтобы избежать таких несоответствий, всегда указывайте первый SkipBlock в определениях полей, которые вы создаете, по крайней мере, если имя поля содержит символы, не относимые к ASCII. 
  
   Если в будущей версии формата определения поля в потоке FieldDefinition будут вводиться дополнительные данные, эти данные можно сохранить в виде дополнительных структур потока SkipBlock в серии SkipBlocks перед завершающими структурами SkipBlock, для элемента данных Size на которые имеется элемент Size, равный 0. Более ранние версии Outlook могут безопасен игнорировать эти дополнительные структуры SkipBlock в зависимости от завершаемой структуры SkipBlock и по-прежнему правильно обрабатывать все поддерживаемые блоки.
    
## <a name="see-also"></a>См. также

- [Элементы и поля Outlook](outlook-items-and-fields.md)
- [Структуры потоков](stream-structures.md)
- [Структура потока PropertyDefinition](propertydefinition-stream-structure.md)


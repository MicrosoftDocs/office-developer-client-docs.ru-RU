---
title: Структура FieldDefinition потока
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 93acdbc8-381f-45d5-be6c-0cad066269fe
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 98584e450bb820dbce05b0f8d2c6d15551586130
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25383277"
---
# <a name="fielddefinition-stream-structure"></a>Структура FieldDefinition потока

**Относится к**: Outlook 2013 | Outlook 2016 
  
Определение поля, пользовательские поля или набора параметров привязки данных для встроенных полей, содержащихся в структуре FieldDefinition потока.
  
Можно программно работать структуру потока FieldDefinition Если структура содержит определение поля, пользовательские поля. Не следует пытаться программным путем создания или изменения структуры FieldDefinition Если структура содержит параметры для встроенных поля. Для поддержки таких параметров для встроенных полей следует использовать конструктор форм Microsoft Outlook.
  
> [!NOTE]
> Outlook поддерживает два формата определения полей: PropDefV1 и PropDefV2. Формат PropDefV1 определения полей содержит следующие элементы данных: флаги, VT, DispId, NmidNameLength, NmidName, NameANSI, FormulaANSI, ValidationRuleANSI, ValidationTextANSI и ErrorANSI. Формат PropDefV2 содержит те же элементы и элементы InternalType и SkipBlocks. 
>
> Outlook не поддерживает версии Юникод для FormulaANSI, ValidationRuleANSI и ValidationTextANSI элементов данных в формат определения поля PropDefV2. Если эти элементы символами, отличные от ASCII, эти символы несогласованно приводится в зависимости от кодовой страницы ANSI компьютера, на котором выполняется Outlook. Таким образом следует использовать только строковые значения, которые состоят только из знаков ASCII для этих элементов данных. 
  
Элементы данных в этот поток хранятся в прямом байтовом, сразу после друг с другом в указанном порядке.
  
- Флаги: Значение DWORD (4 байта), комбинация флагов ноль или больше, чьи значения и значения перечислены в следующей таблице.
    
    |**Имя флага**|**Значение**|**Описание**|
    |:-----|:-----|:-----|
    |PDO_IS_CUSTOM  <br/> |0x00000001  <br/> |Структура FieldDefinition содержит определение поля, выбранные пользователем.  <br/> |
    |PDO_REQUIRED  <br/> |0x00000002  <br/> |Для управления формы, связанного с данным полем для **значение является обязательным для этого поля** флажок на вкладке **проверки** диалогового окна **Свойства** .  <br/> |
    |PDO_PRINT_SAVEAS  <br/> |0x00000004  <br/> |Элементов управления формы, связанных с данным полем флажок для **Включить это поле для печати и сохранить как** установлен на вкладке **проверки** диалогового окна **Свойства** .  <br/> |
    |PDO_CALC_AUTO  <br/> |0x00000008  <br/> |Для управления формы, связанного с данным полем для **вычисления эту формулу, автоматически** установлен флажок на вкладке **значение** диалоговое окно " **Свойства** ".  <br/> |
    |PDO_FT_CONCAT  <br/> |0x00000010  <br/> |Это поле **сочетание** типа и имеет **присоединяется поля и любые фрагменты текста друг с другом** параметр в диалоговое окно его **Сочетание формулу поля** .  <br/> |
    |PDO_FT_SWITCH  <br/> |0x00000020  <br/> |Это поле имеет тип **комбинации** и выбрал параметр **Отображение только первое поле пустым, пропуская последующие** в диалоговом окне **Сочетание формулу поля** .  <br/> |
    |PDO_PRINT_SAVEAS_DEF  <br/> |0x00000040  <br/> |Этот флаг не используется с Outlook, но она включена для всех определений пользовательских полей.  <br/> |
   
- VT: WORD (2 байта), тип данных поля, который — константа из перечисления [VARENUM](https://msdn.microsoft.com/library/system.runtime.interopservices.varenum.aspx) . 
    
- DispId: Значение DWORD (4 байта), идентификатор поля. Для пользовательских полей значение равно 0.
    
- NmidNameLength: WORD (2 байта), число элементов в массиве NmidName.
    
- NmidName: Массив WCHAR. Для определения пользовательских полей это представление Юникод (UTF-16) имя поля. Число этого массива равно NmidNameLength.
    
- NameANSI: [PackedAnsiString](packedansistring-stream-structure.md) потока структура. Это представление ANSI имя поля. 
    
- FormulaANSI: PackedAnsiString потока структура. Это представлением ANSI Формула расчета для поля. Он отображается в разделе **Исходное значение** на вкладке **значение** диалоговое окно **Свойства** элемента управления формы, связанного с данным полем. 
    
- ValidationRuleANSI: PackedAnsiString потока структура. Это представление в формате ANSI Формула проверки полей. Он отображается в текстовом поле для **Проверки формулы** на вкладке **Проверка** диалоговое окно **Свойства** элемента управления формы, связанного с данным полем. 
    
- ValidationTextANSI: PackedAnsiString потока структура. Это представление в формате ANSI текст сообщения об ошибке проверки полей. Он отображается в текстовом поле для **отображения этого сообщения, если не удается выполнить проверку** на вкладке **Проверка** диалоговое окно **Свойства** элемента управления формы, связанного с данным полем. 
    
- ErrorANSI: PackedAnsiString потока структура. Outlook не использует этот элемент; Этот элемент следует устанавливать пустую строку.
    
- InternalType: Значение DWORD (4 байта) внутреннего типа поля. Этот элемент данных присутствует только в том случае, если PropDefV2 имеет формат определения поля. Внутренний тип — это один из следующих значений, каждое из которых соответствует типу в диалоговом окне **Новое поле** для пользовательских полей. 
    
    |**Имя внутреннего типа**|**Значение**|**Соответствующий тип в диалоговое окно " **Новое поле** "**|
    |:-----|:-----|:-----|
    |iTypeString  <br/> |0  <br/> |**Text** <br/> |
    |iTypeNumber  <br/> |1  <br/> |**Число** <br/> |
    |iTypePercent  <br/> |2  <br/> |**Процент** <br/> |
    |Денежный  <br/> |3  <br/> |**Валюта** <br/> |
    |iTypeBool  <br/> |4  <br/> |**Yes/No** (Да или нет) <br/> |
    |iTypeDateTime  <br/> |5  <br/> |**Дата/время** <br/> |
    |iTypeDuration  <br/> |6  <br/> |**Срок действия** <br/> |
    |iTypeCombination  <br/> |7  <br/> |**Комбинация**, **Отображение только первое поле пустым, пропуская последующие** флажок в диалоговом окне **Сочетание формулу поля** .  <br/> |
    |iTypeFormula  <br/> |8  <br/> |**Формулы** <br/> |
    |iTypeResult  <br/> |9  <br/> |Этот тип не используется для пользовательских полей.  <br/> |
    |iTypeVariant  <br/> |10  <br/> |Этот тип не используется для пользовательских полей.  <br/> |
    |iTypeFloatResult  <br/> |11  <br/> |Этот тип не используется для пользовательских полей.  <br/> |
    |iTypeConcat  <br/> |12  <br/> |**Комбинация**, с параметром **присоединяется поля и любые фрагменты текста друг с другом** , выбранные в диалоговом окне **Сочетание формулу поля** .  <br/> |
    |iTypeKeywords  <br/> |13  <br/> |**Keyword** <br/> |
    |iTypeInteger  <br/> |14  <br/> |**Integer** <br/> |
   
- SkipBlocks: Последовательность одного или нескольких структур [SkipBlock](skipblock-stream-structure.md) потока. Этот элемент данных присутствует только в том случае, если PropDefV2 имеет формат определения поля. Если формат определения поля PropDefV2, серии должен содержать по крайней мере один SkipBlock структуры, структура SkipBlock, имеющей равно 0, элемент данных размер и ряд следует начать и завершать эту структуру SkipBlock. 
    
   Назначение структура SkipBlock зависит от его относительное положение в последовательности SkipBlocks. Если определение поля в формате PropDefV2 и первого структура не прерывающие структура (элемент данных размером больше 0), Outlook предполагается, что первая структура SkipBlock указывает имя поля в кодировке Юникод (UTF-16). 
    
   > [!IMPORTANT]
   > Если первый SkipBlock прерывающие структуры, элемент данных NameANSI используется для определения имени поля. Если эта строка содержит отличные от ASCII символы, эти символы несогласованно приводится в зависимости от кодовой страницы ANSI компьютера, на котором выполняется Outlook. Чтобы запретить несоответствий, убедитесь, что всегда укажите первый SkipBlock в определения полей, созданные вами, по крайней мере при имя поля включает в себя символы, отличные от ASCII. 
  
   Если будущая версия формат определения поля представлены дополнительные части данных в потоке FieldDefinition, эти данные могут храниться как дополнительные структуры SkipBlock потока в серии SkipBlocks перед прерывающие структура SkipBlock, имеющей Элемент data размер равно 0. Более ранних версиях Outlook можно спокойно проигнорировать эти дополнительные структуры SkipBlock до выполнения определенного SkipBlock структуры и по-прежнему правильно обрабатывать все блоки, которые они поддерживают.
    
## <a name="see-also"></a>См. также

- [Поля и элементы Outlook](outlook-items-and-fields.md)
- [Структуры потоков](stream-structures.md)
- [Структура потока PropertyDefinition](propertydefinition-stream-structure.md)


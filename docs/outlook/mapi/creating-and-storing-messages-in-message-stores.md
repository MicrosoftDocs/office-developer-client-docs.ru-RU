---
title: �������� � �������� ��������� � �������� ���������
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cc74b31c-d7ed-4fcf-9535-a2f9222901b7
description: '���� ���������� ���������: 23 ���� 2011 �.'
ms.openlocfilehash: 32cfae36fb519654c1fb92d2f3b688c966f9288f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808239"
---
# <a name="creating-and-storing-messages-in-message-stores"></a>�������� � �������� ��������� � �������� ���������

  
  
**Применимо к**: Outlook 
  
��� ���������� ��������� ���������, ������� � ��������� ��������� � ������� �������� �������� ������ ������� ������� �������� �������� ������. ��� ������� ���������� ������ �������� ���, ����� ��������� �������� ��������� � �� ��������.
  
������� ��������� ���������� ������� ����� ���������, ��������� ������ ������� ��������� � ����������� �������� ��� ���������. ������ ���� ������� ����� ����� � ������������ �� [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md) ����������. ����� ����� ���������� ���������� �������� ����� �������������� �������� � �������� [IMAPIProp](imapipropiunknown.md) . 
  
���� ��������� �������� ���������� ��������� ���������, ������� �������� ��������, ��������� ������ �������� �� ������� ��������� � ��������� �� �� ������� �������� ��������, ����� �������, ��� ��� ����� ���� ��������� ������������� ��� �������� ��������� ����� ������� ������.
  
MAPI ���������, ��� � ��������� �� [IMessage](imessageimapiprop.md) ���������� �������� ����������, ��� ��������, ��� ���������, ��������� � ��� �� ���������� ����������� �� ������ ������ [IMAPIProp::SaveChanges](imapiprop-savechanges.md) ������� ���������. ��� ���������� ����� ��������� �������� ���������� ��������� ���������. ������ ��� ��������; ������ ������, ��������� ������� � ������ �� ����� �� ��������� � ��� ����� ������������� ������� �������� �������� ��� ������ **SaveChanges**. 
  
��������� �������� �� ��������� ������� ����� ����������� ��������� ��� ���������� ����������, �� ��������� � ����� **SaveChanges** ��������� �������: 
  
- ��������� �������� ������ ���� ������/������ ����� **SaveChanges** ������, �� ������ ��� ������ �����. Например, **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) имеет значение изначально клиентским приложением, которое создает сообщение (и поэтому чтение и запись), но не может быть изменен после первого вызова **SaveChanges**.
    
- ��������� �������� ����� ����������� ��������� � ��������� �����, � ������� ��� ��������� �, � ����� ������ **IMAPIFolder**. �������� �������� **PR_MESSAGE_FLAGS** ������� � �����, ������������ ��� ������ [IMAPIFolder::CreateMessage](imapifolder-createmessage.md) . 
    
- ��������� �������� �� ����� ���� ��������, ���� �� ����� ������ **SaveChanges** � ������ ���. Например свойство **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) могут быть недоступны до вызова метода **SaveChanges** . 
    
- ��������� �������� ����� ����� ����������� ��������� � ������� ���������� ������� ���������. Например свойство **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) обычно является производным от свойство **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) в поставщиков хранилища сообщений, которые поддерживают сообщений в формате RTF.
    
- ��������� �������� ������������ ����� ������ ���� �������, ��������� � �������� ���������. Например свойство **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) требуется на папки и объекты, а также сообщения хранения объектов сообщений.
    
��� ��������������� �� ���������� ��������� ���������, ����� ����������� ���������� ��������� ����� ��������.
  
## <a name="see-also"></a>��. �����



[���������� ��������� � �������� ���������](implementing-messages-in-message-stores.md)


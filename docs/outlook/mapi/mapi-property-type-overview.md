---
title: Обзор типа свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 58dd25f09b76d97fd6441915225756a19f4ec3cb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438199"
---
# <a name="mapi-property-type-overview"></a>Обзор типа свойств MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Типы свойств — это константы, определенные MAPI в MAPIDEFS. Файл загона H, который указывает на тип данных, на который указывается значение свойства. Все свойства, независимо от того, определяются они mapI, клиентские приложения или поставщики услуг, используют один из этих типов. 
  
Типы свойств следуют аналогичной конвенции именования, используемой для тегов свойств. Многие типы свойств имеют как одно значение, так и несколько значений. Одно значение свойств содержит одно значение такого типа, как один ряд или строка символов. Константа, используемая для представления одного свойства значения, имеет две части: префикс PT_ и строка, описывающие фактический тип, например LONG или STRING8. 
  
Свойства с несколькими значениями содержат несколько значений своего типа. В отличие от массивов вариантов OLE каждое значение в многоценном свойстве имеет один и тот же тип. Константа, используемая для представления многоценных свойств, создается путем объединения флага MV_FLAG с соответствующим одно значением, представляющим базовый тип. Существует три части: префикс PT_ затем MV_ строка, описываемая типом. Например, тип свойства, содержащего несколько пакетов, PT_MV_LONG для нескольких строк символов PT_MV_STRING8.
  
На следующем рисунке показана структура [структуры SPropValue](spropvalue.md) для описания многоценного integer, свойства типа PT_MV_LONG. Участник **Value** расширяется, чтобы включить число значений в свойстве и указатель на массив этих значений. 
  
**Свойства с несколькими значениями**
  
![Свойства с несколькими]значениями(media/amapi_12.gif "с несколькими значениями")
  
Хотя поддержка свойств с несколькими значениями необязательна, MAPI рекомендует клиентам и поставщикам услуг поддерживать оба типа свойств, так как это позволяет более взаимодействовать между компонентами, совместимыми с MAPI.
  
На следующем рисунке перечислены все константы типа свойств, показывающие, где они хранятся в **структуре SPropValue.** Размер участника **Value** зависит от конкретного типа. Обратите внимание, что не все типы однозначных значений имеют многозначные эквиваленты. 
  
**Константы типа свойств**
  
![Тип свойств констант](media/amapi_11.gif "свойств константы типа Свойства")
  
Клиенты и поставщики услуг, работающие с свойством, должны следовать двум шагам:
  
1. Определите, доступное или недоступное свойство.
    
2. При наличии извлекаем значение свойства.
    
Иногда клиенту или поставщику услуг требуется только проверить наличие свойства; в других случаях необходимо проверить определенное значение. Например, поставщики транспорта имеют три различных курса действий для обработки свойства PR SEND_RICH_INFO [(PidTagSendRichInfo),](pidtagsendrichinfo-canonical-property.md)значение Boolean, которое указывает, следует ли передавать сообщение с форматным текстом. **\_** Если **SEND_RICH_INFO \_ настроен** на TRUE, поставщик транспорта передает отформатированный текст. Если установлено false, отформатированный текст удаляется перед передачей. Если **PR_SEND_RICH_INFO** недоступен, поставщик транспорта следует курсу действий по умолчанию, независимо от того, что для конкретного поставщика. 
  
MAPI определяет особый тип свойства, PT_UNSPECIFIED, который клиент или поставщик услуг может использовать для получения свойства, когда тип свойства неизвестен. Чтобы получить свойство без предварительного сведения о его типе, клиент или поставщик услуг вызывает метод [IMAPIProp::GetProps](imapiprop-getprops.md) объекта и передает тег свойства, который состоит из идентификатора свойства и PT_UNSPECIFIED типа свойства. **GetProps** возвращает структуру [SPropValue](spropvalue.md) для свойства, заменяя PT_UNSPECIFIED соответствующим типом. Поставщики услуг, реализующие **GetProps,** должны поддерживать PT_UNSPECIFIED. 
  
Некоторые объекты MAPI поддерживают свойства, которые сами являются объектами. Свойства объектов имеют тип PT_OBJECT. Вместо использования **IMAPIProp::GetProps** для доступа к этим свойствам клиенты и поставщики услуг обычно используют метод [IMAPIProp::OpenProperty,](imapiprop-openproperty.md) указывая соответствующий интерфейс для доступа, или метод объекта, поддерживающих свойство. 
  
Поскольку для доступа к значению свойства объекта используется один из интерфейсов объекта, **GetProps** не подходит. С **помощью GetProps** вызываемая компания имеет доступ к значению свойства через **структуру SPropValue.** С **помощью IMAPIProp::OpenProperty** вызыватели извлекают указатель в интерфейс, который может получить доступ к объекту. **OpenProperty** всегда можно использовать для получения свойства объекта. Другой вариант, вызываемый методом на объекте, доступен не во всех свойствах объекта. 
  
Например, каждая папка поддерживает две таблицы, таблицу иерархии и таблицу содержимого. Эти таблицы являются свойствами папки; теги свойств **PR_CONTAINER_HIERARCHY** [(PidTagContainerHierarchy)](pidtagcontainerhierarchy-canonical-property.md)и **PR_CONTAINER_CONTENTS** [(PidTagContainerContents).](pidtagcontainercontents-canonical-property.md) Таблицы — это объекты, для доступа к которые требуется интерфейс **IMAPITable.** Клиент может вызвать метод [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) для доступа к таблице иерархии, метод [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) для доступа к таблице содержимого или метод [IMAPIProp:OpenProperty](imapiprop-openproperty.md) для доступа к любой таблице. Чтобы вызвать **OpenProperty,** клиент передает тег свойства свойства в качестве первого параметра и идентификатор интерфейса для интерфейса, который будет использоваться для доступа в качестве второго параметра. Эти параметры будут **PR_CONTAINER_HIERARCHY** или **PR_CONTAINER_CONTENTS** и **IID_IMAPITable**.
  
Полный список типов свойств с одно значением и несколькими значениями см. [в списке Типы свойств.](property-types.md) 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


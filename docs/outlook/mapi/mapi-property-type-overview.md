---
title: Обзор типов свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 58dd25f09b76d97fd6441915225756a19f4ec3cb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438199"
---
# <a name="mapi-property-type-overview"></a><span data-ttu-id="f4235-103">Обзор типов свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="f4235-103">MAPI property type overview</span></span>
  
<span data-ttu-id="f4235-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f4235-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f4235-105">Типы свойств — это константы, определенные MAPI в MAPIDEFS. H файл заголовков, указывающий базовый тип данных значения свойства.</span><span class="sxs-lookup"><span data-stu-id="f4235-105">Property types are constants defined by MAPI in the MAPIDEFS.H header file that indicate the underlying data type of a property value.</span></span> <span data-ttu-id="f4235-106">Все свойства, определенные с помощью MAPI, клиентскими приложениями или поставщиками служб, используют один из этих типов.</span><span class="sxs-lookup"><span data-stu-id="f4235-106">All properties, whether they are defined by MAPI, by client applications, or by service providers, use one of these types.</span></span> 
  
<span data-ttu-id="f4235-107">Типы свойств соответствуют аналогичному соглашению об именовании, которое используется для тегов свойств.</span><span class="sxs-lookup"><span data-stu-id="f4235-107">Property types follow a similar naming convention to the one used for property tags.</span></span> <span data-ttu-id="f4235-108">Многие типы свойств имеют версию с одним значением и несколько значений.</span><span class="sxs-lookup"><span data-stu-id="f4235-108">Many property types have both a single-value and multiple-value version.</span></span> <span data-ttu-id="f4235-109">Свойства с одним значением содержат одно значение его типа, например, одиночное целое число или символьную строку.</span><span class="sxs-lookup"><span data-stu-id="f4235-109">Single valued properties contain one value of its type such as a single integer or character string.</span></span> <span data-ttu-id="f4235-110">Константа, используемая для представления одного свойства значения, состоит из двух частей: префиксный PT_ и строка, описывающая фактический тип, например LONG или STRING8.</span><span class="sxs-lookup"><span data-stu-id="f4235-110">The constant used to represent a single value property has two parts: the prefix PT_ and a string describing the actual type, such as LONG or STRING8.</span></span> 
  
<span data-ttu-id="f4235-111">Свойства с несколькими значениями содержат более одного значения его типа.</span><span class="sxs-lookup"><span data-stu-id="f4235-111">Multiple-value properties contain more than one value of its type.</span></span> <span data-ttu-id="f4235-112">В отличие от массивов Variant OLE, каждое значение многозначного свойства имеет один и тот же тип.</span><span class="sxs-lookup"><span data-stu-id="f4235-112">Unlike OLE variant arrays, every value in a multivalued property is of the same type.</span></span> <span data-ttu-id="f4235-113">Константа, используемая для представления многозначных свойств, создается путем комбинирования флага MV_FLAG с соответствующей константой с одним значением, представляющей базовый тип.</span><span class="sxs-lookup"><span data-stu-id="f4235-113">The constant used to represent multivalued properties is created by combining the MV_FLAG flag with the corresponding single value constant representing the base type.</span></span> <span data-ttu-id="f4235-114">Существует три части: префикс PT_, за которым следует MV_, за которым следует строка, описывающая тип.</span><span class="sxs-lookup"><span data-stu-id="f4235-114">There are three parts: the prefix PT_ followed by MV_ followed by a string that describes the type.</span></span> <span data-ttu-id="f4235-115">Например, типом свойства, содержащего несколько целых чисел, является PT_MV_LONG, а для нескольких строк символов — PT_MV_STRING8.</span><span class="sxs-lookup"><span data-stu-id="f4235-115">For example, the type for a property containing multiple integers is PT_MV_LONG and for multiple character strings is PT_MV_STRING8.</span></span>
  
<span data-ttu-id="f4235-116">На следующем рисунке показана структура структуры [спропвалуе](spropvalue.md) для описания целого числа, состоящего из нескольких значений, свойства типа PT_MV_LONG.</span><span class="sxs-lookup"><span data-stu-id="f4235-116">The following illustration shows the structure of an [SPropValue](spropvalue.md) structure to describe a multiple-value integer, a property of type PT_MV_LONG.</span></span> <span data-ttu-id="f4235-117">Элемент **value** расширяется и включает в себя количество целых значений в свойстве и указатель на массив этих значений.</span><span class="sxs-lookup"><span data-stu-id="f4235-117">The **Value** member is expanded to include a count of the number of integer values in the property and a pointer to an array of those values.</span></span> 
  
<span data-ttu-id="f4235-118">**Свойства с несколькими значениями**</span><span class="sxs-lookup"><span data-stu-id="f4235-118">**Multiple-value properties**</span></span>
  
<span data-ttu-id="f4235-119">Многозначные свойства ![свойств](media/amapi_12.gif "с") несколькими значениями</span><span class="sxs-lookup"><span data-stu-id="f4235-119">![Multiple-value properties](media/amapi_12.gif "Multiple-value properties")</span></span>
  
<span data-ttu-id="f4235-120">Хотя поддержка свойств с несколькими значениями необязательна, MAPI рекомендует, чтобы клиенты и поставщики услуг поддерживали оба типа свойств, так как это обеспечивает более высокое взаимодействие между компонентами, совместимыми с MAPI.</span><span class="sxs-lookup"><span data-stu-id="f4235-120">Although support for multiple-value properties is optional, MAPI recommends that clients and service providers support both types of properties because doing so enables greater interaction between MAPI-compliant components.</span></span>
  
<span data-ttu-id="f4235-121">На следующем рисунке перечислены все различные константы типа свойства, в которых показано, где они хранятся в структуре **спропвалуе** .</span><span class="sxs-lookup"><span data-stu-id="f4235-121">The following illustration lists all of the different property type constants, showing where they are stored in an **SPropValue** structure.</span></span> <span data-ttu-id="f4235-122">Размер элемента **value** зависит от конкретного типа.</span><span class="sxs-lookup"><span data-stu-id="f4235-122">The size of the **Value** member is dependent on the particular type.</span></span> <span data-ttu-id="f4235-123">Обратите внимание, что не все типы с одним значением имеют эквиваленты из нескольких значений.</span><span class="sxs-lookup"><span data-stu-id="f4235-123">Notice that not all of the single-value types have multiple-value equivalents.</span></span> 
  
<span data-ttu-id="f4235-124">**Константы типа свойств**</span><span class="sxs-lookup"><span data-stu-id="f4235-124">**Property type constants**</span></span>
  
<span data-ttu-id="f4235-125">Константы типа ![Свойства константы](media/amapi_11.gif "типа свойства")</span><span class="sxs-lookup"><span data-stu-id="f4235-125">![Property type constants](media/amapi_11.gif "Property type constants")</span></span>
  
<span data-ttu-id="f4235-126">Для клиентов и поставщиков услуг, работающих с свойством, необходимо выполнить два действия:</span><span class="sxs-lookup"><span data-stu-id="f4235-126">Clients and service providers working with a property need to follow two steps:</span></span>
  
1. <span data-ttu-id="f4235-127">Определите, является ли свойство доступным или недоступным.</span><span class="sxs-lookup"><span data-stu-id="f4235-127">Determine if the property is available or unavailable.</span></span>
    
2. <span data-ttu-id="f4235-128">При наличии можно получить значение свойства.</span><span class="sxs-lookup"><span data-stu-id="f4235-128">If available, retrieve the property's value.</span></span>
    
<span data-ttu-id="f4235-129">Иногда поставщику клиента или службы требуется только проверка наличия свойства; другие случаи, когда необходимо проверить конкретное значение.</span><span class="sxs-lookup"><span data-stu-id="f4235-129">Sometimes a client or service provider need only check for the existence of a property; other times it is necessary to check for a specific value.</span></span> <span data-ttu-id="f4235-130">Например, у поставщиков транспорта есть три разных курса действий для обработки свойства **\_PR SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)), логическое значение, которое указывает, следует ли передавать сообщение с форматированным текстом.</span><span class="sxs-lookup"><span data-stu-id="f4235-130">For example, transport providers have three different courses of action for processing the **PR\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) property, a Boolean value that indicates whether or not a message should be transmitted with formatted text.</span></span> <span data-ttu-id="f4235-131">Если для параметра **PR\_SEND_RICH_INFO** задано значение true, то поставщик транспорта передает форматированный текст.</span><span class="sxs-lookup"><span data-stu-id="f4235-131">If **PR\_SEND_RICH_INFO** is set to TRUE, the transport provider transmits the formatted text.</span></span> <span data-ttu-id="f4235-132">Если задано значение FALSE, отформатированный текст отбрасывается перед передачей.</span><span class="sxs-lookup"><span data-stu-id="f4235-132">If it is set to FALSE, the formatted text is discarded before transmission.</span></span> <span data-ttu-id="f4235-133">Если **PR_SEND_RICH_INFO** недоступен, то транспортному поставщику по умолчанию соответствует свой курс действий по умолчанию, любой из которых относится к определенному поставщику.</span><span class="sxs-lookup"><span data-stu-id="f4235-133">If **PR_SEND_RICH_INFO** is unavailable, the transport provider follows its default course of action, whatever that is for the particular provider.</span></span> 
  
<span data-ttu-id="f4235-134">MAPI определяет особый тип свойства, PT_UNSPECIFIED, который клиент или поставщик услуг может использовать для получения свойства при неизвестном типе свойства. Чтобы получить свойство без предварительного знания его типа, клиент или поставщик услуг вызывает метод объекта [IMAPIProp::](imapiprop-getprops.md) и передает тег свойства, состоящего из идентификатора свойства и типа свойства PT_UNSPECIFIED.</span><span class="sxs-lookup"><span data-stu-id="f4235-134">MAPI defines a special property type, PT_UNSPECIFIED, that a client or service provider can use to retrieve a property when the property type is unknown.To retrieve a property without advance knowledge of its type, a client or service provider calls an object's [IMAPIProp::GetProps](imapiprop-getprops.md) method and passes a property tag made up of the property's identifier and the PT_UNSPECIFIED property type.</span></span> <span data-ttu-id="f4235-135">**PROPS** возвращает структуру [спропвалуе](spropvalue.md) для свойства, заменяя PT_UNSPECIFIED соответствующим типом.</span><span class="sxs-lookup"><span data-stu-id="f4235-135">**GetProps** returns an [SPropValue](spropvalue.md) structure for the property, replacing PT_UNSPECIFIED with the appropriate type.</span></span> <span data-ttu-id="f4235-136">Для поддержки PT_UNSPECIFIED требуются поставщики услуг, реализующие свойства **PROPS** .</span><span class="sxs-lookup"><span data-stu-id="f4235-136">Service providers implementing **GetProps** are required to support PT_UNSPECIFIED.</span></span> 
  
<span data-ttu-id="f4235-137">Некоторые объекты MAPI поддерживают свойства, которые являются собственными объектами.</span><span class="sxs-lookup"><span data-stu-id="f4235-137">Some MAPI objects support properties that are themselves objects.</span></span> <span data-ttu-id="f4235-138">Свойства объекта имеют тип PT_OBJECT.</span><span class="sxs-lookup"><span data-stu-id="f4235-138">Object properties have the type PT_OBJECT.</span></span> <span data-ttu-id="f4235-139">Вместо того чтобы использовать **IMAPIProp:: PROPS** для доступа к этим свойствам, клиенты и поставщики услуг обычно могут использовать метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) , указав соответствующий интерфейс для Access, или метод объекта, поддерживающего свойство.</span><span class="sxs-lookup"><span data-stu-id="f4235-139">Instead of using **IMAPIProp::GetProps** to access these properties, clients and service providers typically user either the [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method, specifying the appropriate interface for access, or a method on the object supporting the property.</span></span> 
  
<span data-ttu-id="f4235-140">Так как доступ к значению свойства объекта включает использование одного из интерфейсов для объекта, свойство- **PROPS** является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="f4235-140">Because accessing the value of an object property involves using one of the interfaces for the object, **GetProps** is inappropriate.</span></span> <span data-ttu-id="f4235-141">С помощью параметра GetProperty вызывающий абонент получает доступ к значению **свойства с помощью**структуры **спропвалуе** .</span><span class="sxs-lookup"><span data-stu-id="f4235-141">With **GetProps**, the caller accesses a property's value through an **SPropValue** structure.</span></span> <span data-ttu-id="f4235-142">С **IMAPIProp:: опенпроперти**, вызывающая сторона получает указатель на интерфейс, который может получить доступ к объекту.</span><span class="sxs-lookup"><span data-stu-id="f4235-142">With **IMAPIProp::OpenProperty**, the caller retrieves a pointer to an interface that can access the object.</span></span> <span data-ttu-id="f4235-143">**Опенпроперти** всегда можно использовать для получения свойства объекта.</span><span class="sxs-lookup"><span data-stu-id="f4235-143">**OpenProperty** can always be used to retrieve an object property.</span></span> <span data-ttu-id="f4235-144">Другой вариант, вызывающий метод для объекта, недоступен для каждого свойства объекта.</span><span class="sxs-lookup"><span data-stu-id="f4235-144">The other option, calling a method on the object, is not available with every object property.</span></span> 
  
<span data-ttu-id="f4235-145">Например, в каждой папке поддерживаются две таблицы, таблица иерархии и таблица содержимого.</span><span class="sxs-lookup"><span data-stu-id="f4235-145">For example, every folder supports two tables, a hierarchy table and a contents table.</span></span> <span data-ttu-id="f4235-146">Эти таблицы являются свойствами папки; их теги свойств — это **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) и **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="f4235-146">These tables are properties of the folder; their property tags are **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) and **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)).</span></span> <span data-ttu-id="f4235-147">Таблицы — это объекты, для доступа к которым требуется интерфейс **IMAPITable** .</span><span class="sxs-lookup"><span data-stu-id="f4235-147">Tables are objects that require the **IMAPITable** interface for access.</span></span> <span data-ttu-id="f4235-148">Клиент может вызвать метод [IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md) для доступа к таблице иерархий, метод [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md) для доступа к таблице содержимого или метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) для доступа к любой таблице.</span><span class="sxs-lookup"><span data-stu-id="f4235-148">A client can call the folder's [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) method to access the hierarchy table, the folder's [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) method to access the contents table, or the folder's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to access either table.</span></span> <span data-ttu-id="f4235-149">Чтобы вызвать **опенпроперти**, клиент передает тег свойства для свойства в качестве первого параметра и идентификатор интерфейса для интерфейса, который будет использоваться для доступа в качестве второго параметра.</span><span class="sxs-lookup"><span data-stu-id="f4235-149">To call **OpenProperty**, a client passes the property tag for the property as the first parameter and an interface identifier for the interface to be used for access as the second parameter.</span></span> <span data-ttu-id="f4235-150">Эти параметры **PR_CONTAINER_HIERARCHY** или **PR_CONTAINER_CONTENTS** и **IID_IMAPITable**.</span><span class="sxs-lookup"><span data-stu-id="f4235-150">These parameters would be **PR_CONTAINER_HIERARCHY** or **PR_CONTAINER_CONTENTS** and **IID_IMAPITable**.</span></span>
  
<span data-ttu-id="f4235-151">Полный список типов свойств с одним значением и с несколькими значениями представлен в статье [типы свойств](property-types.md).</span><span class="sxs-lookup"><span data-stu-id="f4235-151">For a complete list of the single-value and multiple-value property types, see [Property Types](property-types.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="f4235-152">См. также</span><span class="sxs-lookup"><span data-stu-id="f4235-152">See also</span></span>

- [<span data-ttu-id="f4235-153">Обзор свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="f4235-153">MAPI Property Overview</span></span>](mapi-property-overview.md)


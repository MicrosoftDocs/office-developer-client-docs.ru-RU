---
title: Обзор типов свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ce3cd37247f37c4e70adb07769f00b2df07307a3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809805"
---
# <a name="mapi-property-type-overview"></a><span data-ttu-id="2dd2c-103">Обзор типов свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="2dd2c-103">MAPI property type overview</span></span>
  
<span data-ttu-id="2dd2c-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="2dd2c-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="2dd2c-105">Типы свойств являются константами, определенными с MAPI в MAPIDEFS. Файл заголовка, которые указывают базовый тип данных значения свойства.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-105">Property types are constants defined by MAPI in the MAPIDEFS.H header file that indicate the underlying data type of a property value.</span></span> <span data-ttu-id="2dd2c-106">Все свойства ли они определены MAPI, клиентские приложения или поставщиков услуг, используйте один из следующих типов.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-106">All properties, whether they are defined by MAPI, by client applications, or by service providers, use one of these types.</span></span> 
  
<span data-ttu-id="2dd2c-107">Типы свойств выполните аналогичные соглашение об именовании тому, используемые для тегов свойств.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-107">Property types follow a similar naming convention to the one used for property tags.</span></span> <span data-ttu-id="2dd2c-108">Многие типы свойств имеют одно значение и несколькими значениями версии.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-108">Many property types have both a single-value and multiple-value version.</span></span> <span data-ttu-id="2dd2c-109">Значениями свойств единого содержать одно значение этого типа например одиночное целое число или строка символов.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-109">Single valued properties contain one value of its type such as a single integer or character string.</span></span> <span data-ttu-id="2dd2c-110">Константа, используемый для представления одного значения свойства состоит из двух частей: префикс PT_ и строка, описывающая фактического типа, например STRING8 или LONG.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-110">The constant used to represent a single value property has two parts: the prefix PT_ and a string describing the actual type, such as LONG or STRING8.</span></span> 
  
<span data-ttu-id="2dd2c-111">Несколько значений свойства содержит более одного значения этого типа.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-111">Multiple-value properties contain more than one value of its type.</span></span> <span data-ttu-id="2dd2c-112">В отличие от OLE variant массивы каждое значение многозначного свойства имеет тот же тип.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-112">Unlike OLE variant arrays, every value in a multivalued property is of the same type.</span></span> <span data-ttu-id="2dd2c-113">Константа, используемый для представления многозначные свойства создается путем объединения флаг MV_FLAG с соответствующей константы одно значение, представляющее базовый тип.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-113">The constant used to represent multivalued properties is created by combining the MV_FLAG flag with the corresponding single value constant representing the base type.</span></span> <span data-ttu-id="2dd2c-114">Существует три части: префикс PT_, а затем MV_ следуют строку, которая описывает тип.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-114">There are three parts: the prefix PT_ followed by MV_ followed by a string that describes the type.</span></span> <span data-ttu-id="2dd2c-115">К примеру тип свойства, содержащий несколько целых чисел — PT_MV_LONG и для нескольких строк является PT_MV_STRING8.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-115">For example, the type for a property containing multiple integers is PT_MV_LONG and for multiple character strings is PT_MV_STRING8.</span></span>
  
<span data-ttu-id="2dd2c-116">На следующей иллюстрации показана структура [SPropValue](spropvalue.md) структуры для описания: целое число несколько значений, свойство типа PT_MV_LONG.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-116">The following illustration shows the structure of an [SPropValue](spropvalue.md) structure to describe a multiple-value integer, a property of type PT_MV_LONG.</span></span> <span data-ttu-id="2dd2c-117">Элемент **значения** расширяется для включения количество число целые значения в свойстве и указатель на массив эти значения.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-117">The **Value** member is expanded to include a count of the number of integer values in the property and a pointer to an array of those values.</span></span> 
  
<span data-ttu-id="2dd2c-118">**Свойства с несколькими значениями**</span><span class="sxs-lookup"><span data-stu-id="2dd2c-118">**Multiple-value properties**</span></span>
  
<span data-ttu-id="2dd2c-119">![Свойства с несколькими значениями] (media/amapi_12.gif "Свойства с несколькими значениями")</span><span class="sxs-lookup"><span data-stu-id="2dd2c-119">![Multiple-value properties](media/amapi_12.gif "Multiple-value properties")</span></span>
  
<span data-ttu-id="2dd2c-120">Хотя поддержка несколько значений свойств является необязательным, рекомендует MAPI, что клиентов и поставщиков услуг поддерживает обоих типов свойств, поскольку при таком включает более высокой версии взаимодействия между компонентами MAPI-совместимое.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-120">Although support for multiple-value properties is optional, MAPI recommends that clients and service providers support both types of properties because doing so enables greater interaction between MAPI-compliant components.</span></span>
  
<span data-ttu-id="2dd2c-121">Ниже перечислены все константы типа различные свойства, показывающий, где они хранятся в структуре **SPropValue** .</span><span class="sxs-lookup"><span data-stu-id="2dd2c-121">The following illustration lists all of the different property type constants, showing where they are stored in an **SPropValue** structure.</span></span> <span data-ttu-id="2dd2c-122">Размер элемента **значение** , зависит от определенного типа.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-122">The size of the **Value** member is dependent on the particular type.</span></span> <span data-ttu-id="2dd2c-123">Обратите внимание, что не все типы одно значение эквивалентами несколько значений.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-123">Notice that not all of the single-value types have multiple-value equivalents.</span></span> 
  
<span data-ttu-id="2dd2c-124">**Константы типа свойств**</span><span class="sxs-lookup"><span data-stu-id="2dd2c-124">**Property type constants**</span></span>
  
<span data-ttu-id="2dd2c-125">![Константы типа свойства] (media/amapi_11.gif "Константы типа свойства")</span><span class="sxs-lookup"><span data-stu-id="2dd2c-125">![Property type constants](media/amapi_11.gif "Property type constants")</span></span>
  
<span data-ttu-id="2dd2c-126">Клиентов и поставщиков услуг, работа со свойством необходимо выполнить два действия:</span><span class="sxs-lookup"><span data-stu-id="2dd2c-126">Clients and service providers working with a property need to follow two steps:</span></span>
  
1. <span data-ttu-id="2dd2c-127">Определите, если свойство или полностью недоступными.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-127">Determine if the property is available or unavailable.</span></span>
    
2. <span data-ttu-id="2dd2c-128">Если он доступен, получите значение свойства.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-128">If available, retrieve the property's value.</span></span>
    
<span data-ttu-id="2dd2c-129">В некоторых случаях клиента или поставщика требуются только проверки существования свойства; в других случаях это необходимо для проверки для определенного значения.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-129">Sometimes a client or service provider need only check for the existence of a property; other times it is necessary to check for a specific value.</span></span> <span data-ttu-id="2dd2c-130">Поставщики транспорта с три различных варианта действий для обработки, например, **связей с Общественностью\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) свойство, значение Boolean, указывающее, следует ли передавать сообщения с форматированный текст.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-130">For example, transport providers have three different courses of action for processing the **PR\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) property, a Boolean value that indicates whether or not a message should be transmitted with formatted text.</span></span> <span data-ttu-id="2dd2c-131">Если **связей с Общественностью\_SEND_RICH_INFO** — это значение равно TRUE, поставщика транспорта передает форматированный текст.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-131">If **PR\_SEND_RICH_INFO** is set to TRUE, the transport provider transmits the formatted text.</span></span> <span data-ttu-id="2dd2c-132">Если он имеет значение FALSE, перед передачей удаляются форматированный текст.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-132">If it is set to FALSE, the formatted text is discarded before transmission.</span></span> <span data-ttu-id="2dd2c-133">Если **PR_SEND_RICH_INFO** недоступен, поставщика транспорта то есть после его по умолчанию или иные действия, необходимые для определенного поставщика.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-133">If **PR_SEND_RICH_INFO** is unavailable, the transport provider follows its default course of action, whatever that is for the particular provider.</span></span> 
  
<span data-ttu-id="2dd2c-134">MAPI определяет тип специальные свойства, PT_UNSPECIFIED, клиента или поставщика можно использовать для получения свойства, если тип свойства не известен. Чтобы получить свойство без базы знаний предварительное этого типа, клиента или поставщика вызывает метод [IMAPIProp::GetProps](imapiprop-getprops.md) объекта и передает тег свойства, состоящих из идентификатора свойства и тип свойства PT_UNSPECIFIED.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-134">MAPI defines a special property type, PT_UNSPECIFIED, that a client or service provider can use to retrieve a property when the property type is unknown.To retrieve a property without advance knowledge of its type, a client or service provider calls an object's [IMAPIProp::GetProps](imapiprop-getprops.md) method and passes a property tag made up of the property's identifier and the PT_UNSPECIFIED property type.</span></span> <span data-ttu-id="2dd2c-135">**GetProps** возвращает структуру [SPropValue](spropvalue.md) для свойства, заменив PT_UNSPECIFIED соответствующего типа.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-135">**GetProps** returns an [SPropValue](spropvalue.md) structure for the property, replacing PT_UNSPECIFIED with the appropriate type.</span></span> <span data-ttu-id="2dd2c-136">Реализация **GetProps** поставщиков услуг требуются для поддержки PT_UNSPECIFIED.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-136">Service providers implementing **GetProps** are required to support PT_UNSPECIFIED.</span></span> 
  
<span data-ttu-id="2dd2c-137">Некоторые объекты MAPI поддерживают свойства, которые сами являются объектами.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-137">Some MAPI objects support properties that are themselves objects.</span></span> <span data-ttu-id="2dd2c-138">Свойства объекта иметь тип PT_OBJECT.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-138">Object properties have the type PT_OBJECT.</span></span> <span data-ttu-id="2dd2c-139">Вместо использования **IMAPIProp::GetProps** для доступа к эти свойства, клиентов и поставщиков услуг обычно пользователя либо [IMAPIProp::OpenProperty](imapiprop-openproperty.md) метод, указав соответствующий интерфейс для доступа или метод на объекте Поддержка свойство.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-139">Instead of using **IMAPIProp::GetProps** to access these properties, clients and service providers typically user either the [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method, specifying the appropriate interface for access, or a method on the object supporting the property.</span></span> 
  
<span data-ttu-id="2dd2c-140">Так как доступ к значению свойства объекта включает использование один из интерфейсов для объекта, **GetProps** , является недопустимым.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-140">Because accessing the value of an object property involves using one of the interfaces for the object, **GetProps** is inappropriate.</span></span> <span data-ttu-id="2dd2c-141">С **GetProps**вызывающего обращается к значению свойства через структуру **SPropValue** .</span><span class="sxs-lookup"><span data-stu-id="2dd2c-141">With **GetProps**, the caller accesses a property's value through an **SPropValue** structure.</span></span> <span data-ttu-id="2dd2c-142">С помощью **IMAPIProp::OpenProperty**вызывающего получает указатель на интерфейс, который можно получить доступ к объекту.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-142">With **IMAPIProp::OpenProperty**, the caller retrieves a pointer to an interface that can access the object.</span></span> <span data-ttu-id="2dd2c-143">**OpenProperty** всегда могут использоваться для получения свойства объекта.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-143">**OpenProperty** can always be used to retrieve an object property.</span></span> <span data-ttu-id="2dd2c-144">Другой вариант, вызвав метод на объекте, не доступны в каждое свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-144">The other option, calling a method on the object, is not available with every object property.</span></span> 
  
<span data-ttu-id="2dd2c-145">Например каждой папки поддерживает две таблицы, таблицы иерархии и содержимое таблицы.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-145">For example, every folder supports two tables, a hierarchy table and a contents table.</span></span> <span data-ttu-id="2dd2c-146">Эти таблицы являются свойства папки; теги их свойства: **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) и **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="2dd2c-146">These tables are properties of the folder; their property tags are **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) and **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)).</span></span> <span data-ttu-id="2dd2c-147">Таблицы являются объектами, которые требуют **IMAPITable** интерфейса для доступа.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-147">Tables are objects that require the **IMAPITable** interface for access.</span></span> <span data-ttu-id="2dd2c-148">Клиент может вызвать метод [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) папки для доступа к таблице иерархии, метод [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) папки для доступа к таблице содержимое или папки [IMAPIProp::OpenProperty ](imapiprop-openproperty.md)метод для доступа к любой таблице.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-148">A client can call the folder's [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) method to access the hierarchy table, the folder's [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) method to access the contents table, or the folder's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method to access either table.</span></span> <span data-ttu-id="2dd2c-149">Для вызова **OpenProperty**клиент передает тега свойства для свойства в качестве первого параметра и идентификатора интерфейса для интерфейса, используемый для доступа в качестве второго параметра.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-149">To call **OpenProperty**, a client passes the property tag for the property as the first parameter and an interface identifier for the interface to be used for access as the second parameter.</span></span> <span data-ttu-id="2dd2c-150">Эти параметры являются **PR_CONTAINER_HIERARCHY** или **PR_CONTAINER_CONTENTS** и **IID_IMAPITable**.</span><span class="sxs-lookup"><span data-stu-id="2dd2c-150">These parameters would be **PR_CONTAINER_HIERARCHY** or **PR_CONTAINER_CONTENTS** and **IID_IMAPITable**.</span></span>
  
<span data-ttu-id="2dd2c-151">Полный список типов одно значение и несколько значений свойств в разделе [Типы свойств](property-types.md).</span><span class="sxs-lookup"><span data-stu-id="2dd2c-151">For a complete list of the single-value and multiple-value property types, see [Property Types](property-types.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2dd2c-152">См. также</span><span class="sxs-lookup"><span data-stu-id="2dd2c-152">See also</span></span>

- [<span data-ttu-id="2dd2c-153">Обзор свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="2dd2c-153">MAPI Property Overview</span></span>](mapi-property-overview.md)


---
title: Обзор типов свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 58dd25f09b76d97fd6441915225756a19f4ec3cb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438199"
---
# <a name="mapi-property-type-overview"></a>Обзор типов свойств MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Типы свойств — это константы, определенные MAPI в MAPIDEFS. H файл заголовков, указывающий базовый тип данных значения свойства. Все свойства, определенные с помощью MAPI, клиентскими приложениями или поставщиками служб, используют один из этих типов. 
  
Типы свойств соответствуют аналогичному соглашению об именовании, которое используется для тегов свойств. Многие типы свойств имеют версию с одним значением и несколько значений. Свойства с одним значением содержат одно значение его типа, например, одиночное целое число или символьную строку. Константа, используемая для представления одного свойства значения, состоит из двух частей: префиксный PT_ и строка, описывающая фактический тип, например LONG или STRING8. 
  
Свойства с несколькими значениями содержат более одного значения его типа. В отличие от массивов Variant OLE, каждое значение многозначного свойства имеет один и тот же тип. Константа, используемая для представления многозначных свойств, создается путем комбинирования флага MV_FLAG с соответствующей константой с одним значением, представляющей базовый тип. Существует три части: префикс PT_, за которым следует MV_, за которым следует строка, описывающая тип. Например, типом свойства, содержащего несколько целых чисел, является PT_MV_LONG, а для нескольких строк символов — PT_MV_STRING8.
  
На следующем рисунке показана структура структуры [спропвалуе](spropvalue.md) для описания целого числа, состоящего из нескольких значений, свойства типа PT_MV_LONG. Элемент **value** расширяется и включает в себя количество целых значений в свойстве и указатель на массив этих значений. 
  
**Свойства с несколькими значениями**
  
Многозначные свойства ![свойств](media/amapi_12.gif "с") несколькими значениями
  
Хотя поддержка свойств с несколькими значениями необязательна, MAPI рекомендует, чтобы клиенты и поставщики услуг поддерживали оба типа свойств, так как это обеспечивает более высокое взаимодействие между компонентами, совместимыми с MAPI.
  
На следующем рисунке перечислены все различные константы типа свойства, в которых показано, где они хранятся в структуре **спропвалуе** . Размер элемента **value** зависит от конкретного типа. Обратите внимание, что не все типы с одним значением имеют эквиваленты из нескольких значений. 
  
**Константы типа свойств**
  
Константы типа ![Свойства константы](media/amapi_11.gif "типа свойства")
  
Для клиентов и поставщиков услуг, работающих с свойством, необходимо выполнить два действия:
  
1. Определите, является ли свойство доступным или недоступным.
    
2. При наличии можно получить значение свойства.
    
Иногда поставщику клиента или службы требуется только проверка наличия свойства; другие случаи, когда необходимо проверить конкретное значение. Например, у поставщиков транспорта есть три разных курса действий для обработки свойства **\_PR SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)), логическое значение, которое указывает, следует ли передавать сообщение с форматированным текстом. Если для параметра **PR\_SEND_RICH_INFO** задано значение true, то поставщик транспорта передает форматированный текст. Если задано значение FALSE, отформатированный текст отбрасывается перед передачей. Если **PR_SEND_RICH_INFO** недоступен, то транспортному поставщику по умолчанию соответствует свой курс действий по умолчанию, любой из которых относится к определенному поставщику. 
  
MAPI определяет особый тип свойства, PT_UNSPECIFIED, который клиент или поставщик услуг может использовать для получения свойства при неизвестном типе свойства. Чтобы получить свойство без предварительного знания его типа, клиент или поставщик услуг вызывает метод объекта [IMAPIProp::](imapiprop-getprops.md) и передает тег свойства, состоящего из идентификатора свойства и типа свойства PT_UNSPECIFIED. **PROPS** возвращает структуру [спропвалуе](spropvalue.md) для свойства, заменяя PT_UNSPECIFIED соответствующим типом. Для поддержки PT_UNSPECIFIED требуются поставщики услуг, реализующие свойства **PROPS** . 
  
Некоторые объекты MAPI поддерживают свойства, которые являются собственными объектами. Свойства объекта имеют тип PT_OBJECT. Вместо того чтобы использовать **IMAPIProp:: PROPS** для доступа к этим свойствам, клиенты и поставщики услуг обычно могут использовать метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) , указав соответствующий интерфейс для Access, или метод объекта, поддерживающего свойство. 
  
Так как доступ к значению свойства объекта включает использование одного из интерфейсов для объекта, свойство- **PROPS** является недопустимым. С помощью параметра GetProperty вызывающий абонент получает доступ к значению **свойства с помощью**структуры **спропвалуе** . С **IMAPIProp:: опенпроперти**, вызывающая сторона получает указатель на интерфейс, который может получить доступ к объекту. **Опенпроперти** всегда можно использовать для получения свойства объекта. Другой вариант, вызывающий метод для объекта, недоступен для каждого свойства объекта. 
  
Например, в каждой папке поддерживаются две таблицы, таблица иерархии и таблица содержимого. Эти таблицы являются свойствами папки; их теги свойств — это **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) и **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)). Таблицы — это объекты, для доступа к которым требуется интерфейс **IMAPITable** . Клиент может вызвать метод [IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md) для доступа к таблице иерархий, метод [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md) для доступа к таблице содержимого или метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) для доступа к любой таблице. Чтобы вызвать **опенпроперти**, клиент передает тег свойства для свойства в качестве первого параметра и идентификатор интерфейса для интерфейса, который будет использоваться для доступа в качестве второго параметра. Эти параметры **PR_CONTAINER_HIERARCHY** или **PR_CONTAINER_CONTENTS** и **IID_IMAPITable**.
  
Полный список типов свойств с одним значением и с несколькими значениями представлен в статье [типы свойств](property-types.md). 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


---
title: Обзор типов свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ce3cd37247f37c4e70adb07769f00b2df07307a3
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809805"
---
# <a name="mapi-property-type-overview"></a>Обзор типов свойств MAPI
  
**Относится к**: Outlook 
  
Типы свойств являются константами, определенными с MAPI в MAPIDEFS. Файл заголовка, которые указывают базовый тип данных значения свойства. Все свойства ли они определены MAPI, клиентские приложения или поставщиков услуг, используйте один из следующих типов. 
  
Типы свойств выполните аналогичные соглашение об именовании тому, используемые для тегов свойств. Многие типы свойств имеют одно значение и несколькими значениями версии. Значениями свойств единого содержать одно значение этого типа например одиночное целое число или строка символов. Константа, используемый для представления одного значения свойства состоит из двух частей: префикс PT_ и строка, описывающая фактического типа, например STRING8 или LONG. 
  
Несколько значений свойства содержит более одного значения этого типа. В отличие от OLE variant массивы каждое значение многозначного свойства имеет тот же тип. Константа, используемый для представления многозначные свойства создается путем объединения флаг MV_FLAG с соответствующей константы одно значение, представляющее базовый тип. Существует три части: префикс PT_, а затем MV_ следуют строку, которая описывает тип. К примеру тип свойства, содержащий несколько целых чисел — PT_MV_LONG и для нескольких строк является PT_MV_STRING8.
  
На следующей иллюстрации показана структура [SPropValue](spropvalue.md) структуры для описания: целое число несколько значений, свойство типа PT_MV_LONG. Элемент **значения** расширяется для включения количество число целые значения в свойстве и указатель на массив эти значения. 
  
**Свойства с несколькими значениями**
  
![Свойства с несколькими значениями] (media/amapi_12.gif "Свойства с несколькими значениями")
  
Хотя поддержка несколько значений свойств является необязательным, рекомендует MAPI, что клиентов и поставщиков услуг поддерживает обоих типов свойств, поскольку при таком включает более высокой версии взаимодействия между компонентами MAPI-совместимое.
  
Ниже перечислены все константы типа различные свойства, показывающий, где они хранятся в структуре **SPropValue** . Размер элемента **значение** , зависит от определенного типа. Обратите внимание, что не все типы одно значение эквивалентами несколько значений. 
  
**Константы типа свойств**
  
![Константы типа свойства] (media/amapi_11.gif "Константы типа свойства")
  
Клиентов и поставщиков услуг, работа со свойством необходимо выполнить два действия:
  
1. Определите, если свойство или полностью недоступными.
    
2. Если он доступен, получите значение свойства.
    
В некоторых случаях клиента или поставщика требуются только проверки существования свойства; в других случаях это необходимо для проверки для определенного значения. Поставщики транспорта с три различных варианта действий для обработки, например, **связей с Общественностью\_SEND_RICH_INFO** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) свойство, значение Boolean, указывающее, следует ли передавать сообщения с форматированный текст. Если **связей с Общественностью\_SEND_RICH_INFO** — это значение равно TRUE, поставщика транспорта передает форматированный текст. Если он имеет значение FALSE, перед передачей удаляются форматированный текст. Если **PR_SEND_RICH_INFO** недоступен, поставщика транспорта то есть после его по умолчанию или иные действия, необходимые для определенного поставщика. 
  
MAPI определяет тип специальные свойства, PT_UNSPECIFIED, клиента или поставщика можно использовать для получения свойства, если тип свойства не известен. Чтобы получить свойство без базы знаний предварительное этого типа, клиента или поставщика вызывает метод [IMAPIProp::GetProps](imapiprop-getprops.md) объекта и передает тег свойства, состоящих из идентификатора свойства и тип свойства PT_UNSPECIFIED. **GetProps** возвращает структуру [SPropValue](spropvalue.md) для свойства, заменив PT_UNSPECIFIED соответствующего типа. Реализация **GetProps** поставщиков услуг требуются для поддержки PT_UNSPECIFIED. 
  
Некоторые объекты MAPI поддерживают свойства, которые сами являются объектами. Свойства объекта иметь тип PT_OBJECT. Вместо использования **IMAPIProp::GetProps** для доступа к эти свойства, клиентов и поставщиков услуг обычно пользователя либо [IMAPIProp::OpenProperty](imapiprop-openproperty.md) метод, указав соответствующий интерфейс для доступа или метод на объекте Поддержка свойство. 
  
Так как доступ к значению свойства объекта включает использование один из интерфейсов для объекта, **GetProps** , является недопустимым. С **GetProps**вызывающего обращается к значению свойства через структуру **SPropValue** . С помощью **IMAPIProp::OpenProperty**вызывающего получает указатель на интерфейс, который можно получить доступ к объекту. **OpenProperty** всегда могут использоваться для получения свойства объекта. Другой вариант, вызвав метод на объекте, не доступны в каждое свойство объекта. 
  
Например каждой папки поддерживает две таблицы, таблицы иерархии и содержимое таблицы. Эти таблицы являются свойства папки; теги их свойства: **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) и **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)). Таблицы являются объектами, которые требуют **IMAPITable** интерфейса для доступа. Клиент может вызвать метод [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) папки для доступа к таблице иерархии, метод [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) папки для доступа к таблице содержимое или папки [IMAPIProp::OpenProperty ](imapiprop-openproperty.md)метод для доступа к любой таблице. Для вызова **OpenProperty**клиент передает тега свойства для свойства в качестве первого параметра и идентификатора интерфейса для интерфейса, используемый для доступа в качестве второго параметра. Эти параметры являются **PR_CONTAINER_HIERARCHY** или **PR_CONTAINER_CONTENTS** и **IID_IMAPITable**.
  
Полный список типов одно значение и несколько значений свойств в разделе [Типы свойств](property-types.md). 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


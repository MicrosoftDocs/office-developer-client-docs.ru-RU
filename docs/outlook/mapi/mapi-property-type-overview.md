---
title: Обзор типов свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b762f5fb-7c2c-4303-96f7-0b6e657146c9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 58dd25f09b76d97fd6441915225756a19f4ec3cb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438199"
---
# <a name="mapi-property-type-overview"></a>Обзор типов свойств MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Типы свойств — это константы, определенные MAPI в MAPIDEFS. H файл заголовков, указывающий базовый тип данных значения свойства. Все свойства, определенные с помощью MAPI, клиентскими приложениями или поставщиками служб, используют один из этих типов. 
  
Типы свойств соответствуют аналогичному соглашению об именовании, которое используется для тегов свойств. Многие типы свойств имеют версию с одним значением и несколько значений. Свойства с одним значением содержат одно значение его типа, например, одиночное целое число или символьную строку. Константа, используемая для представления свойства с одним значением, состоит из двух частей: префикса ПТ_ и строки, описывающей фактический тип, например LONG или STRING8. 
  
Свойства с несколькими значениями содержат более одного значения его типа. В отличие от массивов Variant OLE, каждое значение многозначного свойства имеет один и тот же тип. Константа, используемая для представления многозначных свойств, создается путем объединения флага МВ_ФЛАГ с соответствующей константой с одним значением, представляющей базовый тип. Существует три части: префикс ПТ_, за которым следует МВ_, за которым следует строка, описывающая тип. Например, тип свойства с несколькими целыми числами — ПТ_МВ_ЛОНГ, а для нескольких строк символов — PT_MV_STRING8.
  
На следующем рисунке показана структура структуры [спропвалуе](spropvalue.md) для описания целого числа, состоящего из нескольких значений, свойства типа пт_мв_лонг. Элемент **value** расширяется и включает в себя количество целых значений в свойстве и указатель на массив этих значений. 
  
**Свойства с несколькими значениями**
  
![Свойства с несколькими значениями] (media/amapi_12.gif "Свойства с несколькими значениями")
  
Хотя поддержка свойств с несколькими значениями необязательна, MAPI рекомендует, чтобы клиенты и поставщики услуг поддерживали оба типа свойств, так как это обеспечивает более высокое взаимодействие между компонентами, совместимыми с MAPI.
  
На следующем рисунке перечислены все различные константы типа свойства, в которых показано, где они хранятся в структуре **спропвалуе** . Размер элемента **value** зависит от конкретного типа. Обратите внимание, что не все типы с одним значением имеют эквиваленты из нескольких значений. 
  
**Константы типа свойств**
  
![Константы типа свойства] (media/amapi_11.gif "Константы типа свойства")
  
Для клиентов и поставщиков услуг, работающих с свойством, необходимо выполнить два действия:
  
1. Определите, является ли свойство доступным или недоступным.
    
2. При наличии можно получить значение свойства.
    
Иногда поставщику клиента или службы требуется только проверка наличия свойства; другие случаи, когда необходимо проверить конкретное значение. Например, у поставщиков транспорта есть три разных курса действий для обработки свойства **\_PR сенд_рич_инфо** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)), логическое значение, которое указывает, следует ли передавать сообщение с форматированный текст. Если для параметра **PR\_СЕНД_РИЧ_ИНФО** задано значение true, то поставщик транспорта передает форматированный текст. Если задано значение FALSE, отформатированный текст отбрасывается перед передачей. Если **пр_сенд_рич_инфо** недоступен, то транспортному поставщику следует придерживаться действия по умолчанию, что и для конкретного поставщика. 
  
MAPI определяет особый тип свойства, ПТ_УНСПЕЦИФИЕД, который клиент или поставщик услуг может использовать для получения свойства, если тип свойства неизвестен. Чтобы получить свойство без предварительного знания его типа, клиент или поставщик услуг вызывает метод объекта [IMAPIProp::](imapiprop-getprops.md) и передает тег свойства, состоящего из идентификатора свойства и типа свойства пт_унспеЦифиед. **PROPS** возвращает структуру [спропвалуе](spropvalue.md) для свойства, заменяя пт_унспеЦифиед на соответствующий тип. Для поддержки ПТ_УНСПЕЦИФИЕД **** требуются поставщики услуг, реализуЮщие свойства PROPS. 
  
Некоторые объекты MAPI поддерживают свойства, которые являются собственными объектами. Свойства объекта имеют тип ПТ_ОБЖЕКТ. Вместо использования **IMAPIProp:: PROPS** для доступа к этим свойствам клиенты и поставщики услуг обычно имеют метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) , указывая соответствующий интерфейс для доступа, или метод объекта. поддержка свойства. 
  
Так как доступ к значению свойства объекта включает использование одного из интерфейсов для объекта, свойство **** -PROPS является недопустимым. С **** помощью параметра GetProperty вызывающий абонент получает доступ к значению свойства с помощью структуры **спропвалуе** . С **IMAPIProp:: опенпроперти**, вызывающая сторона получает указатель на интерфейс, который может получить доступ к объекту. **Опенпроперти** всегда можно использовать для получения свойства объекта. Другой вариант, вызывающий метод для объекта, недоступен для каждого свойства объекта. 
  
Например, в каждой папке поддерживаются две таблицы, таблица иерархии и таблица содержимого. Эти таблицы являются свойствами папки; их теги свойств — **пр_контаинер_хиерарчи** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) и **пр_контаинер_контентс** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)). Таблицы — это объекты, для доступа к которым требуется интерфейс **IMAPITable** . Клиент может вызвать метод [IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md) папки для доступа к таблице иерархии, метод [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md) для доступа к таблице содержимого или [IMAPIProp:: опенпроперти ](imapiprop-openproperty.md)метод для доступа к любой таблице. Чтобы вызвать **опенпроперти**, клиент передает тег свойства для свойства в качестве первого параметра и идентификатор интерфейса для интерфейса, который будет использоваться для доступа в качестве второго параметра. Эти параметры могут быть **пр_контаинер_хиерарчи** или **пр_контаинер_контентс** и **иид_имапитабле**.
  
Полный список типов свойств с одним значением и с несколькими значениями представлен в статье [типы свойств](property-types.md). 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


---
title: имапистатусфлушкуеуес
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIStatus.FlushQueues
api_type:
- COM
ms.assetid: d6b01a91-b452-4b2c-9802-698e7b0f4169
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5f8396ca84192e485d33fb5a96f641361b717584
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432606"
---
# <a name="imapistatusflushqueues"></a>IMAPIStatus::FlushQueues

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Принудительно отправляет или загружает все сообщения, ожидающие отправки или получения. Этот метод поддерживаются объектом состояния и объектами состояния очереди печати MAPI, которые реализуются поставщиками транспорта.
  
```cpp
HRESULT FlushQueues(
  ULONG_PTR ulUIParam,
  ULONG cbTargetTransport,
  LPENTRYID lpTargetTransport,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _улуипарам_
  
> возврата Дескриптор родительского окна всех диалоговых окон и окон, отображаемых данным методом.
    
 _кбтаржеттранспорт_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лптаржеттранспорт_ . Параметр _кбтаржеттранспорт_ задается только при вызовах объекта состояния диспетчера MAPI. Для вызовов поставщика транспорта параметр _кбтаржеттранспорт_ имеет значение 0. 
    
 _лптаржеттранспорт_
  
> возврата Указатель на идентификатор записи поставщика транспорта, на котором необходимо очистить очереди сообщений. Параметр _лптаржеттранспорт_ задается только при вызовах объекта состояния диспетчера MAPI. Для вызовов поставщика транспорта параметр _лптаржеттранспорт_ имеет значение null. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, управляющих операцией Flush. Можно задать следующие флаги:
    
FLUSH_ASYNC_OK 
  
> Операция сброса может выполняться асинхронно. Этот флаг применяется только к объекту состояния диспетчера MAPI. 
    
FLUSH_DOWNLOAD 
  
> Входящие очереди сообщений должны быть сброшены.
    
FLUSH_FORCE 
  
> Операция сброса должна выполняться независимо от вероятности снижения производительности. Этот флаг должен быть установлен при назначении асинхронного поставщика транспорта.
    
FLUSH_NO_UI 
  
> Объект Status не должен отображать индикатор хода выполнения.
    
FLUSH_UPLOAD 
  
> Исходящие очереди сообщений должны быть сброшены.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция сброса выполнена успешно.
    
MAPI_E_BUSY 
  
> Выполняется другая операция; ее выполнение должно быть разрешено или остановлено до запуска этой операции.
    
MAPI_E_NO_SUPPORT 
  
> Объект Status не поддерживает эту операцию, как указано в отсутствие флага STATUS_FLUSH_QUEUES в свойстве **PR_RESOURCE_METHODS** объекта Status ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md)).
    
## <a name="remarks"></a>Примечания

Метод **имапистатус:: FlushQueues** запрашивает немедленную отправку всех сообщений в исходящей очереди или получение всех сообщений из очереди поступающих с помощью диспетчера MAPI или поставщика транспорта. **FlushQueues** реализован только в объекте состояния ДИСПЕТЧЕРА очереди MAPI и объектах состояния, предоставленных поставщиками транспорта. 
  
MAPI_E_BUSY должны быть возвращены для асинхронных запросов, чтобы клиенты могли продолжать работу. 
  
По умолчанию **FlushQueues** является синхронной операцией; Управление не возвращается вызывающему абоненту до завершения операции очистки. Только операция очистки, выполняемая диспетчером MAPI, может быть асинхронной. клиенты запрашивают это поведение, настроив флаг FLUSH_ASYNC_OK. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Реализация **FlushQueues** для удаленного поставщика транспорта задает биты в свойстве **PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md)) в строке состояния объекта входа, чтобы управлять процессом очистки очередей. Если удаленное средство просмотра передается в флаг FLUSH_UPLOAD, метод **FlushQueues** должен задать STATUS_INBOUND_ENABLED и STATUS_INBOUND_ACTIVE бит. Если удаленное средство просмотра передается в флаг FLUSH_DOWNLOAD, метод **FlushQueues** должен задать STATUS_OUTBOUND_ENABLED и STATUS_OUTBOUND_ACTIVE бит. Затем **FlushQueues** должен возвратить S_OK. После этого диспетчер очереди MAPI инициирует соответствующие действия для отправки и загрузки сообщений. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вызов объекта состояния диспетчера очереди MAPI — это директива для передачи всех сообщений в или из соответствующего поставщика транспорта. При вызове объекта состояния отдельного поставщика транспорта затрагиваются только сообщения для этого поставщика.
  
## <a name="see-also"></a>См. также



[Каноническое свойство PidTagResourceMethods](pidtagresourcemethods-canonical-property.md)
  
[Каноническое свойство PidTagStatusCode](pidtagstatuscode-canonical-property.md)
  
[IMAPIStatus : IMAPIProp](imapistatusimapiprop.md)


---
title: Составление идентификаторов записей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bc2a9116-948e-4da3-96b8-26d73bcd63c4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 1d38c0ac7ddbd24123dd51d7315644f3ad786d15
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808184"
---
# <a name="constructing-entry-identifiers"></a>Составление идентификаторов записей

  
  
**Относится к**: Outlook 
  
Идентификаторы записей, созданные со структурой [ENTRYID](entryid.md) . Структура **ENTRYID** состоит из флаг, описывающий атрибуты идентификатор записи и идентификатор фактический записи. 
  
## <a name="entryid-structure"></a>Идентификатор записи структуры

Структура **ENTRYID** определяется следующим образом: 
  
```cpp
typedef struct
{
    BYTE        abFlags[4];
    BYTE        ab[MAPI_DIM];
}  ENTRYID, FAR *LPENTRYID;
 
```

MAPI_DIM — это константа, определенные в файле заголовка MapiDefs.h. 
  
Получения первого байта член 4-байтных **abFlags** описывает тип и использовать запись идентификатора и может принимать следующие значения: 
  
- MAPI_NOTRECI — Указывает идентификатор записи не может использоваться в качестве получателей на сообщение.
    
- MAPI_NOTRESERVED — Указывает, что другие пользователи не могут получить доступ к идентификатор записи.
    
- MAPI_NOW — Указывает, что идентификатор записи не может использоваться в других случаях.
    
- MAPI_SHORTTERM — Указывает, что идентификатор записи краткосрочных. Все значения в этом байтов должно иметь значение, если не разрешены других способов использования идентификатор записи.
    
- MAPI_THISSESSION — Указывает, что идентификатор записи не может использоваться для других сеансов.
    
- MAPI_NOTRESERVED — Указывает, что идентификатор записи можно использовать другие поставщики услуг для других объектов.
    
Член **ab** идентификаторов запись, которая создается по поставщиков хранилища адресной книги и сообщения состоит из двух частей: структура [MAPIUID](mapiuid.md) 16-битное, определяет поставщик услуг и фрагмент для идентификации объекта. **MAPIUID** — это структура, содержащая идентификатор GUID, или идентификатор GUID. GUID — это идентификатор байтов порядке независимо, можно создать с помощью Microsoft Visual Studio*Создать GUID** средство. 
  
При входе в вызов метода [IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md) поставщика услуг регистрирует его структуры **MAPIUID** MAPI. Когда клиент вызывает метод **OpenEntry** для доступа к объекту, MAPI использует структуру **MAPIUID** для определения, какой службе поставщика можно обеспечить доступа. Поставщики услуг следует использовать одну и ту же структуру **MAPIUID** для всех версий их DLL. Это позволяет клиентам с новой версией отвечать на сообщения, отправленные и сохранения с более ранними версиями. 
  
Остальная часть член **ab** после 16-битное **MAPIUID** содержит двоичные данные службы поставщика для идентификации определенных объектов. Нет нет фиксированного размера для этой части идентификатор записи. Она может быть любого размера, в рамках причине. Поставщик службы обычно включает в себя следующие сведения в этой части его идентификаторы записей: 
  
- Сведения о версии, поскольку типичные для поставщика услуг для изменения формата его идентификаторы записей из одной версии на другую, хранение сведений о версии позволяет быстро определить, как для дешифрования любой идентификатор записи.
    
- Сведения о расположении — сведения о расположении — данные, задающей поставщика услуг показывает, как найти объекта, представленного идентификатор записи. Например поставщик службы можно хранить диска смещение для последнего позицию в файл данных, что объект был сохранен. Так как этот тип данных можно изменить со временем, поставщиков услуг следует предоставить несколько способов для поиска объектов в их идентификаторы записей.
    
Хотя для поставщиков услуг может повторно их идентификаторы записей, их следует избегать этого практического занятия. Если это необходимо для повторного использования идентификатор входа, поставщиков услуг должна потратить между начальной использования и повторного использования, в течение периода времени. Кроме того идентификатор записи должен быть назначен другой объект того же типа. То есть идентификатор конкретной записи не должны быть связаны сначала с сообщением, а затем с папкой.
  
## <a name="see-also"></a>См. также



[Идентификаторы MAPI записей](mapi-entry-identifiers.md)


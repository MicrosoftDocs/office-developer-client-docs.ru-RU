---
title: Создание идентификаторов записей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bc2a9116-948e-4da3-96b8-26d73bcd63c4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8d48c2584fa5b7e862102e401ea8165821607f77
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427950"
---
# <a name="constructing-entry-identifiers"></a>Создание идентификаторов записей

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Идентификаторы записей создаются с использованием структуры [EntryID](entryid.md) . Структура **EntryID** состоит из флага, который описывает атрибуты идентификатора записи и фактический идентификатор записи. 
  
## <a name="entryid-structure"></a>Структура ENTRYID

Структура **EntryID** определяется следующим образом: 
  
```cpp
typedef struct
{
    BYTE        abFlags[4];
    BYTE        ab[MAPI_DIM];
}  ENTRYID, FAR *LPENTRYID;
 
```

MAPI_DIM — это константа, определенная в файле заголовка MapiDefs. h. 
  
Первый байт 4 – байтового элемента **абфлагс** описывает тип и использование идентификатора записи и может иметь следующие значения: 
  
- MAPI_NOTRECI — указывает, что идентификатор записи нельзя использовать в качестве получателя сообщения.
    
- MAPI_NOTRESERVED — указывает, что другие пользователи не могут получить доступ к идентификатору записи.
    
- MAPI_NOW — указывает, что идентификатор записи нельзя использовать в другое время.
    
- MAPI_SHORTTERM — указывает, что идентификатор записи является коротким термином. Все остальные значения этого байта должны быть заданы, если другие варианты использования идентификатора записи не разрешены.
    
- MAPI_THISSESSION — указывает, что идентификатор записи нельзя использовать в других сеансах.
    
- MAPI_NOTRESERVED — указывает, что идентификатор записи может использоваться другими поставщиками служб для других объектов.
    
Элемент **AB** идентификаторов записей, созданный адресными книгами и поставщиками хранилищ сообщений, состоит из двух частей: 16-байтовой структуры [мапиуид](mapiuid.md) , определяющей поставщика услуг, и фрагмента для идентификации объекта. **Мапиуид** — это структура, содержащая глобальный уникальный идентификатор (GUID). GUID это идентификатор, независимый от порядка следования байтов, который можно создать с помощью средства Microsoft Visual Studio*CREATE GUID**. 
  
Поставщик услуг регистрирует свою структуру **мапиуид** с помощью MAPI в процессе входа в вызове метода [Имаписуппорт:: сетпровидеруид](imapisupport-setprovideruid.md) . Когда клиент вызывает метод **OpenEntry** для доступа к объекту, MAPI использует структуру **мапиуид** , чтобы определить, какой поставщик услуг может предоставить этот доступ. Поставщики услуг должны использовать одну и ту же структуру **мапиуид** для всех версий библиотеки DLL. Это позволяет клиентам с более новой версией реагировать на сообщения, отправленные и сохраненные в более старую версию. 
  
Остальная часть элемента **AB** после 16 – байтового **мапиуид** содержит двоичные данные, зависящие от поставщика службы, для идентификации определенных объектов. Для этой части идентификатора записи нет фиксированного размера. Это может быть любой размер в пределах причины. Поставщик услуг обычно включает в эту часть идентификаторов записей следующую информацию: 
  
- Сведения о версии — так как поставщик услуг обычно изменяет формат идентификаторов записей с версии на Version, хранение сведений о версии позволяет быстро определить способ расшифровки любого идентификатора записи.
    
- Сведения о расположении — сведения о расположении — это данные, которые предоставляют поставщику услуг индикатор того, как искать объект, представленный идентификатором записи. Например, поставщик услуг может хранить смещение диска для последнего места в файле данных, в котором был сохранен объект. Так как эти сведения могут изменяться со временем, поставщики услуг предоставляют несколько способов поиска объектов в идентификаторах записей.
    
Несмотря на то, что поставщики услуг могут перезапускать свои идентификаторы записей, следует избегать подобных рекомендаций. Если необходимо повторно использовать идентификатор записи, поставщики услуг должны отложить период времени между первоначальным использованием и повторное использование, если это возможно. Кроме того, идентификатор записи следует переназначить другому объекту того же типа. То есть конкретный идентификатор записи не должен быть связан сначала с сообщением, а затем с папкой.
  
## <a name="see-also"></a>См. также



[Идентификаторы записей MAPI](mapi-entry-identifiers.md)


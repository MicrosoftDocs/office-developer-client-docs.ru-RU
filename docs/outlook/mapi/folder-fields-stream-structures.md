---
title: Структуры потока поля папок
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336892"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="ccdd2-103">Структуры потока поля папок</span><span class="sxs-lookup"><span data-stu-id="ccdd2-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="ccdd2-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ccdd2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ccdd2-105">Свойство [PidTagUserFields](pidtaguserfields-canonical-property.md) сообщения содержит двоичный поток FolderUserFields, который содержит определения поля, определенные пользователем папки.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="ccdd2-106">В этом разделе описываются структуры потока для определений полей, определенных пользователем для папок.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="ccdd2-107">Структура потока FolderUserFields состоит из структуры FolderUserFieldsA или структуры FolderUserFieldsA, а затем структуры FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="ccdd2-108">Элементы данных в этом потоке хранятся сразу после друг друга в указанном ниже порядке:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ccdd2-109">**FolderUserFieldsAnsi**: структура потока folderUserFieldsA.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="ccdd2-110">**FolderUserFieldsUnicode** (необязательно): структура потока folderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="ccdd2-111">Наличие folderUserFieldsUnicode определяется общей длиной folderUserFields, которая превышает длину FolderUserFieldsAnsi.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="ccdd2-112">FolderUserFieldsAnsi используется для совместимости с более старыми версиями клиентов MAPI, поэтому если folderUserFieldsUnicode присутствует, содержимое FolderUserFieldsAnsi игнорируется.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="ccdd2-113">Чтобы избежать возможной потери данных при преобразовании ANSI, при создании потока FolderUserFields всегда включается часть FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="ccdd2-114">Структура потока folderUserFieldsA</span><span class="sxs-lookup"><span data-stu-id="ccdd2-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="ccdd2-115">Структура потока FolderUserFieldsA — это массив структур потока FolderFieldDefinitionA, содержащих определения для всех определенных пользователем полей в папке Outlook, если только она не переопределена частью folderUserFieldsW структуры FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="ccdd2-116">Элементы данных в этом потоке хранятся в порядке маленького byte, сразу же следуя друг за другом в указанном ниже порядке:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ccdd2-117">**FieldDefinitionCount**: DWORD (4 bytes), количество определений полей в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="ccdd2-118">Это количество элементов в **массиве FieldDefinitions.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="ccdd2-119">**FieldDefinitions:** массив структур потока FolderFieldDefinitionA.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="ccdd2-120">Количество этого массива равно элементу **данных FieldDefinitionCount.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="ccdd2-121">Если эта folderUserFieldsA не будет переопределена частью folderUserFieldsW структуры FolderUserFields, массив **FieldDefinitions** должен быть "неокончен", имея поле Common.FieldType последнего элемента FolderFieldDefinitionA, равное поле ftNull.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="ccdd2-122">Структура потока folderUserFieldsW</span><span class="sxs-lookup"><span data-stu-id="ccdd2-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="ccdd2-123">Структура потока FolderUserFieldsW — это массив структур потока FolderFieldDefinitionW, содержащих определения для всех определенных пользователем полей в Outlook папке.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="ccdd2-124">Элементы данных в этом потоке хранятся в порядке маленького byte, сразу же следуя друг за другом в указанном ниже порядке:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ccdd2-125">**FieldDefinitionCount**: DWORD (4 bytes), количество определений полей в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="ccdd2-126">Это количество элементов в **массиве FieldDefinitions.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="ccdd2-127">**FieldDefinitions:** массив структур потока FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="ccdd2-128">Количество этого массива равно элементу **данных FieldDefinitionCount.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="ccdd2-129">Массив **FieldDefinitions** должен быть "прекращен" с помощью поля Common.FieldType последнего элемента FolderFieldDefinitionW, равного поле ftNull.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="ccdd2-130">Структура потока folderFieldDefinitionA</span><span class="sxs-lookup"><span data-stu-id="ccdd2-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="ccdd2-131">Структура потока FolderFieldDefinitionA содержит определение определенного пользователем поля с именем поля, хранимого в ANSI.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="ccdd2-132">Элементы данных в этом потоке хранятся в порядке маленького byte, сразу же следуя друг за другом в указанном ниже порядке:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ccdd2-133">**FieldType**: FldType (4 bytes), тип этого поля.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="ccdd2-134">**FieldNameLength**: WORD (2 bytes), количество элементов в **массиве FieldName.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="ccdd2-135">**FieldName**: массив CHAR.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="ccdd2-136">Это представление кода CP_ACP anSI.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="ccdd2-137">Количество этого массива равно **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="ccdd2-138">Имя поля должно удовлетворять ограничениям по параметру Name, указанным в [методе UserProperties.Add.](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx)</span><span class="sxs-lookup"><span data-stu-id="ccdd2-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="ccdd2-139">По причинам устаревшей совместимости Outlook могут обрабатывать некоторые значения **FieldName,** не удовлетворяющие этим ограничениям, однако такие случаи не охватываются этой темой.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="ccdd2-140">**Общие:** структура потока FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="ccdd2-141">Структура потока folderFieldDefinitionW</span><span class="sxs-lookup"><span data-stu-id="ccdd2-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="ccdd2-142">Структура потока FolderFieldDefinitionW содержит определение пользовательского поля с именем поля, хранимого в Unicode.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="ccdd2-143">Элементы данных в этом потоке хранятся в порядке маленького byte, сразу же следуя друг за другом в указанном ниже порядке:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ccdd2-144">**FieldType**: FldType (4 bytes), тип этого поля.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="ccdd2-145">**FieldNameLength**: WORD (2 bytes), количество элементов в **массиве FieldName.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="ccdd2-146">**Имя поля:** массив WCHAR.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="ccdd2-147">Это представление имени поля Unicode (UTF-16).</span><span class="sxs-lookup"><span data-stu-id="ccdd2-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="ccdd2-148">Количество этого массива равно **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="ccdd2-149">Имя поля должно удовлетворять ограничениям по параметру Name, указанным в [методе UserProperties.Add.](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx)</span><span class="sxs-lookup"><span data-stu-id="ccdd2-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="ccdd2-150">По причинам устаревшей совместимости Outlook могут обрабатывать некоторые значения **FieldName,** не удовлетворяющие этим ограничениям, но такие случаи не охватываются этой темой.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="ccdd2-151">**Общие:** структура потока FolderFieldDefinitionCommon.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="ccdd2-152">Переумерия FldType</span><span class="sxs-lookup"><span data-stu-id="ccdd2-152">FldType Enumeration</span></span>

<span data-ttu-id="ccdd2-153">**Значения перечисления FldType** перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="ccdd2-154">Имя</span><span class="sxs-lookup"><span data-stu-id="ccdd2-154">Name</span></span>|<span data-ttu-id="ccdd2-155">Значение</span><span class="sxs-lookup"><span data-stu-id="ccdd2-155">Value</span></span>|<span data-ttu-id="ccdd2-156">Смысл</span><span class="sxs-lookup"><span data-stu-id="ccdd2-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="ccdd2-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="ccdd2-157">ftNull</span></span>  <br/> |<span data-ttu-id="ccdd2-158">0x0</span><span class="sxs-lookup"><span data-stu-id="ccdd2-158">0x0</span></span>  <br/> |<span data-ttu-id="ccdd2-159">Этот тип поля используется для null-terminate массива определений полей.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="ccdd2-160">ftString</span><span class="sxs-lookup"><span data-stu-id="ccdd2-160">ftString</span></span>  <br/> |<span data-ttu-id="ccdd2-161">0x1</span><span class="sxs-lookup"><span data-stu-id="ccdd2-161">0x1</span></span>  <br/> |<span data-ttu-id="ccdd2-162">Текст</span><span class="sxs-lookup"><span data-stu-id="ccdd2-162">Text</span></span>  <br/> |
|<span data-ttu-id="ccdd2-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="ccdd2-163">ftInteger</span></span>  <br/> |<span data-ttu-id="ccdd2-164">0x3</span><span class="sxs-lookup"><span data-stu-id="ccdd2-164">0x3</span></span>  <br/> |<span data-ttu-id="ccdd2-165">Целое число</span><span class="sxs-lookup"><span data-stu-id="ccdd2-165">Integer</span></span>  <br/> |
|<span data-ttu-id="ccdd2-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="ccdd2-166">ftTime</span></span>  <br/> |<span data-ttu-id="ccdd2-167">0x5</span><span class="sxs-lookup"><span data-stu-id="ccdd2-167">0x5</span></span>  <br/> |<span data-ttu-id="ccdd2-168">Дата/время</span><span class="sxs-lookup"><span data-stu-id="ccdd2-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="ccdd2-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="ccdd2-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="ccdd2-170">0x6</span><span class="sxs-lookup"><span data-stu-id="ccdd2-170">0x6</span></span>  <br/> |<span data-ttu-id="ccdd2-171">Да или Нет</span><span class="sxs-lookup"><span data-stu-id="ccdd2-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="ccdd2-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="ccdd2-172">ftDuration</span></span>  <br/> |<span data-ttu-id="ccdd2-173">0x7</span><span class="sxs-lookup"><span data-stu-id="ccdd2-173">0x7</span></span>  <br/> |<span data-ttu-id="ccdd2-174">Длительность</span><span class="sxs-lookup"><span data-stu-id="ccdd2-174">Duration</span></span>  <br/> |
|<span data-ttu-id="ccdd2-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="ccdd2-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="ccdd2-176">0xB</span><span class="sxs-lookup"><span data-stu-id="ccdd2-176">0xB</span></span>  <br/> |<span data-ttu-id="ccdd2-177">Ключевые слова</span><span class="sxs-lookup"><span data-stu-id="ccdd2-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="ccdd2-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="ccdd2-178">ftFloat</span></span>  <br/> |<span data-ttu-id="ccdd2-179">0xC</span><span class="sxs-lookup"><span data-stu-id="ccdd2-179">0xC</span></span>  <br/> |<span data-ttu-id="ccdd2-180">Число или процент</span><span class="sxs-lookup"><span data-stu-id="ccdd2-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="ccdd2-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="ccdd2-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="ccdd2-182">0xE</span><span class="sxs-lookup"><span data-stu-id="ccdd2-182">0xE</span></span>  <br/> |<span data-ttu-id="ccdd2-183">Денежный</span><span class="sxs-lookup"><span data-stu-id="ccdd2-183">Currency</span></span>  <br/> |
|<span data-ttu-id="ccdd2-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="ccdd2-184">ftCalc</span></span>  <br/> |<span data-ttu-id="ccdd2-185">0x12</span><span class="sxs-lookup"><span data-stu-id="ccdd2-185">0x12</span></span>  <br/> |<span data-ttu-id="ccdd2-186">Формула</span><span class="sxs-lookup"><span data-stu-id="ccdd2-186">Formula</span></span>  <br/> |
|<span data-ttu-id="ccdd2-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="ccdd2-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="ccdd2-188">0x13</span><span class="sxs-lookup"><span data-stu-id="ccdd2-188">0x13</span></span>  <br/> |<span data-ttu-id="ccdd2-189">Сочетание типа, показывающая только первое не пустое поле, игнорируя последующие.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="ccdd2-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="ccdd2-190">ftConcat</span></span>  <br/> |<span data-ttu-id="ccdd2-191">0x17</span><span class="sxs-lookup"><span data-stu-id="ccdd2-191">0x17</span></span>  <br/> |<span data-ttu-id="ccdd2-192">Сочетание типовой присоединение полей и любых фрагментов текста друг к другу.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="ccdd2-193">Структура потока folderFieldDefinitionCommon</span><span class="sxs-lookup"><span data-stu-id="ccdd2-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="ccdd2-194">Структура потока folderFieldDefinitionCommon содержит данные определения поля, определяемого пользователем, которое является общим как для folderFieldDefinitionA, так и для folderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="ccdd2-195">Элементы данных в этом потоке хранятся в порядке маленького byte, сразу же следуя друг за другом в указанном ниже порядке:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="ccdd2-196">**PropSetGuid**: GUID (16 bytes), набор свойств GUID соответствующего имени свойства MAPI поля папки.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="ccdd2-197">Значение этого поля должно быть равно PS_PUBLIC_STRINGS, если тип поля не **является ftNone,** в этом случае значение этого поля должно быть равно GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="ccdd2-198">По причинам устаревшей совместимости Outlook могут обрабатывать некоторые значения **PropSetGuid,** не удовлетворяющие этому ограничению, однако такие случаи не охватываются этой темой.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="ccdd2-199">**fcapm**: DWORD (4 bytes), сочетание нуля или более флагов, значения которых и значения перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="ccdd2-200">Флаги с одинаковым значением имеют значения, зависящие от типа поля, то есть значения FldType.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="ccdd2-201">Имя флага</span><span class="sxs-lookup"><span data-stu-id="ccdd2-201">Flag name</span></span>|<span data-ttu-id="ccdd2-202">Значение</span><span class="sxs-lookup"><span data-stu-id="ccdd2-202">Value</span></span>|<span data-ttu-id="ccdd2-203">Смысл</span><span class="sxs-lookup"><span data-stu-id="ccdd2-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="ccdd2-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="ccdd2-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="ccdd2-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="ccdd2-205">0x00000001</span></span>  <br/> |<span data-ttu-id="ccdd2-206">Поле редактируемо.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="ccdd2-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="ccdd2-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="ccdd2-208">0x00000002</span></span>  <br/> |<span data-ttu-id="ccdd2-209">Поле сортируемый.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="ccdd2-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="ccdd2-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="ccdd2-211">0x00000004</span></span>  <br/> |<span data-ttu-id="ccdd2-212">Поле сгруппивное.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="ccdd2-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="ccdd2-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="ccdd2-214">0x00000100</span></span>  <br/> |<span data-ttu-id="ccdd2-215">Поле может вметь несколько строк текста.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="ccdd2-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="ccdd2-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="ccdd2-217">0x01000000</span></span>  <br/> |<span data-ttu-id="ccdd2-218">Это поле типа ftFloat — это процентное поле.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="ccdd2-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="ccdd2-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="ccdd2-220">0x01000000</span></span>  <br/> |<span data-ttu-id="ccdd2-221">Это поле типа ftTime — это поле времени только для дат.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="ccdd2-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="ccdd2-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="ccdd2-223">0x01000000</span></span>  <br/> |<span data-ttu-id="ccdd2-224">Для этого поля типа ftInteger ни один блок не разрешен в формате отображения; например, такие форматы, как "Computer - 640 K..." не допускается.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="ccdd2-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="ccdd2-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="ccdd2-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="ccdd2-226">0x80000000</span></span>  <br/> |<span data-ttu-id="ccdd2-227">Поле может быть изменено в элементе. Это специально для настраиваемой формы.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="ccdd2-228">**dwString**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="ccdd2-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="ccdd2-229">См. первую следующую заметку.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-229">See the first following Note.</span></span>
    
- <span data-ttu-id="ccdd2-230">**dwBitmap**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="ccdd2-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="ccdd2-231">См. первую следующую заметку.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-231">See the first following Note.</span></span>
    
- <span data-ttu-id="ccdd2-232">**dwDisplay**: DWORD (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="ccdd2-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="ccdd2-233">См. первую следующую заметку.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-233">See the first following Note.</span></span>
    
- <span data-ttu-id="ccdd2-234">**iFmt**: INT (4 bytes).</span><span class="sxs-lookup"><span data-stu-id="ccdd2-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="ccdd2-235">Для типов полей, которые имеют диалоговое окно "Format:" в диалоговых окнах "Новое поле", "Изменить поле" и "Свойства поля", индекс формата на основе 0, выбранный в этом диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="ccdd2-236">Для типов полей без этого комбо-окна это должно быть 0.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="ccdd2-237">Значение поля вместе с типом поля однозначно определяет значения полей **dwString,** **dwBitmap** и **dwDisplay,** см. в первой следующей заметке.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="ccdd2-238">**wszFormulaLength**: WORD (2 bytes), количество элементов в **массиве wszFormulaLength.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="ccdd2-239">**wszFormulaLength**: массив WCHAR.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="ccdd2-240">Это представление единой строки формулы поля (UTF-16) в стандартном формате.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="ccdd2-241">См. вторую ниже примечание для описания стандартных форматов и форматов пользовательского интерфейса формулы поля.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="ccdd2-242">Количество этого массива равно **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="ccdd2-243">Строка формулы должна быть пустой строкой, если тип поля **не является ftCalc,** **ftSwitch** или **ftConcat.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="ccdd2-244">Хотя значения **dwString,** **dwBitmap** и **dwDisplay** однозначно определяются на основе значения **FldType** и **значения iFmt,** которые являются избыточными, их правильные значения по-прежнему необходимы для правильной обработки определения поля Outlook.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="ccdd2-245">Нет простого описания алгоритма, который выполняет это определение.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="ccdd2-246">Таким образом, чтобы выяснить, какие значения **dwString,** **dwBitmap** и **dwDisplay** соответствуют заданным значениям **FldType** и **iFmt,** выполните тест, создав определенное пользователем поле этого типа, а также с помощью этого формата, выбранного в поле **Комбо** Format, при условии его применимости, проверьте создаваемый поток **FolderUserFields,** который Outlook создается для этого пользовательского поля.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="ccdd2-247">Формула поля в формате пользовательского интерфейса  редактирована в текстовом окне Формула диалоговых диалогов **New Field,** **Edit Field** и **Field Properties** для определенного пользователем поля.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="ccdd2-248">Алгоритм преобразования формулы из формата пользовательского интерфейса в стандартный зависит от типа поля, описанного ниже:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="ccdd2-249">Для полей типов **ftCalc** и **ftSwitch** стандартный формат встроенных полей, для которых соответствующие свойства MAPI не называются свойствами типа MNID STRING, получается путем замены фрагментов имен полей, то есть \_ `[<field_name>]` `[_<field_dispid_decimal>]` фрагментов.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="ccdd2-250">Например, если формат пользовательского интерфейса формулы для поля типа Formula **,** то есть **ftCalc,** с языком Office пользовательского интерфейса, который является английским, является , где имя определенного пользователем поля, стандартный формат такой формулы будет `[Business Phone] & [My custom field]` `My custom field` `[_14856] & [My custom field]` .</span><span class="sxs-lookup"><span data-stu-id="ccdd2-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="ccdd2-251">Для полей типа **ftConcat** стандартный формат получается, выполняя следующие:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="ccdd2-252">Усечено ведущее и трейлинг-белое пространство.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="ccdd2-253">Размыть формулу в последовательность фрагментов следующих двух видов:</span><span class="sxs-lookup"><span data-stu-id="ccdd2-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="ccdd2-254">Имя поля в квадратных скобках, то есть `[<field_name>]` .</span><span class="sxs-lookup"><span data-stu-id="ccdd2-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="ccdd2-255">Подстройка, не содержащая квадратных скобок.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="ccdd2-256">Убедитесь, что в последовательности нет двух фрагментов второго типа.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="ccdd2-257">Если формула не может быть разсчитана таким образом, она считается недействительной.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="ccdd2-258">Выполните ту же замену фрагментов первого типа, что и для **полей ftCalc** и **ftSwitch.**</span><span class="sxs-lookup"><span data-stu-id="ccdd2-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="ccdd2-259">Для каждого фрагмента второго типа избежите все символы двойного кавычка ("""), если они есть, с двумя последовательными двукавыми символами и заключим его в двойные кавычка.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="ccdd2-260">Вставьте строку ampersand `&` () между каждой парой смежных фрагментов.</span><span class="sxs-lookup"><span data-stu-id="ccdd2-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="ccdd2-261">Например, с помощью языка Office пользовательского интерфейса us English, если формат пользовательского интерфейса формулы для поля типа **ftConcat** — где имя определенного пользователем поля, стандартный формат для такой формулы будет `text1 [Business Phone] "text2" [My custom field]` `My custom field` `""text1" & [_14856] & """text2""" & [My custom field]"` .</span><span class="sxs-lookup"><span data-stu-id="ccdd2-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="ccdd2-262">См. также</span><span class="sxs-lookup"><span data-stu-id="ccdd2-262">See also</span></span>

- [<span data-ttu-id="ccdd2-263">Пример потока folderUserFields</span><span class="sxs-lookup"><span data-stu-id="ccdd2-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="ccdd2-264">Добавление определения для нового User-Defined поля</span><span class="sxs-lookup"><span data-stu-id="ccdd2-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)


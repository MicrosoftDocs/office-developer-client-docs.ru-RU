---
title: Структуры потока полей папок
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336892"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="2709b-103">Структуры потока полей папок</span><span class="sxs-lookup"><span data-stu-id="2709b-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="2709b-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2709b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2709b-105">Свойство [PidTagUserFields](pidtaguserfields-canonical-property.md) сообщения содержит двоичный поток, FolderUserFields, который содержит определения определяемых пользователем полей папки.</span><span class="sxs-lookup"><span data-stu-id="2709b-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="2709b-106">В этом разделе описываются структуры потока для определений определяемых пользователем полей папки.</span><span class="sxs-lookup"><span data-stu-id="2709b-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="2709b-107">Структура потока FolderUserFields состоит из структуры Фолдерусерфиелдса или структуры Фолдерусерфиелдса, а затем структуры Фолдерусерфиелдсв.</span><span class="sxs-lookup"><span data-stu-id="2709b-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="2709b-108">Элементы данных в этом потоке хранятся сразу друг от друга в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="2709b-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2709b-109">**Фолдерусерфиелдсанси**: структура потока фолдерусерфиелдса.</span><span class="sxs-lookup"><span data-stu-id="2709b-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="2709b-110">**Фолдерусерфиелдсуникоде** (необязательно): структура потока фолдерусерфиелдсв.</span><span class="sxs-lookup"><span data-stu-id="2709b-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="2709b-111">Присутствие Фолдерусерфиелдсуникоде определяется общей длиной FolderUserFields, превышающей длину Фолдерусерфиелдсанси.</span><span class="sxs-lookup"><span data-stu-id="2709b-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="2709b-112">Фолдерусерфиелдсанси используется для совместимости с более старыми версиями клиентов MAPI, не поддерживающими Юникод, поэтому при наличии Фолдерусерфиелдсуникоде содержимое Фолдерусерфиелдсанси игнорируется.</span><span class="sxs-lookup"><span data-stu-id="2709b-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="2709b-113">Чтобы избежать возможной потери данных в преобразовании ANSI, при создании потока FolderUserFields всегда включается часть Фолдерусерфиелдсв.</span><span class="sxs-lookup"><span data-stu-id="2709b-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="2709b-114">Структура потока Фолдерусерфиелдса</span><span class="sxs-lookup"><span data-stu-id="2709b-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="2709b-115">Структура потока Фолдерусерфиелдса — это массив структуры потоков Фолдерфиелддефинитиона, который содержит определения для всех пользовательских полей в папке Outlook, если не переопределен частью Фолдерусерфиелдсв структуры FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="2709b-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="2709b-116">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="2709b-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2709b-117">**Фиелддефинитионкаунт**: DWORD (4 байта), количество определений полей в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="2709b-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="2709b-118">Это количество элементов в массиве **фиелддефинитионс** .</span><span class="sxs-lookup"><span data-stu-id="2709b-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="2709b-119">**Фиелддефинитионс**: массив структуры потоков фолдерфиелддефинитиона.</span><span class="sxs-lookup"><span data-stu-id="2709b-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="2709b-120">Количество этого массива равно элементу данных **фиелддефинитионкаунт** .</span><span class="sxs-lookup"><span data-stu-id="2709b-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="2709b-121">Если это Фолдерусерфиелдса не переопределено частью Фолдерусерфиелдсв структуры FolderUserFields, массив **фиелддефинитионс** должен иметь значение "null-завершено", указав для свойства Last. фолдерфиелддефинитиона элемента Last FieldType значение фтнулл.</span><span class="sxs-lookup"><span data-stu-id="2709b-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="2709b-122">Структура потока Фолдерусерфиелдсв</span><span class="sxs-lookup"><span data-stu-id="2709b-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="2709b-123">Структура потока Фолдерусерфиелдсв — это массив структуры потоков Фолдерфиелддефинитионв, в котором содержатся определения для всех полей, определенных пользователем, в папке Outlook.</span><span class="sxs-lookup"><span data-stu-id="2709b-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="2709b-124">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="2709b-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2709b-125">**Фиелддефинитионкаунт**: DWORD (4 байта), количество определений полей в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="2709b-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="2709b-126">Это количество элементов в массиве **фиелддефинитионс** .</span><span class="sxs-lookup"><span data-stu-id="2709b-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="2709b-127">**Фиелддефинитионс**: массив структуры потоков фолдерфиелддефинитионв.</span><span class="sxs-lookup"><span data-stu-id="2709b-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="2709b-128">Количество этого массива равно элементу данных **фиелддефинитионкаунт** .</span><span class="sxs-lookup"><span data-stu-id="2709b-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="2709b-129">Массив **фиелддефинитионс** должен иметь значение "нулем — завершено", так как его Последнее поле Фолдерфиелддефинитионв элемента равно фтнулл.</span><span class="sxs-lookup"><span data-stu-id="2709b-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="2709b-130">Структура потока Фолдерфиелддефинитиона</span><span class="sxs-lookup"><span data-stu-id="2709b-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="2709b-131">Структура потока Фолдерфиелддефинитиона содержит определение определяемого пользователем поля с именем поля, хранящимся в кодировке ANSI.</span><span class="sxs-lookup"><span data-stu-id="2709b-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="2709b-132">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="2709b-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2709b-133">**FieldType**: флдтипе (4 байта), тип этого поля.</span><span class="sxs-lookup"><span data-stu-id="2709b-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="2709b-134">**Фиелднамеленгс**: Word (2 байта), количество элементов в **самом массиве** .</span><span class="sxs-lookup"><span data-stu-id="2709b-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="2709b-135">**Fieldname**: массив char.</span><span class="sxs-lookup"><span data-stu-id="2709b-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="2709b-136">Это представление имени поля в виде кодовой страницы ANSI CP_ACP.</span><span class="sxs-lookup"><span data-stu-id="2709b-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="2709b-137">Количество этого массива равно **фиелднамеленгс**.</span><span class="sxs-lookup"><span data-stu-id="2709b-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="2709b-138">Имя поля должно удовлетворять ограничениям для параметра name, как указано в методе [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2709b-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="2709b-139">В целях обеспечения совместимости с устаревшими версиями Outlook может **обрабатывать некоторые значения** , которые не удовлетворяют этим ограничениям, но такие случаи не рассматриваются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="2709b-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="2709b-140">**Общие**: структура потока фолдерфиелддефинитионкоммон.</span><span class="sxs-lookup"><span data-stu-id="2709b-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="2709b-141">Структура потока Фолдерфиелддефинитионв</span><span class="sxs-lookup"><span data-stu-id="2709b-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="2709b-142">Структура потока Фолдерфиелддефинитионв содержит определение определяемого пользователем поля с именем поля, хранящимся в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="2709b-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="2709b-143">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="2709b-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2709b-144">**FieldType**: флдтипе (4 байта), тип этого поля.</span><span class="sxs-lookup"><span data-stu-id="2709b-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="2709b-145">**Фиелднамеленгс**: Word (2 байта), количество элементов в **самом массиве** .</span><span class="sxs-lookup"><span data-stu-id="2709b-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="2709b-146">**Fieldname**: массив типа WCHAR.</span><span class="sxs-lookup"><span data-stu-id="2709b-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="2709b-147">Это представление в Юникоде (UTF-16) имени поля.</span><span class="sxs-lookup"><span data-stu-id="2709b-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="2709b-148">Количество этого массива равно **фиелднамеленгс**.</span><span class="sxs-lookup"><span data-stu-id="2709b-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="2709b-149">Имя поля должно удовлетворять ограничениям для параметра name, как указано в методе [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2709b-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="2709b-150">В целях совместимости с устаревшими версиями Outlook может **обрабатывать некоторые значения** , которые не удовлетворяют этим ограничениям, но такие случаи не рассматриваются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="2709b-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="2709b-151">**Общие**: структура потока фолдерфиелддефинитионкоммон.</span><span class="sxs-lookup"><span data-stu-id="2709b-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="2709b-152">Перечисление Флдтипе</span><span class="sxs-lookup"><span data-stu-id="2709b-152">FldType Enumeration</span></span>

<span data-ttu-id="2709b-153">Значения перечислений **флдтипе** перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="2709b-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="2709b-154">Имя</span><span class="sxs-lookup"><span data-stu-id="2709b-154">Name</span></span>|<span data-ttu-id="2709b-155">Значение</span><span class="sxs-lookup"><span data-stu-id="2709b-155">Value</span></span>|<span data-ttu-id="2709b-156">Смысл</span><span class="sxs-lookup"><span data-stu-id="2709b-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2709b-157">фтнулл</span><span class="sxs-lookup"><span data-stu-id="2709b-157">ftNull</span></span>  <br/> |<span data-ttu-id="2709b-158">0x0</span><span class="sxs-lookup"><span data-stu-id="2709b-158">0x0</span></span>  <br/> |<span data-ttu-id="2709b-159">Этот тип поля используется для завершения работы массива определений поля (null).</span><span class="sxs-lookup"><span data-stu-id="2709b-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="2709b-160">фтстринг</span><span class="sxs-lookup"><span data-stu-id="2709b-160">ftString</span></span>  <br/> |<span data-ttu-id="2709b-161">0x1</span><span class="sxs-lookup"><span data-stu-id="2709b-161">0x1</span></span>  <br/> |<span data-ttu-id="2709b-162">Текст</span><span class="sxs-lookup"><span data-stu-id="2709b-162">Text</span></span>  <br/> |
|<span data-ttu-id="2709b-163">фтинтежер</span><span class="sxs-lookup"><span data-stu-id="2709b-163">ftInteger</span></span>  <br/> |<span data-ttu-id="2709b-164">0x3</span><span class="sxs-lookup"><span data-stu-id="2709b-164">0x3</span></span>  <br/> |<span data-ttu-id="2709b-165">Целое число</span><span class="sxs-lookup"><span data-stu-id="2709b-165">Integer</span></span>  <br/> |
|<span data-ttu-id="2709b-166">фттиме</span><span class="sxs-lookup"><span data-stu-id="2709b-166">ftTime</span></span>  <br/> |<span data-ttu-id="2709b-167">0x5</span><span class="sxs-lookup"><span data-stu-id="2709b-167">0x5</span></span>  <br/> |<span data-ttu-id="2709b-168">Дата и время</span><span class="sxs-lookup"><span data-stu-id="2709b-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="2709b-169">фтбулеан</span><span class="sxs-lookup"><span data-stu-id="2709b-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="2709b-170">0x6</span><span class="sxs-lookup"><span data-stu-id="2709b-170">0x6</span></span>  <br/> |<span data-ttu-id="2709b-171">Да или Нет</span><span class="sxs-lookup"><span data-stu-id="2709b-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="2709b-172">фтдуратион</span><span class="sxs-lookup"><span data-stu-id="2709b-172">ftDuration</span></span>  <br/> |<span data-ttu-id="2709b-173">0x7</span><span class="sxs-lookup"><span data-stu-id="2709b-173">0x7</span></span>  <br/> |<span data-ttu-id="2709b-174">Длительность</span><span class="sxs-lookup"><span data-stu-id="2709b-174">Duration</span></span>  <br/> |
|<span data-ttu-id="2709b-175">фтмултистринг</span><span class="sxs-lookup"><span data-stu-id="2709b-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="2709b-176">0xB</span><span class="sxs-lookup"><span data-stu-id="2709b-176">0xB</span></span>  <br/> |<span data-ttu-id="2709b-177">Ключевые слова</span><span class="sxs-lookup"><span data-stu-id="2709b-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="2709b-178">фтфлоат</span><span class="sxs-lookup"><span data-stu-id="2709b-178">ftFloat</span></span>  <br/> |<span data-ttu-id="2709b-179">0xC</span><span class="sxs-lookup"><span data-stu-id="2709b-179">0xC</span></span>  <br/> |<span data-ttu-id="2709b-180">Число или процент</span><span class="sxs-lookup"><span data-stu-id="2709b-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="2709b-181">фткурренци</span><span class="sxs-lookup"><span data-stu-id="2709b-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="2709b-182">0xE</span><span class="sxs-lookup"><span data-stu-id="2709b-182">0xE</span></span>  <br/> |<span data-ttu-id="2709b-183">Денежный</span><span class="sxs-lookup"><span data-stu-id="2709b-183">Currency</span></span>  <br/> |
|<span data-ttu-id="2709b-184">фткалк</span><span class="sxs-lookup"><span data-stu-id="2709b-184">ftCalc</span></span>  <br/> |<span data-ttu-id="2709b-185">0x12</span><span class="sxs-lookup"><span data-stu-id="2709b-185">0x12</span></span>  <br/> |<span data-ttu-id="2709b-186">Формула</span><span class="sxs-lookup"><span data-stu-id="2709b-186">Formula</span></span>  <br/> |
|<span data-ttu-id="2709b-187">фтсвитч</span><span class="sxs-lookup"><span data-stu-id="2709b-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="2709b-188">0x13</span><span class="sxs-lookup"><span data-stu-id="2709b-188">0x13</span></span>  <br/> |<span data-ttu-id="2709b-189">Комбинация типа, отражающая только первое непустое поле — игнорирует последующие.</span><span class="sxs-lookup"><span data-stu-id="2709b-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="2709b-190">фтконкат</span><span class="sxs-lookup"><span data-stu-id="2709b-190">ftConcat</span></span>  <br/> |<span data-ttu-id="2709b-191">0x17</span><span class="sxs-lookup"><span data-stu-id="2709b-191">0x17</span></span>  <br/> |<span data-ttu-id="2709b-192">Сочетание типа присоединяемых полей и любых фрагментов текста друг с другом.</span><span class="sxs-lookup"><span data-stu-id="2709b-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="2709b-193">Структура потока Фолдерфиелддефинитионкоммон</span><span class="sxs-lookup"><span data-stu-id="2709b-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="2709b-194">Структура потока Фолдерфиелддефинитионкоммон содержит данные определяемого пользователем определения поля, которое является общим для Фолдерфиелддефинитиона и Фолдерфиелддефинитионв.</span><span class="sxs-lookup"><span data-stu-id="2709b-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="2709b-195">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="2709b-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="2709b-196">**Пропсетгуид**: GUID (16 байт), идентификатор GUID набора свойств соответствующего имени свойства MAPI для поля папки.</span><span class="sxs-lookup"><span data-stu-id="2709b-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="2709b-197">Значение этого поля должно быть равно PS_PUBLIC_STRINGS, если тип поля не **фтноне** , в этом случае значение этого поля должно быть равно GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="2709b-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="2709b-198">В целях обеспечения совместимости с устаревшими версиями Outlook может обрабатывать некоторые значения **пропсетгуид** , не соответствующие этому ограничению, однако такие случаи не рассматриваются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="2709b-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="2709b-199">**фкапм**: DWORD (4 байта), комбинация нуля или более флагов. значения этих флагов перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="2709b-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="2709b-200">Флаги с одинаковым значением имеют значения, зависящие от типа поля, то есть значения Флдтипе.</span><span class="sxs-lookup"><span data-stu-id="2709b-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="2709b-201">Имя флага</span><span class="sxs-lookup"><span data-stu-id="2709b-201">Flag name</span></span>|<span data-ttu-id="2709b-202">Значение</span><span class="sxs-lookup"><span data-stu-id="2709b-202">Value</span></span>|<span data-ttu-id="2709b-203">Смысл</span><span class="sxs-lookup"><span data-stu-id="2709b-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="2709b-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="2709b-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="2709b-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="2709b-205">0x00000001</span></span>  <br/> |<span data-ttu-id="2709b-206">Поле доступно для редактирования.</span><span class="sxs-lookup"><span data-stu-id="2709b-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="2709b-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="2709b-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="2709b-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="2709b-208">0x00000002</span></span>  <br/> |<span data-ttu-id="2709b-209">Поле доступно для сортировки.</span><span class="sxs-lookup"><span data-stu-id="2709b-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="2709b-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="2709b-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="2709b-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="2709b-211">0x00000004</span></span>  <br/> |<span data-ttu-id="2709b-212">Поле является группированным.</span><span class="sxs-lookup"><span data-stu-id="2709b-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="2709b-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="2709b-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="2709b-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="2709b-214">0x00000100</span></span>  <br/> |<span data-ttu-id="2709b-215">Поле может содержать несколько строк текста.</span><span class="sxs-lookup"><span data-stu-id="2709b-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="2709b-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="2709b-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="2709b-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="2709b-217">0x01000000</span></span>  <br/> |<span data-ttu-id="2709b-218">Это поле типа Фтфлоат является процентным.</span><span class="sxs-lookup"><span data-stu-id="2709b-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="2709b-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="2709b-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="2709b-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="2709b-220">0x01000000</span></span>  <br/> |<span data-ttu-id="2709b-221">Это поле типа Фттиме — это поле даты и времени.</span><span class="sxs-lookup"><span data-stu-id="2709b-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="2709b-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="2709b-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="2709b-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="2709b-223">0x01000000</span></span>  <br/> |<span data-ttu-id="2709b-224">В этом поле типа Фтинтежер не допускается использование единиц в формате отображения; Например, такие форматы, как "Computering 640 K..." не разрешены.</span><span class="sxs-lookup"><span data-stu-id="2709b-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="2709b-225">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="2709b-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="2709b-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="2709b-226">0x80000000</span></span>  <br/> |<span data-ttu-id="2709b-227">Поле можно редактировать в элементе: это относится только к настраиваемым формам.</span><span class="sxs-lookup"><span data-stu-id="2709b-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="2709b-228">**двстринг**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="2709b-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="2709b-229">Ознакомьтесь с первой заметкой.</span><span class="sxs-lookup"><span data-stu-id="2709b-229">See the first following Note.</span></span>
    
- <span data-ttu-id="2709b-230">**двбитмап**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="2709b-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="2709b-231">Ознакомьтесь с первой заметкой.</span><span class="sxs-lookup"><span data-stu-id="2709b-231">See the first following Note.</span></span>
    
- <span data-ttu-id="2709b-232">**двдисплай**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="2709b-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="2709b-233">Ознакомьтесь с первой заметкой.</span><span class="sxs-lookup"><span data-stu-id="2709b-233">See the first following Note.</span></span>
    
- <span data-ttu-id="2709b-234">**ифмт**: int (4 байта).</span><span class="sxs-lookup"><span data-stu-id="2709b-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="2709b-235">Для типов полей с раскрывающимся списком "формат:" в диалоговых окнах "Создание поля", "изменение поля" и "Свойства поля" — индекс формата, который выбран в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="2709b-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="2709b-236">Для типов полей без поля со списком это значение должно быть равно 0.</span><span class="sxs-lookup"><span data-stu-id="2709b-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="2709b-237">Значение поля, вместе с типом поля, однозначно определяет значения полей **двстринг**, **двбитмап**и **двдисплай** , приведенные в первой заметке.</span><span class="sxs-lookup"><span data-stu-id="2709b-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="2709b-238">**всзформулаленгс**: Word (2 байта), количество элементов в массиве **всзформулаленгс** .</span><span class="sxs-lookup"><span data-stu-id="2709b-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="2709b-239">**всзформулаленгс**: массив типа WCHAR.</span><span class="sxs-lookup"><span data-stu-id="2709b-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="2709b-240">Это представление Юникод (UTF-16) строки формулы поля в стандартном формате.</span><span class="sxs-lookup"><span data-stu-id="2709b-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="2709b-241">В следующей заметке представлено описание стандартных форматов и форматов пользовательского интерфейса формулы поля.</span><span class="sxs-lookup"><span data-stu-id="2709b-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="2709b-242">Количество этого массива равно **всзформулаленгс**.</span><span class="sxs-lookup"><span data-stu-id="2709b-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="2709b-243">Строка формулы должна быть пустой строкой, если тип поля — **фткалк**, **фтсвитч** или **фтконкат**.</span><span class="sxs-lookup"><span data-stu-id="2709b-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="2709b-244">Несмотря на то, что значения **двстринг**, **двбитмап**и **двдисплай** однозначно определяются в соответствии со значением **флдтипе** и значением **ифмт** , которые являются избыточными, их правильные значения все еще необходимы для правильной обработки определения поля приложением Outlook.</span><span class="sxs-lookup"><span data-stu-id="2709b-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="2709b-245">Не существует простого описания алгоритма, который выполняет это определение.</span><span class="sxs-lookup"><span data-stu-id="2709b-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="2709b-246">Таким образом, чтобы узнать, какие значения **двстринг**, **двбитмап**и **двдисплай** соответствуют заданному значению **флдтипе** и **ифмт** значению, выполните тест, создав определяемое пользователем поле этого типа, а также с выбранным в поле со списком **форматом** форматом, при условии его применимости, изучите полученный **FolderUserFields** поток, создаваемый Outlook для этого поля пользователя.</span><span class="sxs-lookup"><span data-stu-id="2709b-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="2709b-247">Формула поля в формате пользовательского интерфейса редактируется в текстовом поле **Формула** для диалогового окна **Создание поля**, **изменение поля**и **Свойства поля** для поля, определяемого пользователем.</span><span class="sxs-lookup"><span data-stu-id="2709b-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="2709b-248">Алгоритм преобразования формулы из формата пользовательского интерфейса в стандартный формат зависит от типа поля, как описано ниже.</span><span class="sxs-lookup"><span data-stu-id="2709b-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="2709b-249">Для полей типов **фткалк** и **фтсвитч**стандартный формат для встроенных полей, которые соответствующие свойства MAPI не называются свойствами строки мнид\_, заменяются на фрагменты имен полей, которые относятся `[<field_name>]` к фрагментам. `[_<field_dispid_decimal>]`</span><span class="sxs-lookup"><span data-stu-id="2709b-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="2709b-250">Например, если формат пользовательского интерфейса формулы для поля типа **Формула**( **фткалк**) с языком пользовательского интерфейса Office Английский ( `[Business Phone] & [My custom field]`США), где `My custom field` — это имя пользовательского поля, будет использоваться `[_14856] & [My custom field]`стандартный формат такой формулы.</span><span class="sxs-lookup"><span data-stu-id="2709b-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="2709b-251">Для полей типа **фтконкат**стандартный формат получается путем выполнения следующих действий:</span><span class="sxs-lookup"><span data-stu-id="2709b-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="2709b-252">Усечение начальных и конечных пробелов.</span><span class="sxs-lookup"><span data-stu-id="2709b-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="2709b-253">Проанализируйте формулу в последовательности фрагментов следующих двух типов:</span><span class="sxs-lookup"><span data-stu-id="2709b-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="2709b-254">Имя поля в квадратных скобках, то есть, `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="2709b-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="2709b-255">Подстрока, не содержащая квадратных скобок.</span><span class="sxs-lookup"><span data-stu-id="2709b-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="2709b-256">Убедитесь, что ни один из двух фрагментов второго типа не является смежным в последовательности.</span><span class="sxs-lookup"><span data-stu-id="2709b-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="2709b-257">Если формула не может быть проанализирована таким образом, она считается недопустимой.</span><span class="sxs-lookup"><span data-stu-id="2709b-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="2709b-258">Выполните ту же замену для фрагментов первого типа, что и для полей **фткалк** и **фтсвитч** .</span><span class="sxs-lookup"><span data-stu-id="2709b-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="2709b-259">Для каждого фрагмента второго типа все символы двойных кавычек ("" "), если они есть, с двумя последовательными символами двойной кавычки и заключить их в двойные кавычки.</span><span class="sxs-lookup"><span data-stu-id="2709b-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="2709b-260">Вставка строки амперсанда (`&`) между каждой из двух смежных фрагментов.</span><span class="sxs-lookup"><span data-stu-id="2709b-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="2709b-261">Например, если используется английский язык ПОЛЬЗОВАТЕЛЬСКОГО интерфейса Office, то если для поля типа **фтконкат** задан `text1 [Business Phone] "text2" [My custom field]`формат пользовательского интерфейса, где `My custom field` — это имя определяемого пользователем поля, то для такой формулы будет использоваться `""text1" & [_14856] & """text2""" & [My custom field]"`стандартный формат.</span><span class="sxs-lookup"><span data-stu-id="2709b-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2709b-262">См. также</span><span class="sxs-lookup"><span data-stu-id="2709b-262">See also</span></span>

- [<span data-ttu-id="2709b-263">Пример потока FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="2709b-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="2709b-264">Добавление определения для нового пользовательского поля</span><span class="sxs-lookup"><span data-stu-id="2709b-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)


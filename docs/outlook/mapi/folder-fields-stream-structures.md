---
title: Структуры потоков полей папок
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: d6724914896fe7c40e9a456785aa5c92b84532fe
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808458"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="f1feb-103">Структуры потоков полей папок</span><span class="sxs-lookup"><span data-stu-id="f1feb-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="f1feb-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="f1feb-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="f1feb-105">Свойство [PidTagUserFields](pidtaguserfields-canonical-property.md) сообщение содержит двоичный поток FolderUserFields, который содержит определения полей, пользовательские папки.</span><span class="sxs-lookup"><span data-stu-id="f1feb-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="f1feb-106">В этом разделе описываются структуры потока для определения пользовательских полей папки.</span><span class="sxs-lookup"><span data-stu-id="f1feb-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="f1feb-107">Структура потока FolderUserFields состоит из структуры FolderUserFieldsA или FolderUserFieldsA структуры, а затем FolderUserFieldsW структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="f1feb-108">Элементы данных в этот поток, хранятся сразу после друг с другом в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f1feb-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="f1feb-109">**FolderUserFieldsAnsi**: FolderUserFieldsA в потоковом режиме структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="f1feb-110">**FolderUserFieldsUnicode** (необязательно): FolderUserFieldsW в потоковом режиме структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="f1feb-111">Общая длина FolderUserFields, которые больше, чем длина FolderUserFieldsAnsi обнаруживает присутствие FolderUserFieldsUnicode.</span><span class="sxs-lookup"><span data-stu-id="f1feb-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="f1feb-112">FolderUserFieldsAnsi используется для обеспечения совместимости с старые, Юникод, версий клиентов MAPI, поэтому при наличии FolderUserFieldsUnicode, содержимое FolderUserFieldsAnsi игнорируется.</span><span class="sxs-lookup"><span data-stu-id="f1feb-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="f1feb-113">Чтобы избежать возможных данных потери в преобразование ANSI, при создании потока FolderUserFields всегда включать часть FolderUserFieldsW.</span><span class="sxs-lookup"><span data-stu-id="f1feb-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="f1feb-114">Структура FolderUserFieldsA потока</span><span class="sxs-lookup"><span data-stu-id="f1feb-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="f1feb-115">Структура потока FolderUserFieldsA — массива структур FolderFieldDefinitionA потока, которые содержат определения для всех пользовательских полей в папке Outlook, если оно не переопределено FolderUserFieldsW частью структуры FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="f1feb-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="f1feb-116">Элементы данных в этот поток, хранятся в прямом байтовом, сразу после друг с другом в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f1feb-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="f1feb-117">**FieldDefinitionCount**: DWORD (4 байта), количество определения полей в этот поток.</span><span class="sxs-lookup"><span data-stu-id="f1feb-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="f1feb-118">Это число элементов в массиве **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="f1feb-119">**FieldDefinitions**: массив FolderFieldDefinitionA в потоковом режиме структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="f1feb-120">Число этого массива равно **FieldDefinitionCount** элемента данных.</span><span class="sxs-lookup"><span data-stu-id="f1feb-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="f1feb-121">Если этот FolderUserFieldsA переопределяется FolderUserFieldsW частью структуры FolderUserFields, массива **FieldDefinitions** должен быть «символом null», если его последнего элемента FolderFieldDefinitionA Common.FieldType поля равно Чтобы ftNull.</span><span class="sxs-lookup"><span data-stu-id="f1feb-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="f1feb-122">Структура FolderUserFieldsW потока</span><span class="sxs-lookup"><span data-stu-id="f1feb-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="f1feb-123">Структура потока FolderUserFieldsW — массива структур FolderFieldDefinitionW потока, которые содержат определения для всех пользовательских полей в папке Outlook.</span><span class="sxs-lookup"><span data-stu-id="f1feb-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="f1feb-124">Элементы данных в этот поток, хранятся в прямом байтовом, сразу после друг с другом в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f1feb-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="f1feb-125">**FieldDefinitionCount**: DWORD (4 байта), количество определения полей в этот поток.</span><span class="sxs-lookup"><span data-stu-id="f1feb-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="f1feb-126">Это число элементов в массиве **FieldDefinitions** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="f1feb-127">**FieldDefinitions**: массив FolderFieldDefinitionW в потоковом режиме структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="f1feb-128">Число этого массива равно **FieldDefinitionCount** элемента данных.</span><span class="sxs-lookup"><span data-stu-id="f1feb-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="f1feb-129">Массив **FieldDefinitions** должен быть «символом null», если его последнего элемента FolderFieldDefinitionW Common.FieldType поля равно ftNull.</span><span class="sxs-lookup"><span data-stu-id="f1feb-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="f1feb-130">Структура FolderFieldDefinitionA потока</span><span class="sxs-lookup"><span data-stu-id="f1feb-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="f1feb-131">Структура потока FolderFieldDefinitionA содержит определение того, пользовательские поля с имя поля, хранящиеся в формате ANSI.</span><span class="sxs-lookup"><span data-stu-id="f1feb-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="f1feb-132">Элементы данных в этот поток, хранятся в прямом байтовом, сразу после друг с другом в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f1feb-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="f1feb-133">**FieldType**: FldType (4 байта), тип данного поля.</span><span class="sxs-lookup"><span data-stu-id="f1feb-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="f1feb-134">**FieldNameLength**: WORD (2 байта), число элементов в массиве **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="f1feb-135">**FieldName**: массив символов.</span><span class="sxs-lookup"><span data-stu-id="f1feb-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="f1feb-136">Это представление кодовая страница ANSI CP_ACP имя поля.</span><span class="sxs-lookup"><span data-stu-id="f1feb-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="f1feb-137">Число этого массива равно **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="f1feb-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="f1feb-138">Имя поля должны соответствовать ограничения на параметр Name, как указано в метод [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f1feb-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="f1feb-139">Для обеспечения совместимости прежних версий Outlook может быть обрабатывать некоторые **FieldName** значения не удовлетворить эти ограничения, однако таких случаях не распространяются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f1feb-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="f1feb-140">**Общие**: FolderFieldDefinitionCommon в потоковом режиме структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="f1feb-141">Структура FolderFieldDefinitionW потока</span><span class="sxs-lookup"><span data-stu-id="f1feb-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="f1feb-142">Структура потока FolderFieldDefinitionW содержит определение того, пользовательские поля с именем сохранен в формате Юникод.</span><span class="sxs-lookup"><span data-stu-id="f1feb-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="f1feb-143">Элементы данных в этот поток, хранятся в прямом байтовом, сразу после друг с другом в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f1feb-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="f1feb-144">**FieldType**: FldType (4 байта), тип данного поля.</span><span class="sxs-lookup"><span data-stu-id="f1feb-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="f1feb-145">**FieldNameLength**: WORD (2 байта), число элементов в массиве **FieldName** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="f1feb-146">**FieldName**: массив WCHAR.</span><span class="sxs-lookup"><span data-stu-id="f1feb-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="f1feb-147">Это представление Юникод (UTF-16) имя поля.</span><span class="sxs-lookup"><span data-stu-id="f1feb-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="f1feb-148">Число этого массива равно **FieldNameLength**.</span><span class="sxs-lookup"><span data-stu-id="f1feb-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="f1feb-149">Имя поля должны соответствовать ограничения на параметр Name, как указано в метод [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f1feb-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="f1feb-150">Для обеспечения совместимости прежних версий Outlook может быть обрабатывать некоторые **FieldName** значения не удовлетворить эти ограничения, но таких случаях не распространяются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f1feb-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="f1feb-151">**Общие**: FolderFieldDefinitionCommon в потоковом режиме структуры.</span><span class="sxs-lookup"><span data-stu-id="f1feb-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="f1feb-152">Перечисление FldType</span><span class="sxs-lookup"><span data-stu-id="f1feb-152">FldType Enumeration</span></span>

<span data-ttu-id="f1feb-153">В следующей таблице перечислены значения перечисления **FldType** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="f1feb-154">Имя</span><span class="sxs-lookup"><span data-stu-id="f1feb-154">Name</span></span>|<span data-ttu-id="f1feb-155">Значение</span><span class="sxs-lookup"><span data-stu-id="f1feb-155">Value</span></span>|<span data-ttu-id="f1feb-156">Описание</span><span class="sxs-lookup"><span data-stu-id="f1feb-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="f1feb-157">ftNull</span><span class="sxs-lookup"><span data-stu-id="f1feb-157">ftNull</span></span>  <br/> |<span data-ttu-id="f1feb-158">0x0</span><span class="sxs-lookup"><span data-stu-id="f1feb-158">0x0</span></span>  <br/> |<span data-ttu-id="f1feb-159">Этот тип поля используется для завершите массив определения полей.</span><span class="sxs-lookup"><span data-stu-id="f1feb-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="f1feb-160">ftString</span><span class="sxs-lookup"><span data-stu-id="f1feb-160">ftString</span></span>  <br/> |<span data-ttu-id="f1feb-161">0x1</span><span class="sxs-lookup"><span data-stu-id="f1feb-161">0x1</span></span>  <br/> |<span data-ttu-id="f1feb-162">Текст</span><span class="sxs-lookup"><span data-stu-id="f1feb-162">Text</span></span>  <br/> |
|<span data-ttu-id="f1feb-163">ftInteger</span><span class="sxs-lookup"><span data-stu-id="f1feb-163">ftInteger</span></span>  <br/> |<span data-ttu-id="f1feb-164">0x3</span><span class="sxs-lookup"><span data-stu-id="f1feb-164">0x3</span></span>  <br/> |<span data-ttu-id="f1feb-165">Целое число</span><span class="sxs-lookup"><span data-stu-id="f1feb-165">Integer</span></span>  <br/> |
|<span data-ttu-id="f1feb-166">ftTime</span><span class="sxs-lookup"><span data-stu-id="f1feb-166">ftTime</span></span>  <br/> |<span data-ttu-id="f1feb-167">0x5</span><span class="sxs-lookup"><span data-stu-id="f1feb-167">0x5</span></span>  <br/> |<span data-ttu-id="f1feb-168">Дата, время</span><span class="sxs-lookup"><span data-stu-id="f1feb-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="f1feb-169">ftBoolean</span><span class="sxs-lookup"><span data-stu-id="f1feb-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="f1feb-170">0x6</span><span class="sxs-lookup"><span data-stu-id="f1feb-170">0x6</span></span>  <br/> |<span data-ttu-id="f1feb-171">Да/Нет</span><span class="sxs-lookup"><span data-stu-id="f1feb-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="f1feb-172">ftDuration</span><span class="sxs-lookup"><span data-stu-id="f1feb-172">ftDuration</span></span>  <br/> |<span data-ttu-id="f1feb-173">0x7</span><span class="sxs-lookup"><span data-stu-id="f1feb-173">0x7</span></span>  <br/> |<span data-ttu-id="f1feb-174">Продолжительность</span><span class="sxs-lookup"><span data-stu-id="f1feb-174">Duration</span></span>  <br/> |
|<span data-ttu-id="f1feb-175">ftMultiString</span><span class="sxs-lookup"><span data-stu-id="f1feb-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="f1feb-176">0xb</span><span class="sxs-lookup"><span data-stu-id="f1feb-176">0xB</span></span>  <br/> |<span data-ttu-id="f1feb-177">Keywords</span><span class="sxs-lookup"><span data-stu-id="f1feb-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="f1feb-178">ftFloat</span><span class="sxs-lookup"><span data-stu-id="f1feb-178">ftFloat</span></span>  <br/> |<span data-ttu-id="f1feb-179">0xC</span><span class="sxs-lookup"><span data-stu-id="f1feb-179">0xC</span></span>  <br/> |<span data-ttu-id="f1feb-180">Число или процент</span><span class="sxs-lookup"><span data-stu-id="f1feb-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="f1feb-181">ftCurrency</span><span class="sxs-lookup"><span data-stu-id="f1feb-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="f1feb-182">0xE</span><span class="sxs-lookup"><span data-stu-id="f1feb-182">0xE</span></span>  <br/> |<span data-ttu-id="f1feb-183">Денежный</span><span class="sxs-lookup"><span data-stu-id="f1feb-183">Currency</span></span>  <br/> |
|<span data-ttu-id="f1feb-184">ftCalc</span><span class="sxs-lookup"><span data-stu-id="f1feb-184">ftCalc</span></span>  <br/> |<span data-ttu-id="f1feb-185">0x12</span><span class="sxs-lookup"><span data-stu-id="f1feb-185">0x12</span></span>  <br/> |<span data-ttu-id="f1feb-186">Формула</span><span class="sxs-lookup"><span data-stu-id="f1feb-186">Formula</span></span>  <br/> |
|<span data-ttu-id="f1feb-187">ftSwitch</span><span class="sxs-lookup"><span data-stu-id="f1feb-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="f1feb-188">0x13</span><span class="sxs-lookup"><span data-stu-id="f1feb-188">0x13</span></span>  <br/> |<span data-ttu-id="f1feb-189">Сочетание типа отображение только первое поле пустым - пропуская последующие.</span><span class="sxs-lookup"><span data-stu-id="f1feb-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="f1feb-190">ftConcat</span><span class="sxs-lookup"><span data-stu-id="f1feb-190">ftConcat</span></span>  <br/> |<span data-ttu-id="f1feb-191">0x17</span><span class="sxs-lookup"><span data-stu-id="f1feb-191">0x17</span></span>  <br/> |<span data-ttu-id="f1feb-192">Сочетание типа объединять поля и любые фрагменты текста друг с другом.</span><span class="sxs-lookup"><span data-stu-id="f1feb-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="f1feb-193">Структура FolderFieldDefinitionCommon потока</span><span class="sxs-lookup"><span data-stu-id="f1feb-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="f1feb-194">Структура потока FolderFieldDefinitionCommon содержит данные определения пользовательских полей, общий для FolderFieldDefinitionA и FolderFieldDefinitionW.</span><span class="sxs-lookup"><span data-stu-id="f1feb-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="f1feb-195">Элементы данных в этот поток, хранятся в прямом байтовом, сразу после друг с другом в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f1feb-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="f1feb-196">**PropSetGuid**: идентификатор GUID (16 байт), идентификатор GUID папки поля соответствующего имени свойства MAPI набора свойств.</span><span class="sxs-lookup"><span data-stu-id="f1feb-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="f1feb-197">В этом поле значение должно быть равно PS_PUBLIC_STRINGS, если тип поля не **ftNone** , в противном случае это поле значение должно быть равно GUID_NULL.</span><span class="sxs-lookup"><span data-stu-id="f1feb-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="f1feb-198">Для обеспечения совместимости прежних версий Outlook может быть обрабатывать некоторые **PropSetGuid** значения не удовлетворить это ограничение, однако таких случаях не распространяются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="f1feb-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="f1feb-199">**fcapm**: DWORD (4 байта), комбинация флагов ноль или больше, значения которого и значения перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="f1feb-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="f1feb-200">Флаги с тем же значением имеют значения зависят от типа поля, то есть, FldType значение.</span><span class="sxs-lookup"><span data-stu-id="f1feb-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="f1feb-201">Имя флага</span><span class="sxs-lookup"><span data-stu-id="f1feb-201">Flag name</span></span>|<span data-ttu-id="f1feb-202">Значение  </span><span class="sxs-lookup"><span data-stu-id="f1feb-202">Value</span></span>|<span data-ttu-id="f1feb-203">Описание</span><span class="sxs-lookup"><span data-stu-id="f1feb-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="f1feb-204">FCAPM_CAN_EDIT</span><span class="sxs-lookup"><span data-stu-id="f1feb-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="f1feb-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="f1feb-205">0x00000001</span></span>  <br/> |<span data-ttu-id="f1feb-206">Поля можно редактировать.</span><span class="sxs-lookup"><span data-stu-id="f1feb-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-207">FCAPM_CAN_SORT</span><span class="sxs-lookup"><span data-stu-id="f1feb-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="f1feb-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="f1feb-208">0x00000002</span></span>  <br/> |<span data-ttu-id="f1feb-209">Поле подлежит сортировке.</span><span class="sxs-lookup"><span data-stu-id="f1feb-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-210">FCAPM_CAN_GROUP</span><span class="sxs-lookup"><span data-stu-id="f1feb-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="f1feb-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="f1feb-211">0x00000004</span></span>  <br/> |<span data-ttu-id="f1feb-212">Поле группируемое.</span><span class="sxs-lookup"><span data-stu-id="f1feb-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-213">FCAPM_MULTILINE_TEXT</span><span class="sxs-lookup"><span data-stu-id="f1feb-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="f1feb-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="f1feb-214">0x00000100</span></span>  <br/> |<span data-ttu-id="f1feb-215">Поле может содержать несколько строк текста.</span><span class="sxs-lookup"><span data-stu-id="f1feb-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-216">FCAPM_PERCENT</span><span class="sxs-lookup"><span data-stu-id="f1feb-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="f1feb-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="f1feb-217">0x01000000</span></span>  <br/> |<span data-ttu-id="f1feb-218">В этом поле ftFloat тип — это процентное поле.</span><span class="sxs-lookup"><span data-stu-id="f1feb-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-219">FCAPM_DATEONLY</span><span class="sxs-lookup"><span data-stu-id="f1feb-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="f1feb-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="f1feb-220">0x01000000</span></span>  <br/> |<span data-ttu-id="f1feb-221">В этом поле ftTime типа является поля только для даты времени.</span><span class="sxs-lookup"><span data-stu-id="f1feb-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-222">FCAPM_UNITLESS</span><span class="sxs-lookup"><span data-stu-id="f1feb-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="f1feb-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="f1feb-223">0x01000000</span></span>  <br/> |<span data-ttu-id="f1feb-224">Для этого поля ftInteger тип единица не разрешена в формат отображения; для примера таких форматов как «Computer - 640 K...»</span><span class="sxs-lookup"><span data-stu-id="f1feb-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…"</span></span> <span data-ttu-id="f1feb-225">не допускается.</span><span class="sxs-lookup"><span data-stu-id="f1feb-225">are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="f1feb-226">FCAPM_CAN_EDIT_IN_ITEM</span><span class="sxs-lookup"><span data-stu-id="f1feb-226">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="f1feb-227">0x80000000</span><span class="sxs-lookup"><span data-stu-id="f1feb-227">0x80000000</span></span>  <br/> |<span data-ttu-id="f1feb-228">Это поле может быть изменено в элементе: это специально для настраиваемых форм.</span><span class="sxs-lookup"><span data-stu-id="f1feb-228">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="f1feb-229">**dwString**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="f1feb-229">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="f1feb-230">В разделе первого следующее примечание.</span><span class="sxs-lookup"><span data-stu-id="f1feb-230">See the first following Note.</span></span>
    
- <span data-ttu-id="f1feb-231">**dwBitmap**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="f1feb-231">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="f1feb-232">В разделе первого следующее примечание.</span><span class="sxs-lookup"><span data-stu-id="f1feb-232">See the first following Note.</span></span>
    
- <span data-ttu-id="f1feb-233">**dwDisplay**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="f1feb-233">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="f1feb-234">В разделе первого следующее примечание.</span><span class="sxs-lookup"><span data-stu-id="f1feb-234">See the first following Note.</span></span>
    
- <span data-ttu-id="f1feb-235">**iFmt**: INT (4 байта).</span><span class="sxs-lookup"><span data-stu-id="f1feb-235">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="f1feb-236">Для типов полей, которые имеют «формате:» поле со списком в «Новое поле», «Изменить поле» и «Свойства поля» диалоговых окон, нуля индекс формата, выбранного в этом поле со списком.</span><span class="sxs-lookup"><span data-stu-id="f1feb-236">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="f1feb-237">Для полей типа без, поле со списком это должно быть 0.</span><span class="sxs-lookup"><span data-stu-id="f1feb-237">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="f1feb-238">В поле значение вместе с типом поля однозначно определить значения **dwString**, **dwBitmap**и **dwDisplay** полей см первого.</span><span class="sxs-lookup"><span data-stu-id="f1feb-238">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="f1feb-239">**wszFormulaLength**: WORD (2 байта), число элементов в массиве **wszFormulaLength** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-239">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="f1feb-240">**wszFormulaLength**: массив WCHAR.</span><span class="sxs-lookup"><span data-stu-id="f1feb-240">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="f1feb-241">Это представление поля формул строки в его стандартный формат Юникод (UTF-16).</span><span class="sxs-lookup"><span data-stu-id="f1feb-241">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="f1feb-242">В разделе второй следующее примечание описание стандартных и пользовательский Интерфейс форматы формулу поля.</span><span class="sxs-lookup"><span data-stu-id="f1feb-242">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="f1feb-243">Число этого массива равно **wszFormulaLength**.</span><span class="sxs-lookup"><span data-stu-id="f1feb-243">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="f1feb-244">Формулы строка должна быть пустой строке, если тип поля не **ftCalc**, **ftSwitch** и **ftConcat**.</span><span class="sxs-lookup"><span data-stu-id="f1feb-244">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="f1feb-245">Несмотря на то, что значения **dwString**, **dwBitmap**и **dwDisplay** однозначно определяются на основе значения **FldType** и **iFmt** значения, которые являются избыточными, правильных значений по-прежнему необходимы для правильного Обработка определения поля с Outlook.</span><span class="sxs-lookup"><span data-stu-id="f1feb-245">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="f1feb-246">Нет нет простое описание алгоритм, который выполняет это определение.</span><span class="sxs-lookup"><span data-stu-id="f1feb-246">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="f1feb-247">Таким образом чтобы узнать, какие **dwString**, **dwBitmap**и **dwDisplay** значения соответствуют заданным **FldType** значение и значение **iFmt** , можно выполните проверку, создав пользовательские поля этого типа и с этим форматом выбранные в поле со списком **Формат** при условии его применимость изучите итоговый **FolderUserFields** потока, который создает Outlook для этого поля, выбранные пользователем.</span><span class="sxs-lookup"><span data-stu-id="f1feb-247">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="f1feb-248">В текстовом поле **Формула** **Новое поле**, **Изменить поле**и диалоговых окнах **Свойств поля** для пользовательского поля изменяется формулу поля в формате пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="f1feb-248">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="f1feb-249">Алгоритм для преобразования формулы в формате пользовательского интерфейса в стандартный формат зависит от типа поля, как описано в следующих:</span><span class="sxs-lookup"><span data-stu-id="f1feb-249">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="f1feb-250">Для полей типа **ftCalc** и **ftSwitch**стандартный формат для встроенных полей, не являющихся соответствующих свойств MAPI с именем свойства типа MNID\_СТРОКУ, полученный путем замены фрагментов имя поля, то есть `[<field_name>]` с помощью фрагментов `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="f1feb-250">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="f1feb-251">Например, если имеет формат пользовательского интерфейса формулу в поле введите **формулу**, которая является **ftCalc**, с помощью языка пользовательского интерфейса Office, английский (США), `[Business Phone] & [My custom field]`, где `My custom field` — это имя поля, выбранные пользователем, стандартный формат такой формулы будет `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="f1feb-251">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="f1feb-252">Для полей типа **ftConcat**стандартный формат полученные в результате следующих:</span><span class="sxs-lookup"><span data-stu-id="f1feb-252">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="f1feb-253">Усекать начальные и конечные пробелы.</span><span class="sxs-lookup"><span data-stu-id="f1feb-253">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="f1feb-254">Синтаксический анализ формулу в последовательность фрагментов два следующих типа:</span><span class="sxs-lookup"><span data-stu-id="f1feb-254">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="f1feb-255">Имя поля в квадратных скобках, то есть, `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="f1feb-255">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="f1feb-256">Подстроки, не содержащий квадратные скобки.</span><span class="sxs-lookup"><span data-stu-id="f1feb-256">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="f1feb-257">Убедитесь, что указаны не двух фрагментов второго типа рядом в последовательности.</span><span class="sxs-lookup"><span data-stu-id="f1feb-257">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="f1feb-258">Если формула невозможно выполнить синтаксический анализ таким образом, считается недействительной.</span><span class="sxs-lookup"><span data-stu-id="f1feb-258">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="f1feb-259">Выполнение одной замены для фрагментов первый из них как для поля **ftCalc** и **ftSwitch** .</span><span class="sxs-lookup"><span data-stu-id="f1feb-259">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="f1feb-260">Для каждого фрагмента второго типа escape-все двойные кавычки ("" ") символы, если они существуют, с двумя последовательными знаками кавычек и заключите его в двойные кавычки.</span><span class="sxs-lookup"><span data-stu-id="f1feb-260">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="f1feb-261">Вставить строку амперсанд (`&`) между каждой парой смежных фрагментов.</span><span class="sxs-lookup"><span data-stu-id="f1feb-261">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="f1feb-262">Например, с помощью язык пользовательского интерфейса Office, английский (США), если имеет формат пользовательского интерфейса формулу в поле Тип **ftConcat** `text1 [Business Phone] "text2" [My custom field]`, где `My custom field` — это имя пользовательского поля, стандартный формат для такой формулы будет `""text1" & [_14856] & """text2""" & [My custom field]"`.</span><span class="sxs-lookup"><span data-stu-id="f1feb-262">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="f1feb-263">См. также</span><span class="sxs-lookup"><span data-stu-id="f1feb-263">See also</span></span>

- [<span data-ttu-id="f1feb-264">Пример потока FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="f1feb-264">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="f1feb-265">Добавление определения для нового пользовательского поля</span><span class="sxs-lookup"><span data-stu-id="f1feb-265">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)


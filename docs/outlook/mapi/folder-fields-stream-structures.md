---
title: Структуры потока полей папок
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: edbc9e6c-008c-4c13-9a0c-cb47ac0f3686
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 96051bd2b62fd7c0e908a1018aac0225e44986be
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336892"
---
# <a name="folder-fields-stream-structures"></a><span data-ttu-id="96ddc-103">Структуры потока полей папок</span><span class="sxs-lookup"><span data-stu-id="96ddc-103">Folder Fields Stream Structures</span></span>

<span data-ttu-id="96ddc-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="96ddc-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="96ddc-105">Свойство [PidTagUserFields](pidtaguserfields-canonical-property.md) сообщения содержит двоичный поток, FolderUserFields, который содержит определения определяемых пользователем полей папки.</span><span class="sxs-lookup"><span data-stu-id="96ddc-105">A message's [PidTagUserFields](pidtaguserfields-canonical-property.md) property contains a binary stream, FolderUserFields, which contains the folder user-defined field definitions.</span></span> <span data-ttu-id="96ddc-106">В этом разделе описываются структуры потока для определений определяемых пользователем полей папки.</span><span class="sxs-lookup"><span data-stu-id="96ddc-106">This topic describes the stream structures for folder user-defined field definitions.</span></span> 

<span data-ttu-id="96ddc-107">Структура потока FolderUserFields состоит из структуры Фолдерусерфиелдса или структуры Фолдерусерфиелдса, а затем структуры Фолдерусерфиелдсв.</span><span class="sxs-lookup"><span data-stu-id="96ddc-107">A FolderUserFields stream structure consists of either a FolderUserFieldsA structure or a FolderUserFieldsA structure followed by a FolderUserFieldsW structure.</span></span>
  
<span data-ttu-id="96ddc-108">Элементы данных в этом потоке хранятся сразу друг от друга в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="96ddc-108">Data elements in this stream are stored immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="96ddc-109">**Фолдерусерфиелдсанси**: структура потока фолдерусерфиелдса.</span><span class="sxs-lookup"><span data-stu-id="96ddc-109">**FolderUserFieldsAnsi**: A FolderUserFieldsA stream structure.</span></span>
    
- <span data-ttu-id="96ddc-110">**Фолдерусерфиелдсуникоде** (необязательно): структура потока Фолдерусерфиелдсв.</span><span class="sxs-lookup"><span data-stu-id="96ddc-110">**FolderUserFieldsUnicode** (optional): A FolderUserFieldsW stream structure.</span></span>
    
<span data-ttu-id="96ddc-111">Присутствие Фолдерусерфиелдсуникоде определяется общей длиной FolderUserFields, превышающей длину Фолдерусерфиелдсанси.</span><span class="sxs-lookup"><span data-stu-id="96ddc-111">The presence of FolderUserFieldsUnicode is detected by the total length of the FolderUserFields being greater than the length of FolderUserFieldsAnsi.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="96ddc-112">Фолдерусерфиелдсанси используется для совместимости с более старыми версиями клиентов MAPI, не поддерживающими Юникод, поэтому при наличии Фолдерусерфиелдсуникоде содержимое Фолдерусерфиелдсанси игнорируется.</span><span class="sxs-lookup"><span data-stu-id="96ddc-112">FolderUserFieldsAnsi is used for compatibility with older, non-Unicode, versions of MAPI clients, therefore if FolderUserFieldsUnicode is present, the contents of FolderUserFieldsAnsi is ignored.</span></span> <span data-ttu-id="96ddc-113">Чтобы избежать возможной потери данных в преобразовании ANSI, при создании потока FolderUserFields всегда включается часть Фолдерусерфиелдсв.</span><span class="sxs-lookup"><span data-stu-id="96ddc-113">To avoid possible data loss in ANSI conversion, when creating a FolderUserFields stream always include the FolderUserFieldsW part.</span></span> 
  
## <a name="folderuserfieldsa-stream-structure"></a><span data-ttu-id="96ddc-114">Структура потока Фолдерусерфиелдса</span><span class="sxs-lookup"><span data-stu-id="96ddc-114">FolderUserFieldsA Stream Structure</span></span>

<span data-ttu-id="96ddc-115">Структура потока Фолдерусерфиелдса — это массив структуры потоков Фолдерфиелддефинитиона, который содержит определения для всех пользовательских полей в папке Outlook, если не переопределен частью Фолдерусерфиелдсв структуры FolderUserFields.</span><span class="sxs-lookup"><span data-stu-id="96ddc-115">A FolderUserFieldsA stream structure is an array of FolderFieldDefinitionA stream structures that contain definitions for all user-defined fields in an Outlook folder, unless overridden by the FolderUserFieldsW part of the FolderUserFields structure.</span></span>
  
<span data-ttu-id="96ddc-116">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="96ddc-116">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="96ddc-117">**Фиелддефинитионкаунт**: DWORD (4 байта), количество определений полей в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="96ddc-117">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="96ddc-118">Это количество элементов в массиве **фиелддефинитионс** .</span><span class="sxs-lookup"><span data-stu-id="96ddc-118">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="96ddc-119">**Фиелддефинитионс**: массив структуры потоков фолдерфиелддефинитиона.</span><span class="sxs-lookup"><span data-stu-id="96ddc-119">**FieldDefinitions**: An array of FolderFieldDefinitionA stream structures.</span></span> <span data-ttu-id="96ddc-120">Количество этого массива равно элементу данных **фиелддефинитионкаунт** .</span><span class="sxs-lookup"><span data-stu-id="96ddc-120">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="96ddc-121">Если это Фолдерусерфиелдса не переопределено частью Фолдерусерфиелдсв структуры FolderUserFields, массив **фиелддефинитионс** должен иметь значение "null-завершено", так как для последнего поля фолдерфиелддефинитиона элемента указано значение "равно". FieldType в Фтнулл.</span><span class="sxs-lookup"><span data-stu-id="96ddc-121">Unless this FolderUserFieldsA is overridden by the FolderUserFieldsW part of the FolderUserFields structure, the **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionA element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderuserfieldsw-stream-structure"></a><span data-ttu-id="96ddc-122">Структура потока Фолдерусерфиелдсв</span><span class="sxs-lookup"><span data-stu-id="96ddc-122">FolderUserFieldsW Stream Structure</span></span>

<span data-ttu-id="96ddc-123">Структура потока Фолдерусерфиелдсв — это массив структуры потоков Фолдерфиелддефинитионв, в котором содержатся определения для всех полей, определенных пользователем, в папке Outlook.</span><span class="sxs-lookup"><span data-stu-id="96ddc-123">A FolderUserFieldsW stream structure is an array of FolderFieldDefinitionW stream structures that contain definitions for all user-defined fields in an Outlook folder.</span></span>
  
<span data-ttu-id="96ddc-124">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="96ddc-124">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="96ddc-125">**Фиелддефинитионкаунт**: DWORD (4 байта), количество определений полей в этом потоке.</span><span class="sxs-lookup"><span data-stu-id="96ddc-125">**FieldDefinitionCount**: DWORD (4 bytes), the number of field definitions in this stream.</span></span> <span data-ttu-id="96ddc-126">Это количество элементов в массиве **фиелддефинитионс** .</span><span class="sxs-lookup"><span data-stu-id="96ddc-126">This is the count of elements in the **FieldDefinitions** array.</span></span>
    
- <span data-ttu-id="96ddc-127">**Фиелддефинитионс**: массив структуры потоков фолдерфиелддефинитионв.</span><span class="sxs-lookup"><span data-stu-id="96ddc-127">**FieldDefinitions**: An array of FolderFieldDefinitionW stream structures.</span></span> <span data-ttu-id="96ddc-128">Количество этого массива равно элементу данных **фиелддефинитионкаунт** .</span><span class="sxs-lookup"><span data-stu-id="96ddc-128">The count of this array is equal to the **FieldDefinitionCount** data element.</span></span>
    
<span data-ttu-id="96ddc-129">Массив **фиелддефинитионс** должен иметь значение "нулем — завершено", так как его Последнее поле Фолдерфиелддефинитионв элемента равно фтнулл.</span><span class="sxs-lookup"><span data-stu-id="96ddc-129">The **FieldDefinitions** array must be "null-terminated" by having its last FolderFieldDefinitionW element's Common.FieldType field equal to ftNull.</span></span>
  
## <a name="folderfielddefinitiona-stream-structure"></a><span data-ttu-id="96ddc-130">Структура потока Фолдерфиелддефинитиона</span><span class="sxs-lookup"><span data-stu-id="96ddc-130">FolderFieldDefinitionA Stream Structure</span></span>

<span data-ttu-id="96ddc-131">Структура потока Фолдерфиелддефинитиона содержит определение определяемого пользователем поля с именем поля, хранящимся в КОДИРОВКе ANSI.</span><span class="sxs-lookup"><span data-stu-id="96ddc-131">A FolderFieldDefinitionA stream structure contains a definition of a user-defined field with the field name stored in ANSI.</span></span>
  
<span data-ttu-id="96ddc-132">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="96ddc-132">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="96ddc-133">**FieldType**: флдтипе (4 байта), тип этого поля.</span><span class="sxs-lookup"><span data-stu-id="96ddc-133">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="96ddc-134">**Фиелднамеленгс**: Word (2 байта), количество элементов в самом массиве. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="96ddc-134">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="96ddc-135">**Fieldname**: массив char.</span><span class="sxs-lookup"><span data-stu-id="96ddc-135">**FieldName**: An array of CHAR.</span></span> <span data-ttu-id="96ddc-136">Это КП_АКП кодовое представление имени поля в КОДИРОВКе ANSI.</span><span class="sxs-lookup"><span data-stu-id="96ddc-136">This is the ANSI CP_ACP codepage representation of the field name.</span></span> <span data-ttu-id="96ddc-137">Количество этого массива равно **фиелднамеленгс**.</span><span class="sxs-lookup"><span data-stu-id="96ddc-137">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="96ddc-138">Имя поля должно удовлетворять ограничениям для параметра name, как указано в методе [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="96ddc-138">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="96ddc-139">В целях обеспечения совместимости с устаревшими версиями Outlook может обрабатывать некоторые значения \*\*\*\* , которые не удовлетворяют этим ограничениям, но такие случаи не рассматриваются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="96ddc-139">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="96ddc-140">**Общие**: структура потока фолдерфиелддефинитионкоммон.</span><span class="sxs-lookup"><span data-stu-id="96ddc-140">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="folderfielddefinitionw-stream-structure"></a><span data-ttu-id="96ddc-141">Структура потока Фолдерфиелддефинитионв</span><span class="sxs-lookup"><span data-stu-id="96ddc-141">FolderFieldDefinitionW Stream Structure</span></span>

<span data-ttu-id="96ddc-142">Структура потока Фолдерфиелддефинитионв содержит определение определяемого пользователем поля с именем поля, хранящимся в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="96ddc-142">A FolderFieldDefinitionW stream structure contains a definition of a user-defined field with the field name stored in Unicode.</span></span>
  
<span data-ttu-id="96ddc-143">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="96ddc-143">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="96ddc-144">**FieldType**: флдтипе (4 байта), тип этого поля.</span><span class="sxs-lookup"><span data-stu-id="96ddc-144">**FieldType**: FldType (4 bytes), the type of this field.</span></span>
    
- <span data-ttu-id="96ddc-145">**Фиелднамеленгс**: Word (2 байта), количество элементов в самом массиве. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="96ddc-145">**FieldNameLength**: WORD (2 bytes), the number of elements in the **FieldName** array.</span></span>
    
- <span data-ttu-id="96ddc-146">**Fieldname**: массив типа WCHAR.</span><span class="sxs-lookup"><span data-stu-id="96ddc-146">**FieldName**: An array of WCHAR.</span></span> <span data-ttu-id="96ddc-147">Это представление в Юникоде (UTF-16) имени поля.</span><span class="sxs-lookup"><span data-stu-id="96ddc-147">This is the Unicode (UTF-16) representation of the field name.</span></span> <span data-ttu-id="96ddc-148">Количество этого массива равно **фиелднамеленгс**.</span><span class="sxs-lookup"><span data-stu-id="96ddc-148">The count of this array is equal to **FieldNameLength**.</span></span> <span data-ttu-id="96ddc-149">Имя поля должно удовлетворять ограничениям для параметра name, как указано в методе [UserProperties. Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) .</span><span class="sxs-lookup"><span data-stu-id="96ddc-149">The field name must satisfy the restrictions on the Name parameter as specified in the [UserProperties.Add](https://msdn.microsoft.com/library/microsoft.office.interop.outlook.userproperties.add.aspx) Method.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="96ddc-150">В целях совместимости с устаревшими версиями Outlook может обрабатывать некоторые значения, \*\*\*\* которые не удовлетворяют этим ограничениям, но такие случаи не рассматриваются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="96ddc-150">For reasons of legacy compatibility, Outlook may be able to handle some **FieldName** values not satisfying these restrictions, but such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="96ddc-151">**Общие**: структура потока фолдерфиелддефинитионкоммон.</span><span class="sxs-lookup"><span data-stu-id="96ddc-151">**Common**: A FolderFieldDefinitionCommon stream structure.</span></span>
    
## <a name="fldtype-enumeration"></a><span data-ttu-id="96ddc-152">ПереЧисление Флдтипе</span><span class="sxs-lookup"><span data-stu-id="96ddc-152">FldType Enumeration</span></span>

<span data-ttu-id="96ddc-153">Значения перечислений **флдтипе** перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="96ddc-153">**FldType** enumeration values are listed in the following table.</span></span> 
  
|<span data-ttu-id="96ddc-154">Имя</span><span class="sxs-lookup"><span data-stu-id="96ddc-154">Name</span></span>|<span data-ttu-id="96ddc-155">Значение</span><span class="sxs-lookup"><span data-stu-id="96ddc-155">Value</span></span>|<span data-ttu-id="96ddc-156">Значение</span><span class="sxs-lookup"><span data-stu-id="96ddc-156">Meaning</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="96ddc-157">Фтнулл</span><span class="sxs-lookup"><span data-stu-id="96ddc-157">ftNull</span></span>  <br/> |<span data-ttu-id="96ddc-158">0x0</span><span class="sxs-lookup"><span data-stu-id="96ddc-158">0x0</span></span>  <br/> |<span data-ttu-id="96ddc-159">Этот тип поля используется для завершения работы массива определений поля (null).</span><span class="sxs-lookup"><span data-stu-id="96ddc-159">This field type is used to null-terminate an array of field definitions.</span></span>  <br/> |
|<span data-ttu-id="96ddc-160">Фтстринг</span><span class="sxs-lookup"><span data-stu-id="96ddc-160">ftString</span></span>  <br/> |<span data-ttu-id="96ddc-161">0x1</span><span class="sxs-lookup"><span data-stu-id="96ddc-161">0x1</span></span>  <br/> |<span data-ttu-id="96ddc-162">Текст</span><span class="sxs-lookup"><span data-stu-id="96ddc-162">Text</span></span>  <br/> |
|<span data-ttu-id="96ddc-163">Фтинтежер</span><span class="sxs-lookup"><span data-stu-id="96ddc-163">ftInteger</span></span>  <br/> |<span data-ttu-id="96ddc-164">0x3</span><span class="sxs-lookup"><span data-stu-id="96ddc-164">0x3</span></span>  <br/> |<span data-ttu-id="96ddc-165">Целое число</span><span class="sxs-lookup"><span data-stu-id="96ddc-165">Integer</span></span>  <br/> |
|<span data-ttu-id="96ddc-166">Фттиме</span><span class="sxs-lookup"><span data-stu-id="96ddc-166">ftTime</span></span>  <br/> |<span data-ttu-id="96ddc-167">0x5</span><span class="sxs-lookup"><span data-stu-id="96ddc-167">0x5</span></span>  <br/> |<span data-ttu-id="96ddc-168">Дата/время</span><span class="sxs-lookup"><span data-stu-id="96ddc-168">Date/Time</span></span>  <br/> |
|<span data-ttu-id="96ddc-169">Фтбулеан</span><span class="sxs-lookup"><span data-stu-id="96ddc-169">ftBoolean</span></span>  <br/> |<span data-ttu-id="96ddc-170">0x6</span><span class="sxs-lookup"><span data-stu-id="96ddc-170">0x6</span></span>  <br/> |<span data-ttu-id="96ddc-171">Да или Нет</span><span class="sxs-lookup"><span data-stu-id="96ddc-171">Yes/No</span></span>  <br/> |
|<span data-ttu-id="96ddc-172">Фтдуратион</span><span class="sxs-lookup"><span data-stu-id="96ddc-172">ftDuration</span></span>  <br/> |<span data-ttu-id="96ddc-173">0x7</span><span class="sxs-lookup"><span data-stu-id="96ddc-173">0x7</span></span>  <br/> |<span data-ttu-id="96ddc-174">Duration (Длительность)</span><span class="sxs-lookup"><span data-stu-id="96ddc-174">Duration</span></span>  <br/> |
|<span data-ttu-id="96ddc-175">Фтмултистринг</span><span class="sxs-lookup"><span data-stu-id="96ddc-175">ftMultiString</span></span>  <br/> |<span data-ttu-id="96ddc-176">0xB</span><span class="sxs-lookup"><span data-stu-id="96ddc-176">0xB</span></span>  <br/> |<span data-ttu-id="96ddc-177">Ключевые слова</span><span class="sxs-lookup"><span data-stu-id="96ddc-177">Keywords</span></span>  <br/> |
|<span data-ttu-id="96ddc-178">Фтфлоат</span><span class="sxs-lookup"><span data-stu-id="96ddc-178">ftFloat</span></span>  <br/> |<span data-ttu-id="96ddc-179">0xC</span><span class="sxs-lookup"><span data-stu-id="96ddc-179">0xC</span></span>  <br/> |<span data-ttu-id="96ddc-180">Число или процент</span><span class="sxs-lookup"><span data-stu-id="96ddc-180">Number or Percent</span></span>  <br/> |
|<span data-ttu-id="96ddc-181">Фткурренци</span><span class="sxs-lookup"><span data-stu-id="96ddc-181">ftCurrency</span></span>  <br/> |<span data-ttu-id="96ddc-182">0xE</span><span class="sxs-lookup"><span data-stu-id="96ddc-182">0xE</span></span>  <br/> |<span data-ttu-id="96ddc-183">Денежный</span><span class="sxs-lookup"><span data-stu-id="96ddc-183">Currency</span></span>  <br/> |
|<span data-ttu-id="96ddc-184">Фткалк</span><span class="sxs-lookup"><span data-stu-id="96ddc-184">ftCalc</span></span>  <br/> |<span data-ttu-id="96ddc-185">0x12</span><span class="sxs-lookup"><span data-stu-id="96ddc-185">0x12</span></span>  <br/> |<span data-ttu-id="96ddc-186">Формула</span><span class="sxs-lookup"><span data-stu-id="96ddc-186">Formula</span></span>  <br/> |
|<span data-ttu-id="96ddc-187">Фтсвитч</span><span class="sxs-lookup"><span data-stu-id="96ddc-187">ftSwitch</span></span>  <br/> |<span data-ttu-id="96ddc-188">0x13</span><span class="sxs-lookup"><span data-stu-id="96ddc-188">0x13</span></span>  <br/> |<span data-ttu-id="96ddc-189">Комбинация типа, отражающая только первое непустое поле — игнорирует последующие.</span><span class="sxs-lookup"><span data-stu-id="96ddc-189">Combination of type showing only the first non-empty field - ignoring subsequent ones.</span></span>  <br/> |
|<span data-ttu-id="96ddc-190">Фтконкат</span><span class="sxs-lookup"><span data-stu-id="96ddc-190">ftConcat</span></span>  <br/> |<span data-ttu-id="96ddc-191">0x17</span><span class="sxs-lookup"><span data-stu-id="96ddc-191">0x17</span></span>  <br/> |<span data-ttu-id="96ddc-192">Сочетание типа присоединяемых полей и любых фрагментов текста друг с другом.</span><span class="sxs-lookup"><span data-stu-id="96ddc-192">Combination of type joining fields and any text fragments to each other.</span></span>  <br/> |
   
## <a name="folderfielddefinitioncommon-stream-structure"></a><span data-ttu-id="96ddc-193">Структура потока Фолдерфиелддефинитионкоммон</span><span class="sxs-lookup"><span data-stu-id="96ddc-193">FolderFieldDefinitionCommon Stream Structure</span></span>

<span data-ttu-id="96ddc-194">Структура потока Фолдерфиелддефинитионкоммон содержит данные определяемого пользователем определения поля, которое является общим для Фолдерфиелддефинитиона и Фолдерфиелддефинитионв.</span><span class="sxs-lookup"><span data-stu-id="96ddc-194">A FolderFieldDefinitionCommon stream structure contains the data of a user-defined field definition that is common to both a FolderFieldDefinitionA and a FolderFieldDefinitionW.</span></span>
  
<span data-ttu-id="96ddc-195">Элементы данных в этом потоке хранятся в обратном порядке байтов, который выполняется сразу же после каждого следующего порядка:</span><span class="sxs-lookup"><span data-stu-id="96ddc-195">Data elements in this stream are stored in little-endian byte order, immediately following each other in the following specified order:</span></span>
  
- <span data-ttu-id="96ddc-196">**Пропсетгуид**: GUID (16 байт), идентификатор GUID набора свойств соответствующего имени свойства MAPI для поля папки.</span><span class="sxs-lookup"><span data-stu-id="96ddc-196">**PropSetGuid**: GUID (16 bytes), the property set GUID of the folder field's corresponding MAPI property name.</span></span> <span data-ttu-id="96ddc-197">Значение этого поля должно равняться ПС_ПУБЛИК_СТРИНГС, если типом поля не является **фтноне** , в этом случае значение этого поля должно быть равно гуид_нулл.</span><span class="sxs-lookup"><span data-stu-id="96ddc-197">This field's value must be equal to PS_PUBLIC_STRINGS, unless the field type is **ftNone** in which case this field's value must be equal to GUID_NULL.</span></span> 
    
   > [!NOTE]
   > <span data-ttu-id="96ddc-198">В целях обеспечения совместимости с устаревшими версиями Outlook может обрабатывать некоторые значения **пропсетгуид** , не соответствующие этому ограничению, однако такие случаи не рассматриваются в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="96ddc-198">For reasons of legacy compatibility, Outlook may be able to handle some **PropSetGuid** values not satisfying this restriction, however such cases are not covered by this topic.</span></span> 
  
- <span data-ttu-id="96ddc-199">**фкапм**: DWORD (4 байта), комбинация нуля или более флагов. значения этих флагов перечислены в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="96ddc-199">**fcapm**: DWORD (4 bytes), a combination of zero or more flags the values of which and meanings are listed in the following table.</span></span> <span data-ttu-id="96ddc-200">Флаги с одинаковым значением имеют значения, зависящие от типа поля, то есть значения Флдтипе.</span><span class="sxs-lookup"><span data-stu-id="96ddc-200">Flags with the same value have meanings dependent on the field's type, that is, FldType value.</span></span>
    
    |<span data-ttu-id="96ddc-201">Имя флага</span><span class="sxs-lookup"><span data-stu-id="96ddc-201">Flag name</span></span>|<span data-ttu-id="96ddc-202">Значение</span><span class="sxs-lookup"><span data-stu-id="96ddc-202">Value</span></span>|<span data-ttu-id="96ddc-203">Значение</span><span class="sxs-lookup"><span data-stu-id="96ddc-203">Meaning</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="96ddc-204">ФКАПМ_КАН_ЕДИТ</span><span class="sxs-lookup"><span data-stu-id="96ddc-204">FCAPM_CAN_EDIT</span></span>  <br/> |<span data-ttu-id="96ddc-205">0x00000001</span><span class="sxs-lookup"><span data-stu-id="96ddc-205">0x00000001</span></span>  <br/> |<span data-ttu-id="96ddc-206">Поле доступно для редактирования.</span><span class="sxs-lookup"><span data-stu-id="96ddc-206">The field is editable.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-207">ФКАПМ_КАН_СОРТ</span><span class="sxs-lookup"><span data-stu-id="96ddc-207">FCAPM_CAN_SORT</span></span>  <br/> |<span data-ttu-id="96ddc-208">0x00000002</span><span class="sxs-lookup"><span data-stu-id="96ddc-208">0x00000002</span></span>  <br/> |<span data-ttu-id="96ddc-209">Поле доступно для сортировки.</span><span class="sxs-lookup"><span data-stu-id="96ddc-209">The field is sortable.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-210">ФКАПМ_КАН_ГРАУП</span><span class="sxs-lookup"><span data-stu-id="96ddc-210">FCAPM_CAN_GROUP</span></span>  <br/> |<span data-ttu-id="96ddc-211">0x00000004</span><span class="sxs-lookup"><span data-stu-id="96ddc-211">0x00000004</span></span>  <br/> |<span data-ttu-id="96ddc-212">Поле является группированным.</span><span class="sxs-lookup"><span data-stu-id="96ddc-212">The field is groupable.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-213">ФКАПМ_МУЛТИЛИНЕ_ТЕКСТ</span><span class="sxs-lookup"><span data-stu-id="96ddc-213">FCAPM_MULTILINE_TEXT</span></span>  <br/> |<span data-ttu-id="96ddc-214">0x00000100</span><span class="sxs-lookup"><span data-stu-id="96ddc-214">0x00000100</span></span>  <br/> |<span data-ttu-id="96ddc-215">Поле может содержать несколько строк текста.</span><span class="sxs-lookup"><span data-stu-id="96ddc-215">The field can hold multiple lines of text.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-216">ФКАПМ_ПЕРЦЕНТ</span><span class="sxs-lookup"><span data-stu-id="96ddc-216">FCAPM_PERCENT</span></span>  <br/> |<span data-ttu-id="96ddc-217">0x01000000</span><span class="sxs-lookup"><span data-stu-id="96ddc-217">0x01000000</span></span>  <br/> |<span data-ttu-id="96ddc-218">Это поле типа Фтфлоат является процентным.</span><span class="sxs-lookup"><span data-stu-id="96ddc-218">This field of the type ftFloat is a percentage field.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-219">ФКАПМ_ДАТЕОНЛИ</span><span class="sxs-lookup"><span data-stu-id="96ddc-219">FCAPM_DATEONLY</span></span>  <br/> |<span data-ttu-id="96ddc-220">0x01000000</span><span class="sxs-lookup"><span data-stu-id="96ddc-220">0x01000000</span></span>  <br/> |<span data-ttu-id="96ddc-221">Это поле типа Фттиме — это поле даты и времени.</span><span class="sxs-lookup"><span data-stu-id="96ddc-221">This field of the type ftTime is a date-only time field.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-222">ФКАПМ_УНИТЛЕСС</span><span class="sxs-lookup"><span data-stu-id="96ddc-222">FCAPM_UNITLESS</span></span>  <br/> |<span data-ttu-id="96ddc-223">0x01000000</span><span class="sxs-lookup"><span data-stu-id="96ddc-223">0x01000000</span></span>  <br/> |<span data-ttu-id="96ddc-224">В этом поле типа Фтинтежер не допускается использование единиц в формате отображения; Например, такие форматы, как "Computering 640 K..." не разрешены.</span><span class="sxs-lookup"><span data-stu-id="96ddc-224">For this field of the type ftInteger, no unit is allowed in display format; for example such formats as "Computer - 640 K…" are not allowed.</span></span>  <br/> |
    |<span data-ttu-id="96ddc-225">ФКАПМ_КАН_ЕДИТ_ИН_ИТЕМ</span><span class="sxs-lookup"><span data-stu-id="96ddc-225">FCAPM_CAN_EDIT_IN_ITEM</span></span>  <br/> |<span data-ttu-id="96ddc-226">0x80000000</span><span class="sxs-lookup"><span data-stu-id="96ddc-226">0x80000000</span></span>  <br/> |<span data-ttu-id="96ddc-227">Поле можно редактировать в элементе: это относится только к настраиваемым формам.</span><span class="sxs-lookup"><span data-stu-id="96ddc-227">The field can be edited in the item: This is specifically for custom forms.</span></span>  <br/> |
   
- <span data-ttu-id="96ddc-228">**двстринг**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="96ddc-228">**dwString**: DWORD (4 bytes).</span></span> <span data-ttu-id="96ddc-229">Ознакомьтесь с первой заМеткой.</span><span class="sxs-lookup"><span data-stu-id="96ddc-229">See the first following Note.</span></span>
    
- <span data-ttu-id="96ddc-230">**двбитмап**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="96ddc-230">**dwBitmap**: DWORD (4 bytes).</span></span> <span data-ttu-id="96ddc-231">Ознакомьтесь с первой заМеткой.</span><span class="sxs-lookup"><span data-stu-id="96ddc-231">See the first following Note.</span></span>
    
- <span data-ttu-id="96ddc-232">**двдисплай**: DWORD (4 байта).</span><span class="sxs-lookup"><span data-stu-id="96ddc-232">**dwDisplay**: DWORD (4 bytes).</span></span> <span data-ttu-id="96ddc-233">Ознакомьтесь с первой заМеткой.</span><span class="sxs-lookup"><span data-stu-id="96ddc-233">See the first following Note.</span></span>
    
- <span data-ttu-id="96ddc-234">**ифмт**: int (4 байта).</span><span class="sxs-lookup"><span data-stu-id="96ddc-234">**iFmt**: INT (4 bytes).</span></span> <span data-ttu-id="96ddc-235">Для типов полей с раскрывающимся списком "формат:" в диалоговых окнах "Создание поля", "изменение поля" и "Свойства поля" — индекс формата, который выбран в поле со списком.</span><span class="sxs-lookup"><span data-stu-id="96ddc-235">For the field types that have the "Format:" combo box in the "New Field", "Edit Field", and "Field Properties" dialogs, the 0-based index of the format selected in that combo box.</span></span> <span data-ttu-id="96ddc-236">Для типов полей без поля со списком это значение должно быть равно 0.</span><span class="sxs-lookup"><span data-stu-id="96ddc-236">For the field types without that combo box, this must be 0.</span></span> <span data-ttu-id="96ddc-237">Значение поля, вместе с типом поля, однозначно определяет значения полей **двстринг**, **двбитмап**и **двдисплай** , приведенные в первой заметке.</span><span class="sxs-lookup"><span data-stu-id="96ddc-237">The field's value together with the field type uniquely determine the values of the **dwString**, **dwBitmap**, and **dwDisplay** fields, see the first following Note.</span></span>
    
- <span data-ttu-id="96ddc-238">**всзформулаленгс**: Word (2 байта), количество элементов в массиве **всзформулаленгс** .</span><span class="sxs-lookup"><span data-stu-id="96ddc-238">**wszFormulaLength**: WORD (2 bytes), the number of elements in the **wszFormulaLength** array.</span></span>
    
- <span data-ttu-id="96ddc-239">**всзформулаленгс**: массив типа WCHAR.</span><span class="sxs-lookup"><span data-stu-id="96ddc-239">**wszFormulaLength**: An array of WCHAR.</span></span> <span data-ttu-id="96ddc-240">Это представление Юникод (UTF-16) строки формулы поля в стандартном формате.</span><span class="sxs-lookup"><span data-stu-id="96ddc-240">This is the Unicode (UTF-16) representation of the field's formula string in its standard format.</span></span> <span data-ttu-id="96ddc-241">В следующей заМетке представлено описание стандартных форматов и форматов ПОЛЬЗОВАТЕЛЬСКОГО интерфейса формулы поля.</span><span class="sxs-lookup"><span data-stu-id="96ddc-241">See the second following Note for the description of the standard and UI formats of a field's formula.</span></span> <span data-ttu-id="96ddc-242">Количество этого массива равно **всзформулаленгс**.</span><span class="sxs-lookup"><span data-stu-id="96ddc-242">The count of this array is equal to **wszFormulaLength**.</span></span> <span data-ttu-id="96ddc-243">Строка формулы должна быть пустой строкой, если тип поля — **фткалк**, **фтсвитч** или **фтконкат**.</span><span class="sxs-lookup"><span data-stu-id="96ddc-243">The formula string must be an empty string unless the field type is **ftCalc**, **ftSwitch** or **ftConcat**.</span></span>
    
> [!NOTE]
> <span data-ttu-id="96ddc-244">Несмотря на то, что значения **двстринг**, **двбитмап**и **двдисплай** однозначно определяются на основе значения **флдтипе** , а значение **ифмт** , которое является избыточным, их правильные значения по-прежнему необходимы для правильной Обработка определения поля приложением Outlook.</span><span class="sxs-lookup"><span data-stu-id="96ddc-244">Although the values of **dwString**, **dwBitmap**, and **dwDisplay** are uniquely determined based on the **FldType** value and the **iFmt** value, which are redundant, their correct values are still necessary for correct processing of the field definition by Outlook.</span></span> <span data-ttu-id="96ddc-245">Не существует простого описания алгоритма, который выполняет это определение.</span><span class="sxs-lookup"><span data-stu-id="96ddc-245">There is no simple description of the algorithm that performs this determination.</span></span> 
> 
> <span data-ttu-id="96ddc-246">Таким образом, чтобы узнать, какие значения **двстринг**, **двбитмап**и **двдисплай** соответствуют заданному значению **флдтипе** и **ифмт** значению, выполните тест, создав определяемое пользователем поле этого типа, и с выбранным форматом в поле со списком **Формат** , предполагая, что его применимость, изучите полученный в результате поток **FolderUserFields** , который создает Outlook для поля, определенного пользователем.</span><span class="sxs-lookup"><span data-stu-id="96ddc-246">Therefore, to find out which **dwString**, **dwBitmap**, and **dwDisplay** values correspond to a given **FldType** value and **iFmt** value, perform a test by creating a user-defined field of that type, and with that format selected in the **Format** combo box, assuming its applicability, inspect the resulting **FolderUserFields** stream that Outlook creates for that user-defined field.</span></span> 
  
<span data-ttu-id="96ddc-247">Формула поля в формате ПОЛЬЗОВАТЕЛЬСКОГО интерфейса редактируется в текстовом поле **Формула** для диалогового окна **Создание поля**, **изменение поля**и **Свойства поля** для поля, определяемого пользователем.</span><span class="sxs-lookup"><span data-stu-id="96ddc-247">The field's formula in its UI format is edited in the **Formula** text box of the **New Field**, **Edit Field**, and **Field Properties** dialogs for the user-defined field.</span></span> <span data-ttu-id="96ddc-248">Алгоритм преобразования формулы из формата ПОЛЬЗОВАТЕЛЬСКОГО интерфейса в стандартный формат зависит от типа поля, как описано ниже.</span><span class="sxs-lookup"><span data-stu-id="96ddc-248">The algorithm to convert a formula from the UI format to the standard format depends on the field type as described in the following:</span></span> 
- <span data-ttu-id="96ddc-249">Для полей типов **фткалк** и **фтсвитч**стандартный формат для встроенных полей, которые соответствующие свойства MAPI не называются свойствами строки мнид\_, заменяются на фрагменты имени поля, то есть `[<field_name>]` с фрагментами `[_<field_dispid_decimal>]`.</span><span class="sxs-lookup"><span data-stu-id="96ddc-249">For fields of types **ftCalc** and **ftSwitch**, the standard format for built-in fields, which corresponding MAPI properties are not named properties of the kind MNID\_STRING, is obtained by replacing field name fragments, that is `[<field_name>]` with fragments `[_<field_dispid_decimal>]`.</span></span> 

  <span data-ttu-id="96ddc-250">Например, если формат ПОЛЬЗОВАТЕЛЬСКОГО интерфейса формулы для поля типа **Формула**( **фткалк**) с языком пользовательского интерфейса Office Английский (США), то `[Business Phone] & [My custom field]`есть, где `My custom field` — имя определенного пользователем поля, стандартный формат такой формулы будет `[_14856] & [My custom field]`.</span><span class="sxs-lookup"><span data-stu-id="96ddc-250">For example, if the UI format of a formula for a field of the type **Formula**, that is **ftCalc**, with the Office UI language being US English, is `[Business Phone] & [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format of such a formula would be `[_14856] & [My custom field]`.</span></span>

- <span data-ttu-id="96ddc-251">Для полей типа **фтконкат**стандартный формат получается путем выполнения следующих действий:</span><span class="sxs-lookup"><span data-stu-id="96ddc-251">For fields of the type **ftConcat**, the standard format is obtained by performing the following:</span></span>

  1. <span data-ttu-id="96ddc-252">Усечение начальных и конечных пробелов.</span><span class="sxs-lookup"><span data-stu-id="96ddc-252">Truncate leading and trailing whitespace.</span></span> 
  2. <span data-ttu-id="96ddc-253">ПроАнализируйте формулу в последовательности фрагментов следующих двух типов:</span><span class="sxs-lookup"><span data-stu-id="96ddc-253">Parse the formula into a sequence of fragments of the following two kinds:</span></span> 
     - <span data-ttu-id="96ddc-254">Имя поля в квадратных скобках, то есть, `[<field_name>]`.</span><span class="sxs-lookup"><span data-stu-id="96ddc-254">A field name in square brackets, that is, `[<field_name>]`.</span></span> 
     - <span data-ttu-id="96ddc-255">Подстрока, не содержащая квадратных скобок.</span><span class="sxs-lookup"><span data-stu-id="96ddc-255">A substring not containing any square brackets.</span></span>   
      <span data-ttu-id="96ddc-256">Убедитесь, что ни один из двух фрагментов второго типа не является смежным в последовательности.</span><span class="sxs-lookup"><span data-stu-id="96ddc-256">Assure that no two fragments of the second kind are adjacent in the sequence.</span></span> <span data-ttu-id="96ddc-257">Если формула не может быть проанализирована таким образом, она считается недопустимой.</span><span class="sxs-lookup"><span data-stu-id="96ddc-257">If the formula cannot be parsed this way, it is considered invalid.</span></span> 
  3. <span data-ttu-id="96ddc-258">Выполните ту же замену для фрагментов первого типа, что и для полей **фткалк** и **фтсвитч** .</span><span class="sxs-lookup"><span data-stu-id="96ddc-258">Perform the same replacement for fragments of the first kind as for the **ftCalc** and **ftSwitch** fields.</span></span> 
  4. <span data-ttu-id="96ddc-259">Для каждого фрагмента второго типа все символы двойных кавычек ("" "), если они есть, с двумя последовательными символами двойной кавычки и заключить их в двойные кавычки.</span><span class="sxs-lookup"><span data-stu-id="96ddc-259">For each fragment of the second kind, escape all double-quote (""") characters, if any, with two consecutive double-quote characters, and enclose it in double quotes.</span></span> 
  5. <span data-ttu-id="96ddc-260">Вставка строки амперсанда (`&`) между каждой из двух смежных фрагментов.</span><span class="sxs-lookup"><span data-stu-id="96ddc-260">Insert an ampersand string (`&`) between each pair of adjacent fragments.</span></span>
 
  <span data-ttu-id="96ddc-261">Например, если используется английский язык ПОЛЬЗОВАТЕЛЬСКОГО интерфейса Office, то если для поля типа **фтконкат** ЗАДАН `text1 [Business Phone] "text2" [My custom field]`формат пользовательского интерфейса, где `My custom field` — это имя определяемого пользователем поля, то для такой формулы будет использоваться `""text1" & [_14856] & """text2""" & [My custom field]"`стандартный формат.</span><span class="sxs-lookup"><span data-stu-id="96ddc-261">For example, using the Office UI language US English, if the UI format of a formula for a field of the type **ftConcat** is `text1 [Business Phone] "text2" [My custom field]`, where `My custom field` is the name of a user-defined field, the standard format for such a formula would be `""text1" & [_14856] & """text2""" & [My custom field]"`.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="96ddc-262">См. также</span><span class="sxs-lookup"><span data-stu-id="96ddc-262">See also</span></span>

- [<span data-ttu-id="96ddc-263">Пример потока FolderUserFields</span><span class="sxs-lookup"><span data-stu-id="96ddc-263">FolderUserFields Stream Sample</span></span>](folderuserfields-stream-sample.md)
- [<span data-ttu-id="96ddc-264">Добавление определения для нового пользовательского поля</span><span class="sxs-lookup"><span data-stu-id="96ddc-264">Add a Definition for a New User-Defined Field</span></span>](how-to-add-a-definition-for-a-new-user-defined-field.md)


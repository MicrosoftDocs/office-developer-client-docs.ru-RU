---
title: IMAPITableAdvise
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.Advise
api_type:
- COM
ms.assetid: e8b5d21e-dc14-4b61-96b3-a51bcfa0d232
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: cd6b119bd88fccf80bf2488592a24b3398e6e8af
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22594245"
---
# <a name="imapitableadvise"></a>IMAPITable::Advise

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Регистрирует объект приемника уведомлений для получения уведомлений о влияния на таблице указанных событий.
  
```cpp
HRESULT Advise(
ULONG ulEventMask,
LPMAPIADVISESINK lpAdviseSink,
ULONG_PTR FAR * lpulConnection
);
```

## <a name="parameters"></a>Параметры

 _ulEventMask_
  
> [in] Значение, указывающее тип события, которое будет создавать уведомления. Допустим только следующее значение:
    
 `fnevTableModified`
  
 _lpAdviseSink_
  
> [in] Указатель на объект приемника уведомлений для последующих уведомлений. Этот объект приемника уведомлений должны уже выделено.
    
 _lpulConnection_
  
> [out] Указатель на ненулевое значение, представляющее регистрации успешного уведомлений.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Регистрация уведомлений, успешно завершена.
    
MAPI_E_NO_SUPPORT 
  
> Реализация таблицы не поддерживает изменения в его строках и столбцах или не поддерживает уведомления.
    
## <a name="remarks"></a>Замечания

Используйте метод **IMAPITable::Advise** для регистрации объекта таблицы, реализованный в поставщик для обратных вызовов уведомлений. При каждом изменении объекта таблицы Поставщик проверяет маска какие события было задано с помощью параметра _ulEventMask_ и, следовательно, какой тип изменения произошло. Если немного, поставщик вызывает метод [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) для объекта приемник уведомлений, указанное с помощью параметра _lpAdviseSink_ сообщение о событии. Данные, передаваемые в структуре уведомлений в подпрограмму **OnNotify** описание события. 
  
Вызов **OnNotify** может возникнуть во время звонка, которое изменяет объект или в любое время следующей. На компьютерах, поддерживающих многопоточной среде вызов **OnNotify** может выполняться на любой поток. Способ включить вызов **OnNotify** , который может произойти в неподходящее время в одну, который является более безопасной обработки поставщика следует использовать функцию [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) . 
  
Для предоставления уведомлений, объект приемника; рекомендаций поставщика реализации **уведомлений** необходимо сохранить копию указатель _lpAdviseSink_ для этого он вызывает метод **IUnknown::AddRef** для приемник уведомлений на обслуживание указателя на объект до отмены регистрации уведомлений с помощью вызова метода [IMAPITable::Unadvise](imapitable-unadvise.md) . Реализации **уведомлений** следует присвоить номер подключения для регистрации уведомлений и вызов **AddRef** на этот номер подключения до возвращения в параметре _lpulConnection_ . Поставщиков услуг можно освободить объект приемника уведомлений перед отменяется регистрация, но они не нужно освободить номер подключения до ** Unadvise ** вызова. 
  
После вызова **уведомлений** прошло успешно и перед ** Unadvise ** была вызванный, клиенты должны быть готовы для объекта приемник уведомлений нужно освободить. Клиент таким образом освобождать возвращается объект приемника уведомлений после **уведомлений** возвращает только при наличии его определенным длительного использования для него. 
  
Из-за асинхронного поведения уведомлений реализации, измените параметры столбца в таблице могут получать уведомления со сведениями, организованных в предыдущем порядок столбцов. Например строка таблицы могут возвращаться для сообщений, который только что был удален из контейнера. Такие уведомления отправляется, когда было сделано это изменение параметра столбца и сведения о нем отправляются, но эти сведения еще не были добавлены в табличном представлении уведомлений.
  
Дополнительные сведения о процессе уведомления видеть [Уведомления о событии в MAPI](event-notification-in-mapi.md). Сведения о таблице уведомлений содержатся [Уведомления о таблице](about-table-notifications.md). Сведения об использовании методов **IMAPISupport** для поддержки уведомлений [Поддерживающие уведомления о событии](supporting-event-notification.md)см.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |CContestTableListCtrl::NotificationOn  <br/> |Mfcmapi (en) использует метод **IMAPITable::Advise** для регистрации уведомлений разрешить в табличном представлении, чтобы быть в курсе.  <br/> |
   
## <a name="see-also"></a>См. также



[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)
  
[IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)
  
[IMAPITable::Unadvise](imapitable-unadvise.md)
  
[TABLE_NOTIFICATION](table_notification.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: IABLogonOpenTemplateID
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABLogon.OpenTemplateID
api_type:
- COM
ms.assetid: 751c36d3-c39e-4357-a60a-88685a378de0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bc68878a25873533162df7e1671e483c3bb77865
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334750"
---
# <a name="iablogonopentemplateid"></a>IABLogon::OpenTemplateID

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Открывает запись получателя, которая имеет данные, проживающие в поставщике адресной книги хост- адресов.
  
```cpp
HRESULT OpenTemplateID(
  ULONG cbTemplateID,
  LPENTRYID lpTemplateID,
  ULONG ulTemplateFlags,
  LPMAPIPROP lpMAPIPropData,
  LPCIID lpInterface,
  LPMAPIPROP FAR * lppMAPIPropNew,
  LPMAPIPROP lpMAPIPropSibling
);
```

## <a name="parameters"></a>Parameters

 _cbTemplateID_
  
> [in] Количество byte в идентификаторе шаблона, на который указывает _параметр lpTemplateID._ 
    
 _lpTemplateID_
  
> [in] Указатель на идентификатор шаблона **или свойство** [PR_TEMPLATEID (PidTagTemplateid)](pidtagtemplateid-canonical-property.md)для открываемой записи получателя.
    
 _ulTemplateFlags_
  
> [in] Битмашка флагов, используемых для того, чтобы указать, как открыть запись, представленную идентификатором шаблона. Можно установить следующий флаг:
    
FILL_ENTRY 
  
> Поставщик хостов создает новую запись в контейнере на основе записи, представленной идентификатором шаблона. Метод **IABLogon::OpenTemplateID** должен либо выполнять определенную инициализацию записи поставщика хостов с помощью [реализации IMAPIProp: IUnknown](imapipropiunknown.md) в параметре _lpMAPIPropData,_ либо возвращать настраиваемую реализацию интерфейса **IMAPIProp в** _параметре lppMAPIPropNew._ 
    
 _lpMAPIPropData_
  
> [in] Указатель на объект свойства хост-поставщика и реализацию интерфейса, полученного из **IMAPIProp.**
    
 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса (IID), который представляет тип указателя интерфейса, возвращаемого в _параметре lppMAPIPropNew._ Передача **null** возвращает стандартный пользовательский интерфейс обмена сообщениями [IMailUser : IMAPIProp](imailuserimapiprop.md).
    
 _lppMAPIPropNew_
  
> [вышел] Указатель на связанный объект свойства и реализация интерфейса, полученного из **IMAPIProp.**
    
 _lpMAPIPropSibling_
  
> [вышел] Зарезервировано; должно быть **null**.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Соответствующий код был успешно связан с связанными данными в принимающем поставщике.
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает ИД шаблонов.
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Идентификатор шаблона, переданный в  _параметре lpTemplateID,_ не распознается поставщиком адресной книги. 
    
## <a name="remarks"></a>Примечания

Метод **IABLogon::OpenTemplateID** реализуется только поставщиками адресных книг, которые должны контролировать копии записей, расположенных в контейнерах поставщиков хостов. Поставщики, реализуют **OpenTemplateID,** известны как иностранные поставщики адресных книг. Поставщики хостов звонят [по вызову IMAPISupport::OpenTemplateID,](imapisupport-opentemplateid.md) чтобы создать скопированную запись или открыть скопированную запись, и MAPI передает вызов **в IABLogon::OpenTemplateID**. **IABLogon::OpenTemplateID** открывает запись и связывает код, который управляет этим кодом, с данными в принимающем поставщике. 
  
Вместо использования идентификатора записи **IABLogon::OpenTemplateID** использует другое свойство, идентификатор шаблона **записи, PR_TEMPLATEID**. Идентификаторы шаблонов должны поддерживаться для записей, код которых должен быть привязан к данным в принимающем поставщике.
  
Примеры того, когда поставщик адресных книг должен реализовать **IABLogon::OpenTemplateID,** являются следующими: 
  
- Чтобы периодически обновлять данные для скопированные записи, чтобы они оставались синхронизированными с оригиналом.
    
- Реализация функций, которые не может реализовать поставщик хостов, например динамическое заполнение списка, который отображается в таблице сведений записи из данных на сервере.
    
- Управление взаимодействием между свойствами в записи поставщика размещения и исходной **записью,** например вычислением PR_EMAIL_ADDRESS [(PidTagEmailAddress)](pidtagemailaddress-canonical-property.md)из значений элементов управления редактирования в отображения сведений, содержащих различные компоненты адреса.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Когда поставщик хостинга копирует или создает запись от поставщика, и вы поставляете реализацию объекта свойства через **IABLogon::OpenTemplateID,** вы обрабатываете большинство вызовов для поддержания записи. Однако, так как передаваемые вызовы должны быть перенаадчены поставщику хостов, он может перехватить любой вызов и выполнить настраиваемую обработку перед переададной.
  
В реализации объектов свойства следует использовать следующие рекомендации:
  
- Когда [вызван IMAPIProp::GetProps,](imapiprop-getprops.md) определите, является ли запрос для вычислительного свойства и, если это так, обрабатывать его. Передай все запросы на некомпьютерные свойства поставщику размещения. 
    
- Когда [IMAPIProp::OpenProperty](imapiprop-openproperty.md) вызван для открытия любой таблицы, кроме таблицы отображения сведений, обрабатывают запрос. Большинство таблиц не могут быть точно скопированы поставщику хостов. Для этих запрашиваемых таблиц необходимо создать **реализацию IMAPITable.** В таблице **PR_DETAILS_TABLE** [(PidTagDetailsTable)](pidtagdetailstable-canonical-property.md)свойство должно быть скопировано с хост-провайдером. Это позволяет этому поставщику создавать таблицу локально. Может потребоваться обернуть реализацию таблицы отображения для создания уведомлений таблицы отображения. 
    
- Когда [вызван IMAPIProp::SetProps,](imapiprop-setprops.md) поставщик хостов может проверить данные, прежде чем дать вам задать свойства. Вы можете убедиться, что все необходимые свойства были настроены или вычислены. Если ошибка обнаружена, верни соответствующее значение ошибки и, если можно, любое дополнительное объяснение через [IMAPIProp::GetLastError](imapiprop-getlasterror.md).
    
- Когда [вызваны IMAPIProp::SaveChanges,](imapiprop-savechanges.md) поставщику хостов может потребоваться выполнить обработку перед сохранением записи. Необходимо сохранить все данные, которые влияют на измененные свойства, например новый адрес, в записи поставщика размещения. 
    
В общем, сделайте так, чтобы реализация записи, которую вы передаете поставщику хостов, перехватывала все методы для выполнения контекстных манипуляций с соответствующими свойствами. Если флаг FILL_ENTRY в  _параметре ulTemplateFlags,_ задай все свойства для входа. 
  
Если вы возвращаете новый объект свойства в  _параметре lppMAPIPropNew,_ позвоните [методу IUnknown::AddRef](https://msdn.microsoft.com/library/ms691379%28VS.85%29.aspx) объекта свойства поставщика хостов, чтобы сохранить ссылку. Все вызовы через связанный объект, возвращенный реализацией **IMAPIProp** в  _lppMAPIPropNew,_ должны быть перенаправлены в соответствующий метод в объекте свойства хост после их решения связанным объектом. 
  
Идентификаторы свойств всех именных свойств, которые передаются через связанный объект свойства, находятся в пространстве имен идентификатора поставщика. Реализация метода [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md) должна определять имена свойств, чтобы он выполнял любые задачи, определенные шаблону. Кроме того, свойства, которые поставщик передает поставщику хостов, также должны быть в пространстве имен. Например, если в **OpenTemplateID** задано имя имени, следует использовать один из идентификаторов для имени, создав его, если это необходимо, позвонив по методу [IMAPIProp::GetIDsFromNames.](imapiprop-getidsfromnames.md) 
  
Если вы не узнаете идентификатор записи, переданный  _в lpTemplateID,_ MAPI_E_UNKNOWN_ENTRYID.
  
Дополнительные сведения о работе с идентификаторами шаблонов адресных книг см. в книге [Acting as a Foreign Address Book Provider.](acting-as-a-foreign-address-book-provider.md)
  
## <a name="see-also"></a>См. также



[IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md)
  
[IPropData : IMAPIProp](ipropdataimapiprop.md)
  
[Каноническое свойство PidTagTemplateid](pidtagtemplateid-canonical-property.md)
  
[IABLogon : IUnknown](iablogoniunknown.md)


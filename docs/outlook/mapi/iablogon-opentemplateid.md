---
title: IABLogonOpenTemplateID
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABLogon.OpenTemplateID
api_type:
- COM
ms.assetid: 751c36d3-c39e-4357-a60a-88685a378de0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bc68878a25873533162df7e1671e483c3bb77865
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334750"
---
# <a name="iablogonopentemplateid"></a>IABLogon::OpenTemplateID

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Открывает запись получателя с данными, которые есть в поставщике адресной книги хост-адреса.
  
```cpp
HRESULT OpenTemplateID(
  ULONG cbTemplateID,
  LPENTRYID lpTemplateID,
  ULONG ulTemplateFlags,
  LPMAPIPROP lpMAPIPropData,
  LPCIID lpInterface,
  LPMAPIPROP FAR * lppMAPIPropNew,
  LPMAPIPROP lpMAPIPropSibling
);
```

## <a name="parameters"></a>Параметры

 _cbTemplateID_
  
> [in] Количество byte в идентификаторе шаблона, на который указывает _параметр lpTemplateID._ 
    
 _lpTemplateID_
  
> [in] Указатель на идентификатор шаблона или **PR_TEMPLATEID** ([PidTagTemplateid)](pidtagtemplateid-canonical-property.md)записи получателя, которая должна быть открыта.
    
 _ulTemplateFlags_
  
> [in] Битоваяmas флагов, используемая для того, чтобы указать, как открыть запись, представленную идентификатором шаблона. Можно установить следующий флаг:
    
FILL_ENTRY 
  
> Поставщик услуг хоста создает новую запись в своем контейнере на основе записи, представленной идентификатором шаблона. Метод **IABLogon::OpenTemplateID** должен либо выполнять определенную инициализацию записи поставщика услуг хоста с помощью [реализации IMAPIProp : IUnknown](imapipropiunknown.md) в _параметре lpMAPIPropData,_ либо возвращать пользовательскую реализацию интерфейса **IMAPIProp** в _параметре lppMAPIPropNew._ 
    
 _lpMAPIPropData_
  
> [in] Указатель на объект свойства поставщика услуг хоста и реализацию интерфейса, производного от **IMAPIProp.**
    
 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса ( IID), который представляет тип указателя интерфейса, возвращаемого в _параметре lppMAPIPropNew._ Передача **null** возвращает стандартный пользовательский интерфейс обмена сообщениями [IMailUser : IMAPIProp.](imailuserimapiprop.md)
    
 _lppMAPIPropNew_
  
> [out] Указатель на объект привязанного свойства и реализацию интерфейса, производного от **IMAPIProp.**
    
 _lpMAPIPropSibling_
  
> [out] Зарезервировано; должно быть **null**.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Соответствующий код успешно привязан к связанным данным в поставщике услуг.
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает ИД шаблонов.
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Идентификатор шаблона, переданный в  _параметре lpTemplateID,_ не распознается поставщиком адресной книги. 
    
## <a name="remarks"></a>Примечания

Метод **IABLogon::OpenTemplateID** реализуется только поставщиками адресных книг, которые должны контролировать копии записей, расположенных в контейнерах поставщиков услуг. Поставщики, реализуют **OpenTemplateID,** называются поставщиками внешних адресных книг. Поставщики услуг host вызовите [IMAPISupport::OpenTemplateID,](imapisupport-opentemplateid.md) чтобы создать скопированную запись или открыть скопированную запись, и MAPI передает вызов **в IABLogon::OpenTemplateID.** **IABLogon::OpenTemplateID** открывает запись и привязывает код, который управляет ее данными в поставщике услуг. 
  
Вместо использования идентификатора записи **IABLogon::OpenTemplateID** использует другое свойство, идентификатор шаблона записи, **PR_TEMPLATEID**. Идентификаторы шаблонов должны поддерживаться для записей, код которых должен быть привязан к данным в поставщике услуг.
  
Вот некоторые примеры, когда поставщик адресной книги должен реализовать **IABLogon::OpenTemplateID:** 
  
- Периодическое обновление данных для скопированной записи, чтобы они оставались синхронизированными с исходным.
    
- Реализация функций, которые не удается реализовать поставщику услуг, например динамическое заполнение списка, который отображается в таблице сведений записи из данных на сервере.
    
- Для управления взаимодействием между свойствами в записи поставщика услуг размещения и исходной записью, например вычисление **PR_EMAIL_ADDRESS** ([PidTagEmailAddress)](pidtagemailaddress-canonical-property.md)из значений элементов управления редактированием в сведениях, содержащих различные компоненты адреса.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Когда поставщик услуг хоста копирует или создает запись у поставщика и вы передаете реализацию объекта свойства через **IABLogon::OpenTemplateID,** большинство вызовов обрабатываются для поддержания записи. Однако, так как поставщик услуг связи может перенаададовывать эти вызовы вам, поставщик услуг хоста может перехватить любой вызов и выполнить пользовательскую обработку перед переад назад.
  
В реализации объектов свойств следует использовать следующие рекомендации:
  
- При [обращении к IMAPIProp::GetProps](imapiprop-getprops.md) определите, является ли запрос для вычисляемого свойства и, если это так, обработать его. Передать все запросы на несовершенные свойства поставщику услуг размещения. 
    
- Когда [IMAPIProp::OpenProperty](imapiprop-openproperty.md) вызван для открытия любой таблицы, кроме отображаемой таблицы сведений, обрабатывают запрос. Большинство таблиц не могут быть точно скопированы поставщику услуг. Необходимо создать реализацию **IMAPITable** для этих запрашиваемых таблиц. Таблица сведений **PR_DETAILS_TABLE** ([PidTagDetailsTable)](pidtagdetailstable-canonical-property.md)должна быть скопирована поставщику услуг. Это позволяет поставщику создавать таблицу локально. Вам может потребоваться обтекать реализацию таблицы отображения для создания уведомлений таблицы отображения. 
    
- При [наборе IMAPIProp::SetProps](imapiprop-setprops.md) поставщик услуг размещения может проверить данные, прежде чем устанавливать свойства. Вы можете убедиться, что все необходимые свойства установлены или вычислены. Если ошибка обнаружена, вернетесь соответствующее значение ошибки и, если возможно, любое дополнительное объяснение с помощью [IMAPIProp::GetLastError](imapiprop-getlasterror.md).
    
- При выполнении связи [IMAPIProp::SaveChanges](imapiprop-savechanges.md) поставщику услуг хоста может потребоваться выполнить обработку перед сохранением записи. В записи поставщика услуг размещения необходимо сохранить все данные, на которые влияют измененные свойства, например новый адрес. 
    
Как правило, реализация записи, передаемой поставщику услуг размещения, перехватывает все методы для выполнения обработки соответствующих свойств с учетом контекста. Если флаг FILL_ENTRY передается в  _параметре ulTemplateFlags,_ установите все свойства записи. 
  
Если вы возвращаете новый объект свойства в параметре  _lppMAPIPropNew,_ вызовите метод [IUnknown::AddRef](https://msdn.microsoft.com/library/ms691379%28VS.85%29.aspx) объекта свойства поставщика услуг хоста, чтобы сохранить ссылку. Все вызовы через привязанный объект, возвращенный реализацией **IMAPIProp** в  _lppMAPIPropNew,_ должны быть перенаправлены соответствующему методу в объекте свойства хоста после того, как объект привязана к ним. 
  
Идентификаторы свойств всех именуемого свойства, которые передаются через объект привязанного свойства, находятся в пространстве имен идентификатора поставщика. Реализация метода [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md) должна определять имена свойств, чтобы он выполнял любые задачи, определенные в шаблоне. Аналогичным образом, свойства, которые поставщик передает поставщику услуг размещения, также должны быть в вашем пространстве имен. Например, если в **OpenTemplateID** задано именовое свойство, следует использовать один из идентификаторов для имени — при необходимости создать его, вызывая метод [IMAPIProp::GetIDsFromNames.](imapiprop-getidsfromnames.md) 
  
Если идентификатор записи, переданный в  _lpTemplateID,_ не распознается, MAPI_E_UNKNOWN_ENTRYID.
  
Дополнительные сведения о работе с идентификаторами шаблонов адресных книг см. в документе ["Действующие как поставщик внешних адресных книг".](acting-as-a-foreign-address-book-provider.md)
  
## <a name="see-also"></a>См. также



[IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md)
  
[IPropData : IMAPIProp](ipropdataimapiprop.md)
  
[Каноническое свойство PidTagTemplateid](pidtagtemplateid-canonical-property.md)
  
[IABLogon : IUnknown](iablogoniunknown.md)


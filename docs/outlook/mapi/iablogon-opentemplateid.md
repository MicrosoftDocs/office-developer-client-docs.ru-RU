---
title: Иаблогонопентемплатеид
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABLogon.OpenTemplateID
api_type:
- COM
ms.assetid: 751c36d3-c39e-4357-a60a-88685a378de0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bc68878a25873533162df7e1671e483c3bb77865
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334750"
---
# <a name="iablogonopentemplateid"></a>IABLogon::OpenTemplateID

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Открывает запись получателя, которая содержит данные, находящиеся в поставщике адресной книги узла.
  
```cpp
HRESULT OpenTemplateID(
  ULONG cbTemplateID,
  LPENTRYID lpTemplateID,
  ULONG ulTemplateFlags,
  LPMAPIPROP lpMAPIPropData,
  LPCIID lpInterface,
  LPMAPIPROP FAR * lppMAPIPropNew,
  LPMAPIPROP lpMAPIPropSibling
);
```

## <a name="parameters"></a>Параметры

 _Кбтемплатеид_
  
> возврата Число байтов в идентификаторе шаблона, на которое указывает параметр _лптемплатеид_ . 
    
 _Лптемплатеид_
  
> возврата Указатель на идентификатор шаблона или свойство **пр_темплатеид** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) открываемой записи получателя.
    
 _Ултемплатефлагс_
  
> возврата Битовая маска флагов, используемая для указания способа открытия записи, представленной идентификатором шаблона. Можно задать следующий флаг:
    
ФИЛЛ_ЕНТРИ 
  
> Поставщик узла создает новую запись в своем контейнере на основе записи, представленной идентификатором шаблона. Метод **иаблогон:: опентемплатеид** должен выполнять определенную инициализацию записи поставщика узла с помощью реализации интерфейса [IMAPIProp: IUnknown](imapipropiunknown.md) в параметре _лпмапипропдата_ или возвращать настраиваемый **IMAPIProp **реализация интерфейса в параметре _лппмапипропнев_ . 
    
 _Лпмапипропдата_
  
> возврата Указатель на объект Property поставщика ведущего приложения и реализацию интерфейса, производного от **IMAPIProp**.
    
 _Лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий тип указателя интерфейса, возвращаемого в параметре _лппмапипропнев_ . При передаче **значения NULL** возвращается стандартный пользовательский интерфейс обмена сообщениями, [имаилусер: IMAPIProp](imailuserimapiprop.md).
    
 _Лппмапипропнев_
  
> вышли Указатель на связанный объект Property и реализацию интерфейса, производного от **IMAPIProp**.
    
 _Лпмапипропсиблинг_
  
> вышли Резервирования должно иметь **значение NULL**.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Соответствующий код был успешно привязан к связанным данным в поставщике узла.
    
МАПИ_Е_НО_СУППОРТ 
  
> Объект не поддерживает идентификаторы шаблонов.
    
МАПИ_Е_УНКНОВН_ЕНТРИД 
  
> Поставщику адресной книги не удается распознать идентификатор шаблона, переданный в параметре _лптемплатеид_ . 
    
## <a name="remarks"></a>Комментарии

Метод **иаблогон:: опентемплатеид** реализован только поставщиками адресных книг, которые должны поддерживать Управление копиями записей, которые находятся в контейнерах поставщиков узла. Поставщики, которые реализуют **опентемплатеид** , называются внешними поставщиками адресных книг. Поставщики узла вызывают [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md) для создания скопированной записи или открытия скопированной записи, а MAPI передается на вызов **Иаблогон:: опентемплатеид**. **Иаблогон:: опентемплатеид** открывает запись и применяет к ней код, который управляет им данных в поставщике узла. 
  
Вместо использования идентификатора записи **иаблогон:: опентемплатеид** использует другое свойство, идентификатор шаблона записи **пр_темплатеид**. Идентификаторы шаблонов должны поддерживаться записями, код которых должен быть связан с данными в поставщике узла.
  
Некоторые примеры, когда поставщик адресных книг должен реализовать **иаблогон:: опентемплатеид** , следующие: 
  
- Для периодического обновления данных скопированной записи, чтобы она оставалась синхронизированной с оригиналом.
    
- Реализация функциональных возможностей, которые поставщик узла не может реализовать, например динамического заполнения списка, который отображается в таблице сведений записи, из данных на сервере.
    
- Для управления взаимодействием между свойствами в записи поставщика узла и исходной записью, такими как вычисление **пр_емаил_аддресс** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) из значений элементов управления редактирования в отображаемом сведения, содержащих различные компоненты адреса.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Когда поставщик узла копирует или создает запись из поставщика, и вы предоставляете реализацию объекта Property с помощью **иаблогон:: опентемплатеид**, вы обрабатываете большинство вызовов для поддержки записи. Тем не менее, так как поставщик узла отправляет эти вызовы, поставщик узла может перехватить любой вызов и выполнить настраиваемую обработку перед пересылкой вызова.
  
В реализациях объектов свойств необходимо придерживаться следующих рекомендаций:
  
- Когда вызывается [IMAPIProp::](imapiprop-getprops.md) -Props, определите, предназначен ли запрос для вычисляемого свойства, и обработайте его. Передача всех запросов для невычисляемых свойств поставщику узла. 
    
- Когда [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) вызывается для открытия любой таблицы, кроме таблицы отображения сведений, обработайте запрос. Большинство таблиц не удается точно скопировать в поставщик узла. Необходимо создать реализацию **IMAPITable** для этих запрошенных таблиц. Свойство Table Details **пр_детаилс_табле** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) необходимо скопировать в поставщик узла. Это позволяет этому поставщику создать таблицу локально. Вы можете заключить реализацию таблицы отображения для создания уведомлений для отображения таблицы. 
    
- Когда [IMAPIProp:: SetProps](imapiprop-setprops.md) вызывается, поставщик узла может проверить данные, прежде чем позволить задать свойства. Вы можете убедиться, что все необходимые свойства заданы или вычислены. Если обнаружена ошибка, возвращайте соответствующее значение ошибки и, если возможно, любое дополнительное объяснение через [IMAPIProp:: GetLastError](imapiprop-getlasterror.md).
    
- Когда [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) вызывается, поставщику узла может потребоваться выполнить обработку перед сохранением записи. Необходимо сохранить все данные, на которые влияет измененные свойства, например новый адрес, в записи поставщика узла. 
    
В общем случае сделайте реализацию записи, которая передается обратно поставщику узла, перехватить все методы для выполнения контекстной обработки соответствующих свойств. Если в параметре _ултемплатефлагс_ передается флаг филл_ентри, задайте для записи все свойства. 
  
Если вы возвращаете новый объект Property в параметре _лппмапипропнев_ , вызовите метод [IUnknown:: AddRef](https://msdn.microsoft.com/library/ms691379%28VS.85%29.aspx) объекта Property поставщика узла для поддержки ссылки. Все вызовы через привязанный объект, возвращаемый в _лппмапипропнев_ реализацией **IMAPIProp** , должны перенаправляться в соответствующий метод объекта Property узла после того, как они обрабатываются связанным объектом. 
  
Идентификаторы свойств любых именованных свойств, которые передаются через объект связанного свойства, находятся в пространстве имен идентификатора поставщика. Реализация метода [IMAPIProp:: жетнамесфромидс](imapiprop-getnamesfromids.md) должна определять имена свойств, чтобы она могла выполнять любые задачи, связанные с шаблоном. Аналогично свойства, которые поставщик передает поставщику узла, также должны находиться в пространстве имен. Например, если вы задаете именованное свойство в **опентемплатеид**, то при необходимости необходимо использовать один из идентификаторов для имени (при необходимости), вызвав метод [IMAPIProp:: жетидсфромнамес](imapiprop-getidsfromnames.md) . 
  
Если вы не узнаете идентификатор записи, переданный в _лптемплатеид_, возвратите мапи_е_ункновн_ентрид.
  
Для получения дополнительных сведений о том, как работать с идентификаторами шаблонов адресных книг, обратитесь к разделу "работа в [качестве поставщика внешних адресНых книг](acting-as-a-foreign-address-book-provider.md)".
  
## <a name="see-also"></a>См. также



[IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md)
  
[IPropData : IMAPIProp](ipropdataimapiprop.md)
  
[Каноническое свойство PidTagTemplateid](pidtagtemplateid-canonical-property.md)
  
[IABLogon : IUnknown](iablogoniunknown.md)


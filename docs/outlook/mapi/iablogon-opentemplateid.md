---
title: IABLogonOpenTemplateID
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABLogon.OpenTemplateID
api_type:
- COM
ms.assetid: 751c36d3-c39e-4357-a60a-88685a378de0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f2fedd98fe84d7359aebaca8d03a20f392dae2b0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808734"
---
# <a name="iablogonopentemplateid"></a>IABLogon::OpenTemplateID

  
  
**Относится к**: Outlook 
  
Открывает запись получателя, который содержит данные, хранимые в адресной книге узла.
  
```cpp
HRESULT OpenTemplateID(
  ULONG cbTemplateID,
  LPENTRYID lpTemplateID,
  ULONG ulTemplateFlags,
  LPMAPIPROP lpMAPIPropData,
  LPCIID lpInterface,
  LPMAPIPROP FAR * lppMAPIPropNew,
  LPMAPIPROP lpMAPIPropSibling
);
```

## <a name="parameters"></a>Параметры

 _cbTemplateID_
  
> [in] Число байтов в идентификатор шаблона, на который указывает параметр _lpTemplateID_ . 
    
 _lpTemplateID_
  
> [in] Указатель на идентификатор шаблона или свойство **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) получателей записи, которую требуется открыть.
    
 _ulTemplateFlags_
  
> [in] Битовая маска флагов, используемых для указания того, как открыть запись, представленное идентификатор шаблона. Можно задать следующий флаг:
    
FILL_ENTRY 
  
> Поставщик узла создания записи в контейнера на основе записи, представленного идентификатор шаблона. Метод **IABLogon::OpenTemplateID** либо должен выполнять определенные инициализации запись узла поставщика с помощью [IMAPIProp: IUnknown](imapipropiunknown.md) реализации в параметре _lpMAPIPropData_ или return настраиваемую **IMAPIProp **реализация с помощью параметра _lppMAPIPropNew_ интерфейса. 
    
 _lpMAPIPropData_
  
> [in] Указатель на объект свойств и реализация интерфейса поставщика узла на основе **IMAPIProp**.
    
 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса (ИД интерфейса), который представляет тип указателя интерфейса должно быть возвращено с помощью параметра _lppMAPIPropNew_ . Передача **null** Возвращает стандартный пользовательский интерфейс системы обмена сообщениями [IMailUser: IMAPIProp](imailuserimapiprop.md).
    
 _lppMAPIPropNew_
  
> [out] Указатель на объект привязки свойств и реализация интерфейса на основе **IMAPIProp**.
    
 _lpMAPIPropSibling_
  
> [out] Зарезервировано; должен иметь **значение null**.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Соответствующий код был успешно привязан к связанных данных в поставщике узла.
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает идентификаторы шаблонов.
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Идентификатор шаблона, переданной в параметре _lpTemplateID_ не распознается поставщик адресной книги. 
    
## <a name="remarks"></a>Замечания

Метод **IABLogon::OpenTemplateID** реализована только с поставщиками адресных книг, которые необходимо контролировать копий своих записей, которые расположены в контейнерах поставщиков услуг размещения. Поставщики, которые реализуют **OpenTemplateID** называются поставщиками внешнего адресной книги. Поставщики узла вызова [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) для создания скопированной записи или откройте скопированный запись, и передает MAPI на вызов **IABLogon::OpenTemplateID**. **IABLogon::OpenTemplateID** открывает запись и связывает код, который управляет к данным в поставщике узла. 
  
А не использовать запись идентификатора, **IABLogon::OpenTemplateID** используется другой свойство, идентификатор шаблона элемента, **PR_TEMPLATEID**. Идентификаторы шаблон должен поддерживается для записей, код должен быть привязан к данным в этот поставщик.
  
Некоторые примеры когда поставщика адресных книг должна реализовать **IABLogon::OpenTemplateID** , как показано ниже: 
  
- Периодически обновлять данные в скопированной записи, чтобы он остается синхронизированы с исходной.
    
- Чтобы реализовать функциональные возможности, которые не могут реализовать поставщик узла, такие как динамическое заполнение списка, который отображается в таблице запись сведений на основе данных на сервере.
    
- Для управления взаимодействием между свойствами в запись узла поставщика и исходной операции, такие как вычисления **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) из значений редактирования элементов управления в окне сведений, которые содержат различные компоненты адреса.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Когда этот поставщик копирует или создает запись у поставщика и предоставить реализацию свойства объекта через **IABLogon::OpenTemplateID**, обрабатывать большинство вызовов на обслуживание операция. Тем не менее так как это до узла поставщика для переадресации звонков, эти вам поставщик узла можно перехвата любой вызов и выполнять настраиваемые функции обработки перед переадресацией звонка.
  
В реализации объекта свойства следует использовать следующие рекомендации:
  
- При вызове [IMAPIProp::GetProps](imapiprop-getprops.md) определите, являются ли запрос для вычисляемого свойства и, если он установлен, его обработки. Перенос всех запросов для невычисляемого свойств для размещения поставщика. 
    
- При вызове [IMAPIProp::OpenProperty](imapiprop-openproperty.md) для открытия любой таблицы, за исключением сведения отображения таблицы, обработать запрос. Большинство таблицы не удается скопировать точно для размещения поставщика. Необходимо создать **IMAPITable** реализации для этих запрошенные таблиц. Свойство **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) сведения о таблице нужно скопировать поставщик узла. Это позволяет данного поставщика для создания таблицы локально. Может потребоваться перенос реализации отображения таблицы для создания уведомлений в таблице отображения. 
    
- При вызове [IMAPIProp::SetProps](imapiprop-setprops.md) поставщик узла можно проверить данные перед предоставлением можно задать свойства. Вы можете проверить, что все необходимые свойства задайте или вычислить. Если обнаружена ошибка возврата соответствующего значения ошибки и, если это возможно, любые дополнительные объяснение через [IMAPIProp::GetLastError](imapiprop-getlasterror.md).
    
- При вызове [IMAPIProp::SaveChanges](imapiprop-savechanges.md) узла поставщика может потребоваться обработка перед сохраните запись. Следует сохранить все данные, которые были затронуты измененных свойств, например новый адрес в запись узла поставщика. 
    
В общем случае внести внедрения записи, передаваемого поставщик узла перехватывать все методы для выполнения обработки контекстные соответствующих свойств. Если флаг FILL_ENTRY передается в параметре _ulTemplateFlags_ , необходимо задайте все свойства для записи. 
  
Если новый объект свойство вернуться в параметре _lppMAPIPropNew_ , вызовите метод [IUnknown::AddRef](http://msdn.microsoft.com/en-us/library/ms691379%28VS.85%29.aspx) объекта свойство поставщика узла на обслуживание ссылку. Все вызовы через присоединенного объекта, возвращаемого реализации **IMAPIProp** в _lppMAPIPropNew_ должны направляться их соответствующий метод в объекте свойство узла после они обрабатываются объектом привязки. 
  
Идентификаторы свойств именованные свойства, которые передаются через объект связанное свойство находятся в пространстве имен идентификатор ваш поставщик. Реализация метода [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md) необходимо определить имена свойств, чтобы он может выполнять любые задачи, связанные с шаблоном. Аналогично свойства, которые ваш поставщик передается поставщик узла также должен быть в пространстве имен. Например, если значение именованного свойства в **OpenTemplateID**, следует использовать один из вашего идентификаторов для имени — создание его, если это необходимо, путем вызова метода [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) . 
  
Если идентификатор записи, переданные в _lpTemplateID_не распознают, возвратите MAPI_E_UNKNOWN_ENTRYID.
  
Дополнительные сведения о работе с идентификаторами шаблон адресной книги можно [используется в качестве внешнего поставщик адресной книги](acting-as-a-foreign-address-book-provider.md).
  
## <a name="see-also"></a>См. также



[IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md)
  
[IPropData : IMAPIProp](ipropdataimapiprop.md)
  
[Каноническое свойство PidTagTemplateid](pidtagtemplateid-canonical-property.md)
  
[IABLogon : IUnknown](iablogoniunknown.md)


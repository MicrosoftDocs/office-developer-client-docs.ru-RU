---
title: Имапиконтаинержесиерарчитабле
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIContainer.GetHierarchyTable
api_type:
- COM
ms.assetid: d0c54092-86a3-47e0-8133-72e119e74b65
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: efc7f7a2fa703004afe361d766e0209ba40ffe46
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32286941"
---
# <a name="imapicontainergethierarchytable"></a>IMAPIContainer::GetHierarchyTable

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Возвращает указатель на таблицу иерархии контейнера.
  
```cpp
HRESULT GetHierarchyTable(
  ULONG ulFlags,
  LPMAPITABLE FAR * lppTable
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> возврата Битовая маска флагов, определяющих способ возвращения данных в таблице. Можно задать следующие флаги:
    
КОНВЕНИЕНТ_ДЕПС 
  
> Заполняет таблицу иерархии контейнерами из нескольких уровней. Если КОНВЕНИЕНТ_ДЕПС не задано, таблица иерархии содержит только непосредственные дочерние контейнеры контейнера.
    
МАПИ_ДЕФЕРРЕД_ЕРРОРС 
  
> **Жесиерарчитабле** может успешно вернуть, возможно, перед тем, как таблица стала доступна вызывающему объекту. Если таблица недоступна, выполнение последующих вызовов таблицы может вызвать ошибку. 
    
MAPI_UNICODE 
  
> ЗаПрашивает возврат столбцов, содержащих строковые данные, в формате Юникод. Если флаг МАПИ_УНИКОДЕ не установлен, строки должны быть возвращены в формате ANSI. 
    
SHOW_SOFT_DELETES
  
> Показывает элементы, которые в настоящее время помечены как обратимо удаленные — то есть они находятся на стадии хранения удаленных элементов.
    
 _Лпптабле_
  
> вышли Указатель на указатель на таблицу иерархии.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Таблица иерархии успешно получена.
    
МАПИ_Е_БАД_ЧАРВИДС 
  
> Установлен либо флаг МАПИ_УНИКОДЕ, либо реализация не поддерживает Юникод, или МАПИ_УНИКОДЕ не задано, а реализация поддерживает только Юникод.
    
МАПИ_Е_НО_СУППОРТ 
  
> Контейнер не имеет дочерних контейнеров и не может предоставить таблицу иерархии.
    
## <a name="remarks"></a>Замечания

Метод **IMAPIContainer:: жесиерарчитабле** возвращает указатель на таблицу иерархии контейнера. В таблице иерархий содержатся сводные сведения о дочерних контейнерах в контейнере. В таблицах иерархии папок хранятся сведения о вложенных папках; в таблицах иерархий адресной книги хранятся сведения о контейнерах дочерних адресных книг и списках рассылки. 
  
Некоторые контейнеры могут не иметь дочерних контейнеров. Эти контейнеры возвращают МАПИ_Е_НО_СУППОРТ из реализации **жесиерарчитабле**.
  
Если установлен флаг КОНВЕНИЕНТ_ДЕПС, каждая строка в таблице иерархий также включает в себя свойство **пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md)) в виде столбца. **Пр_депс** указывает уровень каждого контейнера относительно контейнера, в котором реализуется таблица. Непосредственные дочерние контейнеры реализующего контейнера имеют нулевую глубину, дочерние контейнеры в контейнерах нулевой глубины имеют глубину 1 и т. д. Значения **пр_депс** увеличиваются последовательно, как иерархия уровней Дипенс. 
  
Полный список обязательных и необязательных столбцов в таблицах иерархий представлен в статье [иерархиЧеские таблицы](hierarchy-tables.md).
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если вы поддерживаете иерархию для контейнера, необходимо также выполнить следующие действия:
  
- Поддерживает вызов метода контейнера [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) для открытия свойства **пр_контаинер_хиерарчи** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)).
    
- Возвращает **пр_контаинер_хиерарчи** из вызова методов контейнера [IMAPIProp:: жетпроплист](imapiprop-getproplist.md) или [IMAPIProp::: PROPS](imapiprop-getprops.md) . 
    
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Столбцы таблицы строковых и двоичных содержимого можно усечь. Как правило, поставщики возвращают 255 символов. Так как вы не можете заранее узнать, содержит ли таблица усеченные столбцы, предположим, что столбец усекается, если длина столбца составляет 255 или 510 байт. Вы всегда можете получить полное значение сокращенного столбца (при необходимости) непосредственно из объекта, используя его идентификатор записи, чтобы открыть его, а затем вызвать метод [IMAPIProp::](imapiprop-getprops.md) /PROPS. 
  
В зависимости от реализации поставщика, ограничения и операции сортировки можно применить ко всей строке или к усеченной версии этой строки. Кроме того, поставщики хранилища не гарантируют соблюдение порядка сортировки [ссортордерсет](ssortorderset.md) , указанного для таблиц иерархии. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Хиерарчитаблетриктрл. cpp  <br/> |Чиерарчитаблетриктрл:: Жесиерарчитабле  <br/> |Класс Чиерарчитаблетриктрл использует **жесиерарчитабле** для получения таблиц иерархии для отображения в элементе управления представлением в виде дерева.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::GetPropList](imapiprop-getproplist.md)
  
[IMAPIProp::GetProps](imapiprop-getprops.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)
  
[Каноническое свойство PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)
  
[IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


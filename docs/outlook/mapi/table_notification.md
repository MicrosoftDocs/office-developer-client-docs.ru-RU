---
title: TABLE_NOTIFICATION
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.TABLE_NOTIFICATION
api_type:
- COM
ms.assetid: 48e478c4-6e9a-40ab-a7bb-e6219b743b08
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 6c35220529fb88b470c563a0b004bfcf7e63ef76
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415959"
---
# <a name="table_notification"></a>TABLE_NOTIFICATION

**Относится к**: Outlook 2013 | Outlook 2016 
  
Описывает строку в таблице, на которую влияют некоторые типы событий, такие как изменение или ошибка. Это приводит к созданию уведомления таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |MAPIDEFS. h  <br/> |
   
```cpp
typedef struct _TABLE_NOTIFICATION
{
  ULONG ulTableEvent;
  HRESULT hResult;
  SPropValue propIndex;
  SPropValue propPrior;
  SRow row;
} TABLE_NOTIFICATION;

```

## <a name="members"></a>"Участники"

**ултабливент**
  
> Битовая маска флагов, используемых для представления типа табличного события. Можно задать следующие флаги:
    
TABLE_CHANGED 
  
> Указывает на высокий уровень, в котором изменилось какое-либо значение для таблицы. Состояние таблицы — то, что она была до события. Это означает, что все свойства **PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md)), закладки, текущее расположение и параметры пользовательского интерфейса все еще действительны. Обработайте это событие с помощью пересчитывания таблицы. Поставщики услуг, которые не хотят реализовывать Многофункциональные уведомления, отправляют TABLE_CHANGED события, а не более подробные события, чтобы указать конкретный тип изменения. 
    
TABLE_ERROR 
  
> Произошла ошибка, обычно во время обработки асинхронной операции. При обработке следующих методов возникли ошибки, которые могут создать это событие: 
    
   - [IMAPITable::SortTable](imapitable-sorttable.md)
    
   - [IMAPITable::SetColumns](imapitable-setcolumns.md)
    
   - [IMAPITable::Restrict](imapitable-restrict.md)
    
   После получения события TABLE_ERROR клиент не может зависеть от точности содержимого таблицы. Кроме того, ожидающие уведомления о других изменениях могут быть потеряны. Метод [IMAPITable:: GetLastError](imapitable-getlasterror.md) не может предоставлять дополнительные сведения об ошибке, так как она была создана в какой-либо предыдущей точке, а не обязательно из последнего вызова метода. 
    
TABLE_RELOAD 
  
> Данные в таблице должны быть перезагружены. Поставщики услуг отправляют TABLE_RELOAD когда, например, базовые данные хранятся в базе данных, а база данных заменяется. Обработайте это событие, предполагая, что ничего для таблицы по-прежнему является допустимым и пересчитывает таблицу. Все закладки, ключи экземпляра, сведения о состоянии и размещении недопустимы.
    
TABLE_RESTRICT_DONE 
  
> Операция ограничения, инициированная с помощью вызова метода **IMAPITable:: restrict** , завершена. 
    
TABLE_ROW_ADDED 
  
> В таблицу добавлена новая строка и сохранен соответствующий объект. События TABLE_ROW_ADDED создаются после вызова метода [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) . 
    
TABLE_ROW_DELETED 
  
> Строка была удалена из таблицы. Для члена **пропприор** ЗАДАНО значение null. 
    
TABLE_ROW_MODIFIED 
  
> Изменена строка. Элемент **Row** содержит затронутые свойства для строки. Несколько событий TABLE_ROW_MODIFIED отправляются в том порядке, в котором они отображаются в представлении таблицы. 
    
  TABLE_ROW_MODIFIED события отправляются после того, как изменения соответствующего объекта зафиксированы с помощью вызова метода **IMAPIProp:: SaveChanges** . Если измененная строка теперь является первой строкой в таблице, значение тега свойства в элементе **пропприор** — **PR_NULL** ([PidTagNull](pidtagnull-canonical-property.md)).
    
TABLE_SETCOL_DONE 
  
> Операция настройки столбца, инициированная с помощью вызова метода **IMAPITable:: метода SetColumns** , завершена. 
    
TABLE_SORT_DONE 
  
> Операция сортировки таблицы, инициированная с помощью вызова метода **IMAPITable:: сорттабле** , завершена. 
    
**Состав**
  
> Значение HRESULT для возникшей ошибки, если для члена **ултабливент** задано значение TABLE_ERROR. 
    
**пропиндекс**
  
> Структура [спропвалуе](spropvalue.md) для свойства **PR_INSTANCE_KEY** затронутой строки. 
    
**пропприор**
  
> Структура **спропвалуе** для свойства **PR_INSTANCE_KEY** строки перед затронутым. Если затронутая строка является первой строкой в таблице, **пропприор** должен иметь значение **PR_NULL** , а не ноль. Ноль не является допустимым тегом свойства. 
    
**Строка**
  
> Структура [сров](srow.md) , описывающая затронутую строку. Эта структура заполняется для всех событий уведомления таблицы. Для событий уведомления таблицы, которые не передают данные строки, элементу **квалуес** структуры **сров** присваивается нулевое значение, а для элемента **лппропс** задано значение null. Так как эта структура **сров** доступна только для чтения; Клиенты должны создать копию этого файла, если необходимо внести изменения. Для создания копии можно использовать функцию [скдуппропсет](scduppropset.md) . 
    
## <a name="remarks"></a>Примечания

Структура **уведомления\_таблицы** — это один из элементов объединения структур, включенных в элемент **info** структуры [уведомления](notification.md) . Элемент **info** включает структуру **уведомления таблицы\_** , если элемент **улевенттипе** структуры имеет значение _фневтаблемодифиед_.
  
Порядок и тип столбцов в элементе Row отражают порядок и тип, которые действовали на момент создания уведомления. Порядок и тип в момент создания уведомления не обязательно совпадают с моментом доставки уведомления. 
  
Дополнительные сведения об уведомлении можно найти в разделах, приведенных в следующей таблице.
  
|**Статья**|**Описание**|
|:-----|:-----|
|[Уведомление о событии в MAPI](event-notification-in-mapi.md) <br/> |Общие сведения о событиях уведомлений и уведомлений.  <br/> |
|[Обработка уведомлений](handling-notifications.md) <br/> |Обсуждение того, как клиенты должны обрабатывать уведомления.  <br/> |
|[Поддержка уведомлений о событиях](supporting-event-notification.md) <br/> |Обсуждение того, как поставщики услуг могут использовать метод **имаписуппорт** для создания уведомлений.  <br/> |
   
Так как уведомления таблиц асинхронны, клиенты могут получать уведомления о добавленной строке после изучения других средств. Возможно получение TABLE_ERROR события при возникновении ошибки в методе **IMAPITable:: Sort**, **IMAPITable:: restricting**или **IMAPITable:: метода SetColumns** , или когда базовый процесс пытается обновить таблицу, например, новые или измененные строки. 
  
## <a name="see-also"></a>См. также

- [�����������](notification.md) 
- [ScDupPropset](scduppropset.md)
- [SRow](srow.md)
- [SPropValue](spropvalue.md)
- [Структуры MAPI](mapi-structures.md)


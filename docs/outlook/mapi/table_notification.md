---
title: TABLE_NOTIFICATION
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.TABLE_NOTIFICATION
api_type:
- COM
ms.assetid: 48e478c4-6e9a-40ab-a7bb-e6219b743b08
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 6c35220529fb88b470c563a0b004bfcf7e63ef76
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415959"
---
# <a name="table_notification"></a>TABLE_NOTIFICATION

**Область применения**: Outlook 2013 | Outlook 2016 
  
Описывает строку в таблице, на которую повлияло какое-либо событие, например изменение или ошибка. Это приводит к сгенерированию уведомления таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapidefs.h  <br/> |
   
```cpp
typedef struct _TABLE_NOTIFICATION
{
  ULONG ulTableEvent;
  HRESULT hResult;
  SPropValue propIndex;
  SPropValue propPrior;
  SRow row;
} TABLE_NOTIFICATION;

```

## <a name="members"></a>"Участники"

**ulTableEvent**
  
> Bitmask флагов, используемых для представления типа события таблицы. Можно установить следующие флаги:
    
TABLE_CHANGED 
  
> Указывает на высоком уровне, что что-то в таблице изменилось. Состояние таблицы так же, как и до события. Это означает, **что все свойства PR_INSTANCE_KEY** [(PidTagInstanceKey),](pidtaginstancekey-canonical-property.md)закладки, текущее позиционирование и выбор пользовательского интерфейса по-прежнему действительны. Обработать это событие, перечитав таблицу. Поставщики услуг, которые не хотят внедрять уведомления с богатой таблицей, отправляют TABLE_CHANGED события, а не более подробные события, чтобы указать определенный тип изменений. 
    
TABLE_ERROR 
  
> Ошибка произошла, как правило, во время обработки асинхронной операции. Ошибки при обработке следующих методов могут создавать это событие: 
    
   - [IMAPITable::SortTable](imapitable-sorttable.md)
    
   - [IMAPITable::SetColumns](imapitable-setcolumns.md)
    
   - [IMAPITable::Restrict](imapitable-restrict.md)
    
   После получения события TABLE_ERROR клиент не может полагаться на точность содержимого таблицы. Кроме того, могут быть потеряны ожидающих уведомлений о других изменениях. Метод [IMAPITable::GetLastError](imapitable-getlasterror.md) может не предоставлять дополнительные сведения об ошибке, так как она была сгенерирована в какой-либо предыдущей точке, не обязательно из последнего вызова метода. 
    
TABLE_RELOAD 
  
> Данные в таблице должны быть перезагружены. Поставщики услуг отправляют TABLE_RELOAD, когда, например, в базе данных хранятся данные, а база данных заменяется. Справься с этим событием, если предположить, что ничего не имеется в таблице, и перечитыв таблицу. Все закладки, ключи экземпляра, сведения о состоянии и позиционировании являются недействительными.
    
TABLE_RESTRICT_DONE 
  
> Операция ограничения, начатая с помощью **вызова метода IMAPITable::Restrict,** завершена. 
    
TABLE_ROW_ADDED 
  
> В таблицу добавлена новая строка и сохранен соответствующий объект. TABLE_ROW_ADDED события создаются после вызова метода [IMAPIProp::SaveChanges.](imapiprop-savechanges.md) 
    
TABLE_ROW_DELETED 
  
> Строка удалена из таблицы. Для **участника propPrior** установлено NULL. 
    
TABLE_ROW_MODIFIED 
  
> Строка изменена. Член **строки** содержит затронутые свойства строки. Несколько TABLE_ROW_MODIFIED отправляются в том порядке, в который они отображаются в представлении таблицы. 
    
  TABLE_ROW_MODIFIED события отправляются после внесения изменений в соответствующий объект с вызовом метода **IMAPIProp::SaveChanges.** Если измененная строка теперь является первой строкой в таблице, значение тега свойства в **члене** **propPrior** PR_NULL [(PidTagNull).](pidtagnull-canonical-property.md)
    
TABLE_SETCOL_DONE 
  
> Операция настройки столбцов, начатая с помощью **вызова метода IMAPITable::SetColumns,** завершена. 
    
TABLE_SORT_DONE 
  
> Операция сортировки таблиц, начатая с помощью **вызова метода IMAPITable::SortTable,** завершена. 
    
**hResult**
  
> Значение HRESULT для ошибки, которая произошла, если для члена **ulTableEvent** установлено значение TABLE_ERROR. 
    
**propIndex**
  
> [Структура SPropValue](spropvalue.md) для **PR_INSTANCE_KEY** свойства затронутой строки. 
    
**propPrior**
  
> **Структура SPropValue** для **PR_INSTANCE_KEY** свойства строки перед затрагиваемой. Если затрагиваемая строка является первой строкой в  таблице, **propPrior** должен быть PR_NULL ноль. Zero — это не допустимый тег свойства. 
    
**строка**
  
> [Структура SRow](srow.md) с описанием затронутой строки. Эта структура заполняется для всех событий уведомлений таблицы. Для событий уведомлений таблицы, которые не передают данные строки, для **члена cValues** структуры **SRow** установлено значение нуля, а для **участника lpProps** — значение NULL. Так как **эта структура SRow** является только для чтения; клиенты должны сделать его копию, если они хотят внести изменения. Для копирования можно использовать функцию [ScDupPropset.](scduppropset.md) 
    
## <a name="remarks"></a>Примечания

Структура **\_ УВЕДОМЛЕНий TABLE** является одним из членов объединения структур, включенных в состав **информационного** члена [структуры NOTIFICATION.](notification.md) Член **info** включает структуру **УВЕДОМЛЕНий \_ TABLE,** когда член **ulEventType** структуры задан  _для fnevTableModified_.
  
Порядок и тип столбцов в члене строки отражают порядок и тип, которые были в действительности во время получения уведомления. Порядок и тип на момент получения уведомления необязательно совпадают с моментом доставки уведомления. 
  
Дополнительные сведения об уведомлении см. в следующей таблице.
  
|**Статья**|**Описание**|
|:-----|:-----|
|[Уведомление о событиях в MAPI](event-notification-in-mapi.md) <br/> |Общий обзор событий уведомлений и уведомлений.  <br/> |
|[Обработка уведомлений](handling-notifications.md) <br/> |Обсуждение того, как клиенты должны обрабатывать уведомления.  <br/> |
|[Поддержка уведомления о событиях](supporting-event-notification.md) <br/> |Обсуждение того, как поставщики услуг могут использовать **метод IMAPISupport** для создания уведомлений.  <br/> |
   
Так как уведомления таблицы асинхронны, клиенты могут получать уведомления о добавленной строке после получения информации о добавлении другими средствами. Можно получить событие TABLE_ERROR при ошибке в **IMAPITable::Sort,** **IMAPITable::Restrict** или **методе IMAPITable::SetColumns** или при попытке обновить таблицу с помощью, например, новых или измененных строк. 
  
## <a name="see-also"></a>См. также

- [�����������](notification.md) 
- [ScDupPropset](scduppropset.md)
- [SRow](srow.md)
- [SPropValue](spropvalue.md)
- [Структуры MAPI](mapi-structures.md)


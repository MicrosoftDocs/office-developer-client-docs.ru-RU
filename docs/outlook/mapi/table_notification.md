---
title: TABLE_NOTIFICATION
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.TABLE_NOTIFICATION
api_type:
- COM
ms.assetid: 48e478c4-6e9a-40ab-a7bb-e6219b743b08
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 6c35220529fb88b470c563a0b004bfcf7e63ef76
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415959"
---
# <a name="table_notification"></a>TABLE_NOTIFICATION

**Относится к**: Outlook 2013 | Outlook 2016 
  
Описывает строку в таблице, на которую влияет событие определенного типа, например изменение или ошибка. Это приводит к сгенерированию уведомления таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapidefs.h  <br/> |
   
```cpp
typedef struct _TABLE_NOTIFICATION
{
  ULONG ulTableEvent;
  HRESULT hResult;
  SPropValue propIndex;
  SPropValue propPrior;
  SRow row;
} TABLE_NOTIFICATION;

```

## <a name="members"></a>"Участники"

**ulTableEvent**
  
> Битоваяmas флагов, используемых для представления типа события таблицы. Можно установить следующие флаги:
    
TABLE_CHANGED 
  
> На высоком уровне показывает, что что-то в таблице изменилось. Состояние таблицы находится в том же состоянии, что и до события. Это означает, **что все** PR_INSTANCE_KEY [(PidTagInstanceKey)](pidtaginstancekey-canonical-property.md)свойства, закладки, текущее позиционирование и выбор пользовательского интерфейса остаются действительными. Обработать это событие, перечитав таблицу. Поставщики услуг, которые не хотят внедрять уведомления с TABLE_CHANGED таблиц, отправляют события TABLE_CHANGED, а не более подробные события, чтобы указать определенный тип изменений. 
    
TABLE_ERROR 
  
> Произошла ошибка, обычно во время обработки асинхронной операции. Ошибки во время обработки следующих методов могут привести к этому событию: 
    
   - [IMAPITable::SortTable](imapitable-sorttable.md)
    
   - [IMAPITable::SetColumns](imapitable-setcolumns.md)
    
   - [IMAPITable::Restrict](imapitable-restrict.md)
    
   После получения события TABLE_ERROR клиент не может полагаться на точность содержимого таблицы. Кроме того, могут быть потеряны ожидающих уведомлений о других изменениях. Метод [IMAPITable::GetLastError](imapitable-getlasterror.md) может не предоставлять дополнительные сведения об ошибке, так как она была сгенерирована в какой-либо предыдущей точке, не обязательно из последнего вызова метода. 
    
TABLE_RELOAD 
  
> Данные в таблице должны быть перезагружены. Поставщики услуг отправляют TABLE_RELOAD, например, когда базовая база данных хранится в базе данных и заменяется базой данных. Обработать это событие, предполагая, что ничего о таблице по-прежнему не является допустимым, и перечитав таблицу. Все закладки, ключи экземпляров, сведения о состоянии и положении недопустимы.
    
TABLE_RESTRICT_DONE 
  
> Операция ограничения, инициированная вызовом метода **IMAPITable::Restrict,** завершена. 
    
TABLE_ROW_ADDED 
  
> В таблицу добавлена новая строка и сохранен соответствующий объект. TABLE_ROW_ADDED события создаются после вызова метода [IMAPIProp::SaveChanges.](imapiprop-savechanges.md) 
    
TABLE_ROW_DELETED 
  
> Строка удалена из таблицы. Для **члена propPrior** установлено nULL. 
    
TABLE_ROW_MODIFIED 
  
> Строка была изменена. Член **строки** содержит затронутые свойства для строки. Несколько TABLE_ROW_MODIFIED отправляются в том порядке, в который они отображаются в представлении таблицы. 
    
  TABLE_ROW_MODIFIED события отправляются после внесения изменений в соответствующий объект с помощью вызова метода **IMAPIProp::SaveChanges.** Если измененная строка теперь является первой строкой в таблице, значение тега свойства в члене **propPrior** PR_NULL **(** [PidTagNull).](pidtagnull-canonical-property.md)
    
TABLE_SETCOL_DONE 
  
> Операция настройки столбца, инициированная вызовом метода **IMAPITable::SetColumns,** завершена. 
    
TABLE_SORT_DONE 
  
> Операция сортировки таблиц, инициированная вызовом метода **IMAPITable::SortTable,** завершена. 
    
**hResult**
  
> Значение HRESULT возникской ошибки, если для члена **ulTableEvent** установлено значение TABLE_ERROR. 
    
**propIndex**
  
> [Структура SPropValue](spropvalue.md) **для** PR_INSTANCE_KEY свойства затронутой строки. 
    
**propPrior**
  
> **Структура SPropValue** для **PR_INSTANCE_KEY** строки до затронутого. Если затронутая строка является первой строкой в таблице, **для propPrior** необходимо установить значение **PR_NULL** ноль. Ноль не является допустимым тегом свойства. 
    
**row**
  
> [Структура SRow,](srow.md) описывающие затронутую строку. Эта структура заполняется для всех событий уведомлений таблицы. Для событий уведомлений таблицы, которые не передают данные строки, для члена **cValues** структуры **SRow** устанавливается нулевое значение, а для члена **lpProps** — значение NULL. Поскольку эта **структура SRow** является только для чтения; клиенты должны сделать ее копию, если они хотят внести изменения. Для копирования можно использовать функцию [ScDupPropset.](scduppropset.md) 
    
## <a name="remarks"></a>Примечания

Структура **TABLE \_ NOTIFICATION** — это один из членов объединения структур, включенных в состав данных структуры [NOTIFICATION.](notification.md)  Член **info** включает структуру **TABLE \_ NOTIFICATION,** когда для члена **ulEventType** структуры установлено в  _fnevTableModified_.
  
Порядок и тип столбцов в члене строки отражают порядок и тип, которые вступили в силу на момент получения уведомления. Порядок и тип уведомления не обязательно совпадают с порядком и типом на момент его доставки. 
  
Дополнительные сведения об уведомлении см. в темах, описанных в следующей таблице.
  
|**Статья**|**Описание**|
|:-----|:-----|
|[Уведомление о событии в MAPI](event-notification-in-mapi.md) <br/> |Общий обзор событий уведомлений и уведомлений.  <br/> |
|[Обработка уведомлений](handling-notifications.md) <br/> |Обсуждение того, как клиенты должны обрабатывать уведомления.  <br/> |
|[Поддержка уведомлений о событиях](supporting-event-notification.md) <br/> |Обсуждение того, как поставщики служб могут использовать метод **IMAPISupport** для создания уведомлений.  <br/> |
   
Так как уведомления таблиц являются асинхронными, клиенты могут получать уведомления о добавленной строке после изучения добавления другими способами. Можно получить событие TABLE_ERROR при ошибке в методе **IMAPITable::Sort,** **IMAPITable::Restrict** или **IMAPITable::SetColumns** или при попытке обновления таблицы с помощью, например, новых или измененных строк. 
  
## <a name="see-also"></a>См. также

- [�����������](notification.md) 
- [ScDupPropset](scduppropset.md)
- [SRow](srow.md)
- [SPropValue](spropvalue.md)
- [Структуры MAPI](mapi-structures.md)


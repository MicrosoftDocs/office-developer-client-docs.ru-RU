---
title: Имаписуппортрегистерпрепроцессор
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.RegisterPreprocessor
api_type:
- COM
ms.assetid: 9b5659ab-2b49-41ab-92ce-ca343e35d670
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 58215de6cc4e9e68386f8f017839752acc6e1753
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404899"
---
# <a name="imapisupportregisterpreprocessor"></a>IMAPISupport::RegisterPreprocessor

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Регистрирует функцию препроцессора поставщика транспорта (функцию, которая соответствует прототипу [препроцессмессаже](preprocessmessage.md) ). 
  
```cpp
HRESULT RegisterPreprocessor(
LPMAPIUID lpMuid,
LPSTR lpszAdrType,
LPSTR lpszDLLName,
LPSTR lpszPreprocess,
LPSTR lpszRemovePreprocessInfo,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпмуид_
  
> возврата Указатель на структуру [мапиуид](mapiuid.md) , которая содержит идентификатор, который обрабатывает функция препроцессора. Параметр _лпмуид_ может иметь значение null. 
    
 _Лпсзадртипе_
  
> возврата Указатель на тип адреса для сообщений, с которыми работает функция, например FAX, SMTP или X500. Параметр _лпсзадртипе_ может иметь значение null. 
    
 _Лпсздллнаме_
  
> возврата Указатель на имя библиотеки динамической компоновки (DLL), которая содержит точку входа для функции предварительной обработки.
    
 _Лпсзпрепроцесс_
  
> возврата Указатель на имя функции препроцессора. Параметр _лпсзпрепроцесс_ может иметь значение null. 
    
 _Лпсзремовепрепроцессинфо_
  
> возврата Указатель на имя функции, которая удаляет сведения о препроцессоре (функция, которая соответствует прототипу [ремовепрепроцессинфо](removepreprocessinfo.md) ). Параметр _лпсзремовепрепроцессинфо_ может иметь значение null. 
    
 _ulFlags_
  
> Резервирования должно быть равно нулю.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Функция предварительной обработки была успешно зарегистрирована.
    
## <a name="remarks"></a>Примечания

Метод **имаписуппорт:: регистерпрепроцессор** реализован только для объектов поддержки транспортного поставщика. Поставщики транспорта вызывают **регистерпрепроцессор** для регистрации функции препроцессора (функции, которая соответствует прототипу [препроцессмессаже](preprocessmessage.md) ). Функция предварительной обработки должна быть зарегистрирована, прежде чем диспетчер очереди MAPI сможет ее вызвать. 
  
Параметры _лпсзпрепроцесс_, _лпсзремовепрепроцессинфо_и _лпсздллнаме_ должны указывать на строки, которые можно использовать в сочетании с вызовами функции Win32 **GetProcAddress** , разрешая DLL препроцессора точка входа, вызываемая правильно. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вызовы предварительных процессоров относятся к порядку поставщика транспорта. Это означает, что если поставщик транспорта готов к обработке сообщения, функция препроцессора не будет вызываться для этого сообщения. Функция препроцессора будет вызываться только для тех сообщений, которые будут обрабатываться.
  
Вы можете написать функции препроцессора для обработки определенного идентификатора, хранящегося в структуре [мапиуид](mapiuid.md) , или типе адреса. Если указать и структуру **мапиуид** в параметре _лпмуид_ , и тип адреса в параметре _лпсзадртипе_ , то функция будет вызываться для получателей сообщений, которые совпадают с **мапиуид** или типом адреса. Если _лпмуид_ имеет значение null, а _лпсзадртипе_ имеет значение, отличное от NULL, то функция будет вызываться только для тех получателей, адрес которых соответствует типу, на который указывает _лпсзадртипе_. Если _лпмуид_ не имеет значение NULL и _ЛПСЗАДРТИПЕ_ имеет значение null, функция будет вызываться для получателей, которые совпадают с **мапиуид**, независимо от их типа адреса. Если оба значения равны NULL, функция вызывается для всех получателей сообщения.
  
## <a name="see-also"></a>См. также



[MAPIUID](mapiuid.md)
  
[PreprocessMessage](preprocessmessage.md)
  
[RemovePreprocessInfo](removepreprocessinfo.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


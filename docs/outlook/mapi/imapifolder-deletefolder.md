---
title: Имапифолдерделетефолдер
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.DeleteFolder
api_type:
- COM
ms.assetid: 6c3e883c-80c0-4eda-8f81-8277d933a74b
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a476607927f3563ede94a04ccfe4f7a3749c978e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33417408"
---
# <a name="imapifolderdeletefolder"></a>IMAPIFolder::DeleteFolder

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Удаляет вложенную папку.
  
```cpp
HRESULT DeleteFolder(
  ULONG_PTR cbEntryID,
  LPENTRYID lpEntryID,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Кбентрид_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _Лпентрид_
  
> возврата Указатель на идентификатор записи подпапки, которую требуется удалить.
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения. Параметр _улуипарам_ игнорируется, если не установлен флаг фолдер_диалог в параметре _ulFlags_ . 
    
 _Лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_переДАЕТСЯ значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации объекта Progress для MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг Фолдер_диалог в _ulFlags_.
    
 _ulFlags_
  
> возврата Битовая маска флагов, управляющих удалением вложенной папки. Можно задать следующие флаги:
    
ДЕЛ_ФОЛДЕРС 
  
> Все подпапки вложенной папки, на которую указывает _лпентрид_ , следует удалить. 
    
ДЕЛ_МЕССАЖЕС 
  
> Все сообщения в вложенной папке, на которые указывает _лпентрид_ , должны быть удалены. 
    
ФОЛДЕР_ДИАЛОГ 
  
> Во время выполнения операции должен отобразиться индикатор хода выполнения.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Указанная папка успешно удалена.
    
МАПИ_Е_ХАС_ФОЛДЕРС 
  
> Удаляемая вложенная папка содержит вложенные папки, а флаг ДЕЛ_ФОЛДЕРС не установлен. Вложенные папки не были удалены.
    
МАПИ_Е_ХАС_МЕССАЖЕС 
  
> Удаляемая вложенная папка содержит сообщения, а флаг ДЕЛ_МЕССАЖЕС не установлен. Вложенная папка не была удалена.
    
МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН 
  
> Вызов выполнен успешно, но не все записи были успешно удалены. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder::D елетефолдер** удаляет вложенную папку. По умолчанию **DeleteFolder** работает только с пустыми папками, но его можно успешно использовать в непустых папках, задав два флага: ДЕЛ_ФОЛДЕРС и дел_мессажес. Можно удалить только пустые папки и папки, которые задают флаги ДЕЛ_ФОЛДЕРС и ДЕЛ_МЕССАЖЕС в вызове **DeleteFolder** . ДЕЛ_ФОЛДЕРС позволяет удалять все подпапки папки; ДЕЛ_МЕССАЖЕС позволяет удалять все сообщения из папки. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если операция удаления включает несколько папок, выполните операцию как можно скорее для каждой папки. Иногда одна из папок, которую необходимо удалить, не существует или была перемещена или скопирована в другом месте. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**DeleteFolder** успешно удалил все сообщения и вложенную папку.  <br/> |S_OK  <br/> |
|**DeleteFolder** не удалось удалить все сообщения и вложенную папку.  <br/> |МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН или МАПИ_Е_НОТ_ФАУНД  <br/> |
|**DeleteFolder** не удалось выполнить.  <br/> |Любое значение ошибки, кроме МАПИ_Е_НОТ_ФАУНД  <br/> |
   
Если **DeleteFolder** не удается выполнить, не следует предполагать, что работа не выполнялась. Возможно, в **DeleteFolder** удалось удалить одно или несколько сообщений и вложенных папок, прежде чем возникнет ошибка. 
  
Если не удается удалить одну или несколько вложенных папок, **DeleteFolder** возвращает МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН или мапи_е_нот_фаунд в зависимости от реализации поставщика хранилища сообщений. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мсгсторедлг. cpp  <br/> |Кмсгсторедлг:: Онделетеселектедитем  <br/> |MFCMAPI использует метод **IMAPIFolder::D елетефолдер** для удаления папок.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: Получение сообщений с использованием настраиваемой обработки вложений TNEF
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bb5082fa-8fe3-46fe-b2de-b6dd1af79ea7
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 046b537d41b318fa857ef77f1906edcf2c3aa2bf
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429322"
---
# <a name="receiving-messages-by-using-tnef-custom-attachment-processing"></a>Получение сообщений с использованием настраиваемой обработки вложений TNEF

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Чтобы получить сообщение в формате TNEF с настраиваемой обработкой вложений:
  
1. Импортируйте все переданные свойства, которые поддерживаются системой обмена сообщениями — из входящего сообщения в новое сообщение MAPI. Сюда входит текст сообщения, который содержит поток данных TNEF.
    
2. Определите и декодировать специальное вложение, содержащее поток TNEF.
    
3. Извлечение всех вложений из входящего сообщения в вложения MAPI в новом сообщении MAPI. Восстановленные имена файлов или другие идентифицирующие маркеры для вложений следует поместить в свойство **PR_ATTACH_TRANSPORT_NAME** ([PidTagAttachTransportName](pidtagattachtransportname-canonical-property.md)) новых вложений, чтобы метод [итнеф:: екстрактпропс](itnef-extractprops.md) мог сопоставить правильное вложение с тегами вложений, закодированными в тексте сообщения. 
    
4. Создайте интерфейс OLE **IStream** , который обходит Раскодированный поток TNEF и использует этот объект вместе с новым сообщением MAPI при вызове функции [опентнефстреамекс](opentnefstreamex.md) . 
    
5. Вызовите метод **итнеф:: екстрактпропс** для восстановления подходящих свойств сообщения из потока данных TNEF. 
    
6. Вызовите метод [итнеф:: опентагжедбоди](itnef-opentaggedbody.md) с установленными флагами MAPI_CREATE и MAPI_MODIFY. Этот вызов Удаляет теги вложений из текста сообщения и преобразует их в сведения о расположении вложения в сообщении MAPI. 
    
7. Доставьте сообщение через диспетчер очереди MAPI.
    


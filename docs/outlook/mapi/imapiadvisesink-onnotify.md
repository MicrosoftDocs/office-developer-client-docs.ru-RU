---
title: Имапиадвисесинконнотифи
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIAdviseSink.OnNotify
api_type:
- COM
ms.assetid: 9eec90d3-2369-4340-86ed-0efa58918ed5
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5983ed3229f6b0053f15a614116cf5680e942587
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32351445"
---
# <a name="imapiadvisesinkonnotify"></a>IMAPIAdviseSink::OnNotify

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Реагирует на уведомление, выполняя одну или несколько задач. Выполняемые задачи зависят от типа события и объекта, который создает уведомление. 
  
```cpp
ULONG OnNotify(
  ULONG cNotif,
  LPNOTIFICATION lpNotifications
);
```

## <a name="parameters"></a>Параметры

 _Кнотиф_
  
> возврата Количество структур [уведомлений](notification.md) , на которые указывает параметр _лпнотификатионс_ . 
    
 _Лпнотификатионс_
  
> возврата Указатель на одну или несколько структур **уведомлений** , которые предоставляют сведения о произошедших событиях. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Уведомление успешно обработано.
    
## <a name="remarks"></a>Примечания

Процесс уведомления начинается с того, что клиент или MAPI вызывает метод **advise** поставщика услуг для регистрации, чтобы получить уведомление о конкретном типе для определенного объекта. Один из параметров метода **advise** является указателем на объект приемника уведомлений, который реализует интерфейс [имапиадвисесинк](imapiadvisesinkiunknown.md) . При возникновении события в целевом объекте, соответствующем зарегистрированному уведомлению, поставщик услуг напрямую или косвенно через MAPI вызывает метод onNotify приемника уведомлений **** . 
  
Вызов onNotify **** может выполняться во время вызова MAPI, который вызывает событие или позже. В системах, поддерживающих несколько потоков выполнения, **OnNotify** можно вызывать либо в том же потоке, который использовался для регистрации, либо в другом потоке. Клиенты могут убедиться в том, **** что вызов OnNotify выполняется в том же потоке, который используется для вызова **advise** , создавая приемник уведомлений, который передается в предложение **advise** с помощью функции [хрсиссреададвисесинк](hrthisthreadadvisesink.md) . 
  
Параметр _лпнотификатионс_ указывает на одну или несколько структур **уведомлений** , описывающих, что было изменено во время события. Существует разный тип структуры **уведомлений** для каждого типа события. 
  
В следующей таблице приведены значения, которые используются для представления возможных типов событий и структур, связанных с каждым значением:
  
|**Тип события уведомления**|**Соответствующая структура**|
|:-----|:-----|
|**Фневкритикалеррор** <br/> |[ERROR_NOTIFICATION](error_notification.md) <br/> |
|**Фневневмаил** <br/> |[NEWMAIL_NOTIFICATION](newmail_notification.md) <br/> |
|**Фневобжекткреатед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**Фневобжектделетед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**Фневобжектмодифиед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**Фневобжекткопиед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**Фневсеарчкомплете** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**Фневтаблемодифиед** <br/> |[TABLE_NOTIFICATION](table_notification.md) <br/> |
|**Фневстатусобжектмодифиед** <br/> |[STATUS_OBJECT_NOTIFICATION](status_object_notification.md) <br/> |
|**Фневекстендед** <br/> |[EXTENDED_NOTIFICATION](extended_notification.md) <br/> |
   
Дополнительные сведения о том, как настроить и остановить уведомления, можно найти в справочных материалах по методам **advise** и **unadvise** для любого из следующих интерфейсов: [иаблогон](iablogoniunknown.md), [IAddrBook](iaddrbookimapiprop.md), [имапиформ](imapiformiunknown.md), [ IMAPISession](imapisessioniunknown.md), [IMAPITable](imapitableiunknown.md), [IMsgStore](imsgstoreimapiprop.md)и [имслогон](imslogoniunknown.md). 
  
Общие сведения о процессе уведомления содержатся [в разделе уведомление о событии в MAPI](event-notification-in-mapi.md). 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Реализация **OnNotify** , как правило, состоит из одного или нескольких блоков кода для каждого типа уведомлений, которые предполагается получить. В этих блоках кода выполните все задачи, которые необходимо учитывать в ответ на уведомление. Например, предположим, что вы регистрируетесь на получение уведомлений **фневобжектмодифиед** для папки, включенной в диалоговое окно. В блоке кода, который вы включаете в **** метод OnNotify для обработки уведомлений **фневобжектмодифиед** , вы можете отправить в диалоговое окно сообщение Windows, чтобы запросить обновленное отображение. 
  
Не изменяйте и не освобождайте структуру **уведомлений** , переданную в OnNotify. **** Данные в структуре действительны только до возврата **OnNotify** . 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При внесении изменений в несколько объектов вы можете уведомить зарегистрированный приемник уведомлений об отдельном вызове **OnNotify** или в нескольких вызовах в зависимости от ограничений памяти. Это справедливо независимо от того, являются ли изменения результатом одного вызова метода или нескольких. Например, вызов [IMAPIFolder:: копимессажес](imapifolder-copymessages.md) может повлиять на несколько сообщений и папок. Как поставщик хранилища сообщений можно выполнить один вызов функции onNotify с **** типом события **фневобжектмодифиед** для целевой папки или многих вызовов, по одному для каждого из сообщений. Аналогично, если клиент выполняет повторяющиеся вызовы [IMAPIFolder:: CreateMessage](imapifolder-createmessage.md), эти вызовы могут быть объединены в одно событие **фневобжектмодифиед** для папки или разделяются на отдельные события **фневобжекткреатед** для каждого нового сообщения. 
  
Дополнительные сведения о том, как и когда создавать уведомления, можно узнать [в статье уведомление о событии в MAPI](event-notification-in-mapi.md) и [уведомление о событии](supporting-event-notification.md). 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Адвисесинк. h и Адвисесинк. cpp  <br/> |Кадвисесинк:: Оннотифидеск  <br/> |Класс Кадвисесинк реализуется для обработки всех уведомлений в MFCMAPI.  <br/> |
   
## <a name="see-also"></a>См. также



[HrAllocAdviseSink](hrallocadvisesink.md)
  
[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)
  
[IMAPISupport::Notify](imapisupport-notify.md)
  
[�����������](notification.md)
  
[IMAPIAdviseSink : IUnknown](imapiadvisesinkiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


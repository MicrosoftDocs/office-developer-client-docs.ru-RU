---
title: Имсгсторежетрецеивефолдер
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMsgStore.GetReceiveFolder
api_type:
- COM
ms.assetid: ccd9d623-a3cb-4e66-9649-78c3887cb726
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: ab21dcfb9011b675e3db4e4df29cb6ecafa6e7c6
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435350"
---
# <a name="imsgstoregetreceivefolder"></a>IMsgStore::GetReceiveFolder

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Получает папку, которая была установлена в качестве назначения для входящих сообщений указанного класса сообщений или в качестве папки получения по умолчанию для хранилища сообщений.
  
```cpp
HRESULT GetReceiveFolder(
  LPSTR lpszMessageClass,
  ULONG ulFlags,
  ULONG FAR * lpcbEntryID,
  LPENTRYID FAR * lppEntryID,
  LPSTR FAR * lppszExplicitClass
);
```

## <a name="parameters"></a>Параметры

 _Лпсзмессажекласс_
  
> возврата Указатель на класс сообщений, связанный с папкой получения. Если для параметра _лпсзмессажекласс_ ЗАДАНО значение null или пустая строка, **жетрецеивефолдер** Возвращает папку получения по умолчанию для хранилища сообщений. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют типом переданных и возвращаемых строк. Можно задать следующий флаг:
    
MAPI_UNICODE 
  
> Строка класса сообщения в формате Юникод. Если флаг МАПИ_УНИКОДЕ не установлен, строка класса сообщения отображается в формате ANSI.
    
 _Лпкбентрид_
  
> вышли Указатель на число байтов в идентификаторе записи, на который указывает параметр _лппентрид_ . 
    
 _Лппентрид_
  
> вышли Указатель на указатель на идентификатор записи для запрошенной папки получения.
    
 _ЛппсзексплиЦиткласс_
  
> вышли Указатель на указатель на класс сообщений, который явно задается в качестве папки получения, в папку, на которую указывает _лппентрид_. Этот класс сообщений должен совпадать с классом в параметре _лпсзмессажекласс_ или базовым классом этого класса. ЗНАЧЕНИЕ NULL указывает на то, что папка, на которую указывает _лппентрид_ , является папкой получения по умолчанию для хранилища сообщений. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Папка получения успешно возвращена.
    
## <a name="remarks"></a>Примечания

Метод **IMsgStore:: жетрецеивефолдер** получает идентификатор записи для папки получения, папку, предназначенную для получения входящих сообщений определенного класса сообщений. Вызывающие абоненты могут указать класс сообщения или значение NULL в параметре _лпсзмессажекласс_ . Если _лпсзмессажекласс_ имеет значение null, **жетрецеивефолдер** возвращает следующие значения: 
  
- В _лппсзексплиЦиткласс_имя первого базового класса класса Message, на который указывает _лпсзмессажекласс_ , который явно задает папку получения. 
    
- В _лппентрид_— идентификатор записи для папки получения базового класса, на которую указывает параметр _лппсзексплиЦиткласс_ . 
    
Например, предположим, что папка "получение" класса сообщений **IPM. ЗаМетка** для идентификатора записи папки "Входящие" и **жетрецеивефолдер** вызывается с содержимым _лпсзмессажекласс_ , для которого задано значение **IPM. Note. Phone**. Если **IPM. Note. Phone** не имеет явного набора папок получения, **жетрецеивефолдер** возвращает идентификатор элемента папки "Входящие" в _лппентрид_ и **IPM. Примечание** в _лппсзексплиЦиткласс_.
  
Если клиент вызывает **жетрецеивефолдер** для класса сообщений и не настроил папку Receive для этого класса сообщений, _лппсзексплиЦиткласс_ — это строка нулевой длины, строка в формате Юникод или строка в формате ANSI, в зависимости от того, является ли Клиент устанавливает флаг МАПИ_УНИКОДЕ в параметре _ulFlags_ . 
  
Папка получения по умолчанию, полученная путем передачи значения NULL в параметре _лпсзмессажекласс_ , всегда существует для каждого хранилища сообщений. 
  
Клиент должен вызвать функцию [мапифрибуффер](mapifreebuffer.md) , когда она выполняется с идентификатором записи, возвращенным в _лппентрид_ , для освобождения памяти, содержащей идентификатор записи. Он также должен вызывать **мапифрибуффер** , когда он выполняется с помощью строки класса сообщений, возвращаемой в _лппсзексплиЦиткласс_ , для освобождения памяти, содержащей эту строку. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мапифунктионс. cpp  <br/> |Inbox  <br/> |MFCMAPI использует метод **IMsgStore:: жетрецеивефолдер** , чтобы перейти к папке "Входящие".  <br/> |
   
## <a name="see-also"></a>См. также



[MAPIFreeBuffer](mapifreebuffer.md)
  
[IMsgStore: IMAPIProp](imsgstoreimapiprop.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


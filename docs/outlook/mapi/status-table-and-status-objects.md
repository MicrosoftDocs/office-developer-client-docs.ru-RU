---
title: Объекты "таблица состояния" и "состояние"
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 203765c1-4b08-4032-a5bf-18f3e752a899
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3eb190069b43ea1960c3b6edf30a9e0b782d2c41
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336332"
---
# <a name="status-table-and-status-objects"></a>Объекты "таблица состояния" и "состояние"

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
MAPI предоставляет таблицу со сведениями о состоянии подсистемы MAPI, диспетчере почтовых ящиков MAPI, адресной книги или конкретного поставщика услуг. Доступ к этой таблице можно получить, вызвав [IMAPISession:: жетстатустабле](imapisession-getstatustable.md).
  
Каждая строка в таблице Status представляет объект состояния, реализованный MAPI или поставщиком услуг. Объект Status можно использовать для отображения страницы свойств конфигурации поставщика, для изменения пароля поставщика, отправки или скачивания сообщений, а также для связи с конкретным поставщиком транспорта. 
  
Получить доступ к объекту Status можно двумя способами:
  
- Через таблицу состояния
    
- С помощью метода **опенстатусентри** объекта logon 
    
Так как объекты входа недоступны для клиентов, для доступа к объектам состояния необходимо использовать таблицу состояние. Подход таблицы состояний является косвенным, требуется несколько вызовов перед открытием объекта status и указателем на возвращаемую реализацию **имапистатус** . 
  
 **Использование таблицы состояния для открытия объекта Status**
  
1. Call **имапистатус:: жетстатустабле** для получения указателя [IMAPITable](imapitableiunknown.md) . 
    
2. ВыЗовите для таблицы состояний метод [IMAPITable:: метода SetColumns](imapitable-setcolumns.md) , чтобы ограничить набор столбцов значением **пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **пр_ресаурце_типе** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) и **пр_дисплай_наме** ([ PidTagDisplayName](pidtagdisplayname-canonical-property.md)).
    
3. Ограничьте представление таблицы определенным объектом Status. Для реализации MAPI клиент может определить ограничение свойства с помощью **пр_ресаурце_типе**. Для реализации поставщиков услуг клиент может ограничить доступ к **пр_провидер_дисплай** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)), имени поставщика или **пр_провидер_длл_наме** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)), именем библиотеки DLL поставщика. файлу.
    
4. Call [IMAPITable:: restrict](imapitable-restrict.md) to set Restriction. 
    
5. ВыЗовите [хркуеряллровс](hrqueryallrows.md), передав структуру [спропертирестриктион](spropertyrestriction.md) , чтобы получить строку, представляющую состояние поставщика. 
    
6. Call [IMAPISession:: OpenEntry](imapisession-openentry.md), указывающий идентификатор записи из строки таблицы состояний, чтобы открыть объект status и получить указатель **имапистатус** . 
    
Чтобы отобразить страницу свойств, вызовите метод объекта Status [имапистатус:: сеттингсдиалог](imapistatus-settingsdialog.md) для целевого поставщика. **Сеттингсдиалог** отображает страницу свойств для просмотра и, в некоторых случаях, изменения свойств конфигурации поставщика. 
  
Для связи с поставщиком транспорта вызовите метод [имапистатус:: валидатестате](imapistatus-validatestate.md) объекта Status. **Валидатестате** может перенастроить поставщик транспорта, запретить поставщику отображать пользовательский интерфейс и управлять сеансом, включающим загрузку заголовков сообщений с удаленного сервера в зависимости от передаваемых флагов. Например, чтобы отменить загрузку удаленных заголовков, передайте флаг АБОРТ_КСП_ХЕАДЕР_ОПЕРАТИОН в **валидатестате**. Чтобы подключиться к удаленному серверу или отключиться от него, передайте ФОРЦЕ_КСП_КОННЕКТ или ФОРЦЕ_КСП_ДИСКОННЕКТ. Для повторной настройки поставщика передается КОНФИГ_ЧАНЖЕД. 
  
Клиенты, которые реализуют отправку или получение сообщений при вызове по требованию, можно получить поставщик транспорта или метод [имапистатус:: FlushQueues](imapistatus-flushqueues.md) очереди транспорта MAPI. В метод можно передать три флага: ФЛУШ_УПЛОАД, ФЛУШ_ДОВНЛОАД и ФЛУШ_ФОРЦЕ. ФЛУШ_УПЛОАД предписывает поставщику или диспетчеру MAPI отправку сообщений, ожидающих в очереди вывода, в то время как ФЛУШ_ДОВНЛОАД сообщает поставщику или диспетчеру MAPI о получении входящих сообщений. ФЛУШ_ФОРЦЕ можно задать с помощью любого из других флагов, чтобы объект Status выполнял сброс независимо от времени. 
  
Не предполагають возможность вызова **сеттингсдиалог** или [ChangePassword](imapistatus-changepassword.md) для любой из подсистем MAPI, диспетчера очереди MAPI и объектов состояния адресной книги. Объекты состояния подсистемы и адресной книги поддерживают только **валидатестате**; объект состояния очереди MAPI поддерживает **FlushQueues** в дополнение к **валидатестате**.
  
## <a name="see-also"></a>См. также



[Таблицы состояния](status-tables.md)
  
[Объекты состояния MAPI](mapi-status-objects.md)


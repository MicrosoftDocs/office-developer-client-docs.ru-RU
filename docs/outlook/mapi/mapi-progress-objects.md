---
title: Объекты хода выполнения MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3007aeb5ac3810c57ed6fb4a555d5ce22e831768
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809790"
---
# <a name="mapi-progress-objects"></a>Объекты хода выполнения MAPI

  
  
**Относится к**: Outlook 
  
Методы и данные о ходе выполнения объекта можно управлять как индикатора сообщает о ходе выполнения. Несмотря на то, что клиент или MAPI реализует объект ход выполнения, большая часть усилий по обеспечению правильности отображения хода выполнения попадает на поставщиков услуг. Можно гарантировать его точность путем указания произвольном порядке и значения для параметров, которые передаются в методы объекта хода выполнения.
  
Объекты о ходе выполнения передаются следующие параметры:
  
- Битовая маска флаги, заданные с [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) и извлечения с [IMAPIProgress::GetFlags](imapiprogress-getflags.md).
    
- Минимальное значение (локальных и глобальных) задайте с **SetLimits** и получены с [IMAPIProgress::GetMin](imapiprogress-getmin.md).
    
- Максимальное значение (локальных и глобальных) задайте с **SetLimits** и получены с [IMAPIProgress::GetMax](imapiprogress-getmax.md).
    
- Значение, указывающее текущий процент завершения операции, переданной в [IMAPIProgress::Progress](imapiprogress-progress.md).
    
- Количество объектов, которые на данный момент после обработки передаются **хода выполнения**.
    
- Счетчик общее число объектов, участвующих в данной операции, переданной в **хода выполнения**.
    
Все поставщики услуг приступить к их обработки с помощью вызова **IMAPIProgress::GetFlags** для извлечения флаги задан параметр отображения хода выполнения. На данный момент флаги можно задать только к MAPI_TOP_LEVEL. Клиенты и MAPI инициализировать флаг MAPI_TOP_LEVEL, использовании поставщиков служб снимите при необходимости. 
  
Флаги имеет значение MAPI_TOP_LEVEL при работе с объектом верхнего уровня в операции. Объект верхнего уровня — это объект, который будет вызываться клиентом для начала операции. В ходе операции копирования папки это папка копируются. В операции удаления папки это папка. При внесении вызов процесс нижнего уровня объекта или вложенные объекты, снимите флажок значение флагов. В операцию копирования папки вложенных объектов, вложенных папок, расположенных в папке копируются. 
  
MAPI позволяет отличать объектов верхнего уровня и вложенных с флагом MAPI_TOP_LEVEL, чтобы все объекты задействованных в рамках одной операции можно использовать ту же реализацию [IMAPIProgress](imapiprogressiunknown.md) для отображения хода выполнения, приводящую к Отображение индикаторов для четкое выполнение в одном положительное направлении. Ли MAPI_TOP_LEVEL настройка влияет на настройки других параметров в последующие запросы к объекту хода выполнения. 
  
Так как он может быть нестандартный для установки значений соответствующий параметр для отображения хода выполнения на всех уровнях многоуровневой операции, некоторые поставщики услуг отказаться от отобразить индикатор выполнения для вложенных объектов. 
  
 **Чтобы избежать выполнения для вложенных объектов**
  
- Передайте значение NULL для параметра _lpProgress_ в вызове для обработки вложенные объекты. Например при копировании папки это вызов метода [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) вложенной папке. 
    
- Писать специальный код для интерпретации параметр _lpProgress_ . Так как значение NULL для параметра _lpProgress_ можно также имели в виду, что клиент должны отображать ход выполнения с помощью реализации интерфейса MAPI, необходимо определить, когда требуется вызов [и когда следует ли игнорировать параметр _lpProgress_ специальный код IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).
    
Вызов **IMAPIProgress::SetLimits** установить или сбросить флаг MAPI_TOP_LEVEL и задавать локальных и глобальных минимального и максимального значения. Значение флагов, является ли параметр влияет на объекте хода выполнения понимает минимального и максимального значения для локальной или глобальной. Если для флага MAPI_TOP_LEVEL, эти значения считаются глобальные и используются для вычисления хода выполнения для всей операции. Объекты хода выполнения инициализации глобального минимальное значение 0 и глобальные максимальное значение до 1000. 
  
При MAPI_TOP_LEVEL не задано, минимального и максимального значения считаются локальной и используются во внутреннем поставщиков для отображения хода выполнения для вложенных нижнем уровне. Объекты хода выполнения сохраните локальные минимального и максимального значения только для того, чтобы они могут быть возвращены для поставщиков при вызове **GetMin** и **GetMax** . 
  
Значение, количество объектов и параметров общее объекта ввода в метод **IMAPIProgress::Progress** . Параметр значение, число, указывающее процент, является обязательным. Если значение флага MAPI_TOP_LEVEL, можно также передать число объектов и всего по объекту. Некоторые клиенты используют эти значения для отображения фразы, например «5 элементов завершен из десяти» с индикатором хода выполнения. Ход выполнения операции могут быть выявлены строго в процентном выражении или в процентном выражении и точки зрения количества элементов, которые были обработаны из общего обработки. К примеру для вы поставщика хранилища сообщений и перед выполнением операции копирования, копирование 10 папок, индикатор хода выполнения можно предоставить пользователю с дополнительной информации, отображая фразы, например «1 10», «2 10", «3 10" , и так далее до завершения операции. 
  
## <a name="see-also"></a>См. также



[Индикаторы выполнения MAPI](mapi-progress-indicators.md)


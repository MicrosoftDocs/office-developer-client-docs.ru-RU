---
title: Объекты хода выполнения MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3007aeb5ac3810c57ed6fb4a555d5ce22e831768
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809790"
---
# <a name="mapi-progress-objects"></a><span data-ttu-id="75b8a-103">Объекты хода выполнения MAPI</span><span class="sxs-lookup"><span data-stu-id="75b8a-103">MAPI Progress Objects</span></span>

  
  
<span data-ttu-id="75b8a-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="75b8a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="75b8a-105">Методы и данные о ходе выполнения объекта можно управлять как индикатора сообщает о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="75b8a-105">With the methods and data of a progress object, you can control how the indicator reports progress.</span></span> <span data-ttu-id="75b8a-106">Несмотря на то, что клиент или MAPI реализует объект ход выполнения, большая часть усилий по обеспечению правильности отображения хода выполнения попадает на поставщиков услуг.</span><span class="sxs-lookup"><span data-stu-id="75b8a-106">Although a client or MAPI implements the progress object, most of the burden of ensuring the correctness of the progress display falls on service providers.</span></span> <span data-ttu-id="75b8a-107">Можно гарантировать его точность путем указания произвольном порядке и значения для параметров, которые передаются в методы объекта хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="75b8a-107">You can guarantee its accuracy by specifying a particular order and value for the parameters that are passed to progress object methods.</span></span>
  
<span data-ttu-id="75b8a-108">Объекты о ходе выполнения передаются следующие параметры:</span><span class="sxs-lookup"><span data-stu-id="75b8a-108">The following parameters are passed to progress objects:</span></span>
  
- <span data-ttu-id="75b8a-109">Битовая маска флаги, заданные с [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) и извлечения с [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span><span class="sxs-lookup"><span data-stu-id="75b8a-109">A bitmask of flags, set with [IMAPIProgress::SetLimits](imapiprogress-setlimits.md) and retrieved with [IMAPIProgress::GetFlags](imapiprogress-getflags.md).</span></span>
    
- <span data-ttu-id="75b8a-110">Минимальное значение (локальных и глобальных) задайте с **SetLimits** и получены с [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span><span class="sxs-lookup"><span data-stu-id="75b8a-110">A minimum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMin](imapiprogress-getmin.md).</span></span>
    
- <span data-ttu-id="75b8a-111">Максимальное значение (локальных и глобальных) задайте с **SetLimits** и получены с [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span><span class="sxs-lookup"><span data-stu-id="75b8a-111">A maximum value (local and global), set with **SetLimits** and retrieved with [IMAPIProgress::GetMax](imapiprogress-getmax.md).</span></span>
    
- <span data-ttu-id="75b8a-112">Значение, указывающее текущий процент завершения операции, переданной в [IMAPIProgress::Progress](imapiprogress-progress.md).</span><span class="sxs-lookup"><span data-stu-id="75b8a-112">A value that indicates the current percentage of completion of the operation, passed to [IMAPIProgress::Progress](imapiprogress-progress.md).</span></span>
    
- <span data-ttu-id="75b8a-113">Количество объектов, которые на данный момент после обработки передаются **хода выполнения**.</span><span class="sxs-lookup"><span data-stu-id="75b8a-113">A count of the number of objects that have so far been processed, passed to **Progress**.</span></span>
    
- <span data-ttu-id="75b8a-114">Счетчик общее число объектов, участвующих в данной операции, переданной в **хода выполнения**.</span><span class="sxs-lookup"><span data-stu-id="75b8a-114">A count of the total number of objects involved in the operation, passed to **Progress**.</span></span>
    
<span data-ttu-id="75b8a-115">Все поставщики услуг приступить к их обработки с помощью вызова **IMAPIProgress::GetFlags** для извлечения флаги задан параметр отображения хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="75b8a-115">All service providers begin their progress display processing with a call to **IMAPIProgress::GetFlags** to retrieve the present flags setting.</span></span> <span data-ttu-id="75b8a-116">На данный момент флаги можно задать только к MAPI_TOP_LEVEL.</span><span class="sxs-lookup"><span data-stu-id="75b8a-116">Currently, the flags can be set only to MAPI_TOP_LEVEL.</span></span> <span data-ttu-id="75b8a-117">Клиенты и MAPI инициализировать флаг MAPI_TOP_LEVEL, использовании поставщиков служб снимите при необходимости.</span><span class="sxs-lookup"><span data-stu-id="75b8a-117">Clients and MAPI initialize the flag to MAPI_TOP_LEVEL, relying on service providers to clear it when appropriate.</span></span> 
  
<span data-ttu-id="75b8a-118">Флаги имеет значение MAPI_TOP_LEVEL при работе с объектом верхнего уровня в операции.</span><span class="sxs-lookup"><span data-stu-id="75b8a-118">The flags value is set to MAPI_TOP_LEVEL while you are working with the top-level object in the operation.</span></span> <span data-ttu-id="75b8a-119">Объект верхнего уровня — это объект, который будет вызываться клиентом для начала операции.</span><span class="sxs-lookup"><span data-stu-id="75b8a-119">The top-level object is the object that is called by the client to begin an operation.</span></span> <span data-ttu-id="75b8a-120">В ходе операции копирования папки это папка копируются.</span><span class="sxs-lookup"><span data-stu-id="75b8a-120">In a folder copy operation, this is the folder being copied.</span></span> <span data-ttu-id="75b8a-121">В операции удаления папки это папка.</span><span class="sxs-lookup"><span data-stu-id="75b8a-121">In a folder delete operation, this is the folder being deleted.</span></span> <span data-ttu-id="75b8a-122">При внесении вызов процесс нижнего уровня объекта или вложенные объекты, снимите флажок значение флагов.</span><span class="sxs-lookup"><span data-stu-id="75b8a-122">When you make a call to process a lower level object, or subobject, clear the flags value.</span></span> <span data-ttu-id="75b8a-123">В операцию копирования папки вложенных объектов, вложенных папок, расположенных в папке копируются.</span><span class="sxs-lookup"><span data-stu-id="75b8a-123">In a folder copy operation, subobjects are the subfolders that are in the folder being copied.</span></span> 
  
<span data-ttu-id="75b8a-124">MAPI позволяет отличать объектов верхнего уровня и вложенных с флагом MAPI_TOP_LEVEL, чтобы все объекты задействованных в рамках одной операции можно использовать ту же реализацию [IMAPIProgress](imapiprogressiunknown.md) для отображения хода выполнения, приводящую к Отображение индикаторов для четкое выполнение в одном положительное направлении.</span><span class="sxs-lookup"><span data-stu-id="75b8a-124">MAPI allows you to differentiate between top-level objects and subobjects with the MAPI_TOP_LEVEL flag so that all objects involved in an operation can use the same [IMAPIProgress](imapiprogressiunknown.md) implementation to show progress, thereby causing the indicator display to proceed smoothly in a single positive direction.</span></span> <span data-ttu-id="75b8a-125">Ли MAPI_TOP_LEVEL настройка влияет на настройки других параметров в последующие запросы к объекту хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="75b8a-125">Whether or not the MAPI_TOP_LEVEL flag is set affects the settings of the other parameters in subsequent calls to the progress object.</span></span> 
  
<span data-ttu-id="75b8a-126">Так как он может быть нестандартный для установки значений соответствующий параметр для отображения хода выполнения на всех уровнях многоуровневой операции, некоторые поставщики услуг отказаться от отобразить индикатор выполнения для вложенных объектов.</span><span class="sxs-lookup"><span data-stu-id="75b8a-126">Because it can be nontrivial to set appropriate parameter values for a progress display at all levels of a multilevel operation, some service providers elect not to show progress for subobjects.</span></span> 
  
 <span data-ttu-id="75b8a-127">**Чтобы избежать выполнения для вложенных объектов**</span><span class="sxs-lookup"><span data-stu-id="75b8a-127">**To avoid showing progress for subobjects**</span></span>
  
- <span data-ttu-id="75b8a-128">Передайте значение NULL для параметра _lpProgress_ в вызове для обработки вложенные объекты.</span><span class="sxs-lookup"><span data-stu-id="75b8a-128">Pass NULL for the  _lpProgress_ parameter in the call to process a subobject.</span></span> <span data-ttu-id="75b8a-129">Например при копировании папки это вызов метода [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) вложенной папке.</span><span class="sxs-lookup"><span data-stu-id="75b8a-129">For example, if you are copying folders, this is the call to a subfolder's [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md) method.</span></span> 
    
- <span data-ttu-id="75b8a-130">Писать специальный код для интерпретации параметр _lpProgress_ .</span><span class="sxs-lookup"><span data-stu-id="75b8a-130">Write special code to determine how to interpret the  _lpProgress_ parameter.</span></span> <span data-ttu-id="75b8a-131">Так как значение NULL для параметра _lpProgress_ можно также имели в виду, что клиент должны отображать ход выполнения с помощью реализации интерфейса MAPI, необходимо определить, когда требуется вызов [и когда следует ли игнорировать параметр _lpProgress_ специальный код IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span><span class="sxs-lookup"><span data-stu-id="75b8a-131">Because a NULL value for the  _lpProgress_ parameter can also mean that the client should display progress by using the MAPI implementation, special code is necessary to determine when to ignore the  _lpProgress_ parameter and when to call [IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md).</span></span>
    
<span data-ttu-id="75b8a-132">Вызов **IMAPIProgress::SetLimits** установить или сбросить флаг MAPI_TOP_LEVEL и задавать локальных и глобальных минимального и максимального значения.</span><span class="sxs-lookup"><span data-stu-id="75b8a-132">Call **IMAPIProgress::SetLimits** to set or clear the MAPI_TOP_LEVEL flag and to set local and global minimum and maximum values.</span></span> <span data-ttu-id="75b8a-133">Значение флагов, является ли параметр влияет на объекте хода выполнения понимает минимального и максимального значения для локальной или глобальной.</span><span class="sxs-lookup"><span data-stu-id="75b8a-133">The value of the flags setting affects whether the progress object understands the minimum and maximum values to be local or global.</span></span> <span data-ttu-id="75b8a-134">Если для флага MAPI_TOP_LEVEL, эти значения считаются глобальные и используются для вычисления хода выполнения для всей операции.</span><span class="sxs-lookup"><span data-stu-id="75b8a-134">When the MAPI_TOP_LEVEL flag is set, these values are considered global and are used to calculate progress for the entire operation.</span></span> <span data-ttu-id="75b8a-135">Объекты хода выполнения инициализации глобального минимальное значение 0 и глобальные максимальное значение до 1000.</span><span class="sxs-lookup"><span data-stu-id="75b8a-135">Progress objects initialize the global minimum value to 0 and the global maximum value to 1000.</span></span> 
  
<span data-ttu-id="75b8a-136">При MAPI_TOP_LEVEL не задано, минимального и максимального значения считаются локальной и используются во внутреннем поставщиков для отображения хода выполнения для вложенных нижнем уровне.</span><span class="sxs-lookup"><span data-stu-id="75b8a-136">When MAPI_TOP_LEVEL is not set, the minimum and maximum values are considered local and are used internally by providers to display progress for lower level subobjects.</span></span> <span data-ttu-id="75b8a-137">Объекты хода выполнения сохраните локальные минимального и максимального значения только для того, чтобы они могут быть возвращены для поставщиков при вызове **GetMin** и **GetMax** .</span><span class="sxs-lookup"><span data-stu-id="75b8a-137">Progress objects save the local minimum and maximum values only so that they can be returned to providers when **GetMin** and **GetMax** are called.</span></span> 
  
<span data-ttu-id="75b8a-138">Значение, количество объектов и параметров общее объекта ввода в метод **IMAPIProgress::Progress** .</span><span class="sxs-lookup"><span data-stu-id="75b8a-138">The value, object count, and object total parameters are input to the **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="75b8a-139">Параметр значение, число, указывающее процент, является обязательным.</span><span class="sxs-lookup"><span data-stu-id="75b8a-139">The value parameter, a number that indicates the percentage of progress, is required.</span></span> <span data-ttu-id="75b8a-140">Если значение флага MAPI_TOP_LEVEL, можно также передать число объектов и всего по объекту.</span><span class="sxs-lookup"><span data-stu-id="75b8a-140">If the MAPI_TOP_LEVEL flag is set, you can also pass an object count and an object total.</span></span> <span data-ttu-id="75b8a-141">Некоторые клиенты используют эти значения для отображения фразы, например «5 элементов завершен из десяти» с индикатором хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="75b8a-141">Some clients use these values to display a phrase such as "5 items completed out of 10" with the progress indicator.</span></span> <span data-ttu-id="75b8a-142">Ход выполнения операции могут быть выявлены строго в процентном выражении или в процентном выражении и точки зрения количества элементов, которые были обработаны из общего обработки.</span><span class="sxs-lookup"><span data-stu-id="75b8a-142">Progress on an operation can be reported strictly as a percentage or as a percentage and in terms of the number of items that have been processed out of the total to be processed.</span></span> <span data-ttu-id="75b8a-143">К примеру для вы поставщика хранилища сообщений и перед выполнением операции копирования, копирование 10 папок, индикатор хода выполнения можно предоставить пользователю с дополнительной информации, отображая фразы, например «1 10», «2 10", «3 10" , и так далее до завершения операции.</span><span class="sxs-lookup"><span data-stu-id="75b8a-143">For example, if you are a message store provider and you are performing a copy operation that is copying 10 folders, the progress indicator can supply the user with additional information by displaying a phrase such as "1 of 10", "2 of 10", "3 of 10", and so on until the operation is complete.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="75b8a-144">См. также</span><span class="sxs-lookup"><span data-stu-id="75b8a-144">See also</span></span>



[<span data-ttu-id="75b8a-145">Индикаторы выполнения MAPI</span><span class="sxs-lookup"><span data-stu-id="75b8a-145">MAPI Progress Indicators</span></span>](mapi-progress-indicators.md)


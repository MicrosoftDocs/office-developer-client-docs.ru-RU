---
title: Объекты mapi Progress
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 73d905028f8f62ad8cbb9da9b1ad61b8cab1065e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422028"
---
# <a name="mapi-progress-objects"></a>Объекты mapi Progress

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
С помощью методов и данных объекта прогресса можно управлять ходом выполнения отчетов индикатора. Хотя клиент или MAPI реализует объект progress, большая часть бремени обеспечения правильности отображения прогресса ложится на поставщиков услуг. Вы можете гарантировать его точность, указав определенный порядок и значение для параметров, которые передаются для выполнения методов объекта.
  
Для выполнения объектов передаются следующие параметры:
  
- Битмашка флагов, задаваемая [с помощью IMAPIProgress::SetLimits](imapiprogress-setlimits.md) и извлеченная с [помощью IMAPIProgress::GetFlags](imapiprogress-getflags.md).
    
- Минимальное значение (локальное и глобальное), задав набор **SetLimits** и полученный [с помощью IMAPIProgress::GetMin](imapiprogress-getmin.md).
    
- Максимальное значение (локальное и глобальное), задав набор **SetLimits** и извлеченный [с помощью IMAPIProgress::GetMax.](imapiprogress-getmax.md)
    
- Значение, которое указывает текущий процент завершения операции, передано [IMAPIProgress::P rogress](imapiprogress-progress.md).
    
- Количество объектов, которые были обработаны, передано в **Progress**.
    
- Количество объектов, участвующих в операции, передается в **"Прогресс".**
    
Все поставщики услуг начинают обработку отображения хода с вызова **в IMAPIProgress::GetFlags** для получения параметров нынешних флагов. В настоящее время флаги можно установить только для MAPI_TOP_LEVEL. Клиенты и MAPI инициализируют флаг для MAPI_TOP_LEVEL, полагаясь на поставщиков услуг, чтобы очистить его при необходимости. 
  
При работе с объектом верхнего уровня в операции MAPI_TOP_LEVEL значение флагов. Объект верхнего уровня — это объект, который вызван клиентом для начала операции. В операции копирования папок это скопированная папка. В операции удаления папок эта папка удаляется. При вызове для обработки объекта нижнего уровня или субобпроекта очистить значение флагов. В операции копирования папок поддомекты — это подмостки, которые находятся в скопированной папке. 
  
MAPI позволяет различать объекты верхнего уровня и подобъекты с флагом MAPI_TOP_LEVEL, чтобы все объекты, участвующие в операции, могли использовать одну и ту же реализацию [IMAPIProgress](imapiprogressiunknown.md) для отображения прогресса, что приводит к плавному реализации индикатора в одном положительном направлении. Установлено MAPI_TOP_LEVEL или нет, влияет на параметры других параметров в последующих вызовах на объект progress. 
  
Поскольку для отображения прогресса на всех уровнях многоуровневой операции может быть нетривиальным устанавливать соответствующие значения параметров, некоторые поставщики услуг не показывают прогресса для подобектов. 
  
 **Чтобы не показывать прогресс для подобектов**
  
- Передай NULL для  _параметра lpProgress_ в вызове для обработки подобекта. Например, если вы копируете папки, это вызов к методу [IMAPIFolder::CopyFolder.](imapifolder-copyfolder.md) 
    
- Напишите специальный код, чтобы определить, как _интерпретировать параметр lpProgress._ Так как значение NULL для параметра  _lpProgress_ также может означать, что клиент должен отображать прогресс с помощью реализации MAPI, необходимо использовать специальный код, чтобы определить, когда игнорировать параметр  _lpProgress_ и когда вызывать [IMAPISupport::D oProgressDialog](imapisupport-doprogressdialog.md).
    
Вызов **IMAPIProgress::SetLimits,** чтобы установить или очистить флаг MAPI_TOP_LEVEL и установить локальные и глобальные минимальные и максимальные значения. Значение параметра флагов влияет на то, понимает ли объект progress минимальные и максимальные значения локального или глобального значения. Когда за установлен MAPI_TOP_LEVEL флаг, эти значения считаются глобальными и используются для вычисления прогресса для всей операции. Объекты progress инициализируют глобальное минимальное значение до 0, а глобальное максимальное значение до 1000. 
  
Если MAPI_TOP_LEVEL не установлено, минимальные и максимальные значения считаются локальными и используются внутренними поставщиками для отображения прогресса для подобектов более низкого уровня. Объекты progress сохранения локальных минимальных и максимальных значений только для того, чтобы они могли быть возвращены поставщикам, когда будут вызваны **GetMin** и **GetMax.** 
  
Значение, количество объектов и общие параметры объекта являются входом в **метод IMAPIProgress::P rogress.** Необходимо значение параметра, число, которое указывает процент прогресса. Если задат MAPI_TOP_LEVEL, можно также передать количество объектов и общее число объектов. Некоторые клиенты используют эти значения для отображения фразы, например "5 элементов, завершенных из 10" с индикатором прогресса. О ходе операции можно отчитаться строго в процентах или в процентах, а также с точки зрения количества обработанных элементов из общего количества обрабатываемых элементов. Например, если вы поставщик магазина сообщений и выполняете операцию копирования 10 папок, индикатор прогресса может предоставить пользователю дополнительные сведения, отобразив такие фразы, как "1 из 10", "2 из 10", "3 из 10" и т. д. до завершения операции. 
  
## <a name="see-also"></a>См. также



[Индикаторы прогресса MAPI](mapi-progress-indicators.md)


---
title: Объекты хода выполнения MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 73d905028f8f62ad8cbb9da9b1ad61b8cab1065e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422028"
---
# <a name="mapi-progress-objects"></a>Объекты хода выполнения MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
С помощью методов и данных объекта хода выполнения можно управлять тем, как индикатор сообщает о ходе выполнения. Хотя клиент или MAPI реализует объект хода выполнения, большая часть нагрузки по обеспечению правильности отображения хода выполнения ложится на поставщиков услуг. Вы можете гарантировать ее точность, указав определенный порядок и значение для параметров, которые передаются методам объекта progress.
  
В объекты хода выполнения передаются следующие параметры:
  
- Битоваяmas флагов, задаваемая с [помощью IMAPIProgress::SetLimits](imapiprogress-setlimits.md) и получаемая с [помощью IMAPIProgress::GetFlags.](imapiprogress-getflags.md)
    
- Минимальное значение (локальное и глобальное), задав set with **SetLimits** и полученный с [помощью IMAPIProgress::GetMin](imapiprogress-getmin.md).
    
- Максимальное значение (локальное и глобальное), задав **значение SetLimits** и полученный с [помощью IMAPIProgress::GetMax.](imapiprogress-getmax.md)
    
- Значение, которое указывает текущий процент завершения операции, переданный [IMAPIProgress::P rogress](imapiprogress-progress.md).
    
- Число объектов, которые были обработаны до сих пор, переданных в **progress**.
    
- Общее число объектов, участвующих в операции, переданных **в** progress.
    
Все поставщики услуг начинают обработку хода выполнения с вызова **IMAPIProgress::GetFlags** для получения параметра флагов. В настоящее время для флагов можно установить только MAPI_TOP_LEVEL. Клиенты и MAPI инициализируют флаг для MAPI_TOP_LEVEL, если необходимо, поставщики услуг очищают его. 
  
Значение флагов устанавливается MAPI_TOP_LEVEL во время работы с объектом верхнего уровня в операции. Объект верхнего уровня — это объект, который вызван клиентом для начала операции. В операции копирования папок это папка, скопированная. В операции удаления папки это папка, которая удаляется. При вызове обработки объекта нижнего уровня или подобекта очищает значение флагов. В операции копирования папок подобекты — это вложенные папки, которые находятся в копируется папке. 
  
MAPI позволяет различать объекты верхнего уровня и подобъекты с помощью флага MAPI_TOP_LEVEL, чтобы все объекты, участвующие в операции, могли использовать одну реализацию [IMAPIProgress](imapiprogressiunknown.md) для отображения хода выполнения, что приводит к плавному переходу индикатора в одном положительном направлении. Установка флага MAPI_TOP_LEVEL влияет на параметры других параметров в последующих вызовах к объекту хода выполнения. 
  
Так как устанавливать соответствующие значения параметров для отображения хода выполнения на всех уровнях многоуровневой операции может быть нетривиальным, некоторые поставщики услуг выбирают не отображать ход выполнения для подобектов. 
  
 **Предотвращение показа хода выполнения для подобектов**
  
- Передав NULL для  _параметра lpProgress_ в вызове для обработки подобекта. Например, при копировании папок это вызов метода [IMAPIFolder::CopyFolder вложенной папки.](imapifolder-copyfolder.md) 
    
- Напишите специальный код, чтобы определить, как _интерпретировать параметр lpProgress._ Поскольку значение NULL для параметра  _lpProgress_ также может означать, что клиент должен отображать ход выполнения с помощью реализации MAPI, для определения того, когда следует игнорировать параметр  _lpProgress_ и когда вызывать [IMAPISupport::D oProgressDialog,](imapisupport-doprogressdialog.md)требуется специальный код.
    
Вызовите **IMAPIProgress::SetLimits,** чтобы установить или очистить флаг MAPI_TOP_LEVEL, а также установить локальные и глобальные минимальные и максимальные значения. Значение параметра флагов влияет на то, понимает ли объект ход выполнения минимальное и максимальное значения как локальные или глобальные. Если установлен MAPI_TOP_LEVEL флага, эти значения считаются глобальными и используются для вычисления хода выполнения всей операции. Объекты хода выполнения инициализируют глобальное минимальное значение 0, а глобальное максимальное значение 1000. 
  
Если MAPI_TOP_LEVEL не установлен, минимальные и максимальные значения считаются локальными и используются поставщиками для отображения хода выполнения для подобектов нижнего уровня. Объекты хода выполнения сохранения локальных минимальных и максимальных значений только для того, чтобы они могли быть возвращены поставщикам при **вызвании GetMin** и **GetMax.** 
  
Значение, число объектов и параметры общего числа объектов являются входным значением для метода **IMAPIProgress::P rogress.** Параметр value, число, которое указывает процент выполнения, является требуемой. Если установлен MAPI_TOP_LEVEL, можно также передать количество объектов и общее число объектов. Некоторые клиенты используют эти значения для отображения фразы, например "5 элементов, завершенных из 10" с индикатором хода выполнения. Ход выполнения операции может быть только в процентах или в процентах, а также в отношении количества элементов, обработанных из общего числа обрабатываемых элементов. Например, если вы поставщик службы хранения сообщений и выполняете операцию копирования 10 папок, индикатор хода выполнения может предоставить пользователю дополнительные сведения, отображая такие фразы, как "1 из 10", "2 из 10", "3 из 10" и т. д., пока операция не будет завершена. 
  
## <a name="see-also"></a>См. также



[Индикаторы хода выполнения MAPI](mapi-progress-indicators.md)


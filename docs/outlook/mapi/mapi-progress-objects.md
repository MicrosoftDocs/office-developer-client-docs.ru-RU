---
title: Объекты хода выполнения MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e446004e-1ef2-4e58-b764-de7b4dcefaf1
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 73d905028f8f62ad8cbb9da9b1ad61b8cab1065e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422028"
---
# <a name="mapi-progress-objects"></a>Объекты хода выполнения MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
С помощью методов и данных объекта Progress можно управлять ходом выполнения отчета индикатора. Несмотря на то, что клиент или MAPI реализует объект Progress, большая часть нагрузки по обеспечению правильности отображения хода выполнения зависит от поставщиков услуг. Вы можете гарантировать точность, указав определенный порядок и значение для параметров, которые передаются в методы объекта Progress.
  
Следующие параметры передаются объектам хода выполнения:
  
- Битовая маска флагов, задается с помощью [IMAPIProgress:: SetLimits](imapiprogress-setlimits.md) и извлекаются с помощью [флагов IMAPIProgress::](imapiprogress-getflags.md).
    
- Минимальное значение (local и Global), заданное с помощью **SetLimits** и полученное с помощью [IMAPIProgress:: GetMin](imapiprogress-getmin.md).
    
- Максимальное значение (local и Global), заданное с помощью **SetLimits** и полученное с помощью [IMAPIProgress:: жетмакс](imapiprogress-getmax.md).
    
- Значение, указывающее текущий процент завершения операции, переданный в [IMAPIProgress::P рогресс](imapiprogress-progress.md).
    
- Количество объектов, которые пока были обработаны, переданы в **ходе выполнения**.
    
- Общее число объектов, участвующих в операции, переданных в **ходе выполнения**.
    
Все поставщики услуг начинают обработку отображения хода выполнения с помощью вызова **IMAPIProgress::** GetSetting для получения параметра текущих флагов. В настоящее время флаги можно задать только для MAPI_TOP_LEVEL. Клиенты и MAPI инициализируют флаг для MAPI_TOP_LEVEL, полагается на поставщиков услуг, чтобы очищать его при необходимости. 
  
Значение Flags задается MAPI_TOP_LEVEL при работе с объектом верхнего уровня в операции. Объект верхнего уровня — это объект, вызываемый клиентом для начала операции. В операции копирования папки это копируемая папка. В операции удаления папки это папка, которая будет удалена. При вызове обработки объекта нижнего уровня или подобъекта очистите значение флагов. В операции копирования папок вложенные объекты — это вложенные папки, которые находятся в копируемой папке. 
  
MAPI позволяет различать объекты верхнего уровня и подобъекты с помощью флага MAPI_TOP_LEVEL, чтобы все объекты, участвующие в операции, могли использовать одну и ту же реализацию [IMAPIProgress](imapiprogressiunknown.md) для отображения хода выполнения, что приводит к тому, что индикатор продвигается плавно в одном положительном направлении. Указывает, влияет ли установленный флаг MAPI_TOP_LEVEL на параметры других параметров при последующих вызовах объекта Progress. 
  
Так как может быть нетривиальное задание значений параметров для отображения хода выполнения на всех уровнях многоуровневой операции, некоторые поставщики услуг не отображают сведения о ходе выполнения для вложенных объектов. 
  
 **Чтобы не показывать ход выполнения для подобъектов**
  
- Передайте значение NULL для параметра _лппрогресс_ в вызове для обработки подобъекта. Например, при копировании папок вызывается метод [IMAPIFolder:: CopyFolder](imapifolder-copyfolder.md) вложенной папки. 
    
- Напишите специальный код, чтобы определить, как интерпретировать параметр _лппрогресс_ . Так как значение NULL для параметра _лппрогресс_ также может означать, что клиент должен отображать ход выполнения с помощью реализации MAPI, необходим специальный код, чтобы определить, когда следует игнорировать параметр _лппрогресс_ и когда следует вызывать [имаписуппорт::D опрогрессдиалог](imapisupport-doprogressdialog.md).
    
Call **IMAPIProgress:: SetLimits** для установки или снятия флага MAPI_TOP_LEVEL, а также для задания локальных и глобальных минимальных и максимальных значений. Значение параметра flags влияет на то, распознает ли объект Progress минимальное и максимальное значения, которые должны быть локальными или глобальными. Если установлен флаг MAPI_TOP_LEVEL, эти значения считаются глобальными и используются для вычисления хода выполнения для всей операции. Объекты Progress инициализируют глобальное минимальное значение 0 и глобальное максимальное значение до 1000. 
  
Если MAPI_TOP_LEVEL не задано, то минимальное и максимальное значения считаются локальными и используются поставщиками для внутреннего отображения сведений о ходе выполнения для подобъектов нижнего уровня. Объекты хода выполнения сохраняют локальное минимальное и максимальное значения только для того, чтобы они могли возвращаться поставщикам при вызове **GetMin** и **жетмакс** . 
  
В качестве входных параметров для метода **IMAPIProgress::P рогресс** используется входное значение, количество объектов и общее количество параметров объекта. Параметр value — число, указывающее процент выполнения, является обязательным. Если установлен флаг MAPI_TOP_LEVEL, также можно передать Счетчик объектов и объект. Некоторые клиенты используют эти значения для отображения фразы, например "5 элементов, завершенных из 10" с индикатором хода выполнения. Ход выполнения операции можно указать исключительно в процентах или в виде процента, а также в терминах количества элементов, обработанных из итогового значения для обработки. Например, если вы являетесь поставщиком хранилища сообщений и выполняете операцию копирования, которая копирует 10 папок, индикатор хода выполнения может предоставить пользователю дополнительные сведения, выполнив фразу "1 из 10", "2 из 10", "3 из 10" и так далее до завершения операции. 
  
## <a name="see-also"></a>См. также



[Индикаторы хода выполнения MAPI](mapi-progress-indicators.md)


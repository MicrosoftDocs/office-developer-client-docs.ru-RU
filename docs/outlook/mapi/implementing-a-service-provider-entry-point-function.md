---
title: Реализация функции точки входа для поставщика службы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83ff54c4-86ce-4529-ae45-260dfb763b30
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 14dd11f873493e32b83dbd1960cac8ff8ef8e436
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25387050"
---
# <a name="implementing-a-service-provider-entry-point-function"></a>Реализация функции точки входа для поставщика службы

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каждый поставщик услуг DLL-Библиотека имеет функцию, которая вызывает MAPI, чтобы загрузить его точки входа. Обратите внимание, что эта функция точки входа не то же, что [DllMain](https://msdn.microsoft.com/library/ms682583.aspx), функции точки входа Win32 DLL.
  
В зависимости от типа поставщика функция точки входа вашего поставщика соответствует другой прототип. MAPI определяет прототипов функций различных запись точки для поставщиков услуг.
  
|**Поставщик**|**Прототип функции точки входа**|
|:-----|:-----|
|Поставщики хранилища сообщений  <br/> |[MSProviderInit](msproviderinit.md) <br/> |
|Поставщиками транспорта  <br/> |[XPProviderInit](xpproviderinit.md) <br/> |
|Поставщиками адресных книг  <br/> |[ABProviderInit](abproviderinit.md) <br/> |
   
Значительная часть функциональности в этих прототипов является общим для всех типов поставщика службы. 
  
Адресная книга, хранилища сообщений и поставщиками транспорта выполните следующие две основные задачи в их функции точки входа.
  
1. Проверка версии интерфейс поставщика службы (SPI) убедитесь, что MAPI используется версия, совместимый с версией, которая использует ваш поставщик услуг. Используйте параметр _lpulMAPIVer_ , который содержит версию MAPI SPI и параметр _lpulProviderVer_ , который содержит вашей версии SPI, для выполнения проверки. Эти параметры являются целые числа без знака 32-разрядная версия, состоит из трех частей: 
    
  - Биты 24 до 31 представляют основной номер версии.
    
  - Биты 16 до 23 представляют дополнительный номер версии.
    
  - Биты цифры от 0 до 15 представляют идентификатор обновления. Несмотря на то, что основной номер версии редко изменяется, изменения номер вспомогательной версии каждый раз, когда выпущен MAPI и индекс параметров безопасности был изменен. Идентификатор обновления — это внутренний Microsoft построения версии; он используется для отслеживания изменений в процессе разработки. MAPI определяет константу CURRENT_SPI_VERSION, приведенной в файле заголовка Mapispi.h для указания присутствует версии SPI. Если используется версия старше версии, с помощью интерфейса MAPI индекс параметров безопасности с ошибкой вашей проверки с ошибкой MAPI_E_VERSION.
    
2. Создайте экземпляр объекта поставщика. Так как поставщик может работы и инициализации несколько раз, необходимо создать новый экземпляр каждый раз, когда это происходит. Поставщики запускаются несколько раз, когда они отображаются в несколько профилей, используемых одновременно с одного или нескольких клиентов или они отображаются несколько раз в одном профиле. Так же, как прототип функции запись точки отличается в зависимости от типа поставщика, поэтому не тип объекта поставщика. 
    
    При создании поставщика адресных книг реализовать [IABProvider: IUnknown](iabprovideriunknown.md). При создании поставщика хранилища message реализация [IMSProvider: IUnknown](imsprovideriunknown.md). Для получения дополнительных сведений см. [Загрузка поставщики хранилища сообщений](loading-message-store-providers.md).
    
    При создании поставщика транспорта реализовать [IXPProvider: IUnknown](ixpprovideriunknown.md). Для получения дополнительных сведений см [инициализации поставщика транспорта](initializing-the-transport-provider.md).
    
## <a name="see-also"></a>См. также



[Запуск поставщика службы](starting-a-service-provider.md)


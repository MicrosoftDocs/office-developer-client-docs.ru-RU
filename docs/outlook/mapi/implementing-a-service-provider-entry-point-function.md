---
title: Реализация функции точки входа поставщика услуг
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83ff54c4-86ce-4529-ae45-260dfb763b30
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 14dd11f873493e32b83dbd1960cac8ff8ef8e436
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332993"
---
# <a name="implementing-a-service-provider-entry-point-function"></a>Реализация функции точки входа поставщика услуг

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каждая DLL-запись поставщика услуг имеет функцию точки входа, которую MAPI вызывает для ее загрузки. Следует помнить, что эта функция точки входа не такая, как [DllMain](https://msdn.microsoft.com/library/ms682583.aspx), функция точки входа Win32 DLL.
  
В зависимости от типа поставщика функция точки входа поставщика соответствует другому прототипу. MAPI определяет различные прототипы функции точки входа для поставщиков услуг.
  
|**Поставщик**|**Прототип функции точки входа**|
|:-----|:-----|
|Поставщики store сообщений  <br/> |[MSProviderInit](msproviderinit.md) <br/> |
|Поставщики транспорта  <br/> |[XPProviderInit](xpproviderinit.md) <br/> |
|Поставщики адресных книг  <br/> |[ABProviderInit](abproviderinit.md) <br/> |
   
Большая часть функциональных возможностей этих прототипов является одинаковой для всех типов поставщиков услуг. 
  
Адресная книга, хранилище сообщений и поставщики транспорта выполняют следующие две основные задачи в своих функциях точки входа:
  
1. Проверьте версию интерфейса поставщика услуг (SPI), чтобы убедиться, что MAPI использует версию, совместимую с версией, используемой поставщиком услуг. Для выполнения проверки используйте параметр  _lpulMAPIVer,_ который содержит версию MAPI SPI, и  _параметр lpulProviderVer,_ содержащий версию SPI. Эти параметры являются 32-битами без подписи, состоящими из трех частей: 
    
  - Биты от 24 до 31 представляют основной версии.
    
  - Биты от 16 до 23 представляют второстепенную версию.
    
  - Биты от 0 до 15 представляют идентификатор обновления. Несмотря на то что основной номер версии редко изменяется, номер второстепенной версии изменяется при выпусках MAPI и изменения SPI. Идентификатор обновления — это версия внутренней сборки Майкрософт; он используется для отслеживания изменений в процессе разработки. MAPI определяет константы CURRENT_SPI_VERSION, задокументированные в файле заголовщика Mapispi.h, чтобы указать конечную версию SPI. Не удается проверить ошибку MAPI_E_VERSION если вы используете версию SPI, которая является более новой, чем версия, используемая MAPI.
    
2. Создание экземпляра объекта поставщика. Так как поставщик может быть запущен и инициализирован несколько раз, каждый раз при этом следует создавать новый экземпляр. Поставщики запущены несколько раз, когда они отображаются в нескольких профилях, которые одновременно используются одним или несколькими клиентами, или если они отображаются несколько раз в одном профиле. Так же, как прототип функции точки входа отличается в зависимости от типа поставщика, так же как и тип объекта поставщика. 
    
    Если вы пишете поставщика адресной книги, реализуем [IABProvider : IUnknown](iabprovideriunknown.md). Если вы пишете поставщика store сообщений, реализуют [IMSProvider : IUnknown](imsprovideriunknown.md). Дополнительные сведения см. в [подзагосе "Загрузка поставщиков store сообщений".](loading-message-store-providers.md)
    
    Если вы пишете поставщика транспорта, реализуют [IXPProvider : IUnknown](ixpprovideriunknown.md). Дополнительные сведения см. в [инициализации поставщика транспорта.](initializing-the-transport-provider.md)
    
## <a name="see-also"></a>См. также



[Запуск поставщика услуг](starting-a-service-provider.md)


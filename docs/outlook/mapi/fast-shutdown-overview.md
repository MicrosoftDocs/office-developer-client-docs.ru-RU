---
title: Обзор быстрого завершения работы
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a7830d73-427c-4f8b-86f4-51e040c142c3
description: 'Дата последнего изменения: 26 июня 2012 года'
ms.openlocfilehash: 8c33214b04e7c41eab173196c09f145c20ddf219
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32341103"
---
# <a name="fast-shutdown-overview"></a><span data-ttu-id="f6cfb-103">Обзор быстрого завершения работы</span><span class="sxs-lookup"><span data-stu-id="f6cfb-103">Fast Shutdown Overview</span></span>

<span data-ttu-id="f6cfb-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f6cfb-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f6cfb-105">Быстрое завершение работы — это механизм, позволяющий клиенту MAPI инициировать быстрое завершение работы клиентского процесса, уведомляя всех поставщиков, с которыми клиент имеет активный сеанс MAPI, чтобы сохранить данные и параметры до того, как клиентский процесс завершит работу.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-105">Fast shutdown is a mechanism for a MAPI client to initiate a quick shutdown of the client process, notifying all providers with which the client has an active MAPI session to save data and settings before the client process exits.</span></span> <span data-ttu-id="f6cfb-106">В этом разделе описывается базовый механизм быстрого завершения работы.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-106">This topic describes the basic mechanism of fast shutdown.</span></span> 

<span data-ttu-id="f6cfb-107">Начиная с Microsoft Outlook 2010 и теперь включая Microsoft Outlook 2013, подсистема MAPI предоставляет интерфейс [метод imapiclientshutdown: IUnknown](imapiclientshutdowniunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="f6cfb-107">Starting in Microsoft Outlook 2010 and now including Microsoft Outlook 2013, the MAPI subsystem provides the [IMAPIClientShutdown : IUnknown](imapiclientshutdowniunknown.md) interface.</span></span> <span data-ttu-id="f6cfb-108">В качестве механизма по умолчанию для выхода из клиентского процесса можно применять быстрое завершение работы Outlook и других клиентов MAPI.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-108">Outlook and other MAPI clients can adopt fast shutdown as the default mechanism to exit the client process.</span></span> <span data-ttu-id="f6cfb-109">Параметр уровня пользователя в реестре Windows клиентского компьютера управляет внедрением быстрого завершения работы всех клиентов MAPI для этого пользователя на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-109">A user-level setting in the Windows registry of the client computer controls the adoption of fast shutdown for all MAPI clients for that user on that computer.</span></span> <span data-ttu-id="f6cfb-110">Сведения о параметрах реестра приведены в разделе [Параметры быстрого завершения работы пользователя](fast-shutdown-user-options.md).</span><span class="sxs-lookup"><span data-stu-id="f6cfb-110">For details about the registry settings, see [Fast Shutdown User Options](fast-shutdown-user-options.md).</span></span>
  
<span data-ttu-id="f6cfb-111">Если клиент MAPI должен применять быстрое завершение работы, он должен использовать интерфейс **метод imapiclientshutdown: IUnknown** .</span><span class="sxs-lookup"><span data-stu-id="f6cfb-111">If a MAPI client needs to adopt fast shutdown, it must use the **IMAPIClientShutdown : IUnknown** interface.</span></span> <span data-ttu-id="f6cfb-112">Ниже приведен типичный порядок событий при попытке клиента завершить работу.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-112">The following is the typical course of events when the client attempts to shut down:</span></span> 
  
1. <span data-ttu-id="f6cfb-113">Клиент MAPI инициирует завершение работы, вызывая метод [метод imapiclientshutdown:: QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) , чтобы определить, поддерживает ли подсистема MAPI быстрое завершение работы.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-113">The MAPI client initiates the shutdown by calling the [IMAPIClientShutdown::QueryFastShutdown](imapiclientshutdown-queryfastshutdown.md) method to determine whether the MAPI subsystem supports fast shutdown.</span></span> 
    
2. <span data-ttu-id="f6cfb-114">Подсистема MAPI отвечает за доступную поддержку быстрого завершения работы для вызова **метод imapiclientshutdown:: QueryFastShutdown** клиента, используя следующую процедуру:</span><span class="sxs-lookup"><span data-stu-id="f6cfb-114">The MAPI subsystem responds with the available fast shutdown support to the client's **IMAPIClientShutdown::QueryFastShutdown** call by using the following procedure:</span></span> 
    
    1. <span data-ttu-id="f6cfb-115">Подсистема MAPI вызывает метод [IMAPIProviderShutdown:: QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) для каждого поставщика MAPI, с которым клиентский процесс MAPI имеет активный сеанс MAPI, если поставщик реализует [интерфейс IMAPIProviderShutdown: IUnknown](imapiprovidershutdowniunknown.md) взаимодействия.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-115">The MAPI subsystem calls the [IMAPIProviderShutdown::QueryFastShutdown](imapiprovidershutdown-queryfastshutdown.md) method for each MAPI provider with which the MAPI client process has an active MAPI session, if the provider has implemented the [IMAPIProviderShutdown : IUnknown](imapiprovidershutdowniunknown.md) interface.</span></span> 
        
       > [!NOTE]
       >  <span data-ttu-id="f6cfb-116">Подсистема MAPI всегда запрашивает и уведомляет поставщиков MAPI с помощью интерфейса **IMAPIProviderShutdown: IUnknown** в каждом сеансе MAPI в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="f6cfb-116">The MAPI subsystem always queries and notifies MAPI providers through the **IMAPIProviderShutdown : IUnknown** interface within each MAPI session in the following order:</span></span>
       > 1. <span data-ttu-id="f6cfb-117">Поставщики транспорта</span><span class="sxs-lookup"><span data-stu-id="f6cfb-117">Transport providers</span></span>
       > 2. <span data-ttu-id="f6cfb-118">Поставщики адресных книг</span><span class="sxs-lookup"><span data-stu-id="f6cfb-118">Address book providers</span></span>
       > 3. <span data-ttu-id="f6cfb-119">Поставщики услуг хранения</span><span class="sxs-lookup"><span data-stu-id="f6cfb-119">Store providers</span></span> 
    
    2. <span data-ttu-id="f6cfb-120">В зависимости от параметра быстрого завершения работы реестра для этого пользователя на клиентском компьютере подсистема MAPI указывает соответствующий код возврата для **метод imapiclientshutdown:: QueryFastShutdown**.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-120">Depending on the fast shutdown registry setting for that user on the client computer, the MAPI subsystem specifies the appropriate return code to **IMAPIClientShutdown::QueryFastShutdown**.</span></span> <span data-ttu-id="f6cfb-121">Код возврата — значение S_OK или МАПИ_Е_НО_СУППОРТ.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-121">The return code is either S_OK or MAPI_E_NO_SUPPORT.</span></span>
        
    3. <span data-ttu-id="f6cfb-122">Клиент MAPI вызывает метод [метод imapiclientshutdown:: нотифипроцессшутдовн](imapiclientshutdown-notifyprocessshutdown.md) , чтобы показать подсистеме MAPI намерение завершить работу.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-122">The MAPI client calls the [IMAPIClientShutdown::NotifyProcessShutdown](imapiclientshutdown-notifyprocessshutdown.md) method to indicate to the MAPI subsystem the intention to shut down.</span></span> 
        
    4. <span data-ttu-id="f6cfb-123">Подсистема MAPI указывает каждому загруженному поставщику MAPI, что клиент MAPI завершает работу.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-123">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client will shut down.</span></span> <span data-ttu-id="f6cfb-124">Для тех поставщиков, которые реализовали интерфейс **IMAPIProviderShutdown: IUnknown** , подсистема MAPI вызывает соответствующий метод [IMAPIProviderShutdown:: нотифипроцессшутдовн](imapiprovidershutdown-notifyprocessshutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="f6cfb-124">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::NotifyProcessShutdown](imapiprovidershutdown-notifyprocessshutdown.md) method.</span></span> 
        
    5. <span data-ttu-id="f6cfb-125">Клиент MAPI вызывает метод [метод imapiclientshutdown::D офастшутдовн](imapiclientshutdown-dofastshutdown.md) , чтобы указать подсистему MAPI, что клиентский процесс завершается немедленно.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-125">The MAPI client calls the [IMAPIClientShutdown::DoFastShutdown](imapiclientshutdown-dofastshutdown.md) method to indicate to the MAPI subsystem that the client process is exiting immediately.</span></span> 
        
    6. <span data-ttu-id="f6cfb-126">Подсистема MAPI указывает каждому загруженному поставщику MAPI, что клиентский процесс MAPI завершает работу.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-126">The MAPI subsystem indicates to each loaded MAPI provider that the MAPI client process is exiting.</span></span> <span data-ttu-id="f6cfb-127">Для тех поставщиков, которые реализовали интерфейс **IMAPIProviderShutdown: IUnknown** , подсистема MAPI вызывает соответствующий метод [IMAPIProviderShutdown::D офастшутдовн](imapiprovidershutdown-dofastshutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="f6cfb-127">For those providers that have implemented the **IMAPIProviderShutdown : IUnknown** interface, the MAPI subsystem calls the corresponding [IMAPIProviderShutdown::DoFastShutdown](imapiprovidershutdown-dofastshutdown.md) method.</span></span> <span data-ttu-id="f6cfb-128">На этом шаге эти поставщики MAPI должны проверить, что все необходимые действия, такие как сохранение данных и параметров, завершаются при подготовке клиента MAPI к немедленному отключению всех ссылок и выходе.</span><span class="sxs-lookup"><span data-stu-id="f6cfb-128">At this point, these MAPI providers should verify that all necessary actions, such as saving data and settings, are complete in preparation for the MAPI client to immediately disconnect all references and exit.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="f6cfb-129">См. также</span><span class="sxs-lookup"><span data-stu-id="f6cfb-129">See also</span></span>

- [<span data-ttu-id="f6cfb-130">Завершение работы клиента в MAPI</span><span class="sxs-lookup"><span data-stu-id="f6cfb-130">Client Shutdown in MAPI</span></span>](client-shutdown-in-mapi.md)
- [<span data-ttu-id="f6cfb-131">Параметры быстрого завершения работы пользователя</span><span class="sxs-lookup"><span data-stu-id="f6cfb-131">Fast Shutdown User Options</span></span>](fast-shutdown-user-options.md)
- [<span data-ttu-id="f6cfb-132">Рекомендации по быстрому завершению работы</span><span class="sxs-lookup"><span data-stu-id="f6cfb-132">Best Practices for Fast Shutdown</span></span>](best-practices-for-fast-shutdown.md)


---
title: Доступ к объектам с помощью сеанса
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ecada707-2960-41ec-be7e-619cad257c57
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f0696ad4d15274e4af18d2246dd124c1bfee1a2c
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22589408"
---
# <a name="accessing-objects-by-using-the-session"></a><span data-ttu-id="a1658-103">Доступ к объектам с помощью сеанса</span><span class="sxs-lookup"><span data-stu-id="a1658-103">Accessing Objects by Using the Session</span></span>

  
  
<span data-ttu-id="a1658-104">**Применимо к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a1658-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a1658-105">Указатель сеанса, полученные из при вызове [MAPILogonEx](mapilogonex.md) можно использовать для доступа к множеству объектов.</span><span class="sxs-lookup"><span data-stu-id="a1658-105">The session pointer that you receive from your call to [MAPILogonEx](mapilogonex.md) can be used to access a wide variety of objects.</span></span> <span data-ttu-id="a1658-106">В следующей таблице перечислены методы, используемые для доступа к различных объектов:</span><span class="sxs-lookup"><span data-stu-id="a1658-106">The following table lists the methods that are used to access various objects:</span></span> 
  
|<span data-ttu-id="a1658-107">**Объект**</span><span class="sxs-lookup"><span data-stu-id="a1658-107">**Object**</span></span>|<span data-ttu-id="a1658-108">**Метод сеанса**</span><span class="sxs-lookup"><span data-stu-id="a1658-108">**Session method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a1658-109">Раздел профиля</span><span class="sxs-lookup"><span data-stu-id="a1658-109">Profile section</span></span>  <br/> |[<span data-ttu-id="a1658-110">IMAPISession::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="a1658-110">IMAPISession::OpenProfileSection</span></span>](imapisession-openprofilesection.md) <br/> |
|<span data-ttu-id="a1658-111">Хранение сообщений</span><span class="sxs-lookup"><span data-stu-id="a1658-111">Message store</span></span>  <br/> |[<span data-ttu-id="a1658-112">IMAPISession::OpenMsgStore</span><span class="sxs-lookup"><span data-stu-id="a1658-112">IMAPISession::OpenMsgStore</span></span>](imapisession-openmsgstore.md) <br/> |
|<span data-ttu-id="a1658-113">Адресная книга</span><span class="sxs-lookup"><span data-stu-id="a1658-113">Address book</span></span>  <br/> |[<span data-ttu-id="a1658-114">IMAPISession::OpenAddressBook</span><span class="sxs-lookup"><span data-stu-id="a1658-114">IMAPISession::OpenAddressBook</span></span>](imapisession-openaddressbook.md) <br/> |
|<span data-ttu-id="a1658-115">Объект администрирования службы сообщений</span><span class="sxs-lookup"><span data-stu-id="a1658-115">Message service administration object</span></span>  <br/> |[<span data-ttu-id="a1658-116">IMAPISession::AdminServices</span><span class="sxs-lookup"><span data-stu-id="a1658-116">IMAPISession::AdminServices</span></span>](imapisession-adminservices.md) <br/> |
|<span data-ttu-id="a1658-117">Папка, сообщения, контейнер адресной книги, список рассылки или обмена мгновенными сообщениями пользователя</span><span class="sxs-lookup"><span data-stu-id="a1658-117">Folder, message, address book container, distribution list, or messaging user</span></span>  <br/> |[<span data-ttu-id="a1658-118">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-118">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
   
<span data-ttu-id="a1658-119">С помощью метода **OpenEntry** и идентификатор допустимый записи можно открыть любой адресной книги или сообщение объекта-поставщика хранилища.</span><span class="sxs-lookup"><span data-stu-id="a1658-119">With the **OpenEntry** method and a valid entry identifier, you can open any address book or message store provider object.</span></span> <span data-ttu-id="a1658-120">Существуют другие методы **OpenEntry** в MAPI, кроме метода **IMAPISession** .</span><span class="sxs-lookup"><span data-stu-id="a1658-120">There are other **OpenEntry** methods in MAPI, in addition to the **IMAPISession** method.</span></span> <span data-ttu-id="a1658-121">**OpenEntry** реализуется в следующих объектов:</span><span class="sxs-lookup"><span data-stu-id="a1658-121">**OpenEntry** is implemented in the following objects:</span></span> 
  
|<span data-ttu-id="a1658-122">**Объект**</span><span class="sxs-lookup"><span data-stu-id="a1658-122">**Object**</span></span>|<span data-ttu-id="a1658-123">**Способ**</span><span class="sxs-lookup"><span data-stu-id="a1658-123">**Method**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a1658-124">Объект входа поставщик адресной книги</span><span class="sxs-lookup"><span data-stu-id="a1658-124">Address book provider's logon object</span></span>  <br/> |[<span data-ttu-id="a1658-125">IABLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-125">IABLogon::OpenEntry</span></span>](iablogon-openentry.md) <br/> |
|<span data-ttu-id="a1658-126">Адресная книга</span><span class="sxs-lookup"><span data-stu-id="a1658-126">Address book</span></span>  <br/> |[<span data-ttu-id="a1658-127">IAddrBook::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-127">IAddrBook::OpenEntry</span></span>](iaddrbook-openentry.md) <br/> |
|<span data-ttu-id="a1658-128">Контейнер адресной книги</span><span class="sxs-lookup"><span data-stu-id="a1658-128">Address book container</span></span>  <br/> |[<span data-ttu-id="a1658-129">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-129">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="a1658-130">Сеанс</span><span class="sxs-lookup"><span data-stu-id="a1658-130">Session</span></span>  <br/> |[<span data-ttu-id="a1658-131">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-131">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md) <br/> |
|<span data-ttu-id="a1658-132">Хранение сообщений</span><span class="sxs-lookup"><span data-stu-id="a1658-132">Message store</span></span>  <br/> |[<span data-ttu-id="a1658-133">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-133">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md) <br/> |
|<span data-ttu-id="a1658-134">Объект входа поставщика хранилища сообщений</span><span class="sxs-lookup"><span data-stu-id="a1658-134">Message store provider's logon object</span></span>  <br/> |[<span data-ttu-id="a1658-135">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-135">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md) <br/> |
|<span data-ttu-id="a1658-136">Folder</span><span class="sxs-lookup"><span data-stu-id="a1658-136">Folder</span></span>  <br/> |[<span data-ttu-id="a1658-137">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-137">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md) <br/> |
|<span data-ttu-id="a1658-138">Поддержка объектов</span><span class="sxs-lookup"><span data-stu-id="a1658-138">Support object</span></span>  <br/> |[<span data-ttu-id="a1658-139">IMAPISupport::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="a1658-139">IMAPISupport::OpenEntry</span></span>](imapisupport-openentry.md) <br/> |
   
<span data-ttu-id="a1658-140">Некоторые методы **OpenEntry** требуется идентификатор записи объекта, чтобы открыть, как **IMAPISession::OpenEntry**; другие методы разрешить NULL должен быть указан.</span><span class="sxs-lookup"><span data-stu-id="a1658-140">Some **OpenEntry** methods require an entry identifier of the object to be opened, as does **IMAPISession::OpenEntry**; other methods allow NULL to be specified.</span></span> <span data-ttu-id="a1658-141">Идентификатор записи NULL обрабатывается по-разному в зависимости от объекта.</span><span class="sxs-lookup"><span data-stu-id="a1658-141">A NULL entry identifier is interpreted differently depending on the object.</span></span> <span data-ttu-id="a1658-142">Например при вызове **IAddrBook::OpenEntry** с идентификатором записи NULL, MAPI открывает корневой контейнер адресной книги.</span><span class="sxs-lookup"><span data-stu-id="a1658-142">For example, when you call **IAddrBook::OpenEntry** with a NULL entry identifier, MAPI opens the root container of the address book.</span></span> <span data-ttu-id="a1658-143">Метод **OpenEntry** хранилище сообщений ведет себя аналогично; она открывается в корневую папку хранилища сообщений.</span><span class="sxs-lookup"><span data-stu-id="a1658-143">The message store's **OpenEntry** method behaves similarly; it opens the root folder of the message store.</span></span> <span data-ttu-id="a1658-144">**IMAPIContainer::OpenEntry**, реализованный папки и контейнеров адресной книги, может вернуть MAPI_E_INVALID_PARAMETER или корневой контейнер, в зависимости от реализации.</span><span class="sxs-lookup"><span data-stu-id="a1658-144">**IMAPIContainer::OpenEntry**, implemented by both folders and address book containers, might return MAPI_E_INVALID_PARAMETER or the root container, depending on the implementer.</span></span> 
  
<span data-ttu-id="a1658-145">В дополнение к запрещение идентификатор записи значение NULL, метод **OpenEntry** сеанса отличается от другие методы **OpenEntry** из-за его задание не следует открыть объекты.</span><span class="sxs-lookup"><span data-stu-id="a1658-145">In addition to disallowing a NULL value for the entry identifier, the session's **OpenEntry** method differs from other **OpenEntry** methods because its job is not to open objects.</span></span> <span data-ttu-id="a1658-146">Вместо этого проверяет идентификатор записи и перенаправляет звонок с другим методом **OpenEntry** , реализованный поставщика услуг, соответствующего.</span><span class="sxs-lookup"><span data-stu-id="a1658-146">Instead, it examines the entry identifier and forwards the call to another **OpenEntry** method implemented by the appropriate service provider.</span></span> <span data-ttu-id="a1658-147">К примеру при вызове **IMAPISession::OpenEntry** с идентификатором записи сообщения, MAPI вызывает **IMSLogon::OpenEntry** метод хранилища сообщений ответственность за сообщение.</span><span class="sxs-lookup"><span data-stu-id="a1658-147">For example, if you call **IMAPISession::OpenEntry** with the entry identifier of a message, MAPI calls the **IMSLogon::OpenEntry** method of the message store responsible for the message.</span></span> 
  
<span data-ttu-id="a1658-148">В дополнение к сеансу для открытия объектов, клиенты используют его для их сравнения.</span><span class="sxs-lookup"><span data-stu-id="a1658-148">In addition to using the session to open objects, clients use it to compare them.</span></span> <span data-ttu-id="a1658-149">Метод [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) сравнивает, сравнение их идентификаторы записей.</span><span class="sxs-lookup"><span data-stu-id="a1658-149">The [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md) method compares objects by comparing their entry identifiers.</span></span> <span data-ttu-id="a1658-150">Если [MAPIUID](mapiuid.md) структуры, содержащихся в идентификаторы записей принадлежат к поставщику услуг, MAPI перенаправляет звонок этому поставщику.</span><span class="sxs-lookup"><span data-stu-id="a1658-150">If the [MAPIUID](mapiuid.md) structures contained within the entry identifiers belong to the same service provider, MAPI forwards the call to that provider.</span></span> <span data-ttu-id="a1658-151">**CompareEntryIDs** возвращает ошибку, если не соответствующие идентификаторы двух записей.</span><span class="sxs-lookup"><span data-stu-id="a1658-151">**CompareEntryIDs** returns an error value when the two entry identifiers do not match.</span></span> <span data-ttu-id="a1658-152">Несмотря на то, что этот метод позволяет сравнивать идентификаторы записей, относящихся к любой тип объекта, **CompareEntryIDs** из них лучше подходит для более высокого уровня объекты, такие как хранилищ сообщений и контейнеров адресной книги.</span><span class="sxs-lookup"><span data-stu-id="a1658-152">Although this method can compare entry identifiers that belong to any type of object, **CompareEntryIDs** works best for higher level objects such as message stores and address book containers.</span></span> <span data-ttu-id="a1658-153">Для сравнения нижнем уровне объектов, непосредственно сравнивайте ключей поиска объектов (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) или ключи записей (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span><span class="sxs-lookup"><span data-stu-id="a1658-153">To compare lower level objects, compare directly the objects' search keys (**PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))) or record keys (**PR_RECORD_KEY** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))).</span></span> 
  
<span data-ttu-id="a1658-154">Как **OpenEntry** **CompareEntryIDs** реализуется несколько объектов.</span><span class="sxs-lookup"><span data-stu-id="a1658-154">Like **OpenEntry**, **CompareEntryIDs** is implemented by multiple objects.</span></span> <span data-ttu-id="a1658-155">Выберите необходимый **OpenEntry** и **CompareEntryID** метод согласно объем сведений, у вас есть о объект или объекты открыть или по сравнению.</span><span class="sxs-lookup"><span data-stu-id="a1658-155">Choose which **OpenEntry** and **CompareEntryID** method to use according to the amount of information that you have about the object or objects to be opened or compared.</span></span> <span data-ttu-id="a1658-156">При выборе вызываемый метод интерфейса, придерживайтесь следующих рекомендаций:</span><span class="sxs-lookup"><span data-stu-id="a1658-156">Use the following guidelines when deciding which interface method to call:</span></span> 
  
- <span data-ttu-id="a1658-157">Если у вас нет сведений о целевых объектов, вызовите [IMAPISession::OpenEntry](imapisession-openentry.md) или [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span><span class="sxs-lookup"><span data-stu-id="a1658-157">If you have no information about the target objects, call [IMAPISession::OpenEntry](imapisession-openentry.md) or [IMAPISession::CompareEntryIDs](imapisession-compareentryids.md).</span></span> <span data-ttu-id="a1658-158">Такой подход обеспечивает доступ к любой объект, но не самые медленные из трех.</span><span class="sxs-lookup"><span data-stu-id="a1658-158">This approach enables access to any object, but is the slowest of the three.</span></span>
    
- <span data-ttu-id="a1658-159">Если вы уверены, что целевых объектов адресной книги, а не, например, папки, вызовите метод [IAddrBook::OpenEntry](iaddrbook-openentry.md) или [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) .</span><span class="sxs-lookup"><span data-stu-id="a1658-159">If you know that the target objects are address book entries rather than, for example, folders, call the [IAddrBook::OpenEntry](iaddrbook-openentry.md) or [IAddrBook::CompareEntryIDs](iaddrbook-compareentryids.md) method.</span></span> <span data-ttu-id="a1658-160">**IAddrBook::OpenEntry** открывает корневой контейнер адресной книги, если в качестве целевого объекта указано значение NULL.</span><span class="sxs-lookup"><span data-stu-id="a1658-160">**IAddrBook::OpenEntry** opens the root container of the address book when NULL is specified as the target object.</span></span> <span data-ttu-id="a1658-161">Такой подход обеспечивает доступ к любой объект адресной книги и быстрее, чем **IMAPISession**, но более медленными, чем использование **IMAPIContainer**.</span><span class="sxs-lookup"><span data-stu-id="a1658-161">This approach enables access to any address book object and is faster than using **IMAPISession**, but slower than using **IMAPIContainer**.</span></span>
    
- <span data-ttu-id="a1658-162">Если идентификатор записи является идентификатором краткосрочных запись или вы знаете, что целевых объектов принадлежащих контейнер определенный адресной книги или папки, вызовите метод [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) .</span><span class="sxs-lookup"><span data-stu-id="a1658-162">If the entry identifier being used is a short-term entry identifier or if you know that the target objects belong to a particular address book container or folder, call the [IMAPIContainer::OpenEntry](imapicontainer-openentry.md) method.</span></span> <span data-ttu-id="a1658-163">Такой подход обеспечивает максимальное быстродействие, но обеспечивает доступ только к объектам в конкретных контейнер или папки.</span><span class="sxs-lookup"><span data-stu-id="a1658-163">This approach yields the fastest performance, but enables access only to objects in a specific container or folder.</span></span> 
    


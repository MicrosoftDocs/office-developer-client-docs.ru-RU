---
title: Свойства строки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63d7360a-e3a3-4365-9d46-50df1c715bde
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9720b649eadecc73d84d98926674a1786796ba70
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431395"
---
# <a name="mapi-string-properties"></a>Свойства строки MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
MAPI предоставляет три различных типа свойств для описания свойств строки:
  
PT_TSTRING
  
PT_STRING8
  
PT_UNICODE
  
Свойства строки чаще всего определяются как PT_TSTRING. Тип PT_TSTRING условно компилируются в один из других типов строки в зависимости от того, определен ли макрос UNICODE. PT_STRING8 в формате ANSI описываются 8-битные строки символов, оканчивые нулями; PT_UNICODE двухбайтовую строку символов с символами с нулью. 
  
Клиент или поставщик услуг или оба клиента и поставщик могут выбрать поддержку строк символов Юникода. Это не обязательно. Клиент, который поддерживает только PT_STRING8 строк, может работать с поставщиком, который поддерживает Юникод и наоборот. Чтобы обеспечить такое взаимозаменяемость, клиенты и поставщики услуг передают флаг MAPI_UNICODE, чтобы указать, что Юникод поддерживается в методах, в которые включается обмен строками символов. 
  
Например, предположим, что клиент поддерживает Юникод и должен получить отображаемого имени папки. Все свойства PT_TSTRING клиента компилются для PT_UNICODE. Когда клиент вызывает метод [IMAPIProp::GetProps](imapiprop-getprops.md) папки для получения свойства **PR_DISPLAY_NAME** ([PidTagDisplayName),](pidtagdisplayname-canonical-property.md)он передает флаг MAPI_UNICODE, чтобы запросить возврат строки отображаемого имени в формате Юникод. 
  
Клиенты и поставщики услуг должны знать, что указание набора символов в вызове метода — это только запрос. Поддержка одного или обоих наборов символов определяется реализацией объекта. Однако поставщикам услуг рекомендуется поддерживать оба набора символов, так как это позволяет им обеспечить более широкое распространение, чем поставщики, которые поддерживают только один набор. 
  
Строки могут быть довольно большими, как и двоичные свойства— свойства, которые используют тип свойства PT_BINARY. Чтобы упростить работу с большими свойствами, MAPI позволяет поставщикам услуг устанавливать эти свойства для применения ограничений размера. Эти ограничения могут отличаться в зависимости от:
  
- Является ли чтение или написание свойств.
    
- Способ реализации методов **IMAPIProp** поставщиком услуг. 
    
- Вопросы, связанные со временем работы, например ограничения памяти.
    
- Проблемы перевода наборов символов. 
    
Ограничения размера также можно установить на строку и двоичные свойства, если они используются в наборе столбцов таблицы, так как иногда невозможно сделать видимым все значения большого свойства. Многие поставщики услуг утесируют большие строковые или двоичные свойства, используемые в таблицах, до 255 bytes. 
  
Когда клиент вызывает метод **GetProps** или **SetProps** объекта для работы с большой строкой или двоичным свойством и вызов не удается из-за размера свойства, метод возвращает значение ошибки MAPI_E_NOT_ENOUGH_MEMORY. Если для определенного свойства не удается получить запрос **GetProps,** клиент может восстановиться, вызывая [IMAPIProp::OpenProperty](imapiprop-openproperty.md) и запрашивая доступ к **IStream,** указав IID_IStream в качестве идентификатора интерфейса. С **помощью OpenProperty** клиент может получить большое свойство с помощью такого интерфейса, как **IStream,** который лучше подходит для работы с большими свойствами. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


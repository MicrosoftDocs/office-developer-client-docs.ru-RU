---
title: Свойства строки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63d7360a-e3a3-4365-9d46-50df1c715bde
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9720b649eadecc73d84d98926674a1786796ba70
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431395"
---
# <a name="mapi-string-properties"></a>Свойства строки MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В интерфейсе MAPI предусмотрены три различных типа свойств, описывающих свойства String:
  
PT_TSTRING
  
PT_STRING8
  
PT_UNICODE
  
Свойства String чаще всего определяются как PT_TSTRING. Тип свойства PT_TSTRING условно компилируется в один из других типов строковых свойств, в зависимости от того, был ли определен макрос UNICODE. PT_STRING8 описывает 8 – битовые строки символов с завершающим нулем в формате ANSI; PT_UNICODE описаны строки двухбайтовых символов, заканчивающихся нулем. 
  
Как клиент, так и поставщик услуг или как клиент, так и поставщик могут поддерживать строки символов Юникода. Он не является обязательным. Клиент, поддерживающий только PT_STRING8 строки, может работать с поставщиком, поддерживающим Юникод и наоборот. Чтобы обеспечить это взаимодействие, клиенты и поставщики услуг передают флаг, флаг MAPI_UNICODE, чтобы указать, что Юникод поддерживается в методах, использующих обмен символьных строк. 
  
Например, предположим, что клиент поддерживает Юникод и требуется получить отображаемое имя папки. Все свойства PT_TSTRING клиента компилируются в тип PT_UNICODE. Когда клиент вызывает метод [IMAPIProp::-PROPS](imapiprop-getprops.md) папки для получения свойства **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)), он передает флаг MAPI_UNICODE, чтобы запросить возврат строки отображаемого имени в формате Юникод. 
  
Клиенты и поставщики услуг должны знать, что при указании набора символов в вызове метода используется только запрос. Поддержка одного или обоих наборов знаков осуществляется разработчиком объекта. Однако поставщикам услуг рекомендуется поддерживать оба набора символов, так как они позволяют им добиться более широкого распространения, чем поставщики, поддерживающие только один набор. 
  
Строковые свойства могут увеличиваться до очень большого размера, как и двоичные свойства — свойства, использующие тип свойства PT_BINARY. Для упрощения работы с большими свойствами MAPI позволяет поставщикам услуг настроить эти свойства для применения ограниченности размеров. Эти пределы могут различаться в зависимости от следующих условий:
  
- Сведения о том, считываются ли свойства или записываются.
    
- Как поставщик услуг реализует методы **IMAPIProp** . 
    
- Рекомендации среды выполнения, такие как ограничения памяти.
    
- Проблемы с преобразованием набора символов. 
    
Кроме того, при использовании в наборе столбцов таблицы для свойств String и binary можно установить предельные значения размера, так как иногда невозможно сделать видимым все значения больших свойств. Многие поставщики услуг усекаются большие строковые или двоичные свойства, используемые в таблицах до 255 байт. 
  
Когда клиент вызывает метод **GetProperty или метод** **SetProps** для работы с большим строковым или двоичным свойством, а вызов завершается со сбоем из-за размера свойства, метод возвращает значение ошибки MAPI_E_NOT_ENOUGH_MEMORY. Если это **PROPS** , который отдает отказ для определенного свойства, клиент может выполнить восстановление, вызвав [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) и запрашивая интерфейс **IStream** для Access, указав IID_IStream в качестве идентификатора интерфейса. С помощью **опенпроперти**клиент может получить большое свойство с помощью интерфейса **IStream** , который лучше всего подходит для работы с большими свойствами. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


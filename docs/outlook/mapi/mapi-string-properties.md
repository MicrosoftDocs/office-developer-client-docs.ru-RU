---
title: Строковые свойства MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63d7360a-e3a3-4365-9d46-50df1c715bde
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3cf118866bbc305678201a42a9a91998334f5cb0
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809844"
---
# <a name="mapi-string-properties"></a>Строковые свойства MAPI

  
  
**Относится к**: Outlook 
  
MAPI предоставляет три различных типа свойств для описания строковые свойства:
  
PT_TSTRING
  
PT_STRING8
  
PT_UNICODE
  
Строка чаще всего определены как PT_TSTRING. Тип свойства PT_TSTRING условно компилирует к одному из других типов свойств строку, в зависимости от того, в зависимости от того, было определено ли макрос Юникод. PT_STRING8 описывает 8-разрядных символом null строк в формате ANSI. PT_UNICODE описание символом null двухбайтовой строк. 
  
Либо клиента или поставщика услуг или клиента и поставщика можно выбрать для поддержки знаков Юникод. Не требуется. Клиент, который поддерживает только PT_STRING8 строк может работать с поставщиком, который поддерживает Юникод и наоборот. Чтобы включить этот взаимодействие, клиентов и поставщиков услуг передайте флаг, флаг MAPI_UNICODE для указания поддержки Юникод в методах, в которых используются exchange строк символов. 
  
Предположим, например, клиент поддерживает Юникод и требуется получить отображаемое имя папки. Все свойства PT_TSTRING клиента компилируются в введите PT_UNICODE. Если клиент вызывает метод [IMAPIProp::GetProps](imapiprop-getprops.md) папки для получения его свойство **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)), он передает флаг MAPI_UNICODE для запроса возвращение строку отображаемое имя в формате Юникод . 
  
Клиенты и поставщики услуг следует знать, определяющее набор символов в вызове метода представляет собой запрос. Поддержка одного или обоих наборов знаков — специалист по реализации объекта. Тем не менее поставщиков услуг, рекомендуется для поддержки оба набора символов, так как он позволяет добиться более распространенными рассылки более поставщиков, которые поддерживают только один набор. 
  
Строковые свойства при изменении быть большого как двоичные свойства — свойства, используйте свойство введите PT_BINARY. Для облегчения работы с большой свойств MAPI позволяет поставщиков услуг Установка этих свойств для принудительного применения ограничения размера. Эти ограничения могут различаться, в зависимости от:
  
- Выполняется ли свойства для чтения или записи.
    
- Как поставщик услуг реализует методы **IMAPIProp** . 
    
- Вопросы среды выполнения, в том числе объемом доступной памяти.
    
- Проблемы преобразования наборов символов. 
    
Ограничения на размер можно разместить на строку и двоичные свойства, если они используются в столбце задан таблицы, так как в некоторых случаях невозможно отобразить все значения для крупных свойства. Многие поставщики услуг усекать больших строка или двоичные свойства, используемые в таблицах до 255 байт. 
  
Когда клиент вызывает метод **GetProps** или **SetProps** объекта для работы с большой строку или двоичного свойства и завершается неудачно из-за размера свойства, метод возвращает значение ошибки MAPI_E_NOT_ENOUGH_MEMORY. Если это ошибочных для конкретного свойства **GetProps** клиента можно восстановить путем вызова [IMAPIProp::OpenProperty](imapiprop-openproperty.md) и разрешения на запрос **IStream** для доступа, указав в качестве идентификатора интерфейса IID_IStream. С помощью **OpenProperty**, можно получить большой свойства с помощью интерфейса, таких как **IStream** , который лучше всего подходит для работы с большой свойства. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


---
title: Свойства строки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 63d7360a-e3a3-4365-9d46-50df1c715bde
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9720b649eadecc73d84d98926674a1786796ba70
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33431395"
---
# <a name="mapi-string-properties"></a>Свойства строки MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
MAPI предоставляет три различных типа свойств для описания свойств строк:
  
PT_TSTRING
  
PT_STRING8
  
PT_UNICODE
  
Свойства строки чаще всего определяются как PT_TSTRING. Тип PT_TSTRING условно компилирует один из других типов свойств строк в зависимости от того, определен ли макрос UNICODE. PT_STRING8 описывает 8-битные null-terminated строки символов в формате ANSI; PT_UNICODE описывает строки символов с двойным byte null-terminated. 
  
Клиент или поставщик услуг или как клиент, так и поставщик могут выбрать для поддержки строк символов Юникод. Это не обязательно. Клиент, который поддерживает только PT_STRING8 строки, может работать с поставщиком, который поддерживает Юникод и наоборот. Чтобы включить эту интероперабельность, клиенты и поставщики услуг передают флаг , флаг MAPI_UNICODE, чтобы указать, что Юникод поддерживается методами, которые включают обмен строками символов. 
  
Например, предположим, что клиент поддерживает Юникод и должен получить отображаемую папку. Все свойства клиента PT_TSTRING, чтобы ввести PT_UNICODE. Когда клиент вызывает [IMAPIProp::GetProps](imapiprop-getprops.md) для получения свойства **PR_DISPLAY_NAME** [(PidTagDisplayName),](pidtagdisplayname-canonical-property.md)он передает флаг MAPI_UNICODE, чтобы попросить вернуть строку имени отображения в формате Unicode. 
  
Клиенты и поставщики услуг должны знать, что указание набора символов в методовом вызове — это только запрос. Поддержка одного или обоих наборов символов — это решение для реализации объекта. Однако поставщикам услуг рекомендуется поддерживать оба набора символов, так как это позволяет им добиваться более широкого распространения, чем поставщики, которые поддерживают только один набор. 
  
Свойства строки могут быть довольно большими, как и двоичные свойства — свойства, которые используют тип свойства PT_BINARY. Чтобы облегчить работу с большими свойствами, MAPI позволяет поставщикам услуг устанавливать эти свойства для применения ограничений размера. Эти ограничения могут отличаться в зависимости от:
  
- Читают ли свойства или пишутся.
    
- Как поставщик услуг реализует методы **IMAPIProp.** 
    
- Соображения, связанные с временем работы, например ограничения памяти.
    
- Проблемы перевода набора символов. 
    
Ограничения размера также могут быть размещены на свойствах строк и двоичных объектов, когда они используются в наборе столбцов таблицы, так как иногда невозможно сделать все значение большого свойства видимым. Многие поставщики услуг усечены большими строками или двоичными свойствами, используемыми в таблицах, до 255 bytes. 
  
Когда клиент вызывает метод **GetProps** или **SetProps** объекта для работы с большим свойством строки или двоичного свойства и вызов не удается из-за размера свойства, метод возвращает значение ошибки MAPI_E_NOT_ENOUGH_MEMORY. Если для определенного свойства не удается **получитьПропс,** клиент может восстановиться, позвонив [в IMAPIProp::OpenProperty](imapiprop-openproperty.md) и запросив доступ к **IStream,** указав IID_IStream в качестве идентификатора интерфейса. С **помощью OpenProperty** клиент может получить большое свойство с помощью интерфейса, например **IStream,** который лучше подходит для работы с большими свойствами. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


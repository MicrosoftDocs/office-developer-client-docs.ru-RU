---
title: Поддержка вложений сообщений для поставщиков хранилищ сообщений
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412137"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a>Поддержка вложений сообщений для поставщиков хранилищ сообщений

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщик хранилища сообщений не обязан поддерживать вложения сообщений. Однако многие клиентские приложения ожидают, что в сообщения могут добавляться вложения. Если хранилище сообщений будет использоваться для создания или хранения IPM. Обратите внимание, что вы должны поддерживать вложения сообщений. Поставщики хранилища сообщений по умолчанию также должны поддерживать вложения сообщений. Дополнительные сведения см. в разделе [классы сообщений MAPI](mapi-message-classes.md)и [хранилища сообщений по умолчанию](default-message-stores.md).
  
Существует пять типов вложений, поддерживаемых MAPI: файловые вложения, вложения данных, вложения сообщений, вложения объектов OLE и ссылки. Требования для поддержки каждого типа различаются. Клиенты различают два типа вложений с помощью свойства **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) объектов вложений.
  
Поддержка вложений подразумевает реализацию интерфейса [иаттач: IMAPIProp](iattachimapiprop.md) . Интерфейс **иаттач** не имеет собственных методов; Он содержит только методы, наследуемые от интерфейса [IMAPIProp](imapipropiunknown.md) . Так как у поставщика хранилища сообщений уже должны быть реализованы свойства объектов сообщений, это значительно упрощает задачу поддержки вложений. Реализация **иаттач** по существу означает предоставление клиентам доступа к таблице свойств для определенных вложений в сообщениях. 
  
Вложения данных — это просто вложения, для которых содержимое вложения хранится непосредственно в свойстве **PR_ATTACH_DATA_BIN** вложения ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)). Вложения данных существуют в основном для того, чтобы клиенты прикреплять файлы к сообщению, когда отправитель и получатель сообщения не имеют доступа к общему файловому серверу. Для получения дополнительных сведений просмотрите свойство **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).
  
Вложения сообщений — это вложения, для которых вложенным объектом является другой объект [iMessage: мапипроп](imessageimapiprop.md) . Так как поставщики хранилища сообщений уже поддерживают интерфейс **iMessage** , поддержка вложений сообщений не является сложной задачей. 
  
Поддержка вложений объектов OLE подразумевает реализацию интерфейсов OLE **IStorage**, **IStream**и **помощью istreamdocfile** . Поставщик хранилища сообщений должен иметь возможность преобразования данных объекта OLE, хранящихся в сообщении, в активный объект OLE, когда клиент открывает объект. 
  
Ссылки могут находиться в двух типах: ссылки на файлы и ссылки на другие сообщения. Ссылки на файлы используют значение ATTACH_BY_REF_ONLY для свойства **PR_ATTACH_METHOD** вместе с **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) или **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)), чтобы указать расположение файла.
  
Способ реализации ссылок на сообщения могут зависеть от аспектов локальной системы обмена сообщениями и, как указано, в этом случае не может быть полностью задокументирована. Например, Отправка ссылки на сообщение, хранящаяся в хранилище сообщений на сервере, обычно заключается в отправке идентификатора записи связанного сообщения, при условии, что у отправителя и получателя есть доступ к этому серверу. Другие конфигурации системы обмена сообщениями предоставляют другие требования и проблемы, возникающие при внедрении ссылок на сообщения.
  
## <a name="see-also"></a>См. также



[���������� ��������� ���������](message-store-features.md)


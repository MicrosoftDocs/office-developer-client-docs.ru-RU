---
title: Поддержка вложений к сообщениям для поставщиков хранилищ сообщений
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: 'Дата последнего изменения: 7 декабря 2015 года'
ms.openlocfilehash: a94d1230f4f26d080976fd15768bdfeb6ea04748
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22576101"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a>Поддержка вложений к сообщениям для поставщиков хранилищ сообщений

 
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщик хранилища сообщений не требуется поддержка вложений сообщений. Тем не менее многие клиентские приложения согласно прогнозу, будут иметь возможность добавления вложений в сообщения. Если хранения сообщений будет использоваться для создания или хранить IPM. Примечание сообщения, а затем вы должны поддерживать вложений сообщений. Поставщики хранилища сообщений по умолчанию также должны поддерживать вложений сообщений. Для получения дополнительных сведений см [Классы сообщений MAPI](mapi-message-classes.md)и [Хранилищ сообщений по умолчанию](default-message-stores.md).
  
Существует пять типов вложений, которые поддерживает MAPI: файлов вложений, данные вложения, вложения, вложения объектов OLE и ссылки. Требования для поддержки каждого типа отличаются. Клиенты различать два типа вложений при помощи свойства **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) на объекты вложения.
  
Поддержка вложений означает, что реализация [IAttach: IMAPIProp](iattachimapiprop.md) интерфейса. Интерфейс **IAttach** не имеет методов собственных; содержит только методы, наследуемые из интерфейса [IMAPIProp](imapipropiunknown.md) . Так как поставщика хранилища сообщений уже должен реализовывать свойства для объектов-сообщение, это существенно упрощает работу с поддержкой вложения. Реализация **IAttach** по сути означает, что предоставление клиентам возможности доступа к таблице свойств для конкретного вложения в сообщениях. 
  
Данные вложения, просто вложения, для которых содержимое вложения хранятся непосредственно в свойство **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) вложения. Данные вложениями в первую очередь, чтобы позволить клиентам подключение файлов на сообщение, если отправитель и получатель сообщения не имеют доступа к серверу общих файлов. Для получения дополнительных сведений см **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).
  
Вложения сообщения, вложения, для которых вложения вложенного объекта является другой [IMessage: MAPIProp](imessageimapiprop.md) объекта. Поскольку поставщики хранилища сообщений уже поддерживают интерфейс **IMessage** , поддерживающие вложений сообщений не затруднения. 
  
Поддержка вложений объекта OLE означает, что реализации интерфейсов OLE **IStorage** **IStream**и **IStreamDocfile** . Поставщик хранилища сообщений должен быть способен для преобразования OLE объекта данными в сообщения в активного объекта OLE при открытии объекта клиента. 
  
Ссылки бывают двух типов: ссылки на файлы, а также ссылки на другие сообщения. Ссылки на файлы использовать значение ATTACH_BY_REF_ONLY для свойства **PR_ATTACH_METHOD** , а также **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) или **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) для указания расположение файла.
  
Как один реализует ссылки на сообщения могут зависеть от аспекты локальной системы обмена сообщениями и, таким образом, не может быть полностью задокументированы здесь. Например Отправка ссылки для сообщений, которые хранятся на хранилища сообщений на основе сервера достаточно обычно отправки запись идентификатор связанного сообщения, предоставляя, что отправитель и получатель имеют доступ к серверу. Другие системы обмена сообщениями конфигурации системы представить другие требования и задачи для реализации ссылки на сообщения.
  
## <a name="see-also"></a>См. также



[���������� ��������� ���������](message-store-features.md)


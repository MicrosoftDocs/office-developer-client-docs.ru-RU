---
title: Поддержка вложений сообщений для поставщиков хранилищ сообщений
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32350626"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a>Поддержка вложений сообщений для поставщиков хранилищ сообщений

 
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщик хранилища сообщений не обязан поддерживать вложения сообщений. Однако многие клиентские приложения ожидают, что в сообщения могут добавляться вложения. Если хранилище сообщений будет использоваться для создания или хранения IPM. Обратите внимание, что вы должны поддерживать вложения сообщений. Поставщики хранилища сообщений по умолчанию также должны поддерживать вложения сообщений. Дополнительные сведения см. в разделе [классы сообщений MAPI](mapi-message-classes.md)и [хранилища сообщений по умолчанию](default-message-stores.md).
  
Существует пять типов вложений, поддерживаемых MAPI: файловые вложения, вложения данных, вложения сообщений, вложения объектов OLE и ссылки. Требования для поддержки каждого типа различаются. Клиенты различают два типа вложений с помощью свойства **пр_аттач_месод** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) объектов вложений.
  
Поддержка вложений подразумевает реализацию интерфейса [иаттач: IMAPIProp](iattachimapiprop.md) . Интерфейс **иаттач** не имеет собственных методов; Он содержит только методы, наследуемые от интерфейса [IMAPIProp](imapipropiunknown.md) . Так как у поставщика хранилища сообщений уже должны быть реализованы свойства объектов сообщений, это значительно упрощает задачу поддержки вложений. Реализация **иаттач** по существу означает предоставление клиентам доступа к таблице свойств для определенных вложений в сообщениях. 
  
Вложения данных — это просто вложения, для которых содержимое вложения хранится непосредственно в свойстве **пр_аттач_дата_бин** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) вложения. Вложения данных существуют в основном для того, чтобы клиенты прикреплять файлы к сообщению, когда отправитель и получатель сообщения не имеют доступа к общему файловому серверу. Дополнительные сведения см. в разделе свойство **пр_аттач_месод** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).
  
Вложения сообщений — это вложения, для которых вложенным объектом является другой объект [iMessage: мапипроп](imessageimapiprop.md) . Так как поставщики хранилища сообщений уже поддерживают интерфейс **iMessage** , поддержка вложений сообщений не является сложной задачей. 
  
Поддержка вложений объектов OLE подразумевает реализацию интерфейсов OLE **IStorage**, **IStream**и **помощью istreamdocfile** . Поставщик хранилища сообщений должен иметь возможность преобразования данных объекта OLE, хранящихся в сообщении, в активный объект OLE, когда клиент открывает объект. 
  
Ссылки могут находиться в двух типах: ссылки на файлы и ссылки на другие сообщения. Ссылки на файлы используют значение АТТАЧ_БИ_РЕФ_ОНЛИ для свойства **пр_аттач_месод** вместе с **пр_аттач_паснаме** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) или **пр_аттач_лонг_паснаме** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)), чтобы указать расположение файла.
  
Способ реализации ссылок на сообщения могут зависеть от аспектов локальной системы обмена сообщениями и, как указано, в этом случае не может быть полностью задокументирована. Например, Отправка ссылки на сообщение, хранящаяся в хранилище сообщений на сервере, обычно заключается в отправке идентификатора записи связанного сообщения, при условии, что у отправителя и получателя есть доступ к этому серверу. Другие конфигурации системы обмена сообщениями предоставляют другие требования и проблемы, возникающие при внедрении ссылок на сообщения.
  
## <a name="see-also"></a>См. также



[���������� ��������� ���������](message-store-features.md)


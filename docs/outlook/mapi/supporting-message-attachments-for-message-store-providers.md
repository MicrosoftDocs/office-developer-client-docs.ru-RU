---
title: Поддержка вложений сообщений для поставщиков магазинов сообщений
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412137"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a>Поддержка вложений сообщений для поставщиков магазинов сообщений

 
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщику магазина сообщений не требуется поддерживать вложения сообщений. Однако многие клиентские приложения ожидают, что они смогут добавлять вложения в сообщения. Если хранилище сообщений будет использоваться для создания или хранения IPM. Примечание сообщений, то вы должны поддерживать вложения сообщений. Поставщики хранения сообщений по умолчанию также должны поддерживать вложения сообщений. Дополнительные сведения см. в [нескольких классах сообщений MAPI](mapi-message-classes.md)и магазинах [сообщений по умолчанию.](default-message-stores.md)
  
MapI поддерживает пять типов вложений: вложения файлов, вложения данных, вложения сообщений, объектные вложения OLE и ссылки. Требования для поддержки каждого типа отличаются. Клиенты различают два типа вложений с помощью **свойства** [PR_ATTACH_METHOD (PidTagAttachMethod)](pidtagattachmethod-canonical-property.md)на объектах вложений.
  
Поддержка вложений означает реализацию [интерфейса IAttach : IMAPIProp.](iattachimapiprop.md) Интерфейс **IAttach** не имеет собственных методов; он имеет только методы, унаследованные от [интерфейса IMAPIProp.](imapipropiunknown.md) Так как поставщик хранения сообщений уже должен реализовать свойства для объектов сообщений, это значительно упрощает задачу поддержки вложений. Реализация **IAttach в** основном означает предоставление клиентам доступа к таблице свойств для определенных вложений в сообщениях. 
  
Вложения данных — это просто вложения, для которых **содержимое вложения** хранится непосредственно в свойстве [PR_ATTACH_DATA_BIN (PidTagAttachDataBinary).](pidtagattachdatabinary-canonical-property.md) Вложения данных существуют прежде всего для того, чтобы позволить клиентам прикреплять файлы к сообщению, если отправитель и получатель сообщения не имеют доступа к общему серверу файлов. Дополнительные сведения см. в **PR_ATTACH_METHOD** [(PidTagAttachMethod).](pidtagattachmethod-canonical-property.md)
  
Вложения сообщений — это вложения, для которых подобект вложения является еще одним [объектом IMessage: MAPIProp.](imessageimapiprop.md) Поскольку поставщики магазинов сообщений уже поддерживают **интерфейс IMessage,** поддержка вложений сообщений не является сложной задачей. 
  
Поддержка вложений объектов OLE означает реализацию интерфейсов OLE **IStorage,** **IStream** и **IStreamDocfile.** Поставщик магазина сообщений должен иметь возможность преобразовать объектные данные OLE, хранимые в сообщении, в активный объект OLE при открываемом клиентом объекте. 
  
Ссылки приходят в двух типах: ссылки на файлы и ссылки на другие сообщения. Ссылки на файлы используют ATTACH_BY_REF_ONLY для свойства **PR_ATTACH_METHOD** вместе с **PR_ATTACH_PATHNAME** [(PidTagAttachPathname)](pidtagattachpathname-canonical-property.md)или **PR_ATTACH_LONG_PATHNAME** [(PidTagAttachLongPathname)](pidtagattachlongpathname-canonical-property.md)для указания расположения файла.
  
То, как реализовать ссылки на сообщения, может зависеть от аспектов локальной системы обмена сообщениями и, как таковой, не может быть полностью задокументировано здесь. Например, отправка ссылки на сообщение, которое хранится в серверном хранилище сообщений, как правило, является просто отправкой идентификатора входа связанного сообщения, при этом отправитель и получатель имеют доступ к этому серверу. Другие конфигурации системы обмена сообщениями представляют другие требования и проблемы для реализации ссылок на сообщения.
  
## <a name="see-also"></a>См. также



[���������� ��������� ���������](message-store-features.md)


---
title: Поддержка вложений сообщений для поставщиков хранилищ сообщений
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d5fabc40-71e8-4afa-9846-533da605ce6c
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 69d1df5bf206cddd0d25698665c9fd87b81e4ea5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412137"
---
# <a name="supporting-message-attachments-for-message-store-providers"></a><span data-ttu-id="9ba0a-103">Поддержка вложений сообщений для поставщиков хранилищ сообщений</span><span class="sxs-lookup"><span data-stu-id="9ba0a-103">Supporting Message Attachments for Message Store Providers</span></span>

 
  
<span data-ttu-id="9ba0a-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9ba0a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9ba0a-105">Поставщик хранилища сообщений не обязан поддерживать вложения сообщений.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-105">Your message store provider does not need to support message attachments.</span></span> <span data-ttu-id="9ba0a-106">Однако многие клиентские приложения ожидают, что в сообщения могут добавляться вложения.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-106">However, many client applications expect to be able to add attachments to messages.</span></span> <span data-ttu-id="9ba0a-107">Если хранилище сообщений будет использоваться для создания или хранения IPM. Обратите внимание, что вы должны поддерживать вложения сообщений.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-107">If your message store will be used to create or store IPM.Note messages, then you should support message attachments.</span></span> <span data-ttu-id="9ba0a-108">Поставщики хранилища сообщений по умолчанию также должны поддерживать вложения сообщений.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-108">Default message store providers should also support message attachments.</span></span> <span data-ttu-id="9ba0a-109">Дополнительные сведения см. в разделе [классы сообщений MAPI](mapi-message-classes.md)и [хранилища сообщений по умолчанию](default-message-stores.md).</span><span class="sxs-lookup"><span data-stu-id="9ba0a-109">For more information, see [MAPI Message Classes](mapi-message-classes.md), and [Default Message Stores](default-message-stores.md).</span></span>
  
<span data-ttu-id="9ba0a-110">Существует пять типов вложений, поддерживаемых MAPI: файловые вложения, вложения данных, вложения сообщений, вложения объектов OLE и ссылки.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-110">There are five types of attachments that MAPI supports: file attachments, data attachments, message attachments, OLE object attachments, and links.</span></span> <span data-ttu-id="9ba0a-111">Требования для поддержки каждого типа различаются.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-111">The requirements for supporting each type are different.</span></span> <span data-ttu-id="9ba0a-112">Клиенты различают два типа вложений с помощью свойства **пр_аттач_месод** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) объектов вложений.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-112">Clients differentiate between the two types of attachments by means of the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property on attachment objects.</span></span>
  
<span data-ttu-id="9ba0a-113">Поддержка вложений подразумевает реализацию интерфейса [иаттач: IMAPIProp](iattachimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="9ba0a-113">Supporting attachments means implementing the [IAttach : IMAPIProp](iattachimapiprop.md) interface.</span></span> <span data-ttu-id="9ba0a-114">Интерфейс **иаттач** не имеет собственных методов; Он содержит только методы, наследуемые от интерфейса [IMAPIProp](imapipropiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="9ba0a-114">The **IAttach** interface has no methods of its own; it has only methods that are inherited from the [IMAPIProp](imapipropiunknown.md) interface.</span></span> <span data-ttu-id="9ba0a-115">Так как у поставщика хранилища сообщений уже должны быть реализованы свойства объектов сообщений, это значительно упрощает задачу поддержки вложений.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-115">Because your message store provider must already implement properties for message objects, this greatly simplifies the task of supporting attachments.</span></span> <span data-ttu-id="9ba0a-116">Реализация **иаттач** по существу означает предоставление клиентам доступа к таблице свойств для определенных вложений в сообщениях.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-116">Implementing **IAttach** basically means providing a way for clients to access a table of properties for particular attachments on messages.</span></span> 
  
<span data-ttu-id="9ba0a-117">Вложения данных — это просто вложения, для которых содержимое вложения хранится непосредственно в свойстве **пр_аттач_дата_бин** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) вложения.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-117">Data attachments are simply attachments for which the contents of the attachment are stored directly in an attachment's **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) property.</span></span> <span data-ttu-id="9ba0a-118">Вложения данных существуют в основном для того, чтобы клиенты прикреплять файлы к сообщению, когда отправитель и получатель сообщения не имеют доступа к общему файловому серверу.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-118">Data attachments exist primarily to allow clients to attach files to a message when the sender and the recipient of the message do not have access to a common file server.</span></span> <span data-ttu-id="9ba0a-119">Дополнительные сведения см. в разделе свойство **пр_аттач_месод** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="9ba0a-119">For more information, see the **PR_ATTACH_METHOD** ([PidTagAttachMethod](pidtagattachmethod-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="9ba0a-120">Вложения сообщений — это вложения, для которых вложенным объектом является другой объект [iMessage: мапипроп](imessageimapiprop.md) .</span><span class="sxs-lookup"><span data-stu-id="9ba0a-120">Message attachments are attachments for which the attachment subobject is another [IMessage : MAPIProp](imessageimapiprop.md) object.</span></span> <span data-ttu-id="9ba0a-121">Так как поставщики хранилища сообщений уже поддерживают интерфейс **iMessage** , поддержка вложений сообщений не является сложной задачей.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-121">Because message store providers already support the **IMessage** interface, supporting message attachments is not difficult.</span></span> 
  
<span data-ttu-id="9ba0a-122">Поддержка вложений объектов OLE подразумевает реализацию интерфейсов OLE **IStorage**, **IStream**и **помощью istreamdocfile** .</span><span class="sxs-lookup"><span data-stu-id="9ba0a-122">Supporting OLE object attachments means implementing the OLE **IStorage**, **IStream**, and **IStreamDocfile** interfaces.</span></span> <span data-ttu-id="9ba0a-123">Поставщик хранилища сообщений должен иметь возможность преобразования данных объекта OLE, хранящихся в сообщении, в активный объект OLE, когда клиент открывает объект.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-123">Your message store provider must be able to convert OLE object data stored in the message into an active OLE object when a client opens the object.</span></span> 
  
<span data-ttu-id="9ba0a-124">Ссылки могут находиться в двух типах: ссылки на файлы и ссылки на другие сообщения.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-124">Links come in two types: links to files and links to other messages.</span></span> <span data-ttu-id="9ba0a-125">Ссылки на файлы используют значение АТТАЧ_БИ_РЕФ_ОНЛИ для свойства \*\*пр_аттач_месод\*\* вместе с \*\*пр_аттач_паснаме\*\* ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) или \*\*пр_аттач_лонг_паснаме\*\* ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)), чтобы указать расположение файла.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-125">Links to files use the ATTACH_BY_REF_ONLY value for the **PR_ATTACH_METHOD** property along with **PR_ATTACH_PATHNAME** ([PidTagAttachPathname](pidtagattachpathname-canonical-property.md)) or **PR_ATTACH_LONG_PATHNAME** ([PidTagAttachLongPathname](pidtagattachlongpathname-canonical-property.md)) to specify the location of a file.</span></span>
  
<span data-ttu-id="9ba0a-126">Способ реализации ссылок на сообщения могут зависеть от аспектов локальной системы обмена сообщениями и, как указано, в этом случае не может быть полностью задокументирована.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-126">How one implements links to messages may depend on aspects of the local messaging system and, as such, cannot be fully documented here.</span></span> <span data-ttu-id="9ba0a-127">Например, Отправка ссылки на сообщение, хранящаяся в хранилище сообщений на сервере, обычно заключается в отправке идентификатора записи связанного сообщения, при условии, что у отправителя и получателя есть доступ к этому серверу.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-127">For example, sending a link to a message that is stored on a server-based message store is typically just a matter of sending the entry identifier of the linked message, providing that both the sender and recipient have access to that server.</span></span> <span data-ttu-id="9ba0a-128">Другие конфигурации системы обмена сообщениями предоставляют другие требования и проблемы, возникающие при внедрении ссылок на сообщения.</span><span class="sxs-lookup"><span data-stu-id="9ba0a-128">Other messaging system configurations present other requirements and challenges for implementing links to messages.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="9ba0a-129">См. также</span><span class="sxs-lookup"><span data-stu-id="9ba0a-129">See also</span></span>



[<span data-ttu-id="9ba0a-130">���������� ��������� ���������</span><span class="sxs-lookup"><span data-stu-id="9ba0a-130">Message Store Features</span></span>](message-store-features.md)


---
title: Основной идентификатор MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: de1fe8fd5ef5a6e79934478c62b2403c48f85b5e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22565881"
---
# <a name="mapi-primary-identity"></a>Основной идентификатор MAPI

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Всего сеансов MAPI имеют поставщик определенной службы, которая предоставляет основной идентификатор для сеанса. Как правило это поставщика адресных книг, который предоставит identity через один из его обмена сообщениями объектов-пользователей или списки рассылки. На самом деле MAPI рекомендует службы сообщений, содержащих поставщика адресных книг использовать один из его объекты для основного удостоверения. Когда поставщик службы, к которой принадлежит служба сообщений предоставляет основного удостоверения, всех других поставщиков услуг службы сообщений совместно использовать это удостоверение.
  
Файл Mapisvc.inf. INF-файл конфигурации имеет операций, связанных с identity на уровне поставщика службы и службы сообщений. Разделы службы сообщений необходимо включить запись, указывающую ли служба можно указать основной идентификатор; разделы поставщика службы включать аналогичный элемент только в том случае, если поставщик может предоставить удостоверение.
  
В следующей таблице перечислены элементы, отображаемые в разделах поставщика службы в файл Mapisvc.inf и служба сообщений. INF-файл.
  
|**Основной идентификатор поставщика**|**Параметр PR_RESOURCE_FLAGS**|
|:-----|:-----|
|Служба сообщений  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|Не службы сообщений  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|Поставщик услуг  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
Несмотря на то, что несколько служб сообщения можно объявить свои возможности предоставления основной идентификатор сеанса, для этого установлен флажок служба только одно сообщение. Этот параметр может возникать:
  
- При создании профиля.
    
- Если клиент вызывает **IMsgServiceAdmin::SetPrimaryIdentity** явным образом установить службы конкретное сообщение как поставщик удостоверений сеанса. Для получения дополнительных сведений. В разделе [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).
    
При создании профиля MAPI определяет первый служба сообщений для настройки, которая включает в себя поставщика с STATUS_PRIMARY_IDENTITY флаг в своем свойстве **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) для предоставления основной идентификатор . В рамках службы выделенных сообщений первый поставщик задаются с помощью этого набора ресурсов флаг выбирается для предоставления идентификатора для службы. Флаг STATUS_PRIMARY_IDENTITY снят для всех поставщиков в выделенной службы и другие службы сообщений в профиле. Если в любой момент поставщика, передав основного удостоверения удаляется из профиля, MAPI, назначает роли для следующего поставщика, который требуется настроить, можно предоставить удостоверение. Это определяется внешний вид `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` запись в раздел поставщика в MAPISVC.INF. 
  
Когда клиент вызывает метод **IMsgServiceAdmin::SetPrimaryIdentity** службы сообщений, задает MAPIUID для поставщика услуг в пределах целевой службы. Для получения дополнительных сведений см [MAPIUID](mapiuid.md). Поставщик услуг, представленного **MAPIUID** назначена для предоставления основного удостоверения для службы сообщений и для сеанса и все прочие службы в службе будут использовать это удостоверение. 
  
Каждый поставщик службы сообщений, ответственность за предоставление основной идентификатор обновляет его строку в таблице состояния, чтобы включить следующие свойства.
  
|**Свойство основного удостоверения**|**Задайте значение**|
|:-----|:-----|
|**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))  <br/> |Отображаемое имя объекта, передав основного удостоверения.  <br/> |
|**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))  <br/> |Клавиша поиска для объекта, передав основного удостоверения.  <br/> |
|**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))  <br/> |Идентификатор записи для объекта, передав основного удостоверения.  <br/> |
   
 **Чтобы получить идентификатор записи для объекта, передав основного удостоверения**
  
- Вызовите метод **IMAPISession::QueryIdentity** . Для получения дополнительных сведений см [IMAPISession::QueryIdentity](imapisession-queryidentity.md). **QueryIdentity** выполняет поиск в таблице состояния для строки, которая содержит значение STATUS_PRIMARY_IDENTITY в столбце **PR_RESOURCE_FLAGS** и возвращает соответствующие **PR_IDENTITY_ENTRYID** как идентификатор записи для основной удостоверение. 
    


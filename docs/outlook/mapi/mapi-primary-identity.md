---
title: Основной идентификатор MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5bf88de280b012c54d4caaac6bdfe877f476ac37
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404724"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="c49ae-103">Основной идентификатор MAPI</span><span class="sxs-lookup"><span data-stu-id="c49ae-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="c49ae-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c49ae-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c49ae-105">Большинство сеансов MAPI имеют определенного поставщика услуг, который предоставляет основной идентификатор для сеанса.</span><span class="sxs-lookup"><span data-stu-id="c49ae-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="c49ae-106">Как правило, это поставщик адресных книг, который обеспечивает идентификацию через один из объектов пользователя обмена сообщениями или списков рассылки.</span><span class="sxs-lookup"><span data-stu-id="c49ae-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="c49ae-107">По сути, MAPI рекомендует, чтобы службы сообщений, которые включают поставщика адресных книг, использовали один из ее объектов для основного удостоверения.</span><span class="sxs-lookup"><span data-stu-id="c49ae-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="c49ae-108">Если поставщик услуг, принадлежащий службе сообщений, предоставляет основное удостоверение, все остальные поставщики услуг в службе сообщений совместно используют это удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="c49ae-109">MAPISVC. INF-файл конфигурации содержит записи, связанные с удостоверениями как на уровне службы сообщений, так и на уровне поставщика услуг.</span><span class="sxs-lookup"><span data-stu-id="c49ae-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="c49ae-110">Разделы службы сообщений должны включать запись, в которой указывается, может ли служба указать основной идентификатор; разделы поставщика услуг содержат Похожие записи, только когда поставщик может предоставить удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="c49ae-111">В следующей таблице перечислены записи, которые отображаются в разделах "Служба сообщений" и "поставщик услуг" в MAPISVC. INF-файл.</span><span class="sxs-lookup"><span data-stu-id="c49ae-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="c49ae-112">**Первичный поставщик удостоверений**</span><span class="sxs-lookup"><span data-stu-id="c49ae-112">**Primary identity supplier**</span></span>|<span data-ttu-id="c49ae-113">**Параметр ПР_РЕСАУРЦЕ_ФЛАГС**</span><span class="sxs-lookup"><span data-stu-id="c49ae-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="c49ae-114">Служба сообщений</span><span class="sxs-lookup"><span data-stu-id="c49ae-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="c49ae-115">Не служба сообщений</span><span class="sxs-lookup"><span data-stu-id="c49ae-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="c49ae-116">Поставщик услуг</span><span class="sxs-lookup"><span data-stu-id="c49ae-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="c49ae-117">Хотя несколько служб сообщений могут объявлять свои возможности для предоставления основного удостоверения сеанса, для этого выбирается только одна служба сообщений.</span><span class="sxs-lookup"><span data-stu-id="c49ae-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="c49ae-118">Это может произойти по следующим параметрам:</span><span class="sxs-lookup"><span data-stu-id="c49ae-118">This selection can occur:</span></span>
  
- <span data-ttu-id="c49ae-119">При создании профиля.</span><span class="sxs-lookup"><span data-stu-id="c49ae-119">When a profile is created.</span></span>
    
- <span data-ttu-id="c49ae-120">Когда клиент вызывает метод **имсгсервицеадмин:: сетпримаридентити** , чтобы явно установить определенную службу сообщений в качестве поставщика удостоверения сеанса.</span><span class="sxs-lookup"><span data-stu-id="c49ae-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="c49ae-121">Для получения дополнительных сведений.</span><span class="sxs-lookup"><span data-stu-id="c49ae-121">For more information.</span></span> <span data-ttu-id="c49ae-122">См. [имсгсервицеадмин:: сетпримаридентити](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="c49ae-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="c49ae-123">При создании профиля MAPI назначает первую службу сообщений, которая включает поставщика с установленным флагом СТАТУС_ПРИМАРИ_ИДЕНТИТИ в свойстве **пр_ресаурце_флагс** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) для предоставления основного идентификатора. .</span><span class="sxs-lookup"><span data-stu-id="c49ae-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="c49ae-124">В назначенной службе сообщений первый поставщик, который необходимо настроить с помощью этого набора флагов ресурсов, выбирается для предоставления удостоверения службы.</span><span class="sxs-lookup"><span data-stu-id="c49ae-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="c49ae-125">Флаг СТАТУС_ПРИМАРИ_ИДЕНТИТИ снимается для всех других поставщиков в указанной службе и других службах сообщений в профиле.</span><span class="sxs-lookup"><span data-stu-id="c49ae-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="c49ae-126">Если поставщик поставляет первичное удостоверение из профиля, MAPI назначает роль следующему поставщику для настройки, которая может предоставлять удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="c49ae-127">Это определяется внешним видом `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` записи в разделе поставщика в Mapisvc. INF.</span><span class="sxs-lookup"><span data-stu-id="c49ae-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="c49ae-128">Когда клиент вызывает метод **имсгсервицеадмин:: сетпримаридентити** службы сообщений, он определяет мапиуид для поставщика услуг в целевой службе.</span><span class="sxs-lookup"><span data-stu-id="c49ae-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="c49ae-129">Дополнительные сведения см. в разделе [мапиуид](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="c49ae-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="c49ae-130">Поставщик услуг, представленный **мапиуид** , назначается для предоставления основного удостоверения для службы сообщений и для сеанса, а все остальные поставщики в службе будут совместно использовать это удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="c49ae-131">Каждый поставщик в службе сообщений, ответственный за предоставление основного идентификатора, обновляет строку в таблице состояния, чтобы включить следующие свойства.</span><span class="sxs-lookup"><span data-stu-id="c49ae-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="c49ae-132">**Основное свойство Identity**</span><span class="sxs-lookup"><span data-stu-id="c49ae-132">**Primary identity property**</span></span>|<span data-ttu-id="c49ae-133">**Значение**</span><span class="sxs-lookup"><span data-stu-id="c49ae-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="c49ae-134">**Пр_идентити_дисплай** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="c49ae-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="c49ae-135">Отображаемое имя объекта, предоставляющего Основное удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="c49ae-136">**Пр_идентити_сеарч_кэй** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="c49ae-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="c49ae-137">Ключ поиска для объекта, предоставляющего Основное удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="c49ae-138">**Пр_идентити_ентрид** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="c49ae-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="c49ae-139">Идентификатор записи для объекта, предоставляющего Основное удостоверение.</span><span class="sxs-lookup"><span data-stu-id="c49ae-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="c49ae-140">**Получение идентификатора записи для объекта, предоставляющего Основное удостоверение**</span><span class="sxs-lookup"><span data-stu-id="c49ae-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="c49ae-141">ВыЗовите метод **IMAPISession:: куеридентити** .</span><span class="sxs-lookup"><span data-stu-id="c49ae-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="c49ae-142">Дополнительные сведения см. в статье [IMAPISession:: куеридентити](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="c49ae-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="c49ae-143">**Куеридентити** ищет в таблице состояние строку, которая содержит значение статус_примари_идентити в столбце **пр_ресаурце_флагс** , и возвращает соответствующее **пр_идентити_ентрид** в качестве идентификатора записи для основного хищения.</span><span class="sxs-lookup"><span data-stu-id="c49ae-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    


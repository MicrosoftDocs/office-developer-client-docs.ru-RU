---
title: Отображение индикатора хода выполнения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 20f5ad5a-b700-4fb5-9658-f71da5a06a12
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7b0ce0ab75ffdce045ccde5bf6ea8a7da046f463
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33408029"
---
# <a name="display-a-progress-indicator"></a>Отображение индикатора хода выполнения
 
**Относится к**: Outlook 2013 | Outlook 2016 
  
Чтобы отобразить индикатор хода выполнения, вызовите [IMAPIProgress::](imapiprogress-getflags.md) GetSetting, чтобы получить текущие параметры флагов. 
  
Если установлен флаг MAPI_TOP_LEVEL, выполните следующие действия:
  
1. Задайте переменную, равную общему количеству элементов, обрабатываемых в операции. Например, если вы копируете содержимое папки, это значение будет равным числу вложенных папок в папке плюс количество сообщений. 
    
2. Установите переменную равное 1000 на число элементов. 
    
3. Если отображается ход выполнения для подобъектов, вызовите метод [IMAPIProgress:: SetLimits](imapiprogress-setlimits.md) объекта Progress и передайте следующие значения для трех параметров: 
    
   - Задайте для параметра _лпулмин_ значение 0. 
    
   - Установите для параметра _лпулмакс_ значение 1000. 
    
   - Задайте для параметра _лпулфлагс_ значение MAPI_TOP_LEVEL. 
    
4. Для каждого объекта, который необходимо обработать, выполните следующие действия:
    
   1. Call **IMAPIProgress:: SetLimits** и передайте следующие значения для трех параметров: 
      
     - Задайте для параметра _лпулмин_ значение, заданное в пункте 2, умноженное на значение текущего элемента минус 1. 
      
     - Задайте для параметра _лпулмакс_ значение, заданное в пункте 2, умноженное на текущий объект. 
      
     - Задайте для параметра _лпулфлагс_ значение 0. 
      
   2. Выполнение любой обработки, которую необходимо выполнить для этого объекта. Если это объект и требуется отображать ход выполнения для подобъектов, передайте указатель на объект Progress в параметре _лппрогресс_ в метод. 
      
   3. Call [IMAPIProgress::P рогресс](imapiprogress-progress.md) и передайте следующие значения для трех параметров: 
      
     - Задайте для параметра _улвалуе_ значение, заданное в пункте 2, умноженное на текущий объект. 
      
     - Установите для параметра _улкаунт_ текущий объект. 
      
     - Присвойте параметру _ултотал_ значение, заданное на шаге 1, на общее число объектов. 
    
Если флаг MAPI_TOP_LEVEL не установлен, выполните следующие действия:
  
1. Вызовите метод [IMAPIProgress:: GetMin](imapiprogress-getmin.md) объекта Progress, чтобы получить минимальное значение для отображения. 
    
2. Call [IMAPIProgress:: жетмакс](imapiprogress-getmax.md) , чтобы получить максимальное значение для отображения. 
    
3. Задайте переменную, равную общему количеству обрабатываемых объектов. 
    
4. Присвойте переменной значение, равное результату вычитания минимума из максимального значения, а затем — по общему количеству объектов.
    
5. Для каждого объекта, который необходимо обработать, выполните следующие действия:
    
   1. Если поставщик показывает ход выполнения для подобъектов, вызовите метод **IMAPIProgress:: SetLimits** и передайте следующие значения для трех параметров: 
      
     - Установите для параметра _лпулмин_ минимальное значение плюс текущий элемент минус 1, умноженное на значение, заданное на шаге 4. 
      
     - Установите для параметра _лпулмакс_ минимальное значение плюс текущее единицу измерения, умноженное на переменную, установленную на шаге 4. 
      
     - Задайте для параметра _лпулфлагс_ значение 0. 
      
   2. Выполнение любой обработки, которую необходимо выполнить для этого объекта. Если объект является подобъектом, а поставщик отображает ход выполнения для подобъектов, передайте указатель на объект Progress в параметре _лппрогресс_ в метод. 
      
   3. Call [IMAPIProgress::P рогресс](imapiprogress-progress.md) и передайте следующие значения для трех параметров: 
      
     - Задайте для параметра _улвалуе_ значение переменная Set в шаге 2, умноженной на текущий объект. 
      
     - Задайте для параметра _улкаунт_ значение 0. 
      
     - Задайте для параметра _ултотал_ значение 0. 
    
В приведенном ниже примере кода показана логика, необходимая для отображения хода выполнения на всех уровнях операции, которая копирует содержимое папки, содержащей пять вложенных папок. 
  
```cpp
lpProgress->GetFlags (lpulFlags);
ulFlags = *lpulFlags;
/* The folder in charge of the display. It contains 5 subfolders. */
if (ulFlags & MAPI_TOP_LEVEL)
{
    ulItems = 5                         // 5 subfolders in this folder
    ulScale = (ulMax / ulItems)         // 200 because ulMax = 1000
    lpProgress->SetLimits(0, ulMax, MAPI_TOP_LEVEL)
    for (i = 1; i <= ulItems; i++)      // for each subfolder to copy
    {
        lpProgress->SetLimits( (i - 1) * ulScale, i * ulScale, 0)
        CopyOneFolder(lpFolder(i), lpProgress)
        lpProgress->Progress( i * ulScale, i, ulItems)
    }
}
else
/* One of the subfolders to be copied. It contains 3 messages. */
{
    lpProgress->GetMin(&ulMin);
    lpProgress->GetMax(&ulMax);
    ulItems = 3;
    ulDelta = (ulMax - ulMin) / ulItems;
    for (i = 1; i <= ulItems; i++)
    {
        lpProgress->SetLimits(ulMin + (i - 1) * ulDelta,
                              ulMin + i * ulDelta, 0)
        CopyOneFolder(lpFolder(i), lpProgress)
        /* Pass 0 for ulCount and ulTotal because this is not the */
        /* top-level display, and that information is unavailable  */
        lpProgress->Progress( i * ulDelta, 0, 0)
    }
}
 
```

## <a name="see-also"></a>См. также

- [Индикаторы хода выполнения MAPI](mapi-progress-indicators.md)


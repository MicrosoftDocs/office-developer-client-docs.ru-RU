---
title: Реализация интерфейса IUnknown
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 01bba63b-a2a1-490e-8b78-5c9ba8d9547b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5165476ea131e40153191e8625af5ea3c49f47b1
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32310047"
---
# <a name="implementing-the-iunknown-interface"></a>Реализация интерфейса IUnknown

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Методы интерфейса [IUnknown,](https://msdn.microsoft.com/library/ms680509%28v=VS.85%29.aspx) реализованные в каждом объекте MAPI, поддерживают взаимодействие между объектами и управление объектами. 
  
 **IUnknown** имеет три метода: [IUnknown::AddRef](https://msdn.microsoft.com/library/ms691379%28v=VS.85%29.aspx), [IUnknown::QueryInterface](https://msdn.microsoft.com/library/ms682521%28v=VS.85%29.aspx)и [IUnknown::Release](https://msdn.microsoft.com/library/ms682317%28v=VS.85%29.aspx). **QueryInterface** позволяет одному объекту определить, поддерживает ли другой объект определенный интерфейс. С **помощью QueryInterface** могут взаимодействовать два объекта без предварительного знания функциональности друг друга. Если объект, реализующий **QueryInterface,** поддерживает интерфейс, о который идет речь, он возвращает указатель на реализацию интерфейса. Если объект не поддерживает запрашивается интерфейс, он возвращает MAPI_E_INTERFACE_NOT_SUPPORTED значение. 
  
Когда **QueryInterface** возвращает запрашивающийся указатель интерфейса, он также должен увеличить количество ссылок нового объекта. Число ссылок объекта — это числовая величина, используемая для управления жизненным сроком объекта. Если количество ссылок больше 1, память объекта не может быть освобождена, так как она активно используется. Безопасно освободить объект можно только в том случае, если количество ссылок опускается до 0. 
  
Два других метода **IUnknown,** **AddRef** и **Release,** управляют количеством ссылок. **AddRef** приращение эталонного подсчета, а **Release** - его. Все методы или функции API, которые возвращают указатели интерфейса, такие как **QueryInterface,** должны вызывать **AddRef,** чтобы помногить количество ссылок. Все реализации методов, которые получают указатели интерфейса, должны вызывать **release,** чтобы ухуметь количество, когда указатель больше не нужен. **Выпуск** проверяет существующее количество ссылок, освобождает память, связанную с интерфейсом, только если это количество 0. 
  
> [!NOTE]
> Так **как addRef** и **Release** не требуются для возврата точных значений, вызыватели этих методов не должны использовать возвращаемую информацию, чтобы определить, является ли объект действительным или был уничтожен. 
  
## <a name="see-also"></a>См. также



[Реализация объектов MAPI](implementing-mapi-objects.md)


---
title: Реализация интерфейса IUnknown
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 01bba63b-a2a1-490e-8b78-5c9ba8d9547b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f9ab3b75743d882aca0145b73b8ef707204cc8de
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22571901"
---
# <a name="implementing-the-iunknown-interface"></a>Реализация интерфейса IUnknown

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Методы интерфейса [IUnknown](http://msdn.microsoft.com/en-us/library/ms680509%28v=VS.85%29.aspx) , реализованный в каждый объект MAPI поддерживают способ управления обмена данными и объекта. 
  
 **Интерфейс IUnknown** имеет три метода: [IUnknown::AddRef](http://msdn.microsoft.com/en-us/library/ms691379%28v=VS.85%29.aspx), [IUnknown::QueryInterface](http://msdn.microsoft.com/en-us/library/ms682521%28v=VS.85%29.aspx)и [функции IUnknown::Release](http://msdn.microsoft.com/en-us/library/ms682317%28v=VS.85%29.aspx). **QueryInterface** включает один объект, который требуется определить, поддерживает ли другой объект определенного интерфейса. **QueryInterface**могут работать два объекта с отсутствуют знания функциональные возможности друг друга. Если объект, который реализует **QueryInterface** поддерживают интерфейс интересующую, возвращает указатель на реализацию интерфейса. Если объект не поддерживает запрошенный интерфейс, возвращается значение MAPI_E_INTERFACE_NOT_SUPPORTED. 
  
При **QueryInterface** возвращает указатель на интерфейс, его необходимо также увеличить счетчик ссылок новый объект. Счетчик ссылку на объект — числовое значение, используемый для управления объекта зависящая от. Если счетчик ссылок больше 1, так как он активно используется не может освободить память объекта. Это, только когда счетчик ссылок станет равен 0, что объект безопасно можно отменить. 
  
Другие два методы **IUnknown** , **AddRef** и **выпуска**, управление счетчик ссылок. **Метод AddRef** увеличивает счетчик ссылок, при **выпуске** уменьшает его. Все методы или функции API, которые возвращают указатели интерфейса, таких как **QueryInterface**, необходимо вызвать **метод AddRef** для увеличивают счетчик ссылок. Все реализации методов, которые получают указателей интерфейса необходимо вызвать **выпуска** для уменьшения count, когда указатель мыши больше не требуется. **Выпуск** проверяет наличие существующего счетчик ссылок, освободить память, связанные с интерфейсом только в том случае, если число равняется 0. 
  
> [!NOTE]
> Так как **AddRef** и **Release** не требуются для возвращения точных значений, звонящих из этих методов нельзя использовать возвращаемые значения для определения ли объект еще не истек или был удален. 
  
## <a name="see-also"></a>См. также



[Реализация объектов MAPI](implementing-mapi-objects.md)


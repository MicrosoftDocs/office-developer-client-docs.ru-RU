---
title: Определение новых свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 1a2325ea-ddfa-480f-b65f-f5b20471fb40
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 666ee413319765e39e25d586208f764afc93ae6b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32336682"
---
# <a name="defining-new-mapi-properties"></a>Определение новых свойств MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Несмотря на множество свойств, предоставляемых MAPI для использования клиентами и поставщиками услуг, MAPI позволяет создавать новые свойства при необходимости. Некоторые допустимые сценарии для определения новых общедоступных свойств включают клиент, создающий свойства для поддержки нового класса сообщений и поставщика услуг, создающий новые свойства для предоставления уникальных компонентов системы обмена сообщениями.
  
Как правило, поставщик услуг не является допустимым для определения новых свойств для существующего объекта MAPI или класса Message. Одним из основных преимуществ использования MAPI является настройка стандартных идентификаторов и форматов для большого количества элементов системы обмена сообщениями, что позволяет пользователям эффективно смешивать и сопоставлять поставщиков услуг. Поставщики услуг, использующие нестандартные свойства, не работают с другими поставщиками служб. 
  
Клиенты могут создавать свойства контента для новых классов сообщений следующим образом:
  
- Использование идентификаторов свойств в определенном диапазоне для свойств содержимого, специфичных для класса сообщений.
    
    - Также
    
- Использование именованных свойств. 
    
Первый вариант предпочтительнее, так как не все поставщики услуг поддерживают именованные свойства. MAPI определяет два отдельных диапазона для клиентов, которые используются для новых свойств контента, специфичных для класса сообщений:
  
- 0x6800 в 0x7BFF для передающегося свойств
    
- 0x7C00 в 0x7FFF для подходящих свойств
    
Идентификаторы свойств должны относиться к предварительно заданным диапазонам, чтобы предотвратить конфликты между свойствами, определенными разными поставщиками или пользователями. Тем не менее пользователи свойств в этих диапазонах не могут принимать предположения относительно поведения свойств. Каждый клиент, который создает новый класс сообщений, имеет доступ к этим диапазонам; свойство с идентификатором _XXXX_ может означать одно поведение для одного класса сообщений и другое поведение для другого класса Message. 
  
Именованные свойства используются для гарантии того, что определенное свойство является уникальным для класса сообщения. Именованные идентификаторы свойств начинаются в диапазоне 0x8000. Клиенты определяют одно или несколько имен, а затем вызывают метод [IMAPIProp:: жетидсфромнамес](imapiprop-getidsfromnames.md) хранилища сообщений для сопоставления идентификатора с каждым именем. Именованные свойства могут использоваться клиентами или поставщиками услуг для определения новых свойств для любого объекта, только если владелец объекта поддерживает именованные свойства. Пользователи этих свойств вызывают **жетидсфромнамес** и связанный метод **IMAPIProp** , [жетнамесфромидс](imapiprop-getnamesfromids.md)для сопоставления имени и идентификатора.
  
Все свойства, новые или существующие, должны использовать набор предопределенных типов свойств. Новые типы свойств невозможно добавить, и существующие типы невозможно изменить или удалить. Простые и небольшие свойства, такие как свойства с одним символом или 16 – разрядным целыми числами, могут храниться в любом соответствующем типе. Например, целые числа могут храниться в виде **ulong** , а строки — в виде **PT_STRING8**. 
  
Используйте тип **пт_бинари** , чтобы обозначить массив байтов с подсчитанным массивом. Этот тип свойства полезен для расширения типов данных, которые могут храниться в объекте. Байты передаются по последовательности, и никаких предположений о значении этих данных нет. Когда клиентское приложение считывает данные из такого свойства, данные не изменяются в том порядке, в котором они были сохранены. Клиент должен выполнить необходимые перестановки байтов при перемещении данных между ЦП. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


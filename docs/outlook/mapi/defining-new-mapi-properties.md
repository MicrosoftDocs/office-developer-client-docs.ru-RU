---
title: Определение новых свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 1a2325ea-ddfa-480f-b65f-f5b20471fb40
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 666ee413319765e39e25d586208f764afc93ae6b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425017"
---
# <a name="defining-new-mapi-properties"></a><span data-ttu-id="ef4e9-103">Определение новых свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="ef4e9-103">Defining New MAPI Properties</span></span>

  
  
<span data-ttu-id="ef4e9-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ef4e9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ef4e9-105">Несмотря на множество свойств, предоставленных MAPI для использования клиентами и поставщиками услуг, MAPI позволяет при необходимости создавать новые свойства.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-105">In spite of the wealth of properties supplied by MAPI for use by clients and service providers, MAPI enables new properties to be created if necessary.</span></span> <span data-ttu-id="ef4e9-106">Некоторые допустимые сценарии определения новых общедоступных свойств включают создание клиентом свойств для поддержки нового класса сообщений и создание новых свойств для использования уникальных функций системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-106">Some of the valid scenarios for defining new public properties include a client creating properties to support a new message class and a service provider creating new properties to expose unique messaging system features.</span></span>
  
<span data-ttu-id="ef4e9-107">Обычно поставщик службы не может определить новые свойства существующего объекта MAPI или класса сообщений.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-107">It is typically not valid for a service provider to define new properties for an existing MAPI object or message class.</span></span> <span data-ttu-id="ef4e9-108">Одно из основных преимуществ использования MAPI состоит в том, что стандартные идентификаторы и форматы для большого количества систем обмена сообщениями настроены, что позволяет пользователям легко смешивать и сопутствий поставщиков услуг.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-108">One of the primary benefits of using MAPI is that standard identifiers and formats for a large number of messaging system elements are set up, enabling users to seamlessly mix and match service providers.</span></span> <span data-ttu-id="ef4e9-109">Поставщики услуг, которые используют нестандартные свойства, не работают с другими поставщиками услуг.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-109">Service providers that use nonstandard properties do not work as well with other service providers.</span></span> 
  
<span data-ttu-id="ef4e9-110">Клиенты могут создавать свойства контента для новых классов сообщений с помощью:</span><span class="sxs-lookup"><span data-stu-id="ef4e9-110">Clients can create content properties for new message classes by:</span></span>
  
- <span data-ttu-id="ef4e9-111">Использование идентификаторов свойств в указанном диапазоне для свойств контента, характерного для определенного класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-111">Using property identifiers within a designated range for message class-specific content properties.</span></span>
    
    - <span data-ttu-id="ef4e9-112">Или -</span><span class="sxs-lookup"><span data-stu-id="ef4e9-112">Or -</span></span>
    
- <span data-ttu-id="ef4e9-113">Использование именуемой свойства.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-113">Using named properties.</span></span> 
    
<span data-ttu-id="ef4e9-114">Первый вариант предпочтительный, так как не все поставщики услуг поддерживают именуемые свойства.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-114">The first option is preferable because not all service providers support named properties.</span></span> <span data-ttu-id="ef4e9-115">MAPI определяет два отдельных диапазона для клиентов, которые будут использовать для новых свойств содержимого для определенного класса сообщений:</span><span class="sxs-lookup"><span data-stu-id="ef4e9-115">MAPI defines two separate ranges for clients to use for new message class-specific content properties:</span></span>
  
- <span data-ttu-id="ef4e9-116">0x6800 0x7BFF для передаваемых свойств</span><span class="sxs-lookup"><span data-stu-id="ef4e9-116">0x6800 to 0x7BFF for transmittable properties</span></span>
    
- <span data-ttu-id="ef4e9-117">0x7C00 0x7FFF для ненастраимых свойств</span><span class="sxs-lookup"><span data-stu-id="ef4e9-117">0x7C00 to 0x7FFF for nontransmittable properties</span></span>
    
<span data-ttu-id="ef4e9-118">Идентификаторы свойств должны попадать в предопределенные диапазоны, чтобы предотвратить конфликты между свойствами, определенными разными поставщиками или пользователями.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-118">Property identifiers must fall in predefined ranges to help prevent collisions between properties defined by different vendors or users.</span></span> <span data-ttu-id="ef4e9-119">Однако пользователи свойств в этих диапазонах не могут делать предположений о поведении свойств.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-119">However, users of properties in these ranges cannot make assumptions as to the behavior of the properties.</span></span> <span data-ttu-id="ef4e9-120">Каждый клиент, создав новый класс сообщений, имеет доступ к этим диапазонам; Свойство с идентификатором  _xxxx_ может означать одно поведение для одного класса сообщений, а другое поведение для другого класса сообщений.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-120">Every client that creates a new message class has access to these ranges; a property with identifier  _xxxx_ can mean one behavior for one message class and another behavior for another message class.</span></span> 
  
<span data-ttu-id="ef4e9-121">Именуемые свойства используются для того, чтобы гарантировать уникальность определенного свойства для класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-121">Named properties are used to guarantee a specific property is unique to a message class.</span></span> <span data-ttu-id="ef4e9-122">Идентификаторы именуемого свойства начинаются в 0x8000 диапазона.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-122">Named property identifiers start in the 0x8000 range.</span></span> <span data-ttu-id="ef4e9-123">Клиенты определяют одно или несколько имен, а затем вызовите метод [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) в хранилище сообщений, чтобы связать идентификатор с каждым именем.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-123">Clients define one or more names and then call the message store's [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) method to associate an identifier with each name.</span></span> <span data-ttu-id="ef4e9-124">Именуемые свойства могут использоваться клиентами или поставщиками служб для определения новых свойств любого объекта только в том случае, если владелец объекта поддерживает именуемые свойства.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-124">Named properties can be used by clients or service providers to define new properties for any object only if the owner of the object supports named properties.</span></span> <span data-ttu-id="ef4e9-125">Пользователи этих свойств звонят **методу GetIDsFromNames** и связанному методу **IMAPIProp** [GetNamesFromIDs](imapiprop-getnamesfromids.md)для связи имени с его идентификатором.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-125">Users of these properties call **GetIDsFromNames** and a related **IMAPIProp** method, [GetNamesFromIDs](imapiprop-getnamesfromids.md), to map between a name and its identifier.</span></span>
  
<span data-ttu-id="ef4e9-126">Все свойства, новые или существующие, должны использовать набор предопределенных типов свойств.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-126">All properties, new or existing, must use the set of predefined property types.</span></span> <span data-ttu-id="ef4e9-127">Новые типы свойств нельзя добавлять, а существующие типы нельзя изменять или удалять.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-127">New property types cannot be added and existing types cannot be modified or deleted.</span></span> <span data-ttu-id="ef4e9-128">Простые, небольшие свойства, такие как одно символы или 16-разрядные integer, могут храниться в любом соответствующем типе.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-128">Simple, small properties, such as single-character or 16-bit integer properties, can be stored in any appropriate type.</span></span> <span data-ttu-id="ef4e9-129">Например, integers can be stored as **ULONG** and strings can be stored as **PT_STRING8**.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-129">For example, integers can be stored as **ULONG** and strings can be stored as **PT_STRING8**.</span></span> 
  
<span data-ttu-id="ef4e9-130">Используйте тип **PT_BINARY,** чтобы указать массив подсчитаных byte.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-130">Use the **PT_BINARY** type to indicate a counted byte array.</span></span> <span data-ttu-id="ef4e9-131">Этот тип свойства полезен для расширения типов данных, которые могут храниться в объекте.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-131">This property type is useful for extending the types of data that can be stored in an object.</span></span> <span data-ttu-id="ef4e9-132">Данные передаются последовательно, и не делается никаких предположений о значении данных.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-132">Bytes are transmitted in sequence and no assumptions are made about the meaning of the data.</span></span> <span data-ttu-id="ef4e9-133">Когда клиентские приложения считыют данные из такого свойства, данные не изменяются по сравнению с тем, как они хранились.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-133">When a client application reads data out of such a property, the data is unchanged from how it was stored.</span></span> <span data-ttu-id="ef4e9-134">При перемещении данных между ЦП клиент должен выполнять любые необходимые замены ветвей.</span><span class="sxs-lookup"><span data-stu-id="ef4e9-134">The client must perform any necessary byte swapping when moving data across CPUs.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="ef4e9-135">См. также</span><span class="sxs-lookup"><span data-stu-id="ef4e9-135">See also</span></span>



[<span data-ttu-id="ef4e9-136">Обзор свойств MAPI</span><span class="sxs-lookup"><span data-stu-id="ef4e9-136">MAPI Property Overview</span></span>](mapi-property-overview.md)


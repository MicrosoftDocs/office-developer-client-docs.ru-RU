---
title: Определение новых свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 1a2325ea-ddfa-480f-b65f-f5b20471fb40
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 666ee413319765e39e25d586208f764afc93ae6b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425017"
---
# <a name="defining-new-mapi-properties"></a>Определение новых свойств MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Несмотря на множество свойств, предоставленных MAPI для использования клиентами и поставщиками услуг, MAPI позволяет при необходимости создавать новые свойства. Некоторые допустимые сценарии определения новых общедоступных свойств включают создание клиентом свойств для поддержки нового класса сообщений и создание новых свойств для использования уникальных функций системы обмена сообщениями.
  
Обычно поставщик службы не может определить новые свойства существующего объекта MAPI или класса сообщений. Одно из основных преимуществ использования MAPI состоит в том, что стандартные идентификаторы и форматы для большого количества систем обмена сообщениями настроены, что позволяет пользователям легко смешивать и сопутствий поставщиков услуг. Поставщики услуг, которые используют нестандартные свойства, не работают с другими поставщиками услуг. 
  
Клиенты могут создавать свойства контента для новых классов сообщений с помощью:
  
- Использование идентификаторов свойств в указанном диапазоне для свойств контента, характерного для определенного класса сообщения.
    
    - Или -
    
- Использование именуемой свойства. 
    
Первый вариант предпочтительный, так как не все поставщики услуг поддерживают именуемые свойства. MAPI определяет два отдельных диапазона для клиентов, которые будут использовать для новых свойств содержимого для определенного класса сообщений:
  
- 0x6800 0x7BFF для передаваемых свойств
    
- 0x7C00 0x7FFF для ненастраимых свойств
    
Идентификаторы свойств должны попадать в предопределенные диапазоны, чтобы предотвратить конфликты между свойствами, определенными разными поставщиками или пользователями. Однако пользователи свойств в этих диапазонах не могут делать предположений о поведении свойств. Каждый клиент, создав новый класс сообщений, имеет доступ к этим диапазонам; Свойство с идентификатором  _xxxx_ может означать одно поведение для одного класса сообщений, а другое поведение для другого класса сообщений. 
  
Именуемые свойства используются для того, чтобы гарантировать уникальность определенного свойства для класса сообщения. Идентификаторы именуемого свойства начинаются в 0x8000 диапазона. Клиенты определяют одно или несколько имен, а затем вызовите метод [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) в хранилище сообщений, чтобы связать идентификатор с каждым именем. Именуемые свойства могут использоваться клиентами или поставщиками служб для определения новых свойств любого объекта только в том случае, если владелец объекта поддерживает именуемые свойства. Пользователи этих свойств звонят **методу GetIDsFromNames** и связанному методу **IMAPIProp** [GetNamesFromIDs](imapiprop-getnamesfromids.md)для связи имени с его идентификатором.
  
Все свойства, новые или существующие, должны использовать набор предопределенных типов свойств. Новые типы свойств нельзя добавлять, а существующие типы нельзя изменять или удалять. Простые, небольшие свойства, такие как одно символы или 16-разрядные integer, могут храниться в любом соответствующем типе. Например, integers can be stored as **ULONG** and strings can be stored as **PT_STRING8**. 
  
Используйте тип **PT_BINARY,** чтобы указать массив подсчитаных byte. Этот тип свойства полезен для расширения типов данных, которые могут храниться в объекте. Данные передаются последовательно, и не делается никаких предположений о значении данных. Когда клиентские приложения считыют данные из такого свойства, данные не изменяются по сравнению с тем, как они хранились. При перемещении данных между ЦП клиент должен выполнять любые необходимые замены ветвей. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


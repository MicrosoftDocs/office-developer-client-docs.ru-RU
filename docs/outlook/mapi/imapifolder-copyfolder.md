---
title: Имапифолдеркопифолдер
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CopyFolder
api_type:
- COM
ms.assetid: 2c1c25c6-1aec-4d9e-a2a3-bf1b4a2908b8
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 3d9c1e88b12baf50593212a3ae3c02907ce6617b
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425661"
---
# <a name="imapifoldercopyfolder"></a>IMAPIFolder::CopyFolder

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Копирует или перемещает вложенную папку.
  
```cpp
HRESULT CopyFolder(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  LPCIID lpInterface,
  LPVOID lpDestFolder,
  LPSTR lpszNewFolderName,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Кбентрид_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _Лпентрид_
  
> возврата Указатель на идентификатор записи вложенной папки, которую необходимо скопировать или переместить.
    
 _Лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к папке, на которую указывает параметр _лпдестфолдер_ . При передаче значения NULL поставщику услуг возвращается интерфейс стандартных папок, [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md). Допустимые значения для _лпинтерфаце_ включают Иид_иункновн, Иид_имапипроп, Иид_имапиконтаинер и иид_имапифолдер. 
    
 _Лпдестфолдер_
  
> возврата Указатель на открытую папку для получения скопированной или перемещенной вложенной папки.
    
 _Лпсзневфолдернаме_
  
> возврата Указатель на имя скопированной или перемещенной папки в новом месте назначения. Если для _лпсзневфолдернаме_ ЗАДАНО значение null, имя исходной вложенной папки используется для имени конечной папки. 
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения. Параметр _улуипарам_ игнорируется, если не ЗАДАН флаг фолдер_диалог в параметре _ulFlags_ . 
    
 _Лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_переДАЕТСЯ значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации объекта Progress для MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг Фолдер_диалог в _ulFlags_.
    
 _ulFlags_
  
> возврата Битовая маска флагов, управляющих операциями копирования или перемещения. Можно задать следующие флаги:
    
КОПИ_СУБФОЛДЕРС 
  
> Все вложенные папки в вложенной папке также должны быть скопированы. Если для операции копирования не задан КОПИ_СУБФОЛДЕРС, копируется только вложенная папка, определенная с помощью _лпентрид_ . При выполнении операции перемещения поведение КОПИ_СУБФОЛДЕРС по умолчанию зависит от того, установлен ли флаг. 
    
ФОЛДЕР_ДИАЛОГ 
  
> ЗаПрашивает отображение индикатора хода выполнения.
    
ФОЛДЕР_МОВЕ 
  
> Вложенная папка перемещается, а не копируется. Если ФОЛДЕР_МОВЕ не задано, то подпапка копируется.
    
МАПИ_ДЕКЛИНЕ_ОК 
  
> Информирует поставщика хранилища сообщений, что если он реализует **CopyFolder** , вызывая его объект поддержки [Имаписуппорт::D окопито](imapisupport-docopyto.md) или [имаписуппорт::D окопипропс](imapisupport-docopyprops.md) Method, **CopyFolder** должен вместо этого вернуть мапи_е_ ДЕКЛИНЕ_КОПИ. 
    
MAPI_UNICODE 
  
> Имя конечной папки имеет формат Юникод. Если флаг МАПИ_УНИКОДЕ не установлен, имя папки указывается в формате ANSI.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Указанная папка успешно скопирована или перемещена.
    
МАПИ_Е_БАД_ЧАРВИДС 
  
> Установлен либо флаг МАПИ_УНИКОДЕ, и поставщик хранилища сообщений не поддерживает Юникод, или МАПИ_УНИКОДЕ не задан, а поставщик хранилища сообщений поддерживает только Юникод.
    
МАПИ_Е_КОЛЛИСИОН 
  
> Имя папки, которую вы перемещаете или копирует, совпадает с именем вложенной папки в папке назначения. Для поставщика хранилища сообщений требуются уникальные имена папок.
    
МАПИ_Е_ДЕКЛИНЕ_КОПИ 
  
> Поставщик реализует этот метод, вызывая метод объекта support, и вызывающий абонент передал флаг МАПИ_ДЕКЛИНЕ_ОК.
    
МАПИ_Е_ФОЛДЕР_ЦИКЛЕ 
  
> Исходная папка напрямую или косвенно содержит целевую папку. Перед обнаружением этого условия может быть выполнено большое количество действий, поэтому исходная и конечная папки могут быть частично изменены. 
    
МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН 
  
> Вызов выполнен успешно, но не все записи успешно скопированы. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder:: CopyFolder** копирует или перемещает вложенную папку из одного расположения в другое. Подпапка, которую необходимо скопировать или переместить, добавляется в папку назначения в качестве вложенной папки. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если операция копирования или перемещения включает несколько папок, как показано в результате установки флага КОПИ_СУБФОЛДЕРС, выполните операцию как можно более полную для каждой папки. Иногда одна из папок, которую необходимо переместить или скопировать, не существует или уже была перемещена или скопирована в другом месте. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений.
  
Попробуйте сохранить все идентификаторы записи сообщений в скопированных сообщениях. Также следует попытаться сохранить идентификаторы записей, но это не обязательно. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**CopyFolder** успешно копирует или перемещает все сообщения и вложенную папку.  <br/> |S_OK  <br/> |
|**CopyFolder** не удалось успешно скопировать или переместить все сообщения и вложенную папку.  <br/> |МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН или МАПИ_Е_НОТ_ФАУНД  <br/> |
|**CopyFolder** не удалось выполнить.  <br/> |Любое значение ошибки, кроме МАПИ_Е_НОТ_ФАУНД  <br/> |
   
Если **CopyFolder** не удается выполнить, не следует предполагать, что работа не выполнялась. Возможно, в **CopyFolder** удалось скопировать или переместить одно или несколько сообщений и вложенных папок, прежде чем возникнет ошибка. 
  
Если идентификатор записи для несуществующей папки передается в _лпентрид_, **CopyFolder** возвращает мапи_в_партиал_комплетион или мапи_е_нот_фаунд в зависимости от реализации хранилища сообщений. 
  
В зависимости от поставщика хранилища сообщений идентификатор элемента исходного сообщения может быть не сохранен в скопированном сообщении. Рекомендуется сохранять идентификаторы записей везде, где это возможно, но это не является обязательным требованием. Как правило, вы можете зависеть от следующих сценариев:
  
- Когда вы перемещаете папку между двумя разными типами хранилищ сообщений, идентификатор записи гарантированно изменяется.
    
- Когда вы перемещаете папку между двумя хранилищами одного и того же типа, идентификатор записи почти всегда изменяется.
    
- Когда вы перемещаете папку в другое расположение в том же хранилище сообщений, идентификатор записи может измениться или может не измениться в зависимости от поставщика хранилища сообщений.
    
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мсгсторедлг. cpp  <br/> |Кмсгсторедлг:: Онпастефолдер  <br/> |MFCMAPI использует метод **IMAPIFolder:: CopyFolder** , чтобы скопировать папки из одного расположения в другое. MFCMAPI запоминает исходную папку во время операции копирования и фактически выполняет копию во время операции вставки.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


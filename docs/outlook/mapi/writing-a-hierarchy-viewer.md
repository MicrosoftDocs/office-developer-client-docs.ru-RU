---
title: Написание средства просмотра иерархии
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4c939a8c-8148-4add-b181-5a12e6d32309
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5f6ebd20afc3b8d029fa7c632c55982862664055
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421132"
---
# <a name="writing-a-hierarchy-viewer"></a>Написание средства просмотра иерархии

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Средство просмотра иерархии — это компонент пользовательского интерфейса, используемый для отображения таблиц иерархии контейнеров папок и адресной книги. Пользователи, просматривающие иерархию, могут отображать элементы иерархии на разных уровнях, расширяя и променяя каждый уровень по запросу.
  
Свойство Container, **пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md)), управляет уровнем, на котором отображается элемент иерархии. Для записей, представляющих контейнеры и папки адресной книги верхнего уровня, свойству **пр_депс** присвоено нулевое значение. Значение этого свойства увеличивается последовательно для записей последовательного уровня. То есть когда пользователь выбирает контейнер верхнего уровня для расширения, отображает все контейнеры с **пр_депс** , для которых задано значение 1. Когда пользователь разворачивает один из этих подконтейнеров, отобразите контейнеры с **пр_депс** , равными 2, и т. д. 
  
Пользователи, просматривающие иерархию, поддерживают разный диапазон глубины. Вы можете ограничить просмотр только одним или двумя уровнями или поддерживать несколько уровней, если для отображения обширной иерархии используется приоритет. 
  
Адресная книга предоставляет средство просмотра иерархий для контейнеров верхнего уровня в адресной книге. 
  
 **Доступ к таблице иерархий адресной книги**
  
1. Call [IAddrBook:: OpenEntry](iaddrbook-openentry.md), передавая идентификатор записи null, чтобы открыть корневой контейнер адресной книги.
    
2. ВыЗовите метод [IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md) корневого контейнера для доступа к таблице иерархий АДРЕСНОЙ книги MAPI. 
    
 **Доступ к таблице иерархии хранилища сообщений по умолчанию**
  
1. Call [IMAPISession:: жетмсгсторестабле](imapisession-getmsgstorestable.md) для доступа к таблице хранилища сообщений. 
    
2. Создайте ограничение с помощью структуры [спропертирестриктион](spropertyrestriction.md) , чтобы ограничить таблицу только теми строками, у которых для свойства **пр_дефаулт_сторе** ([PIDTAGDEFAULTSTORE](pidtagdefaultstore-canonical-property.md)) задано значение true. 
    
3. Вызов [IMAPITable:: FindRow](imapitable-findrow.md), передавая его **спропертирестриктион**, чтобы определить, где находится строка, представляющая хранилище сообщений по умолчанию. 
    
4. Call [IMAPISession:: OpenEntry](imapisession-openentry.md), передавая свойство **пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)) из строки хранилища сообщений по умолчанию в таблице хранилища сообщений.
    
5. ВыЗовите метод [IMAPIProp::](imapiprop-getprops.md) -PROPS хранилища сообщений для получения свойства **пр_ипм_субтри_ентрид** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md)).
    
6. ВыЗовите метод [IMsgStore:: OpenEntry](imsgstore-openentry.md) хранилища сообщений, передав свойство **пр_ипм_субтри_ентрид** , чтобы открыть корневую папку поддерева IPM хранилища сообщений. 
    
7. ВыЗовите метод [IMAPIContainer:: жесиерарчитабле](imapicontainer-gethierarchytable.md) корневой папки IPM, чтобы получить доступ к своей таблице иерархии. 
    


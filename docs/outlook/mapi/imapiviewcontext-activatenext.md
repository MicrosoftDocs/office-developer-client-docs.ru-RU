---
title: имапивиевконтекстактиватенекст
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIViewContext.ActivateNext
api_type:
- COM
ms.assetid: 25ce90ac-526e-48a0-9edb-bd266375d4f4
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5b10f744e3033aab63820e4cd5e414f4c01c27cf
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410618"
---
# <a name="imapiviewcontextactivatenext"></a>IMAPIViewContext::ActivateNext

**Относится к**: Outlook 2013 | Outlook 2016 
  
Активирует следующее или предыдущее сообщение в порядке просмотра. 
  
```cpp
HRESULT ActivateNext(
ULONG ulDir,
LPCRECT prcPosRect
);
```

## <a name="parameters"></a>Параметры

_улдир_
  
> возврата Флаги состояния, которые предоставляют сведения о сообщении, которое необходимо активировать. Допустимые параметры флагов:
    
  - VCDIR_CATEGORY: средство просмотра должно активировать сообщение в другой категории представления. Активируемое сообщение: 
        
    - Первое сообщение в категории "в следующем представлении", если этот флаг имеет значение **или**ed с VCDIR_NEXT. 
        
    - Последнее сообщение в предыдущей категории представления, если этот флаг имеет значение **или**ed с VCDIR_PREV, а предыдущая категория развернута. 
        
    - Первое сообщение в предыдущей категории представления, если этот флаг имеет значение **или**ed с VCDIR_PREV, а предыдущая категория не развернута. В этом случае предыдущая категория перестанет автоматически расширяться. 
        
  - VCDIR_DELETE: средство просмотра должно активировать следующее или предыдущее сообщение, так как текущее сообщение было удалено. 
        
  - VCDIR_MOVE: средство просмотра должно активировать следующее или предыдущее сообщение, так как текущее сообщение было перемещено. 
        
  - VCDIR_NEXT: средство просмотра должно активировать следующее сообщение в порядке просмотра. 
        
  - VCDIR_PREV: средство просмотра должно активировать предыдущее сообщение в порядке просмотра. 
        
  - VCDIR_UNREAD: средство просмотра должно активировать следующее или предыдущее непрочитанное сообщение в порядке просмотра. 
    
_пркпосрект_
  
> возврата Указатель на структуру **прямоугольника** Windows, содержащую размер и положение окна, которое будет использоваться для отображения активированного сообщения. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщение успешно активировано. 
    
S_FALSE 
  
> Сообщение успешно активировано, но в процессе открыт другой тип формы.
    
## <a name="remarks"></a>Примечания

Объекты форм вызовите метод **имапивиевконтекст:: активатенекст** , чтобы изменить сообщение, отображаемое для пользователя. Значение, передаваемое в параметре _улдир_ , указывает, какое сообщение должно быть активировано, а в некоторых случаях — почему. Флаги VCDIR_NEXT и VCDIR_PREVIOUS соответствуют пользователям, которые выбирая **следующую** или **предыдущую** команду в представлении соответственно. Эти операции обычно соответствуют перемещению вверх или вниз одного сообщения в списке сообщений в средстве просмотра форм. 
  
Флаги VCDIR_DELETE и VCDIR_MOVE задаются с помощью методов [имапимессажесите::D елетемессаже](imapimessagesite-deletemessage.md) и [Имапимессажесите:: мовемессаже](imapimessagesite-movemessage.md) соответственно. Реализации этих методов вызывают **активатенекст** с соответствующим направлением, а затем выполняют запрошенную операцию над сообщением, если не удалось вызвать **активатенекст** . Средства просмотра форм обычно позволяют пользователям указать направление перемещения в списке сообщений. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Реализация [имапивиевконтекст:: активатенекст](imapiviewcontext-activatenext.md) создает следующее или предыдущее сообщение в папке в зависимости от значения свойства _улдир_, текущего сообщения. После возврата **активатенекст** вызовите [имапимессажесите::.](imapimessagesite-getmessage.md) Get, чтобы получить указатель на вновь активируемое сообщение. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Если **активатенекст** возвращает S_FALSE, или если текущее сообщение отсутствует, выполните процедуру нормального завершения работы, которая должна включать вызов метода [Имапиформ:: шутдовнформ](imapiform-shutdownform.md) формы. Если отображается следующее или предыдущее сообщение, используйте прямоугольник окна, переданный в параметре _пркпосрект_ , чтобы отобразить его. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мимапиформвиевер. cpp  <br/> |Кмимапиформвиевер:: Активатенекст  <br/> |MFCMAPI реализует метод **имапивиевконтекст:: активатенекст** в этой функции.  <br/> |
   
## <a name="see-also"></a>См. также

- [IMAPIViewContext::GetViewStatus](imapiviewcontext-getviewstatus.md)
- [IMAPIViewContext : IUnknown](imapiviewcontextiunknown.md)
- [Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: Службы сообщений и профилям
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 0f55d4cda013810884177a0f47e861e3693defd7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19810027"
---
# <a name="message-services-and-profiles"></a>Службы сообщений и профилям
  
**Относится к**: Outlook 
  
Некоторые пользователи требуются службы несколько систем обмена сообщениями, каждый из которых одного или нескольких поставщиков услуг. Так как это сложный для установки и настройки каждого из этих поставщиков услуг по отдельности, а так как сервер обмена сообщениями обычно требуется группа связанных поставщиков для предоставления его функциональные возможности, MAPI включает в себя понятие службы сообщений. Службы сообщений помогают пользователям установить и настроить их поставщиков услуг.
  
Чтобы создать службы сообщений, разработчик пишет к программе службы сообщений запись точки управления конфигурацией каждый поставщик в службе и программы установки для выполнения следующих:
  
- Установка каждого поставщика в службе.
    
- Создание реестра и инициализации записей файла.
    
- Создание записей в файле конфигурации MAPI Mapisvc.inf.
    
Файла Mapisvc.inf содержит сведения, связанные с конфигурацией все службы сообщений и поставщиков услуг, установленный на компьютере. Организован в иерархической разделы с каждым уровнем, связанной со следующей. В верхней состоит из трех разделов, которые содержат следующие: 
  
- Список файлов справки службы сообщений.
    
- Список наиболее важные или по умолчанию, службы сообщений.
    
- Список всех служб на компьютере.
    
Следующий уровень содержит разделы для каждой службы сообщений и последний уровень содержит разделы для каждого поставщика служб в службе. Требует MAPI, что разработчики поставщиков услуг и службы сообщений добавлять определенные элементы в Mapisvc.inf; Разработчики могут добавлять другие элементы на свой собственный риск. Большинство данных в заканчивается Mapisvc.inf вверх на одно или несколько профилей, коллекции параметров конфигурации для пользователя предпочтительный набор служб сообщения. Поскольку компьютер может иметь несколько пользователей и одного пользователя может иметь несколько наборов параметров, числа профилей могут существовать на компьютере. Каждый профиль описывает на другой набор службы сообщений. Наличие нескольких профилей позволяет пользователю работать, например, дома с помощью одного набора служб сообщения и в офисе с другим набором.
  
Профили создаются во время входа в систему или установки службы сообщений клиентским приложением, которое предоставляет поддержку конфигурации. MAPI предоставляет два клиентских приложений: мастер профилей и элемент панели управления. Элемент панели управления — это проверка всех составляющих конфигурации приложение, с помощью которой пользователи могут создание, удаление, изменить и скопируйте профили, а также вносить изменения в записи в профиле. Мастер профиля — это простое приложение предназначено для Добавление службы сообщений в профиль упростить. Мастер профиля состоит из нескольких диалоговых окон, называется страницы свойств, которые запрашивать у пользователя через процесс установки и настройки службы. Пользователь должен будет ввести только значения для наиболее важные параметры; все другие параметры наследуют значения по умолчанию. После создания профилей пользователей не разрешены для внесения изменений. 
  
В то время как элемент управления панели всегда вызывается с помощью панели управления, существует множество сценариев, которые могут вызвать мастер профиля для вызова. Клиентские приложения можно вызвать мастер профилей, чтобы создать профиль по умолчанию во время входа в систему, когда один еще не был создан. Вместо воссоздание код, чтобы добавить профиль, элемент панели управления или другого клиентского приложения можно использовать функциональность уже в мастере профилей. Служба сообщений, в его функции точки входа при можно вызывать мастер профиля службы необходимо добавить в профиль по умолчанию. Службы сообщений, с помощью мастера профилей необходимо создать дополнительные функцию и стандартная процедура Windows диалогового окна. Мастер профиля вызывает функцию точки входа для получения диалоговое окно настройки службы, пока процедура диалогового окна обрабатывает сообщения, которые создаются при использовании этого диалоговое окно. 
  
Профили организованы аналогично для файла Mapisvc.inf. Профили связаны иерархических разделов; службы поставщиков собственные разделов в нижнем уровне службы сообщений владельцем разделах на среднем уровне и MAPI несет ответственность за разделах на верхнем уровне. В каждом разделе определяется с помощью уникального идентификатора, называемого [MAPIUID](mapiuid.md). В разделах MAPI внутренние MAPI, такие как идентификаторы всех разделах профиля службы сообщений и ссылки на других разделах. Каждый раздел службы сообщений сохранение ссылки на разделы его поставщика и каждый раздел поставщика сохраняет ссылку на раздел его службы. 
  
На следующем рисунке показана содержимое двух типичного профилей. Сэм имеет двух профилей на свой компьютер, одно для домашнего использования, а другое для использования office. Домашняя страница профиля содержит три службы сообщений. Сообщение службы X — это служба единого поставщика для управления адресной книгой. Сообщение служб Y и Z иметь три поставщика — поставщика адресных книг, поставщика хранилища сообщений и поставщика транспорта. Профиль рабочего элемента SAM содержит две службы другое сообщение, каждый из которых содержит поставщика адресных книг, поставщика хранилища сообщений и поставщика транспорта. 
  
**Пример профиля**
  
![Пример профиля] (media/amapi_56.gif "Пример профиля")
  
На следующем рисунке показана профиля, которая включает в себя две службы сообщений. Код для установки и настройки поставщиков услуг, относящихся к службе сообщение находится в этой Библиотеке код для поставщиков. Этот код считывает сведения из профиля во время входа в систему для настройки поставщиков услуг и его запрос пользователя, если это возможно и необходимости отсутствующие сведения. Запросы от клиента, чтобы просмотреть или изменить параметры конфигурации для каких-либо из поставщиков также обрабатывается этот общий код.
  
**Установка и настройка поставщиков услуг**
  
![Установка и настройка поставщиков услуг] (media/amapi_55.gif "Установка и настройка поставщиков услуг")
  
## <a name="see-also"></a>См. также

- [MAPIUID](mapiuid.md)
- [����� �������� � ���������������� MAPI](mapi-programming-overview.md)


---
title: NSTServiceEntry
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 5ada6363-2406-4c0a-8326-a299a8bbefe1
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 96c04a242c477204ea1447fb78c31d189eeac59a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32280056"
---
# <a name="nstserviceentry"></a>NSTServiceEntry

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Функция точки входа службы сообщений для поставщика хранилища MAPI, которая заключает PST-файл в локальное хранилище в качестве хранилища НСТ. 
  
## <a name="quick-info"></a>Краткие сведения

|||
|:-----|:-----|
|Реализовано в:  <br/> |Поставщик MAPI  <br/> |
|Вызывающая сторона:  <br/> |MAPI  <br/> |
   
```cpp
HRESULT NSTServiceEntry( 
    HINSTANCE hInstance,   
    LPMALLOC lpMalloc, 
    LPMAPISUP lpMAPISup, 
    ULONG ulUIParam, 
    ULONG ulFlags, 
    ULONG ulContext, 
    ULONG cValues, 
    LPSPropValue lpProps, 
    LPPROVIDERADMIN lpProviderAdmin, 
    LPMAPIERROR FAR * lppMapiError 
);
```

## <a name="parameters"></a>Параметры

 **Нстсервицеентри** использует прототип функции **[мсгсервицеентри](msgserviceentry.md)** . Для получения сведений о параметрах обратитесь к разделу **[мсгсервицеентри](msgserviceentry.md)**. 
  
## <a name="return-values"></a>Возвращаемые значения

Сведения о возвращаемых значениях приведены в разделе **[мсгсервицеентри](msgserviceentry.md)**. 
  
## <a name="remarks"></a>Замечания

При использовании **[GetProcAddress](https://msdn.microsoft.com/library/ms683212.aspx)** для поиска адреса этой функции в MSMapi32. dll укажите в качестве имени процедуры "нстсервицеентри". 
  
Чтобы использовать API репликации, поставщик хранилища MAPI должен сначала открыть и переключить локальное хранилище на основе PST, вызвав **[нстсервицеентри](nstserviceentry.md)**. Затем поставщик может использовать основные интерфейсы API- **[иосткс](iostxiunknown.md)** и **[ипсткс](ipstxiunknown.md)** для выполнения репликации. 
  
К хранилищу НСТ применяются следующие примечания:
  
- Не сохраняйте информацию в разделе Глобальный профиль при реализации поставщика MAPI, использующего **нстсервицеентри**. Раздел глобального профиля предоставляется многим поставщикам, и данные, хранящиеся в этом профиле, могут быть перезаписаны. 
    
- При сохранении отметок времени обновляются только элементы с существующими метками времени изменения. 
    
- При сохранении элементов проверка конфликтов не выполняется автоматически.
    
-  При сохранении элементов обнаружение дубликатов не выполняется. 
    
-  Файл, представляющий кэшированную версию сервера, добавляется с помощью параметра. НСТ. 
    
- Чтобы получить указатель на раздел глобального профиля, служба сообщений вызывает **[имаписуппорт:: опенпрофилесектион](imapisupport-openprofilesection.md)** в объекте support с помощью **пбнстглобалпрофилесектионгуид** , как определено ниже: 
    
  ```
  #define  pbNSTGlobalProfileSectionGuid "\x85\xED\x14\x23\x9D\xF7\x42\x66\x8B\xF2\xFB\xD4\xA5\x21\x29\x41"
  ```

- В этом случае объект поддержки службы сообщений должен гарантировать, что **имаписуппорт:: опенпрофилесектион** возвращает раздел профиля, который определен свойством **[пр_сервице_уид](pidtagserviceuid-canonical-property.md)** в разделе профиля по умолчанию. Чтобы получить этот раздел профиля, объект support может открыть раздел профиля по умолчанию, получить **пр_сервице_уид**и передать результат в **Имаписуппорт:: опенпрофилесектион** , чтобы получить правильный глобальный раздел профиля. Объект support, который в свою очередь, возвращает указатель на этот глобальный раздел профиля службе сообщений. 
    
## <a name="see-also"></a>См. также



[Сведения об API репликации](about-the-replication-api.md)


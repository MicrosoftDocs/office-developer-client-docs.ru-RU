---
title: ADRPARM
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ADRPARM
api_type:
- COM
ms.assetid: 35cd57b4-9901-456c-bf06-1f84e274eb4e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 9663a25a50d914f47cff48124898d16318bbbc43
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425899"
---
# <a name="adrparm"></a>ADRPARM

**Область применения**: Outlook 2013 | Outlook 2016 
  
Описывает отображение и поведение диалогового окна общего адреса. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapidefs.h  <br/> |
   
```cpp
typedef struct _ADRPARM
{
  ULONG cbABContEntryID;
  LPENTRYID lpABContEntryID;
  ULONG ulFlags;
  LPVOID lpReserved;
  ULONG ulHelpContext;
  LPSTR lpszHelpFileName;
  LPFNABSDI lpfnABSDI;
  LPFNDISMISS lpfnDismiss;
  LPVOID lpvDismissContext;
  LPSTR lpszCaption;
  LPSTR lpszNewEntryTitle;
  LPSTR lpszDestWellsTitle;
  ULONG cDestFields;
  ULONG nDestFieldFocus;
  LPSTR FAR *lppszDestTitles;
  ULONG FAR *lpulDestComps;
  LPSRestriction lpContRestriction;
  LPSRestriction lpHierRestriction;
} ADRPARM, FAR *LPADRPARM;

```

## <a name="members"></a>"Участники"

**cbABContEntryID**
  
> Количество bytes в идентификаторе записи, на который указывает **lpABContEntryID.**
    
**lpABContEntryID**
  
> Указатель на идентификатор входа контейнера, который поставляет начальный список адресов получателей, отображаемого в диалоговом окне адресов.
    
**ulFlags**
  
> Bitmask флагов, связанных с различными вариантами диалоговых адресов. Можно установить следующие флаги:
    
AB_RESOLVE
  
> Разрешить все имена после закрытия диалогового окна с адресом. Если есть неоднозначные записи, которые являются результатом процесса разрешения имен, диалоговое окно, как представляется, вызывает у пользователя помощь в их разрешении. Установка этого флага гарантирует, что все имена, возвращенные [IAddrBook::Address,](iaddrbook-address.md) будут разрешены. 
    
AB_SELECTONLY
  
> Отключить создание разных адресов для списка получателей. Этот флаг используется только в том случае, если диалоговое окно является модальным, как указывается DIALOG_MODAL заданной флагом.
    
ADDRESS_ONE
  
> Пользователь может выбрать именно одного получателя, а не нескольких получателей из списка. Этот флаг действителен только в том случае, если **значение cDestFields** нулевое и диалоговое окно является модальным, как указывается в DIALOG_MODAL заданной отметке. 
    
DIALOG_MODAL
  
> Вызывает отображение модальной версии диалогового окна общего адреса. Этот флаг или DIALOG_SDI должен быть заданной; они не могут быть установлены. 
    
DIALOG_OPTIONS
  
> Вызывает отображение кнопки **"Параметры** отправки" в диалоговом окне. Этот флаг используется только в том случае, если диалоговое окно является модальным, как указывается DIALOG_MODAL заданной флагом. 
    
DIALOG_SDI
  
> Вызывает отображённую версию общего диалогового окна адресов. Этот флаг или DIALOG_MODAL должен быть заданной; они не могут быть установлены. Флаг DIALOG_SDI игнорируется для клиентов, не Outlook, и будет отображаться модальная версия диалогового окна. Следовательно, указатель на ручку не следует ожидать в параметре _lpulUIParam_ [IAddrBook::Address.](iaddrbook-address.md)
    
**lpReserved**
  
> Зарезервировано, должно быть ноль.
    
**ulHelpContext**
  
> Указывает контекст в **справке,** который сначала будет показан при нажатии кнопки справки в диалоговом окне адресов. 
    
**lpszHelpFileName**
  
> Указатель на имя файла справки, который будет связан с диалоговое окно адреса. Член **lpszHelpFileName** используется вместе с **ulHelpContext** для вызова функции **Windows WinHelp.** 
    
**lpfnABSDI**
  
> Указатель на функцию MAPI на основе прототипа [ACCELERATEABSDI](accelerateabsdi.md) или NULL. Этот член применяется только к безмежной версии диалогового окна, как указывается в заданной DIALOG_SDI флаге. Клиенты, строив структуру **ADRPARM** для переададновки [в IAddrBook::Address,](iaddrbook-address.md) всегда должны задать **члену lpfnABSDI** NULL. Если флаг DIALOG_SDI, MAPI закажит его в допустимую функцию перед возвращением. Клиенты называют эту функцию из цикла сообщений, чтобы убедиться, что ускорители в диалоговом окне адресной книги работают. При отклонении диалогового окна и вызове функции MAPI, на которые указывает член **lpfnDismiss,** клиенты должны отогнать функцию **ACCELERATEABSDI** из цикла сообщений. 
    
**lpfnDismiss**
  
> Указатель на функцию на основе прототипа [DISMISSMODELESS](dismissmodeless.md) или NULL. Этот член применяется только к безмежной версии диалогового окна, как указывается в заданной DIALOG_SDI флаге. MAPI вызывает функцию **DISMISSMODELESS,** когда пользователь отклонять диалоговое окно без режима адреса, информируя клиента, вызываемого **IAddrBook::Address,** что диалоговое окно больше не активна. 
    
**lpvDismissContext**
  
> Указатель для контекстной информации, которая будет передана функции **DISMISSMODELESS,** указываемой участником **lpfnDismiss.** Этот член применяется только к безмежной версии диалогового окна, как указывается в заданной DIALOG_SDI флаге. 
    
**lpszCaption**
  
> Указатель на текст, который будет использоваться в качестве заголовка для общего диалогового окна адресов.
    
**lpszNewEntryTitle**
  
> Указатель на текст, который будет использоваться в качестве метки кнопки для кнопки, вызываемой диалогового окна **New Entry** или другого диалогового окна. 
    
**lpszDestWellsTitle**
  
> Указатель на текст, который будет использоваться в качестве заголовка для элементов управления текстовым полем получателя, которые могут отображаться в модальной версии диалогового окна общего адреса. Этот член не используется для бес режимных диалогов. 
    
**cDestFields**
  
> Количество элементов управления текстовым полем получателей в модальной версии диалогового окна адреса или нулевое значение, если диалоговое окно является бес режимным. Диалоговое окно адресов открыто для просмотра только при следующих условиях: 
    
  - Значение **участника cDestFields** установлено до нуля. 
    
  - Установлен DIALOG_BOX флаг.
    
  - Флаг ADDRESS_ONE не установлен.
    
  Настройка **cDestFields** для 0XFFFFFFFF означает, что MAPI должна создать по умолчанию число элементов управления текстовыми полями получателей. В этом случае **участниками lppszDestTitles** и **lpulDestComps** должны быть NULL. 
    
**nDestFieldFocus**
  
> Указывает определенное управление текстовым полем, которое должно иметь начальное внимание при отывке модальной версии диалогового окна. Это значение должно быть от 0 до значения **cDestFields** минус 1. 
    
**lppszDestTitles**
  
> Указатель на массив меток для кнопок, связанных с каждым из элементов управления текстовым полем, отображаемого в модальной версии диалогового окна адреса. Значение члена **cDestFields** указывает количество меток, включенных в массив. Если участником **lppszDestTitles** является NULL, метод **Address** использует названия по умолчанию. 
    
**lpulDestComps**
  
> Указатель на массив значений типа получателей, таких как MAPI_TO, MAPI_CC и MAPI_BCC, связанный с каждым управлением текстовым полем. Значение члена **CDestFields** указывает количество типов получателей, включенных в массив. Значения, на которые указывают **lpulDestComps,** можно  использовать для PR_RECIPIENT_TYPE [(PidTagRecipientType)](pidtagrecipienttype-canonical-property.md)свойства каждого получателя. Если участником **lpulDestComps** является NULL, метод **Address** использует типы получателей по умолчанию. 
    
**lpContRestriction**
  
> Указатель на [структуру SRestriction,](srestriction.md) которая ограничивает тип записей адресов, которые могут отображаться в диалоговом окне. 
    
**lpHierRestriction**
  
> Указатель на **структуру SRestriction,** которая ограничивает контейнеры адресной книги, которые могут поставлять записи адресов для отображения в диалоговом окне. 
    
## <a name="remarks"></a>Примечания

**Структуры ADRPARM** используются клиентами и поставщиками услуг для контроля внешнего вида и поведения диалоговых окне общего адреса MAPI. Существует два варианта диалоговых окне адресов: modeless и modal. Некоторые члены в структуре **ADRPARM** применяются к обеим версиям диалогового окна, но некоторые применяются только к одной из двух версий. В следующей таблице участники структуры **ADRPARM** связаны с их использованием с общими диалогами адресов. 
  
|Член ADRPARM|Тип диалоговое окно|
|:-----|:-----|
|**cbABContEntryID** и **lpABContEntryID** <br/> |Modal и modeless  <br/> |
|**ulFlags** <br/> |Modal и modeless  <br/> |
|**lpReserved** <br/> |Modal и modeless  <br/> |
|**ulHelpContext и** **lpszHelpFileName** <br/> |Modal и modeless  <br/> |
|**lpfnABSDI** <br/> |Modeless  <br/> |
|**lpfnDismiss** и **lpvDismissContext** <br/> |Modeless  <br/> |
|**lpszCaption** <br/> |Modal и modeless  <br/> |
|**lpszNewEntryTitle** <br/> |Модальный  <br/> |
|**lpszDestWellsTitle**, **cDestFields**, **nDestFieldFocus**, **lppszDestTitles** и **lpulDestComps** <br/> |Модальный  <br/> |
|**lpContRestriction** <br/> |Modal и modeless  <br/> |
|**lpHierRestriction** <br/> |Modal и modeless  <br/> |
   
Диалоговое окно без режима — это отображение записей из одного или более контейнеров адресной книги только для чтения. Диалоговое окно может отображать все записи из выбранных контейнеров или ограничиваться только теми записями и контейнерами, которые соответствуют критериям, установленным ограничением. Ограничение содержимого, на которое указывает **lpContRestriction,** может ограничить типы отображаемой записи, а ограничение иерархии, на которое указывает **lpHierRestriction,** может ограничить контейнеры, предоставляющие записи. Чтобы сообщить звониму об отклонении диалогового окна, MAPI вызывает функцию, предоставляемую вызываемой вызываемой, которая соответствует [прототипу DISMISSMODELESS.](dismissmodeless.md) Другая функция, которая соответствует прототипу [ACCELERATEABSDI,](accelerateabsdi.md) предоставляется MAPI и вызывается вызываемой вызываемой в цикле сообщений Windows для облегчения работы клавишных ярлыков. Бесхозяйная версия диалогового окна адреса MAPI может отображаться, когда клиенты звонят [в IAddrBook::Address](iaddrbook-address.md) или когда поставщики услуг называют [IMAPISupport::Address.](imapisupport-address.md) 
  
Диалоговое окно modal — это отображение записей из одного или более контейнеров. Его содержимое может быть затронуто таким же образом, как и в бесконтактной версии ограничениями, установленными в **членах lpContRestriction** и **lpHierRestriction.** Помимо окна списка, отображаемого записей контейнера, диалоговое окно modal может содержать от одного до трех элементов управления текстовым полем для хранения записей, выбранных пользователем. Каждый контроль редактирования связан с определенным типом **получателя или PR_RECIPIENT_TYPE,** например MAPI_TO. Диалоговое окно модального адреса может отображаться  с помощью методов Адрес или когда клиенты звонят [в IAddrBook::D etails,](iaddrbook-details.md) а поставщики услуг называют [IMAPISupport::D etails](imapisupport-details.md). 
  
Эта иллюстрация включает два управления текстовым полем, так как член **cDestFields** структуры **ADRPARM,** контролирующей отображение этого диалогового окна, задает 2. Первый контроль имеет начальное внимание, так как для **члена nDestFieldFocus** установлено 0. 
  
Член **lpszNewEntryTitle** указывает на текст для метки кнопки, которая при выборе вызывает отображение дополнительного диалогового окна. Как правило, как показано на иллюстрации диалогового окна modal, кнопка помечена New, а в диалоговом окне, которое отображается, перечислены все типы адресов, которые могут быть созданы любыми поставщиками адресных книг в профиле.  Клиенты вызывают отображение этого диалогового окна New **Entry,** вызывая [параметр IAddrBook::NewEntry](iaddrbook-newentry.md) и продавая ноль для параметра  _cbEidNewEntryTpl_ и NULL для  _параметра lpEidNewEntryTpl_ при выборе кнопки. Сведения, включенные в диалоговое окно, приходят из разной таблицы MAPI. 
  
Каждая запись в этом диалоговом окне связана с шаблоном ввода данных, необходимых для создания адреса определенного типа. Большинство поставщиков адресных книг поставляют по одному шаблону для каждого типа записи адреса, которую они могут создать. Когда пользователь делает выбор из этого диалогового окна, MAPI отображает соответствующий шаблон.
  
Наиболее значительные четыре бита члена **ulFlags** структуры **ADRPARM** содержат номер версии, определяющий версию **структуры ADRPARM.** Текущая версия — 0 (ноль) или ADRPARM_HELP_CTX. Текущая реализация MAPI будет неудачной для любой версии структуры, кроме нуля. 
  
Будущие версии структуры могут быть совершенно другими; они могут не поддерживать структуру version-zero. Для извлечения номера версии из члена **ulFlags** и объединения его с определенными флагами предоставляются следующие макрос: 
  
- **GET_ADRPARM_VERSION** _(ulFlags)_ 
- **SET_ADRPARM_VERSION** (_ulFlags_, _ ulVersion _) 
- **ADRPARM_HELP_CTX**
  
## <a name="see-also"></a>См. также

- [ACCELERATEABSDI](accelerateabsdi.md)
- [DISMISSMODELESS](dismissmodeless.md)
- [IAddrBook::Address](iaddrbook-address.md)
- [IMAPISupport::Address](imapisupport-address.md)
- [SRestriction](srestriction.md)
- [Структуры MAPI](mapi-structures.md)


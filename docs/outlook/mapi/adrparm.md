---
title: ADRPARM
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ADRPARM
api_type:
- COM
ms.assetid: 35cd57b4-9901-456c-bf06-1f84e274eb4e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: ad26cb9b77404d6470f7a8d787eb85edc5cce402
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/21/2018
ms.locfileid: "19808044"
---
# <a name="adrparm"></a>ADRPARM

**Относится к**: Outlook 
  
Описание отображения и поведения стандартным диалоговым окном адрес. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapidefs.h  <br/> |
   
```cpp
typedef struct _ADRPARM
{
  ULONG cbABContEntryID;
  LPENTRYID lpABContEntryID;
  ULONG ulFlags;
  LPVOID lpReserved;
  ULONG ulHelpContext;
  LPSTR lpszHelpFileName;
  LPFNABSDI lpfnABSDI;
  LPFNDISMISS lpfnDismiss;
  LPVOID lpvDismissContext;
  LPSTR lpszCaption;
  LPSTR lpszNewEntryTitle;
  LPSTR lpszDestWellsTitle;
  ULONG cDestFields;
  ULONG nDestFieldFocus;
  LPSTR FAR *lppszDestTitles;
  ULONG FAR *lpulDestComps;
  LPSRestriction lpContRestriction;
  LPSRestriction lpHierRestriction;
} ADRPARM, FAR *LPADRPARM;

```

## <a name="members"></a>Members

**cbABContEntryID**
  
> Число байт в идентификаторе запись, на который указывает **lpABContEntryID**.
    
**lpABContEntryID**
  
> Указатель на идентификатор записи контейнера, представляющий начальное список адресов получателей, которые отображаются в поле адрес.
    
**ulFlags**
  
> Битовая маска флаги, связанные с различные параметры диалогового окна адрес. Можно задать следующие флажки:
    
AB_RESOLVE
  
> Включите все имена разрешаться после закрытия диалогового окна адрес. В случае неоднозначные операций, которые возникают из процесса разрешения имен диалоговое окно отображается для запроса пользователя для получения справки по их устранению. Параметр, этот флаг гарантирует, что все имена, возвращаемые [IAddrBook::Address](iaddrbook-address.md) разрешаются. 
    
AB_SELECTONLY
  
> Отключение создания одноразовых адреса для списка получателей. Этот флаг используется только в том случае, если окно является модальным, как указанной флагом DIALOG_MODAL задаваемая.
    
ADDRESS_ONE
  
> Пользователь может выбрать только один получатель вместо нескольким получателям из списка. Этот флаг действителен только в том случае, если **cDestFields** равно 0, а диалоговое окно является модальным, как указанной флагом DIALOG_MODAL задаваемая. 
    
DIALOG_MODAL
  
> Вызывает модальное версии общие адреса диалогового окна для отображения. Необходимо задать этот флаг или DIALOG_SDI; они не могут быть заданы. 
    
DIALOG_OPTIONS
  
> Вызывает кнопки **Отправить параметры** для отображения в диалоговом окне. Этот флаг используется только в том случае, если окно является модальным, как указанной флагом DIALOG_MODAL задаваемая. 
    
DIALOG_SDI
  
> Вызывает безрежимным версии общие адреса диалогового окна для отображения. Необходимо задать этот флаг или DIALOG_MODAL; они не могут быть заданы. Флаг DIALOG_SDI игнорируется для клиентов, не являющиеся Outlook и будет отображаться версия модального диалогового окна. Следовательно указатель мыши на маркер не следует ожидать в параметре _lpulUIParam_ [IAddrBook::Address](iaddrbook-address.md).
    
**lpReserved**
  
> Зарезервированные, должен быть равно нулю.
    
**ulHelpContext**
  
> Определяет контекст, в рамках **справки** , который будет отображаться сначала при нажатии кнопки справки в поле адрес. 
    
**lpszHelpFileName**
  
> Указатель на имя файла справки, который будет связан с диалоговое окно "адрес". Член **lpszHelpFileName** используется вместе с **ulHelpContext** для вызова функции Windows **WinHelp** . 
    
**lpfnABSDI**
  
> Указатель на функцию MAPI на основе прототип [ACCELERATEABSDI](accelerateabsdi.md) или значение NULL. Этот член относится к безрежимным версии диалоговое окно, только как указанной флагом DIALOG_SDI задаваемая. Построение структуру **ADRPARM** для передачи [IAddrBook::Address](iaddrbook-address.md) клиентов должны всегда набора **lpfnABSDI** значение NULL. Если значение флага DIALOG_SDI, MAPI будет установите его в допустимую функцию перед возвращением. Клиенты эта функция из в их цикл обработки сообщений, чтобы убедиться в том, что ускорители работы в поле адрес книги рабочих поле диалогового окна. При закрытии диалоговое окно MAPI вызывает функцию, на который указывает член **lpfnDismiss** , клиенты должны отсоедините функцию **ACCELERATEABSDI** из своих цикл обработки сообщений. 
    
**lpfnDismiss**
  
> Указатель на функцию на основе прототип [DISMISSMODELESS](dismissmodeless.md) или значение NULL. Этот член применим только к безрежимным версии диалоговое окно, только как указанной флагом DIALOG_SDI задаваемая. MAPI вызывает **DISMISSMODELESS** функцию, если пользователь не закрывает диалоговое окно безрежимным адрес, уведомляющее о клиента, вызывающего **IAddrBook::Address** диалоговое окно не является активной. 
    
**lpvDismissContext**
  
> Указатель на данные контекста, передаваемых в функцию **DISMISSMODELESS** , на который указывает член **lpfnDismiss** . Этот член применим только к безрежимным версии диалоговом окне, указанной флагом DIALOG_SDI задаваемая. 
    
**lpszCaption**
  
> Указатель на текст, который используется в качестве названия для стандартным диалоговым окном адрес.
    
**lpszNewEntryTitle**
  
> Указатель на текст для использования в качестве метки кнопки для кнопки, который вызывает диалоговое окно **Новая запись** или другое диалоговое окно. 
    
**lpszDestWellsTitle**
  
> Указатель на текст для использования в качестве заголовка для получателей элемента управления текстовых полей, которые могут появляться в модальное версии стандартным диалоговым окном адрес. Этот член не используется для безрежимным диалоговых окон. 
    
**cDestFields**
  
> Число получателей текстовых полей в версии модальное диалоговое окно "адрес" или ноль, если окно является безрежимным. Диалоговое окно "адрес" Открыть для просмотра только в том случае, если выполняются следующие условия: 
    
  - Член **cDestFields** присваивается нулевое значение. 
    
  - Флаг DIALOG_BOX установлен.
    
  - Флаг ADDRESS_ONE не установлен.
    
  Установка **cDestFields** для 0XFFFFFFFF предполагает, что MAPI следует создать по умолчанию число получателей текст элемента управления полей. В этом случае члены **lppszDestTitles** и **lpulDestComps** значения NULL. 
    
**nDestFieldFocus**
  
> Указывает, определенного текстового поля, для которого следует внимание при отображении версии модального диалогового окна. Это значение должно быть между 0 и значением **cDestFields** минус 1. 
    
**lppszDestTitles**
  
> Указатель на массив метки для кнопки, связанные с каждым из элемента управления текстовых полей, отображаемых в версию модальное диалоговое окно "адрес". Значение элемента **cDestFields** указывает число меток, включенные в массиве. Если член **lppszDestTitles** имеет значение NULL, метод **адрес** использует по умолчанию заголовков. 
    
**lpulDestComps**
  
> Указатель на массив значений тип получателя, например MAPI_TO, MAPI_CC и MAPI_BCC, который связан с каждой текстового поля. Значение элемента **CDestFields** показывает, сколько типов получателей, включенных в массиве. Значения, на который указывает **lpulDestComps** можно использовать для свойства **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md)) для каждого получателя. Если член **lpulDestComps** имеет значение NULL, метод **адрес** использует типы получателей по умолчанию. 
    
**lpContRestriction**
  
> Указатель на структуру [SRestriction](srestriction.md) , какие записей адресов, которые могут отображаться в диалоговом окне. 
    
**lpHierRestriction**
  
> Указатель на структуру **SRestriction** , которая ограничивает контейнеров адресной книги, которые можно предоставить записей адресов для отображения в диалоговом окне. 
    
## <a name="remarks"></a>Замечания

**ADRPARM** структуры используются для управления внешний вид и поведение MAPI адрес окон с клиентов и поставщиков услуг. Существуют два вида диалоговое окно "адрес": безрежимным и модальные окна. Некоторые элементы в структуре **ADRPARM** применяются для обеих версий диалоговое окно, но некоторые применимы только к одной из двух версий. В следующей таблице элементы структуры **ADRPARM** относится к их использования с адреса окон. 
  
|Член ADRPARM|Тип диалогового окна|
|:-----|:-----|
|**cbABContEntryID** и **lpABContEntryID** <br/> |Модальные окна и безрежимным  <br/> |
|**ulFlags** <br/> |Модальные окна и безрежимным  <br/> |
|**lpReserved** <br/> |Модальные окна и безрежимным  <br/> |
|**ulHelpContext** и **lpszHelpFileName** <br/> |Модальные окна и безрежимным  <br/> |
|**lpfnABSDI** <br/> |MODELESS  <br/> |
|**lpfnDismiss** и **lpvDismissContext** <br/> |MODELESS  <br/> |
|**lpszCaption** <br/> |Модальные окна и безрежимным  <br/> |
|**lpszNewEntryTitle** <br/> |Модальные окна  <br/> |
|**lpszDestWellsTitle**, **cDestFields**, **nDestFieldFocus**, **lppszDestTitles**и **lpulDestComps** <br/> |Модальные окна  <br/> |
|**lpContRestriction** <br/> |Модальные окна и безрежимным  <br/> |
|**lpHierRestriction** <br/> |Модальные окна и безрежимным  <br/> |
   
Диалоговое окно безрежимным отображается только для чтения записей из одного или нескольких контейнеров адресной книги. Диалоговое окно можно отобразить все записи из выбранного контейнеров или ограничиваться записей и контейнеры, которые соответствуют критериям, приведенным в ограничение. Ограничение содержимое, на который указывает **lpContRestriction** можно ограничить типы записей отображаются и ограничения иерархии, на который указывает **lpHierRestriction** можно ограничить контейнеров, предоставляя записей. Для оповещения вызывающего абонента, когда диалоговое окно закрывается, MAPI вызывает функцию, предоставленные вызывающего абонента, которая соответствует прототип [DISMISSMODELESS](dismissmodeless.md) . Другой функции, соответствующий прототип [ACCELERATEABSDI](accelerateabsdi.md) , автор MAPI и вызывать вызывающим абонентом в цикл обработки сообщений Windows, чтобы облегчить работу сочетания клавиш. Когда клиенты вызывать [IAddrBook::Address](iaddrbook-address.md) или [IMAPISupport::Address](imapisupport-address.md)вызова поставщиков услуг отображается безрежимным версия MAPI адреса диалогового окна. 
  
Чтение и запись модального диалогового окна отображается записей из одного или нескольких контейнеров. Его содержимое может измениться точно так же, безрежимным версии путем ограничения установки в **lpContRestriction** и **lpHierRestriction** элементы. В дополнение к поле со списком отображения элементов контейнера модального диалогового окна может содержать от одного до трех элемента управления текстовых полей для хранения записей, выбранный пользователем. Все элементы управления, изменить связан с определенным типом получателей или **PR_RECIPIENT_TYPE** свойства, такие как MAPI_TO. Диалоговое окно модальное адрес отображаются с помощью одного из методов **адрес** или при клиенты вызывать [IAddrBook::Details](iaddrbook-details.md) и [IMAPISupport::Details](imapisupport-details.md)вызова поставщиков услуг. 
  
На этом рисунке включает в себя два элемента управления текстовых полей так, как член **cDestFields** структуры **ADRPARM** , управление отображением в этом диалоговом окне 2. Первый элемент управления имеет фокус начального, так как член **nDestFieldFocus** имеет значение 0. 
  
Элемент **lpszNewEntryTitle** указывает текст для метки кнопки, выполнение, при этом дополнительное диалоговое для отображения. Как правило как показано на рисунке модального диалогового окна, кнопка помечена как **Создать** и поле, которое отображается список всех типов адресов, которые могут быть созданы в указанных поставщиками адресной книги в профиле. Клиенты вызвать это диалоговое окно **Новая запись** будет отображаться путем вызова [IAddrBook::NewEntry](iaddrbook-newentry.md) и передачи нуля для параметра _cbEidNewEntryTpl_ и значение NULL для параметра _lpEidNewEntryTpl_ при выборе пользователем кнопки. Сведения, содержащиеся в данном диалоговом извлекаются из таблицы одноразовых MAPI. 
  
Каждая запись в данном диалоговом связан с шаблоном для ввода данных, необходимых для создания адрес определенного типа. Большинство поставщиками адресной книги всегда один шаблон для каждого типа записи адресов, которые они могут быть созданы. Когда пользователь выбирает элемент в этом диалоговом окне, MAPI отображает соответствующий шаблон.
  
Наиболее важные четыре бита член **ulFlags** структуры **ADRPARM** содержат версии номер, идентифицирующий версию структуры **ADRPARM** . Текущая версия равно 0 (нулю) или ADRPARM_HELP_CTX. Текущая реализация интерфейса MAPI завершится с ошибкой для любой версии структуры, отличное от нуля. 
  
Будущих версий структуры может быть заменено другим; они могут не поддерживать Структура версии нулю. Для извлечения из члена **ulFlags** номер версии, а также для объединения с определенных флагов предоставляются следующие макросы: 
  
- **GET_ADRPARM_VERSION** (_ulFlags_) 
- **SET_ADRPARM_VERSION** (_ulFlags_, _ ulVersion _) 
- **ADRPARM_HELP_CTX**
  
## <a name="see-also"></a>См. также

- [ACCELERATEABSDI](accelerateabsdi.md)
- [DISMISSMODELESS](dismissmodeless.md)
- [IAddrBook::Address](iaddrbook-address.md)
- [IMAPISupport::Address](imapisupport-address.md)
- [SRestriction](srestriction.md)
- [Структуры MAPI](mapi-structures.md)


---
title: ADRPARM
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ADRPARM
api_type:
- COM
ms.assetid: 35cd57b4-9901-456c-bf06-1f84e274eb4e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 9663a25a50d914f47cff48124898d16318bbbc43
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425899"
---
# <a name="adrparm"></a>ADRPARM

**Относится к**: Outlook 2013 | Outlook 2016 
  
Описание отображения и поведения диалоговых окна с общим адресом. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapidefs.h  <br/> |
   
```cpp
typedef struct _ADRPARM
{
  ULONG cbABContEntryID;
  LPENTRYID lpABContEntryID;
  ULONG ulFlags;
  LPVOID lpReserved;
  ULONG ulHelpContext;
  LPSTR lpszHelpFileName;
  LPFNABSDI lpfnABSDI;
  LPFNDISMISS lpfnDismiss;
  LPVOID lpvDismissContext;
  LPSTR lpszCaption;
  LPSTR lpszNewEntryTitle;
  LPSTR lpszDestWellsTitle;
  ULONG cDestFields;
  ULONG nDestFieldFocus;
  LPSTR FAR *lppszDestTitles;
  ULONG FAR *lpulDestComps;
  LPSRestriction lpContRestriction;
  LPSRestriction lpHierRestriction;
} ADRPARM, FAR *LPADRPARM;

```

## <a name="members"></a>"Участники"

**cbABContEntryID**
  
> Количествобайтов в идентификаторе записи, на который указывает **lpABContEntryID.**
    
**lpABContEntryID**
  
> Указатель на идентификатор записи контейнера, который указывает начальный список адресов получателей, отображаемого в диалоговом окне адреса.
    
**ulFlags**
  
> Битоваяmas флагов, связанных с различными вариантами диалоговых окна адресов. Можно установить следующие флаги:
    
AB_RESOLVE
  
> Разрешите все имена после закрытия диалоговых окна адресов. Если в процессе разрешения имен есть неоднозначные записи, появится диалоговое окно с запросом помощи в их разрешении. Установка этого флага гарантирует, что все имена, возвращенные [IAddrBook::Address,](iaddrbook-address.md) будут разрешены. 
    
AB_SELECTONLY
  
> Отключите создание разных адресов для списка получателей. Этот флаг используется только в том случае, если диалоговое окно является модальным, как указывает DIALOG_MODAL флага.
    
ADDRESS_ONE
  
> Пользователь может выбрать только одного получателя вместо нескольких получателей в списке. Этот флаг действителен, только если **cDestFields** имеет нулевое значение, а диалоговое окно является модальным, как указано в DIALOG_MODAL флаге. 
    
DIALOG_MODAL
  
> Отображает модальные версии диалоговых окна с общим адресом. Этот флаг или DIALOG_SDI должен быть установлен; они не могут быть установлены. 
    
DIALOG_OPTIONS
  
> Отображает **кнопку** "Параметры отправки" в диалоговом окне. Этот флаг используется только в том случае, если диалоговое окно является модальным, как указывает DIALOG_MODAL флага. 
    
DIALOG_SDI
  
> Отображает неавтомтную версию общего диалоговых окна адресов. Этот флаг или DIALOG_MODAL должен быть установлен; они не могут быть установлены. Флаг DIALOG_SDI игнорируется для клиентов, не в том же Outlook, и отображается модальная версия диалоговых окно. Следовательно, указатель на лад не следует ожидать в параметре _lpulUIParam_ [IAddrBook::Address.](iaddrbook-address.md)
    
**lpReserved**
  
> Зарезервировано, должно быть нуль.
    
**ulHelpContext**
  
> Указывает контекст в **справке,** который будет сначала показан при нажатии пользователем кнопки "Справка" в диалоговом окне адреса. 
    
**lpszHelpFileName**
  
> Указатель на имя файла справки, который будет связан с диалоговое окно адреса. Член **lpszHelpFileName** используется вместе с **ulHelpContext** для вызова функции Windows **WinHelp.** 
    
**lpfnABSDI**
  
> Указатель на функцию MAPI на основе прототипа [ACCELERATEABSDI](accelerateabsdi.md) или NULL. Этот член применяется только к неавтомантной версии диалогового окна, как указано DIALOG_SDI заданной флагом. Клиенты, выполнив структуру **ADRPARM** для прохода в [IAddrBook::Address,](iaddrbook-address.md) должны всегда устанавливать для члена **lpfnABSDI** NULL. Если флаг DIALOG_SDI установлен, MAPI применет его к допустимой функции перед возвратом. Клиенты звонят этой функции из цикла сообщений, чтобы убедиться, что ускорители в диалоговом окне адресной книги работают. Когда диалоговое окно будет отклонено и MAPI вызывает функцию, на которая указывает член **lpfnDismiss,** клиенты должны отогнали функцию **ACCELERATEABSDI** из цикла сообщений. 
    
**lpfnDismiss**
  
> Указатель на функцию на основе [прототипа DISMISSMODELESS](dismissmodeless.md) или NULL. Этот член применяется только к неавтомантной версии диалогового окна, как указано в DIALOG_SDI флаге. MAPI вызывает функцию **DISMISSMODELESS,** когда пользователь отклонять диалоговое окно без режима адресов, сообщая клиенту, который вызывает **IAddrBook::Address,** о том, что диалоговое окно больше не активно. 
    
**lpvDismissContext**
  
> Указатель на контекстные сведения, которые передаются функции **DISMISSMODELESS,** на которую указывает **член lpfnDismiss.** Этот член применяется только к неавтомантной версии диалогового окна, как указано DIALOG_SDI флага. 
    
**lpszCaption**
  
> Указатель на текст, который будет использоваться в качестве заголовка для диалогового окна общего адреса.
    
**lpszNewEntryTitle**
  
> Указатель на текст, который будет использоваться в качестве подписи кнопки для кнопки, которая вызывает диалоговое окно "Новая запись" или другое диалоговое окно.  
    
**lpszDestWellsTitle**
  
> Указатель на текст, который будет использоваться в качестве заголовка для элементов управления текстом получателя, которые могут отображаться в модальной версии диалогового окна общего адреса. Этот член не используется для диалогов без режима. 
    
**cDestFields**
  
> Количество элементов управления текстового окна получателя в модальной версии диалогового окна адреса или нуль, если диалоговое окно не является модальным. Диалоговое окно "Адрес" открыто для просмотра только при следующих условиях: 
    
  - Для **члена cDestFields** установлено значение 0. 
    
  - Установлен DIALOG_BOX флага.
    
  - Флаг ADDRESS_ONE не установлен.
    
  Установка **значения cDestFields** 0XFFFFFFFF подразумевает, что MAPI должен создать количество элементов управления текстового поля получателя по умолчанию. В этом случае члены **lppszDestTitles** и **lpulDestComps** должны иметь NULL. 
    
**nDestFieldFocus**
  
> Указывает определенный текстовый поле, который должен иметь начальный фокус при отметке модальной версии диалогового окна. Это значение должно быть от 0 до значения **cDestFields** минус 1. 
    
**lppszDestTitles**
  
> Указатель на массив меток для кнопок, связанных с каждым из элементов управления текстового окна, которые отображаются в модальной версии диалогового окна адреса. Значение члена **cDestFields** указывает количество меток, включенных в массив. Если член **lppszDestTitles** имеет значение NULL, метод **Address** использует заголовки по умолчанию. 
    
**lpulDestComps**
  
> Указатель на массив значений типа получателя, например MAPI_TO, MAPI_CC и MAPI_BCC, связанных с каждым текстовым полем. Значение члена **CDestFields** указывает количество типов получателей, включенных в массив. Значения, на которые указывает **lpulDestComps,** можно использовать для PR_RECIPIENT_TYPE **(** [PidTagRecipientType)](pidtagrecipienttype-canonical-property.md)каждого получателя. Если член **lpulDestComps** имеет значение NULL, метод **Address** использует типы получателей по умолчанию. 
    
**lpContRestriction**
  
> Указатель на [структуру SRestriction,](srestriction.md) ограничивающую тип записей адресов, которые могут отображаться в диалоговом окне. 
    
**lpHierRestriction**
  
> Указатель на **структуру SRestriction,** ограничивающую контейнеры адресной книги, которые могут предоставить записи адресов для отображения в диалоговом окне. 
    
## <a name="remarks"></a>Примечания

**Структуры ADRPARM** используются клиентами и поставщиками услуг для управления внешним видом и поведением общих диалоговых окнах адресов MAPI. Существует два варианта диалоговых окна адресов: без режима и модального. Некоторые члены в структуре **ADRPARM** применяются к обеим версиям диалоговых окна, но некоторые относятся только к одной из двух версий. В следующей таблице члены структуры **ADRPARM** связаны с их использованием в общих диалоговых окнах адресов. 
  
|Член ADRPARM|Тип диалоговых окно|
|:-----|:-----|
|**cbABContEntryID** и **lpABContEntryID** <br/> |Модальные и неавториальные  <br/> |
|**ulFlags** <br/> |Модальные и неавториальные  <br/> |
|**lpReserved** <br/> |Модальные и неавториальные  <br/> |
|**ulHelpContext** и **lpszHelpFileName** <br/> |Модальные и неавториальные  <br/> |
|**lpfnABSDI** <br/> |Без режима  <br/> |
|**lpfnDismiss** и **lpvDismissContext** <br/> |Без режима  <br/> |
|**lpszCaption** <br/> |Модальные и неавториальные  <br/> |
|**lpszNewEntryTitle** <br/> |Модальный  <br/> |
|**lpszDestWellsTitle,** **cDestFields,** **nDestFieldFocus,** **lppszDestTitles** и **lpulDestComps** <br/> |Модальный  <br/> |
|**lpContRestriction** <br/> |Модальные и неавториальные  <br/> |
|**lpHierRestriction** <br/> |Модальные и неавториальные  <br/> |
   
Диалоговое окно без режима — это отображение записей из одного или более контейнеров адресной книги только для чтения. Диалоговое окно может отображать все записи из выбранных контейнеров или может быть ограничено только теми записями и контейнерами, которые соответствуют критериям, установленным ограничением. Ограничение содержимого, на которое указывает **lpContRestriction,** может ограничивать типы отображаемой записи, а ограничение иерархии, на которое указывает **lpHierRestriction,** может ограничивать контейнеры, предоставляющие записи. Чтобы сообщить вызываемой при отклоненном диалоговом окне, MAPI вызывает функцию, предоставляемую вызываемой, которая соответствует [прототипу DISMISSMODELESS.](dismissmodeless.md) Другая функция, которая соответствует прототипу [ACCELERATEABSDI,](accelerateabsdi.md) предоставляется MAPI и вызывается вызываемой в цикле сообщений Windows для упрощения работы сочетания клавиш. Нереализуемая версия диалоговых окна адресов MAPI может отображаться, когда клиенты звонят по адресу [IAddrBook::Address](iaddrbook-address.md) или когда поставщики услуг [звонят по адресу IMAPISupport::Address.](imapisupport-address.md) 
  
Модальные диалоговые окна — это экран чтения и записи записей из одного или более контейнеров. На его содержимое могут повлиять ограничения, установленные в членах **lpContRestriction** и **lpHierRestriction,** как и на непрерывную версию. Помимо списка, в котором отображаются записи контейнера, модальные диалоговые окна могут содержать от одного до трех элементов управления для хранения записей, выбранных пользователем. Каждый из них связан с определенным типом получателя **или PR_RECIPIENT_TYPE,** например MAPI_TO. Диалоговое окно модального адреса может отображаться в любом из методов **Address** или при вызове [IAddrBook::D etails](iaddrbook-details.md) и поставщиков услуг [IMAPISupport::D etails](imapisupport-details.md). 
  
На этом рисунке показаны два текстовых поля, так как элемент **cDestFields** структуры **ADRPARM,** управляющей отображением этого диалогового окна, имеет 2. Первый из них имеет начальный фокус, так как для члена **nDestFieldFocus** установлено 0. 
  
Член **lpszNewEntryTitle** указывает на текст для метки кнопки, которая при его выборе отображает дополнительное диалоговое окно. Как правило, как показано на иллюстрации модального диалогового  окна, кнопка помечена как новая, а в этом диалоговом окне перечислены все типы адресов, которые могут быть созданы любыми поставщиками адресных книг в профиле. Клиенты  вызывают отображение диалоговых окна "Новая запись", вызывая [IAddrBook::NewEntry](iaddrbook-newentry.md) и передавая ноль для параметра _cbEidNewEntryTpl_ и NULL для _параметра lpEidNewEntryTpl,_ когда пользователь нажмет кнопку. Сведения, включенные в это диалоговое окно, выводится из таблицы one-off MAPI. 
  
Каждая запись в этом диалоговом окне связана с шаблоном для ввода данных, необходимых для создания адреса определенного типа. Большинство поставщиков адресных книг по одному шаблону для каждого типа записи адреса, которую они могут создать. Когда пользователь делает выбор в этом диалоговом окне, MAPI отображает соответствующий шаблон.
  
Самые значимые четыре бита члена **ulFlags** структуры **ADRPARM** содержат номер версии, определяющий версию **структуры ADRPARM.** Текущая версия — 0 (ноль) или ADRPARM_HELP_CTX. Текущая реализация MAPI не будет работать для любой версии структуры, кроме нуля. 
  
Будущие версии структуры могут быть совершенно другими; они могут не поддерживать структуру с нулевой версией. Для извлечения номера версии из члена **ulFlags** и его объединения с определенными флагами предоставляются следующие макрос: 
  
- **GET_ADRPARM_VERSION** (_ulFlags)_ 
- **SET_ADRPARM_VERSION** (_ulFlags_, _ ulVersion _) 
- **ADRPARM_HELP_CTX**
  
## <a name="see-also"></a>См. также

- [ACCELERATEABSDI](accelerateabsdi.md)
- [DISMISSMODELESS](dismissmodeless.md)
- [IAddrBook::Address](iaddrbook-address.md)
- [IMAPISupport::Address](imapisupport-address.md)
- [SRestriction](srestriction.md)
- [Структуры MAPI](mapi-structures.md)


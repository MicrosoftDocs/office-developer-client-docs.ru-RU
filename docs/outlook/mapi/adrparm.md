---
title: ADRPARM
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ADRPARM
api_type:
- COM
ms.assetid: 35cd57b4-9901-456c-bf06-1f84e274eb4e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 9663a25a50d914f47cff48124898d16318bbbc43
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425899"
---
# <a name="adrparm"></a>ADRPARM

**Относится к**: Outlook 2013 | Outlook 2016 
  
Описывает отображение и поведение диалогового окна "общий адрес". 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |MAPIDEFS. h  <br/> |
   
```cpp
typedef struct _ADRPARM
{
  ULONG cbABContEntryID;
  LPENTRYID lpABContEntryID;
  ULONG ulFlags;
  LPVOID lpReserved;
  ULONG ulHelpContext;
  LPSTR lpszHelpFileName;
  LPFNABSDI lpfnABSDI;
  LPFNDISMISS lpfnDismiss;
  LPVOID lpvDismissContext;
  LPSTR lpszCaption;
  LPSTR lpszNewEntryTitle;
  LPSTR lpszDestWellsTitle;
  ULONG cDestFields;
  ULONG nDestFieldFocus;
  LPSTR FAR *lppszDestTitles;
  ULONG FAR *lpulDestComps;
  LPSRestriction lpContRestriction;
  LPSRestriction lpHierRestriction;
} ADRPARM, FAR *LPADRPARM;

```

## <a name="members"></a>"Участники"

**кбабконтентрид**
  
> Количество байтов в идентификаторе записи, на который указывает **лпабконтентрид**.
    
**лпабконтентрид**
  
> Указатель на идентификатор записи контейнера, который предоставляет начальный список адресов получателей, отображаемых в диалоговом окне адрес.
    
**ulFlags**
  
> Битовая маска флагов, связанных с различными параметрами диалогового окна адреса. Можно задать следующие флаги:
    
AB_RESOLVE
  
> Включите разрешение всех имен после закрытия диалогового окна "адрес". При наличии неоднозначных записей, которые могут возникать в процессе разрешения имен, отображается диалоговое окно с запросом на помощь пользователю при их разрешении. Установка этого флага гарантирует, что все имена, возвращаемые методом [IAddrBook:: Address](iaddrbook-address.md) , будут разрешены. 
    
AB_SELECTONLY
  
> Отключение создания одноразовых адресов для списка получателей. Этот флаг используется только в том случае, если диалоговое окно является модальным, как указано установленным флагом DIALOG_MODAL.
    
ADDRESS_ONE
  
> Пользователь может выбрать только одного получателя, а не нескольких получателей в списке. Этот флаг действителен, только если **кдестфиелдс** имеет значение 0, а диалоговое окно является модальным, как указано установленным флагом DIALOG_MODAL. 
    
DIALOG_MODAL
  
> Вызывает отображение модальной версии диалогового окна Общий адрес. Этот флаг или DIALOG_SDI должны быть установлены; они не могут быть заданы одновременно. 
    
DIALOG_OPTIONS
  
> Вызывает отображение кнопки " **Параметры отправки** " в диалоговом окне. Этот флаг используется только в том случае, если диалоговое окно является модальным, как указано установленным флагом DIALOG_MODAL. 
    
DIALOG_SDI
  
> Приводит к отображению немодальной версии диалогового окна Общий адрес. Этот флаг или DIALOG_MODAL должны быть установлены; они не могут быть заданы одновременно. Флаг DIALOG_SDI игнорируется для клиентов, отличных от Outlook, и отображается модальная версия диалогового окна. Поэтому указатель на дескриптор не должен быть ожидаемым в параметре _лпулуипарам_ объекта [IAddrBook:: Address](iaddrbook-address.md).
    
**лпресервед**
  
> Зарезервировано, должно быть равно нулю.
    
**улхелпконтекст**
  
> Задает контекст в **справке** , который будет отображаться при нажатии пользователем кнопки Справка в диалоговом окне адрес. 
    
**лпсзелпфиленаме**
  
> Указатель на имя файла справки, который будет связан с диалоговым окном "адрес". Элемент **лпсзелпфиленаме** используется вместе с **улхелпконтекст** для вызова функции Windows **WinHelp** . 
    
**лпфнабсди**
  
> Указатель на функцию MAPI на основе прототипа [акцелератеабсди](accelerateabsdi.md) или значения NULL. Этот член применяется только к немодальной версии диалогового окна, как указано в установленном флаге DIALOG_SDI. Клиенты, создающие структуру **адрпарм** для передачи в [IAddrBook:: Address](iaddrbook-address.md) должен всегда присвоить элементу **лпфнабсди** значение null. Если установлен флаг DIALOG_SDI, MAPI задаст ему допустимую функцию, прежде чем возвращать значение. Клиенты вызывают эту функцию из цикла сообщений, чтобы убедиться, что ускорители в диалоговом окне Адресная книга работают. Когда диалоговое окно закрывается, а MAPI вызывает функцию, на которую ссылается член **лпфндисмисс** , клиенты должны отсоединить функцию **акцелератеабсди** от своего цикла обработки сообщений. 
    
**лпфндисмисс**
  
> Указатель на функцию на основе прототипа [дисмиссмоделесс](dismissmodeless.md) или значение null. Этот элемент применяется только к немодальной версии диалогового окна, как указано в установленном флаге DIALOG_SDI. MAPI вызывает функцию **дисмиссмоделесс** , когда пользователь закрывает диалоговое окно с немодальным адресом, что информирует клиентский вызов **IAddrBook:: адрес** , который больше не активен в диалоговом окне. 
    
**лпвдисмиссконтекст**
  
> Указатель на сведения контекста, передаваемые в функцию **дисмиссмоделесс** , на которую указывает элемент **лпфндисмисс** . Этот элемент применяется только к немодальной версии диалогового окна, как указано в установленном флаге DIALOG_SDI. 
    
**лпсзкаптион**
  
> Указатель на текст, который будет использоваться в качестве заголовка для диалогового окна "общий адрес".
    
**лпсзневентрититле**
  
> Указатель на текст, который будет использоваться в качестве подписи кнопки, которая вызывает диалоговое окно " **создать запись** " или другое диалоговое окно. 
    
**лпсздествеллститле**
  
> Указатель на текст, который будет использоваться в качестве заголовка для элементов управления текстовым полем получателя, которые могут отображаться в модальной версии диалогового окна Общий адрес. Этот элемент не используется для немодальных диалоговых окон. 
    
**кдестфиелдс**
  
> Количество элементов управления текстовым полем "получатель" в модальной версии диалогового окна "адрес" или ноль, если диалоговое окно является немодальным. Диалоговое окно адрес открыто только для просмотра при соблюдении следующих условий: 
    
  - Для члена **кдестфиелдс** задано значение 0. 
    
  - Установлен флаг DIALOG_BOX.
    
  - Флаг ADDRESS_ONE не установлен.
    
  Если для параметра **кдестфиелдс** задано значение 0XFFFFFFFF, MAPI должен создать количество элементов управления текстовым полем получателя по умолчанию. В этом случае члены **лппсздесттитлес** и **лпулдесткомпс** должны иметь значение null. 
    
**ндестфиелдфокус**
  
> Указывает конкретное текстовое поле, которое должно иметь начальный фокус при появлении модальной версии диалогового окна. Это значение должно находиться в диапазоне от 0 до значения **кдестфиелдс** минус 1. 
    
**лппсздесттитлес**
  
> Указатель на массив меток для кнопок, связанных с каждым из элементов управления текстовым полем, которые отображаются в модальной версии диалогового окна "адрес". Значение элемента **кдестфиелдс** указывает количество меток, включенных в массив. Если элемент **лппсздесттитлес** имеет значение null, метод **Address** использует названия по умолчанию. 
    
**лпулдесткомпс**
  
> Указатель на массив значений типа получателя, например MAPI_TO, MAPI_CC и MAPI_BCC, связанный с каждым элементом управления "текстовое поле". Значение элемента **кдестфиелдс** указывает количество типов получателей, включенных в массив. Значения, указываемые в **лпулдесткомпс** , можно использовать для установки свойства **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md)) каждого получателя. Если элемент **лпулдесткомпс** имеет значение null, метод **Address** использует типы получателей по умолчанию. 
    
**лпконтрестриктион**
  
> Указатель на структуру [срестриктион](srestriction.md) , которая ограничит тип записей адресов, которые могут отображаться в диалоговом окне. 
    
**лфиеррестриктион**
  
> Указатель на структуру **срестриктион** , ограничивающую контейнеры адресных книг, которые могут предоставлять записи адресов для отображения в диалоговом окне. 
    
## <a name="remarks"></a>Примечания

Структуры **адрпарм** используются клиентами и поставщиками услуг для управления внешним видом и поведением диалоговых окон общего адреса MAPI. Диалоговое окно "адрес" состоит из двух вариантов: немодальных и модальных. Некоторые элементы структуры **адрпарм** применяются к обеим версиям диалогового окна, но некоторые из них применимы только к одной из двух версий. В приведенной ниже таблице члены структуры **адрпарм** связаны с их использованием в диалоговых окнах общего адреса. 
  
|Элемент АДРПАРМ|Диалоговое окно "тип"|
|:-----|:-----|
|**кбабконтентрид** и **лпабконтентрид** <br/> |Модальные и немодальные  <br/> |
|**ulFlags** <br/> |Модальные и немодальные  <br/> |
|**лпресервед** <br/> |Модальные и немодальные  <br/> |
|**улхелпконтекст** и **лпсзелпфиленаме** <br/> |Модальные и немодальные  <br/> |
|**лпфнабсди** <br/> |Открыто  <br/> |
|**лпфндисмисс** и **лпвдисмиссконтекст** <br/> |Открыто  <br/> |
|**лпсзкаптион** <br/> |Модальные и немодальные  <br/> |
|**лпсзневентрититле** <br/> |Модальный  <br/> |
|**лпсздествеллститле**, **кдестфиелдс**, **ндестфиелдфокус**, **лппсздесттитлес**и **лпулдесткомпс** <br/> |Модальный  <br/> |
|**лпконтрестриктион** <br/> |Модальные и немодальные  <br/> |
|**лфиеррестриктион** <br/> |Модальные и немодальные  <br/> |
   
Немодальное диалоговое окно — это доступное только для чтения отображение записей из одного или нескольких контейнеров адресных книг. В диалоговом окне могут отображаться все записи из выбранных контейнеров или только те записи и контейнеры, которые соответствуют условиям, установленным ограничением. Ограничение содержимого, на которое указывает **лпконтрестриктион** , может ограничить типы отображаемых записей, а ограничение иерархии, на которое указывает **лфиеррестриктион** , может ограничить контейнеры, предоставляющие записи. Чтобы сообщить вызывающему объекту о закрытии диалогового окна, MAPI вызывает функцию, которая предоставляется вызывающей стороной, которая соответствует прототипу [дисмиссмоделесс](dismissmodeless.md) . Другая функция, которая соответствует прототипу [акцелератеабсди](accelerateabsdi.md) , обеспечивается MAPI и вызывается вызывающим абонентом в цикле обработки сообщений Windows для упрощения работы с сочетаниями клавиш. Немодальная версия диалогового окна "адрес MAPI" может отображаться, когда клиенты вызывают [IAddrBook:: Address](iaddrbook-address.md) или когда поставщики услуг вызывают [Имаписуппорт:: Address](imapisupport-address.md). 
  
Модальное диалоговое окно — это отображение записей для чтения и записи из одного или нескольких контейнеров. Его содержимое может быть затронут аналогично немодальной версии с помощью ограничений, заданные в членах **лпконтрестриктион** и **лфиеррестриктион** . В дополнение к списку, отображающему записи контейнера, модальное диалоговое окно может содержать от одного до трех элементов управления текстовым полем для хранения записей, выбранных пользователем. Каждый элемент управления редактированием связан с определенным типом получателя или свойством **PR_RECIPIENT_TYPE** , например MAPI_TO. Диалоговое окно модального адреса может отображаться одним из методов **адреса** или при вызове клиентами [IAddrBook::D етаилс](iaddrbook-details.md) и поставщики услуг вызывают [имаписуппорт::D етаилс](imapisupport-details.md). 
  
Эта иллюстрация включает два элемента управления "текстовое поле", так как элемент **кдестфиелдс** структуры **адрпарм** , управляющий отображением этого диалогового окна, имеет значение 2. Первый элемент управления изначально имеет фокус, так как для элемента **ндестфиелдфокус** задано значение 0. 
  
Элемент **лпсзневентрититле** указывает на текст для подписи кнопки, при выборе которой отображается дополнительное диалоговое окно. Как правило, как показано на рисунке модального диалогового окна, кнопка называется **New (создать** ), а в появившемся диалоговом окне — Список всех типов адресов, которые могут создаваться любыми поставщиками адресных книг в профиле. Клиенты вызывают отображение **этого** диалогового окна при вызове метода [IAddrBook:: невентри](iaddrbook-newentry.md) и передает ноль для параметра _кбеидневентритпл_ и значение NULL для параметра _лпеидневентритпл_ , когда пользователь нажимает кнопку. Сведения, содержащиеся в этом диалоговом окне, берутся из таблицы одноразовых MAPI. 
  
Каждая запись в этом диалоговом окне связана с шаблоном для ввода данных, необходимых для создания адреса определенного типа. Большинство поставщиков адресных книг предоставляют один шаблон для каждого типа записи адресов, который они могут создать. Когда пользователь делает выбор из этого диалогового окна, MAPI отображает соответствующий шаблон.
  
Старшие четыре бита элемента **ulFlags** структуры **адрпарм** содержат номер версии, определяющий версию структуры **адрпарм** . Текущая версия: 0 (ноль) или ADRPARM_HELP_CTX. Текущая реализация MAPI не будет работать для любой версии структуры, отличной от нуля. 
  
Будущие версии структуры могут быть совершенно другими; они могут не поддерживать структуру нулевой версии. Следующие макросы предоставляются для извлечения номера версии из члена **ulFlags** и для его объединения с определенными флагами: 
  
- **GET_ADRPARM_VERSION** (_ulFlags_) 
- **SET_ADRPARM_VERSION** (_UlFlags_, _ улверсион _) 
- **ADRPARM_HELP_CTX**
  
## <a name="see-also"></a>См. также

- [ACCELERATEABSDI](accelerateabsdi.md)
- [DISMISSMODELESS](dismissmodeless.md)
- [IAddrBook::Address](iaddrbook-address.md)
- [IMAPISupport::Address](imapisupport-address.md)
- [SRestriction](srestriction.md)
- [Структуры MAPI](mapi-structures.md)


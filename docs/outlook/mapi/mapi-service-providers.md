---
title: Поставщиков служб MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6511e1b5-697e-4ed1-80af-aa8ca56fd045
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 3f1cab24ef6bbd632ee3dc204e93f59e6f9ac846
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809843"
---
# <a name="mapi-service-providers"></a>Поставщиков служб MAPI

  
  
**Относится к**: Outlook 
  
Существует три общие типы поставщиков услуг.
  
- Адресной книги поставщиков.
    
- Поставщики хранилища сообщений.
    
- Поставщиками транспорта.
    
Поставщиков хранилища адресной книги и сообщение имеет много общего. Они зарегистрируйте уникальный идентификатор MAPI, используемых для создания идентификаторы записей для объектов. Они предоставляют иерархия объектов и свойств, которые клиенты могут получить доступ к и работа с элементами управления. Для объектов контейнера они поддерживают иерархии таблица и таблица содержимое. Они поддерживают уведомления о событии на эти таблицы и при необходимости для отдельных объектов, чтобы клиенты могут получать сведения об изменениях, произошедшие во время сеанса. При длительных операций, которые могут быть отображены индикатор выполнения для оповещения пользователя о состоянии операции. Клиенты могут взаимодействовать с поставщиками хранилища адресной книги и сообщения либо косвенно через MAPI с помощью [IAddrBook: IMAPIProp](iaddrbookimapiprop.md) и [IMAPISession: IUnknown](imapisessioniunknown.md) интерфейсы или непосредственно с помощью одного из интерфейсов поставщика службы в в следующей таблице. 
  
|**Адресной книги поставщика интерфейсов**|**Интерфейсы поставщика хранилища сообщений**|
|:-----|:-----|
|[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md) <br/> |[IMsgStore: IMAPIProp](imsgstoreimapiprop.md) <br/> |
|[IDistList : IMAPIContainer](idistlistimapicontainer.md) <br/> |[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) <br/> |
|[IMailUser : IMAPIProp](imailuserimapiprop.md) <br/> |[IMessage: IMAPIProp](imessageimapiprop.md) <br/> |
| <br/> |[IAttach : IMAPIProp](iattachimapiprop.md) <br/> |
   
Поставщики транспорта отличаются от адресной книги и сообщения поставщиков хранилища, как они обмениваться данными MAPI и с клиентами. Поставщики транспорта обычно дождитесь MAPI запрашивать сведения, а не связь. В отличие от других поставщиков поставщиками транспорта не поддерживают различные объекты и таблиц, используемых клиентами. Тем не менее они поддерживают состояние объекта, как сделать всех поставщиков услуг и опубликовать его свойства в таблице состояния. В то время как поставщиков хранилища адресной книги и сообщения вызвать метод [IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md) для регистрации уникальных идентификаторов для создания их идентификаторы записей, поставщиками транспорта вызовите метод [IXPLogon::AddressTypes](ixplogon-addresstypes.md) для Регистрация уникальных идентификаторов, а также типы адресов для о доставки определенного сообщения. 
  
Поставщик услуг должен иметь три файлы заголовков: один файл общедоступных заголовка и два внутренних файлов. Используйте файл общедоступных заголовка для конфигурации и документирования свойства и их значения. Включить в один из файлов внутреннего заголовка всех необходимых общедоступных MAPI заголовков; файл заголовка должно быть включено во всех исходных файлов поставщика службы. Использование внутренних файлов для определения кодов ресурса.
  
Адресная книга, хранилища сообщений и поставщиками транспорта выполнить следующие задачи:
  
- Передать функцию точки входа. 
    
- Укажите поставщика и вход в систему для обработки входа в систему и инициализации. 
    
- Если принадлежит поставщик службы сообщений укажите функцию точки входа службы сообщений. 
    
- Поддержка настройки при помощи свойств.
    
- Состояние объекта и обеспечивающие ее использование в таблице состояния. 
    
- Дескриптор, завершение работы.
    
## <a name="see-also"></a>См. также



[Понятия MAPI](mapi-concepts.md)


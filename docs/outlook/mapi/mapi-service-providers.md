---
title: Поставщики службы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6511e1b5-697e-4ed1-80af-aa8ca56fd045
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: bb40891376ac511869ba157b675e53ee236b24ca
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32346678"
---
# <a name="mapi-service-providers"></a>Поставщики службы MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Существует три стандартных типа поставщиков услуг:
  
- Поставщики адресных книг.
    
- Поставщики хранилища сообщений.
    
- Поставщики транспорта.
    
У поставщиков адресных книг и хранилищ сообщений есть много сходства. Они регистрируют уникальный идентификатор с помощью MAPI, который используется для создания идентификаторов записей для своих объектов. Они предоставляют иерархию объектов и свойств, которые клиенты могут использовать для доступа и управления. Для объектов контейнера они поддерживают таблицу иерархий и таблицу содержимого. Они поддерживают уведомления о событиях в этих таблицах и при необходимости на отдельных объектах, чтобы клиенты могли получать уведомления об изменениях, происходящих во время сеанса. Когда операции становятся длительными, они могут отображать индикатор хода выполнения для информирования пользователя о состоянии операции. Клиенты могут общаться с адресными книгами и поставщиками хранилищ сообщений косвенно через MAPI с помощью интерфейсов [IAddrBook: IMAPIProp](iaddrbookimapiprop.md) и [IMAPISession: IUnknown](imapisessioniunknown.md) или напрямую с помощью одного из интерфейсов поставщика услуг в следующей таблице. 
  
|**Интерфейсы поставщика адресных книг**|**Интерфейсы поставщика хранилища сообщений**|
|:-----|:-----|
|[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md) <br/> |[IMsgStore: IMAPIProp](imsgstoreimapiprop.md) <br/> |
|[IDistList : IMAPIContainer](idistlistimapicontainer.md) <br/> |[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) <br/> |
|[IMailUser : IMAPIProp](imailuserimapiprop.md) <br/> |[IMessage: IMAPIProp](imessageimapiprop.md) <br/> |
| <br/> |[IAttach : IMAPIProp](iattachimapiprop.md) <br/> |
   
Поставщики транспорта отличаются от поставщиков адресных книг и хранилищ сообщений тем, как они взаимодействуют с MAPI и с клиентами. Как правило, поставщики транспорта ожидают, что для получения информации необходимо запросить их, а не инициировать обмен данными. В отличие от других поставщиков, поставщики транспорта не поддерживают множество объектов и таблиц, к которым часто обращаются клиенты. Тем не менее, они поддерживают объект status, как все поставщики служб, и публикуют свои свойства в таблице Status. В то время как адресная книга и поставщики хранилищ сообщений вызывают метод [имаписуппорт:: сетпровидеруид](imapisupport-setprovideruid.md) для регистрации уникальных идентификаторов для создания своих идентификаторов записей, поставщики транспорта вызывают метод [Иксплогон:: аддресстипес](ixplogon-addresstypes.md) для Зарегистрируйте уникальные идентификаторы, а также типы адресов для предполагаемой ответственности за доставку определенных сообщений. 
  
У поставщика услуг должен быть три файла заголовков: один общедоступный файл заголовка и два внутренних файла. Используйте общедоступный файл заголовков для настройки свойств документов и их значений. Включите в один из внутренних заголовочных файлов всех необходимых общедоступных заголовков MAPI; Этот заголовочный файл должен быть включен во все исходные файлы поставщика услуг. Используйте другой внутренний файл для определения идентификаторов ресурсов.
  
Адресная книга, хранилище сообщений и поставщики транспорта выполняют следующие задачи:
  
- Предоставьте функцию точки входа. 
    
- Предоставьте поставщик и объект входа для обработки входа и инициализации. 
    
- Если поставщик принадлежит службе сообщений, предоставьте функцию точки входа в службу сообщений. 
    
- Поддержка конфигурации путем реализации страницы свойств.
    
- Реализация объекта status и поддержка таблицы состояния. 
    
- Завершение работы дескриптора.
    
## <a name="see-also"></a>См. также



[Понятия MAPI](mapi-concepts.md)


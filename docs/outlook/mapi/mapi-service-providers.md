---
title: Поставщики услуг MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6511e1b5-697e-4ed1-80af-aa8ca56fd045
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: bb40891376ac511869ba157b675e53ee236b24ca
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409540"
---
# <a name="mapi-service-providers"></a>Поставщики услуг MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Существует три распространенных типа поставщиков услуг:
  
- Поставщики адресных книг.
    
- Поставщики store сообщений.
    
- Поставщики транспорта.
    
Поставщики адресной книги и магазина сообщений имеют множество сходств. Они регистрируют уникальный идентификатор с помощью MAPI, который они используют для создания идентификаторов записей для своих объектов. Они предоставляют иерархию объектов и свойств, к которые клиенты могут получать доступ и управлять ими. Для своих объектов-контейнеров они поддерживают таблицу иерархии и таблицу содержимого. Они поддерживают уведомления о событиях в этих таблицах и при желании на отдельных объектах, чтобы клиенты могли получать уведомления об изменениях, происходящих во время сеанса. Когда операции становятся длительными, они могут отображать индикатор хода выполнения, чтобы сообщить пользователю о состоянии операции. Клиенты могут взаимодействовать с поставщиками адресной книги и магазина сообщений либо косвенно через MAPI, используя [IAddrBook : IMAPIProp](iaddrbookimapiprop.md) и [IMAPISession : интерфейсы IUnknown](imapisessioniunknown.md) или напрямую с помощью одного из интерфейсов поставщика услуг, который приводится в следующей таблице. 
  
|**Интерфейсы поставщиков адресных книг**|**Интерфейсы поставщиков store сообщений**|
|:-----|:-----|
|[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md) <br/> |[IMsgStore: IMAPIProp](imsgstoreimapiprop.md) <br/> |
|[IDistList : IMAPIContainer](idistlistimapicontainer.md) <br/> |[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md) <br/> |
|[IMailUser : IMAPIProp](imailuserimapiprop.md) <br/> |[IMessage: IMAPIProp](imessageimapiprop.md) <br/> |
| <br/> |[IAttach : IMAPIProp](iattachimapiprop.md) <br/> |
   
Поставщики транспорта отличаются от поставщиков адресной книги и хранения сообщений способом взаимодействия с MAPI и клиентами. Поставщики транспорта обычно ждут, пока MAPI запросит у них информацию, а не инициируют связь. В отличие от других поставщиков, поставщики транспорта не поддерживают различные объекты и таблицы, к которые часто имеют доступ клиенты. Однако они поддерживают объект состояния, как и все поставщики услуг, и публикуют его свойства в таблице состояния. В то время как поставщики адресной книги и хранения сообщений вызывают метод [IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md) для регистрации уникальных идентификаторов для создания идентификаторов записей, поставщики транспорта звонят [методу IXPLogon::AddressTypes](ixplogon-addresstypes.md) для регистрации уникальных идентификаторов, а также типов адресов для оказания ответственности за доставку определенных сообщений. 
  
Поставщик услуг должен иметь три файла заголовок: один файл общедоступных и два внутренних. Используйте файл открытого загона для настройки, а также для документации свойств и их значений. Включить в один из внутренних файлов заголовок все необходимые общедоступные заголовки MAPI; Этот файл заголовок должен быть включен во все исходные файлы поставщика услуг. Используйте другой внутренний файл для определения идентификаторов ресурсов.
  
Адресная книга, хранилище сообщений и поставщики транспорта выполняют следующие задачи:
  
- Указать функцию точки входа. 
    
- Предоставить поставщик и объект для логотипа для обработки инициализации и инициализации. 
    
- Если поставщик принадлежит к службе сообщений, указать функцию точки входа службы сообщений. 
    
- Поддержка конфигурации путем реализации таблицы свойств.
    
- Реализация объекта состояния и поддержка таблицы состояния. 
    
- Обработка отключения.
    
## <a name="see-also"></a>См. также



[Понятия MAPI](mapi-concepts.md)


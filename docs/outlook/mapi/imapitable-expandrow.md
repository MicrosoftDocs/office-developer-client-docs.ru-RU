---
title: Имапитабликспандров
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.ExpandRow
api_type:
- COM
ms.assetid: b96dd8f6-e648-4014-8a1d-ae1da771c439
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5e2ce756baaefef7bd0028e746b1dbe10756365e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329045"
---
# <a name="imapitableexpandrow"></a>IMAPITable::ExpandRow

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Расширяет категорию свернутой таблицы, добавляя конечные или нижние строки заголовков, принадлежащих к категории, в представление таблицы.
  
```cpp
HRESULT ExpandRow(
ULONG cbInstanceKey,
LPBYTE pbInstanceKey,
ULONG ulRowCount,
ULONG ulFlags,
LPSRowSet FAR * lppRows,
ULONG FAR * lpulMoreRows
);
```

## <a name="parameters"></a>Параметры

 _Кбинстанцекэй_
  
> возврата Количество байтов в свойстве ПР_ИНСТАНЦЕ_КЭЙ, на которое указывает параметр _пбинстанцекэй_ . 
    
 _Пбинстанцекэй_
  
> возврата Указатель на свойство **пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md)), которое определяет строку заголовка для категории. 
    
 _Улровкаунт_
  
> возврата Максимальное число строк, возвращаемых в параметре _лппровс_ . 
    
 _ulFlags_
  
> Резервирования должно быть равно нулю.
    
 _Лппровс_
  
> вышли Указатель на структуру [SRowSet](srowset.md) , получающую первые (вплоть до _улровкаунт_) строк, которые были вставлены в представление таблицы в результате расширения. Эти строки вставляются после строки заголовков, определяемой параметром _пбинстанцекэй_ . Параметр _лппровс_ может иметь значение null, если параметр _улровкаунт_ равен нулю. 
    
 _Лпулмореровс_
  
> вышли Указатель на общее число строк, добавленных в представление таблицы.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Категория успешно развернута.
    
МАПИ_Е_НОТ_ФАУНД 
  
> Строка, указанная с помощью параметра _пбинстанцекэй_ , не существует. 
    
## <a name="remarks"></a>Комментарии

Метод **IMAPITable:: експандров** расширяет категорию свернутой таблицы, добавляя конечные или нижние строки заголовков, принадлежащие к категории, в представление таблицы. В параметре _улровкаунт_ можно указать только число строк, возвращаемых в параметре _лппровс_ . Если для _улровкаунт_ задано значение больше нуля и одна или несколько строк возвращаются в наборе строк, на который указывает _лппровс_, то положение закладки букмарк_куррент перемещается в строку сразу после последней строки в наборе строк.
  
Если для параметра _улровкаунт_ задано значение 0, то в категорию добавляются строки заголовков из нуля или нижние уровни, а также возвращаются нулевые строки, так как в категории отсутствуют строки заголовков конечных или нижних уровней, для положения букмарк_куррент задано значение строка После строки, указанной в параметре _пбинстанцекэй_. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Не создавайте уведомления для строк, которые добавляются в табличное представление из-за расширения категории.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Количество строк в наборе строк, на которое указывает параметр _лппровс_ , может не равняться количеству строк, которые были в действительности добавлены в таблицу, а также ко всему набору заголовков конечных или нижних уровней для категории. Могут возникать ошибки, например недостаток памяти или количество строк в категории, превышающее число, указанное в параметре _улровкаунт_ . В обоих случаях БУКМАРК_КУРРЕНТ будет размещен в последней возвращенной строке. Чтобы немедленно извлечь остальные строки в категории, вызовите команду [IMAPITable:: QueryRows](imapitable-queryrows.md).
  
Не ожидать получения табличного уведомления при изменении состояния категории. Вы можете поддерживать локальный кэш строк, которые можно обновлять при каждом вызове **експандров** или **коллапсеров** . 
  
Для получения дополнительных сведений об классифицированных таблицах, ознакомьтесь со статьей [Сортировка и категоризация](sorting-and-categorization.md).
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Контентстаблелистктрл. cpp  <br/> |Кконтентстаблелистктрл::D Оекспандколлапсе  <br/> |MFCMAPI использует метод **IMAPITable:: експандров** , чтобы развернуть категорию свернутой таблицы.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CollapseRow](imapitable-collapserow.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


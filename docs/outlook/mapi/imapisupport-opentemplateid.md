---
title: имаписуппортопентемплатеид
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.OpenTemplateID
api_type:
- COM
ms.assetid: 532f7af0-b2cc-49dd-b1de-e3ec1dc9a3e7
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 07aa508b473f4a87d5b4909f83771549c301a600
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418507"
---
# <a name="imapisupportopentemplateid"></a>IMAPISupport::OpenTemplateID

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Открывает запись получателя в поставщике внешней адресной книги.
  
```cpp
HRESULT OpenTemplateID(
ULONG cbTemplateID,
LPENTRYID lpTemplateID,
ULONG ulTemplateFlags,
LPMAPIPROP lpMAPIPropData,
LPCIID lpInterface,
LPMAPIPROP FAR * lppMAPIPropNew,
LPMAPIPROP lpMAPIPropSibling
);
```

## <a name="parameters"></a>Параметры

 _кбтемплатеид_
  
> возврата Количество байтов в идентификаторе шаблона, на который указывает _лптемплатеид_. 
    
 _лптемплатеид_
  
> возврата Указатель на свойство идентификатора шаблона **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) записи получателя, которое нужно открыть.
    
 _ултемплатефлагс_
  
> возврата Битовая маска флагов, используемых для описания способа открытия записи. Можно задать следующий флаг:
    
FILL_ENTRY 
  
> Создается новая запись. Когда внешний поставщик получает последующий вызов [иаблогон:: опентемплатеид](iablogon-opentemplateid.md) из MAPI, он может управлять способом создания записи, изменяя свойства, на которые указывает параметр _лпмапипропдата_ , или возвращая определенную реализацию интерфейса в _лппмапипропнев_ для управления заданными свойствами новой записи. 
    
 _лпмапипропдата_
  
> возврата Указатель на реализацию интерфейса, который абонент использует для доступа к записи. Это реализация, которую внешний поставщик может переносить в собственную реализацию и возвращать параметр _лппмапипропнев_ . Параметр _лпмапипропдата_ должен указать на реализацию интерфейса чтения и записи, производную от [IMAPIProp: IUnknown](imapipropiunknown.md) и поддерживающая интерфейс, запрашиваемый в параметре _лпинтерфаце_ . 
    
 _лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к записи. Параметр _лппмапипропнев_ указывает на интерфейс типа, указанного с помощью _лпинтерфаце_. При передаче значения NULL возвращается стандартный интерфейс для пользователя обмена сообщениями, IID_IMailUser. 
    
 _лппмапипропнев_
  
> вышли Указатель на реализацию интерфейса, предоставленный внешним поставщиком для доступа к записи.
    
 _лпмапипропсиблинг_
  
> Резервирования должно иметь значение NULL.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Процесс привязки выполнен успешно.
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Поставщик внешней адресной книги не существует.
    
## <a name="remarks"></a>Примечания

Метод **имаписуппорт:: опентемплатеид** реализован только для объектов поддержки поставщика адресных книг. **Опентемплатеид** вызывается только поставщиками адресных книг, которые могут выполнять роль ведущих элементов для записей, принадлежащих другим поставщикам адресных книг, также называемым внешними поставщиками. Поставщики узла вызывают **опентемплатеид** , чтобы открыть внешнюю запись, которая происходит, когда данные в поставщике узла привязаны к коду в внешнем поставщике. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вызовите **опентемплатеид** только в том случае, если вы поддерживаете хранение записей с идентификаторами шаблонов от поставщиков внешних адресных книг. Такая поддержка размещает дополнительные требования к реализациям [иабконтаинер:: креатинтри](iabcontainer-createentry.md) и [Иаблогон:: OpenEntry](iablogon-openentry.md) . Дополнительные сведения см. в описании этих способов и [действуют как поставщик адресной книги узла](acting-as-a-host-address-book-provider.md).
  
Если вызов **опентемплатеид** возвращает в качестве связанного интерфейса ту же реализацию объекта Property, что вы передали, вы можете освободить ссылку на объект Property. Это связано с тем, что внешний поставщик вызвал метод **AddRef** объекта для хранения собственной ссылки. Если внешнему поставщику не требуется хранить ссылку на объект Property, то **опентемплатеид** возвратит непривязанный объект Property. 
  
Если **опентемплатеид** не работает с MAPI_E_UNKNOWN_ENTRYID, попробуйте продолжить, рассматривая запись как доступную только для чтения. 
  
## <a name="see-also"></a>См. также



[IABLogon::OpenTemplateID](iablogon-opentemplateid.md)
  
[IPropData : IMAPIProp](ipropdataimapiprop.md)
  
[Каноническое свойство PidTagTemplateid](pidtagtemplateid-canonical-property.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


---
title: Добавление или удаление поставщиков в службе сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 44bb4d34-ca96-4d5a-93fe-85e09bd7971d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ed5ea8bdfcbdaaa6b6abd81a39f0e8df50d3b314
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433425"
---
# <a name="adding-or-deleting-providers-in-a-message-service"></a>Добавление или удаление поставщиков в службе сообщений

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Чтобы добавить или удалить поставщиков служб в службе сообщений, используйте интерфейс [ипровидерадмин: IUnknown](iprovideradminiunknown.md) . Вы можете получить указатель **ипровидерадмин** , вызвав [Имсгсервицеадмин:: админпровидерс](imsgserviceadmin-adminproviders.md). Таблица поставщика, доступная с помощью [ипровидерадмин:: жетпровидертабле](iprovideradmin-getprovidertable.md), содержит сведения о поставщиках услуг, установленных в службе сообщений в данный момент. Клиенты и поставщики услуг могут использовать таблицу поставщика для доступа к имени DLL поставщика, например, **мапиуид**, отображаемое имя и тип поставщика, а также сведения о службе сообщений. Дополнительные сведения см. в [таблице поставщиков](provider-tables.md).
  
 **Добавление или удаление поставщика услуг в службе сообщений**
  
1. ВыЗовите метод **админсервицес** , чтобы получить доступ к объекту администрирования службы сообщений. 
    
2. Call [имсгсервицеадмин:: жетмсгсервицетабле](imsgserviceadmin-getmsgservicetable.md) для доступа к таблице службы сообщений. 
    
3. Создание ограничения свойства с помощью структуры [спропертирестриктион](spropertyrestriction.md) , соответствующей **пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) или **пр_сервице_наме** ([PidTagServiceName](pidtagservicename-canonical-property.md)), с именем службы сообщений, которая должна быть изменения. 
    
4. ВыЗовите метод [IMAPITable:: FindRow](imapitable-findrow.md) таблицы служба сообщений, чтобы определить расположение строки в таблице, представляющей целевую службу сообщений. 
    
5. Call [имсгсервицеадмин:: админпровидерс](imsgserviceadmin-adminproviders.md) для получения указателя **ипровидерадмин** . Передайте столбец **пр_сервице_уид** ([PidTagServiceUid](pidtagserviceuid-canonical-property.md)) из строки таблицы службы сообщений в качестве параметра _лпуид_ . 
    
6. Call [ипровидерадмин:: жетпровидертабле](iprovideradmin-getprovidertable.md) для доступа к таблице поставщика. 
    
7. Создание ограничения свойства с помощью структуры Спропертирестриктион, которая соответствует **пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) или **пр_провидер_дисплай** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)) с именем поставщика услуг, который должен быть добавлен или удален. 
    
8. ВыЗовите таблицу поставщика метод [IMAPITable:: FindRow](imapitable-findrow.md) для обнаружения строки в таблице, представляющей целевого поставщика услуг. 
    
9. Call [ипровидерадмин:: креатепровидер](iprovideradmin-createprovider.md) для добавления поставщика или [Ипровидерадмин::D елетепровидер](iprovideradmin-deleteprovider.md) , чтобы удалить его из службы сообщений. Для **креатепровидер**передайте свойство **пр_дисплай_наме** поставщика в качестве параметра _лпсзпровидер_ . Для любого метода необходимо передать свойство **пр_сервице_уид** поставщика в качестве параметра _лпуид_ . После добавления или удаления поставщика услуг изменения не будут очевидны до создания нового сеанса. 
    
Другой способ добавления поставщика услуг, а именно поставщика хранилища сообщений, в профиль включает создание идентификатора записи для поставщика. Так как создание идентификатора записи требует знания его формата, этот метод можно использовать только в том случае, если поставщик услуг создал свой формат идентификатора записи public. 
  
С помощью созданного идентификатора записи клиент может вызвать [IMAPISession:: опенмсгсторе](imapisession-openmsgstore.md). MAPI автоматически создает в профиле для поставщика услуг раздел профиля, но не добавляет его в службу сообщений. 
  
Некоторые службы сообщений не разрешают этот тип динамического изменения; независимо от того, поддерживается ли он службой сообщений. Еще одна функция, которая может и не поддерживаться, является возможностью прямого доступа к разделам частного профиля службы сообщений. Если используемая служба сообщений разрешает такой доступ, она публикует **GUID** , представляющий частный раздел в Mapisvc. INF. Этот **идентификатор GUID** можно передать в вызове [Ипровидерадмин:: опенпрофилесектион](iprovideradmin-openprofilesection.md) для доступа к разделу профиля. 
  


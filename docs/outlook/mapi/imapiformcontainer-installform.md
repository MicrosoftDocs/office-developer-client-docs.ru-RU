---
title: Имапиформконтаинеринсталлформ
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFormContainer.InstallForm
api_type:
- COM
ms.assetid: b39ca52c-4dbe-41c0-9e1b-3998a9dc9742
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a0650033e4fea79046eac5757e3d0deb963c38e6
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32351648"
---
# <a name="imapiformcontainerinstallform"></a>IMAPIFormContainer::InstallForm

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Устанавливает форму в библиотеку форм.
  
```cpp
HRESULT InstallForm(
  ULONG_PTR ulUIParam,
  ULONG ulFlags,
  LPCSTR szCfgPathName
);
```

## <a name="parameters"></a>Параметры

 _Улуипарам_
  
> возврата Дескриптор родительского окна всех диалоговых окон и окон, отображаемых данным методом. Параметр _улуипарам_ игнорируется, если клиентское приложение не устанавливает флаг мапи_диалог в параметре _ulFlags_ . Параметр _улуипарам_ может иметь значение null, если мапи_диалог также не передан. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, управляющих установкой формы. Можно задать следующие флаги:
    
МАПИ_ДИАЛОГ 
  
> Отображает диалоговое окно для получения сведений о ходе выполнения или приглашения пользователя на дополнительные сведения. Если этот флаг не установлен, диалоговое окно не отображается.
    
MAPI_UNICODE 
  
> Переданные строки имеют формат Юникод. Если флаг МАПИ_УНИКОДЕ не установлен, строки представлены в формате ANSI.
    
МАПИФОРМ_ИНСТАЛЛ_ОВЕРВРИТЕОНКОНФЛИКТ 
  
> Если уже существует другая форма, которая обрабатывает класс сообщений, обрабатываемый этой формой, замените существующую форму на эту. Этот флаг игнорируется, если также присутствует флаг МАПИ_ДИАЛОГ. 
    
 _Сзкфгпаснаме_
  
> возврата Путь к файлу конфигурации формы.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������.
    
МАПИ_Е_ЕКСТЕНДЕД_ЕРРОР 
  
> Произошла ошибка реализации. Чтобы получить структуру [мапиеррор](mapierror.md) , связанную с ошибкой, вызовите метод [Имапиформконтаинер:: GetLastError](imapiformcontainer-getlasterror.md) . 
    
МАПИ_Е_УСЕР_КАНЦЕЛ 
  
> Пользователь отменил установку формы, обычно нажав кнопку **Отмена** в диалоговом окне. 
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Поставщики библиотеки форм должны заполнить структуру **мапиеррор** и вернуть мапи_е_екстендед_еррор, если выполняются какие – либо из следующих условий: 
  
- Файл конфигурации не найден.
    
- Файл конфигурации недоступен для чтения.
    
- Недопустимый файл конфигурации.
    
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Клиентские приложения вызывают метод **имапиформконтаинер:: инсталлформ** для установки формы в определенный контейнер форм. Параметр _сзкфгпаснаме_ должен содержать путь к файлу конфигурации формы (то есть, файл с расширением. cfg, который описывает форму и ее реализацию). Флаги в параметре _ulFlags_ определяют следующее: 
  
- Если установлен флаг МАПИ_ДИАЛОГ, отображается пользовательский интерфейс, который позволяет пользователю, устанавливающему форму, указать сведения об установке.
    
- Если установлен флаг МАПИФОРМ_ИНСТАЛЛ_ОВЕРВРИТЕОНКОНФЛИКТ, все предыдущие формы для того же класса сообщений заменяются на устанавливаемую форму. В противном случае установка формы объединяется с текущим описанием формы (если оно существует).
    
- Если задано значение МАПИ_ДИАЛОГ, МАПИФОРМ_ИНСТАЛЛ_ОВЕРВРИТЕОНКОНФЛИКТ игнорируется.
    
- Отсутствие МАПИФОРМ_ИНСТАЛЛ_ОВЕРВРИТЕОНКОНФЛИКТ в установленном флаге означает, что слияние будет выполнено. Все новые платформы в файле. cfg, которые в настоящее время не указаны в описании формы, будут установлены и никакие другие изменения не будут выполнены.
    
- Если установлен флаг МАПИ_УНИКОДЕ, путь к файлу конфигурации формы представляет собой строку в Юникоде. 
    
Клиенты должны вызывать [имапиформконтаинер:: GetLastError](imapiformcontainer-getlasterror.md) , если **инсталлформ** возвращает мапи_е_екстендед_еррор, и должны проверить возвращаемую структуру [мапиеррор](mapierror.md) , чтобы определить условие, вызвавшее ошибку. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Формконтаинердлг. cpp  <br/> |Кформконтаинердлг:: Онинсталлформ  <br/> |MFCMAPI использует метод **имапиформконтаинер:: инсталлформ** для установки формы в контейнере форм.  <br/> |
   
## <a name="see-also"></a>См. также



[MAPIERROR](mapierror.md)
  
[IMAPIFormContainer : IUnknown](imapiformcontaineriunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


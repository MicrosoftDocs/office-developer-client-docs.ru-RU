---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 96e81442125ae49e0c2856a1cf3a97a16d3453cf
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22583339"
---
# <a name="ixpprovidertransportlogon"></a>IXPProvider::TransportLogon

**Применимо к**: Outlook 2013 | Outlook 2016 
  
Устанавливает сеанс, в котором клиентское приложение входит в систему поставщика транспорта. 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a>Параметры

_lpMAPISup_: [входной параметр] указатель на объект поддержки поставщика транспорта для функции обратного вызова в рамках MAPI для данного сеанса. Этот объект действителен, пока не поставщика транспорта освобождает его.
    
_ulUIParam_: [дескриптор родительского окна все диалоговые окна или windows, этот метод отображает in]. Параметр _ulUIParam_ может отличаться от null, например, когда флаг LOGON_SETUP имеет значение с помощью параметра _lpulFlags_ . 
    
_lpszProfileName_: [входной параметр] указатель на имя профиля пользователя. Параметр _lpszProfileName_ в основном используется, когда необходимо появится диалоговое окно. 
    
_lpulFlags_: [в, out] битовую маску флагов, который определяет, каким образом устанавливаются сеанса входа в систему. Можно задать следующие флаги ввода диспетчером очереди MAPI:
    
  - LOGON_NO_CONNECT: Учетная запись пользователя является вход в систему для данного поставщика транспорта для целей, отличных от передачи и приема сообщений. Поставщика транспорта не следует пытаться подключаться к другие системы обмена сообщениями.
        
  - LOGON_NO_DIALOG: Диалоговое окно не должно отображаться даже в том случае, если в настоящее время сохраненные учетные данные пользователя: недопустимый или недостаточно для входа в систему.
        
  - LOGON_NO_INBOUND: Поставщика транспорта не требуется инициализировать для приема сообщений и не должен принимать входящие сообщения. Диспетчер очереди MAPI можно использовать метод [IXPLogon::TransportNotify](ixplogon-transportnotify.md) более поздней версии для обозначения поставщика транспорта для включения обработки входящего сообщения. 
        
  - LOGON_NO_OUTBOUND: Поставщика транспорта не нужно инициализировать для отправки сообщений, как диспетчер очереди MAPI не выполняет какие-либо. Если клиентское приложение требуется подключение к удаленной поставщика во время составления сообщения, чтобы его можно выполнять вызовы метода [IXPLogon::AddressTypes](ixplogon-addresstypes.md) , поставщика транспорта следует создать подключение. Диспетчер очереди MAPI можно использовать **TransportNotify** для поставщика транспорта оповещения о том, можно приступить к исходящей операции. 
      
  - MAPI_UNICODE: Строка переданное для имени профиля — в формате Юникод. Если MAPI\_Юникод флаг не установлен, — это строка в формате ANSI.
      
    Можно задать следующие флаги выходные данные, поставщика транспорта:
      
  - LOGON_SP_IDLE: Запросы, что диспетчер очереди MAPI часто вызовите метод [IXPLogon::Idle](ixplogon-idle.md) поставщика транспорта для обработки времени простоя. 
      
  - LOGON_SP_POLL: Запросы, которые диспетчер очереди MAPI часто вызовите метод [IXPLogon::Poll](ixplogon-poll.md) на объекте возвращенные входа для проверки новых сообщений. Если этот флаг не установлен, диспетчер очереди MAPI проверяет наличие новых сообщений при поставщика транспорта использует метод [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) для уведомления очереди, что существуют новые сообщения для обработки. Поставщика транспорта эффективно становится доступным только для отправки, не задав этот флаг и, не запрашивая диспетчер очереди MAPI поступления сообщений. 
      
  - LOGON_SP_RESOLVE: Запросы, которые разрешают диспетчер очереди MAPI для полного адреса все адреса получателей сообщения не поддерживается поставщиком транспорта. Таким образом, что поставщик транспорта можно создать обратный путь для всех получателей.
      
  - MAPI_UNICODE: Возвращенных строк в структуре [MAPIERROR](mapierror.md) при их наличии, находятся в формате Юникод. Если флаг MAPI_UNICODE не установлен, они в формате ANSI. 
    
_lppMAPIError_: [out] указатель на указатель на структуру возвращенные **MAPIERROR** при их наличии, которая содержит версии, компонент и контекста сведения об ошибке. Параметр _lppMAPIError_ может быть присвоено значение NULL, если структура не **MAPIERROR** для возврата. 
    
_lppXPLogon_: [out] указатель на указатель на объект возвращенные транспорта поставщика входа в систему.
    
## <a name="return-value"></a>������������ ��������

Значение S_OK: Звонок успешно и вернул ожидаемым значением или значения.
    
MAPI_E_FAILONEPROVIDER: Этот поставщик не может войти, но эта ошибка не следует отключить службу. 
    
MAPI_E_UNCONFIGURED: Профиль не содержит достаточно сведений для входа в систему для завершения. MAPI вызывает функцию точки входа службы сообщений поставщика.
    
MAPI_E_UNKNOWN_CPID: Поставщик не поддерживает кодовая страница клиента.
    
MAPI_E_UNKNOWN_LCID: Поставщик не поддерживает сведения о языковом стандарте клиента.
    
MAPI_E_USER_CANCEL: Пользователь отменил операцию, как правило, нажмите кнопку **Отмена** в диалоговом окне. 
    
## <a name="remarks"></a>Замечания

Диспетчер очереди MAPI вызывает метод **IXPProvider::TransportLogon** сеанс входа в систему для пользователя. 
  
Большинство поставщиков транспорта, используется метод [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) , входящие в состав поддержки объект, указанный с помощью параметра _lpMAPISup_ для сохранения и извлечения сведений об удостоверениях, адреса сервера и учетные данные. С помощью **OpenProfileSection**, поставщика транспорта можно записать данные, произвольных и связать его с помощью учетной записи входа для определенного ресурса. Например поставщик можно использовать **OpenProfileSection** для сохранения имя учетной записи и пароль, связанный с определенным сеансом и любые имена серверов или другие необходимые сведения, необходимые для доступа к ресурсам для данного сеанса. MAPI скрывает сведения, связанные с ресурсами извне. В разделе профилей, доступные через _lpMAPISup_ управляется диспетчер очереди MAPI, данные, связанные с этой контекста пользователя, разделенных на основе данных для других контекстов. 
  
Поставщика транспорта необходимо вызвать метод **IUnknown::AddRef** на объекте поддержки и сохраните копию указатель мыши на этот объект в составе объекта поставщика входа в систему. 
  
Отображаемое имя профиля в _lpszProfileName_ предоставляется, поставщика транспорта можно использовать его в сообщения об ошибках или диалоговые окна входа в систему. Если поставщик сохраняет это имя, его нужно скопировать выделенный поставщиком хранилища. 
  
Поставщики транспорта, которые тесно связаны с другими поставщиками услуг может потребоваться выполнение дополнительных действий при входе в систему для установления хороший учетные данные, необходимые для операций между поставщиками компаньона.
  
Как правило поставщиками транспорта открываются при первом входе в систему в профиль. Так как первого входа в систему в профиль таким образом обычно поступает перед входом в систему для любого хранилища сообщений, диспетчер очереди MAPI обычно вызывает **TransportLogon** LOGON_NO_INBOUND и LOGON_NO_OUTBOUND набора флагов в _lpulFlags_. Более поздних версий когда хранилищ соответствующего сообщения доступны в сеансе профиля, диспетчер очереди MAPI вызывает **TransportNotify** для инициации входящих и исходящих операций для поставщика транспорта. 
  
Передача флаг LOGON_NO_CONNECT в сигналы _lpulFlags_ работу в автономном режиме поставщика транспорта. Этот флаг указывает, что необходимо осуществлять без внешних подключений; Если поставщик транспорта не удается установить сеанс без подключения к внешним данным, она возвращает код ошибки для входа в систему. 
  
Поставщика транспорта следует устанавливать флаг LOGON_SP_IDLE на _lpulFlags_ во время инициализации если он предназначен для использования время, затрачиваемое системы в противном случае бездействия. Такое время часто используется для обработки автоматического операций, таких как автоматическая загрузка, сообщения превышено время загрузки сообщений или превышено время отправки сообщения. Если установлен этот флаг, диспетчер очереди MAPI вызывает **Idle** при наступлении времени простоя системы для инициации таких операций. Диспетчер очереди MAPI не вызывает **Idle** через заданные промежутки времени; Вместо этого он вызывается только во время простоя значение true. Таким образом поставщики не должны работать на любые предположения об как часто вызывать их методы **Idle** . Поставщики, которые поддерживают операции время простоя следует указать пользовательский интерфейс настройки для него в свойств их поставщика. 
  
Если вход в систему поставщика транспорта успешно, поставщик должен возвращать с помощью параметра _lppXPLogon_ указатель объект входа в систему. Диспетчер очереди MAPI будет использовать этот объект для доступа к дополнительные поставщика. Если **TransportLogon** отображает диалоговое окно входа в систему и пользователь отменил входа в систему как правило, нажмите кнопку **Отмена** в диалоговом окне Поставщик должен возвращать MAPI_E_USER_CANCEL. 
  
Для большинства ошибок, возвращаемые **TransportLogon**MAPI отключает службы сообщений, к которым принадлежит поставщик. MAPI не будут вызывать поставщиков, которые принадлежат в службе rest сеанса MAPI. С другой стороны при **TransportLogon** возвращает значение ошибки MAPI_E_FAILONEPROVIDER из его входа в систему, MAPI не отключайте службы сообщений, к которой принадлежит поставщик. **TransportLogon** должен возвращать MAPI_E_FAILONEPROVIDER, если возникает ошибка, которая не гарантирует отключение службы в оставшейся части сеанса. 
  
Если поставщик возвращает MAPI_E_UNCONFIGURED из его входа в систему, MAPI вызовите функцию запись службы поставщика сообщение и повторите вход в систему. MAPI передает MSG_SERVICE_CONFIGURE в качестве контекста, чтобы дать возможность настройки службы. Если принято решение клиента разрешить пользовательского интерфейса при входе в систему, службу можно представить его настройки свойств, чтобы пользователь может ввести сведения о конфигурации. 
  
Если поставщик обнаруживает, что все, что не является необходимой информации в профиле, она возвращает MAPI_E_UNCONFIGURED, чтобы MAPI вызывает функцию точки входа службы сообщений поставщика. 
  
## <a name="see-also"></a>См. также

- [IXPProvider : IUnknown](ixpprovideriunknown.md)  
- [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md)  
- [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md)  
- [IXPLogon::AddressTypes](ixplogon-addresstypes.md)  
- [IXPLogon::Idle](ixplogon-idle.md)  
- [IXPLogon::Poll](ixplogon-poll.md)  
- [IXPLogon::TransportNotify](ixplogon-transportnotify.md) 
- [MAPIERROR](mapierror.md)


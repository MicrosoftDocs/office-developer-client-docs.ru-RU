---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 01a8e3c479ab3ddd1be9386e033b993fda5835a7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809685"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="451d9-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="451d9-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="451d9-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="451d9-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="451d9-105">Устанавливает сеанс, в котором клиентское приложение входит в систему поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="451d9-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="451d9-106">Параметры</span><span class="sxs-lookup"><span data-stu-id="451d9-106">Parameters</span></span>

<span data-ttu-id="451d9-107">_lpMAPISup_: [входной параметр] указатель на объект поддержки поставщика транспорта для функции обратного вызова в рамках MAPI для данного сеанса.</span><span class="sxs-lookup"><span data-stu-id="451d9-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="451d9-108">Этот объект действителен, пока не поставщика транспорта освобождает его.</span><span class="sxs-lookup"><span data-stu-id="451d9-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="451d9-109">_ulUIParam_: [дескриптор родительского окна все диалоговые окна или windows, этот метод отображает in].</span><span class="sxs-lookup"><span data-stu-id="451d9-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="451d9-110">Параметр _ulUIParam_ может отличаться от null, например, когда флаг LOGON_SETUP имеет значение с помощью параметра _lpulFlags_ .</span><span class="sxs-lookup"><span data-stu-id="451d9-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="451d9-111">_lpszProfileName_: [входной параметр] указатель на имя профиля пользователя.</span><span class="sxs-lookup"><span data-stu-id="451d9-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="451d9-112">Параметр _lpszProfileName_ в основном используется, когда необходимо появится диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="451d9-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="451d9-113">_lpulFlags_: [в, out] битовую маску флагов, который определяет, каким образом устанавливаются сеанса входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="451d9-114">Можно задать следующие флаги ввода диспетчером очереди MAPI:</span><span class="sxs-lookup"><span data-stu-id="451d9-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="451d9-115">LOGON_NO_CONNECT: Учетная запись пользователя является вход в систему для данного поставщика транспорта для целей, отличных от передачи и приема сообщений.</span><span class="sxs-lookup"><span data-stu-id="451d9-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="451d9-116">Поставщика транспорта не следует пытаться подключаться к другие системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="451d9-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="451d9-117">LOGON_NO_DIALOG: Диалоговое окно не должно отображаться даже в том случае, если в настоящее время сохраненные учетные данные пользователя: недопустимый или недостаточно для входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="451d9-118">LOGON_NO_INBOUND: Поставщика транспорта не требуется инициализировать для приема сообщений и не должен принимать входящие сообщения.</span><span class="sxs-lookup"><span data-stu-id="451d9-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="451d9-119">Диспетчер очереди MAPI можно использовать метод [IXPLogon::TransportNotify](ixplogon-transportnotify.md) более поздней версии для обозначения поставщика транспорта для включения обработки входящего сообщения.</span><span class="sxs-lookup"><span data-stu-id="451d9-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="451d9-120">LOGON_NO_OUTBOUND: Поставщика транспорта не нужно инициализировать для отправки сообщений, как диспетчер очереди MAPI не выполняет какие-либо.</span><span class="sxs-lookup"><span data-stu-id="451d9-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="451d9-121">Если клиентское приложение требуется подключение к удаленной поставщика во время составления сообщения, чтобы его можно выполнять вызовы метода [IXPLogon::AddressTypes](ixplogon-addresstypes.md) , поставщика транспорта следует создать подключение.</span><span class="sxs-lookup"><span data-stu-id="451d9-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="451d9-122">Диспетчер очереди MAPI можно использовать **TransportNotify** для поставщика транспорта оповещения о том, можно приступить к исходящей операции.</span><span class="sxs-lookup"><span data-stu-id="451d9-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="451d9-123">MAPI_UNICODE: Строка переданное для имени профиля — в формате Юникод.</span><span class="sxs-lookup"><span data-stu-id="451d9-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="451d9-124">Если MAPI\_Юникод флаг не установлен, — это строка в формате ANSI.</span><span class="sxs-lookup"><span data-stu-id="451d9-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="451d9-125">Можно задать следующие флаги выходные данные, поставщика транспорта:</span><span class="sxs-lookup"><span data-stu-id="451d9-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="451d9-126">LOGON_SP_IDLE: Запросы, что диспетчер очереди MAPI часто вызовите метод [IXPLogon::Idle](ixplogon-idle.md) поставщика транспорта для обработки времени простоя.</span><span class="sxs-lookup"><span data-stu-id="451d9-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="451d9-127">LOGON_SP_POLL: Запросы, которые диспетчер очереди MAPI часто вызовите метод [IXPLogon::Poll](ixplogon-poll.md) на объекте возвращенные входа для проверки новых сообщений.</span><span class="sxs-lookup"><span data-stu-id="451d9-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="451d9-128">Если этот флаг не установлен, диспетчер очереди MAPI проверяет наличие новых сообщений при поставщика транспорта использует метод [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) для уведомления очереди, что существуют новые сообщения для обработки.</span><span class="sxs-lookup"><span data-stu-id="451d9-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="451d9-129">Поставщика транспорта эффективно становится доступным только для отправки, не задав этот флаг и, не запрашивая диспетчер очереди MAPI поступления сообщений.</span><span class="sxs-lookup"><span data-stu-id="451d9-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="451d9-130">LOGON_SP_RESOLVE: Запросы, которые разрешают диспетчер очереди MAPI для полного адреса все адреса получателей сообщения не поддерживается поставщиком транспорта.</span><span class="sxs-lookup"><span data-stu-id="451d9-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="451d9-131">Таким образом, что поставщик транспорта можно создать обратный путь для всех получателей.</span><span class="sxs-lookup"><span data-stu-id="451d9-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="451d9-132">MAPI_UNICODE: Возвращенных строк в структуре [MAPIERROR](mapierror.md) при их наличии, находятся в формате Юникод.</span><span class="sxs-lookup"><span data-stu-id="451d9-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="451d9-133">Если флаг MAPI_UNICODE не установлен, они в формате ANSI.</span><span class="sxs-lookup"><span data-stu-id="451d9-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="451d9-134">_lppMAPIError_: [out] указатель на указатель на структуру возвращенные **MAPIERROR** при их наличии, которая содержит версии, компонент и контекста сведения об ошибке.</span><span class="sxs-lookup"><span data-stu-id="451d9-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="451d9-135">Параметр _lppMAPIError_ может быть присвоено значение NULL, если структура не **MAPIERROR** для возврата.</span><span class="sxs-lookup"><span data-stu-id="451d9-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="451d9-136">_lppXPLogon_: [out] указатель на указатель на объект возвращенные транспорта поставщика входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="451d9-137">������������ ��������</span><span class="sxs-lookup"><span data-stu-id="451d9-137">Return value</span></span>

<span data-ttu-id="451d9-138">Значение S_OK: Звонок успешно и вернул ожидаемым значением или значения.</span><span class="sxs-lookup"><span data-stu-id="451d9-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="451d9-139">MAPI_E_FAILONEPROVIDER: Этот поставщик не может войти, но эта ошибка не следует отключить службу.</span><span class="sxs-lookup"><span data-stu-id="451d9-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="451d9-140">MAPI_E_UNCONFIGURED: Профиль не содержит достаточно сведений для входа в систему для завершения.</span><span class="sxs-lookup"><span data-stu-id="451d9-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="451d9-141">MAPI вызывает функцию точки входа службы сообщений поставщика.</span><span class="sxs-lookup"><span data-stu-id="451d9-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="451d9-142">MAPI_E_UNKNOWN_CPID: Поставщик не поддерживает кодовая страница клиента.</span><span class="sxs-lookup"><span data-stu-id="451d9-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="451d9-143">MAPI_E_UNKNOWN_LCID: Поставщик не поддерживает сведения о языковом стандарте клиента.</span><span class="sxs-lookup"><span data-stu-id="451d9-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="451d9-144">MAPI_E_USER_CANCEL: Пользователь отменил операцию, как правило, нажмите кнопку **Отмена** в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="451d9-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="451d9-145">Замечания</span><span class="sxs-lookup"><span data-stu-id="451d9-145">Remarks</span></span>

<span data-ttu-id="451d9-146">Диспетчер очереди MAPI вызывает метод **IXPProvider::TransportLogon** сеанс входа в систему для пользователя.</span><span class="sxs-lookup"><span data-stu-id="451d9-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="451d9-147">Большинство поставщиков транспорта, используется метод [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) , входящие в состав поддержки объект, указанный с помощью параметра _lpMAPISup_ для сохранения и извлечения сведений об удостоверениях, адреса сервера и учетные данные.</span><span class="sxs-lookup"><span data-stu-id="451d9-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="451d9-148">С помощью **OpenProfileSection**, поставщика транспорта можно записать данные, произвольных и связать его с помощью учетной записи входа для определенного ресурса.</span><span class="sxs-lookup"><span data-stu-id="451d9-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="451d9-149">Например поставщик можно использовать **OpenProfileSection** для сохранения имя учетной записи и пароль, связанный с определенным сеансом и любые имена серверов или другие необходимые сведения, необходимые для доступа к ресурсам для данного сеанса.</span><span class="sxs-lookup"><span data-stu-id="451d9-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="451d9-150">MAPI скрывает сведения, связанные с ресурсами извне.</span><span class="sxs-lookup"><span data-stu-id="451d9-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="451d9-151">В разделе профилей, доступные через _lpMAPISup_ управляется диспетчер очереди MAPI, данные, связанные с этой контекста пользователя, разделенных на основе данных для других контекстов.</span><span class="sxs-lookup"><span data-stu-id="451d9-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="451d9-152">Поставщика транспорта необходимо вызвать метод **IUnknown::AddRef** на объекте поддержки и сохраните копию указатель мыши на этот объект в составе объекта поставщика входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="451d9-153">Отображаемое имя профиля в _lpszProfileName_ предоставляется, поставщика транспорта можно использовать его в сообщения об ошибках или диалоговые окна входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="451d9-154">Если поставщик сохраняет это имя, его нужно скопировать выделенный поставщиком хранилища.</span><span class="sxs-lookup"><span data-stu-id="451d9-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="451d9-155">Поставщики транспорта, которые тесно связаны с другими поставщиками услуг может потребоваться выполнение дополнительных действий при входе в систему для установления хороший учетные данные, необходимые для операций между поставщиками компаньона.</span><span class="sxs-lookup"><span data-stu-id="451d9-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="451d9-156">Как правило поставщиками транспорта открываются при первом входе в систему в профиль.</span><span class="sxs-lookup"><span data-stu-id="451d9-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="451d9-157">Так как первого входа в систему в профиль таким образом обычно поступает перед входом в систему для любого хранилища сообщений, диспетчер очереди MAPI обычно вызывает **TransportLogon** LOGON_NO_INBOUND и LOGON_NO_OUTBOUND набора флагов в _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="451d9-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="451d9-158">Более поздних версий когда хранилищ соответствующего сообщения доступны в сеансе профиля, диспетчер очереди MAPI вызывает **TransportNotify** для инициации входящих и исходящих операций для поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="451d9-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="451d9-159">Передача флаг LOGON_NO_CONNECT в сигналы _lpulFlags_ работу в автономном режиме поставщика транспорта.</span><span class="sxs-lookup"><span data-stu-id="451d9-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="451d9-160">Этот флаг указывает, что необходимо осуществлять без внешних подключений; Если поставщик транспорта не удается установить сеанс без подключения к внешним данным, она возвращает код ошибки для входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="451d9-161">Поставщика транспорта следует устанавливать флаг LOGON_SP_IDLE на _lpulFlags_ во время инициализации если он предназначен для использования время, затрачиваемое системы в противном случае бездействия.</span><span class="sxs-lookup"><span data-stu-id="451d9-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="451d9-162">Такое время часто используется для обработки автоматического операций, таких как автоматическая загрузка, сообщения превышено время загрузки сообщений или превышено время отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="451d9-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="451d9-163">Если установлен этот флаг, диспетчер очереди MAPI вызывает **Idle** при наступлении времени простоя системы для инициации таких операций.</span><span class="sxs-lookup"><span data-stu-id="451d9-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="451d9-164">Диспетчер очереди MAPI не вызывает **Idle** через заданные промежутки времени; Вместо этого он вызывается только во время простоя значение true.</span><span class="sxs-lookup"><span data-stu-id="451d9-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="451d9-165">Таким образом поставщики не должны работать на любые предположения об как часто вызывать их методы **Idle** .</span><span class="sxs-lookup"><span data-stu-id="451d9-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="451d9-166">Поставщики, которые поддерживают операции время простоя следует указать пользовательский интерфейс настройки для него в свойств их поставщика.</span><span class="sxs-lookup"><span data-stu-id="451d9-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="451d9-167">Если вход в систему поставщика транспорта успешно, поставщик должен возвращать с помощью параметра _lppXPLogon_ указатель объект входа в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="451d9-168">Диспетчер очереди MAPI будет использовать этот объект для доступа к дополнительные поставщика.</span><span class="sxs-lookup"><span data-stu-id="451d9-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="451d9-169">Если **TransportLogon** отображает диалоговое окно входа в систему и пользователь отменил входа в систему как правило, нажмите кнопку **Отмена** в диалоговом окне Поставщик должен возвращать MAPI_E_USER_CANCEL.</span><span class="sxs-lookup"><span data-stu-id="451d9-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="451d9-170">Для большинства ошибок, возвращаемые **TransportLogon**MAPI отключает службы сообщений, к которым принадлежит поставщик.</span><span class="sxs-lookup"><span data-stu-id="451d9-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="451d9-171">MAPI не будут вызывать поставщиков, которые принадлежат в службе rest сеанса MAPI.</span><span class="sxs-lookup"><span data-stu-id="451d9-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="451d9-172">С другой стороны при **TransportLogon** возвращает значение ошибки MAPI_E_FAILONEPROVIDER из его входа в систему, MAPI не отключайте службы сообщений, к которой принадлежит поставщик.</span><span class="sxs-lookup"><span data-stu-id="451d9-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="451d9-173">**TransportLogon** должен возвращать MAPI_E_FAILONEPROVIDER, если возникает ошибка, которая не гарантирует отключение службы в оставшейся части сеанса.</span><span class="sxs-lookup"><span data-stu-id="451d9-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="451d9-174">Если поставщик возвращает MAPI_E_UNCONFIGURED из его входа в систему, MAPI вызовите функцию запись службы поставщика сообщение и повторите вход в систему.</span><span class="sxs-lookup"><span data-stu-id="451d9-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="451d9-175">MAPI передает MSG_SERVICE_CONFIGURE в качестве контекста, чтобы дать возможность настройки службы.</span><span class="sxs-lookup"><span data-stu-id="451d9-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="451d9-176">Если принято решение клиента разрешить пользовательского интерфейса при входе в систему, службу можно представить его настройки свойств, чтобы пользователь может ввести сведения о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="451d9-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="451d9-177">Если поставщик обнаруживает, что все, что не является необходимой информации в профиле, она возвращает MAPI_E_UNCONFIGURED, чтобы MAPI вызывает функцию точки входа службы сообщений поставщика.</span><span class="sxs-lookup"><span data-stu-id="451d9-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="451d9-178">См. также</span><span class="sxs-lookup"><span data-stu-id="451d9-178">See also</span></span>

- [<span data-ttu-id="451d9-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="451d9-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="451d9-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="451d9-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="451d9-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="451d9-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="451d9-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="451d9-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="451d9-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="451d9-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="451d9-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="451d9-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="451d9-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="451d9-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="451d9-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="451d9-186">MAPIERROR</span></span>](mapierror.md)


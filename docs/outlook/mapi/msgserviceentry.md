---
title: MSGSERVICEENTRY
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.MSGSERVICEENTRY
api_type:
- COM
ms.assetid: 655774a6-588c-44c7-903b-4497b7eccbc2
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 954609cbc62039c0d60874bde83fde50d1d11c30
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22591669"
---
# <a name="msgserviceentry"></a>MSGSERVICEENTRY

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Определяет прототип для сообщений службы функцию точки входа для поддержки конфигурации службы сообщений. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapispi.h  <br/> |
|Функция реализован:  <br/> |Службы сообщений  <br/> |
|Вызывается функция:  <br/> |MAPI  <br/> |
   
```cpp
HRESULT MSGSERVICEENTRY(
  HINSTANCE hInstance,
  LPMALLOC lpMalloc,
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  ULONG ulFlags,
  ULONG ulContext,
  ULONG cValues,
  LPSPropValue lpProps,
  LPPROVIDERADMIN lpProviderAdmin,
  LPMAPIERROR FAR * lppMapiError
);
```

## <a name="parameters"></a>Параметры

 _hInstance_
  
> [in] Дескриптор экземпляра службы providerDLL. Дескриптор обычно используется для извлечения ресурсов. 
    
 _lpMalloc_
  
> [in] Указатель на объект распределителя памяти, предоставление интерфейса OLE **IMalloc** . Служба сообщений может потребоваться использовать этот метод для распределения при работе с определенных интерфейсов, таких как **IStream**. 
    
 _lpMAPISup_
  
> [in] Указатель на [IMAPISupport: IUnknown](imapisupportiunknown.md) реализация интерфейса. 
    
 _ulUIParam_
  
> [in] От реализации значение, используемое для передачи в функцию или ноль, сведения о пользовательском интерфейсе. Параметр _ulUIParam_ является дескриптор родительского окна для диалогового окна конфигурации и типа HWND (приведения к ULONG_PTR). Нулевое значение указывает, что нет родительского окна. 
    
 _ulFlags_
  
> [in] Битовая маска, указывающее параметры для функции входа службы флагов. Можно задать следующие флажки:
    
MAPI_UNICODE 
  
> Строки переданное хранятся в формате Юникод. Если флаг MAPI_UNICODE не установлен, они в формате ANSI. 
    
MSG_SERVICE_UI_READ_ONLY 
  
> Пользовательский интерфейс конфигурации службы должны отображаться текущей конфигурации, но не разрешать пользователям изменять его. 
    
SERVICE_UI_ALLOWED 
  
> Разрешает диалоговое окно настройки будет отображаться, если это необходимо. Если для флага SERVICE_UI_ALLOWED, диалоговое окно должно отображаться только в том случае, если массива значение свойства _lpProps_ пуст или не содержит допустимое конфигурации. Если SERVICE_UI_ALLOWED не установлен, диалоговое окно может по-прежнему отображается, если установлен флаг SERVICE_UI_ALWAYS. 
    
UI_CURRENT_PROVIDER_FIRST 
  
> Запросы, что диалоговое окно конфигурации для поставщика active Directory отображаться поверх других диалоговых окон. 
    
SERVICE_UI_ALWAYS 
  
> Требуется служба сообщений для отображения диалогового окна конфигурации. Если флаг SERVICE_UI_ALWAYS не установлен, диалоговое окно настройки может по-прежнему отображается, если установлен флаг SERVICE_UI_ALLOWED и сведений о конфигурации допустимый недоступен из массива значение свойства _lpProps_ . SERVICE_UI_ALLOWED или SERVICE_UI_ALWAYS должен иметь значение Разрешить пользовательского интерфейса для отображения. 
    
 _ulContext_
  
> [in] Операция конфигурации, в настоящее время выполнения MAPI. Параметр _ulContext_ будет содержать одно из следующих значений: 
    
MSG_SERVICE_CONFIGURE 
  
> Изменения в конфигурацию службы должны выполняться в профиле. Если значение флага SERVICE_UI_ALWAYS, службы должны отображать диалоговое окно ее настройки. Диалоговое окно также должно отображаться, если установлен флаг SERVICE_UI_ALLOWED и параметр _lpProps_ пуст или не содержит данных недопустимой конфигурацией. Если _lpProps_ содержит допустимых данных, диалоговое окно не должно отображаться и службы следует использовать эти данные для внесения изменений конфигурации. 
    
MSG_SERVICE_CREATE 
  
> Службы добавляется в профиль. Если установлен параметр SERVICE_UI_ALWAYS или SERVICE_UI_ALLOWED флаг службы должны отображать диалоговое окно ее настройки. Если ни один из флаг установлен, следует не удается службу. 
    
MSG_SERVICE_DELETE 
  
> Служба удаляется из профиля. После получения это событие, службу должен возвращать значение S_OK.
    
MSG_SERVICE_INSTALL 
  
> Служба установлена на рабочей станции пользователя из сети, гибкий диск или другой внешний носитель. После получения это событие, служба обычно возвращает значение S_OK. 
    
MSG_SERVICE_PROVIDER_CREATE 
  
> Запрашивает создание дополнительного экземпляра поставщика службы. Если служба поддерживает эту операцию, он должен вызвать [IProviderAdmin::CreateProvider](iprovideradmin-createprovider.md). Если служба не поддерживает эту операцию, он может вернуть MAPI_E_NO_SUPPORT. 
    
MSG_SERVICE_PROVIDER_DELETE 
  
> Запросы на том, что служба удаляет экземпляр поставщика. Если служба поддерживает эту операцию, он должен вызвать [IProviderAdmin::DeleteProvider](iprovideradmin-deleteprovider.md). Если служба не поддерживает эту операцию, он может вернуть MAPI_E_NO_SUPPORT.
    
MSG_SERVICE_UNINSTALL 
  
> Служба удалена. После получения это событие, служба может выполнять все задачи очистки, которые необходимо выполнить до службы заканчивается и затем возвращает значение success. Если пользователь отменил удаления, служба должна вернуть MAPI_E_USER_CANCEL. 
    
 _cValues_
  
> [in] Число значений свойств в массиве указывает параметр _lpProps_ . Значение параметра _cValues_ равно нулю, если передает без значений свойств MAPI. 
    
 _lpProps_
  
> [in] Указатель на необязательный массив [SPropValue](spropvalue.md) структуры, указывающее значения свойств, поддерживаемых поставщиком, которые будут использовать функцию во время настройки службы сообщений. Функция использует этот параметр только в том случае, если параметр _ulContext_ имеет значение MSG_SERVICE_CONFIGURE. Этот параметр обычно используется для передачи путь к файлу для службы на основе файла, например из службы адресной книги. Если флаг MSG_SERVICE_CONFIGURE не передается в параметре _ulFlags_ , параметр _lpProps_ должен быть нулю. 
    
 _lpProviderAdmin_
  
> [in] Указатель на интерфейс [IProviderAdmin:IUnknown](iprovideradminiunknown.md) , можно использовать функцию для поиска разделов профиля для определенного поставщика в текущей службы сообщений. 
    
 _lppMapiError_
  
> [out] Указатель на структуру [MAPIERROR](mapierror.md) . Структура выделяется с помощью функции [MAPIAllocateBuffer](mapiallocatebuffer.md) . Все элементы являются необязательными, несмотря на то, что большинство структур будет содержать строку сообщения допустимый ошибка _lpszError_ участника. Если присутствуют _lpszComponent_ или _lpszError_ элементы структуры, их памяти в конечном счете освобождения с помощью одного вызова [MAPIFreeBuffer](mapifreebuffer.md) на базовую структуру. 
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������. 
    
MAPI_E_UNCONFIGURED 
  
> Поставщик услуг не был настроен. 
    
MAPI_E_USER_CANCEL 
  
> Пользователь отменил операцию, как правило, нажмите кнопку **Отмена** в диалоговом окне. 
    
MAPI_E_NO_SUPPORT 
  
> Поставщик не поддерживает изменения в объекты или не поддерживает уведомление об изменениях. 
    
MAPI_E_BAD_CHARWIDTH 
  
> Либо был установлен флажок MAPI_UNICODE и реализация не поддерживает Юникод, или MAPI_UNICODE не было установлено и реализация поддерживает только Юникод.
    
## <a name="remarks"></a>Замечания

Функция, которая определена с помощью прототипа функции **MSGSERVICEENTRY** включает сообщения службы для настройки сами или выполнить другие действия, зависящие от службы. Функции в основном предоставляющей диалоговое окно, в котором пользователь может изменить параметры, относящиеся к службе сообщений. Он также может поддерживать программной конфигурации с помощью массива значение свойства, переданной в параметре _lpProps_ . Программная конфигурация является необязательным, если служба не поддерживает мастер профиля, для которого является обязательным. 
  
MAPI вызывает эта точка входа из приложения панели управления или в ответ на вызов [IMsgServiceAdmin::CreateMsgService](imsgserviceadmin-createmsgservice.md) или [IMsgServiceAdmin::ConfigureMsgService](imsgserviceadmin-configuremsgservice.md)клиентского приложения. 
  
MAPI помещает без ограничений на имя функции, что служба сообщений с помощью прототип **MSGSERVICEENTRY** , но предпочитает имя **на неизвестную запись сервиса**. Ограничения на порядковый номер для функции нет и одного поставщика DLL-Библиотека может содержать несколько функций. Тем не менее только одна из функции может быть задано **на неизвестную запись сервиса**. 
  
Служба сообщений можно использовать функцию [BuildDisplayTable](builddisplaytable.md) и метод [IMAPISupport::DoConfigPropsheet](imapisupport-doconfigpropsheet.md) для упрощения реализации диалогового окна конфигурации. 
  
Это позволяет пользователю отменить операцию MSG_SERVICE_UNINSTALL. В этом случае функции **на неизвестную запись сервиса** должен проверить, с пользователем, убедитесь, что служба не следует удалять и возвращает MAPI_E_USER_CANCEL, если служба останется установленной. 
  
Функции, основанной на прототип **MSGSERVICEENTRY** возвращает одно из перечисленных значений HRESULT. MAPI переадресует это значение при ответе на вызов клиента [IMsgServiceAdmin::ConfigureMsgService](imsgserviceadmin-configuremsgservice.md). 
  
Службы сообщений, которые экспортировать функции входа службы необходимо включить свойства **PR_SERVICE_ENTRY_NAME** ([PidTagServiceEntryName](pidtagserviceentryname-canonical-property.md)) и **PR_SERVICE_DLL_NAME** ([PidTagServiceDllName](pidtagservicedllname-canonical-property.md)) в разделе службы сообщений MAPISVC.INF. 
  


---
title: Установка свойств входящих сообщений
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cf4a0501-f42b-4652-a239-003022686475
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f6233afffd532c420ae170ae45b1bf93d6571865
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812291"
---
# <a name="setting-properties-on-incoming-messages"></a><span data-ttu-id="84d1a-103">Установка свойств входящих сообщений</span><span class="sxs-lookup"><span data-stu-id="84d1a-103">Setting Properties on Incoming Messages</span></span>

  
  
<span data-ttu-id="84d1a-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="84d1a-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="84d1a-105">Клиентские приложения в подсистеме MAPI предполагается, что число свойств в любой полученного сообщения.</span><span class="sxs-lookup"><span data-stu-id="84d1a-105">The client applications within the MAPI subsystem expect a number of properties in any received message.</span></span> <span data-ttu-id="84d1a-106">При поставщика транспорта возвращает сообщение в MAPI, его следует задать эти свойства, поскольку он — это единственный процесс с сведения, необходимые для этого, или по крайней мере наилучшего источника данных.</span><span class="sxs-lookup"><span data-stu-id="84d1a-106">When the transport provider brings a message into MAPI, it should set these properties, since it is either the only process with the necessary information to do so, or is at least the best source of the information.</span></span>
  
<span data-ttu-id="84d1a-107">Поставщики, рекомендуется задать значения для всех этих свойств в входящих сообщений.</span><span class="sxs-lookup"><span data-stu-id="84d1a-107">Providers are encouraged to set the values for all of these properties in incoming messages.</span></span>
  
|<span data-ttu-id="84d1a-108">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="84d1a-108">**Property name**</span></span>|<span data-ttu-id="84d1a-109">**Описание**</span><span class="sxs-lookup"><span data-stu-id="84d1a-109">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="84d1a-110">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-110">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-111">Тема сообщения.</span><span class="sxs-lookup"><span data-stu-id="84d1a-111">The subject of the message.</span></span>  <br/> |
|<span data-ttu-id="84d1a-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-113">Текст сообщения в обычный текст.</span><span class="sxs-lookup"><span data-stu-id="84d1a-113">Plain text message text.</span></span>  <br/> |
|<span data-ttu-id="84d1a-114">**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-114">**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-115">Текст сообщения сжатый формат RTF.</span><span class="sxs-lookup"><span data-stu-id="84d1a-115">Compressed RTF message text.</span></span>  <br/> |
|<span data-ttu-id="84d1a-116">**PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-116">**PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-117">Дата и время сообщение было доставлено.</span><span class="sxs-lookup"><span data-stu-id="84d1a-117">The date and time the message was delivered.</span></span>  <br/> |
|<span data-ttu-id="84d1a-118">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-118">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-119">Отображаемое имя этого отправитель сообщения.</span><span class="sxs-lookup"><span data-stu-id="84d1a-119">The display name of the message originator.</span></span>  <br/> |
|<span data-ttu-id="84d1a-120">**PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-120">**PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-121">Записи адресной книги после этого отправитель сообщения.</span><span class="sxs-lookup"><span data-stu-id="84d1a-121">The address book entry of the message originator.</span></span>  <br/> |
|<span data-ttu-id="84d1a-122">**PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-122">**PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-123">Адресной книги поиска ключ после этого отправитель сообщения.</span><span class="sxs-lookup"><span data-stu-id="84d1a-123">The address book search key of the message originator.</span></span>  <br/> |
|<span data-ttu-id="84d1a-124">**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-124">**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-125">Время, когда сообщение было отправлено системы обмена сообщениями с сообщениями клиента отправителя.</span><span class="sxs-lookup"><span data-stu-id="84d1a-125">The time that the message was submitted to its messaging system by the sender's messaging client.</span></span>  <br/> |
|<span data-ttu-id="84d1a-126">**PR_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-126">**PR_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-127">Имя представителя делегат для отправки.</span><span class="sxs-lookup"><span data-stu-id="84d1a-127">The name of the representative delegate for sending.</span></span>  <br/> |
|<span data-ttu-id="84d1a-128">**PR_SENT_REPRESENTING_ENTRYID** ([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-128">**PR_SENT_REPRESENTING_ENTRYID** ([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-129">Записи адресной книги, отправляющим делегата.</span><span class="sxs-lookup"><span data-stu-id="84d1a-129">The address book entry of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="84d1a-130">**PR_SENT_REPRESENTING_SEARCH_KEY** ([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-130">**PR_SENT_REPRESENTING_SEARCH_KEY** ([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-131">Ключ поиска книги адрес отправителя делегата.</span><span class="sxs-lookup"><span data-stu-id="84d1a-131">The address book search key of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="84d1a-132">**PR_RCVD_REPRESENTING_NAME** ([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-132">**PR_RCVD_REPRESENTING_NAME** ([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-133">Имя представителя делегат для приема.</span><span class="sxs-lookup"><span data-stu-id="84d1a-133">The name of the representative delegate for receiving.</span></span>  <br/> |
|<span data-ttu-id="84d1a-134">**PR_RCVD_REPRESENTING_ENTRYID** ([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-134">**PR_RCVD_REPRESENTING_ENTRYID** ([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-135">Записи адресной книги получающей делегата.</span><span class="sxs-lookup"><span data-stu-id="84d1a-135">The address book entry of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="84d1a-136">**PR_RCVD_REPRESENTING_SEARCH_KEY** ([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-136">**PR_RCVD_REPRESENTING_SEARCH_KEY** ([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-137">Клавиша поиска книги адрес получающей делегата.</span><span class="sxs-lookup"><span data-stu-id="84d1a-137">The address book search key of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="84d1a-138">**PR_REPLY_RECIPIENT_NAMES** ([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-138">**PR_REPLY_RECIPIENT_NAMES** ([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-139">Список делегированных получателя отображения имен, разделенных точкой с запятой и пространства («;»).</span><span class="sxs-lookup"><span data-stu-id="84d1a-139">The list of delegated recipient display names, separated by a semicolon and space ("; ").</span></span>  <br/> |
|<span data-ttu-id="84d1a-140">**PR_REPLY_RECIPIENT_ENTRIES** ([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-140">**PR_REPLY_RECIPIENT_ENTRIES** ([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-141">Список делегированных получателей на ответ.</span><span class="sxs-lookup"><span data-stu-id="84d1a-141">The list of delegated recipients for a reply.</span></span>  <br/> |
|<span data-ttu-id="84d1a-142">**PR_MESSAGE_TO_ME** ([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-142">**PR_MESSAGE_TO_ME** ([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-143">Указывает, что получатель был намеренно с именем как получателя «кому» (не входит в группу).</span><span class="sxs-lookup"><span data-stu-id="84d1a-143">Indicates that the recipient was specifically named as a "to" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="84d1a-144">**PR_MESSAGE_CC_ME** ([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-144">**PR_MESSAGE_CC_ME** ([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-145">Указывает, что получатель был намеренно с именем как получателя «копия» (не входит в группу).</span><span class="sxs-lookup"><span data-stu-id="84d1a-145">Indicates that the recipient was specifically named as a "cc" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="84d1a-146">**PR_MESSAGE_RECIP_ME** ([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="84d1a-146">**PR_MESSAGE_RECIP_ME** ([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="84d1a-147">Указывает, что получатель был намеренно с именем как «Кому», «копия» или «Скрытая копия» получатель (не входит в группу).</span><span class="sxs-lookup"><span data-stu-id="84d1a-147">Indicates that the recipient was specifically named as a "to", "cc" or "bcc" recipient (not in a group).</span></span>  <br/> |
   
<span data-ttu-id="84d1a-148">Поставщики, которые имеют не очевидное сопоставления можно задать группу **PR_SENT_REPRESENTING** свойств те же значения, как группа **PR_SENDER** , группа **PR_RCVD_REPRESENTING** свойств, те же значения, как **PR_RECEIVED_BY **группу, а можно создать группу **PR_REPLY_RECIPIENT** свойства на основе значений группы **PR_SENDER** .</span><span class="sxs-lookup"><span data-stu-id="84d1a-148">Providers that have no apparent mappings can set the **PR_SENT_REPRESENTING** group of properties to the same values as the **PR_SENDER** group, the **PR_RCVD_REPRESENTING** group of properties to the same values as the **PR_RECEIVED_BY** group, and can build the **PR_REPLY_RECIPIENT** group of properties based on the values of the **PR_SENDER** group.</span></span> <span data-ttu-id="84d1a-149">Например **PR_SENT_REPRESENTING_NAME** может быть присвоено значение **PR_SENDER_NAME**.</span><span class="sxs-lookup"><span data-stu-id="84d1a-149">For example, **PR_SENT_REPRESENTING_NAME** can be set to the same value as **PR_SENDER_NAME**.</span></span>
  
<span data-ttu-id="84d1a-150">Свойство **PR_ENTRYID** или **PR_ENTRYLIST** может возникать, если это необходимо, путем вызова метода [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md) .</span><span class="sxs-lookup"><span data-stu-id="84d1a-150">The **PR_ENTRYID** or **PR_ENTRYLIST** property can be generated, if necessary, by calling the [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md) method.</span></span> <span data-ttu-id="84d1a-151">Группа **PR_SEARCH_KEY** свойств могут создаваться путем объединения **PR_ADDRTYPE** свойства, связанного с пользователем, двоеточие (:) и **PR_EMAIL_ADDRESS** свойства, связанного с этим пользователем, а затем изменение результат в верхний регистр .</span><span class="sxs-lookup"><span data-stu-id="84d1a-151">The **PR_SEARCH_KEY** group of properties can be generated by concatenating the **PR_ADDRTYPE** property associated with a user, a colon (:), and the **PR_EMAIL_ADDRESS** property associated with the user, then changing the result to uppercase.</span></span> <span data-ttu-id="84d1a-152">Функции Windows API **CharUpperBuff** — это удобный функции для этой цели.</span><span class="sxs-lookup"><span data-stu-id="84d1a-152">The Windows API function **CharUpperBuff** is a convenient function to use for this purpose.</span></span> <span data-ttu-id="84d1a-153">Что является необходимым этого процесса состоит в форме каноническое адрес, который необходимо сравнить как двоичные количество.</span><span class="sxs-lookup"><span data-stu-id="84d1a-153">What is required of this process is to make a canonical form of the address that can be compared as a binary quantity.</span></span> <span data-ttu-id="84d1a-154">Обратите внимание на то, что это не требуется, если поставщик транспорта задается с учетом регистра по отношению к адреса электронной почты.</span><span class="sxs-lookup"><span data-stu-id="84d1a-154">Note that this is not necessary if the transport provider is case-sensitive with respect to email addresses.</span></span> 
  


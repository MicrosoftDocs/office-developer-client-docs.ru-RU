---
title: Настройка свойств входящих сообщений
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cf4a0501-f42b-4652-a239-003022686475
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: d7043004799d534f11aa98770e2e323cbdae95a8
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432697"
---
# <a name="setting-properties-on-incoming-messages"></a><span data-ttu-id="ff7c4-103">Настройка свойств входящих сообщений</span><span class="sxs-lookup"><span data-stu-id="ff7c4-103">Setting Properties on Incoming Messages</span></span>

  
  
<span data-ttu-id="ff7c4-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ff7c4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ff7c4-105">Клиентские приложения в подсистеме MAPI ожидают ряд свойств в любом полученном сообщении.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-105">The client applications within the MAPI subsystem expect a number of properties in any received message.</span></span> <span data-ttu-id="ff7c4-106">Когда поставщик транспорта выводит сообщение в MAPI, он должен установить эти свойства, так как это либо единственный процесс с необходимой информацией, либо по крайней мере лучший источник информации.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-106">When the transport provider brings a message into MAPI, it should set these properties, since it is either the only process with the necessary information to do so, or is at least the best source of the information.</span></span>
  
<span data-ttu-id="ff7c4-107">Поставщикам рекомендуется устанавливать значения для всех этих свойств во входящих сообщениях.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-107">Providers are encouraged to set the values for all of these properties in incoming messages.</span></span>
  
|<span data-ttu-id="ff7c4-108">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="ff7c4-108">**Property name**</span></span>|<span data-ttu-id="ff7c4-109">**Описание**</span><span class="sxs-lookup"><span data-stu-id="ff7c4-109">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="ff7c4-110">**PR_SUBJECT** ([PidTagSubject)](pidtagsubject-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-110">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-111">Тема сообщения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-111">The subject of the message.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ff7c4-112">**PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-113">Текст обычного текстового сообщения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-113">Plain text message text.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-114">**PR_RTF_COMPRESSED** ([PidTagRtfCompressed)](pidtagrtfcompressed-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-114">**PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-115">Сжатый текст сообщения RTF.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-115">Compressed RTF message text.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-116">**PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime)](pidtagmessagedeliverytime-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-116">**PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-117">Дата и время доставки сообщения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-117">The date and time the message was delivered.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-118">**PR_SENDER_NAME** ([PidTagSenderName)](pidtagsendername-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-118">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-119">Отображаемого имени источника сообщения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-119">The display name of the message originator.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-120">**PR_SENDER_ENTRYID** ([PidTagSenderEntryId)](pidtagsenderentryid-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-120">**PR_SENDER_ENTRYID** ([PidTagSenderEntryId](pidtagsenderentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-121">Запись адресной книги источника сообщения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-121">The address book entry of the message originator.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-122">**PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey)](pidtagsendersearchkey-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-122">**PR_SENDER_SEARCH_KEY** ([PidTagSenderSearchKey](pidtagsendersearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-123">Ключ поиска в адресной книге источника сообщения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-123">The address book search key of the message originator.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-124">**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime)](pidtagclientsubmittime-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-124">**PR_CLIENT_SUBMIT_TIME** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-125">Время отправки сообщения в систему обмена сообщениями клиентом отправитель.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-125">The time that the message was submitted to its messaging system by the sender's messaging client.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-126">**PR_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ff7c4-126">**PR_SENT_REPRESENTING_NAME** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-127">Имя представителя для отправки.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-127">The name of the representative delegate for sending.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-128">**PR_SENT_REPRESENTING_ENTRYID** ([PidTagSentRepresentingEntryId)](pidtagsentrepresentingentryid-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-128">**PR_SENT_REPRESENTING_ENTRYID** ([PidTagSentRepresentingEntryId](pidtagsentrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-129">Запись адресной книги отправляемого делегата.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-129">The address book entry of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-130">**PR_SENT_REPRESENTING_SEARCH_KEY** ([PidTagSentRepresentingSearchKey)](pidtagsentrepresentingsearchkey-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-130">**PR_SENT_REPRESENTING_SEARCH_KEY** ([PidTagSentRepresentingSearchKey](pidtagsentrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-131">Ключ поиска адресной книги отправляемого делегата.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-131">The address book search key of the sending delegate.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-132">**PR_RCVD_REPRESENTING_NAME** ([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ff7c4-132">**PR_RCVD_REPRESENTING_NAME** ([PidTagReceivedRepresentingName](pidtagreceivedrepresentingname-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-133">Имя представителя для получения.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-133">The name of the representative delegate for receiving.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-134">**PR_RCVD_REPRESENTING_ENTRYID** ([PidTagReceivedRepresentingEntryId)](pidtagreceivedrepresentingentryid-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-134">**PR_RCVD_REPRESENTING_ENTRYID** ([PidTagReceivedRepresentingEntryId](pidtagreceivedrepresentingentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-135">Запись адресной книги получающие делегаты.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-135">The address book entry of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-136">**PR_RCVD_REPRESENTING_SEARCH_KEY** ([PidTagReceivedRepresentingSearchKey)](pidtagreceivedrepresentingsearchkey-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-136">**PR_RCVD_REPRESENTING_SEARCH_KEY** ([PidTagReceivedRepresentingSearchKey](pidtagreceivedrepresentingsearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-137">Ключ поиска в адресной книге получающем делегате.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-137">The address book search key of the receiving delegate.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-138">**PR_REPLY_RECIPIENT_NAMES** ([PidTagReplyRecipientNames)](pidtagreplyrecipientnames-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-138">**PR_REPLY_RECIPIENT_NAMES** ([PidTagReplyRecipientNames](pidtagreplyrecipientnames-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-139">Список делегированных получателей отображает имена, разделенные окном и пробелом ("; ").</span><span class="sxs-lookup"><span data-stu-id="ff7c4-139">The list of delegated recipient display names, separated by a semicolon and space ("; ").</span></span>  <br/> |
|<span data-ttu-id="ff7c4-140">**PR_REPLY_RECIPIENT_ENTRIES** ([PidTagReplyRecipientEntries)](pidtagreplyrecipiententries-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-140">**PR_REPLY_RECIPIENT_ENTRIES** ([PidTagReplyRecipientEntries](pidtagreplyrecipiententries-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-141">Список делегированных получателей для ответа.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-141">The list of delegated recipients for a reply.</span></span>  <br/> |
|<span data-ttu-id="ff7c4-142">**PR_MESSAGE_TO_ME** ([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="ff7c4-142">**PR_MESSAGE_TO_ME** ([PidTagMessageToMe](pidtagmessagetome-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-143">Указывает, что получатель был назван в качестве получателя "to" (не в группе).</span><span class="sxs-lookup"><span data-stu-id="ff7c4-143">Indicates that the recipient was specifically named as a "to" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="ff7c4-144">**PR_MESSAGE_CC_ME** ([PidTagMessageCcMe)](pidtagmessageccme-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-144">**PR_MESSAGE_CC_ME** ([PidTagMessageCcMe](pidtagmessageccme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-145">Указывает, что получатель был назван в качестве получателя "cc" (не в группе).</span><span class="sxs-lookup"><span data-stu-id="ff7c4-145">Indicates that the recipient was specifically named as a "cc" recipient (not in a group).</span></span>  <br/> |
|<span data-ttu-id="ff7c4-146">**PR_MESSAGE_RECIP_ME** ([PidTagMessageRecipientMe)](pidtagmessagerecipientme-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-146">**PR_MESSAGE_RECIP_ME** ([PidTagMessageRecipientMe](pidtagmessagerecipientme-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="ff7c4-147">Указывает, что получатель был назван в качестве получателя "to", "cc" или "bcc" (не в группе).</span><span class="sxs-lookup"><span data-stu-id="ff7c4-147">Indicates that the recipient was specifically named as a "to", "cc" or "bcc" recipient (not in a group).</span></span>  <br/> |
   
<span data-ttu-id="ff7c4-148">Поставщики без видимых сопоставлений могут установить для группы **свойств PR_SENT_REPRESENTING** те же значения, что и для группы **PR_SENDER,** группы свойств **PR_RCVD_REPRESENTING** с одинаковыми значениями группы **PR_RECEIVED_BY** и создать группу свойств **PR_REPLY_RECIPIENT** на основе значений группы **PR_SENDER.**</span><span class="sxs-lookup"><span data-stu-id="ff7c4-148">Providers that have no apparent mappings can set the **PR_SENT_REPRESENTING** group of properties to the same values as the **PR_SENDER** group, the **PR_RCVD_REPRESENTING** group of properties to the same values as the **PR_RECEIVED_BY** group, and can build the **PR_REPLY_RECIPIENT** group of properties based on the values of the **PR_SENDER** group.</span></span> <span data-ttu-id="ff7c4-149">Например, **PR_SENT_REPRESENTING_NAME** можно установить то же значение, **что и PR_SENDER_NAME.**</span><span class="sxs-lookup"><span data-stu-id="ff7c4-149">For example, **PR_SENT_REPRESENTING_NAME** can be set to the same value as **PR_SENDER_NAME**.</span></span>
  
<span data-ttu-id="ff7c4-150">Свойство **PR_ENTRYID** **или PR_ENTRYLIST** при необходимости можно создать с помощью вызова метода [IMAPISupport::CreateOneOff.](imapisupport-createoneoff.md)</span><span class="sxs-lookup"><span data-stu-id="ff7c4-150">The **PR_ENTRYID** or **PR_ENTRYLIST** property can be generated, if necessary, by calling the [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md) method.</span></span> <span data-ttu-id="ff7c4-151">Группу **PR_SEARCH_KEY** свойств можно сгенерировать, совместив свойство **PR_ADDRTYPE,** связанное с пользователем, двоеточие (:) и свойство **PR_EMAIL_ADDRESS,** связанное с пользователем, а затем изменив результат в верхнем регистре.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-151">The **PR_SEARCH_KEY** group of properties can be generated by concatenating the **PR_ADDRTYPE** property associated with a user, a colon (:), and the **PR_EMAIL_ADDRESS** property associated with the user, then changing the result to uppercase.</span></span> <span data-ttu-id="ff7c4-152">Функция API Windows **CharUpperBuff** — удобная функция, используемая для этой цели.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-152">The Windows API function **CharUpperBuff** is a convenient function to use for this purpose.</span></span> <span data-ttu-id="ff7c4-153">Для этого необходимо создать каноническую форму адреса, которую можно сравнить с двоичным количеством.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-153">What is required of this process is to make a canonical form of the address that can be compared as a binary quantity.</span></span> <span data-ttu-id="ff7c4-154">Обратите внимание, что это не требуется, если поставщик транспорта с учетом учетных записей в отношении адресов электронной почты.</span><span class="sxs-lookup"><span data-stu-id="ff7c4-154">Note that this is not necessary if the transport provider is case-sensitive with respect to email addresses.</span></span> 
  


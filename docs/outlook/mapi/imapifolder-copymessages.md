---
title: IMAPIFolderCopyMessages
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CopyMessages
api_type:
- COM
ms.assetid: 4c7d2110-3fcb-4b9f-bf20-1dc1a611161d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e253aa6a701d565fbc61e8a0e0a6388f7199c000
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22593265"
---
# <a name="imapifoldercopymessages"></a>IMAPIFolder::CopyMessages

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Копирование или перемещение одно или несколько сообщений.
  
```cpp
HRESULT CopyMessages(
  LPENTRYLIST lpMsgList,
  LPCIID lpInterface,
  LPVOID lpDestFolder,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpMsgList_
  
> [in] Указатель на массив структур [ENTRYLIST](entrylist.md) , чтобы указать сообщения или сообщения, чтобы скопировать или переместить. 
    
 _lpInterface_
  
> [in] Указатель на идентификатор интерфейса (ИД интерфейса), который представляет интерфейс, который будет использоваться для доступа к папке назначения, на который указывает параметр _lpDestFolder_ . Передача значение NULL, приводит к поставщика услуг, возврат интерфейсе стандартные папки [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md). Клиенты необходимо передать значение NULL. Другие абонентов можно включить параметр _lpInterface_ IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer или IID_IMAPIFolder. 
    
 _lpDestFolder_
  
> [in] Указатель открыть папку для получения копируемые или перемещения сообщений.
    
 _ulUIParam_
  
> [in] Дескриптор родительского окна из диалоговых окон и windows отображает этот метод. Параметр _ulUIParam_ игнорируется, если клиент устанавливает флаг MESSAGE_DIALOG с помощью параметра _ulFlags_ и передает значение NULL в параметре _lpProgress_ . 
    
 _lpProgress_
  
> [in] Указатель на объект хода выполнения, который отображает индикатор хода выполнения. Если в _lpProgress_передается значение NULL, поставщика хранилища сообщений отображает индикатор выполнения с помощью реализация объекта MAPI хода выполнения. Параметр _lpProgress_ используется только флаг MESSAGE_DIALOG установлен в _ulFlags_.
    
 _ulFlags_
  
> [in] Битовая маска флаги, который определяет, как выполнить операцию копирования или перемещения. Можно задать следующие флажки:
    
MAPI_DECLINE_OK 
  
> Информирует поставщика хранилища сообщений сразу же возвращает MAPI_E_DECLINE_COPY, если он реализует **IMAPIFolder::CopyMessages** путем вызова метода [IMAPISupport::DoCopyTo](imapisupport-docopyto.md) или [IMAPISupport::DoCopyProps](imapisupport-docopyprops.md) объект поддержки. 
    
MESSAGE_DIALOG 
  
> Отображает индикатор выполнения, как операция продолжается.
    
MESSAGE_MOVE 
  
> Сообщения или сообщения должны быть перемещены, а не копируются. Если MESSAGE_MOVE не задано, копируются сообщения.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщения или сообщения были успешно скопировать или переместить.
    
MAPI_E_DECLINE_COPY 
  
> Поставщик реализует этот метод, вызвав метод объекта поддержки и вызывающего абонента, истекло флаг MAPI_DECLINE_OK.
    
MAPI_W_PARTIAL_COMPLETION 
  
> Вызов завершился успешно, но не все записи были успешно скопировать или переместить. При возвращении этого предупреждения вызова необходимо обрабатывать об успешном завершении. Чтобы проверить это предупреждение, используйте **HR_FAILED** макрос. Дополнительные сведения можно [С помощью макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Замечания

Метод **IMAPIFolder::CopyMessages** копирование или перемещение сообщений в другую папку. 
  
Сообщения, которые открываются с помощью чтения и записи разрешений можно переместить или скопировать. 
  
## <a name="notes-to-implementers"></a>Примечания для реализующих

При копировании сообщения в другом хранилище сообщение без использования метода [IMAPISupport::CopyMessages](imapisupport-copymessages.md) , сначала необходимо вызвать [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) с установленным флагом GENERATE_RECEIPT_ONLY. Получение хранилища сообщений не отвечает за создание просмотра отчетов для копируемые или перемещения сообщений. При вызове **IMAPISupport::CopyMessages** для реализации **IMAPIFolder::CopyMessages**не вызывайте **SetReadFlags**; Он будет называться MAPI. 
  
Реализация может перемещение или копирование сообщения в любом порядке и создания отчетов о состоянии чтения в любом порядке. То есть можно завершить копирование сообщений перед созданием отчетов состояние чтения или отправлять отчеты до внедрения запускает операцию копирования. Тем не менее, прочитайте направляются отчеты для всех сообщений скопировать, независимо от того, является ли копирование выполнено успешно.
  
При операции копирования или перемещения включает в себя более одного сообщения, как можно выполните операцию. Не останавливайте операции преждевременно Если произошла ошибка, которая находится за пределами элементу управления, такие как хватает памяти, недостаточно места на диске или повреждение в хранилище сообщений.
  
Попробуйте использовать идентификаторы записей в рамках операции копирования или перемещения. Также следует сохранить идентификаторы записей, несмотря на то, что он не является обязательным.
  
Отправка уведомлений, если перемещение или копирование сообщений, чтобы клиенты являются forewarned, что их вызовы методов [IMAPIProp::SaveChanges](imapiprop-savechanges.md) эти сообщения могут завершиться с ошибкой. 
  
Не включать состояния сообщения или операции перемещения. Перемещение и копирование состояния сообщения существенно влияет на производительность.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Используйте **IMAPIFolder::CopyMessages** для заполнения папки результатов поиска, где сообщения часто сгруппированные по родительской папки. 
  
Ожидается, что эти возвращаемые значения в следующих случаях.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**IMAPIFolder::CopyMessages** успешно после копирования или перемещения каждого сообщения.  <br/> |S_OK  <br/> |
|**IMAPIFolder::CopyMessages** не удалось успешно скопируйте или переместите каждого сообщения.  <br/> |MAPI_W_PARTIAL_COMPLETION  <br/> |
|**IMAPIFolder::CopyMessages** не удалось завершить.  <br/> |Любое значение ошибки  <br/> |
   
При **IMAPIFolder::CopyMessages** не удается завершить, не предполагают, что работа не выполнена. **IMAPIFolder::CopyMessages** мог для копирования или перемещения одного или нескольких сообщений перед ошибок. 
  
## <a name="see-also"></a>См. также



[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


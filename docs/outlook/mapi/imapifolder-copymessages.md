---
title: имапифолдеркопимессажес
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CopyMessages
api_type:
- COM
ms.assetid: 4c7d2110-3fcb-4b9f-bf20-1dc1a611161d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 21aa28e1a2c11ee7361fb4921f8d527b3e3ceb44
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424457"
---
# <a name="imapifoldercopymessages"></a>IMAPIFolder::CopyMessages

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Копирует или перемещает одно или несколько сообщений.
  
```cpp
HRESULT CopyMessages(
  LPENTRYLIST lpMsgList,
  LPCIID lpInterface,
  LPVOID lpDestFolder,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _лпмсглист_
  
> возврата Указатель на массив структур [ентрилист](entrylist.md) , идентифицирующий сообщение или сообщения, которые необходимо скопировать или переместить. 
    
 _лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к папке назначения, на которую указывает параметр _лпдестфолдер_ . При передаче значения NULL поставщику услуг возвращается интерфейс стандартных папок, [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md). Клиенты должны передавать значение NULL. Другие абоненты могут задать для параметра _лпинтерфаце_ значение IID_IUnknown, IID_IMAPIProp, IID_IMAPIContainer или IID_IMAPIFolder. 
    
 _лпдестфолдер_
  
> возврата Указатель на открытую папку для получения скопированных или перемещенных сообщений.
    
 _улуипарам_
  
> возврата Дескриптор родительского окна любых диалоговых окон или окон, которые отображает этот метод. Параметр _улуипарам_ игнорируется, если клиент не устанавливает флаг MESSAGE_DIALOG в параметре _ulFlags_ и передает значение NULL в параметр _лппрогресс_ . 
    
 _лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_передается значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации объекта Progress для MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг MESSAGE_DIALOG в _ulFlags_.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих, как выполняется операция копирования или перемещения. Можно задать следующие флаги:
    
MAPI_DECLINE_OK 
  
> Информирует поставщика хранилища сообщений о немедленном возврате MAPI_E_DECLINE_COPY, если он реализует метод **IMAPIFolder:: копимессажес** , вызывая метод [Имаписуппорт::D окопито](imapisupport-docopyto.md) или [имаписуппорт::D окопипропс](imapisupport-docopyprops.md) . 
    
MESSAGE_DIALOG 
  
> Отображает индикатор хода выполнения операции.
    
MESSAGE_MOVE 
  
> Вместо копирования необходимо переместить сообщение или сообщения. Если MESSAGE_MOVE не заданы, сообщения копируются.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщение или сообщения были успешно скопированы или перемещены.
    
MAPI_E_DECLINE_COPY 
  
> Поставщик реализует этот метод, вызывая метод объекта поддержки, и вызывающий абонент передал флаг MAPI_DECLINE_OK.
    
MAPI_W_PARTIAL_COMPLETION 
  
> Вызов выполнен успешно, но не все записи были успешно скопированы или перемещены. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **HR_FAILED** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder:: копимессажес** копирует или перемещает сообщения в другую папку. 
  
Сообщения, открытые с разрешением на чтение и запись, можно перемещать или копировать. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если вы копируете сообщения в другое хранилище сообщений, не используя метод [имаписуппорт:: копимессажес](imapisupport-copymessages.md) , сначала необходимо вызвать [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md) с установленным флагом GENERATE_RECEIPT_ONLY. Принимающее хранилище сообщений не несет ответственности за создание отчетов о прочтении для скопированных или перемещенных сообщений. При вызове **имаписуппорт:: копимессажес** для реализации **IMAPIFolder:: копимессажес**, не вызывайте **сетреадфлагс**; Интерфейс MAPI выполнит его вызов. 
  
Ваша реализация может перемещать или копировать сообщения в любом порядке и создавать отчеты о состоянии чтения в любом порядке. То есть вы можете завершить копирование сообщений до создания любого из отчетов о состоянии чтения или отправить отчеты до того, как ваша реализация начнет операцию копирования. Тем не менее, необходимо отправить отчеты о прочтении для всех сообщений, которые будут скопированы, независимо от того, успешно ли выполнено копирование.
  
Если операция копирования или перемещения содержит более одного сообщения, выполните операцию как можно скорее. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений.
  
Постарайтесь поддерживать идентификаторы записей в операциях перемещения или копирования. Кроме того, необходимо сохранить идентификаторы записей, хотя это необязательно.
  
Отправлять уведомления при перемещении или копировании сообщений, чтобы клиенты фореварнед, что их вызовы к сообщениям " [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) " могут привести к сбою. 
  
Не включайте состояние сообщения в операцию копирования или перемещения. Перемещение или копирование состояния сообщения существенно влияет на производительность.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Используйте **IMAPIFolder:: копимессажес** для заполнения папок результатов поиска, где сообщения часто группируются по родительской папке. 
  
Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**IMAPIFolder:: копимессажес** успешно копирует или перемещает каждое сообщение.  <br/> |S_OK  <br/> |
|**IMAPIFolder:: копимессажес** не удалось успешно скопировать или переместить каждое сообщение.  <br/> |MAPI_W_PARTIAL_COMPLETION  <br/> |
|**IMAPIFolder:: копимессажес** не удалось выполнить.  <br/> |Любое значение ошибки  <br/> |
   
Когда **IMAPIFolder:: копимессажес** не удается выполнить, не следует предполагать, что работа не выполнялась. **IMAPIFolder:: копимессажес** могли скопировать или переместить одно или несколько сообщений, прежде чем возникнет ошибка. 
  
## <a name="see-also"></a>См. также



[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


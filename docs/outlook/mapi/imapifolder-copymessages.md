---
title: Имапифолдеркопимессажес
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.CopyMessages
api_type:
- COM
ms.assetid: 4c7d2110-3fcb-4b9f-bf20-1dc1a611161d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 21aa28e1a2c11ee7361fb4921f8d527b3e3ceb44
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32280129"
---
# <a name="imapifoldercopymessages"></a>IMAPIFolder::CopyMessages

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Копирует или перемещает одно или несколько сообщений.
  
```cpp
HRESULT CopyMessages(
  LPENTRYLIST lpMsgList,
  LPCIID lpInterface,
  LPVOID lpDestFolder,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпмсглист_
  
> возврата Указатель на массив структур [ентрилист](entrylist.md) , идентифицирующий сообщение или сообщения, которые необходимо скопировать или переместить. 
    
 _Лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к папке назначения, на которую указывает параметр _лпдестфолдер_ . При передаче значения NULL поставщику услуг возвращается интерфейс стандартных папок, [IMAPIFolder: IMAPIContainer](imapifolderimapicontainer.md). Клиенты должны передавать значение NULL. Другие абоненты могут задать для параметра _лпинтерфаце_ значение Иид_иункновн, Иид_имапипроп, Иид_имапиконтаинер или иид_имапифолдер. 
    
 _Лпдестфолдер_
  
> возврата Указатель на открытую папку для получения скопированных или перемещенных сообщений.
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна любых диалоговых окон или окон, которые отображает этот метод. Параметр _улуипарам_ игнорируется, если клиент не устанавливает флаг мессаже_диалог в параметре _ulFlags_ и не передает значение NULL в параметре _лппрогресс_ . 
    
 _Лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_переДАЕТСЯ значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации объекта Progress для MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг Мессаже_диалог в _ulFlags_.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих, как выполняется операция копирования или перемещения. Можно задать следующие флаги:
    
МАПИ_ДЕКЛИНЕ_ОК 
  
> Информирует поставщика хранилища сообщений о том, что он немедленно возвращает МАПИ_Е_ДЕКЛИНЕ_КОПИ, если он реализует **IMAPIFolder:: копимессажес** , вызывая метод [Имаписуппорт::D окопито](imapisupport-docopyto.md) или [имаписуппорт::D окопипропс](imapisupport-docopyprops.md) . 
    
МЕССАЖЕ_ДИАЛОГ 
  
> Отображает индикатор хода выполнения операции.
    
МЕССАЖЕ_МОВЕ 
  
> Вместо копирования необходимо переместить сообщение или сообщения. Если МЕССАЖЕ_МОВЕ не задано, сообщения копируются.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сообщение или сообщения были успешно скопированы или перемещены.
    
МАПИ_Е_ДЕКЛИНЕ_КОПИ 
  
> Поставщик реализует этот метод, вызывая метод объекта support, и вызывающий абонент передал флаг МАПИ_ДЕКЛИНЕ_ОК.
    
МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН 
  
> Вызов выполнен успешно, но не все записи были успешно скопированы или перемещены. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Замечания

Метод **IMAPIFolder:: копимессажес** копирует или перемещает сообщения в другую папку. 
  
Сообщения, открытые с разрешением на чтение и запись, можно перемещать или копировать. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если вы копируете сообщения в другое хранилище сообщений, не используя метод [имаписуппорт:: копимессажес](imapisupport-copymessages.md) , сначала необходимо вызвать [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md) с установленным флагом женерате_рецеипт_онли. Принимающее хранилище сообщений не несет ответственности за создание отчетов о прочтении для скопированных или перемещенных сообщений. При вызове **имаписуппорт:: копимессажес** для реализации **IMAPIFolder:: копимессажес**, не вызывайте **сетреадфлагс**; ИНТЕРФЕЙС MAPI выполнит его вызов. 
  
Ваша реализация может перемещать или копировать сообщения в любом порядке и создавать отчеты о состоянии чтения в любом порядке. То есть вы можете завершить копирование сообщений до создания любого из отчетов о состоянии чтения или отправить отчеты до того, как ваша реализация начнет операцию копирования. Тем не менее, необходимо отправить отчеты о прочтении для всех сообщений, которые будут скопированы, независимо от того, успешно ли выполнено копирование.
  
Если операция копирования или перемещения содержит более одного сообщения, выполните операцию как можно скорее. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений.
  
ПоСтарайтесь поддерживать идентификаторы записей в операциях перемещения или копирования. Кроме того, необходимо сохранить идентификаторы записей, хотя это необязательно.
  
Отправлять уведомления при перемещении или копировании сообщений, чтобы клиенты фореварнед, что их вызовы к сообщениям " [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) " могут привести к сбою. 
  
Не включайте состояние сообщения в операцию копирования или перемещения. Перемещение или копирование состояния сообщения существенно влияет на производительность.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Используйте **IMAPIFolder:: копимессажес** для заполнения папок результатов поиска, где сообщения часто группируются по родительской папке. 
  
Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Condition**|**Возвращаемое значение**|
|:-----|:-----|
|**IMAPIFolder:: копимессажес** успешно копирует или перемещает каждое сообщение.  <br/> |S_OK  <br/> |
|**IMAPIFolder:: копимессажес** не удалось успешно скопировать или переместить каждое сообщение.  <br/> |МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН  <br/> |
|**IMAPIFolder:: копимессажес** не удалось выполнить.  <br/> |Любое значение ошибки  <br/> |
   
Когда **IMAPIFolder:: копимессажес** не удается выполнить, не следует предполагать, что работа не выполнялась. **IMAPIFolder:: копимессажес** могли скопировать или переместить одно или несколько сообщений, прежде чем возникнет ошибка. 
  
## <a name="see-also"></a>См. также



[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


---
title: иаддрбукопенентри
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IAddrBook.OpenEntry
api_type:
- COM
ms.assetid: bd7746f4-8070-4cc5-8b8e-c527c5847545
description: 'Дата последнего изменения: 1 февраля 2013 г.'
ms.openlocfilehash: 293fe5a65c760f61ab0073e0eafc1a606c69050f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434167"
---
# <a name="iaddrbookopenentry"></a>IAddrBook::OpenEntry

**Относится к**: Outlook 2013 | Outlook 2016 
  
Открывает запись адресной книги и возвращает указатель на интерфейс, который можно использовать для доступа к записи.
  
```cpp
HRESULT OpenEntry(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  LPCIID lpInterface,
  ULONG ulFlags,
  ULONG FAR * lpulObjType,
  LPUNKNOWN FAR * lppUnk
);
```

## <a name="parameters"></a>Параметры

_кбентрид_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
_лпентрид_
  
> возврата Указатель на идентификатор записи, представляющий запись адресной книги, которую требуется открыть.
    
_лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID) интерфейса, который будет использоваться для доступа к открытой записи. При передаче значения NULL возвращается стандартный интерфейс объекта. Для пользователей обмена сообщениями стандартный интерфейс — [имаилусер: IMAPIProp](imailuserimapiprop.md). Для списков рассылки это [идистлист: IMAPIContainer](idistlistimapicontainer.md) и для контейнеров, [иабконтаинер: IMAPIContainer](iabcontainerimapicontainer.md). Вызывающие абоненты могут установить _лпинтерфаце_ в соответствии со стандартным интерфейсом или интерфейсом в иерархии наследования. 
    
_ulFlags_
  
> возврата Битовая маска флагов, определяющих способ открытия записи. Можно задать следующие флаги.
    
MAPI_BEST_ACCESS 
  
> Запрашивает открытие записи с максимальным количеством разрешенных сетевых и клиентских разрешений. Например, если у клиента есть разрешение на чтение и запись, поставщик адресной книги должен попытаться открыть запись с разрешениями на чтение и запись. Клиент может получить уровень доступа, предоставленный, вызвав метод [IMAPIProp::-PROPS](imapiprop-getprops.md) открытой записи и извлекая свойство **PR_ACCESS_LEVEL** ([PidTagAccessLevel](pidtagaccesslevel-canonical-property.md)).
    
MAPI_CACHE_ONLY
  
> Открывает запись адресной книги и обращается к ней только из кэша. Например, вы можете использовать этот флаг, чтобы разрешить клиентскому приложению открывать глобальный список адресов (GAL) в режиме кэширования Exchange и получать доступ к записи в этой адресной книге из кэша, не создавая трафик между клиентом и сервером. Этот флаг поддерживается только поставщиком адресной книги Exchange.
    
MAPI_DEFERRED_ERRORS 
  
> Разрешает успешный вызов, потенциально перед тем, как запись будет полностью открыта и доступна, подразумевая, что последующие вызовы записи могут возвращать ошибку.
    
MAPI_GAL_ONLY
  
> Для разрешения имен используйте только глобальный список адресов. Этот флаг поддерживается только поставщиком адресной книги Exchange.
    
  > [!NOTE]
  > MAPI_GAL_ONLY _ulFlags_ могут быть не определены в текущем загружаемом файле заголовков, в этом случае вы можете добавить его в код, используя следующее значение: >`#define MAPI_GAL_ONLY (0x00000080)`
  
MAPI_MODIFY 
  
> Запрашивает открытие записи с разрешением на чтение и запись. Так как записи открываются с доступом только для чтения по умолчанию, клиенты не должны предполагать, что разрешение на чтение и запись предоставлено независимо от того, задано ли MAPI_MODIFY.
    
MAPI_NO_CACHE
  
> Не используйте автономную адресную книгу для разрешения имен. Этот флаг поддерживается только поставщиком адресной книги Exchange.
    
_лпулобжтипе_
  
> вышли Указатель на тип открытого элемента.
    
_лппунк_
  
> вышли Указатель на указатель на открытую запись.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Запись успешно открыта.
    
MAPI_E_NO_ACCESS 
  
> Предпринята попытка открыть запись, для которой у пользователя недостаточно разрешений.
    
MAPI_E_NOT_FOUND 
  
> Запись, представленная _лпентрид_ , не существует. 
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Идентификатор записи, указанный в _лпентрид_ , не распознается. Это значение обычно возвращается, если поставщик адресных книг, ответственный за соответствующую запись, не открыт. 
    
## <a name="remarks"></a>Примечания

Клиенты и поставщики услуг вызывают метод **IAddrBook:: OpenEntry** для открытия записи адресной книги. MAPI перенаправляет вызов соответствующему поставщику адресной книги на основе структуры [мапиуид](mapiuid.md) , включенной в идентификатор записи, переданный в параметре _лпентрид_ . Поставщик адресных книг открывает запись только для чтения, если не установлен флаг MAPI_MODIFY или MAPI_BEST_ACCESS в параметре _ulFlags_ . Тем не менее, эти флаги являются рекомендациями. Если у поставщика адресных книг нет разрешения на изменение запрошенной записи, возвращается MAPI_E_NO_ACCESS. 
  
Параметр _лпинтерфаце_ указывает интерфейс, который будет использоваться для доступа к открытой записи. При передаче значения NULL в _лпинтерфаце_ показывается использование стандартного интерфейса MAPI для этого типа записи. Так как поставщик адресных книг может возвращать другой интерфейс, отличный от предложенного параметром _лпинтерфаце_ , вызывающая сторона должна проверить значение, возвращенное в параметре _лпулобжтипе_ , чтобы определить, является ли возвращаемый тип объекта ожидаемым. Если тип объекта не является ожидаемым, вызывающий может привести параметр _лппунк_ к более подходящему типу. 
  
## <a name="see-also"></a>См. также

- [IAddrBook : IMAPIProp](iaddrbookimapiprop.md)


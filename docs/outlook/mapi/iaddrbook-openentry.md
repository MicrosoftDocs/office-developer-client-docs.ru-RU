---
title: IAddrBookOpenEntry
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IAddrBook.OpenEntry
api_type:
- COM
ms.assetid: bd7746f4-8070-4cc5-8b8e-c527c5847545
description: 'Последнее изменение: 01 февраля 2013 г.'
ms.openlocfilehash: 4d380f784094064232cdb7369080612ba9ccac0e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22576871"
---
# <a name="iaddrbookopenentry"></a>IAddrBook::OpenEntry

**Относится к**: Outlook 2013 | Outlook 2016 
  
Открывает запись книги и возвращает указатель на интерфейс, который можно использовать для доступа к операции.
  
```cpp
HRESULT OpenEntry(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  LPCIID lpInterface,
  ULONG ulFlags,
  ULONG FAR * lpulObjType,
  LPUNKNOWN FAR * lppUnk
);
```

## <a name="parameters"></a>Параметры

_cbEntryID_
  
> [in] Число байтов в идентификатор записи, на который указывает параметр _lpEntryID_ . 
    
_lpEntryID_
  
> [in] Указатель на идентификатор записи, который представляет записи адресной книги, чтобы открыть.
    
_lpInterface_
  
> [in] Указатель на интерфейс идентификатор (ИД интерфейса) интерфейс, который будет использоваться для доступа к открытой операцией. Передача NULL Возвращает стандартный интерфейс объекта. Для пользователей, обмена мгновенными сообщениями, — это стандартный интерфейс [IMailUser: IMAPIProp](imailuserimapiprop.md). Для списков рассылки — это [IDistList: IMAPIContainer](idistlistimapicontainer.md) и для контейнеров, это [IABContainer: IMAPIContainer](iabcontainerimapicontainer.md). Вызывающие объекты можно задать _lpInterface_ соответствующий стандартный интерфейс или интерфейс в иерархии наследования. 
    
_ulFlags_
  
> [in] Битовая маска флаги, который определяет, как открыть запись. Можно задать следующие флаги.
    
MAPI_BEST_ACCESS 
  
> Запросы, что операция открываются с максимальное допустимое разрешения сети и клиента. Например если клиент имеет разрешение на чтение и запись, поставщик адресной книги следует попытаться открыть запись с разрешением на чтение и запись. Можно получить уровень доступа, который был предоставлен путем вызова метода open запись [IMAPIProp::GetProps](imapiprop-getprops.md) и извлечение свойства **PR_ACCESS_LEVEL** ([PidTagAccessLevel](pidtagaccesslevel-canonical-property.md)).
    
MAPI_CACHE_ONLY
  
> Открывает запись книги и обращается к нему только из кэша. Например можно использовать этот флаг позволяет открыть глобальный список адресов (GAL) в режиме кэширования данных exchange и получить доступ к записи в этот список адресов из кэша без создания трафика между клиентом и сервером клиентского приложения. Этот флаг поддерживается только поставщик Exchange адресной книги.
    
MAPI_DEFERRED_ERRORS 
  
> Разрешает вызов для успешного выполнения, потенциально перед словом полностью open и доступны, подразумевает, что более поздние вызовов записи могут завершиться ошибкой.
    
MAPI_GAL_ONLY
  
> Для выполнения разрешения имен используйте только глобальный список адресов. Этот флаг поддерживается только поставщик Exchange адресной книги.
    
  > [!NOTE]
  > _UlFlags_ MAPI_GAL_ONLY не могут быть определены в файле загружаемых заголовка в настоящий момент, в этом случае можно добавить его в код с помощью следующее значение: >`#define MAPI_GAL_ONLY (0x00000080)`
  
MAPI_MODIFY 
  
> Запросы, которые словом открывать с разрешение чтения и записи. Поскольку записи открываются с доступом только для чтения по умолчанию, клиенты не следует предполагать, независимо от того, является ли MAPI_MODIFY имеет значение были предоставлены разрешения на чтение и запись.
    
MAPI_NO_CACHE
  
> Не используйте автономной адресной книги для разрешения имен. Этот флаг поддерживается только поставщик Exchange адресной книги.
    
_lpulObjType_
  
> [out] Указатель на тип открыт записи.
    
_lppUnk_
  
> [out] Указатель на указатель открыт записи.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Операция успешно открыт.
    
MAPI_E_NO_ACCESS 
  
> Предпринята попытка открыть запись, для которой пользователь имеет недостаточно разрешений.
    
MAPI_E_NOT_FOUND 
  
> Запись, представленного _lpEntryID_ не существует. 
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Идентификатор записи, указанной в _lpEntryID_ не распознается. Это значение возвращается как правило, если поставщик адресной книги, ответственный за запись не открыта. 
    
## <a name="remarks"></a>Замечания

Клиенты и поставщики услуг вызовите метод **IAddrBook::OpenEntry** для открытия записи адресной книги. MAPI перенаправляет вызов соответствующего доступа к адресной книге, на основе структуры [MAPIUID](mapiuid.md) , включенные в идентификатор записи, переданной в параметре _lpEntryID_ . Поставщик адресной книги открывает записи с доступом только для чтения, если не задан флаг MAPI_MODIFY или MAPI_BEST_ACCESS с помощью параметра _ulFlags_ . Тем не менее эти флаги, предложения. Если поставщик адресной книги не допускает изменения для записи в запросе, возвращается MAPI_E_NO_ACCESS. 
  
Параметр _lpInterface_ указывает интерфейс, который должен использоваться для доступа к открытой записи. Указать значение NULL для _lpInterface_ указывает, что следует использовать стандартный интерфейс MAPI для этого типа записи. Так как поставщик адресной книги может вернуть другой интерфейс, отличной от предложенных с помощью параметра _lpInterface_ , вызывающий объект должен проверить, значение, возвращенное в параметре _lpulObjType_ , чтобы определить, является ли тип объекта, возвращенного ожидаемым. Если тип объекта не типа, вызывающего можно привести параметр _lppUnk_ в тип, который является более корректно. 
  
## <a name="see-also"></a>См. также

- [IAddrBook : IMAPIProp](iaddrbookimapiprop.md)


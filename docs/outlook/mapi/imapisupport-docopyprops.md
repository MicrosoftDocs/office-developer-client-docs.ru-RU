---
title: Имаписуппортдокопипропс
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.DoCopyProps
api_type:
- COM
ms.assetid: 2446ef52-578a-4004-9719-de9b0207ccad
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 24107ae1926c8590da6a823a354eeae72d72f248
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32322367"
---
# <a name="imapisupportdocopyprops"></a>IMAPISupport::DoCopyProps

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Копирует или перемещает одно или несколько свойств объекта в другой объект.
  
```cpp
HRESULT DoCopyProps(
  LPCIID lpSrcInterface,
  LPVOID lpSrcObj,
  LPSPropTagArray lpIncludeProps,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  LPCIID lpDestInterface,
  LPVOID lpDestObj,
  ULONG ulFlags,
  LPSPropProblemArray FAR * lppProblems
);
```

## <a name="parameters"></a>Параметры

 _ЛпсрЦинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к объекту со свойствами, которые необходимо скопировать или переместить.
    
 _Лпсркобж_
  
> возврата Указатель на объект, содержащий свойства, которые необходимо скопировать или переместить.
    
 _Лпинклудепропс_
  
> возврата Указатель на структуру [спроптагаррай](sproptagarray.md) , которая содержит считанный массив тегов свойств, указывающий свойства для копирования или перемещения. Параметр _лпинклудепропс_ не может иметь значение null. 
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения.
    
 _Лппрогресс_
  
> возврата Указатель на реализацию индикатора хода выполнения. Если в параметре _лппрогресс_ переДАЕТСЯ значение null, индикатор хода выполнения отображается с помощью реализации MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг мапи_диалог в параметре _ulFlags_ . 
    
 _Лпдестинтерфаце_
  
> возврата Указатель на идентификатор интерфейса, представляющий интерфейс, который будет использоваться для доступа к объекту для получения копируемых или перемещенных свойств.
    
 _Лпдестобж_
  
> возврата Указатель на объект, который будет получать скопированные или перемещенные свойства.
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют выполнением операции копирования или перемещения. Можно задать следующие флаги:
    
МАПИ_ДИАЛОГ 
  
> Отображает индикатор хода выполнения.
    
МАПИ_МОВЕ 
  
> **Докопипропс** должен выполнять операцию перемещения, а не операцию копирования. Если этот флаг не задан, **докопипропс** выполняет операцию копирования. 
    
МАПИ_НОРЕПЛАЦЕ 
  
> Существующие свойства в целевом объекте не должны быть перезаписаны. Если этот флаг не задан, **докопипропс** перезаписывает существующие свойства. 
    
 _Лпппроблемс_
  
> [вход, выход] На входе указатель на указатель на структуру [спроппроблемаррай](spropproblemarray.md) ; в противном случае — значение NULL, которое указывает на отсутствие необходимости в сведениях об ошибке. Если _лпппроблемс_ является допустимым указателем на входе, **докопипропс** возвращает подробные сведения об ошибках при копировании одного или нескольких свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Свойства были успешно скопированы или перемещены.
    
МАПИ_Е_КОЛЛИСИОН 
  
> Свойство, которое необходимо скопировать или переместить, уже существует в целевом объекте, а также установлен флаг МАПИ_НОРЕПЛАЦЕ. 
    
МАПИ_Е_ФОЛДЕР_ЦИКЛЕ 
  
> Исходный объект напрямую или косвенно содержит целевой объект. Прежде чем было обнаружено это условие, можно выполнить значительную работу, чтобы исходный и конечный объекты могли быть изменены частично. 
    
МАПИ_Е_ИНТЕРФАЦЕ_НОТ_СУППОРТЕД 
  
> Интерфейс, определенный параметром _лпсрЦинтерфаце_ , не поддерживается исходным объектом, или интерфейс, определенный параметром _лпдестинтерфаце_ , не поддерживается целевым объектом. 
    
МАПИ_Е_НО_АКЦЕСС 
  
> Предпринята попытка получить доступ к объекту, для которого вызывающая сторона не имеет достаточных разрешений. Эта ошибка возвращается, если целевой объект совпадает с исходным объектом.
    
Следующие значения могут возвращаться в структуре **спроппроблемаррай** , но не в качестве возвращаемых значений для **докопипропс**. Эти ошибки относятся к одному свойству.
  
МАПИ_Е_БАД_ЧАРВИДС 
  
> Установлен либо флаг МАПИ_УНИКОДЕ, либо **докопипропс** не поддерживает Юникод, или мапи_уникоде не задано и **Докопипропс** поддерживает только Юникод. 
    
МАПИ_Е_КОМПУТЕД 
  
> Абонент не может изменить свойство, так как оно является свойством только для чтения, которое вычисляется владельцем целевого объекта. Эта ошибка не серьезна; вызывающая сторона должна разрешить продолжение операции копирования.
    
МАПИ_Е_ИНВАЛИД_ТИПЕ 
  
> Недопустимый тип свойства.
    
МАПИ_Е_УНЕКСПЕКТЕД_ТИПЕ 
  
> Тип свойства не является типом, ожидаемым вызывающим абонентом.
    
## <a name="remarks"></a>Замечания

Метод **имаписуппорт::D окопипропс** реализован для объектов поддержки поставщика хранилища сообщений. Поставщики хранилища сообщений могут вызывать **докопипропс** для реализации метода [IMAPIProp:: копипропс](imapiprop-copyprops.md) для своих папок и сообщений. **Докопипропс** копирует или перемещает свойства, указанные в массиве тегов свойств, на который указывает _лпинклудепропс_ , и присутствуют в объекте, на который указывает _лпсркобж_. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При копировании свойств между объектами одного типа, например двумя сообщениями, параметры _лпсрЦинтерфаце_ и _лпдестинтерфаце_ должны содержать один и тот же идентификатор интерфейса, а параметры _лпсркобж_ и _лпдестобж_ должен направляться на объекты того же типа. Если для _лпдестинтерфаце_ ЗАДАНО значение null, **докопипропс** возвращает мапи_е_инвалид_параметер. Если для _лпдестинтерфаце_ задан допустимый идентификатор интерфейса, но для параметра _лпдестобж_ задан недопустимый указатель, результаты будут непредсказуемыми. Вероятнее всего, ваш поставщик завершится с ошибками. 
  
Установите флаг МАПИ_НОРЕПЛАЦЕ, если не требуется перезаписывать свойства конечного объекта. Свойства в целевом объекте, которые существуют в исходном объекте и не перезаписываются, не удаляются и не изменяются.
  
Чтобы скопировать список получателей сообщения, включите свойство **пр_мессаже_реЦипиентс** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) в массив тегов свойств, на который указывает параметр _лпинклудепропс_ . Чтобы скопировать вложения сообщения, включите свойство **пр_мессаже_аттачментс** ([PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)). 
  
Чтобы скопировать папку или таблицу иерархии контейнера или адресной книги, включите **пр_контаинер_хиерарчи** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) или **пр_контаинер_контентс** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)) в массив тегов свойств. Чтобы включить таблицу с содержимым, связанным с папкой, включите в массив свойство **пр_фолдер_ассоЦиатед_контентс** ([PidTagFolderAssociatedContents](pidtagfolderassociatedcontents-canonical-property.md)).
  
Если подпапки копируются или перемещаются, их содержимое копируется или перемещается целиком, независимо от использования свойств, указанных в структуре **спроптагаррай** . 
  
 **Докопипропс** сообщает о глобальных ошибках, возникающих при выполнении операции, и отдельных ошибках, происходящих с одним или несколькими свойствами. Эти отдельные ошибки помещаются в структуру **спроппроблемаррай** . Вы можете отключить отчеты об ошибках на уровне свойств, передав значение NULL, а не действительный указатель для параметра структуры массива проблем свойств. 
  
Если вы хотите получать сведения об ошибках, передайте допустимый указатель структуры **спроппроблемаррай** в параметр _лпппроблемс_ . Когда **докопипропс** ВОЗВРАЩАЕТ значение S_OK, проверьте возможные ошибки с отдельными свойствами в структуре. Когда **докопипропс** возвращает ошибку, в структуре **спроппроблемаррай** не возвращается никакой информации. Вместо этого вызовите метод [имаписуппорт:: GetLastError](imapisupport-getlasterror.md) , чтобы получить подробные сведения об ошибке. 
  
Если **докопипропс** ВОЗВРАЩАЕТ значение S_OK, то освободите возвращаемую структуру **спроппроблемаррай** , вызвав функцию [мапифрибуффер](mapifreebuffer.md) . 
  
## <a name="see-also"></a>См. также



[IMAPIProp::CopyProps](imapiprop-copyprops.md)
  
[IMAPISupport::CopyMessages](imapisupport-copymessages.md)
  
[IMAPISupport::DoCopyTo](imapisupport-docopyto.md)
  
[IMAPISupport::GetLastError](imapisupport-getlasterror.md)
  
[Каноническое свойство PidTagContainerContents](pidtagcontainercontents-canonical-property.md)
  
[Каноническое свойство PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)
  
[Каноническое свойство PidTagFolderAssociatedContents](pidtagfolderassociatedcontents-canonical-property.md)
  
[Каноническое свойство PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)
  
[Каноническое свойство PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)
  
[SPropProblemArray](spropproblemarray.md)
  
[SPropTagArray](sproptagarray.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


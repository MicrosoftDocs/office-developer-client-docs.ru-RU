---
title: имаписуппортдокопипропс
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.DoCopyProps
api_type:
- COM
ms.assetid: 2446ef52-578a-4004-9719-de9b0207ccad
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 24107ae1926c8590da6a823a354eeae72d72f248
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405585"
---
# <a name="imapisupportdocopyprops"></a>IMAPISupport::DoCopyProps

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Копирует или перемещает одно или несколько свойств объекта в другой объект.
  
```cpp
HRESULT DoCopyProps(
  LPCIID lpSrcInterface,
  LPVOID lpSrcObj,
  LPSPropTagArray lpIncludeProps,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  LPCIID lpDestInterface,
  LPVOID lpDestObj,
  ULONG ulFlags,
  LPSPropProblemArray FAR * lppProblems
);
```

## <a name="parameters"></a>Параметры

 _лпсрЦинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к объекту со свойствами, которые необходимо скопировать или переместить.
    
 _лпсркобж_
  
> возврата Указатель на объект, содержащий свойства, которые необходимо скопировать или переместить.
    
 _лпинклудепропс_
  
> возврата Указатель на структуру [спроптагаррай](sproptagarray.md) , которая содержит считанный массив тегов свойств, указывающий свойства для копирования или перемещения. Параметр _лпинклудепропс_ не может иметь значение null. 
    
 _улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения.
    
 _лппрогресс_
  
> возврата Указатель на реализацию индикатора хода выполнения. Если в параметре _лппрогресс_ передается значение null, индикатор хода выполнения отображается с помощью реализации MAPI. Параметр _лппрогресс_ игнорируется, если в параметре _ulFlags_ не задан флаг MAPI_DIALOG. 
    
 _лпдестинтерфаце_
  
> возврата Указатель на идентификатор интерфейса, представляющий интерфейс, который будет использоваться для доступа к объекту для получения копируемых или перемещенных свойств.
    
 _лпдестобж_
  
> возврата Указатель на объект, который будет получать скопированные или перемещенные свойства.
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют выполнением операции копирования или перемещения. Можно задать следующие флаги:
    
MAPI_DIALOG 
  
> Отображает индикатор хода выполнения.
    
MAPI_MOVE 
  
> **Докопипропс** должен выполнять операцию перемещения, а не операцию копирования. Если этот флаг не задан, **докопипропс** выполняет операцию копирования. 
    
MAPI_NOREPLACE 
  
> Существующие свойства в целевом объекте не должны быть перезаписаны. Если этот флаг не задан, **докопипропс** перезаписывает существующие свойства. 
    
 _лпппроблемс_
  
> [вход, выход] На входе указатель на указатель на структуру [спроппроблемаррай](spropproblemarray.md) ; в противном случае — значение NULL, которое указывает на отсутствие необходимости в сведениях об ошибке. Если _лпппроблемс_ является допустимым указателем на входе, **докопипропс** возвращает подробные сведения об ошибках при копировании одного или нескольких свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Свойства были успешно скопированы или перемещены.
    
MAPI_E_COLLISION 
  
> Свойство, которое необходимо скопировать или переместить, уже существует в целевом объекте, а флаг MAPI_NOREPLACE установлен. 
    
MAPI_E_FOLDER_CYCLE 
  
> Исходный объект напрямую или косвенно содержит целевой объект. Прежде чем было обнаружено это условие, можно выполнить значительную работу, чтобы исходный и конечный объекты могли быть изменены частично. 
    
MAPI_E_INTERFACE_NOT_SUPPORTED 
  
> Интерфейс, определенный параметром _лпсрЦинтерфаце_ , не поддерживается исходным объектом, или интерфейс, определенный параметром _лпдестинтерфаце_ , не поддерживается целевым объектом. 
    
MAPI_E_NO_ACCESS 
  
> Предпринята попытка получить доступ к объекту, для которого вызывающая сторона не имеет достаточных разрешений. Эта ошибка возвращается, если целевой объект совпадает с исходным объектом.
    
Следующие значения могут возвращаться в структуре **спроппроблемаррай** , но не в качестве возвращаемых значений для **докопипропс**. Эти ошибки относятся к одному свойству.
  
MAPI_E_BAD_CHARWIDTH 
  
> Установлен установленный флаг MAPI_UNICODE и **докопипропс** не поддерживает Юникод, или MAPI_UNICODE не задан и **Докопипропс** поддерживает только Юникод. 
    
MAPI_E_COMPUTED 
  
> Абонент не может изменить свойство, так как оно является свойством только для чтения, которое вычисляется владельцем целевого объекта. Эта ошибка не серьезна; вызывающая сторона должна разрешить продолжение операции копирования.
    
MAPI_E_INVALID_TYPE 
  
> Недопустимый тип свойства.
    
MAPI_E_UNEXPECTED_TYPE 
  
> Тип свойства не является типом, ожидаемым вызывающим абонентом.
    
## <a name="remarks"></a>Примечания

Метод **имаписуппорт::D окопипропс** реализован для объектов поддержки поставщика хранилища сообщений. Поставщики хранилища сообщений могут вызывать **докопипропс** для реализации метода [IMAPIProp:: копипропс](imapiprop-copyprops.md) для своих папок и сообщений. **Докопипропс** копирует или перемещает свойства, указанные в массиве тегов свойств, на который указывает _лпинклудепропс_ , и присутствуют в объекте, на который указывает _лпсркобж_. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При копировании свойств между объектами одного типа, например двумя сообщениями, параметры _лпсрЦинтерфаце_ и _лпдестинтерфаце_ должны содержать один и тот же идентификатор интерфейса, а параметры _лпсркобж_ и _лпдестобж_ должны указать на объекты того же типа. Если для _лпдестинтерфаце_ ЗАДАНО значение null, **докопипропс** возвращает MAPI_E_INVALID_PARAMETER. Если для _лпдестинтерфаце_ задан допустимый идентификатор интерфейса, но для параметра _лпдестобж_ задан недопустимый указатель, результаты будут непредсказуемыми. Вероятнее всего, ваш поставщик завершится с ошибками. 
  
Установите флаг MAPI_NOREPLACE, если вы не хотите перезаписывать свойства конечного объекта. Свойства в целевом объекте, которые существуют в исходном объекте и не перезаписываются, не удаляются и не изменяются.
  
Чтобы скопировать список получателей сообщения, включите свойство **PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) в массив тегов свойств, на который указывает параметр _лпинклудепропс_ . Чтобы скопировать вложения сообщения, включите свойство **PR_MESSAGE_ATTACHMENTS** ([PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)). 
  
Чтобы скопировать иерархию или таблицу контента контейнера или адресной книги, укажите **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) или **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)) в массиве тегов свойств. Чтобы включить таблицу с содержимым, связанным с папкой, включите в массив свойство **PR_FOLDER_ASSOCIATED_CONTENTS** ([PidTagFolderAssociatedContents](pidtagfolderassociatedcontents-canonical-property.md)).
  
Если подпапки копируются или перемещаются, их содержимое копируется или перемещается целиком, независимо от использования свойств, указанных в структуре **спроптагаррай** . 
  
 **Докопипропс** сообщает о глобальных ошибках, возникающих при выполнении операции, и отдельных ошибках, происходящих с одним или несколькими свойствами. Эти отдельные ошибки помещаются в структуру **спроппроблемаррай** . Вы можете отключить отчеты об ошибках на уровне свойств, передав значение NULL, а не действительный указатель для параметра структуры массива проблем свойств. 
  
Если вы хотите получать сведения об ошибках, передайте допустимый указатель структуры **спроппроблемаррай** в параметр _лпппроблемс_ . Когда **докопипропс** возвращает S_OK, проверьте возможные ошибки с отдельными свойствами в структуре. Когда **докопипропс** возвращает ошибку, в структуре **спроппроблемаррай** не возвращается никакой информации. Вместо этого вызовите метод [имаписуппорт:: GetLastError](imapisupport-getlasterror.md) , чтобы получить подробные сведения об ошибке. 
  
Если **докопипропс** возвращает S_OK, освободите возвращаемую структуру **спроппроблемаррай** , вызвав функцию [мапифрибуффер](mapifreebuffer.md) . 
  
## <a name="see-also"></a>См. также



[IMAPIProp::CopyProps](imapiprop-copyprops.md)
  
[IMAPISupport::CopyMessages](imapisupport-copymessages.md)
  
[IMAPISupport::DoCopyTo](imapisupport-docopyto.md)
  
[IMAPISupport::GetLastError](imapisupport-getlasterror.md)
  
[Каноническое свойство PidTagContainerContents](pidtagcontainercontents-canonical-property.md)
  
[Каноническое свойство PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)
  
[Каноническое свойство PidTagFolderAssociatedContents](pidtagfolderassociatedcontents-canonical-property.md)
  
[Каноническое свойство PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)
  
[Каноническое свойство PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)
  
[SPropProblemArray](spropproblemarray.md)
  
[SPropTagArray](sproptagarray.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


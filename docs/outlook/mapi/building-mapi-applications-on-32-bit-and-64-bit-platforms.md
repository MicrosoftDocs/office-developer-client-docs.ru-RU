---
title: Создание приложений MAPI на 32- и 64-разрядных платформах
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
api_type:
- COM
ms.assetid: d218ba2d-7a2e-4c33-a09b-a8c7e27f9726
description: 'Дата последнего изменения: 9 марта 2015 г.'
localization_priority: Priority
ms.openlocfilehash: 74f321d2c6c8b5159191d4dcdb62e0db21132435
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32326474"
---
# <a name="building-mapi-applications-on-32-bit-and-64-bit-platforms"></a><span data-ttu-id="2f6c1-103">Создание приложений MAPI на 32- и 64-разрядных платформах</span><span class="sxs-lookup"><span data-stu-id="2f6c1-103">Building MAPI applications on 32-bit and 64-bit platforms</span></span>

<span data-ttu-id="2f6c1-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2f6c1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2f6c1-105">В этой статье описаны действия, которые следует выполнять разработчикам MAPI, чтобы изменить и перестроить 32-разрядные приложения MAPI для запуска на 64-разрядных платформах и 64-разрядные приложения для запуска на 32-разрядных платформах.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-105">This topic describes the actions that MAPI developers should take to change and rebuild 32-bit MAPI applications to run on a 64-bit platform, and 64-bit applications to run on a 32-bit platform.</span></span> <span data-ttu-id="2f6c1-106">В этой статье 64-разрядная платформа — это компьютер с установленной 64-разрядной версией Microsoft Outlook и 64-разрядной версией Windows, а 32-разрядная платформа — компьютер с установленной 32-разрядной версией Outlook и 32- или 64-разрядной версией Windows.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-106">In this topic, a 64-bit platform is a computer installed with 64-bit Microsoft Outlook and 64-bit Windows, and a 32-bit platform is a computer installed with a 32-bit Outlook and 32-bit or 64-bit Windows.</span></span> 
  
## <a name="operating-system-and-office-support-for-64-bit-outlook"></a><span data-ttu-id="2f6c1-107">Поддержка, предоставляемая операционной системой и Office для 64-разрядного приложения Outlook</span><span class="sxs-lookup"><span data-stu-id="2f6c1-107">Operating system and Office support for 64-bit Outlook</span></span>

> [!NOTE]
> <span data-ttu-id="2f6c1-108">Термин "разрядность" указывает на различия между 32- и 64-разрядной архитектурой процессоров и соответствующую совместимость приложений.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-108">The term bitness refers to the distinction between 32-bit and 64-bit processor architectures and the associated compatibility of applications.</span></span> <span data-ttu-id="2f6c1-109">В этой статье термин "разрядность" используется для указания версии Windows, Microsoft Office, Outlook, или MAPI приложения, предназначенных для 32- и 64-разрядной архитектуры процессора компьютера и, возможно, других приложений, запускаемых на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-109">In this topic, bitness is used to qualify the version of Windows, Microsoft Office, Outlook, or a MAPI application built to suit a 32-bit or 64-bit processor architecture of a computer, and possibly other applications that run on that computer.</span></span> 
  
<span data-ttu-id="2f6c1-110">Начиная с Microsoft Office 2010, приложение Outlook доступно как в 32-разрядной, так и 64-разрядной версии.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-110">Starting in Microsoft Office 2010, Outlook is available as a 32-bit and a 64-bit application.</span></span> <span data-ttu-id="2f6c1-111">На одном компьютере разрядность Outlook зависит от разрядности операционной системы Windows (x86 или x64) и Microsoft Office, если набор Office уже установлен на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-111">On the same computer, the bitness of Outlook depends on the bitness of the Windows operating system (x86 or x64), and of Microsoft Office, if Office is already installed on that computer.</span></span> <span data-ttu-id="2f6c1-112">Ниже указаны некоторые факторы, на которые следует обратить внимание при выборе 32-разрядной или 64-разрядной версии Outlook:</span><span class="sxs-lookup"><span data-stu-id="2f6c1-112">The following are some of the factors that determine the feasibility of installing a 32-bit or a 64-bit version of Outlook:</span></span>
  
- <span data-ttu-id="2f6c1-p104">32-разрядную версию Office (и 32-разрядное приложение Outlook) можно установить на компьютер с 32-разрядной или 64-разрядной версией операционной системы Windows. 64-разрядную версию Office (и 64-разрядное приложение Outlook) можно установить только на компьютер с 64-разрядной операционной системой.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-p104">32-bit Office (and 32-bit Outlook) can be installed on a 32-bit or 64-bit version of the Windows operating system. 64-bit Office (and 64-bit Outlook) can be installed only on a 64-bit operating system.</span></span>
    
- <span data-ttu-id="2f6c1-115">По умолчанию при установке Office в 64-разрядной версии операционной системы Windows устанавливается 32-разрядная версия Office.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-115">The default installation of Office on a 64-bit version of the Windows operating system is 32-bit Office.</span></span>
    
- <span data-ttu-id="2f6c1-116">Разрядность установленной версии Outlook всегда совпадает с разрядностью Office, если набор Office установлен на том же компьютере.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-116">The bitness of an installed version of Outlook is always the same as the bitness of Office, if Office is installed on the same computer.</span></span> <span data-ttu-id="2f6c1-117">Другими словами, 32-разрядную версию Outlook нельзя установить на том же компьютере, на котором уже установлены 64-разрядные версии других приложений Office, например 64-разрядная версии Microsoft Word или 64-разрядная версия Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-117">In other words, a 32-bit version of Outlook cannot be installed on the same computer that already has 64-bit versions of other Office applications installed, such as 64-bit Microsoft Word or 64-bit Microsoft Excel.</span></span> <span data-ttu-id="2f6c1-118">Аналогичным образом, 64-разрядную версию Outlook нельзя установить на том же компьютере, на котором уже установлены 32-разрядные версии других приложений Office.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-118">Similarly, a 64-bit version of Outlook cannot be installed on the same computer that already has 32-bit versions of other Office applications installed.</span></span>
    
## <a name="preparing-mapi-applications-for-32-bit-and-64-bit-platforms"></a><span data-ttu-id="2f6c1-119">Подготовка приложений MAPI для 32- и 64-разрядных платформ</span><span class="sxs-lookup"><span data-stu-id="2f6c1-119">Preparing MAPI applications for 32-bit and 64-bit platforms</span></span>

<span data-ttu-id="2f6c1-120">Приложениями MAPI являются автономные приложения, такие как Microsoft Communicator и MFCMAPI, а также поставщики служб, такие как поставщики адресной книги, хранилища и транспорта.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-120">MAPI applications include standalone applications such as Microsoft Communicator and MFCMAPI, and service providers such as address book, store, and transport providers.</span></span> <span data-ttu-id="2f6c1-121">Чтобы вызовы методов и функций MAPI работали в приложении MAPI (за исключением одной функции Simple MAPI, MAPISendMail), разрядность приложения MAPI должна совпадать с разрядностью подсистемы MAPI на компьютере, на котором должно использоваться это приложение.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-121">For MAPI method and function calls to work in a MAPI application (with the exception of one Simple MAPI function, MAPISendMail), the bitness of the MAPI application must be the same as the bitness of the MAPI subsystem on the computer that the application is targeted to run on.</span></span> <span data-ttu-id="2f6c1-122">Разрядность подсистемы MAPI, в свою очередь, определяется разрядностью установленной версии Outlook и всегда совпадает с ней.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-122">The bitness of the MAPI subsystem, in turn, is determined by and always the same as the bitness of the installed version of Outlook.</span></span> <span data-ttu-id="2f6c1-123">В приведенной ниже таблице перечислены необходимые действия для подготовки запуска приложений MAPI на целевых компьютерах с Office и Windows разных разрядностей.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-123">The following table summarizes the necessary actions to prepare MAPI applications to run on targeted computers configured with Office and Windows of various bitness.</span></span>
  
|<span data-ttu-id="2f6c1-124">Разрядность версии приложения MAPI</span><span class="sxs-lookup"><span data-stu-id="2f6c1-124">Bitness of MAPI application</span></span>|<span data-ttu-id="2f6c1-125">Разрядность версии Outlook на целевом компьютере</span><span class="sxs-lookup"><span data-stu-id="2f6c1-125">Bitness of Outlook on targeted computer</span></span>|<span data-ttu-id="2f6c1-126">Разрядность версии Windows на целевом компьютере</span><span class="sxs-lookup"><span data-stu-id="2f6c1-126">Bitness of Windows on targeted computer</span></span>|<span data-ttu-id="2f6c1-127">Необходимое действие, позволяющее запустить приложение на целевом компьютере</span><span class="sxs-lookup"><span data-stu-id="2f6c1-127">Necessary action to enable application to run on targeted computer</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="2f6c1-128">32-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-128">32-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-129">32-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-129">32-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-130">32- или 64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-130">32-bit or 64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-131">Специальных действий не требуется.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-131">No specific action is necessary.</span></span>  <br/> |
|<span data-ttu-id="2f6c1-132">32-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-132">32-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-133">64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-133">64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-134">64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-134">64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-135">Перестройка приложения в виде 64-разрядной версии.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-135">Rebuild the application as a 64-bit application.</span></span> <span data-ttu-id="2f6c1-136">В противном случае все вызовы методов и функций MAPI (кроме **MAPISendMail**) завершатся сбоем.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-136">Otherwise, all MAPI method and function calls (except for **MAPISendMail**) will fail.</span></span>  <br/> |
|<span data-ttu-id="2f6c1-137">64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-137">64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-138">64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-138">64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-139">64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-139">64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-140">Специальных действий не требуется.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-140">No specific action is necessary.</span></span>  <br/> |
|<span data-ttu-id="2f6c1-141">64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-141">64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-142">32-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-142">32-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-143">32- или 64-разрядная</span><span class="sxs-lookup"><span data-stu-id="2f6c1-143">32-bit or 64-bit</span></span>  <br/> |<span data-ttu-id="2f6c1-144">Перестройка приложения в виде 32-разрядной версии.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-144">Rebuild the application as a 32-bit application.</span></span> <span data-ttu-id="2f6c1-145">В противном случае все вызовы методов и функций MAPI (кроме **MAPISendMail**) завершатся сбоем.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-145">Otherwise, all MAPI method and function calls (except for **MAPISendMail**) will fail.</span></span>  <br/> |
   
<span data-ttu-id="2f6c1-146">В разделах ниже каждый сценарий объясняется подробнее.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-146">The following sections further explain each scenario.</span></span> <span data-ttu-id="2f6c1-147">Дополнительные сведения о связывании и вызове функций MAPI для сценариев, требующих перестройки приложения MAPI, см. в статье [Ссылки на функции MAPI](how-to-link-to-mapi-functions.md)</span><span class="sxs-lookup"><span data-stu-id="2f6c1-147">For scenarios that require rebuilding the MAPI application, see [Link to MAPI Functions](how-to-link-to-mapi-functions.md) for additional information regarding linking to and calling MAPI functions.</span></span> 
  
### <a name="32-bit-mapi-application-and-32-bit-outlook"></a><span data-ttu-id="2f6c1-148">32-разрядное приложение MAPI и 32-разрядная версия Outlook</span><span class="sxs-lookup"><span data-stu-id="2f6c1-148">32-bit MAPI application and 32-bit Outlook</span></span>

<span data-ttu-id="2f6c1-149">Приложения MAPI, созданные для 32-разрядной подсистемы MAPI, доступной в 32-разрядных версиях Outlook, включая версии ранее Microsoft Outlook 2013, по-прежнему поддерживается на компьютерах с установленной 32-разрядной версией Outlook и 32- или 64-разрядной версией операционной системы Windows.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-149">MAPI applications compiled for a 32-bit MAPI subsystem that is available in 32-bit versions of Outlook, including those versions prior to Microsoft Outlook 2013, continue to be supported on computers installed with 32-bit Outlook and a 32-bit or 64-bit Windows operating system.</span></span> <span data-ttu-id="2f6c1-150">От разработчиков приложений не требуется специальных действий.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-150">There is no specific action necessary for the application developers.</span></span>
  
### <a name="32-bit-mapi-application-and-64-bit-outlook"></a><span data-ttu-id="2f6c1-151">32-разрядное приложение MAPI и 64-разрядная версия Outlook</span><span class="sxs-lookup"><span data-stu-id="2f6c1-151">32-bit MAPI application and 64-bit Outlook</span></span>

<span data-ttu-id="2f6c1-152">32-разрядные приложения MAPI не поддерживаются на компьютерах с установленной 64-разрядной версией Outlook и 64-разрядной версией Windows.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-152">32-bit MAPI applications are not supported to run on a computer installed with 64-bit Outlook and 64-bit Windows.</span></span> <span data-ttu-id="2f6c1-153">Разработчик приложения должен обновить и перестроить приложение в виде 64-разрядной версии для 64-разрядной платформы.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-153">The application developer must update and rebuild the application as a 64-bit application for the 64-bit platform.</span></span> <span data-ttu-id="2f6c1-154">Это связано с тем, что 32-разрядное приложение не может загрузить 64-разрядный файл Msmapi32.dll.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-154">This is because a 32-bit application cannot load a 64-bit Msmapi32.dll file.</span></span> <span data-ttu-id="2f6c1-155">Есть небольшое количество изменений в API, которые разработчикам приложений необходимо включить при создании кода, правильно работающего в 64-разрядной среде.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-155">There are a small number of API changes that application developers must incorporate to build their code successfully for a 64-bit environment.</span></span> <span data-ttu-id="2f6c1-156">Эти изменения добавлены в файлы заголовков MAPI для поддержки 64-разрядной платформы.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-156">MAPI header files have been updated with these changes to support the 64-bit platform.</span></span> <span data-ttu-id="2f6c1-157">Эти файлы заголовков можно скачать на странице [Outlook 2010: файлы заголовков MAPI](https://www.microsoft.com/downloads/details.aspx?FamilyID=f8d01fc8-f7b5-4228-baa3-817488a66db1).</span><span class="sxs-lookup"><span data-stu-id="2f6c1-157">You can download these header files at [Outlook 2010: MAPI Header Files](https://www.microsoft.com/downloads/details.aspx?FamilyID=f8d01fc8-f7b5-4228-baa3-817488a66db1).</span></span> <span data-ttu-id="2f6c1-158">Разработчики могут использовать этот набор файлов заголовков MAPI для создания как 32-разрядных, так и 64-разрядных приложений MAPI.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-158">Developers can use this same set of MAPI header files to build both 32-bit and 64-bit MAPI applications.</span></span>
  
### <a name="64-bit-mapi-application-and-64-bit-outlook"></a><span data-ttu-id="2f6c1-159">64-разрядное приложение MAPI и 64-разрядная версия Outlook</span><span class="sxs-lookup"><span data-stu-id="2f6c1-159">64-bit MAPI application and 64-bit Outlook</span></span>

<span data-ttu-id="2f6c1-160">64-разрядные приложения MAPI поддерживаются на компьютерах с установленной 64-разрядной версией Outlook и 64-разрядной версией Windows.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-160">64-bit MAPI applications are supported on computers installed with 64-bit Outlook and 64-bit Windows.</span></span> <span data-ttu-id="2f6c1-161">От разработчиков приложений не требуется специальных действий.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-161">There is no specific action necessary for the application developers.</span></span>
  
### <a name="64-bit-mapi-application-and-32-bit-outlook"></a><span data-ttu-id="2f6c1-162">64-разрядное приложение MAPI и 32-разрядная версия Outlook</span><span class="sxs-lookup"><span data-stu-id="2f6c1-162">64-bit MAPI application and 32-bit Outlook</span></span>

<span data-ttu-id="2f6c1-163">64-разрядные приложения MAPI не поддерживаются на компьютерах с установленной 32-разрядной версией Outlook и 32- или 64-разрядной версией Windows.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-163">64-bit MAPI applications are not supported to run on a computer installed with 32-bit Outlook and 32-bit or 64-bit Windows.</span></span> <span data-ttu-id="2f6c1-164">Разработчик приложения должен обновить и перестроить приложение в виде 32-разрядной версии для работы с 32-разрядным приложением Outlook.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-164">The application developer must update and rebuild the application as a 32-bit application to work with 32-bit Outlook.</span></span> <span data-ttu-id="2f6c1-165">Используйте обновленные файлы заголовков MAPI, которые можно скачать на странице [Outlook 2010: файлы заголовков MAPI](https://www.microsoft.com/downloads/details.aspx?FamilyID=f8d01fc8-f7b5-4228-baa3-817488a66db1).</span><span class="sxs-lookup"><span data-stu-id="2f6c1-165">Use the updated MAPI header files, which you can download at [Outlook 2010: MAPI Header Files](https://www.microsoft.com/downloads/details.aspx?FamilyID=f8d01fc8-f7b5-4228-baa3-817488a66db1).</span></span> <span data-ttu-id="2f6c1-166">Разработчики могут использовать этот набор файлов заголовков MAPI для создания как 32-разрядных, так и 64-разрядных приложений MAPI.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-166">Developers can use this same set of MAPI header files to build both 32-bit and 64-bit MAPI applications.</span></span>
  
### <a name="exception-mapisendmail"></a><span data-ttu-id="2f6c1-167">Исключение: MAPISendMail</span><span class="sxs-lookup"><span data-stu-id="2f6c1-167">Exception: MAPISendMail</span></span>

<span data-ttu-id="2f6c1-168">Обычно 32-разрядное приложение MAPI не должно запускаться на 64-разрядной платформе (64-разрядное приложение Outlook на 64-разрядной версии Windows) без предварительной перестройки в виде 64-разрядного приложения, и 64-разрядное приложение MAPI не должно запускаться на компьютере с установленной 32-разрядной версией Outlook и 32- или 64-разрядной версией Windows без предварительной перестройки в виде 32-разрядного приложения.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-168">In general, a 32-bit MAPI application must not run on a 64-bit platform (64-bit Outlook on 64-bit Windows) without first being rebuilt as a 64-bit application, and a 64-bit MAPI application must not run on a computer installed with 32-bit Outlook and 32-bit or 64-bit Windows without first being rebuilt as a 32-bit application.</span></span> <span data-ttu-id="2f6c1-169">На рисунке 1 показано диалоговое окно с оповещением, отображаемое при возникновении любого из этих сценариев.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-169">Figure 1 shows an alert dialog box that would be displayed if either of these scenarios occurs.</span></span>
  
<span data-ttu-id="2f6c1-170">**Рисунок 1. Сообщение об ошибке для большинства вызовов MAPI с различной разрядностью.**</span><span class="sxs-lookup"><span data-stu-id="2f6c1-170">**Figure 1. Error message for most cross-bitness MAPI calls.**</span></span>

<span data-ttu-id="2f6c1-171">![Сообщение об ошибке для большинства вызовов MAPI с различной разрядностью](media/738905fb-57ae-4af7-b54b-a1676c80d3c3.JPG "Сообщение об ошибке для большинства вызовов MAPI с различной разрядностью")</span><span class="sxs-lookup"><span data-stu-id="2f6c1-171">![Error message for most cross-bitness MAPI calls](media/738905fb-57ae-4af7-b54b-a1676c80d3c3.JPG "Error message for most cross-bitness MAPI calls")</span></span>
  
<span data-ttu-id="2f6c1-172">Однако одна функция (**MAPISendMail**) из всех элементов Simple MAPI и MAPI выполняется успешно в сценарии WOW64 (Windows-32-bit-on-Windows-64-bit) или WOW32 (Windows-64-bit-on-Windows-32-bit) и не приводит к появлению указанного выше оповещения.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-172">However, one function call among all Simple MAPI and MAPI elements, **MAPISendMail**, would succeed in a Windows-32-bit-on-Windows-64-bit (WOW64) or Windows-64-bit-on-Windows-32-bit (WOW32) scenario and would not result in the above alert.</span></span> <span data-ttu-id="2f6c1-173">Этот сценарий WOW64 относится только к Windows 7.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-173">This WOW64 scenario only applies to Windows 7.</span></span> 

<span data-ttu-id="2f6c1-174">На рисунке 2 показан сценарий WOW64, в котором 32-разрядное приложение MAPI вызывает функцию **MAPISendMail** на компьютере с установленной 64-разрядной версией Windows 7.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-174">Figure 2 shows a WOW64 scenario in which a 32-bit MAPI application calls **MAPISendMail** on a computer installed with 64-bit Windows 7.</span></span> <span data-ttu-id="2f6c1-175">В этом сценарии библиотека MAPI осуществляет вызов COM, чтобы запустить 64-разрядное приложение Fixmapi.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-175">In this scenario, the MAPI library makes a COM call to launch a 64-bit Fixmapi application.</span></span> <span data-ttu-id="2f6c1-176">Приложение Fixmapi неявно связывается с библиотекой MAPI, направляющей вызов функции в заглушку Windows MAPI, которая, в свою очередь, направляет вызов в заглушку Outlook MAPI, позволяя успешно выполнить вызов функции **MAPISendMail**.</span><span class="sxs-lookup"><span data-stu-id="2f6c1-176">The Fixmapi application implicitly links to the MAPI library, which routes the function call to the Windows MAPI stub, which in turn forwards the call to the Outlook MAPI stub, enabling the **MAPISendMail** function call to succeed.</span></span> 
  
<span data-ttu-id="2f6c1-177">**Рисунок 2. Обработка MAPISendMail в сценарии WOW64.**</span><span class="sxs-lookup"><span data-stu-id="2f6c1-177">**Figure 2. Processing MAPISendMail in a WOW64 scenario.**</span></span>

<span data-ttu-id="2f6c1-178">![Обработка MAPISendMail в сценарии WOW64](media/346ba974-4844-4b64-9dd1-d0f829ab99b3.gif "Обработка MAPISendMail в сценарии WOW64")</span><span class="sxs-lookup"><span data-stu-id="2f6c1-178">![Processing MAPISendMail in a WOW64 scenario](media/346ba974-4844-4b64-9dd1-d0f829ab99b3.gif "Processing MAPISendMail in a WOW64 scenario")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="2f6c1-179">См. также</span><span class="sxs-lookup"><span data-stu-id="2f6c1-179">See also</span></span>

- [<span data-ttu-id="2f6c1-180">Ссылки на функции MAPI</span><span class="sxs-lookup"><span data-stu-id="2f6c1-180">Link to MAPI Functions</span></span>](how-to-link-to-mapi-functions.md)


---
title: Построение приложений MAPI на 32-разрядной и 64-разрядных платформах
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d218ba2d-7a2e-4c33-a09b-a8c7e27f9726
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: dce3f4b5bfdcb34148c25c880d8d2d8173755b37
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808131"
---
# <a name="building-mapi-applications-on-32-bit-and-64-bit-platforms"></a>Построение приложений MAPI на 32-разрядной и 64-разрядных платформах

**Относится к**: Outlook 
  
В этом разделе описываются действия, которые MAPI разработчикам следует изменять и перестроение 32-разрядных приложений MAPI для запуска на 64-разрядной платформе и 64-разрядных приложений для запуска на 32-разрядной платформы. В этом разделе 64-разрядной платформы — это компьютер с 64-разрядная версия Microsoft Outlook и 64-разрядная версия Windows и 32-разрядной платформе — это компьютер с 32-разрядного приложения Outlook и 32-разрядная или 64-разрядная версия Windows. 
  
## <a name="operating-system-and-office-support-for-64-bit-outlook"></a>Операционная система и техническая поддержка Office для 64-разрядного приложения Outlook

> [!NOTE]
> Разрядности термин относится к различие между 32-разрядной и 64-разрядных процессоров архитектуры и связанные совместимости приложений. В этом разделе разрядности используется в рамках программы версии Windows, Microsoft Office, Outlook, или приложения MAPI, созданных в соответствии с архитектуру 32-разрядная или 64-разрядных процессора компьютера и возможно других приложений, которые запускаются на этом компьютере. 
  
Начиная с Microsoft Office 2010, Outlook доступна как 32-разрядных и 64-разрядного приложения. На одном компьютере разрядности версий Outlook, зависит от разрядности операционной системы Windows (x86 или x64) и Microsoft Office, если Office уже установлены на этом компьютере. Ниже приведены некоторые факторы, которые следует при выборе 32-разрядная или 64-разрядная версия Outlook.
  
- 32-разрядную версию Office (и 32-разрядное приложение Outlook) можно установить на компьютер с 32-разрядной или 64-разрядной версией операционной системы Windows. 64-разрядную версию Office (и 64-разрядное приложение Outlook) можно установить только на компьютер с 64-разрядной операционной системой.
    
- По умолчанию на компьютере с 64-разрядной версией операционной системы Windows устанавливается 32-разрядная версия Office.
    
- Разрядности установленной версии Outlook всегда является то же, что разрядности версий Office, если Office устанавливается на том же компьютере. Другими словами 32-разрядная версия Outlook нельзя установить на одном компьютере, которые уже имеют 64-разрядных версиях другие приложения Office, таких как Microsoft Word 64-разрядная или 64-разрядная версия Microsoft Excel. Аналогично 64-разрядная версия Outlook нельзя установить на одном компьютере, который уже содержит 32-разрядные версии другие приложения Office.
    
## <a name="preparing-mapi-applications-for-32-bit-and-64-bit-platforms"></a>Подготовка приложений MAPI для 32-разрядной и 64-разрядных платформах

Приложения MAPI включают автономных приложений, таких как Microsoft Communicator и mfcmapi (en), а также поставщиков услуг, например адресной книги, хранения и поставщиками транспорта. Для метода MAPI и функции звонков для работы в приложении MAPI (за исключением одного Simple MAPI функция, MAPISendMail), разрядности версий приложений MAPI должен совпадать с разрядности подсистемы MAPI на компьютере для целевого приложения Запустите на. Разрядности подсистемы MAPI, в свою очередь, определяется по и всегда совпадает с разрядности установленной версии Outlook. В следующей таблице перечислены действия, необходимые для подготовки приложений MAPI для запуска на конечных компьютерах, настроенных с помощью Office и Windows различных разрядности.
  
|Разрядности версий приложений MAPI|Разрядности версий Outlook на компьютере|Разрядности версий Windows на компьютере|Необходимые действия для запуска на компьютере приложения|
|:-----|:-----|:-----|:-----|
|32-���������  <br/> |32-���������  <br/> |32-разрядная или 64-разрядная версия  <br/> |Нет определенных действий не требуется.  <br/> |
|32-���������  <br/> |64-разрядная версия  <br/> |64-разрядная версия  <br/> |Перестроение приложения как 64-разрядное приложение. В противном случае не удастся всех MAPI метода и функции звонков (за исключением **MAPISendMail**).  <br/> |
|64-разрядная версия  <br/> |64-разрядная версия  <br/> |64-разрядная версия  <br/> |Нет определенных действий не требуется.  <br/> |
|64-разрядная версия  <br/> |32-���������  <br/> |32-разрядная или 64-разрядная версия  <br/> |Перестроение приложения как 32-разрядное приложение. В противном случае не удастся всех MAPI метода и функции звонков (за исключением **MAPISendMail**).  <br/> |
   
Далее в следующих разделах описывается каждого сценария. Для сценариев, которые требуют перестроения приложения MAPI видеть [ссылка на функции MAPI](how-to-link-to-mapi-functions.md) для получения дополнительных сведений о связывание и вызов функций MAPI. 
  
### <a name="32-bit-mapi-application-and-32-bit-outlook"></a>32-разрядная версия приложения MAPI и 32-разрядного приложения Outlook

Приложения MAPI, скомпилированные для 32-разрядной подсистемы MAPI, который доступен в 32-разрядных версиях Outlook, включая этих версий до Microsoft Outlook 2013 по-прежнему поддерживается на компьютерах с 32-разрядного приложения Outlook и 32-разрядная или 64-разрядная версия Windows Операционная система. Нет определенных действий, необходимых для разработчиков приложений.
  
### <a name="32-bit-mapi-application-and-64-bit-outlook"></a>приложения MAPI 32-разрядной и 64-разрядного приложения Outlook

32-разрядных приложений MAPI не поддерживается для запуска на компьютер с 64-разрядного приложения Outlook и 64-разрядная версия Windows. Разработчик приложений необходимо обновить и перестроение приложения как 64-разрядных приложений для 64-разрядной платформы. Это так, как 32-разрядное приложение не удалось загрузить файл Msmapi32.dll 64-разрядная версия. Существует небольшое число изменений API, которые разработчики приложений необходимо использовать для построения кода успешно на 64-разрядную среду. Файлы заголовков MAPI обновлены для поддержки 64-разрядной платформе эти изменения. Вы можете загрузить эти файлы в [Outlook 2010: файлы заголовков MAPI](http://www.microsoft.com/downloads/details.aspx?FamilyID=f8d01fc8-f7b5-4228-baa3-817488a66db1). Разработчики могут использовать этот же набор файлов заголовков MAPI для создания 32-разрядной и 64-разрядных приложений MAPI.
  
### <a name="64-bit-mapi-application-and-64-bit-outlook"></a>приложения MAPI 64-разрядных и 64-разрядного приложения Outlook

64-разрядные приложения MAPI, поддерживаются на компьютерах с 64-разрядного приложения Outlook и 64-разрядная версия Windows. Нет определенных действий, необходимых для разработчиков приложений.
  
### <a name="64-bit-mapi-application-and-32-bit-outlook"></a>64-разрядного приложения MAPI и 32-разрядного приложения Outlook

64-разрядных приложений MAPI не поддерживается для запуска на компьютере с 32-разрядного приложения Outlook и 32-разрядная или 64-разрядная версия Windows. Разработчик приложений необходимо обновить и перестроение приложения как 32-разрядное приложение для работы с 32-разрядного приложения Outlook. Используйте обновленные файлы заголовков MAPI, которые можно загрузить по [Outlook 2010: файлы заголовков MAPI](http://www.microsoft.com/downloads/details.aspx?FamilyID=f8d01fc8-f7b5-4228-baa3-817488a66db1). Разработчики могут использовать этот же набор файлов заголовков MAPI для создания 32-разрядной и 64-разрядных приложений MAPI.
  
### <a name="exception-mapisendmail"></a>Исключение: MAPISendMail

Как правило, не следует использовать 32-разрядного приложения MAPI на 64-разрядной платформы (64-разрядная версия Outlook на 64-разрядная версия Windows) не первый восстановленном как приложения 64-разрядных и 64-разрядного приложения MAPI не должен выполнить на компьютере, установленные вместе с 32-разрядного приложения Outlook и 32-разрядная или 64-разрядная версия Windows без предварительного перестраивать как 32-разрядное приложение. На рисунке 1 показано диалоговое окно оповещения, которое будет отображаться, если любой из этих сценариев происходит.
  
**На рисунке 1. Сообщение об ошибке для большинства MAPI различной разрядности вызывает.**

![Сообщение об ошибке для вызовов MAPI с различной разрядности наиболее] (media/738905fb-57ae-4af7-b54b-a1676c80d3c3.JPG "Сообщение об ошибке для вызовов MAPI с различной разрядности наиболее")
  
Тем не менее, бы успешно один вызов функции среди всех Simple MAPI и MAPI элементов **MAPISendMail**в сценарии Windows-64-bit-on-Windows-32-bit (WOW32) или Windows-32-bit-on-Windows-64-bit (WOW64) и не приведет к выше оповещение. В этом сценарии WOW64 применяется только к Windows 7. 

На рисунке 2 показано сценарии WOW64, в котором 32-разрядного приложения MAPI вызывает **MAPISendMail** на компьютер с 64-разрядная версия Windows 7. В этом сценарии библиотеки MAPI совершает вызов COM для запуска 64-разрядного приложения Fixmapi. Приложение Fixmapi неявно ссылки на библиотеку MAPI, который направляет вызов функции заглушка Windows MAPI, который в свою очередь перенаправляет вызов заглушка Outlook MAPI, включив вызов функции **MAPISendMail** для успешного выполнения. 
  
**На рисунке 2. Обработка MAPISendMail в сценарии WOW64.**

![Обработка MAPISendMail в сценарии WOW64] (media/346ba974-4844-4b64-9dd1-d0f829ab99b3.gif "Обработка MAPISendMail в сценарии WOW64")
  
## <a name="see-also"></a>См. также

- [Ссылки на функции MAPI](how-to-link-to-mapi-functions.md)


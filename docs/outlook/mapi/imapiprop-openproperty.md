---
title: имапипропопенпроперти
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.OpenProperty
api_type:
- COM
ms.assetid: e400e6cc-4e36-43fc-9304-b688a0a7fd77
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 7bf1d6912e44319c36e288cd3870218e8c4e45ff
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32319812"
---
# <a name="imapipropopenproperty"></a>IMAPIProp::OpenProperty

**Относится к**: Outlook 2013 | Outlook 2016 
  
Возвращает указатель на интерфейс, который можно использовать для доступа к свойству.
  
```cpp
HRESULT OpenProperty(
  ULONG ulPropTag,
  LPCIID lpiid,
  ULONG ulInterfaceOptions,
  ULONG ulFlags,
  LPUNKNOWN FAR * lppUnk
);
```

## <a name="parameters"></a>Параметры

 _улпроптаг_
  
> возврата Тег свойства для свойства, к которому необходимо получить доступ. Идентификатор и тип должны быть включены в тег Property.
    
 _лпиид_
  
> возврата Указатель на идентификатор интерфейса, который будет использоваться для доступа к свойству. Параметр _лпиид_ не должен иметь **значение NULL**.
    
 _улинтерфацеоптионс_
  
> возврата Данные, связанные с интерфейсом, определяемым параметром _лпиид_ . 
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют доступом к свойству. Можно задать следующие флаги:
    
MAPI_CREATE 
  
> Если свойство не существует, оно должно быть создано. Если свойство существует, текущее значение свойства должно быть отменено. Когда вызывающий абонент устанавливает флаг MAPI_CREATE, он также должен установить флаг MAPI_MODIFY.
    
MAPI_DEFERRED_ERRORS 
  
> Разрешает успешное возвращение **опенпроперти** , возможно, перед тем, как объект будет полностью доступен вызывающему абоненту. Если объект недоступен, то выполнение следующего вызова объекта может вызвать ошибку. 
    
MAPI_MODIFY 
  
> В таких ситуациях необходимо MAPI_MODIFY:
    
  - При открытии свойства потока, например **IID_IStream**, для его изменения.
    
  - При открытии вложения внедренного сообщения, например [PR_ATTACH_DATA_OBJ](pidtagattachdataobject-canonical-property.md) , открытого с помощью **IID_IMessage**, для его изменения.
    
 _лппунк_
  
> вышли Указатель на запрашиваемый интерфейс, который будет использоваться для доступа к свойству.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Запрошенный указатель интерфейса успешно возвращен.
    
MAPI_E_INTERFACE_NOT_SUPPORTED 
  
> Запрошенный интерфейс не поддерживается для этого свойства.
    
MAPI_E_NO_ACCESS 
  
> Вызывающий не имеет достаточных разрешений для доступа к свойству.
    
MAPI_E_NO_SUPPORT 
  
> Объект не может предоставлять доступ к этому свойству через запрошенный интерфейс.
    
MAPI_E_NOT_FOUND 
  
> Запрошенное свойство не существует, а MAPI_CREATE не задано в параметре _ulFlags_ . 
    
MAPI_E_INVALID_PARAMETER 
  
> Для типа свойства в теге задается значение PT_UNSPECIFIED.
    
## <a name="remarks"></a>Примечания

Метод **IMAPIProp:: опенпроперти** предоставляет доступ к свойству через определенный интерфейс. **Опенпроперти** является альтернативой методам [IMAPIProp::-PROPS](imapiprop-getprops.md) и [IMAPIProp:: SetProps](imapiprop-setprops.md) . Если свойства- **PROPS** или **SetProps** не выполняются из-за того, что свойство слишком велико или слишком сложное, вызовите **опенпроперти**. **Опенпроперти** обычно используется для доступа к свойствам типа PT_OBJECT. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы получить доступ к вложениям сообщений, откройте свойство **PR_ATTACH_DATA_OBJ** ([PidTagAttachDataObject](pidtagattachdataobject-canonical-property.md)) с другим идентификатором интерфейса в зависимости от типа вложения. В следующей таблице описано, как вызывать **опенпроперти** для различных типов вложений: 
  
|**Тип вложения**|**Используемый идентификатор интерфейса**|
|:-----|:-----|
|Binary  <br/> |IID_IStream  <br/> |
|String  <br/> |IID_IStream  <br/> |
|Сообщение  <br/> |IID_IMessage  <br/> |
|OLE 2,0  <br/> |IID_IStreamDocfile  <br/> |
   
**Помощью istreamdocfile** является производным от интерфейса [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) , основанного на составном файле OLE 2,0. **Помощью istreamdocfile** — лучший выбор для доступа к вложениям OLE 2,0, так как он требует наименьшего объема издержек. IID_IStreamDocFile можно использовать для тех свойств, которые содержат данные, хранящиеся в структурированном хранилище, доступном через интерфейс [IStorage](https://msdn.microsoft.com/library/aa380015%28VS.85%29.aspx) . 
  
Дополнительные сведения о том, как использовать **опенпроперти** с вложениями, можно узнать в свойстве **PR_ATTACH_DATA_OBJ** и [открыть вложение](opening-an-attachment.md).
  
Не используйте указатель **IStream** , который вы получаете для вызова метода [Seek](https://msdn.microsoft.com/library/aa380043%28v=VS.85%29.aspx) или [SetSize](https://msdn.microsoft.com/library/aa380044%28v=VS.85%29.aspx) , если не используется переменная position или size. Кроме того, не полагайтесь на значение выходного параметра _плибневпоситион_ , возвращенного при вызове **Seek** . 
  
При вызове **опенпроперти** для доступа к свойству с помощью интерфейса **IStream** используйте только этот интерфейс для внесения изменений. Не пытайтесь обновить свойство с любыми другими методами [IMAPIProp: IUnknown](imapipropiunknown.md) , такими как **SetProps** или [IMAPIProp::D елетепропс](imapiprop-deleteprops.md). 
  
Не пытайтесь открыть свойство с помощью **опенпроперти** более одного раза. Результаты не определены, так как они могут отличаться от поставщика к поставщику. 
  
Если необходимо изменить свойство, которое должно быть открыто, установите флаг MAPI_MODIFY. Если вы не знаете, поддерживает ли объект свойство, но считаете, что это необходимо, установите флаги MAPI_CREATE и MAPI_MODIFY. Если MAPI_CREATE задано, MAPI_MODIFY также необходимо задать.
  
Вы несете ответственность за переопределение указателя интерфейса, возвращаемого в параметре _лппунк_ , на тот, который подходит для интерфейса, указанного в параметре _лпиид_ . Кроме того, необходимо использовать возвращенный указатель, чтобы вызвать метод [IUnknown:: Release](https://msdn.microsoft.com/library/ms682317%28v=VS.85%29.aspx) после завершения работы с ним. 
  
Иногда установка флагов в параметре _ulFlags_ недостаточно для указания типа доступа к требуемому свойству. В параметре _улинтерфацеоптионс_ можно добавить дополнительные данные, например флаги. Эти данные зависят от интерфейса. Некоторые интерфейсы (например, **IStream**) используют его, а другие — нет. Например, при открытии свойства, которое необходимо изменить с помощью **IStream**, установите флаг STGM_WRITE в параметре _улинтерфацеоптионс_ в дополнение к MAPI_MODIFY. При открытии таблицы с помощью интерфейса [IMAPITable](imapitableiunknown.md) можно присвоить параметру _улинтерфацеоптионс_ значение MAPI_UNICODE, чтобы указать, должны ли столбцы таблицы, содержащие строковые свойства, иметь формат Юникод. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Стреамедитор. cpp  <br/> |Кстреамедитор:: Реадтекстстреамфромпроперти  <br/> |MFCMAPI использует метод **IMAPIProp:: опенпроперти** для получения потокового интерфейса для больших текстовых и двоичных свойств.  <br/> |
   
## <a name="see-also"></a>См. также

- [HrIStorageFromStream](hristoragefromstream.md) 
- [IMAPIProp::DeleteProps](imapiprop-deleteprops.md) 
- [IMAPIProp::GetProps](imapiprop-getprops.md)
- [IMAPIProp::SetProps](imapiprop-setprops.md)
- [IMAPISupport::IStorageFromStream](imapisupport-istoragefromstream.md)
- [IMAPITable : IUnknown](imapitableiunknown.md)
- [IMAPIProp : IUnknown](imapipropiunknown.md)
- [MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
- [Открытие вложения](opening-an-attachment.md)


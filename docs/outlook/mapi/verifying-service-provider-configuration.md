---
title: Проверка конфигурации поставщика службы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: dc23dc61-7b51-43ab-a184-ce0bdac91d03
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 381e2c9ec84811b69d666017a568e7b9cca21755
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418850"
---
# <a name="verifying-service-provider-configuration"></a>Проверка конфигурации поставщика службы
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Метод для логотипа ([IABProvider::Logon,](iabprovider-logon.md) [IMSProvider::Logon](imsprovider-logon.md)или [IXPProvider::TransportLogon)](ixpprovider-transportlogon.md)должен проверить конфигурацию поставщика. Это включает проверку правильности всех свойств, необходимых для полной работы. Каждому поставщику требуется разное количество свойств; конфигурация зависит от поставщика и степени взаимодействия с пользователем. Некоторые поставщики услуг сохраняют все необходимые свойства в профиле. 

Другие поставщики услуг сохраняют частичный набор свойств в профиле и запросили у пользователя отсутствующие значения. По-прежнему другие поставщики вообще не хранят свойства в профиле, полагаться на то, что пользователь должен предоставить всю информацию, необходимую для настройки.
  
### <a name="to-retrieve-properties-stored-in-the-profile"></a>Извлечение свойств, хранимых в профиле
  
1. Вызовите [IMAPISupport::OpenProfileSection,](imapisupport-openprofilesection.md)передав [MAPIUID](mapiuid.md) поставщика в качестве входного параметра. 
    
2. Вызовите методы [IMAPIProp::GetProps](imapiprop-getprops.md) или [IMAPIProp::GetPropList](imapiprop-getproplist.md) раздела профиля, чтобы получить отдельные свойства или список свойств. 
    
### <a name="to-set-properties-from-user-information"></a>Настройка свойств из сведений о пользователе
  
Отображение листа свойств, если MAPI не установил флаг, запрещающий отображение. Следующие флаги указывают, что пользовательский интерфейс не может быть представлен.
  
|**Flag**|**Поставщик услуг**|
|:-----|:-----|
|AB_NO_DIALOG  <br/> |Поставщик адресной книги  <br/> |
|LOGON_NO_DIALOG  <br/> |Поставщик транспорта  <br/> |
|MDB_NO_DIALOG  <br/> |Поставщик store сообщений  <br/> |
   
Если поставщик не сохраняет все свойства конфигурации в профиле, требуя взаимодействия с пользователем, и MAPI передает один из флагов подавления диалоговых окна методу для MAPI_E_UNCONFIGURED. Также возвращает эту ошибку, если флаг подавления диалогов не установлен, но пользователь не сообщает всю необходимую информацию.
  
Если поставщик услуг не работает с методом входа с MAPI_E_UNCONFIGURED, MAPI снова вызывает функцию точки входа. Если данные не могут быть расположены во втором вызове, сеанс может завершиться в зависимости от того, насколько важен поставщик услуг. 
  
На следующем рисунке показана логика, необходимая для настройки в методе для работы с поставщиком услуг. 
  
**Блок-схема проверки конфигурации**
  
![Потоки проверки конфигурации](media/amapi_62.gif "конфигурации")
  
## <a name="see-also"></a>См. также

- [Реализация службы для логоса](implementing-service-provider-logon.md)


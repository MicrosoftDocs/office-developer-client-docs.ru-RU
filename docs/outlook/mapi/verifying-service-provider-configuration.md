---
title: Проверка конфигурации поставщика службы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: dc23dc61-7b51-43ab-a184-ce0bdac91d03
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 381e2c9ec84811b69d666017a568e7b9cca21755
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418850"
---
# <a name="verifying-service-provider-configuration"></a>Проверка конфигурации поставщика службы
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Метод входа ([иабпровидер:: logon](iabprovider-logon.md), [Функцииimsprovider:: logon](imsprovider-logon.md)или [иксппровидер:: транспортлогон](ixpprovider-transportlogon.md)) должен проверить конфигурацию поставщика. Это включает проверку правильности настройки всех свойств, необходимых для полной операции. Каждому поставщику необходимо различное количество свойств; Настройка зависит от поставщика и степени взаимодействия с пользователем. Некоторые поставщики услуг хранят все необходимые свойства в профиле. 

Другие поставщики услуг хранят частичный набор свойств в профиле и запрашивают у пользователя недостающие значения. Другие поставщики по-прежнему не хранят свойства в профиле вообще, полагаться на то, что пользователь должен предоставить всю информацию, необходимую для настройки.
  
### <a name="to-retrieve-properties-stored-in-the-profile"></a>Извлечение свойств, хранящихся в профиле
  
1. Call [имаписуппорт:: опенпрофилесектион](imapisupport-openprofilesection.md), передавая [мапиуид](mapiuid.md) поставщика в качестве входного параметра. 
    
2. Вызовите методы [IMAPIProp::](imapiprop-getprops.md) GetProperty или [IMAPIProp:: жетпроплист](imapiprop-getproplist.md) , чтобы получить отдельные свойства или список свойств. 
    
### <a name="to-set-properties-from-user-information"></a>Задание свойств сведений о пользователе
  
Отображение страницы свойств, если в MAPI не установлен флаг, запрещающий отображение. Следующие флаги указывают на то, что пользовательский интерфейс не может быть представлен.
  
|**Флаг**|**Поставщик услуг**|
|:-----|:-----|
|AB_NO_DIALOG  <br/> |Поставщик адресных книг  <br/> |
|LOGON_NO_DIALOG  <br/> |Поставщик транспорта  <br/> |
|MDB_NO_DIALOG  <br/> |Поставщик хранилища сообщений  <br/> |
   
Если поставщик не сохраняет все свойства конфигурации в профиле, требуя взаимодействия с пользователем, а MAPI передает один из флагов блокировки диалогового окна в метод входа, возвращается MAPI_E_UNCONFIGURED. Также возвращайте эту ошибку, если не установлен флаг запрета диалоговых окон, но пользователь не предоставляет все необходимые сведения.
  
Если поставщик услуг не смог выполнить вход в систему с MAPI_E_UNCONFIGURED, MAPI повторно вызывает функцию точки входа. Если не удается найти информацию при втором вызове, сеанс может завершиться в зависимости от того, насколько важен ваш поставщик услуг. 
  
На следующем рисунке показана логика, необходимая для настройки в методе входа поставщика услуг. 
  
**Блок-схема проверки конфигурации**
  
![Configuration verification flowchart](media/amapi_62.gif "Блок-схема проверки конфигурации") блок-схемы проверки конфигурации
  
## <a name="see-also"></a>См. также

- [Реализация входа у поставщика услуг](implementing-service-provider-logon.md)


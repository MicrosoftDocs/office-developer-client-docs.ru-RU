---
title: Проверка конфигурации службы поставщика
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: dc23dc61-7b51-43ab-a184-ce0bdac91d03
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 047a3b99b2d615984252071a1264521a4b2240f8
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812592"
---
# <a name="verifying-service-provider-configuration"></a>Проверка конфигурации службы поставщика
  
**Относится к**: Outlook 
  
Метод входа в систему ([IABProvider::Logon](iabprovider-logon.md), [IMSProvider::Logon](imsprovider-logon.md)или [IXPProvider::TransportLogon](ixpprovider-transportlogon.md)) необходимо проверить конфигурацию вашего поставщика. Это включает в себя проверки, что все свойства, необходимые для полного операции установлены правильно. Каждый поставщик требуются разные число свойств; Конфигурация зависит от поставщика и степень взаимодействия с пользователем, то. Некоторые поставщики услуг хранить все необходимые свойства в профиле. 

Других поставщиков услуг, оставьте сокращенный набор свойств в профиле и запрашивать у пользователя для отсутствующие значения. По-прежнему других поставщиков не следует хранить свойства профиля, от пользователя ввести все сведения, необходимые для настройки.
  
### <a name="to-retrieve-properties-stored-in-the-profile"></a>Для извлечения свойств, хранящиеся в профиле
  
1. Вызовите [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md), передав [MAPIUID](mapiuid.md) поставщика в качестве входного параметра. 
    
2. Вызов раздела профиля [IMAPIProp::GetProps](imapiprop-getprops.md) или [IMAPIProp::GetPropList](imapiprop-getproplist.md) методы для получения отдельных свойств или список свойств. 
    
### <a name="to-set-properties-from-user-information"></a>Для настройки свойств из сведений о пользователе
  
Показывать на листе свойств MAPI не установлен флаг Запрет отображения. Следующие флаги указывают, что пользовательский интерфейс не могут быть представлены.
  
|**Flag**|**Поставщик услуг**|
|:-----|:-----|
|AB_NO_DIALOG  <br/> |Поставщик адресной книги  <br/> |
|LOGON_NO_DIALOG  <br/> |Поставщик транспорта  <br/> |
|MDB_NO_DIALOG  <br/> |Поставщик хранилища сообщений  <br/> |
   
Если ваш поставщик не сохраняет все его свойства конфигурации в профиле, требующее вмешательства пользователя и MAPI передает один из флагов блокировки отображения диалогового окна поле метод входа в систему, возвратите MAPI_E_UNCONFIGURED. Также возвратите Эта ошибка при флаг блокировки отображения диалогового окна не установлен, но пользователь не поддерживает все необходимые сведения.
  
При сбое метода входа в систему с MAPI_E_UNCONFIGURED ваш поставщик услуг MAPI еще раз вызывает функцию точки входа. Если сведения не удается найти на второй вызов, сеанс может завершить работу, в зависимости от того, насколько важна поставщиком услуг. 
  
На следующем рисунке показана логика, необходимые для настройки в методе службы поставщика входа в систему. 
  
**Блок-схема проверки конфигурации**
  
![Блок-схема проверки конфигурации] (media/amapi_62.gif "Блок-схема проверки конфигурации")
  
## <a name="see-also"></a>См. также

- [Реализация входа для поставщика службы](implementing-service-provider-logon.md)


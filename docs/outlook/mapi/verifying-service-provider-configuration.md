---
title: Проверка конфигурации поставщика службы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: dc23dc61-7b51-43ab-a184-ce0bdac91d03
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 381e2c9ec84811b69d666017a568e7b9cca21755
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418850"
---
# <a name="verifying-service-provider-configuration"></a>Проверка конфигурации поставщика службы
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Ваш метод logon[(IABProvider:::Logon,](iabprovider-logon.md) [IMSProvider::Logon](imsprovider-logon.md)или [IXPProvider::TransportLogon)](ixpprovider-transportlogon.md)должен проверить конфигурацию поставщика. Это включает проверку правильности всех свойств, необходимых для полной работы. Каждому поставщику требуется различное количество свойств; конфигурация зависит от поставщика и степени взаимодействия с пользователем, который вы разрешаете. Некоторые поставщики услуг держат все необходимые свойства в профиле. 

Другие поставщики услуг держат частичный набор свойств в профиле и подсказывая пользователю отсутствующие значения. Однако другие поставщики вообще не хранят свойства в профиле, полагаясь на то, что пользователь должен предоставить всю необходимую информацию для настройки.
  
### <a name="to-retrieve-properties-stored-in-the-profile"></a>Извлечение свойств, хранимых в профиле
  
1. Вызов [IMAPISupport::OpenProfileSection,](imapisupport-openprofilesection.md)передавая [MAPIUID](mapiuid.md) поставщика в качестве параметра ввода. 
    
2. Вызовите методы [IMAPIProp::GetProps](imapiprop-getprops.md) или [IMAPIProp::GetPropList](imapiprop-getproplist.md) для получения отдельных свойств или списка свойств. 
    
### <a name="to-set-properties-from-user-information"></a>Настройка свойств из пользовательских сведений
  
Отображение листа свойств, если MAPI не установил флаг, запрещающий отображение. Следующие флаги указывают, что пользовательский интерфейс не может быть представлен.
  
|**Флаг**|**Поставщик услуг**|
|:-----|:-----|
|AB_NO_DIALOG  <br/> |Поставщик адресных книг  <br/> |
|LOGON_NO_DIALOG  <br/> |Поставщик транспорта  <br/> |
|MDB_NO_DIALOG  <br/> |Поставщик магазина сообщений  <br/> |
   
Если поставщик не хранит все свои свойства конфигурации в профиле, требуя взаимодействия с пользователем, и MAPI передает один из флагов подавления диалоговых полей в метод logon, верните MAPI_E_UNCONFIGURED. Также возвращайте эту ошибку, когда флаг подавления диалогов не установлен, но пользователь не сообщает всю необходимую информацию.
  
Если поставщик услуг не работает с помощью метода MAPI_E_UNCONFIGURED, MAPI снова вызывает функцию точки входа. Если данные не могут быть расположены при втором вызове, сеанс может завершиться в зависимости от того, насколько важен поставщик услуг. 
  
На следующем рисунке показана логика, необходимая для настройки в методе logon поставщика услуг. 
  
**Блок-схема проверки конфигурации**
  
![Поток проверки конфигурации проверки](media/amapi_62.gif "конфигурации")
  
## <a name="see-also"></a>См. также

- [Реализация logon поставщика услуг](implementing-service-provider-logon.md)


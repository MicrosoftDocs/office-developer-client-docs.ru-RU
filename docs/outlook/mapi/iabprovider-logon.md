---
title: IABProviderLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABProvider.Logon
api_type:
- COM
ms.assetid: f9468715-1674-4d14-81c8-2f24dbaa0453
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 59c6d4a05c91511ad8c481fd4ddbe42396442190
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25384110"
---
# <a name="iabproviderlogon"></a>IABProvider::Logon

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Устанавливает подключение к активного сеанса.
  
```cpp
HRESULT Logon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG ulFlags,
  ULONG FAR * lpulcbSecurity,
  LPBYTE FAR * lppbSecurity,
  LPMAPIERROR FAR * lppMAPIError,
  LPABLOGON FAR * lppABLogon
);
```

## <a name="parameters"></a>Параметры

 _lpMAPISup_
  
> [in] Указатель на объект поддержки поставщик адресной книги.
    
 _ulUIParam_
  
> [in] Дескриптор родительского окна для диалогового окна входа в систему, которая отображает метод **входа в систему** , если это разрешено. Параметр _ulUIParam_ содержит значение параметра с таким же именем, переданной в MAPI в предыдущем вызове функции [MAPILogonEx](mapilogonex.md) . 
    
 _lpszProfileName_
  
> [in] Указатель на имя профиля сеанса.
    
 _ulFlags_
  
> [in] Битовая маска флаги, который определяет, как выполняется вход в систему. Можно задать следующие флажки:
    
AB_NO_DIALOG 
  
> Поставщик не отображать диалоговое окно во время входа в систему. Если этот флаг не установлен, поставщик может отображать диалоговое окно запрашивать у пользователя отсутствуют сведения о конфигурации.
    
MAPI_DEFERRED_ERRORS 
  
> Включение **входа в систему** для возврата успешно, возможно до завершения процесса входа в систему. 
    
MAPI_UNICODE 
  
> Все строки должны быть в формате Юникод. Если флаг MAPI_UNICODE не установлен, строки должен быть в формате ANSI.
    
 _lpulcbSecurity_
  
> [in, out] Указатель на размер в байтах, структуры учетные данные безопасности, на который указывает параметр _lppbSecurity_ . На выходе — значение должно быть от нуля; в выходных данных значение должно быть нулю. В обоих случаях указатели должно быть допустимым. 
    
 _lppbSecurity_
  
> [in, out] Указатель на указатель на учетные данные безопасности. На выходе — значение должно быть от нуля; в выходных данных значение должно быть нулю. В обоих случаях указатель должен быть допустимый.
    
 _lppMAPIError_
  
> [out] Указатель на указатель на структуру [MAPIERROR](mapierror.md) . Параметр _lppMAPIError_ может быть присвоено значение NULL, если структура не **MAPIERROR** для возврата. 
    
 _lppABLogon_
  
> [out] Указатель на указатель на объект поставщика входа в систему.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Подключение к активного сеанса успешно установлено.
    
MAPI_E_FAILONEPROVIDER 
  
> Поставщик не может войти, но можно продолжить MAPI, войдите в систему других поставщиков службы сообщений, к которой принадлежит поставщик. 
    
MAPI_E_UNCONFIGURED 
  
> Поставщик имеет недостаточно сведений для выполнения входа в систему. MAPI вызывает функцию запись службы поставщика сообщения.
    
MAPI_E_UNKNOWN_CPID 
  
> Сервер не настроен для поддержки кодовой страницы клиента.
    
MAPI_E_UNKNOWN_LCID 
  
> Сервер не настроен для поддержки сведения о языковом стандарте клиента.
    
MAPI_E_USER_CANCEL 
  
> Пользователь отменил операцию, как правило, нажмите кнопку **Отмена** в диалоговом окне входа в систему. 
    
## <a name="remarks"></a>Замечания

Подключений с каждой поставщик адресной книги в профиле сеанса при вызове метода [IMAPISession::OpenAddressBook](imapisession-openaddressbook.md) клиентом. **OpenAddressBook** вызывает метод **входа в систему** для каждого поставщика. 
  
Имя профиля, на который указывает параметр _lpszProfileName_ отображается в набор знаков клиента пользователя, как указано в наличие или отсутствие флага MAPI_UNICODE с помощью параметра _ulFlags_ . 
  
## <a name="notes-to-implementers"></a>Примечания для реализующих

В реализации метода **входа в систему** вызовите метод [IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md) для регистрации уникального идентификатора или [MAPIUID](mapiuid.md) структуры. Каждый объект будет иметь запись идентификатор, который включает в себя этот **MAPIUID**. MAPI использует **MAPIUID** объекта с его поставщиком. Например, когда клиент вызывает метод [IMAPISession::OpenEntry](imapisession-openentry.md) , чтобы открыть обмена сообщениями пользователя, **OpenEntry** проверяет **MAPIUID** часть идентификатор записи, который был передан и сопоставляет его с **MAPIUID** , зарегистрированные, поставщик адресной книги. 
  
Если клиент входит в систему с поставщиком более одного раза, можно зарегистрировать различных **MAPIUID** для каждого входа в систему. Регистрация уникальных структур **MAPIUID** позволяет MAPI для правильной маршрутизации запросов к экземпляру соответствующего поставщика. Тем не менее может потребоваться каждый объект входа совместно использовать один **MAPIUID**. В этом случае требуется обрабатывать маршрута самостоятельно вместо использования MAPI. Дополнительные сведения о создании **MAPIUID**можно [Регистрации уникальных идентификаторов поставщика службы](registering-service-provider-unique-identifiers.md).
  
Поддержка объект, который передает MAPI в метод **входа в систему** с помощью параметра _lpMAPISup_ предоставляет доступ к многие из методов, включенных в [IMAPISupport: IUnknown](imapisupportiunknown.md) интерфейса. MAPI создает объект поддержки, настроенный для соответствующего типа поставщика. К примеру Если необходимо войти в базовом системы обмена сообщениями или служба каталогов при создании подключения к можно вызвать метод [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) для получения учетных данных для этого конкретного сеанса. 
  
Если **Вход в систему** прошла успешно, убедитесь, что метод объектов поддержки [IUnknown::AddRef](https://msdn.microsoft.com/library/ms691379%28VS.85%29.aspx) увеличить счетчик ссылок на него. Благодаря этому поставщику к удержанию указателя на объект поддержки для остальных сеанса. Если этот метод **AddRef** не вызван, MAPI будет выгрузить ваш поставщик. 
  
Может включать имя профиля, переданной в параметре _lpszProfileName_ ошибка диалоговых окон, экрана входа или других пользовательских интерфейсов. Чтобы использовать имя профиля, скопируйте его в хранилище, которое выделено. 
  
Создайте объект входа в систему и возвращает указатель на него с помощью параметра _lppABLogon_ . MAPI выполнять вызовы методов в реализации [IABLogon](iablogoniunknown.md) использует этот объект входа в систему. 
  
Если требуется пароль при входе в систему, только в том случае, если не установлен флаг AB_NO_DIALOG отображения диалогового окна входа в систему. Если пользователь отменил процесс входа в систему, как правило, нажмите кнопку **Отмена** в диалоговом окне возврата MAPI_E_USER_CANCEL из **входа в систему**.
  
Как правило, если поставщика адресных книг не может войти, MAPI отключает службы сообщений, к которой принадлежит поставщик со сбоями, то есть MAPI не пытается устанавливать подключения для каких-либо других поставщиков, относящихся к службе для остальных сеанса время жизни. Тем не менее если ваш поставщик не удается установить подключение и вы не хотите отключить всей службы, возвращает MAPI_E_FAILONEPROVIDER или MAPI_E_UNCONFIGURED. MAPI не отключает службы сообщений, к которой принадлежит поставщик. 
  
Возврат MAPI_E_FAILONEPROVIDER при возникновении ошибки, которая не является серьезные, чтобы предотвратить установления подключения других поставщиков службы сообщений. Возвращает MAPI_E_UNCONFIGURED, если отсутствуют необходимые сведения о конфигурации из профиля и не может отобразить диалоговое окно с запросом. MAPI ответит путем вызова функции точки входа службы сообщения ваш поставщик с набором MSG_SERVICE_CONFIGURE как параметр _ulContext_ для предоставления службы возможности для настройки, либо программными средствами или с помощью свойств. Точка входа в службу сообщение завершения работы функции, MAPI, как повторить вход в систему. 
  
## <a name="see-also"></a>См. также



[IABLogon::Logoff](iablogon-logoff.md)
  
[IABLogon::OpenEntry](iablogon-openentry.md)
  
[IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md)
  
[IMAPISupport::SetProviderUID](imapisupport-setprovideruid.md)
  
[MSGSERVICEENTRY](msgserviceentry.md)
  
[IABProvider : IUnknown](iabprovideriunknown.md)


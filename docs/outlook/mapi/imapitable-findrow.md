---
title: имапитаблефиндров
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.FindRow
api_type:
- COM
ms.assetid: 6511368c-9777-497e-9eea-cf390c04b92e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a5364af229721d101f38d2f054f528169b48c09e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429574"
---
# <a name="imapitablefindrow"></a>IMAPITable::FindRow

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Находит следующую строку в таблице, которая соответствует определенным условиям поиска, и перемещает курсор в эту строку.
  
```cpp
HRESULT FindRow(
LPSRestriction lpRestriction,
BOOKMARK BkOrigin,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _лпрестриктион_
  
> возврата Указатель на структуру [срестриктион](srestriction.md) , которая описывает критерии поиска. 
    
 _бкоригин_
  
> возврата Закладка, определяющая строку, в которой запрос **FindRow** должен начинаться. Можно создать закладку с помощью метода [IMAPITable:: креатебукмарк](imapitable-createbookmark.md) или одного из следующих предварительно заданных значений. 
    
BOOKMARK_BEGINNING 
  
> Выполняет поиск с начала таблицы. 
    
BOOKMARK_CURRENT 
  
> Выполняет поиск из строки в таблице, в которой находится курсор. 
    
BOOKMARK_END 
  
> Выполняет поиск с конца таблицы. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют направлением поиска. Можно задать следующий флаг:
    
DIR_BACKWARD 
  
> Выполняет поиск в обратном направлении от строки, указанной закладкой.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция поиска выполнена успешно.
    
MAPI_E_INVALID_BOOKMARK 
  
> Закладка в параметре _бкоригин_ является недопустимой, так как она была удалена или находится за пределами последней запрошенной строки. 
    
MAPI_E_NOT_FOUND 
  
> Не найдены строки, которые содержали ограничение.
    
MAPI_W_POSITION_CHANGED
  
> Вызов выполнен успешно, но закладка, используемая в операции, больше не задается в той же строке, что и при ее последнем использовании; Если закладка не использовалась, она больше не находится в той же позиции, что и при ее создании. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **HR_FAILED** . Просмотр и [Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable:: FindRow** ищет первую строку в таблице в соответствии с набором критериев поиска, описанным в структуре **срестриктион** , на которую указывает параметр _лпрестриктион_ . 
  
Обычно поиск **выполняется в** перенаправлении с указанной закладки. Вызывающий абонент может задать перемещение в обратном направлении из закладки, установив флаг DIR_BACKWARD в параметре _ulFlags_ . Поиск вперед начинается с текущей закладки; Поиск в обратном направлении начинается с строки, предшествующей закладке. Конечное положение поиска непосредственно перед найденной первой строкой, которая удовлетворяет ограничению. 
  
Если строка, указывающая на закладку в параметре _бкоригин_ , больше не существует в таблице, а в таблице не удается установить новую позицию для закладки, то методом **FindRow** возвращается MAPI_E_INVALID_BOOKMARK. Если строка, на которую указывает _бкоригин_ , больше не существует и таблица может установить новую позицию для закладки, то методом **FindRow** возвращается MAPI_W_POSITION_CHANGED. 
  
Если закладка, переданная в _бкоригин_ , BOOKMARK_BEGINNING или BOOKMARK_END, то метод **FindRow** возвращает MAPI_E_NOT_FOUND, если соответствующая строка не найдена. Если закладка, используемая в _бкоригин_ , BOOKMARK_CURRENT, то **FindRow** может вернуть MAPI_W_POSITION_CHANGED, но не MAPI_E_INVALID_BOOKMARK, так как всегда существует текущее положение курсора. 
  
Столбец свойства **PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md)) является обязательным для всех таблиц, и все реализации метода **FindRow** необходимы для поддержки вызовов, которые ищут строку на основе PR_INSTANCE_KEY. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Тип поиска префикса, выполняемого методом **FindRow** , удобен только в том случае, если поиск соответствует тому же направлению, что и Организация таблицы. Чтобы обеспечить необходимое поведение, функция сравнения, которая подразумевается **RELOP_GE** , переданная в структуру ограничения свойств, должна быть той же функцией сравнения, на которой основан порядок сортировки таблицы. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Можно использовать команду **FindRow** для поддержки прокрутки, основанной на строках, вводимых пользователем, особенно в полях списка в диалоговых окнах адресов. В этом типе прокрутки пользователи вводят более длительные префиксы строкового значения, и вы можете периодически выдать вызов **FindRow** , чтобы перейти к первой строке, которая соответствует префиксу. Направление перехода курсора зависит от направления, в котором будет выполняться поиск. 
  
Для использования метода **FindRow**необходимо задать закладку. Поиск строки может исходить из любой закладки, в том числе из предварительно заданной закладки, указывающей текущую позицию, начало и конец таблицы. Если таблица содержит большое количество строк, операция поиска может выполняться медленно.
  
Используйте ограничение, чтобы найти префикс строки для прокрутки, как показано ниже. Для прямого поиска по столбцу, отсортированному по возрастанию, и для обратного поиска по столбцу, отсортированному по убыванию, передайте структуру ограниченного свойства в параметре _лпрестриктион_ с отношением **RELOP_GE** и соответствующим тегом свойства и префиксом, используя _префикс_ **GE** _тега_ Format. 
  
Дополнительные сведения об использовании структур ограничений для указания фильтра можно узнать в статье [ограничения](about-restrictions.md).
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Контентстаблелистктрл. cpp  <br/> |двсреадфунклоадтабле  <br/> |MFCMAPI использует метод **IMAPITable:: FindRow** для поиска строк, которые отвечают ограничению.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[SPropertyRestriction](spropertyrestriction.md)
  
[SRestriction](srestriction.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


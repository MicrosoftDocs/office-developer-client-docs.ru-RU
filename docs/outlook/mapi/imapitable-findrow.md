---
title: IMAPITableFindRow
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.FindRow
api_type:
- COM
ms.assetid: 6511368c-9777-497e-9eea-cf390c04b92e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a5364af229721d101f38d2f054f528169b48c09e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429574"
---
# <a name="imapitablefindrow"></a>IMAPITable::FindRow

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Находит следующую строку в таблице, которая соответствует определенным условиям поиска, и перемещает курсор в эту строку.
  
```cpp
HRESULT FindRow(
LPSRestriction lpRestriction,
BOOKMARK BkOrigin,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpRestriction_
  
> [in] Указатель на структуру [SRestriction,](srestriction.md) которая описывает условия поиска. 
    
 _BkOrigin_
  
> [in] Закладка, идентифицирующие строку, в которой должен начинаться поиск **FindRow.** Закладку можно создать с помощью метода [IMAPITable::CreateBookmark](imapitable-createbookmark.md) или передать одно из следующих предварительно заранее задаваемых значений. 
    
BOOKMARK_BEGINNING 
  
> Выполняет поиск в начале таблицы. 
    
BOOKMARK_CURRENT 
  
> Выполняет поиск по строке в таблице, в которой расположен курсор. 
    
BOOKMARK_END 
  
> Выполняет поиск в конце таблицы. 
    
 _ulFlags_
  
> [in] Битоваяmas флагов, которая управляет направлением поиска. Можно установить следующий флаг:
    
DIR_BACKWARD 
  
> Выполняет поиск в обратном направлении от строки, которая определена закладкой.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция поиска прошла успешно.
    
MAPI_E_INVALID_BOOKMARK 
  
> Закладка в  _параметре BkOrigin_ недействительна, так как она была удалена или находится за пределами последней запрашиваемой строки. 
    
MAPI_E_NOT_FOUND 
  
> Строки, которые соответствуют ограничению, не найдены.
    
MAPI_W_POSITION_CHANGED
  
> Вызов был успешным, но закладка, используемая в операции, больше не устанавливается в той же строке, что и при последнем вызове; если закладка не использовалась, она больше не находится в том положении, в который она была создана. При возвращении этого предупреждения вызов должен быть обработан как успешный. Чтобы проверить это предупреждение, используйте **макрос HR_FAILED.** См. ["Использование макроса для обработки ошибок".](using-macros-for-error-handling.md)
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::FindRow** находит первую строку в таблице для соответствия набору критериев поиска, описанных в структуре **SRestriction,** на который указывает параметр _lpRestriction._ 
  
Обычно **поиск в FindRow** выполняется из указанной закладки. Вызываемая может настроить поиск для перемещения назад от закладки, установив флаг DIR_BACKWARD в _параметре ulFlags._ Поиск вперед начинается с текущей закладки; поиск в обратном направлении начинается со строки перед закладкой. End position of the search is just before the first row found that satisfied the restriction. 
  
Если строка, на которую указывает закладка в параметре  _BkOrigin,_ больше не существует в таблице и в таблице не удается установить новое положение для закладки, **FindRow** возвращает MAPI_E_INVALID_BOOKMARK. Если строка, на которую указывает  _BkOrigin,_ больше не существует и таблица может установить новое положение для закладки, **FindRow** возвращает MAPI_W_POSITION_CHANGED. 
  
Если закладка, переданная  _в BkOrigin,_ BOOKMARK_BEGINNING или BOOKMARK_END, **FindRow** возвращает MAPI_E_NOT_FOUND если совпадающие строки не найдены. Если закладка, используемая в  _BkOrigin,_ BOOKMARK_CURRENT, **FindRow** может возвращать MAPI_W_POSITION_CHANGED но не MAPI_E_INVALID_BOOKMARK, так как всегда имеется текущее положение курсора. 
  
Столбец **свойства PR_INSTANCE_KEY** ([PidTagInstanceKey)](pidtaginstancekey-canonical-property.md)требуется для всех таблиц, а все реализации **FindRow** необходимы для поддержки вызовов, ищите строку на основе PR_INSTANCE_KEY. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Тип поиска префикса, выполняемого **FindRow,** полезен, только если поиск выполняется в том же направлении, что и организация таблицы. Для достижения требуемого поведения функция сравнения,  подразумеваемая RELOP_GE, переданная в структуре ограничений свойств, должна быть той же функцией сравнения, на которой основан порядок сортировки таблицы. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

С помощью **FindRow** можно поддерживать прокрутку на основе строк, введите их пользователем, особенно в полях со списками в диалоговом окке адреса. В этом типе прокрутки пользователи постепенно введите более длинные префиксы нужного строковых значений, и вы можете периодически вызывать **FindRow,** чтобы перейти к первой строке, которая соответствует префиксу. Направление перехода курсора зависит от того, в каком направлении будет запускаться поиск. 
  
Чтобы использовать **FindRow,** необходимо установить закладку. Поиск строк может происходить из любой закладки, в том числе из предустановленных закладок, указывающих текущую позицию, а также начало и конец таблицы. Если в таблице много строк, операция поиска может быть медленной.
  
Используйте ограничение, чтобы найти префикс строки для прокрутки следующим образом. Для переадресации поиска в столбце, отсортженном по возрастанию, и для обратного поиска в столбце, отсортженном в порядке убывающего, передав структуру ограничений свойств в _параметре lpRestriction_ с отношением **RELOP_GE** и соответствующим тегом свойства и префиксом, используя префикс  **GE** тега формата _._ 
  
Дополнительные сведения об использовании структур ограничений для указания фильтра см. в [сведениях об ограничениях.](about-restrictions.md)
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |DwThreadFuncLoadTable  <br/> |MFCMAPI использует метод **IMAPITable::FindRow** для поиска строк, которые соответствуют ограничению.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[SPropertyRestriction](spropertyrestriction.md)
  
[SRestriction](srestriction.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


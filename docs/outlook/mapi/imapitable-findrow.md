---
title: IMAPITableFindRow
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.FindRow
api_type:
- COM
ms.assetid: 6511368c-9777-497e-9eea-cf390c04b92e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a5364af229721d101f38d2f054f528169b48c09e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429574"
---
# <a name="imapitablefindrow"></a>IMAPITable::FindRow

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Находит следующую строку в таблице, которая соответствует определенным критериям поиска и перемещает курсор в эту строку.
  
```cpp
HRESULT FindRow(
LPSRestriction lpRestriction,
BOOKMARK BkOrigin,
ULONG ulFlags
);
```

## <a name="parameters"></a>Parameters

 _lpRestriction_
  
> [in] Указатель на структуру [SRestriction,](srestriction.md) которая описывает критерии поиска. 
    
 _BkOrigin_
  
> [in] Закладки, определяющие строку, в которой **FindRow** должен начать поиск. Закладки можно создать с помощью [метода IMAPITable::CreateBookmark](imapitable-createbookmark.md) или передать одно из следующих предопределяемых значений. 
    
BOOKMARK_BEGINNING 
  
> Поиск с начала таблицы. 
    
BOOKMARK_CURRENT 
  
> Поиск из строки в таблице, где расположен курсор. 
    
BOOKMARK_END 
  
> Поиск в конце таблицы. 
    
 _ulFlags_
  
> [in] Битмашка флагов, которые контролируют направление поиска. Можно установить следующий флаг:
    
DIR_BACKWARD 
  
> Поиск в обратном направлении из строки, выделенной закладкой.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция поиска прошла успешно.
    
MAPI_E_INVALID_BOOKMARK 
  
> Закладки в  _параметре BkOrigin_ недействительны, так как она удалена или находится за пределами последней строки, запрашиваемой. 
    
MAPI_E_NOT_FOUND 
  
> Строк, которые соответствуют ограничению, обнаружено не было.
    
MAPI_W_POSITION_CHANGED
  
> Вызов удался, но закладки, используемые в операции, больше не устанавливаются в том же ряду, что и в последний раз; если закладка не была использована, она больше не находится в том же положении, что и при ее создания. Когда это предупреждение возвращается, вызов должен быть обработан как успешный. Чтобы проверить это предупреждение, используйте **HR_FAILED** макрос. См. в руб. Использование [макроса для обработки ошибок.](using-macros-for-error-handling.md)
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::FindRow** находит первую строку в таблице, чтобы соответствовать набору критериев поиска, описанным в структуре **SRestriction,** на который указывает параметр _lpRestriction._ 
  
Обычно **FindRow** выполняет поиск вперед из указанной закладки. Вызываемая может настроить поиск для перемещения назад от закладки, установив флаг DIR_BACKWARD в параметре _ulFlags._ Поиск вперед начинается с текущего закладки; поиск в обратном направлении начинается с строки до закладки. End position of the search is just before the first row found that satisfied the restriction. 
  
Если строка, на которую указывает закладки в параметре  _BkOrigin,_ больше не существует в таблице и таблица не может установить новое положение для закладки, **FindRow** возвращает MAPI_E_INVALID_BOOKMARK. Если строка, на которую указывает  _BkOrigin,_ больше не существует и таблица может установить новую позицию для закладки, **FindRow** возвращает MAPI_W_POSITION_CHANGED. 
  
Если закладки, переданные в  _BkOrigin,_ BOOKMARK_BEGINNING или BOOKMARK_END, **FindRow** возвращает MAPI_E_NOT_FOUND, если не найдена ни одна строка. Если закладка, используемая в  _BkOrigin,_ BOOKMARK_CURRENT, **FindRow** может MAPI_W_POSITION_CHANGED, но не MAPI_E_INVALID_BOOKMARK, так как всегда имеется текущая позиция курсора. 
  
Столбец **свойств PR_INSTANCE_KEY** [(PidTagInstanceKey)](pidtaginstancekey-canonical-property.md)необходим для всех таблиц, а все реализации **FindRow** необходимы для поддержки вызовов, ищем строку на основе PR_INSTANCE_KEY. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Тип поиска префикса, выполняемый **FindRow,** полезен только в том случае, если поиск выполняется в том же направлении, что и организация таблицы. Для достижения требуемого поведения функция сравнения,  подразумеваемая RELOP_GE, переданной в структуре ограничений свойств, должна быть той же функцией сравнения, на которой основан порядок сортировки таблицы. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вы можете использовать **FindRow** для поддержки прокрутки на основе строк, вбрасуемой пользователем, особенно в полях списков в диалоговом окантовке адресов. В этом типе прокрутки пользователи введите постепенно более длинные префиксы нужного значения строки, и вы можете периодически выдавать вызов **FindRow,** чтобы перейти к первой строке, которая соответствует префиксу. В каком направлении скачет курсор, зависит от того, в каком направлении будет запускаться поиск. 
  
Чтобы использовать **FindRow,** необходимо установить закладки. Поиск строки может происходить из любой закладки, в том числе из заранее закладки с указанием текущего положения и начала и конца таблицы. Если в таблице большое количество строк, операция поиска может быть медленной.
  
Используйте ограничение, чтобы найти префикс строки для прокрутки следующим образом. Для переадресации поиска в столбце, отсортировали в порядке восходящего и для обратного поиска в столбце, отсортировали в порядке убывающего,  передать структуру ограничений свойств в _параметре lpRestriction_ с отношением **RELOP_GE** и соответствующим тегом свойства и префиксом, используя префикс **ge формат тега GE** _._ 
  
Дополнительные сведения об использовании структур ограничений для указания фильтра см. в дополнительных [сведениях об ограничениях.](about-restrictions.md)
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |DwThreadFuncLoadTable  <br/> |MFCMAPI использует **метод IMAPITable::FindRow** для поиска строк, которые соответствуют ограничению.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[SPropertyRestriction](spropertyrestriction.md)
  
[SRestriction](srestriction.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


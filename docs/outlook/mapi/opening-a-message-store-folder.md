---
title: Открытие папки хранилища сообщений
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d858e4fe-822e-4330-9ed3-4b7d22fa51dc
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: df7db013cb435484c721388abab51ab4ba43828f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436540"
---
# <a name="opening-a-message-store-folder"></a><span data-ttu-id="4cd8e-103">Открытие папки хранилища сообщений</span><span class="sxs-lookup"><span data-stu-id="4cd8e-103">Opening a message store folder</span></span>

<span data-ttu-id="4cd8e-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4cd8e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4cd8e-105">Чтобы можно было открыть любую папку, ее идентификатор должен быть доступен.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-105">Before any folder can be opened, its entry identifier must be available.</span></span> <span data-ttu-id="4cd8e-106">Для большинства папок это означает извлечение их свойств **пр_ентрид** .</span><span class="sxs-lookup"><span data-stu-id="4cd8e-106">For most folders, this means retrieving their **PR_ENTRYID** properties.</span></span> <span data-ttu-id="4cd8e-107">Для специальных папок, например, некоторых папок поддерева IPM и других корневых папок, MAPI определяет специальные свойства идентификатора записи, доступные при вызове метода **IMAPIProp::** /PROPS хранилища сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-107">For special folders, such as some of the IPM subtree folders and other root folders, MAPI defines special entry identifier properties that are accessible by calling the message store's **IMAPIProp::GetProps** method.</span></span> <span data-ttu-id="4cd8e-108">Эти идентификаторы записей всегда называются долгосрочными и именуются следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4cd8e-108">These entry identifiers are always long-term and are named as follows:</span></span> 
  
|<span data-ttu-id="4cd8e-109">**Folder**</span><span class="sxs-lookup"><span data-stu-id="4cd8e-109">**Folder**</span></span>|<span data-ttu-id="4cd8e-110">**Свойство "идентификатор записи"**</span><span class="sxs-lookup"><span data-stu-id="4cd8e-110">**Entry identifier property**</span></span>|
|:-----|:-----|
|<span data-ttu-id="4cd8e-111">����� ����������</span><span class="sxs-lookup"><span data-stu-id="4cd8e-111">Outbox folder</span></span>  <br/> |<span data-ttu-id="4cd8e-112">**Пр_ипм_аутбокс_ентрид** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (Только для класса сообщений IPM).</span><span class="sxs-lookup"><span data-stu-id="4cd8e-112">**PR_IPM_OUTBOX_ENTRYID** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md)) (IPM message class only)</span></span>  <br/> |
|<span data-ttu-id="4cd8e-113">папка "Удаленные"</span><span class="sxs-lookup"><span data-stu-id="4cd8e-113">Deleted Items folder</span></span>  <br/> |<span data-ttu-id="4cd8e-114">**Пр_ипм_вастебаскет_ентрид** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-114">**PR_IPM_WASTEBASKET_ENTRYID** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-115">����� �������������</span><span class="sxs-lookup"><span data-stu-id="4cd8e-115">Sent Items folder</span></span>  <br/> |<span data-ttu-id="4cd8e-116">**Пр_ипм_сентмаил_ентрид** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-116">**PR_IPM_SENTMAIL_ENTRYID** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-117">IPM �������� �����</span><span class="sxs-lookup"><span data-stu-id="4cd8e-117">IPM root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-118">**Пр_ипм_субтри_ентрид** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-118">**PR_IPM_SUBTREE_ENTRYID** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-119">�������� ����� ����������� ������</span><span class="sxs-lookup"><span data-stu-id="4cd8e-119">Search-results root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-120">**Пр_финдер_ентрид** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-120">**PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-121">Корневая папка общих представлений</span><span class="sxs-lookup"><span data-stu-id="4cd8e-121">Common views root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-122">**Пр_коммон_виевс_ентрид** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-122">**PR_COMMON_VIEWS_ENTRYID** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-123">Корневая папка личных представлений</span><span class="sxs-lookup"><span data-stu-id="4cd8e-123">Personal views root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-124">**Пр_виевс_ентрид** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-124">**PR_VIEWS_ENTRYID** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-125">Корневая папка контактов</span><span class="sxs-lookup"><span data-stu-id="4cd8e-125">Contacts root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-126">**Пр_ипм_контакт_ентрид** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-126">**PR_IPM_CONTACT_ENTRYID** ([PidTagIpmContactEntryId](pidtagipmcontactentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-127">Корневая папка черновиков</span><span class="sxs-lookup"><span data-stu-id="4cd8e-127">Drafts root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-128">**Пр_ипм_драфтс_ентрид** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-128">**PR_IPM_DRAFTS_ENTRYID** ([PidTagIpmDraftsEntryId](pidtagipmdraftsentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-129">Корневая папка журнала</span><span class="sxs-lookup"><span data-stu-id="4cd8e-129">Journal root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-130">**Пр_ипм_жаурнал_ентрид** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-130">**PR_IPM_JOURNAL_ENTRYID** ([PidTagIpmJournalEntryId](pidtagipmjournalentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-131">Корневая папка календаря</span><span class="sxs-lookup"><span data-stu-id="4cd8e-131">Calendar root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-132">**Пр_ипм_аппоинтмент_ентрид** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-132">**PR_IPM_APPOINTMENT_ENTRYID** ([PidTagIpmAppointmentEntryId](pidtagipmappointmententryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-133">Корневая папка заМеток</span><span class="sxs-lookup"><span data-stu-id="4cd8e-133">Notes root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-134">**Пр_ипм_ноте_ентрид** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-134">**PR_IPM_NOTE_ENTRYID** ([PidTagIpmNoteEntryId](pidtagipmnoteentryid-canonical-property.md))</span></span>  <br/> |
|<span data-ttu-id="4cd8e-135">Корневая папка задач</span><span class="sxs-lookup"><span data-stu-id="4cd8e-135">Tasks root folder</span></span>  <br/> |<span data-ttu-id="4cd8e-136">**Пр_ипм_таск_ентрид** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4cd8e-136">**PR_IPM_TASK_ENTRYID** ([PidTagIpmTaskEntryId](pidtagipmtaskentryid-canonical-property.md))</span></span>  <br/> |
   
<span data-ttu-id="4cd8e-137">Прежде чем попытаться получить один из этих специальных идентификаторов записей, извлеките свойство **\_PR валид_фолдер_маск** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) хранилища сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-137">Before you try to retrieve one of these special entry identifiers, retrieve the **PR\_VALID_FOLDER_MASK** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)) property of the message store.</span></span> <span data-ttu-id="4cd8e-138">**PR\_валид_фолдер_маск** — это битовая маска, указывающая, какие из специальных идентификаторов записей существуют.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-138">**PR\_VALID_FOLDER_MASK** is a bitmask that identifies which of the special entry identifiers exist.</span></span> <span data-ttu-id="4cd8e-139">Для каждой из специальных папок существует один бит.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-139">There is one bit for each of the special folders.</span></span> <span data-ttu-id="4cd8e-140">Если бит задан, он указывает, что соответствующая папка поддерживается и имеет допустимый идентификатор записи.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-140">If the bit is set, it indicates that the corresponding folder is supported and has a valid entry identifier.</span></span> <span data-ttu-id="4cd8e-141">Например, если папка "Удаленные" существует и имеет допустимый идентификатор записи, бит ипм_вастебаскет_валид папки\_будет установлен в **пр_валид_фолдер_маск**.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-141">For example, if the Deleted Items folder exists and has a valid entry identifier, the FOLDER\_IPM_WASTEBASKET_VALID bit will be set in **PR_VALID_FOLDER_MASK**.</span></span> 
  
## <a name="open-the-folder-where-all-incoming-messages-of-a-particular-class-are-placed"></a><span data-ttu-id="4cd8e-142">Открытие папки, в которой размещаются все входящие сообщения определенного класса</span><span class="sxs-lookup"><span data-stu-id="4cd8e-142">Open the folder where all incoming messages of a particular class are placed</span></span>
  
1. <span data-ttu-id="4cd8e-143">Call [IMsgStore:: жетрецеивефолдер](imsgstore-getreceivefolder.md) для получения идентификатора записи, устанавливая параметр _лпсзмессажекласс_ для указания на строку символов, идентифицирующую класс Message.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-143">Call [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md) to retrieve its entry identifier, setting the  _lpszMessageClass_ parameter to point to a character string identifying the message class.</span></span> <span data-ttu-id="4cd8e-144">Например, если вы хотите открыть папку "Входящие" для поддерева IPM, наведите _лпсзмессажекласс_ на IPM.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-144">For example, if you want to open the Inbox for your IPM subtree, point  _lpszMessageClass_ to IPM.</span></span> <span data-ttu-id="4cd8e-145">Если вы хотите открыть папку получения для сообщений IPC, задайте для нее значение IPC.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-145">If you want to open the receive folder for IPC messages, set it to point to IPC.</span></span> 

   <span data-ttu-id="4cd8e-146">Если для класса Message отсутствует зарегистрированная папка получения, **жетрецеивефолдер** выбирает папку получения, связанный класс сообщений которой соответствует максимально возможному префиксу переданного класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-146">If there is no registered receive folder for the message class, **GetReceiveFolder** chooses the receive folder whose associated message class matches the longest possible prefix of the message class passed in.</span></span> <span data-ttu-id="4cd8e-147">Дополнительные сведения см. [](mapi-receive-folders.md)</span><span class="sxs-lookup"><span data-stu-id="4cd8e-147">For more information, see [MAPI Receive Folders](mapi-receive-folders.md).</span></span> 
   
   <span data-ttu-id="4cd8e-148">Обратите внимание, что свойство **пр_ипм_аутбокс_ентрид** используется для открытия папки "Исходящие" только для сообщений IPM.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-148">Note that the **PR_IPM_OUTBOX_ENTRYID** property is used to open the Outbox folder only for IPM messages.</span></span> <span data-ttu-id="4cd8e-149">Если вы открываете папку "исХодящие" для сообщений IPC, используйте идентификатор записи для папки получения.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-149">If you are opening the Outbox for IPC messages, use instead the entry identifier for its receive folder.</span></span> <span data-ttu-id="4cd8e-150">Входящие и исходящие сообщения IPC помещаются в папку Receive.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-150">Both incoming and outgoing IPC messages are placed in the receive folder.</span></span> 
    
2. <span data-ttu-id="4cd8e-151">ВыЗовите один из четырех методов **OpenEntry** , чтобы открыть папку и вернуть указатель интерфейса, который можно использовать для доступа к нему.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-151">Call one of four **OpenEntry** methods to open the folder and return an interface pointer that you can use to access it.</span></span> <span data-ttu-id="4cd8e-152">Чтобы открыть папку, можно вызвать любой из указанных ниже способов.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-152">You can call any one of the following methods to open a folder:</span></span> 
    
   - [<span data-ttu-id="4cd8e-153">IMAPISession::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="4cd8e-153">IMAPISession::OpenEntry</span></span>](imapisession-openentry.md)
    
   - [<span data-ttu-id="4cd8e-154">IMSLogon::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="4cd8e-154">IMSLogon::OpenEntry</span></span>](imslogon-openentry.md)
    
   - [<span data-ttu-id="4cd8e-155">IMsgStore::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="4cd8e-155">IMsgStore::OpenEntry</span></span>](imsgstore-openentry.md)
    
   - [<span data-ttu-id="4cd8e-156">IMAPIContainer::OpenEntry</span><span class="sxs-lookup"><span data-stu-id="4cd8e-156">IMAPIContainer::OpenEntry</span></span>](imapicontainer-openentry.md)
    
   <span data-ttu-id="4cd8e-157">Выбор конкретного способа зависит от открываемой папки и объектов, доступных в данный момент.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-157">The specific method that you choose depends on the folder to be opened and the objects that are available at the time.</span></span> <span data-ttu-id="4cd8e-158">Так как метод **IMAPISession** может открыть любую папку для любого хранилища сообщений в текущем профиле, вызовите этот **OpenEntry** , если вы не знаете ничего о открываемой папке.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-158">Because the **IMAPISession** method can open any folder for any message store in the current profile, call this **OpenEntry** when you do not know anything about the folder to be opened.</span></span> <span data-ttu-id="4cd8e-159">Если вы знаете, к какому хранилищу сообщений принадлежит папка, и у вас есть указатель на хранилище сообщений, вызовите **IMsgStore:: OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-159">If you know which message store owns the folder and you have a pointer to the message store, call **IMsgStore::OpenEntry**.</span></span> 
    
   <span data-ttu-id="4cd8e-160">Например, используйте метод **IMsgStore** для открытия папки получения.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-160">For example, use the **IMsgStore** method to open a receive folder.</span></span> <span data-ttu-id="4cd8e-161">Если у вас есть указатель на объект входа поставщика хранилища сообщений, вызовите метод **имслогон:: OpenEntry**.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-161">If you have a pointer to the message store provider's logon object, call **IMSLogon::OpenEntry**.</span></span> <span data-ttu-id="4cd8e-162">Так как эти вызовы напрямую указывают на поставщика хранилища сообщений, а не через MAPI, обработка выполняется быстрее.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-162">Because these calls go directly to the message store provider rather than through MAPI, processing is faster.</span></span> <span data-ttu-id="4cd8e-163">Если открываемая папка является вложенной папкой уже открытой папки, вызовите метод **IMAPIContainer:: OpenEntry** для открытой папки.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-163">If the folder you are opening is a subfolder of a folder that you already have open, call the open folder's **IMAPIContainer::OpenEntry** method.</span></span> <span data-ttu-id="4cd8e-164">Метод **IMAPIContainer** открывает только вложенные папки в текущей открытой папке и является единственным методом, который гарантированно работает с краткосрочными идентификаторами записей.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-164">The **IMAPIContainer** method only opens subfolders of a currently opened folder and is the only method guaranteed to work with short-term entry identifiers.</span></span> 
    
3. <span data-ttu-id="4cd8e-165">Если вы хотите, чтобы вы могли вносить изменения в открываемую папку, укажите уровень доступа, задав в вызове **OpenEntry** либо флаг\_"\_лучший доступ"\_MAPI, либо флаг изменения MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-165">If you want to be able to make changes to the folder to be opened, specify an access level by setting either the MAPI\_BEST\_ACCESS or MAPI\_MODIFY flag in the **OpenEntry** call.</span></span> <span data-ttu-id="4cd8e-166">Эти флаги являются рекомендациями для поставщика хранилища сообщений для предоставления максимального уровня доступа, для наилучшего\_\_доступа к MAPI, а также для чтения и записи,\_для изменения MAPI при открытии папки.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-166">These flags are suggestions to the message store provider to grant the highest level of access, for MAPI\_BEST\_ACCESS, or read/write access, for MAPI\_MODIFY, when opening the folder.</span></span> 

   <span data-ttu-id="4cd8e-167">Так как эти флаги являются только рекомендациями, папка может быть открыта и не может быть открыта с ожидаемым уровнем доступа.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-167">Because these flags are only suggestions, the folder may or may not be opened with the access level you expect.</span></span> <span data-ttu-id="4cd8e-168">Получив свойство **пр_акцесс** ([PidTagAccess](pidtagaccess-canonical-property.md)), можно определить диапазон операций, которые можно выполнить для открытой папки.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-168">By retrieving the **PR_ACCESS** ([PidTagAccess](pidtagaccess-canonical-property.md)) property, you can determine the range of operations that can be performed on the open folder.</span></span> 
    
   <span data-ttu-id="4cd8e-169">Тем не менее, так как многие поставщики хранилищ сообщений рассчитывают значение этого свойства по запросу, а не поддерживают его как свойство Folder или как столбец в их иерархической таблице, то извлечение может занимать много времени.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-169">However, because many message store providers calculate the value for this property on demand rather than supporting it as a folder property or as a column in their hierarchy table, retrieving it can be time-consuming.</span></span> <span data-ttu-id="4cd8e-170">Альтернативная стратегия заключается в попытке выполнить любую операцию и при необходимости возвратить сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="4cd8e-170">An alternate strategy is to attempt whatever operation you need to perform and return an error if necessary.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="4cd8e-171">См. также</span><span class="sxs-lookup"><span data-stu-id="4cd8e-171">See also</span></span>

- [<span data-ttu-id="4cd8e-172">Каноническое свойство PidTagEntryId</span><span class="sxs-lookup"><span data-stu-id="4cd8e-172">PidTagEntryId Canonical Property</span></span>](pidtagentryid-canonical-property.md) 
- [<span data-ttu-id="4cd8e-173">IMAPIProp::GetProps</span><span class="sxs-lookup"><span data-stu-id="4cd8e-173">IMAPIProp::GetProps</span></span>](imapiprop-getprops.md)


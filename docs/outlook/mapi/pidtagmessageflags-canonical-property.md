---
title: Каноническое свойство PidTagMessageFlags
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- PidTagMessageFlags
api_type:
- HeaderDef
ms.assetid: 7561112b-ca72-4c49-a8a0-cc1879a4e151
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5b660b592e77279a4d60f3a036724341352c9b6a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325746"
---
# <a name="pidtagmessageflags-canonical-property"></a>Каноническое свойство PidTagMessageFlags

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Содержит битовую маску флагов, указывающих происхождение и текущее состояние сообщения. 
  
|||
|:-----|:-----|
|Связанные свойства:  <br/> |PR_MESSAGE_FLAGS  <br/> |
|Идентификатор:  <br/> |0x0E07  <br/> |
|Тип данных:  <br/> |PT_LONG  <br/> |
|Область:  <br/> |Общий обмен сообщениями  <br/> |
   
## <a name="remarks"></a>Примечания

Это свойство является неотправляющим свойством сообщения, которое предоставляется как при отправке, так и получении окончанием передачи, с разными значениями в зависимости от того, какое клиентское приложение или поставщик хранилища задействованы. Это свойство инициализируется клиентом или поставщиком хранилища сообщений, когда сообщение создается и сохраняется в первый раз, а затем периодически обновляется поставщиком хранилища сообщений, поставщиком транспорта и диспетчером MAPI при обработке сообщения и изменяется его состояние. 
  
Это свойство существует в сообщении как до, так и после отправки, а также на всех копиях полученного сообщения. Несмотря на то, что он не является свойством получателя, он предоставляется по-разному для каждого получателя в зависимости от того, было ли оно прочитано или изменено этим получателем. 
  
Для этого свойства можно задать один или несколько из следующих флагов:
  
MSGFLAG_ASSOCIATED 
  
> Сообщение является связанным сообщением папки. Клиент или поставщик имеет доступ к этому флагу только для чтения. Флаг MSGFLAG_READ игнорируется для связанных сообщений, в которых не сохраняется состояние чтения и непрочтенных сообщений. 
    
MSGFLAG_FROMME 
  
> Пользователь обмена сообщениями получил сообщение. Клиент или поставщик имеет доступ на чтение и запись к этому флагу до первого вызова [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) и только для чтения. Этот флаг предназначен для установки поставщиком транспорта. 
    
MSGFLAG_HASATTACH 
  
> Сообщение содержит по крайней мере одно вложение. Этот флаг соответствует свойству **PR_HASATTACH** сообщения ([PidTagHasAttachments](pidtaghasattachments-canonical-property.md)). Клиент имеет доступ только для чтения к этому флагу. 
    
MSGFLAG_NRN_PENDING 
  
> Отчет о непрочтении необходимо отправить для сообщения. Клиент или поставщик имеет доступ к этому флагу только для чтения. 
    
MSGFLAG_ORIGIN_INTERNET 
  
> Входящее сообщение получено через Интернет. Он был создан либо за предельным названием организации, либо из источника, который шлюз не может считать доверенным. Клиент должен отобразить соответствующее сообщение для пользователя. Поставщики транспорта устанавливают этот флаг; Клиент имеет доступ только для чтения. 
    
MSGFLAG_ORIGIN_MISC_EXT 
  
> Входящее сообщение получено по внешнему каналу, отличному от X. 400 или Интернета. Он был создан либо за предельным названием организации, либо из источника, который шлюз не может считать доверенным. Клиент должен отобразить соответствующее сообщение для пользователя. Поставщики транспорта устанавливают этот флаг; Клиент имеет доступ только для чтения. 
    
MSGFLAG_ORIGIN_X400 
  
> Входящее сообщение получено по ссылке X. 400. Он был создан либо за предельным названием организации, либо из источника, который шлюз не может считать доверенным. Клиент должен отобразить соответствующее сообщение для пользователя. Поставщики транспорта устанавливают этот флаг; Клиент имеет доступ только для чтения. 
    
MSGFLAG_READ 
  
> Сообщение помечено как прочитанное. Это может произойти в результате вызова в любой момент времени на [iMessage:: сетреадфлаг](imessage-setreadflag.md) или [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md). Клиенты также могут установить этот флаг, вызвав метод сообщения **IMAPIProp:: SetProps** , прежде чем сообщение будет сохранено в первый раз. Этот флаг игнорируется, если установлен флаг **MSGFLAG_ASSOCIATED** . 
    
MSGFLAG_RESEND 
  
> Сообщение содержит запрос на операцию повторной отправки с отчетом о недоставке. Клиент или поставщик имеет доступ на чтение и запись к этому флагу до первого вызова [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) и только для чтения. 
    
MSGFLAG_RN_PENDING 
  
> Для сообщения необходимо отправить отчет о прочтении. Клиент или поставщик имеет доступ к этому флагу только для чтения. 
    
MSGFLAG_SUBMIT 
  
> Сообщение помечено для отправки в результате вызова [iMessage:: субмитмессаже](imessage-submitmessage.md). Поставщики хранилища сообщений устанавливают этот флаг; Клиент имеет доступ только для чтения. 
    
MSGFLAG_UNMODIFIED 
  
> Исходящее сообщение не было изменено с момента первого сохранения; входящее сообщение не было изменено, так как оно было доставлено. 
    
MSGFLAG_UNSENT 
  
> Сообщение по-прежнему формируется. Он сохраняется, но не отправлен. Клиент или поставщик имеет доступ на чтение и запись к этому флагу до первого вызова [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) и только для чтения. Если клиент не устанавливает этот флаг на время отправки сообщения, поставщик хранилища сообщений задает его при вызове **iMessage:: субмитмессаже** . Как правило, этот флаг удаляется после отправки сообщения. 
    
Клиент или поставщик хранилища сообщений может проверить текущее состояние сообщения в любое время, вызвав метод [IMAPIProp::-PROPS](imapiprop-getprops.md) для считывания значений флагов. Клиент или поставщик также может вызвать метод [IMAPIProp:: SetProps](imapiprop-setprops.md) , чтобы изменить флаги, доступные для чтения и записи в данный момент. 
  
Некоторые флаги всегда доступны только для чтения. Некоторые из них доступны для чтения и записи, пока первый вызов метода [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) и затем становится доступен только для чтения, как **IMAPIProp:: SetProps** . Одно из них, MSGFLAG_READ, можно изменить позже с помощью [iMessage:: сетреадфлаг](imessage-setreadflag.md) или [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md). 
  
Исходные значения этого свойства обычно MSGFLAG_UNSENT и MSGFLAG_UNMODIFIED, чтобы указать сообщение, которое еще не было отправлено или изменено. Когда сообщение сохраняется в второй раз, поставщик хранилища сообщений очищает флаг MSGFLAG_UNMODIFIED. Другое значение, которое может задать поставщик хранилища сообщений при сохранении сообщения — это MSGFLAG_HASATTACH флаг, указывающий на то, что сообщение имеет одно или несколько вложений. Свойство **PR_HASATTACH** вычисляется по этому параметру. 
  
Когда клиент вызывает метод [iMessage:: субмитмессаже](imessage-submitmessage.md) для отправки сообщения, поставщик хранилища сообщений создает его копию для ДИСПЕТЧЕРА очереди MAPI и обновляет это свойство, устанавливая флаг MSGFLAG_SUBMIT. Поставщик хранилища сообщений также устанавливает MSGFLAG_UNSENT, если он еще не задан. MSGFLAG_SUBMIT указывает, что был вызван **субмитмессаже** , начат процесс отправки, а теперь сообщение доступно только для чтения клиенту. MSGFLAG_UNSENT указывает, что диспетчер очереди MAPI обрабатывает сообщение. Если процесс отправки отменяется, поставщик хранилища сообщений сбрасывает этот флаг. 
  
Когда сообщение передается поставщику транспорта для доставки, поставщик транспорта устанавливает флаг MSGFLAG_FROMME, если отправитель имел ту же учетную запись на сервере обмена сообщениями, в котором оно было получено. Поставщики транспорта устанавливают MSGFLAG_FROMME для входящего сообщения, отправленного пользователем, вошедшим в систему. Клиент может использовать это значение, чтобы определить, является ли более уместным отображение имен получателей в таблице содержимого папки "Отправленные", чем имена отправителей. Сообщения, сохраненные во время процесса композиции и еще не отправленные, также должны отображаться с именами получателей, а не отправителями. 
  
Для входящего сообщения поставщик хранилища сообщений очищает флаг MSGFLAG_READ, чтобы сбросить его состояние прочтения. Клиент может установить или снять флаг MSGFLAG_READ, когда необходимо изменить состояние чтения и управлять отправкой отчетов о прочтении и непрочтении, вызвав метод сообщения [iMessage:: сетреадфлаг](imessage-setreadflag.md) или его папку [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md) . Основное различие между этими методами, кроме объекта, реализующего их, заключается в том, что метод Folder может повлиять на одно, несколько или все сообщения в папке. Метод Message влияет на одно сообщение. 
  
Клиент также должен проверить входящее сообщение для MSGFLAG_ORIGIN_X400, MSGFLAG_ORIGIN_INTERNET и MSGFLAG_ORIGIN_MISC_EXTных флагов. Эти флаги устанавливаются поставщиком входящих транспорта и указывают на то, что сообщение было получено из источника, который шлюз не может считать доверенным. Это означает, что сообщение было отправлено либо вне Организации, либо на рабочей станции, не известной шлюзу. В любом случае удостоверение отправителя может быть не подтверждено, и существует риск внедрения компьютерных вирусов в организацию. Клиент должен отобразить предупреждение пользователю и предоставить возможность удалить сообщение, не открывая его. 
  
Поставщики хранилища сообщений устанавливают флаг MSGFLAG_UNMODIFIED для входящих сообщений. MSGFLAG_UNMODIFIED указывает, что сообщение не было изменено после доставки. Клиент не может очистить это значение после того, как оно было задано поставщиком хранилища сообщений. 
  
## <a name="related-resources"></a>Связанные ресурсы

### <a name="protocol-specifications"></a>Спецификации протокола

[[MS — ОКСПРОПС]](https://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx)
  
> Содержит ссылки на соответствующие спецификации протоколов Exchange Server.
    
[[MS — ОКСКМСГ]](https://msdn.microsoft.com/library/7fd7ec40-deec-4c06-9493-1bc06b349682%28Office.15%29.aspx)
  
> Обрабатывает объекты сообщений и вложений.
    
### <a name="header-files"></a>Файлы заголовков

MAPIDEFS. h
  
> Содержит определения типов данных.
    
Мапитагс. h
  
> Содержит определения свойств, перечисленных как альтернативные имена.
    
## <a name="see-also"></a>См. также



[IMsgStore::AbortSubmit](imsgstore-abortsubmit.md)


[Свойства MAPI](mapi-properties.md)
  
[Каноническое свойство MAPI](mapi-canonical-properties.md)
  
[Сопоставление имен канонических свойств с именами MAPI](mapping-canonical-property-names-to-mapi-names.md)
  
[Сопоставление имен MAPI с именами канонических свойств](mapping-mapi-names-to-canonical-property-names.md)


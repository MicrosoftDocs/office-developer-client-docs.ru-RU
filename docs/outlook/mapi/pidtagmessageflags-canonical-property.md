---
title: Каноническое свойство PidTagMessageFlags
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- PidTagMessageFlags
api_type:
- HeaderDef
ms.assetid: 7561112b-ca72-4c49-a8a0-cc1879a4e151
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 5b660b592e77279a4d60f3a036724341352c9b6a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325746"
---
# <a name="pidtagmessageflags-canonical-property"></a>Каноническое свойство PidTagMessageFlags

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Содержит битмаску флагов, которые указывают происхождение и текущее состояние сообщения. 
  
|||
|:-----|:-----|
|Связанные свойства:  <br/> |PR_MESSAGE_FLAGS  <br/> |
|Идентификатор:  <br/> |0x0E07  <br/> |
|Тип данных:  <br/> |PT_LONG  <br/> |
|Область:  <br/> |Общие сообщения  <br/> |
   
## <a name="remarks"></a>Примечания

Это свойство является свойством непередаваемых сообщений, которое подвергается как на отправляющих, так и на приемных концах передачи, с различными значениями в зависимости от клиентского приложения или поставщика хранения. Это свойство инициализировано клиентом или поставщиком магазина сообщений, когда сообщение создается и сохраняется впервые, а затем периодически обновляется поставщиком, поставщиком транспорта и пулером MAPI по мере обработки сообщения и изменения его состояния. 
  
Это свойство существует в сообщении до и после отправки и во всех копиях полученного сообщения. Несмотря на то, что оно не является свойством получателя, оно по-разному передается каждому получателю в зависимости от того, было ли оно прочитано или изменено этим получателем. 
  
Для этого свойства можно установить один или несколько следующих флагов:
  
MSGFLAG_ASSOCIATED 
  
> Сообщение — это связанное сообщение папки. Клиент или поставщик имеет доступ только для чтения к этому флагу. Флаг MSGFLAG_READ игнорируется для связанных сообщений, которые не сохраняют состояние чтения и чтения. 
    
MSGFLAG_FROMME 
  
> Отправив сообщение, пользователь сообщения получал сообщение. Клиент или поставщик имеют доступ к этому флагу до первого вызова [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и после этого только для чтения. Этот флаг должен быть установлен поставщиком транспорта. 
    
MSGFLAG_HASATTACH 
  
> Сообщение имеет по крайней мере одно вложение. Этот флаг соответствует свойству  PR_HASATTACH[(PidTagHasAttachments).](pidtaghasattachments-canonical-property.md) Клиент имеет доступ только для чтения к этому флагу. 
    
MSGFLAG_NRN_PENDING 
  
> Для сообщения необходимо отправить непрочитанные отчеты. Клиент или поставщик имеет доступ только для чтения к этому флагу. 
    
MSGFLAG_ORIGIN_INTERNET 
  
> Входящие сообщения поступили через Интернет. Она возникла либо за пределами организации, либо из источника, который шлюз не может считать доверенным. Клиент должен отображать соответствующее сообщение пользователю. Поставщики транспорта устанавливают этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_ORIGIN_MISC_EXT 
  
> Входящие сообщения прибыли по внешней ссылке, кроме X.400 или Интернета. Она возникла либо за пределами организации, либо из источника, который шлюз не может считать доверенным. Клиент должен отображать соответствующее сообщение пользователю. Поставщики транспорта устанавливают этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_ORIGIN_X400 
  
> Входящие сообщения поступили по ссылке X.400. Она возникла либо за пределами организации, либо из источника, который шлюз не может считать доверенным. Клиент должен отображать соответствующее сообщение пользователю. Поставщики транспорта устанавливают этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_READ 
  
> Сообщение помечено как прочитано. Это может произойти в результате вызова в любое время [в IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md). Клиенты также могут установить этот флаг, позвонив по методу **IMAPIProp::SetProps,** прежде чем сообщение будет сохранено впервые. Этот флаг игнорируется, **если MSGFLAG_ASSOCIATED** заданной. 
    
MSGFLAG_RESEND 
  
> В сообщении содержится запрос на операцию повторной работы с отчетом о неделивстве. Клиент или поставщик имеют доступ к этому флагу до первого вызова [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и после этого только для чтения. 
    
MSGFLAG_RN_PENDING 
  
> Для сообщения необходимо отправить отчет о считыве. Клиент или поставщик имеет доступ только для чтения к этому флагу. 
    
MSGFLAG_SUBMIT 
  
> Сообщение помечено для отправки в результате вызова [в IMessage::SubmitMessage](imessage-submitmessage.md). Поставщики магазина сообщений устанавливают этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_UNMODIFIED 
  
> Исходяние сообщения не было изменено с момента первого с момента его сберегу- входящие сообщения не были изменены с момента его доставки. 
    
MSGFLAG_UNSENT 
  
> Сообщение по-прежнему составляется. Он сохранен, но не отправлен. Клиент или поставщик имеют доступ к этому флагу до первого вызова [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и после этого только для чтения. Если клиент не задает этот флаг к моменту отправки сообщения, поставщик магазина сообщений задает его при запросе **IMessage::SubmitMessage.** Как правило, этот флаг очищается после сообщения. 
    
Клиент или поставщик магазина сообщений может проверить текущее состояние сообщения в любое время, позвонив по методу [IMAPIProp::GetProps](imapiprop-getprops.md) для чтения значений флага. Клиент или поставщик также может вызвать [метод IMAPIProp::SetProps,](imapiprop-setprops.md) чтобы изменить любые флаги, которые в настоящее время имеют доступ к чтением и записи. 
  
Некоторые флаги всегда только для чтения. Некоторые из них читают и пишут до первого вызова метода [IMAPIProp::SaveChanges,](imapiprop-savechanges.md) а затем становятся только для чтения, если речь идет **о IMAPIProp::SetProps.** Один из них, MSGFLAG_READ, можно изменить позже с [помощью IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md). 
  
Начальные значения для этого свойства обычно MSGFLAG_UNSENT и MSGFLAG_UNMODIFIED указывают сообщение, которое еще не отправлено или изменено. Когда сообщение сохраняется во второй раз, поставщик магазина сообщений очищает флаг MSGFLAG_UNMODIFIED. Еще одно значение, которое поставщик магазина сообщений может установить при сберегать сообщение, MSGFLAG_HASATTACH флага, указывающее, что в сообщении имеется одно или несколько вложений. Свойство **PR_HASATTACH** вычисляется из этого параметра. 
  
Когда клиент вызывает метод [IMessage::SubmitMessage](imessage-submitmessage.md) для отправки сообщения, поставщик магазина сообщений создает его копию для пульпера MAPI и обновляет это свойство, установив флаг MSGFLAG_SUBMIT. Поставщик хранения сообщений также задает MSGFLAG_UNSENT, если он еще не установлен. MSGFLAG_SUBMIT указывает, что был вызван **SubmitMessage,** который начинает процесс отправки, и что сообщение теперь только для чтения для клиента. MSGFLAG_UNSENT указывает, что пульпер MAPI занимается сообщением. Если процесс отправки отменяется, поставщик магазина сообщений сбрасывает этот флаг. 
  
Когда сообщение предоставляется поставщику транспорта для доставки, поставщик транспорта задает флаг MSGFLAG_FROMME, если у отправщика была та же учетная запись на сервере обмена сообщениями, что и сообщение. Поставщики транспорта MSGFLAG_FROMME для входящих сообщений, отправленных пользователем, зарегистрированным в настоящее время. Клиент может использовать это значение, чтобы определить, что в таблице содержимого папки отправленных элементов более уместно показывать имена получателей, чем имена отправитель. Сообщения, которые были сохранены в процессе композиции и еще не отправлены, также должны отображаться с именами получателей, а не именами отправитель. 
  
Для входящих сообщений поставщик магазина сообщений очищает флаг MSGFLAG_READ для сброса состояния чтения. Клиент может установить или очистить флаг MSGFLAG_READ, если необходимо изменить состояние чтения и контролировать отправку отчетов о считывке и непрочитанности, позвонив [методу IMessage::SetReadFlag](imessage-setreadflag.md) сообщения или [методу IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) его папки. Основное отличие этих методов, помимо реализуемого объекта, состоит в том, что метод папок может повлиять на одно, несколько или все сообщения в папке. Метод сообщения влияет на одно сообщение. 
  
Клиент также должен протестировать входящие сообщения для MSGFLAG_ORIGIN_X400, MSGFLAG_ORIGIN_INTERNET и MSGFLAG_ORIGIN_MISC_EXT флагов. Эти флаги устанавливаются поставщиком входящий транспорта и указывают, что сообщение поступило из источника, который шлюз не может считать доверенным. Это означает, что сообщение возникло либо за пределами организации, либо внутренне, но с рабочей станции, не известной шлюзу. В любом случае, личность отправитель не может быть подтверждена, и существует риск внедрения компьютерного вируса в организацию. Клиент должен отобразить предупреждение пользователю и предложить возможность удаления сообщения без его открытия. 
  
Поставщики магазина сообщений устанавливают флаг MSGFLAG_UNMODIFIED для входящих сообщений. MSGFLAG_UNMODIFIED указывает, что сообщение не было изменено с момента доставки. Клиент не может очистить это значение после того, как оно было заданной поставщиком магазина сообщений. 
  
## <a name="related-resources"></a>Связанные ресурсы

### <a name="protocol-specifications"></a>Спецификации протокола

[[MS-OXPROPS]](https://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx)
  
> Содержит ссылки на связанные Exchange Server протоколы.
    
[[MS-OXCMSG]](https://msdn.microsoft.com/library/7fd7ec40-deec-4c06-9493-1bc06b349682%28Office.15%29.aspx)
  
> Обрабатывает объекты сообщений и вложений.
    
### <a name="header-files"></a>Файлы заголовки

Mapidefs.h
  
> Предоставляет определения типов данных.
    
Mapitags.h
  
> Содержит определения свойств, перечисленных в качестве альтернативных имен.
    
## <a name="see-also"></a>См. также



[IMsgStore::AbortSubmit](imsgstore-abortsubmit.md)


[Свойства MAPI](mapi-properties.md)
  
[Канонические свойства MAPI](mapi-canonical-properties.md)
  
[Сопоставление имен канонических свойств с именами MAPI](mapping-canonical-property-names-to-mapi-names.md)
  
[Сопоставление имен MAPI с каноническими именами свойств](mapping-mapi-names-to-canonical-property-names.md)


---
title: Каноническое свойство PidTagMessageFlags
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- PidTagMessageFlags
api_type:
- HeaderDef
ms.assetid: 7561112b-ca72-4c49-a8a0-cc1879a4e151
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 8082b0b6d47a16a79f5e426375e20b17d22298d4
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22586622"
---
# <a name="pidtagmessageflags-canonical-property"></a>Каноническое свойство PidTagMessageFlags

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Содержит битовую маску флагов, которые указывают происхождения и текущее состояние сообщения. 
  
|||
|:-----|:-----|
|Связанные свойства:  <br/> |PR_MESSAGE_FLAGS  <br/> |
|Идентификатор:  <br/> |0x0E07  <br/> |
|Тип данных:  <br/> |PT_LONG  <br/> |
|Область:  <br/> |Общие системы обмена сообщениями  <br/> |
   
## <a name="remarks"></a>Замечания

Это свойство является свойство nontransmittable сообщения на отправку и получение концах передаваемых данных с другими значениями, в зависимости от приложения или хранилища поставщик клиента участвующих. Это свойство является инициализирован с помощью клиента или сообщения поставщика хранилища при сообщение создан и сохранен в первый раз и затем периодически обновляются, поставщика хранилища сообщений, поставщика транспорта и диспетчер очереди MAPI при обработки сообщения и его состояния изменения. 
  
Это свойство существует до и после отправки сообщения, а также на все копии полученного сообщения. Несмотря на то, что оно не является свойством получателей, она предоставляется по-разному для каждого получателя, определяется ли он читать или изменяемые получателя. 
  
Для этого свойства может быть установлено одно или несколько из следующих флагов:
  
MSGFLAG_ASSOCIATED 
  
> Сообщение является связанного сообщения из папки. Клиент или поставщик имеет доступ только для чтения, чтобы этот флаг. Флаг MSGFLAG_READ игнорируется для связанного сообщения, которые не следует сохранять чтения/непрочитанные состояний. 
    
MSGFLAG_FROMME 
  
> Отправка обмена сообщениями пользователя был пользователя обмена мгновенными сообщениями, получение сообщения. Клиента или поставщика имеет доступ на чтение и запись к этот флаг до первого вызова [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и только для чтения в дальнейшем. Этот флаг предназначен для установки поставщика транспорта. 
    
MSGFLAG_HASATTACH 
  
> Сообщение имеет по крайней мере одного вложения. Этот флаг соответствует свойству **PR_HASATTACH** ([PidTagHasAttachments](pidtaghasattachments-canonical-property.md)) сообщение. Клиент имеет доступ только для чтения, чтобы этот флаг. 
    
MSGFLAG_NRN_PENDING 
  
> Nonread отчета должна отправляться сообщения. Клиент или поставщик имеет доступ только для чтения, чтобы этот флаг. 
    
MSGFLAG_ORIGIN_INTERNET 
  
> Входящее сообщение было доставлено в Интернете. Она была создана за пределами организации или из источника, которые шлюз нельзя обратить внимание надежные. Клиент отображать соответствующего сообщения для пользователя. Поставщики транспорта установить этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_ORIGIN_MISC_EXT 
  
> Входящее сообщение было доставлено на внешний ресурс, отличный от X.400 или Интернета. Она была создана за пределами организации или из источника, которые шлюз нельзя обратить внимание надежные. Клиент отображать соответствующего сообщения для пользователя. Поставщики транспорта установить этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_ORIGIN_X400 
  
> Входящее сообщение было доставлено через связь X.400. Она была создана за пределами организации или из источника, которые шлюз нельзя обратить внимание надежные. Клиент отображать соответствующего сообщения для пользователя. Поставщики транспорта установить этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_READ 
  
> Сообщение помечено как прочтение. Это может произойти в результате вызова в любое время [IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md). Клиенты могут также необходимо задать этот флаг, вызвав метод **IMAPIProp::SetProps** сообщения перед сообщения был сохранен в первый раз. Этот флаг игнорируется, если установлен флаг **MSGFLAG_ASSOCIATED** . 
    
MSGFLAG_RESEND 
  
> Сообщение содержит запрос для выполнения операции повторная отправка с отчетом о недоставке. Клиента или поставщика имеет доступ на чтение и запись к этот флаг до первого вызова [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и только для чтения в дальнейшем. 
    
MSGFLAG_RN_PENDING 
  
> Чтение отчета необходимо отправить сообщения. Клиент или поставщик имеет доступ только для чтения, чтобы этот флаг. 
    
MSGFLAG_SUBMIT 
  
> Сообщение помечено для отправки в результате вызова [IMessage::SubmitMessage](imessage-submitmessage.md). Поставщики хранилища сообщений следует установить этот флаг; клиент имеет доступ только для чтения. 
    
MSGFLAG_UNMODIFIED 
  
> Исходящие сообщения не были изменены с момента первый раз, он был сохранен; входящие сообщения не были ли изменены, поскольку оно было доставлено. 
    
MSGFLAG_UNSENT 
  
> Сообщение по-прежнему состоит. Сохраняется, но не отправляются. Клиента или поставщика имеет доступ на чтение и запись к этот флаг до первого вызова [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и только для чтения в дальнейшем. Если клиент не установлен этот флаг с момента отправки сообщения, поставщик хранения сообщений настраивается при вызове **IMessage::SubmitMessage** . Как правило этот флажок снят, после отправки сообщения. 
    
Клиент или сообщение поставщика хранилища можно проверить текущее состояние сообщения в любое время путем вызова метода [IMAPIProp::GetProps](imapiprop-getprops.md) для считывания значений флаг. Клиента или поставщика можно также вызвать метод [IMAPIProp::SetProps](imapiprop-setprops.md) для изменения любого флаги, которые в настоящее время имеют доступ на чтение и запись. 
  
Некоторые из флаги всегда доступны только для чтения. Некоторые, чтение и запись только после первого вызова метода [IMAPIProp::SaveChanges](imapiprop-savechanges.md) , после чего доступны только для чтения, как заинтересована в **IMAPIProp::SetProps** . Одно из следующих MSGFLAG_READ, можно изменить позднее через [IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md). 
  
Начальные значения для этого свойства являются MSGFLAG_UNSENT и MSGFLAG_UNMODIFIED для указания сообщения, которые еще не отправляются или изменены. Когда сообщение сохраняется при повторном подключении, поставщик хранения сообщений сбрасывает MSGFLAG_UNMODIFIED. Другим значением, поставщик хранения сообщений можно задать при сохранении сообщение имеет флаг MSGFLAG_HASATTACH, указывающего на то, что сообщение имеет одно или несколько вложений. Свойство **PR_HASATTACH** вычисляется из этого параметра. 
  
Когда клиент вызывает метод [IMessage::SubmitMessage](imessage-submitmessage.md) , чтобы отправить сообщение, поставщик хранения сообщений создается копия для очереди MAPI и обновляет это свойство, установив флаг MSGFLAG_SUBMIT. Поставщик хранения сообщений также устанавливает MSGFLAG_UNSENT, если он еще не установлен. MSGFLAG_SUBMIT указывает, что **SubmitMessage** вызова начать процесс отправки и сообщение теперь доступны только для чтения к клиенту. MSGFLAG_UNSENT указывает, что диспетчер очереди MAPI обрабатывает сообщение. Если отмены процесса отправки поставщика хранилища сообщений восстанавливаются значения по умолчанию этот флаг. 
  
Когда сообщение передается поставщика транспорта для доставки, поставщика транспорта устанавливает флаг MSGFLAG_FROMME Если отправитель имеет ту же учетную запись на сервер обмена сообщениями, как сообщение было получено на. Поставщики транспорта задайте MSGFLAG_FROMME для входящего сообщения, отправленного с текущего пользователя. Клиент может использовать это значение для определения, что более подходящим для отображения имен получателей в таблице содержимое папка «Отправленные», чем имена отправителя. Сообщения, которые сохраняются во время процесса формирования и еще не отправляются также должно отображаться с имена получателей, а не отправителя. 
  
Для входящего сообщения поставщик хранения сообщений сбрасывает MSGFLAG_READ сбросить состояние чтения. Клиент можно установить или сбросить флаг MSGFLAG_READ, если это необходимо изменить состояние чтения и контролировать отправку отчетов чтения и nonread, путем вызова метода [IMessage::SetReadFlag](imessage-setreadflag.md) сообщения или его папки [IMAPIFolder:: SetReadFlags](imapifolder-setreadflags.md) метод. Основное различие между эти методы, отличный от объект, реализующий их, — это что метод папки может повлиять на один, некоторые или все сообщения в папке. Метод сообщения влияет на одного сообщения. 
  
Клиент также следует тестировать входящие сообщения для флаги MSGFLAG_ORIGIN_X400, MSGFLAG_ORIGIN_INTERNET и MSGFLAG_ORIGIN_MISC_EXT. Эти флаги задаются поставщиком входящего транспорта и указывает, что сообщение было доставлено из источника, шлюз не может учитывать надежные. Это означает, что было создано сообщение либо за пределами организации, или во внутренней сети, но с рабочей станции не известен на шлюз. В любом случае не удается подтвердить личность отправителя и риск краткие сведения о компьютере вирус в организации. Клиент должен отображать предупреждение для пользователя и предоставлена возможность удалить сообщение без его открытия. 
  
Поставщики хранилища сообщений установите флаг MSGFLAG_UNMODIFIED для входящих сообщений. MSGFLAG_UNMODIFIED указывает, что сообщение не были изменены с момента доставки. Клиент не может очистить это значение после установки поставщиком хранилища сообщений. 
  
## <a name="related-resources"></a>Связанные ресурсы

### <a name="protocol-specifications"></a>Спецификации протокола

[[MS-OXPROPS]](http://msdn.microsoft.com/library/f6ab1613-aefe-447d-a49c-18217230b148%28Office.15%29.aspx)
  
> Содержит ссылки на связанные спецификаций протокола Exchange Server.
    
[[MS-OXCMSG]](http://msdn.microsoft.com/library/7fd7ec40-deec-4c06-9493-1bc06b349682%28Office.15%29.aspx)
  
> Обрабатывает объекты сообщения и вложения.
    
### <a name="header-files"></a>Файлы заголовков

Mapidefs.h
  
> Содержит определения типов данных.
    
Mapitags.h
  
> Содержит определения свойства в списке альтернативных имен.
    
## <a name="see-also"></a>См. также



[IMsgStore::AbortSubmit](imsgstore-abortsubmit.md)


[Свойства MAPI](mapi-properties.md)
  
[Каноническое свойства MAPI](mapi-canonical-properties.md)
  
[Сопоставление имен канонических свойств с именами MAPI](mapping-canonical-property-names-to-mapi-names.md)
  
[Сопоставление имен MAPI с именами канонических свойств](mapping-mapi-names-to-canonical-property-names.md)


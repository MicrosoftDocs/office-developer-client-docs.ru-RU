---
title: имапитаблерестрикт
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.Restrict
api_type:
- COM
ms.assetid: a5bfc190-b58f-44c3-893c-8727df14ee58
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 6cca6bc12fa6f100885b7bf705d79fa24a2e2f91
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414622"
---
# <a name="imapitablerestrict"></a>IMAPITable::Restrict

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Применяет фильтр к таблице, уменьшая набор строк только на те строки, которые соответствуют заданному условию.
  
```cpp
HRESULT Restrict(
LPSRestriction lpRestriction,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _лпрестриктион_
  
> возврата Указатель на структуру [срестриктион](srestriction.md) , определяющую условия фильтра. При передаче значения NULL в параметре _лпрестриктион_ удаляется текущий фильтр. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют временем операции ограничения. Можно задать следующие флаги:
    
TBL_ASYNC 
  
> Асинхронно запускает операцию и возвращает результат до завершения операции.
    
TBL_BATCH 
  
> Откладывает оценку фильтра до тех пор, пока данные в таблице не будут обязательными.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Фильтр успешно применен.
    
MAPI_E_BUSY 
  
> Выполняется другая операция, которая не позволяет запустить операцию ограничения. Выполнение выполняемой операции должно быть разрешено или остановлено.
    
MAPI_E_TOO_COMPLEX 
  
> Таблице не удается выполнить операцию, так как определенный фильтр, на который указывает параметр _лпрестриктион_ , слишком сложный. 
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable:: restrict** устанавливает ограничение или фильтр для таблицы. Если имеется предыдущее ограничение, оно отбрасывается и применяется новый. Применение ограничения не влияет на базовые данные таблицы; Он просто изменяет представление, ограничивая строки, которые могут быть извлечены в строки, содержащие данные, удовлетворяющие ограничению. 
  
Существует несколько различных типов ограничений, каждая из которых описана в разных структурах. Структура [срестриктион](srestriction.md) содержит два члена: значение, которое указывает тип ограничения и конкретную структуру, подходящую для этого типа. 
  
Уведомления для строк таблицы, которые скрыты от представлений по вызовам **ограничения** , никогда не создаются. 
  
Ограничение свойства для многозначного свойства работает как ограничение на свойство с одним значением. Для многозначного свойства, используемого в ограничении свойств, должен быть установлен флаг MVI_FLAG. Если этот флаг не установлен, он рассматривается как полностью упорядоченный кортеж. Сравнение двух многозначных столбцов сравнивает элементы столбцов по порядку, сообщая о связи столбцов по первому неравенству. Равенство возвращается только в том случае, если сравниваемые столбцы содержат одни и те же значения в одном и том же порядке. Если один столбец содержит меньше значений, чем другой, то полученное отношение имеет значение NULL для другого значения.
  
Более подробную информацию об ограничениях можно узнать в статье [ограничения](about-restrictions.md).
  
> [!NOTE]
> Если вы создаете динамические запросы для поиска данных на сервере, используйте метод **FindRow** , вместо того чтобы использовать метод **restrict** и метод **QueryRows** вместе. Метод **restrict** создает кэшированное представление, используемое для оценки всех сообщений, добавляемых в базовую папку или измененных в ней. Если клиентское приложение использует метод **restrict** для каждого динамического запроса, для каждого запроса будет создано кэшированное представление. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы отменить текущее ограничение без создания нового, передайте значение NULL в _лпрестриктион_.
  
Если выполняется другой асинхронный вызов таблицы, что приводит к **неограниченному** возвращению MAPI_E_BUSY, можно вызвать функцию [IMAPITable:: Abort](imapitable-abort.md) для остановки вызова. 
  
 Если вы не задаете один из флагов, то **Ограничьте** работу синхронно. Если установлен флаг TBL_BATCH, **ограничение** откладывает оценку ограничения, если вы не запрашиваете данные. Если установлен флаг TBL_ASYNC, **ограничение**действует асинхронно, потенциально возвращая до завершения операции.
  
Все закладки для таблицы отбрасываются, когда выполняется вызов **restrict** , а BOOKMARK_CURRENT текущее положение курсора задается в начале таблицы. 
  
Если вы попытаетесь применить ограничение свойства к свойству, которое не входит в набор столбцов таблицы, результаты будут неопределенными. Если вы не уверены в том, что свойство поддерживается в таблице, объедините ограничение свойства с ограничением EXISTS. Ограничение Exists проверяет наличие свойства перед попыткой применить ограничение свойства. 
  
Не ожидается получение уведомления таблицы для строки, которая была отфильтрована из таблицы из-за ограничения.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Контентстаблелистктрл. cpp  <br/> |Кконтентстаблелистктрл:: Апплирестриктион  <br/> |MFCMAPI использует метод **IMAPITable:: restrict** , чтобы задать ограничение для таблицы.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::Abort](imapitable-abort.md)
  
[IMAPITable::FindRow](imapitable-findrow.md)
  
[IMAPITable::GetRowCount](imapitable-getrowcount.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[SPropertyRestriction](spropertyrestriction.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


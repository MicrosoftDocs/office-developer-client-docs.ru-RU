---
title: IMAPITableRestrict
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.Restrict
api_type:
- COM
ms.assetid: a5bfc190-b58f-44c3-893c-8727df14ee58
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 924715f26e104739f2e60762511221da5facd5a5
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22578327"
---
# <a name="imapitablerestrict"></a>IMAPITable::Restrict

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Применение фильтра к таблице, уменьшение строки, задайте значение только строк, соответствующих определенным условиям.
  
```cpp
HRESULT Restrict(
LPSRestriction lpRestriction,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpRestriction_
  
> [in] Указатель на структуру [SRestriction](srestriction.md) , определяющие условия фильтра. Указать значение NULL для параметра _lpRestriction_ удаляет текущий фильтр. 
    
 _ulFlags_
  
> [in] Битовая маска флаги, определяющее время операции ограничение. Можно задать следующие флажки:
    
TBL_ASYNC 
  
> Асинхронно запускает операцию и возвращает до завершения операции.
    
TBL_BATCH 
  
> Вычисление фильтра которого откладывается, пока данные в таблице является обязательным.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Фильтр успешно применена.
    
MAPI_E_BUSY 
  
> В, не позволяющей операции ограничение запуск выполняется другой операции. В процессе выполнения операции должны выполнить либо должна быть остановлена.
    
MAPI_E_TOO_COMPLEX 
  
> Таблицы не удается выполнить операцию, так как отдельного фильтра, на который указывает параметр _lpRestriction_ довольно просто. 
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::Restrict** устанавливает ограничения или фильтр, в таблице. Если предыдущие ограничения, она удаляется и применяется новое. Применение ограничения не оказывает воздействия на базовых данных таблицы. он просто изменяет представление, ограничив число строк, которые могут быть получены для строки, содержащие данные, которые удовлетворяют ограничение. 
  
Существует несколько различных типов ограничений, каждый описывается с другой структурой. Структура [SRestriction](srestriction.md) содержит два элемента: значение, которое указывает тип ограничения и определенную структуру для этого типа. 
  
Уведомления для строки таблицы, которые являются скрытыми от режима отображения путем вызова **Restrict** никогда не создаются. 
  
Ограничение свойства на свойством работает как ограничение на одно значение свойства. Многозначные свойства для использования в ограничении свойства должен быть установлен флаг MVI_FLAG. Если он не установлен этот флаг, он обрабатывается как полностью упорядоченном кортеж. Сравнение двух многозначных столбцов сравниваются элементы столбцов в порядке, отчетов отношения столбцов в первом неравенство. Равенство возвращается только в том случае, если по сравнению столбцы содержат те же значения, в том же порядке. Если один столбец значений меньше, чем другое, переданные отношения, является значение null на другое значение.
  
Дополнительные сведения об ограничениях обратитесь к разделу [О ограничения](about-restrictions.md).
  
> [!NOTE]
> При создании динамических запросов для поиска данных на сервере, используйте метод **FindRow** вместо вместе с помощью метода **Restrict** и метод **QueryRows** . Метод **Restrict** создает кэшированные представления, которая используется для оценки все сообщения, добавлены или изменены в основной папке. Если клиентское приложение использует метод **Restrict** для каждого динамического запроса, кэшированные представления создается для каждого запроса. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы отменить текущее ограничение без создания новой, передайте _lpRestriction_NULL.
  
Если выполняется другой вызов асинхронных таблице вызывает ошибку **ограничить** для возврата MAPI_E_BUSY, можно вызвать [IMAPITable::Abort](imapitable-abort.md) для остановки вызова. 
  
 **Ограничить** работает синхронно, если не выбрано флаги. Если установлен флаг TBL_BATCH, **ограничить** откладывает оценки ограничение, если не запрашивать данные. Если установлен флаг TBL_ASYNC, **ограничить**работает асинхронно, потенциально возврат до завершения операции.
  
Все закладки для таблицы удаляются, когда выполняется вызов для **Restrict** и имеет значение BOOKMARK_CURRENT, текущей позиции курсора в начало таблицы. 
  
При попытке наложить ограничение свойства для свойства, которое не входит в набор столбцов в таблице результатов не определено. Каждый раз, когда вы не знаете поддерживается ли свойство в таблице, объединять ограничение свойства с существует ограничение. Существует ограничение проверяется на наличие свойства перед попыткой наложить ограничение свойства. 
  
Не ожидается получение уведомлений в таблице на строку, в которой было отфильтровано из таблицы из-за ограничения.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |CContentsTableListCtrl::ApplyRestriction  <br/> |Mfcmapi (en) используется метод **IMAPITable::Restrict** для определения ограничения на таблицу.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPITable::Abort](imapitable-abort.md)
  
[IMAPITable::FindRow](imapitable-findrow.md)
  
[IMAPITable::GetRowCount](imapitable-getrowcount.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[SPropertyRestriction](spropertyrestriction.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


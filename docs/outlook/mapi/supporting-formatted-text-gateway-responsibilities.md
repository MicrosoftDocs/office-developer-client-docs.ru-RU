---
title: Поддержка функциональных обязанностей для шлюза форматированного текста
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: de737118-5f3b-464f-b036-f4a3489d411a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: d5c3480018be399a85ee0bfda7ce1ff9b701cecc
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32327421"
---
# <a name="supporting-formatted-text-gateway-responsibilities"></a>Поддержка форматированного текста: обязанности шлюза

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
 **Для обработки форматированного текста исходящих сообщений шлюзы**
  
1. Получение только свойства **пр_ртф_компрессед** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) сообщения из хранилища сообщений. Основное преимущество получения только свойства **пр_ртф_компрессед** заключается в том, что текст сообщения не должен передаваться между машинами, если шлюз и хранилище сообщений существуют на разных компьютерах. 
    
2. Создайте текст сообщения из форматированного текста, вызвав функцию библиотеки RTF **хртекстфромкомпресседртфстреам** или, если сообщение хранится локально, **ртфсинк**. Флаг РТФ_СИНК_РТФ_ЧАНЖЕД должен быть установлен в вызове **ртфсинк**. Дополнительные сведения см. в разделе [ртфсинк](rtfsync.md).
    
3. Внесите необратимые изменения в текст сообщения, например при удалении неподдерживаемых символов. 
    
4. Убедитесь, что оба свойства **пр_ртф_ин_синк** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) и ауксиллиари RTF заданы либо отсутствуют.
    
5. При внесении любых изменений вызовите **ртфсинк** с установленными флагами РТФ_СИНК_РТФ_ЧАНЖЕД и ртф_синк_боди_чанжед. **Ртфсинк** будет пересчитывать свойства RTF ауксиллиари из измененного текста. 
    
6. Внесите в текст сообщения все обратимые изменения, такие как вставка заполнители вложения и выполнение необратимых преобразований кодовых страниц.
    
7. Отправьте сообщение.
    
 **Для обработки сообщений в формате RTF для входящих сообщений шлюзы**
  
1. Отмените все изменения текста сообщения, сделанные непосредственно перед отправкой сообщения. 
    
2. ВыЗовите **ртфсинк** , если сообщение содержит как свойства **пр_ртф_компрессед** , так и **пр_боди** ([PidTagBody](pidtagbody-canonical-property.md)). 
    
3. Обновление сообщения в хранилище сообщений с помощью свойства **пр_ртф_компрессед** , если оно содержится в сообщении; Обновите свойство **пр_боди** , только если **пр_ртф_компрессед** отсутствует. 
    
4. Удалить **пр_боди** , если сообщение содержит и это свойство, и **пр_ртф_компрессед**.
    
Шлюзы вызывают **ртфсинк** , чтобы избежать передачи текста сообщения и форматированного текста, если хранилище сообщений находится на другом компьютере. Если шлюз является локальным, он может задать оба свойства и разрешить хранилищу сообщений выполнение синхронизации. 
  


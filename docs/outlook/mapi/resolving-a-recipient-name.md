---
title: Разрешение имени получателя
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2baed391-85bd-4e88-8800-c19bc2d2d54a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: a3faed3dda2461cab749c824fc97c2074e62375f
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405868"
---
# <a name="resolving-a-recipient-name"></a>Разрешение имени получателя

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
При отправке сообщения список получателей строится со свойствами, связанными с каждым получателем. К моменту отправки сообщения одно из этих свойств должно быть идентификатором долгосрочного входа получателя. Чтобы убедиться, что каждый получатель включает свойство **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), передайте структуру [ADRLIST](adrlist.md) , описывающую список получателей, в содержимое параметра _Лпадрлист_ в вызове [IAddrBook:: ресолвенаме](iaddrbook-resolvename.md).
  
 **Ресолвенаме** начинает обработку, игнорируя записи в структуре **ADRLIST** , которые уже были разрешены, как указано в элементе идентификатора записи в соответствующем массиве **спропвалуе** структуры [адрентри](adrentry.md) . После этого **ресолвенаме** автоматически назначит одноразовые идентификаторы записей двум типам получателей: 
  
- Получатели с адресом, отформатированным в виде адреса в Интернете
    
- Получатели с адресом, отформатированным следующим образом:
    
     `displayname[address type:email address]`
    
Для всех оставшихся записей **ресолвенаме** ищет точное совпадение с отображаемым именем в адресной книге. **Ресолвенаме** использует свойство **PR_AB_SEARCH_PATH** ([PidTagAbSearchPath](pidtagabsearchpath-canonical-property.md)), чтобы определить набор контейнеров для поиска и порядок поиска. MAPI вызывает метод [иабконтаинер:: ResolveNames](iabcontainer-resolvenames.md) каждого контейнера, чтобы попытаться разрешить все имена. Так как некоторые контейнеры не поддерживают **ResolveNames**, если контейнер возвращает MAPI_E_NO_SUPPORT, MAPI применяет ограничение свойства **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)) к своей таблице содержимого. Все контейнеры адресной книги должны поддерживать разрешение имен с использованием этого ограничения. После того как все имена будут устранены, дальнейшие вызовы контейнеров не выполняются. Если все контейнеры были вызваны, но при этом остаются неоднозначные или неразрешенные имена, MAPI отображает диалоговое окно, если возможно запросить разрешение пользователя на разрешение оставшихся имен.
  
Ограничение **PR_ANR** сопоставляет значение свойства **PR_ANR** с отображаемым именем в структуре **ADRLIST** . Ограничение представления таблицы содержимого контейнера с помощью ограничения свойства **PR_ANR** приводит к тому, что поставщику адресной книги требуется тип поиска, соответствующий свойству, которое имеет смысл для поставщика. Например, один поставщик адресных книг может всегда сопоставлять имена в списке получателей с **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)), в то время как другой может позволить администратору выбрать свойство.
  
 **Настройка ограничения свойства PR_ANR для таблицы содержимого контейнера адресной книги**
  
1. Создайте структуру [срестриктион](srestriction.md) , как показано в следующем коде: 
    
  ```cpp
  SRestriction SRestrict;
  SRestrict.rt = RES_PROPERTY;
  SRestrict.res.resProperty.relop = RELOP_EQ;
  SRestrict.res.resProperty.ulPropTag = PR_ANR;
  SRestrict.res.resProperty.lpProp->ulPropTag = PR_ANR;
  SRestrict.res.resProperty.lpProp->Value.LPSZ = lpszName;
   
  ```

2. Вызовите для таблицы содержаний метод [IMAPITable:: restrict](imapitable-restrict.md) , передав структуру **срестриктион** в качестве параметра _лпрестриктион_ . 
    


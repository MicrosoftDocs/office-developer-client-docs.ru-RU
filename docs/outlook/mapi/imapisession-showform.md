---
title: Имаписессионшовформ
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISession.ShowForm
api_type:
- COM
ms.assetid: 233cf936-34db-42d4-b5e3-17a93acb2009
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 8b90dee3958a20994f9a60d104ae714ad95307d3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32335667"
---
# <a name="imapisessionshowform"></a>IMAPISession::ShowForm

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Отображает форму.
  
```cpp
HRESULT ShowForm(
  ULONG_PTR ulUIParam,
  LPMDB lpMsgStore,
  LPMAPIFOLDER lpParentFolder,
  LPCIID lpInterface,
  ULONG ulMessageToken,
  LPMESSAGE lpMessageSent,
  ULONG ulFlags,
  ULONG ulMessageStatus,
  ULONG ulMessageFlags,
  ULONG ulAccess,
  LPSTR lpszMessageClass
);
```

## <a name="parameters"></a>Параметры

 _Улуипарам_
  
> возврата Дескриптор родительского окна формы.
    
 _Лпмсгсторе_
  
> возврата Указатель на хранилище сообщений, содержащее папку, на которую указывает параметр _лппарентфолдер_ . 
    
 _Лппарентфолдер_
  
> возврата Указатель на папку, в которой было создано сообщение, связанное с параметром _улмессажетокен_ . 
    
 _Лпинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к сообщению, отображаемому в форме. Параметр _лпинтерфаце_ должен иметь значение null или иид_имессаже. Передача значений NULL в стандартный интерфейс [iMessage](imessageimapiprop.md)используется. 
    
 _Улмессажетокен_
  
> возврата Маркер, связанный с сообщением, которое должно отображаться в форме. Параметру _улмессажетокен_ должно быть присвоено значение параметра _лпулмессажетокен_ из предыдущего вызова [IMAPISession::P репареформ](imapisession-prepareform.md).
    
 _Лпмессажесент_
  
> возврата Резервирования должно иметь значение NULL. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих способ и способ сохранения сообщения. Можно задать следующие флаги:
    
МАПИ_НЕВ_МЕССАЖЕ 
  
> Сообщение никогда не сохранялось (то есть метод [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) не вызывался). 
    
МАПИ_ПОСТ_МЕССАЖЕ 
  
> Сообщение должно быть сохранено в родительской папке. Сообщение не обрабатывается для отправки, но вместо этого отправляется в папку. Если этот флаг не установлен, сообщение копируется в папку "исХодящие" и обрабатывается для отправки. 
    
 _Улмессажестатус_
  
> возврата Битовая маска флагов, скопированных из свойства **пр_мсг_статус** ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md)) сообщения, связанного с маркерОм в параметре _улмессажетокен_ . Флаги предоставляют сведения о состоянии сообщения. 
    
 _Улмессажефлагс_
  
> возврата Битовая маска флагов, скопированных из свойства **пр_мессаже_флагс** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) сообщения, связанного с маркерОм в параметре _улмессажетокен_ . Эти флаги предоставляют дополнительные сведения о состоянии сообщения. 
    
 _Улакцесс_
  
> возврата Флаг, указывающий уровень разрешений для сообщения, отображаемого в форме. Эти сведения копируются из свойства **пр_акцесс** ([PidTagAccess](pidtagaccess-canonical-property.md)) сообщения, связанного с маркером, в параметре _улмессажетокен_ . 
    
 _Лпсзмессажекласс_
  
> возврата Указатель на класс сообщения, который отображается в форме и копируется из свойства **пр_мессаже_класс** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) сообщения, связанного с маркером, в параметре _улмессажетокен_ . 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Форма успешно отображена.
    
МАПИ_Е_УСЕР_КАНЦЕЛ 
  
> Пользователь отменил операцию, как правило, нажав кнопку **Отмена** в диалоговом окне. 
    
## <a name="remarks"></a>Комментарии

Метод **IMAPISession:: шовформ** отображает форму сообщения, подготовленную методом **IMAPISession::P репареформ** . 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вы должны иметь только одну ссылку на сообщение, переданное в параметре _лпмессаже_ метода **препареформ** . 
  
Имейте в виду, что реализации форм могут возвращать значения ошибок, отличные от тех, которые задокументированы MAPI. Если вы можете использовать эти значения ошибок для более точного определения условия ошибки, сделайте это. В противном случае обработайте эти ошибки как при обработке МАПИ_Е_КАЛЛ_ФАИЛЕД. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мапиформфунктионс. cpp  <br/> |Опенмессажемодал  <br/> |MFCMAPI использует метод **IMAPISession:: шовформ** вместе с методом **препареформ** для отображения сообщения в модальной форме.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMessage: IMAPIProp](imessageimapiprop.md)
  
[IMAPISession::PrepareForm](imapisession-prepareform.md)
  
[IMAPISession: IUnknown](imapisessioniunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: Имаписуппортспулернотифи
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.SpoolerNotify
api_type:
- COM
ms.assetid: d4f153b2-939f-4153-85fb-dc510193848c
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 99377d63b4b5cf8731809446b70770f0c24231ed
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32326287"
---
# <a name="imapisupportspoolernotify"></a>IMAPISupport::SpoolerNotify

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Уведомляет диспетчер очереди MAPI об изменении состояния или запросе службы. 
  
```cpp
HRESULT SpoolerNotify(
ULONG ulFlags,
LPVOID lpvData
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> возврата Битовая маска флагов, указывающая тип уведомления. Поставщики транспорта могут устанавливать все флаги, кроме НОТИФИ_НЕВМАИЛ_РЕЦЕИВЕД; для поставщиков хранилища сообщений допустимы только НОТИФИ_НЕВМАИЛ_РЕЦЕИВЕД и НОТИФИ_РЕАДТОСЕНД. Для параметра _ulFlags_ допустимы следующие флаги: 
    
НОТИФИ_КОНФИГ_ЧАНЖЕ 
  
> Регистрирует запрос на изменение конфигурации поставщика транспорта. 
    
НОТИФИ_КРИТИКАЛ_ЕРРОР 
  
> В поставщике транспорта произошла неустранимая ошибка. Так как оба НОТИФИ_СЕНТДЕФЕРРЕД и НОТИФИ_КРИТИКАЛ_ЕРРОР используют параметр _лпвдата_ для вызовов поставщика транспорта, эти флаги являются взаимоисключающими. 
    
НОТИФИ_КРИТСЕК 
  
> ЗаПрашивает критический раздел для поставщика транспорта. Параметр _лпвдата_ не определен и должен иметь значение null. 
    
НОТИФИ_НЕВМАИЛ 
  
> Диспетчер очереди MAPI должен скачать все недавно полученные сообщения в течение следующего доступного времени. Параметр _лпвдата_ не определен и должен иметь значение null. 
    
НОТИФИ_НЕВМАИЛ_РЕЦЕИВЕД 
  
> В хранилище сообщений получено новое сообщение. Параметр _лпвдата_ указывает на структуру [невмаил_нотификатион](newmail_notification.md) , описывающую сообщение. Этот флаг используется для поставщиков хранилища сообщений, тесно связанных с поставщиками транспорта, и игнорируется, если поставщик хранилища вошел в систему с установленным флагом МАПИ_НО_МАИЛ. 
    
НОТИФИ_НОНКРИТ 
  
> Освобождает критический раздел, полученный при предыдущем вызове метода **спулернотифи** с _ulFlags_ , установленным в нотифи_критсек. Параметр _лпвдата_ не определен и должен иметь значение null. 
    
НОТИФИ_РЕАДИТОСЕНД 
  
> Поставщик транспорта или хранилища сообщений готов к отправке сообщений. Параметр _лпвдата_ не определен и должен иметь значение null. 
    
НОТИФИ_СЕНТДЕФЕРРЕД 
  
> Ранее отложенное сообщение должно быть отправлено, а поставщик транспорта должен получать уведомления о том, что сообщение готово к доставке, с помощью вызова метода [иксплогон:: субмитмессаже](ixplogon-submitmessage.md) . Идентификатор записи для отложенного сообщения хранится в структуре [сбинари](sbinary.md) , на которую указывает _лпвдата_. Так как оба НОТИФИ_СЕНТДЕФЕРРЕД и НОТИФИ_КРИТИКАЛ_ЕРРОР используют параметр _лпвдата_ , эти флаги являются взаимоисключающими. 
    
 _Лпвдата_
  
> возврата Указатель на связанные данные, которые относятся к уведомлению. Параметр _лпвдата_ указывает на действительные данные только в том случае, если установлены следующие флаги (_ЛПВДАТА_ имеет значение null, если _ulFlags_ задано для других типов уведомлений): 
    
|**параметр _ulFlags_**|**значение _лпвдата_**|
|:-----|:-----|
|НОТИФИ_КРИТИКАЛ_ЕРРОР  <br/> |Сведения об ошибке.  <br/> |
|НОТИФИ_НЕВМАИЛ_РЕЦЕИВЕД  <br/> |Структура **невмаил_нотификатион** , содержащая сведения о новом доставленном сообщении.  <br/> |
|НОТИФИ_СЕНТДЕФЕРРЕД  <br/> |Структура **сбинари** , содержащая идентификатор отложенного сообщения.  <br/> |
   
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Уведомление успешно установлено.
    
## <a name="remarks"></a>Замечания

Метод **имаписуппорт:: спулернотифи** реализован для объектов, поддерживающих хранилище сообщений и поставщиков транспорта. Эти поставщики вызывают **спулернотифи** , чтобы уведомить Диспетчер очереди MAPI об изменении состояния или запросе службы. **Спулернотифи** вызывается преимущественно поставщиками транспорта и может вызываться в любой момент в сеансе. 
  
## <a name="notes-to-transport-providers"></a>Примечания для поставщиков транспорта

Если вы изменили конфигурацию поставщика транспорта, вызовите **спулернотифи** и задайте _ulFlags_ в нотифи_конфиг_чанжед. **Спулернотифи** отвечает, вызывая метод [Иксплогон:: аддресстипес](ixplogon-addresstypes.md) для запроса изменений в поддерживаемых типах адресов. 
  
Если требуется важный раздел для обеспечения непрерывной обработки, вызовите **спулернотифи** с _ulFlags_ , установленным в нотифи_критсек. Установка этого флага информирует диспетчер очереди MAPI о том, что он не должен вызывать метод [иксплогон:: Idle](ixplogon-idle.md) и [иксплогон::P олл](ixplogon-poll.md) . При открытом критическом разделе возвращается МАПИ_Е_БУСИ, когда вызывается метод [имапистатус:: валидатестате](imapistatus-validatestate.md) . Завершив работу с критическим разделом, выполните еще один вызов **спулернотифи** с _ulFlags_ , установленным в нотифи_нонкрит. 
  
Например, если удаленный поставщик транспорта находится в процессе отправки сообщений, может потребоваться разрешить пользователю ввести номер телефона для установки удаленного подключения. Перед выполнением цикла обработки диалогового окна необходимо объявить критический раздел. Когда пользователь закрывает диалоговое окно, а затем завершает процедуру диалогового окна, необходимо освободить критический раздел.
  
При установке _ulFlags_ в нотифи_критикал_еррор Диспетчер очереди MAPI не выполняет дальнейших вызовов поставщика, кроме его освобождения. При вызове **спулернотифи** с нотифи_критикал_еррор SET из методов [Иксплогон:: стартмессаже](ixplogon-startmessage.md) или [иксплогон:: субмитмессаже](ixplogon-submitmessage.md) возвращается соответствующее значение ошибки из вызова **StartMessage** или * * SubmitMessage * *. сразу после вызова **спулернотифи** . 
  
Если поставщик транспорта был восстановлен из условия, которое ранее приводило к сбою, вызовите **спулернотифи** с _ulFlags_ , установленным в нотифи_реадитосенд. Этот флаг указывает, что поставщик еще раз готов обрабатывать сообщения. 
  
## <a name="notes-to-message-store-providers"></a>Примечания к поставщикам хранилища сообщений

ВыЗовите **спулернотифи**, ПЕРЕДАВ флаг Нотифи_реадитосенд в _ulFlags_, прежде чем выполнять первый вызов [Имаписуппорт::P Репаресубмит](imapisupport-preparesubmit.md) в **iMessage:: субмитмессаже**. Этот вызов **спулернотифи** должен выполняться только один раз для каждого сеанса. 
  
Если поставщик хранилища сообщений тесно связан с поставщиком транспорта и вы вызываете **спулернотифи** с параметром _ulFlags_ в нотифи_невмаил_рецеивед, то диспетчер очереди MAPI открывает новое сообщение и начинает обработку новой функции-ловушки сообщения. После завершения обработки Диспетчер очереди MAPI вызывает метод [IMsgStore:: нотифиневмаил](imsgstore-notifynewmail.md) для уведомления о новом сообщении. 
  
Дополнительные сведения о вызове **спулернотифи**можно найти в следующих разделах:
  
- [Реализация метода FlushQueues](implementing-the-flushqueues-method.md)
    
- [Взаимодействие с диспетчером очереди MAPI](interacting-with-the-mapi-spooler.md)
    
- [Модель приема сообщений](message-reception-model.md)
    
## <a name="see-also"></a>См. также



[IMsgStore::NotifyNewMail](imsgstore-notifynewmail.md)
  
[IXPLogon::StartMessage](ixplogon-startmessage.md)
  
[IXPLogon::SubmitMessage](ixplogon-submitmessage.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


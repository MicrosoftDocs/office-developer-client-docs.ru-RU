---
title: иаблогонадвисе
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABLogon.Advise
api_type:
- COM
ms.assetid: 375d65b1-607d-4e2a-8052-9bcbf08fc2ac
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4ab0e4b023e6af19f650abf421aed122dcc21879
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428230"
---
# <a name="iablogonadvise"></a>IABLogon::Advise

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Регистрирует вызывающий абонент для получения уведомления об указанных событиях, влияющих на контейнер, пользователя обмена сообщениями или список рассылки.
  
```cpp
HRESULT Advise(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulEventMask,
  LPMAPIADVISESINK lpAdviseSink,
  ULONG FAR * lpulConnection
);
```

## <a name="parameters"></a>Параметры

 _кбентрид_
  
> возврата Количество байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _лпентрид_
  
> возврата Указатель на идентификатор записи объекта, для которого необходимо создать уведомления.
    
 _улевентмаск_
  
> возврата Битовая маска значений, указывающая типы событий уведомлений, в которых заинтересован вызывающий абонент, которые необходимо включить в регистрацию. Существует соответствующая структура [уведомлений](notification.md) , связанная с каждым типом события, в котором хранятся сведения о событии. В следующей таблице приведены допустимые значения параметра _улевентмаск_ и структуры, связанные с каждым значением. 
    
|**Тип события уведомления**|**Соответствующая структура **уведомлений****|
|:-----|:-----|
|**фневкритикалеррор** <br/> |[ERROR_NOTIFICATION](error_notification.md) <br/> |
|**фневобжекткреатед** <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|**фневобжектделетед** <br/> |**OBJECT_NOTIFICATION** <br/> |
|**фневобжектмодифиед** <br/> |**OBJECT_NOTIFICATION** <br/> |
|**фневобжекткопиед** <br/> |**OBJECT_NOTIFICATION** <br/> |
|**фневобжектмовед** <br/> |**OBJECT_NOTIFICATION** <br/> |
   
 _лпадвисесинк_
  
> возврата Указатель на объект приемника уведомлений для получения последующих уведомлений.
    
 _лпулконнектион_
  
> вышли Указатель на ненулевое значение, представляющее регистрацию уведомления.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Успешная регистрация уведомления.
    
MAPI_E_INVALID_ENTRYID 
  
> Значение идентификатора записи, переданного в параметре _лпентрид_ , не соответствует формату. 
    
MAPI_E_NO_SUPPORT 
  
> Поставщик адресных книг не поддерживает уведомление, возможно потому, что он не позволяет вносить изменения в объекты.
    
MAPI_E_UNKNOWN_ENTRYID 
  
> Поставщик адресных книг не может обработать идентификатор записи, переданный в _лпентрид_.
    
## <a name="remarks"></a>Примечания

Поставщики адресных книг реализуют метод **иаблогон:: Advise** для регистрации вызывающего абонента, чтобы получать уведомления об изменении объекта в одном из контейнеров. Абоненты могут зарегистрироваться для получения уведомлений о пользователях системы обмена сообщениями, списках рассылки или всех контейнерах. 
  
Клиенты обычно вызывают метод [IAddrBook:: Advise](iaddrbook-advise.md) для регистрации уведомлений в адресной книге. Затем MAPI вызывает метод **advise** поставщика адресных книг, который отвечает за объект, представленный идентификатором записи в _лпентрид_.
  
Когда происходит изменение указанного объекта типа, представленного в _улевентмаск_, выполняется вызов метода **OnNotify** приемника уведомлений, на который указывает _лпадвисесинк_. Данные, переданные в структуру **уведомлений** в подпрограмму **OnNotify** , описывают событие. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Вы можете поддерживать уведомления с помощью интерфейса MAPI или без него. В MAPI есть три метода поддержки объектов, которые помогают поставщикам услуг реализовать уведомления:
  
- [IMAPISupport::Subscribe](imapisupport-subscribe.md)
    
- [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md)
    
- [IMAPISupport::Notify](imapisupport-notify.md)
    
Если вы намерены использовать методы поддержки MAPI, вызовите **подписку** при вызове метода **advise** и освободите указатель _лпадвисесинк_ . 
  
Если вы хотите самостоятельно поддерживать уведомления, вызовите метод **AddRef** приемника уведомлений, представленный параметром _лпадвисесинк_ , чтобы сохранить копию этого указателя. Сохраняйте эту копию до тех пор, пока не будет вызван метод [иаблогон:: unadvise](iablogon-unadvise.md) для отмены регистрации. 
  
Независимо от того, как вы можете поддерживать уведомления, назначьте ненулевой номер подключения для регистрации уведомлений и верните его в параметр _лпулконнектион_ . Не освобождайте этот номер подключения, пока не будет вызван метод **unadvise** . 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Указатель приемника уведомлений, который передается с помощью параметра _лпадвисесинк_ **, можно указать** на созданный объект или с помощью MAPI, созданного с помощью функции [хрсиссреададвисесинк](hrthisthreadadvisesink.md) . Вы можете использовать **хрсиссреададвисесинк** , если вы поддерживаете несколько потоков выполнения и хотите убедиться в том, что последующие вызовы метода **OnNotify** выполняются в соответствующее время в соответствующем потоке. 
  
Будьте готовы к выпуску вашего объекта приемника уведомлений в любое время после вызова **advise** и перед вызовом метода **Unadvise**unadvise. Поэтому следует освободить объект приемника **уведомлений после возврата по нажатию** , если для него не задано конкретное долгосрочное использование. 
  
Дополнительные сведения о процессе уведомления можно найти в статье [уведомление о событии в MAPI](event-notification-in-mapi.md). Сведения о том, как использовать методы **имаписуппорт** для поддержки уведомлений, можно узнать в разделе [Поддержка уведомлений о событиях](supporting-event-notification.md). Для получения дополнительных сведений [о многопоточности](threading-in-mapi.md)и MAPI см.
  
## <a name="see-also"></a>См. также



[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)
  
[IABLogon::Unadvise](iablogon-unadvise.md)
  
[IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)
  
[�����������](notification.md)
  
[IABLogon : IUnknown](iablogoniunknown.md)


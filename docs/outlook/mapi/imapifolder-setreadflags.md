---
title: Имапифолдерсетреадфлагс
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.SetReadFlags
api_type:
- COM
ms.assetid: 95a40c8a-0a8b-46c7-a07a-cbc6a7de8a3c
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 15504ecc88188ed7bc4eed0e64b1871dbc6a5e8d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406915"
---
# <a name="imapifoldersetreadflags"></a>IMAPIFolder::SetReadFlags

**Относится к**: Outlook 2013 | Outlook 2016 
  
Задает или очищает флаг МСГФЛАГ_РЕАД в свойстве **пр_мессаже_флагс** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) одного или нескольких сообщений папки и управляет отправкой отчетов о прочтении. 
  
```cpp
HRESULT SetReadFlags(
  LPENTRYLIST lpMsgList,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

_Лпмсглист_
  
> возврата Указатель на массив структур [ентрилист](entrylist.md) , определяющий сообщение или сообщения, для которых задаются или удаляются флаги чтения. Если для _лпмсглист_ ЗАДАНО значение null, флаги чтения для всех сообщений папки задаются или сбрасываются. 
    
_Улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения. Параметр _улуипарам_ игнорируется, если не установлен флаг мессаже_диалог в параметре _ulFlags_ . 
    
_Лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_переДАЕТСЯ значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг Мессаже_диалог в _ulFlags_.
    
_ulFlags_
  
> возврата Битовая маска флагов, определяющая параметр флага чтения сообщения и обработки отчетов о прочтении. Можно задать следующие флаги:
    
  - КЛЕАР_РЕАД_ФЛАГ: флаг МСГФЛАГ_РЕАД должен быть снят в **пр_мессаже_флагс** , а отчет о прочтении не должен быть отправлен. 
        
  - КЛЕАР_НРН_ПЕНДИНГ: флаг МСГФЛАГ_НРН_ПЕНДИНГ должен быть снят в **пр_мессаже_флагс** , а отчет о непрочтенных сообщениях не должен быть отправлен. 
        
  - КЛЕАР_РН_ПЕНДИНГ: флаг МСГФЛАГ_РН_ПЕНДИНГ должен быть снят в **пр_мессаже_флагс** , а отчет о прочтении не должен быть отправлен. 
        
  - ЖЕНЕРАТЕ_РЕЦЕИПТ_ОНЛИ: отчет о прочтении должен быть отправлен, если он находится в состоянии ожидания, но в состоянии флага МСГФЛАГ_РЕАД не должно быть никаких изменений.
        
  - МАПИ_ДЕФЕРРЕД_ЕРРОРС: разрешает успешное возвращение **сетреадфлагс** , возможно, до завершения операции. 
        
  - МЕССАЖЕ_ДИАЛОГ: отображает индикатор хода выполнения операции.
    
  - СУППРЕСС_РЕЦЕИПТ: ожидающий отчет о прочтении должен быть отменен, если был запрошен отчет о прочтении, и этот вызов изменяет состояние сообщения с "непрочтено" на "чтение". Если этот вызов не изменяет состояние сообщения, поставщик хранилища сообщений может игнорировать этот флаг.
    
## <a name="return-values"></a>Возвращаемые значения

S_OK 
  
> Флаг чтения для указанного сообщения или сообщений был успешно установлен или снят.
    
МАПИ_Е_НО_СУППРЕСС 
  
> Поставщик хранилища сообщений не поддерживает отдавление отчетов о прочтении.
    
МАПИ_Е_ИНВАЛИД_ПАРАМЕТЕР 
  
> В параметре _ulFlags_ задано одно из следующих несовместимых комбинаций флагов: 
    
   - СУППРЕСС_РЕЦЕИПТ | КЛЕАР_РЕАД_ФЛАГ 
    
   - СУППРЕСС_РЕЦЕИПТ | КЛЕАР_РЕАД_ФЛАГ | ЖЕНЕРАТЕ_РЕЦЕИПТ_ОНЛИ
    
   - КЛЕАР_РЕАД_ФЛАГ | ЖЕНЕРАТЕ_РЕЦЕИПТ_ОНЛИ
    
МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН 
  
> Вызов выполнен успешно, но не все сообщения успешно обработаны. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder:: сетреадфлагс** задает или очищает флаг мсгфлаг_реад в свойстве **пр_мессаже_флагс** одного или нескольких сообщений папки. Установка флага МСГФЛАГ_РЕАД помечает сообщение как прочитанное, которое не обязательно указывает на то, что предполагаемый получатель действительно прочитал сообщение. 
  
**Сетреадфлагс** также управляет отправкой отчетов о прочтении. 
  
Невозможно изменить флаг чтения для следующих параметров:
  
- Несуществующие сообщения.
    
- Сообщения, перемещенные в другое место.
    
- Сообщения, открытые с разрешениями на чтение и запись.
    
- Отправленные в настоящее время сообщения.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Вы можете не поддерживать отправку отчетов о прочтении и запрос на отключение отчетов о прочтении. Чтобы избежать подавления отчета о прочтении, возвращайте МАПИ_Е_НО_СУППРЕСС при вызове **сетреадфлагс** с параметром суппресс_рецеипт в параметре _ulFlags_ . 
  
Если параметр _лпмсглист_ указывает на несколько сообщений, выполните операцию полностью, как можно скорее для каждого сообщения. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений. 
  
Если ни один из флагов не задан в параметре _ulFlags_ , применяются следующие правила. 
  
- Если МСГФЛАГ_РЕАД уже задан, ничего делать не нужно.
    
- Если МСГФЛАГ_РЕАД не задано, немедленно установите его и отправьте все ожидающие отчеты о прочтении, если задано свойство **пр_реад_рецеипт_рекуестед** ([PidTagReadReceiptRequested](pidtagreadreceiptrequested-canonical-property.md)).
    
Если установлен флаг СУППРЕСС_РЕЦЕИПТ, применяются следующие правила.
  
- Если МСГФЛАГ_РЕАД уже задан, ничего делать не нужно. 
    
- Если МСГФЛАГ_РЕАД не задано, установите его и отмените все ожидающие отчеты о прочтении.
    
Если установлен флаг КЛЕАР_РЕАД_ФЛАГ, снимите флаг МСГФЛАГ_РЕАД в свойстве **пр_мессаже_флагс** каждого сообщения и не отправляйте отчеты о прочтении. 
  
Когда установлен флаг ЖЕНЕРАТЕ_РЕЦЕИПТ_ОНЛИ, отправьте все ожидающие отчеты о прочтении. Не задавайте и не снимайте МСГФЛАГ_РЕАД.
  
Если установлены флаги СУППРЕСС_РЕЦЕИПТ и ЖЕНЕРАТЕ_РЕЦЕИПТ_ОНЛИ, задайте для **ПР_РЕАД_РЕЦЕИПТ_РЕКУЕСТЕД** значение false, если оно задано и не отправляет отчет о прочтении. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**Сетреадфлагс** успешно обработал каждое сообщение.  <br/> |S_OK  <br/> |
|**Сетреадфлагс** не удалось успешно обработать каждое сообщение.  <br/> |МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН или МАПИ_Е_НОТ_ФАУНД  <br/> |
|**Сетреадфлагс** не удалось выполнить.  <br/> |Любое значение ошибки, кроме МАПИ_Е_НОТ_ФАУНД  <br/> |
   
Если **сетреадфлагс** не удается выполнить, не следует предполагать, что работа не выполнялась. В **сетреадфлагс** может быть возможно установить или снять флаг мсгфлаг_реад для одного или нескольких сообщений, прежде чем возникнет ошибка. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Фолдердлг. cpp  <br/> |Кфолдердлг:: Онсетреадфлаг  <br/> |MFCMAPI использует метод **IMAPIFolder:: сетреадфлагс** , чтобы вручную задать состояние чтения для указанных сообщений.  <br/> |
   
## <a name="see-also"></a>См. также

- [ENTRYLIST](entrylist.md) 
- [IMessage::SetReadFlag](imessage-setreadflag.md)  
- [Каноническое свойство PidTagMessageFlags](pidtagmessageflags-canonical-property.md)  
- [Каноническое свойство PidTagReadReceiptRequested](pidtagreadreceiptrequested-canonical-property.md)  
- [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)
- [MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)  
- [Использование макросов для обработки ошибок](using-macros-for-error-handling.md)


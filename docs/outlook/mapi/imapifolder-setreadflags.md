---
title: имапифолдерсетреадфлагс
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.SetReadFlags
api_type:
- COM
ms.assetid: 95a40c8a-0a8b-46c7-a07a-cbc6a7de8a3c
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 15504ecc88188ed7bc4eed0e64b1871dbc6a5e8d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406915"
---
# <a name="imapifoldersetreadflags"></a>IMAPIFolder::SetReadFlags

**Относится к**: Outlook 2013 | Outlook 2016 
  
Задает или очищает флаг MSGFLAG_READ в свойстве **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) одного или нескольких сообщений папки и управляет отправкой отчетов о прочтении. 
  
```cpp
HRESULT SetReadFlags(
  LPENTRYLIST lpMsgList,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

_лпмсглист_
  
> возврата Указатель на массив структур [ентрилист](entrylist.md) , определяющий сообщение или сообщения, для которых задаются или удаляются флаги чтения. Если для _лпмсглист_ ЗАДАНО значение null, флаги чтения для всех сообщений папки задаются или сбрасываются. 
    
_улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения. Параметр _улуипарам_ игнорируется, если в параметре _ulFlags_ не задан флаг MESSAGE_DIALOG. 
    
_лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_передается значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг MESSAGE_DIALOG в _ulFlags_.
    
_ulFlags_
  
> возврата Битовая маска флагов, определяющая параметр флага чтения сообщения и обработки отчетов о прочтении. Можно задать следующие флаги:
    
  - CLEAR_READ_FLAG: флажок MSGFLAG_READ должен быть снят в **PR_MESSAGE_FLAGS** , а отчет о прочтении не должен быть отправлен. 
        
  - CLEAR_NRN_PENDING: флажок MSGFLAG_NRN_PENDING должен быть снят в **PR_MESSAGE_FLAGS** , а отчет о непрочтенных сообщениях не должен быть отправлен. 
        
  - CLEAR_RN_PENDING: флажок MSGFLAG_RN_PENDING должен быть снят в **PR_MESSAGE_FLAGS** , а отчет о прочтении не должен быть отправлен. 
        
  - GENERATE_RECEIPT_ONLY: отчет о прочтении должен быть отправлен, если он находится в состоянии ожидания, но в состоянии флага MSGFLAG_READ не должно быть никаких изменений.
        
  - MAPI_DEFERRED_ERRORS: разрешает успешно возвращаться **сетреадфлагс** , возможно, до завершения операции. 
        
  - MESSAGE_DIALOG: отображает индикатор хода выполнения операции.
    
  - SUPPRESS_RECEIPT: ожидающий отчет о прочтении должен быть отменен, если был запрошен отчет о прочтении, и этот вызов изменяет состояние сообщения с "непрочтено" на "чтение". Если этот вызов не изменяет состояние сообщения, поставщик хранилища сообщений может игнорировать этот флаг.
    
## <a name="return-values"></a>Возвращаемые значения

S_OK 
  
> Флаг чтения для указанного сообщения или сообщений был успешно установлен или снят.
    
MAPI_E_NO_SUPPRESS 
  
> Поставщик хранилища сообщений не поддерживает отдавление отчетов о прочтении.
    
MAPI_E_INVALID_PARAMETER 
  
> В параметре _ulFlags_ задано одно из следующих несовместимых комбинаций флагов: 
    
   - SUPPRESS_RECEIPT | CLEAR_READ_FLAG 
    
   - SUPPRESS_RECEIPT | CLEAR_READ_FLAG | GENERATE_RECEIPT_ONLY
    
   - CLEAR_READ_FLAG | GENERATE_RECEIPT_ONLY
    
MAPI_W_PARTIAL_COMPLETION 
  
> Вызов выполнен успешно, но не все сообщения успешно обработаны. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **HR_FAILED** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder:: сетреадфлагс** задает или очищает флаг MSGFLAG_READ в свойстве **PR_MESSAGE_FLAGS** одного или нескольких сообщений папки. При установке флага MSGFLAG_READ сообщение помечается как прочитанное, что не обязательно указывает на то, что предполагаемый получатель действительно прочитал сообщение. 
  
**Сетреадфлагс** также управляет отправкой отчетов о прочтении. 
  
Невозможно изменить флаг чтения для следующих параметров:
  
- Несуществующие сообщения.
    
- Сообщения, перемещенные в другое место.
    
- Сообщения, открытые с разрешениями на чтение и запись.
    
- Отправленные в настоящее время сообщения.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Вы можете не поддерживать отправку отчетов о прочтении и запрос на отключение отчетов о прочтении. Чтобы избежать подавления отчета о прочтении, возвращайте MAPI_E_NO_SUPPRESS при вызове **сетреадфлагс** с SUPPRESS_RECEIPT Set в параметре _ulFlags_ . 
  
Если параметр _лпмсглист_ указывает на несколько сообщений, выполните операцию полностью, как можно скорее для каждого сообщения. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений. 
  
Если ни один из флагов не задан в параметре _ulFlags_ , применяются следующие правила. 
  
- Если MSGFLAG_READ уже заданы, ничего делать не нужно.
    
- Если MSGFLAG_READ не задано, немедленно установите его и отправьте все ожидающие отчеты о прочтении, если задано свойство **PR_READ_RECEIPT_REQUESTED** ([PidTagReadReceiptRequested](pidtagreadreceiptrequested-canonical-property.md)).
    
Если установлен флаг SUPPRESS_RECEIPT, применяются следующие правила.
  
- Если MSGFLAG_READ уже заданы, ничего делать не нужно. 
    
- Если MSGFLAG_READ не задано, установите его и отмените все ожидающие отчеты о прочтении.
    
Если установлен флаг CLEAR_READ_FLAG, снимите флаг MSGFLAG_READ в свойстве **PR_MESSAGE_FLAGS** каждого сообщения и не отправляются отчеты о прочтении. 
  
Когда установлен флаг GENERATE_RECEIPT_ONLY, отправьте все ожидающие отчеты о прочтении. Не задавайте и не снимайте MSGFLAG_READ.
  
Если установлены флаги SUPPRESS_RECEIPT и GENERATE_RECEIPT_ONLY, задайте для **PR_READ_RECEIPT_REQUESTED** значение false, если он установлен и не отправляет отчет о прочтении. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**Сетреадфлагс** успешно обработал каждое сообщение.  <br/> |S_OK  <br/> |
|**Сетреадфлагс** не удалось успешно обработать каждое сообщение.  <br/> |MAPI_W_PARTIAL_COMPLETION или MAPI_E_NOT_FOUND  <br/> |
|**Сетреадфлагс** не удалось выполнить.  <br/> |Любое значение ошибки, кроме MAPI_E_NOT_FOUND  <br/> |
   
Если **сетреадфлагс** не удается выполнить, не следует предполагать, что работа не выполнялась. В **сетреадфлагс** может быть возможно установить или снять флаг MSGFLAG_READ для одного или нескольких сообщений, прежде чем возникнет ошибка. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Фолдердлг. cpp  <br/> |Кфолдердлг:: Онсетреадфлаг  <br/> |MFCMAPI использует метод **IMAPIFolder:: сетреадфлагс** , чтобы вручную задать состояние чтения для указанных сообщений.  <br/> |
   
## <a name="see-also"></a>См. также

- [ENTRYLIST](entrylist.md) 
- [IMessage::SetReadFlag](imessage-setreadflag.md)  
- [Каноническое свойство PidTagMessageFlags](pidtagmessageflags-canonical-property.md)  
- [Каноническое свойство PidTagReadReceiptRequested](pidtagreadreceiptrequested-canonical-property.md)  
- [IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)
- [MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)  
- [Использование макросов для обработки ошибок](using-macros-for-error-handling.md)


---
title: Запуск поставщика службы
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c4b61cc3-d9fe-4616-a05c-d1e4096b5abd
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: d14a9961002d63733423af474e147ec5001051fb
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22586335"
---
# <a name="starting-a-service-provider"></a>Запуск поставщика службы

 
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
К определенному моменту после клиент запускает сеанс с MAPI, ваш поставщик услуг будет запущен. Поставщики транспорта, запущены клиент создает запрос для своих служб. При входе в систему клиента, запущены поставщиков хранилища адресной книги и сообщения.
  
Клиент вызывает [IMAPISession::OpenAddressBook](imapisession-openaddressbook.md) для загрузки каждого из поставщиками адресных книг, включенные в профиль и [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) для загрузки поставщика хранилища определенного сообщения. Поставщиками адресных книг, которые входят в состав службы сообщений, запущены перед любым из других поставщиков в службе. 
  
MAPI запускает каждого поставщика услуг в текущей конфигурации следующим образом:
  
- Поиск имя DLL в профиле. Вы должны зарегистрировать имя вашего поставщика библиотеки DLL в файле конфигурации Mapisvc.inf, чтобы убедиться, что он отображается в профиле. Когда ваш поставщик услуг добавляется в профиль по отдельности или в составе службы сообщений, все разделы **[Поставщика услуг]** из Mapisvc.inf, которые применяются к поставщику, копируются в профиль. Дополнительные сведения о структуре Mapisvc.inf можно [Файл формата MapiSvc.inf](file-format-of-mapisvc-inf.md).
    
- Вызов функции Windows API **LoadLibrary** для загрузки библиотеки DLL. Так как MAPI вызывает **LoadLibrary** либо каждый раз, когда используется поставщик службы DLL (независимо от того, является ли он уже загружена) или только в первый раз, ваш поставщик услуг не может делать предположения об количество раз, которые будут загружаться. Для каждого вызова **метода LoadLibrary**MAPI выполняется вызов функции Windows API **FreeLibrary** при поставщика услуг, которые больше не требуется DLL-Библиотеку. 
    
- Вызов функции точки входа для поставщика. MAPI вызывает функцию точки входа вашего поставщика, чтобы начать процесс входа в систему. Точка входа функции убедитесь, что используется версия интерфейса поставщика службы (SPI), совместимый с версией MAPI. Также эти функции возвращают указатели на объекты только что созданный поставщика. Дополнительные сведения о создании запись точки функции для поставщика см [реализации функции выберите запись службы поставщика](implementing-a-service-provider-entry-point-function.md).
    
## <a name="see-also"></a>См. также



[Поставщиков служб MAPI](mapi-service-providers.md)


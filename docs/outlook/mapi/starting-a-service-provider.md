---
title: Запуск поставщика услуг
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c4b61cc3-d9fe-4616-a05c-d1e4096b5abd
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: f67976681ef0283c86e1c09c49e531572668ff50
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439557"
---
# <a name="starting-a-service-provider"></a>Запуск поставщика услуг

 
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
В какой-то момент после того, как клиент начнет сеанс с MAPI, поставщик услуг будет запущен. Поставщики транспорта запущены, когда клиент делает запрос на свои услуги. Поставщики адресной книги и магазина сообщений запущены во время процесса логона клиента.
  
Клиент вызывает [IMAPISession::OpenAddressBook,](imapisession-openaddressbook.md) чтобы загрузить каждый из поставщиков адресных книг, включенных в профиль, и [IMAPISession::OpenMsgStore](imapisession-openmsgstore.md) для загрузки определенного поставщика магазина сообщений. Поставщики адресных книг, которые являются частью службы сообщений, запущены перед любым из других поставщиков в службе. 
  
MAPI запускает каждого поставщика услуг в активном профиле, делая следующее:
  
- Поиск имени DLL в профиле. Необходимо зарегистрировать имя поставщика DLL в файле конфигурации Mapisvc.inf, чтобы убедиться, что оно отображается в профиле. Когда поставщик услуг добавляется в профиль, индивидуально или в составе службы сообщений, все разделы **[Поставщик услуг]** из Mapisvc.inf, применимые к поставщику, копируется в профиль. Дополнительные сведения о структуре Mapisvc.inf см. в файловом [формате MapiSvc.inf.](file-format-of-mapisvc-inf.md)
    
- Вызов функции Windows API **LoadLibrary** для загрузки DLL. Так как MAPI вызывает **LoadLibrary** каждый раз, когда он использует поставщика услуг DLL (независимо от того, был ли он загружен) или только в первый раз, поставщик услуг не должен делать предположений о количестве загрузок. При каждом вызове **в LoadLibrary** MAPI звонит в функцию API Windows **FreeLibrary,** когда DLL поставщика услуг больше не требуется. 
    
- Вызов функции точки входа для поставщика. MAPI вызывает функцию точки входа поставщика, чтобы инициировать процесс логона. Функции точки входа гарантируют использование версии интерфейса поставщика услуг (SPI), которая совместима с версией, используемой MAPI. Эти функции также возвращают указатели для вновь созданных объектов-поставщиков. Дополнительные сведения о создании функции точки входа для поставщика см. в примере [Implementing a Service Provider Entry Point Function.](implementing-a-service-provider-entry-point-function.md)
    
## <a name="see-also"></a>См. также



[Поставщики услуг MAPI](mapi-service-providers.md)


---
title: Запуск поставщика услуг
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c4b61cc3-d9fe-4616-a05c-d1e4096b5abd
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: f67976681ef0283c86e1c09c49e531572668ff50
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439557"
---
# <a name="starting-a-service-provider"></a>Запуск поставщика услуг

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В некоторый момент после того, как клиент начнет сеанс с MAPI, ваш поставщик услуг будет запущен. Поставщики транспорта запускаются, когда клиент отправляет запрос на их службы. Адресные книги и поставщики хранилища сообщений запускаются в процессе входа клиента.
  
Клиент вызывает [IMAPISession:: опенаддрессбук](imapisession-openaddressbook.md) для загрузки каждого из поставщиков адресных книг, включенных в профиль, и [IMAPISession:: опенмсгсторе](imapisession-openmsgstore.md) для загрузки определенного поставщика хранилища сообщений. Поставщики адресных книг, являющиеся частью службы сообщений, запускаются до других поставщиков в службе. 
  
MAPI запускает каждого поставщика услуг в активном профиле, выполнив следующие действия:
  
- Поиск имени DLL в профиле. Необходимо зарегистрировать имя библиотеки DLL поставщика в файле конфигурации Mapisvc. INF, чтобы убедиться в том, что он отображается в профиле. Когда поставщик услуг добавляется в профиль отдельно или в составе службы сообщений, все разделы **[поставщик услуг]** из Mapisvc. INF, применимые к поставщику, копируются в профиль. Дополнительные сведения о структуре Mapisvc. INF приведены в разделе [Формат файлов файла Mapisvc. INF](file-format-of-mapisvc-inf.md).
    
- Вызов функции **LOADLIBRARY** API Windows для загрузки DLL. Так как функция **LoadLibrary вызывает LoadLibrary** всякий раз, когда она использует библиотеку DLL поставщика услуг (независимо от того, была ли она загружена) или только первый раз, поставщик услуг не должен делать предположения о количестве загруженности. При каждом вызове метода **LoadLibrary**MAPI вызывает функцию Windows API **FreeLibrary** , если библиотека DLL поставщика услуг больше не нужна. 
    
- Вызов функции точки входа для поставщика. MAPI вызывает функцию точки входа поставщика для запуска процесса входа. Функции точки входа гарантируют, что вы используете версию интерфейса поставщика услуг (SPI), совместимую с версией, используемой MAPI. Эти функции также возвращают указатели на вновь созданные объекты поставщика. Для получения дополнительных сведений о создании функции точки входа для поставщика, ознакомьтесь со статьей [Реализация функции точки входа поставщика услуг](implementing-a-service-provider-entry-point-function.md).
    
## <a name="see-also"></a>См. также



[Поставщики службы MAPI](mapi-service-providers.md)


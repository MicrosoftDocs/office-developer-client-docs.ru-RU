---
title: Советы по повышению производительности таблиц
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ac82f7e8-6453-4b4f-8223-3c23d09ca4c6
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 82be33090a63f24c430007d9759045c365961f5d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412515"
---
# <a name="tips-for-better-table-performance"></a>Советы по повышению производительности таблиц
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поскольку многие операции с таблицами могут быть отнимательными и не существует способа показать ход выполнения, для повышения производительности полезно использовать следующие методы:
  
- **Make [IMAPITable : IUnknown](imapitableiunknown.md) calls in the correct order**
    
   Клиенты и поставщики услуг могут работать с таблицами различными способами. Они могут открыть таблицу и получить данные для всех строк с помощью набора столбцов по умолчанию и порядка сортировки. Кроме того, они могут изменять это представление таблицы по умолчанию, изменяя набор столбцов, изменяя порядок сортировки или устанавливая ограничение, чтобы сузить область таблицы. Пользователи таблиц, которые намерены выполнить одну или несколько из этих операций, прежде чем получить какие-либо данные, должны выполнять их в следующем порядке:
    
    1. Определите набор столбцов [с помощью IMAPITable::SetColumns.](imapitable-setcolumns.md)
        
    2. Установить ограничение с [помощью IMAPITable::Restrict.](imapitable-restrict.md)
        
    3. Определите порядок сортировки [с помощью IMAPITable::SortTable.](imapitable-sorttable.md)
    
    Выполнение этих задач в этом порядке ограничивает количество строк и столбцов, которые будут отсортироваться, тем самым повышая производительность.
    
- **Задержка операции с использованием флага TBL_BATCH по возможности**
    
    Установка флага TBL BATCH для метода позволяет реализации таблицы собирать несколько вызовов, прежде чем действовать на любой \_ из них. Вместо того чтобы делать потенциально много вызовов на удаленный сервер; Реализации таблицы может сделать один, выполняя все операции одновременно. Результаты операций не оцениваются, пока они не будут необходимы. 
    
    Например, если клиент вызывает [IMAPITable::Restrict,](imapitable-restrict.md) чтобы указать ограничение с установленным флагом пакета TBL, это ограничение не вступает в силу, пока клиент не вызывает \_ [IMAPITable::QueryRows](imapitable-queryrows.md) для получения данных. Это позволяет реализации таблицы объединить работу двух вызовов в один. Пользователи таблиц, которые пользуются флагом TBL BATCH, должны знать, что обработка ошибок в этих условиях \_ может быть более сложной. 
    
    Так как обработка ошибок отложенной операции аналогична обработке ошибок при DEFERRED_ERRORS MAPI, дополнительные сведения см. в подстройки \_ [Deferring MAPI Errors.](deferring-mapi-errors.md) 
    
- **Сохранение кэша часто используемых свойств**
    
    Поставщики услуг, реализующие таблицы, могут уменьшить время, необходимое для создания представления, кэширует копии часто используемых свойств объектов. Сохранение копии этих свойств в памяти экономит их извлечение из объекта при каждом перестроенном представлении.
    
## <a name="see-also"></a>См. также

- [Таблицы MAPI](mapi-tables.md)


---
title: Советы по повышению производительности таблиц
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ac82f7e8-6453-4b4f-8223-3c23d09ca4c6
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 82be33090a63f24c430007d9759045c365961f5d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412515"
---
# <a name="tips-for-better-table-performance"></a>Советы по повышению производительности таблиц
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Так как многие операции с таблицами могут занимать много времени и не позволяют определить ход выполнения, для улучшения производительности рекомендуется использовать следующие методы:
  
- **Сделайте вызов [IMAPITable: Вызовы IUnknown](imapitableiunknown.md) в правильном порядке**
    
   Клиенты и поставщики услуг могут работать с таблицами различными способами. Они могут открыть таблицу и получить данные для всех строк, используя набор столбцов по умолчанию и порядок сортировки. Кроме того, они могут изменять это представление таблицы по умолчанию, изменяя набор столбцов, изменяя порядок сортировки или устанавливая ограничение для сужения области таблицы. Пользователи таблиц, которые планирует выполнить одну или несколько из этих операций перед получением данных, должны выполнить их в следующем порядке:
    
    1. Определите набор столбцов с помощью [IMAPITable:: метода SetColumns](imapitable-setcolumns.md).
        
    2. Установите ограничение с помощью [IMAPITable:: restrict](imapitable-restrict.md).
        
    3. Определите порядок сортировки с помощью [IMAPITable:: сорттабле](imapitable-sorttable.md).
    
    Выполнение этих задач в этом порядке ограничит число строк и столбцов, которые будут отсортированы, что повышает производительность.
    
- **Задержка операции с использованием флага TBL_BATCH, если это возможно**
    
    Установка флага\_пакета tbl для метода позволяет средству реализации таблицы собирать несколько вызовов перед началом работы с одним из них. Вместо того чтобы совершать потенциально много вызовов на удаленный сервер; средство реализации таблиц может сделать одно, одновременно выполнив все операции. Результаты операций не оцениваются до тех пор, пока они не потребуются. 
    
    Например, когда клиент вызывает функцию [IMAPITable:: restrict](imapitable-restrict.md) to указать ограничение с установленным флагом пакета tbl\_, ограничение не обязательно будет применяться до тех пор, пока клиент не выйдет вызов [IMAPITable:: QueryRows](imapitable-queryrows.md) для получения данных. Это позволяет разработчику таблицы объединять работу двух вызовов в одну. Пользователи таблиц, которые используют преимущества пакетного\_ФЛАГа tbl, должны знать, что обработка ошибок для этих условий может быть более сложной. 
    
    Так как обработка ошибок из отложенной операции аналогична обработке ошибок при установке флага MAPI\_DEFERRED_ERRORS, дополнительные сведения приведены в разделе [Задержка ошибок MAPI](deferring-mapi-errors.md) . 
    
- **Сохранение кэша часто используемых свойств**
    
    Поставщики услуг, реализующие таблицы, могут уменьшить время, необходимое для создания представления путем кэширования копий часто используемых свойств объекта. Сохранение копии этих свойств в памяти позволяет извлекать их из объекта каждый раз, когда необходимо перестроить представление.
    
## <a name="see-also"></a>См. также

- [Таблицы MAPI](mapi-tables.md)


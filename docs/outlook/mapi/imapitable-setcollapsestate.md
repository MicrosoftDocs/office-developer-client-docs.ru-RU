---
title: Имапитаблесетколлапсестате
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SetCollapseState
api_type:
- COM
ms.assetid: 31325e8f-1cf9-49b2-8118-953996b0037f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7351457dc5b72cfc4a7ef9f91e9d33a80ca98c39
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414069"
---
# <a name="imapitablesetcollapsestate"></a>IMAPITable::SetCollapseState

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Перестраивает текущее развернутое или свернутое состояние таблицы с классификацией с использованием данных, сохраненных при предыдущем вызове метода [IMAPITable:: жетколлапсестате](imapitable-getcollapsestate.md) . 
  
```cpp
HRESULT SetCollapseState(
ULONG ulFlags,
ULONG cbCollapseState,
LPBYTE pbCollapseState,
BOOKMARK FAR * lpbkLocation
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> Резервирования должно быть равно нулю.
    
 _Кбколлапсестате_
  
> возврата Количество байтов в структуре, на которую указывает параметр _пбколлапсестате_ . 
    
 _Пбколлапсестате_
  
> возврата Указатель на структуры, содержащие данные, необходимые для перестроения представления таблицы.
    
 _Лпбклокатион_
  
> вышли Указатель на закладку, указывающую строку в таблице, в которой должно быть перестроено свернутое или развернутое состояние. Эта закладка и ключ экземпляра передаются в параметре _лпбинстанцекэй_ в вызове [IMAPITable:: жетколлапсестате](imapitable-getcollapsestate.md) Идентифицируйте ту же строку. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Состояние таблицы, классифицированной по категориям, успешно перестроено.
    
МАПИ_Е_БУСИ 
  
> Выполняется другая операция, которая не позволяет запустить операцию. Выполнение выполняемой операции должно быть разрешено или остановлено.
    
МАПИ_Е_УНАБЛЕ_ТО_КОМПЛЕТЕ 
  
> Таблице не удалось завершить перестроение свернутого или расширенного представления.
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable:: сетколлапсестате** переустанавливает развернутое или свернутое состояние представления таблицы. **Сетколлапсестате** и **жетколлапсестате** работают вместе следующим образом: 
  
1. Когда состояние таблицы, классифицированной по категориям, будет изменено, вызов [IMAPITable:: жетколлапсестате](imapitable-getcollapsestate.md) вызывается для сохранения всех данных, относящихся к состоянию до изменения. 
    
2. Чтобы восстановить сохраненное состояние таблицы, вызывается метод **сетколлапсестате** . Данные, сохраненные в **жетколлапсестате** , передаются в **сетколлапсестате**. **Сетколлапсестате** может использовать эти данные для восстановления состояния. 
    
3. **Сетколлапсестате** возвращает в качестве выходного параметра закладку, которая определяет ту же строку, что и ключ экземпляра, переданный в качестве входных данных для **жетколлапсестате**.
    
Для получения дополнительных сведений об классифицированных таблицах, ознакомьтесь со статьей [Сортировка и категоризация](sorting-and-categorization.md). 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Вы несете ответственность за проверку того, что порядок сортировки и ограничения точно совпадают со временем вызова **жетколлапсестате** . Если было сделано изменение, **сетколлапсестате** не должно вызываться, так как результаты могут быть непредсказуемыми. Это может произойти, если, например, клиент вызывает **жетколлапсестате** , а затем **сорттабле** для изменения ключа сортировки перед вызовом **сетколлапсестате**. Чтобы обеспечить безопасность, убедитесь, что сохраненные данные все еще действительны, прежде чем продолжить восстановление. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Для вызова **сетколлапсестате**необходимо ранее вызвать **жетколлапсестате**. Порядок сортировки, устанавливающий категории, должен быть одинаковым для обоих методов. Если порядок сортировки отличается, результаты операции **сетколлапсестате** непредсказуемы. 
  
## <a name="see-also"></a>См. также



[IMAPITable::CreateBookmark](imapitable-createbookmark.md)
  
[IMAPITable::FreeBookmark](imapitable-freebookmark.md)
  
[IMAPITable::GetCollapseState](imapitable-getcollapsestate.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


---
title: IMAPITableSortTable
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SortTable
api_type:
- COM
ms.assetid: ff5f78ac-06cf-46fb-93da-5f4a3a5d1b22
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f16ba9164d55fdb7bd688d4068f99dc4407e5413
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432368"
---
# <a name="imapitablesorttable"></a>IMAPITable::SortTable

**Область применения**: Outlook 2013 | Outlook 2016 
  
Метод **IMAPITable::SortTable** заказывает строки таблицы в зависимости от критериев сортировки. 
  
```cpp
HRESULT SortTable(
LPSSortOrderSet lpSortCriteria,
ULONG ulFlags
);
```

## <a name="parameters"></a>Parameters

_lpSortCriteria_
  
> [in] Указатель на [структуру SSortOrderSet,](ssortorderset.md) которая содержит критерии сортировки для применения. Передача **структуры SSortOrderSet** с нулем столбцов указывает на то, что таблицу не нужно сортировать в любом конкретном порядке. 
    
_ulFlags_
  
> [in] Bitmask флагов, которые контролируют время **операции IMAPITable::SortTable.** Можно установить следующие флаги: 
    
TBL_ASYNC 
  
> Запускает операцию асинхронно и возвращается до завершения операции.
    
TBL_BATCH 
  
> Откладывает завершение сортировки до тех пор, пока не потребуются данные в таблице.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция сортировки прошла успешно.
    
MAPI_E_BUSY 
  
> В настоящее время продолжается другая операция, которая не позволяет начать операцию сортировки. Либо операция должна быть разрешена к завершению, либо она должна быть остановлена.
    
MAPI_E_NO_SUPPORT 
  
> В таблице не поддерживается тип запрашиваемой сортировки.
    
MAPI_E_TOO_COMPLEX 
  
> Таблица не может выполнять операцию, так как определенные критерии сортировки, на которые указывает параметр  _lpSortCriteria,_ слишком сложны. **SortTable** может MAPI_E_TOO_COMPLEX в следующих условиях. 
    
   - Для столбца свойств, который не может сортироваться, запрашивается операция сортировки.
    
   - Реализация не поддерживает заказ сортировки, запрашиваемого в **члене ulOrder** структуры **SSortOrderSet.** 
    
   - Количество столбцов для сортировки, как указано в члене **cSorts** в **SSortOrderSet,** больше, чем может обрабатывать реализация.
    
   - Запрашивается операция сортировки, как указывает тег свойства **в SSortOrderSet,** на основе свойства, которое не находится в доступном или активном наборе, и реализация не поддерживает сортировку свойств, не имеющихся в доступном наборе.
    
   - Одно свойство указывается несколько раз в наборе порядка сортировки, как указывается несколькими экземплярами одного и того же тега свойств, и реализация не может выполнять такую операцию сортировки.
    
   - Операция сортировки, основанная на столбцах многоценных свойств, запрашивается с помощью MVI_FLAG и реализация не поддерживает сортировку по многоценным свойствам. 
    
   - Тег свойства свойства в **SSortOrderSet** указывает свойство или тип, который не поддерживается реализацией. 
    
   - Операция сортировки, которая проходит через таблицу  из свойства[PR_RENDERING_POSITION (PidTagRenderingPosition),](pidtagrenderingposition-canonical-property.md)указывается только для таблицы вложений, которая поддерживает этот тип сортировки.
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::SortTable** заказывает строки в представлении таблицы. В то время как некоторые таблицы поддерживают стандартную и категоризированную сортировку в различных столбцах ключей сортировки, другие таблицы более ограничены в их поддержке. Поставщики адресных книг обычно не поддерживают сортировку таблиц. Поставщики магазинов сообщений обычно поддерживают сортировку до такой степени, что они сохраняют порядок сортировки папок, который приводит к сортировке полной таблицы (таблицы без ограничений). 
  
Некоторые таблицы позволяют сортировать в любом столбце таблицы. Другие таблицы не являются; столбцы, не включенные в представление таблицы, не влияет на вызов **SortTable.** Некоторые таблицы требуют, чтобы ключи сортировки были построены только с помощью столбцов в текущем наборе столбцов таблицы. 
  
Таблица может возвращаться MAPI_E_NO_SUPPORT или MAPI_E_TOO_COMPLEX **из SortTable,** если она не может выполнить операцию сортировки. Кроме того, поставщики магазинов не гарантируют честь набора сортировки, заданного для таблиц иерархии. 
  
Если в структуре [SSortOrderSet](ssortorderset.md) имеются нулевые столбцы, на которые указывает параметр  _lpSortCriteria,_ в таблице возвращается текущий набор столбцов. Текущий порядок сортировки можно получить, позвонив по методу [IMAPITable::QuerySortOrder.](imapitable-querysortorder.md) 
  
Все закладки для таблицы недействительны и должны быть удалены при вызове в **SortTable,** а закладки BOOKMARK_CURRENT, которая указывает текущее положение курсора, следует установить в начале таблицы. 
  
Если вы сортировать столбец, содержащий многоценное свойство без MVI_FLAG флага, значения столбца рассматриваются как полностью упорядоченный пучок. Сравнение двух многооценных столбцов сравнивает элементы столбцов в порядке, сообщая о связи столбцов при первом неравенстве, и возвращает равенство только в том случае, если сравниваемые столбцы содержат одинаковые значения в том же порядке. Если у одного столбца меньше значений, чем у другого, сообщаемая связь имеет значение null к другому значению.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

**SortTable** работает синхронно, если не установить один из флагов. Если вы установите флаг TBL_BATCH, **SortTable** откладывает операцию сортировки, если не запрашивать данные. Если флаг TBL_ASYNC установлен, **SortTable** работает асинхронно, потенциально возвращаясь до завершения операции. 
  
Вызов метода [IMAPITable::Abort,](imapitable-abort.md) чтобы остановить асинхронную операцию, если необходимо немедленно сделать сортировку. Если **sortTable** не может продолжиться, так как одна или несколько асинхронных операций на таблице находятся в процессе выполнения, он возвращает MAPI_E_BUSY. 
  
Для лучшей производительности вызываем **SetColumns** для  настройки набора столбцов таблицы и ограничим ограничение количества строк в таблице перед вызовом **SortTable** для выполнения сортировки. 
  
При **сбое SortTable** порядок сортировки, который был в силе до сбоя, по-прежнему действует. 
  
## <a name="see-also"></a>См. также

- [IMAPITable::Abort](imapitable-abort.md)
- [IMAPITable::GetRowCount](imapitable-getrowcount.md)
- [IMAPITable::QueryColumns](imapitable-querycolumns.md)
- [IMAPITable::QuerySortOrder](imapitable-querysortorder.md)
- [IMAPITable::SetColumns](imapitable-setcolumns.md)
- [SSortOrderSet](ssortorderset.md)
- [IMAPITable : IUnknown](imapitableiunknown.md)


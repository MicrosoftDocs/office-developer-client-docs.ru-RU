---
title: имапитаблесорттабле
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SortTable
api_type:
- COM
ms.assetid: ff5f78ac-06cf-46fb-93da-5f4a3a5d1b22
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f16ba9164d55fdb7bd688d4068f99dc4407e5413
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432368"
---
# <a name="imapitablesorttable"></a>IMAPITable::SortTable

**Относится к**: Outlook 2013 | Outlook 2016 
  
Метод **IMAPITable:: сорттабле** упорядочивает строки таблицы в зависимости от условий сортировки. 
  
```cpp
HRESULT SortTable(
LPSSortOrderSet lpSortCriteria,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

_лпсорткритериа_
  
> возврата Указатель на структуру [ссортордерсет](ssortorderset.md) , которая содержит применяемые критерии сортировки. Передача структуры **ссортордерсет** , содержащей нулевые столбцы, указывает на то, что таблица не должна быть отсортирована в определенном порядке. 
    
_ulFlags_
  
> возврата Битовая маска флагов, которые управляют временем действия **IMAPITable:: сорттабле** . Можно задать следующие флаги: 
    
TBL_ASYNC 
  
> Асинхронно запускает операцию и возвращает результат до завершения операции.
    
TBL_BATCH 
  
> Откладывает выполнение сортировки до тех пор, пока данные в таблице не будут обязательными.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция сортировки выполнена успешно.
    
MAPI_E_BUSY 
  
> Выполняется другая операция, которая не позволяет начать операцию сортировки. Выполнение выполняемой операции должно быть разрешено или остановлено.
    
MAPI_E_NO_SUPPORT 
  
> Таблица не поддерживает тип запрошенной сортировки.
    
MAPI_E_TOO_COMPLEX 
  
> Таблице не удается выполнить операцию, так как некоторые критерии сортировки, на которые указывает параметр _лпсорткритериа_ , слишком сложны. **Сорттабле** могут возвращать MAPI_E_TOO_COMPLEX в следующих условиях. 
    
   - Для столбца свойств, который не может сортировать реализация, запрашивается операция сортировки.
    
   - Реализация не поддерживает порядок сортировки, запрошенный в элементе **улордер** структуры **ссортордерсет** . 
    
   - Число столбцов, которые необходимо отсортировать, как указано в элементе **ксортс** в **ссортордерсет**, больше, чем может обрабатывать реализация.
    
   - Запрашивается операция сортировки, как указано в теге свойства в **ссортордерсет**, на основе свойства, которое не является доступным или активным, а реализация не поддерживает сортировку свойств, не включенных в набор доступных.
    
   - Одно свойство указывается несколько раз в наборе порядка сортировки, как указано в нескольких экземплярах одного тега свойства, и реализация не может выполнять такую операцию сортировки.
    
   - Операция сортировки, основанная на столбцах с многозначными свойствами, запрашивается с помощью MVI_FLAG, а реализация не поддерживает сортировку в многозначных свойствах. 
    
   - Тег свойства для свойства в **ссортордерсет** указывает свойство или тип, который не поддерживается в реализации. 
    
   - Операция сортировки, отличная от таблицы из свойства **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)), задается только для таблицы вложений, поддерживающей этот тип сортировки.
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable:: сорттабле** упорядочивает строки в табличном представлении. В то время как некоторые таблицы поддерживают как стандартную, так и сортировку по нескольким ключевым столбцам сортировки, другие таблицы в их поддержке более ограничены. Как правило, поставщики адресных книг не поддерживают сортировку таблиц. Поставщики хранилищ сообщений обычно поддерживают сортировку в экстент, в котором они сохраняют порядок сортировки папок, которые отображаются при сортировке всей таблицы (таблицы без ограничений). 
  
Некоторые таблицы позволяют выполнять сортировку для любого столбца таблицы. Другие таблицы не поддерживаются; вызов **сорттабле** не влияет на столбцы, не включенные в представление таблицы. Для некоторых таблиц требуется, чтобы ключи сортировки создавались только со столбцами в текущем наборе столбцов таблицы. 
  
Таблица может возвращать MAPI_E_NO_SUPPORT или MAPI_E_TOO_COMPLEX из **сорттабле** , когда она не может выполнить операцию сортировки. Кроме того, поставщики хранилища не гарантируют соблюдение порядка сортировки, указанного для таблиц иерархии. 
  
Если в структуре [ссортордерсет](ssortorderset.md) есть нулевые столбцы, на которые указывает параметр _лпсорткритериа_ , то таблица возвращает текущий набор столбцов. Текущий порядок сортировки можно получить, вызвав метод [IMAPITable:: куерисортордер](imapitable-querysortorder.md) в таблице. 
  
Все закладки для таблицы становятся недействительными и должны быть удалены при выполнении вызова **сорттабле** и закладке BOOKMARK_CURRENT, указывающей текущее положение курсора, должно быть равно началу таблицы. 
  
При сортировке по столбцу, содержащему многозначное свойство без установленного флага MVI_FLAG, значения столбца рассматриваются как полностью упорядоченный кортеж. Сравнение двух многозначных столбцов сравнивает элементы столбцов по порядку с первого неравенства и возвращает равенство только в том случае, если сравниваемые столбцы содержат одни и те же значения в одном порядке. Если один столбец содержит меньше значений, чем другой, то полученное отношение имеет значение NULL для другого значения.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

**Сорттабле** работает синхронно, если не установлен один из флагов. Если вы установили флаг TBL_BATCH, **сорттабле** откладывает операцию сортировки, пока не запросите данные. Если установлен флаг TBL_ASYNC, то **сорттабле** работает асинхронно, потенциально возвращать до завершения операции. 
  
Вызовите метод [IMAPITable:: Abort](imapitable-abort.md) , чтобы остановить выполнение асинхронной операции, если сортировка должна быть выполнена немедленно. Если **сорттабле** не удается продолжить, так как выполняется одна или несколько асинхронных операций над таблицей, возвращается MAPI_E_BUSY. 
  
Для достижения лучшей производительности вызовите **метода SetColumns** , чтобы настроить набор столбцов таблицы и **ограничить** количество строк в таблице перед вызовом **сорттабле** для выполнения сортировки. 
  
При сбое **сорттабле** порядок сортировки, который действовал до сбоя, по-прежнему действует. 
  
## <a name="see-also"></a>См. также

- [IMAPITable::Abort](imapitable-abort.md)
- [IMAPITable::GetRowCount](imapitable-getrowcount.md)
- [IMAPITable::QueryColumns](imapitable-querycolumns.md)
- [IMAPITable::QuerySortOrder](imapitable-querysortorder.md)
- [IMAPITable::SetColumns](imapitable-setcolumns.md)
- [SSortOrderSet](ssortorderset.md)
- [IMAPITable : IUnknown](imapitableiunknown.md)


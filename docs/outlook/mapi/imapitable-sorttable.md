---
title: IMAPITableSortTable
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SortTable
api_type:
- COM
ms.assetid: ff5f78ac-06cf-46fb-93da-5f4a3a5d1b22
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: efeff92f1a21d076c1ee58b82ad3ab25797df014
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22592306"
---
# <a name="imapitablesorttable"></a>IMAPITable::SortTable

**Область применения**: Outlook 2013 | Outlook 2016 
  
Метод **IMAPITable::SortTable** заказов строки в таблице, в зависимости от сортировки критериев. 
  
```cpp
HRESULT SortTable(
LPSSortOrderSet lpSortCriteria,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

_lpSortCriteria_
  
> [in] Указатель на структуру [SSortOrderSet](ssortorderset.md) , содержащий условия сортировки для применения. Передача структуру **SSortOrderSet** , которая содержит ноль столбцы указывает, что таблица имеет сортировки в любом порядке. 
    
_ulFlags_
  
> [in] Битовая маска флаги, определяющее время операции **IMAPITable::SortTable** . Можно задать следующие флажки: 
    
TBL_ASYNC 
  
> Асинхронно запускает операцию и возвращает до завершения операции.
    
TBL_BATCH 
  
> Определяет завершения сортировки, пока данные в таблице является обязательным.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Сортировка операция выполнена успешно.
    
MAPI_E_BUSY 
  
> В, не позволяющей сортировку запуск выполняется другой операции. В процессе выполнения операции должны выполнить либо должна быть остановлена.
    
MAPI_E_NO_SUPPORT 
  
> Таблица не поддерживает тип сортировки в запросе.
    
MAPI_E_TOO_COMPLEX 
  
> Таблицы не удается выполнить операцию, так как определенного сортировки, на который указывает параметр _lpSortCriteria_ слишком сложный. **SortTable** может вернуть MAPI_E_TOO_COMPLEX при следующих условиях. 
    
   - Операция сортировки запрашивается для столбца свойства сортировать реализации нельзя.
    
   - Реализация не поддерживает порядок сортировки, запрашиваемый в член **ulOrder** структуры **SSortOrderSet** . 
    
   - Число столбцов для сортировки, как указано в член **cSorts** в **SSortOrderSet**, больше, чем реализация может обрабатывать.
    
   - Запрашивается операция сортировки, как указано в тег свойства в **SSortOrderSet**, на основе свойства, которое не входит в набор доступных и активных и реализация не поддерживает сортировку на набор свойств.
    
   - Одно свойство задано несколько раз в наборе порядок сортировки, как указано в несколько экземпляров одной тега свойства и реализация не могут выполнять операции сортировки.
    
   - Запрашивается операция сортировки, основанные на столбцах многозначных свойств при помощи MVI_FLAG и реализация не поддерживает сортировку на многозначные свойства. 
    
   - Тег свойства для свойства в **SSortOrderSet** задает свойство или тип, который не поддерживает реализацию. 
    
   - Операция сортировки, кроме одного, которое проходит таблицы из свойства **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) переадресовывать указан только для таблицы вложений, поддерживающего этот тип сортировки.
    
## <a name="remarks"></a>Замечания

Метод **IMAPITable::SortTable** заказов строки в представлении таблицы. В то время как некоторые таблицы поддерживает стандартные и по категориям сортировка на различные столбцы, другими таблицами более ограничены в их поддержка. Поставщиками адресных книг обычно не поддерживают Сортировка в таблице. Поставщики хранилища сообщений обычно поддерживает сортировку при условии, что они сохранить порядок сортировки папок, полученные при сортировке полной таблицы (таблицы без ограничений). 
  
Некоторые таблицы разрешить сортировку необходимо выполнить для любого столбца в таблице. Нет других таблиц; столбцы, не включенные в табличном представлении не влияет на вызов **SortTable** . Для некоторых таблиц требуется создать ключи сортировки только со столбцами в текущий набор столбцов таблицы. 
  
Таблица может вернуть MAPI_E_NO_SUPPORT или MAPI_E_TOO_COMPLEX из **SortTable** , когда она не может выполнить операцию сортировки. Кроме того поставщики хранилища не обязательно соблюдать порядок сортировки, указанный для таблиц иерархии набор. 
  
При наличии ноль столбцов в структуре [SSortOrderSet](ssortorderset.md) указывает параметр _lpSortCriteria_ , таблице возвращает текущий набор столбцов. Порядок сортировки можно извлечь путем вызова метода [IMAPITable::QuerySortOrder](imapitable-querysortorder.md) таблицы. 
  
Все закладки для таблицы становятся недействительными и должны быть удалены, когда выполняется вызов для **SortTable** и необходимо задать закладку BOOKMARK_CURRENT, которое указывает текущую позицию курсора в начало таблицы. 
  
Если сортируется на столбец, который содержит свойством без установленного флага MVI_FLAG значения в столбцах обрабатывается как полностью упорядоченном кортеж. Сравнение двух многозначных столбцов сравнивает элементы столбцов в порядке, отчетов отношения столбцов в первом неравенство и возвращает равенства только в том случае, если сравниваемые столбцы содержат те же значения, в том же порядке. Если один столбец значений меньше, чем другое, переданные отношения, является значение null на другое значение.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

**SortTable** работает синхронно, если не выбрано флаги. Если установлен флаг TBL_BATCH **SortTable** откладывает сортировку, если не запрашивать данные. Если установлен флаг TBL_ASYNC, **SortTable** работает асинхронно, потенциально возврат до завершения операции. 
  
Вызовите метод [IMAPITable::Abort](imapitable-abort.md) для остановки асинхронной операции в процессе выполнения, если порядка сортировки необходимо выполнить немедленно. Если **SortTable** не может продолжать работу, так как один или несколько асинхронной операции для таблицы находятся в процессе выполнения, возвращает MAPI_E_BUSY. 
  
Для достижения наилучшей производительности вызова **метода SetColumns** для настройки набора столбцов таблицы и **ограничить** для ограничения количество строк в таблице, прежде чем вызывать **SortTable** для выполнения сортировки. 
  
Каждый раз, когда происходит сбой **SortTable** , порядок сортировки, который был фактически до сбоя — это по-прежнему в силу. 
  
## <a name="see-also"></a>См. также

- [IMAPITable::Abort](imapitable-abort.md)
- [IMAPITable::GetRowCount](imapitable-getrowcount.md)
- [IMAPITable::QueryColumns](imapitable-querycolumns.md)
- [IMAPITable::QuerySortOrder](imapitable-querysortorder.md)
- [IMAPITable::SetColumns](imapitable-setcolumns.md)
- [SSortOrderSet](ssortorderset.md)
- [IMAPITable : IUnknown](imapitableiunknown.md)


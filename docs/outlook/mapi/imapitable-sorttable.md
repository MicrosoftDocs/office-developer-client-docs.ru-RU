---
title: IMAPITableSortTable
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SortTable
api_type:
- COM
ms.assetid: ff5f78ac-06cf-46fb-93da-5f4a3a5d1b22
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f16ba9164d55fdb7bd688d4068f99dc4407e5413
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432368"
---
# <a name="imapitablesorttable"></a>IMAPITable::SortTable

**Относится к**: Outlook 2013 | Outlook 2016 
  
Метод **IMAPITable::SortTable** заказыывает строки таблицы в зависимости от критериев сортировки. 
  
```cpp
HRESULT SortTable(
LPSSortOrderSet lpSortCriteria,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

_lpSortCriteria_
  
> [in] Указатель на [структуру SSortOrderSet,](ssortorderset.md) которая содержит критерии сортировки, которые необходимо применить. Передача структуры **SSortOrderSet,** которая содержит ноль столбцов, означает, что таблица не должна сортироваться в определенном порядке. 
    
_ulFlags_
  
> [in] Битоваяmas флагов, которая управляет временем операции **IMAPITable::SortTable.** Можно установить следующие флаги: 
    
TBL_ASYNC 
  
> Запускает операцию асинхронно и возвращается до ее завершения.
    
TBL_BATCH 
  
> Откладывает завершение сортировки до тех пор, пока не потребуются данные в таблице.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция сортировки прошла успешно.
    
MAPI_E_BUSY 
  
> В настоящее время идет другая операция, которая препятствует запуску операции сортировки. Либо операция должна быть разрешена для завершения, либо она должна быть остановлена.
    
MAPI_E_NO_SUPPORT 
  
> Таблица не поддерживает тип запрашиваемой сортировки.
    
MAPI_E_TOO_COMPLEX 
  
> Таблица не может выполнить операцию, так как конкретные критерии сортировки, на которые указывает параметр  _lpSortCriteria,_ слишком сложны. **SortTable** может возвращать MAPI_E_TOO_COMPLEX при следующих условиях. 
    
   - Для столбца свойств, который не удается отсортировать, запрашивается операция сортировки.
    
   - Реализация не поддерживает порядок сортировки, запрашиваемой в члене **ulOrder** структуры **SSortOrderSet.** 
    
   - Количество столбцов, которые необходимо отсортировать, как указано в члене **cSorts** в **SSortOrderSet,** больше, чем может обработать реализация.
    
   - Запрашивается операция сортировки, как указывает тег свойства в **SSortOrderSet,** на основе свойства, которое отсутствует в доступном или активном наборе, и реализация не поддерживает сортировку по свойствам, недоступным в доступном наборе.
    
   - Одно свойство указывается несколько раз в наборе порядка сортировки, как указано несколькими экземплярами одного тега свойства, и реализация не может выполнять такую операцию сортировки.
    
   - Операция сортировки на основе столбцов многоценных свойств запрашивается с помощью MVI_FLAG и реализация не поддерживает сортировку по многоценным свойствам. 
    
   - Тег свойства для свойства **в SSortOrderSet** указывает свойство или тип, которые реализация не поддерживает. 
    
   - Операция сортировки, которая проходит через таблицу из свойства **PR_RENDERING_POSITION** ([PidTagRenderingPosition),](pidtagrenderingposition-canonical-property.md)задана только для таблицы вложений, которая поддерживает этот тип сортировки.
    
## <a name="remarks"></a>Примечания

Метод **IMAPITable::SortTable** заказывает строки в представлении таблицы. В то время как некоторые таблицы поддерживают стандартную и категоризированную сортировку в различных столбцах ключей сортировки, другие таблицы поддерживаются более ограниченно. Поставщики адресных книг обычно не поддерживают сортировку таблиц. Поставщики store сообщений обычно поддерживают сортировку в той степени, в какой они хранят порядок сортировки папок, который приводит к сортировке полной таблицы (таблицы без ограничений). 
  
Некоторые таблицы позволяют сортировать любой столбец таблицы. Другие таблицы этого не делают; вызов **SortTable** не влияет на столбцы, не включенные в представление таблицы. В некоторых таблицах требуется, чтобы ключи сортировки были построены только с помощью столбцов в текущем наборе столбцов таблицы. 
  
Таблица может возвращать MAPI_E_NO_SUPPORT или MAPI_E_TOO_COMPLEX из **SortTable,** если не удается выполнить операцию сортировки. Кроме того, поставщики магазина не гарантируют, что они будут соблюдать набор заказов сортировки, указанный для таблиц иерархии. 
  
При нулевом числе столбцов в структуре [SSortOrderSet,](ssortorderset.md) на которые указывает параметр  _lpSortCriteria,_ таблица возвращает текущий набор столбцов. Текущий порядок сортировки можно получить путем вызова метода [IMAPITable::QuerySortOrder таблицы.](imapitable-querysortorder.md) 
  
Все закладки для таблицы недействительны и должны удаляться при вызове **SortTable,** а закладка BOOKMARK_CURRENT, которая указывает текущее положение курсора, должна быть установлена в начале таблицы. 
  
При сортировке столбца, который содержит многоценное свойство без MVI_FLAG флага, значения столбца рассматриваются как полностью упорядоченный набор. Сравнение двух столбцов с несколькими значениями сравнивает элементы столбцов по порядку, сообщает о связи столбцов при первом ветвях и возвращает уровень равенства только в том случае, если сравниваемые столбцы содержат одинаковые значения в одном порядке. Если в одном столбце меньше значений, чем в другом, сообщается, что относительно другого имеется значение null.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

**SortTable** работает синхронно, если не установлен один из флагов. Если установлен флаг TBL_BATCH, **SortTable** откладывает операцию сортировки, если вы не запросили данные. Если флаг TBL_ASYNC установлен, **SortTable** работает асинхронно, потенциально возвращаясь до завершения операции. 
  
Вызовите метод [IMAPITable::Abort,](imapitable-abort.md) чтобы остановить асинхронную операцию, если сортировка должна быть сделана немедленно. Если **SortTable** не удается продолжить из-за выполнения одной или более асинхронных операций в таблице, она возвращает MAPI_E_BUSY. 
  
Для лучшей производительности вызовите **SetColumns,** чтобы  настроить набор столбцов таблицы, и ограничить количество строк в таблице перед вызовом **SortTable** для выполнения сортировки. 
  
При **сбое SortTable** порядок сортировки, который был действовать до сбоя, остается в силе. 
  
## <a name="see-also"></a>См. также

- [IMAPITable::Abort](imapitable-abort.md)
- [IMAPITable::GetRowCount](imapitable-getrowcount.md)
- [IMAPITable::QueryColumns](imapitable-querycolumns.md)
- [IMAPITable::QuerySortOrder](imapitable-querysortorder.md)
- [IMAPITable::SetColumns](imapitable-setcolumns.md)
- [SSortOrderSet](ssortorderset.md)
- [IMAPITable : IUnknown](imapitableiunknown.md)


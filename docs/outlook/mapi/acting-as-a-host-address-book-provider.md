---
title: Будет действовать как поставщик адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: '���� ���������� ���������: 23 ���� 2011 �.'
ms.openlocfilehash: cf52062eacbd13b45087df9d8558bffd43ccd744
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808011"
---
# <a name="acting-as-a-host-address-book-provider"></a>Будет действовать как поставщик адресной книги

  
  
**Применимо к**: Outlook 
  
Этот поставщик является поставщика адресных книг, содержащую получателей из других поставщиков в его контейнеров и зависит от реализации получателей с другими поставщиками частично управлять их обслуживания. Этот поставщик использует идентификаторы шаблон этих внешних получателей для привязки данных для этих получателей для кода в внешнего поставщика. Этот процесс привязки инициируется, когда поставщик Получает свойство **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) получателя и передает его в вызове [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md). 
  
Если поставщик звонки **IMAPISupport::OpenTemplateID**, MAPI соответствует **MAPIUID** в рамках идентификатор шаблона с **MAPIUID** зарегистрировано с помощью поставщика и вызывает метод [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) поставщика. Внешний поставщик может вернуть указатель на объект свойство ваш поставщик собственная реализация объекта свойство или на реализацию, которая имеет объект вашего поставщика. Возвращенный указатель переводится в содержимое параметра _lppMAPIPropNew_ . 
  
Ваш поставщик можно выбрать ли вызов **IMAPISupport::OpenTemplateID** с установленным флагом FILL_ENTRY. Установите этот флаг, при создании получателя или когда длительное время прошедшее ваш поставщик обновлен свойства получателя. Флаг FILL_ENTRY обычно используется для хранения получателя в ваш поставщик синхронизации с исходной. Реализация этого типа расписания синхронизации повышает производительность. 
  
 **Для сохранения внешнего получателя синхронизации**
  
1. Определите соответствующий интервал для периодического обновления. 
    
2. Метка времени каждого вызова [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md). 
    
3. Оценка ли это необходимо для выполнения полного обновления на основании количество времени, истек срок действия с момента последнего вызова. При необходимости полного обновления вызовите **IMAPISupport::OpenTemplateID** с флагом FILL_ENTRY. Если не требуется, не задан флаг на звонок. 
    
Клиент создает запрос для одного свойства скопированной получателя, к поставщику можно выбирать обработать запрос самого или использовать код из внешнего службы. Поставщик может предполагать внешнего поставщика для перехвата наиболее, если не все, вызовы **IMAPIProp** за исключением [IMAPIProp::OpenProperty](imapiprop-openproperty.md). Вызов **OpenProperty** разрешения на запрос свойства **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) всегда перенаправляется в ваш поставщик.
  
 **Для доступа к коду идентификатор шаблона**
  
1. Откройте получателя и вызвать метод [IMAPIProp::GetProps](imapiprop-getprops.md) для получения свойства **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)). В случае сбоя **GetProps** недоступностью **PR_TEMPLATEID** внешнего поставщика не поддерживает идентификатор шаблона и связанных с ними код для данного получателя. Ваш поставщик потребуется использовать его реализация получателя для всех обслуживания. 
    
2. Если **GetProps**возвращает идентификатор шаблона, передайте его и указатель для реализации **IMAPIProp** получателя в вызове метода **IMAPISupport::OpenTemplateID** . Установите для флага FILL_ENTRY большинство или все свойства получателя должны быть обновленные, например, во время создания или если они не были обновлены, чтобы некоторое время. 
    
3. Если **OpenTemplateID** возвращает реализации **IMAPIProp** внешнего поставщика, вернитесь к клиенту указатель на этой реализации. 
    
4. Если **OpenTemplateID** не возвращает реализацию, обычно так как внешнего поставщика не профилей, возвращает клиенту указатель реализацию **IMAPIProp** ваш поставщик. Клиент должен иметь возможность работа со свойствами объекта с использованием любого из интерфейса. 
    


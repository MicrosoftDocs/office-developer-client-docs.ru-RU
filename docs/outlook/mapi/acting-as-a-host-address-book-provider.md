---
title: Выступая в качестве поставщика адресной книги для хостов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406467"
---
# <a name="acting-as-a-host-address-book-provider"></a>Выступая в качестве поставщика адресной книги для хостов

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщик хостов — это поставщик адресных книг, который включает получателей от других поставщиков в контейнерах и полагается на реализацию получателей другими поставщиками, чтобы частично контролировать их обслуживание. Поставщик хостинга использует идентификаторы шаблонов этих иностранных получателей для привязки данных для этих получателей к коду в иностранном поставщике. Этот процесс привязки инициируется, когда поставщик извлекает **свойство PR_TEMPLATEID** [(PidTagTemplateid)](pidtagtemplateid-canonical-property.md)получателя и передает его в вызов [iMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md). 
  
Когда поставщик вызывает **IMAPISupport::OpenTemplateID,** MAPI соответствует **MAPIUID** в идентификаторе шаблона с **MAPIUID,** зарегистрированным поставщиком, и вызывает метод [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) поставщика. Иностранный поставщик может возвращать указатель на объект свойства поставщика, его реализацию объекта свойства или реализацию, которая заворачивает объект поставщика. Возвращенный указатель помещается в содержимое параметра _lppMAPIPropNew._ 
  
Поставщик может выбрать, следует ли вызывать **IMAPISupport::OpenTemplateID** с FILL_ENTRY флагом. Установите этот флаг, когда получатель создается или когда прошло длительное время, так как поставщик обновил свойства получателя. Часто используется флаг FILL_ENTRY, чтобы получатель в поставщике синхронизировался с оригиналом. Реализация этого типа расписания синхронизации повышает производительность. 
  
 **Синхронизация иностранного получателя**
  
1. Определение соответствующего интервала для периодических обновлений. 
    
2. Timestamp каждый звонок [в IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md). 
    
3. Оцените, необходимо ли выполнять полное обновление в зависимости от времени, истекаемого после последнего звонка. Если требуется полное обновление, позвоните **в IMAPISupport::OpenTemplateID** с FILL_ENTRY флагом. Если это не требуется, не установите флаг на вызов. 
    
Когда клиент делает запрос на одно из скопированные свойства получателя, поставщик может выбрать, обрабатывать ли сам запрос или использовать код, предоставленный иностранным поставщиком. Ваш поставщик может ожидать, что иностранный поставщик перехватит большинство, если не все, вызовы **в IMAPIProp,** за исключением [IMAPIProp::OpenProperty](imapiprop-openproperty.md). Вызов в **OpenProperty** с запросом **свойства PR_DETAILS_TABLE** [(PidTagDetailsTable)](pidtagdetailstable-canonical-property.md)всегда передается поставщику.
  
 **Доступ к коду идентификатора шаблона**
  
1. Откройте получателя и позвоните по методу [IMAPIProp::GetProps](imapiprop-getprops.md) для получения **свойства** [PR_TEMPLATEID (PidTagTemplateid).](pidtagtemplateid-canonical-property.md) Если **GetProps** сбой, **PR_TEMPLATEID** недоступен, иностранный поставщик не поддерживает идентификатор шаблона и связанный код для этого получателя. Поставщику необходимо будет использовать его реализацию получателя для всего обслуживания. 
    
2. Если идентификатор шаблона возвращается из **GetProps,** передай его и указатель в реализацию **IMAPIProp** получателя в вызове метода **IMAPISupport::OpenTemplateID.** Установите флаг FILL_ENTRY, если необходимо обновить большинство или все свойства получателя, например во время создания или если они не были обновлены некоторое время. 
    
3. Если **OpenTemplateID** возвращает реализацию **IMAPIProp** иностранного поставщика, верни клиенту указатель на эту реализацию. 
    
4. Если **OpenTemplateID** не возвращает реализацию, как правило, из-за того, что иностранный поставщик не находится в профиле, верни клиенту указатель на реализацию **IMAPIProp** поставщика. Клиент должен иметь возможность работать с свойствами объекта с помощью любого интерфейса. 
    


---
title: Действует как поставщик адресной книги узла
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406467"
---
# <a name="acting-as-a-host-address-book-provider"></a>Действует как поставщик адресной книги узла

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщик узла — это поставщик адресных книг, который включает получателей из других поставщиков в своих контейнерах и использует реализацию получателей другими поставщиками для частичного управления их обслуживанием. Поставщик узла использует идентификаторы этих внешних получателей, чтобы привязывать данные для этих получателей к коду во внешнем поставщике. Этот процесс привязки инициируется, когда поставщик получает свойство **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) получателя и передает его в вызов [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md). 
  
Когда поставщик вызывает **имаписуппорт:: опентемплатеид**, MAPI сопоставляет **мапиуид** в пределах идентификатора шаблона с **мапиуид** , зарегистрированным поставщиком, и вызывает метод поставщика [иаблогон:: опентемплатеид](iablogon-opentemplateid.md) . Внешний поставщик может возвратить указатель на объект свойства поставщика, на его собственную реализацию объекта Property или на реализацию, которая создает оболочку для объекта поставщика. Возвращенный указатель помещается в содержимое параметра _лппмапипропнев_ . 
  
Поставщик может выбрать, следует ли вызывать **имаписуппорт:: опентемплатеид** с установленным флагом FILL_ENTRY. Установите этот флаг при создании получателя или в течение длительного времени, после того как поставщик обновил свойства получателя. Флаг FILL_ENTRY обычно используется для синхронизации получателя в поставщике с оригиналом. Реализация этого типа расписания синхронизации повышает производительность. 
  
 **Синхронизация инородных получателей**
  
1. Определите подходящий интервал для периодического обновления. 
    
2. Временная метка каждый вызов [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md). 
    
3. Определите, требуется ли полное обновление в зависимости от времени, истекшего с момента последнего вызова. Если требуется полное обновление, вызовите **имаписуппорт:: опентемплатеид** с флагом FILL_ENTRY. Если это необязательно, не задавайте флаг на вызов. 
    
Когда клиент отправляет запрос для одного из свойств скопированного получателя, поставщик может выбрать, нужно ли обработать сам запрос или использовать код, предоставленный внешним поставщиком. Поставщик может ожидать, что внешний поставщик перехватывает большинство, если не все, вызовы **IMAPIProp** , за исключением [IMAPIProp:: опенпроперти](imapiprop-openproperty.md). Вызов **опенпроперти** , который запрашивает свойство **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)), всегда пересылается поставщику.
  
 **Доступ к коду идентификатора шаблона**
  
1. Откройте получателя и вызовите его метод [IMAPIProp::-PROPS](imapiprop-getprops.md) , чтобы получить значение свойства **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)). Если функции- **PROPS** не удается выполнить из-за недоступности **PR_TEMPLATEID** , внешний поставщик не поддерживает идентификатор шаблона и связанный код для этого получателя. Поставщику потребуется использовать его реализацию получателя для всего обслуживания. 
    
2. Если идентификатор шаблона возвращается из метода **PROPS**, передайте его и указатель на реализацию **IMAPIProp** получателя в вызове метода **имаписуппорт:: опентемплатеид** . Установите флаг FILL_ENTRY, если необходимо обновить большинство или все свойства получателя, например, во время создания, или если они не были обновлены в течение определенного времени. 
    
3. Если **опентемплатеид** возвращает реализацию **IMAPIProp** для внешнего поставщика, вернитесь к клиенту в указатель на эту реализацию. 
    
4. Если **опентемплатеид** не возвращает реализацию, как правило, так как внешний поставщик не находится в профиле, вернитесь к клиенту в качестве указателя на реализацию **IMAPIProp** поставщика. Клиент должен иметь возможность работать со свойствами объекта с помощью любого интерфейса. 
    


---
title: Будет действовать как поставщик адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: '���� ���������� ���������: 23 ���� 2011 �.'
ms.openlocfilehash: cf52062eacbd13b45087df9d8558bffd43ccd744
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808011"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="9f734-103">Будет действовать как поставщик адресной книги</span><span class="sxs-lookup"><span data-stu-id="9f734-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="9f734-104">**Применимо к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="9f734-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="9f734-105">Этот поставщик является поставщика адресных книг, содержащую получателей из других поставщиков в его контейнеров и зависит от реализации получателей с другими поставщиками частично управлять их обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9f734-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="9f734-106">Этот поставщик использует идентификаторы шаблон этих внешних получателей для привязки данных для этих получателей для кода в внешнего поставщика.</span><span class="sxs-lookup"><span data-stu-id="9f734-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="9f734-107">Этот процесс привязки инициируется, когда поставщик Получает свойство **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) получателя и передает его в вызове [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="9f734-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="9f734-108">Если поставщик звонки **IMAPISupport::OpenTemplateID**, MAPI соответствует **MAPIUID** в рамках идентификатор шаблона с **MAPIUID** зарегистрировано с помощью поставщика и вызывает метод [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) поставщика.</span><span class="sxs-lookup"><span data-stu-id="9f734-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="9f734-109">Внешний поставщик может вернуть указатель на объект свойство ваш поставщик собственная реализация объекта свойство или на реализацию, которая имеет объект вашего поставщика.</span><span class="sxs-lookup"><span data-stu-id="9f734-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="9f734-110">Возвращенный указатель переводится в содержимое параметра _lppMAPIPropNew_ .</span><span class="sxs-lookup"><span data-stu-id="9f734-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="9f734-111">Ваш поставщик можно выбрать ли вызов **IMAPISupport::OpenTemplateID** с установленным флагом FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="9f734-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="9f734-112">Установите этот флаг, при создании получателя или когда длительное время прошедшее ваш поставщик обновлен свойства получателя.</span><span class="sxs-lookup"><span data-stu-id="9f734-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="9f734-113">Флаг FILL_ENTRY обычно используется для хранения получателя в ваш поставщик синхронизации с исходной.</span><span class="sxs-lookup"><span data-stu-id="9f734-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="9f734-114">Реализация этого типа расписания синхронизации повышает производительность.</span><span class="sxs-lookup"><span data-stu-id="9f734-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="9f734-115">**Для сохранения внешнего получателя синхронизации**</span><span class="sxs-lookup"><span data-stu-id="9f734-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="9f734-116">Определите соответствующий интервал для периодического обновления.</span><span class="sxs-lookup"><span data-stu-id="9f734-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="9f734-117">Метка времени каждого вызова [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="9f734-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="9f734-118">Оценка ли это необходимо для выполнения полного обновления на основании количество времени, истек срок действия с момента последнего вызова.</span><span class="sxs-lookup"><span data-stu-id="9f734-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="9f734-119">При необходимости полного обновления вызовите **IMAPISupport::OpenTemplateID** с флагом FILL_ENTRY.</span><span class="sxs-lookup"><span data-stu-id="9f734-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="9f734-120">Если не требуется, не задан флаг на звонок.</span><span class="sxs-lookup"><span data-stu-id="9f734-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="9f734-121">Клиент создает запрос для одного свойства скопированной получателя, к поставщику можно выбирать обработать запрос самого или использовать код из внешнего службы.</span><span class="sxs-lookup"><span data-stu-id="9f734-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="9f734-122">Поставщик может предполагать внешнего поставщика для перехвата наиболее, если не все, вызовы **IMAPIProp** за исключением [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="9f734-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="9f734-123">Вызов **OpenProperty** разрешения на запрос свойства **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) всегда перенаправляется в ваш поставщик.</span><span class="sxs-lookup"><span data-stu-id="9f734-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="9f734-124">**Для доступа к коду идентификатор шаблона**</span><span class="sxs-lookup"><span data-stu-id="9f734-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="9f734-125">Откройте получателя и вызвать метод [IMAPIProp::GetProps](imapiprop-getprops.md) для получения свойства **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="9f734-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="9f734-126">В случае сбоя **GetProps** недоступностью **PR_TEMPLATEID** внешнего поставщика не поддерживает идентификатор шаблона и связанных с ними код для данного получателя.</span><span class="sxs-lookup"><span data-stu-id="9f734-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="9f734-127">Ваш поставщик потребуется использовать его реализация получателя для всех обслуживания.</span><span class="sxs-lookup"><span data-stu-id="9f734-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="9f734-128">Если **GetProps**возвращает идентификатор шаблона, передайте его и указатель для реализации **IMAPIProp** получателя в вызове метода **IMAPISupport::OpenTemplateID** .</span><span class="sxs-lookup"><span data-stu-id="9f734-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="9f734-129">Установите для флага FILL_ENTRY большинство или все свойства получателя должны быть обновленные, например, во время создания или если они не были обновлены, чтобы некоторое время.</span><span class="sxs-lookup"><span data-stu-id="9f734-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="9f734-130">Если **OpenTemplateID** возвращает реализации **IMAPIProp** внешнего поставщика, вернитесь к клиенту указатель на этой реализации.</span><span class="sxs-lookup"><span data-stu-id="9f734-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="9f734-131">Если **OpenTemplateID** не возвращает реализацию, обычно так как внешнего поставщика не профилей, возвращает клиенту указатель реализацию **IMAPIProp** ваш поставщик.</span><span class="sxs-lookup"><span data-stu-id="9f734-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="9f734-132">Клиент должен иметь возможность работа со свойствами объекта с использованием любого из интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9f734-132">The client should be able to work with the object's properties using either interface.</span></span> 
    


---
title: Действует как поставщик адресной книги узла
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406467"
---
# <a name="acting-as-a-host-address-book-provider"></a><span data-ttu-id="80d10-103">Действует как поставщик адресной книги узла</span><span class="sxs-lookup"><span data-stu-id="80d10-103">Acting as a Host Address Book Provider</span></span>

  
  
<span data-ttu-id="80d10-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="80d10-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="80d10-105">Поставщик узла — это поставщик адресных книг, который включает получателей из других поставщиков в своих контейнерах и использует реализацию получателей другими поставщиками для частичного управления их обслуживанием.</span><span class="sxs-lookup"><span data-stu-id="80d10-105">A host provider is an address book provider that includes recipients from other providers in its containers and relies on the implementation of the recipients by the other providers to partially control their maintenance.</span></span> <span data-ttu-id="80d10-106">Поставщик узла использует идентификаторы этих внешних получателей, чтобы привязывать данные для этих получателей к коду во внешнем поставщике.</span><span class="sxs-lookup"><span data-stu-id="80d10-106">A host provider uses the template identifiers of these foreign recipients to bind the data for these recipients to code in the foreign provider.</span></span> <span data-ttu-id="80d10-107">Этот процесс привязки инициируется, когда поставщик получает свойство **пр_темплатеид** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) получателя и передает его в вызов [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="80d10-107">This binding process is initiated when your provider retrieves the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property of a recipient and passes it in a call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
  
<span data-ttu-id="80d10-108">Когда поставщик вызывает **имаписуппорт:: опентемплатеид**, MAPI сопоставляет **мапиуид** в пределах идентификатора шаблона с **мапиуид** , зарегистрированным поставщиком, и вызывает метод поставщика [иаблогон:: опентемплатеид](iablogon-opentemplateid.md) .</span><span class="sxs-lookup"><span data-stu-id="80d10-108">When your provider calls **IMAPISupport::OpenTemplateID**, MAPI matches the **MAPIUID** within the template identifier with a **MAPIUID** registered by a provider and calls the provider's [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) method.</span></span> <span data-ttu-id="80d10-109">Внешний поставщик может возвратить указатель на объект свойства поставщика, на его собственную реализацию объекта Property или на реализацию, которая создает оболочку для объекта поставщика.</span><span class="sxs-lookup"><span data-stu-id="80d10-109">The foreign provider might return a pointer to your provider's property object, to its own property object implementation, or to an implementation that wraps your provider's object.</span></span> <span data-ttu-id="80d10-110">Возвращенный указатель помещается в содержимое параметра _лппмапипропнев_ .</span><span class="sxs-lookup"><span data-stu-id="80d10-110">The returned pointer is placed in the contents of the  _lppMAPIPropNew_ parameter.</span></span> 
  
<span data-ttu-id="80d10-111">Поставщик может выбрать, следует ли вызывать **имаписуппорт:: опентемплатеид** с установленным флагом филл_ентри.</span><span class="sxs-lookup"><span data-stu-id="80d10-111">Your provider can choose whether or not to call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag set.</span></span> <span data-ttu-id="80d10-112">Установите этот флаг при создании получателя или в течение длительного времени, после того как поставщик обновил свойства получателя.</span><span class="sxs-lookup"><span data-stu-id="80d10-112">Set this flag when the recipient is being created or when a long time has passed since your provider has refreshed the recipient's properties.</span></span> <span data-ttu-id="80d10-113">Обычно флаг ФИЛЛ_ЕНТРИ используется для синхронизации получателя в поставщике с оригиналом.</span><span class="sxs-lookup"><span data-stu-id="80d10-113">A common use of the FILL_ENTRY flag is to keep a recipient in your provider synchronized with the original.</span></span> <span data-ttu-id="80d10-114">Реализация этого типа расписания синхронизации повышает производительность.</span><span class="sxs-lookup"><span data-stu-id="80d10-114">Implementing this type of synchronization schedule enhances performance.</span></span> 
  
 <span data-ttu-id="80d10-115">**Синхронизация инородных получателей**</span><span class="sxs-lookup"><span data-stu-id="80d10-115">**To keep a foreign recipient synchronized**</span></span>
  
1. <span data-ttu-id="80d10-116">Определите подходящий интервал для периодического обновления.</span><span class="sxs-lookup"><span data-stu-id="80d10-116">Determine an appropriate interval for periodic updates.</span></span> 
    
2. <span data-ttu-id="80d10-117">Временная метка каждый вызов [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="80d10-117">Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md).</span></span> 
    
3. <span data-ttu-id="80d10-118">Определите, требуется ли полное обновление в зависимости от времени, истекшего с момента последнего вызова.</span><span class="sxs-lookup"><span data-stu-id="80d10-118">Evaluate whether or not it is necessary to perform a full update based on the amount of time that has expired since the last call.</span></span> <span data-ttu-id="80d10-119">Если требуется полное обновление, вызовите **имаписуппорт:: опентемплатеид** с флагом филл_ентри.</span><span class="sxs-lookup"><span data-stu-id="80d10-119">If a full update is necessary, call **IMAPISupport::OpenTemplateID** with the FILL_ENTRY flag.</span></span> <span data-ttu-id="80d10-120">Если это необязательно, не задавайте флаг на вызов.</span><span class="sxs-lookup"><span data-stu-id="80d10-120">If it is not necessary, do not set the flag on the call.</span></span> 
    
<span data-ttu-id="80d10-121">Когда клиент отправляет запрос для одного из свойств скопированного получателя, поставщик может выбрать, нужно ли обработать сам запрос или использовать код, предоставленный внешним поставщиком.</span><span class="sxs-lookup"><span data-stu-id="80d10-121">When a client makes a request for one of the copied recipient's properties, your provider can choose whether to handle the request itself or use the code supplied by the foreign provider.</span></span> <span data-ttu-id="80d10-122">Поставщик может ожидать, что внешний поставщик перехватывает большинство, если не все, вызовы **IMAPIProp** , за исключением [IMAPIProp:: опенпроперти](imapiprop-openproperty.md).</span><span class="sxs-lookup"><span data-stu-id="80d10-122">Your provider can expect the foreign provider to intercept most, if not all, calls to **IMAPIProp** except for [IMAPIProp::OpenProperty](imapiprop-openproperty.md).</span></span> <span data-ttu-id="80d10-123">Вызов **опенпроперти** , который запрашивает свойство **пр_детаилс_табле** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)), всегда пересылается поставщику.</span><span class="sxs-lookup"><span data-stu-id="80d10-123">A call to **OpenProperty** requesting the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property is always forwarded to your provider.</span></span>
  
 <span data-ttu-id="80d10-124">**Доступ к коду идентификатора шаблона**</span><span class="sxs-lookup"><span data-stu-id="80d10-124">**To access template identifier code**</span></span>
  
1. <span data-ttu-id="80d10-125">Откройте получателя и вызовите его метод [IMAPIProp::](imapiprop-getprops.md) -Props, чтобы получить свойство **пр_темплатеид** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="80d10-125">Open the recipient and call its [IMAPIProp::GetProps](imapiprop-getprops.md) method to retrieve the **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property.</span></span> <span data-ttu-id="80d10-126">Если \*\*\*\* функции-PROPS не удается выполнить из-за недоступности **пр_темплатеид** , внешний поставщик не поддерживает идентификатор шаблона и связанный код для этого получателя.</span><span class="sxs-lookup"><span data-stu-id="80d10-126">If **GetProps** fails because **PR_TEMPLATEID** is unavailable, the foreign provider does not support a template identifier and related code for this recipient.</span></span> <span data-ttu-id="80d10-127">Поставщику потребуется использовать его реализацию получателя для всего обслуживания.</span><span class="sxs-lookup"><span data-stu-id="80d10-127">Your provider will need to use its implementation of the recipient for all maintenance.</span></span> 
    
2. <span data-ttu-id="80d10-128">Если идентификатор шаблона возвращается из метода **PROPS**, передайте его и указатель на реализацию **IMAPIProp** получателя в вызове метода **имаписуппорт:: опентемплатеид** .</span><span class="sxs-lookup"><span data-stu-id="80d10-128">If the template identifier is returned from **GetProps**, pass it and a pointer to the recipient's **IMAPIProp** implementation in a call to the **IMAPISupport::OpenTemplateID** method.</span></span> <span data-ttu-id="80d10-129">Установите флаг ФИЛЛ_ЕНТРИ, если необходимо обновить большинство или все свойства получателя, например, во время создания, или если они не были обновлены в течение определенного времени.</span><span class="sxs-lookup"><span data-stu-id="80d10-129">Set the FILL_ENTRY flag if most or all of the recipient's properties need to be updated, such as at creation time or if they have not been updated for a while.</span></span> 
    
3. <span data-ttu-id="80d10-130">Если **опентемплатеид** возвращает реализацию **IMAPIProp** для внешнего поставщика, вернитесь к клиенту в указатель на эту реализацию.</span><span class="sxs-lookup"><span data-stu-id="80d10-130">If **OpenTemplateID** returns the foreign provider's **IMAPIProp** implementation, return to the client a pointer to this implementation.</span></span> 
    
4. <span data-ttu-id="80d10-131">Если **опентемплатеид** не возвращает реализацию, как правило, так как внешний поставщик не находится в профиле, вернитесь к клиенту в качестве указателя на реализацию **IMAPIProp** поставщика.</span><span class="sxs-lookup"><span data-stu-id="80d10-131">If **OpenTemplateID** does not return an implementation, typically because the foreign provider is not in the profile, return to the client a pointer to your provider's **IMAPIProp** implementation.</span></span> <span data-ttu-id="80d10-132">Клиент должен иметь возможность работать со свойствами объекта с помощью любого интерфейса.</span><span class="sxs-lookup"><span data-stu-id="80d10-132">The client should be able to work with the object's properties using either interface.</span></span> 
    


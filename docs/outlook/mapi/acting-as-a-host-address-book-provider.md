---
title: Выступая в качестве поставщика адресной книги для хост-адресов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f06a1034-ee49-4a09-831e-9752713228a8
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 202d4b4391de7553e39e50dc527df5502ebcefb3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33406467"
---
# <a name="acting-as-a-host-address-book-provider"></a>Выступая в качестве поставщика адресной книги для хост-адресов

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщик услуг хранения — это поставщик адресной книги, который включает получателей от других поставщиков в своих контейнерах и использует реализацию получателей другими поставщиками для частичного контроля их обслуживания. Поставщик услуг хоста использует идентификаторы шаблонов этих внешних получателей для привязки данных для этих получателей к коду во внешнем поставщике. Этот процесс привязки инициален, когда поставщик извлекает свойство **PR_TEMPLATEID** ([PidTagTemplateid)](pidtagtemplateid-canonical-property.md)получателя и передает его в [вызове IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md). 
  
Когда поставщик вызывает **IMAPISupport::OpenTemplateID,** MAPI соответствует **MAPIUID** в идентификаторе шаблона **с MAPIUID,** зарегистрированным поставщиком, и вызывает метод [IABLogon::OpenTemplateID](iablogon-opentemplateid.md) поставщика. Внешние поставщики могут возвращать указатель на объект свойства поставщика, на реализацию собственного объекта свойства или на реализацию, которая обтекает объект поставщика. Возвращенный указатель помещается в содержимое параметра _lppMAPIPropNew._ 
  
Поставщик может выбрать, следует ли вызывать **IMAPISupport::OpenTemplateID** с установленным FILL_ENTRY флагом. Установите этот флаг, когда получатель создается или когда прошло много времени, так как поставщик обновил свойства получателя. Распространенным использованием флага FILL_ENTRY является сохранение синхронизации получателя в поставщике с исходным. Реализация этого типа расписания синхронизации повышает производительность. 
  
 **Сохранение синхронизации внешнего получателя**
  
1. Определите соответствующий интервал для периодических обновлений. 
    
2. Timestamp each call to [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md). 
    
3. Оцените необходимость выполнения полного обновления в зависимости от времени, истекаемого с момента последнего вызова. Если требуется полное обновление, вызовите **IMAPISupport::OpenTemplateID** с FILL_ENTRY флагом. Если это не требуется, не устанавливать флаг при вызове. 
    
Когда клиент запрашивает одно из скопированные свойства получателя, поставщик может выбрать, обрабатывать ли сам запрос или использовать код, предоставленный внешнего поставщика. Поставщик может ожидать, что внешние поставщики будут перехватывать большинство (если не все) вызовов **IMAPIProp,** кроме [IMAPIProp::OpenProperty.](imapiprop-openproperty.md) Вызов **OpenProperty,** **запрашивающий** свойство PR_DETAILS_TABLE ([PidTagDetailsTable),](pidtagdetailstable-canonical-property.md)всегда перенаправляется поставщику.
  
 **Доступ к коду идентификатора шаблона**
  
1. Откройте получателя и вызовите его метод [IMAPIProp::GetProps,](imapiprop-getprops.md) чтобы получить **свойство PR_TEMPLATEID** ([PidTagTemplateid).](pidtagtemplateid-canonical-property.md) Если происходит сбой **GetProps** **PR_TEMPLATEID** недоступен, то внешние поставщики не поддерживают идентификатор шаблона и связанный код для этого получателя. Поставщик должен будет использовать свою реализацию получателя для всего обслуживания. 
    
2. Если идентификатор шаблона возвращается из **GetProps,** передав его и указатель на реализацию **IMAPIProp** получателя в вызове метода **IMAPISupport::OpenTemplateID.** Установите флаг FILL_ENTRY, если необходимо обновить большинство или все свойства получателя, например во время создания или если они не обновлялись в течение некоторого времени. 
    
3. Если **OpenTemplateID** возвращает реализацию **IMAPIProp** внешнего поставщика, верните клиенту указатель на эту реализацию. 
    
4. Если **OpenTemplateID** не возвращает реализацию, как правило, из-за того, что внешнего поставщика нет в профиле, верните клиенту указатель на реализацию **IMAPIProp** поставщика. Клиент должен иметь возможность работать со свойствами объекта с помощью любого интерфейса. 
    


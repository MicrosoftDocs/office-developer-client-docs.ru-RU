---
title: Создание профиля Outlook с помощью MFCMAPI
ms.date: 05/18/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 85581bc7-2d81-46af-8836-adef39c933fc
description: MFCMAPI предоставляет доступ к хранилищам MAPI для упрощения исследования проблем Exchange и Outlook, а также для предоставления разработчикам поддержки разработки MAPI.
ms.openlocfilehash: 8a300ad53918b22cc3de5554a1e3c29289cd9365
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32345992"
---
# <a name="create-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="32c91-103">Создание профиля Outlook с помощью MFCMAPI</span><span class="sxs-lookup"><span data-stu-id="32c91-103">Create an Outlook profile using MFCMAPI</span></span>

<span data-ttu-id="32c91-104">MFCMAPI предоставляет доступ к хранилищам MAPI для упрощения исследования проблем Exchange и Outlook, а также для предоставления разработчикам поддержки разработки MAPI.</span><span class="sxs-lookup"><span data-stu-id="32c91-104">MFCMAPI provides access to MAPI stores to facilitate investigation of Exchange and Outlook issues and to provide developers with support for MAPI development.</span></span>

<span data-ttu-id="32c91-105">**Относится к**: Office 365 | Outlook | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="32c91-105">**Applies to**: Office 365 | Outlook | Outlook 2016</span></span> 
  
<span data-ttu-id="32c91-106">Для пользователей, не являющихся разработчиками, рекомендуется использовать пользовательский интерфейс Outlook для создания профилей для Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="32c91-106">For non-developers, it is recommended that you use the Outlook user interface to create profiles for Exchange 2013.</span></span>
  
## <a name="configure-an-outlook-profile-using-mfcmapi"></a><span data-ttu-id="32c91-107">Настройка профиля Outlook с помощью MFCMAPI</span><span class="sxs-lookup"><span data-stu-id="32c91-107">Configure an Outlook profile using MFCMAPI</span></span>

1. <span data-ttu-id="32c91-108">Откройте [MFCMAPI](https://mfcmapi.codeplex.com/)и в меню **профиль** выберите пункт **Показать профили**.</span><span class="sxs-lookup"><span data-stu-id="32c91-108">Open [MFCMAPI](https://mfcmapi.codeplex.com/), and on the **Profile** menu, click **Show Profiles**.</span></span> 
    
2. <span data-ttu-id="32c91-109">В меню **действия** выберите команду **создать профиль**.</span><span class="sxs-lookup"><span data-stu-id="32c91-109">On the **Actions** menu, click **Create Profile**.</span></span> 
    
3. <span data-ttu-id="32c91-110">Создайте новое имя для профиля и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="32c91-110">Create a new name for the profile, and then click **OK**.</span></span> 
    
4. <span data-ttu-id="32c91-111">Щелкните правой кнопкой мыши новый профиль, а затем в меню **службы** выберите команду **Добавить службу**.</span><span class="sxs-lookup"><span data-stu-id="32c91-111">Right-click the new profile, and then on the **Services** menu, click **Add Service**.</span></span> 
    
5. <span data-ttu-id="32c91-112">Снимите флажок "Пользовательский интерфейс службы отображения" и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="32c91-112">Uncheck the"Display Service UI" box, and then click **OK**.</span></span> 
    
6. <span data-ttu-id="32c91-113">Дважды щелкните только что созданный профиль и выберите службу **мсемс** .</span><span class="sxs-lookup"><span data-stu-id="32c91-113">Double-click the newly created profile, and then click the **MSEMS** service.</span></span> 
    
7. <span data-ttu-id="32c91-114">Откройте раздел Профиль Exchange.</span><span class="sxs-lookup"><span data-stu-id="32c91-114">Locate the Exchange Profile section.</span></span>
    
   <span data-ttu-id="32c91-115">This can be difficult in Outlook�s MAPI, since in 2010 and above there is no longer the global profile section.</span><span class="sxs-lookup"><span data-stu-id="32c91-115">This can be difficult in Outlook's MAPI, since in 2010 and above there is no longer the global profile section.</span></span> <span data-ttu-id="32c91-116">To find the Profile section, find the property PR_EMSMDB_SECTION_UID (0x3D150102).</span><span class="sxs-lookup"><span data-stu-id="32c91-116">To find the Profile section, find the property PR_EMSMDB_SECTION_UID (0x3D150102).</span></span> <span data-ttu-id="32c91-117">The value will be the GUID of the profile section persisted in binary form, which will be used in the subsequent steps.</span><span class="sxs-lookup"><span data-stu-id="32c91-117">The value will be the GUID of the profile section persisted in binary form, which will be used in the subsequent steps.</span></span> <span data-ttu-id="32c91-118">Это значение потребуется на шаге 9.</span><span class="sxs-lookup"><span data-stu-id="32c91-118">You will need this value in step 9.</span></span>
    
8. <span data-ttu-id="32c91-119">Дважды щелкните службу **мсемс** .</span><span class="sxs-lookup"><span data-stu-id="32c91-119">Double-click the **MSEMS** service.</span></span> 
    
9. <span data-ttu-id="32c91-120">Найдите раздел профиль **Exchange** с помощью идентификатора UID из шага 7, а затем щелкните один раз, чтобы выбрать строку.</span><span class="sxs-lookup"><span data-stu-id="32c91-120">Find the **Exchange** profile section by using the UID from step 7, and then single-click to select the row.</span></span> 
    
10. <span data-ttu-id="32c91-121">В меню Свойство выберите пункт **Дополнительные свойства**.</span><span class="sxs-lookup"><span data-stu-id="32c91-121">On the Property menu, click **Additional Properties**.</span></span> 
    
11. <span data-ttu-id="32c91-122">Нажмите кнопку **Добавить**, а затем добавьте следующие свойства:</span><span class="sxs-lookup"><span data-stu-id="32c91-122">Click **Add**, and then add the following properties:</span></span> 
    
    <span data-ttu-id="32c91-123">**для Outlook 2016**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)` и`PR_DISPLAY_NAME_W`</span><span class="sxs-lookup"><span data-stu-id="32c91-123">**For Outlook 2016**: `PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W (0x6641001F)` and `PR_DISPLAY_NAME_W`</span></span>
    
    <span data-ttu-id="32c91-124">**для Outlook для Office 365**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS` `PR_ROH_PROXY_AUTH_SCHEME`,, `PR_PROFILE_AUTH_PACKAGE`, и`PR_ROH_PROXY_PRINCIPAL_NAME`</span><span class="sxs-lookup"><span data-stu-id="32c91-124">**For Outlook for Office 365**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, `PR_PROFILE_AUTH_PACKAGE`, and `PR_ROH_PROXY_PRINCIPAL_NAME`</span></span> 
    
    <span data-ttu-id="32c91-125">**для Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER` `PR_ROH_PROXY_SERVER`,, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`и `PR_PROFILE_AUTH_PACKAGE`.</span><span class="sxs-lookup"><span data-stu-id="32c91-125">**For Exchange 2013**: `PR_PROFILE_UNRESOLVED_NAME`, `PR_PROFILE_UNRESOLVED_SERVER`, `PR_ROH_PROXY_SERVER`, `PR_ROH_FLAGS`, `PR_ROH_PROXY_AUTH_SCHEME`, and `PR_PROFILE_AUTH_PACKAGE`.</span></span> 
    
12. <span data-ttu-id="32c91-126">Нажмите кнопку **ОК**, а затем настройте каждое свойство в соответствии с приведенной ниже таблицей в зависимости от версии, к которой выполняется подключение.</span><span class="sxs-lookup"><span data-stu-id="32c91-126">Click **OK**, and then configure each property according to the table below, depending on the version you are connecting to.</span></span> 
    
13. <span data-ttu-id="32c91-127">В меню **сеанс** выберите пункт **Вход и отображение хранилища**, а затем выберите профиль (если он еще не выбран).</span><span class="sxs-lookup"><span data-stu-id="32c91-127">On the **Session** menu, click **Logon and Display Store**, and then select the profile (if it is not already selected).</span></span> 
    
### <a name="outlook-2016"></a><span data-ttu-id="32c91-128">Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="32c91-128">Outlook 2016</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="32c91-129">**Property**</span><span class="sxs-lookup"><span data-stu-id="32c91-129">**Property**</span></span> <br/> |<span data-ttu-id="32c91-130">**Tag**</span><span class="sxs-lookup"><span data-stu-id="32c91-130">**Tag**</span></span> <br/> |<span data-ttu-id="32c91-131">**Описание**</span><span class="sxs-lookup"><span data-stu-id="32c91-131">**Description**</span></span> <br/> |
| <span data-ttu-id="32c91-132">ПР_ПРОФИЛЕ_УСЕР_СМТП_ЕМАИЛ_АДДРЕСС_В</span><span class="sxs-lookup"><span data-stu-id="32c91-132">PR_PROFILE_USER_SMTP_EMAIL_ADDRESS_W</span></span>  <br/> |<span data-ttu-id="32c91-133">0x6641001F</span><span class="sxs-lookup"><span data-stu-id="32c91-133">0x6641001F</span></span>  <br/> |<span data-ttu-id="32c91-134">SMTP-адрес пользователя</span><span class="sxs-lookup"><span data-stu-id="32c91-134">SMTP Address of the user</span></span>  <br/> |
|<span data-ttu-id="32c91-135">PR_DISPLAY_NAME_W</span><span class="sxs-lookup"><span data-stu-id="32c91-135">PR_DISPLAY_NAME_W</span></span>  <br/> |<span data-ttu-id="32c91-136">0x3001001F</span><span class="sxs-lookup"><span data-stu-id="32c91-136">0x3001001F</span></span>  <br/> |<span data-ttu-id="32c91-137">Отображаемое имя пользователя</span><span class="sxs-lookup"><span data-stu-id="32c91-137">The display name of the user</span></span>  <br/> |
|<span data-ttu-id="32c91-138">ПР_СТОРЕ_ПРОВИДЕРС</span><span class="sxs-lookup"><span data-stu-id="32c91-138">PR_STORE_PROVIDERS</span></span>  <br/> |<span data-ttu-id="32c91-139">0x3D000102</span><span class="sxs-lookup"><span data-stu-id="32c91-139">0x3D000102</span></span>  <br/> |<span data-ttu-id="32c91-140">Настройка значения этого свойства, расположенного в разделе **емсмдб** , и обновление соответствующего идентификатора для соответствующего свойства</span><span class="sxs-lookup"><span data-stu-id="32c91-140">Configure the value of this property, located in the **EMSMDB** section, and update the corresponding UID for the matching property</span></span>  <br/> |
   
### <a name="outlook-for-office-365"></a><span data-ttu-id="32c91-141">Outlook для Office 365</span><span class="sxs-lookup"><span data-stu-id="32c91-141">Outlook for Office 365</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="32c91-142">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="32c91-142">**Property**</span></span> <br/> |<span data-ttu-id="32c91-143">**Value**</span><span class="sxs-lookup"><span data-stu-id="32c91-143">**Value**</span></span> <br/> |<span data-ttu-id="32c91-144">**Описание**</span><span class="sxs-lookup"><span data-stu-id="32c91-144">**Description**</span></span> <br/> |
|<span data-ttu-id="32c91-145">ПР_ПРОФИЛЕ_УНРЕСОЛВЕД_НАМЕ<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-145">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="32c91-146">псевдоним почтового ящика</span><span class="sxs-lookup"><span data-stu-id="32c91-146">mailbox alias</span></span>  <br/> |<span data-ttu-id="32c91-147">Псевдоним целевого почтового ящика; Например, администратор</span><span class="sxs-lookup"><span data-stu-id="32c91-147">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="32c91-148">ПР_ПРОФИЛЕ_УНРЕСОЛВЕД_СЕРВЕР<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-148">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="32c91-149">персонализированный идентификатор сервера</span><span class="sxs-lookup"><span data-stu-id="32c91-149">personalized server id</span></span>  <br/> |<span data-ttu-id="32c91-150">Значение, полученное из **автообнаружения**.</span><span class="sxs-lookup"><span data-stu-id="32c91-150">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="32c91-151">в формате <guid>@tenant. onmicrosoft.com; Например, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="32c91-151">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="32c91-152">*Узел автообнаружения* : Response/Account/Protocol/Server (курс)</span><span class="sxs-lookup"><span data-stu-id="32c91-152">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="32c91-153">ПР_РОХ_ПРОКСИ_СЕРВЕР</span><span class="sxs-lookup"><span data-stu-id="32c91-153">PR_ROH_PROXY_SERVER</span></span>  <br/> |<span data-ttu-id="32c91-154">Outlook.Office365.com</span><span class="sxs-lookup"><span data-stu-id="32c91-154">outlook.office365.com</span></span>  <br/> | <span data-ttu-id="32c91-155">*Узел автообнаружения* : Response/Account/Protocol/Server (expr) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-155">*Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="32c91-156">ПР_РОХ_ФЛАГС</span><span class="sxs-lookup"><span data-stu-id="32c91-156">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="32c91-157">РОХФЛАГС_УСЕ_РОХ (0x1)</span><span class="sxs-lookup"><span data-stu-id="32c91-157">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/> <span data-ttu-id="32c91-158">РОХ_ФЛАГС_УСЕ_ССЛ (0x2)</span><span class="sxs-lookup"><span data-stu-id="32c91-158">ROH_FLAGS_USE_SSL (0x2)</span></span>  <br/>  <span data-ttu-id="32c91-159">РОХФЛАГС_МУТУАЛ_АУС (0x4)</span><span class="sxs-lookup"><span data-stu-id="32c91-159">ROHFLAGS_MUTUAL_AUTH (0x4)</span></span>  <br/>  <span data-ttu-id="32c91-160">РОХФЛАГС_ХТТП_ФИРСТ_ОН_ФАСТ (0x8)</span><span class="sxs-lookup"><span data-stu-id="32c91-160">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/>  <span data-ttu-id="32c91-161">РОХФЛАГС_ХТТП_ФИРСТ_ОН_СЛОВ (0x20)</span><span class="sxs-lookup"><span data-stu-id="32c91-161">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20)</span></span>  <br/> |<span data-ttu-id="32c91-162">Содержит параметры в профиле, используемом Outlook для подключения к Microsoft Exchange Server с помощью удаленного вызова процедур (RPC) по протоколу HTTP.</span><span class="sxs-lookup"><span data-stu-id="32c91-162">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP).</span></span> <span data-ttu-id="32c91-163">*Узел автообнаружения* : Response/Account/Protocol/SSL (expr) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-163">*Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="32c91-164">ПР_РОХ_ПРОКСИ_АУС_СЧЕМЕ</span><span class="sxs-lookup"><span data-stu-id="32c91-164">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="32c91-165">РПК_К_ХТТП_АУСН_СЧЕМЕ_БАСИК (0x1)</span><span class="sxs-lookup"><span data-stu-id="32c91-165">RPC_C_HTTP_AUTHN_SCHEME_BASIC (0x1)</span></span>  <br/> |<span data-ttu-id="32c91-166">Представляет протокол проверки подлинности, который будет использоваться для этого *узла автообнаружения* профиля: Response/Account/Protocol/АУСПАККАЖЕ (expr) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-166">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="32c91-167">ПР_ПРОФИЛЕ_АУС_ПАККАЖЕ</span><span class="sxs-lookup"><span data-stu-id="32c91-167">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="32c91-168">РПК_К_АУСН_НОНЕ (0x0)</span><span class="sxs-lookup"><span data-stu-id="32c91-168">RPC_C_AUTHN_NONE (0x0)</span></span>  <br/> |<span data-ttu-id="32c91-169">Описание схемы проверки подлинности, которая будет использоваться для *узла АВТООБНАРУЖЕНИЯ* RPC: Response/Account/Protocol/АУСПАККАЖЕ (курс) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-169">Describes the authentication scheme to use for the RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
|<span data-ttu-id="32c91-170">ПР_РОХ_ПРОКСИ_ПРИНЦИПАЛ_НАМЕ</span><span class="sxs-lookup"><span data-stu-id="32c91-170">PR_ROH_PROXY_PRINCIPAL_NAME</span></span>  <br/> |<span data-ttu-id="32c91-171">Элемент ЦертпринЦипалнаме</span><span class="sxs-lookup"><span data-stu-id="32c91-171">CertPrincipalName element</span></span>  <br/> |<span data-ttu-id="32c91-172">Используется для поддержки взаимной проверки подлинности; Например, мсстд:Аутлук. com *node автообнаружения* : Response/Account/Protocol/ЦЕРТПРИНЦИПАЛНАМЕ (expr)) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-172">Used to support mutual authentication; for example, msstd:outlook.com *Autodiscover Node*  : Response/Account/Protocol/CertPrincipalName (EXPR) ) <sup>2</sup></span></span> <br/> |
   
### <a name="exchange-2013"></a><span data-ttu-id="32c91-173">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="32c91-173">Exchange 2013</span></span>
  
||||
|:-----|:-----|:-----|
|<span data-ttu-id="32c91-174">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="32c91-174">**Property**</span></span> <br/> |<span data-ttu-id="32c91-175">**Value**</span><span class="sxs-lookup"><span data-stu-id="32c91-175">**Value**</span></span> <br/> |<span data-ttu-id="32c91-176">**Описание**</span><span class="sxs-lookup"><span data-stu-id="32c91-176">**Description**</span></span> <br/> |
|<span data-ttu-id="32c91-177">ПР_ПРОФИЛЕ_УНРЕСОЛВЕД_НАМЕ<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-177">PR_PROFILE_UNRESOLVED_NAME<sup>1</sup></span></span> <br/> |<span data-ttu-id="32c91-178">псевдоним почтового ящика</span><span class="sxs-lookup"><span data-stu-id="32c91-178">mailbox alias</span></span>  <br/> |<span data-ttu-id="32c91-179">Псевдоним целевого почтового ящика; Например, администратор</span><span class="sxs-lookup"><span data-stu-id="32c91-179">The alias for the target mailbox; for example, Administrator</span></span>  <br/> |
|<span data-ttu-id="32c91-180">ПР_ПРОФИЛЕ_УНРЕСОЛВЕД_СЕРВЕР<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-180">PR_PROFILE_UNRESOLVED_SERVER<sup>1</sup></span></span> <br/> |<span data-ttu-id="32c91-181">персонализированный идентификатор сервера</span><span class="sxs-lookup"><span data-stu-id="32c91-181">personalized server id</span></span>  <br/> |<span data-ttu-id="32c91-182">Значение, полученное из **автообнаружения**.</span><span class="sxs-lookup"><span data-stu-id="32c91-182">The value retrieved from **Autodiscover**.</span></span> <span data-ttu-id="32c91-183">в формате <guid>@tenant. onmicrosoft.com; Например, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="32c91-183">in the format <guid>@tenant.onmicrosoft.com; for example, F5FA2827-5978-43cd-8FA8-E07BC3BB5591@contoso.onmicrosoft.com</span></span>  <br/>  <span data-ttu-id="32c91-184">*Узел автообнаружения* : Response/Account/Protocol/Server (курс)</span><span class="sxs-lookup"><span data-stu-id="32c91-184">*Autodiscover Node*  : Response/Account/Protocol/Server (EXCH)</span></span>  <br/> |
|<span data-ttu-id="32c91-185">ПР_РОХ_ПРОКСИ_СЕРВЕР</span><span class="sxs-lookup"><span data-stu-id="32c91-185">PR_ROH_PROXY_SERVER</span></span>  <br/> | <span data-ttu-id="32c91-186">доменное имя сервера клиентского доступа</span><span class="sxs-lookup"><span data-stu-id="32c91-186">client access server domain name</span></span>  <br/> | <span data-ttu-id="32c91-187">Полное доменное имя (FQDN); Например, *узел автообнаружения* E2013cas.contoso.com: Response/Account/Protocol/Server (expr) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-187">The fully qualified domain name (FQDN); for example, e2013cas.contoso.com  *Autodiscover Node*  : Response/Account/Protocol/Server (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="32c91-188">ПР_РОХ_ФЛАГС</span><span class="sxs-lookup"><span data-stu-id="32c91-188">PR_ROH_FLAGS</span></span>  <br/> |<span data-ttu-id="32c91-189">РОХФЛАГС_УСЕ_РОХ (0x1)</span><span class="sxs-lookup"><span data-stu-id="32c91-189">ROHFLAGS_USE_ROH (0x1)</span></span>  <br/>  <span data-ttu-id="32c91-190">РОХФЛАГС_ХТТП_ФИРСТ_ОН_ФАСТ (0x8)</span><span class="sxs-lookup"><span data-stu-id="32c91-190">ROHFLAGS_HTTP_FIRST_ON_FAST (0x8)</span></span>  <br/> <span data-ttu-id="32c91-191">РОХФЛАГС_ХТТП_ФИРСТ_ОН_СЛОВ (0x20))</span><span class="sxs-lookup"><span data-stu-id="32c91-191">ROHFLAGS_HTTP_FIRST_ON_SLOW (0x20))</span></span>  <br/> |<span data-ttu-id="32c91-192">Содержит параметры в профиле, используемом Outlook для подключения к Microsoft Exchange Server с помощью удаленного вызова процедур (RPC) по *узлу АВТООБНАРУЖЕНИЯ* http: Response/Account/Protocol/SSL (expr) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-192">Contains the settings in a profile used by Outlook to connect to Microsoft Exchange Server by using a remote procedure call (RPC) over Hypertext Transfer Protocol (HTTP) *Autodiscover Node*  : Response/Account/Protocol/SSL (EXPR) <sup>2</sup></span></span> <br/> |
| <span data-ttu-id="32c91-193">ПР_РОХ_ПРОКСИ_АУС_СЧЕМЕ</span><span class="sxs-lookup"><span data-stu-id="32c91-193">PR_ROH_PROXY_AUTH_SCHEME</span></span>  <br/> | <span data-ttu-id="32c91-194">РПК_К_ХТТП_АУСН_СЧЕМЕ_НТЛМ (0x2)</span><span class="sxs-lookup"><span data-stu-id="32c91-194">RPC_C_HTTP_AUTHN_SCHEME_NTLM (0x2)</span></span>  <br/> |<span data-ttu-id="32c91-195">Представляет протокол проверки подлинности, который будет использоваться для этого *узла автообнаружения* профиля: Response/Account/Protocol/АУСПАККАЖЕ (expr) <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-195">Represents the authentication protocol to be used for this profile *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXPR) <sup>2</sup></span></span> <br/> |
|<span data-ttu-id="32c91-196">ПР_ПРОФИЛЕ_АУС_ПАККАЖЕ</span><span class="sxs-lookup"><span data-stu-id="32c91-196">PR_PROFILE_AUTH_PACKAGE</span></span>  <br/> |<span data-ttu-id="32c91-197">РПК_К_АУСН_ВИННТ (0xA)</span><span class="sxs-lookup"><span data-stu-id="32c91-197">RPC_C_AUTHN_WINNT (0xA)</span></span>  <br/> |<span data-ttu-id="32c91-198">Описание схемы проверки подлинности, используемой для *узла АВТООБНАРУЖЕНИЯ* RPC: Response/Account/Protocol/АУСПАККАЖЕ (курс) <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="32c91-198">Describes the authentication scheme to use for RPC *Autodiscover Node*  : Response/Account/Protocol/AuthPackage (EXCH) ) <sup>3</sup></span></span> <br/> |
   
> [!NOTE] 
> - <span data-ttu-id="32c91-199">Все значения свойств, упомянутые выше, могут различаться в зависимости от конкретной организации.</span><span class="sxs-lookup"><span data-stu-id="32c91-199">All property values mentioned above may vary for your particular organization.</span></span> 
> - <span data-ttu-id="32c91-200"><sup>1</sup> необходимо использовать версию Юникод, а не версию ANSI.</span><span class="sxs-lookup"><span data-stu-id="32c91-200"><sup>1</sup> You must use the Unicode version, rather than the ANSI version.</span></span> 
> - <span data-ttu-id="32c91-201">Необходимо использовать автоОбнаружение на основе простого старого XML (POX).</span><span class="sxs-lookup"><span data-stu-id="32c91-201">You must use the Plain Old XML (POX) based Autodiscover.</span></span> <span data-ttu-id="32c91-202">Это единственный поддерживаемый автоОбнаружение для настройки профилей Outlook/Exchange.</span><span class="sxs-lookup"><span data-stu-id="32c91-202">This is the only supported Autodiscover for configuring Outlook/Exchange profiles.</span></span>
> - <span data-ttu-id="32c91-203">Чтобы сделать запрос автообнаружения от вашего имени, можно использовать Outlook, щелкнув правой кнопкой мыши значок Outlook в **панели задач**, удерживая клавишу CTRL и выбрав пункт **Проверка автонастройки электронной почты**.</span><span class="sxs-lookup"><span data-stu-id="32c91-203">You can use Outlook to make an Autodiscover request on your behalf by right-clicking the Outlook icon in the **System Tray**, while holding down CTRL and clicking **Test E-Mail Autoconfiguration**.</span></span> 
> - <span data-ttu-id="32c91-204">Для ПР_РОХ_ФЛАГС в вашей среде может потребоваться флаг РОХФЛАГС_ССЛ_ОНЛИ (0x2), чтобы указать MAPI использовать только протокол SSL.</span><span class="sxs-lookup"><span data-stu-id="32c91-204">For PR_ROH_FLAGS, your environment may require the flag ROHFLAGS_SSL_ONLY (0x2) to tell MAPI to use only SSL.</span></span> <span data-ttu-id="32c91-205">Если для вашей среды требуется взаимная проверка подлинности, необходимо также установить этот флаг (а не [РОХФЛАГС_МУТУАЛ_АУС (0x4)]).</span><span class="sxs-lookup"><span data-stu-id="32c91-205">If your environment requires mutual authentication, you will need to set that flag as well [ROHFLAGS_MUTUAL_AUTH (0x4)].</span></span> <span data-ttu-id="32c91-206">Для установки РОХФЛАГС_МУТУАЛ_АУС (0x4) потребуется также задать свойство ПР_РОХ_ПРОКСИ_ПРИНЦИПАЛ_НАМЕ.</span><span class="sxs-lookup"><span data-stu-id="32c91-206">Setting ROHFLAGS_MUTUAL_AUTH (0x4) will require that you also set the property PR_ROH_PROXY_PRINCIPAL_NAME.</span></span> <span data-ttu-id="32c91-207">Это значение должно быть основным именем сервера.</span><span class="sxs-lookup"><span data-stu-id="32c91-207">You should set this to be the principal name of the server.</span></span>
> - <span data-ttu-id="32c91-208"><sup>2</sup> для Outlook 2010, необходимо использовать протокол expr.</span><span class="sxs-lookup"><span data-stu-id="32c91-208"><sup>2</sup> For Outlook 2010, you will need to use the EXPR protocol.</span></span> <span data-ttu-id="32c91-209">Outlook 2013 использует протокол ЕКСХТТП.</span><span class="sxs-lookup"><span data-stu-id="32c91-209">Outlook 2013 uses the EXHTTP protocol.</span></span> 
> - <span data-ttu-id="32c91-210"><sup>3</sup> это значение может отсутствовать в отклике автообнаружения.</span><span class="sxs-lookup"><span data-stu-id="32c91-210"><sup>3</sup> This value may not be in the Autodiscover response.</span></span> <span data-ttu-id="32c91-211">Если этот параметр не указан, клиент должен использовать Kerberos или NTLM.</span><span class="sxs-lookup"><span data-stu-id="32c91-211">If not specified, the client should use Kerberos or NTLM.</span></span> 
    
<span data-ttu-id="32c91-212">Советы по поиску и устранению неИсправностей приведены [в статье Настройка профиля Outlook с помощью MFCMAPI для Exchange 2013](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013).</span><span class="sxs-lookup"><span data-stu-id="32c91-212">For Troubleshooting tips, see [How to configure an Outlook profile using MFCMAPI for Exchange 2013](https://blogs.msdn.microsoft.com/dvespa/2014/01/16/how-to-configure-an-outlook-profile-using-mfcmapi-for-exchange-2013).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="32c91-213">См. также</span><span class="sxs-lookup"><span data-stu-id="32c91-213">See also</span></span>

- [<span data-ttu-id="32c91-214">Справочник по MAPI для Outlook</span><span class="sxs-lookup"><span data-stu-id="32c91-214">Outlook MAPI Reference</span></span>](https://msdn.microsoft.com/library/office/cc765775.aspx)  
- [<span data-ttu-id="32c91-215">Программное создание профиля в Outlook</span><span class="sxs-lookup"><span data-stu-id="32c91-215">Programmatically Create a Profile in Outlook</span></span>](https://msdn.microsoft.com/library/office/mt707568.aspx)
    


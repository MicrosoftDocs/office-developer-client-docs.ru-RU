---
title: Завершение работы поставщика службы
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e518830b-0aaa-4ce4-a85a-07e4f00750a9
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 71706fc970170f74aa5555da29d904c08c0422f2
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812296"
---
# <a name="shutting-down-a-service-provider"></a>Завершение работы поставщика службы

 
  
**Относится к**: Outlook 
  
Когда клиент вызывает метод [IMAPISession::Logoff](imapisession-logoff.md) , чтобы завершить сеанс и завершите работу всех поставщиков услуг активный, MAPI в свою очередь вызывает следующие методы: 
  
- [IABLogon::Logoff](iablogon-logoff.md) поставщиками адресной книги. 
    
- [IMSLogon::Logoff](imslogon-logoff.md) поставщиков хранилища сообщений. 
    
- [IXPLogon::TransportLogoff](ixplogon-transportlogoff.md) поставщиками транспорта. 
    
Эти методы иметь аналогичные реализации. Основные задачи, которые выполняет выход из системы, как показано ниже:
  
- Освобождение всех открытых объектов, включая вложенных объектов и объектов состояния.
    
- Вызов метода [функции IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) объект поддержки для уменьшения счетчик ссылок на него. 
    
- Удаление всех зарегистрированных [MAPIUID](mapiuid.md) структуры ваш поставщик. 
    
- Удаление ваш поставщик строки в таблице состояния.
    
- Выполнять все задачи, связанные с очистки ресурсов, включая следующие:
    
  - Завершение подключения к удаленному серверу.
    
  - Уменьшение справочные материалы по счетчик на объект вход в систему.
    
  - Удаление из списка объектов входа в систему, ваш поставщик хранит объект вход в систему.
    
  - В режиме отладки выдачи трассировку для поиска объектов, которые утечка памяти.
    
При возвращении метод выхода из системы, MAPI вызывает следующее:
  
- Метод **функции IUnknown::Release** объекта входа в систему. 
    
- Метод **Shutdown** объект поставщика для выполнения задач, окончательную. В зависимости от типа поставщика называется один из следующих методов: 
    
  - [IABProvider::Shutdown](iabprovider-shutdown.md) для поставщиками адресных книг 
    
  - [IMSProvider::Shutdown](imsprovider-shutdown.md) для поставщиков хранилища сообщений 
    
  - [IXPProvider::Shutdown](ixpprovider-shutdown.md) для поставщиками транспорта 
    
- Метод **функции IUnknown::Release** объект поставщика. 
    
Если ваш поставщик хранилища сообщений, вызов клиентом [IMsgStore::StoreLogoff](imsgstore-storelogoff.md) также начнет процесс завершения работы. **StoreLogoff** завершает работу одного поставщика хранилища конкретное сообщение и не оказывает влияния на сеанс. Только поставщика хранилища сообщений можно завершить работу с помощью этого метода; нет возможности явные остановки конкретной адресной книги или транспорта поставщика. Дополнительные сведения о реагировании **StoreLogoff** звонков, см [Завершает работу сообщение поставщика хранилища](shutting-down-a-message-store-provider.md).
  
Ваш поставщик DLL будет выгружен, когда MAPI вызывает функцию Win32 API **FreeLibrary**вызов, внесенных после последнего активного клиента называется [MAPIUninitialize](mapiuninitialize.md). В данный момент ваш поставщик услуг будет завершена завершает работу. 
  
## <a name="see-also"></a>См. также



[Поставщиков служб MAPI](mapi-service-providers.md)


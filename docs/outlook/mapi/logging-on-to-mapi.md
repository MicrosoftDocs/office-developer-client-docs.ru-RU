---
title: Вход в MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 1ae3c47964ff238f57e98e0005a966008192f7c7
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809673"
---
# <a name="logging-on-to-mapi"></a>Вход в MAPI
 
**Относится к**: Outlook 
  
Клиентские приложения вход в подсистему MAPI с вызова функции **MAPILogonEx** . Для получения дополнительных сведений см [MAPILogonEx](mapilogonex.md). **MAPILogonEx** проверяет Выбор профиля и настройки каждого поставщика служб в профиле. После настройки MAPI запускает поставщиками адресной книги перед началом работы поставщиков хранилища сообщений. Поставщики транспорта запускаются при их служб сначала являются обязательными. 
  
## <a name="choose-a-profile"></a>Выберите профиль
  
- Передайте строку символов, которая представляет имя профиля, с помощью параметра _lpszProfileName_ **MAPILogonEx**или...
    
- Пользователь может выбрать профиль, указать значение NULL для параметра _lpszProfileName_ и установив флаг MAPI_LOGON_UI, или... 

- Выберите профиль по умолчанию, указать значение NULL для параметра _lpszProfileName_ и установка флага MAPI_USE_DEFAULT. 
    
Если требуется определенный профиль, отличный от профиля по умолчанию, необходимо сохранить его имя в базе данных конфигурации или использовать конкретное соглашение об именовании. MAPI не предоставляет никаких атрибутов профиля отличный от имени и значения по умолчанию флаг в таблице профилей и зарезервирован для обмена сообщениями клиента и связанных с ними приложений IPM флаг профиля по умолчанию.
  
Клиенты, которые предоставляют сокращенный профиль или сведения о конфигурации поставщика для **MAPILogonEx** должен запрашивать у пользователя для дополнительных данных, позволяя диалоговое окно для отображения. Если отсутствуют сведения о и **MAPILogonEx** нельзя предложить пользователю указать его, не удается выполнить вход. Клиенты, которые не требуется пользователям вводить данные, можно отключить отображаемое поле диалогового окна. 
  
Флаги, **MAPILogonEx** используется для включения пользовательского интерфейса являются взаимоисключающими; можно задать только один. Оставив эти флаги неопределенные подавляет отображение пользовательского интерфейса, в результате чего **MAPILogonEx** с ошибкой, если отсутствуют необходимые сведения. То есть если отключить пользовательский интерфейс и передать значение NULL для параметра _lpszProfileName_ , а не задан флаг MAPI_USE_DEFAULT, **MAPILogonEx** завершится ошибкой, так как он не удается получить имя профиля. 
  
Сеанс, который устанавливает **MAPILogonEx** может быть отдельного сеанса обмена мгновенными сообщениями, сеанс обмена мгновенными сообщениями или nonmessaging сеанса. Сеансы обмена мгновенными сообщениями, частные подключения между вашего клиента и подсистемы MAPI и может быть установлено путем установки флага MAPI_NEW_SESSION в вызове **MAPILogonEx**.
  
Общие сеансов обмена мгновенными сообщениями, подключений, которые могут использовать несколько клиентов системы обмена сообщениями. Общие сеансов обычно устанавливаются для клиентов, используйте тот же профиль. Чтобы установить новый сеанс общего сеанса, установите флаг MAPI_ALLOW_OTHERS. 
  
## <a name="use-an-existing-shared-session"></a>Используйте существующий совместный сеанс
  
- Не задан флаг MAPI_NEW_SESSION.
    
- Не задан флаг MAPI_ALLOW_OTHERS.
    
- Передайте значение NULL для параметра _lpszProfileName_ . 
    
- Передайте значение NULL для параметра _lpszPassword_ . 
    
Nonmessaging сеансы разрешить клиентам для доступа к подсистеме MAPI, но не разрешать сообщений для отправки или получения. Конфигурация или администрирования приложений приведены примеры клиентов, которым может потребоваться установить nonmessaging сеансов. Чтобы запросить nonmessaging сеанса, установите флаг MAPI_NO_MAIL. Этот флаг установлен входе клиента без уведомления диспетчер очереди MAPI. Клиентов, которые подключаются к MAPI с этот флаг не ожидать, когда-либо получать отчеты о состоянии чтения.
  
Флаг MAPI_NO_MAIL должны быть установлены только:
  
- Если клиент не будет отправлять и получать сообщения во время сеанса.
    
- Если клиент имеет полный контроль над содержимое профиля и отправки и получения сообщений с помощью тесно связанных сообщений хранилища и транспорта поставщиками, такими как поставщики Microsoft Exchange.
    
Клиент обмена мгновенными сообщениями могут совместно использовать сеанс с помощью nonmessaging клиента. Характеристики один участник сеанса совместной работы, не влияют характеристики других участников. То есть при входе в систему с набором флаги MAPI_NO_MAIL и MAPI_ALLOW_OTHERS ведения журнала на ваш сеанс обмена мгновенными сообщениями клиент не оказывает влияния на операции клиента и наоборот. Клиент обмена мгновенными сообщениями по-прежнему возможность отправки и получения сообщений и клиент не работает.
  
**MAPILogonEx** определяет несколько флаги, которые можно установить: 
  
- MAPI_FORCE_DOWNLOAD указывает, что перед возвращает **MAPILogonEx** необходимо загрузить входящих сообщений. Не этот флаг при указании сообщений веб-сайта в фоновом режиме в дальнейшем. 
    
- MAPI_SERVICE_UI_ALWAYS запросы, каждая служба сообщения в профиле отображать диалоговое окно настройки.
    
- MAPI_NT_SERVICE указывает, что клиент реализуется как служба Windows. Должен быть установлен этот флаг, если клиент — это служба.
    
С помощью каждого успешного входа в систему **MAPILogonEx** возвращает указатель на сеанс MAPI. В этом указатель можно использовать для вызова методов интерфейса **IMAPISession** . Дополнительные сведения можно [IMAPISession: IUnknown](imapisessioniunknown.md). Указатели сеанса, независимо от типа сеанса, являются уникальными для клиентов, которые получают их и являются недопустимыми для задачи.
  


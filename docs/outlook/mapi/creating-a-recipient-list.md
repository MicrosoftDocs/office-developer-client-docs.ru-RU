---
title: Создание списка получателей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 270f86dd-2c1f-47eb-80f7-9d0d63936d61
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e3aa1f2b2e1e7c6d8a9be3fff451002952930ffb
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332909"
---
# <a name="creating-a-recipient-list"></a>Создание списка получателей

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Список получателей — это структура [ADRLIST](adrlist.md) , содержащая массив структур значений свойств для каждого получателя сообщения — назначение сообщения. Получатель может представлять пользователя, компьютер или папку. Для всех отправляемых сообщений требуется по крайней мере один получатель, проходящих через процесс разрешения имен — процесс, обеспечивающий включение свойства **пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)) в массив значений свойств получателя. 
  
Свойства получателя — это сочетание свойств адресных книг и сообщений. Свойства получателей могут быть применены ко всем сообщениям определенного получателя или только к текущему сообщению. Как хранилище сообщений, так и поставщики транспорта могут задавать свойства получателей. 
  
Каждый получатель должен иметь основной набор свойств в массиве значений свойств, когда сообщение готово к отправке. Обязательный набор свойств получателя включает в себя следующее:
  
- **Пр_аддртипе** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) 
    
- **Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) 
    
- **Пр_емаил_аддресс** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) 
    
- **PR_ENTRYID**
    
- **Пр_обжект_типе** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) 
    
- **Пр_сеарч_кэй** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) 
    
Эти свойства используются для доступа к получателю, отправки сообщений в него и сравнения с другими. Не все эти свойства должны быть доступны сразу. Вы можете сначала добавить получателя, не зная его идентификатора записи, используя процесс разрешения имен для назначения этого свойства. В некоторый момент перед отправкой сообщения вызовите [IAddrBook:: ресолвенаме](iaddrbook-resolvename.md) , чтобы убедиться, что все получатели в списке получателей разрешены. Дополнительные сведения см. в разделе [разрешение имени получателя](resolving-a-recipient-name.md).
  
Списки получателей можно создавать из записей "пользователи системы обмена сообщениями" или "список рассылки" в контейнере адресной книги или из одного из них. Один из них — это получатели, которые создаются как временные записи, которые будут использоваться только для адресации одного сообщения или записи, добавляемые в личную адресную книгу. Формат для одноразового идентификатора записи и адреса определяется MAPI. Дополнительные сведения об этих форматах приведены в статье [одноразовЫе адреса](one-off-addresses.md) и [одноразовЫе идентификаторы записей](one-off-entry-identifiers.md).
  
Вы можете разрешить пользователям создавать свои списки получателей:
  
- Только с записями из адресной книги.
    
- Только с одноразовыми записями.
    
- С помощью сочетаний получателей адресной книги и односторонней.
    
 **Создание списка получателей с помощью диалогового окна "общий адрес"**
  
1. Выделение структуры [адрпарм](adrparm.md) и указателя на структуру [ADRLIST](adrlist.md) . 
    
2. Обнуление памяти в структуре **адрпарм** и присвойте указателю **ADRLIST** значение null. 
    
3. Call [IAddrBook:: Address](iaddrbook-address.md) для отображения диалогового окна адрес и заполнения структуры **адрпарм** . 
    
4. Call [iMessage:: модифиреЦипиентс](imessage-modifyrecipients.md), передавая указатель **ADRLIST** . Эта структура будет содержать свойства каждого получателя, выбранного пользователем. 
    
 **Порядок создания списка получателей программным способом**
  
1. Выделить структуру **ADRLIST** , содержащую одну структуру [адрентри](adrentry.md) для каждого из получателей, которые должны быть включены в список. Сделайте каждую структуру **адрентри** достаточно большой для хранения всех обязательных свойств и **пр_реЦипиент_типе** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md)).
    
2. Для каждого получателя задайте массив значений свойства для элемента **аентриес** в структуре **ADRLIST** . 
    
3. Call [iMessage:: модифиреЦипиентс](imessage-modifyrecipients.md) с установленным флагом модреЦип_адд. 
    


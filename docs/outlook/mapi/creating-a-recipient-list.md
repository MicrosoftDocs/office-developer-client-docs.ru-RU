---
title: Создание списка получателей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 270f86dd-2c1f-47eb-80f7-9d0d63936d61
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e3aa1f2b2e1e7c6d8a9be3fff451002952930ffb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428216"
---
# <a name="creating-a-recipient-list"></a>Создание списка получателей

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Список получателей — это структура [ADRLIST,](adrlist.md) которая содержит массив структур значений свойств для каждого получателя сообщения , предназначенного для сообщения. Получатель может представлять пользователя, машину или папку. Для всех отправленных сообщений требуется, по крайней мере, один получатель, который прошел процесс разрешения **имен, —** процесс обеспечения того, чтобы свойство [PR_ENTRYID (PidTagEntryId)](pidtagentryid-canonical-property.md)было включено в массив свойств получателя. 
  
Свойства получателя — это сочетание свойств адресной книги и свойств сообщений. Свойства получателя могут применяться либо к всем сообщениям для конкретного получателя, либо только к текущему сообщению. Оба поставщика хранения сообщений и поставщики транспорта могут устанавливать свойства получателей. 
  
Каждый получатель должен иметь базовый набор свойств в массиве значений свойств к моменту готовности к отправлению сообщения. Необходимый набор свойств получателей:
  
- **PR_ADDRTYPE** [(PidTagAddressType)](pidtagaddresstype-canonical-property.md) 
    
- **PR_DISPLAY_NAME** [(PidTagDisplayName)](pidtagdisplayname-canonical-property.md) 
    
- **PR_EMAIL_ADDRESS** [(PidTagEmailAddress)](pidtagemailaddress-canonical-property.md) 
    
- **PR_ENTRYID**
    
- **PR_OBJECT_TYPE** [(PidTagObjectType)](pidtagobjecttype-canonical-property.md) 
    
- **PR_SEARCH_KEY** [(PidTagSearchKey)](pidtagsearchkey-canonical-property.md) 
    
Эти свойства используются для доступа к получателю, отправки ему сообщений и сравнения с другими. Не все эти свойства должны быть доступны сразу. Вы можете добавить получателя изначально, не зная его идентификатор входа, полагаясь на процесс разрешения имен, чтобы назначить это свойство. В какой-то момент перед отправкой сообщения позвоните [в IAddrBook::ResolveName,](iaddrbook-resolvename.md) чтобы убедиться, что все получатели в списке получателей будут устранены. Дополнительные сведения см. в [дополнительных сведениях, в том, как разрешить имя получателя.](resolving-a-recipient-name.md)
  
Списки получателей можно создавать из пользователей сообщений или записей списков рассылки в контейнере адресной книги или из разных. Отдельные получатели — это получатели, созданные в качестве временных записей, которые будут использоваться только для обращения к одному сообщению или в качестве записей, которые будут добавлены в личную адресную книгу. Формат идентификатора и адреса для одноавтной записи определяется MAPI. Дополнительные сведения об этих форматах см. в [документе One-Off Addresses](one-off-addresses.md) и [One-Off Entry Identifiers.](one-off-entry-identifiers.md)
  
Вы можете позволить пользователям создавать списки получателей:
  
- Только с записями из адресной книги.
    
- Только с одноавтными записями.
    
- Сочетание получателей адресной книги и разовая.
    
 **Создание списка получателей с помощью общего диалогового окна адресов**
  
1. Выделение [структуры ADRPARM](adrparm.md) и указателя в [структуру ADRLIST.](adrlist.md) 
    
2. Обнуление памяти в **структуре ADRPARM** и задав указатель **ADRLIST** NULL. 
    
3. Вызов [IAddrBook::Address,](iaddrbook-address.md) чтобы отобразить диалоговое окно адреса и заполнить **структуру ADRPARM.** 
    
4. Вызов [IMessage::ModifyRecipients,](imessage-modifyrecipients.md)передавая **указатель ADRLIST.** Эта структура будет содержать свойства каждого получателя, выбранного пользователем. 
    
 **Создание списка получателей программным путем**
  
1. **Выделим структуру ADRLIST,** которая содержит одну [структуру ADRENTRY](adrentry.md) для каждого из получателей, которые будут включены в список. Сделайте каждую структуру **ADRENTRY** достаточно большой, чтобы удерживать каждое из необходимых свойств **и** PR_RECIPIENT_TYPE [(PidTagRecipientType).](pidtagrecipienttype-canonical-property.md)
    
2. Для каждого получателя установите массив значений свойств для его **участника aEntries** в **структуре ADRLIST.** 
    
3. Вызов [IMessage::ModifyRecipients](imessage-modifyrecipients.md) с MODRECIP_ADD флагом. 
    


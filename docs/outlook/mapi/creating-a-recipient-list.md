---
title: Создание списка получателей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 270f86dd-2c1f-47eb-80f7-9d0d63936d61
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: e3aa1f2b2e1e7c6d8a9be3fff451002952930ffb
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428216"
---
# <a name="creating-a-recipient-list"></a>Создание списка получателей

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Список получателей — это структура [ADRLIST,](adrlist.md) которая содержит массив структур значений свойств для каждого получателя сообщения — назначения для сообщения. Получатель может представлять пользователя, компьютер или папку. Для всех отослаенных сообщений требуется по крайней мере один получатель, который прошел процесс разрешения **имен—** процесс, обеспечивающий, чтобы свойство PR_ENTRYID [(PidTagEntryId)](pidtagentryid-canonical-property.md)было включено в массив значений свойств получателя. 
  
Свойства получателя — это сочетание свойств адресной книги и сообщений. Свойства получателя могут применяться либо к всем сообщениям для определенного получателя, либо только к текущему сообщению. Как поставщики хранения сообщений, так и поставщики транспорта могут устанавливать свойства получателей. 
  
Каждый получатель должен иметь основной набор свойств в массиве значений свойств к моменту, когда сообщение будет готово к отправлению. К обязательному набору свойств получателей относятся:
  
- **PR_ADDRTYPE** ([PidTagAddressType)](pidtagaddresstype-canonical-property.md) 
    
- **PR_DISPLAY_NAME** ([PidTagDisplayName)](pidtagdisplayname-canonical-property.md) 
    
- **PR_EMAIL_ADDRESS** ([PidTagEmailAddress)](pidtagemailaddress-canonical-property.md) 
    
- **PR_ENTRYID**
    
- **PR_OBJECT_TYPE** ([PidTagObjectType)](pidtagobjecttype-canonical-property.md) 
    
- **PR_SEARCH_KEY** ([PidTagSearchKey)](pidtagsearchkey-canonical-property.md) 
    
Эти свойства используются для доступа к получателю, отправки ему сообщений и сравнения с другими. Не все эти свойства должны быть доступны сразу. Вы можете добавить получателя изначально, не зная его идентификатор записи, назначив этому свойству процесс разрешения имен. В определенный момент перед отправкой сообщения вызовите [IAddrBook::ResolveName,](iaddrbook-resolvename.md) чтобы убедиться, что все получатели в списке получателей разрешены. Дополнительные сведения см. в под [названием "Разрешение имени получателя".](resolving-a-recipient-name.md)
  
Списки получателей могут создаваться из записей пользователей сообщений или списков рассылки в контейнере адресной книги или из разных мест. Единственными получателями являются получатели, которые создаются как временные записи, которые используются только для обращения к одному сообщению или в качестве записей, добавляемой в личную адресную книгу. Формат идентификатора и адреса однораховой записи определяется с помощью MAPI. Дополнительные сведения об этих форматах см. в записях [one-off Addresses](one-off-addresses.md) и [One-Off Entry Identifiers.](one-off-entry-identifiers.md)
  
Вы можете позволить пользователям создавать списки получателей:
  
- Только с записями из адресной книги.
    
- Только с одновключными записями.
    
- С сочетанием получателей адресной книги и одного разов.
    
 **Создание списка получателей с помощью диалогового окна общего адреса**
  
1. Выделим [структуру ADRPARM](adrparm.md) и указатель на [структуру ADRLIST.](adrlist.md) 
    
2. Обнуление памяти в **структуре ADRPARM** и установите для указателя **ADRLIST** значение NULL. 
    
3. Вызовите [IAddrBook::Address,](iaddrbook-address.md) чтобы отобразить диалоговое окно адреса и заполнить структуру **ADRPARM.** 
    
4. Вызовите [IMessage::ModifyRecipients,](imessage-modifyrecipients.md)передавая **указатель ADRLIST.** Эта структура будет содержать свойства каждого получателя, выбранного пользователем. 
    
 **Создание списка получателей программным путем**
  
1. Выделим **структуру ADRLIST,** которая содержит одну структуру [ADRENTRY](adrentry.md) для каждого получателя, который будет включен в список. Сделайте **каждую структуру ADRENTRY** достаточно большой, чтобы она удерживала все необходимые свойства **и** PR_RECIPIENT_TYPE ([PidTagRecipientType).](pidtagrecipienttype-canonical-property.md)
    
2. Для каждого получателя установите массив значений свойств для его **члена aEntries** в структуре **ADRLIST.** 
    
3. Вызовите [IMessage::ModifyRecipients](imessage-modifyrecipients.md) с MODRECIP_ADD флага. 
    


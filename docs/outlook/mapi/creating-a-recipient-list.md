---
title: Создание списка получателей
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 270f86dd-2c1f-47eb-80f7-9d0d63936d61
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: fa23377a8b080ae9dac3e31dfa137ca03a242c74
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808255"
---
# <a name="creating-a-recipient-list"></a>Создание списка получателей

  
  
**Относится к**: Outlook 
  
Список получателей является структурой [ADRLIST](adrlist.md) , который содержит массив структур значение свойства для каждого получателя сообщения — назначения для сообщения. Получатель может представлять человеческого пользователя, компьютера или папки. Все сообщения, отправляемые требуется по крайней мере одного получателя, которое было через процесс разрешения имен — процесс для проверка того, что свойство **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) включается в массив значений свойств получателя. 
  
Свойства получателя — это сочетание свойств адресной книги и свойства сообщения. Свойствами получателя можно применять ко всем сообщениям для отдельного получателя или только для текущего сообщения. Оба сообщения хранилища и поставщиками транспорта можно задать свойствами получателя. 
  
Каждого получателя, необходимо иметь базовый набор свойств в его массива значение свойства, время, когда сообщение Готово к отправке. Необходимый набор параметров учетной записи получателя включают:
  
- **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) 
    
- **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) 
    
- **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) 
    
- **PR_ENTRYID**
    
- **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md)) 
    
- **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) 
    
Эти свойства используются для доступа к получателя, отправлять сообщения и сравнить его с другими пользователями. Не все эти свойства должны быть доступны сразу. Можно добавить получателя изначально неизвестны его идентификатор записи полагаться на процесс разрешения имен для назначения этого свойства. Перед отправкой сообщения вызовите [IAddrBook::ResolveName](iaddrbook-resolvename.md) , чтобы убедиться в том, что все сообщения, в список получателей разрешаются. Для получения дополнительных сведений см [разрешения имени получателя](resolving-a-recipient-name.md).
  
Можно создать списки получателей из системы обмена сообщениями пользователи или элементы списка рассылки в контейнер адресной книги или one-offs. One-offs являются получателей, которые создаются в качестве временных записей для использования только для одного сообщения-адресов или записей для добавления к адресной книге. Формат идентификатора единичных записей и адреса определяется MAPI. Дополнительные сведения об этих форматах можно [Одноразовых адресов](one-off-addresses.md) и [Одноразовых идентификаторы записей](one-off-entry-identifiers.md).
  
Можно разрешить пользователям создавать свои списки получателей:
  
- Только с записями из адресной книги.
    
- Только с одноразовых записи.
    
- Вместе с адресной книгой получателей и one-offs.
    
 **Чтобы создать список получателей с помощью стандартным диалоговым окном адрес**
  
1. Выделите структуру [ADRPARM](adrparm.md) и указатель на структуру [ADRLIST](adrlist.md) . 
    
2. Нулевое значение памяти в структуре **ADRPARM** и установите указатель **ADRLIST** NULL. 
    
3. Вызов [IAddrBook::Address](iaddrbook-address.md) для отображения диалогового окна адрес и заполнения **ADRPARM** структуры. 
    
4. Вызовите [IMessage::ModifyRecipients](imessage-modifyrecipients.md), передав указатель **ADRLIST** . Эта структура будет содержать свойства каждого из получателей, выбранный пользователем. 
    
 **Создание списка получателей программными средствами**
  
1. Выделите структуру **ADRLIST** , которая содержит одну структуру [ADRENTRY](adrentry.md) для каждого из получателей, которые включены в список. Сделайте каждого **ADRENTRY** структуру, достаточное для хранения всех необходимых свойств и **PR_RECIPIENT_TYPE** ([PidTagRecipientType](pidtagrecipienttype-canonical-property.md)).
    
2. Для каждого получателя задайте массива значение свойства для элемента его **aEntries** в структуре **ADRLIST** . 
    
3. Вызов [IMessage::ModifyRecipients](imessage-modifyrecipients.md) с установленным флагом MODRECIP_ADD. 
    


---
title: FtgRegisterIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.FtgRegisterIdleRoutine
api_type:
- COM
ms.assetid: 8d9557ba-7919-42c6-9e2f-f10214437d53
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: b45b80f09efbd4f05aabc2c868d5bd8eb5fa4cce
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32327995"
---
# <a name="ftgregisteridleroutine"></a>FtgRegisterIdleRoutine

**Область применения**: Outlook 2013 | Outlook 2016 
  
Добавляет подпрограмму бездействия на основе функции [фнидле](fnidle.md) в систему MAPI. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Мапиутил. h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
FTG FtgRegisterIdleRoutine(
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle
);
```

## <a name="parameters"></a>Параметры

_Пфнидле_
  
> возврата Указатель на подпрограмму Idle. 
    
_Пвидлепарам_
  
> возврата Указатель на блок памяти, который антивирусная программа должна передать в качестве параметра в подпрограмму Idle при его вызове. 
    
_Приидле_
  
> возврата Начальный приоритет для процедуры Idle. Возможные приоритеты для подпрограмм, определенных при реализации, больше или меньше нуля, но не равны нулю. Нулевой приоритет резервируется для события пользователя, такого как щелчок мыши или сообщение WM_PAINT. Приоритеты больше нуля представляют фоновые задачи, которые имеют более высокий приоритет, чем события пользователя, и отправляются как часть стандартного цикла приема сообщений Windows. Приоритеты, меньшие нуля, представляют неактивные задачи, выполняемые во время простоя при загрузке сообщений. Ниже приведены примеры приоритетов: 1 для отправки на передний план, 2 для вставки символов Power и 3 для загрузки новых сообщений.
    
_КсеЦидле_
  
> возврата Начальное значение времени в сотых долях секунды, которое будет использоваться при указании параметров подпрограммы бездействия. Значение начального значения времени может различаться в зависимости от того, что передается в параметре _ироидле_ . Значение может быть одним из следующих: 
    
  - Минимальный период действия пользователя, который должен пройти, прежде чем антивирусное ядро MAPI вызывает подпрограмму простоя в первый раз, если установлен флаг ФИРОВАИТ в _ироидле_. По исТечении этого времени модуль простоя может вызывать процедуру простоя, как это необходимо. 
    
  - Минимальный интервал между вызовами процедуры Idle, если установлен флаг ФИРОИНТЕРВАЛ в _ироидле_. 
    
_Ироидле_
  
> возврата Битовая маска флагов, используемых для установки начальных параметров для процедуры Idle. Можно задать следующие флаги:
    
  ФИРОНОАДЖУСТМЕНТ
    
  > Используйте этот флаг, чтобы указать, что таймер неактивной программы не должен быть скорректирован для спящего режима или возобновления. Поведение по умолчанию без этого флага заключается в том, что при расчете затраченного времени исключается время сна. Если ФИРОНОАДЖУСТМЕНТ передается, то время сна включается при расчете затраченного времени.
      
  ФИРОДИСАБЛЕД
    
  > Подпрограмму периода бездействия следует отключить при регистрации. Действие по умолчанию включает процедуру Idle, когда **фтгрегистеридлераутине** регистрирует ее. 
      
  ФИРОИНТЕРВАЛ 
    
  > Время, заданное параметром _ксеЦидле_ , является минимальным интервалом между последовательными вызовами процедуры Idle. 
      
  ФИРУНЦЕОНЛИ 
    
  > Устаревши. Не используйте. 
      
  ФИРОПЕРБЛОКК 
    
  > Устаревши. Не используйте. 
      
  ФИРОВАИТ 
    
  > Время, заданное параметром _ксеЦидле_ , является минимальным периодом действия пользователя, который должен пройти, прежде чем модуль бездействия MAPI вызывает подпрограмму бездействия в первый раз. По исТечении этого времени модуль простоя может вызывать процедуру простоя, как это необходимо. 
    
## <a name="return-value"></a>Возвращаемое значение

Функция **фтгрегистеридлераутине** возвращает тег функции, определяющий подпрограмму Idle, добавленную в систему MAPI. Если **фтгрегистеридлераутине** не может зарегистрировать подпрограмму Idle для клиентского приложения или поставщика услуг, например из-за проблем с памятью, возвращается значение null. 
  
## <a name="remarks"></a>Комментарии

Приведенные ниже функции работают с модулем бездействия MAPI и с процедурами простоя на основе прототипа функции [фнидле](fnidle.md) . 
  
|**Функция неАктивности**|**Usage**|
|:-----|:-----|
|[ChangeIdleRoutine](changeidleroutine.md) <br/> |Изменяет характеристики зарегистрированной процедуры бездействия.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированную процедуру бездействия из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированную подпрограмму бездействия, не удаляя ее из системы MAPI.  <br/> |
|**FtgRegisterIdleRoutine** <br/> |Добавляет подпрограмму бездействия в систему MAPI с включением или без него.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Завершает работу модуля бездействия MAPI для вызывающего приложения.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует модуль бездействия MAPI для вызывающего приложения.  <br/> |
   
**Чанжеидлераутине**, **дерегистеридлераутине**и **енаблеидлераутине** принимают в качестве входного параметра тег функции, возвращенный методом **фтгрегистеридлераутине**. 
  
Когда все фоновые задачи для платформы становятся неактивными, модуль бездействия MAPI вызывает подпрограмму самого высокого приоритета, готовую к выполнению. Не существует гарантии того, что вы звоните между процедурами неактивности и одинаковым приоритетом. 
  
Ниже приведен пример использования флага ФИРОНОАДЖУСТМЕНТ в параметре _ироидле_ . 
  
1. Регистрация процедуры бездействия с 5 минутной задержкой.
    
2. Переход в спящий режим/режим сна компьютера через 1 минуту (4 минуты влево на таймер).
    
3. ВозОбновите работу компьютера спустя 10 минут.
    
Поведение по умолчанию, не ФИРОНОАДЖУСТМЕНТ, заключается в том, что для выполнения процедуры необходимо подождать 4 еще больше минут. То есть ваш таймер был настроен таким образом, чтобы разрешить время, в течение которого компьютер находился в спящем режиме. Тем не менее, если вы передаете ФИРОНОАДЖУСТМЕНТ, подпрограмму простоя будут выполняться немедленно, так как истечет более 5 минут реального времени.
  


---
title: FtgRegisterIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.FtgRegisterIdleRoutine
api_type:
- COM
ms.assetid: 8d9557ba-7919-42c6-9e2f-f10214437d53
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: b45b80f09efbd4f05aabc2c868d5bd8eb5fa4cce
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418523"
---
# <a name="ftgregisteridleroutine"></a>FtgRegisterIdleRoutine

**Относится к**: Outlook 2013 | Outlook 2016 
  
Добавляет процедуру бездействия на основе функций [FNIDLE](fnidle.md) в систему MAPI. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
FTG FtgRegisterIdleRoutine(
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle
);
```

## <a name="parameters"></a>Параметры

_pfnIdle_
  
> [in] Указатель на процедуру бездействия. 
    
_pvIdleParam_
  
> [in] Указатель на блок памяти, который механизм бездействия должен передать в качестве параметра в процедуру простоя при его вызове. 
    
_priIdle_
  
> [in] Начальный приоритет для процедуры простоя. Возможные приоритеты для процедур, определяемой реализацией, больше или меньше нуля, но не нуль. Нулевой приоритет зарезервирован для события пользователя, например щелчка мыши или WM_PAINT сообщения. Приоритеты больше нуля представляют фоновые задачи, которые имеют более высокий приоритет, чем события пользователя, и отправляются в рамках стандартного цикла циклов сообщений Windows. Приоритеты меньше нуля представляют задачи бездействия, которые запускались только во время простоя сообщения. Примеры приоритетов: 1 для отправки на переднем плане, 2 для вставки символов питания и 3 для загрузки новых сообщений.
    
_csecIdle_
  
> [in] Начальное значение времени (в сотых секундах), используемого для указания параметров процедуры бездействия. Значение начального значения времени зависит от того, что передается в _параметре iroIdle._ Значением может быть одно из следующих значений: 
    
  - Минимальный период бездействия пользователя, который должен пройти до первого вызова процедуры простоя MAPI, если флаг FIROWAIT установлен в _iroIdle._ По идентности этого времени механизм бездействия может вызывать процедуру простоя по мере необходимости. 
    
  - Минимальный интервал между вызовами процедуры простоя, если флаг FIROINTERVAL установлен _в iroIdle._ 
    
_iroIdle_
  
> [in] Битоваяmas флагов, используемая для настройки начальных параметров процедуры простоя. Можно установить следующие флаги:
    
  FIRONOADJUSTMENT
    
  > Используйте этот флаг, чтобы указать, что не следует настраивать обычное время ожидания для спящий режим или возобновления работы. По умолчанию без этого флага время спящий режим исключается при расчете времени, за которое у вас исчислялось. Если fiRONOADJUSTMENT передается, то при вычислении затмило время сна.
      
  FIRODISABLED
    
  > Процедуру простоя следует отключить при регистрации. Действие по умолчанию — включить процедуру простоя, когда **FtgRegisterIdleRoutine** регистрирует ее. 
      
  FIROINTERVAL 
    
  > Время, заданное параметром  _csecIdle,_ — это минимальный интервал между последовательными вызовами процедуры простоя. 
      
  FIROONCEONLY 
    
  > Устаревшее. Не используйте. 
      
  FIROPERBLOCK 
    
  > Устаревшее. Не используйте. 
      
  FIROWAIT 
    
  > Время, заданное параметром  _csecIdle,_ — это минимальный период бездействия пользователя, который должен пройти, прежде чем механизм бездействия MAPI в первый раз вызывает процедуру простоя. По идентности этого времени механизм бездействия может вызывать процедуру простоя по мере необходимости. 
    
## <a name="return-value"></a>Возвращаемое значение

Функция **FtgRegisterIdleRoutine** возвращает тег функции, определяющий процедуру бездействия, добавленную в систему MAPI. Если **FtgRegisterIdleRoutine** не удается зарегистрировать процедуру бездействия для клиентского приложения или поставщика услуг, например из-за проблем с памятью, возвращается NULL. 
  
## <a name="remarks"></a>Примечания

Следующие функции работают с механизмом бездействия MAPI и процедурами бездействия на основе прототипа функции [FNIDLE.](fnidle.md) 
  
|**Простаиваемая подпрограмма**|**Использование**|
|:-----|:-----|
|[ChangeIdleRoutine](changeidleroutine.md) <br/> |Изменяет характеристики зарегистрированной процедуры бездействия.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированную процедуру бездействия из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированную процедуру бездействия, не удаляя ее из системы MAPI.  <br/> |
|**FtgRegisterIdleRoutine** <br/> |Добавляет процедуру бездействия в систему MAPI с включением или без нее.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Выключает механизм бездействия MAPI для вызывающим приложением.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует механизм бездействия MAPI для вызывающим приложением.  <br/> |
   
**ChangeIdleRoutine,** **DeregisterIdleRoutine** и **EnableIdleRoutine** принимают в качестве входного параметра тег функции, возвращенный **FtgRegisterIdleRoutine.** 
  
Когда все задачи переднего плана для платформы простаивают, механизм бездействия MAPI вызывает процедуру простоя с наивысшим приоритетом, готовую к выполнению. Порядок вызовов между процедурами бездействия с одинаковым приоритетом не гарантируется. 
  
Ниже приводится пример использования флага FIRONOADJUSTMENT в _параметре iroIdle._ 
  
1. Зарегистрируйте процедуру простоя с 5-минутной задержкой.
    
2. Гибернайте или спящий режим компьютера через 1 минуту (4 минуты на стороне времени).
    
3. Возобновит работу компьютера через 10 минут.
    
По умолчанию без FIRONOADJUSTMENT вам все равно придется подождать 4 минуты, чтобы запустить процедуру. То есть ваш timer был настроен для того, чтобы разрешить, сколько времени компьютер заснул. Однако если передать FIRONOADJUSTMENT, процедура простоя будет немедленно запускаться, так как прошло более 5 минут реального времени.
  


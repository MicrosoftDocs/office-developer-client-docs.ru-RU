---
title: FtgRegisterIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.FtgRegisterIdleRoutine
api_type:
- COM
ms.assetid: 8d9557ba-7919-42c6-9e2f-f10214437d53
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0d3f24c41f2cfbd499d92e050c74da904dd4c377
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808516"
---
# <a name="ftgregisteridleroutine"></a>FtgRegisterIdleRoutine

**Относится к**: Outlook 
  
Добавляет [FNIDLE](fnidle.md) на основе функции простоя подпрограммы в систему MAPI. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализованный:  <br/> |MAPI  <br/> |
|Вызывается:  <br/> |Клиентские приложения и поставщиков услуг  <br/> |
   
```cpp
FTG FtgRegisterIdleRoutine(
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle
);
```

## <a name="parameters"></a>Параметры

_pfnIdle_
  
> [in] Указатель на простоя процедуры. 
    
_pvIdleParam_
  
> [in] Указатель на блок памяти, который ядро простоя следует передать в качестве параметра простоя процедуру при ее вызове. 
    
_priIdle_
  
> [in] Начальный приоритет для бездействующих процедуры. Возможных приоритетов для реализации процедуры больше или меньше, чем нулю, но не ноль. Ноль приоритет зарезервирован для событие пользователя, например, одним щелчком мыши или сообщение WM_PAINT. Приоритеты больше нуля представляют фоновых задач, которые имеют более высокий приоритет, чем событий пользователя и отправляется как часть стандартного цикла обработки сообщений Windows. Приоритеты меньше нуля представляют простоя задачи, на которых выполняется только во время простоя приема-передачи сообщений. Приведены примеры приоритетов: 1 для отправки переднего плана, 2 для вставки символ power Правка и 3 для загрузки новых сообщений.
    
_csecIdle_
  
> [in] Значение начального времени в сотые доли секунды, для использования в указания простоя стандартных параметров. Смысл значения начальное время, может изменяться в зависимости от того, что передается в параметре _iroIdle_ . Возможны следующие значения: 
    
  - Минимальный период бездействия со стороны пользователя, которое должно пройти перед MAPI простоя механизм вызывает простоя подпрограммы в первый раз, если флаг FIROWAIT установлен в _iroIdle_. По истечении этого времени простоя модуль может вызывать простоя процедуру при необходимости. 
    
  - Минимальный интервал между вызовами простоя процедуру, если флаг FIROINTERVAL установлен в _iroIdle_. 
    
_iroIdle_
  
> [in] Битовая маска, которая используется для задания начальных параметров для бездействующих подпрограммы флагов. Можно задать следующие флажки:
    
  FIRONOADJUSTMENT
    
  > Используйте этот флаг, чтобы указать, что таймер простоя процедуры не быть настроены для спящего режима или возобновления. Поведение по умолчанию без этот флаг является то, что время бездействия исключен при расчете затраченное время. Если передается FIRONOADJUSTMENT затем время бездействия включен при расчете времени, затраченного.
      
  FIRODISABLED
    
  > Простоя процедура должна быть отключена при регистрации. Действие по умолчанию — для включения простоя подпрограммы, когда он регистрирует **FtgRegisterIdleRoutine** . 
      
  FIROINTERVAL 
    
  > Время, указанное в параметре _csecIdle_ — это минимальный интервал между последовательными вызовами простоя процедуру. 
      
  FIROONCEONLY 
    
  > Устаревший. Не используйте.  
      
  FIROPERBLOCK 
    
  > Устаревший. Не используйте.  
      
  FIROWAIT 
    
  > Время, указанное в параметре _csecIdle_ — это минимальный период бездействия со стороны пользователя, которое должно пройти перед простоя подсистемы MAPI вызывает простоя подпрограмму в первый раз. По истечении этого времени простоя модуль может вызывать простоя процедуру при необходимости. 
    
## <a name="return-value"></a>������������ ��������

Функция **FtgRegisterIdleRoutine** возвращает функция тег, идентифицирующий простоя подпрограммы, который был добавлен в систему MAPI. Если **FtgRegisterIdleRoutine** невозможно зарегистрировать простоя подпрограммы для клиентского приложения или поставщик услуг, например из-за проблем с памяти, он возвращает значение NULL. 
  
## <a name="remarks"></a>Замечания

Следующие функции работы с простоя подсистемы MAPI и простоя процедуры на основании прототипа функции [FNIDLE](fnidle.md) . 
  
|**Функция простоя процедуры**|**Использование**|
|:-----|:-----|
|[ChangeIdleRoutine](changeidleroutine.md) <br/> |Изменение характеристик зарегистрированных простоя процедуры.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированные простоя процедуру из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированных простоя подпрограмму без его удаления из системы MAPI.  <br/> |
|**FtgRegisterIdleRoutine** <br/> |Добавляет простоя подпрограммы система MAPI, независимо от его включение.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Завершает работу обработчика бездействия MAPI для вызывающего приложения.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует обработчик простоя MAPI для вызывающего приложения.  <br/> |
   
**ChangeIdleRoutine**, **DeregisterIdleRoutine**и **EnableIdleRoutine** принимают в качестве входного параметра, функция тег возвращаемых **FtgRegisterIdleRoutine**. 
  
При бездействии все задачи переднего плана для платформы, механизм простоя MAPI вызывает наивысший приоритет простоя подпрограммы готов к выполнению. Нет никаких гарантий вызова порядок простоя процедуры одинаковый приоритет. 
  
Ниже приведен пример использования флага FIRONOADJUSTMENT с помощью параметра _iroIdle_ . 
  
1. Регистрация простоя подпрограммы с задержкой 5 минут.
    
2. Спящий режим/спящий компьютер после 1 минута (4 минуты остаются на таймер).
    
3. Возобновление компьютере 10 минут.
    
Поведение по умолчанию, без FIRONOADJUSTMENT, является то, что вы по-прежнему ожидания 4 несколько минут для процедуру для запуска. То есть таймера было изменено о предоставлении как долго компьютер был находится в спящем режиме. Тем не менее если передать FIRONOADJUSTMENT простоя подпрограммы будет выполняться сразу же из-за истечения более 5 минут режиме реального времени.
  


---
title: IMAPISupportStoreLogoffTransports
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.StoreLogoffTransports
api_type:
- COM
ms.assetid: f21fba96-c5ca-4d41-9b93-c7955ab7327f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b77a58b04e5cdeee7a9e84051a6ed287c1a20115
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22578313"
---
# <a name="imapisupportstorelogofftransports"></a>IMAPISupport::StoreLogoffTransports

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Запрашивает надлежащей выпуске хранилища сообщений.
  
```cpp
HRESULT StoreLogoffTransports(
ULONG FAR * lpulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpulFlags_
  
> [in, out] Битовая маска флаги, определяющее, как выполняется выход из системы хранения сообщений. На входе все флаги для этого параметра являются взаимоисключающими; только один из следующих флагов можно установить на вызов.
    
LOGOFF_ABORT 
  
> Какие-либо действия поставщика транспорта для этого хранилища должна быть прекращена до выхода из системы. Управление возвращается клиенту после остановки операции и диспетчер очереди MAPI вышел хранилище. Если какие-либо действия транспорта с удалением, выход из системы не происходит и не изменяется поведение поставщика транспорта или диспетчер очереди MAPI. Если в данный момент не выполняет никаких действий, диспетчер очереди MAPI освобождает хранилище. 
    
LOGOFF_NO_WAIT 
  
> Диспетчер очереди MAPI следует освобождение хранилище и возврата в клиенте сразу отправляется в конце концов исходящей почты, Готово к отправке. Если хранилище сообщений по умолчанию папки "Входящие", полученного сообщения в процесс и затем отключена дальнейший приема. 
    
LOGOFF_ORDERLY 
  
> Диспетчер очереди MAPI должен освобождать хранилище и возврата в клиент сразу же после все ожидающие сообщения будут завершены обработки. Новые сообщения будут обрабатываться. 
    
LOGOFF_PURGE 
  
> Работает так же, как флаг LOGOFF_NO_WAIT. После завершения флаг LOGOFF_PURGE возвращает управление вызывающего абонента. 
    
LOGOFF_QUIET 
  
> Выход из системы появляется, если какие-либо действия поставщика транспорта, предпринимаются. Тип действия с удалением возвращается как флаг на выходных данных.
    
    On output, MAPI spooler can return one or more of the following flags:
    
LOGOFF_COMPLETE 
  
> Выход из системы можно выполнить. Все ресурсы, связанные с хранилищем выпущенные и объект является недействительным. Диспетчер очереди MAPI выполнил или будет выполнять все запросы. На этом этапе следует вызывать только метод **функции IUnknown::Release** хранилища сообщений. 
    
LOGOFF_INBOUND 
  
> Сообщение в настоящее время поступают в хранилище данных из одного или нескольких поставщиков транспорта. 
    
LOGOFF_OUTBOUND 
  
> В настоящее время отправляется из хранилища с одним или несколькими поставщиками транспорта. 
    
LOGOFF_OUTBOUND_QUEUE 
  
> В настоящий момент в очереди исходящих сообщений для хранилища сообщений.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Процедура logoff прошла успешно.
    
## <a name="remarks"></a>Замечания

Метод **IMAPISupport::StoreLogoffTransports** реализуется для объектов поддержки поставщика хранилища сообщений. Поставщики хранилища сообщений вызов **StoreLogoffTransports** для предоставления клиентским приложениям управлять тем, как закрытие действие поставщика маркеров транспорта MAPI в качестве хранилища сообщений. 
  
Если другим процессом хранилища выходите открыть для одного профиля, MAPI игнорирует вызов **StoreLogoffTransports** и возвращает флаг LOGOFF_COMPLETE с помощью параметра _lpulFlags_ . 
  
Поведение поставщика хранилища после возврата из **StoreLogoffTransports** должен быть основан на значение _lpulFlags_, который указывает на состояние системы и передает клиента инструкции по поведение выход из системы. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

 **StoreLogoffTransports** обычно вызван метод [IMsgStore::StoreLogoff](imsgstore-storelogoff.md) поставщика хранилища. Тем не менее он может вызываться также из метода **функции IUnknown::Release** хранилища сообщений. Реализуйте метод **Release** для хранения сообщений, вы можете проверить ли вызов **StoreLogoffTransports** , выполненных. Если звонок не произошло, вызовите **StoreLogoffTransports** с установленным флагом LOGOFF_ABORT. 
  
Параметр _lpulFlags_ имеет значение флаг, указывающий, как клиент требует хранилище сообщений, чтобы завершить работу. Определение подходящей настройки для _ulFlags_ на основе параметра соответствующий параметр в вызове **StoreLogoff**. То есть клиент вызванный метод **StoreLogoff** с _ulFlags_ , задайте значение LOGOFF_ORDERLY, необходимо вызвать **StoreLogoffTransports** с _ulFlags_ , задайте значение LOGOFF_ORDERLY. 
  
Дополнительные сведения о процессе выхода из системы хранения сообщений можно [Завершает работу сообщение поставщика хранилища](shutting-down-a-message-store-provider.md).
  
## <a name="see-also"></a>См. также



[IMsgStore::StoreLogoff](imsgstore-storelogoff.md)
  
[IXPLogon::FlushQueues](ixplogon-flushqueues.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


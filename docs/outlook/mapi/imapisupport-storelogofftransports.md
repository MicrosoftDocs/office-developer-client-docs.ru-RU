---
title: Имаписуппортсторелогоффтранспортс
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.StoreLogoffTransports
api_type:
- COM
ms.assetid: f21fba96-c5ca-4d41-9b93-c7955ab7327f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 30c91ec7a5a28b0c270da5223a2a245fb504d8c5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421384"
---
# <a name="imapisupportstorelogofftransports"></a>IMAPISupport::StoreLogoffTransports

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
ЗаПрашивает выпуск хранилища сообщений по расрядку.
  
```cpp
HRESULT StoreLogoffTransports(
ULONG FAR * lpulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпулфлагс_
  
> [вход, выход] Битовая маска флагов, определяющих способ выхода из хранилища сообщений. Во входных данных все флаги этого параметра являются взаимоисключающими; для каждого вызова можно задать только один из следующих флагов:
    
ЛОГОФФ_АБОРТ 
  
> Перед выходом из системы необходимо остановить все действия поставщика транспорта для этого хранилища. Управление возвращается клиенту после того, как действие остановлено, а диспетчер очереди MAPI вышел из хранилища. Если выполняется какое-либо действие транспорта, выход из системы не выполняется, и не происходит никаких изменений в работе диспетчера очереди MAPI или поставщика транспорта. Если в настоящее время нет действий, то диспетчер очереди MAPI освобождает хранилище. 
    
ЛОГОФФ_НО_ВАИТ 
  
> Диспетчер очереди MAPI должен освобождать хранилище и возвращать его клиенту сразу после отправки всей исходящей почты, готовой к отправке. Если в хранилище сообщений есть папка "Входящие" по умолчанию, то будет получено любое сообщение в процессе, а затем дальнейший прием отключен. 
    
ЛОГОФФ_ОРДЕРЛИ 
  
> Диспетчер очереди MAPI должен освободить хранилище и вернуть управление клиенту сразу после обработки всех ожидающих сообщений. Новые сообщения не обрабатываются. 
    
ЛОГОФФ_ПУРЖЕ 
  
> Работает так же, как и флаг ЛОГОФФ_НО_ВАИТ. Флаг ЛОГОФФ_ПУРЖЕ возвращает управление вызывающей стороне после завершения. 
    
ЛОГОФФ_КУИЕТ 
  
> Если выполняется какое-либо действие поставщика транспорта, выход из системы не должен выполняться. Тип выполняемого действия возвращается в виде флага в выходных данных.
    
    On output, MAPI spooler can return one or more of the following flags:
    
ЛОГОФФ_КОМПЛЕТЕ 
  
> Может завершиться выход из системы. Все ресурсы, связанные с хранилищем, были выпущены, а объект является недействительным. Очередь MAPI выполнила или выполнит все запросы. В этой точке должен быть вызван только метод **IUnknown:: Release** хранилища сообщений. 
    
ЛОГОФФ_ИНБАУНД 
  
> В данный момент сообщение поступает в хранилище от одного или нескольких поставщиков транспорта. 
    
ЛОГОФФ_АУТБАУНД 
  
> В данный момент сообщение отправляется из хранилища одним или несколькими поставщиками транспорта. 
    
ЛОГОФФ_АУТБАУНД_КУЕУЕ 
  
> В данный момент в очереди исходящих сообщений для этого хранилища есть сообщения.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Процедура выхода выполнена успешно.
    
## <a name="remarks"></a>Примечания

Метод **имаписуппорт:: сторелогоффтранспортс** реализован для объектов поддержки поставщика хранилища сообщений. Поставщики хранилищ сообщений вызывают **сторелогоффтранспортс** , чтобы предоставить клиентским приложениям возможность управления процессом обработки службой MAPI действия поставщика транспорта в случае закрытия хранилища сообщений. 
  
Если для одного и того же профиля другой процесс отключился от магазина, MAPI игнорирует вызов **сторелогоффтранспортс** и ВОЗВРАЩАЕТ флаг логофф_комплете в параметре _лпулфлагс_ . 
  
Поведение поставщика услуг хранения, следующего за возвратом из **сторелогоффтранспортс** , должно основываться на значении _лпулфлагс_, которое указывает состояние системы и передает клиентские инструкции для выхода из системы. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

 **Сторелогоффтранспортс** обычно вызывается из метода [IMsgStore:: сторелогофф](imsgstore-storelogoff.md) поставщика хранилища. Однако он также может вызываться из метода **IUnknown:: Release** хранилища сообщений. Реализуйте метод **Release** хранилища сообщений, чтобы можно было проверить, не вызван ли вызов **сторелогоффтранспортс** . Если вызов не выполнялся, вызовите **сторелогоффтранспортс** с установленным флагом логофф_аборт. 
  
В параметре _лпулфлагс_ задается флаг, указывающий, как клиенту требуется завершение работы хранилища сообщений. Определите соответствующий параметр для _ulFlags_ в соответствии с параметром соответствующего параметра в вызове **сторелогофф**. То есть, если клиент, вызываемый методом **сторелогофф** с _ulFlags_ , имеет значение Логофф_ордерли, необходимо вызвать **сторелогоффтранспортс** с _ulFlags_ , равным логофф_ордерли. 
  
Дополнительные сведения о процессе выхода из хранилища сообщений приведены в разделе [Завершение работы поставщика хранилища сообщений](shutting-down-a-message-store-provider.md).
  
## <a name="see-also"></a>См. также



[IMsgStore::StoreLogoff](imsgstore-storelogoff.md)
  
[IXPLogon::FlushQueues](ixplogon-flushqueues.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


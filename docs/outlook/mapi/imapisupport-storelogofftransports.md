---
title: IMAPISupportStoreLogoffTransports
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.StoreLogoffTransports
api_type:
- COM
ms.assetid: f21fba96-c5ca-4d41-9b93-c7955ab7327f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 30c91ec7a5a28b0c270da5223a2a245fb504d8c5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421384"
---
# <a name="imapisupportstorelogofftransports"></a>IMAPISupport::StoreLogoffTransports

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Запрашивает упорядоченный выпуск хранения сообщений.
  
```cpp
HRESULT StoreLogoffTransports(
ULONG FAR * lpulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpulFlags_
  
> [in, out] Битоваяmas флагов, которая управляет процессом входа в хранилище сообщений. При вводе все флаги для этого параметра являются взаимоисключающими; Для каждого вызова можно установить только один из следующих флагов:
    
LOGOFF_ABORT 
  
> Все действия поставщика транспорта для этого магазина должны быть остановлены перед тем, как выйти из системы. Управление возвращается клиенту после того, как действие остановлено, и пулер MAPI выошел из магазина. Если какие-либо действия транспорта происходят, то выйдите из системы, а поведение поставщика транспорта или пула MAPI не изменится. Если в настоящее время действий нет, то пульщик MAPI освобождает хранилище. 
    
LOGOFF_NO_WAIT 
  
> Пулер MAPI должен освободить хранилище и вернуть управление клиенту сразу после того, как будет отправлена вся готовая к рассылке почта. Если в хранилище сообщений есть почта по умолчанию, то получается любое сообщение, которое находится в процессе, а затем дополнительная приемная будет отключена. 
    
LOGOFF_ORDERLY 
  
> Пулер MAPI должен освободить хранилище и вернуть управление клиенту сразу после завершения обработки ожидающих сообщений. Новые сообщения не должны обрабатываться. 
    
LOGOFF_PURGE 
  
> Работает так же, как флаг LOGOFF_NO_WAIT. Флаг LOGOFF_PURGE возвращает управление вызываемой по завершении. 
    
LOGOFF_QUIET 
  
> Вход не должен происходить, если происходит какой-либо из действий поставщика транспорта. Тип действия, которое происходит, возвращается в качестве флага при выходе.
    
    On output, MAPI spooler can return one or more of the following flags:
    
LOGOFF_COMPLETE 
  
> Выйдите из нее. Все ресурсы, связанные с хранилищем, освобождены, а объект стал недействительным. Пулер MAPI выполнил или выполнит все запросы. На этом этапе должен быть вызван только метод **IUnknown::Release** в хранилище сообщений. 
    
LOGOFF_INBOUND 
  
> В настоящее время в хранилище приходит сообщение от одного или более поставщиков транспорта. 
    
LOGOFF_OUTBOUND 
  
> В настоящее время сообщение отправляется из магазина одним или более поставщиками транспорта. 
    
LOGOFF_OUTBOUND_QUEUE 
  
> В настоящее время в очереди исходящие сообщения для магазина.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Процедура logoff прошла успешно.
    
## <a name="remarks"></a>Примечания

Метод **IMAPISupport::StoreLogoffTransports** реализован для объектов поддержки поставщика store сообщений. Поставщики store сообщений звонят **в StoreLogoffTransports,** чтобы предоставить клиентские приложениям некоторый контроль над тем, как MAPI обрабатывает действия поставщиков транспорта, когда хранилище сообщений закрывается. 
  
Если для другого процесса необходимо отключить хранилище для того же профиля, MAPI игнорирует вызов **StoreLogoffTransports** и возвращает флаг LOGOFF_COMPLETE в _параметре lpulFlags._ 
  
Поведение поставщика магазина после возврата **из StoreLogoffTransports** должно основываться на значении  _lpulFlags,_ которое указывает состояние системы и передает клиентские инструкции для поведения при выйдите из системы. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

 **StoreLogoffTransports** обычно вызван из метода [IMsgStore::StoreLogoff](imsgstore-storelogoff.md) поставщика магазина. Однако его также можно использовать из метода **IUnknown::Release** в хранилище сообщений. **Внедрите метод Release** для вашего хранения сообщений, чтобы можно было проверить, был ли выполнен вызов **StoreLogoffTransports.** Если вызов не произошел, вызовите **StoreLogoffTransports** с установленным LOGOFF_ABORT флагом. 
  
Для  _параметра lpulFlags_ установлен флаг, который указывает, как клиент требует, чтобы хранилище сообщений было закрыто. Определите соответствующий параметр _для ulFlags_ на основе параметра соответствующего параметра в вызове **StoreLogoff.** То есть, если клиент называется **методом StoreLogoff,** для  _ulFlags_ установлено LOGOFF_ORDERLY, следует вызвать **StoreLogoffTransports,** для  _ulFlags_ установлено LOGOFF_ORDERLY. 
  
Дополнительные сведения о процессе выключения из магазина сообщений см. в записи ["Завершение работы поставщика store сообщений".](shutting-down-a-message-store-provider.md)
  
## <a name="see-also"></a>См. также



[IMsgStore::StoreLogoff](imsgstore-storelogoff.md)
  
[IXPLogon::FlushQueues](ixplogon-flushqueues.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


---
title: Обзор диспетчера очереди MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5866b202-883e-454e-aeb1-61526c43dae9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5e4bd4f6038db3dbb33ec3511d953448fea7a6c2
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809845"
---
# <a name="mapi-spooler-overview"></a>Обзор диспетчера очереди MAPI
  
**Относится к**: Outlook 
  
Диспетчер очереди MAPI — это функция Microsoft Office Outlook процесс, отвечающий за отправку сообщений в и получение сообщений из систем обмена сообщениями. Диспетчер очереди MAPI играет важнейшую роль в сообщении и доставки. При недоступности системы обмена сообщениями, диспетчер очереди MAPI хранятся сообщения и автоматически пересылает их в дальнейшем. Эта возможность содержатся на в или отправки данных в случае необходимости называется хранения и пересылки, критическим компонентом в средах, где удаленные подключения общих и сетевого трафика высокой. Диспетчер очереди MAPI работает как в фоновом потоке в Outlook.
  
Диспетчер очереди MAPI имеет дополнительные обязанности, связанные с рассылки сообщений. Эти дополнительные операции относятся следующие:
  
- Позволяет отслеживать их типы получателей, которые обрабатываются поставщиков определенного транспорта.
    
- Время доставки новое сообщение, уведомляющее о клиентского приложения.
    
- Предварительная обработка и последующая обработка вызова сообщение.
    
- Создание отчетов, которые указывают, доставки сообщения произошла.
    
- Поддержка состояния на обработанные получателей.
    
На следующем рисунке показана на высоком уровне потоки сообщение от клиента к системе обмена сообщениями.
  
**Поток обработки исходящих сообщений**
  
![Исходящий поток сообщений] (media/amapi_46.gif "Исходящий поток сообщений")
  
Пользователь клиентское приложение отправляет сообщение для одного или нескольких получателей. Сообщение хранилища поставщика инициирует процесс отправки форматирования сообщения с Дополнительные сведения, необходимые для передачи.
  
Диспетчер очереди MAPI получает сообщение для обработки при возникновении любого из следующих условий:
  
- Поставщик хранения сообщения не является тесно связанным с помощью поставщика транспорта.
    
- Сообщение необходимо предварительной обработки.
    
- Хранение сообщений и транспорта тесно поставщика, но они не могут обрабатывать всех получателей, которым адресовано сообщение.
    
Если диспетчер очереди MAPI получает сообщение, выполняет все необходимые предварительной обработки и доставляет сообщение в поставщике соответствующий транспортный протокол. Поставщик транспорта обеспечивает сообщение к его систем обмена сообщениями, который отправляет его получателю.
  
С помощью входящих сообщений потока изменен на обратный. Поставщика транспорта получает сообщение из его систем обмена сообщениями и уведомляет диспетчер очереди MAPI. Очереди выполняет все необходимые постобработку и информирует поставщика хранилища сообщений, что пришло новое сообщение. Это уведомление вызывает клиента, чтобы обновить его отображение сообщений, позволяя пользователям для чтения нового сообщения.
  
## <a name="see-also"></a>См. также

- [Функции MAPI и архитектура](mapi-features-and-architecture.md)


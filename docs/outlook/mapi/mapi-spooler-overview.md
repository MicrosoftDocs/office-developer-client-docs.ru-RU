---
title: Общие сведения о системе буферизации MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5866b202-883e-454e-aeb1-61526c43dae9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 162957ea17b5a82d4da68340e971d328c85cd9f7
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432718"
---
# <a name="mapi-spooler-overview"></a>Общие сведения о системе буферизации MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Spooler MAPI — это функция процесса Microsoft Office Outlook, который отвечает за отправку сообщений и получение сообщений из системы обмена сообщениями. Шпалер MAPI играет жизненно важную роль в получении и доставке сообщений. Когда система обмена сообщениями недоступна, пульпер MAPI сохраняет сообщения и автоматически передает их в более позднее время. Эта возможность хранения или отправки данных при необходимости называется хранилищем и перенаправками, что является важной функцией в средах, где удаленные подключения являются общими, а сетевой трафик — высоким. Шпалер MAPI выполняется в качестве фонового потока в Outlook.
  
У шпалеров MAPI есть дополнительные обязанности, связанные с распространением сообщений. Эти дополнительные обязанности включают следующие:
  
- Отслеживание типов получателей, которые обрабатываются конкретными поставщиками транспорта.
    
- Информирование клиентского приложения при доставке нового сообщения.
    
- Обращение к предварительной и постпроцессинговой подготовке сообщений.
    
- Создание отчетов, которые указывают на то, что произошла доставка сообщений.
    
- Сохранение состояния обрабатываемых получателей.
    
На следующем рисунке на высоком уровне показано, как сообщение перетекает из клиента в систему обмена сообщениями.
  
**Поток обработки исходящих сообщений**
  
![Исходяние потока исходяющих](media/amapi_46.gif "сообщений")
  
Пользователь клиентского приложения отправляет сообщение одному или более получателям. Поставщик магазина сообщений инициирует процесс отправки, форматирование сообщения с помощью дополнительных сведений, необходимых для передачи.
  
Spooler MAPI получает сообщение для обработки, если возникает любое из следующих условий:
  
- Поставщик хранения сообщений не тесно совмещение с поставщиком транспорта.
    
- Сообщение требует предварительной подготовки.
    
- Хранилище сообщений и поставщик транспорта тесно совмещение, но они не могут обрабатывать всех получателей, к которым адресовано сообщение.
    
Если шпалер MAPI получает сообщение, он выполняет все необходимые препроцессы и передает сообщение соответствующему поставщику транспорта. Поставщик транспорта передает сообщение своей системе обмена сообщениями, которая отправляет его своему получателю.
  
При входящих сообщениях поток будет обратным. Поставщик транспорта получает сообщение из своей системы обмена сообщениями и сообщает о spooler MAPI. Spooler выполняет все необходимые постпроцессы и сообщает поставщику магазина сообщений о том, что пришло новое сообщение. Это уведомление заставляет клиента обновить отображение сообщений, что позволяет пользователю читать новое сообщение.
  
## <a name="see-also"></a>См. также

- [Функции и архитектура MAPI](mapi-features-and-architecture.md)


---
title: Открытие записей адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 017a62c0-49c6-47fb-acce-db58e6bb9cc5
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6ebd6009700742e9b1159bc95ff0496c423e512c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422161"
---
# <a name="opening-address-book-entries"></a>Открытие записей адресной книги

**Относится к**: Outlook 2013 | Outlook 2016 
  
Когда клиент или поставщик запросили открыть один из объектов, MAPI вызывает метод [иаблогон:: OpenEntry](iablogon-openentry.md) поставщика. MAPI определяет, что идентификатор записи, представляющий целевой объект, принадлежит поставщику, изучая часть [мапиуид](mapiuid.md) идентификатора записи и сопоставляя его с **мапиуид** , зарегистрированным в вызове **имаписуппорт:: сетпровидеруид**. Затем MAPI вызывает метод **OpenEntry** . Поставщик должен ответить, получая соответствующий объект — контейнер, список рассылки или пользователя обмена сообщениями. 
  
Идентификатор записи NULL указывает на запрос на открытие корневого контейнера поставщика адресной книги. Клиенты открывают корневой контейнер для доступа к своей таблице иерархии и его получателям. Поставщики адресных книг, которые предоставляют только шаблоны для создания одноразовых получателей, не поддерживают вызов **OpenEntry** для корневого контейнера. 
  
### <a name="to-implement-iablogonopenentry"></a>Реализация Иаблогон:: OpenEntry
  
1. Убедитесь, что идентификатор записи является допустимым идентификатором, поддерживаемым поставщиком. Если он не является допустимым идентификатором записи, возвращается MAPI_E_INVALID_ENTRYID. 
    
2. Проверьте флаг, который передается с параметром _ulFlags_ . Если служба MAPI передается в MAPI_MODIFY, а поставщик не разрешает изменять его объекты, то при отказе и возврате значения ошибки MAPI_E_ACCESS_DENIED. 
    
3. Убедитесь, что интерфейс, запрашиваемый в параметре _лпинтерфаце_ , действителен для типа объекта, который запросил открыть поставщик. Если передается недопустимый параметр, происходит сбой и возвращается MAPI_E_INTERFACE_NOT_SUPPORTED значение ошибки. 
    
4. Если параметр _кбентрид_ равен нулю, это запрос на открытие корневого контейнера поставщика. Создайте корневой контейнер и возвратите указатель на его реализацию интерфейса **иабконтаинер** . 
    
5. Если поставщик реализует несколько объектов входа, каждый со своим зарегистрированным **мапиуид**, сопоставьте **мапиуид** , содержащиеся в идентификаторе записи, с соответствующим объектом logon. 
    
6. Определите тип объекта, который представляет идентификатор записи: пользователь обмена сообщениями, список рассылки или контейнер, принадлежащий поставщику или пользователю с одноразовым обменом сообщениями, чтобы можно было задать значение для параметра _лпулобжекттипе_ . 
    
7. Создайте объект соответствующего типа и задайте следующие основные свойства:
    
    - **PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))
    - **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))
    - **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))
    - **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))
    
8. Рассчитайте **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) и **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) из сведений в идентификаторе записи.
    
9. Возвращает указатель на реализацию интерфейса для объекта. 
    


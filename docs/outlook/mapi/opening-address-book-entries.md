---
title: Открытие адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 017a62c0-49c6-47fb-acce-db58e6bb9cc5
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: cd86b9cc86f30aac75b732b97208933de4d336e9
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22566434"
---
# <a name="opening-address-book-entries"></a>Открытие адресной книги

**Применимо к**: Outlook 2013 | Outlook 2016 
  
Когда клиента или поставщика запросил один из объектов открываются MAPI вызывает метод [IABLogon::OpenEntry](iablogon-openentry.md) ваш поставщик. MAPI определяет, что запись идентификатор, представляющий целевой объект принадлежит к поставщику, проверяя [MAPIUID](mapiuid.md) часть идентификатор записи и сопоставление его **MAPIUID** , ваш поставщик зарегистрирован в вызове ** IMAPISupport::SetProviderUID**. MAPI вызывает метод **OpenEntry** . Поставщик должен отвечать путем получения соответствующего объекта — контейнер, список рассылки или обмена мгновенными сообщениями пользователя. 
  
Идентификатор записи NULL указывает запрос для открытия контейнера корневым поставщик адресной книги. Клиенты откройте корневой контейнер для доступа к таблице его иерархии и его получателей. Поставщиками адресных книг, которые только предоставляют шаблоны для создания одноразовых получатели не поддерживают вызова **OpenEntry** для корневого контейнера. 
  
### <a name="to-implement-iablogonopenentry"></a>Для реализации IABLogon::OpenEntry
  
1. Убедитесь, что идентификатор записи допустимый идентификатор, ваш поставщик поддерживает. Если не является допустимым идентификатором, возвратите MAPI_E_INVALID_ENTRYID. 
    
2. Проверьте флаг, который передается с помощью параметра _ulFlags_ . Если истекло MAPI в MAPI_MODIFY и ваш поставщик не позволяет его объекты, которую нужно изменить, давать сбой и возвращать значение MAPI_E_ACCESS_DENIED ошибки. 
    
3. Убедитесь, что на интерфейс, запрошенный в параметре _lpInterface_ допустимый тип объекта, который запросил у поставщика для открытия. Если переданную недопустимый параметр давать сбой и возвращать значение MAPI_E_INTERFACE_NOT_SUPPORTED ошибки. 
    
4. Если параметр _cbEntryID_ равно нулю, это запроса на открытие ваш поставщик корневого контейнера. Создание корневого контейнера и возвращает указатель на его реализация интерфейса **IABContainer** . 
    
5. Если ваш поставщик реализует несколько объектов входа в систему, каждый со своим зарегистрирован **MAPIUID**, карты **MAPIUID** содержащимися в идентификатор записи с помощью объекта соответствующие входа в систему. 
    
6. Определить, какой тип объекта представляет идентификатор записи: обмена сообщениями пользователя, список рассылки или контейнера, относящегося к поставщику или одноразовых обмена сообщениями пользователя или список рассылки, соответствующее значение можно использовать для _lpulObjectType_ параметр. 
    
7. Создание объекта соответствующего типа и задайте следующие основные свойства:
    
    - **PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))
    - **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))
    - **PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))
    - **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))
    
8. Вычисление **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md)) и **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) на основании сведений в идентификатор записи.
    
9. Возвращает указатель для реализации интерфейса для объекта. 
    


---
title: Открытие записей адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 017a62c0-49c6-47fb-acce-db58e6bb9cc5
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6ebd6009700742e9b1159bc95ff0496c423e512c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422161"
---
# <a name="opening-address-book-entries"></a>Открытие записей адресной книги

**Относится к**: Outlook 2013 | Outlook 2016 
  
Когда клиент или поставщик запрашивает открытие одного из ваших объектов, MAPI вызывает метод [IABLogon::OpenEntry](iablogon-openentry.md) поставщика. MAPI определяет, что идентификатор записи, представляющий целевой объект, принадлежит поставщику, изучив часть [MAPIUID](mapiuid.md) идентификатора записи и сопосмотрев ее с **MAPIUID,** зарегистрированным поставщиком в вызове **IMAPISupport::SetProviderUID.** Затем MAPI вызывает метод **OpenEntry.** Поставщик должен ответить, запросив соответствующий объект — контейнер, список рассылки или пользователя системы обмена сообщениями. 
  
Идентификатор записи NULL указывает запрос на открытие корневого контейнера поставщика адресной книги. Клиенты открывают корневой контейнер, чтобы получить доступ к его таблице иерархии и ее получателям. Поставщики адресных книг, которые только поставляют шаблоны для создания разных получателей, не поддерживают вызов **OpenEntry** для корневого контейнера. 
  
### <a name="to-implement-iablogonopenentry"></a>Реализация IABLogon::OpenEntry
  
1. Убедитесь, что идентификатор записи является допустимым идентификатором, поддерживаемым поставщиком. Если он не является допустимым идентификатором записи, MAPI_E_INVALID_ENTRYID. 
    
2. Проверьте флаг, переданный с помощью параметра _ulFlags._ Если MAPI передан в MAPI_MODIFY поставщик не разрешает изменять его объекты, сбой и возврат значения ошибки MAPI_E_ACCESS_DENIED ошибки. 
    
3. Убедитесь, что интерфейс, запрашиваемой в  _параметре lpInterface,_ действителен для типа объекта, который был предложен открыть поставщику. Если передан недопустимый параметр, сбой и возврат MAPI_E_INTERFACE_NOT_SUPPORTED ошибки. 
    
4. Если параметр  _cbEntryID имеет_ нулевое значение, это запрос на открытие корневого контейнера поставщика. Создайте корневой контейнер и вернетесь указатель на реализацию интерфейса **IABContainer.** 
    
5. Если поставщик реализует несколько объектов входа, каждый из которых имеет собственный **зарегистрированный MAPIUID,** соединен **mapIUID,** содержащийся в идентификаторе записи, с соответствующим объектом входа. 
    
6. Определите тип объекта, который представляет идентификатор записи: пользователь системы обмена сообщениями, список рассылки или контейнер, принадлежащий поставщику, или одноразовый пользователь или список рассылки сообщений, чтобы можно было установить соответствующее значение для параметра _lpulObjectType._ 
    
7. Создайте объект соответствующего типа и установите следующие базовые свойства:
    
    - **PR_DISPLAY_TYPE** ([PidTagDisplayType)](pidtagdisplaytype-canonical-property.md)
    - **PR_ENTRYID** ([PidTagEntryId)](pidtagentryid-canonical-property.md)
    - **PR_OBJECT_TYPE** ([PidTagObjectType)](pidtagobjecttype-canonical-property.md)
    - **PR_ADDRTYPE** ([PidTagAddressType)](pidtagaddresstype-canonical-property.md)
    
8. Вычисляет **PR_EMAIL_ADDRESS** ([PidTagEmailAddress)](pidtagemailaddress-canonical-property.md) **и** PR_DISPLAY_NAME ([PidTagDisplayName)](pidtagdisplayname-canonical-property.md)из сведений в идентификаторе записи.
    
9. Возвращает указатель на реализацию интерфейса для объекта. 
    


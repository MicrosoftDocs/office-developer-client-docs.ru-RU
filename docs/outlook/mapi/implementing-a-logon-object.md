---
title: Реализация объекта logon
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 41e5c88c-d79d-4e9f-81f4-c4365cfaa15d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f9d77313012c2d133dc9352707ebc5e0c69c9973
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433047"
---
# <a name="implementing-a-logon-object"></a>Реализация объекта logon

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каждая адресная книга, хранилище сообщений и поставщик транспорта создают экземпляр объекта logon в рамках своей реализации [иабпровидер:: logon](iabprovider-logon.md), [Функцииimsprovider:: logon](imsprovider-logon.md)или [иксппровидер:: транспортлогон](ixpprovider-transportlogon.md). Объекты входа реализуют методы, которые помогают отправлять запросы клиентов службы MAPI. В зависимости от типа поставщика услуг ваш объект входа будет поддерживать один из следующих интерфейсов. 
  
|**Интерфейс объекта logon**|**Поставщик услуг**|
|:-----|:-----|
|[IABLogon : IUnknown](iablogoniunknown.md) <br/> |Поставщик адресных книг  <br/> |
|[IMSLogon : IUnknown](imslogoniunknown.md) <br/> |Поставщик хранилища сообщений  <br/> |
|[IXPLogon : IUnknown](ixplogoniunknown.md) <br/> |Поставщик транспорта  <br/> |
   
Службы адресных книг и хранилищ сообщений реализуют следующие функции в своих объектах входа:
  
- Поддержка уведомлений о событиях (**Advise** методы advise **и unadvise)** . Обзор уведомления о событиях представлен [в статье уведомление о событии в MAPI](event-notification-in-mapi.md). Дополнительные сведения о поддержке уведомлений в объекте logon содержатся в разделе [Поддержка уведомления о событиях](supporting-event-notification.md). 
    
- Сравнение идентификатора записи (метод**метод compareentryids** ). Общие сведения об идентификаторах записей можно узнать в статье [идентификаторы записей MAPI](mapi-entry-identifiers.md). Дополнительные сведения о сравнении идентификаторов записей в методе **метод compareentryids** объекта logon см в разделе [Поддержка доступа к объектам и сравнение](supporting-object-access-and-comparison.md).
    
- Доступ к дополнительным сведениям об ошибке (метод**GetLastError** ). Более подробную информацию об обработке ошибок в MAPI можно узнать [в статье обработка ошибок в MAPI](error-handling-in-mapi.md). 
    
- Доступ к объектам, реализуемым поставщиком услуг (методом**OpenEntry** ). Дополнительные сведения см в разделе [Поддержка доступа к объектам и сравнение](supporting-object-access-and-comparison.md).
    
- Доступ к объекту Status (метод**опенстатусентри** ). Общие сведения об объектах состояния приведены в разделе [объекты состояния MAPI](mapi-status-objects.md). Для получения подробных сведений о реализации объекта Status ознакомьтесь с [реализацией объекта Status](status-object-implementation.md).
    
- Процесс выхода из системы (метод**logoff** ). Для получения дополнительных сведений обратитесь [к разделу завершение работы поставщика услуг](shutting-down-a-service-provider.md).
    
Если ваш поставщик является поставщиком адресной книги, вы также реализуете следующие методы и связанные с ней функции:
  
- [Иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) для предоставления списка шаблонов, которые поддерживаются для создания новых получателей. Дополнительные сведения см. в разделе [одноразовые таблицы](one-off-tables.md) или [Реализация одноразовой таблицы поставщика](implementing-a-provider-one-off-table.md).
    
- [Иаблогон:: опентемплатеид](iablogon-opentemplateid.md) для предоставления доступа к реализации получателя, данные которого хранятся в поставщике адресной книги узла. Для получения дополнительных сведений обратитесь к разделу "работа в [качестве поставщика внешних адресных книг](acting-as-a-foreign-address-book-provider.md)". 
    
- [Иаблогон::P репаререЦипс](iablogon-preparerecips.md) , чтобы обеспечить доступность соответствующих свойств для всех получателей в списке получателей. Дополнительные сведения см. в статье [иаблогон::P репаререЦипс](iablogon-preparerecips.md). 
    
Объект входа поставщика транспорта, который реализует [иксплогон: IUnknown](ixplogoniunknown.md), сильно отличается от объектов входа, реализованных другими типами поставщиков услуг. У него есть только две функции, общие с другими объектами входа: доступ к объекту Status через метод [иксплогон:: опенстатусентри](ixplogon-openstatusentry.md) и операцию выхода из системы с помощью метода [Иксплогон:: транспортлогофф](ixplogon-transportlogoff.md) . Поставщики транспорта реализуют следующие уникальные функции в своих объектах входа: 
  
- Регистрация типов адресов ([иксплогон:: метод аддресстипес](ixplogon-addresstypes.md) ). Более подробную информацию о регистрации типа адреса можно узнать в статье [Transport Provider and spool MAPI Operational Model](transport-provider-and-mapi-spooler-operational-model.md).
    
- Управление передачей сообщений ([иксплогон:: стартмессаже](ixplogon-startmessage.md), [Иксплогон:: ендмессаже](ixplogon-endmessage.md)и [иксплогон:: субмитмессаже](ixplogon-submitmessage.md) методы). Для получения дополнительных сведений см. [модель приема сообщений](message-reception-model.md), [взаимодействие с диспетчером очереди MAPI](interacting-with-the-mapi-spooler.md)и [модель отправки сообщений](message-submission-model.md).
    
- Проверка внутреннего состояния ([иксплогон:: валидатестате](ixplogon-validatestate.md) ). 
    
- Возможность загружать и отправлять сообщения по требованию ([иксплогон:: метод FlushQueues](ixplogon-flushqueues.md) ). Дополнительные сведения см. в разделе [Реализация метода FlushQueues](implementing-the-flushqueues-method.md).
    
- Возможность запросов к ожидающим сообщениям ([иксплогон::P метод олл](ixplogon-poll.md) ). Дополнительные сведения см. в статье [модель приема сообщений](message-reception-model.md).
    
- Обнаружение состояния простоя ([иксплогон:: метод Idle](ixplogon-idle.md) ). 
    
- Взаимодействие с диспетчером очереди MAPI (метод[иксплогон:: транспортнотифи](ixplogon-transportnotify.md) ). 
    
## <a name="see-also"></a>См. также



[Реализация входа у поставщика услуг](implementing-service-provider-logon.md)


---
title: Реализация объекта logon
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 41e5c88c-d79d-4e9f-81f4-c4365cfaa15d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f9d77313012c2d133dc9352707ebc5e0c69c9973
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332846"
---
# <a name="implementing-a-logon-object"></a><span data-ttu-id="c0944-103">Реализация объекта logon</span><span class="sxs-lookup"><span data-stu-id="c0944-103">Implementing a Logon Object</span></span>

  
  
<span data-ttu-id="c0944-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="c0944-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="c0944-105">Каждая адресная книга, хранилище сообщений и поставщик транспорта создают экземпляр объекта logon в рамках своей реализации [иабпровидер:: logon](iabprovider-logon.md), [Функцииimsprovider:: logon](imsprovider-logon.md)или [иксппровидер:: транспортлогон](ixpprovider-transportlogon.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-105">Every address book, message store, and transport provider instantiates a logon object as part of its implementation of [IABProvider::Logon](iabprovider-logon.md), [IMSProvider::Logon](imsprovider-logon.md), or [IXPProvider::TransportLogon](ixpprovider-transportlogon.md).</span></span> <span data-ttu-id="c0944-106">Объекты входа реализуют методы, которые помогают отправлять запросы клиентов службы MAPI.</span><span class="sxs-lookup"><span data-stu-id="c0944-106">Logon objects implement methods that help MAPI service client requests.</span></span> <span data-ttu-id="c0944-107">В зависимости от типа поставщика услуг ваш объект входа будет поддерживать один из следующих интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="c0944-107">Depending on your type of service provider, your logon object will support one of the following interfaces.</span></span> 
  
|<span data-ttu-id="c0944-108">**Интерфейс объекта logon**</span><span class="sxs-lookup"><span data-stu-id="c0944-108">**Logon object interface**</span></span>|<span data-ttu-id="c0944-109">**Поставщик услуг**</span><span class="sxs-lookup"><span data-stu-id="c0944-109">**Service provider**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="c0944-110">IABLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c0944-110">IABLogon : IUnknown</span></span>](iablogoniunknown.md) <br/> |<span data-ttu-id="c0944-111">Поставщик адресных книг</span><span class="sxs-lookup"><span data-stu-id="c0944-111">Address book provider</span></span>  <br/> |
|[<span data-ttu-id="c0944-112">IMSLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c0944-112">IMSLogon : IUnknown</span></span>](imslogoniunknown.md) <br/> |<span data-ttu-id="c0944-113">Поставщик хранилища сообщений</span><span class="sxs-lookup"><span data-stu-id="c0944-113">Message store provider</span></span>  <br/> |
|[<span data-ttu-id="c0944-114">IXPLogon : IUnknown</span><span class="sxs-lookup"><span data-stu-id="c0944-114">IXPLogon : IUnknown</span></span>](ixplogoniunknown.md) <br/> |<span data-ttu-id="c0944-115">Поставщик транспорта</span><span class="sxs-lookup"><span data-stu-id="c0944-115">Transport provider</span></span>  <br/> |
   
<span data-ttu-id="c0944-116">Службы адресных книг и хранилищ сообщений реализуют следующие функции в своих объектах входа:</span><span class="sxs-lookup"><span data-stu-id="c0944-116">Address book and message store providers implement the following features in their logon objects:</span></span>
  
- <span data-ttu-id="c0944-117">Поддержка уведомлений о событиях (методы**advise** и unadvise). \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="c0944-117">Support for event notification (**Advise** and **Unadvise** methods).</span></span> <span data-ttu-id="c0944-118">Обзор уведомления о событиях представлен [в статье уведомление о событии в MAPI](event-notification-in-mapi.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-118">For an overview of event notification, see [Event Notification in MAPI](event-notification-in-mapi.md).</span></span> <span data-ttu-id="c0944-119">Дополнительные сведения о поддержке уведомлений в объекте logon содержатся в разделе [Поддержка уведомления о событиях](supporting-event-notification.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-119">For more information about supporting notification in your logon object, see [Supporting Event Notification](supporting-event-notification.md).</span></span> 
    
- <span data-ttu-id="c0944-120">Сравнение идентификатора записи (метод**метод compareentryids** ).</span><span class="sxs-lookup"><span data-stu-id="c0944-120">Entry identifier comparison (**CompareEntryIDs** method).</span></span> <span data-ttu-id="c0944-121">Общие сведения об идентификаторах записей можно узнать в статье [идентификаторы записей MAPI](mapi-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-121">For general information about entry identifiers, see [MAPI Entry Identifiers](mapi-entry-identifiers.md).</span></span> <span data-ttu-id="c0944-122">Дополнительные сведения о сравнении идентификаторов записей в методе **метод compareentryids** объекта logon см в разделе [Поддержка доступа к объектам и сравнение](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-122">For more information about comparing entry identifiers in your logon object's **CompareEntryIDs** method, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span>
    
- <span data-ttu-id="c0944-123">Доступ к дополнительным сведениям об ошибке (метод**GetLastError** ).</span><span class="sxs-lookup"><span data-stu-id="c0944-123">Access to additional error information (**GetLastError** method).</span></span> <span data-ttu-id="c0944-124">Более подробную информацию об обработке ошибок в MAPI можно узнать [в статье обработка ошибок в MAPI](error-handling-in-mapi.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-124">For more information about handling errors in MAPI, see [Error Handling in MAPI](error-handling-in-mapi.md).</span></span> 
    
- <span data-ttu-id="c0944-125">Доступ к объектам, реализуемым поставщиком услуг (методом**OpenEntry** ).</span><span class="sxs-lookup"><span data-stu-id="c0944-125">Access to objects implemented by the service provider (**OpenEntry** method).</span></span> <span data-ttu-id="c0944-126">Дополнительные сведения см в разделе [Поддержка доступа к объектам и сравнение](supporting-object-access-and-comparison.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-126">For more information, see [Supporting Object Access and Comparison](supporting-object-access-and-comparison.md).</span></span>
    
- <span data-ttu-id="c0944-127">Доступ к объекту Status (метод**опенстатусентри** ).</span><span class="sxs-lookup"><span data-stu-id="c0944-127">Access to a status object (**OpenStatusEntry** method).</span></span> <span data-ttu-id="c0944-128">Общие сведения об объектах состояния приведены в разделе [объекты состояния MAPI](mapi-status-objects.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-128">For general information about status objects, see [MAPI Status Objects](mapi-status-objects.md).</span></span> <span data-ttu-id="c0944-129">Для получения подробных сведений о реализации объекта Status ознакомьтесь с [реализациЕй объекта Status](status-object-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-129">For specific information about implementing a status object, see [Status Object Implementation](status-object-implementation.md).</span></span>
    
- <span data-ttu-id="c0944-130">Процесс выхода из системы (метод**logoff** ).</span><span class="sxs-lookup"><span data-stu-id="c0944-130">A logoff process (**Logoff** method).</span></span> <span data-ttu-id="c0944-131">Для получения дополнительных сведений обратитесь [к разделу завершение работы поставщика услуг](shutting-down-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-131">For more information, see [Shutting Down a Service Provider](shutting-down-a-service-provider.md).</span></span>
    
<span data-ttu-id="c0944-132">Если ваш поставщик является поставщиком адресной книги, вы также реализуете следующие методы и связанные с ней функции:</span><span class="sxs-lookup"><span data-stu-id="c0944-132">If your provider is an address book provider, you will also implement the following methods and associated features:</span></span>
  
- <span data-ttu-id="c0944-133">[Иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) для предоставления списка шаблонов, которые поддерживаются для создания новых получателей.</span><span class="sxs-lookup"><span data-stu-id="c0944-133">[IABLogon::GetOneOffTable](iablogon-getoneofftable.md) to provide a listing of the templates that you support for creating new recipients.</span></span> <span data-ttu-id="c0944-134">Дополнительные сведения см. в разделе [одноразовЫе таблицы](one-off-tables.md) или [Реализация одноразовой таблицы поставщика](implementing-a-provider-one-off-table.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-134">For more information, see [One-Off Tables](one-off-tables.md) or [Implementing a Provider One-Off Table](implementing-a-provider-one-off-table.md).</span></span>
    
- <span data-ttu-id="c0944-135">[Иаблогон:: опентемплатеид](iablogon-opentemplateid.md) для предоставления доступа к реализации получателя, данные которого хранятся в поставщике адресной книги узла.</span><span class="sxs-lookup"><span data-stu-id="c0944-135">[IABLogon::OpenTemplateID](iablogon-opentemplateid.md) to provide access to the implementation of a recipient whose data resides in a host address book provider.</span></span> <span data-ttu-id="c0944-136">Для получения дополнительных сведений обратитесь к разделу "работа в [качестве поставщика внешних адресНых книг](acting-as-a-foreign-address-book-provider.md)".</span><span class="sxs-lookup"><span data-stu-id="c0944-136">For more information, see [Acting as a Foreign Address Book Provider](acting-as-a-foreign-address-book-provider.md).</span></span> 
    
- <span data-ttu-id="c0944-137">[Иаблогон::P репаререЦипс](iablogon-preparerecips.md) , чтобы обеспечить доступность соответствующих свойств для всех получателей в списке получателей.</span><span class="sxs-lookup"><span data-stu-id="c0944-137">[IABLogon::PrepareRecips](iablogon-preparerecips.md) to ensure that the appropriate properties are available for all of the recipients in a recipient list.</span></span> <span data-ttu-id="c0944-138">Дополнительные сведения см. в статье [иаблогон::P репаререЦипс](iablogon-preparerecips.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-138">For more information, see [IABLogon::PrepareRecips](iablogon-preparerecips.md).</span></span> 
    
<span data-ttu-id="c0944-139">Объект входа поставщика транспорта, который реализует [иксплогон: IUnknown](ixplogoniunknown.md), сильно отличается от объектов входа, реализованных другими типами поставщиков услуг.</span><span class="sxs-lookup"><span data-stu-id="c0944-139">A transport provider's logon object, which implements [IXPLogon : IUnknown](ixplogoniunknown.md), is quite different from the logon objects implemented by the other types of service providers.</span></span> <span data-ttu-id="c0944-140">У него есть только две функции, общие с другими объектами входа: доступ к объекту Status через метод [иксплогон:: опенстатусентри](ixplogon-openstatusentry.md) и операцию выхода из системы с помощью метода [Иксплогон:: транспортлогофф](ixplogon-transportlogoff.md) .</span><span class="sxs-lookup"><span data-stu-id="c0944-140">It has only two features in common with the other logon objects: access to a status object through the [IXPLogon::OpenStatusEntry](ixplogon-openstatusentry.md) method and a logoff operation through the [IXPLogon::TransportLogoff](ixplogon-transportlogoff.md) method.</span></span> <span data-ttu-id="c0944-141">Поставщики транспорта реализуют следующие уникальные функции в своих объектах входа:</span><span class="sxs-lookup"><span data-stu-id="c0944-141">Transport providers implement the following unique features in their logon objects:</span></span> 
  
- <span data-ttu-id="c0944-142">Регистрация типов адресов ([иксплогон:: метод аддресстипес](ixplogon-addresstypes.md) ).</span><span class="sxs-lookup"><span data-stu-id="c0944-142">Registration for address types ([IXPLogon::AddressTypes](ixplogon-addresstypes.md) method).</span></span> <span data-ttu-id="c0944-143">Более подробную информацию о регистрации типа адреса можно узнать в статье [Transport Provider and spool MAPI Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-143">For more information about registering an address type, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="c0944-144">Управление передачей сообщений ([иксплогон:: стартмессаже](ixplogon-startmessage.md), [Иксплогон:: ендмессаже](ixplogon-endmessage.md)и [иксплогон:: субмитмессаже](ixplogon-submitmessage.md) методы).</span><span class="sxs-lookup"><span data-stu-id="c0944-144">Control of message transmission ([IXPLogon::StartMessage](ixplogon-startmessage.md), [IXPLogon::EndMessage](ixplogon-endmessage.md), and [IXPLogon::SubmitMessage](ixplogon-submitmessage.md) methods).</span></span> <span data-ttu-id="c0944-145">Для получения дополнительных сведений см. [модель приема сообщений](message-reception-model.md), [взаимодействие с диспетчером очереди MAPI](interacting-with-the-mapi-spooler.md)и [модель отправки сообщений](message-submission-model.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-145">For more information, see [Message Reception Model](message-reception-model.md), [Interacting with the MAPI Spooler](interacting-with-the-mapi-spooler.md), and [Message Submission Model](message-submission-model.md).</span></span>
    
- <span data-ttu-id="c0944-146">Проверка внутреннего состояния ([иксплогон:: валидатестате](ixplogon-validatestate.md) ).</span><span class="sxs-lookup"><span data-stu-id="c0944-146">Internal state validation ([IXPLogon::ValidateState](ixplogon-validatestate.md) method).</span></span> 
    
- <span data-ttu-id="c0944-147">Возможность загружать и отправлять сообщения по требованию ([иксплогон:: метод FlushQueues](ixplogon-flushqueues.md) ).</span><span class="sxs-lookup"><span data-stu-id="c0944-147">Ability to download or upload messages on demand ([IXPLogon::FlushQueues](ixplogon-flushqueues.md) method).</span></span> <span data-ttu-id="c0944-148">Дополнительные сведения см. в разделе [Реализация метода FlushQueues](implementing-the-flushqueues-method.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-148">For more information, see [Implementing the FlushQueues Method](implementing-the-flushqueues-method.md).</span></span>
    
- <span data-ttu-id="c0944-149">Возможность запросов к ожидающим сообщениям ([иксплогон::P метод олл](ixplogon-poll.md) ).</span><span class="sxs-lookup"><span data-stu-id="c0944-149">Ability to query for pending messages ([IXPLogon::Poll](ixplogon-poll.md) method).</span></span> <span data-ttu-id="c0944-150">Дополнительные сведения см. в статье [модель приема сообщений](message-reception-model.md).</span><span class="sxs-lookup"><span data-stu-id="c0944-150">For more information, see [Message Reception Model](message-reception-model.md).</span></span>
    
- <span data-ttu-id="c0944-151">Обнаружение состояния простоя ([иксплогон:: метод Idle](ixplogon-idle.md) ).</span><span class="sxs-lookup"><span data-stu-id="c0944-151">Idle state detection ([IXPLogon::Idle](ixplogon-idle.md) method).</span></span> 
    
- <span data-ttu-id="c0944-152">Взаимодействие с диспетчером очереди MAPI (метод[иксплогон:: транспортнотифи](ixplogon-transportnotify.md) ).</span><span class="sxs-lookup"><span data-stu-id="c0944-152">Interaction with the MAPI spooler ([IXPLogon::TransportNotify](ixplogon-transportnotify.md) method).</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="c0944-153">См. также</span><span class="sxs-lookup"><span data-stu-id="c0944-153">See also</span></span>



[<span data-ttu-id="c0944-154">Реализация входа у поставщика услуг</span><span class="sxs-lookup"><span data-stu-id="c0944-154">Implementing Service Provider Logon</span></span>](implementing-service-provider-logon.md)


---
title: О URL-адресах MAPI для Notification-Based индексации
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9cb35f0a-267e-2d85-1701-02d52578a0b8
description: 'Последнее изменение: 08 ноября 2011 г.'
ms.openlocfilehash: 5a3e45809f36b71968560a4b239e268addf00474
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422483"
---
# <a name="about-mapi-urls-for-notification-based-indexing"></a>О URL-адресах MAPI для Notification-Based индексации

**Область применения**: Outlook 2013 | Outlook 2016 
  
Если поставщик магазина сообщает индексатору, что объект готов к индексации, он создает URL-адрес MAPI, который однозначно идентифицирует объект с обработщиком протокола MAPI. URL-адреса MAPI кодируются в Unicode и имеют следующий формат: 
  
`Mapi://SID/StoreDisplayName ($HashNumber)/StoreType/FolderNameA/…/FolderNameN/[EntryIDEncoded[/at=AttachIDEncoded:FileName]]`

В следующей таблице описываются различные части типичного URL-адреса.

|Part | Описание|
|:----|:-----------|  
|*SID* |Идентификатор безопасности текущего пользователя.| 
|*StoreDisplayName* |Строка, которая указывает имя отображения пользователя в этом магазине.|
|*HashNumber* |DWORD **в** hexadecimal представлении, которое рассчитывается на основе ID записи магазина или подписи сопоставления магазина. Это значение хранится в реестре и будет использоваться позже для идентификации магазина в обработнике протокола MAPI.<br/><br/>Это число должно быть рассчитано таким образом, чтобы минимизировать столкновения с другими хранилищами. Для алгоритма, Outlook для вычисления номера hash, см. в записи [Algorithm to Calculate the Store Hash Number.](algorithm-to-calculate-the-store-hash-number.md)|
|*StoreType* |Номер, который идентифицирует тип магазина, который содержит объект, который будет индексироваться. Возможны следующие значения.<br/>- 0 - Хранилище по умолчанию.<br/><br/>- 1 - Хранилище Делегирования, используемого для элементов делегирования, кэшированных локально.<br/><br/>- 2 — общедоступные папки, используемые для избранных общедоступных папок.<br/><br/>**ПРИМЕЧАНИЕ.** Если в магазине вместо нажатого обхода используется символ *X.*| 
|*FolderNameA/.../FolderNameN* |Путь от корневого IPM_SUBTREE к папке или сообщению. Например, сообщение в папке **Family** в папке **"Входящие"** имеет для этого параметра папку **"Входящие" и** "Семейство". |
|*EntryIDEncoded* |Код входа MAPI для элемента, закодированного как строка Юникод. Сведения о том, как кодируются определенные специальные символы, см. в следующем разделе "Специальные символы". Дополнительные сведения об алгоритме кодирования ID записи см. в приложении [Algorithm to Encode Entry IDs and Attachment IDs.](algorithm-to-encode-entry-ids-and-attachment-ids.md)<br/><br/>**ПРИМЕЧАНИЕ.** При просмотре в виде текста этот кодированный код записи отображается как случайные символы или поля Hangul в соответствии с алгоритмом в зависимости от доступных шрифтов.  |
|*AttachIDEncoded* |Код вложения, закодированный как строка Unicode. Сведения о том, как кодируются определенные специальные символы, см. в следующем разделе "Специальные символы". Дополнительные сведения об алгоритме кодирования ID записи см. в приложении [Algorithm to Encode Entry IDs and Attachment IDs.](algorithm-to-encode-entry-ids-and-attachment-ids.md)<br/><br/>**ПРИМЕЧАНИЕ.** При просмотре в виде текста этот кодированный код записи отображается как случайные символы или поля Hangul в соответствии с алгоритмом в зависимости от доступных шрифтов. |
|*FileName* |Имя файла вложения, как оно отображается в сообщении.|
    
## <a name="examples-of-mapi-urls"></a>Примеры URL-адресов MAPI

Ниже приводится несколько примеров URL-адресов MAPI.
  
- URL-адрес MAPI для папки: 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($be19928f)/2/Office`
    
- URL-адрес MAPI для сообщения: 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($484efb89)/0/Calendar/곯가가가걍걝걌곌겷걢곒갑겛개가검걟곔걙곾걤곂갠가`
    
- URL-адрес MAPI для вложения: 
    
  `mapi://S-1-5-21-2127521184-1604012920-1887927527-71418/Mailbox - Some User ($484efb89)/0/Inbox/곯가가가걍걝걌곌겷걢곒갑겛개가검걟곔걙곾간곷갦가/at=겅걋각가:somefile.txt`
    
## <a name="special-characters"></a>Специальные символы

Определенные символы кодируются, если они отображаются в сообщении или вложении. Ниже показано, какие символы закодированы в URL-адресе MAPI:
  
- % > %25
    
- / > %2F 
    
- \ > %5C 
    
- \* > %2A 
    
- ? > %3F 
    
## <a name="blob-associated-with-each-mapi-url"></a>Blob, связанный с каждым URL-адресом MAPI

При нажатии URL-адреса MAPI для объекта, который будет индексироваться, поставщик магазинов также создает двоичный большой объект (BLOB), содержащий определенные сведения для обработчицы протокола MAPI. Поставщик магазина связывает этот BLOB с каждым URL-адресом MAPI и отправляет его при нажатии URL-адреса MAPI на индексер. Формат BLOB следующим образом: 
  
```cpp
DWORD  dwVersion
DWORD  dwFlags
ULONG  cbProfileName
WCHAR  wszProfileName
ULONG  cbProviderItemID
WCHAR  wszProviderItemID
```

Поставщик магазина должен записать эти значения в BLOB в показанном порядке. В следующей таблице описывается каждое поле BLOB.

|Part | Описание|
|:----|:-----------|  
|*dwVersion* |Это версия отосланных данных. В настоящее время это значение 1.|
|*dwFlags* |Зарезервировано для последующего использования. В настоящее время это значение должно быть 0.|
|*cbProfileName* |Размер имени профиля в bytes. Эта информация полезна обработчиве протокола MAPI, чтобы узнать, какой профиль использовать при индексации элемента.|
|*wszProfileName* |Null-terminated Unicode string that contains the profile name.|
|*cbProviderItemID* |Размер ID элемента поставщика в bytes. Поставщик магазина должен отправлять только ID элемента поставщика для папок, чтобы предотвратить открытие дополнительных папок для получения этой информации.|
|*wszProviderItemID* |Null-terminated Unicode string with the provider item ID that uniquely identifies the item in the store.|
    
## <a name="see-also"></a>См. также

- [Индексация Notification-Based магазина](about-notification-based-store-indexing.md)
- [Константы MAPI](mapi-constants.md)


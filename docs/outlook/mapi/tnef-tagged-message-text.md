---
title: Текст сообщения с тегами в формате TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8c65339e-240c-412d-9b71-69c746468bfb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2b4d4cd790870a024cac6f2ed9952d18a970235a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419921"
---
# <a name="tnef-tagged-message-text"></a>Текст сообщения с тегами в формате TNEF

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Формат TNEF использует текст сообщения с тегами для разрешения положений вложений в родительском сообщении. Это делается путем добавления заполнителя места в тексте сообщения в позиции вложения. Этот держатель или тег вложений описывает вложение таким образом, что формат TNEF знает, как Разрешить вложение и его положение. Теги форматируются следующим образом:
  
 `[[ <Object Title> : <KeyNum> in <Stream Name> ]] [[ <File Name> : <KeyNum> in <Transport Name> ]]`
  
 ** \<Заголовок\> объекта** **и \<имя\> файла** — это переменные, содержащие значения, которые берутся из самого вложения. В случаях, когда эти значения недоступны, заголовок по умолчанию задается в формате TNEF на основе типа вложения. 
  
Переменная ** \<кэйнум\> ** содержит текстовое представление ключа вложения, назначенного вложению, в формате TNEF. Базовое значение ключа передается в вызов [опентнефстреамекс](opentnefstreamex.md) . Базовое значение не должно быть нулевым и не должно быть одинаковым для каждого вызова **опентнефстреамекс**. Должно быть достаточно использовать псевдослучайных случайных чисел на основе системного времени из любого генератора случайных чисел, предоставляемого библиотекой времени выполнения, если гарантируется, что они никогда не равны нулю.
  
Переменная ** \<имени\> транспорта** содержит либо имя потока, переданное в вызов [опентнефстреамекс](opentnefstreamex.md) , либо значение свойства **PR_ATTACH_TRANSPORT_NAME** ([PidTagAttachTransportName](pidtagattachtransportname-canonical-property.md)).
  
> [!NOTE]
> Свойство **PR_ATTACH_TRANSPORT_NAME** и переменная ** \<имени\> транспорта** в теге Text сообщения не имеют отношения к имени реализуемого поставщика транспорта. Эти элементы представляют имя вложения для поставщика транспорта и системы обмена сообщениями. 
  
Текст сообщения помечается, когда поставщик транспорта запрашивает текст сообщения с тегами, вызывая метод [итнеф:: опентагжедбоди](itnef-opentaggedbody.md) . При чтении из потока текста с тегами в формате TNEF заменяется одиночный символ, который был в тексте сообщения в индексе, указанном в свойстве **PR_RENDERING_POSITION** ([PidTagRenderingPosition](pidtagrenderingposition-canonical-property.md)) с соответствующим тегом. При записи в поток текста с тегами TNEF проверяет входящие данные для тегов, находит связанное вложение и заменяет тег на один символ пробела.
  
Обратите внимание, что с помощью текста сообщения с тегами поставщик транспорта может сохранить расположение вложений независимо от большинства изменений, внесенных в текст сообщения системами обмена сообщениями.
  


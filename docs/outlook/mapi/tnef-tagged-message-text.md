---
title: TNEF-Tagged сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8c65339e-240c-412d-9b71-69c746468bfb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2b4d4cd790870a024cac6f2ed9952d18a970235a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419921"
---
# <a name="tnef-tagged-message-text"></a>TNEF-Tagged сообщения

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Помеченный текст сообщения используется TNEF для решения позиций вложений в родительском сообщении. Это делается путем добавления держателя места в текст сообщения в положении вложения. Этот держатель места или тег вложения описывает вложение таким образом, чтобы TNEF знал, как разрешить вложение и его положение. Теги отформатированы следующим образом:
  
 `[[ <Object Title> : <KeyNum> in <Stream Name> ]] [[ <File Name> : <KeyNum> in <Transport Name> ]]`
  
 **\< Название \> объекта** и **\< имя файла \>** — это переменные, содержащие значения, взятые из самого вложения. В случаях, когда эти значения недоступны, название по умолчанию является TNEF на основе типа вложения. 
  
Переменная **\< KeyNum \>** содержит текстовое представление ключа вложения, назначенного Вложением TNEF. Базовое значение ключа передается в [вызов OpenTnefStreamEx.](opentnefstreamex.md) Базовое значение не должно быть нулевым и не должно быть одинаковым для каждого звонка **в OpenTnefStreamEx.** Должно быть достаточно использовать псевдо случайные числа в зависимости от системного времени от любого генератора случайных чисел, которые предоставляет библиотека run-time, до тех пор, пока вы гарантируете, что они никогда не будут нулем.
  
Переменная **\< \> "Имя** транспорта" содержит имя потока, переданное в вызов [OpenTnefStreamEx,](opentnefstreamex.md) или значение свойства **PR_ATTACH_TRANSPORT_NAME** [(PidTagAttachTransportName).](pidtagattachtransportname-canonical-property.md)
  
> [!NOTE]
> Свойство **PR_ATTACH_TRANSPORT_NAME** и переменная **\< "Имя \>** транспорта" в текстовом теге сообщения не имеют ничего общего с именем реализуемого поставщика транспорта. Эти элементы представляют имя вложения для поставщика транспорта и системы обмена сообщениями. 
  
Текст сообщения помечен, когда поставщик транспорта просит помеченный текст сообщения, позвонив по методу [ITnef::OpenTaggedBody.](itnef-opentaggedbody.md) При чтении из помеченного текстового потока TNEF заменяет один символ, который был в тексте сообщения в индексе, предоставленном в свойстве **PR_RENDERING_POSITION** [(PidTagRenderingPosition)](pidtagrenderingposition-canonical-property.md)соответствующим тегом. При записи в текстовый поток с тегами TNEF проверяет входящие данные для тегов, находит связанное вложение и заменяет тег одним пробелом.
  
Обратите внимание, что с помощью помеченного текста сообщения поставщик транспорта может сохранять расположение вложений независимо от большинства изменений, внесенных в текст сообщения системами обмена сообщениями.
  


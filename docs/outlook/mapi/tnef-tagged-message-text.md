---
title: TNEF-Tagged сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8c65339e-240c-412d-9b71-69c746468bfb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 2b4d4cd790870a024cac6f2ed9952d18a970235a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419921"
---
# <a name="tnef-tagged-message-text"></a>TNEF-Tagged сообщения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Текст сообщения с тегами используется TNEF для разрешения позиций вложений в родительском сообщении. Для этого в текст сообщения добавляется владелец места в позиции вложения. Этот владелец места или тег вложения описывает вложение таким образом, чтобы TNEF знал, как разрешить вложение и его положение. Теги форматированы следующим образом:
  
 `[[ <Object Title> : <KeyNum> in <Stream Name> ]] [[ <File Name> : <KeyNum> in <Transport Name> ]]`
  
 **\< Заголовок \> объекта** **\< и имя файла — \>** это переменные, содержащие значения, взятые из самого вложения. В случаях, когда эти значения недоступны, заголовок по умолчанию заголовок по умолчанию заголовок TNEF основан на типе вложения. 
  
Переменная **\< KeyNum \>** содержит текстовое представление ключа вложения, назначенного вложением с помощью TNEF. Базовое значение ключа передается в вызов [OpenTnefStreamEx.](opentnefstreamex.md) Базовое значение не должно быть нулем и не должно быть одинаковым для каждого вызова **OpenTnefStreamEx.** Достаточно использовать псевдосъемные числа на основе системного времени от любого генератора случайных чисел, которые предоставляет библиотека времени запуска, если вы гарантируете, что они никогда не будут нулем.
  
Переменная **\< Transport \> Name** содержит имя потока, переданное в вызов [OpenTnefStreamEx,](opentnefstreamex.md) или значение свойства **PR_ATTACH_TRANSPORT_NAME** ([PidTagAttachTransportName).](pidtagattachtransportname-canonical-property.md)
  
> [!NOTE]
> Свойство **PR_ATTACH_TRANSPORT_NAME** и **\< переменная \> Transport Name** в текстовом теге сообщения не имеют отношения к имени реализуемого поставщика транспорта. Эти элементы представляют имя вложения для поставщика транспорта и системы обмена сообщениями. 
  
Текст сообщения помечен, когда поставщик транспорта запросит помеченный текст сообщения, вызывая метод [ITnef::OpenTaggedBody.](itnef-opentaggedbody.md) При чтении из текстового потока с тегом TNEF заменяет один символ, который был в тексте сообщения в индексе, предоставленном в свойстве **PR_RENDERING_POSITION** ([PidTagRenderingPosition)](pidtagrenderingposition-canonical-property.md)соответствующим тегом. При записи в помеченный текстовый поток TNEF проверяет входящие данные на наличие тегов, находит связанное вложение и заменяет тег одним пробелом.
  
Обратите внимание, что с помощью текста сообщения с тегами поставщик транспорта может сохранить расположение вложений независимо от большинства изменений, внесенных в текст сообщения системами обмена сообщениями.
  


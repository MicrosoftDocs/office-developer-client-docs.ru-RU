---
title: HrValidateIPMSubtree
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.HrValidateIPMSubtree
api_type:
- COM
ms.assetid: 6454c1fa-5216-4934-a908-48c634ac4a07
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 6cf51985e534434c584eff4d63dfbf239121ee85
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436575"
---
# <a name="hrvalidateipmsubtree"></a>HrValidateIPMSubtree

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Добавляет папки стандартных сообщений взаимоконтактных сообщений (IPM) в хранилище сообщений. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Мапиутил. h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения  <br/> |
   
```cpp
HrValidateIPMSubtree(
  LPMDB lpMDB,
  ULONG ulFlags,
  ULONG FAR * lpcValues,
  LPSPropValue FAR * lppProps,
  LPMAPIERROR FAR * lppMapiError
);
```

## <a name="parameters"></a>Параметры

 _Лпмдб_
  
> возврата Указатель на объект хранилища сообщений, в который добавляются папки. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, используемых для управления созданием папок. Можно задать следующие флаги:
    
МАПИ_ФОРЦЕ_КРЕАТЕ 
  
> Папки следует проверить перед созданием, даже если свойства хранилища сообщений указывают, что они действительны. Клиентское приложение обычно устанавливает этот флаг, если ошибка указывает на то, что структура существующей папки повреждена. 
    
МАПИ_ФУЛЛ_ИПМ_ТРИ 
  
> Полный набор папок IPM должен быть создан в корневой папке хранилища сообщений. Названия папок в иерархии:
    
    - Представления папок
    
    - Общие представления
    
    - Корень поиска\*
    
    - Поддерево IPM\*
    
    - Inbox;
    
    - Исходящие
    
    - Удаленные элементы\*
    
    - Отправленные
    
    где три папки с \* пометкой — это минимальный набор, созданный даже в том случае, если не ЗАДАН флаг мапи_фулл_ипм_три. Клиентское приложение обычно устанавливает этот флаг, когда хранилище сообщений, в котором будут создаваться папки, является хранилищем по умолчанию.
    
 _Лпквалуес_
  
> [вход, выход] Указатель на число структур [спропвалуе](spropvalue.md) в массиве, возвращаемом параметром _лпппропс_ . Если _лпппропс_ имеет значение null, значение параметра _лпквалуес_ может быть равно нулю. 
    
 _Лпппропс_
  
> [вход, выход] Указатель на указатель на массив структур **спропвалуе** , который содержит значения свойств для свойства **пр_валид_фолдер_маск** ([PidTagValidFolderMask](pidtagvalidfoldermask-canonical-property.md)), а также для свойств соответствующего идентификатора записи папки. Если **хрвалидатеипмсубтри** создает папку "Входящие" в хранилище сообщений, массив **спропвалуе** содержит идентификатор записи "Входящие" с особым тегом свойства, `PROP_TAG(PT_BINARY, PROP_ID_NULL)`закодированным как. Параметр _лпппропс_ может иметь значение null, что указывает на то, что для вызывающей реализации не требуется возвратить массив **спропвалуе** . 
    
 _Лппмапиеррор_
  
> вышли Указатель на указатель на структуру [мапиеррор](mapierror.md) , содержащую сведения о версии, компоненте и контексте ошибки. Параметр _лппмапиеррор_ имеет значение null, если структура **мапиеррор** не возвращается. 
    
## <a name="return-value"></a>Возвращаемое значение

Нет.
  
## <a name="remarks"></a>Примечания

MAPI использует функцию **хрвалидатеипмсубтри** для внутренних целей, чтобы построить стандартное поддерево IPM в хранилище сообщений при первом открытии хранилища, или когда хранилище по умолчанию создано. Эта функция также может использоваться клиентскими приложениями для проверки или исправления стандартных папок сообщений. 
  
 **Хрвалидатеипмсубтри** всегда создает папки корневОй папки поиска и поддерева IPM в корневой папке хранилища и в папке "Удаленные" в папке "ПОДдерево IPM". Папка поддерева IPM является корневым каталогом иерархии IPM в этом хранилище сообщений. Корневую папку поиска можно использовать в качестве корня поддерева для папок результатов поиска. 
  
Клиенты IPM должны отображать свое представление папки, начиная с корневой папки поддерева IPM и отображая вложенные папки под ним. Сведения в корневой папке хранилища сообщений не должны отображаться в пользовательском интерфейсе клиента. Эта функция означает, что если клиент должен скрыть сведения, эти сведения можно поместить в корневой каталог дерева IPM, где они не видны пользователю. В отличие от приложений, не связанных с IPM, которые требуют, чтобы сообщения и папки были невидимы для пользователя, например в серверном хранилище сообщений, их можно поместить вне иерархии IPM. 
  
 **Хрвалидатеипмсубтри** задает свойство **пр_валид_фолдер_маск** , которое указывает, содержит ли создаваемая папка IPM допустимый идентификатор записи. Следующие свойства идентификатора записи в хранилище сообщений задаются идентификаторами записей соответствующих папок и возвращаются в параметре _лпппропс_ вместе с **пр_валид_фолдер_маск**: 
  
 **Пр_коммон_виевс_ентрид** ([PidTagCommonViewsEntryId](pidtagcommonviewsentryid-canonical-property.md))
  
> **Пр_финдер_ентрид** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md))
  
> **Пр_ипм_аутбокс_ентрид** ([PidTagIpmOutboxEntryId](pidtagipmoutboxentryid-canonical-property.md))
  
> **Пр_ипм_сентмаил_ентрид** ([PidTagIpmSentMailEntryId](pidtagipmsentmailentryid-canonical-property.md))
  
> **Пр_ипм_субтри_ентрид** ([PidTagIpmSubtreeEntryId](pidtagipmsubtreeentryid-canonical-property.md))
  
> **Пр_ипм_вастебаскет_ентрид** ([PidTagIpmWastebasketEntryId](pidtagipmwastebasketentryid-canonical-property.md))
  
> **Пр_виевс_ентрид** ([PidTagViewsEntryId](pidtagviewsentryid-canonical-property.md))
  
> Заполнитель [проп_таг](prop_tag.md) для папки "Входящие" IPM (ПТ_БИНАРИ, проп_ид_нулл). 
    
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мстсторедлг. cpp  <br/> |Кмсгсторедлг:: Онвалидатеипмсубтри  <br/> |MFCMAPI использует метод **хрвалидатеипмсубтри** для добавления стандартных папок в хранилище сообщений.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPISession::OpenMsgStore](imapisession-openmsgstore.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


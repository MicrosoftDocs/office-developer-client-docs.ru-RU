---
title: IABContainerCreateEntry
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABContainer.CreateEntry
api_type:
- COM
ms.assetid: ea1daf74-d9e3-4304-bf5d-889afeea6ae9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9f80130279e3437dd9be947de97d3f0d4181165e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411276"
---
# <a name="iabcontainercreateentry"></a>IABContainer::CreateEntry

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает новую запись, которая может быть пользователем системы обмена сообщениями, списком рассылки или другим контейнером.
  
```cpp
HRESULT CreateEntry(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulCreateFlags,
  LPMAPIPROP FAR * lppMAPIPropEntry
);
```

## <a name="parameters"></a>Параметры

 _cbEntryID_
  
> [in] Количество вхождений в идентификаторе записи, на которые указывает параметр _lpEntryID._ 
    
 _lpEntryID_
  
> [in] Указатель на идентификатор записи шаблона для создания новых записей определенного типа. 
    
 _ulCreateFlags_
  
> [in] Битоваяmas флагов, которая управляет процессом создания записей. Можно установить следующие флаги:
    
CREATE_CHECK_DUP_LOOSE 
  
> Должен выполняться свободный уровень проверки дублирующихся записей. Реализация свободной проверки записей является конкретной для поставщика. Например, поставщик может определить свободное совпадение как любые две записи с одинаковым отображаемой именем.
    
CREATE_CHECK_DUP_STRICT 
  
> Должен выполняться строгий уровень проверки записей. Реализация строгой проверки дубликатов записей является конкретной для поставщика. Например, поставщик может определить строгое соответствие как любые две записи с одинаковым отображаемого имени и адресом обмена сообщениями.
    
CREATE_REPLACE 
  
> Новая запись должна заменить существующую, если определено, что эти две записи дублируются.
    
 _lppMAPIPropEntry_
  
> [out] Указатель на указатель на созданную запись.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Новая запись успешно создана.
    
## <a name="remarks"></a>Примечания

Метод **IABContainer::CreateEntry** создает новую запись определенного типа в указанном контейнере, возвращая указатель на реализацию интерфейса для дальнейшего доступа к записи. Новая запись создается с помощью шаблона, выбранного в списке доступных шаблонов контейнера, опубликованных в его одностолковой таблице. Звоняющие имеют доступ к одноразовой таблице контейнера, вызывая его метод [IMAPIProp::OpenProperty](imapiprop-openproperty.md) и запрашивая свойство **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates).](pidtagcreatetemplates-canonical-property.md) 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Все контейнеры, которые поддерживают метод **IABContainer::CreateEntry,** должны быть модификуемыми. Задайте флаг AB_MODIFIABLE контейнера в свойстве **PR_CONTAINER_FLAGS** ([PidTagContainerFlags),](pidtagcontainerflags-canonical-property.md)чтобы указать, что его можно модификатировать. 
  
Необходимо поддерживать все флаги _ulCreateFlags._ Однако интерпретация и использование этих флагов является конкретной реализацией, то есть вы можете определить, что семантика CREATE_CHECK_DUP_LOOSE и CREATE_CHECK_DUP_STRICT означает в контексте реализации. Если вы не можете определить, является ли запись дубликатом, всегда разрешайте ее создавать. 
  
Некоторые поставщики реализуют строгую проверку записи путем совпадения отображаемой записи, адреса обмена сообщениями и ключа поиска в записи; другие поставщики ограничивают совпадение отображаемой именем и адресом. Свободные проверки записей часто реализуются путем проверки только отображаемой записи. 
  
## <a name="notes-to-host-address-book-provider-implementers"></a>Примечания для поставщиков адресной книги для хост-адресов

Если контейнер может создавать записи из шаблонов других поставщиков, реализация **CreateEntry** должна предоставить хранилище для некоторых или всех свойств, связанных с созданными записями. Например, если вы предоставляете хранилище для свойства **PR_DETAILS_TABLE** записи [(PidTagDetailsTable),](pidtagdetailstable-canonical-property.md)вы можете создать его диалоговое окно сведений без необходимости зависеть от внешнего поставщика. 
  
Если контейнер может создавать записи, которые поддерживают **свойство PR_TEMPLATEID** ([PidTagTemplateid),](pidtagtemplateid-canonical-property.md)реализация **CreateEntry** должна сделать следующее: 
  
1. Вызовите [метод IMAPISupport::OpenTemplateID.](imapisupport-opentemplateid.md) **OpenTemplateID** позволяет коду внешнего поставщика для записи привязываться к создаемой записи. Внешние поставщики поддерживают этот процесс привязки, чтобы контролировать записи, созданные из их шаблонов, в контейнеры поставщиков адресных книг хост-адресов. 
    
2. Выполните любую необходимую инициализацию и заполните новый объект всеми свойствами из записи во внешнем поставщике, которую объект вернул в _параметре lppMAPIPropNew_ из **OpenTemplateID.**
    
Если **openTemplateID** успешно, скопируйте свойства в реализацию, на которая указывает параметр _lppMAPIPropNew,_ а не непосредственно на реализацию, на которая указывает параметр _lpMAPIPropData._ Инициализировать новую запись для автономного использования так же, как и любую другую запись от внешнего поставщика. 
  
Если **OpenTemplateID** возвращает ошибку, **сбой CreateEntry.** Не разрешайте создавать запись. Так как внешние поставщики могут делать предположения о данных в поставщике, не создавайте запись с идентификатором шаблона, который не был успешно привязан к внешнему поставщику. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Когда **CreateEntry** возвращает, вы можете или не сможете сразу получить доступ к идентификатору записи для новой записи. Некоторые поставщики адресных книг не делают ее доступной до тех пор, пока не будет вызван метод [IMAPIProp::SaveChanges](imapiprop-savechanges.md) новой записи. 
  
Хотя в **CreateEntry** в качестве параметров передаются дублирующиеся флажки проверки, повторная проверка не будет происходить до тех пор, пока не будет вызван **saveChanges.** Поэтому связанные ошибки, такие как MAPI_E_COLLISION, которые указывают на то, что была предпринята попытка создать уже существующую запись, возвращаются **saveChanges,** а не **CreateEntry.**
  
## <a name="see-also"></a>См. также



[IABContainer::CopyEntries](iabcontainer-copyentries.md)
  
[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[Каноническое свойство PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)
  
[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md)


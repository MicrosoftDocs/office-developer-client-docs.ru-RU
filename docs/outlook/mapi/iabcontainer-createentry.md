---
title: IABContainerCreateEntry
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABContainer.CreateEntry
api_type:
- COM
ms.assetid: ea1daf74-d9e3-4304-bf5d-889afeea6ae9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9f80130279e3437dd9be947de97d3f0d4181165e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411276"
---
# <a name="iabcontainercreateentry"></a>IABContainer::CreateEntry

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Создает новую запись, которая может быть пользователем обмена сообщениями, списком рассылки или другим контейнером.
  
```cpp
HRESULT CreateEntry(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulCreateFlags,
  LPMAPIPROP FAR * lppMAPIPropEntry
);
```

## <a name="parameters"></a>Parameters

 _cbEntryID_
  
> [in] Количество bytes в идентификаторе записи, на который указывает параметр _lpEntryID._ 
    
 _lpEntryID_
  
> [in] Указатель на идентификатор записи шаблона для создания новых записей определенного типа. 
    
 _ulCreateFlags_
  
> [in] Битмашка флагов, которые контролируют выполнение создания записи. Можно установить следующие флаги:
    
CREATE_CHECK_DUP_LOOSE 
  
> Должен быть выполнен свободный уровень проверки дублирующихся записей. Реализация свободной проверки дубликатов записей — это конкретный поставщик. Например, поставщик может определить свободный совпадение как любые две записи с одинаковым именем отображения.
    
CREATE_CHECK_DUP_STRICT 
  
> Должен быть выполнен строгий уровень проверки записи дубликата. Реализация строгой проверки дубликатов записи является конкретным поставщиком. Например, поставщик может определить строгое соответствие как любые две записи с одинаковым именем отображения и адресом обмена сообщениями.
    
CREATE_REPLACE 
  
> Новая запись должна заменить существующую, если установлено, что эти две записи являются дубликатами.
    
 _lppMAPIPropEntry_
  
> [вышел] Указатель на указатель на вновь созданную запись.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Новая запись была успешно создана.
    
## <a name="remarks"></a>Примечания

Метод **IABContainer::CreateEntry** создает новую запись определенного типа в указанном контейнере, возвращая указатель в реализацию интерфейса для дальнейшего доступа к записи. Новая запись создается с помощью шаблона, выбранного из списка доступных шаблонов контейнера, опубликованных в его разовой таблице. Звонители могут получить доступ к разовой таблице контейнера, позвонив по методу [IMAPIProp::OpenProperty](imapiprop-openproperty.md) **и** запросив свойство [PR_CREATE_TEMPLATES (PidTagCreateTemplates).](pidtagcreatetemplates-canonical-property.md) 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Все контейнеры, поддерживают **метод IABContainer::CreateEntry,** должны быть модификабельными. Установите флаг AB_MODIFIABLE контейнера в **свойстве PR_CONTAINER_FLAGS** [(PidTagContainerFlags),](pidtagcontainerflags-canonical-property.md)чтобы указать, что он является модификационным. 
  
Необходимо поддерживать все флаги _ulCreateFlags._ Однако интерпретация и использование этих флагов специфична для реализации, то есть можно определить, что означают семантика CREATE_CHECK_DUP_LOOSE и CREATE_CHECK_DUP_STRICT в контексте реализации. Если вы не можете или не можете определить, является ли запись дубликатом, всегда разрешайте создать запись. 
  
Некоторые поставщики реализуют строгие проверки входа, сообразуя имя отображения, адрес обмена сообщениями и ключ поиска в записи; другие поставщики ограничивают совпадение отображением имени и адреса. Проверка свободного входа часто реализуется, проверяя только имя дисплея. 
  
## <a name="notes-to-host-address-book-provider-implementers"></a>Заметки для организаторов поставщиков адресных книг

Если контейнер может создавать записи из шаблонов других поставщиков, реализация **CreateEntry** должна обеспечить хранение некоторых или всех свойств, связанных с созданными записями. Например, если вы предоставляете **хранилище** для свойства PR_DETAILS_TABLE входа [(PidTagDetailsTable),](pidtagdetailstable-canonical-property.md)вы можете создать диалоговое окно его сведений без необходимости зависеть от иностранного поставщика. 
  
Если контейнер может создавать **записи, поддерживаюные свойство PR_TEMPLATEID** [(PidTagTemplateid),](pidtagtemplateid-canonical-property.md)реализация **CreateEntry** должна сделать следующее: 
  
1. Вызов метода [IMAPISupport::OpenTemplateID.](imapisupport-opentemplateid.md) **OpenTemplateID** позволяет коду иностранного поставщика для входа привязаться к создаемой новой записи. Иностранные поставщики поддерживают этот процесс привязки для поддержания контроля над записями, созданными из их шаблонов, в контейнеры поставщиков адресных книг хост-адресов. 
    
2. Выполните любую необходимую инициализацию и заполнять новый объект всеми свойствами из записи в иностранном поставщике, возвращаемом объектом в _параметре lppMAPIPropNew_ из **OpenTemplateID.**
    
Если **openTemplateID** успешно, скопируйте свойства для реализации, на которые указывает параметр _lppMAPIPropNew,_ а не непосредственно к реализации, на который указывает параметр _lpMAPIPropData._ Инициализация новой записи для автономного использования, как и любая другая запись от иностранного поставщика. 
  
Если **OpenTemplateID** возвращает ошибку, **CreateEntry** должен не сбой. Не допускайте создания записи. Так как иностранный поставщик может делать предположения о данных в поставщике, не создайте запись с идентификатором шаблона, который не был успешно привязан к иностранному поставщику. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Когда **CreateEntry** возвращается, вы можете или не сможете сразу получить доступ к идентификатору записи для новой записи. Некоторые поставщики адресных книг не делают ее доступной до тех пор, пока не будет вызван метод [IMAPIProp::SaveChanges.](imapiprop-savechanges.md) 
  
Несмотря на то, что дублирующие флаги проверки передаются в качестве параметров **в CreateEntry,** операция проверки дубликатов не будет происходить до тех пор, пока не будет **вызвано saveChanges.** Поэтому связанные ошибки, такие как MAPI_E_COLLISION, которые указывают на то, что была предпринята попытка создать уже существующую запись, возвращаются **saveChanges,** а не **CreateEntry**.
  
## <a name="see-also"></a>См. также



[IABContainer::CopyEntries](iabcontainer-copyentries.md)
  
[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[Каноническое свойство PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)
  
[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md)


---
title: Иабконтаинеркреатинтри
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABContainer.CreateEntry
api_type:
- COM
ms.assetid: ea1daf74-d9e3-4304-bf5d-889afeea6ae9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9f80130279e3437dd9be947de97d3f0d4181165e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411276"
---
# <a name="iabcontainercreateentry"></a>IABContainer::CreateEntry

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает новую запись, которая может быть пользователем обмена сообщениями, списком рассылки или другим контейнером.
  
```cpp
HRESULT CreateEntry(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulCreateFlags,
  LPMAPIPROP FAR * lppMAPIPropEntry
);
```

## <a name="parameters"></a>Параметры

 _Кбентрид_
  
> возврата Количество байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _Лпентрид_
  
> возврата Указатель на идентификатор записи шаблона для создания новых записей определенного типа. 
    
 _Улкреатефлагс_
  
> возврата Битовая маска флагов, определяющих порядок выполнения создания записи. Можно задать следующие флаги:
    
КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ 
  
> Необходимо выполнить свободный уровень проверки повторяющихся записей. Реализация свободной проверки повторяющихся записей определяется поставщиком. Например, поставщик может определить нестрогое совпадение как любые две записи с одинаковым отображаемым именем.
    
КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ 
  
> Необходимо выполнить определенный уровень проверки дубликатов записей. Реализация проверки на уникальность повторяющихся записей определяется поставщиком. Например, поставщик может определить в качестве значения для всех двух элементов с одинаковым отображаемым именем и адресом для обмена сообщениями.
    
КРЕАТЕ_РЕПЛАЦЕ 
  
> Новая запись должна заменить существующую, если она определена как дубликаты.
    
 _Лппмапипропентри_
  
> вышли Указатель на указатель на вновь созданный элемент.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Новая запись успешно создана.
    
## <a name="remarks"></a>Примечания

Метод **иабконтаинер:: креатинтри** создает новую запись определенного типа в указанном контейнере, возвращая указатель на реализацию интерфейса для последующего доступа к записи. Новая запись создается с помощью шаблона, выбранного из списка доступных шаблонов контейнера, опубликованных в обратной таблице. Вызывающие абоненты обращаются к одноразовой таблице контейнера, вызывая метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) и запрашивая свойство **пр_креате_темплатес** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)). 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Все контейнеры, поддерживающие метод **иабконтаинер:: креатинтри** , должны быть изменяемыми. Установите флаг АБ_МОДИФИАБЛЕ контейнера в его свойстве **пр_контаинер_флагс** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), чтобы указать, что он является изменяемым. 
  
Вы должны поддерживать все флаги _улкреатефлагс_ . Однако интерпретация и использование этих флагов зависит от реализации, то есть можно определить семантику КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ и КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ в контексте реализации. Если не удается определить, является ли запись повторяющейся, всегда разрешите создание записи. 
  
Некоторые поставщики реализуют четкие проверки ввода, сопоставляя отображаемое имя, адрес для обмена сообщениями и ключ поиска в записи; другие поставщики ограничивают подходящими для отображаемого имени и адреса. НеСтрогая проверка ввода часто реализуется только путем проверки отображаемого имени. 
  
## <a name="notes-to-host-address-book-provider-implementers"></a>Примечания для размещения средств реализации поставщика адресных книг

Если ваш контейнер может создавать записи из шаблонов других поставщиков, ваша реализация **креатинтри** должна предоставлять хранилище для некоторых или всех свойств, связанных с созданными записями. Например, если вы предоставляете хранилище для свойства **пр_детаилс_табле** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)), вы можете создать его диалоговое окно со сведениями, не зависят от внешнего поставщика. 
  
Если ваш контейнер может создавать записи, поддерживающие свойство **пр_темплатеид** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)), реализация **креатинтри** должна выполнять следующие действия: 
  
1. ВыЗовите метод [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md) . **Опентемплатеид** включает код внешнего поставщика для записи, которая будет привязана к создаваемой новой записи. Внешние поставщики поддерживают этот процесс привязки для поддержания контроля над записями, созданными из их шаблонов, в контейнерах поставщиков адресных книг узла. 
    
2. Выполните все необходимые действия по инициализации и заполните новый объект всеми свойствами из записи в внешнем поставщике, который возвращает объект в параметре _лппмапипропнев_ из **опентемплатеид**.
    
Если **опентемплатеид** успешно, скопируйте свойства в реализацию, на которую указывает параметр _лппмапипропнев_ , а не непосредственно к реализации, на которую указывает параметр _лпмапипропдата_ . Инициализируйте новую запись для использования в автономном режиме, как и любой другой ввод из внешнего поставщика. 
  
Если **опентемплатеид** возвращает ошибку, **креатинтри** не должно вызывать ошибку. Не разрешать создание записи. Так как внешний поставщик может делать предположения относительно данных в вашем поставщике, не создавайте запись с идентификатором шаблона, который не был успешно привязан к внешнему поставщику. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Когда возвращается значение **креатинтри** , вы можете или не сможете немедленно получить доступ к идентификатору записи для новой записи. Некоторые поставщики адресных книг не делают ее доступными до тех пор, пока не будет вызван метод New записи [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) . 
  
Несмотря на то что в качестве параметров в **креатинтри**передаются флаги проверки дубликатов, операция проверки на совпадение не выполняется, пока не будет вызван метод **SaveChanges** . Таким образом, связанные ошибки, такие как МАПИ_Е_КОЛЛИСИОН, которые указывают, что была предпринята попытка создать уже существующую запись, она возвращается методом **SaveChanges** , а не **креатинтри**.
  
## <a name="see-also"></a>См. также



[IABContainer::CopyEntries](iabcontainer-copyentries.md)
  
[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[Каноническое свойство PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)
  
[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md)


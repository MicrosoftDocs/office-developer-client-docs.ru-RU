---
title: IABContainerCreateEntry
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABContainer.CreateEntry
api_type:
- COM
ms.assetid: ea1daf74-d9e3-4304-bf5d-889afeea6ae9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: acf9cee9bf0713b909b0d82fc606b015ac28474e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808731"
---
# <a name="iabcontainercreateentry"></a>IABContainer::CreateEntry

  
  
**Относится к**: Outlook 
  
Создает новый объект, который может быть обмена сообщениями пользователя, в список рассылки или другой контейнер.
  
```cpp
HRESULT CreateEntry(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulCreateFlags,
  LPMAPIPROP FAR * lppMAPIPropEntry
);
```

## <a name="parameters"></a>Параметры

 _cbEntryID_
  
> [in] Число байт в идентификаторе запись указывает параметр _lpEntryID_ . 
    
 _lpEntryID_
  
> [in] Указатель на идентификатор записи шаблон для создания новых записей определенного типа. 
    
 _ulCreateFlags_
  
> [in] Битовая маска флаги, который определяет, как выполняется операция создания. Можно задать следующие флажки:
    
CREATE_CHECK_DUP_LOOSE 
  
> Следует выполнять свободном уровень проверки повторяющиеся записи. Реализация проверки свободном дубликат зависит от поставщика. Например поставщик можно определить неточное соответствие две записи, с одинаковым отображаемое имя.
    
CREATE_CHECK_DUP_STRICT 
  
> Следует выполнять строго уровень проверки повторяющиеся записи. Реализация strict дубликат проверки зависит от поставщика. Например поставщик можно определить строгое соответствие две записи, оба с одинаковым отображать имя и адрес для сообщений.
    
CREATE_REPLACE 
  
> Новая запись необходимо заменить существующий, если определено, что они дубликатов.
    
 _lppMAPIPropEntry_
  
> [out] Указатель на указатель на созданный элемент.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Новая запись успешно создан.
    
## <a name="remarks"></a>Замечания

Метод **IABContainer::CreateEntry** создает новую запись определенного типа в указанном контейнере, указатель возвращается в реализации интерфейса дальнейший доступ к записи. Новая запись создается с помощью шаблона, который был выбран из контейнера списка доступных шаблонов, опубликованные в одноразовых таблице. Абоненты доступ к таблице одноразовых контейнер путем вызова метода [IMAPIProp::OpenProperty](imapiprop-openproperty.md) и разрешения на запрос свойства **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)). 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Все контейнеры, поддерживающие метод **IABContainer::CreateEntry** значения можно изменить. Установите флаг AB_MODIFIABLE контейнера в своем свойстве **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), чтобы указать, что он или нет. 
  
Вы должны поддерживать все флажки _ulCreateFlags_ . Тем не менее, интерпретации и использовании этих флагов зависит от реализации, то есть, вы можете определить означает в контексте внедрения семантика CREATE_CHECK_DUP_LOOSE и CREATE_CHECK_DUP_STRICT. Если не удается или не определить, является ли запись дубликата всегда разрешать записи, которую требуется создать. 
  
Некоторые поставщики реализации строго запись при проверке соответствия отображаемое имя системы обмена сообщениями адрес и ключа поиска в запись; прочие ограничения совпадение, чтобы отобразить имя и адрес. Проверка свободного запись часто реализуется проверка только отображаемое имя. 
  
## <a name="notes-to-host-address-book-provider-implementers"></a>Примечания для размещения специалистов по внедрению поставщик адресной книги

Если контейнера можно создавать записи на основе шаблонов других поставщиков, внедрения **CreateEntry** предоставьте хранилища для некоторых или всех свойств, связанных с созданные операции. Например при указании хранилища для свойства элемента **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) можно создать его диалоговое окно сведений о без необходимости зависят от внешнего поставщика. 
  
Если контейнера можно создавать записи, которые поддерживают свойство **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)), внедрения **CreateEntry** необходимо выполнить следующее: 
  
1. Вызовите метод [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) . **OpenTemplateID** включает код внешнего поставщика для записи для привязки к создаваемой новую запись. Внешний поставщиков поддерживает этот процесс привязки для контроля за операции, созданные из своих шаблонов в контейнеры узла поставщиками адресной книги. 
    
2. Выполнить инициализацию и внесите в новый объект со всеми свойствами из записи в внешнего поставщика, возвращенный объект с помощью параметра _lppMAPIPropNew_ из **OpenTemplateID**.
    
При успешном **OpenTemplateID** скопируйте свойства в реализации указывает параметр _lppMAPIPropNew_ , а не непосредственно к реализации, на который указывает параметр _lpMAPIPropData_ . Инициализация новую запись в автономном режиме, как и любой другой записи от внешнего поставщика. 
  
Если **OpenTemplateID** возвращает ошибку, **CreateEntry** следует с ошибкой. Не разрешать записи, которую требуется создать. Так как внешнего поставщика можно оценить данные в ваш поставщик, не создают запись с идентификатором шаблона, который не был успешно привязан к внешнего поставщика. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При возврате **CreateEntry** , можно или не удается для немедленного доступа к идентификатор записи для новой записи. Некоторые поставщиками адресной книги не сделать его доступным только после вызова метода [IMAPIProp::SaveChanges](imapiprop-savechanges.md) новая запись. 
  
Несмотря на то, что повторяющихся проверки флаги передаются в качестве параметров для **CreateEntry**, дубликат проверку не выполняется до вызова метода **SaveChanges** . Таким образом связанных с ними ошибки, например MAPI_E_COLLISION, это означает, что была предпринята попытка создание уже существующей записи, возвращаемые **SaveChanges** , а не **CreateEntry**.
  
## <a name="see-also"></a>См. также



[IABContainer::CopyEntries](iabcontainer-copyentries.md)
  
[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[Каноническое свойство PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)
  
[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md)


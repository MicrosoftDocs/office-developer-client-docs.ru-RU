---
title: IMAPITableSetColumns
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SetColumns
api_type:
- COM
ms.assetid: 9a39cf8d-df0f-493c-b272-f15c65b3f15e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 897330feb216dbc3ab143378977c77141cf488f0
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416351"
---
# <a name="imapitablesetcolumns"></a>IMAPITable::SetColumns

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Определяет конкретные свойства и порядок свойств, которые будут отображаться в качестве столбцов в таблице.
  
```cpp
HRESULT SetColumns(
LPSPropTagArray lpPropTagArray,
ULONG ulFlags
);
```

## <a name="parameters"></a>Parameters

 _lpPropTagArray_
  
> [in] Указатель на массив тегов свойств, определяющих свойства, которые должны быть включены в качестве столбцов в таблице. Часть типа свойства каждого тега может быть назначена допустимым типом или PR_NULL для **резерва** места для последующих дополнений. Параметр  _lpPropTagArray_ не может быть задан в NULL; каждая таблица должна иметь по крайней мере один столбец. 
    
 _ulFlags_
  
> [in] Bitmask флагов, которые контролируют возвращение асинхронного вызова **в SetColumns,** например, когда **SetColumns** используется в уведомлении. Можно установить следующие флаги: 
    
TBL_ASYNC 
  
> Запросы на асинхронное выполнение операции настройки столбца, из-за чего **SetColumns** потенциально возвращается до полного завершения операции. 
    
TBL_BATCH 
  
> Позволяет таблице отложить операцию настройки столбца до тех пор, пока данные не потребуются.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция установки столбца была успешной.
    
MAPI_E_BUSY 
  
> В настоящее время продолжается другая операция, которая не позволяет начать операцию установки столбца. Либо операция должна быть разрешена к завершению, либо она должна быть остановлена.
    
## <a name="remarks"></a>Примечания

Набор столбцов таблицы — это группа свойств, которые составляют столбцы для строк в таблице. Для каждого типа таблицы установлен столбец по умолчанию. Набор столбцов по умолчанию состоит из свойств, которые автоматически включает в себя реализутель таблицы. Пользователи таблицы могут изменить этот набор по умолчанию, назвав **метод IMAPITable::SetColumns.** Они могут запрашивать, чтобы другие столбцы были добавлены в набор по умолчанию, если реализутель таблицы поддерживает их удаление столбцов или изменения порядка столбцов. **SetColumns** указывает столбцы, возвращаемые с каждой строкой, и порядок этих столбцов в строке. 
  
Успешность операции **SetColumns** становится очевидной только после последующего вызова для получения данных таблицы. После этого сообщается о любых ошибках. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Некоторые поставщики позволяют **вызову SetColumns** заказать только столбцы таблиц, которые являются частью доступных столбцов для представления таблицы. Другие поставщики позволяют **вызову SetColumns** заказать все столбцы таблиц, включая те, которые содержат свойства, не содержащиеся в исходном наборе столбцов. 
  
Если TBL_BATCH для асинхронных операций, поставщики должны возвращать тип свойства PT_ERROR и значение свойства NULL для столбцов, которые не поддерживаются.
  
Не нужно отвечать на флаг TBL_ASYNC, чтобы операция была асинхронной. Если вы не поддерживаете определение набора асинхронных столбцов, выполните операцию синхронно. Если вы можете поддерживать флаг TBL_ASYNC и еще одна асинхронная операция все еще находится в процессе выполнения, MAPI_E_BUSY. В противном случае S_OK независимо от того, поддерживаете ли вы все свойства, включенные в массив тегов свойств. Ошибки, полученные в результате неподтверченных свойств, должны возвращаться из **методов IMAPITable,** которые извлекали данные, такие как **QueryRows.** 
  
Не создавать уведомления для строк таблиц, которые скрыты от просмотра вызовами **для ограничения.** 
  
При отправке уведомлений таблицы порядок  свойств в [](table_notification.md) строке члена структуры TABLE_NOTIFICATION и порядок, заданный последним вызовом **SetColumns,** должны быть одинаковыми с моментом отправки запроса уведомления. 
  
Другой флаг, TBL_BATCH, позволяет звонителям указать, что реализутель таблицы может отложить оценку результатов операции до более позднего времени. По возможности звонителям следует установить этот флаг, так как пакетная операция повышает производительность.
  
Часто звонителям удобно зарезервировать некоторые столбцы в наборе извлеченных строк для значений, которые будут добавлены позже. Звонители делают **это, PR_NULL** [(PidTagNull)](pidtagnull-canonical-property.md)в нужные позиции в массиве тегов свойств, переданных **в SetColumns;** затем таблица будет передавать **PR_NULL** на этих позициях во всех строках, извлеченных с **помощью QueryRows.**
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При создании массива тегов свойств для  _параметра lpPropTagArray_ заказать теги в том порядке, в который должны отображаться столбцы в представлении таблицы. 
  
Можно указать многооценные свойства, которые необходимо включить в столбец, применив к тегу свойства многоценный флаг экземпляра или MVI_FLAG константу. Установите этот флаг, передав тег свойства для одноочная версия свойства в качестве параметра для макроса MVI_PROP следующим образом:
  
```
MVI_PROP(ulPropTag)

```

Макрос MVI_PROP будет MVI_FLAG для свойства, превратив тег в многоценный тег. Если вы ошибочно попробуете вызвать MVI_PROP одно значение свойства, MAPI проигноризовует вызов и оставит тег свойства без изменений. 
  
Можно включить теги свойств, **PR_NULL** в массив тегов свойств, чтобы зарезервировать место в наборе столбцов. Пространство для хранения позволяет добавлять в набор столбцов без выделения нового массива тегов свойств. 
  
Если вызов **в SetColumns** вызывает изменение порядка столбцов таблицы, и один или несколько из этих столбцов представляют многоценное свойство, можно увеличить количество строк в таблице. Если это произойдет, все закладки для таблицы будут отброшены. Дополнительные сведения о том, как многоценные столбцы влияют на таблицы, см. в статье [Working with Multivalued Columns.](working-with-multivalued-columns.md)
  
Установка столбцов по умолчанию является синхронной операцией. Однако можно разрешить таблице отложить операцию до тех пор, пока данные не будут необходимы, установив TBL_BATCH флаг. Установка этого флага может повысить производительность. Другой флаг, TBL_ASYNC, делает операцию асинхронной, что позволяет **SetColumns** возвращаться до завершения операции. Чтобы определить время завершения, позвоните [по телефону IMAPITable::GetStatus](imapitable-getstatus.md).
  
Если вызов **в SetColumns** возвращается MAPI_E_BUSY, указав, что другая операция препятствует запуску операции, вы можете вызвать [IMAPITable::Abort,](imapitable-abort.md) чтобы остановить операцию в процессе. 
  
Вы также можете вызвать [HrAddColumnsEx для](hraddcolumnsex.md) изменения набора столбцов. Разница между **HrAddColumnsEx** и **IMAPITable::SetColumns** заключается в том, что **HrAddColumnsEx** менее гибка; он может добавлять только столбцы. Дополнительные столбцы размещаются в начале набора столбцов; все существующие столбцы отображаются после этих столбцов. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |CContentsTableListCtrl::D SetColumns  <br/> |MFCMAPI использует **метод IMAPITable::SetColumns** для набора нужных столбцов для таблицы.  <br/> |
   
## <a name="see-also"></a>См. также



[HrQueryAllRows](hrqueryallrows.md)
  
[IMAPITable::Abort](imapitable-abort.md)
  
[IMAPITable::GetRowCount](imapitable-getrowcount.md)
  
[IMAPITable::QueryColumns](imapitable-querycolumns.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::Restrict](imapitable-restrict.md)
  
[IMAPITable::SortTable](imapitable-sorttable.md)
  
[SPropTagArray](sproptagarray.md)
  
[SPropValue](spropvalue.md)
  
[SRowSet](srowset.md)
  
[TABLE_NOTIFICATION](table_notification.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


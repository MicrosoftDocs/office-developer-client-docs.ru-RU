---
title: IMAPITableSetColumns
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SetColumns
api_type:
- COM
ms.assetid: 9a39cf8d-df0f-493c-b272-f15c65b3f15e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 9eeab1e1186aeb5a9b458facd59bd4cc155e8014
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809224"
---
# <a name="imapitablesetcolumns"></a>IMAPITable::SetColumns

  
  
**Относится к**: Outlook 
  
Определяет конкретного свойства и порядок свойств в виде столбцов в таблице.
  
```cpp
HRESULT SetColumns(
LPSPropTagArray lpPropTagArray,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpPropTagArray_
  
> [in] Указатель на массив тегов свойств, идентифицирующий свойства в качестве столбцов в таблице. Тип свойства часть каждого тега может быть присвоено недопустимого типа или **PR_NULL** зарезервировать место для последующего добавления. Параметр _lpPropTagArray_ не может иметь значение NULL. Каждый таблица должна иметь по крайней мере один столбец. 
    
 _ulFlags_
  
> [in] Битовая маска флаги, который управляет return асинхронный вызов **метода SetColumns**, например, при использовании **метода SetColumns** в уведомлении. Можно задать следующие флажки: 
    
TBL_ASYNC 
  
> Запросы, которые операции задания столбца быть выполнена асинхронно вызывает ошибку **метода SetColumns** потенциально возвращает перед полностью завершения операции. 
    
TBL_BATCH 
  
> Позволяет таблице отложить операцию параметр столбца, пока данные не требуется.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Столбец параметр операция выполнена успешно.
    
MAPI_E_BUSY 
  
> В, не позволяющей столбца, установка операция запуск выполняется другой операции. В процессе выполнения операции должны выполнить либо должна быть остановлена.
    
## <a name="remarks"></a>Замечания

Набор столбцов таблицы — набор свойств, которые будут включены в столбцы для строки в таблице. Существует столбец по умолчанию для каждого типа в таблице. Набор столбцов по умолчанию, состоящих из свойства, которые разработчик таблицы автоматически включает в себя. Таблица пользователей можно изменить это значение по умолчанию, задайте путем вызова метода **IMAPITable::SetColumns** . Они могут запросить, что остальные столбцы добавляется к набору Если разработчик в таблице поддерживает их удаления столбцов или изменить порядок столбцов по умолчанию. **Метода SetColumns** указывает столбцы, возвращаемые с каждой строки и порядок этих столбцов в строке. 
  
Успешное выполнение **метода SetColumns** происходит только после последующих вызовов для извлечения данных из таблицы. Затем это сообщает об ошибках. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Некоторые поставщики разрешить вызов **метода SetColumns** заказ только столбцов таблицы, которые входят в состав доступные столбцы для представления таблицы. Прочие разрешить вызов **метода SetColumns** заказ всех столбцов таблицы, включая те, содержащий свойства не в наборе исходного столбца. 
  
Если TBL_BATCH для асинхронной операции, поставщики должен возвращать типа свойства PT_ERROR и свойство значение NULL для столбцов, которые не поддерживаются.
  
Необходимо ответить на TBL_ASYNC флаг разрешения на запрос, что быть асинхронной операции. Если вы не поддерживают определение набора асинхронных столбца, синхронно выполнения операции. Если может поддерживать флаг TBL_ASYNC и другой асинхронной операции выполняется по-прежнему в, возвращаемого MAPI_E_BUSY. В противном случае возвращает значение S_OK независимо от того, ли все свойства, включенные в массиве свойство tag поддерживать. Ошибки, связанные с неподдерживаемые свойства должны возвращаться из **IMAPITable** методы для получения данных, таких как **QueryRows**. 
  
Не создавать уведомления для строки таблицы, которые являются скрытыми от режима отображения путем вызова **Restrict**. 
  
После отправки уведомлений в таблице, порядок свойств в элемент **строки** [TABLE_NOTIFICATION](table_notification.md) структуры и порядок указанного с самыми последними вызова **метода SetColumns** должны быть одинаковыми по состоянию на время, запрашивать уведомление отправлено. 
  
Другой флаг, TBL_BATCH, позволяет вызывающих объектов указать, что разработчик в таблице можно отложить оценка результаты операции на более поздний срок. По возможности абонентов следует задать этот флаг, поскольку пакетной операции повышает производительность.
  
Часто удобно для абонентов на бронирование некоторые столбцы в наборе строк извлеченных для значения, добавляемые позже. Вызывающие этого путем добавления **PR_NULL** ([PidTagNull](pidtagnull-canonical-property.md)) в нужное положение в массиве тега свойства, передаваемые **метода SetColumns**; Таблица будет затем обратно прохода **PR_NULL** в этих положениях все строки извлекается с **QueryRows**.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При создании массива тега свойства для параметра _lpPropTagArray_ заказа теги в порядке столбцов, отображаемых в представлении таблицы. 
  
Можно указать многозначные свойства, которые будут включены в набор, применив флаг многозначных экземпляра или константа MVI_FLAG тега свойства столбцов. Установите этот флаг, передав свойство тег для версии одним значением свойства как параметр макрос MVI_PROP следующим образом:
  
```
MVI_PROP(ulPropTag)

```

Макрос MVI_PROP устанавливающей MVI_FLAG для свойства отсутствию тега в многозначных тег. Если по ошибке попытка вызвать MVI_PROP для свойства с одним значением, MAPI пропуск вызов и оставьте без изменений тега свойства. 
  
Может включать свойство теги для **PR_NULL** в массиве свойство tag резервирует место в наборе столбцов. Резервирование места позволяет добавить в набор без необходимости выделить новый массив тега свойства столбцов. 
  
При вызове **метода SetColumns** являются причиной изменения порядку столбцов таблицы и одной или нескольких из этих столбцов представления многозначные свойства, существует возможность количество строк в таблице, чтобы увеличить. В этом случае все закладки для таблицы удаляются. Дополнительные сведения о том, как многозначные столбцы влияет на таблицы, работу [с несколькими значениями столбцов](working-with-multivalued-columns.md).
  
Настройка столбцов по умолчанию является синхронный режим. Тем не менее можно разрешить таблице откладывать операции до тех пор данные, необходимые путем установки флага TBL_BATCH. Установка этого флага может повысить производительность. Другой флаг TBL_ASYNC, выполняет операцию асинхронной, позволяя **метода SetColumns** для возврата до завершения операции. Чтобы определить, когда происходит завершение работы, вызовите [IMAPITable::GetStatus](imapitable-getstatus.md).
  
Если вызов **метода SetColumns** возвращает MAPI_E_BUSY, указывающего на то, что операция другой препятствует операции запуска, можно вызвать [IMAPITable::Abort](imapitable-abort.md) , чтобы отменить эту операцию в процессе выполнения. 
  
Можно также вызвать [HrAddColumnsEx](hraddcolumnsex.md) , чтобы изменить набор столбцов. Различие между **HrAddColumnsEx** и **IMAPITable::SetColumns** является **HrAddColumnsEx** менее гибкие; его можно только добавить столбцы. Дополнительные столбцы помещаются в начале набор столбцов; все существующие столбцы отображаются следующие столбцы. 
  
## <a name="mfcmapi-reference"></a>Справочник по mfcmapi (en)

������ ���� mfcmapi (en) ���������� � ������� ����.
  
|**����**|**�������**|**�����������**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |CContentsTableListCtrl::DoSetColumns  <br/> |Mfcmapi (en) используется метод **IMAPITable::SetColumns** для определения нужные столбцы для таблицы.  <br/> |
   
## <a name="see-also"></a>См. также



[HrQueryAllRows](hrqueryallrows.md)
  
[IMAPITable::Abort](imapitable-abort.md)
  
[IMAPITable::GetRowCount](imapitable-getrowcount.md)
  
[IMAPITable::QueryColumns](imapitable-querycolumns.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::Restrict](imapitable-restrict.md)
  
[IMAPITable::SortTable](imapitable-sorttable.md)
  
[SPropTagArray](sproptagarray.md)
  
[SPropValue](spropvalue.md)
  
[SRowSet](srowset.md)
  
[TABLE_NOTIFICATION](table_notification.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


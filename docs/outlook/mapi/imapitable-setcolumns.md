---
title: IMAPITableSetColumns
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SetColumns
api_type:
- COM
ms.assetid: 9a39cf8d-df0f-493c-b272-f15c65b3f15e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 897330feb216dbc3ab143378977c77141cf488f0
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416351"
---
# <a name="imapitablesetcolumns"></a>IMAPITable::SetColumns

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Определяет конкретные свойства и порядок их появления в качестве столбцов в таблице.
  
```cpp
HRESULT SetColumns(
LPSPropTagArray lpPropTagArray,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpPropTagArray_
  
> [in] Указатель на массив тегов свойств, определяющих свойства, которые необходимо включить в качестве столбцов в таблице. Для части типа свойства каждого тега можно установить  допустимый тип или PR_NULL зарезервировать место для последующих дополнений. Для  _параметра lpPropTagArray_ нельзя установить NULL; каждая таблица должна иметь по крайней мере один столбец. 
    
 _ulFlags_
  
> [in] Битоваяmas флагов, которая управляет возвратом асинхронного вызова **SetColumns,** например, если **SetColumns** используется в уведомлении. Можно установить следующие флаги: 
    
TBL_ASYNC 
  
> Запрашивает выполнение операции настройки столбца асинхронно, из-за чего **SetColumns** потенциально возвращается до полного завершения операции. 
    
TBL_BATCH 
  
> Позволяет таблице отложить операцию настройки столбца до тех пор, пока данные не потребуются.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция настройки столбца прошла успешно.
    
MAPI_E_BUSY 
  
> В настоящее время идет другая операция, которая препятствует запуску операции настройки столбца. Либо операция должна быть разрешена для завершения, либо она должна быть остановлена.
    
## <a name="remarks"></a>Примечания

Набор столбцов таблицы — это группа свойств, которые составляют столбцы для строк в таблице. Существует набор столбцов по умолчанию для каждого типа таблицы. Набор столбцов по умолчанию состоит из свойств, которые автоматически включает в себя реализутель таблицы. Пользователи таблицы могут изменить этот набор по умолчанию, вызывая метод **IMAPITable::SetColumns.** Они могут запросить, чтобы другие столбцы были добавлены в набор по умолчанию, если реализутель таблицы поддерживает их удаление столбцов или чтобы изменить порядок столбцов. **SetColumns** указывает столбцы, которые возвращаются с каждой строкой, и порядок этих столбцов в строке. 
  
Успешность операции **SetColumns** становится очевидной только после последующего вызова для получения данных таблицы. После этого сообщается о любых ошибках. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Некоторые поставщики позволяют вызвать **SetColumns,** чтобы указать только столбцы таблицы, которые являются частью доступных столбцов для представления таблицы. Другие поставщики позволяют **вызову SetColumns** указать все столбцы таблицы, включая те, которые содержат свойства, не в исходном наборе столбцов. 
  
Если TBL_BATCH для асинхронных операций, поставщики должны возвращать тип свойства PT_ERROR и значение NULL для столбцов, которые не поддерживаются.
  
Вам не нужно отвечать на флаг TBL_ASYNC запроса на асинхронную операцию. Если определение набора асинхронных столбцов не поддерживается, выполните операцию синхронно. Если вы можете поддерживать флаг TBL_ASYNC и еще одна асинхронная операция все еще находится в процессе выполнения, MAPI_E_BUSY. В противном случае S_OK независимо от того, поддерживаете ли вы все свойства, включенные в массив тегов свойств. Ошибки, полученные из неподтверченных свойств, следует возвращать из методов **IMAPITable,** которые извлекает данные, например **QueryRows.** 
  
Не создавать уведомления для строк таблиц, скрытых из представления вызовами **ограничения.** 
  
При отправке уведомлений о таблице порядок свойств в члене строки структуры [TABLE_NOTIFICATION](table_notification.md) и порядок, указанный самым последним вызовом **SetColumns,** должны быть одинаковыми на момент отправки запроса уведомления.  
  
Другой флаг, TBL_BATCH, позволяет звонятелям указать, что реализующий таблицу может отложить оценку результатов операции до более позднего времени. По возможности вызывателям следует установить этот флаг, так как пакетная операция повышает производительность.
  
Часто звонятелям удобно резервировать некоторые столбцы в наборе полученных строк для значений, которые будут добавлены позже. Для этого вызыватели **размещают PR_NULL** ([PidTagNull)](pidtagnull-canonical-property.md)в нужных позициях в массиве тегов свойств, переданном **в SetColumns;** затем таблица возвращает данные **PR_NULL** на этих позициях во всех строках, полученных с **помощью QueryRows.**
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При создании массива тегов свойств для параметра  _lpPropTagArray_ упорядочение тегов в том порядке, в который должны отображаться столбцы в представлении таблицы. 
  
Вы можете указать многоценные свойства, которые необходимо включить в набор столбцов, применив к тегу свойства многоценный флаг экземпляра MVI_FLAG константу. Установите этот флаг, передав тег свойства для одно значение версии свойства в качестве параметра в макрос MVI_PROP следующим образом:
  
```
MVI_PROP(ulPropTag)

```

Макрос MVI_PROP будет MVI_FLAG для свойства, превращая тег в многоценный тег. Если вы ошибочно попытались вызвать MVI_PROP свойство с одним значением, MAPI игнорирует вызов и оставляет тег свойства без изменений. 
  
Вы можете включить теги свойств, **PR_NULL** в массив тегов свойств, чтобы зарезервировать место в наборе столбцов. Пространство для хранения позволяет добавлять набор столбцов, не выделяя новый массив тегов свойств. 
  
Если вызов **SetColumns** приводит к изменению порядка столбцов таблицы, а один или несколько из этих столбцов представляют многоценное свойство, число строк в таблице может увеличиться. В этом случае все закладки для таблицы удаляются. Дополнительные сведения о том, как многоценные столбцы влияют на таблицы, см. в статье "Работа с [многоценными столбцами".](working-with-multivalued-columns.md)
  
Установка столбцов по умолчанию является синхронной операцией. Однако можно разрешить таблице откладывать операцию до тех пор, пока не будут необходимы данные, установив TBL_BATCH флага. Установка этого флага может повысить производительность. Другой флаг, TBL_ASYNC, делает операцию асинхронной, позволяя **SetColumns** возвращаться до завершения операции. Чтобы определить время завершения, вызовите [IMAPITable::GetStatus.](imapitable-getstatus.md)
  
Если вызов **SetColumns** возвращает MAPI_E_BUSY, что другая операция препятствует запуску операции, можно вызвать [IMAPITable::Abort,](imapitable-abort.md) чтобы остановить операцию. 
  
Вы также можете вызвать [HrAddColumnsEx,](hraddcolumnsex.md) чтобы изменить набор столбцов. Разница между **HrAddColumnsEx** и **IMAPITable::SetColumns** заключается в том, что **HrAddColumnsEx** менее гибкая; он может добавлять только столбцы. Дополнительные столбцы размещаются в начале набора столбцов; Все существующие столбцы отображаются после этих столбцов. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|ContentsTableListCtrl.cpp  <br/> |CContentsTableListCtrl::D oSetColumns  <br/> |MFCMAPI использует метод **IMAPITable::SetColumns,** чтобы установить нужные столбцы для таблицы.  <br/> |
   
## <a name="see-also"></a>См. также



[HrQueryAllRows](hrqueryallrows.md)
  
[IMAPITable::Abort](imapitable-abort.md)
  
[IMAPITable::GetRowCount](imapitable-getrowcount.md)
  
[IMAPITable::QueryColumns](imapitable-querycolumns.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::Restrict](imapitable-restrict.md)
  
[IMAPITable::SortTable](imapitable-sorttable.md)
  
[SPropTagArray](sproptagarray.md)
  
[SPropValue](spropvalue.md)
  
[SRowSet](srowset.md)
  
[TABLE_NOTIFICATION](table_notification.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: имапитаблесетколумнс
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPITable.SetColumns
api_type:
- COM
ms.assetid: 9a39cf8d-df0f-493c-b272-f15c65b3f15e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 897330feb216dbc3ab143378977c77141cf488f0
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416351"
---
# <a name="imapitablesetcolumns"></a>IMAPITable::SetColumns

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Определяет определенные свойства и порядок их отображения в виде столбцов в таблице.
  
```cpp
HRESULT SetColumns(
LPSPropTagArray lpPropTagArray,
ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _лппроптагаррай_
  
> возврата Указатель на массив тегов свойств, определяющий свойства, которые необходимо включить в качестве столбцов в таблице. Для части типа свойства каждого тега можно задать допустимый тип или **PR_NULL** зарезервировать пространство для последующих дополнений. Параметр _лппроптагаррай_ не может иметь значение null; у каждой таблицы должен быть по крайней мере один столбец. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют возвратом асинхронного вызова в **метода SetColumns**, например, когда **метода SetColumns** используется в уведомлении. Можно задать следующие флаги: 
    
TBL_ASYNC 
  
> Запрашивает, чтобы операция установки столбца выполнялась асинхронно, вызывая потенциальное возвращение **метода SetColumns** до полного завершения операции. 
    
TBL_BATCH 
  
> Разрешает таблице откладывать операцию установки столбца, пока данные не будут действительно необходимы.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция настройки столбца выполнена успешно.
    
MAPI_E_BUSY 
  
> Выполняется другая операция, которая не позволяет запустить операцию настройки столбца. Выполнение выполняемой операции должно быть разрешено или остановлено.
    
## <a name="remarks"></a>Примечания

Набор столбцов таблицы — это группа свойств, которые составляют столбцы для строк в таблице. Для каждого типа таблицы существует набор столбцов по умолчанию. Набор столбцов по умолчанию состоит из свойств, автоматически включаемых средством реализации таблиц. Пользователи таблицы могут изменить этот набор по умолчанию, вызвав метод **IMAPITable:: метода SetColumns** . Они могут запросить Добавление других столбцов в набор по умолчанию, если средство реализации таблиц поддерживает их удаление или изменение порядка столбцов. **Метода SetColumns** указывает столбцы, возвращаемые с каждой строкой, и порядок этих столбцов в строке. 
  
Успешное выполнение операции **метода SetColumns** очевидно только после выполнения следующего вызова для получения данных таблицы. Затем сообщается о сообщениях об ошибках. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Некоторые поставщики допускают вызов **метода SetColumns** для заказа только тех столбцов таблицы, которые являются частью доступных столбцов для представления таблицы. Другие поставщики допускают вызов **метода SetColumns** для упорядочения всех столбцов таблицы, включая те, которые содержат свойства, не приходящие к исходному набору столбцов. 
  
Если для асинхронных операций задано TBL_BATCH, то поставщики должны возвращать тип свойства PT_ERROR и значение свойства NULL для неподдерживаемых столбцов.
  
Нет необходимости отвечать на флаг TBL_ASYNC, запрашивающий выполнение операции асинхронно. Если вы не поддерживаете определение набора асинхронных столбцов, выполните операцию в синхронном режиме. Если вы можете поддерживать флаг TBL_ASYNC и еще выполняется другая асинхронная операция, возвращайте MAPI_E_BUSY. В противном случае возвращает S_OK, независимо от того, поддерживаются ли все свойства, включенные в массив тегов свойств. Ошибки, вызванные неподдерживаемыми свойствами, возвращаются из методов **IMAPITable** , которые получают данные, например **QueryRows**. 
  
Не создавайте уведомления для строк таблицы, которые скрыты от представления вызовами для **ограничения**. 
  
При отправке уведомлений таблицы порядок следования свойств в элементе **Row** структуры [TABLE_NOTIFICATION](table_notification.md) и порядке, указанному последним вызовом **метода SetColumns** , должен быть таким же, как и при отправке запроса уведомления. 
  
Другой флаг, TBL_BATCH, позволяет звонящим указать, что средство реализации таблиц может отложить оценку результатов операции до следующего момента. Когда это возможно, абонентам следует устанавливать этот флаг, так как пакетная операция повышает производительность.
  
Часто вызывающим абонентам часто удобно зарезервировать некоторые столбцы в извлеченных строках для значений, которые будут добавлены позже. Вызывающим объектам это можно сделать, разместив **PR_NULL** ([PidTagNull](pidtagnull-canonical-property.md)) в нужных позициях в массиве тегов свойств, переданном **метода SetColumns**; затем Таблица передается обратно **PR_NULL** в этих местах во всех строках, полученных с помощью **QueryRows**.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

При создании массива тегов свойств для параметра _лппроптагаррай_ упорядочивайте теги в том порядке, в котором должны отображаться столбцы в представлении таблицы. 
  
Можно указать многозначные свойства, включаемые в набор столбцов, применяя флаг многозначного экземпляра или MVI_FLAG константу к тегу свойства. Установите этот флаг, передав тег свойства для однозначной версии свойства в качестве параметра для макроса MVI_PROP следующим образом:
  
```
MVI_PROP(ulPropTag)

```

Макрос MVI_PROP задает MVI_FLAG для свойства, преобразуя тег в многозначный тег. Если вы ошибочно попытаетесь вызвать MVI_PROP для свойства с одним значением, MAPI проигнорирует вызов и оставит неизменным тег свойства. 
  
Можно включить теги свойств в значение **PR_NULL** в массиве тегов свойств, чтобы зарезервировать пространство в наборе столбцов. Резервирование пространства позволяет добавить в набор столбцов, не выполняя выделение нового массива тегов свойств. 
  
Если при вызове **метода SetColumns** происходит изменение порядка столбцов таблицы и один или несколько этих столбцов представляют многозначное свойство, можно увеличить количество строк в таблице. В таком случае все закладки для таблицы отбрасываются. Дополнительные сведения о том, как Многозначные столбцы влияют на таблицы, можно посмотреть [в разделе Работа с многозначными столбцами](working-with-multivalued-columns.md).
  
Параметр columns по умолчанию является синхронной операцией. Однако можно разрешить таблице отложить операцию до тех пор, пока данные не понадобятся, установив флаг TBL_BATCH. Установка этого флага может увеличить производительность. Другой флаг, TBL_ASYNC, делает операцию асинхронной, позволяя **метода SetColumns** возвращаться до завершения операции. Чтобы определить, когда выполняется завершение, вызовите метод [IMAPITable::.](imapitable-getstatus.md)
  
Если при вызове **метода SetColumns** возвращается MAPI_E_BUSY, указывающий на то, что другая операция препятствует запуску операции, можно вызвать команду [IMAPITable:: Abort](imapitable-abort.md) для остановки выполняемой операции. 
  
Вы также можете вызвать [храддколумнсекс](hraddcolumnsex.md) , чтобы изменить набор столбцов. Разница между **храддколумнсекс** и **IMAPITable:: метода SetColumns** заключается в том, что **храддколумнсекс** является менее гибким; Он может только добавлять столбцы. Дополнительные столбцы помещаются в начало набора столбцов; После этих столбцов отображаются все существующие столбцы. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Контентстаблелистктрл. cpp  <br/> |Кконтентстаблелистктрл::D Осетколумнс  <br/> |MFCMAPI использует метод **IMAPITable:: метода SetColumns** , чтобы задать нужные столбцы для таблицы.  <br/> |
   
## <a name="see-also"></a>См. также



[HrQueryAllRows](hrqueryallrows.md)
  
[IMAPITable::Abort](imapitable-abort.md)
  
[IMAPITable::GetRowCount](imapitable-getrowcount.md)
  
[IMAPITable::QueryColumns](imapitable-querycolumns.md)
  
[IMAPITable::QueryRows](imapitable-queryrows.md)
  
[IMAPITable::Restrict](imapitable-restrict.md)
  
[IMAPITable::SortTable](imapitable-sorttable.md)
  
[SPropTagArray](sproptagarray.md)
  
[SPropValue](spropvalue.md)
  
[SRowSet](srowset.md)
  
[TABLE_NOTIFICATION](table_notification.md)
  
[IMAPITable : IUnknown](imapitableiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


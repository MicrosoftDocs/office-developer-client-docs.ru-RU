---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e43a1d7c57668ba930b4c4af7194bd298971e6ba
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432382"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**Область применения**: Outlook 2013 | Outlook 2016 
  
Определяет функцию вызова, вызываемую мастером профилей, чтобы разрешить поставщику услуг реагировать на события пользователей при от показании листов свойств или страниц поставщика. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiwz.h  <br/> |
|Определенные функции, реализованные в:  <br/> |Поставщики служб  <br/> |
|Определенная функция, вызванная:  <br/> |Мастер профилей MAPI  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>Parameters

_hDlg_
  
> [in] Ручка окна в диалоговом окне Мастер профиля. 
    
_wMsgID_
  
> [in] Сообщение окна, которое будет обработано. Помимо обычных оконных сообщений, ожидаемых в диалоговом окне modal, можно получить следующие сообщения:
    
WM_CLOSE 
  
> Мастер профилей завершен. Поставщик служб должен сделать все необходимые очистки, такие как решение любой динамически выделенной памяти. 
    
WM_COMMAND 
  
> Выбран один из элементов управления поставщика или нажата кнопка **Далее** или Назад.  Значение параметра  _wParam_ указывает, какое из этих событий пользователя произошло. 
    
WM_INITDIALOG 
  
> Пользователь перешел на другую страницу свойства, для которой диалоговое окно должно быть инициализировано. Поставщик должен инициализировать элементы управления, добавленные мастером профилей в диалоговое окно. 
    
WIZ_QUERYNUMPAGES 
  
> Мастер профилей подсказывет количество страниц, которые должен отображать поставщик. Поставщик должен возвращать количество страниц вместо TRUE или FALSE. Например, используйте следующее заявление о возвращении, чтобы указать, что необходимо отобразить три страницы:
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> [in] 32-битный параметр, связанный с сообщениями окна. Возможные значения зависят от сообщения, указанного в _параметре wMsgID._ В дополнение к значениям, ожидаемым при регулярном окне сообщений для модуля диалогового окна, можно получить следующие значения: 
    
WIZ_NEXT 
  
> Когда _wMsgID_ содержит WM_COMMAND, пользователь нажал кнопку **Далее.** 
    
WIZ_PREV 
  
> Если _wMsgID_ WM_COMMAND, пользователь нажал кнопку **"Назад".** 
    
_lParam_
  
> [in] 32-битный параметр, связанный с сообщениями окна. Возможные значения зависят от сообщения, указанного в _параметре wMsgID._ 
    
## <a name="return-value"></a>Возвращаемое значение

Значение, возвращаемое функцией **SERVICEWIZARDDLGPROC,** зависит от полученного сообщения окна. Обратите внимание, в частности, на исключительное значение возврата для WIZ_QUERYNUMPAGES сообщения. Нормальные значения возврата: 
  
TRUE 
  
> Поставщик услуг обработал полученное окно сообщения. 
    
FALSE 
  
> Поставщик услуг не обработал полученное окно сообщения.
    
## <a name="remarks"></a>Примечания

Когда пользователь перемещается с одной страницы свойства на другую, поставщик несет ответственность за сокрытие элементов управления старой страницы и отображение элементов управления для следующей или предыдущей страницы. Когда пользователь нажимает кнопку **Далее,** функция **SERVICEWIZARDDDLGPROC** называется с WM_COMMAND и WIZ_NEXT в _параметре wParam._ В следующих действиях описывается, что происходит между временем щелчка **пользователя Далее** и временем отрисовки первых страниц конфигурации поставщика. 
  
1. Мастер профилей скрывает все элементы управления, которые находятся в окне. 
    
2. Мастер профилей добавляет скрытые элементы управления поставщика на страницу. 
    
3. Мастер профилей вызывает **SERVICEWIZARDDLGPROC,** WM_INITDIALOG сообщение, чтобы поставщик инициализировать элементы управления. 
    
4. Мастер профилей вызывает **SERVICEWIZARDDLGPROC,** отправляя WIZ_QUERYNUMPAGES сообщение. Поставщик возвращает количество страниц, которые должны быть показаны. 
    
5. Мастер профилей вызывает **SERVICEWIZARDDLGPROC,** отправляя WM_COMMAND сообщение с параметром  _wParam_ в WIZ_NEXT или WIZ_PREV. На этом этапе поставщик возвращает FALSE {error} или показывает свои элементы управления и возвращает TRUE {success}. Если мастер профиля проходит ID_NEXT, отображается первая страница поставщика. Если ID_PREV, отображается последняя страница. 
    
6. Мастер профиля вызывает функцию **SERVICEWIZARDDLGPROC** поставщика, отправляя сообщение WM_COMMAND с параметром  _wParam_ в WIZ_NEXT или WIZ_PREV (в зависимости от того, на какую кнопку нажал пользователь). Поставщик несет ответственность за отображение или сокрытие элементов управления и написание данных в **IMAPIProp,** переданном мастеру профилей, чтобы пройти последовательность страниц. Поставщик должен вернуть TRUE, если следующая или предыдущая страница была успешно показана, и FALSE, если не удалось показать ни следующую, ни предыдущую страницу. Поставщик должен знать, когда он находится за пределами последовательности страниц, и соответствующим образом реагировать, скрывая свои элементы управления и записывая данные в профиль. 
    
7. Если пользователь находится за пределами диапазона страниц поставщика, мастер профилей удаляет скрытые элементы управления поставщика из диалогового окна и вызывает следующего поставщика или отображает следующую страницу, если это последний поставщик. 
    


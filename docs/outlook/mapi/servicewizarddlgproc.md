---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e43a1d7c57668ba930b4c4af7194bd298971e6ba
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432382"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**Относится к**: Outlook 2013 | Outlook 2016 
  
Определяет функцию обратного вызова, вызываемую мастером профилей, чтобы разрешить поставщику услуг реагировать на события пользователя при отображении страниц свойств или страниц свойств поставщика. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Мапивз. h  <br/> |
|Определенная функция реализована следующим образом:  <br/> |Поставщики служб  <br/> |
|Определенная функция, вызываемая:  <br/> |Мастер профилей MAPI  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>Параметры

_хдлг_
  
> возврата Диалоговое окно "дескриптор окна" в диалоговом окне мастера профилей. 
    
_вмсгид_
  
> возврата Сообщение окна, которое необходимо обработать. В дополнение к обычным сообщениям окон, ожидаемым модальным диалоговым окном, могут быть получены следующие сообщения:
    
WM_CLOSE 
  
> Работа мастера профилей завершена. Поставщик услуг должен выполнить всю необходимую очистку, например освобождение динамической выделенной памяти. 
    
WM_COMMAND 
  
> Был выбран один из элементов управления поставщика или нажата кнопка " **Далее** " или " **назад** ". Значение в параметре _wParam_ указывает, какие из этих пользовательских событий произошли. 
    
WM_INITDIALOG 
  
> Пользователь переместился на другую страницу свойств, для которой должно быть инициализировано диалоговое окно. Поставщик должен инициализировать элементы управления, добавленные мастером профилей в диалоговое окно. 
    
WIZ_QUERYNUMPAGES 
  
> Мастер профилей запрашивает количество страниц, которое должен отображать поставщик. Поставщик должен возвратить количество страниц, а не TRUE или FALSE. Например, используйте приведенный ниже оператор return, чтобы указать, что должны отображаться три страницы:
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> возврата 32 — битовый параметр, связанный с сообщениями окон. Возможные значения зависят от сообщения, указанного в параметре _вмсгид_ . Помимо значений, ожидаемых обычными сообщениями окон для модального диалогового окна, можно получить следующие значения: 
    
WIZ_NEXT 
  
> Когда _вмсгид_ содержит WM_COMMAND, пользователь выбрал кнопку **Далее** . 
    
WIZ_PREV 
  
> Когда _вмсгид_ содержит WM_COMMAND, пользователь настроил кнопку Back ( **назад** ). 
    
_lParam_
  
> возврата 32 — битовый параметр, связанный с сообщениями окон. Возможные значения зависят от сообщения, указанного в параметре _вмсгид_ . 
    
## <a name="return-value"></a>Возвращаемое значение

Значение, возвращаемое функцией на основе **сервицевизарддлгпрок** , зависит от полученного сообщения окна. Обратите внимание, что в частности, в качестве значения, возвращаемого WIZ_QUERYNUMPAGES сообщения. Обычные возвращаемые значения: 
  
TRUE 
  
> Поставщик услуг обработал сообщение Received Window. 
    
FALSE 
  
> Поставщик услуг не обработал сообщение Received Window.
    
## <a name="remarks"></a>Примечания

Когда пользователь перемещается с одной страницы свойств на другую, поставщик отвечает за скрытие элементов управления старой страницы и отображение элементов управления для следующей или предыдущей страницы. Когда пользователь нажимает кнопку " **Далее** ", функция на основе **сервицевизарддлгпрок** вызывается с сообщением WM_COMMAND и WIZ_NEXT в параметре _wParam_ . В следующих шагах описывается, что происходит между моментом, когда пользователь нажимает кнопку **Далее** и отображается время отображения страниц конфигурации первого поставщика. 
  
1. Мастер профилей скрывает все элементы управления, наявляющиесяся в окне. 
    
2. Мастер профилей добавляет на страницу скрытые элементы управления поставщика. 
    
3. Мастер профилей вызывает **сервицевизарддлгпрок**, отправляя сообщение WM_INITDIALOG, чтобы поставщик мог инициализировать элементы управления. 
    
4. Мастер профилей вызывает **сервицевизарддлгпрок**, отправляя сообщение WIZ_QUERYNUMPAGES. Поставщик возвращает число страниц, которые должны отображаться. 
    
5. Мастер профилей вызывает **сервицевизарддлгпрок**, отправляя сообщение WM_COMMAND с параметром _wParam_ , установленным как WIZ_NEXT, так и WIZ_PREV. На этом шаге поставщик возвращает значение FALSE {Error} или открывает его элементы управления и возвращает значение TRUE {Success}. Если мастер профилей передает ID_NEXT, отображается первая страница поставщика. Если ID_PREV передается, отображается последняя страница. 
    
6. Мастер профилей вызывает функцию **сервицевизарддлгпрок** поставщика, отправляя сообщение WM_COMMAND с параметром _wParam_ , равным WIZ_NEXT или WIZ_PREV (в зависимости от того, какая кнопка нажата). Поставщик отвечает за отображение или скрытие элементов управления и запись их данных в **IMAPIProp** , передаваемый мастеру профилей для пошаговой последовательности страниц. Поставщик должен возвращать значение TRUE, если следующая или Предыдущая страница была успешно отображена, и FALSE, если не удается отобразить ни следующую, ни предыдущую страницу. Поставщику необходимо знать, когда он выполняет шаг с заходом вне последовательности страниц и отвечает соответствующим образом, скрывая элементы управления и записывает данные в профиль. 
    
7. Если пользователь выполняет действия за пределами диапазона страниц поставщика, мастер профилей удаляет скрытые элементы управления поставщика из диалогового окна и вызывает следующего поставщика или отображает следующую страницу, если это последний поставщик. 
    


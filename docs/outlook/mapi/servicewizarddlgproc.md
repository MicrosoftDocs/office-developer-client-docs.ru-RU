---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: e43a1d7c57668ba930b4c4af7194bd298971e6ba
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432382"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**Относится к**: Outlook 2013 | Outlook 2016 
  
Определяет функцию ответного вызова, вызываемую мастером профилей, чтобы поставщик службы реагировал на события пользователей при от показании таблиц или страниц свойств поставщика. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiwz.h  <br/> |
|Определяемая функция, реализованная в:  <br/> |Поставщики служб  <br/> |
|Определяемая функция, вызванная:  <br/> |Мастер профилей MAPI  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>Параметры

_hDlg_
  
> [in] Десналь окна в диалоговом окне "Мастер профилей". 
    
_wMsgID_
  
> [in] Сообщение окна, которое необходимо обработать. Помимо обычных сообщений окна, ожидаемых модальным диалогом, можно получить следующие сообщения:
    
WM_CLOSE 
  
> Мастер профилей завершен. Поставщик услуг должен сделать всю необходимую очистку, например распределить динамически выделяемую память. 
    
WM_COMMAND 
  
> Был выбран один из элементов управления поставщика  или нажата кнопка "Далее"  или "Назад". Значение параметра  _wParam_ указывает, какое из этих пользовательских событий произошло. 
    
WM_INITDIALOG 
  
> Пользователь перешел на другую страницу свойств, для которой необходимо инициализировать диалоговое окно. Поставщик должен инициализировать элементы управления, добавленные мастером профилей в диалоговое окно. 
    
WIZ_QUERYNUMPAGES 
  
> Мастер профилей выводит запрос на количество страниц, которые должен отобразить поставщик. Поставщик должен возвращать количество страниц вместо TRUE или FALSE. Например, используйте следующий возвращаемый отчет, чтобы указать, что должны отображаться три страницы:
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> [in] 32-битный параметр, связанный с сообщениями окна. Возможные значения зависят от сообщения, указанного в параметре _wMsgID._ Помимо значений, ожидаемых в обычных сообщениях окна для модального диалоговых окон, можно получить следующие значения: 
    
WIZ_NEXT 
  
> Если _wMsgID_ WM_COMMAND, пользователь нажал кнопку **"Далее".** 
    
WIZ_PREV 
  
> Если _wMsgID_ WM_COMMAND, пользователь нажал кнопку **"Назад".** 
    
_lParam_
  
> [in] 32-битный параметр, связанный с сообщениями окна. Возможные значения зависят от сообщения, указанного в параметре _wMsgID._ 
    
## <a name="return-value"></a>Возвращаемое значение

Значение, возвращаемое функцией на основе **SERVICEWIZARDDLGPROC,** зависит от полученного сообщения окна. Обратите внимание, в частности, на исключительное возвращаемого значения для WIZ_QUERYNUMPAGES сообщения. Нормальные возвращаемые значения: 
  
TRUE 
  
> Поставщик услуг обработал полученное сообщение окна. 
    
FALSE 
  
> Поставщик услуг не обработал полученное сообщение окна.
    
## <a name="remarks"></a>Примечания

Когда пользователь переходит со страницы свойств на другую, поставщик отвечает за скрытие элементов управления старой страницы и отображение элементов управления для следующей или предыдущей страницы. Когда пользователь нажимает  кнопку "Далее", функция на основе **SERVICEWIZARDDLGPROC** с сообщением WM_COMMAND и WIZ_NEXT в _параметре wParam._ Далее описано, что происходит между нажатием кнопки "Далее" и временем отображения страниц конфигурации первого поставщика.  
  
1. Мастер профилей скрывает все элементы управления, которые находятся в окне. 
    
2. Мастер профилей добавляет на страницу скрытые элементы управления поставщика. 
    
3. Мастер профилей вызывает **SERVICEWIZARDDLGPROC,** отправляя сообщение WM_INITDIALOG, чтобы поставщик может инициализировать элементы управления. 
    
4. Мастер профилей вызывает **SERVICEWIZARDDLGPROC,** отправляя WIZ_QUERYNUMPAGES сообщения. Поставщик возвращает количество страниц, которые должны быть показаны. 
    
5. Мастер профилей вызывает **SERVICEWIZARDDLGPROC,** отправляя сообщение WM_COMMAND с параметром  _wParam,_ установленным WIZ_NEXT или WIZ_PREV. На этом этапе поставщик возвращает FALSE {error} или открывает свои элементы управления и возвращает TRUE {success}. Если мастер профилей передает ID_NEXT, отображается первая страница поставщика. Если ID_PREV передается, отображается последняя страница. 
    
6. Мастер профилей вызывает функцию **SERVICEWIZARDDLGPROC** поставщика, отправляя сообщение WM_COMMAND с параметром  _wParam,_ установленным как WIZ_NEXT, так и WIZ_PREV (в зависимости от нажатия пользователем кнопки). Поставщик отвечает за отображение или скрытие своих элементов управления и запись данных в **IMAPIProp,** переданный мастеру профилей, чтобы пошаговая последовательность страниц. Поставщик должен вернуть true, если следующая или предыдущая страница была успешно показана, и FALSE, если ни следующая, ни предыдущая страницы не могут быть показаны. Поставщик должен знать, когда он находится за пределами своей последовательности страниц, и реагировать соответствующим образом, скрывая свои элементы управления и записыв данные в профиль. 
    
7. Если пользователь находится за пределами диапазона страниц поставщика, мастер профилей удаляет скрытые элементы управления поставщика из диалоговых окна и вызывает следующего поставщика или отображает следующую страницу, если это был последний поставщик. 
    


---
title: SERVICEWIZARDDLGPROC
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- MAPI.SERVICEWIZARDDLGPROC
api_type:
- COM
ms.assetid: 3e2d5190-e67a-470d-8177-0f0ba20c7b82
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: fdd5d01b96c9ea756ee64f113ccb5119a9693668
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22594469"
---
# <a name="servicewizarddlgproc"></a>SERVICEWIZARDDLGPROC
 
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Определяет функцию обратного вызова вызывается мастером профилей, чтобы разрешить поставщика услуг реагировать на события пользователя при поставщика свойств или страниц выводимыми на экран. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiwz.h  <br/> |
|Функция реализован:  <br/> |Поставщики услуг  <br/> |
|Вызывается функция:  <br/> |Мастер профилей MAPI  <br/> |
   
```cpp
BOOL SERVICEWIZARDDLGPROC(
  HWND hDlg,
  UINT wMsgID,
  WPARAM wParam,
  LPARAM lParam
);
```

## <a name="parameters"></a>Параметры

_hDlg_
  
> [in] Дескриптор окна в диалоговое окно мастера профилей. 
    
_wMsgID_
  
> [in] Окно сообщения для обработки. В дополнение к регулярным окно сообщения, ожидаемый модального диалогового окна могут быть получены следующие сообщения:
    
WM_CLOSE 
  
> Завершения работы мастера профилей. Поставщика услуг следует делать все необходимые очистки, такие как освобождение какие-либо динамически выделить память. 
    
WM_COMMAND 
  
> Один из элементов управления поставщика был выбран или была нажата кнопка **Далее** или **Назад** . Значение в параметре _wParam_ указывает, какой из этих событий пользователя произошло. 
    
WM_INITDIALOG 
  
> Пользователь переходит на другую страницу свойства, для которого должен быть инициализирован диалоговое окно. Поставщик должны инициализировать элементы управления, добавленные в диалоговое окно мастера профилей. 
    
WIZ_QUERYNUMPAGES 
  
> Мастер профиля запроса на число страниц, которые необходимо отобразить. Поставщик должен возвращать число страниц, а не значение TRUE или FALSE. Например используйте следующий оператор возврата для указания, что три страницы должны отображаться:
    
   ```cpp
return (BOOL)3;

   ```

_wParam_
  
> [in] Параметр 32-разрядная версия, связанный с окном сообщения. Возможные значения зависят от сообщения, указанный в параметре _wMsgID_ . В дополнение к значениям, ожидаемый с регулярным окно сообщения для модального диалогового окна могут быть получены следующие значения: 
    
WIZ_NEXT 
  
> При _wMsgID_ содержит WM_COMMAND, пользователь нажатии кнопки **Далее** . 
    
WIZ_PREV 
  
> Если _wMsgID_ содержит WM_COMMAND, нажата кнопка **Назад** . 
    
_lParam_
  
> [in] Параметр 32-разрядная версия, связанный с окном сообщения. Возможные значения зависят от сообщения, указанный в параметре _wMsgID_ . 
    
## <a name="return-value"></a>������������ ��������

Значение, возвращаемое функцией **SERVICEWIZARDDLGPROC** на основе зависит от получено сообщение окна. В частности, обратите внимание, что исключительных возвращаемое значение для сообщения WIZ_QUERYNUMPAGES. Обычный значения будут возвращены: 
  
TRUE 
  
> Поставщик услуг обработал сообщение получено окна. 
    
FALSE 
  
> Поставщик услуг не обработал сообщение получено окна.
    
## <a name="remarks"></a>Замечания

Когда пользователь перемещается с одного свойства страницы, поставщик несет ответственность за скрытие элементов управления на странице старые и отображение элементов управления для страницы следующий или предыдущий. При нажатии кнопки **Далее** функция **SERVICEWIZARDDLGPROC** на основе вызывается с сообщение WM_COMMAND и WIZ_NEXT в параметре _wParam_ . Далее описано, что происходит между нажатии кнопки **Далее** и время, когда отображаются страницы настройки первого поставщика. 
  
1. Мастер профиля скрывает все элементы управления, которые находятся на окна. 
    
2. Мастер профиля добавляет поставщика скрытые элементы управления на страницу. 
    
3. Мастер профиля вызывает **SERVICEWIZARDDLGPROC**, отправка сообщение WM_INITDIALOG, чтобы поставщик может инициализации элементов управления. 
    
4. Мастер профиля вызывает **SERVICEWIZARDDLGPROC**, отправив сообщение WIZ_QUERYNUMPAGES. Поставщик возвращает число страниц, которые требуется отобразить. 
    
5. Мастер профиля вызывает **SERVICEWIZARDDLGPROC**, отправив сообщение WM_COMMAND с параметром _wParam_ , задайте значение WIZ_NEXT или WIZ_PREV. На этом этапе поставщик либо возвращает FALSE {ошибка} или выявляет ее элементов управления и возвращает значение TRUE {успеха}. Если мастер профиля передает ID_NEXT, отображается первая страница поставщика. Если ID_PREV передается, отображается последней странице. 
    
6. Мастер профиля вызывает функцию **SERVICEWIZARDDLGPROC** поставщика, отправив сообщение WM_COMMAND с параметром _wParam_ , задайте значение WIZ_NEXT или WIZ_PREV (в зависимости от того, какая кнопка нажата). Поставщик отвечает за отображение и скрытие элементов управления и записи данных в **IMAPIProp** передается мастер профиля для пошагового выполнения последовательности страниц. Поставщик должен возвращать значение TRUE, если был успешно показано следующей или предыдущей странице, и значение FALSE, если ни Далее, ни предыдущей страницы может отображаться. Поставщика необходимо принять во внимание при захода вне его последовательность страниц и отреагировать, скрытие элементов управления и записи данных в профиль. 
    
7. Если пользователь действия вне диапазона поставщика страниц, мастер профиля Удаляет поставщика скрытые элементы управления из диалогового окна и вызывает следующий поставщик или отображает его следующей страницы, если последний поставщика, который был. 
    


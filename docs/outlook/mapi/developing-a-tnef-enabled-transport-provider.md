---
title: Разработка поставщика транспорта включена поддержка формата TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7525eee1-4016-49b8-9509-5ebbe1db819f
description: '���� ���������� ���������: 23 ���� 2011 �.'
ms.openlocfilehash: 9f80feecda219e3bcebbf8ceb346b5034e821470
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808292"
---
# <a name="developing-a-tnef-enabled-transport-provider"></a>Разработка поставщика транспорта включена поддержка формата TNEF

  
  
**Применимо к**: Outlook 
  
Для обеспечения взаимодействия между систем обмена сообщениями, которые поддерживают различные наборы компонентов MAPI, MAPI предоставляет транспорта Neutral Encapsulation формата TNEF в качестве стандартный способ передачи данных. В этом формате инкапсулирует свойства MAPI, не поддерживаемых системы обмена сообщениями в двоичный поток, который может передаваться вместе с сообщением, поставщика транспорта отправляет его. Поставщика транспорта, который получает сообщение, затем может декодировать двоичный поток для извлечения всех свойств исходного сообщения и сделать их доступными для клиентских приложений. Действующие модель TNEF —.
  
- Клиенты обмена сообщениями, отправка и получение сообщений для транспорта TNEF в обычном режиме.
    
- Транспорта разделяет свойства на исходящие сообщения на две категории: те, которые поддерживает системы сообщений и те, которые не поддерживает. Значения свойств, поддерживаемых приложением системы обмена сообщениями преобразуются в требуемом формате.
    
- Транспорта использует методы MAPI TNEF для кодирования любые неподдерживаемые свойства в поток данных single. Затем транспорта включает этого потока данных в специальных вложений на исходящее сообщение, с помощью модели базового обмена сообщениями системы вложения, перед отправкой сообщения.
    
- Включено TNEF транспорта, которая получает такое сообщение делает две вещи. Во-первых, он преобразует свойства входящих сообщений — из них, поддерживаемые базовой системы сообщение — в свойства MAPI. Во-вторых при наличии особых вложения он используется для получения дополнительных свойств MAPI вложения перед доставкой сообщения в клиентское приложение методы MAPI TNEF.
    
MAPI предоставляет реализацию интерфейса **ITnef** для использования с поставщиками транспорта MAPI, при работе с объектами TNEF. Функция [OpenTnefStreamEx](opentnefstreamex.md) используется для создания объектов TNEF и свяжите их с сообщением. Потоки TNEF расширяют платформу интерфейса OLE **IStream** 
  
> [!NOTE]
> Используйте **OpenTnefStreamEx** для создания объектов TNEF. Старый функция **OpenTnefStream** по-прежнему существует для совместимости со старой исходного кода и не должен использоваться в что-либо создать. 
  
Интерфейс **ITnef** предоставляет следующие методы: 
  
- [AddProps](itnef-addprops.md)
    
- [EncodeRecips](itnef-encoderecips.md)
    
- [ExtractProps](itnef-extractprops.md)
    
- [Готово](itnef-finish.md)
    
- [FinishComponent](itnef-finishcomponent.md)
    
- [OpenTaggedBody](itnef-opentaggedbody.md)
    
- [SetProps](itnef-setprops.md)
    
Поддерживает модель реализации MAPI TNEF:
  
- Все свойства MAPI без воздействия на другие свойства сообщений. Чтобы сообщения MAPI выдержать транспорта посредством системы обмена сообщениями необходимо инкапсулированную всех свойств, которые не могут быть закодированы как свойства системы обмена сообщениями. Так как почти никогда не известен во время, когда сообщение отправляется ли MAPI-совместимый клиент будет выведено сообщение, схема Инкапсуляция позволяет поставщика транспорта для кодирования только свойства сообщения MAPI, не поддерживает системы обмена сообщениями изначально поддерживают. Это означает, что сообщения, которые используют TNEF не «прозрачно» для системы обмена сообщениями не на основе MAPI, таких как SMTP под управлением UNIX систем обмена сообщениями. Эти системы получают свойства, которые они поддерживают в способом типичные для получения их и другие свойства как закодированного потока данных TNEF. Поставщика транспорта TNEF несет ответственность за различить эти два набора свойств и отправка поддерживаемый набор образом соответствующих прав для системы обмена сообщениями. Формат TNEF делает нет предположения на уровне поддержка в системе обмена сообщениями. Тем не менее в примеры использования TNEF, включенные в этом разделе, предполагается делается, что система обмена сообщениями поддерживает по крайней мере один одного вложения, помимо сообщения. В некоторых случаях вложение можно только поддерживается в формате UUENCODE потока и передаваемые сведения как часть текста сообщения. Только в редких случаях система обмена сообщениями получит маленьким поддержка свойства сообщений, полный кодировка TNEF всех свойств не требуется.
    
- Механизм для определения поток TNEF во входящем сообщении принадлежит к сообщению ли на основе MAPI свойства **PR_TNEF_CORRELATION_KEY** ([PidTagTnefCorrelationKey](pidtagtnefcorrelationkey-canonical-property.md)). Это свойство должны находиться в потоке TNEF и в заголовке соответствующего сообщения. Если свойство имеет то же значение в обоих местах или отсутствует в любом месте, предполагается, что поток TNEF принадлежат к сообщению. В противном случае поток TNEF игнорируется. Транспортов TNEF включено несете ответственность за выбор значения для этого свойства для исходящих сообщений и кодирования в заголовке соответствующего сообщения (например, идентификатор сообщения: заголовка для сообщений SMTP) и в потоке TNEF.
    


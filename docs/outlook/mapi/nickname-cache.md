---
title: Кэш псевдонимов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Last modified: January 30, 2013'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334519"
---
# <a name="nickname-cache"></a>Кэш псевдонимов

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Microsoft Office Outlook 2007, Microsoft Outlook 2010, русская версия и Microsoft Outlook 2013 взаимодействуют с кэшом псевдонимов, также известным как "поток автозаполнеия". Поток автозаполнений — это место, где Outlook сохраняет список автозаполнений, который является списком  имен, отображаемого в полях редактирования "Кому", "Ск" и "Ск", когда пользователь создает сообщение электронной почты.  В этом разделе описывается взаимодействие Outlook 2007, Outlook 2010 и Outlook 2013 с потоком автозаполнения, а также обсуждается двоичный формат файла и рекомендуемые способы взаимодействия с потоком автозаполнения. 
  
Для приложений, взаимодействующих с Outlook 2010 или Outlook 2013, поток автозаполнеия хранится как свойство MAPI и может быть изменен с помощью MAPI или **объекта PropertyAccessor** сообщения. Объект **PropertyAccessor** имеется в объектных моделях Outlook 2010 или Outlook 2013. 
  
Нет зависимостей от объектной модели Outlook 2007 или API MAPI. Таким образом, приложения, которые внося изменения в поток автозаполнеия в Outlook 2007, могут быть написаны на любом языке программирования.
  
## <a name="interacting-with-the-autocomplete-stream"></a>Взаимодействие с потоком автозаполнения

При **доступе** к полям редактирования "К", "Ск" и "Ск" в сообщении загружается поток автозаполнений и отображается список имен пользователей.  Outlook взаимодействует с потоком автозаполнеия двумя способами: 
  
1. Загрузка потока автозаполнения 
    
2. Сохранение изменений данных в потоке автозаполнеия
    
Способ хранения данных автозаполнения в Outlook 2007 и Outlook 2010 или Outlook 2013 отличается следующим образом: 
  
 **Outlook 2007**
  
В Outlook 2007 поток автозаполнеия хранится в файле с тем же именем, что и профиль, и расширением NK2. Например, если используется профиль outlook по умолчанию, файл будет называться outlook.nk2. NK2-файл хранится в папке %APPDATA%\Microsoft\Outlook. Дополнительные сведения о двоичном формате двоичных файлов кэша псевдонимов см. в документе [Outlook 2003/2007 NK2 File Format and Developer Guidelines.](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
  
 **Outlook 2010 и Outlook 2013**
  
Outlook 2010 или Outlook 2013 считывает поток автозаполнеия из сообщения в таблице "Связанное содержимое" почтового ящика почтовой учетной записи доставки. Это скрытое сообщение имеет класс сообщения и тему IPM.Configuration. Автозаполнеть. Поток автозаполнения хранится в этом сообщении в свойстве PR_ROAMING_BINARYSTREAM ( Каноническое свойство[PidTagRoamingBinary).](pidtagroamingbinary-canonical-property.md) Данные автозаполнеия могут временно кэшироваться в DAT-файле автозаполнеия, расположенном в папке %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache. Однако DAT-файл является только кэшем и не используется для записи обратно в хранилище доставки, когда пользователь выходит из Outlook 2010 или Outlook 2013.
  
## <a name="loading-the-autocomplete-stream"></a>Загрузка потока автозаполнения

Outlook загружает поток автозаполнения при инициализации элемента с функциональными возможностями адресовки. Например, адреса электронной почты используются в новых сообщениях электронной почты, ответе на почту, элементе контакта, в запросе на собрание и так далее. Чтобы загрузить данные, Outlook считыет все содержимое потока в память.
  
Для операций автозаполнеия Outlook взаимодействует исключительно с этой структурой в памяти в течение outlook.exe процесса. Outlook сохраняет структуру только после завершения работы. Дополнительные сведения об этом процессе см. в следующем разделе "Сохранение потока автозаполнеия".
  
## <a name="saving-the-autocomplete-stream"></a>Сохранение потока автозаполнеия

Outlook сохраняет поток автозаполнений при остановке работы, если список автозаполнений изменился одним из следующих способов:
  
- Новая запись псевдонима добавляется путем разрешения имени, выбора получателя в диалоговом оке адресной книги или отправки почты получателю, которого еще нет в списке.
    
- Запись изменена путем отправки почты существующему получателю в списке.
    
- Пользователь удаляет запись с помощью пользовательского интерфейса.
    
- Другие незначительные сценарии, не релевантные для этой темы.
    
Сохранение изменений в данных автозаполнеия включает запись структуры в памяти обратно в поток [автозаполнеия.](autocomplete-stream.md) При взаимодействии с Outlook 2007 поток будет сохранен в локальный NK2-файл. Для Outlook 2010 или Outlook 2013 поток автозаполнеия записывает обратно в таблицу "Связанное содержимое" почтового ящика почтовой учетной записи доставки.
  
## <a name="recommendations"></a>Рекомендации

- Никогда не изменяйте поток автозаполнеия частично. Поддерживаемым взаимодействием является 1) чтение всего потока автозаполнеия в память, 2) изменение структуры памяти и 3) запись всего потока обратно в таблицу "Связанное содержимое" в папке "Входящие" почтовой учетной записи (для Outlook 2010 или Outlook 2013) или в локальный NK2-файл (Outlook 2007).
    
- Не взаимодействуть с потоком автозаполнеия во время работы Outlook. Если Outlook работает во время изменения потока, скорее всего, он переопишет изменения при его закрытии.
    
- Не записывай свойства типа PT_MV_UNICODE и PR_MV_STRING8 в поток автозаполнеия, который будет потребляться Microsoft Outlook 2003. Эти свойства понятны только в Outlook 2007, Outlook 2010 и Outlook 2013.
    
- При разработке кода, взаимодействующего с Outlook 2007, рекомендуется заблокировать NK2-файл от изменения другими процессами во время чтения и записи с помощью стандартных API блокировки файлов (например, **LockFile** в C/C++ и **FileStream.Lock** в C#). 
    
- Только изменяйте свойства типов из набора строк потока автозаполнеия. Дополнительные сведения о свойствах и типах свойств потока автозаполнеия см. в этой [теме.](autocomplete-stream.md)
    
## <a name="see-also"></a>См. также



[Autocomplete Stream](autocomplete-stream.md)
  
[Профили MAPI](mapi-profiles.md)


[Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)


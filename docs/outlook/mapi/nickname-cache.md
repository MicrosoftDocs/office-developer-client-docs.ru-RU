---
title: Кэш псевдонимов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Дата последнего изменения: 30 января 2013 г.'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334519"
---
# <a name="nickname-cache"></a>Кэш псевдонимов

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Microsoft Office Outlook 2007, Microsoft Outlook 2010 и Microsoft Outlook 2013 взаимодействуют с кэшем псевдонимов, также называемым "потоком автозаполнения". В потоке автозаполнения в Outlook хранится список автозаполнения, который представляет собой список имен, отображаемых в полях " **Кому**", **"копия**" и **"Скрытая копия"** , когда пользователь создает электронную почту. В этом разделе описывается, как Outlook 2007, Outlook 2010 и Outlook 2013 взаимодействуют с потоком автозаполнения, а также описывает двоичный формат файла и рекомендуемые способы взаимодействия с потоком автозаполнения. 
  
Для приложений, взаимодействующих с Outlook 2010 или Outlook 2013, поток автозаполнения хранится в виде свойства MAPI и может быть изменен с помощью MAPI или объекта **PropertyAccessor** сообщения. Объект **PropertyAccessor** предоставляется в объектных моделях Outlook 2010 или Outlook 2013. 
  
Отсутствует зависимость от объектной модели Outlook 2007 или API MAPI. Таким образом, приложения, которые делают изменения в потоке автозаполнения в Outlook 2007, можно писать с помощью любого языка программирования.
  
## <a name="interacting-with-the-autocomplete-stream"></a>Взаимодействие с потоком автозаполнения

При обращении к полям редактирования " **Кому**", **"копия**" или **"Скрытая копия"** в сообщении загружается поток автозаполнения, и отображается список имен пользователей. Взаимодействие Outlook с потоком автозаполнения осуществляется двумя способами: 
  
1. Загрузка потока автозаполнения 
    
2. Сохранение изменений данных в потоке автозаполнения
    
Средства хранения данных автозаполнения отличаются от Outlook 2007 и Outlook 2010 или Outlook 2013 следующим образом: 
  
 **Outlook 2007**
  
Для Outlook 2007 поток автозаполнения хранится в файле с тем же именем, что и у профиля, и расширением NK2. Например, если используется профиль по умолчанию "Outlook", файл будет называться "Outlook. nk2". NK2-файл хранится в%Аппдата%\микрософт\аутлук. Для получения дополнительных сведений о двоичном формате двоичного файла кэша псевдонимов, ознакомьтесь со статьей [Outlook 2003/2007 NK2 File Format и рекомендациями для разработчиков](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).
  
 **Outlook 2010 и Outlook 2013**
  
Outlook 2010 или Outlook 2013 считывает поток автозаполнения из сообщения в таблице содержимого папки "Входящие" хранилища доставки учетной записи почты. Это скрытое сообщение содержит класс сообщения и тему IPM. Configuration. автозавершение. Поток автозаполнения хранится в этом сообщении в свойстве PR_ROAMING_BINARYSTREAM ([каноническое свойство PidTagRoamingBinary](pidtagroamingbinary-canonical-property.md)). Данные автозаполнения могут быть временно кэшированы в файле автозаполнения с расширением dat, расположенном в%Усерпрофиле%\аппдата\локал\микрософт\аутлук\роамкаче. Однако файл DAT является только кэшем и не используется для обратной записи в хранилище доставки, когда пользователь выходит из Outlook 2010 или Outlook 2013.
  
## <a name="loading-the-autocomplete-stream"></a>Загрузка потока автозаполнения

Outlook загружает поток автозаполнения всякий раз при инициализации элемента с функциональностью адресации. Например, адреса электронной почты используются в новых сообщениях, ответах почты, элементах контактов, приглашениях на собрания и т. д. Для загрузки данных Outlook считывает все содержимое потока в память.
  
Для операций автозаполнения Outlook работает исключительно с этой структурой памяти в течение времени жизни процесса Outlook. exe. Приложение Outlook сохраняет структуру только при завершении работы. В следующем разделе "сохранение потока автозаполнения" для получения дополнительной информации по этому процессу.
  
## <a name="saving-the-autocomplete-stream"></a>Сохранение потока автозаполнения

Outlook сохраняет поток автозаполнения при завершении работы, если список автозаполнения изменился одним из указанных ниже способов.
  
- Новая запись псевдонима добавляется с помощью разрешения имени, подбора получателя из диалогового окна адресной книги или отправки почты получателю, который еще не был добавлен в список.
    
- Запись изменяется путем отправки почты существующему получателю в списке.
    
- Пользователь удаляет запись с помощью пользовательского интерфейса.
    
- Другие небольшие сценарии, не относящиеся к этой теме.
    
Сохранение изменений в данных автозаполнения включает запись структуры в памяти обратно в [поток автозаполнения](autocomplete-stream.md). При взаимодействии с Outlook 2007, поток сохраняется в локальном файле NK2. Для Outlook 2010 или Outlook 2013 поток автозаполнения записывается обратно в связанную таблицу содержимого папки "Входящие" хранилища доставки учетной записи почты.
  
## <a name="recommendations"></a>Рекомендации

- Никогда не изменяйте поток автозаполнения. Поддерживаемым взаимодействием является 1) чтение всего потока автозаполнения в память, 2) изменение структуры памяти и 3) запись всего потока обратно в связанную таблицу содержимого папки "Входящие" в хранилище доставки учетной записи почты (для Outlook 2010 или Outlook 2013) или на локальный NK2-файл (Outlook 2007).
    
- Не работайте с потоком автозаполнения во время работы Outlook. Если во время изменения потока приложение Outlook будет запущено, то, скорее всего, будут перезаписаны изменения при завершении работы.
    
- Не записываете свойства типа PT_MV_UNICODE и PR_MV_STRING8 в поток автозаполнения, который будет использоваться в Microsoft Outlook 2003. Эти свойства понятны только для Outlook 2007, Outlook 2010 и Outlook 2013.
    
- При разработке кода, взаимодействующего с Outlook 2007, рекомендуется блокировать файл с расширением NK2 при изменении другими процессами во время чтения и записи с помощью стандартных API блокировки файлов (например, **локкфиле** в C/C++ и **FileStream. Lock** в C#). 
    
- Изменять только свойства типов из набора строк в потоке автозаполнения. Дополнительные сведения о свойствах и типах потоков автозаполнения приведены в разделе [Stream автозаполнения](autocomplete-stream.md).
    
## <a name="see-also"></a>См. также



[Поток автозаполнения](autocomplete-stream.md)
  
[Профили MAPI](mapi-profiles.md)


[Руководство по формату файлов NK2 Outlook 2003/2007 и разработчикам](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)


---
title: Кэш псевдонимов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Last modified: January 30, 2013'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334519"
---
# <a name="nickname-cache"></a><span data-ttu-id="97d0e-103">Кэш псевдонимов</span><span class="sxs-lookup"><span data-stu-id="97d0e-103">Nickname cache</span></span>

 
  
<span data-ttu-id="97d0e-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="97d0e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="97d0e-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, русская версия и Microsoft Outlook 2013 взаимодействуют с кэшом псевдонимов, также известным как "поток автозаполнеия".</span><span class="sxs-lookup"><span data-stu-id="97d0e-105">Microsoft Office Outlook 2007, Microsoft Outlook 2010, and Microsoft Outlook 2013 interact with the nickname cache, also known as the "autocomplete stream."</span></span> <span data-ttu-id="97d0e-106">Поток автозаполнений — это место, где Outlook сохраняет список автозаполнений, который является списком  имен, отображаемого в полях редактирования "Кому", "Ск" и "Ск", когда пользователь создает сообщение электронной почты. </span><span class="sxs-lookup"><span data-stu-id="97d0e-106">The autocomplete stream is where Outlook persists the autocomplete list, which is the list of names that displays in the **To**, **Cc**, and **Bcc** edit boxes while a user is composing an email.</span></span> <span data-ttu-id="97d0e-107">В этом разделе описывается взаимодействие Outlook 2007, Outlook 2010 и Outlook 2013 с потоком автозаполнения, а также обсуждается двоичный формат файла и рекомендуемые способы взаимодействия с потоком автозаполнения.</span><span class="sxs-lookup"><span data-stu-id="97d0e-107">This topic describes how Outlook 2007, Outlook 2010, and Outlook 2013 interact with the autocomplete stream and also discusses the binary format of the file and the recommended ways for interacting with the autocomplete stream.</span></span> 
  
<span data-ttu-id="97d0e-108">Для приложений, взаимодействующих с Outlook 2010 или Outlook 2013, поток автозаполнеия хранится как свойство MAPI и может быть изменен с помощью MAPI или **объекта PropertyAccessor** сообщения.</span><span class="sxs-lookup"><span data-stu-id="97d0e-108">For applications that interact with Outlook 2010 or Outlook 2013, the autocomplete stream is stored as a MAPI property and can be modified using the MAPI or the **PropertyAccessor** object of the message.</span></span> <span data-ttu-id="97d0e-109">Объект **PropertyAccessor** имеется в объектных моделях Outlook 2010 или Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="97d0e-109">The **PropertyAccessor** object is exposed in the Outlook 2010 or Outlook 2013 object models.</span></span> 
  
<span data-ttu-id="97d0e-110">Нет зависимостей от объектной модели Outlook 2007 или API MAPI.</span><span class="sxs-lookup"><span data-stu-id="97d0e-110">There are no dependencies on the Outlook 2007 object model or MAPI APIs.</span></span> <span data-ttu-id="97d0e-111">Таким образом, приложения, которые внося изменения в поток автозаполнеия в Outlook 2007, могут быть написаны на любом языке программирования.</span><span class="sxs-lookup"><span data-stu-id="97d0e-111">Therefore, applications that make changes to the autocomplete stream within Outlook 2007 can be written using any programming language.</span></span>
  
## <a name="interacting-with-the-autocomplete-stream"></a><span data-ttu-id="97d0e-112">Взаимодействие с потоком автозаполнения</span><span class="sxs-lookup"><span data-stu-id="97d0e-112">Interacting with the Autocomplete Stream</span></span>

<span data-ttu-id="97d0e-113">При **доступе** к полям редактирования "К", "Ск" и "Ск" в сообщении загружается поток автозаполнений и отображается список имен пользователей. </span><span class="sxs-lookup"><span data-stu-id="97d0e-113">When the **To**, **Cc**, or **Bcc** edit boxes are accessed on a message, the autocomplete stream is loaded and the list of user names is displayed.</span></span> <span data-ttu-id="97d0e-114">Outlook взаимодействует с потоком автозаполнеия двумя способами:</span><span class="sxs-lookup"><span data-stu-id="97d0e-114">Outlook interacts with the autocomplete stream in two ways:</span></span> 
  
1. <span data-ttu-id="97d0e-115">Загрузка потока автозаполнения</span><span class="sxs-lookup"><span data-stu-id="97d0e-115">Loading the autocomplete stream</span></span> 
    
2. <span data-ttu-id="97d0e-116">Сохранение изменений данных в потоке автозаполнеия</span><span class="sxs-lookup"><span data-stu-id="97d0e-116">Saving changes to the data in the autocomplete stream</span></span>
    
<span data-ttu-id="97d0e-117">Способ хранения данных автозаполнения в Outlook 2007 и Outlook 2010 или Outlook 2013 отличается следующим образом:</span><span class="sxs-lookup"><span data-stu-id="97d0e-117">The means of storing the autocomplete data differs between Outlook 2007 and Outlook 2010 or Outlook 2013 as follows:</span></span> 
  
 <span data-ttu-id="97d0e-118">**Outlook 2007**</span><span class="sxs-lookup"><span data-stu-id="97d0e-118">**Outlook 2007**</span></span>
  
<span data-ttu-id="97d0e-119">В Outlook 2007 поток автозаполнеия хранится в файле с тем же именем, что и профиль, и расширением NK2.</span><span class="sxs-lookup"><span data-stu-id="97d0e-119">For Outlook 2007, the autocomplete stream is stored in a file with the same name as the profile and an extension of .nk2.</span></span> <span data-ttu-id="97d0e-120">Например, если используется профиль outlook по умолчанию, файл будет называться outlook.nk2.</span><span class="sxs-lookup"><span data-stu-id="97d0e-120">For example, if the default profile of "outlook" is used, the file will be called "outlook.nk2".</span></span> <span data-ttu-id="97d0e-121">NK2-файл хранится в папке %APPDATA%\Microsoft\Outlook.</span><span class="sxs-lookup"><span data-stu-id="97d0e-121">The .nk2 file is stored in %APPDATA%\Microsoft\Outlook.</span></span> <span data-ttu-id="97d0e-122">Дополнительные сведения о двоичном формате двоичных файлов кэша псевдонимов см. в документе [Outlook 2003/2007 NK2 File Format and Developer Guidelines.](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)</span><span class="sxs-lookup"><span data-stu-id="97d0e-122">For more information about the nickname cache binary file format, see [Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf).</span></span>
  
 <span data-ttu-id="97d0e-123">**Outlook 2010 и Outlook 2013**</span><span class="sxs-lookup"><span data-stu-id="97d0e-123">**Outlook 2010 and Outlook 2013**</span></span>
  
<span data-ttu-id="97d0e-124">Outlook 2010 или Outlook 2013 считывает поток автозаполнеия из сообщения в таблице "Связанное содержимое" почтового ящика почтовой учетной записи доставки.</span><span class="sxs-lookup"><span data-stu-id="97d0e-124">Outlook 2010 or Outlook 2013 reads the autocomplete stream from a message in the Associated Contents table of the Inbox of the mail account's delivery store.</span></span> <span data-ttu-id="97d0e-125">Это скрытое сообщение имеет класс сообщения и тему IPM.Configuration. Автозаполнеть.</span><span class="sxs-lookup"><span data-stu-id="97d0e-125">This hidden message has a message class and subject of IPM.Configuration.Autocomplete.</span></span> <span data-ttu-id="97d0e-126">Поток автозаполнения хранится в этом сообщении в свойстве PR_ROAMING_BINARYSTREAM ( Каноническое свойство[PidTagRoamingBinary).](pidtagroamingbinary-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="97d0e-126">The autocomplete stream is stored on this message in the PR_ROAMING_BINARYSTREAM property ([PidTagRoamingBinary Canonical Property](pidtagroamingbinary-canonical-property.md)).</span></span> <span data-ttu-id="97d0e-127">Данные автозаполнеия могут временно кэшироваться в DAT-файле автозаполнеия, расположенном в папке %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span><span class="sxs-lookup"><span data-stu-id="97d0e-127">The autocomplete data may be temporarily cached in an autocomplete .dat file located in %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache.</span></span> <span data-ttu-id="97d0e-128">Однако DAT-файл является только кэшем и не используется для записи обратно в хранилище доставки, когда пользователь выходит из Outlook 2010 или Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="97d0e-128">However, the .dat file is only a cache and is not used to write back to the delivery store when the user exits Outlook 2010 or Outlook 2013.</span></span>
  
## <a name="loading-the-autocomplete-stream"></a><span data-ttu-id="97d0e-129">Загрузка потока автозаполнения</span><span class="sxs-lookup"><span data-stu-id="97d0e-129">Loading the Autocomplete Stream</span></span>

<span data-ttu-id="97d0e-130">Outlook загружает поток автозаполнения при инициализации элемента с функциональными возможностями адресовки.</span><span class="sxs-lookup"><span data-stu-id="97d0e-130">Outlook loads the autocomplete stream whenever an item with addressing functionality is initialized.</span></span> <span data-ttu-id="97d0e-131">Например, адреса электронной почты используются в новых сообщениях электронной почты, ответе на почту, элементе контакта, в запросе на собрание и так далее.</span><span class="sxs-lookup"><span data-stu-id="97d0e-131">For example, email addresses are used in a new mail, a mail reply, a contact item, a meeting request, and so on.</span></span> <span data-ttu-id="97d0e-132">Чтобы загрузить данные, Outlook считыет все содержимое потока в память.</span><span class="sxs-lookup"><span data-stu-id="97d0e-132">To load the data, Outlook reads all of the contents of the stream into memory.</span></span>
  
<span data-ttu-id="97d0e-133">Для операций автозаполнеия Outlook взаимодействует исключительно с этой структурой в памяти в течение outlook.exe процесса.</span><span class="sxs-lookup"><span data-stu-id="97d0e-133">For autocomplete operations, Outlook interacts exclusively with this in-memory structure for the duration of the outlook.exe process lifetime.</span></span> <span data-ttu-id="97d0e-134">Outlook сохраняет структуру только после завершения работы.</span><span class="sxs-lookup"><span data-stu-id="97d0e-134">Outlook only saves the structure on shutdown.</span></span> <span data-ttu-id="97d0e-135">Дополнительные сведения об этом процессе см. в следующем разделе "Сохранение потока автозаполнеия".</span><span class="sxs-lookup"><span data-stu-id="97d0e-135">See the following section "Saving the Autocomplete Stream" for more information on this process.</span></span>
  
## <a name="saving-the-autocomplete-stream"></a><span data-ttu-id="97d0e-136">Сохранение потока автозаполнеия</span><span class="sxs-lookup"><span data-stu-id="97d0e-136">Saving the Autocomplete Stream</span></span>

<span data-ttu-id="97d0e-137">Outlook сохраняет поток автозаполнений при остановке работы, если список автозаполнений изменился одним из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="97d0e-137">Outlook saves the autocomplete stream on shutdown if the autocomplete list has changed in any of the following ways:</span></span>
  
- <span data-ttu-id="97d0e-138">Новая запись псевдонима добавляется путем разрешения имени, выбора получателя в диалоговом оке адресной книги или отправки почты получателю, которого еще нет в списке.</span><span class="sxs-lookup"><span data-stu-id="97d0e-138">A new nickname entry is added through resolving a name, picking a recipient from the address book dialog, or sending mail to a recipient that was not already in the list.</span></span>
    
- <span data-ttu-id="97d0e-139">Запись изменена путем отправки почты существующему получателю в списке.</span><span class="sxs-lookup"><span data-stu-id="97d0e-139">An entry is modified by sending mail to an existing recipient in the list.</span></span>
    
- <span data-ttu-id="97d0e-140">Пользователь удаляет запись с помощью пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="97d0e-140">An entry is removed by the user through the UI.</span></span>
    
- <span data-ttu-id="97d0e-141">Другие незначительные сценарии, не релевантные для этой темы.</span><span class="sxs-lookup"><span data-stu-id="97d0e-141">Other minor scenarios not relevant to this topic.</span></span>
    
<span data-ttu-id="97d0e-142">Сохранение изменений в данных автозаполнеия включает запись структуры в памяти обратно в поток [автозаполнеия.](autocomplete-stream.md)</span><span class="sxs-lookup"><span data-stu-id="97d0e-142">Saving changes to the autocomplete data involves writing the in-memory structure back to an [Autocomplete Stream](autocomplete-stream.md).</span></span> <span data-ttu-id="97d0e-143">При взаимодействии с Outlook 2007 поток будет сохранен в локальный NK2-файл.</span><span class="sxs-lookup"><span data-stu-id="97d0e-143">When interacting with Outlook 2007, the stream is saved to a local .nk2 file.</span></span> <span data-ttu-id="97d0e-144">Для Outlook 2010 или Outlook 2013 поток автозаполнеия записывает обратно в таблицу "Связанное содержимое" почтового ящика почтовой учетной записи доставки.</span><span class="sxs-lookup"><span data-stu-id="97d0e-144">For Outlook 2010 or Outlook 2013, the autocomplete stream writes back to the Associated Contents table of the Inbox of the mail account's delivery store.</span></span>
  
## <a name="recommendations"></a><span data-ttu-id="97d0e-145">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="97d0e-145">Recommendations</span></span>

- <span data-ttu-id="97d0e-146">Никогда не изменяйте поток автозаполнеия частично.</span><span class="sxs-lookup"><span data-stu-id="97d0e-146">Never partially modify the autocomplete stream.</span></span> <span data-ttu-id="97d0e-147">Поддерживаемым взаимодействием является 1) чтение всего потока автозаполнеия в память, 2) изменение структуры памяти и 3) запись всего потока обратно в таблицу "Связанное содержимое" в папке "Входящие" почтовой учетной записи (для Outlook 2010 или Outlook 2013) или в локальный NK2-файл (Outlook 2007).</span><span class="sxs-lookup"><span data-stu-id="97d0e-147">The supported interaction is to 1) read the entire autocomplete stream into memory, 2) modify the memory structure, and 3) write the entire stream back to either the Associated Contents table of the Inbox of the mail account's delivery store (for Outlook 2010 or Outlook 2013) or to the local .nk2 file (Outlook 2007).</span></span>
    
- <span data-ttu-id="97d0e-148">Не взаимодействуть с потоком автозаполнеия во время работы Outlook.</span><span class="sxs-lookup"><span data-stu-id="97d0e-148">Do not interact with the autocomplete stream while Outlook is running.</span></span> <span data-ttu-id="97d0e-149">Если Outlook работает во время изменения потока, скорее всего, он переопишет изменения при его закрытии.</span><span class="sxs-lookup"><span data-stu-id="97d0e-149">If Outlook is running while you modify the stream, it will likely overwrite your changes when it shuts down.</span></span>
    
- <span data-ttu-id="97d0e-150">Не записывай свойства типа PT_MV_UNICODE и PR_MV_STRING8 в поток автозаполнеия, который будет потребляться Microsoft Outlook 2003.</span><span class="sxs-lookup"><span data-stu-id="97d0e-150">Do not write properties of type PT_MV_UNICODE and PR_MV_STRING8 into an autocomplete stream to be consumed by Microsoft Outlook 2003.</span></span> <span data-ttu-id="97d0e-151">Эти свойства понятны только в Outlook 2007, Outlook 2010 и Outlook 2013.</span><span class="sxs-lookup"><span data-stu-id="97d0e-151">These properties are only understood by Outlook 2007, Outlook 2010, and Outlook 2013.</span></span>
    
- <span data-ttu-id="97d0e-152">При разработке кода, взаимодействующего с Outlook 2007, рекомендуется заблокировать NK2-файл от изменения другими процессами во время чтения и записи с помощью стандартных API блокировки файлов (например, **LockFile** в C/C++ и **FileStream.Lock** в C#).</span><span class="sxs-lookup"><span data-stu-id="97d0e-152">When developing code that interacts with Outlook 2007, we recommend that you lock the .nk2 file from modification by other processes while you are reading and writing it using standard file locking APIs (for example, **LockFile** in C/C++ and **FileStream.Lock** in C#).</span></span> 
    
- <span data-ttu-id="97d0e-153">Только изменяйте свойства типов из набора строк потока автозаполнеия.</span><span class="sxs-lookup"><span data-stu-id="97d0e-153">Only modify the properties of types that are from the row-set of the autocomplete stream.</span></span> <span data-ttu-id="97d0e-154">Дополнительные сведения о свойствах и типах свойств потока автозаполнеия см. в этой [теме.](autocomplete-stream.md)</span><span class="sxs-lookup"><span data-stu-id="97d0e-154">For more information about the autocomplete stream properties and property types, see [Autocomplete Stream](autocomplete-stream.md).</span></span>
    
## <a name="see-also"></a><span data-ttu-id="97d0e-155">См. также</span><span class="sxs-lookup"><span data-stu-id="97d0e-155">See also</span></span>



[<span data-ttu-id="97d0e-156">Autocomplete Stream</span><span class="sxs-lookup"><span data-stu-id="97d0e-156">Autocomplete Stream</span></span>](autocomplete-stream.md)
  
[<span data-ttu-id="97d0e-157">Профили MAPI</span><span class="sxs-lookup"><span data-stu-id="97d0e-157">MAPI Profiles</span></span>](mapi-profiles.md)


[<span data-ttu-id="97d0e-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span><span class="sxs-lookup"><span data-stu-id="97d0e-158">Outlook 2003/2007 NK2 File Format and Developer Guidelines</span></span>](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)


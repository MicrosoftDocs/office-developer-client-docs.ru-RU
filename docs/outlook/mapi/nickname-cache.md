---
title: Кэш псевдонимов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2813c102-6778-4443-ab4b-b573f3568705
description: 'Последнее изменение: 30 января 2013 г.'
ms.openlocfilehash: 841b01ae8dfcf841b0a1d64113ce7258c4c61583
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32334519"
---
# <a name="nickname-cache"></a>Кэш псевдонимов

 
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Microsoft Office Outlook 2007 Microsoft Outlook 2010, русская версия и Microsoft Outlook 2013 с кэшом ником, также известным как "поток автокомплектов". Поток автокомплетов — это Outlook список автокомплектов, который является списком имен, отображаемого в полях **Редактирование To**, **Cc** и **Bcc** во время составления электронной почты пользователем. В этом разделе описывается взаимодействие Outlook 2007, Outlook 2010 и Outlook 2013 годов с потоком автозаполнения, а также обсуждается двоичный формат файла и рекомендуемые способы взаимодействия с потоком автозаполнения. 
  
Для приложений, взаимодействующих с Outlook 2010 или Outlook 2013 г., поток автокомплетов хранится в качестве свойства MAPI и может быть изменен с помощью MAPI или объекта **PropertyAccessor** сообщения. Объект **PropertyAccessor** выставлен в Outlook 2010 или Outlook 2013. 
  
Нет зависимостей от Outlook объектной модели 2007 или API MAPI. Поэтому приложения, которые внося изменения в поток автокомплектов Outlook 2007 г., могут быть написаны с помощью любого языка программирования.
  
## <a name="interacting-with-the-autocomplete-stream"></a>Взаимодействие с потоком автозаполнения

При доступе к полям редактирования **To,** **Cc** или **Bcc** в сообщении поток автокомплетов загружается и отображается список имен пользователей. Outlook взаимодействует с потоком автокомплектов двумя способами: 
  
1. Загрузка потока автозаполнения 
    
2. Сохранение изменений в данных в потоке автокомплектов
    
Средства хранения данных автокомплектов различаются между 2007 Outlook и Outlook 2010 или Outlook 2013 года следующим образом: 
  
 **Outlook 2007**
  
Для Outlook 2007 года поток автокомплетов хранится в файле с тем же именем, что и профиль и расширение .nk2. Например, если по умолчанию используется профиль "Outlook", файл будет называться outlook.nk2. Файл .nk2 хранится в %APPDATA%\Microsoft\Outlook. Дополнительные сведения о формате двоичных файлов кэша псевдонима см. в Outlook [2003/2007 NK2 File Format and Developer Guidelines.](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
  
 **Outlook 2010 и Outlook 2013 г.**
  
Outlook 2010 или Outlook 2013 г. считываю поток автокомплетов из сообщения в таблице Associated Contents в почтовом ящике магазина доставки почтовой учетной записи. Это скрытое сообщение имеет класс сообщения и объект IPM.Configuration. Автокомплект. Поток автокомплетов хранится в этом сообщении в свойстве PR_ROAMING_BINARYSTREAM[(каноническое свойство PidTagRoamingBinary).](pidtagroamingbinary-canonical-property.md) Данные автокомплектов могут временно кэшироваться в файле autocomplete .dat, расположенном в %USERPROFILE%\AppData\Local\Microsoft\Outlook\RoamCache. Однако файл .dat является кэшем и не используется для записи обратно в хранилище доставки при выходе пользователя Outlook 2010 или Outlook 2013 года.
  
## <a name="loading-the-autocomplete-stream"></a>Загрузка потока автозаполнения

Outlook загружает поток автозаполнения при инициализации элемента с функциями адресов. Например, адреса электронной почты используются в новой почте, почтовом ответе, контактном элементе, запросе на собрание и так далее. Чтобы загрузить данные, Outlook считыв все содержимое потока в память.
  
Для автоматических операций Outlook взаимодействует исключительно с этой структурой памяти в течение всего outlook.exe процесса. Outlook сохраняет структуру только при остановке. Дополнительные сведения об этом процессе см. в следующем разделе "Сохранение потока автозаполненки".
  
## <a name="saving-the-autocomplete-stream"></a>Сохранение потока автокомплетов

Outlook сохраняет поток автозаполнений при остановке, если список автозаполнений изменился любым из следующих способов:
  
- Новая запись клички добавляется путем решения имени, выбора получателя из диалогового номера адресной книги или отправки почты получателю, который еще не был в списке.
    
- Запись изменена путем отправки почты существующему получателю в списке.
    
- Запись удаляется пользователем через пользовательский интерфейс.
    
- Другие второстепенные сценарии, не соответствующие этой теме.
    
Сохранение изменений в данных автокомплектов включает запись структуры в памяти обратно в [поток автокомплетов.](autocomplete-stream.md) При взаимодействии с Outlook 2007 г. поток сохранен в локальном файле .nk2. В Outlook 2010 или Outlook 2013 г. поток автокомплектов возвращается в таблицу "Связанное содержимое" почтового ящика магазина доставки почтовой учетной записи.
  
## <a name="recommendations"></a>Рекомендации

- Никогда частично не измените поток автокомплектов. Поддерживаемые взаимодействия : 1) чтение всего потока автокомплетов в память, 2) изменение структуры памяти и 3) запись всего потока обратно в таблицу Связанное содержимое в папке "Входящие" магазина доставки почтовой учетной записи (за Outlook 2010 или Outlook 2013 г.) или в локальный файл .nk2 (Outlook 2007 г.).
    
- Не взаимодействуть с потоком автокомплетов во время Outlook запуска. Если Outlook при изменении потока, при его закрытии, скорее всего, будет переоценка изменений.
    
- Не записывай свойства типа PT_MV_UNICODE и PR_MV_STRING8 в поток автокомплетов, потребляемых Корпорацией Майкрософт Outlook 2003 г. Эти свойства понимаются только Outlook 2007, Outlook 2010 и Outlook 2013.
    
- При разработке кода, который взаимодействует с Outlook 2007 г., рекомендуется заблокировать файл .nk2 из изменений другими процессами во время чтения и записи с помощью стандартных API блокировки файлов (например, **LockFile** в C/C++ и **FileStream.Lock** в C#). 
    
- Измените только свойства типов из строкового набора потока автокомплетов. Дополнительные сведения о свойствах потока автокомплетов и типах свойств см. в дополнительных сведениях [о потоке autocomplete.](autocomplete-stream.md)
    
## <a name="see-also"></a>См. также



[Поток автокомплетов](autocomplete-stream.md)
  
[Профили MAPI](mapi-profiles.md)


[Outlook 2003/2007 NK2 File Format and Developer Guidelines](https://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)


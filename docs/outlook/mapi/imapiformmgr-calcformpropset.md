---
title: Имапиформмгркалкформпропсет
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFormMgr.CalcFormPropSet
api_type:
- COM
ms.assetid: ab302bfd-5cff-49b4-b0d2-308ae5af478d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bf072aba27c90b7cea80c464e17fafb47524b695
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32342086"
---
# <a name="imapiformmgrcalcformpropset"></a>IMAPIFormMgr::CalcFormPropSet

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Возвращает массив свойств, которые использует группа форм.
  
```cpp
HRESULT CalcFormPropSet(
  LPSMAPIFORMINFOARRAY pfrminfoarray,
  ULONG ulFlags,
  LPMAPIFORMPROPARRAY FAR * ppResults
);
```

## <a name="parameters"></a>Параметры

 _пфрминфоаррай_
  
> возврата Указатель на массив объектов данных формы, определяющий формы, для которых возвращаются свойства.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих, как возвращается массив свойств в параметре _ппресултс_ . Можно задать следующие флаги: 
    
ФОРМПРОПСЕТ_ИНТЕРСЕКТИОН 
  
> Возвращаемый массив содержит пересечение свойств формы.
    
ФОРМПРОПСЕТ_УНИОН 
  
> Возвращаемый массив содержит объединение свойств формы.
    
MAPI_UNICODE 
  
> Возвращаемые в массиве строки представлены в формате Юникод. Если флаг МАПИ_УНИКОДЕ не установлен, строки представлены в формате ANSI.
    
 _Ппресултс_
  
> вышли Указатель на указатель на возвращаемую структуру [смапиформпропаррай](smapiformproparray.md) , которая содержит свойства, используемые формами. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вызов выполнен успешно и вернул ожидаемое значение или значения.
    
МАПИ_Е_БАД_ЧАРВИДС 
  
> Установлен либо флаг МАПИ_УНИКОДЕ, либо реализация не поддерживает Юникод, или МАПИ_УНИКОДЕ не задано, а реализация поддерживает только Юникод.
    
## <a name="remarks"></a>Комментарии

Средства просмотра форм вызывают метод **имапиформмгр:: калкформпропсет** , чтобы получить массив свойств, которые использует группа форм. **Калкформпропсет** принимает либо пересечение, либо объединение наборов свойств этих форм, в зависимости от флага, установленного в параметре _ulFlags_ , и возвращает структуру **смапиформпропаррай** , содержащую результирующую группу параметры. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если средство просмотра формы передает флаг МАПИ_УНИКОДЕ в параметре _ulFlags_ , все строки должны быть возвращены в виде строк Юникода. Поставщики библиотеки форм, не поддерживающие строки Юникода, должны возвращать МАПИ_Е_БАД_ЧАРВИДС, если МАПИ_УНИКОДЕ передается. 
  
## <a name="see-also"></a>См. также



[SMAPIFormPropArray](smapiformproparray.md)
  
[IMAPIFormMgr : IUnknown](imapiformmgriunknown.md)


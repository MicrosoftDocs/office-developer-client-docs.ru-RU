---
title: Поиск в хранилище сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9e8d4639-7507-4d98-b56f-a65be369dc40
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7240f49a15fdaea4d1f30dae578d25c3f2c1c0f3
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32338803"
---
# <a name="searching-a-message-store"></a>Поиск в хранилище сообщений

**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения могут выполнять поиск в одной или нескольких папках, в которых выполняется поиск сообщений, которые отвечают условиям поиска. Наиболее простая методика поиска включает в себя применение ограничения для определения критериев и размещения результатов в папке результатов поиска, созданной явным образом для этого поиска или для предыдущего поиска. Эту методику поддерживает не все хранилища сообщений. 

Чтобы определить, поддерживает ли используемое хранилище сообщений использование папок результатов поиска, вызовите его метод [IMAPIProp::](imapiprop-getprops.md) -Props, чтобы получить значение свойства **\_PR сторе_суппорт_маск** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)). Если установлен флаг СТОРЕ_СЕАРЧ_ОК, Поиск поддерживается. Если он не задан, потребуется альтернативный способ проверки целевых папок вручную.
  
### <a name="to-search-one-or-more-folders-in-a-message-store"></a>Поиск в одной или нескольких папках в хранилище сообщений
  
1. Если у вас есть папка результатов поиска из предыдущего поиска, перейдите к шагу 2. В противном случае для создания папки результатов поиска выполните следующие действия:
    
    1. Получите идентификатор записи для корневой папки результатов поиска, вызвав метод [IMAPIProp::](imapiprop-getprops.md) -PROPS хранилища сообщений и запрашивая **пр_финдер_ентрид** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)).
        
    2. Call [IMsgStore:: OpenEntry](imsgstore-openentry.md) для открытия папки, представленной с помощью пр_финдер_ентрид. 
        
    3. ВыЗовите метод [IMAPIFolder:: CreateFolder](imapifolder-createfolder.md) для создания папки результатов поиска с установленным флагом фолдер_сеарч. 
    
2. Создание ограничения для хранения критериев поиска. 
    
3. Создайте массив идентификаторов записей, представляющих папки для поиска. Этот шаг не требуется, если ранее использовалась папка результатов поиска, и вы хотите выполнить поиск в тех же папках.
    
4. ВыЗовите метод [IMAPIContainer:: сетсеарчкритериа](imapicontainer-setsearchcriteria.md) папки результатов поиска, указав _лпконтаинерлист_ в массиве идентификаторов записей и _лпрестриктион_ к ограничению. 
    
5. Если вы зарегистрировались для получения уведомлений о завершении поиска с хранилищем сообщений, дождитесь поступления уведомления.
    
6. Просмотрите результаты поиска, вызвав метод [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md) папки результатов поиска, чтобы получить доступ к его таблице содержимого. 
    
7. ВыЗовите таблицу содержимого: метод [IMAPITable:: QueryRows](imapitable-queryrows.md) для получения сообщений, удовлетворяющих условиям поиска. 
    


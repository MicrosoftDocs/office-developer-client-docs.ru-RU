---
title: Реализация листа свойств
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3f1c6497a182231645691f669d8900d33b495503
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33430051"
---
# <a name="property-sheet-implementation"></a>Реализация листа свойств

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Лист свойств — диалоговое окно для отображения свойств объекта. Свойства могут быть только для чтения, что позволяет пользователю просматривать их или читать или писать, что позволяет пользователю вносить изменения. В листе свойств содержится одно или несколько перекрывающихся детских окон, называемых страницами. Каждая страница содержит окна управления для настройки группы связанных свойств. Пользователи перемещаются со страницы на страницу, выбрав вкладку, которая выводит соответствующую страницу на первый план листа свойств.
  
Поставщики услуг должны реализовать лист свойств, отображает минимальный набор свойств, связанных с конфигурацией в службе сообщений. Если вы позволите изменить эти свойства службы сообщений, вы можете разрешить пользователям клиентских приложений, например панели управления, вносить изменения или осуществлять изменения программным образом. Реализация листов свойств для отображения и редактирования других типов свойств необязательна. 
  
Как правило, в следующих ситуациях необходимо отобразить лист свойств:
  
- При вызове клиентом объекта [IMAPIStatus::SettingsDialog используется метод IMAPIStatus::SettingsDialog.](imapistatus-settingsdialog.md) 
    
- Когда MAPI вызывает метод логона объекта поставщика.
    
- Когда MAPI вызывает функцию точки входа для службы сообщений поставщика.
    
Поставщики транспорта также реализуют листы свойств для отображения свойств, связанных с вариантами сообщений, а поставщики адресных книг реализуют листы свойств для просмотра и редактирования подробных сведений о пользователях сообщений и списках рассылки, расширенных критериях поиска и шаблонах для ввода новых пользователей.
  
Для создания листа свойств можно использовать один из следующих трех методов:
  
- Вручную, как и любое диалоговое окно.
    
- С помощью общего управления листом свойств, предоставляемым в Windows SDK.
    
- С помощью таблицы отображения MAPI.
    
Поставщики должны выбрать последний вариант (создать лист свойств с помощью таблицы отображения). Это самый простой вариант, так как он устраняет необходимость работы с пользовательским Windows интерфейсом. 
  
Чтобы реализовать лист свойств, построенный из таблицы отображения для свойств службы сообщений, используйте следующую процедуру:
  
1. Вызов [IMAPISupport::OpenProfileSection,](imapisupport-openprofilesection.md) чтобы открыть раздел в текущем профиле. [Передай mapIUID](mapiuid.md) или NULL, чтобы открыть профильный раздел поставщика. 
    
2. Вызов [CreateIProp для](createiprop.md) создания объекта данных свойства. 
    
3. Вызовите метод [IMAPIProp::CopyTo в разделе IMAPIProp::CopyTo,](imapiprop-copyto.md) чтобы скопировать все свойства раздела в объект данных свойства. 
    
4. Создайте таблицу отображения, создав одну или несколько структур [DTPAGE,](dtpage.md) описывающие элементы управления, отображаемые на листе свойств и вызываемые функцией [BuildDisplayTable,](builddisplaytable.md) или реализуя настраиваемый код. 
    
5. Вызов [IMAPISupport::D oConfigPropsheet,](imapisupport-doconfigpropsheet.md) чтобы отобразить лист свойств с скопированные свойствами. Передай указатель объекту данных свойств в качестве _параметра lpConfigData_ и указатель на таблицу отображения в качестве _параметра lpDisplayTable._ Если вы хотите переопредить режим доступа по умолчанию для этого листа свойств, не задайте флаг DT_EDITABLE для каждого управления в таблице отображения, которая представляет свойство только для чтения. 
    
6. После внесения всех изменений в лист свойств вызываем метод **IMAPIProp::CopyTo** объекта свойств, чтобы скопировать измененные свойства обратно в профильный раздел. 
    
Обзор таблиц отображения см. в таблице [Display Tables.](display-tables.md) 
  
Подробные сведения о таблицах отображения см. в [таблице Display Table Implementation.](display-table-implementation.md) 
  
Сведения о внедрении управления см. в см. в нем [Control Object Implementation.](control-object-implementation.md)
  
Чтобы получить индекс управления, выбранный пользователем в поле списка таблицы отображения, подождите, пока пользователь не нажмет **кнопку ОК** или **Применить**. На этом этапе идентификатор входа выбранного элемента возвращается в [интерфейс IMAPIProp : IUnknown](imapipropiunknown.md) как значение свойства, указанного участником **ulPRSetProperty** в структуре [DTBLLBX.](dtbllbx.md) 
  
Если необходимо добавить или удалить элементы из списка, не будет работать таблица отображения и метод [IMAPISupport::D ConfigPropsheet.](imapisupport-doconfigpropsheet.md) Вместо этого рассмотрите возможность реализации листа свойств с API свойств Win32, который содержится в comdlg32.dll файле. 
  
## <a name="see-also"></a>См. также



[Поставщики услуг MAPI](mapi-service-providers.md)


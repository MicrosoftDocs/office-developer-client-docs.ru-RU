---
title: Реализация страницы свойств
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3f1c6497a182231645691f669d8900d33b495503
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328527"
---
# <a name="property-sheet-implementation"></a>Реализация страницы свойств

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Страница свойств — это диалоговое окно для отображения свойств объекта. Свойства могут быть доступны только для чтения, что позволяет пользователю только просматривать их или читать и записывать, позволяя пользователю вносить изменения. Страница свойств содержит один или несколько перекрывающихся дочерних окон, называемых страницами. Каждая страница содержит окна элементов управления для настройки группы связанных свойств. Пользователи переносятся со страницы на страницу, выбирая вкладку, которая переводит соответствующую страницу на передний план страницы свойств.
  
Поставщики услуг должны реализовать страницу свойств, в которой отображается минимальный набор свойств, связанных с конфигурацией в службе сообщений. Если вы разрешаете изменение этих свойств службы сообщений, вы можете либо разрешить пользователям клиентских приложений, таких как панель управления, изменить или применить изменения программным способом. Реализация страниц свойств для отображения и изменения других типов свойств является необязательной. 
  
Как правило, необходимо отображать страницу свойств в следующих ситуациях:
  
- Когда клиент вызывает метод [имапистатус:: сеттингсдиалог](imapistatus-settingsdialog.md) объекта Status. 
    
- Когда MAPI вызывает метод входа объекта поставщика.
    
- Когда MAPI вызывает функцию точки входа для службы сообщений поставщика.
    
Поставщики транспорта также реализуют страницы свойств для отображения свойств, связанных с параметрами сообщений, а поставщики адресных книг реализуют страницы свойств для просмотра и редактирования подробных сведений об обмене сообщениями и списках рассылки, расширенном поиске условия и шаблоны для ввода новых пользователей.
  
Для создания страницы свойств можно использовать один из следующих трех способов:
  
- Вручную, как любое из диалоговых окон.
    
- С помощью общего элемента управления листа свойств, включенного в пакет SDK для Windows.
    
- С помощью таблицы отображения MAPI.
    
Поставщики должны выбрать последний вариант (создать страницу свойств с помощью таблицы отображения). Это самый простой вариант, так как он избавляет от необходимости работы с пользовательским интерфейсом Windows. 
  
Чтобы реализовать страницу свойств, созданную из таблицы отображения для свойств службы сообщений, используйте следующую процедуру.
  
1. Call [имаписуппорт:: опенпрофилесектион](imapisupport-openprofilesection.md) , чтобы открыть раздел в текущем профиле. Передайте [мапиуид](mapiuid.md) или значение null, чтобы открыть раздел профиля поставщика. 
    
2. Call [креатеипроп](createiprop.md) для создания объекта данных свойства. 
    
3. ВыЗовите метод [IMAPIProp:: CopyTo](imapiprop-copyto.md) раздела profile, чтобы скопировать все свойства раздела в объект данных свойства. 
    
4. Создайте таблицу отображения, создав одну или несколько структур [дтпаже](dtpage.md) , описывающих элементы управления, которые будут отображаться на странице свойств и вызвав функцию [буилддисплайтабле](builddisplaytable.md) , или реализовав пользовательский код. 
    
5. Call [имаписуппорт::D оконфигпропшит](imapisupport-doconfigpropsheet.md) для отображения страницы свойств с скопированными свойствами. Передайте указатель на объект данных Property в качестве параметра _лпконфигдата_ и указателя на таблицу отображения в качестве параметра _лпдисплайтабле_ . Если вы хотите переопределить режим доступа по умолчанию для этой страницы свойств, не задавайте флаг ДТ_ЕДИТАБЛЕ для каждого элемента управления в таблице отображения, который представляет свойство только для чтения. 
    
6. После внесения всех изменений на странице свойств вызовите метод **IMAPIProp:: CopyTo** объекта данных Property, чтобы скопировать измененные свойства обратно в раздел profile. 
    
Общие сведения о отображаемых таблицах приведены в разделе [Display Tables](display-tables.md). 
  
Подробную информацию о таблицах отображения можно узнать в статье [Реализация отображения таблицы](display-table-implementation.md). 
  
Сведения о реализации элемента управления можно найти в разделе [Реализация объекта Control](control-object-implementation.md).
  
Чтобы получить индекс элемента управления, выбираемого пользователем в списке отображаемой таблицы, подождите, пока пользователь нажмет кнопку **ОК** или **Применить**. На этом шаге идентификатор записи выбранного элемента записывается обратно в интерфейс [IMAPIProp: IUnknown](imapipropiunknown.md) в качестве значения свойства, указанного элементом **Улпрсетпроперти** в структуре [дтбллбкс](dtbllbx.md) . 
  
Если вам нужно иметь возможность добавлять и удалять элементы из списка, с помощью таблицы отображения и метода [имаписуппорт::D оконфигпропшит](imapisupport-doconfigpropsheet.md) не будут работать. Вместо этого рекомендуется реализовать страницу свойств с помощью API страницы свойств Win32, содержащегося в файле COMDLG32. dll. 
  
## <a name="see-also"></a>См. также



[Поставщики службы MAPI](mapi-service-providers.md)


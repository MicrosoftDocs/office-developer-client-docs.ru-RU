---
title: Реализация листа свойств
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3f1c6497a182231645691f669d8900d33b495503
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33430051"
---
# <a name="property-sheet-implementation"></a>Реализация листа свойств

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Лист свойств — это диалоговое окно для отображения свойств объекта. Свойства могут быть только для чтения, позволяя пользователю только просматривать их или читать и записывать, позволяя пользователю вносить изменения. Лист свойств содержит одно или несколько перекрывающихся окон, называемых страницами. Каждая страница содержит окна управления для настройки группы связанных свойств. Пользователи переходят со страницы на страницу, выбирая вкладку, которая выводит соответствующую страницу на переднем плане листа свойств.
  
Поставщики услуг должны реализовать таблицу свойств, которая отображает минимальный набор свойств, связанных с конфигурацией в службе сообщений. Если эти свойства службы сообщений можно изменить, можно разрешить пользователям клиентских приложений, например панели управления, вносить изменения или программными средствами. Реализация листов свойств для отображения и редактирования других типов свойств является необязательным. 
  
Обычно лист свойств требуется отображать в следующих ситуациях:
  
- Когда клиент вызывает метод [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) объекта состояния. 
    
- Когда MAPI вызывает метод для работы с объектом поставщика.
    
- Когда MAPI вызывает функцию точки входа для службы сообщений поставщика.
    
Поставщики транспорта также реализуют листы свойств для отображения свойств, связанных с параметрами сообщений, а поставщики адресных книг реализуют листы свойств для просмотра и изменения подробных сведений о пользователях сообщений и списках рассылки, расширенных критериях поиска и шаблонах для ввода новых пользователей.
  
Для создания листа свойств можно использовать один из следующих трех методов:
  
- Вручную, как в любом диалоговом окне.
    
- С помощью общего управления листа свойств, предоставленного в Windows SDK.
    
- С помощью отображаемой таблицы MAPI.
    
Поставщики должны выбрать последний вариант (создать лист свойств с помощью таблицы отображения). Это самый простой вариант, так как он устраняет необходимость работы с пользовательским интерфейсом Windows. 
  
Чтобы реализовать лист свойств, построенный из таблицы отображения для свойств службы сообщений, используйте следующую процедуру:
  
1. Вызовите [IMAPISupport::OpenProfileSection,](imapisupport-openprofilesection.md) чтобы открыть раздел в текущем профиле. [Передайте mapIUID](mapiuid.md) или NULL, чтобы открыть раздел профиля поставщика. 
    
2. Вызовите [CreateIProp,](createiprop.md) чтобы создать объект данных свойства. 
    
3. Вызовите метод [IMAPIProp::CopyTo](imapiprop-copyto.md) раздела профиля, чтобы скопировать все свойства раздела в объект данных свойства. 
    
4. Создайте таблицу отображения, создав одну или несколько структур [DTPAGE,](dtpage.md) описывающих элементы управления для отображения на листе свойств и вызывая функцию [BuildDisplayTable](builddisplaytable.md) или реализуя пользовательский код. 
    
5. Вызовите [IMAPISupport::D oConfigPropsheet,](imapisupport-doconfigpropsheet.md) чтобы отобразить лист свойств с скопированные свойства. Передав указатель на объект данных свойства в качестве параметра _lpConfigData_ и указатель на таблицу отображения в качестве параметра _lpDisplayTable._ Если вы хотите переопредить режим доступа по умолчанию для этого листа свойств, не устанавливайте флаг DT_EDITABLE для каждого из них в таблице отображения, который представляет свойство только для чтения. 
    
6. После внесения всех изменений на лист свойств вызовите метод **IMAPIProp::CopyTo** объекта данных свойства, чтобы скопировать измененные свойства обратно в раздел профиля. 
    
Обзор таблиц отображения см. в [таблице отображения.](display-tables.md) 
  
Подробные сведения о таблицах отображения см. в [описании реализации таблицы отображения.](display-table-implementation.md) 
  
Сведения о реализации управления см. в реализации [объекта control.](control-object-implementation.md)
  
Чтобы получить индекс выбранного пользователем в списке таблицы отображения, подождите, пока пользователь не нажмет кнопку **"ОК"** или **"Применить".** На этом этапе идентификатор записи выбранного элемента записи обратно в интерфейс [IMAPIProp : IUnknown](imapipropiunknown.md) в качестве значения свойства, указанного элементом **ulPRSetProperty** в [структуре DTBLLBX.](dtbllbx.md) 
  
Если требуется возможность добавления или удаления элементов из списка, использование таблицы отображения и [метода IMAPISupport::D oConfigPropsheet](imapisupport-doconfigpropsheet.md) не будет работать. Вместо этого рассмотрите возможность реализации листа свойств с API-файлом таблицы свойств Win32, содержа comdlg32.dll файла. 
  
## <a name="see-also"></a>См. также



[Поставщики услуг MAPI](mapi-service-providers.md)


---
title: Реализация страницы свойств
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f3475206-0237-4b5b-8efd-abd5d5e0b6c3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 406451adac3cd73286feb787bd6b4d2f356aa283
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812079"
---
# <a name="property-sheet-implementation"></a>Реализация страницы свойств

  
  
**Относится к**: Outlook 
  
Окно свойств — это диалоговое окно для отображения свойств объекта. Свойства может быть доступна только для чтения Включение пользователю только просматривать их, или чтения и записи, позволяя пользователям для внесения изменений. Окно свойств содержит один или несколько перекрывающиеся дочернего окна вызывается страниц. Каждая страница содержит элемент управления windows для настройки группы свойств, связанных с ними. Пользователи переходить между страницами, выбрав вкладку, которая переводит соответствующую страницу на передний план страницы свойств.
  
Поставщики услуг должен реализовывать свойств, которая отображает минимальный набор свойств, связанные с настройкой службы сообщений. Если разрешить эти свойства службы сообщений нужно изменить, можно либо разрешить пользователям клиентских приложений, таких как панель управления, внесите необходимые изменения или программным путем реализации изменения. Реализация свойств для отображения и редактирования других типов свойств не является обязательным. 
  
Как правило необходимо открыть окно свойств в следующих ситуациях:
  
- Когда клиент вызывает метод [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) состояние объекта. 
    
- Если MAPI вызывает метод объект поставщика входа в систему.
    
- Если MAPI вызывает функцию точки входа для вашего поставщика службы сообщений.
    
Поставщики транспорта также реализовать свойств для отображения свойств, связанных с параметрами сообщения и свойств, просматривать и редактировать подробные сведения об обмене сообщениями пользователей и списки рассылки, расширенный поиск, реализуемые поставщиками адресных книг критерии, шаблоны и для ввода новых пользователей.
  
Для создания свойств, можно использовать один из следующих трех способов:
  
- Вручную, как и любой диалоговое окно.
    
- С помощью свойства листа распространенных элемента управления в пакет SDK для Windows.
    
- С помощью MAPI отображения таблицы.
    
Поставщики должен выбрать параметр последнего (создать страницу свойств с помощью таблицы отображения). Это самый простой вариант, поскольку устраняет необходимость работать с пользовательским интерфейсом Windows. 
  
Для реализации свойств, построенная на основе таблицы отображения для свойств службы сообщений, используйте следующую процедуру:
  
1. Вызовите [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) , чтобы открыть отдельный раздел текущего профиля. Передайте [MAPIUID](mapiuid.md) или значение NULL, чтобы открыть раздел ваш поставщик профилей. 
    
2. Вызов [CreateIProp](createiprop.md) для создания объекта данных свойства. 
    
3. Вызовите метод [IMAPIProp::CopyTo](imapiprop-copyto.md) раздела профиля, чтобы скопировать все свойства раздела объект данных свойства. 
    
4. Создание таблицы отображения путем создания структуры один или несколько [DTPAGE](dtpage.md) , которые описывают элементы управления для отображения на странице свойств и вызов функции [BuildDisplayTable](builddisplaytable.md) или при помощи пользовательского кода. 
    
5. Вызов [IMAPISupport::DoConfigPropsheet](imapisupport-doconfigpropsheet.md) для отображения свойств, имеющей скопированные свойства. Передайте указатель на объект данных свойство как параметр _lpConfigData_ и указатель в таблице отображения и параметр _lpDisplayTable_ . Если вы хотите переопределить режим доступа по умолчанию для этой страницы свойств, не задан флаг DT_EDITABLE для каждого элемента управления в таблице отображения, который представляет свойство только для чтения. 
    
6. Когда все изменения, внесенные в окне свойств, вызовите метод **IMAPIProp::CopyTo** объект данных свойств для копирования изменения свойств в разделе профилей. 
    
Общие сведения о таблицах отображения разделе [Отображение таблиц](display-tables.md). 
  
Подробные сведения о таблицах отображения [Отображения реализации таблицы](display-table-implementation.md)см. 
  
Сведения о реализации элемента управления содержатся в разделе [Реализация объекта элемента управления](control-object-implementation.md).
  
Чтобы получить индекс элемента управления, выбранной пользователем в поле со списком отображения таблицы, подождите, пока пользователь нажимает **кнопку ОК** или **Применить**. На этом этапе идентификатор записи выбранного элемента, записывается обратно [IMAPIProp: IUnknown](imapipropiunknown.md) интерфейс в качестве значения свойства, указанного в член **ulPRSetProperty** в структуре [DTBLLBX](dtbllbx.md) . 
  
Если требуется иметь возможность добавлять или удалять элементы из списка с помощью метода [IMAPISupport::DoConfigPropsheet](imapisupport-doconfigpropsheet.md) и отображения таблицы не будут работать. Вместо этого рассмотрите возможность реализации свойств с помощью API листа свойство Win32, содержащийся в файле comdlg32.dll. 
  
## <a name="see-also"></a>См. также



[Поставщиков служб MAPI](mapi-service-providers.md)


---
title: Создание таблиц отображения и соответствующих структур
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a8548040-13ed-4a9f-a7ca-de610f94d7df
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 350272324c3827f4630f0cf35e3ade0ff213ac4d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416246"
---
# <a name="creating-display-tables-and-related-structures"></a><span data-ttu-id="1e49a-103">Создание таблиц отображения и соответствующих структур</span><span class="sxs-lookup"><span data-stu-id="1e49a-103">Creating display tables and related structures</span></span>
  
<span data-ttu-id="1e49a-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1e49a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1e49a-105">Создание таблицы отображения аналогично написанию программы с использованием языка сценариев.</span><span class="sxs-lookup"><span data-stu-id="1e49a-105">Creating a display table is similar to writing a program with a scripting language.</span></span> <span data-ttu-id="1e49a-106">Вы можете создать таблицу отображения, вызвав [буилддисплайтабле](builddisplaytable.md) или записав пользовательский код, чтобы заполнить строки и столбцы таблицы.</span><span class="sxs-lookup"><span data-stu-id="1e49a-106">You can create a display table either by calling [BuildDisplayTable](builddisplaytable.md) or writing custom code to populate the rows and columns of the table.</span></span> <span data-ttu-id="1e49a-107">В общем случае следует использовать метод **буилддисплайтабле** , так как это проще.</span><span class="sxs-lookup"><span data-stu-id="1e49a-107">In general, you should use the **BuildDisplayTable** technique because it is simpler.</span></span> 
  
<span data-ttu-id="1e49a-108">Прежде чем можно будет вызвать **буилддисплайтабле** для запроса MAPI для создания таблицы отображения, необходимо создать иерархию структур.</span><span class="sxs-lookup"><span data-stu-id="1e49a-108">Before you can call **BuildDisplayTable** to prompt MAPI to create a display table, there is a hierarchy of structures that you must build.</span></span> <span data-ttu-id="1e49a-109">Структура верхнего уровня, [дтпаже](dtpage.md), описывает одну страницу свойств с вкладками.</span><span class="sxs-lookup"><span data-stu-id="1e49a-109">The top-level structure, [DTPAGE](dtpage.md), describes a single tabbed property page.</span></span> <span data-ttu-id="1e49a-110">В каждой структуре **дтпаже** — это структура [дтктл](dtctl.md) , в которой описывается один элемент управления, например поле редактирования или переключатель.</span><span class="sxs-lookup"><span data-stu-id="1e49a-110">In every **DTPAGE** structure is a [DTCTL](dtctl.md) structure that describes a single control, such as an edit box or an option button.</span></span> <span data-ttu-id="1e49a-111">Каждая структура **дтктл** содержит структуру, относящуюся к типу элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1e49a-111">Each **DTCTL** structure contains a structure that is specific to the type of control.</span></span> <span data-ttu-id="1e49a-112">Например, если структура **дтктл** описывает элемент управления "поле ввода", она будет содержать структуру **дтбледит** .</span><span class="sxs-lookup"><span data-stu-id="1e49a-112">For example, if the **DTCTL** structure describes an edit box control, it will contain a **DTBLEDIT** structure.</span></span> <span data-ttu-id="1e49a-113">Структура **дтктл** для переключателя содержит структуру **дтблрадиобуттон** .</span><span class="sxs-lookup"><span data-stu-id="1e49a-113">The **DTCTL** structure for an option button contains a **DTBLRADIOBUTTON** structure.</span></span> 
  
<span data-ttu-id="1e49a-114">Эти структуры относятся непосредственно к **буилддисплайтабле**; у них нет смысла вне контекста этой функции.</span><span class="sxs-lookup"><span data-stu-id="1e49a-114">These structures relate directly to **BuildDisplayTable**; they have no meaning outside the context of this function.</span></span> <span data-ttu-id="1e49a-115">При вызове **буилддисплайтабле**одна или несколько структур **дтпаже** передаются в качестве входных параметров.</span><span class="sxs-lookup"><span data-stu-id="1e49a-115">When you call **BuildDisplayTable**, you pass one or more **DTPAGE** structures as input parameters.</span></span> <span data-ttu-id="1e49a-116">Структуры **дтпаже** содержат массив структур **дтктл** и число структур **дтктл** в массиве.</span><span class="sxs-lookup"><span data-stu-id="1e49a-116">The **DTPAGE** structures contain an array of **DTCTL** structures and a count of the number of **DTCTL** structures in the array.</span></span> <span data-ttu-id="1e49a-117">Для каждого элемента управления отображается одна структура в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="1e49a-117">There is one structure for every control to display in the dialog box.</span></span> <span data-ttu-id="1e49a-118">В структурах **дтпаже** также есть строка символов, представляющая имя соответствующего файла справки и ресурса диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="1e49a-118">**DTPAGE** structures also have a character string that represents the name of a corresponding Help file and dialog box resource.</span></span> 
  
<span data-ttu-id="1e49a-119">Каждая структура **дтктл** в структуре **дтпаже** содержит следующие данные, которые используются для задания свойств элемента управления:</span><span class="sxs-lookup"><span data-stu-id="1e49a-119">Each **DTCTL** structure in a **DTPAGE** structure contains the following data that is used to set properties for the control:</span></span> 
  
- <span data-ttu-id="1e49a-120">Тип элемента управления для настройки **PR_CONTROL_TYPEа** ([PidTagControlType](pidtagcontroltype-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="1e49a-120">The control type for setting **PR_CONTROL_TYPE** ([PidTagControlType](pidtagcontroltype-canonical-property.md)).</span></span>
    
- <span data-ttu-id="1e49a-121">Контрольные флаги для настройки **PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="1e49a-121">Control flags for setting **PR_CONTROL_FLAGS** ([PidTagControlFlags](pidtagcontrolflags-canonical-property.md)).</span></span>
    
- <span data-ttu-id="1e49a-122">Данные уведомления для настройки **PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="1e49a-122">Notification data for setting **PR_CONTROL_ID** ([PidTagControlId](pidtagcontrolid-canonical-property.md)).</span></span>
    
- <span data-ttu-id="1e49a-123">Структура управления для настройки **PR_CONTROL_STRUCTURE** ([PidTagControlStructure](pidtagcontrolstructure-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="1e49a-123">The control structure for setting **PR_CONTROL_STRUCTURE** ([PidTagControlStructure](pidtagcontrolstructure-canonical-property.md)).</span></span>
    
<span data-ttu-id="1e49a-124">Структуры **дтктл** также содержат идентификатор ресурса и, для элементов управления "поле со списком" и "поле со списком", фильтр знаков.</span><span class="sxs-lookup"><span data-stu-id="1e49a-124">**DTCTL** structures also contain a resource identifier and, for edit and combo box controls, a character filter.</span></span> 
  
<span data-ttu-id="1e49a-125">Элемент структуры элемента управления структуры **дтктл** описывает данные, которые уникальны для типа элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1e49a-125">The control structure member of a **DTCTL** structure describes the data that is unique for the type of control.</span></span> <span data-ttu-id="1e49a-126">MAPI определяет различные структуры для каждого типа элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1e49a-126">MAPI defines a different structure for each control type.</span></span> <span data-ttu-id="1e49a-127">Например, данные элемента управления редактирования представлены структурой **дтбледит** ; данные в списке представлены структурой **дтбллбкс** .</span><span class="sxs-lookup"><span data-stu-id="1e49a-127">For example, the data of an edit control is represented by a **DTBLEDIT** structure; the data of a list box is represented by a **DTBLLBX** structure.</span></span> 
  
<span data-ttu-id="1e49a-128">Связь между тремя типами структур таблицы отображения показана на следующем рисунке.</span><span class="sxs-lookup"><span data-stu-id="1e49a-128">The relationship between the three types of display table structures is shown in the following illustration.</span></span> <span data-ttu-id="1e49a-129">Диалоговое окно, описываемое этой таблицей отображения, состоит из двух элементов управления: метки и элемента управления "поле ввода".</span><span class="sxs-lookup"><span data-stu-id="1e49a-129">The dialog box described by this display table has two controls: a label and an edit control.</span></span> <span data-ttu-id="1e49a-130">Структура **дтбллбкс** имеет элемент смещения меток, а также несколько структур элементов управления, которые описывают, где начинается строка символов для метки.</span><span class="sxs-lookup"><span data-stu-id="1e49a-130">The **DTBLLBX** structure has a label offset member, as do several of the control structures, that describes where the character string for the label begins.</span></span> <span data-ttu-id="1e49a-131">Строки символов меток обычно размещаются в памяти сразу после структуры.</span><span class="sxs-lookup"><span data-stu-id="1e49a-131">Label character strings are typically placed in memory immediately following the structure.</span></span> 
  
<span data-ttu-id="1e49a-132">**Отображение структур таблицы**</span><span class="sxs-lookup"><span data-stu-id="1e49a-132">**Display table structures**</span></span>
  
<span data-ttu-id="1e49a-133">Отображение ![структур таблицы для](media/dtstruct.gif "отображения структуры таблицы")</span><span class="sxs-lookup"><span data-stu-id="1e49a-133">![Display table structures](media/dtstruct.gif "Display table structures")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="1e49a-134">См. также</span><span class="sxs-lookup"><span data-stu-id="1e49a-134">See also</span></span>

- [<span data-ttu-id="1e49a-135">Реализация таблицы отображения</span><span class="sxs-lookup"><span data-stu-id="1e49a-135">Display table implementation</span></span>](display-table-implementation.md)


---
title: имапипропсетпропс
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.SetProps
api_type:
- COM
ms.assetid: 49f007c9-42e5-4391-8b83-988c9b0ebdba
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 87709f8a77471637d7652982669bcba93ca2e1dd
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412620"
---
# <a name="imapipropsetprops"></a>IMAPIProp::SetProps

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Обновляет одно или несколько свойств.
  
```cpp
HRESULT SetProps(
  ULONG cValues,
  LPSPropValue lpPropArray,
  LPSPropProblemArray FAR * lppProblems
);
```

## <a name="parameters"></a>Параметры

 _квалуес_
  
> возврата Количество значений свойств, на которые указывает параметр _лппропаррай_ . Значение параметра _квалуес_ не должно быть равно 0. 
    
 _лппропаррай_
  
> возврата Указатель на массив структур [спропвалуе](spropvalue.md) , содержащих значения свойств, которые необходимо обновить. 
    
 _лпппроблемс_
  
> [вход, выход] На входе указатель на указатель на структуру [спроппроблемаррай](spropproblemarray.md) ; в противном случае — значение NULL, которое указывает на отсутствие необходимости в сведениях об ошибке. Если _лпппроблемс_ является допустимым указателем на входе, **SetProps** возвращает подробные сведения об ошибках при обновлении одного или нескольких свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Свойства успешно обновлены.
    
Следующие значения могут возвращаться в структуре **спроппроблемаррай** , но не в качестве возвращаемых значений для **SetProps**:
  
MAPI_E_BAD_CHARWIDTH 
  
> Установлен флаг MAPI_UNICODE, а реализация не поддерживает Юникод, или MAPI_UNICODE не задано, а реализация поддерживает только Юникод.
    
MAPI_E_COMPUTED 
  
> Свойство не может быть Обновлено, так как оно доступно только для чтения, которое вычисляется поставщиком службы, который отвечает за объект.
    
MAPI_E_INVALID_TYPE 
  
> Недопустимый тип свойства.
    
MAPI_E_NO_ACCESS 
  
> Предпринята попытка изменить объект, предназначенный только для чтения, или доступ к объекту, для которого у пользователя недостаточно разрешений.
    
MAPI_E_NOT_ENOUGH_MEMORY 
  
> Свойство не может быть Обновлено, так как оно больше размера буфера удаленного вызова процедур (RPC).
    
MAPI_E_UNEXPECTED_TYPE 
  
> Тип свойства не является типом, ожидаемым реализацией вызова.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Игнорируйте тег свойства **PR_NULL** ([PidTagNull](pidtagnull-canonical-property.md)) и все свойства с типом **PT_ERROR**. Не вносите изменения или сообщайте о проблемах в структуре **спроппроблемаррай** . 
  
Возвращает MAPI_E_INVALID_PARAMETER, если свойство типа **PT_OBJECT** включено в массив значений свойства. Также возвращайте эту ошибку, если в массив включено свойство с несколькими значениями, а его элемент **квалуес** имеет значение 0. 
  
Если вызов выполняется в целом, но возникают проблемы с настройкой некоторых свойств, возвращайте S_OK и поместите сведения о проблемах в соответствующую запись структуры **спроппроблемаррай** , на которую указывает параметр _лпппроблемс_ . 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

В зависимости от поставщика услуг Вы также можете изменить тип свойства, передав тег свойства, который содержит другой тип, чем ранее использовался с заданным идентификатором свойства.
  
Если вы включили тег свойства для свойства, которое не поддерживается объектом, а реализация **SetProps** позволяет создавать новые свойства, свойство добавляется в объект. Все предыдущие значения, хранящиеся в идентификаторе свойства, использованном для нового свойства, отбрасываются. 
  
Обратите внимание, что возвращаемое значение S_OK не гарантирует, что все свойства были успешно обновлены. Некоторые поставщики кэшируют вызовы **SetProps** до тех пор, пока не будут получены вызовы, требующие вмешательства поставщика, такие как [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) или [IMAPIProp:: PROPS](imapiprop-getprops.md). Таким образом, можно получить значения ошибок, которые относятся к вызову **SetProps** с помощью последующих вызовов. 
  
Если **SetProps** возвращает S_OK, проверьте структуру **спроппроблемаррай** , на которую указывает _лпппроблемс_ для проблем с обновлением отдельных свойств. Если **SetProps** возвращает ошибку, не проверяйте массив проблем свойств. Вместо этого вызовите метод объекта [IMAPIProp:: GetLastError](imapiprop-getlasterror.md) . 
  
При обновлении больших свойств **SetProps** может не работать и возвращать MAPI_E_NOT_ENOUGH_MEMORY. Максимальный размер свойств не задан, а различные объекты могут иметь разные ограничения. Если вы обрабатываете потенциально большие свойства, будьте готовы вызвать метод [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) с IID_IStream как идентификатор интерфейса, если **SetProps** возвращает это значение ошибки. 
  
Вызовите функцию [мапифрибуффер](mapifreebuffer.md) , чтобы освободить структуру **спроппроблемаррай** . 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Редакторсвойств. cpp  <br/> |Кпропертедитор:: Вритеспропвалуетубжект  <br/> |MFCMAPI использует метод **IMAPIProp:: SetProps** для записи свойства обратно в объект после того, как свойство было изменено.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::GetLastError](imapiprop-getlasterror.md)
  
[IMAPIProp::GetProps](imapiprop-getprops.md)
  
[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[SPropProblemArray](spropproblemarray.md)
  
[SPropValue](spropvalue.md)
  
[IMAPIProp : IUnknown](imapipropiunknown.md)


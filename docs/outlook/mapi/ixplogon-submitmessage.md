---
title: IXPLogonSubmitMessage
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.SubmitMessage
api_type:
- COM
ms.assetid: a261ba0d-cb56-4935-b745-1d4bbd0b8b9d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8a0b10596bdfdc1ea33f6d170ee1e021193d3788
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809646"
---
# <a name="ixplogonsubmitmessage"></a>IXPLogon::SubmitMessage

  
  
**Относится к**: Outlook 
  
Указывает, что диспетчер очереди MAPI для поставщика транспорта для доставки сообщения.
  
```cpp
HRESULT SubmitMessage(
  ULONG ulFlags,
  LPMESSAGE lpMessage,
  ULONG FAR * lpulMsgRef,
  ULONG FAR * lpulReturnParm
);
```

## <a name="parameters"></a>���������

 _ulFlags_
  
> [in] Битовая маска флаги, который определяет, как отправить сообщение. Можно задать следующий флаг:
    
BEGIN_DEFERRED 
  
> Диспетчер очереди MAPI вызывает поставщика транспорта с сообщением, которое ранее отложено. Идентификатор записи сообщения совпадает с при его отложено. Сообщение отложено, передав ее идентификатор записи обратно в диспетчер очереди MAPI с помощью метода [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) с флагом NOTIFY_SENTDEFERRED. 
    
 _lpMessage_
  
> [in] Указатель на объект message (представляющие сообщения для доставки), которая имеет разрешение на чтение/запись, поставщика транспорта, используемый для доступа и работы с этого сообщения. Этот объект действителен до того времени, после поставщика транспорта возвращает из последующих вызов метода [IXPLogon::EndMessage](ixplogon-endmessage.md) . 
    
 _lpulMsgRef_
  
> [out] Указатель на переменную, в котором поставщика транспорта возвращает значение ссылки, назначенных для данного сообщения. Диспетчер очереди MAPI передает это значение ссылку в последующих вызовов для данного сообщения. Диспетчер очереди MAPI Инициализирует значение 0 перед возвращением поставщика транспорта.
    
 _lpulReturnParm_
  
> [out] Указатель на переменную, которая соответствует значению MAPI_E_WAIT или MAPI_E_NETWORK_ERROR об ошибке, возвращенное **SubmitMessage**.
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Вызов успешно и возвращается ожидаемым значением или значения.
    
MAPI_E_BUSY 
  
> Поставщика транспорта не может обрабатывать сообщения, так как он выполнение другой операции. Для указания, что обработка не произошло и диспетчер очереди MAPI не должны вызывать **EndMessage**поставщика следует использовать это возвращаемое значение. Диспетчер очереди MAPI повторите вызов **SubmitMessage** попытку позже. 
    
MAPI_E_CANCEL 
  
> Хотя поставщика транспорта и запрашивает, что диспетчер очереди MAPI повторно отправить сообщения на предыдущей **SpoolerNotify** звонок, условия был изменен после и сообщения не должна быть повторно. Диспетчер очереди MAPI будут поступать какой-либо другой обработки. 
    
MAPI_E_NETWORK_ERROR 
  
> Ошибка сети запрещено успешного завершения операции. Параметр _lpulReturnParm_ должен иметь значение количество секунд, по истечении которого диспетчер очереди MAPI повторно предоставляет сообщение. 
    
MAPI_E_NOT_ME 
  
> Поставщика транспорта не удается обработать это сообщение. Диспетчер очереди MAPI должны пытаться поиск другого поставщика транспорта. Для указания, что обработка не произошло и диспетчер очереди MAPI не должны вызывать **EndMessage**поставщика следует использовать это возвращаемое значение.
    
MAPI_E_WAIT 
  
> Временные неполадки предотвращает поставщика транспорта обработки сообщения. Параметр _lpulReturnParm_ должен иметь значение количество секунд, по истечении которого диспетчер очереди MAPI повторно предоставляет сообщение. 
    
## <a name="remarks"></a>Замечания

Диспетчер очереди MAPI вызывает метод **IXPLogon::SubmitMessage** при получении сообщения для поставщика транспорта для доставки. Сообщение передается поставщика транспорта с помощью параметра _lpMessage_ . 
  
Если поставщик готов принять сообщение, он возвращает значение ссылки с помощью параметра _lpulMsgRef_ процесс переданный объект и вернуть соответствующее значение (обычно это значение S_OK). Если поставщик не готовы обрабатывать передачу, он должен возвращать значение ошибки, и при необходимости другой MAPI возврат значения в _lpulReturnParm_ , чтобы указать время ожидания очереди MAPI перед повторной отправки сообщения. 
  
Реализация поставщика транспорта этого метода можно выполнить следующие:
  
- Поместить сообщение в внутреннюю очередь ожидания для передачи, возможно копирование сообщения на локальное хранилище и возврата.
    
- Попытка выполнения фактических передачи и вернуть по завершении передачи успешно или неудачно.
    
- Определите необходимость отправки сообщения после проверки используемых ресурсов. В этом случае если ресурс свободен, поставщик может блокировки, Подготовка сообщение и отправить его. Если ресурсом «занят», поставщик можно подготовить сообщения и отложить передачу позднее.
    
Предпочтительный способ передачи сообщений зависит от поставщика транспорта и ожидаемого числа процессов за для системных ресурсов. 
  
Во время звонка **SubmitMessage** поставщика транспорта управляет передачи данных сообщений из объекта сообщения. Тем не менее поставщика транспорта следует назначить значение ссылки сообщения, к которой он возвращает указатель в _lpulMsgRef_перед передачей данных. Так, так как в любой момент во время процесса диспетчер очереди MAPI можно вызвать метод [IXPLogon::TransportNotify](ixplogon-transportnotify.md) с флагом NOTIFY_CANCEL_MESSAGE выполнен сигнала поставщика, который должен освобождать все открытые объекты и остановки передачи сообщений. 
  
Поставщика транспорта не следует отправлять все свойства nontransmittable сообщения. При обнаружении таких свойств, его следует перейти к обработки следующее свойство. Поставщик должен постарайтесь не отображаются сведения о получателях MAPI_P1 как часть содержимого передаваемого сообщения; Поставщик следует использовать эти получателей сведения только для целей-адресов. MAPI_P1 получатели являются внутренними получателей, которые используются для повторной отправки сообщений. они должны не передаются. Используйте другие получателей для передачи сведения о получателях. Упорядочение предназначен для разрешения Отправить получателей той же получателей таблицы как изначально указанным получателям.
  
Во время звонка **SubmitMessage** диспетчер очереди MAPI обрабатывает методы для объектов, которые открыты во время передачи сообщения, и он обрабатывает все вложения. В этом обработка может занять много времени. Поставщики транспорта можно вызвать метод [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) для очереди MAPI часто во время такой обработки для освобождения времени использования Процессора для других системных задач. 
  
В таблице получателей сообщения, диспетчер очереди MAPI изначально передается видны всех получателей сообщений. Поставщика транспорта должен обрабатывать только получателей, которые можно обрабатывать — на основании идентификатор записи и тип адреса — и, который еще не их свойство **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)), задайте значение TRUE. Если **PR_RESPONSIBILITY** уже имеет значение TRUE, другой поставщик транспорта обработал получателя. По завершении обработки достаточно получателя для определения ли он может обрабатывать сообщения для этого получателя поставщика его следует задать свойство **PR_RESPONSIBILITY** этого получателя значение TRUE в переданного сообщения. Как правило поставщик Осуществляет это определение после завершения доставки сообщений. 
  
Как правило поставщика транспорта не возвращает из вызова **SubmitMessage** до завершения переноса данных сообщений. Если сообщение об ошибке не возвращается, вызов метода [IXPLogon::EndMessage](ixplogon-endmessage.md) представляет собой следующий вызов из очереди MAPI, к поставщику. 
  
Если **SubmitMessage** возвращает ошибку, диспетчер очереди MAPI освобождает сообщение в процессе без сохранения изменений. Если поставщика транспорта требуется для сохранения изменений сообщение, необходимо вызвать метод [IMAPIProp::SaveChanges](imapiprop-savechanges.md) в окне сообщения до возвращения. 
  
В случае ошибки, которые возникают из-за проблем с транспорта диспетчер очереди MAPI сохраняет сообщения, но задержку повторной отправки сообщений для поставщика транспорта, на основе значения, возвращаемого в _lpulReturnParm_. Поставщика транспорта необходимо заполнить это значение, если ее значение, возвращаемое **SubmitMessage** MAPI_E_WAIT или MAPI_E_NETWORK_ERROR. При возникновении серьезной ошибки, поставщика транспорта необходимо вызвать метод [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) с флагом NOTIFY_CRITICAL_ERROR. 
  
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md)
  
[IMAPISupport::SpoolerYield](imapisupport-spooleryield.md)
  
[IXPLogon::EndMessage](ixplogon-endmessage.md)
  
[IXPLogon::TransportNotify](ixplogon-transportnotify.md)
  
[IXPLogon : IUnknown](ixplogoniunknown.md)


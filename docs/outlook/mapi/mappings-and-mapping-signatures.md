---
title: Сопоставления и подписи сопоставлений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 773f6671-cc21-4d1f-a11d-308bc71c852d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: cd26ce4bc2da3da639b4a611fc9a69f39b13e5f3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410016"
---
# <a name="mappings-and-mapping-signatures"></a><span data-ttu-id="2b712-103">Сопоставления и подписи сопоставлений</span><span class="sxs-lookup"><span data-stu-id="2b712-103">Mappings and Mapping Signatures</span></span>

  
  
<span data-ttu-id="2b712-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2b712-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2b712-105">Когда поставщик услуг поддерживает именуемые свойства, каждый набор пар идентификаторов и имен называется сопоставлением.</span><span class="sxs-lookup"><span data-stu-id="2b712-105">When a service provider supports named properties, each set of identifier and name pairs is referred to as a mapping.</span></span> <span data-ttu-id="2b712-106">Поставщики услуг могут поддерживать одно или несколько сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="2b712-106">Service providers can support one mapping or several.</span></span> <span data-ttu-id="2b712-107">То есть один поставщик, например, может реализовать методы **GetIDsFromNames** и **GetNamesFromIDs** для всех объектов, в которых хранятся сообщения, папки и сообщения, для работы с одним списком имен и соответствующими идентификаторами.</span><span class="sxs-lookup"><span data-stu-id="2b712-107">That is, one message store provider, for example, can implement the **GetIDsFromNames** and **GetNamesFromIDs** methods for all of its message, folder, and message store objects to work with a single list of names and their corresponding identifiers.</span></span> <span data-ttu-id="2b712-108">Другой поставщик может иметь один список для каждой папки и содержащихся в ней сообщений или реализовать уникальный список для каждого сообщения и каждой папки.</span><span class="sxs-lookup"><span data-stu-id="2b712-108">Another message store provider might have one list for every folder and the messages contained within it, or implement a unique list for every message and every folder.</span></span> <span data-ttu-id="2b712-109">Поставщики содержимого, которые используют уникальное сопоставление для каждого сообщения, не должны позволять именовамым свойствам отображаться в таблицах содержимого папки, так как для заданного имени свойства идентификатор свойства будет отличаться от сообщения к сообщению.</span><span class="sxs-lookup"><span data-stu-id="2b712-109">Message store providers that use a unique mapping for every message must not allow named properties to appear in their folder contents tables because for a given property name, the property identifier will differ from message to message.</span></span> <span data-ttu-id="2b712-110">MAPI рекомендует поставщикам упростить работу с одним списком для всех объектов, включая таблицы.</span><span class="sxs-lookup"><span data-stu-id="2b712-110">MAPI recommends that providers keep it simple and operate with a single list for all of their objects including tables.</span></span> 
  
<span data-ttu-id="2b712-111">Для каждого сопоставления поставщики услуг должны предоставить подпись сопоставления.</span><span class="sxs-lookup"><span data-stu-id="2b712-111">For every mapping, service providers must supply a mapping signature.</span></span> <span data-ttu-id="2b712-112">Подпись сопоставления — это двоичное значение, обычно guID, которое уникальным образом идентифицирует набор идентификаторов свойств и их соответствующие имена.</span><span class="sxs-lookup"><span data-stu-id="2b712-112">A mapping signature is a binary value, usually a GUID, that uniquely identifies a set of property identifiers and their corresponding names.</span></span> <span data-ttu-id="2b712-113">Подписи сопоставления хранятся в свойстве PR_MAPPING_SIGNATURE **объекта** ([PidTagMappingSignature).](pidtagmappingsignature-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="2b712-113">Mapping signatures are stored in an object's **PR_MAPPING_SIGNATURE** ([PidTagMappingSignature](pidtagmappingsignature-canonical-property.md)) property.</span></span> <span data-ttu-id="2b712-114">Поставщики услуг должны изменять  значение свойства PR_MAPPING_SIGNATURE при изменении сопоставления, которое оно представляет.</span><span class="sxs-lookup"><span data-stu-id="2b712-114">Service providers must change the value for their **PR_MAPPING_SIGNATURE** property whenever a change is made to the mapping that it represents.</span></span> <span data-ttu-id="2b712-115">Например, **PR_MAPPING_SIGNATURE** необходимо обновить при добавлении нового идентификатора к имени или добавлению новой пары имени и идентификатора.</span><span class="sxs-lookup"><span data-stu-id="2b712-115">For example, **PR_MAPPING_SIGNATURE** must be updated if a new identifier is assigned to a name or a new name and identifier pair is added.</span></span> 
  
<span data-ttu-id="2b712-116">Клиенты, работающие с именоваными  свойствами объектов, используют свойства PR_MAPPING_SIGNATURE объектов в операциях сравнения и копирования.</span><span class="sxs-lookup"><span data-stu-id="2b712-116">Clients working with the named properties of objects use the objects' **PR_MAPPING_SIGNATURE** properties in comparison and copy operations.</span></span> <span data-ttu-id="2b712-117">Для сравнения идентификаторов имен, принадлежащих двум объектам, клиенты, не использующие подписи сопоставления, должны вызывать [идентификаторы IMAPIProp::GetNamesFromID для](imapiprop-getnamesfromids.md) обоих объектов, чтобы получить имена для каждого из идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="2b712-117">To compare named property identifiers belonging to two objects, clients not using mapping signatures must call [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md) on both objects to retrieve the names for each of the identifiers.</span></span> <span data-ttu-id="2b712-118">Использование подписей сопоставления объектов может сделать этот вызов ненужным.</span><span class="sxs-lookup"><span data-stu-id="2b712-118">Using the mapping signatures of objects can render this call unnecessary.</span></span> <span data-ttu-id="2b712-119">Если два объекта имеют одинаковое значение для PR_MAPPING_SIGNATURE свойств, они используют одно и то же сопоставление. </span><span class="sxs-lookup"><span data-stu-id="2b712-119">When two objects have the same value for their **PR_MAPPING_SIGNATURE** properties, they use the same mapping.</span></span> <span data-ttu-id="2b712-120">Идентификаторы, которые используют одно и то же сопоставление, можно сравнить напрямую.</span><span class="sxs-lookup"><span data-stu-id="2b712-120">Identifiers that use the same mapping can be compared directly.</span></span> <span data-ttu-id="2b712-121">Поставщики служб, реализуют [IMAPIProp::CopyTo](imapiprop-copyto.md) и [IMAPIProp::CopyProps,](imapiprop-copyprops.md) также могут использовать подпись сопоставления объекта.</span><span class="sxs-lookup"><span data-stu-id="2b712-121">Service providers that implement [IMAPIProp::CopyTo](imapiprop-copyto.md) and [IMAPIProp::CopyProps](imapiprop-copyprops.md) can also take advantage of an object's mapping signature.</span></span> <span data-ttu-id="2b712-122">При копировании именуемых свойств между объектами поставщики служб могут избежать шага преобразования, если исходные и назначения объектов имеют одну и ту же подпись сопоставления.</span><span class="sxs-lookup"><span data-stu-id="2b712-122">When copying named properties between objects, service providers can avoid the conversion step when the source and destination objects have the same mapping signature.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2b712-123">См. также</span><span class="sxs-lookup"><span data-stu-id="2b712-123">See also</span></span>



[<span data-ttu-id="2b712-124">IMAPIProp : IUnknown</span><span class="sxs-lookup"><span data-stu-id="2b712-124">IMAPIProp : IUnknown</span></span>](imapipropiunknown.md)


[<span data-ttu-id="2b712-125">Именованные свойства MAPI</span><span class="sxs-lookup"><span data-stu-id="2b712-125">MAPI Named Properties</span></span>](mapi-named-properties.md)


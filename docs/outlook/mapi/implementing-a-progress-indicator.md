---
title: Реализация индикатора хода выполнения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6972c960705c336aa6ff96d81b48ccbd490a22ee
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435098"
---
# <a name="implementing-a-progress-indicator"></a>Реализация индикатора хода выполнения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Многие операции, инициированные клиентами, отбирают значительное время. Одним из входных параметров для этих потенциально длительных операций является указатель на объект хода выполнения — объект, который реализует [интерфейс IMAPIProgress : IUnknown.](imapiprogressiunknown.md) Объекты хода выполнения контролируют внешний вид и отображение индикаторов хода выполнения и реализуются клиентами и MAPI. Можно выбрать, следует ли реализовать объект хода выполнения. Реализация MAPI доступна поставщикам услуг, если вы не хотите их использовать. 
  
Объекты хода выполнения работают со следующими фрагментами данных:
  
- Глобальное минимальное значение, которое при методе [IMAPIProgress::P rogress](imapiprogress-progress.md) должно быть меньше или равно значению параметра _ulValue._ В начале операции  _значение ulValue_ будет равно этому минимальному значению. 
    
- Глобальное максимальное значение, которое при :P **IMAPIProgress::P должно** быть больше или равно параметру _ulValue._ В конце операции  _значение ulValue_ будет равно этому максимальному значению. 
    
- Значение флагов, которое указывает, соответствует ли ход выполнения элементу верхнего или нижнего уровня.
    
- Значение, которое указывает текущий уровень хода выполнения операции.
    
- Число обработанных в настоящее время элементов относительно общего числа.
    
- Общее количество элементов, обрабатываемых во время операции.
    
Минимальное и максимальное значения представляют начало и конец операции в числовом формате. Используйте 1 для начального минимального значения и 1000 для начального максимального значения, передав эти значения поставщикам услуг в методах [IMAPIProgress::GetMin](imapiprogress-getmin.md) и [IMAPIProgress::GetMax.](imapiprogress-getmax.md) Поставщики услуг сбрасывают эти значения при вызове [IMAPIProgress::SetLimits.](imapiprogress-setlimits.md) 
  
Значение флагов используется поставщиками служб для определения того, как они должны устанавливать другие значения. Инициализировать значение флагов для MAPI_TOP_LEVEL и вернуть это значение в реализации **GetFlags,** пока поставщик службы не сбросит его, вызывая **SetLimits**. 
  
В реализации метода **SetLimits** сохраните локальные копии каждого из параметров: _lpulMin,_ _lpulMax_ и _lpulFlags._ Эти значения должны быть легко доступны, когда поставщик услуг вызывает методы **GetMin,** **GetMax** или **GetFlags.** 
  
Чтобы обновить отображение индикатора хода выполнения, поставщики услуг вызовите метод **IMAPIProgress::P rogress.** Этот метод имеет три параметра: значение, число и общее значение. Используйте первый параметр  _ulValue_ для отображения индикатора хода выполнения. Параметр  _ulValue_ является индикатором хода выполнения и будет равен глобальному  _ulMin_ только в самом начале операции и равен глобальному  _ulMax_ только после завершения операции. 
  
Используйте второй и третий параметры  _ulCount_ и  _ulTotal_(если они доступны), чтобы отобразить необязательное сообщение, например "5 элементов из 10 завершено". Если для второго и третьего параметров заданы 0, можно выбрать, следует ли визуально изменять индикатор хода выполнения. Некоторые поставщики услуг устанавливают для этих параметров нули, чтобы указать, что они обрабатывают подобект, ход выполнения которого отслеживается относительно родительского объекта. В этой ситуации имеет смысл изменить отображение только в том случае, если родительский объект сообщает о ходе выполнения. Некоторые поставщики услуг каждый раз передают нули для этих параметров. 
  


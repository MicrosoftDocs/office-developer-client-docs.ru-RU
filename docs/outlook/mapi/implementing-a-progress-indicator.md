---
title: Реализация индикатора хода выполнения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6972c960705c336aa6ff96d81b48ccbd490a22ee
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332853"
---
# <a name="implementing-a-progress-indicator"></a>Реализация индикатора хода выполнения

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Многие операции, инициированные клиентами, выполняются в течение длительного времени. Один из входных параметров для этих потенциально длительных операций — указатель на объект Progress — объект, реализующий интерфейс [IMAPIProgress: IUnknown](imapiprogressiunknown.md) . Объекты хода выполнения управляют внешним видом и отображением индикаторов хода выполнения и реализуются клиентами и MAPI. Вы можете выбрать, следует ли реализовать объект Progress. Реализация MAPI доступна для использования поставщиками услуг, если вы не предоставляете реализацию. 
  
Объекты хода выполнения работают со следующими фрагментами данных:
  
- Глобальное минимальное значение, которое при вызове метода [IMAPIProgress::P рогресс](imapiprogress-progress.md) , должно быть меньше или равно значению параметра _улвалуе_ . В начале операции _улвалуе_ будет равно этому минимальному значению. 
    
- Глобальное максимальное значение, которое при вызове метода **IMAPIProgress::P рогресс** , должно быть больше или равно параметру _улвалуе_ . В конце операции _улвалуе_ будет равно этому максимальному значению. 
    
- Значение флага, которое указывает, соответствует ли ход выполнения указанному элементу верхнего или нижнего уровня.
    
- Значение, указывающее текущий уровень хода выполнения для операции.
    
- Число обработанных в данный момент элементов, относящихся к общему количеству.
    
- Общее количество элементов, которые должны быть обработаны во время операции.
    
Минимальное и максимальное значения представляют начало и конец операции в числовом формате. Используйте 1 для начального минимального значения и 1000 для начального максимального значения, передав эти значения поставщикам услуг в методах [IMAPIProgress:: GetMin](imapiprogress-getmin.md) и [IMAPIProgress:: жетмакс](imapiprogress-getmax.md) . Поставщики услуг сбрасывают эти значения при вызове метода [IMAPIProgress:: SetLimits](imapiprogress-setlimits.md). 
  
Значение Flags используется поставщиками услуг для определения того, как должны устанавливаться другие значения. Инициализируйте значение флагов для МАПИ_ТОП_ЛЕВЕЛ и возвращает это значение в реализации **флагов** , пока поставщик услуг не сбрасывает его с помощью вызова **SetLimits**. 
  
В реализации метода **SetLimits** Сохраните локальные копии каждого из параметров: _лпулмин_, _лпулмакс_и _лпулфлагс_. Эти значения должны быть доступны, если поставщик услуг вызывает методы **GetMin**, жетмакс и ****. **** 
  
Чтобы обновить отображение индикатора хода выполнения, поставщики услуг вызывают метод **IMAPIProgress::P рогресс** . Для этого метода существует три параметра: значение, число и сумма. Используйте первый параметр ( _улвалуе_), чтобы отобразить индикатор хода выполнения. Параметр _улвалуе_ — индикатор хода выполнения и будет равен глобальному _улмин_ только в самом начале операции и равен глобальному _улмакс_ только при завершении операции. 
  
Используйте второй и третий параметры, _улкаунт_ и _ултотал_, если они доступны, для отображения необязательного сообщения, например "5 элементов завершено из 10". Если для второго и третьего параметров задано значение 0, вы можете выбрать, следует ли визуально изменить индикатор хода выполнения. Некоторые поставщики услуг устанавливают для этих параметров нулевое значение, чтобы указать, что они обрабатывают подобъект, ход выполнения которого отслеживается относительно родительского объекта. В этом случае имеет смысл изменить отображение только в том случае, если родительский объект сообщает о ходе выполнения. Некоторые поставщики услуг передают нули для этих параметров каждый раз. 
  


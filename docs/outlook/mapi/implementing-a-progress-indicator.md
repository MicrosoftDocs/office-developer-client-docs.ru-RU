---
title: Реализация индикатора хода выполнения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 1a359ec413da91b3e2819978e80ea0a921f6b245
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22587126"
---
# <a name="implementing-a-progress-indicator"></a><span data-ttu-id="5e767-103">Реализация индикатора хода выполнения</span><span class="sxs-lookup"><span data-stu-id="5e767-103">Implementing a Progress Indicator</span></span>

  
  
<span data-ttu-id="5e767-104">**Применимо к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="5e767-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="5e767-105">Многие из этих операций, инициированных клиентами занять значительное время.</span><span class="sxs-lookup"><span data-stu-id="5e767-105">Many of the operations initiated by clients take a significant amount of time.</span></span> <span data-ttu-id="5e767-106">Один из входных параметров для потенциально длительных операций — это указатель на объект хода выполнения — это объект, реализующий [IMAPIProgress: IUnknown](imapiprogressiunknown.md) интерфейса.</span><span class="sxs-lookup"><span data-stu-id="5e767-106">One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the [IMAPIProgress : IUnknown](imapiprogressiunknown.md) interface.</span></span> <span data-ttu-id="5e767-107">Объекты хода выполнения контролировать внешний вид и отображение индикаторов хода выполнения и реализованы клиентам и MAPI.</span><span class="sxs-lookup"><span data-stu-id="5e767-107">Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI.</span></span> <span data-ttu-id="5e767-108">Можно ли реализовать объект хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e767-108">You can choose whether or not to implement a progress object.</span></span> <span data-ttu-id="5e767-109">Реализация интерфейса MAPI для поставщиков услуг для использования, если решено не предоставлять реализацию.</span><span class="sxs-lookup"><span data-stu-id="5e767-109">The MAPI implementation is available for service providers to use if you elect not to supply an implementation.</span></span> 
  
<span data-ttu-id="5e767-110">Объекты о ходе выполнения работы с следующие данные:</span><span class="sxs-lookup"><span data-stu-id="5e767-110">Progress objects work with the following pieces of data:</span></span>
  
- <span data-ttu-id="5e767-111">Глобальные минимальное значение, которое при вызове метода [IMAPIProgress::Progress](imapiprogress-progress.md) должно быть меньше или равно значение параметра _ulValue_ .</span><span class="sxs-lookup"><span data-stu-id="5e767-111">A global minimum value which, when your [IMAPIProgress::Progress](imapiprogress-progress.md) method is called, should be less than or equal to the value of the  _ulValue_ parameter.</span></span> <span data-ttu-id="5e767-112">В начале операции, _ulValue_ будет равен это минимальное значение.</span><span class="sxs-lookup"><span data-stu-id="5e767-112">At the beginning of the operation,  _ulValue_ will be equal to this minimum value.</span></span> 
    
- <span data-ttu-id="5e767-113">Глобальные максимальное значение, которое при вызове метода **IMAPIProgress::Progress** должно быть больше или равно параметру _ulValue_ .</span><span class="sxs-lookup"><span data-stu-id="5e767-113">A global maximum value which, when your **IMAPIProgress::Progress** method is called, should be greater than or equal to the  _ulValue_ parameter.</span></span> <span data-ttu-id="5e767-114">В конце операции _ulValue_ будет равен это максимальное значение.</span><span class="sxs-lookup"><span data-stu-id="5e767-114">At the end of the operation,  _ulValue_ will be equal to this maximum value.</span></span> 
    
- <span data-ttu-id="5e767-115">Флаги значение указывает, соответствует ли ход выполнения сверху или понизить уровень элементов.</span><span class="sxs-lookup"><span data-stu-id="5e767-115">A flags value which indicates whether the progress corresponds to a top or lower level item.</span></span>
    
- <span data-ttu-id="5e767-116">Значение, указывающее текущий уровень хода выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="5e767-116">A value that indicates the current level of progress for the operation.</span></span>
    
- <span data-ttu-id="5e767-117">Количество элементов в настоящее время обработанные относительно Общая.</span><span class="sxs-lookup"><span data-stu-id="5e767-117">The number of the currently processed items relative to the total.</span></span>
    
- <span data-ttu-id="5e767-118">Общее число элементов, обрабатываемых во время операции.</span><span class="sxs-lookup"><span data-stu-id="5e767-118">The total number of items to be processed during the operation.</span></span>
    
<span data-ttu-id="5e767-119">Минимальный и максимальный значения представляют начала и окончания операции в числовой форме.</span><span class="sxs-lookup"><span data-stu-id="5e767-119">The minimum and maximum values represent the beginning and end of the operation in numeric form.</span></span> <span data-ttu-id="5e767-120">Используйте 1 для начальной минимальное значение до 1000 начальный максимальное значение, передавая эти значения для поставщиков услуг в методах [IMAPIProgress::GetMin](imapiprogress-getmin.md) и [IMAPIProgress::GetMax](imapiprogress-getmax.md) .</span><span class="sxs-lookup"><span data-stu-id="5e767-120">Use 1 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the [IMAPIProgress::GetMin](imapiprogress-getmin.md) and [IMAPIProgress::GetMax](imapiprogress-getmax.md) methods.</span></span> <span data-ttu-id="5e767-121">Поставщики услуг сбросить эти значения, когда он совершает вызов [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span><span class="sxs-lookup"><span data-stu-id="5e767-121">Service providers reset these values when they call [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span></span> 
  
<span data-ttu-id="5e767-122">Значение флагов используется поставщиками услуг для определения, как следует устанавливать другие значения.</span><span class="sxs-lookup"><span data-stu-id="5e767-122">The flags value is used by service providers to determine how they should set the other values.</span></span> <span data-ttu-id="5e767-123">Инициализация значение флаги, MAPI_TOP_LEVEL и возвращают это значение в реализации **GetFlags** до поставщика услуг сбрасывает его путем вызова **SetLimits**.</span><span class="sxs-lookup"><span data-stu-id="5e767-123">Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of **GetFlags** until the service provider resets it by calling **SetLimits**.</span></span> 
  
<span data-ttu-id="5e767-124">В реализации метода **SetLimits** Сохранить локальные копии каждого из параметров: _lpulMin_, _lpulMax_и _lpulFlags_.</span><span class="sxs-lookup"><span data-stu-id="5e767-124">In your implementation of the **SetLimits** method, save local copies of each of the parameters:  _lpulMin_,  _lpulMax_, and  _lpulFlags_.</span></span> <span data-ttu-id="5e767-125">Эти значения должны быть легко доступны, когда поставщик службы вызывает **GetMin**, **GetMax**или **GetFlags** методов.</span><span class="sxs-lookup"><span data-stu-id="5e767-125">These values should be readily available when a service provider calls your **GetMin**, **GetMax**, or **GetFlags** methods.</span></span> 
  
<span data-ttu-id="5e767-126">Для обновления отображения индикатора, поставщиков услуг вызывать метод **IMAPIProgress::Progress** .</span><span class="sxs-lookup"><span data-stu-id="5e767-126">To update the display of the progress indicator, service providers call your **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="5e767-127">Существует три параметра для этого метода: значение, числа и всего.</span><span class="sxs-lookup"><span data-stu-id="5e767-127">There are three parameters to this method: a value, a count, and a total.</span></span> <span data-ttu-id="5e767-128">Используйте параметр первого _ulValue_, чтобы отобразить индикатор хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e767-128">Use the first parameter,  _ulValue_, to display the progress indicator.</span></span> <span data-ttu-id="5e767-129">Параметр _ulValue_ — это индикатора хода выполнения и будет равен глобального _ulMin_ только в самом начале операции и равно глобального _ulMax_ только после завершения операции.</span><span class="sxs-lookup"><span data-stu-id="5e767-129">The  _ulValue_ parameter is the progress indicator and will be equal to global  _ulMin_ only at the very beginning of the operation and equal to global  _ulMax_ only at the completion of the operation.</span></span> 
  
<span data-ttu-id="5e767-130">Используйте второй и третий параметры, _инициализирует метод ulCount_ и _ulTotal_, если он доступен для отображения сообщения необязательно, такие как «завершено из десяти 5 элементы.»</span><span class="sxs-lookup"><span data-stu-id="5e767-130">Use the second and third parameters,  _ulCount_ and  _ulTotal_, if available, to display an optional message such as "5 items completed out of 10."</span></span> <span data-ttu-id="5e767-131">Если второй и третий параметры имеют значение 0, можно ли изменяется индикатор хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e767-131">If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator.</span></span> <span data-ttu-id="5e767-132">Некоторые поставщики услуг этих параметров на нули, чтобы указать, что они обрабатываются вложенные объекты, ход выполнения отслеживается относительно родительского объекта.</span><span class="sxs-lookup"><span data-stu-id="5e767-132">Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object.</span></span> <span data-ttu-id="5e767-133">В этом случае это имеет смысл, чтобы изменить способ отображения только в том случае, если родительский объект отчетов о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="5e767-133">In this situation, it makes sense to change the display only when the parent object reports progress.</span></span> <span data-ttu-id="5e767-134">Некоторые поставщики услуг передайте нулей для этих параметров каждый раз.</span><span class="sxs-lookup"><span data-stu-id="5e767-134">Some service providers pass zeroes for these parameters every time.</span></span> 
  


---
title: Реализация индикатора хода выполнения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6972c960705c336aa6ff96d81b48ccbd490a22ee
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332853"
---
# <a name="implementing-a-progress-indicator"></a><span data-ttu-id="fe587-103">Реализация индикатора хода выполнения</span><span class="sxs-lookup"><span data-stu-id="fe587-103">Implementing a Progress Indicator</span></span>

  
  
<span data-ttu-id="fe587-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="fe587-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="fe587-105">Многие операции, инициированные клиентами, выполняются в течение длительного времени.</span><span class="sxs-lookup"><span data-stu-id="fe587-105">Many of the operations initiated by clients take a significant amount of time.</span></span> <span data-ttu-id="fe587-106">Один из входных параметров для этих потенциально длительных операций — указатель на объект Progress — объект, реализующий интерфейс [IMAPIProgress: IUnknown](imapiprogressiunknown.md) .</span><span class="sxs-lookup"><span data-stu-id="fe587-106">One of the input parameters to these potentially lengthy operations is a pointer to a progress object — an object that implements the [IMAPIProgress : IUnknown](imapiprogressiunknown.md) interface.</span></span> <span data-ttu-id="fe587-107">Объекты хода выполнения управляют внешним видом и отображением индикаторов хода выполнения и реализуются клиентами и MAPI.</span><span class="sxs-lookup"><span data-stu-id="fe587-107">Progress objects control the appearance and display of progress indicators and are implemented by clients and by MAPI.</span></span> <span data-ttu-id="fe587-108">Вы можете выбрать, следует ли реализовать объект Progress.</span><span class="sxs-lookup"><span data-stu-id="fe587-108">You can choose whether or not to implement a progress object.</span></span> <span data-ttu-id="fe587-109">Реализация MAPI доступна для использования поставщиками услуг, если вы не предоставляете реализацию.</span><span class="sxs-lookup"><span data-stu-id="fe587-109">The MAPI implementation is available for service providers to use if you elect not to supply an implementation.</span></span> 
  
<span data-ttu-id="fe587-110">Объекты хода выполнения работают со следующими фрагментами данных:</span><span class="sxs-lookup"><span data-stu-id="fe587-110">Progress objects work with the following pieces of data:</span></span>
  
- <span data-ttu-id="fe587-111">Глобальное минимальное значение, которое при вызове метода [IMAPIProgress::P рогресс](imapiprogress-progress.md) , должно быть меньше или равно значению параметра _улвалуе_ .</span><span class="sxs-lookup"><span data-stu-id="fe587-111">A global minimum value which, when your [IMAPIProgress::Progress](imapiprogress-progress.md) method is called, should be less than or equal to the value of the  _ulValue_ parameter.</span></span> <span data-ttu-id="fe587-112">В начале операции _улвалуе_ будет равно этому минимальному значению.</span><span class="sxs-lookup"><span data-stu-id="fe587-112">At the beginning of the operation,  _ulValue_ will be equal to this minimum value.</span></span> 
    
- <span data-ttu-id="fe587-113">Глобальное максимальное значение, которое при вызове метода **IMAPIProgress::P рогресс** , должно быть больше или равно параметру _улвалуе_ .</span><span class="sxs-lookup"><span data-stu-id="fe587-113">A global maximum value which, when your **IMAPIProgress::Progress** method is called, should be greater than or equal to the  _ulValue_ parameter.</span></span> <span data-ttu-id="fe587-114">В конце операции _улвалуе_ будет равно этому максимальному значению.</span><span class="sxs-lookup"><span data-stu-id="fe587-114">At the end of the operation,  _ulValue_ will be equal to this maximum value.</span></span> 
    
- <span data-ttu-id="fe587-115">Значение флага, которое указывает, соответствует ли ход выполнения указанному элементу верхнего или нижнего уровня.</span><span class="sxs-lookup"><span data-stu-id="fe587-115">A flags value which indicates whether the progress corresponds to a top or lower level item.</span></span>
    
- <span data-ttu-id="fe587-116">Значение, указывающее текущий уровень хода выполнения для операции.</span><span class="sxs-lookup"><span data-stu-id="fe587-116">A value that indicates the current level of progress for the operation.</span></span>
    
- <span data-ttu-id="fe587-117">Число обработанных в данный момент элементов, относящихся к общему количеству.</span><span class="sxs-lookup"><span data-stu-id="fe587-117">The number of the currently processed items relative to the total.</span></span>
    
- <span data-ttu-id="fe587-118">Общее количество элементов, которые должны быть обработаны во время операции.</span><span class="sxs-lookup"><span data-stu-id="fe587-118">The total number of items to be processed during the operation.</span></span>
    
<span data-ttu-id="fe587-119">Минимальное и максимальное значения представляют начало и конец операции в числовом формате.</span><span class="sxs-lookup"><span data-stu-id="fe587-119">The minimum and maximum values represent the beginning and end of the operation in numeric form.</span></span> <span data-ttu-id="fe587-120">Используйте 1 для начального минимального значения и 1000 для начального максимального значения, передав эти значения поставщикам услуг в методах [IMAPIProgress:: GetMin](imapiprogress-getmin.md) и [IMAPIProgress:: жетмакс](imapiprogress-getmax.md) .</span><span class="sxs-lookup"><span data-stu-id="fe587-120">Use 1 for the initial minimum value and 1000 for the initial maximum value, passing these values to service providers in the [IMAPIProgress::GetMin](imapiprogress-getmin.md) and [IMAPIProgress::GetMax](imapiprogress-getmax.md) methods.</span></span> <span data-ttu-id="fe587-121">Поставщики услуг сбрасывают эти значения при вызове метода [IMAPIProgress:: SetLimits](imapiprogress-setlimits.md).</span><span class="sxs-lookup"><span data-stu-id="fe587-121">Service providers reset these values when they call [IMAPIProgress::SetLimits](imapiprogress-setlimits.md).</span></span> 
  
<span data-ttu-id="fe587-122">Значение Flags используется поставщиками услуг для определения того, как должны устанавливаться другие значения.</span><span class="sxs-lookup"><span data-stu-id="fe587-122">The flags value is used by service providers to determine how they should set the other values.</span></span> <span data-ttu-id="fe587-123">Инициализируйте значение флагов для МАПИ_ТОП_ЛЕВЕЛ и возвращает это значение в реализации **флагов** , пока поставщик услуг не сбрасывает его с помощью вызова **SetLimits**.</span><span class="sxs-lookup"><span data-stu-id="fe587-123">Initialize the flags value to MAPI_TOP_LEVEL and return this value in your implementation of **GetFlags** until the service provider resets it by calling **SetLimits**.</span></span> 
  
<span data-ttu-id="fe587-124">В реализации метода **SetLimits** Сохраните локальные копии каждого из параметров: _лпулмин_, _лпулмакс_и _лпулфлагс_.</span><span class="sxs-lookup"><span data-stu-id="fe587-124">In your implementation of the **SetLimits** method, save local copies of each of the parameters:  _lpulMin_,  _lpulMax_, and  _lpulFlags_.</span></span> <span data-ttu-id="fe587-125">Эти значения должны быть доступны, если поставщик услуг вызывает методы **GetMin**, жетмакс и \*\*\*\*. \*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="fe587-125">These values should be readily available when a service provider calls your **GetMin**, **GetMax**, or **GetFlags** methods.</span></span> 
  
<span data-ttu-id="fe587-126">Чтобы обновить отображение индикатора хода выполнения, поставщики услуг вызывают метод **IMAPIProgress::P рогресс** .</span><span class="sxs-lookup"><span data-stu-id="fe587-126">To update the display of the progress indicator, service providers call your **IMAPIProgress::Progress** method.</span></span> <span data-ttu-id="fe587-127">Для этого метода существует три параметра: значение, число и сумма.</span><span class="sxs-lookup"><span data-stu-id="fe587-127">There are three parameters to this method: a value, a count, and a total.</span></span> <span data-ttu-id="fe587-128">Используйте первый параметр ( _улвалуе_), чтобы отобразить индикатор хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="fe587-128">Use the first parameter,  _ulValue_, to display the progress indicator.</span></span> <span data-ttu-id="fe587-129">Параметр _улвалуе_ — индикатор хода выполнения и будет равен глобальному _улмин_ только в самом начале операции и равен глобальному _улмакс_ только при завершении операции.</span><span class="sxs-lookup"><span data-stu-id="fe587-129">The  _ulValue_ parameter is the progress indicator and will be equal to global  _ulMin_ only at the very beginning of the operation and equal to global  _ulMax_ only at the completion of the operation.</span></span> 
  
<span data-ttu-id="fe587-130">Используйте второй и третий параметры, _улкаунт_ и _ултотал_, если они доступны, для отображения необязательного сообщения, например "5 элементов завершено из 10".</span><span class="sxs-lookup"><span data-stu-id="fe587-130">Use the second and third parameters,  _ulCount_ and  _ulTotal_, if available, to display an optional message such as "5 items completed out of 10."</span></span> <span data-ttu-id="fe587-131">Если для второго и третьего параметров задано значение 0, вы можете выбрать, следует ли визуально изменить индикатор хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="fe587-131">If the second and third parameters are set to 0, you can choose whether or not to visually change the progress indicator.</span></span> <span data-ttu-id="fe587-132">Некоторые поставщики услуг устанавливают для этих параметров нулевое значение, чтобы указать, что они обрабатывают подобъект, ход выполнения которого отслеживается относительно родительского объекта.</span><span class="sxs-lookup"><span data-stu-id="fe587-132">Some service providers set these parameters to zeroes to indicate that they are processing a subobject whose progress is monitored relative to a parent object.</span></span> <span data-ttu-id="fe587-133">В этом случае имеет смысл изменить отображение только в том случае, если родительский объект сообщает о ходе выполнения.</span><span class="sxs-lookup"><span data-stu-id="fe587-133">In this situation, it makes sense to change the display only when the parent object reports progress.</span></span> <span data-ttu-id="fe587-134">Некоторые поставщики услуг передают нули для этих параметров каждый раз.</span><span class="sxs-lookup"><span data-stu-id="fe587-134">Some service providers pass zeroes for these parameters every time.</span></span> 
  


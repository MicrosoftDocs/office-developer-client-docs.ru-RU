---
title: Реализация индикатора хода выполнения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 767b8723d9a544a31ee5c4bbc1d6186a15387b44
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809292"
---
# <a name="implementing-a-progress-indicator"></a>Реализация индикатора хода выполнения

  
  
**Относится к**: Outlook 
  
Многие из этих операций, инициированных клиентами занять значительное время. Один из входных параметров для потенциально длительных операций — это указатель на объект хода выполнения — это объект, реализующий [IMAPIProgress: IUnknown](imapiprogressiunknown.md) интерфейса. Объекты хода выполнения контролировать внешний вид и отображение индикаторов хода выполнения и реализованы клиентам и MAPI. Можно ли реализовать объект хода выполнения. Реализация интерфейса MAPI для поставщиков услуг для использования, если решено не предоставлять реализацию. 
  
Объекты о ходе выполнения работы с следующие данные:
  
- Глобальные минимальное значение, которое при вызове метода [IMAPIProgress::Progress](imapiprogress-progress.md) должно быть меньше или равно значение параметра _ulValue_ . В начале операции, _ulValue_ будет равен это минимальное значение. 
    
- Глобальные максимальное значение, которое при вызове метода **IMAPIProgress::Progress** должно быть больше или равно параметру _ulValue_ . В конце операции _ulValue_ будет равен это максимальное значение. 
    
- Флаги значение указывает, соответствует ли ход выполнения сверху или понизить уровень элементов.
    
- Значение, указывающее текущий уровень хода выполнения операции.
    
- Количество элементов в настоящее время обработанные относительно Общая.
    
- Общее число элементов, обрабатываемых во время операции.
    
Минимальный и максимальный значения представляют начала и окончания операции в числовой форме. Используйте 1 для начальной минимальное значение до 1000 начальный максимальное значение, передавая эти значения для поставщиков услуг в методах [IMAPIProgress::GetMin](imapiprogress-getmin.md) и [IMAPIProgress::GetMax](imapiprogress-getmax.md) . Поставщики услуг сбросить эти значения, когда он совершает вызов [IMAPIProgress::SetLimits](imapiprogress-setlimits.md). 
  
Значение флагов используется поставщиками услуг для определения, как следует устанавливать другие значения. Инициализация значение флаги, MAPI_TOP_LEVEL и возвращают это значение в реализации **GetFlags** до поставщика услуг сбрасывает его путем вызова **SetLimits**. 
  
В реализации метода **SetLimits** Сохранить локальные копии каждого из параметров: _lpulMin_, _lpulMax_и _lpulFlags_. Эти значения должны быть легко доступны, когда поставщик службы вызывает **GetMin**, **GetMax**или **GetFlags** методов. 
  
Для обновления отображения индикатора, поставщиков услуг вызывать метод **IMAPIProgress::Progress** . Существует три параметра для этого метода: значение, числа и всего. Используйте параметр первого _ulValue_, чтобы отобразить индикатор хода выполнения. Параметр _ulValue_ — это индикатора хода выполнения и будет равен глобального _ulMin_ только в самом начале операции и равно глобального _ulMax_ только после завершения операции. 
  
Используйте второй и третий параметры, _инициализирует метод ulCount_ и _ulTotal_, если он доступен для отображения сообщения необязательно, такие как «завершено из десяти 5 элементы.» Если второй и третий параметры имеют значение 0, можно ли изменяется индикатор хода выполнения. Некоторые поставщики услуг этих параметров на нули, чтобы указать, что они обрабатываются вложенные объекты, ход выполнения отслеживается относительно родительского объекта. В этом случае это имеет смысл, чтобы изменить способ отображения только в том случае, если родительский объект отчетов о ходе выполнения. Некоторые поставщики услуг передайте нулей для этих параметров каждый раз. 
  


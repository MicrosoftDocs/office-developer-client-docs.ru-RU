---
title: Реализация индикатора прогресса
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3a062a88-e87e-4c0c-944e-544a8f080930
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6972c960705c336aa6ff96d81b48ccbd490a22ee
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435098"
---
# <a name="implementing-a-progress-indicator"></a>Реализация индикатора прогресса

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Многие операции, инициированные клиентами, отбирают значительное количество времени. Одним из параметров ввода для этих потенциально длительных операций является указатель на объект прогресса — объект, который реализует [интерфейс IMAPIProgress: IUnknown.](imapiprogressiunknown.md) Объекты progress контролируют внешний вид и отображение индикаторов прогресса и реализуются клиентами и MAPI. Вы можете выбрать, следует ли реализовать объект progress. Реализация MAPI доступна для поставщиков услуг, которые можно использовать, если вы не хотите поставлять реализацию. 
  
Объекты progress работают со следующими частями данных:
  
- Глобальное минимальное значение, которое, когда называется метод [IMAPIProgress::P,](imapiprogress-progress.md) должно быть меньше или равно значению _параметра ulValue._ В начале операции  _значение ulValue_ будет равно этому минимальному значению. 
    
- Глобальное максимальное значение, которое, когда называется метод **IMAPIProgress::P rogress,** должно быть больше или равно параметру _ulValue._ По окончании операции  _значение ulValue_ будет равно этому максимальному значению. 
    
- Значение флагов, которое указывает, соответствует ли прогресс элементу верхнего или нижнего уровня.
    
- Значение, которое указывает текущий уровень выполнения операции.
    
- Количество обрабатываемых в настоящее время элементов относительно общего числа.
    
- Общее количество элементов, обрабатываемых во время операции.
    
Минимальные и максимальные значения представляют начало и конец операции в числовом виде. Используйте 1 для начального минимального значения и 1000 для начального максимального значения, передав эти значения поставщикам услуг в методах [IMAPIProgress::GetMin](imapiprogress-getmin.md) и [IMAPIProgress::GetMax.](imapiprogress-getmax.md) Поставщики услуг сбрасывают эти значения при вызове [IMAPIProgress::SetLimits.](imapiprogress-setlimits.md) 
  
Значение флагов используется поставщиками служб для определения того, как они должны устанавливать другие значения. Инициализировать значение флагов для MAPI_TOP_LEVEL и вернуть это значение в реализации **GetFlags,** пока поставщик службы не сбросит его, позвонив **в SetLimits.** 
  
В реализации метода **SetLimits** сохраните локальные копии каждого из _параметров: lpulMin,_ _lpulMax_ и _lpulFlags._ Эти значения должны быть легко доступны, если поставщик услуг вызывает методы **GetMin,** **GetMax** или **GetFlags.** 
  
Чтобы обновить отображение индикатора прогресса, поставщики услуг называют метод **IMAPIProgress::P gress.** Для этого метода существует три параметра: значение, количество и общее значение. Для отображения индикатора прогресса используйте первый параметр _ulValue._ Параметр  _ulValue_ является индикатором прогресса и будет равен глобальному  _ulMin_ только в самом начале операции и равен глобальному  _ulMax_ только по завершении операции. 
  
Используйте второй и третий  _параметры, ulCount_ и  _ulTotal,_ если они доступны, для отображения необязательных сообщений, таких как "5 элементов, завершенных из 10". Если для второго и третьего параметров установлено 0, можно выбрать, следует ли визуально изменять индикатор прогресса. Некоторые поставщики услуг устанавливают эти параметры до нуля, чтобы указать, что они обрабатывают подобект, ход которого отслеживается по отношению к родительскому объекту. В этой ситуации имеет смысл изменять дисплей только после того, как родительский объект сообщает о прогрессе. Некоторые поставщики услуг каждый раз передают нули для этих параметров. 
  


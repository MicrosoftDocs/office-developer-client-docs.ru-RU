---
title: Обработка ошибок в MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 99e2c485-af84-46f4-84b4-fca2117b5a21
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 98ee0856411cce3a3e9012185be6c30503de7779
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32287284"
---
# <a name="error-handling-in-mapi"></a>Обработка ошибок в MAPI

**Область применения**: Outlook 2013 | Outlook 2016 
  
Значения успешности, предупреждения и ошибок возвращаются с помощью 32-битного номера, известного как обработка результатов, или HRESULT. HRESULT на самом деле не является ручкой для чего-либо; это всего лишь 32-битное значение с несколькими полями, закодированные в значении. Нулевой результат указывает на успех, а незерный результат указывает на сбой.
  
MAPI на 32-битных платформах работает исключительно со значениями HRESULT.
  
На следующем рисунке показан формат HRESULT для 32-битных платформ.
  
**Формат HRESULT**
  
![ФОРМАТ HRESULT формат](media/amapi_49.gif "HRESULT")
  
Бит высокого порядка в HRESULT указывает, является ли возвращаемая величина успешной или неудачной. Если значение установлено до нуля, значение указывает на успех. Если установлено 1, это указывает на сбой.
  
Биты R, C, N и r зарезервированы в HRESULT.
  
Поле объекта в обеих версиях указывает область ответственности за ошибку. Существует несколько объектов, но подавляющее большинство ошибок MAPI FACILITY_ITF для представления ошибок интерфейса. Наиболее распространенными средствами, используемыми в настоящее время, являются: FACILITY_NULL, FACILITY_ITF, FACILITY_DISPATCH, FACILITY_RPC и FACILITY_STORAGE. Если необходимы новые возможности, Корпорация Майкрософт выделяет их, так как они должны быть уникальными. В следующей таблице описываются различные поля объекта.
  
|Facility|Описание|
|:-----|:-----|
|FACILITY_NULL  <br/> |Для широко применимых общих кодов состояния, таких как S_OK или E_OUTOF_MEMORY; значение нулевое.  <br/> |
|FACILITY_ITF  <br/> |Для большинства кодов состояния, возвращаемого из методов интерфейса; значение определяется интерфейсом. То есть два значения HRESULT с одинаковым 32-битным значением, возвращаемого из двух различных интерфейсов, могут иметь разные значения.  <br/> |
|FACILITY_DISPATCH  <br/> |Для поздних [ошибок интерфейса IDispatch.](https://msdn.microsoft.com/library/ms221608.aspx)  <br/> |
|FACILITY_RPC  <br/> |Для кодов состояния, возвращаемого из удаленных вызовов процедуры.  <br/> |
|FACILITY_STORAGE  <br/> |Для кодов состояния, возвращающихся из [вызовов методов IStorage](https://msdn.microsoft.com/library/aa380015%28VS.85%29.aspx) или [IStream,](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) связанных со структурированным хранилищем. Коды состояния со значениями кода (менее 16 бит) в диапазоне Windows кодов ошибок (то есть менее 256) имеют то же значение, что и соответствующие Windows ошибки.  <br/> |
   
Поле кода — это уникальный номер, который назначен для представления ошибки или предупреждения.
  


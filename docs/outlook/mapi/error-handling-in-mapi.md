---
title: Обработка ошибок в MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 99e2c485-af84-46f4-84b4-fca2117b5a21
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 98ee0856411cce3a3e9012185be6c30503de7779
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32287284"
---
# <a name="error-handling-in-mapi"></a>Обработка ошибок в MAPI

**Область применения**: Outlook 2013 | Outlook 2016 
  
Значения "успех", "предупреждение" и "ошибка" возвращаются с помощью 32 бит, который называется дескриптором результатов, или HRESULT. ЗНАЧЕНИЕ HRESULT фактически не является дескриптором для какого-либо объекта; Это просто 32-разрядное значение с несколькими полями, закодированными в значении. Нулевой результат указывает на успешность выполнения, а ненулевое значение указывает на ошибку.
  
MAPI на 32 разрядных платформах работает исключительно со значениями HRESULT.
  
На следующем рисунке показан формат HRESULT для 32 разрядных платформ.
  
**Формат HRESULT**
  
![Формат HRESULT] (media/amapi_49.gif "Формат HRESULT")
  
Бит высокого порядка в значении HRESULT указывает, представляет ли возвращаемое значение успешное или неудачное. Если задано значение 0, значение указывает на успешное выполнение. Если задано значение 1, это указывает на ошибку.
  
Биты R, C, N и r зарезервированы в значении HRESULT.
  
Поле "оборудование" в обеих версиях указывает область ответственности для ошибки. Существует несколько возможностей, но подавляющее большинство ошибок MAPI используют ФАЦИЛИТИ_ИТФ для представления ошибок в интерфейсе. Наиболее распространенными используемыми в настоящее время функциями являются: ФАЦИЛИТИ_НУЛЛ, ФАЦИЛИТИ_ИТФ, ФАЦИЛИТИ_ДИСПАТЧ, ФАЦИЛИТИ_РПК и ФАЦИЛИТИ_СТОРАЖЕ. При необходимости в новых средствах Майкрософт выделяет их, так как они должны быть уникальными. В следующей таблице описываются различные поля средств.
  
|Facility|Описание|
|:-----|:-----|
|ФАЦИЛИТИ_НУЛЛ  <br/> |Для широко применяемых стандартных кодов состояния, таких как S_OK или Е_АУТОФ_МЕМОРИ; значение равно нулю.  <br/> |
|ФАЦИЛИТИ_ИТФ  <br/> |Для большинства кодов состояния, возвращаемых методами интерфейса; значение определяется интерфейсом. То есть два значения HRESULT с точно одинаковым 32-битным значением, возвращенные из двух разных интерфейсов, могут иметь разные значения.  <br/> |
|ФАЦИЛИТИ_ДИСПАТЧ  <br/> |Для позднего связывания ошибок интерфейса [IDispatch](https://msdn.microsoft.com/library/ms221608.aspx) .  <br/> |
|ФАЦИЛИТИ_РПК  <br/> |Для кодов состояния, возвращаемых из удаленных вызовов процедур.  <br/> |
|ФАЦИЛИТИ_СТОРАЖЕ  <br/> |Для кодов состояния, возвращаемых из вызовов метода [IStorage](https://msdn.microsoft.com/library/aa380015%28VS.85%29.aspx) или [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) , относящихся к структурированному хранилищу. Коды состояния с кодом (младшие 16 бит) в диапазоне кодов ошибок Windows (то есть меньше 256) имеют то же значение, что и соответствующие ошибки Windows.  <br/> |
   
Поле Code — это уникальный номер, который назначается для представления ошибки или предупреждения.
  


---
title: MAPI Form Servers
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419109"
---
# <a name="mapi-form-servers"></a>MAPI Form Servers

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
С точки зрения пользователя форма обычно является листом свойств сообщения или формой ввода данных, которая позволяет пользователям вводить структурированную информацию. Однако это может быть любой пользовательский интерфейс, связанный с классом сообщения. С точки зрения программиста форма состоит из:
  
- Тип сообщения MAPI с собственным классом сообщения и идентификатором OLE.
    
- Исполняемый файл, реализуемый сервером форм.
    
- Коллекция свойств MAPI (настраиваемые или иные), которые использует сервер форм. Некоторые или все из них могут быть доступны клиентам обмена сообщениями для использования.
    
- Файл конфигурации, который описывает форму и используется диспетчером форм.
    
Поскольку формы являются [объектами IMessage,](imessageimapiprop.md) они демонстрируют свойства и поведение, которые согласуются с объектами сообщений MAPI. Однако поскольку формы могут иметь настраиваемые свойства, элементы управления и отрисовку отображения, относящуюся к приложению, интерфейсы MAPI, которые используют формы, являются достаточно универсальными, чтобы разрешить любой необходимый интерфейс. Фактическое определение формы хранится в библиотеке форм, которая обсуждается далее в этом разделе. 
  
> [!NOTE]
> Более точно, все сообщения являются экземплярами форм MAPI. Однако настраиваемые формы обычно проще придумать как особые случаи сообщений, так как формы для составления и чтения обычных сообщений электронной почты являются наиболее часто используемыми формами. Тот факт, что все сообщения на самом деле являются только формами, дает настраиваемые формы такое же состояние, как и любое другое сообщение в системе MAPI. 
  
Каждая форма имеет набор свойств, некоторые из которых видны в пользовательском интерфейсе формы. Обычно свойства совпадают с полями в пользовательском интерфейсе формы. Например, форма заказа на покупку может иметь поля Item, Description, Price, Tax и Subtotal. Эти поля — это просто визуальные отрисовки свойств формы с одинаковыми именами. Клиенты могут определить, какие свойства поддерживаются определенным классом сообщений, с помощью метода [IMAPIFormInfo::CalcFormPropSet,](imapiforminfo-calcformpropset.md) который реализуется диспетчером форм MAPI. 
  
Как и базовые сообщения, формы MAPI могут содержать все стандартные свойства сообщения, такие как отправитель, получатель и время отправки сообщения. Формы также могут содержать любое количество настраиваемого свойства, характерного для формы. Например, форма "Отчет об ошибках" может содержать настраиваемые свойства для типа ошибки, серьезности ошибки и версии продукта.
  
Для создания формы необходимо реализовать сервер форм. Сервер форм — это исполняемый файл, который загружается, когда клиенту обмена сообщениями необходимо отобразить сообщение, тип, поддерживаемый сервером форм. Сервер форм, в свою очередь, создает объекты форм, необходимые для отображения определенных сообщений и обработки взаимодействия пользователя с этими сообщениями.
  
С каждым сервером форм связан файл конфигурации. Этот файл содержит сведения, описывая сервер форм в пользу диспетчера форм. Диспетчер форм использует эти сведения при установке сервера форм в библиотеку форм.
  
Дополнительные сведения о создании частей формы см. в [поддоме "Разработка серверов форм MAPI".](developing-mapi-form-servers.md)
  
Серверы форм придерживаются модели COM. Серверы форм выполняются как автономные исполняемые, а не как серверы в прокси-сервере. Дополнительные сведения см. в разделе com и ActiveX Object Services в Windows SDK.
  
Уникальный идентификатор класса (CLSID) определяет каждый сервер форм. Между идентификатором класса и его классом сообщений всегда существует сопоставление "один к одному". Однако это не означает, что сервер форм может работать только с сообщениями одного класса сообщений. Если сервер форм не доступен для обслуживания сообщения определенного класса, используемый диспетчер форм должен попытаться найти сервер форм для класса сообщений выше в иерархии класса сообщений; Это делает диспетчер форм по умолчанию, поставляный с Windows SDK. Такой сервер форм, вероятно, сможет отрисовывать только подмножество свойств сообщения (тех, которые поддерживаются суперклассом), но он будет лучше, чем ничего. Что происходит, когда не найден ни один совпадающий сервер форм, — это подробности реализации, спецификие для используемой диспетчера форм; В этом случае диспетчер форм по умолчанию не открывает сообщения.
  
Дополнительные сведения см. в сведениях о [классах сообщений MAPI.](mapi-message-classes.md)
  
## <a name="see-also"></a>См. также



[Формы MAPI](mapi-forms.md)


---
title: Серверы форм MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419109"
---
# <a name="mapi-form-servers"></a>Серверы форм MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
С точки зрения пользователя форма обычно является листом свойств для сообщения или формы ввода данных, позволяющей пользователям вводить структурированную информацию. Тем не менее, это может быть любой пользовательский интерфейс, связанный с классом сообщений. С точки зрения программиста, форма состоит из следующих элементов:
  
- Тип сообщения MAPI с собственным классом сообщений и идентификатором OLE.
    
- Исполняемый файл, который реализует сервер форм.
    
- Коллекция свойств MAPI — настраиваемая или иным способом, которая используется сервером формы. Некоторые или все из них могут быть доступны для использования клиентами системы обмена сообщениями.
    
- Файл конфигурации, который описывает форму и используется диспетчером форм.
    
Так как формы являются объектами [iMessage](imessageimapiprop.md) , они демонстрируют свойства и поведение, согласованные с объектами сообщений MAPI. Однако в связи с тем, что у форм могут быть настраиваемые свойства, элементы управления и визуализация отображения, зависящая от конкретного приложения, интерфейсы MAPI, используемые формами, достаточно универсального, чтобы разрешить любой необходимый интерфейс. Фактическое определение формы хранится в библиотеке форм, которая обсуждается далее в этом разделе. 
  
> [!NOTE]
> Точнее, все сообщения являются экземплярами форм MAPI. Тем не менее, как правило, пользовательские формы можно рассматривать как особые случаи для сообщений, так как формы для создания и чтения типичных сообщений электронной почты являются наиболее часто используемыми формами. Тот факт, что все сообщения на самом деле являются простыми формами, дает им такое же состояние, что и любое другое сообщение в системе MAPI. 
  
Каждая форма имеет набор свойств, некоторые из которых отображаются в пользовательском интерфейсе формы. Как правило, свойства согласуются с полями в пользовательском интерфейсе формы. Например, форма заказа на покупку может иметь поля элемент, описание, Цена, налог и промежуточный итог. Эти поля представляют собой визуальную визуализацию свойств форм с одинаковыми именами. Клиенты определяют, какие свойства поддерживаются определенным классом сообщения с помощью метода [имапиформинфо:: калкформпропсет](imapiforminfo-calcformpropset.md) , реализованного диспетчером форм MAPI. 
  
Как и в случае с основными сообщениями, формы MAPI могут содержать все стандартные свойства сообщений, такие как отправитель, предполагаемый получатель и время отправки сообщения. Формы также могут содержать любое количество настраиваемых свойств, характерных для формы. Например, форма "отчет об ошибках" может содержать настраиваемые свойства для типа ошибки, серьезности ошибки и версии продукта.
  
Чтобы создать форму, необходимо реализовать сервер форм. Сервер формы — это исполняемый файл, который загружается, когда клиент обмена сообщениями должен отобразить сообщение, которое является типом, поддерживаемым сервером форм. Сервер форм, в свою очередь, создает объекты формы по мере необходимости для отображения определенных сообщений и обработки взаимодействия пользователей с этими сообщениями.
  
С каждым сервером форм связан файл конфигурации. Этот файл содержит сведения, описывающие сервер форм для преимуществ диспетчера форм. Диспетчер форм использует эти сведения при установке сервера форм в библиотеку форм.
  
Сведения о создании частей формы можно найти в статье [Разработка серверов форм MAPI](developing-mapi-form-servers.md).
  
Серверы форм придерживаются к модели компонентных объектов (COM). Серверы форм работают как автономные исполняемые файлы, а не как внутренние серверы. Дополнительные сведения см. в разделе службы объектов COM и ActiveX в пакете Windows SDK.
  
Уникальный идентификатор класса (CLSID) определяет каждый сервер форм. Существует однозначное сопоставление между идентификатором класса и его классом Message. Однако это не означает, что сервер форм может работать только с сообщениями одного класса сообщений. Если сервер форм недоступен для обслуживания сообщения определенного класса, используемый диспетчер форм должен попытаться найти сервер формы для класса сообщений, находящихся выше в иерархии классов сообщений; Это выполняется с помощью диспетчера форм по умолчанию, предоставляемого с помощью пакета SDK Windows. Такой сервер форм, скорее всего, сможет отображать только подмножество свойств сообщения (тех, которые поддерживаются суперклассом), но это будет лучше, чем Nothing. Что происходит, если подходящий сервер форм не найден вообще — это сведения о реализации, характерные для используемого диспетчера форм; когда это происходит, Диспетчер форм по умолчанию не открывает сообщения.
  
Дополнительные сведения см. [](mapi-message-classes.md)
  
## <a name="see-also"></a>См. также



[Формы MAPI](mapi-forms.md)


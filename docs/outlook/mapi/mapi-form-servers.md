---
title: Серверы форм MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419109"
---
# <a name="mapi-form-servers"></a>Серверы форм MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
С точки зрения пользователя форма обычно является листом свойств сообщения или формой ввода данных, которая позволяет пользователям вводить структурированные сведения. Однако это может быть любой пользовательский интерфейс, связанный с классом сообщений. С точки зрения программиста форма состоит из:
  
- Тип сообщения MAPI с собственным классом сообщений и идентификатором OLE.
    
- Исполняемый файл, реализуемый на сервере форм.
    
- Коллекция свойств MAPI — настраиваемая или иная — которая используется сервером форм. Некоторые из них или все они могут быть доступны клиентам для обмена сообщениями для использования.
    
- Файл конфигурации, описывая форму и используемый менеджером форм.
    
Поскольку формы являются [объектами IMessage,](imessageimapiprop.md) они демонстрируют свойства и поведение, соответствующие объектам сообщений MAPI. Однако, так как формы могут иметь настраиваемые свойства, элементы управления и отрисовку отображения, которая является конкретной для приложений, интерфейсы MAPI, которые используют формы, являются достаточно универсальными, чтобы разрешить любой необходимый интерфейс. Фактическое определение формы хранится в библиотеке форм, которая обсуждается позже в этом разделе. 
  
> [!NOTE]
> Точнее, все сообщения являются экземплярами форм MAPI. Однако, как правило, проще думать о настраиваемой форме как о специальных случаях сообщений, так как наиболее часто используемыми формами являются формы для составления и чтения типичных сообщений электронной почты. Тот факт, что все сообщения на самом деле являются просто формами, дает настраиваемые формы тот же статус, что и любое другое сообщение в системе MAPI. 
  
Каждая форма имеет набор свойств, некоторые из которых видны в пользовательском интерфейсе формы. Как правило, свойства совпадают с полями пользовательского интерфейса формы. Например, в форме заказа на покупку могут быть поля Item, Description, Price, Tax и Subtotal. Эти поля — это просто визуальные отрисовки свойств форм с одинаковыми именами. Клиенты выясняют, какие свойства поддерживаются определенным классом сообщений с помощью метода [IMAPIFormInfo::CalcFormPropSet,](imapiforminfo-calcformpropset.md) реализуемого менеджером форм MAPI. 
  
Как и основные сообщения, формы MAPI могут содержать все стандартные свойства сообщений, такие как отправитель, предполагаемый получатель и когда сообщение было отправлено. Формы также могут содержать любое количество настраиваемого свойства, определенного форме. Например, форма "Отчет об ошибках" может содержать настраиваемые свойства для типа ошибки, серьезности ошибки и версии продукта.
  
Чтобы создать форму, необходимо реализовать сервер форм. Сервер форм — это исполняемый файл, загружаемый, когда клиенту обмена сообщениями необходимо отобразить сообщение типа, поддерживаемого сервером форм. Сервер форм, в свою очередь, создает объекты формы, необходимые для отображения определенных сообщений и обработки взаимодействий пользователей с этими сообщениями.
  
Каждый сервер форм имеет связанный с ним файл конфигурации. Этот файл содержит сведения, описывая сервер форм в интересах руководителя форм. Администратор формы использует эти сведения при установке сервера форм в библиотеку форм.
  
Дополнительные сведения о создании частей формы см. в материале [Developing MAPI Form Servers.](developing-mapi-form-servers.md)
  
Серверы форм придерживаются компонентной объектной модели (COM). Серверы форм выполняются как автономные исполняемые, а не как серверы в прок. Дополнительные сведения см. в разделе COM и ActiveX object Services в Windows SDK.
  
Уникальный идентификатор класса (CLSID) определяет каждый сервер форм. Между идентификатором класса и классом сообщений всегда существует сопоставление один к одному. Однако это не означает, что сервер форм может работать только с сообщениями одного класса сообщений. Если сервер формы не доступен для обслуживания сообщения определенного класса, используемый менеджер форм должен попытаться найти сервер формы для класса сообщений выше в иерархии классов сообщений; это делает диспетчер форм по умолчанию, Windows SDK. Такой сервер форм, вероятно, сможет отрисовывать только подмножество свойств сообщения (поддерживаемых суперклассом), но это будет лучше, чем ничего. Что происходит, если не обнаружено ни один совпадающий сервер форм, это деталь реализации, специфическая для используемой диспетчера форм; менеджер форм по умолчанию не открывает сообщения, когда это произойдет.
  
Дополнительные сведения см. в [нескольких классах сообщений MAPI.](mapi-message-classes.md)
  
## <a name="see-also"></a>См. также



[Формы MAPI](mapi-forms.md)


---
title: Серверы форм MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 855292b8-028e-4c1e-87ed-3f20b9ba584a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3c95f6a1d4d50dd6552c6e786d17c40da14f3f3c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419109"
---
# <a name="mapi-form-servers"></a><span data-ttu-id="b1f5c-103">Серверы форм MAPI</span><span class="sxs-lookup"><span data-stu-id="b1f5c-103">MAPI Form Servers</span></span>

  
  
<span data-ttu-id="b1f5c-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="b1f5c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="b1f5c-105">С точки зрения пользователя форма обычно является листом свойств сообщения или формой ввода данных, которая позволяет пользователям вводить структурированные сведения.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-105">From the user's perspective, a form is usually a property sheet for a message or a data-entry form that enables users to enter structured information.</span></span> <span data-ttu-id="b1f5c-106">Однако это может быть любой пользовательский интерфейс, связанный с классом сообщений.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-106">However, it can be any user interface that is associated with a message class.</span></span> <span data-ttu-id="b1f5c-107">С точки зрения программиста форма состоит из:</span><span class="sxs-lookup"><span data-stu-id="b1f5c-107">From a programmer's point of view, a form consists of:</span></span>
  
- <span data-ttu-id="b1f5c-108">Тип сообщения MAPI с собственным классом сообщений и идентификатором OLE.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-108">A type of MAPI message with its own message class and OLE identifier.</span></span>
    
- <span data-ttu-id="b1f5c-109">Исполняемый файл, реализуемый на сервере форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-109">The executable file that implements the form server.</span></span>
    
- <span data-ttu-id="b1f5c-110">Коллекция свойств MAPI — настраиваемая или иная — которая используется сервером форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-110">A collection of MAPI properties — custom or otherwise — that the form server uses.</span></span> <span data-ttu-id="b1f5c-111">Некоторые из них или все они могут быть доступны клиентам для обмена сообщениями для использования.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-111">Some or all of these may be available to messaging clients for use.</span></span>
    
- <span data-ttu-id="b1f5c-112">Файл конфигурации, описывая форму и используемый менеджером форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-112">The configuration file that describes the form and is used by the form manager.</span></span>
    
<span data-ttu-id="b1f5c-113">Поскольку формы являются [объектами IMessage,](imessageimapiprop.md) они демонстрируют свойства и поведение, соответствующие объектам сообщений MAPI.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-113">Because forms are [IMessage](imessageimapiprop.md) objects, they exhibit properties and behavior that is consistent with MAPI message objects.</span></span> <span data-ttu-id="b1f5c-114">Однако, так как формы могут иметь настраиваемые свойства, элементы управления и отрисовку отображения, которая является конкретной для приложений, интерфейсы MAPI, которые используют формы, являются достаточно универсальными, чтобы разрешить любой необходимый интерфейс.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-114">However, because forms can have custom properties, controls, and a display rendering that is application-specific, the MAPI interfaces that forms use are generic enough to permit any sort of interface that is needed.</span></span> <span data-ttu-id="b1f5c-115">Фактическое определение формы хранится в библиотеке форм, которая обсуждается позже в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-115">The actual definition of a form is stored in a form library, which is discussed later in this section.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b1f5c-116">Точнее, все сообщения являются экземплярами форм MAPI.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-116">More accurately, all messages are instances of MAPI forms.</span></span> <span data-ttu-id="b1f5c-117">Однако, как правило, проще думать о настраиваемой форме как о специальных случаях сообщений, так как наиболее часто используемыми формами являются формы для составления и чтения типичных сообщений электронной почты.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-117">However, it is usually easier to think of custom forms as special cases of messages, since forms for composing and reading typical email messages are the most commonly used forms.</span></span> <span data-ttu-id="b1f5c-118">Тот факт, что все сообщения на самом деле являются просто формами, дает настраиваемые формы тот же статус, что и любое другое сообщение в системе MAPI.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-118">The fact that all messages are really just forms gives custom forms the same status as any other message in the MAPI system.</span></span> 
  
<span data-ttu-id="b1f5c-119">Каждая форма имеет набор свойств, некоторые из которых видны в пользовательском интерфейсе формы.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-119">Every form has a set of properties, some of which are visible in the form's user interface.</span></span> <span data-ttu-id="b1f5c-120">Как правило, свойства совпадают с полями пользовательского интерфейса формы.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-120">Usually, properties are matched to fields in the form's user interface.</span></span> <span data-ttu-id="b1f5c-121">Например, в форме заказа на покупку могут быть поля Item, Description, Price, Tax и Subtotal.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-121">For example, a purchase order form might have the fields Item, Description, Price, Tax, and Subtotal.</span></span> <span data-ttu-id="b1f5c-122">Эти поля — это просто визуальные отрисовки свойств форм с одинаковыми именами.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-122">These fields are simply visual renderings of form properties of the same names.</span></span> <span data-ttu-id="b1f5c-123">Клиенты выясняют, какие свойства поддерживаются определенным классом сообщений с помощью метода [IMAPIFormInfo::CalcFormPropSet,](imapiforminfo-calcformpropset.md) реализуемого менеджером форм MAPI.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-123">Clients ascertain which properties are supported by a particular message class through the [IMAPIFormInfo::CalcFormPropSet](imapiforminfo-calcformpropset.md) method, which is implemented by the MAPI form manager.</span></span> 
  
<span data-ttu-id="b1f5c-124">Как и основные сообщения, формы MAPI могут содержать все стандартные свойства сообщений, такие как отправитель, предполагаемый получатель и когда сообщение было отправлено.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-124">Like basic messages, MAPI forms can contain all the standard message properties such as the sender, the intended recipient, and when the message was sent.</span></span> <span data-ttu-id="b1f5c-125">Формы также могут содержать любое количество настраиваемого свойства, определенного форме.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-125">Forms can also contain any number of custom properties that are specific to the form.</span></span> <span data-ttu-id="b1f5c-126">Например, форма "Отчет об ошибках" может содержать настраиваемые свойства для типа ошибки, серьезности ошибки и версии продукта.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-126">For example a "Bug Report" form might contain custom properties for Bug Type, Bug Severity, and Product Version.</span></span>
  
<span data-ttu-id="b1f5c-127">Чтобы создать форму, необходимо реализовать сервер форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-127">To create a form you must implement a form server.</span></span> <span data-ttu-id="b1f5c-128">Сервер форм — это исполняемый файл, загружаемый, когда клиенту обмена сообщениями необходимо отобразить сообщение типа, поддерживаемого сервером форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-128">The form server is the executable file that is loaded when a messaging client needs to display a message that is the type supported by the form server.</span></span> <span data-ttu-id="b1f5c-129">Сервер форм, в свою очередь, создает объекты формы, необходимые для отображения определенных сообщений и обработки взаимодействий пользователей с этими сообщениями.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-129">The form server in turn creates form objects as necessary to display specific messages and handle user interactions with those messages.</span></span>
  
<span data-ttu-id="b1f5c-130">Каждый сервер форм имеет связанный с ним файл конфигурации.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-130">Every form server has a configuration file associated with it.</span></span> <span data-ttu-id="b1f5c-131">Этот файл содержит сведения, описывая сервер форм в интересах руководителя форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-131">This file contains information that describes the form server for the benefit of the form manager.</span></span> <span data-ttu-id="b1f5c-132">Администратор формы использует эти сведения при установке сервера форм в библиотеку форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-132">The form manager uses this information when installing the form server into a form library.</span></span>
  
<span data-ttu-id="b1f5c-133">Дополнительные сведения о создании частей формы см. в материале [Developing MAPI Form Servers.](developing-mapi-form-servers.md)</span><span class="sxs-lookup"><span data-stu-id="b1f5c-133">For details on creating the parts of a form, see [Developing MAPI Form Servers](developing-mapi-form-servers.md).</span></span>
  
<span data-ttu-id="b1f5c-134">Серверы форм придерживаются компонентной объектной модели (COM).</span><span class="sxs-lookup"><span data-stu-id="b1f5c-134">Form servers adhere to the Component Object Model (COM).</span></span> <span data-ttu-id="b1f5c-135">Серверы форм выполняются как автономные исполняемые, а не как серверы в прок.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-135">Form servers run as standalone executables, not as in-proc servers.</span></span> <span data-ttu-id="b1f5c-136">Дополнительные сведения см. в разделе COM и ActiveX object Services в Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-136">For more information, see the COM and ActiveX Object Services section in the Windows SDK.</span></span>
  
<span data-ttu-id="b1f5c-137">Уникальный идентификатор класса (CLSID) определяет каждый сервер форм.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-137">A unique class identifier (CLSID) identifies each form server.</span></span> <span data-ttu-id="b1f5c-138">Между идентификатором класса и классом сообщений всегда существует сопоставление один к одному.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-138">There is always a one-to-one mapping between a class identifier and its message class.</span></span> <span data-ttu-id="b1f5c-139">Однако это не означает, что сервер форм может работать только с сообщениями одного класса сообщений.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-139">This does not mean, however, that a form server can only work with messages of one message class.</span></span> <span data-ttu-id="b1f5c-140">Если сервер формы не доступен для обслуживания сообщения определенного класса, используемый менеджер форм должен попытаться найти сервер формы для класса сообщений выше в иерархии классов сообщений; это делает диспетчер форм по умолчанию, Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-140">If no form server is available to service a message of a particular class, the form manager being used should attempt to find a form server for a message class higher in the message class hierarchy; the default form manager supplied with the Windows SDK does this.</span></span> <span data-ttu-id="b1f5c-141">Такой сервер форм, вероятно, сможет отрисовывать только подмножество свойств сообщения (поддерживаемых суперклассом), но это будет лучше, чем ничего.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-141">Such a form server will probably be able to render only a subset of the message's properties (the ones supported by the superclass), but it will be better than nothing.</span></span> <span data-ttu-id="b1f5c-142">Что происходит, если не обнаружено ни один совпадающий сервер форм, это деталь реализации, специфическая для используемой диспетчера форм; менеджер форм по умолчанию не открывает сообщения, когда это произойдет.</span><span class="sxs-lookup"><span data-stu-id="b1f5c-142">What happens when no matching form server is found at all is an implementation detail specific to the form manager being used; the default form manager does not open messages when this happens.</span></span>
  
<span data-ttu-id="b1f5c-143">Дополнительные сведения см. в [нескольких классах сообщений MAPI.](mapi-message-classes.md)</span><span class="sxs-lookup"><span data-stu-id="b1f5c-143">For more information, see [MAPI Message Classes](mapi-message-classes.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="b1f5c-144">См. также</span><span class="sxs-lookup"><span data-stu-id="b1f5c-144">See also</span></span>



[<span data-ttu-id="b1f5c-145">Формы MAPI</span><span class="sxs-lookup"><span data-stu-id="b1f5c-145">MAPI Forms</span></span>](mapi-forms.md)


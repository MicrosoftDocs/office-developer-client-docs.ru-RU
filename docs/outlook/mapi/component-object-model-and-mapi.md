---
title: Объектная модель компонентов и MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: cca4c70d-b73a-4834-80b5-9cb5889f63cc
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: cf687a7bfadb0981ca3440c2f81bc5de8f910924
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808197"
---
# <a name="component-object-model-and-mapi"></a>Объектная модель компонентов и MAPI

  
  
**Относится к**: Outlook 
  
Документация по Windows SDK документы с этим правилам при внедрении объекты, которые соответствуют для модели компонентных объектов (COM). Эти правила рассматриваются как сделать следующее:
  
- Разработка интерфейсов и объекты.
    
- Реализуйте интерфейс [IUnknown](http://msdn.microsoft.com/en-us/library/ms680509%28VS.85%29.aspx) . 
    
- Управление памятью.
    
- Обработка подсчет ссылок.
    
- Реализация объектов COM объектов.
    
Несмотря на то, что все объекты MAPI считаются на основе COM, так как их реализовать интерфейсы, производные от [IUnknown](http://msdn.microsoft.com/en-us/library/ms680509%28VS.85%29.aspx), в некоторых случаях из стандартных правил COM отличается MAPI. В этом отклонение разработчики большая гибкость в их реализации. К примеру интерфейса MAPI, как и любой COM-интерфейс описывает контракт между разработчик и вызывающего абонента. После создания и публикации интерфейс его определение не может и не изменяется. MAPI не отличаются от это описание, но он немного ослабляет используемые описание. Специалистов по внедрению можно выбрать реализует конкретного способа возвращает одно из следующих значений ошибка вызывающего абонента. 
  
- MAPI_E_NO_SUPPORT
    
- MAPI_E_TOO_COMPLEX
    
- MAPI_E_BAD_CHARWIDTH
    
- MAPI_E_TYPE_NO_SUPPORT
    
Другие отклонений от стандартных правил COM, описаны в следующей таблице.
  
|**Правила программирования COM**|**MAPI вариантов**|
|:-----|:-----|
|Все параметры строки в методы интерфейса должны быть Юникод.  <br/> |Интерфейсы MAPI определены для разрешения параметров строки Юникод или ANSI. Множество методов, которые имеют строковый параметр, также имеют параметр **ulFlags** ; значение флага MAPI_UNICODE в **ulFlags**указывает ширину строковый параметр. Некоторые интерфейсы MAPI не поддерживает Юникод и возврата MAPI_E_BAD_CHARWIDTH при установке флага MAPI_UNICODE.  <br/> |
|Все методы интерфейса должен иметь тип возвращаемого значения HRESULT.  <br/> |MAPI есть по крайней мере один метод, который возвращает значение, не являющиеся HRESULT: [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md).  <br/> |
|Вызывающих объектов и специалистов по внедрению следует выделить и освободить память для параметров интерфейса с помощью стандартных механизмов выделения задач COM.  <br/> |Все методы интерфейса MAPI для управления памяти для параметров интерфейса использовать связанные выделения пространства [MAPIAllocateBuffer](mapiallocatebuffer.md), [MAPIAllocateMore](mapiallocatemore.md)и [MAPIFreeBuffer](mapifreebuffer.md) . Все реализации MAPI интерфейсы, определенные OLE, такие как [IStream](http://msdn.microsoft.com/en-us/library/aa380034%28VS.85%29.aspx)использовать стандартный выделения пространства задач COM.  <br/> |
|Все параметры указатель должен явно иметь значение NULL при сбое метода.  <br/> |Интерфейсы MAPI требуется, что выходные параметры указателя быть задано значение NULL или не изменяются, когда метод не удается выполнить. Все реализации интерфейса MAPI интерфейсы, определенные OLE явно задать выходные параметры значение NULL в случае ошибки.  <br/> |
|Реализация комбинируемого объектов, когда это возможно.  <br/> |Интерфейсы MAPI не комбинируемого.  <br/> |
   
## <a name="see-also"></a>См. также



[MAPIAllocateBuffer](mapiallocatebuffer.md)
  
[MAPIAllocateMore](mapiallocatemore.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)


[Обзор интерфейса и объект MAPI](mapi-object-and-interface-overview.md)


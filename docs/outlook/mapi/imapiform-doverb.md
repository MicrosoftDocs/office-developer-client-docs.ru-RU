---
title: имапиформдоверб
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIForm.DoVerb
api_type:
- COM
ms.assetid: 8b582571-b448-4476-91d9-4cc94dbec710
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 60a8c89afe0d70a1737c6ce694c66359fd6aae4f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32329463"
---
# <a name="imapiformdoverb"></a>IMAPIForm::DoVerb

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Запрашивает выполнение формой любых задач, которые она связывает с определенной командой.
  
```cpp
HRESULT DoVerb(
  LONG iVerb,
  LPMAPIVIEWCONTEXT lpViewContext,
  ULONG_PTR hwndParent,
  LPCRECT lprcPosRect
);
```

## <a name="parameters"></a>Параметры

 _иверб_
  
> возврата Число, связанное с одной из команд формы.
    
 _лпвиевконтекст_
  
> возврата Указатель на объект контекста представления. Параметр _лпвиевконтекст_ может иметь **значение NULL**.
    
 _хвндпарент_
  
> возврата Дескриптор родительского окна любых диалоговых окон или окон, которые отображает этот метод. Параметр _хвндпарент_ должен иметь **значение NULL** , если диалоговое окно или окно не являются модальными. 
    
 _лпркпосрект_
  
> возврата Указатель на структуру [Rect](https://msdn.microsoft.com/library/dd162897%28VS.85%29.aspx) Win32, которая содержит размер и положение окна формы. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Команда успешно вызвана.
    
OLEOBJ_S_CANNOT_DOVERB_NOW 
  
> Команда, представленная параметром _иверб_ , является допустимой, но форма не может выполнять операции, связанные с ней. 
    
## <a name="remarks"></a>Примечания

Средства просмотра форм вызывают метод **имапиформ::D оверб** , чтобы запросить выполнение задач, которые она связывает с каждой командой, поддерживаемой формой. 
  
Каждая из поддерживаемых команд идентифицируется с помощью числового значения, которое передается в **доверб** в параметре _иверб_ . Типичные реализации **доверб** содержат оператор **switch** , который проверяет значения, допустимые для параметра _иверб_ в форме. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если средство просмотра формы определяет контекст представления в параметре _лпвиевконтекст_ , используйте его в реализации **доверб** , а не в контексте представления, переданном при предыдущем вызове метода [имапиформ:: сетвиевконтекст](imapiform-setviewcontext.md) . Внесите все необходимые изменения во внутренние структуры данных и не сохраняйте контекст представления. 
  
Выполните следующие задачи в реализации **доверб** : 
  
- Выполните любой код, который необходим для конкретной команды, связанной с параметром _иверб_ . 
    
- При необходимости восстановите исходный контекст представления.
    
- Если был передан Неизвестный номер команды, возвращается MAPI_E_NO_SUPPORT. В противном случае возвращает результат на основе успешности или сбоя любой выполняемой команды.
    
- Закройте форму. Она всегда отвечает за закрытие формы после завершения вызова **доверб** . 
    
Некоторые глаголы, такие как Print, должны быть модальными по отношению к вызову **доверб** — то есть перед возвратом вызова **доверб** необходимо завершить указанную операцию. 
  
Чтобы получить структуру **Rect** , используемую окном формы, вызовите функцию [жетвиндоврект](https://msdn.microsoft.com/library/ms633519) . 
  
Не сохраняйте дескриптор в параметре _хвндпарент_ , несмотря на то, что он обычно остается действительным до завершения **доверб**, он может быть удален сразу после возврата звонка.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Немодальные команды можно сделать модальными глаголами, наведя _лпвиевконтекст_ на реализацию контекста представления, которая возвращает флаг VCSTATUS_MODAL из метода [Имапивиевконтекст:: жетвиевстатус](imapiviewcontext-getviewstatus.md) . 
  
Дополнительные сведения о командах в MAPI приведены в разделе [команды формы](form-verbs.md). Для получения дополнительных сведений о том, как команды обрабатываются в OLE, ознакомьтесь с разработкой [OLE и передачи данных](https://msdn.microsoft.com/library/ms693425%28VS.85%29.aspx).
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мимапиформвиевер. cpp  <br/> |Кмимапиформвиевер:: Каллдоверб  <br/> |MFCMAPI использует метод **имапиформ::D оверб** для вызова команды в форме.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIForm::SetViewContext](imapiform-setviewcontext.md)
  
[IMAPIViewContext::GetViewStatus](imapiviewcontext-getviewstatus.md)
  
[IMAPIForm : IUnknown](imapiformiunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Команды форм](form-verbs.md)


---
title: Хранение форм
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 6ddf9158-3c10-408a-aeaf-5a382c4339e7
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 793a34b093ba69f73be7e186bec0a769584bbac4
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33414895"
---
# <a name="form-storage"></a><span data-ttu-id="e61b8-103">Хранение форм</span><span class="sxs-lookup"><span data-stu-id="e61b8-103">Form storage</span></span>

<span data-ttu-id="e61b8-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="e61b8-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="e61b8-105">Несмотря на то, что нет необходимости знать все сведения о том, как физически хранятся формы, полезно разобраться с некоторыми основными концепциями.</span><span class="sxs-lookup"><span data-stu-id="e61b8-105">Although it is not necessary to know all the details of how forms are physically stored, it is useful to understand a few of the main concepts.</span></span> <span data-ttu-id="e61b8-106">Поэтому перед описанием трех типов библиотек форм, поддерживаемых диспетчером форм по умолчанию, в этом разделе дается обзор способов хранения форм.</span><span class="sxs-lookup"><span data-stu-id="e61b8-106">Therefore, before describing the three types of form libraries supported by the default form manager, this topic gives an overview of how forms are stored.</span></span>
  
<span data-ttu-id="e61b8-107">Определения форм могут физически храниться в папках в одном или нескольких хранилищах сообщений MAPI.</span><span class="sxs-lookup"><span data-stu-id="e61b8-107">Form definitions can be physically stored within folders in one or more MAPI message stores.</span></span> <span data-ttu-id="e61b8-108">Каждая папка MAPI может рассматриваться как две области для хранения объектов сообщений: стандартные и связанные части.</span><span class="sxs-lookup"><span data-stu-id="e61b8-108">Every MAPI folder can be thought of as having two areas for storing message objects: the standard part and the associated part.</span></span> <span data-ttu-id="e61b8-109">Стандартная часть папки включает сообщения и папки, которыми управляет пользователь.</span><span class="sxs-lookup"><span data-stu-id="e61b8-109">The standard part of the folder includes the messages and folders that users manipulate.</span></span>
  
<span data-ttu-id="e61b8-110">Связанная часть включает скрытые объекты сообщений, связанные с папкой, в том числе определения форм, представления, шаблоны правил, шаблоны ответа и т. д.</span><span class="sxs-lookup"><span data-stu-id="e61b8-110">The associated part includes hidden message objects that are associated with the folder, including form definitions, views, rule templates, reply templates, and so on.</span></span> <span data-ttu-id="e61b8-111">Эта альтернативная часть называется таблицей содержимого, связанной с папкой, а набор сообщений в связанной таблице содержимого называется данными, связанными с папкой.</span><span class="sxs-lookup"><span data-stu-id="e61b8-111">This alternate part is called the folder-associated contents table, and the set of messages in the associated contents table is referred to as the folder-associated information.</span></span> <span data-ttu-id="e61b8-112">Скрытые сообщения являются неотъемлемой частью папки и копируются вместе со стандартным содержимым папки при копировании папки.</span><span class="sxs-lookup"><span data-stu-id="e61b8-112">The hidden messages are an integral part of the folder and are copied along with the standard folder contents when the folder is copied.</span></span> <span data-ttu-id="e61b8-113">Несмотря на то, что физически хранятся в сообщениях, сведения в таблице содержимого, связанной с папкой, имеют более схожие свойства, как и отображаемые сообщения.</span><span class="sxs-lookup"><span data-stu-id="e61b8-113">Although physically stored as messages, information in a folder's associated contents table behaves more like properties than like viewable messages.</span></span> <span data-ttu-id="e61b8-114">Любой объект Folder, поддерживающий связанную таблицу контента, поддерживает хранение настраиваемых форм.</span><span class="sxs-lookup"><span data-stu-id="e61b8-114">Any folder object that supports an associated contents table is capable of storing custom forms.</span></span> <span data-ttu-id="e61b8-115">Метод [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md) может возвращать либо стандартное содержимое, либо связанное содержимое папки в зависимости от значения параметра _ulflags_ метода.</span><span class="sxs-lookup"><span data-stu-id="e61b8-115">The [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md) method can return either the standard contents or the associated contents of the folder, depending on the value of the method's  _ulflags_ parameter.</span></span> 
  
<span data-ttu-id="e61b8-116">Библиотека форм состоит из определений форм, хранящихся в связанной с папкой таблице содержимого.</span><span class="sxs-lookup"><span data-stu-id="e61b8-116">A form library consists of form definitions stored in a folder's associated contents table.</span></span> <span data-ttu-id="e61b8-117">Определение формы содержит свойства формы, действия, поддерживаемые формой, и даже исполняемый файл сервера форм, который хранится в виде одного или нескольких вложений.</span><span class="sxs-lookup"><span data-stu-id="e61b8-117">The form definition includes the form's properties, the actions the form supports, and even the form server executable file, which is stored as one or more message attachments.</span></span>
  
<span data-ttu-id="e61b8-118">Кроме того, формы могут храниться в любом файле или в расположении, которое поддерживается используемым диспетчером форм.</span><span class="sxs-lookup"><span data-stu-id="e61b8-118">Additionally, forms can be stored in any file or location that the form manager being used supports.</span></span> <span data-ttu-id="e61b8-119">Диспетчер форм, используемый по умолчанию, хранит серверы форм в папках MAPI, но настраиваемый диспетчер форм может реализовать собственное хранилище для серверов форм.</span><span class="sxs-lookup"><span data-stu-id="e61b8-119">The default form manager stores form servers in MAPI folders, but a custom form manager could implement its own storage for form servers.</span></span>
  
<span data-ttu-id="e61b8-120">Форма может иметь несколько пользовательских интерфейсов, привязанных к классу сообщений.</span><span class="sxs-lookup"><span data-stu-id="e61b8-120">A form can have multiple user interfaces that are bound to its message class.</span></span> <span data-ttu-id="e61b8-121">Например, форма может иметь отдельные пользовательские интерфейсы создания и чтения.</span><span class="sxs-lookup"><span data-stu-id="e61b8-121">For example, a form can have separate Compose and Read user interfaces.</span></span> <span data-ttu-id="e61b8-122">Форма отвечает за вызов надлежащего пользовательского интерфейса для разных пользовательских запросов в зависимости от того, какой из команд формы вызывается.</span><span class="sxs-lookup"><span data-stu-id="e61b8-122">The form takes care of invoking the proper user interface for different user requests, depending on which of the form's verbs is being called.</span></span> <span data-ttu-id="e61b8-123">Например, если на сервере формы разделяются пользовательские интерфейсы для создания и чтения, Пользовательский интерфейс создания может быть открыт автоматически, когда пользователь создает новое сообщение класса сообщений формы, а пользовательский интерфейс чтения можно открыть автоматически при пользователь открывает существующее сообщение класса сообщений формы.</span><span class="sxs-lookup"><span data-stu-id="e61b8-123">For example, if your form server has separate composing and reading user interfaces, the Compose user interface can be opened automatically when the user creates a new message of the form's message class and the Read user interface can be opened automatically when the user opens an existing message of the form's message class.</span></span>
  
<span data-ttu-id="e61b8-124">Большая часть информации, хранящейся в определении формы, доступна путем вызова метода [имапиформинфо:: IMAPIProp](imapiforminfoimapiprop.md) объекта **имапиформинфо** .</span><span class="sxs-lookup"><span data-stu-id="e61b8-124">Most of the information stored within a form definition is available by invoking the [IMAPIFormInfo::IMAPIProp](imapiforminfoimapiprop.md) method on an **IMAPIFormInfo** object.</span></span> <span data-ttu-id="e61b8-125">Интерфейс **имапиформинфо** упрощает доступ к сведениям формы, вызывая все папки MAPI и методы сообщений, необходимые для получения этих сведений.</span><span class="sxs-lookup"><span data-stu-id="e61b8-125">The **IMAPIFormInfo** interface simplifies access to form information by calling all the MAPI folder and message methods needed to retrieve the information.</span></span> <span data-ttu-id="e61b8-126">Объект **имапиформинфо** можно получить, вызвав метод [Имапиформконтаинер:: ресолвемессажекласс](imapiformcontainer-resolvemessageclass.md) .</span><span class="sxs-lookup"><span data-stu-id="e61b8-126">An **IMAPIFormInfo** object can be obtained by calling the [IMAPIFormContainer::ResolveMessageClass](imapiformcontainer-resolvemessageclass.md) method.</span></span> 
  
<span data-ttu-id="e61b8-127">Эти три типа библиотек форм описаны в разделах [локальные библиотеки форм](local-form-libraries.md), [библиотеки форм папок](folder-form-libraries.md) и [библиотеки личных форм](personal-form-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="e61b8-127">The three types of form libraries are described in the topics [Local Form Libraries](local-form-libraries.md), [Folder Form Libraries](folder-form-libraries.md) and [Personal Form Libraries](personal-form-libraries.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e61b8-128">См. также</span><span class="sxs-lookup"><span data-stu-id="e61b8-128">See also</span></span>

- [<span data-ttu-id="e61b8-129">Формы MAPI</span><span class="sxs-lookup"><span data-stu-id="e61b8-129">MAPI Forms</span></span>](mapi-forms.md)


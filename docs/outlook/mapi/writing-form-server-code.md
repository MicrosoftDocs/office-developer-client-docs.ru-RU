---
title: Написание кода на сервере формы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a93e53261d56e452f38e38da427585cecccba405
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325797"
---
# <a name="writing-form-server-code"></a><span data-ttu-id="ba8d3-103">Написание кода на сервере формы</span><span class="sxs-lookup"><span data-stu-id="ba8d3-103">Writing Form Server Code</span></span>

  
  
<span data-ttu-id="ba8d3-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ba8d3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ba8d3-105">Сервер формы можно представить следующим образом:</span><span class="sxs-lookup"><span data-stu-id="ba8d3-105">You can think of a form server as the following:</span></span> 
  
- <span data-ttu-id="ba8d3-106">Программа Win32, которая отображает интерфейс и обрабатывает сообщения Windows с помощью стандартных механизмов приема сообщений Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-106">A Win32 program that displays an interface and handles windows messages by way of the standard Windows message pump mechanisms.</span></span>
    
- <span data-ttu-id="ba8d3-107">Объект, который регистрирует фабрику классов с помощью OLE и активируется методами автоматизации OLE.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-107">An object that registers its class factory with OLE and is activated by OLE automation methods.</span></span>
    
- <span data-ttu-id="ba8d3-108">Объект MAPI, который следует правилам MAPI для взаимодействия с другими компонентами MAPI.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-108">A MAPI object that follows the MAPI rules for interactions with other MAPI components.</span></span>
    
 <span data-ttu-id="ba8d3-109">Код должен одновременно обрабатывать все три из этих общих требований.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-109">Your code has to handle all three of those broad requirements simultaneously.</span></span> 
  
<span data-ttu-id="ba8d3-110">В разделе службы объектов COM и ActiveX в пакете Windows SDK вы найдете подробные сведения о регистрации фабрики классов на сервере форм.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-110">See the COM and ActiveX Object Services section in the Windows SDK for details about registering your form server's class factory.</span></span> <span data-ttu-id="ba8d3-111">Обработка сообщений Windows и отображение интерфейса — это стандартные приемы программирования Windows, которые не имеют специальных требований в отношении форм MAPI.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-111">Handling windows messages and displaying an interface are standard Windows programming techniques that do not have any special requirements with respect to MAPI forms.</span></span> <span data-ttu-id="ba8d3-112">Опять же, пакет Windows SDK содержит подробные сведения о программировании для Windows.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-112">Again, the Windows SDK has details about Windows programming.</span></span> <span data-ttu-id="ba8d3-113">В этом документе содержатся сведения о том, как реализовать обязательные и необязательные интерфейсы форм MAPI, чтобы они применялись к правилам MAPI для взаимодействия с другими компонентами MAPI, в первую очередь Диспетчер форм MAPI и клиентские приложения для обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-113">This document contains what you need to know to implement the required and optional MAPI form interfaces so that they follow the MAPI rules for interactions with other MAPI components — primarily the MAPI form manager and messaging client applications.</span></span>
  
<span data-ttu-id="ba8d3-114">Все интерфейсы, которые можно использовать при реализации серверов форм, являются производными (напрямую или косвенно) от интерфейса [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx)базового класса OLE.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-114">All of the interfaces that you can use when you implement form servers are derived — either directly or indirectly — from the OLE base class [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span></span> <span data-ttu-id="ba8d3-115">Это означает, что все реализации этих интерфейсов должны иметь методы **QueryInterface**, **AddRef**и **Release** .</span><span class="sxs-lookup"><span data-stu-id="ba8d3-115">This means that all your implementations of these interfaces will need to have **QueryInterface**, **AddRef**, and **Release** methods.</span></span> <span data-ttu-id="ba8d3-116">Если вы используете несколько наследований для реализации всех необходимых интерфейсов в одном новом классе, вы можете сохранить множество работ, чтобы все используемые интерфейсы могли совместно использовать одну реализацию требуемых методов **IUnknown** .</span><span class="sxs-lookup"><span data-stu-id="ba8d3-116">You can save yourself a lot of work if you use multiple inheritance to implement all of the required interfaces in one new class of your own, so that all the interfaces you use can share a single implementation of the required **IUnknown** methods.</span></span> <span data-ttu-id="ba8d3-117">Дополнительные сведения см. в методах [IUnknown:: AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)и [IUnknown:: Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="ba8d3-117">For more information, see the [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), and [IUnknown::Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) methods.</span></span> <span data-ttu-id="ba8d3-118">Для этих методов не существует специальных рекомендаций по отношению к серверам форм MAPI.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-118">There are no special considerations with respect to MAPI form servers for these methods.</span></span> 
  
<span data-ttu-id="ba8d3-119">Хотя не все интерфейсы форм MAPI являются обязательными для всех серверов форм, методы в любом заданном интерфейсе являются обязательными.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-119">While not all of the MAPI form interfaces are mandatory for all form servers, the methods in any given interface are mandatory.</span></span> <span data-ttu-id="ba8d3-120">То есть, если вы решили реализовать определенный интерфейс, необходимо реализовать все методы в интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-120">That is, if you choose to implement a particular interface, you must implement all of the methods in the interface.</span></span> <span data-ttu-id="ba8d3-121">Это отличается от ситуации с некоторыми другими компонентами MAPI, такими как транспортировка сообщений.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-121">This is different from the situation with some other MAPI components, such as message transports.</span></span> <span data-ttu-id="ba8d3-122">К счастью, методы в интерфейсах форм MAPI являются относительно простыми, поэтому реализация всех этих интерфейсов не приводит к значительным затратам на разработчиков.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-122">Fortunately, the methods in the MAPI form interfaces are relatively straightforward, so implementing all of them does not put a great burden on developers.</span></span>
  
<span data-ttu-id="ba8d3-123">Интерфейсы форм MAPI не зависят от типа средства разработки, используемого для создания сервера форм.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-123">The MAPI form interfaces are independent of the type of development tool used to create a form server.</span></span> <span data-ttu-id="ba8d3-124">Это позволяет создавать формы с помощью различных средств разработки.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-124">This allows forms to be created by using different development tools.</span></span> <span data-ttu-id="ba8d3-125">Единственное требование состоит в том, что все серверы форм должны поддерживать необходимые интерфейсы форм MAPI.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-125">The only requirement is that all form servers must support the required MAPI form interfaces.</span></span>
  
<span data-ttu-id="ba8d3-126">Не все интерфейсы MAPI, которые относятся к формам, необходимы для всех серверов форм.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-126">Not all of the MAPI interfaces that relate to forms are required by all form servers.</span></span> <span data-ttu-id="ba8d3-127">Необязательные интерфейсы позволяют реализовать некоторые расширенные функции форм, которые не требуются большинству серверов форм.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-127">The optional interfaces allow you to implement some advanced form functions that are not needed by most form servers.</span></span> <span data-ttu-id="ba8d3-128">В следующей таблице приведены интерфейсы, их назначение и необходимость их реализации.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-128">The following table lists the interfaces, what they are for, and whether you must implement them.</span></span>
  
|<span data-ttu-id="ba8d3-129">**Интерфейс**</span><span class="sxs-lookup"><span data-stu-id="ba8d3-129">**Interface**</span></span>|<span data-ttu-id="ba8d3-130">**Описание**</span><span class="sxs-lookup"><span data-stu-id="ba8d3-130">**Description**</span></span>|<span data-ttu-id="ba8d3-131">**Состояние**</span><span class="sxs-lookup"><span data-stu-id="ba8d3-131">**Status**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="ba8d3-132">IMAPIForm : IUnknown</span><span class="sxs-lookup"><span data-stu-id="ba8d3-132">IMAPIForm : IUnknown</span></span>](imapiformiunknown.md) <br/> |<span data-ttu-id="ba8d3-133">Основной интерфейс, используемый клиентами для загрузки серверов форм, выполнения команд форм и завершения работы серверов форм.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-133">The primary interface that clients use to load form servers, execute form verbs, and shut down form servers.</span></span> <span data-ttu-id="ba8d3-134">Это также интерфейс, производный от интерфейса **IUnknown** OLE, который используется для информирования других компонентов OLE относительно того, какие интерфейсы реализуют объект формы.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-134">This is also the interface derived from the OLE **IUnknown** that is used to inform other OLE components regarding what interfaces a form object implements.</span></span>  <br/> |<span data-ttu-id="ba8d3-135">Обязательный</span><span class="sxs-lookup"><span data-stu-id="ba8d3-135">Required</span></span>  <br/> |
|[<span data-ttu-id="ba8d3-136">IPersistMessage : IUnknown</span><span class="sxs-lookup"><span data-stu-id="ba8d3-136">IPersistMessage : IUnknown</span></span>](ipersistmessageiunknown.md) <br/> |<span data-ttu-id="ba8d3-137">Используется при загрузке сообщений в и сохранения сообщений из объектов формы.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-137">Used when loading messages into and saving messages from form objects.</span></span>  <br/> |<span data-ttu-id="ba8d3-138">Обязательный</span><span class="sxs-lookup"><span data-stu-id="ba8d3-138">Required</span></span>  <br/> |
|[<span data-ttu-id="ba8d3-139">IMAPIFormAdviseSink : IUnknown</span><span class="sxs-lookup"><span data-stu-id="ba8d3-139">IMAPIFormAdviseSink : IUnknown</span></span>](imapiformadvisesinkiunknown.md) <br/> |<span data-ttu-id="ba8d3-140">Используется объектами Form для отслеживания состояния клиентов системы обмена сообщениями и выяснения того, может ли объект формы отображать следующее или предыдущее сообщение в папке.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-140">Used by form objects to keep track of messaging client status and to find out whether the form object is capable of displaying the next or previous message in a folder.</span></span>  <br/> |<span data-ttu-id="ba8d3-141">Необязательный</span><span class="sxs-lookup"><span data-stu-id="ba8d3-141">Optional</span></span>  <br/> |
|[<span data-ttu-id="ba8d3-142">IClassFactory</span><span class="sxs-lookup"><span data-stu-id="ba8d3-142">IClassFactory</span></span>](https://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |<span data-ttu-id="ba8d3-143">Интерфейс фабрики классов OLE, используемый объектами формы для обеспечения соответствия механизму производства классов OLE.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-143">The OLE class factory interface used by form objects for compliance with the OLE class factory mechanism.</span></span>  <br/> |<span data-ttu-id="ba8d3-144">Обязательный</span><span class="sxs-lookup"><span data-stu-id="ba8d3-144">Required</span></span>  <br/> |
|[<span data-ttu-id="ba8d3-145">IMAPIFormFactory : IUnknown</span><span class="sxs-lookup"><span data-stu-id="ba8d3-145">IMAPIFormFactory : IUnknown</span></span>](imapiformfactoryiunknown.md) <br/> |<span data-ttu-id="ba8d3-146">Используется, если сервер форм поддерживает более одного типа формы.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-146">Used if your form server supports more than one type of form.</span></span> <span data-ttu-id="ba8d3-147">В этом случае интерфейс **имапиформфактори** позволяет клиентским приложениям получать доступ к нескольким интерфейсам **IClassFactory** (по одному для каждого типа формы, поддерживаемой сервером форм), которые сервер формы также должен реализовать.</span><span class="sxs-lookup"><span data-stu-id="ba8d3-147">In this case, the **IMAPIFormFactory** interface allows client applications to access the multiple **IClassFactory** interfaces (one per type of form that your form server supports) that your form server must also implement.</span></span>  <br/> |<span data-ttu-id="ba8d3-148">Необязательный</span><span class="sxs-lookup"><span data-stu-id="ba8d3-148">Optional</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="ba8d3-149">См. также</span><span class="sxs-lookup"><span data-stu-id="ba8d3-149">See also</span></span>



[<span data-ttu-id="ba8d3-150">Разработка серверов форм MAPI</span><span class="sxs-lookup"><span data-stu-id="ba8d3-150">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)


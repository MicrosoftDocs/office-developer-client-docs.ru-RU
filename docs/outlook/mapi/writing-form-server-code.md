---
title: Написание серверного кода формы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a93e53261d56e452f38e38da427585cecccba405
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25384082"
---
# <a name="writing-form-server-code"></a><span data-ttu-id="8acc0-103">Написание серверного кода формы</span><span class="sxs-lookup"><span data-stu-id="8acc0-103">Writing Form Server Code</span></span>

  
  
<span data-ttu-id="8acc0-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8acc0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8acc0-105">Можно представить сервера форм следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8acc0-105">You can think of a form server as the following:</span></span> 
  
- <span data-ttu-id="8acc0-106">Программа Win32, которая отображает интерфейс и обработки сообщений windows путем получения стандартных механизмов обработки сообщений Windows.</span><span class="sxs-lookup"><span data-stu-id="8acc0-106">A Win32 program that displays an interface and handles windows messages by way of the standard Windows message pump mechanisms.</span></span>
    
- <span data-ttu-id="8acc0-107">Объект, который регистрирует его фабрики классов OLE и активировать методами автоматизации OLE.</span><span class="sxs-lookup"><span data-stu-id="8acc0-107">An object that registers its class factory with OLE and is activated by OLE automation methods.</span></span>
    
- <span data-ttu-id="8acc0-108">Объект MAPI, исходя из правил MAPI для взаимодействия с другими компонентами MAPI.</span><span class="sxs-lookup"><span data-stu-id="8acc0-108">A MAPI object that follows the MAPI rules for interactions with other MAPI components.</span></span>
    
 <span data-ttu-id="8acc0-109">Код должен обрабатывать все три этих общие требования одновременно.</span><span class="sxs-lookup"><span data-stu-id="8acc0-109">Your code has to handle all three of those broad requirements simultaneously.</span></span> 
  
<span data-ttu-id="8acc0-110">Обратитесь к разделу COM и службы объект ActiveX в пакете SDK Windows для получения дополнительных сведений о регистрации фабрики классов сервера форм.</span><span class="sxs-lookup"><span data-stu-id="8acc0-110">See the COM and ActiveX Object Services section in the Windows SDK for details about registering your form server's class factory.</span></span> <span data-ttu-id="8acc0-111">Обрабатывает сообщения windows и отображение интерфейс — стандартных методов программирования Windows, не связанные с особыми требованиями по отношению к формы MAPI.</span><span class="sxs-lookup"><span data-stu-id="8acc0-111">Handling windows messages and displaying an interface are standard Windows programming techniques that do not have any special requirements with respect to MAPI forms.</span></span> <span data-ttu-id="8acc0-112">Опять же пакет SDK для Windows содержит подробные сведения о создании приложений для Windows.</span><span class="sxs-lookup"><span data-stu-id="8acc0-112">Again, the Windows SDK has details about Windows programming.</span></span> <span data-ttu-id="8acc0-113">В этом документе представлены, что вам нужно знать для реализации интерфейсов формы MAPI обязательные и дополнительные, чтобы они Следуйте правилам MAPI для взаимодействия с другими компонентами MAPI — в основном MAPI форме manager и клиентских приложениях системы обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="8acc0-113">This document contains what you need to know to implement the required and optional MAPI form interfaces so that they follow the MAPI rules for interactions with other MAPI components — primarily the MAPI form manager and messaging client applications.</span></span>
  
<span data-ttu-id="8acc0-114">Все интерфейсы, которые можно использовать при реализации формы серверы производные — прямо или косвенно, от OLE базового класса [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="8acc0-114">All of the interfaces that you can use when you implement form servers are derived — either directly or indirectly — from the OLE base class [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx).</span></span> <span data-ttu-id="8acc0-115">Это означает, что все реализации этих интерфейсов потребуется методы **QueryInterface**, **AddRef**и **Release** .</span><span class="sxs-lookup"><span data-stu-id="8acc0-115">This means that all your implementations of these interfaces will need to have **QueryInterface**, **AddRef**, and **Release** methods.</span></span> <span data-ttu-id="8acc0-116">Можно сэкономить много времени при использовании нескольких наследования для реализации необходимых интерфейсов в один новый класс собственным, таким образом, чтобы все интерфейсы, которые можно использовать могут совместно использовать одной реализации необходимые методы **IUnknown** .</span><span class="sxs-lookup"><span data-stu-id="8acc0-116">You can save yourself a lot of work if you use multiple inheritance to implement all of the required interfaces in one new class of your own, so that all the interfaces you use can share a single implementation of the required **IUnknown** methods.</span></span> <span data-ttu-id="8acc0-117">Для получения дополнительных сведений см методы [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)и [функции IUnknown::Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="8acc0-117">For more information, see the [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx), and [IUnknown::Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) methods.</span></span> <span data-ttu-id="8acc0-118">Существует не особые примечания относительно серверов формы MAPI для этих методов.</span><span class="sxs-lookup"><span data-stu-id="8acc0-118">There are no special considerations with respect to MAPI form servers for these methods.</span></span> 
  
<span data-ttu-id="8acc0-119">Хотя не все интерфейсы формы MAPI, обязательные для всех серверов, формы, методы в любой данный интерфейс являются обязательными.</span><span class="sxs-lookup"><span data-stu-id="8acc0-119">While not all of the MAPI form interfaces are mandatory for all form servers, the methods in any given interface are mandatory.</span></span> <span data-ttu-id="8acc0-120">То есть если вы решаете реализовать определенный интерфейс, необходимо реализовать все методы в интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="8acc0-120">That is, if you choose to implement a particular interface, you must implement all of the methods in the interface.</span></span> <span data-ttu-id="8acc0-121">Это отличается от ситуации с другими компонентами MAPI, такие как транспорт сообщений.</span><span class="sxs-lookup"><span data-stu-id="8acc0-121">This is different from the situation with some other MAPI components, such as message transports.</span></span> <span data-ttu-id="8acc0-122">К счастью методы в интерфейсах формы MAPI относительно просты, поэтому реализация все из них не размещайте вызывает трудности на разработчиков.</span><span class="sxs-lookup"><span data-stu-id="8acc0-122">Fortunately, the methods in the MAPI form interfaces are relatively straightforward, so implementing all of them does not put a great burden on developers.</span></span>
  
<span data-ttu-id="8acc0-123">Интерфейсы формы MAPI не зависят от типа средство разработки, используемые для создания сервера форм.</span><span class="sxs-lookup"><span data-stu-id="8acc0-123">The MAPI form interfaces are independent of the type of development tool used to create a form server.</span></span> <span data-ttu-id="8acc0-124">Это позволяет формы, созданные с помощью средств разработки.</span><span class="sxs-lookup"><span data-stu-id="8acc0-124">This allows forms to be created by using different development tools.</span></span> <span data-ttu-id="8acc0-125">Единственное требование заключается в том, что все серверы формы должен поддерживать необходимых интерфейсов формы MAPI.</span><span class="sxs-lookup"><span data-stu-id="8acc0-125">The only requirement is that all form servers must support the required MAPI form interfaces.</span></span>
  
<span data-ttu-id="8acc0-126">Не все интерфейсы MAPI, имеющих отношение к формам необходимы все серверы формы.</span><span class="sxs-lookup"><span data-stu-id="8acc0-126">Not all of the MAPI interfaces that relate to forms are required by all form servers.</span></span> <span data-ttu-id="8acc0-127">Необязательные интерфейсы позволяют реализовать некоторые расширенные формы функции, которые не требуются для большинство серверов формы.</span><span class="sxs-lookup"><span data-stu-id="8acc0-127">The optional interfaces allow you to implement some advanced form functions that are not needed by most form servers.</span></span> <span data-ttu-id="8acc0-128">В следующей таблице перечислены интерфейсы, что это такое и ли их необходимо реализовать.</span><span class="sxs-lookup"><span data-stu-id="8acc0-128">The following table lists the interfaces, what they are for, and whether you must implement them.</span></span>
  
|<span data-ttu-id="8acc0-129">**Интерфейс**</span><span class="sxs-lookup"><span data-stu-id="8acc0-129">**Interface**</span></span>|<span data-ttu-id="8acc0-130">**Описание**</span><span class="sxs-lookup"><span data-stu-id="8acc0-130">**Description**</span></span>|<span data-ttu-id="8acc0-131">**Состояние**</span><span class="sxs-lookup"><span data-stu-id="8acc0-131">**Status**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="8acc0-132">IMAPIForm : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8acc0-132">IMAPIForm : IUnknown</span></span>](imapiformiunknown.md) <br/> |<span data-ttu-id="8acc0-133">Основной интерфейс, используемый клиентами для загрузки формы серверов, выполнение команд формы и завершение работы серверов формы.</span><span class="sxs-lookup"><span data-stu-id="8acc0-133">The primary interface that clients use to load form servers, execute form verbs, and shut down form servers.</span></span> <span data-ttu-id="8acc0-134">Это интерфейс, производные от OLE **IUnknown** , используемый для оповещения других компонентов OLE относительно объекта формы реализует интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="8acc0-134">This is also the interface derived from the OLE **IUnknown** that is used to inform other OLE components regarding what interfaces a form object implements.</span></span>  <br/> |<span data-ttu-id="8acc0-135">Обязательный</span><span class="sxs-lookup"><span data-stu-id="8acc0-135">Required</span></span>  <br/> |
|[<span data-ttu-id="8acc0-136">IPersistMessage : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8acc0-136">IPersistMessage : IUnknown</span></span>](ipersistmessageiunknown.md) <br/> |<span data-ttu-id="8acc0-137">Используется при загрузке сообщений в и сохранение сообщения от объектам формы.</span><span class="sxs-lookup"><span data-stu-id="8acc0-137">Used when loading messages into and saving messages from form objects.</span></span>  <br/> |<span data-ttu-id="8acc0-138">Обязательный</span><span class="sxs-lookup"><span data-stu-id="8acc0-138">Required</span></span>  <br/> |
|[<span data-ttu-id="8acc0-139">IMAPIFormAdviseSink : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8acc0-139">IMAPIFormAdviseSink : IUnknown</span></span>](imapiformadvisesinkiunknown.md) <br/> |<span data-ttu-id="8acc0-140">Используемые объекты формы для отслеживания сообщений состояние клиента и чтобы узнать, совместимо ли объект формы может отображать следующий или предыдущий сообщения в папке.</span><span class="sxs-lookup"><span data-stu-id="8acc0-140">Used by form objects to keep track of messaging client status and to find out whether the form object is capable of displaying the next or previous message in a folder.</span></span>  <br/> |<span data-ttu-id="8acc0-141">Необязательный</span><span class="sxs-lookup"><span data-stu-id="8acc0-141">Optional</span></span>  <br/> |
|[<span data-ttu-id="8acc0-142">IClassFactory</span><span class="sxs-lookup"><span data-stu-id="8acc0-142">IClassFactory</span></span>](https://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |<span data-ttu-id="8acc0-143">OLE класс фабрики интерфейса, используемый вызывающим объекты формы в соответствии с механизм фабрики классов OLE.</span><span class="sxs-lookup"><span data-stu-id="8acc0-143">The OLE class factory interface used by form objects for compliance with the OLE class factory mechanism.</span></span>  <br/> |<span data-ttu-id="8acc0-144">Обязательный</span><span class="sxs-lookup"><span data-stu-id="8acc0-144">Required</span></span>  <br/> |
|[<span data-ttu-id="8acc0-145">IMAPIFormFactory : IUnknown</span><span class="sxs-lookup"><span data-stu-id="8acc0-145">IMAPIFormFactory : IUnknown</span></span>](imapiformfactoryiunknown.md) <br/> |<span data-ttu-id="8acc0-146">Используется, если сервер формы поддерживает более одного типа формы.</span><span class="sxs-lookup"><span data-stu-id="8acc0-146">Used if your form server supports more than one type of form.</span></span> <span data-ttu-id="8acc0-147">В этом случае интерфейс **IMAPIFormFactory** позволяет клиентским приложениям доступ к несколько интерфейсы **IClassFactory** (по одному для каждого типа формы, которая поддерживает сервер формы), что сервер формы также необходимо реализовать.</span><span class="sxs-lookup"><span data-stu-id="8acc0-147">In this case, the **IMAPIFormFactory** interface allows client applications to access the multiple **IClassFactory** interfaces (one per type of form that your form server supports) that your form server must also implement.</span></span>  <br/> |<span data-ttu-id="8acc0-148">Необязательный</span><span class="sxs-lookup"><span data-stu-id="8acc0-148">Optional</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="8acc0-149">См. также</span><span class="sxs-lookup"><span data-stu-id="8acc0-149">See also</span></span>



[<span data-ttu-id="8acc0-150">Разработка серверов форм MAPI</span><span class="sxs-lookup"><span data-stu-id="8acc0-150">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)


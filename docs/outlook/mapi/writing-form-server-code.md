---
title: Написание серверного кода формы
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 463193b55dab0839c756367db16d02aae5980a77
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22578124"
---
# <a name="writing-form-server-code"></a>Написание серверного кода формы

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Можно представить сервера форм следующим образом: 
  
- Программа Win32, которая отображает интерфейс и обработки сообщений windows путем получения стандартных механизмов обработки сообщений Windows.
    
- Объект, который регистрирует его фабрики классов OLE и активировать методами автоматизации OLE.
    
- Объект MAPI, исходя из правил MAPI для взаимодействия с другими компонентами MAPI.
    
 Код должен обрабатывать все три этих общие требования одновременно. 
  
Обратитесь к разделу COM и службы объект ActiveX в пакете SDK Windows для получения дополнительных сведений о регистрации фабрики классов сервера форм. Обрабатывает сообщения windows и отображение интерфейс — стандартных методов программирования Windows, не связанные с особыми требованиями по отношению к формы MAPI. Опять же пакет SDK для Windows содержит подробные сведения о создании приложений для Windows. В этом документе представлены, что вам нужно знать для реализации интерфейсов формы MAPI обязательные и дополнительные, чтобы они Следуйте правилам MAPI для взаимодействия с другими компонентами MAPI — в основном MAPI форме manager и клиентских приложениях системы обмена сообщениями.
  
Все интерфейсы, которые можно использовать при реализации формы серверы производные — прямо или косвенно, от OLE базового класса [IUnknown](http://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx). Это означает, что все реализации этих интерфейсов потребуется методы **QueryInterface**, **AddRef**и **Release** . Можно сэкономить много времени при использовании нескольких наследования для реализации необходимых интерфейсов в один новый класс собственным, таким образом, чтобы все интерфейсы, которые можно использовать могут совместно использовать одной реализации необходимые методы **IUnknown** . Для получения дополнительных сведений см методы [IUnknown::AddRef](http://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx), [IUnknown::QueryInterface](http://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)и [функции IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) . Существует не особые примечания относительно серверов формы MAPI для этих методов. 
  
Хотя не все интерфейсы формы MAPI, обязательные для всех серверов, формы, методы в любой данный интерфейс являются обязательными. То есть если вы решаете реализовать определенный интерфейс, необходимо реализовать все методы в интерфейсе. Это отличается от ситуации с другими компонентами MAPI, такие как транспорт сообщений. К счастью методы в интерфейсах формы MAPI относительно просты, поэтому реализация все из них не размещайте вызывает трудности на разработчиков.
  
Интерфейсы формы MAPI не зависят от типа средство разработки, используемые для создания сервера форм. Это позволяет формы, созданные с помощью средств разработки. Единственное требование заключается в том, что все серверы формы должен поддерживать необходимых интерфейсов формы MAPI.
  
Не все интерфейсы MAPI, имеющих отношение к формам необходимы все серверы формы. Необязательные интерфейсы позволяют реализовать некоторые расширенные формы функции, которые не требуются для большинство серверов формы. В следующей таблице перечислены интерфейсы, что это такое и ли их необходимо реализовать.
  
|**Интерфейс**|**Описание**|**Состояние**|
|:-----|:-----|:-----|
|[IMAPIForm : IUnknown](imapiformiunknown.md) <br/> |Основной интерфейс, используемый клиентами для загрузки формы серверов, выполнение команд формы и завершение работы серверов формы. Это интерфейс, производные от OLE **IUnknown** , используемый для оповещения других компонентов OLE относительно объекта формы реализует интерфейсы.  <br/> |Обязательный  <br/> |
|[IPersistMessage : IUnknown](ipersistmessageiunknown.md) <br/> |Используется при загрузке сообщений в и сохранение сообщения от объектам формы.  <br/> |Обязательный  <br/> |
|[IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) <br/> |Используемые объекты формы для отслеживания сообщений состояние клиента и чтобы узнать, совместимо ли объект формы может отображать следующий или предыдущий сообщения в папке.  <br/> |Optional  <br/> |
|[IClassFactory](http://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |OLE класс фабрики интерфейса, используемый вызывающим объекты формы в соответствии с механизм фабрики классов OLE.  <br/> |Обязательный  <br/> |
|[IMAPIFormFactory : IUnknown](imapiformfactoryiunknown.md) <br/> |Используется, если сервер формы поддерживает более одного типа формы. В этом случае интерфейс **IMAPIFormFactory** позволяет клиентским приложениям доступ к несколько интерфейсы **IClassFactory** (по одному для каждого типа формы, которая поддерживает сервер формы), что сервер формы также необходимо реализовать.  <br/> |Optional  <br/> |
   
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


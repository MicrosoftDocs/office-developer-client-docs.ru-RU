---
title: Написание кода сервера форм
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ff33badc-ceed-4364-b99c-8af3af83ceb6
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: a93e53261d56e452f38e38da427585cecccba405
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32325797"
---
# <a name="writing-form-server-code"></a>Написание кода сервера форм

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Сервер форм можно использовать в качестве следующего: 
  
- Программа Win32, которая отображает интерфейс и обрабатывает сообщения Windows с помощью стандартных механизмов контроля сообщений Windows.
    
- Объект, который регистрирует фабрику классов в OLE и активируется с помощью методов автоматизации OLE.
    
- Объект MAPI, который следует правилам MAPI для взаимодействия с другими компонентами MAPI.
    
 Код должен одновременно обрабатывать все три этих общих требования. 
  
Подробные сведения о регистрации фабрики классов сервера форм см. в разделе com и ActiveX Object Services в Windows SDK. Обработка сообщений Windows и отображение интерфейса — это стандартные методики программирования Windows, которые не предъявляют особых требований к формам MAPI. Опять же, Windows SDK имеет сведения о программировании для Windows. В этом документе содержатся сведения, необходимые для реализации необходимых и необязательных интерфейсов форм MAPI, чтобы они соблюдали правила MAPI для взаимодействия с другими компонентами MAPI , главным образом диспетчером форм MAPI и клиентских приложений для обмена сообщениями.
  
Все интерфейсы, которые можно использовать при реализации серверов форм, прямо или косвенно являются производными от базового класса OLE [IUnknown.](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) Это означает, что все ваши реализации этих интерфейсов должны иметь методы **QueryInterface,** **AddRef** и **Release.** Вы можете сэкономить много работы, если вы используете несколько наследования для реализации всех необходимых интерфейсов в одном новом классе, чтобы все интерфейсы, которые вы используете, могли использовать одну реализацию необходимых методов **IUnknown.** Дополнительные сведения см. в методах [IUnknown::AddRef,](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)и [IUnknown::Release.](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) Для этих методов нет особых соображений в отношении серверов форм MAPI. 
  
Хотя не все интерфейсы форм MAPI являются обязательными для всех серверов форм, методы в любом интерфейсе являются обязательными. То есть, если вы решили реализовать определенный интерфейс, необходимо реализовать все методы в интерфейсе. Это отличается от ситуации с некоторыми другими компонентами MAPI, такими как транспортировка сообщений. К счастью, методы в интерфейсах форм MAPI относительно просты, поэтому их реализация не ложится большой нагрузкой на разработчиков.
  
Интерфейсы форм MAPI не зависят от типа средства разработки, используемого для создания сервера форм. Это позволяет создавать формы с помощью различных средств разработки. Единственное требование — все серверы форм должны поддерживать необходимые интерфейсы форм MAPI.
  
Не все интерфейсы MAPI, которые связаны с формами, требуются всем серверам форм. Необязательные интерфейсы позволяют реализовать некоторые расширенные функции форм, которые не нужны большинству серверов форм. В следующей таблице перечислены интерфейсы, для чего они перечислены и необходимо ли их реализовать.
  
|**Интерфейс**|**Описание**|**Состояние**|
|:-----|:-----|:-----|
|[IMAPIForm : IUnknown](imapiformiunknown.md) <br/> |Основной интерфейс, который клиенты используют для загрузки серверов форм, выполнения глаголов форм и отключения серверов форм. Это также интерфейс, производный от OLE **IUnknown,** который используется для информирования других компонентов OLE о том, какие интерфейсы реализует объект формы.  <br/> |Обязательна  <br/> |
|[IPersistMessage : IUnknown](ipersistmessageiunknown.md) <br/> |Используется при загрузке и сохранении сообщений из объектов формы.  <br/> |Обязательна  <br/> |
|[IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md) <br/> |Используется объектами форм для отслеживания состояния клиента обмена сообщениями и для того, чтобы узнать, может ли объект формы отображать следующее или предыдущее сообщение в папке.  <br/> |Необязательна  <br/> |
|[IClassFactory](https://msdn.microsoft.com/library/f624f833-2b69-43bc-92cd-c4ecbe6051c5%28Office.15%29.aspx) <br/> |Интерфейс фабрики классов OLE, используемый объектами форм для обеспечения соответствия механизму фабрики классов OLE.  <br/> |Обязательна  <br/> |
|[IMAPIFormFactory : IUnknown](imapiformfactoryiunknown.md) <br/> |Используется, если сервер форм поддерживает несколько типов форм. В этом случае интерфейс **IMAPIFormFactory** позволяет клиентские приложениям получать доступ к нескольким интерфейсам **IClassFactory** (по одному на тип формы, поддерживаемой сервером форм), которые должен реализовать сервер форм.  <br/> |Необязательна  <br/> |
   
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


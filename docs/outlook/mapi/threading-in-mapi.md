---
title: Потоки в MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 259297d2-acd7-4bc5-9a77-0df92cbfa33e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: d9ee45ea7a3592a2b0fc0675bbdb6e640f9bd046
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22580392"
---
# <a name="threading-in-mapi"></a>Потоки в MAPI

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Поток — основные сущности, к которой операционная система выделяет время ЦП. Поток имеет свои регистрах, стека, приоритет и хранилища, но общий адрес места и обработки ресурсов таких как маркеры доступа. Объем памяти, также передать потоков с одним потоком прочтением записанные другим потоком.
  
MAPI клиенты используют следующие универсальные потоковой модели.
  
|**Потоковой модели**|**Описание**|
|:-----|:-----|
|Один потоковой модели  <br/> |Все объекты используются в одном потоке.  <br/> |
|Потоковой модели подразделения  <br/> |Объект можно использовать только в потоке, который он был создан.  <br/> |
|Модель свободной потоковой модели или поток сторонних производителей  <br/> |Объект можно использовать в любом потоке.  <br/> |
   
MAPI использует бесплатные потоковой модели вспомогательные объекты потоками, которые могут использоваться в любом потоке в любое время. OLE использует подразделения, потоковой модели. Модели потоков apartment поддерживает объекты, которые необходимо явно перенести при поток, отличный от, создавшее этот объект должен использовать этот объект.
  
Механизм, который OLE использует для передачи один поток объектов называется маршалинга. Маршалинга включает в себя заглушка объектов и прокси-сервера. Эти специальные объекты пакета параметров интерфейса в объекте маршалинга, передавать эти параметры в другой поток и распаковка их после прибытия. Конфликт между двумя моделями многопоточные возникает, когда объект MAPI без использования threading отправляется в другой процесс, с помощью OLE «lightweight» удаленного вызова процедур или LRPC. LRPC изменяет объект семантика свободной потоковой модели потоковое с помещение интерфейсы заглушку и прокси-сервера с apartment threading поведение между объектом и его вызывающего абонента. Сведения о ситуациях в MAPI, которые привести к конфликта может помочь клиентов и поставщиков услуг предотвратить возникновение проблем.
  
Объект MAPI может осуществляться:
  
- Через прямое обращение к ее методам, с помощью интерфейса указатель, возвращаемый поставщика услуг или MAPI по ссылке процесса клиента, такие как из [MAPILogonEx](mapilogonex.md)возвращенный объект сеанса.
    
- Через косвенных обращение к ее методам с помощью указатель интерфейса, возвращаются все поставщиком услуг, таких как объект папки копируются из другой папки в [IMAPIFolder::CopyFolder](imapifolder-copyfolder.md).
    
- Через функцию обратного вызова, таких как метод [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) , переданного для поставщика услуг или MAPI на вызов **уведомлений** или методы, которые можно отобразить индикатор выполнения длительной операции. 
    


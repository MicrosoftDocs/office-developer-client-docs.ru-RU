---
title: Наборы символов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: fbe63916-b3eb-4ea7-bc42-80a8b0281b03
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 898883d8c93b69762883a502b7a4313b3417d0d3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33417555"
---
# <a name="mapi-character-sets"></a>Наборы символов MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения и поставщики услуг, совместимые с MAPI, могут использовать символы ANSI (однобайтные) или символы Юникод (двойной byte). Наборы символов OEM не поддерживаются. Строка OEM, переданная методу или функции MAPI, приведет к сбой этого метода или функции. Клиентские приложения, которые работают с именами файлов в наборе символов OEM, должны быть осторожны, чтобы преобразовать их в ANSI перед передачей их в метод MAPI или функцию.
  
Поддержка набора символов Unicode необязательна как для клиентов, так и для поставщиков услуг. Все поставщики услуг должны написать свой код, чтобы они могли компилировать независимо от того, поддерживают ли они Юникод. Клиенты компиляторяются условно, в зависимости от уровня поддержки, но поставщики услуг этого не делают. При изменениях набора символов их не следует перекомпактовки. Ничто в коде поставщика услуг не должно быть условным. 
  
Когда клиенты или поставщики услуг, поддерживают Юникод, делают вызов метода, который включает строки символов в качестве параметров ввода или вывода, они задают MAPI_UNICODE флаг. Установка этого флага указывает на реализацию, что все входящие строки являются строками Unicode. На выходе задав этот флаг, все строки, переданные из реализации, должны быть строками Юникод, если это возможно. Реализутели метода, поддерживают Юникод, будут соответствовать запросу; Не соответствуют требованиям реализации методов, которые не предоставляют поддержку Юникод. Свойства строк, не в формате Unicode, имеют тип PT_STRING8.
  
MAPI определяет констант **fMapiUnicode** в файле MAPIDEFS заголовки. H для представления набора символов по умолчанию. Если клиент или поставщик услуг поддерживает Юникод, **fMapiUnicode** задает MAPI_UNICODE. Клиенты и поставщики услуг, которые не поддерживают набор Юникод **fMapiUnicode** до нуля. 
  
Поставщики услуг, которые не поддерживают Unicode, должны:
  
- Отказ от выполнения преобразований между наборами символов.
    
- Никогда не передай флаг MAPI_UNICODE при вызове метода.
    
- Возврат MAPI_E_BAD_CHARWIDTH при MAPI_UNICODE флага.
    
- Объявите свойства строки ANSI явно. 
    
Поставщики услуг также могут возвращать MAPI_E_BAD_CHARWIDTH, когда поддерживают только Юникод, а клиенты не передают MAPI_UNICODE флаг. 
  
 Текущая версия MAPI поддерживает Юникод в следующих методах: 
  
[IAddrBook::Address](iaddrbook-address.md)
  
[IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
  
[IAddrBook::Details](iaddrbook-details.md)
  
[IAddrBook::ResolveName](iaddrbook-resolvename.md)
  
[IMAPIProp::GetLastError](imapiprop-getlasterror.md) **(только реализация IAddrBook)** 
  
Для этих методов звонители могут ожидать, что любые возвращенные строки будут строками Юникод. Строки символов, возвращенные из реализации MAPI любого другого метода, будут строками символов ANSI.
  


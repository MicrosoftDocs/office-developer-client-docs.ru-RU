---
title: Наборы символов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: fbe63916-b3eb-4ea7-bc42-80a8b0281b03
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3f94823eb3f90ff9ac0f472a2de64e1904920d9c
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809714"
---
# <a name="mapi-character-sets"></a>Наборы символов MAPI

  
  
**Относится к**: Outlook 
  
MAPI-совместимое клиентских приложений и поставщиков услуг можно использовать символы ANSI (один байт) или знаки Юникода (два байта). Наборы символов ПВТ не поддерживаются. Строку OEM, переданной в метод MAPI или в функции, метода или функции могут быть. Клиентские приложения, которые работают с именами файлов в набор символов OEM необходимо следить за тем преобразовать их в формате ANSI перед передачей их в метод MAPI или функции.
  
Поддержка Юникода набор знаков является необязательным, как для клиентов и поставщиков услуг. Все поставщики услуг следует писать код, чтобы их можно компилировать вне зависимости от того, является ли они поддерживают Юникод. Клиенты компиляции, в зависимости от их уровень поддержки, но не поставщиков услуг. Они не должны быть перекомпилированы при изменения набор символов. Значение Nothing в коде поставщика службы должны быть условного. 
  
Если клиенты или поставщиков услуг, которые поддерживают Юникод сделать вызов метода, который включает в себя строки символ в качестве входных и выходных параметров, они параметр флаг MAPI_UNICODE. Установка этот флаг указывает реализации, что все входящие строки являются строк в кодировке Юникод. На выходных данных установка этот флаг запросов, всех строк, передаваемых резервного от реализации должны быть строк в кодировке Юникод, если это возможно. Метод специалистов по внедрению, которые поддерживают Юникод будет соответствовать запроса; не будет соответствовать специалистов по внедрению метода, которые не поддерживают Юникод. Строковые свойства, которые не являются в формате Юникод, типа PT_STRING8.
  
MAPI определяет константу **fMapiUnicode** в файле заголовка MAPIDEFS. H для представления набор знаков по умолчанию. Если клиент или служба поставщик поддерживает Юникод, **fMapiUnicode** имеет значение MAPI_UNICODE. Клиенты и поставщики услуг, которые не поддерживают Юникод задайте **fMapiUnicode** присваивается значение 0. 
  
Поставщики услуг, которые не поддерживают Юникод выполнить следующие действия:
  
- Отказ от выполнения преобразований между наборы символов.
    
- Никогда не передайте флаг MAPI_UNICODE вызовы методов.
    
- Возвращает MAPI_E_BAD_CHARWIDTH, когда флаг MAPI_UNICODE передается в.
    
- Явным образом объявите свойства строки ANSI. 
    
Поставщиков услуг может также возвращать MAPI_E_BAD_CHARWIDTH, когда они поддерживают только Юникод и клиенты не передавайте флаг MAPI_UNICODE. 
  
 Текущая версия MAPI поддерживает Юникод в следующих методов: 
  
[IAddrBook::Address](iaddrbook-address.md)
  
[IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
  
[IAddrBook::Details](iaddrbook-details.md)
  
[IAddrBook::ResolveName](iaddrbook-resolvename.md)
  
[IMAPIProp::GetLastError](imapiprop-getlasterror.md) (Только для реализации**IAddrBook** ) 
  
Для этих методов абонентов может предполагать любые возвращенные строки строки Юникод. Строк, возвращенных MAPI реализации любой другой метод будет строк символов ANSI.
  


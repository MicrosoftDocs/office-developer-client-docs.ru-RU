---
title: Наборы символов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: fbe63916-b3eb-4ea7-bc42-80a8b0281b03
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 898883d8c93b69762883a502b7a4313b3417d0d3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33417555"
---
# <a name="mapi-character-sets"></a>Наборы символов MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения и поставщики служб, совместимые с MAPI, могут использовать символы ANSI (одинбайт) или Юникод (двойной). Наборы символов OEM не поддерживаются. Строка OEM, переданная методу или функции MAPI, приведет к сбойу этого метода или функции. Клиентские приложения, которые работают с именами файлов в наборе символов OEM, должны с осторожностью преобразовывать их в ANSI перед их передачей методу или функции MAPI.
  
Поддержка набора символов Юникод не является обязательной как для клиентов, так и для поставщиков услуг. Все поставщики услуг должны написать свой код, чтобы они могли компилировать независимо от того, поддерживают ли они Юникод. Клиенты компилировать условно, в зависимости от их уровня поддержки, а поставщики услуг нет. При смене набора символов их не следует перекомпил использовать повторно. Ничего в коде поставщика услуг не должно быть условным. 
  
Когда клиенты или поставщики услуг, которые поддерживают Юникод, делают вызов метода, который включает строки символов в качестве входных или выходных параметров, они устанавливают MAPI_UNICODE флаг. Установка этого флага указывает реализации, что все входящие строки являются строками Юникода. В выходных данных установка этого флага запрашивает, чтобы все строки, переданные из реализации, по возможности были строками Юникода. Реализация методов, поддерживаюющих Юникод, будет соответствовать запросу; реализация методов, которые не обеспечивают поддержку Юникод, не будут соответствовать требованиям. Строки свойств, не в формате Юникод, имеют тип PT_STRING8.
  
MAPI определяет **константы fMapiUnicode** в файле header MAPIDEFS. H для представления набора символов по умолчанию. Если клиент или поставщик услуг поддерживает Юникод, **для fMapiUnicode** устанавливается MAPI_UNICODE. Клиенты и поставщики услуг, которые не поддерживают Юникод, задают **для fMapiUnicode** нулевое значение. 
  
Поставщики услуг, которые не поддерживают Юникод, должны:
  
- Отказаться от выполнения преобразований между наборами символов.
    
- Никогда не передавать флаг MAPI_UNICODE в вызовах метода.
    
- Возвращает MAPI_E_BAD_CHARWIDTH при MAPI_UNICODE флага.
    
- Явно объявите свойства строки ANSI. 
    
Поставщики услуг также могут возвращать MAPI_E_BAD_CHARWIDTH, если они поддерживают только Юникод, а клиенты не передают MAPI_UNICODE флаг. 
  
 Текущая версия MAPI поддерживает Юникод в следующих методах: 
  
[IAddrBook::Address](iaddrbook-address.md)
  
[IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
  
[IAddrBook::Details](iaddrbook-details.md)
  
[IAddrBook::ResolveName](iaddrbook-resolvename.md)
  
[IMAPIProp::GetLastError](imapiprop-getlasterror.md) ( только реализация **IAddrBook)** 
  
Для этих методов вызыватели могут ожидать, что любые возвращенные строки будут строками Юникода. Строки символов, возвращенные из реализации MAPI любого другого метода, будут строками символов ANSI.
  


---
title: Кодировки MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: fbe63916-b3eb-4ea7-bc42-80a8b0281b03
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 898883d8c93b69762883a502b7a4313b3417d0d3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33417555"
---
# <a name="mapi-character-sets"></a>Кодировки MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения и поставщики служб, совместимые с MAPI, могут использовать символы ANSI (один байт) или символы Юникода (двойной байт). Наборы символов OEM не поддерживаются. Строка OEM, переданная в метод или функцию MAPI, приведет к сбою этого метода или функции. Клиентские приложения, работающие с именами файлов в наборе символов OEM, должны быть осторожны при преобразовании в ANSI перед их передачей в метод или функцию MAPI.
  
Поддержка набора символов Юникода является необязательной как для клиентов, так и для поставщиков услуг. Все поставщики услуг должны написать свой код, чтобы они могли компилироваться независимо от того, поддерживают ли они Юникод. Клиенты компилируются условно, в зависимости от их уровня поддержки, но не имеют поставщиков услуг. Их не следует перекомпилировать при изменении набора символов. В коде поставщика услуг ничего не должно быть условное. 
  
Если клиенты или поставщики услуг, поддерживающие Юникод, выполняют вызов метода, включающий символьные строки в качестве входных или выходных параметров, устанавливается флаг МАПИ_УНИКОДЕ. Установка этого флага указывает на реализацию того, что все входящие строки являются строками в Юникоде. В выходных данных Установка этого флага требует, чтобы все строки, которые передаются обратно из реализации, были строками в Юникоде, если это возможно. Разработчики методов, поддерживающие Юникод, будут соответствовать запросу; методы реализации методов, которые не обеспечивают поддержку Юникода, не соответствуют требованиям. Строковые свойства, формат которых отличается от Юникода, имеют тип PT_STRING8.
  
MAPI определяет константу **фмапиуникоде** в файле заголовка MAPIDEFS. H для представления набора символов по умолчанию. Если клиент или поставщик услуг поддерживает Юникод, для **фмапиуникоде** задается значение мапи_уникоде. Клиенты и поставщики услуг, не поддерживающие Юникод Set **фмапиуникоде** , равны нулю. 
  
Поставщики услуг, не поддерживающие Юникод, должны:
  
- Отказ от выполнения преобразований между наборами символов.
    
- Никогда не передавайте флаг МАПИ_УНИКОДЕ в вызовах метода.
    
- Возвращает МАПИ_Е_БАД_ЧАРВИДС, когда передается флаг МАПИ_УНИКОДЕ.
    
- Явно объявите строковые свойства ANSI. 
    
Поставщики услуг также могут возвращать МАПИ_Е_БАД_ЧАРВИДС, если они поддерживают только Юникод и клиенты, не передающие флаг МАПИ_УНИКОДЕ. 
  
 Текущая версия MAPI поддерживает Юникод в следующих методах: 
  
[IAddrBook::Address](iaddrbook-address.md)
  
[IAddrBook::CreateOneOff](iaddrbook-createoneoff.md)
  
[IAddrBook::Details](iaddrbook-details.md)
  
[IAddrBook::ResolveName](iaddrbook-resolvename.md)
  
[IMAPIProp:: GetLastError](imapiprop-getlasterror.md) (Только реализация**IAddrBook** ) 
  
Для этих методов абоненты могут ожидать, что все возвращенные строки будут строками в Юникоде. Строки символов, возвращаемые реализациями MAPI любого другого метода, будут строками в КОДИРОВКе ANSI.
  


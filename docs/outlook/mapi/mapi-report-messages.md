---
title: Сообщения отчетов MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: aab5c76fb268729f1a50a33e4764905fe3d53405
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405767"
---
# <a name="mapi-report-messages"></a>Сообщения отчетов MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Сообщения отчетов представляют сведения о состоянии отправителя сообщения.
  
Существует два основных типа сообщений отчетов:
  
- Чтение отчетов о состоянии.
    
- Отчеты о состоянии доставки.
    
## <a name="read-status-reports"></a>Чтение отчетов о состоянии

Чтение отчетов о состоянии инициируется поставщиками хранилища сообщений с помощью вызова метода [имаписуппорт:: ReadReceipt](imapisupport-readreceipt.md) и отправляются получателю, представленному идентификатором записи в **пр_репорт_ентрид** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)). свойств. Прочитанные отчеты о состоянии не создаются автоматически; клиентские приложения, которые хотят получить их, должны явным образом запрашивать их.
  
Отчет о прочтении указывает на то, что установлен флаг чтения сообщения, который может произойти при открытии, печати, перемещении или копировании сообщения. Будет ли поставщик хранилища сообщений создавать отчет о прочтении в ответ на операцию перемещения или копирования, зависит от того, где находится сообщение. Если он перемещается или копируется в другое хранилище сообщений, отчет о прочтении, скорее всего, будет отправляться всегда. Если он перемещается или копируется в текущее хранилище сообщений, отчет о прочтении может быть отправлен или не отправлен. 
  
Отчет о непрочтении указывает на то, что не задан флаг чтения сообщения и сообщение не было открыто до его помещения в папку "Удаленные" или до истечения срока действия предельного времени. Клиенты могут вызывать метод [iMessage:: сетреадфлаг](imessage-setreadflag.md) или [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md) для установки или очистки флага чтения сообщения. 
  
## <a name="delivery-status-reports"></a>Отчеты о состоянии доставки

Состояние доставки отражается в отчете о доставке, который отправляется, когда сообщение достиг предполагаемого получателя, и в отчете о недоставке, который отправляется, когда сообщение не может быть доставлено получателю. Отчеты о состоянии доставки отправляются получателю, представленному идентификатором записи в свойстве **пр_репорт_ентрид** , или отправителю, если это свойство отсутствует. 
  
Отчеты о доСтавке отправляются только по запросу и не включают исходное сообщение. Отчеты о недоставке отправляются автоматически, если не был выполнен запрос для их подавления. Отчеты о недоставке содержат исходное сообщение в виде вложения, позволяющее получателю отчета повторно отправлять сообщение в случае, когда заблокированная доставка больше не является проблемой. Вложенное сообщение напоминает первоначальный момент, который существовал при вызове метода [iMessage:: субмитмессаже](imessage-submitmessage.md) для первоначальной отправки. 
  
Один или несколько отчетов о состоянии доставки создаются поставщиками транспорта при вызове метода [имаписуппорт:: статусреЦипс](imapisupport-statusrecips.md) . Поставщики транспорта составляют список получателей сообщения. Независимо от того, получает ли получатель отчет, и тип создаваемого отчета зависит от следующих условий: 
  
- Отчеты о доСтавке отправляются получателям, которые присвойте свойству **пр_оригинатор_деливери_репорт_рекуестед** ([PIDTAGORIGINATORDELIVERYREPORTREQUESTED](pidtagoriginatordeliveryreportrequested-canonical-property.md)) значение true, чтобы сообщение было включено в хранилище сообщений.
    
- Отчеты о недоставке отправляются получателям, для которых не было задано значение FALSE для свойства **пр_оригинатор_нон_деливери_репорт_рекуестед** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)). 
    
Практически все сведения, необходимые для отображения отчета о недоставке, хранятся в таблице получателей вложенного сообщения. Несколько свойств из самого отчета. Для отчетов о доставке необходимые сведения хранятся в таблице получателей отчета и в нескольких свойствах отчета. 
  
Отчеты — это сообщения с отдельными классами сообщений на основе класса отправленного сообщения. Большинство поставщиков служб используют соглашение об именовании, в результате чего класс сообщения состоит из нескольких частей, разделенных точками. Первая часть — "Report", а Последняя — константа, представляющая тип отчета. Средняя часть зарезервирована для класса отправленного сообщения. Например, в отчете о доставке используется константа DR, класс Message для отчета о доставке IPM. Обратите внимание, что сообщение будет иметь вид **Report. IPM. Note. Dr**.
  
В следующей таблице показаны константы, представляющие типы отчетов.
  
|**Тип отчета**|**Константа, используемая в классе Message**|
|:-----|:-----|
|Чтение  <br/> |ИПНРН  <br/> |
|Отчетов непрочтении  <br/> |ИПННРН  <br/> |
|Delivery  <br/> |КОМАНДЕ  <br/> |
|Получили  <br/> |ОТЧЕТ О НЕДОСТАВКЕ  <br/> |
   
Интерактивные клиенты могут отображать сообщения отчетов с помощью стандартных форм, предоставляемых MAPI, или настраиваемых форм, зарегистрированных с помощью диспетчера форм для класса сообщений отчета. Клиенты, которые получают отчет о недоставке для IPM. Примечание. Например, можно отобразить стандартную форму MAPI, которая представляет список неудачных получателей, и предлагаемую причину сбоя. Форма также позволяет пользователю повторно отправить сообщение, если это необходимо. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


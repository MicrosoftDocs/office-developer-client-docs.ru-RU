---
title: Сообщения отчета MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: aab5c76fb268729f1a50a33e4764905fe3d53405
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405767"
---
# <a name="mapi-report-messages"></a><span data-ttu-id="f4f4e-103">Сообщения отчета MAPI</span><span class="sxs-lookup"><span data-stu-id="f4f4e-103">MAPI Report Messages</span></span>

  
  
<span data-ttu-id="f4f4e-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="f4f4e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="f4f4e-105">Сообщения отчетов представляют сведения о состоянии сообщения отправителю.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-105">Report messages present status information about a message to its sender.</span></span>
  
<span data-ttu-id="f4f4e-106">Существует два общих типа сообщений отчетов:</span><span class="sxs-lookup"><span data-stu-id="f4f4e-106">There are two general types of report messages:</span></span>
  
- <span data-ttu-id="f4f4e-107">Чтение отчетов о состоянии.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-107">Read status reports.</span></span>
    
- <span data-ttu-id="f4f4e-108">Отчеты о состоянии доставки.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-108">Delivery status reports.</span></span>
    
## <a name="read-status-reports"></a><span data-ttu-id="f4f4e-109">Чтение отчетов о состоянии</span><span class="sxs-lookup"><span data-stu-id="f4f4e-109">Read Status Reports</span></span>

<span data-ttu-id="f4f4e-110">Отчеты о состоянии чтения инициатуются поставщиками хранения сообщений с помощью вызова метода [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) и отправляются получателю, представленного идентификатором записи в свойстве **PR_REPORT_ENTRYID** ([PidTagReportEntryId).](pidtagreportentryid-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="f4f4e-110">Read status reports are initiated by message store providers through a call to the [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) method and are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) property.</span></span> <span data-ttu-id="f4f4e-111">Отчеты о состоянии чтения не создаются автоматически; клиентские приложения, которые хотят их получить, должны явно запросить их.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-111">Read status reports are not generated automatically; client applications that want to receive them must explicitly request them.</span></span>
  
<span data-ttu-id="f4f4e-112">Отчет о прочтение указывает, что флаг чтения сообщения установлен, что может произойти при его открытие, печати, перемещении или копировании.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-112">A read report indicates that the read flag of a message has been set, which can occur when the message is opened, printed, moved, or copied.</span></span> <span data-ttu-id="f4f4e-113">То, создает ли поставщик сообщения отчет о прочтях в ответ на операцию перемещения или копирования, зависит от того, куда идет сообщение.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-113">Whether or not a message store provider generates a read report in response to a move or copy operation depends on where the message is going.</span></span> <span data-ttu-id="f4f4e-114">Если он перемещается или копируется в другое хранилище сообщений, скорее всего, всегда будет отправлен отчет о прочтовке.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-114">If it is being moved or copied to another message store, a read report will most likely always be sent.</span></span> <span data-ttu-id="f4f4e-115">Если он перемещается или копируется в текущем хранилище сообщений, отчет о прочтях может быть отправлен или не отправлен.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-115">If it is being moved or copied in the current message store, a read report might or might not be sent.</span></span> 
  
<span data-ttu-id="f4f4e-116">Отчет о непрочитанности указывает, что флаг чтения сообщения не установлен и что сообщение не было открыто ни до того, как помещено в папку "Удаленные", ни до истечения срока действия.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-116">A nonread report indicates that the read flag of a message is not set and that the message was not opened either before being placed in the Deleted Items folder or before the expiration of a time limit.</span></span> <span data-ttu-id="f4f4e-117">Клиенты могут вызывать метод [IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags,](imapifolder-setreadflags.md) чтобы установить или очистить флаг чтения сообщения.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-117">Clients can call the [IMessage::SetReadFlag](imessage-setreadflag.md) or [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) method to set or clear a message's read flag.</span></span> 
  
## <a name="delivery-status-reports"></a><span data-ttu-id="f4f4e-118">Отчеты о состоянии доставки</span><span class="sxs-lookup"><span data-stu-id="f4f4e-118">Delivery Status Reports</span></span>

<span data-ttu-id="f4f4e-119">Состояние доставки отражается в отчете о доставке, который отправляется, когда сообщение достигло своего получателя, и в отчете о ненастройстве, который отправляется, когда сообщение не может связаться с получателем.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-119">Delivery status is reflected in a delivery report, which is sent when a message has reached its intended recipient, and in a nondelivery report, which is sent when a message could not reach a recipient.</span></span> <span data-ttu-id="f4f4e-120">Отчеты о состоянии доставки отправляются получателю, представленного  идентификатором записи в свойстве PR_REPORT_ENTRYID, или отправителю, если этого свойства нет.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-120">Delivery status reports are sent to the recipient represented by the entry identifier in the **PR_REPORT_ENTRYID** property or to the sender if this property is not present.</span></span> 
  
<span data-ttu-id="f4f4e-121">Отчеты о доставке отправляются только по запросу и не включают исходное сообщение.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-121">Delivery reports are sent by request only and do not include the original message.</span></span> <span data-ttu-id="f4f4e-122">Отчеты о недостройных сообщениях отправляются автоматически, если не сделан запрос на их подавление.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-122">Nondelivery reports are sent automatically unless a request is made to suppress them.</span></span> <span data-ttu-id="f4f4e-123">Отчеты о ненастроенном виде включают исходное сообщение в виде вложения, чтобы получатель отчета мог повторно отправить сообщение, если все заблокированные сообщения больше не являются проблемой.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-123">Nondelivery reports include the original message as an attachment to enable the report's recipient to resend the message in case whatever blocked the delivery is no longer a problem.</span></span> <span data-ttu-id="f4f4e-124">Вложенное сообщение напоминает исходный текст, который существовал при первоначальном запросе метода [IMessage::SubmitMessage.](imessage-submitmessage.md)</span><span class="sxs-lookup"><span data-stu-id="f4f4e-124">The attached message resembles the original as it existed when the [IMessage::SubmitMessage](imessage-submitmessage.md) method was called to send it initially.</span></span> 
  
<span data-ttu-id="f4f4e-125">Один или несколько отчетов о состоянии доставки создаются поставщиками транспорта при вызове метода [IMAPISupport::StatusRecips.](imapisupport-statusrecips.md)</span><span class="sxs-lookup"><span data-stu-id="f4f4e-125">One or more delivery status reports are generated by transport providers when they call the [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) method.</span></span> <span data-ttu-id="f4f4e-126">Поставщики транспорта составляют список получателей сообщения.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-126">Transport providers compose a list of recipients for a message.</span></span> <span data-ttu-id="f4f4e-127">Независимо от того, получает ли получатель отчет и какой тип отчета создается, зависит от следующего:</span><span class="sxs-lookup"><span data-stu-id="f4f4e-127">Whether or not a recipient receives a report and the type of report that is generated depends on the following:</span></span> 
  
- <span data-ttu-id="f4f4e-128">Отчеты о доставке адресоваются получателям, для свойства **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** [(PidTagOriginatorDeliveryReportRequested)](pidtagoriginatordeliveryreportrequested-canonical-property.md)перед тем, как сообщение было помещено в хранилище сообщений.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-128">Delivery reports go to recipients that set the **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) property to TRUE before the message was placed in the message store.</span></span>
    
- <span data-ttu-id="f4f4e-129">Отчеты о ненадстройсти перейти к получателям, которые не установили для свойства **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested)](pidtagoriginatornondeliveryreportrequested-canonical-property.md)свойство FALSE.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-129">Nondelivery reports go to recipients that did not set the **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) property to FALSE.</span></span> 
    
<span data-ttu-id="f4f4e-130">Почти вся информация, необходимая для отображения отчета о ненастройстве, содержится в таблице получателей вложенного сообщения.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-130">Almost all of the information necessary to display a nondelivery report is contained in the recipient table of the attached message.</span></span> <span data-ttu-id="f4f4e-131">Несколько свойств из самого отчета.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-131">A few properties are from the report itself.</span></span> <span data-ttu-id="f4f4e-132">Для отчетов о доставке необходимые сведения содержатся в таблице получателей отчета и нескольких свойствах отчета.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-132">For delivery reports, the necessary information is contained in the recipient table of the report and in a few report properties.</span></span> 
  
<span data-ttu-id="f4f4e-133">Отчеты — это сообщения с различными классами сообщений, основанными на классе отправленного сообщения.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-133">Reports are messages with distinct message classes, based on the class of the sent message.</span></span> <span data-ttu-id="f4f4e-134">Большинство поставщиков услуг используют соглашение об именах, в котором класс сообщения состоит из нескольких частей, разделенных по точкам.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-134">Most service providers use a naming convention whereby the message class is composed of several parts separated by periods.</span></span> <span data-ttu-id="f4f4e-135">Первая часть — "Отчет", а последняя — константа, представляюная тип отчета.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-135">The first part is "Report" and the last part is a constant that represents the report type.</span></span> <span data-ttu-id="f4f4e-136">Средняя часть зарезервирована для класса отправленного сообщения.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-136">The middle part is reserved for the class of the sent message.</span></span> <span data-ttu-id="f4f4e-137">Например, так как отчет о доставке использует константу DR, класс сообщения для отчета о доставке об IPM. Примечание. Сообщение должно быть **Report.IPM.Note.DR**.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-137">For example, because a delivery report uses the constant DR, the message class for a delivery report about an IPM.Note message would be **Report.IPM.Note.DR**.</span></span>
  
<span data-ttu-id="f4f4e-138">В следующей таблице показаны константы, которые представляют типы отчетов.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-138">The following table shows the constants that represent the types of reports.</span></span>
  
|<span data-ttu-id="f4f4e-139">**Тип отчета**</span><span class="sxs-lookup"><span data-stu-id="f4f4e-139">**Report type**</span></span>|<span data-ttu-id="f4f4e-140">**Константа, используемая в классе сообщений**</span><span class="sxs-lookup"><span data-stu-id="f4f4e-140">**Constant used in message class**</span></span>|
|:-----|:-----|
|<span data-ttu-id="f4f4e-141">Чтение</span><span class="sxs-lookup"><span data-stu-id="f4f4e-141">Read</span></span>  <br/> |<span data-ttu-id="f4f4e-142">IPNRN</span><span class="sxs-lookup"><span data-stu-id="f4f4e-142">IPNRN</span></span>  <br/> |
|<span data-ttu-id="f4f4e-143">Непрочитанные</span><span class="sxs-lookup"><span data-stu-id="f4f4e-143">Nonread</span></span>  <br/> |<span data-ttu-id="f4f4e-144">IPNNRN</span><span class="sxs-lookup"><span data-stu-id="f4f4e-144">IPNNRN</span></span>  <br/> |
|<span data-ttu-id="f4f4e-145">Delivery</span><span class="sxs-lookup"><span data-stu-id="f4f4e-145">Delivery</span></span>  <br/> |<span data-ttu-id="f4f4e-146">DR</span><span class="sxs-lookup"><span data-stu-id="f4f4e-146">DR</span></span>  <br/> |
|<span data-ttu-id="f4f4e-147">Ненастройность</span><span class="sxs-lookup"><span data-stu-id="f4f4e-147">Nondelivery</span></span>  <br/> |<span data-ttu-id="f4f4e-148">NDR</span><span class="sxs-lookup"><span data-stu-id="f4f4e-148">NDR</span></span>  <br/> |
   
<span data-ttu-id="f4f4e-149">Интерактивные клиенты могут отображать сообщения отчетов с помощью стандартных форм, предоставляемых MAPI, или настраиваемые формы, зарегистрированные в диспетчере форм для класса сообщений отчета.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-149">Interactive clients can display report messages by using standard forms provided by MAPI, or custom forms that have been registered with the form manager for the report's message class.</span></span> <span data-ttu-id="f4f4e-150">Клиенты, которые получают отчет о ненастройстве для IPM. Например, в сообщении заметки может отображаться стандартная форма MAPI, в которой представлен список получателей с ошибками и предложенная причина сбоя.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-150">Clients that receive a nondelivery report for an IPM.Note message, for example, can display the standard MAPI form that presents a list of the failed recipients and a suggested reason for the failure.</span></span> <span data-ttu-id="f4f4e-151">Форма также позволяет пользователю повторно отправить сообщение при желании.</span><span class="sxs-lookup"><span data-stu-id="f4f4e-151">The form also enables the user to resend the message, if desired.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="f4f4e-152">См. также</span><span class="sxs-lookup"><span data-stu-id="f4f4e-152">See also</span></span>



[<span data-ttu-id="f4f4e-153">Сообщения MAPI</span><span class="sxs-lookup"><span data-stu-id="f4f4e-153">MAPI Messages</span></span>](mapi-messages.md)


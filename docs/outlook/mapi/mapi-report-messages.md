---
title: Сообщения отчета MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: aab5c76fb268729f1a50a33e4764905fe3d53405
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405767"
---
# <a name="mapi-report-messages"></a>Сообщения отчета MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Сообщения отчетов представляют сведения о состоянии сообщения отправителю.
  
Существует два общих типа сообщений отчетов:
  
- Чтение отчетов о состоянии.
    
- Отчеты о состоянии доставки.
    
## <a name="read-status-reports"></a>Чтение отчетов о состоянии

Отчеты о состоянии чтения инициатуются поставщиками хранения сообщений с помощью вызова метода [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) и отправляются получателю, представленного идентификатором записи в свойстве **PR_REPORT_ENTRYID** ([PidTagReportEntryId).](pidtagreportentryid-canonical-property.md) Отчеты о состоянии чтения не создаются автоматически; клиентские приложения, которые хотят их получить, должны явно запросить их.
  
Отчет о прочтение указывает, что флаг чтения сообщения установлен, что может произойти при его открытие, печати, перемещении или копировании. То, создает ли поставщик сообщения отчет о прочтях в ответ на операцию перемещения или копирования, зависит от того, куда идет сообщение. Если он перемещается или копируется в другое хранилище сообщений, скорее всего, всегда будет отправлен отчет о прочтовке. Если он перемещается или копируется в текущем хранилище сообщений, отчет о прочтях может быть отправлен или не отправлен. 
  
Отчет о непрочитанности указывает, что флаг чтения сообщения не установлен и что сообщение не было открыто ни до того, как помещено в папку "Удаленные", ни до истечения срока действия. Клиенты могут вызывать метод [IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags,](imapifolder-setreadflags.md) чтобы установить или очистить флаг чтения сообщения. 
  
## <a name="delivery-status-reports"></a>Отчеты о состоянии доставки

Состояние доставки отражается в отчете о доставке, который отправляется, когда сообщение достигло своего получателя, и в отчете о ненастройстве, который отправляется, когда сообщение не может связаться с получателем. Отчеты о состоянии доставки отправляются получателю, представленного  идентификатором записи в свойстве PR_REPORT_ENTRYID, или отправителю, если этого свойства нет. 
  
Отчеты о доставке отправляются только по запросу и не включают исходное сообщение. Отчеты о недостройных сообщениях отправляются автоматически, если не сделан запрос на их подавление. Отчеты о ненастроенном виде включают исходное сообщение в виде вложения, чтобы получатель отчета мог повторно отправить сообщение, если все заблокированные сообщения больше не являются проблемой. Вложенное сообщение напоминает исходный текст, который существовал при первоначальном запросе метода [IMessage::SubmitMessage.](imessage-submitmessage.md) 
  
Один или несколько отчетов о состоянии доставки создаются поставщиками транспорта при вызове метода [IMAPISupport::StatusRecips.](imapisupport-statusrecips.md) Поставщики транспорта составляют список получателей сообщения. Независимо от того, получает ли получатель отчет и какой тип отчета создается, зависит от следующего: 
  
- Отчеты о доставке адресоваются получателям, для свойства **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** [(PidTagOriginatorDeliveryReportRequested)](pidtagoriginatordeliveryreportrequested-canonical-property.md)перед тем, как сообщение было помещено в хранилище сообщений.
    
- Отчеты о ненадстройсти перейти к получателям, которые не установили для свойства **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested)](pidtagoriginatornondeliveryreportrequested-canonical-property.md)свойство FALSE. 
    
Почти вся информация, необходимая для отображения отчета о ненастройстве, содержится в таблице получателей вложенного сообщения. Несколько свойств из самого отчета. Для отчетов о доставке необходимые сведения содержатся в таблице получателей отчета и нескольких свойствах отчета. 
  
Отчеты — это сообщения с различными классами сообщений, основанными на классе отправленного сообщения. Большинство поставщиков услуг используют соглашение об именах, в котором класс сообщения состоит из нескольких частей, разделенных по точкам. Первая часть — "Отчет", а последняя — константа, представляюная тип отчета. Средняя часть зарезервирована для класса отправленного сообщения. Например, так как отчет о доставке использует константу DR, класс сообщения для отчета о доставке об IPM. Примечание. Сообщение должно быть **Report.IPM.Note.DR**.
  
В следующей таблице показаны константы, которые представляют типы отчетов.
  
|**Тип отчета**|**Константа, используемая в классе сообщений**|
|:-----|:-----|
|Чтение  <br/> |IPNRN  <br/> |
|Непрочитанные  <br/> |IPNNRN  <br/> |
|Delivery  <br/> |DR  <br/> |
|Ненастройность  <br/> |NDR  <br/> |
   
Интерактивные клиенты могут отображать сообщения отчетов с помощью стандартных форм, предоставляемых MAPI, или настраиваемые формы, зарегистрированные в диспетчере форм для класса сообщений отчета. Клиенты, которые получают отчет о ненастройстве для IPM. Например, в сообщении заметки может отображаться стандартная форма MAPI, в которой представлен список получателей с ошибками и предложенная причина сбоя. Форма также позволяет пользователю повторно отправить сообщение при желании. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


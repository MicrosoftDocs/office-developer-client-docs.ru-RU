---
title: Сообщения отчета MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: addf93cadae418017a40ba448328d2e1fc1decf6
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809815"
---
# <a name="mapi-report-messages"></a>Сообщения отчета MAPI

  
  
**Относится к**: Outlook 
  
О сообщениях присутствует информация о состоянии сообщение его отправителю.
  
Существует два типа сообщения отчета.
  
- Ознакомьтесь с отчетами о состоянии.
    
- Отчеты о состоянии доставки.
    
## <a name="read-status-reports"></a>Прочитайте отчеты о состоянии

Отчеты о состоянии чтения инициированных поставщиков хранилища сообщений путем вызова метода [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) и отправлено получателю, представленное идентификатор записи в **PR_REPORT_ENTRYID** ([PidTagReportEntryId](pidtagreportentryid-canonical-property.md)) свойство. Отчеты о состоянии чтения не создаются автоматически. клиентские приложения, чтобы получать их необходимо явно запросить их.
  
Чтение отчета указывает, что чтения флаг сообщение имеет значение, которая может возникнуть при сообщение открывается, при выводе на печать, перемещения или копирования. Ли поставщик хранения сообщений создает просмотра отчета в ответ на перемещение или операции копирования зависит от того, где будет сообщение. Если это отправить всегда копируются в другом хранилище сообщений, скорее всего, будет чтения отчета или перемещаемой. Если он перемещения или копирования в хранилище текущего сообщения чтения отчета может или не может быть отправлено. 
  
Nonread отчет указывает, что чтения флаг сообщения не установлен и, что сообщение не было открыто до помещения в папку «Удаленные» или до окончания срока действия для ограничения времени. Клиенты могут вызывать метод [IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags](imapifolder-setreadflags.md) , чтобы установить или сбросить флаг чтения сообщения. 
  
## <a name="delivery-status-reports"></a>Отчеты о состоянии доставки

Состояние доставки отражается в отчете доставки сообщения при достижении его получателю сообщения, и в отчете о недоставке, который отправляется, когда сообщение не может получить доступ получателя. Если это свойство не указан, отчеты о состоянии доставки отправляются получателю, представленное идентификатор записи в свойстве **PR_REPORT_ENTRYID** или отправителю. 
  
Отчеты о доставке отправленных только запроса и не включать исходное сообщение. Отчет о недоставке, передаются автоматически в том случае, если запрос не отображать их. Отчет о недоставке включать исходное сообщение как вложение для включения получателя отчета отправить сообщение в случае независимо от существующих заблокированных доставки больше не проблема. Вложенное сообщение имеет следующий вид исходной, которая существовала при вызове метода [IMessage::SubmitMessage](imessage-submitmessage.md) для отправки изначально. 
  
Один или несколько отчетов о состоянии доставки создаются поставщиками транспорта, когда он совершает вызов метода [IMAPISupport::StatusRecips](imapisupport-statusrecips.md) . Поставщики транспорта создания списка получателей сообщения. Получает ли получателя отчета и типа отчета, который генерируется зависит от следующих: 
  
- Отчеты о доставке перейдите к разделу получатели, которые **PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorDeliveryReportRequested](pidtagoriginatordeliveryreportrequested-canonical-property.md)) свойству присвоено значение TRUE, перед сообщение было помещено в хранилище сообщений.
    
- Отчет о недоставке перейдите к разделу получатели, которые не удалось задать свойство **PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED** ([PidTagOriginatorNonDeliveryReportRequested](pidtagoriginatornondeliveryreportrequested-canonical-property.md)) значение FALSE. 
    
Почти все сведения, необходимые для отображения о недоставке содержится в таблице получателей вложенное сообщение. Несколько свойств: от самого отчета. Для отчетов о доставке необходимой информации содержится в таблице получателя отчета и несколько свойств отчета. 
  
Отчеты — это сообщения с классами отдельное сообщение, на основе класса отправляемого сообщения. Большинство поставщиков услуг использовать соглашение об именовании, при котором класс сообщения состоит из нескольких частей, разделенных точками. Первая часть является «Отчет» и последнюю часть — это константа, представляющий тип отчета. Средней части зарезервирован для класса отправленных сообщений. Например так как отчетов о доставке использует постоянное аварийного восстановления, класс сообщения для доставки отчета о IPM. Примечание сообщение будет **Report.IPM.Note.DR**.
  
В следующей таблице показаны константы, которые представляют типы отчетов.
  
|**Тип отчета**|**Константа, используемая в класс сообщения**|
|:-----|:-----|
|Чтение  <br/> |IPNRN  <br/> |
|Nonread  <br/> |IPNNRN  <br/> |
|Доставки  <br/> |АВАРИЙНОЕ ВОССТАНОВЛЕНИЕ  <br/> |
|Недоставке  <br/> |Отчет о недоставке  <br/> |
   
Интерактивные клиенты могут отображаться сообщения отчета с помощью стандартных форм, предоставляемые MAPI или настраиваемых форм, которые были зарегистрированы с помощью диспетчера формы для класса сообщения отчета. Клиенты, которые получают уведомление о недоставке для IPM. Сообщение заметки, например можно отобразить стандартной формы MAPI, который представляет список неудачных получателей и предложенного причину сбоя. Форма также позволяет пользователю повторно отправить сообщения, при желании. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


---
title: Сообщения отчетов MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 824eb670-16b7-49bf-9992-39fe0586a552
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: aab5c76fb268729f1a50a33e4764905fe3d53405
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405767"
---
# <a name="mapi-report-messages"></a>Сообщения отчетов MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
В сообщениях отчетов представлены сведения о состоянии сообщения отправителю.
  
Существует два общих типа сообщений отчетов:
  
- Чтение отчетов о состоянии.
    
- Отчеты о состоянии доставки.
    
## <a name="read-status-reports"></a>Чтение отчетов о состоянии

Отчеты о состоянии чтения инициировали поставщики магазина сообщений с помощью вызова метода [IMAPISupport::ReadReceipt](imapisupport-readreceipt.md) и отправляются получателю, представленного идентификатором записи в **свойстве PR_REPORT_ENTRYID** [(PidTagReportEntryId).](pidtagreportentryid-canonical-property.md) Отчеты о состоянии чтения не создаются автоматически; клиентские приложения, которые хотят их получить, должны явно запрашивать их.
  
В отчете о прочтение указывается, что задарен флаг чтения сообщения, который может возникать при открываемом, напечатании, перемещении или копировании сообщения. Независимо от того, создает ли поставщик магазина сообщений отчет о считывке в ответ на операцию перемещения или копирования, зависит от того, куда идет сообщение. Если он перемещается или копируется в другой магазин сообщений, скорее всего, всегда будет отправлен отчет о прочте. Если он перемещается или копируется в текущем хранилище сообщений, отчет о считывке может быть отправлен или не отправлен. 
  
В непрочитаемом отчете указывается, что флаг чтения сообщения не установлен и что сообщение не было открыто ни до его помещания в папку "Удаленные элементы", ни до истечения срока действия срока. Клиенты могут вызвать [метод IMessage::SetReadFlag](imessage-setreadflag.md) или [IMAPIFolder::SetReadFlags,](imapifolder-setreadflags.md) чтобы установить или очистить флаг чтения сообщения. 
  
## <a name="delivery-status-reports"></a>Отчеты о состоянии доставки

Состояние доставки отражается в отчете о доставке, который отправляется при достижении получателем сообщения, а также в отчете о неделивстве, который отправляется, когда сообщение не может достичь получателя. Отчеты о состоянии доставки отправляются получателю, представленного  идентификатором записи в свойстве PR_REPORT_ENTRYID или отправителю, если этого свойства нет. 
  
Отчеты о доставке отправляются только по запросу и не включают исходное сообщение. Отчеты о недоделастии отправляются автоматически, если не будет выполнен запрос на их подавление. Отчеты о неделивности включают исходное сообщение в виде вложения, чтобы получатель отчета мог повторно отправлять сообщение в случае, если все, что блокирует доставку, больше не является проблемой. Присоединенное сообщение напоминает оригинал, как оно существовало, когда был вызван метод [IMessage::SubmitMessage,](imessage-submitmessage.md) чтобы отправить его изначально. 
  
Один или несколько отчетов о состоянии доставки создаются поставщиками транспорта при вызове метода [IMAPISupport::StatusRecips.](imapisupport-statusrecips.md) Поставщики транспорта составляют список получателей для сообщения. Получает ли получатель отчет или нет, а тип сгенерированного отчета зависит от следующих: 
  
- Отчеты о доставке перейти к **получателям,** задавамым свойство [PR_ORIGINATOR_DELIVERY_REPORT_REQUESTED (PidTagOriginatorDeliveryReportReportRequested)](pidtagoriginatordeliveryreportrequested-canonical-property.md)для TRUE перед тем, как сообщение было помещено в хранилище сообщений.
    
- Отчеты о несделательности идут к получателям, которые не задают **свойству FALSE** PR_ORIGINATOR_NON_DELIVERY_REPORT_REQUESTED [(PidTagOriginatorNonDeliveryReportReportRequested).](pidtagoriginatornondeliveryreportrequested-canonical-property.md) 
    
Почти вся информация, необходимая для отображения отчета о неделивстве, содержится в таблице получателей прикрепленного сообщения. Несколько свойств из самого отчета. Для отчетов о доставке необходимая информация содержится в таблице получателей отчета и в нескольких свойствах отчета. 
  
Отчеты — это сообщения с отдельными классами сообщений, основанными на классе отправленного сообщения. Большинство поставщиков услуг используют конвенцию именования, в которой класс сообщений состоит из нескольких частей, разделенных периодами. Первая часть — "Report", а последняя — константа, представляюная тип отчета. Средняя часть зарезервирована для класса отправленного сообщения. Например, так как в отчете о доставке используется постоянный DR, класс сообщений для отчета о доставке об IPM. Примечание сообщение будет **Report.IPM.Note.DR**.
  
В следующей таблице показаны константы, которые представляют типы отчетов.
  
|**Тип отчета**|**Константа, используемая в классе сообщений**|
|:-----|:-----|
|Чтение  <br/> |IPNRN  <br/> |
|Непрочитанные  <br/> |IPNNRN  <br/> |
|Delivery  <br/> |DR  <br/> |
|Nondelivery  <br/> |NDR  <br/> |
   
Интерактивные клиенты могут отображать сообщения отчетов с помощью стандартных форм, предоставляемых MAPI, или пользовательских форм, зарегистрированных в диспетчере форм для класса сообщений отчета. Клиенты, которые получают отчет о неделивстве для IPM. Например, в сообщении примечание может отображаться стандартная форма MAPI, в которой представлен список сбоя получателей и предложенная причина сбоя. Форма также позволяет пользователю при желании повторно отправлять сообщение. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


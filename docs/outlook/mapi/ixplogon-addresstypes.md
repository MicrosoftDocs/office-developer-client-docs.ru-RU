---
title: Иксплогонаддресстипес
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.AddressTypes
api_type:
- COM
ms.assetid: 5add1f2b-d9e6-4d78-8739-c3848f6e32a3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ca68c604152a7a28fb6a5357aa9c012ec7466b5a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435378"
---
# <a name="ixplogonaddresstypes"></a>IXPLogon::AddressTypes

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Возвращает типы получателей, которые обрабатывает поставщик транспорта.
  
```cpp
HRESULT AddressTypes(
  ULONG FAR * lpulFlags,
  ULONG FAR * lpcAdrType,
  LPSTR FAR * FAR * lpppszAdrTypeArray,
  ULONG FAR * lpcMAPIUID,
  LPUID FAR * FAR * lpppUIDArray
);
```

## <a name="parameters"></a>Параметры

 _Лпулфлагс_
  
> вышли Битовая маска флагов, определяющих тип возвращаемых строк. Можно задать следующий флаг:
    
MAPI_UNICODE 
  
> Возвращаемые строки представлены в формате Юникод. Если флаг МАПИ_УНИКОДЕ не установлен, строки представлены в формате ANSI.
    
 _Лпкадртипе_
  
> вышли Указатель на число записей в массиве, на которое указывает параметр _лпппсзадртипеаррай_ . 
    
 _Лпппсзадртипеаррай_
  
> вышли Указатель на указатель на массив строк, который определяет типы получателей.
    
 _Лпкмапиуид_
  
> вышли Указатель на число записей в массиве, на которое указывает параметр _лпппуидаррай_ . 
    
 _Лпппуидаррай_
  
> вышли Указатель на указатель на массив указателей на структуры [мапиуид](mapiuid.md) , которые определяют типы получателей. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Поставщик транспорта успешно указал типы получателей, которые он может обработать.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Диспетчер очереди MAPI вызывает метод **иксплогон:: аддресстипес** сразу после того, как поставщик транспорта возвращает вызов метода [Иксппровидер:: транспортлогон](ixpprovider-transportlogon.md) , чтобы поставщик транспорта мог указать, какие типы получателей он обрабатывает. Чтобы обозначить это, поставщик транспорта должен передать параметру _лпппсзадртипеаррай_ указатель на массив указателей на строки или передать обратно в параметре _лпппуидаррай_ указатель на массив указателей на **мапиуид** структуры или передавать значения в обоих параметрах. 
  
Эти два массива используются для различных процессов идентификации. MAPI и Диспетчер очереди MAPI используют структуры [мапиуид](mapiuid.md) в массиве _лпппуидаррай_ , чтобы определить идентификаторы записей получателей, которые непосредственно обрабатываются поставщиком транспорта или системой обмена сообщениями, к которой подключается поставщик транспорта. . Ни MAPI, ни Диспетчер очереди MAPI не разворачивает адреса с помощью идентификаторов записей, которые хранятся в любой из этих структур **мапиуид** ; Эти структуры используются только для идентификации типа получателя. 
  
При выборе поставщика транспорта, который должен обрабатывать получателей исходящих сообщений, диспетчер очереди MAPI использует каждую строку параметра _лпппсзадртипеаррай_ для проверки сравнения. Если свойство **пр_аддртипе** получателя сообщения ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) точно совпадает со строкой, определяющей один из типов адресов обмена сообщениями, предоставленных поставщиком транспорта, поставщик может доставить сообщение этому получателю.
  
Если несколько поставщиков транспорта могут обрабатывать один и тот же тип получателя, MAPI выбирает поставщика транспорта на основе заказа приоритета транспорта, указанного в профиле клиентского приложения. Чтобы определить, какой поставщик транспорта будет использоваться, диспетчер очереди MAPI сканирует все зависящие от поставщика структуры **мапиуид** в порядке приоритета, а затем все значения типа адреса, заданные поставщиком, в порядке приоритета. Первый поставщик транспорта, соответствующий определенному получателю в данном сканировании, получает первую возможность для обработки этого получателя. Если этот поставщик не обрабатывает получателя, диспетчер очереди MAPI продолжает сканирование, чтобы найти поставщика транспорта, который еще не обработан. Сканирование продолжается до тех пор, пока не будут найдены никакие совпадения, и при этом создается отчет о недоставке для всех получателей, которые не были обработаны. 
  
Если поставщик всегда поддерживает определенный набор типов получателей, тип адреса и массивы **мапиуид** , передаваемые поставщиком транспорта, могут быть статическими. Если поставщик транспорта динамически создает эти массивы, он может выделить память с помощью объекта поддержки, который ранее был передан в вызове **транспортлогон**, хотя это необязательно.
  
Память, используемая для массивов типа адреса и **мапиуид** , должна быть выделена до последнего вызова метода [Иксплогон:: транспортлогофф](ixplogon-transportlogoff.md) , когда поставщик транспорта может освободить память, если это необходимо. Поставщик транспорта не должен изменять содержимое этих массивов после его возврата из вызова **транспортлогофф** . 
  
Поставщик транспорта, который может обрабатывать любой тип получателя, может возвращать значение NULL в параметре _лпппсзадртипеаррай_ . Поставщики транспорта для систем обмена сообщениями на основе ЛВС, использующих центральный сервер для доставки исходящих сообщений в различные системы инородных сообщений, обычно это выполняется. Этот тип поставщика транспорта должен быть установлен последним в порядке приоритетов диспетчера очереди MAPI и MAPI в профиле. 
  
Поставщик транспорта, который не поддерживает исходящие сообщения, отправленные в него на основе типа адреса, должен возвращать одну строку нулевой длины в _лпппсзадртипеаррай_. Если поставщик транспорта не поддерживает типы получателей, он должен передать значение NULL для структуры **мапиуид** и пустую строку для типа адреса. Поставщики транспорта этого типа чаще всего используются для установки препроцессора сообщений. 
  
## <a name="see-also"></a>См. также



[IXPLogon::TransportLogoff](ixplogon-transportlogoff.md)
  
[IXPProvider::TransportLogon](ixpprovider-transportlogon.md)
  
[MAPIUID](mapiuid.md)
  
[IXPLogon : IUnknown](ixplogoniunknown.md)


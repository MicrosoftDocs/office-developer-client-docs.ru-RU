---
title: IXPLogonAddressTypes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.AddressTypes
api_type:
- COM
ms.assetid: 5add1f2b-d9e6-4d78-8739-c3848f6e32a3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ca68c604152a7a28fb6a5357aa9c012ec7466b5a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435378"
---
# <a name="ixplogonaddresstypes"></a>IXPLogon::AddressTypes

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Возвращает типы получателей, которые обрабатывает поставщик транспорта.
  
```cpp
HRESULT AddressTypes(
  ULONG FAR * lpulFlags,
  ULONG FAR * lpcAdrType,
  LPSTR FAR * FAR * lpppszAdrTypeArray,
  ULONG FAR * lpcMAPIUID,
  LPUID FAR * FAR * lpppUIDArray
);
```

## <a name="parameters"></a>Parameters

 _lpulFlags_
  
> [вышел] Битмашка флагов, контролируемая типом возвращенных строк. Можно установить следующий флаг:
    
MAPI_UNICODE 
  
> Возвращенные строки находятся в формате Unicode. Если флаг MAPI_UNICODE не установлен, строки находятся в формате ANSI.
    
 _lpcAdrType_
  
> [вышел] Указатель на количество записей в массиве, на который указывает параметр _lpppszAdrTypeArray._ 
    
 _lpppszAdrTypeArray_
  
> [вышел] Указатель на указатель на массив строк, определяя типы получателей.
    
 _lpcMAPIUID_
  
> [вышел] Указатель на количество записей в массиве, на который указывает параметр _lpppUIDArray._ 
    
 _lpppUIDArray_
  
> [вышел] Указатель на указатель на массив указателей для [структур MAPIUID,](mapiuid.md) определяющих типы получателей. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Поставщик транспорта успешно указал типы получателей, с которые он может обращаться.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Spooler MAPI вызывает **метод IXPLogon::AddressTypes** сразу после того, как поставщик транспорта возвращается из вызова к методу [IXPProvider::TransportLogon,](ixpprovider-transportlogon.md) чтобы поставщик транспорта указывал, какие типы получателей он обрабатывает. Чтобы указать это, поставщик транспорта должен передать в  _параметре lpppszAdrTypeArray_ указатель на массив указателей на строки или передать в  _параметре lpppUIDArray_ указатель на массив указателей для структур **MAPIUID** или передать значения в обоих параметрах. 
  
Эти два массива используются для различных процессов идентификации. MapI и spooler MAPI используют структуры [MAPIUID](mapiuid.md) в массиве  _lpppUIDArray_ для идентификации идентификаторов записей получателей, непосредственно обрабатывающихся поставщиком транспорта или системой обмена сообщениями, к которой подключается поставщик транспорта. Ни MAPI, ни шпалер MAPI не расширяют адреса с помощью идентификаторов записей, содержащихся ни в одной из этих структур **MAPIUID;** эти структуры используются только для идентификации типа получателя. 
  
Spooler MAPI использует каждую строку в параметре  _lpppszAdrTypeArray_ для сравнения, когда решает, какой поставщик транспорта должен обрабатывать получателей исходящие сообщения. Если свойство PR_ADDRTYPE  [(PidTagAddressType)](pidtagaddresstype-canonical-property.md)соответствует строке, которая идентифицирует один из типов адресов сообщений, который предоставляет поставщик транспорта, поставщик может доставить сообщение этому получателю.
  
Если несколько поставщиков транспорта могут обрабатывать один и тот же тип получателя, MAPI выбирает поставщика транспорта в зависимости от порядка приоритета транспорта, указываемого в профиле клиентского приложения. Чтобы определить, какой поставщик транспорта использовать, шпалер MAPI сканирует все указанные поставщиком структуры **MAPIUID** в порядке приоритета, а затем все значения типа адресов, указанные поставщиком, в порядке приоритета. Первый поставщик транспорта, который будет соответствовать конкретному получателю в этом сканировании, получит первую возможность для обработки этого получателя. Если этот поставщик не обрабатывает получателя, шпалер MAPI продолжает проверку, чтобы найти поставщика транспорта для любого получателя, который еще не обработан. Сканирование продолжается до тех пор, пока не будут найдены дополнительные совпадения, после чего для любого получателя, который не был обработан, создается отчет о неделивстве. 
  
Если поставщик всегда поддерживает определенный набор типов получателей, тип адреса и **массивы MAPIUID,** переданные поставщиком транспорта, могут быть статичными. Если поставщик транспорта динамически строит эти массивы, он может выделять память с помощью объекта поддержки, который ранее был передан в вызов **в TransportLogon,** хотя это и не требуется.
  
Память, используемая для типа адресов и массивов **MAPIUID,** должна оставаться выделенной до окончательного вызова метода [IXPLogon::TransportLogoff,](ixplogon-transportlogoff.md) после чего поставщик транспорта при необходимости может освободить память. Поставщик транспорта не должен изменять содержимое этих массивов после возвращения из **вызова TransportLogoff.** 
  
Поставщик транспорта, который может обрабатывать любой тип получателя, может вернуть NULL в _параметре lpppszAdrTypeArray._ Это обычно делают поставщики транспорта для lan-систем обмена сообщениями, которые используют центральный сервер для доставки исходяющих сообщений в различные иностранные системы сообщений. Этот тип поставщика транспорта должен быть установлен последним в приоритетном порядке MAPI и MAPI для поставщиков транспорта в профиле. 
  
Поставщик транспорта, который не поддерживает исходящие сообщения, которые отправляются ему на основе типа адресов, должен вернуть одну строку нулевой длины в _lpppszAdrTypeArray._ Если поставщик транспорта не поддерживает типы получателей, он должен передать NULL для структуры **MAPIUID** и пустую строку для типа адресов. Поставщики транспорта этого типа чаще всего используются для установки препроцессора сообщения. 
  
## <a name="see-also"></a>См. также



[IXPLogon::TransportLogoff](ixplogon-transportlogoff.md)
  
[IXPProvider::TransportLogon](ixpprovider-transportlogon.md)
  
[MAPIUID](mapiuid.md)
  
[IXPLogon : IUnknown](ixplogoniunknown.md)


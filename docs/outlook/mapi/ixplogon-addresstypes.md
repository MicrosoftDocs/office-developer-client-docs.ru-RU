---
title: IXPLogonAddressTypes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.AddressTypes
api_type:
- COM
ms.assetid: 5add1f2b-d9e6-4d78-8739-c3848f6e32a3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ca68c604152a7a28fb6a5357aa9c012ec7466b5a
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435378"
---
# <a name="ixplogonaddresstypes"></a>IXPLogon::AddressTypes

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Возвращает типы получателей, обрабатываемого поставщиком транспорта.
  
```cpp
HRESULT AddressTypes(
  ULONG FAR * lpulFlags,
  ULONG FAR * lpcAdrType,
  LPSTR FAR * FAR * lpppszAdrTypeArray,
  ULONG FAR * lpcMAPIUID,
  LPUID FAR * FAR * lpppUIDArray
);
```

## <a name="parameters"></a>Параметры

 _lpulFlags_
  
> [out] Битоваяmas флагов, которая управляет типом возвращаемой строки. Можно установить следующий флаг:
    
MAPI_UNICODE 
  
> Возвращенные строки имеют формат Юникод. Если флаг MAPI_UNICODE не установлен, строки будут в формате ANSI.
    
 _lpcAdrType_
  
> [out] Указатель на количество записей в массиве, на которые указывает параметр _lpppszAdrTypeArray._ 
    
 _lpppszAdrTypeArray_
  
> [out] Указатель на указатель на массив строк, определяя типы получателей.
    
 _lpcMAPIUID_
  
> [out] Указатель на количество записей в массиве, на которые указывает параметр _lpppUIDArray._ 
    
 _lpppUIDArray_
  
> [out] Указатель на указатель на массив указателей на структуры [MAPIUID,](mapiuid.md) определяющих типы получателей. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Поставщик транспорта успешно указал типы получателей, которые он может обработать.
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Пулер MAPI вызывает метод **IXPLogon::AddressTypes** сразу после того, как поставщик транспорта возвращается из вызова метода [IXPProvider::TransportLogon,](ixpprovider-transportlogon.md) поэтому поставщик транспорта может указать, какие типы получателей он обрабатывает. Для этого поставщик транспорта должен передать в  _параметре lpppszAdrTypeArray_ указатель на массив указателей на строки или передать обратно в  _параметре lpppUIDArray_ указатель на массив указателей в структуры **MAPIUID** или передать значения в обоих параметрах. 
  
Эти два массива используются для различных процессов идентификации. MAPI и пулер MAPI используют структуры [MAPIUID](mapiuid.md) в массиве  _lpppUIDArray_ для идентификации идентификаторов записей получателей, которые напрямую обрабатываются поставщиком транспорта или системой обмена сообщениями, к которой подключается поставщик транспорта. Ни MAPI, ни пулер MAPI не расширяют адреса с помощью идентификаторов записей, содержащихся ни в одной из этих структур **MAPIUID;** эти структуры используются только для идентификации типов получателей. 
  
Пулер MAPI использует каждую строку в параметре  _lpppszAdrTypeArray_ для сравнения, когда он решает, какой поставщик транспорта должен обрабатывать получателей исходящие сообщения. Если свойство PR_ADDRTYPE **получателя** сообщения [(PidTagAddressType)](pidtagaddresstype-canonical-property.md)в точности соответствует строке, которая определяет один из типов адресов обмена сообщениями, которые предоставляет поставщик транспорта, поставщик может доставить сообщение этому получателю.
  
Если несколько поставщиков транспорта могут обрабатывать один и тот же тип получателя, MAPI выбирает поставщика транспорта в зависимости от порядка приоритета транспорта, указанного в профиле клиентского приложения. Чтобы определить, какой поставщик транспорта использовать, пулер MAPI сканирует все указанные поставщиком структуры **MAPIUID** в порядке приоритета, а затем все указанные поставщиком значения типов адресов в порядке приоритета. Первый поставщик транспорта, который соберет определенного получателя в этой проверке, получает первую возможность обработать этого получателя. Если этот поставщик не обрабатывает получателя, пулер MAPI продолжает сканирование, чтобы найти поставщика транспорта для получателей, которые еще не обработаны. Сканирование продолжается до тех пор, пока не будут найдены дополнительные совпадения, после чего для всех получателей, которые не были обработаны, создается отчет о ненадежательности. 
  
Если поставщик всегда поддерживает определенный набор типов получателей, тип адреса и **массивы MAPIUID,** переданные поставщиком транспорта, могут быть статическими. Если поставщик транспорта динамически составляет эти массивы, он может выделить память с помощью объекта поддержки, который ранее был передан в **вызове TransportLogon,** хотя это необязательно.
  
Память, используемая для типа адреса и массивов **MAPIUID,** должна оставаться выделенной до окончательного вызова метода [IXPLogon::TransportLogoff,](ixplogon-transportlogoff.md) когда поставщик транспорта при необходимости может освободить память. Поставщик транспорта не должен изменять содержимое этих массивов после того, как он возвращается из вызова **TransportLogoff.** 
  
Поставщик транспорта, который может обрабатывать любой тип получателя, может возвращать NULL в _параметре lpppszAdrTypeArray._ Это обычно делают поставщики транспорта для систем обмена сообщениями на основе локальной сети, которые используют центральный сервер для доставки исходяющих сообщений в различные внешние системы обмена сообщениями. Этот тип поставщика транспорта должен быть установлен последним в порядке приоритета пула MAPI и MAPI для поставщиков транспорта в профиле. 
  
Поставщик транспорта, который не поддерживает исходящие сообщения, отправленные ему на основе типа адреса, должен вернуть одну строку нулевой длины в _lpppszAdrTypeArray._ Если поставщик транспорта не поддерживает типы получателей, он должен передать NULL для структуры **MAPIUID** и пустую строку для типа адреса. Поставщики транспорта этого типа чаще всего используются для установки препроцессора сообщения. 
  
## <a name="see-also"></a>См. также



[IXPLogon::TransportLogoff](ixplogon-transportlogoff.md)
  
[IXPProvider::TransportLogon](ixpprovider-transportlogon.md)
  
[MAPIUID](mapiuid.md)
  
[IXPLogon : IUnknown](ixplogoniunknown.md)


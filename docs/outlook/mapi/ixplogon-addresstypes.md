---
title: IXPLogonAddressTypes
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.AddressTypes
api_type:
- COM
ms.assetid: 5add1f2b-d9e6-4d78-8739-c3848f6e32a3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 65d633f0c2b0ce56793eaa55a417b5d6a816d449
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22589849"
---
# <a name="ixplogonaddresstypes"></a>IXPLogon::AddressTypes

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Возвращает типы получателей, которые обрабатывают поставщика транспорта.
  
```cpp
HRESULT AddressTypes(
  ULONG FAR * lpulFlags,
  ULONG FAR * lpcAdrType,
  LPSTR FAR * FAR * lpppszAdrTypeArray,
  ULONG FAR * lpcMAPIUID,
  LPUID FAR * FAR * lpppUIDArray
);
```

## <a name="parameters"></a>Параметры

 _lpulFlags_
  
> [out] Битовая маска флаги, определяющее тип возвращаемой строки. Можно задать следующий флаг:
    
MAPI_UNICODE 
  
> В формате Юникод, возвращенных строк. Если флаг MAPI_UNICODE не установлен, они в формате ANSI.
    
 _lpcAdrType_
  
> [out] Указатель на число записей в массиве указывает параметр _lpppszAdrTypeArray_ . 
    
 _lpppszAdrTypeArray_
  
> [out] Указатель на указатель на массив строк, чтобы указать типы получателей.
    
 _lpcMAPIUID_
  
> [out] Указатель на число записей в массиве указывает параметр _lpppUIDArray_ . 
    
 _lpppUIDArray_
  
> [out] Указатель на указатель на массив указатели на [MAPIUID](mapiuid.md) структуры, чтобы указать типы получателей. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Поставщика транспорта успешно Указывает типы получателей, которые можно обрабатывать.
    
## <a name="notes-to-implementers"></a>Примечания для реализующих

Диспетчер очереди MAPI вызывает метод **IXPLogon::AddressTypes** сразу же после возвращает поставщика транспорта в вызове метода [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) , поставщика транспорта можно указать, какие типы получателей обрабатывает. Чтобы указать это, поставщика транспорта следует передать обратно в параметре _lpppszAdrTypeArray_ указатель на массив указатели на строки или передайте в параметре _lpppUIDArray_ указатель массив указатели на **MAPIUID** структуры или передавать значения в оба параметра. 
  
Эти два массива используются для идентификации различных процессов. MAPI и диспетчер очереди MAPI структур [MAPIUID](mapiuid.md) в массиве _lpppUIDArray_ для определения используют эти идентификаторы получателей записей, которые обрабатываются непосредственно с поставщика транспорта или системы обмена сообщениями, к которому подключается поставщика транспорта . Диспетчер очереди MAPI ни MAPI расширяет адреса с помощью идентификаторы записей, содержащихся в любой из этих структур **MAPIUID** ; Эти структуры используются только для определения типа получателя. 
  
Диспетчер очереди MAPI использует каждый из строки с помощью параметра _lpppszAdrTypeArray_ для тестирования сравнения при определяет, какие поставщика транспорта должен обрабатывать получателей для исходящих сообщений. Если свойство **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) получателя сообщения в точности соответствует строка, определяющая один из системы обмена сообщениями типов адресов, которые предоставляет поставщика транспорта, поставщик можно доставить сообщение для получателя.
  
Если несколько поставщиков транспорта может обрабатывать тот же тип получателя, MAPI выбирает поставщика транспорта в порядке приоритета транспорта указано в профиле клиентского приложения. Чтобы определить, используемого поставщика транспорта, диспетчер очереди MAPI сканирование всех указан поставщик структур **MAPIUID** в порядке приоритета и затем все адреса указанного поставщика тип значения в порядке приоритета. Первый поставщика транспорта в соответствии с определенного получателя в для этого сканирования получает возможность первым обработать данному получателю. Если этого поставщика не обрабатывает получателя, диспетчер очереди MAPI по-прежнему производится сканирование для поиска поставщика транспорта для получателя, еще не обрабатывается. Сканирование продолжается, пока не дальнейший дал, после чего для какого-либо получателя, которое не было обработано создается отчет о недоставке. 
  
Если поставщик поддерживает всегда определенный набор типов получателей, тип адреса и массивов **MAPIUID** , которые переданы поставщика транспорта может быть static. Если поставщик транспорта динамически создает эти массивы, его выделения памяти с помощью объекта поддержки, который ранее был передан в вызове **TransportLogon**, хотя это не требуется.
  
Объем памяти, используемый для типа адреса и массивов **MAPIUID** должны оставаться выделенный до окончательного вызова метода [IXPLogon::TransportLogoff](ixplogon-transportlogoff.md) , в этот момент поставщика транспорта можно освободить память, если это необходимо. Поставщика транспорта не следует изменить содержимое этих массивов после возврата из вызова **TransportLogoff** . 
  
Поставщик транспорта, который может обрабатывать любой тип получателя может возвращать NULL в параметре _lpppszAdrTypeArray_ . Поставщики транспорта для локальных систем обмена сообщениями, использующих центральный сервер для передачи исходящих сообщений на различных систем внешнего сообщения часто это сделать. Этот тип поставщика транспорта должны быть установлены последние в MAPI и MAPI приоритетности очереди транспорта поставщиков в профиле. 
  
Поставщик транспорта, не поддерживает исходящих сообщений, отправляемых на него на основе типа адреса должна вернуть одну строку нулевой длины в _lpppszAdrTypeArray_. Если поставщик транспорта поддерживает не типы получателей, ему следует передать значение NULL для структуры **MAPIUID** и пустая строка для типа адреса. Поставщики транспорта этого типа чаще всего используются для установки препроцессор сообщения. 
  
## <a name="see-also"></a>См. также



[IXPLogon::TransportLogoff](ixplogon-transportlogoff.md)
  
[IXPProvider::TransportLogon](ixpprovider-transportlogon.md)
  
[MAPIUID](mapiuid.md)
  
[IXPLogon : IUnknown](ixplogoniunknown.md)


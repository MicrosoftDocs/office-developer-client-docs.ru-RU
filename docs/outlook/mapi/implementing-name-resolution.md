---
title: Реализация разрешения имен
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4c71b08-c47a-4421-8603-d5356d32dca9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 15c1d502947865c02973f4950b6b6fa8109b8e78
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434706"
---
# <a name="implementing-name-resolution"></a>Реализация разрешения имен

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Поставщики адресных книг отвечают за поддержку разрешения имен — процесс связывать идентификатор записи с отображающим именем. Клиенты инициируют разрешение имен при вызове [IAddrBook::ResolveName,](iaddrbook-resolvename.md) чтобы убедиться, что каждый член списка получателей исходярия сообщения соответствует допустимым адресам. 
  
Поставщик может поддерживать разрешение имен с помощью:
  
- Поддержка **ограничения свойств PR_ANR** [(PidTagAnr),](pidtaganr-canonical-property.md)необходимого для всех контейнеров адресной книги.
    
- Реализация метода [IABContainer::ResolveNames,](iabcontainer-resolvenames.md) параметра для всех контейнеров адресной книги. 
    
Если вы решите поддерживать **IABContainer::ResolveNames,** попытается найти точное совпадение для каждого неурегулированного имени отображения в структуре [ADRLIST,](adrlist.md) переданной с параметром _lpAdrList._ Вы можете фиксировать неурегулированное имя **отображения,** так как отсутствует свойство [PR_ENTRYID (PidTagEntryId)](pidtagentryid-canonical-property.md)в массиве значений свойств в его члене **aEntries** структуры **ADRLIST.** Игнорируйте любые записи с нулевыми свойствами, связанными с ними. 
  
Сообщайте о результатах попытки разрешения в параметре  _lpFlagList_ , массиве флагов, соответствующих массиву имен отображения в  _lpAdrList_. Флаги позиционны так, что первый флаг соответствует первому члену **aEntries** в структуре **ADRLIST,** второй флаг соответствует второму члену **aEntries** и так далее. 
  
Существует три возможных результата для каждой неурегулированной записи:
  
- Совпадение не обнаружено, что означает, что ни одна из записей в записях контейнера не совпадает с записью **в структуре ADRLIST.** Установите соответствующую запись в  _параметре lpFlagList_ для MAPI_UNRESOLVED. 
    
- Можно найти несколько совпадений, что означает, что существует несколько записей контейнеров, которые соответствуют входу в **структуре ADRLIST.** Установите соответствующую запись в  _параметре lpFlagList_ для MAPI_AMBIGUOUS. Не измените количество записей в **структуре ADRLIST.** 
    
- Можно найти точное совпадение, что означает, что в структуре **ADRLIST** имеется только одна запись контейнера, которая соответствует записи. Установите соответствующий член в параметре _lpFlagList_ для MAPI_RESOLVED и добавьте идентификатор записи в массив свойств, связанных с записью **ADRLIST.** 
    
Если вы решите не поддерживать **IABContainer::ResolveNames,** MAPI_E_NO_SUPPORT из своей реализации.
  
Все поставщики адресных книг должны поддерживать неоднозначное разрешение имен — ограничение PR_ANR свойств — на столах содержимого контейнеров.  Чтобы обеспечить эту поддержку, выполните PR_ANR ограничения в реализации [IMAPITable:::Restrict,](imapitable-restrict.md) выполняя тип поиска "наилучшего угадать", соотнося с одним или более определенными свойствами, которые имеют смысл для поставщика. Вы можете использовать одно и то же свойство или свойства каждый **раз,** например PR_DISPLAY_NAME [(PidTagDisplayName)](pidtagdisplayname-canonical-property.md)или **PR_ACCOUNT** [(PidTagAccount),](pidtagaccount-canonical-property.md)или разрешить администратору выбирать из списка приемлемых свойств. 
  
Хотя большинство поставщиков поставляют собственную реализацию таблицы контента, можно настроить реализацию, предоставленную MAPI с помощью [функции CreateTable.](createtable.md) Однако, так как реализация MAPI не поддерживает ограничения любого рода, необходимо создать объект оболочки, чтобы включить настраиваемую версию **Ограничения,** которая перехватывает вызов. 
  


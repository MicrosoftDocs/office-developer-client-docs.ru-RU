---
title: Реализация разрешения имен
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4c71b08-c47a-4421-8603-d5356d32dca9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 15c1d502947865c02973f4950b6b6fa8109b8e78
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434706"
---
# <a name="implementing-name-resolution"></a>Реализация разрешения имен

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщики адресных книг отвечают за поддержку разрешения имен — процесс связывание идентификатора записи с отображаемой именем. Клиенты инициируют разрешение имен при вызове [IAddrBook::ResolveName,](iaddrbook-resolvename.md) чтобы убедиться, что каждый член списка получателей исходя сообщения соответствует допустимым адресам. 
  
Поставщик может поддерживать разрешение имен, выявив:
  
- Поддержка ограничения **PR_ANR** ([PidTagAnr)](pidtaganr-canonical-property.md)— требование для всех контейнеров адресной книги.
    
- Реализация метода [IABContainer::ResolveNames,](iabcontainer-resolvenames.md) параметра для всех контейнеров адресной книги. 
    
Если вы выбрали поддержку **IABContainer::ResolveNames,** попытаться найти точное совпадение для каждого не разрешенного отображаемом имени в структуре [ADRLIST,](adrlist.md) переданной с помощью параметра _lpAdrList._ Вы можете фиксировать неустановленное отображаемого имени, так как в нем отсутствует свойство **PR_ENTRYID** ([PidTagEntryId)](pidtagentryid-canonical-property.md)в массиве значений свойств в его члене **aEntries** структуры **ADRLIST.** Игнорируйте все записи, с которых связаны нулевые свойства. 
  
Report the result of your attempt at resolution in the  _lpFlagList_ parameter, an array of flags that corresponds to the array of display names in  _lpAdrList_. Флаги позиционны так, что первый флаг соответствует первому члену **aEntries** в структуре **ADRLIST,** второй флаг соответствует второму члену **aEntries** и так далее. 
  
Существует три возможных результата для каждой не разрешенной записи:
  
- Совпадение не найдено, то есть ни одна из записей в записях контейнера не соответствует записи в структуре **ADRLIST.** Установите для соответствующей записи в  _параметре lpFlagList_ MAPI_UNRESOLVED. 
    
- Можно найти несколько совпадений, то есть существует несколько записей контейнера, которые соответствуют записи в **структуре ADRLIST.** Установите для соответствующей записи в  _параметре lpFlagList_ MAPI_AMBIGUOUS. Не изменяя количество записей в структуре **ADRLIST.** 
    
- Можно найти точное совпадение, то есть только одна запись контейнера соответствует записи в **структуре ADRLIST.** Задайте соответствующему члену в параметре _lpFlagList_ MAPI_RESOLVED и добавьте идентификатор записи в массив свойств, связанных с записью **ADRLIST.** 
    
Если вы решили не поддерживать **IABContainer::ResolveNames,** MAPI_E_NO_SUPPORT из вашей реализации.
  
Все поставщики адресных книг должны поддерживать **разрешение** неоднозначных имен (ограничение PR_ANR свойств) в таблицах содержимого контейнеров. Чтобы обеспечить эту поддержку, обработать ограничение PR_ANR в реализации [IMAPITable::Restrict,](imapitable-restrict.md) выполнив наиболее угадать тип поиска, соотнося с одним или более определенными свойствами, которые имеют смысл для вашего поставщика. Вы можете использовать одно и то же свойство или свойства каждый раз, например **PR_DISPLAY_NAME** ([PidTagDisplayName)](pidtagdisplayname-canonical-property.md)или **PR_ACCOUNT** ([PidTagAccount),](pidtagaccount-canonical-property.md)или разрешить администратору выбирать из списка допустимых свойств. 
  
Хотя большинство поставщиков предоставляет собственную реализацию таблицы содержимого, вы можете настроить реализацию, предоставленную MAPI, с помощью [функции CreateTable.](createtable.md) Однако, так как реализация MAPI не поддерживает какие-либо ограничения, необходимо создать объект-оболочку, чтобы включить настроенную версию **Restrict,** которая перехватывает вызов. 
  


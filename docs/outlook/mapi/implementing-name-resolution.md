---
title: Реализация разрешения имен
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a4c71b08-c47a-4421-8603-d5356d32dca9
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 15c1d502947865c02973f4950b6b6fa8109b8e78
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434706"
---
# <a name="implementing-name-resolution"></a>Реализация разрешения имен

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщики адресных книг несут ответственность за поддержку разрешения имен — процесс связывания идентификатора записи с отображаемым именем. Клиенты инициируют разрешение имен при вызове [IAddrBook:: ресолвенаме](iaddrbook-resolvename.md) , чтобы убедиться, что каждый участник списка получателей исходящих сообщений соответствует действительному адресу. 
  
Поставщик может поддерживать разрешение имен следующим образом:
  
- Поддержка ограничения свойства **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)), необходимое для всех контейнеров адресных книг.
    
- Реализация метода [иабконтаинер:: ResolveNames](iabcontainer-resolvenames.md) , который является параметром для всех контейнеров адресных книг. 
    
Если вы решили поддерживать **иабконтаинер:: ResolveNames**, попытайтесь найти точное совпадение для каждого неразрешенного отображаемого имени в структуре [ADRLIST](adrlist.md) , переданной с параметром _лпадрлист_ . Можно идентифицировать неизвестное отображаемое имя, так как в нем отсутствует свойство **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) в массиве значений свойства в его **Аентриес** -члене структуры **ADRLIST** . Игнорируйте все записи, связанные с нулевыми свойствами. 
  
Сообщите результат попытки при разрешении в параметре _лпфлаглист_ , массив флагов, соответствующий массиву отображаемых имен в _лпадрлист_. Флаги располагаются таким образом, что первый флаг соответствует первому элементу **аентриес** в структуре **ADRLIST** , второй флаг соответствует второму элементу **аентриес** и т. д. 
  
Существует три возможных результата для каждой неразрешенной записи:
  
- Совпадения не найдены, что означает, что ни одна из записей в записях контейнера не совпадают с записью в структуре **ADRLIST** . Установите для соответствующей записи в параметре _лпфлаглист_ значение MAPI_UNRESOLVED. 
    
- Можно найти несколько совпадений, то есть несколько записей контейнера, соответствующих записи в структуре **ADRLIST** . Установите для соответствующей записи в параметре _лпфлаглист_ значение MAPI_AMBIGUOUS. Не изменяйте число записей в структуре **ADRLIST** . 
    
- Можно найти точное совпадение, то есть только одна запись контейнера, соответствующая записи в структуре **ADRLIST** . Задайте для соответствующего элемента в параметре _лпфлаглист_ значение MAPI_RESOLVED и добавьте идентификатор записи в массив свойств, связанных с записью **ADRLIST** . 
    
Если вы не поддерживаете **иабконтаинер:: ResolveNames**, возвращайте MAPI_E_NO_SUPPORT из реализации.
  
Все поставщики адресных книг должны поддерживать однозначное разрешение имен — ограничение свойства **PR_ANR** — в таблицах контента контейнеров. Чтобы обеспечить такую поддержку, обработайте ограничение PR_ANR в реализации метода [IMAPITable:: Ограничьте](imapitable-restrict.md) , выполнив "лучший тип поиска", соответствующий одному или нескольким определенным свойствам, которые имеют смысл у поставщика. Вы можете использовать одни и те же свойства или свойства каждый раз, например **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) или **PR_ACCOUNT** ([PidTagAccount](pidtagaccount-canonical-property.md)), или разрешить администратору выбирать из списка допустимых свойств. 
  
Несмотря на то, что большинство поставщиков предоставляют собственную реализацию таблицы содержимого, вы можете настроить реализацию MAPI с помощью функции [креатетабле](createtable.md) . Тем не менее, поскольку реализация MAPI не поддерживает ограничения какого-либо рода, необходимо создать объект-оболочку, чтобы включить настраиваемую версию **ограничения** , которая перехватывает вызов. 
  


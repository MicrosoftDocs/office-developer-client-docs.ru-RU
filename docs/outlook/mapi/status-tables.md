---
title: Таблицы состояния
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: f2b2aca7-757f-4260-96a5-d0af55189711
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: d612738ef8bf0e6925d89a5be7cb423695672d28
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422364"
---
# <a name="status-tables"></a>Таблицы состояния

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В таблице состояние содержатся сведения, относящиеся к состоянию текущего сеанса. Для каждого сеанса MAPI существует одна таблица состояния, включающая сведения, предоставляемые MAPI и поставщиками служб. MAPI предоставляет данные для трех строк: строку для подсистемы MAPI, строку для диспетчера очереди MAPI и строку для интегрированной адресной книги. Так как поставщики транспорта должны предоставлять сведения о состоянии для таблицы состояния, существует одна строка для каждого активного поставщика транспорта. Адресная книга и поставщики хранилищ сообщений могут выбирать, следует ли поддерживать таблицу состояния. 
  
Так как каждая строка предоставляется другим ресурсом, набор столбцов может различаться в зависимости от типа строки. Существует набор столбцов, которые необходимо предоставить каждому объекту status и набору столбцов, поставляемых MAPI. Поставщик услуг может добавить в эти наборы, чтобы предоставить свойства, зависящие от поставщика. Например, поставщики хранилища сообщений могут добавлять **PR_STORE_RECORD_KEY** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md)) для предоставления клиентов с идентификатором их хранилища сообщений. Клиенты должны получить сведения о существовании этих дополнительных сведений, чтобы их можно было использовать. 
  
В следующей таблице перечислены свойства, которые должны присутствовать в каждой строке таблицы состояния. Разработчик объекта Status предоставляет некоторые свойства; другие рассчитываются с помощью MAPI.
  
|**Свойства, предоставляемые объектом Status**|**Свойства, предоставляемые MAPI**|
|:-----|:-----|
|**PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))  <br/> |**PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md))  <br/> |
|**PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))  <br/> |**PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))  <br/> |
|**PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md))  <br/> |**PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md))  <br/> |
   
Если объект Status предоставляет удостоверение, он должен задавать **PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md)), **PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md)) и **PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md)), а также включать эти свойства в таблицу. 
  
Четыре свойства рассчитываются MAPI для каждой строки таблицы состояний:
  
|||
|:-----|:-----|
|**PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md))  <br/> |**PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))  <br/> |
|**PR_OBJECT_TYPE** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))  <br/> |**PR_ROWID** ([PidTagRowid](pidtagrowid-canonical-property.md))  <br/> |
   
MAPI присваивает строке состояния идентификатор записи, чтобы позволить клиентам открыть соответствующий объект Status. Идентификатор строки также назначается для определения строки в таблице, как это ключ экземпляра для идентификации данных в объекте status. Для свойства **PR_OBJECT_TYPE** задано значение MAPI_STATUS. 
  
Чтобы получить доступ к таблице состояния, клиенты вызывают метод [IMAPISession:: жетстатустабле](imapisession-getstatustable.md) . Этот вызов не следует принимать сразу после запуска. Это связано с тем, что **жетстатустабле** должен подождать, пока диспетчер очереди MAPI закончит инициализацию поставщиков транспорта, операция, которая откладывается до завершения входа клиента. **Жетстатустабле** является относительно быстрым вызовом после того, как диспетчер очереди MAPI завершит обработку при запуске. 
  
Сведения о таблице состояний можно использовать различными способами, например для доступа к объекту status, чтобы определить, работает ли клиент в подключенном или автономном режиме, а также для наблюдения за состоянием поставщика. Например, клиенты могут открыть объект состояния определенного поставщика услуг, передав значение свойства **PR_ENTRYID** методу [IMAPISession:: OpenEntry](imapisession-openentry.md) . Объект Status поддерживает интерфейс **имапистатус** , интерфейс, который содержит методы для изменения пароля поставщика услуг, очистки очереди сообщений, отображения страницы свойств конфигурации или подтверждения состояния с поставщиком напрямую. Сведения о таблице состояния также можно использовать для создания диалогового окна для информирования клиентов о ходе выполнения длительной операции. 
  
Поставщики услуг, поддерживающие таблицу состояния, используют метод [имаписуппорт:: модифистатусров](imapisupport-modifystatusrow.md) для создания и обновления строк. При каждом изменении своей строки все объекты приемника уведомлений, зарегистрированные для получения уведомлений таблицы состояния, должны быть уведомлены. Поставщики услуг могут вызывать метод [имаписуппорт:: notify](imapisupport-notify.md) , если они используют программу уведомления MAPI, или вызывайте каждый метод [имапиадвисесинк:: OnNotify](imapiadvisesink-onnotify.md) в приемнике уведомлений напрямую. 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


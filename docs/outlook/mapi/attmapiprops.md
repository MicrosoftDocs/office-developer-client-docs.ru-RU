---
title: attMAPIProps
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 806270c1-30e4-494e-9b03-7d1f2fc04099
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 185bfbb151c4f8d4e36b40b94393d14d50c33edf
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410457"
---
# <a name="attmapiprops"></a>attMAPIProps

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Атрибут **аттмапипропс** является особым, поэтому его можно использовать для кодирования любого свойства MAPI, у которого нет аналога в наборе существующих атрибутов TNEF. Данные атрибута — это подсчитанный набор свойств MAPI, который располагается от конца к концу. Формат этой кодировки, который позволяет использовать любой набор свойств MAPI, выглядит следующим образом:  
  
 _Проперти_сек:_
  
> Свойство — число _проперти_валуе,..._
    
Количество элементов _проперти_валуе_ должно быть таким же, как значение счетчика свойства. 
  
 _Проперти_валуе:_
  
> Свойство – Tag _Проперти_проперти — _свойство проптаг_наме_
    
Свойство-Tag — это просто значение, связанное с идентификатором свойства, например 0x0037001F для **пр_субжект** ([PidTagSubject](pidtagsubject-canonical-property.md)).
  
 _Свойств_
  
>  __ Value Value — значение счетчика _,..._
    
 _Значение:_
  
> Value: Data Value — значение size — заполнение данных — значение размера — значение IID — заполнение данных
    
 _Проптаг_наме:_
  
> Name — имя GUID: имя имя — идентификатор имя — GUID имя — имя типа — строка с именем строки имени строки
    
Инкапсуляция каждого свойства зависит от идентификатора свойства и типа свойства. Теги свойств, идентификаторы и типы определены в файлах заголовков Мапитагс. h и MAPIDEFS. h.
  
Если свойство является именованным, то тег свойства сразу же сопровождается именем свойства MAPI, состоящим из глобального уникального идентификатора (GUID), типа, а также идентификатора или строки Юникода.
  
Многозначные свойства и свойства со значениями переменной длины, такими как типы свойств ПТ_БИНАРИ, PT_STRING8, ПТ_УНИКОДЕ или ПТ_ОБЖЕКТ, рассматриваются следующим образом. Первое число значений, закодированных как 32-разрядное длинное длинное, помещается в поток TNEF, за которым следуют отдельные значения. Каждое значение свойства — данные кодируются как размер в байтах, за которым следуют данные value. Значение-Data заполняется до 4-байтовой границы, хотя размер заполнения не включается в значение.
  
Если свойство имеет тип ПТ_ОБЖЕКТ, за значением должно следовать идентификатор интерфейса объекта. Текущая реализация TNEF поддерживает только идентификаторы интерфейса Иид_имессаже, Иид_истораже и Иид_истреам. Размер идентификатора интерфейса включается в значение size.
  
Если объект является внедренным сообщением (то есть у него есть тип свойства ПТ_ОБЖЕКТ и идентификатор интерфейса Иид_имессаже), то данные значения кодируются как внедренный поток TNEF. Фактическая кодировка внедренного сообщения в реализации TNEF выполняется путем открытия второго объекта TNEF для исходного потока и обработки встроенного потока.
  


---
title: attMAPIProps
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 806270c1-30e4-494e-9b03-7d1f2fc04099
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 185bfbb151c4f8d4e36b40b94393d14d50c33edf
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410457"
---
# <a name="attmapiprops"></a>attMAPIProps

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Атрибут **attMAPIProps** является особенным в том, что его можно использовать для кодирования любого свойства MAPI, которое не имеет аналога в наборе существующих атрибутов, определенных TNEF. Данные атрибута — это подсчитываемая набор свойств MAPI, заложенных в конце. Формат этого кодинга, который позволяет использовать любой набор свойств MAPI, является следующим:  
  
 _Property_Seq:_
  
> количество  _свойств Property_Value,..._
    
Должно быть столько  _Property_Value_ элементов, сколько указано в значении "количество свойств". 
  
 _Property_Value:_
  
> свойство тег _Property_property-тег  _Proptag_Name свойства_
    
Тег свойства — это просто значение, связанное с идентификатором свойства, например 0x0037001F для **PR_SUBJECT** [(PidTagSubject).](pidtagsubject-canonical-property.md)
  
 _Свойство:_
  
>  _Значение_  _значение-значение,..._
    
 _Значение:_
  
> обивка значения-данные значения-данные для заполнения значения-размера value-IID-данных
    
 _Proptag_Name:_
  
> name-guid name-kind name-id name-guid name-kind name-string-length name-string padding
    
Инкапсуляция каждого свойства зависит от идентификатора свойства и типа свойства. Теги свойств, идентификаторы и типы определяются в файлах заголовок Mapitags.h и Mapidefs.h.
  
Если свойство является свойством с именем, за тегом свойства немедленно следует имя свойства MAPI, состоящее из глобально уникального идентификатора (GUID), типа и идентификатора или строки Юникод.
  
Многоценные свойства и свойства с переменными значениями длины, такими как PT_BINARY, PT_STRING8, PT_UNICODE или PT_OBJECT свойств, рассматриваются следующим образом. Сначала количество значений, закодированное как 32-битная неподписаная длинная, помещается в поток TNEF, а затем отдельные значения. Данные о значении каждого свойства кодируются как его размер в битах, за которыми следуют сами значения-данные. Значение-данные примыкает к границе 4 байта, хотя количество обивки не включено в размер значения.
  
Если свойство имеет тип PT_OBJECT, за ним следует идентификатор интерфейса объекта. Текущая реализация TNEF поддерживает только идентификаторы IID_IMessage, IID_IStorage и IID_Istream интерфейса. Размер идентификатора интерфейса включен в размер значения.
  
Если объект является встроенным сообщением (то есть имеет тип свойства PT_OBJECT и идентификатор интерфейса IID_Imessage), данные значения закодируются как встроенный поток TNEF. Фактическое кодивка встроенного сообщения в реализации TNEF делается путем открытия второго объекта TNEF для исходного потока и обработки встроенного потока.
  


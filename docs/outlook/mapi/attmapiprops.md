---
title: attMAPIProps
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 806270c1-30e4-494e-9b03-7d1f2fc04099
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 185bfbb151c4f8d4e36b40b94393d14d50c33edf
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33410457"
---
# <a name="attmapiprops"></a>attMAPIProps

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Атрибут **attMAPIProps** является специальным, так как его можно использовать для кодирования любого свойства MAPI, которое не имеет аналога в наборе существующих атрибутов, определенных в TNEF. Данные атрибута — это подсчитаный набор свойств MAPI, которые можно уложить в конец. Формат этой кодии, который позволяет использовать любой набор свойств MAPI, имеет такой формат:  
  
 _Property_Seq:_
  
> property-count  _Property_Value,..._
    
Количество элементов Property_Value  _должно_ быть таким, как указывает значение подсчета свойств. 
  
 _Property_Value:_
  
> property-tag _Property_property-tag  _Proptag_Name Property_
    
Тег свойства — это просто значение, связанное с идентификатором свойства, например 0x0037001F для **PR_SUBJECT** ([PidTagSubject).](pidtagsubject-canonical-property.md)
  
 _Свойство:_
  
>  _Value_ value-count  _Value,..._
    
 _Значение:_
  
> value-data value-size value-data padding value-size value-IID value-data padding
    
 _Proptag_Name:_
  
> name-guid name-kind name-id name-guid name-kind name-string-length name-string padding
    
Инкапсуляция каждого свойства зависит от идентификатора свойства и типа свойства. Теги, идентификаторы и типы свойств определяются в файлах заголовок Mapitags.h и Mapidefs.h.
  
Если свойство является именованным свойством, за тегом свойства сразу же следует имя свойства MAPI, состоящее из глобального уникального идентификатора (GUID), типа и идентификатора или строки Юникода.
  
Многоценные свойства и свойства с переменными значениями длины, такие как типы свойств PT_BINARY, PT_STRING8, PT_UNICODE или PT_OBJECT, обрабатываются следующим образом. Сначала число значений, закодированное как 32-битное длинное без подписи, помещается в поток TNEF, за которым следуют отдельные значения. Значение-данные каждого свойства кодируются в качестве размера в ветвях, за которыми следуют сами данные значения. Значение-данные заполнено до 4-байтовых границ, хотя количество заполнения не включается в размер значения.
  
Если свойство имеет тип PT_OBJECT, за размером значения следует идентификатор интерфейса объекта. Текущая реализация TNEF поддерживает только идентификаторы IID_IMessage, IID_IStorage и IID_Istream интерфейса. Размер идентификатора интерфейса включается в размер значения.
  
Если объект является внедренным сообщением (т. е. имеет тип свойства PT_OBJECT и идентификатор интерфейса IID_Imessage), данные значения кодируются как внедренный поток TNEF. Фактическая кодивка внедренного сообщения в реализации TNEF делается путем открытия второго объекта TNEF для исходного потока и обработки встроенного потока.
  


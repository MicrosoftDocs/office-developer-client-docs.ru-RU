---
title: Открытие текста сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e37fc9d8-433b-41b4-84f2-42a952063f35
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 305b0534f828ea72c1e116fd38fb8f578062e32e
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32348582"
---
# <a name="opening-message-text"></a>Открытие текста сообщения

**Область применения**: Outlook 2013 | Outlook 2016 
  
Текст сообщения хранится в свойстве текста по отношению к **тексту (PR)\_** или сжатом **RTF\_\_(пр.)** . Дополнительную информацию можно узнать в **статье\_Body** ([PidTagBody](pidtagbody-canonical-property.md)), **\_HTML** ([PidTagHtml](pidtaghtml-canonical-property.md)) и сжатом **\_RTF\_** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)). 

Если вы поддерживаете формат RTF, откройте **ртф_компрессед (пр\_**). Если вы не поддерживаете формат RTF, **откройте\_текст PR**. Так как текст сообщения может быть большим, независимо от того, отформатирован он или нет, используйте **IMAPIProp:: опенпроперти** , чтобы открыть эти свойства. For more information, see [IMAPIProp::OpenProperty](imapiprop-openproperty.md).
  
### <a name="to-display-formatted-message-text"></a>Отображение форматированного текста сообщения
  
1. Если вы используете хранилище сообщений с поддержкой не в формате RTF, как указано в разделе отсутствие флага СТОРЕ_РТФ_ОК в свойстве **пр_сторе_суппорт_маск** хранилища ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)):
    
    1. ВыЗовите метод **IMAPIProp::** /PROPS сообщения, чтобы получить свойство **пр_ртф_ин_синк** . Дополнительные сведения см. в статье [IMAPIProp::](imapiprop-getprops.md) -PROPS and **пр_ртф_ин_синк** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)).
        
    2. ВыЗовите Ртфсинк для синхронизации свойства ПР_БОДИ сообщения с помощью свойства **пр_ртф_компрессед** . Дополнительные сведения см. в статье [ртфсинк](rtfsync.md), **пр_боди**и **пр_ртф_компрессед**. Если при вызове метода получения **пр_ртф_ин_синк** произошел сбой, необходимо передать флаг ртф_синк_боди_чанжед, так как свойство не существует или имеет значение false. 
        
    3. Если **ртфсинк** ВОЗВРАЩАЕТ значение true, указывающее, что были сделаны изменения, вызовите метод **IMAPIProp:: SaveChanges** сообщения, чтобы окончательно сохранить их. Дополнительные сведения см. в разделе [IMAPIProp:: SaveChanges](imapiprop-savechanges.md).
    
2. Независимо от того, используется ли хранилище сообщений с поддержкой RTF:
    
    1. Call **IMAPIProp:: опенпроперти** , чтобы открыть свойство **пр_ртф_компрессед** . Дополнительные сведения см. в статье [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) и **пр_ртф_компрессед**.
        
    2. Если **пр_ртф_компрессед** недоступен, вызовите **опенпроперти** , чтобы открыть свойство **пр_боди** . 
        
    3. ВыЗовите функцию **врапкомпресседртфстреам** , чтобы создать несжатую версию сжатых данных RTF, если они доступны. Дополнительные сведения см. в разделе [врапкомпресседртфстреам](wrapcompressedrtfstream.md).
        
    4. Скопируйте отформатированный текст из потока в соответствующее место формы сообщения. 
    
### <a name="to-display-plain-message-text"></a>Отображение обычного текста сообщения
  
1. ВыЗовите метод **IMAPIProp::** /PROPS сообщения, чтобы получить свойство **пр_боди** . Дополнительные сведения см. в статье [IMAPIProp::](imapiprop-getprops.md)/PROPS.
    
2. Если **** параметр PROPS ВОЗВРАЩАЕТ значение пт_еррор для типа свойства в структуре значения свойства или мапи_е_нот_енаугх_мемори, вызовите метод **IMAPIProp:: опенпроперти** этого сообщения. Передайте **пр_боди** как тег свойства и иид_истреам в качестве идентификатора интерфейса. For more information, see [IMAPIProp::OpenProperty](imapiprop-openproperty.md).
    
3. Скопируйте обычный текст из потока в соответствующее место формы сообщения. 
    


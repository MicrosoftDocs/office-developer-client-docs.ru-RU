---
title: Классы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b2ab5d56c53216152a83ca207ff5ba1d53c9049d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412088"
---
# <a name="mapi-message-classes"></a>Классы сообщений MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каждое сообщение имеет свойство класса Message, **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)), которое определяет тип, назначение или содержимое сообщения. **PR_MESSAGE_CLASS** — это обязательное свойство для всех новых сообщений. Класс сообщения определяет форму, используемую для представления сообщения пользователю, и папку для размещения входящих сообщений. 
  
Классы сообщений — это строки с учетом регистра, содержащие символы ASCII от 32 до 127, которые разделяются точками, но не могут заканчиваться точкой. Каждая строка представляет уровень подклассов, и количество допустимых уровней не ограничено. 
  
Например, большинство сообщений, которые клиентские приложения отправляют и получают, попадают в класс сообщений **IPM** , обширную категорию, которая описывает все взаимонаправленные сообщения (то есть сообщения, предназначенные для чтения человеком, а не с помощью компьютера). Поставщики хранилища сообщений более точно описывают сообщение IPM, создавая подкласс **IPM** . Подкласс **IPM** наследует свойства класса сообщений **IPM** . Имена подклассов класса **IPM** связываются путем сцепления других строк символов в идентификатор IPM, например **IPM. Примечание** , чтобы описать сообщение примечания и **IPM. Контакт** для описания контактного сообщения. 
  
Для обработки сообщений IPM и управления ими клиенты могут использовать стандартную форму, предоставляемую MAPI. Для обработки отображения и управления новыми классами сообщений разработчик клиентского приложения имеет два варианта:
  
1. Вы можете создать новую форму, используя набор интерфейсов форм, определенных MAPI, которые может использовать стандартный клиент.
    
2. Вы можете написать собственный клиент, реализовав полное автономное приложение. 
    
Несмотря на то, что клиенты должны задать свойство **PR_MESSAGE_CLASS** для каждого исходящего сообщения подклассу **IPM** или **IPC**, у поставщика хранилища сообщений есть конечная ответственность за его установку. Таким образом, если клиент отправляет сообщение, не устанавливая его класс Message, то поставщик хранилища сообщений задает для него соответствующее значение по умолчанию для соответствующего типа клиента. Класс сообщений по умолчанию для клиентов взаимоконтактных сообщений — **IPM**; классом сообщений по умолчанию для межпроцессных клиентов взаимодействия является **IPC**. 
  
Длина классов сообщений ограничена 255 символами. Однако классы сообщений не должны превышать 127 символов для поддержки классов сообщений, используемых в отчетах. Классы сообщений Report основаны на классе исходного сообщения с двумя дополнениями: префиксом и суффиксом. Этот отчет указывает на то, что сообщение является отчетом, а суффикс указывает на тип отчета: DR (отчет о доставке), отчет о недоставке (отчет о недоставке), ИПНРН (отчет о прочтении) или ИПННРН (непрочтенный отчет). Обратите внимание на то, что ограничения на длину указаны в символах; на платформах, использующих набор двухбайтовых символов, фактические значения счетчика байт могут быть выше. 
  
Поставщики хранилища сообщений должны возвращать MAPI_E_INVALID_PARAMETER от их реализации методов [IMAPIProp:: SetProps](imapiprop-setprops.md) , когда клиент пытается назначить строку, которая превышает допустимое ограничение для своего класса сообщений. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


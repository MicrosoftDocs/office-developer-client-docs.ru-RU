---
title: Классы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b2ab5d56c53216152a83ca207ff5ba1d53c9049d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412088"
---
# <a name="mapi-message-classes"></a>Классы сообщений MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Каждое сообщение имеет свойство класса **PR_MESSAGE_CLASS** ([PidTagMessageClass),](pidtagmessageclass-canonical-property.md)которое определяет тип, назначение или содержимое сообщения. **PR_MESSAGE_CLASS** является обязательной для всех новых сообщений. Класс сообщения определяет форму, которая используется для представить сообщение пользователю, и папку для размещения входящих сообщений. 
  
Классы сообщений — это строки символов с чувствительным к буквам символами, которые содержат символы ASCII от 32 до 127 и размещены по точкам, но не могут заканчиваются точками. Каждая строка представляет уровень подклассов, и количество уровней не ограничивается. 
  
Например, большинство сообщений, которые клиентские приложения отправляют и получают, попадают в класс сообщений **IPM—** широкую категорию, описываемую все межличностные сообщения (то есть сообщения, которые должны читаться пользователем-человеком, а не программным путем компьютером). Поставщики store сообщений точнее описывают сообщение IPM, создавая подкласс **IPM.** Подкласс **IPM** наследует свойства класса сообщений **IPM.** Подклассы класса **IPM** именуются путем совмещения других строк символов с идентификатором **IPM, например IPM. Примечание** для описания сообщения заметки и **IPM. Свяжитесь** с вами, чтобы описать контактное сообщение. 
  
Для обработки отображения сообщений IPM и управления ими клиенты могут использовать стандартную форму, которую предоставляет MAPI. Для обработки отображения новых классов сообщений и управления ими у разработчика клиентского приложения есть два варианта:
  
1. Новую форму можно создать с помощью набора интерфейсов форм, определенных в MAPI, которые может использовать стандартный клиент.
    
2. Вы можете написать собственный клиент, реализуя полное, самостоятельное приложение. 
    
Хотя клиенты должны установить **PR_MESSAGE_CLASS** для каждого исходяходящего сообщения подклассом **IPM** или **IPC,** за его настройку отвечает поставщик банка сообщений. Таким образом, если клиент отправляет сообщение, не устанавливая его класс сообщений, поставщик магазина сообщений устанавливает для него соответствующее значение по умолчанию для соответствующего типа клиента. Классом сообщений по умолчанию для клиентов межличностных сообщений является **IPM;** Классом сообщений по умолчанию для клиентов связи междупроцессами является **IPC.** 
  
Длина классов сообщений составляет 255 символов. Однако классы сообщений не должны превышать 127 символов для поддержки классов сообщений, используемых в отчетах. Классы сообщений отчетов основаны на классе исходного сообщения с двумя добавлениями: префиксом и суффиксом. Отчет с префиксом указывает, что сообщение является отчетом, а суффикс указывает тип отчета: DR (отчет о доставке), отчет о доставке (отчет о ненадеженстве), IPNRN (отчет о прочтениях) или IPNNRN (непрочитанные отчеты). Обратите внимание, что эти ограничения длины задаются символами; На платформах, где используется двухбайтовая символика, фактическое количествобайтов может быть выше. 
  
Поставщики реализации MAPI_E_INVALID_PARAMETER сообщений должны возвращать данные из своих реализаций метода [IMAPIProp::SetProps,](imapiprop-setprops.md) когда клиент пытается назначить строку, которая превышает допустимое ограничение для класса сообщений. 
  
## <a name="see-also"></a>См. также



[MAPI Messages](mapi-messages.md)


---
title: Классы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b2ab5d56c53216152a83ca207ff5ba1d53c9049d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412088"
---
# <a name="mapi-message-classes"></a>Классы сообщений MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Каждое сообщение имеет свойство класса **PR_MESSAGE_CLASS** [(PidTagMessageClass),](pidtagmessageclass-canonical-property.md)которое определяет тип, цель или содержимое сообщения. **PR_MESSAGE_CLASS** это обязательное свойство для всех новых сообщений. Класс сообщения определяет форму, используемую для вручия сообщения пользователю, и папку для размещения входящих сообщений. 
  
Классы сообщений — это строки символов, которые содержат символы ASCII от 32 до 127 и делимитированы по периодам, но не могут закончиться периодом. Каждая строка представляет уровень подклассинга, и количество разрешенных уровней не ограничивается. 
  
Например, большинство сообщений, которые клиентские приложения отправляют и получают, попадают в класс сообщений **IPM** — широкую категорию, описываемую все межличностные сообщения (то есть сообщения, которые предназначены для чтения пользователем, а не программным путем компьютером). Поставщики магазина сообщений более точно описывают сообщение IPM, создав **подкласс IPM.** Подкласс **IPM** наследует свойства класса **сообщений IPM.** Подклассы класса **IPM** называются путем примещения других строк символов к идентификатору **IPM, например IPM. Примечание,** чтобы описать сообщение заметки и **IPM. Свяжитесь** с вами, чтобы описать контактное сообщение. 
  
Для обработки отображения и управления сообщениями IPM клиенты могут использовать стандартную форму, которую предоставляет MAPI. Для обработки отображения и управления новыми классами сообщений у вас как у разработчика клиентских приложений есть два варианта:
  
1. Создать новую форму можно с помощью набора интерфейсов форм, определенных MAPI, которые может использовать стандартный клиент.
    
2. Вы можете написать собственный клиент, реализуя полное, самостоятельное приложение. 
    
Хотя клиенты  должны PR_MESSAGE_CLASS для каждого исходяходящего сообщения в подкласс IPM или **IPC,** поставщик магазина сообщений несет конечную ответственность за его настройку.  Поэтому если клиент отправляет сообщение без настройки класса сообщения, поставщик магазина сообщений задает ему соответствующее значение по умолчанию для соответствующего типа клиента. Класс сообщений по умолчанию для клиентов межличностных сообщений **— IPM;** класс сообщений по умолчанию для клиентов межпроцессной связи **— это IPC.** 
  
Классы сообщений имеют ограничение длины в 255 символов. Однако классы сообщений не должны превышать 127 символов для поддержки классов сообщений, используемых в отчетах. Классы сообщений отчетов основаны на классе исходного сообщения с двумя дополнениями: префиксом и суффиксом. В отчете префикса указывается, что сообщение является отчетом, а суффикс указывает тип отчета: DR (отчет о доставке), NDR (отчет о неделивстве), IPNRN (отчет о прочтениях) или IPNNRN (отчет о непрочитанстве). Обратите внимание, что эти ограничения длины даются в символах; на платформах, где используется набор символов с двойным числом, фактическое число byte может быть выше. 
  
Поставщики магазинов сообщений должны возвращать MAPI_E_INVALID_PARAMETER из реализации метода [IMAPIProp::SetProps,](imapiprop-setprops.md) когда клиент пытается назначить строку, превышаю допустимую для класса сообщений. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


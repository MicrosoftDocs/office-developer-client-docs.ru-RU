---
title: Классы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b2ab5d56c53216152a83ca207ff5ba1d53c9049d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412088"
---
# <a name="mapi-message-classes"></a><span data-ttu-id="8beb0-103">Классы сообщений MAPI</span><span class="sxs-lookup"><span data-stu-id="8beb0-103">MAPI Message Classes</span></span>

  
  
<span data-ttu-id="8beb0-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="8beb0-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="8beb0-105">Каждое сообщение имеет свойство класса Message, **пр_мессаже_класс** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)), которое определяет тип, назначение или содержимое сообщения.</span><span class="sxs-lookup"><span data-stu-id="8beb0-105">Every message has a message class property, **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)), which identifies the type, purpose, or content of the message.</span></span> <span data-ttu-id="8beb0-106">**Пр_мессаже_класс** является обязательным свойством для всех новых сообщений.</span><span class="sxs-lookup"><span data-stu-id="8beb0-106">**PR_MESSAGE_CLASS** is a required property on all new messages.</span></span> <span data-ttu-id="8beb0-107">Класс сообщения определяет форму, используемую для представления сообщения пользователю, и папку для размещения входящих сообщений.</span><span class="sxs-lookup"><span data-stu-id="8beb0-107">A message's class determines the form that is used to present the message to the user and the folder for placing incoming messages.</span></span> 
  
<span data-ttu-id="8beb0-108">Классы сообщений — это строки с учетом регистра, содержащие символы ASCII от 32 до 127, которые разделяются точками, но не могут заканчиваться точкой.</span><span class="sxs-lookup"><span data-stu-id="8beb0-108">Message classes are case-sensitive character strings that contain ASCII characters 32 through 127 and are delimited by periods, but they cannot end with a period.</span></span> <span data-ttu-id="8beb0-109">Каждая строка представляет уровень подклассов, и количество допустимых уровней не ограничено.</span><span class="sxs-lookup"><span data-stu-id="8beb0-109">Each string represents a level of subclassing, and there is no limit to the number of levels allowed.</span></span> 
  
<span data-ttu-id="8beb0-110">Например, большинство сообщений, которые клиентские приложения отправляют и получают, попадают в класс сообщений **IPM** , обширную категорию, которая описывает все взаимонаправленные сообщения (то есть сообщения, которые предназначены для чтения человеком, а не программным путем). компьютер).</span><span class="sxs-lookup"><span data-stu-id="8beb0-110">For example, most messages that client applications send and receive fall into the **IPM** message class, a broad category that describes all interpersonal messages (that is, messages that are meant to be read by a human user, rather than programmatically by a computer).</span></span> <span data-ttu-id="8beb0-111">Поставщики хранилища сообщений более точно описывают сообщение IPM, создавая подкласс **IPM** .</span><span class="sxs-lookup"><span data-stu-id="8beb0-111">Message store providers more precisely describe an IPM message by creating an **IPM** subclass.</span></span> <span data-ttu-id="8beb0-112">Подкласс **IPM** наследует свойства класса сообщений **IPM** .</span><span class="sxs-lookup"><span data-stu-id="8beb0-112">The **IPM** subclass inherits the properties of the **IPM** message class.</span></span> <span data-ttu-id="8beb0-113">Имена подклассов класса **IPM** связываются путем сцепления других строк символов в идентификатор IPM, например **IPM. Примечание** , чтобы описать сообщение примечания и **IPM. Контакт** для описания контактного сообщения.</span><span class="sxs-lookup"><span data-stu-id="8beb0-113">Subclasses of the **IPM** class are named by concatenating other character strings onto the IPM identifier, such as **IPM.Note** to describe a note message and **IPM.Contact** to describe a contact message.</span></span> 
  
<span data-ttu-id="8beb0-114">Для обработки сообщений IPM и управления ими клиенты могут использовать стандартную форму, предоставляемую MAPI.</span><span class="sxs-lookup"><span data-stu-id="8beb0-114">To handle the display and management of IPM messages, clients can use a standard form that MAPI provides.</span></span> <span data-ttu-id="8beb0-115">Для обработки отображения и управления новыми классами сообщений разработчик клиентского приложения имеет два варианта:</span><span class="sxs-lookup"><span data-stu-id="8beb0-115">To handle the display and management of new message classes, you as a client application developer have two options:</span></span>
  
1. <span data-ttu-id="8beb0-116">Вы можете создать новую форму, используя набор интерфейсов форм, определенных MAPI, которые может использовать стандартный клиент.</span><span class="sxs-lookup"><span data-stu-id="8beb0-116">You can create a new form by using the set of MAPI-defined form interfaces that a standard client can use.</span></span>
    
2. <span data-ttu-id="8beb0-117">Вы можете написать собственный клиент, реализовав полное автономное приложение.</span><span class="sxs-lookup"><span data-stu-id="8beb0-117">You can write your own client by implementing a complete, standalone application.</span></span> 
    
<span data-ttu-id="8beb0-118">Несмотря на то, что клиенты должны задать свойство **пр_мессаже_класс** для каждого исходящего сообщения в подклассе **IPM** или **IPC**, поставщик хранилища сообщений имеет конечную ответственность за его установку.</span><span class="sxs-lookup"><span data-stu-id="8beb0-118">Although clients should set the **PR_MESSAGE_CLASS** property for every outgoing message to a subclass of either **IPM** or **IPC**, the message store provider has the ultimate responsibility for setting it.</span></span> <span data-ttu-id="8beb0-119">Таким образом, если клиент отправляет сообщение, не устанавливая его класс Message, то поставщик хранилища сообщений задает для него соответствующее значение по умолчанию для соответствующего типа клиента.</span><span class="sxs-lookup"><span data-stu-id="8beb0-119">Therefore, if a client sends a message without setting its message class, the message store provider sets it to the appropriate default value for the appropriate type of client.</span></span> <span data-ttu-id="8beb0-120">Класс сообщений по умолчанию для клиентов взаимоконтактных сообщений — **IPM**; классом сообщений по умолчанию для межпроцессных клиентов взаимодействия является **IPC**.</span><span class="sxs-lookup"><span data-stu-id="8beb0-120">The default message class for interpersonal messaging clients is **IPM**; the default message class for interprocess communication clients is **IPC**.</span></span> 
  
<span data-ttu-id="8beb0-121">Длина классов сообщений ограничена 255 символами.</span><span class="sxs-lookup"><span data-stu-id="8beb0-121">Message classes have a length restriction of 255 characters.</span></span> <span data-ttu-id="8beb0-122">Однако классы сообщений не должны превышать 127 символов для поддержки классов сообщений, используемых в отчетах.</span><span class="sxs-lookup"><span data-stu-id="8beb0-122">However, message classes should not exceed 127 characters to support the message classes used in reports.</span></span> <span data-ttu-id="8beb0-123">Классы сообщений Report основаны на классе исходного сообщения с двумя дополнениями: префиксом и суффиксом.</span><span class="sxs-lookup"><span data-stu-id="8beb0-123">Report message classes are based on the class of the original message, with two additions: a prefix and a suffix.</span></span> <span data-ttu-id="8beb0-124">Этот отчет указывает на то, что сообщение является отчетом, а суффикс указывает на тип отчета: DR (отчет о доставке), отчет о недоставке (отчет о недоставке), ИПНРН (отчет о прочтении) или ИПННРН (непрочтенный отчет).</span><span class="sxs-lookup"><span data-stu-id="8beb0-124">The prefix REPORT indicates that the message is a report, and the suffix indicates the type of report: DR (delivery report), NDR (nondelivery report), IPNRN (read report), or IPNNRN (nonread report).</span></span> <span data-ttu-id="8beb0-125">Обратите внимание на то, что ограничения на длину указаны в символах; на платформах, использующих набор двухбайтовых символов, фактические значения счетчика байт могут быть выше.</span><span class="sxs-lookup"><span data-stu-id="8beb0-125">Note that these length restrictions are given in characters; on platforms that use a double-byte character set, the actual byte count might be higher.</span></span> 
  
<span data-ttu-id="8beb0-126">Поставщики хранилищ сообщений должны возвращать МАПИ_Е_ИНВАЛИД_ПАРАМЕТЕР из своих [IMAPIProp:: SetProps](imapiprop-setprops.md) метода, когда клиент пытается назначить строку, которая превышает допустимое ограничение для своего класса сообщений.</span><span class="sxs-lookup"><span data-stu-id="8beb0-126">Message store providers should return MAPI_E_INVALID_PARAMETER from their [IMAPIProp::SetProps](imapiprop-setprops.md) method implementations when a client attempts to assign a string that exceeds the allowable limit for their message class.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="8beb0-127">См. также</span><span class="sxs-lookup"><span data-stu-id="8beb0-127">See also</span></span>



[<span data-ttu-id="8beb0-128">Сообщения MAPI</span><span class="sxs-lookup"><span data-stu-id="8beb0-128">MAPI Messages</span></span>](mapi-messages.md)


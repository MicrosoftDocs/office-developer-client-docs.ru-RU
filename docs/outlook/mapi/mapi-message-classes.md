---
title: Классы сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 64ef2bbb-585c-4908-8ad4-a1c954057e9b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 27b81c0939aa3e880f3998d33f4717c51bdbe681
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809778"
---
# <a name="mapi-message-classes"></a>Классы сообщений MAPI

  
  
**Относится к**: Outlook 
  
Каждое сообщение имеет свойство класс сообщения, **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)), который определяет тип, назначение или содержимое сообщения. **PR_MESSAGE_CLASS** свойство является обязательным для всех новых сообщений. Класс сообщения определяет формы, в которой используется для представления сообщение пользователю и папка для размещения входящих сообщений. 
  
Классы сообщений являются строками с учетом регистра символов, которые содержат символы ASCII 32 до 127, которые отделяются периодов, но не может заканчиваться точкой. Каждая строка представляет уровень подклассы и нет ограничений на количество допустимых уровней. 
  
Например, класса большинство сообщений, что клиентские приложения отправки и получения попадают в сообщение **IPM** широкий категорию, которая описывает все сообщения электронной почты — это (то есть, сообщения, предназначенные для чтения человеческого пользователем, а не программными средствами с помощью компьютер). Сообщение об IPM точнее описывают поставщиков хранилища сообщений, создание подкласса **IPM** . Подкласс **IPM** наследует свойства класса сообщений **IPM** . Подклассов класса **IPM** называются путем объединения других знаков на идентификатор IPM, такие как **IPM. Примечание** для описания сообщение заметки и **IPM. Обратитесь в** для описания контактов сообщения. 
  
Для отображения и управления IPM сообщений, клиенты могут использовать стандартной формы, который предоставляет MAPI. Для отображения и управления новые классы сообщений, как разработчик приложения клиента имеется два варианта:
  
1. Можно создать новую форму с помощью набор интерфейсов определенные MAPI формы, которые можно использовать стандартный клиента.
    
2. Можно написать собственного клиента при помощи завершено, автономного приложения. 
    
Хотя клиенты следует установить свойство **PR_MESSAGE_CLASS** для всех исходящих сообщений на подкласс класса **IPM** или **производственных Издержек**, поставщик хранения сообщений имеет ultimate ответственность за установка его. Таким образом Если клиент отправляет сообщение без установки его класс сообщения, поставщик хранения сообщений устанавливает соответствующее значение по умолчанию для соответствующего типа клиента. Класс сообщения по умолчанию для электронной почты — это клиенты обмена сообщениями является **IPM**; Класс сообщения по умолчанию для клиентов, связи между процессами — **производственных Издержек**. 
  
Классы сообщений имеют ограничение длины 255 символов. Тем не менее классы сообщений не должна превышать 127 знаков для поддержки классы сообщений, используемые в отчетах. Классы сообщений отчета основаны на класс исходное сообщение с двумя дополнения: префикс и суффикс. Префикс ОТЧЕТОВ указывает, что сообщение является подчиненным и суффикс указывает тип отчета: аварийное Восстановление (отчет о), отчет о Недоставке (отчет о недоставке), IPNRN (чтение отчета) или IPNNRN (nonread отчет). Обратите внимание на то, что эти ограничения на длину, приводятся в символов; для платформ, использующих набор двухбайтовых знаков количество фактических байтов может быть выше. 
  
Поставщики хранилища сообщений должен возвращать MAPI_E_INVALID_PARAMETER из их реализации метода [IMAPIProp::SetProps](imapiprop-setprops.md) при попытке клиента назначение строку, которая превышает допустимое для их класс сообщения. 
  
## <a name="see-also"></a>См. также



[Сообщения MAPI](mapi-messages.md)


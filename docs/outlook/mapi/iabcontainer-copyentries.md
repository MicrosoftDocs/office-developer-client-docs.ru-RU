---
title: иабконтаинеркопентриес
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABContainer.CopyEntries
api_type:
- COM
ms.assetid: 4e775228-5ceb-4002-9b68-999fb5889b86
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ddb730ed92db4c8d281e7c8d5d9b18bc44505598
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32346398"
---
# <a name="iabcontainercopyentries"></a>IABContainer::CopyEntries

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Копирует одну или несколько записей, как правило, пользователи системы обмена сообщениями или списки рассылки.
  
```cpp
HRESULT CopyEntries(
  LPENTRYLIST lpEntries,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _лпентриес_
  
> возврата Указатель на массив структур [ентрилист](entrylist.md) , который содержит идентификаторы записей для копирования. 
    
 _улуипарам_
  
> возврата Дескриптор родительского окна всех диалоговых окон и окон, отображаемых данным методом. Параметр _улуипарам_ должен равняться нулю, если установлен флаг AB_NO_DIALOG в параметре _ulFlags_ . 
    
 _лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения, или значение NULL. Если _лппрогресс_ имеет значение null, индикатор хода выполнения должен отображаться с использованием объекта Progress, ПРЕДОСТАВЛЕНного MAPI, с помощью метода [Имаписуппорт::D опрогрессдиалог](imapisupport-doprogressdialog.md) . Параметр _лппрогресс_ игнорируется, если установлен флаг AB_NO_DIALOG в _ulFlags_.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих порядок выполнения операции копирования. Можно задать следующие флаги:
    
AB_NO_DIALOG 
  
> Отключает отображение индикатора хода выполнения. Если этот флаг не установлен, отображается индикатор хода выполнения.
    
CREATE_CHECK_DUP_LOOSE 
  
> Указывает, что следует выполнить нестрогий уровень проверки повторяющихся записей. Реализация свободной проверки повторяющихся записей определяется поставщиком. Например, поставщик может определить нестрогое совпадение как любые две записи с одинаковым отображаемым именем.
    
CREATE_CHECK_DUP_STRICT 
  
> Указывает, что необходимо выполнить определенный уровень проверки дубликатов записей. Реализация проверки на уникальность повторяющихся записей определяется поставщиком. Например, поставщик может определить в качестве значения для всех двух элементов с одинаковым отображаемым именем и адресом для обмена сообщениями.
    
CREATE_REPLACE 
  
> Указывает, что новая запись должна заменить существующую, если она определена как дубликаты.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция копирования успешно выполнена.
    
MAPI_W_PARTIAL_COMPLETION 
  
> Операция копирования успешно выполнена, но не удалось скопировать одну или несколько записей. Когда возвращается это значение, вызов должен обрабатываться как успешный. Чтобы проверить это значение, используйте макрос **HR_FAILED** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **иабконтаинер:: копентриес** копирует записи из одного и того же контейнера или другого контейнера. Вызов **копентриес** функционально эквивалентен выполнению следующих вызовов для каждой копируемой записи: 
  
1. Метод [иабконтаинер:: креатинтри](iabcontainer-createentry.md) для создания новой записи. 
    
2. Метод [IMAPIProp::-PROPS](imapiprop-getprops.md) для чтения свойств копируемой записи. 
    
3. Метод [IMAPIProp:: SetProps](imapiprop-setprops.md) для записи свойств в новую запись. 
    
4. Новый метод [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) для выполнения операции сохранения. 
    
5. Метод [IUnknown:: Release](https://msdn.microsoft.com/library/ms682317%28VS.85%29.aspx) новой записи, чтобы освободить ссылку на контейнер. 
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Все контейнеры, поддерживающие метод **иабконтаинер:: копентриес** , должны быть изменяемыми. Установите флаг AB_MODIFIABLE контейнера в его свойстве **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), чтобы указать, что он является изменяемым. 
  
Необходимо поддерживать все флажки; Тем не менее, интерпретация и использование этих флагов зависит от реализации, то есть можно определить, что именно означает семантику CREATE_CHECK_DUP_LOOSE и CREATE_CHECK_DUP_STRICTных флагов в контексте реализации. Если не удается определить, является ли запись повторяющейся, всегда разрешите копирование записи. 
  
Если установлен флаг CREATE_REPLACE, всегда копируйте запись независимо от того, задано ли значение CREATE_CHECK_DUP_LOOSE или CREATE_CHECK_DUP_STRICT, а также является ли запись повторяющейся. 
  
Если CREATE_REPLACE не задано и CREATE_CHECK_DUP_STRICT задано, проверьте наличие дубликатов. Если запись определена как повторяющаяся, не копируйте эту запись. 
  
Не требуется поддержка CREATE_REPLACE; не поддерживающий CREATE_REPLACE означает, что вы можете спокойно проигнорировать его и всегда выполнять копирование. 
  
Возвращать предупреждение MAPI_W_PARTIAL_COMPLETION только в том случае, если невозможно скопировать недублирующую запись. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Используйте флаги CREATE_CHECK_DUP_LOOSE и CREATE_CHECK_DUP_STRICT, чтобы указать поставщику, как вы хотите, чтобы контейнер выполнил проверку на уникальную запись. Если необходимо добавить запись независимо от того, является ли она дубликатом, не задавайте один из этих флагов или установите флаг CREATE_REPLACE. CREATE_REPLACE указывает, что вы не следите, является ли запись повторяющейся; Вы всегда хотите, чтобы оно заменило исходную запись. 
  
## <a name="see-also"></a>См. также



[ENTRYLIST](entrylist.md)
  
[IABContainer::CreateEntry](iabcontainer-createentry.md)
  
[IMAPIProgress : IUnknown](imapiprogressiunknown.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md)


---
title: Иабконтаинеркопентриес
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IABContainer.CopyEntries
api_type:
- COM
ms.assetid: 4e775228-5ceb-4002-9b68-999fb5889b86
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ddb730ed92db4c8d281e7c8d5d9b18bc44505598
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32346398"
---
# <a name="iabcontainercopyentries"></a>IABContainer::CopyEntries

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Копирует одну или несколько записей, как правило, пользователи системы обмена сообщениями или списки рассылки.
  
```cpp
HRESULT CopyEntries(
  LPENTRYLIST lpEntries,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпентриес_
  
> возврата Указатель на массив структур [ентрилист](entrylist.md) , который содержит идентификаторы записей для копирования. 
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна всех диалоговых окон и окон, отображаемых данным методом. Если в параметре _ulFlags_ ЗАДАН флаг аб_но_диалог, параметр _улуипарам_ должен равняться нулю. 
    
 _Лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения, или значение NULL. Если _лппрогресс_ имеет значение null, индикатор хода выполнения должен отображаться с использованием объекта Progress, ПРЕДОСТАВЛЕНного MAPI, с помощью метода [Имаписуппорт::D опрогрессдиалог](imapisupport-doprogressdialog.md) . Параметр _лппрогресс_ игнорируется, если установлен флаг Аб_но_диалог в _ulFlags_.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих порядок выполнения операции копирования. Можно задать следующие флаги:
    
АБ_НО_ДИАЛОГ 
  
> Отключает отображение индикатора хода выполнения. Если этот флаг не установлен, отображается индикатор хода выполнения.
    
КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ 
  
> Указывает, что следует выполнить нестрогий уровень проверки повторяющихся записей. Реализация свободной проверки повторяющихся записей определяется поставщиком. Например, поставщик может определить нестрогое совпадение как любые две записи с одинаковым отображаемым именем.
    
КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ 
  
> Указывает, что необходимо выполнить определенный уровень проверки дубликатов записей. Реализация проверки на уникальность повторяющихся записей определяется поставщиком. Например, поставщик может определить в качестве значения для всех двух элементов с одинаковым отображаемым именем и адресом для обмена сообщениями.
    
КРЕАТЕ_РЕПЛАЦЕ 
  
> Указывает, что новая запись должна заменить существующую, если она определена как дубликаты.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Операция копирования успешно выполнена.
    
МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН 
  
> Операция копирования успешно выполнена, но не удалось скопировать одну или несколько записей. Когда возвращается это значение, вызов должен обрабатываться как успешный. Чтобы проверить это значение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Комментарии

Метод **иабконтаинер:: копентриес** копирует записи из одного и того же контейнера или другого контейнера. Вызов **копентриес** функционально эквивалентен выполнению следующих вызовов для каждой копируемой записи: 
  
1. Метод [иабконтаинер:: креатинтри](iabcontainer-createentry.md) для создания новой записи. 
    
2. Метод [IMAPIProp::](imapiprop-getprops.md) -PROPS для чтения свойств копируемой записи. 
    
3. Метод [IMAPIProp:: SetProps](imapiprop-setprops.md) для записи свойств в новую запись. 
    
4. Новый метод [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) для выполнения операции сохранения. 
    
5. Метод [IUnknown:: Release](https://msdn.microsoft.com/library/ms682317%28VS.85%29.aspx) новой записи, чтобы освободить ссылку на контейнер. 
    
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Все контейнеры, поддерживающие метод **иабконтаинер:: копентриес** , должны быть изменяемыми. Установите флаг АБ_МОДИФИАБЛЕ контейнера в его свойстве **пр_контаинер_флагс** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)), чтобы указать, что он является изменяемым. 
  
Необходимо поддерживать все флажки; Тем не менее, интерпретация и использование этих флагов зависит от реализации, то есть можно определить, что означает семантику флагов КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ и КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ в контексте реализации. Если не удается определить, является ли запись повторяющейся, всегда разрешите копирование записи. 
  
Если установлен флаг КРЕАТЕ_РЕПЛАЦЕ, всегда копируйте запись независимо от того, задано ли КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ или КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ, а также указывает, является ли запись повторяющейся. 
  
Если КРЕАТЕ_РЕПЛАЦЕ не задано, а КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ задано, проверьте наличие дубликатов. Если запись определена как повторяющаяся, не копируйте эту запись. 
  
Не требуется поддержка КРЕАТЕ_РЕПЛАЦЕ; не поддерживающий КРЕАТЕ_РЕПЛАЦЕ означает, что вы можете спокойно проигнорировать его и всегда выполнять копирование. 
  
ВозВращать предупреждение МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН только в том случае, если невозможно скопировать недублирующую запись. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Используйте флаги КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ и КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ, чтобы указать поставщику, как вы хотите, чтобы контейнер выполнил проверку на уникальную запись. Если необходимо добавить запись независимо от того, является ли она дубликатом, не задавайте один из этих флагов или установите флаг КРЕАТЕ_РЕПЛАЦЕ. КРЕАТЕ_РЕПЛАЦЕ указывает, что вы не следите, является ли запись повторяющейся; Вы всегда хотите, чтобы оно заменило исходную запись. 
  
## <a name="see-also"></a>См. также



[ENTRYLIST](entrylist.md)
  
[IABContainer::CreateEntry](iabcontainer-createentry.md)
  
[IMAPIProgress : IUnknown](imapiprogressiunknown.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IABContainer : IMAPIContainer](iabcontainerimapicontainer.md)


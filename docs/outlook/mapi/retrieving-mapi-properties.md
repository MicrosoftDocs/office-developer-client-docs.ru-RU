---
title: Извлечение свойств MAPI
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: bd3f9f59-9020-46e6-9560-86a7a0eeca20
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 41157b97eb28787deaf19c2e974da23dfb77e0be
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812142"
---
# <a name="retrieving-mapi-properties"></a>Извлечение свойств MAPI

 
  
**Относится к**: Outlook 
  
При клиента или поставщика получает свойство из объекта, объект предоставляет значение свойства, типа и идентификатор. 
  
Клиенты и поставщиков услуг можно получить свойства объекта, вызвав один из следующих:
  
[IMAPIProp::GetProps](imapiprop-getprops.md)
  
[IMAPIProp::OpenProperty](imapiprop-openproperty.md)
  
[HrGetOneProp](hrgetoneprop.md)
  
Метод **GetProps** используется для извлечения одного или нескольких свойств, которые не требуется специализированных или альтернативного интерфейса для доступа. Это означает, что свойства, доступные **GetProps** малого, такие как целые числа и логические значения. 
  
 **Для получения значений нескольких свойств**
  
1. Выделите структуру [SPropTagArray](sproptagarray.md) , достаточное для хранения числа свойства нужно вернуть. 
    
2. Значение числа свойств извлекаются и набора каждого **aulPropTag** в идентификатор и введите, если это возможно, одного из свойств конечного член **cValues** структуры **SPropTagArray** . Если тип не известен, его необходимо задайте для PT_UNSPECIFIED. Если Неизвестный тип и идентификатор, найти эти сведения, вызвав [IMAPIProp::GetPropList](imapiprop-getproplist.md). **GetPropList** возвращает массив тега свойства со всеми поддерживаемые свойства объекта. Если доступно только имя свойства, вызовите [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) для доступа к связанного идентификатора. 
    
3. Вызовите [IMAPIProp::GetProps](imapiprop-getprops.md) , чтобы открыть свойства или свойства. 
    
Метод **OpenProperty** используется для открытия большего свойства, которые требуют использования альтернативного интерфейса, таких как **IStream** или [IMAPITable](imapitableiunknown.md) для доступа. **OpenProperty** обычно используется для открытия строка крупных символов, двоичных данных и свойства объекта и может быть открыто только одно свойство за раз. Вызывающие передайте идентификатор дополнительного интерфейса, который требуется как один из входные параметры. 
  
Перечислены некоторые из часто используемых **OpenProperty** Открытие **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)), свойства, в котором размещается текста сообщения на основе текста, **PR_ATTACH_DATA_OBJ** ([PidTagAttachDataObject](pidtagattachdataobject-canonical-property.md)), в котором содержатся свойства Объект или сообщение вложения OLE и **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)), свойства, в котором содержатся папки или адрес таблицу контейнер содержимого книги. 
  
В зависимости от свойств другой интерфейс, запрашивается из **OpenProperty**. **IStream**, интерфейс, который позволяет данных свойства для чтения и записи как поток байт, обычно используется для доступа к **PR_BODY**. [IMessage](imessageimapiprop.md) или **IStream** можно использовать для доступа к **PR_ATTACH_DATA_OBJ**. Вложения внедренных сообщений, которые стандартные сообщения с помощью **IMessage** в то время как сообщения в формате TNEF используйте **IStream**. Поскольку **PR_CONTAINER_CONTENTS** объект таблицы, осуществляется с помощью [IMAPITable](imapitableiunknown.md).
  
 **Чтобы получить свойство PR_ATTACH_DATA_BIN вложения**
  
1. Вызовите функцию [OpenStreamOnFile](openstreamonfile.md) , чтобы открыть поток для файла. 
    
2. Вызовите метод [IMAPIProp::OpenProperty](imapiprop-openproperty.md) сообщений для получения свойства **PR_ATTACH_DATA_BIN** ([PidTagAttachDataBinary](pidtagattachdatabinary-canonical-property.md)) с помощью интерфейса **IStream** . Задайте MAPI_MODIFY и MAPI_CREATE флаги. 
    
3. Выделить **STATSTG** структуры и передайте его в вызов метода **IStream::Stat** файловый поток для определения его размер. Другим способом определения размера потока является вызов **IStream::Seek** с флагом STREAM_SEEK_END. 
    
4. Вызов метода **IStream::CopyTo** поток для копирования данных из потока файлов в вложения. 
    
5. После завершения операции копирования release обоих потоков, вызвав их **функции IUnknown::Release** методы. 
    
Когда **IStream** используется для доступа к свойству, некоторые поставщики услуг автоматически отправлять размер свойство обратно с потоком. Вызов **OpenProperty** с MAPI_DEFERRED_ERRORS флаг можно отложить Открытие свойства и возврат размер потока. Если **IStream::Stat** вызван для получения этого объема после **OpenProperty** с MAPI_DEFERRED_ERRORS флаг, set, производительность повлияет так как этой последовательности вызовов принудительно очень удаленный вызов процедур. Чтобы предотвратить снижение производительности, клиенты могут вызывать любой метод MAPI между вызовами для **OpenProperty** и **Статистика**.
  
Функция [HrGetOneProp](hrgetoneprop.md) , как **OpenProperty**открывает одно свойство за раз. **HrGetOneProp** следует использовать только в том случае, когда целевой объект существует на локальном компьютере. Если целевой объект не доступны локально, несколько раз с помощью **HrGetOneProp** может привести нескольких удаленных вызовов процедур и снижению производительности. 
  
Вызывающие объекты, которые должны несколько свойств можно вызвать **HrGetOneProp** или **OpenProperty** в цикле или один раз вызвать для **GetProps**. Вызов **GetProps** один раз более эффективным. 
  
> [!NOTE]
> Защищенные свойства недоступны автоматически с помощью других свойств в вызове **GetProps**, **HrGetOneProp**или **GetPropList** . Защищенные свойства должно быть явно запрошено с помощью идентификаторов их свойств. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


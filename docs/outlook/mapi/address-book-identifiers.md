---
title: Идентификаторы адресных книг
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 822d83c4b77d06c2e000b391c7e229985470ccd3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421573"
---
# <a name="address-book-identifiers"></a>Идентификаторы адресных книг

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Все поставщики адресных книг назначают идентификаторы записей с помощью свойства **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) их пользователям обмена сообщениями и объектам списка рассылки. Клиентские приложения используют эти идентификаторы записей для открытия и доступа к объектам, которым они назначены.
  
В адресной книге используются три других типа идентификаторов для представления объектов:
  
- Одноразовые идентификаторы записей
    
- Одноразовые идентификаторы записей шаблона
    
- Идентификаторы шаблонов
    
Из-за множества идентификаторов записей и сходства, с которыми они названы, легко разопутаться с использованием и созданием каждого типа. 
  
Одноразовый идентификатор записи — это идентификатор записи, который используется для открытия и получения доступа к типу получателя, известного как одноразовый, или получателя. Один из них — это получатели, которые не принадлежат ни одному из поставщиков адресных книг в профиле. Идентификаторы записей, назначенные односторонними, используют формат, зарезервированный для одноразовых получателей. Так как для открытия объектов и доступа к ним используются одноразовые идентификаторы записей, они хранятся в свойстве PR_ENTRYID.
  
Создаются односторонние и одноразовые идентификаторы записей:
  
- Когда пользователи в клиентском приложении добавляют получателя, не представляющего записи в адресной книге, в список получателей сообщений.
    
- Когда пользователи в клиентском приложении добавляют получателя, не представляющего записи в адресной книге, в контейнер адресной книги с изменяемым адресом.
    
- Когда поставщик транспорта получает сообщение с адресом, который не удается обработать с помощью соответствующего поставщика адресных книг.
    
- Когда поставщик транспорта получает сообщение с адресом, принадлежащим шлюзу.
    
В первых двух ситуациях клиент вызывает **IAddrBook:: креатеонеофф** , чтобы сопоставить идентификатор одноразовой записи с недавно созданным одноразовым получателем. Во втором случае поставщик транспорта вызывает метод **имаписуппорт:: креатеонеофф** , чтобы сопоставить идентификатор одноразовой записи с внешним адресом. Дополнительные сведения см. в статье [IAddrBook:: креатеонеофф](iaddrbook-createoneoff.md) and [Имаписуппорт:: креатеонеофф](imapisupport-createoneoff.md).
  
Одноразовый идентификатор записи шаблона — это короткий идентификатор записи, используемый для открытия и доступа к шаблону для создания однокомпромиссных элементов. Поставщики адресных книг и шаблоны поставки MAPI для ввода сведений, необходимых для создания получателя определенного типа. Сведения об этих шаблонах, в том числе их идентификаторы записей, публикуются в одноразовой таблице. При вызове метода **иаблогон:: жетонеоффтабле** или адресной книги ( **IMAPIProp:: опенпроперти** ) для запроса свойства **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) или, когда поставщик вызывает **имаписуппорт:: жетонеоффтабле**, отображаются одноразовые таблицы. Дополнительные сведения см. в статье [иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md), [IMAPIProp:: опенпроперти](imapiprop-openproperty.md)и [имаписуппорт:: жетонеоффтабле](imapisupport-getoneofftable.md).
  
Для создания нового одноразового пользователя пользователь выбирает один из шаблонов, перечисленных в таблице одноразовый. Клиент передает PR_ENTRYID столбец из выбранной строки, которая является одноразовым идентификатором записи шаблона для выбранного шаблона, в **IAddrBook:: невентри** в параметре _лпеидневентритпл_ . Дополнительные сведения см. в статье [IAddrBook:: невентри](iaddrbook-newentry.md). MAPI использует идентификатор записи одноразового шаблона для отображения шаблона и предоставления пользователю возможности ввода сведений, необходимых для создания получателя. 
  
Идентификатор шаблона — это идентификатор записи, который некоторые поставщики адресных книг назначают получателям в дополнение к идентификатору записи, который хранится в свойстве PR_ENTRYID. Поставщики задают свойство **PR_TEMPLATEID** получателя ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)), чтобы сохранить идентификатор шаблона. Некоторые поставщики адресных книг применяют одно и то же значение для идентификатора шаблона получателя и свойств идентификатора записи.
  
Идентификаторы шаблонов используются только поставщиками адресных книг и MAPI для привязывания данных получателей в одном поставщике, который называется поставщиком узла, для кода получателя в другом поставщике, который называется "инородный поставщик". Поставщик узла предоставляет хранилище для получателя; внешний поставщик предоставляет логику. Процесс привязки позволяет поставщику узла обновлять данные получателя, который он хранит, с помощью кода внешнего поставщика.
  
Когда поставщик узла готов к изменению своего получателя, он передает свойство PR_TEMPLATEID в вызове метода **имаписуппорт:: опентемплатеид** для запуска процесса привязки. MAPI продолжает процесс, передавая идентификатор шаблона соответствующему внешнему поставщику при вызове метода **иаблогон:: опентемплатеид** . Дополнительные сведения см. в статье [имаписуппорт:: опентемплатеид](imapisupport-opentemplateid.md) and [Иаблогон:: опентемплатеид](iablogon-opentemplateid.md). Внешний поставщик возвращает указатель на его реализацию **IMAPIProp** для получателя, который поставщик узла может использовать вместо собственной реализации. 
  


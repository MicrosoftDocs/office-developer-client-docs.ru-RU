---
title: Идентификаторы адресных книг
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 822d83c4b77d06c2e000b391c7e229985470ccd3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421573"
---
# <a name="address-book-identifiers"></a>Идентификаторы адресных книг

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Все поставщики адресных книг назначают идентификаторы записей с **помощью свойства PR_ENTRYID** ([PidTagEntryId)](pidtagentryid-canonical-property.md)объектам пользователей сообщений и списков рассылки. Клиентские приложения используют эти идентификаторы записей для открытия объектов, которым они назначены, и доступа к ним.
  
Адресная книга использует три других типа идентификаторов для представления объектов:
  
- Одноразовые идентификаторы записей
    
- Идентификаторы записей шаблона для разных типов
    
- Идентификаторы шаблонов
    
Из-за различных идентификаторов записей и сходства имен, с которыми они именуются, можно спутать с тем, как каждый тип используется и создается. 
  
Идентификатор однораскрывой записи — это идентификатор записи, который используется для открытия и доступа к типу получателя, известного как один или настраиваемый получатель. Одними из них являются получатели, которые не принадлежат ни одному из поставщиков адресных книг в профиле. Идентификаторы записей, присвоенные односерверным получателям, используют формат, специально зарезервированный для разных получателей. Так как идентификаторы одноаваторных записей используются для открытия объектов и доступа к ним, они хранятся в PR_ENTRYID свойстве.
  
Создаются идентификаторы разных и разных записей:
  
- Когда пользователи клиентского приложения выбирают добавление получателя, который не представляет никаких записей в адресной книге, в список получателей сообщения.
    
- Когда пользователи клиентского приложения выбирают добавление получателя, который не представляет никаких записей в адресной книге, в контейнер изменимой адресной книги.
    
- Когда поставщик транспорта получает сообщение с адресом, который не может обрабатываться связанным поставщиком адресной книги.
    
- Когда поставщик транспорта получает сообщение с адресом, принадлежащим шлюзу.
    
В первых двух ситуациях клиент вызывает **IAddrBook::CreateOneOff,** чтобы связать идентификатор однофаонной записи с только что созданным получателем. Во второй двух ситуациях поставщик транспорта вызывает **IMAPISupport::CreateOneOff,** чтобы связать идентификатор одноразовой записи с другим адресом. Дополнительные сведения см. в книге [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff.](imapisupport-createoneoff.md)
  
Идентификатор записи однораскрывого шаблона — это краткосрочный идентификатор записи, который используется для открытия шаблона и доступа к нему для создания разных моментов. Поставщики адресных книг и шаблоны поставок MAPI для ввода сведений, необходимых для создания получателя определенного типа. Сведения об этих шаблонах, включая их идентификаторы записей, публикуются в односерверной таблице. Одноразовые таблицы отображаются, когда MAPI вызывает метод **IABLogon::GetOneOffTable** или метод **IMAPIProp::OpenProperty** контейнера адресной книги для запроса свойства **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates)](pidtagcreatetemplates-canonical-property.md)или когда поставщик вызывает **IMAPISupport::GetOneOffTable**. Дополнительные сведения см. в [IABLogon::GetOneOffTable,](iablogon-getoneofftable.md) [IMAPIProp::OpenProperty](imapiprop-openproperty.md)и [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).
  
Для создания нового однонастотного шаблона пользователь выбирает один из шаблонов, указанных в одностолбной таблице. Клиент передает столбец PR_ENTRYID из выбранной строки, которая является идентификатором записи шаблона для выбранного шаблона, в **IAddrBook::NewEntry** в параметре _lpEIDNewEntryTpl._ Дополнительные сведения см. в [книге IAddrBook::NewEntry.](iaddrbook-newentry.md) MAPI использует идентификатор записи шаблона для отображения шаблона и позволяет пользователю вводить сведения, необходимые для создания получателя. 
  
Идентификатор шаблона — это идентификатор записи, который некоторые поставщики адресных книг назначают получателям в дополнение к идентификатору записи, который хранится в свойстве PR_ENTRYID. Поставщики устанавливают свойство PR_TEMPLATEID **получателя** [(PidTagTemplateid)](pidtagtemplateid-canonical-property.md)для хранения идентификатора шаблона. Некоторые поставщики адресных книг назначают одно и то же значение для свойств идентификатора шаблона получателя и идентификатора записи.
  
Идентификаторы шаблонов используются только поставщиками адресных книг и MAPI для привязки данных получателей в одном поставщике, который называется поставщиком услуг хоста, для кода получателя в другом поставщике, который называется внешнего поставщика. Поставщик услуг хоста обеспечивает хранилище для получателя; внешняя поставщик обеспечивает логику. Процесс привязки позволяет поставщику услуг хоста обновлять данные получателя, которые он сохраняет, используя код внешнего поставщика.
  
Когда поставщик хоста готов изменить своего получателя, он передает свойство PR_TEMPLATEID в вызове метода **IMAPISupport::OpenTemplateID** для инициации процесса привязки. MAPI продолжает процесс путем передачи идентификатора шаблона соответствующему внешнему поставщику с помощью вызова метода **IABLogon::OpenTemplateID.** Дополнительные сведения см. в [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) и [IABLogon::OpenTemplateID.](iablogon-opentemplateid.md) Внешние поставщики возвращают указатель на реализацию **IMAPIProp** для получателя, которую поставщик услуг хоста может использовать в качестве собственной реализации. 
  


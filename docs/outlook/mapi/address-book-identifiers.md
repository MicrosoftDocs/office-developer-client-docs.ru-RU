---
title: Идентификаторы адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 822d83c4b77d06c2e000b391c7e229985470ccd3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421573"
---
# <a name="address-book-identifiers"></a>Идентификаторы адресной книги

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Все поставщики адресных книг назначают идентификаторы записей **с помощью свойства PR_ENTRYID** [(PidTagEntryId)](pidtagentryid-canonical-property.md)своим объектам пользователей сообщений и списков рассылки. Клиентские приложения используют эти идентификаторы записей для открытия и доступа к объектам, которым они назначены.
  
Адресная книга использует три других типа идентификаторов для представления объектов:
  
- Одноразовые идентификаторы записей
    
- Идентификаторы входов в шаблоны один раз
    
- Идентификаторы шаблонов
    
Из-за разнообразия идентификаторов записей и сходства, с которыми они именуются, легко запутаться в том, как каждый тип используется и создается. 
  
Идентификатор для разной записи — это идентификатор записи, который используется для открытия и доступа к типу получателя, известному как разовый или настраиваемый получатель. Односемейные получатели — это получатели, которые не принадлежат ни одному из поставщиков адресных книг в профиле. Идентификаторы записей, предназначенные для разных получателей, используют формат, специально зарезервированный для разных получателей. Поскольку идентификаторы разных входов используются для открытия и доступа к объектам, они хранятся в PR_ENTRYID свойстве.
  
Создаются идентификаторы одноавтных и одноавтных записей:
  
- Когда пользователи клиентского приложения выбирают добавить получателя, который не представляет ни одной записи в адресной книге, в список получателей сообщения.
    
- Когда пользователи клиентского приложения выбирают добавить получателя, который не представляет никакой записи в адресной книге, в контейнер модифицированной адресной книги.
    
- Когда поставщик транспорта получает сообщение с адресом, который не может обрабатываться его связанным поставщиком адресной книги.
    
- Когда поставщик транспорта получает сообщение с адресом, который принадлежит шлюзу.
    
В первых двух ситуациях клиент вызывает **IAddrBook::CreateOneOff,** чтобы связать идентификатор разовой записи с вновь созданным разовым получателем. Во втором двух ситуациях поставщик транспорта вызывает **IMAPISupport::CreateOneOff,** чтобы связать идентификатор одноразовой записи с иностранным адресом. Дополнительные сведения см. [в книге IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).
  
Идентификатор входа в один шаблон — это краткосрочный идентификатор записи, который используется для открытия и доступа к шаблону для создания разов. Поставщики адресных книг и шаблоны поставок MAPI для ввода сведений, необходимых для создания получателя определенного типа. Сведения об этих шаблонах, включая идентификаторы записей, публикуются в разовой таблице. Разовые таблицы отображаются, когда MAPI вызывает свойство **IABLogon::GetOneOffTable** или метод **IMAPIProp::OpenProperty**  для запроса свойства PR_CREATE_TEMPLATES [(PidTagCreateTemplates)](pidtagcreatetemplates-canonical-property.md)или когда поставщик вызывает **IMAPISupport::GetOneOffTable**. Дополнительные сведения см. в [iABLogon::GetOneOffTable,](iablogon-getoneofftable.md) [IMAPIProp::OpenProperty](imapiprop-openproperty.md)и [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).
  
Для создания нового разового шаблона пользователь выбирает один из шаблонов, перечисленных в разовой таблице. Клиент передает столбец PR_ENTRYID из выбранной строки, которая является идентификатором ввода шаблона выбранного шаблона, в **IAddrBook::NewEntry** в параметре _lpEIDNewEntryTpl._ Дополнительные сведения см. [в книге IAddrBook::NewEntry.](iaddrbook-newentry.md) MAPI использует идентификатор входа в шаблон, чтобы отобразить шаблон и разрешить пользователю вводить сведения, необходимые для создания получателя. 
  
Идентификатор шаблона — это идентификатор записи, который некоторые поставщики адресных книг назначают получателям в дополнение к идентификатору записи, который хранится в свойстве PR_ENTRYID. Поставщики устанавливают свойство  PR_TEMPLATEID[(PidTagTemplateid)](pidtagtemplateid-canonical-property.md)для хранения его идентификатора шаблона. Некоторые поставщики адресных книг назначают одинаковое значение для свойств идентификатора шаблона получателя и идентификатора записи.
  
Идентификаторы шаблонов используются только поставщиками адресных книг и MAPI для привязки данных получателей в одном поставщике, который называется хост-провайдером, для кода получателя в другом поставщике, именуемом иностранным поставщиком. Поставщик хостов поставляет хранилище для получателя; иностранный поставщик поставляет логику. Процесс привязки позволяет хост-поставщику обновлять данные получателя, которые он хранит с помощью кода иностранного поставщика.
  
Когда поставщик хостов готов изменить получателя, он передает свойство PR_TEMPLATEID в вызов к методу **IMAPISupport::OpenTemplateID** для инициации процесса привязки. MAPI продолжает процесс, передав идентификатор шаблона соответствующему иностранному поставщику с помощью вызова на его **метод IABLogon::OpenTemplateID.** Дополнительные сведения см. [в таблице IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) и [IABLogon::OpenTemplateID](iablogon-opentemplateid.md). Иностранный поставщик возвращает указатель для реализации **IMAPIProp** для получателя, который поставщик хост может использовать взамен собственной реализации. 
  


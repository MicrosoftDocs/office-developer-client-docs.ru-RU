---
title: Идентификаторы адресных книг
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f9ba7a2a0752dea353e914aaa14a09046b993e5f
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22580525"
---
# <a name="address-book-identifiers"></a><span data-ttu-id="54d6b-103">Идентификаторы адресных книг</span><span class="sxs-lookup"><span data-stu-id="54d6b-103">Address Book Identifiers</span></span>

  
  
<span data-ttu-id="54d6b-104">**Применимо к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="54d6b-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="54d6b-105">Все поставщиками адресной книги назначьте идентификаторы записей с помощью свойства **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) для имени пользователя обмена мгновенными сообщениями и объекты списка рассылки.</span><span class="sxs-lookup"><span data-stu-id="54d6b-105">All address book providers assign entry identifiers using the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property to their messaging user and distribution list objects.</span></span> <span data-ttu-id="54d6b-106">Клиентские приложения используйте следующие идентификаторы записей для открытия и доступа к объектам, к которым они назначены.</span><span class="sxs-lookup"><span data-stu-id="54d6b-106">Client applications use these entry identifiers to open and access the objects to which they are assigned.</span></span>
  
<span data-ttu-id="54d6b-107">В адресной книге используются три типа идентификаторов для представления объектов:</span><span class="sxs-lookup"><span data-stu-id="54d6b-107">The address book makes use of three other types of identifiers to represent objects:</span></span>
  
- <span data-ttu-id="54d6b-108">Идентификаторы единичных записей</span><span class="sxs-lookup"><span data-stu-id="54d6b-108">One-off entry identifiers</span></span>
    
- <span data-ttu-id="54d6b-109">Идентификаторы записей одноразовых шаблона</span><span class="sxs-lookup"><span data-stu-id="54d6b-109">One-off template entry identifiers</span></span>
    
- <span data-ttu-id="54d6b-110">Идентификаторы шаблона</span><span class="sxs-lookup"><span data-stu-id="54d6b-110">Template identifiers</span></span>
    
<span data-ttu-id="54d6b-111">Из-за различных подобия, с которым они имеют имена и идентификаторы записей можно легко стать знаю, как использовать и создается каждого типа.</span><span class="sxs-lookup"><span data-stu-id="54d6b-111">Because of the variety of entry identifiers and the similarity with which they are named, it is easy to become confused about how each type is used and created.</span></span> 
  
<span data-ttu-id="54d6b-112">Идентификатор единичных записей — это идентификатор записи, который используется для открытия и получить доступ к тип получателя, известных как одного раза или настраиваемые получателя.</span><span class="sxs-lookup"><span data-stu-id="54d6b-112">A one-off entry identifier is an entry identifier that is used to open and access the type of recipient known as a one-off, or custom recipient.</span></span> <span data-ttu-id="54d6b-113">One-offs являются получателей, которые не принадлежат какие-либо поставщиками адресной книги в профиле.</span><span class="sxs-lookup"><span data-stu-id="54d6b-113">One-offs are recipients that do not belong to any of the address book providers in the profile.</span></span> <span data-ttu-id="54d6b-114">Идентификаторы записей, назначенный one-offs использовать формат специально зарезервировано для одноразовых получателей.</span><span class="sxs-lookup"><span data-stu-id="54d6b-114">The entry identifiers assigned to one-offs use a format specifically reserved for one-off recipients.</span></span> <span data-ttu-id="54d6b-115">Так как идентификаторы единичных записей используются для открытия и доступа к объектам, они сохраняются в свойстве PR_ENTRYID.</span><span class="sxs-lookup"><span data-stu-id="54d6b-115">Because one-off entry identifiers are used to open and access objects, they are stored in the PR_ENTRYID property.</span></span>
  
<span data-ttu-id="54d6b-116">Создаются One-offs и идентификаторы единичных записей:</span><span class="sxs-lookup"><span data-stu-id="54d6b-116">One-offs and one-off entry identifiers are created:</span></span>
  
- <span data-ttu-id="54d6b-117">Когда пользователи из клиентского приложения выбрать добавить получателя в список получателей сообщения не представляют все записи в адресной книге.</span><span class="sxs-lookup"><span data-stu-id="54d6b-117">When users of a client application elect to add a recipient that does not represent any entry in the address book to a message's recipient list.</span></span>
    
- <span data-ttu-id="54d6b-118">Когда пользователи из клиентского приложения по своему выбору добавить получателя, который не представляют все записи в адресной книге в контейнер изменяемые адресной книги.</span><span class="sxs-lookup"><span data-stu-id="54d6b-118">When users of a client application elect to add a recipient that does not represent any entry in the address book to a modifiable address book container.</span></span>
    
- <span data-ttu-id="54d6b-119">Когда поставщика транспорта получает сообщение с адреса, который не может справиться с его поставщик связанных с ними адресной книги.</span><span class="sxs-lookup"><span data-stu-id="54d6b-119">When a transport provider receives a message with an address that cannot be handled by its related address book provider.</span></span>
    
- <span data-ttu-id="54d6b-120">Когда поставщика транспорта получает сообщение с адресом, который относится к шлюзу.</span><span class="sxs-lookup"><span data-stu-id="54d6b-120">When a transport provider receives a message with an address that belongs to a gateway.</span></span>
    
<span data-ttu-id="54d6b-121">В первых двух случаях клиент вызывает **IAddrBook::CreateOneOff** для сопоставления идентификатора единичных записей с только что созданный одноразовых получателя.</span><span class="sxs-lookup"><span data-stu-id="54d6b-121">In the first two situations, the client calls **IAddrBook::CreateOneOff** to associate a one-off entry identifier with the newly created one-off recipient.</span></span> <span data-ttu-id="54d6b-122">В следующие две ситуации поставщика транспорта вызывает **IMAPISupport::CreateOneOff** для сопоставления идентификатора единичных записей на внешний адрес.</span><span class="sxs-lookup"><span data-stu-id="54d6b-122">In the second two situations, the transport provider calls **IMAPISupport::CreateOneOff** to associate a one-off entry identifier with the foreign address.</span></span> <span data-ttu-id="54d6b-123">Для получения дополнительных сведений см [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="54d6b-123">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) and [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="54d6b-124">Идентификатор записи одноразовых шаблона является краткосрочной идентификатор записи, которая используется для открытия и доступа к шаблон для создания one-offs.</span><span class="sxs-lookup"><span data-stu-id="54d6b-124">A one-off template entry identifier is a short-term entry identifier that is used to open and access a template for creating one-offs.</span></span> <span data-ttu-id="54d6b-125">Поставщиками адресной книги и MAPI использовать шаблоны для ввода сведения, необходимые для создания определенного типа получателя.</span><span class="sxs-lookup"><span data-stu-id="54d6b-125">Both address book providers and MAPI supply templates for entering the information that is required to create a recipient of a particular type.</span></span> <span data-ttu-id="54d6b-126">Сведения об этих шаблонов, включая их идентификаторы записей публикуется в одноразовых таблице.</span><span class="sxs-lookup"><span data-stu-id="54d6b-126">Information about these templates, including their entry identifiers, is published in the one-off table.</span></span> <span data-ttu-id="54d6b-127">Одноразовых таблиц при MAPI вызывает метод **IABLogon::GetOneOffTable** или метод **IMAPIProp::OpenProperty** контейнер адресной книги для запроса **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) свойство или когда поставщик вызывает метод **IMAPISupport::GetOneOffTable**.</span><span class="sxs-lookup"><span data-stu-id="54d6b-127">One-off tables are displayed when MAPI calls either the **IABLogon::GetOneOffTable** method or an address book container's **IMAPIProp::OpenProperty** method to request the **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property or when a provider calls **IMAPISupport::GetOneOffTable**.</span></span> <span data-ttu-id="54d6b-128">Для получения дополнительных сведений см [IABLogon::GetOneOffTable](iablogon-getoneofftable.md), [IMAPIProp::OpenProperty](imapiprop-openproperty.md)и [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span><span class="sxs-lookup"><span data-stu-id="54d6b-128">For more information, see [IABLogon::GetOneOffTable](iablogon-getoneofftable.md), [IMAPIProp::OpenProperty](imapiprop-openproperty.md), and [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span>
  
<span data-ttu-id="54d6b-129">Чтобы создать новый раза, пользователь выбирает один из шаблонов, перечисленные в таблице одноразовых.</span><span class="sxs-lookup"><span data-stu-id="54d6b-129">To create a new one-off, a user selects one of the templates listed in the one-off table.</span></span> <span data-ttu-id="54d6b-130">Клиент передает в столбце PR_ENTRYID из выбранную строку, которая идентификатор записи одноразовых шаблон выбранного шаблона, **IAddrBook::NewEntry** с помощью параметра _lpEIDNewEntryTpl_ .</span><span class="sxs-lookup"><span data-stu-id="54d6b-130">The client passes the PR_ENTRYID column from the selected row, which is the one-off template entry identifier of the selected template, to **IAddrBook::NewEntry** in the  _lpEIDNewEntryTpl_ parameter.</span></span> <span data-ttu-id="54d6b-131">Для получения дополнительных сведений см [IAddrBook::NewEntry](iaddrbook-newentry.md).</span><span class="sxs-lookup"><span data-stu-id="54d6b-131">For more information, see [IAddrBook::NewEntry](iaddrbook-newentry.md).</span></span> <span data-ttu-id="54d6b-132">MAPI используется идентификатор записи одноразовых шаблона для отображения шаблона и разрешает пользователю введите сведения, необходимые для создания получателя.</span><span class="sxs-lookup"><span data-stu-id="54d6b-132">MAPI uses the one-off template entry identifier to display the template and to allow the user to enter the information needed to create the recipient.</span></span> 
  
<span data-ttu-id="54d6b-133">Идентификатор шаблона — это идентификатор входа, некоторые поставщиками адресных книг по их получателей в дополнение к идентификатор записи, которая хранится в свойстве PR_ENTRYID.</span><span class="sxs-lookup"><span data-stu-id="54d6b-133">A template identifier is an entry identifier that some address book providers assign to their recipients in addition to the entry identifier that is kept in the PR_ENTRYID property.</span></span> <span data-ttu-id="54d6b-134">Поставщики свойства получателя **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) для хранения идентификатору шаблона.</span><span class="sxs-lookup"><span data-stu-id="54d6b-134">Providers set a recipient's **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property to store its template identifier.</span></span> <span data-ttu-id="54d6b-135">Некоторые поставщиками адресных книг назначение такое же значение для свойства запись идентификатор и идентификатор шаблона получателя.</span><span class="sxs-lookup"><span data-stu-id="54d6b-135">Some address book providers assign the same value for a recipient's template identifier and entry identifier properties.</span></span>
  
<span data-ttu-id="54d6b-136">Шаблон идентификаторов используются только с поставщиками адресной книги и по MAPI для привязки данные получателей в один поставщик, называется поставщик узла на код для получателя в другой поставщик, называется внешнего поставщика.</span><span class="sxs-lookup"><span data-stu-id="54d6b-136">Template identifiers are used only by address book providers and by MAPI to bind recipient data in one provider, referred to as the host provider, to code for the recipient in another provider, referred to as the foreign provider.</span></span> <span data-ttu-id="54d6b-137">Поставщик узла предоставляет хранилище для получателя; внешний поставщик логику.</span><span class="sxs-lookup"><span data-stu-id="54d6b-137">The host provider supplies the storage for the recipient; the foreign provider supplies the logic.</span></span> <span data-ttu-id="54d6b-138">Процесс привязки позволяет обновлять данные получателя хранятся с использованием кода внешнего поставщика этот поставщик.</span><span class="sxs-lookup"><span data-stu-id="54d6b-138">The binding process enables a host provider to update the data of a recipient that it stores using the code of a foreign provider.</span></span>
  
<span data-ttu-id="54d6b-139">Когда поставщик узла будет готов для изменения ее получателя, свойство PR_TEMPLATEID передается в вызов метода **IMAPISupport::OpenTemplateID** для запуска процесса привязки.</span><span class="sxs-lookup"><span data-stu-id="54d6b-139">When the host provider is ready to modify its recipient, it passes the PR_TEMPLATEID property in a call to the **IMAPISupport::OpenTemplateID** method to initiate the binding process.</span></span> <span data-ttu-id="54d6b-140">MAPI продолжит процесс путем передачи идентификатора шаблона для соответствующего внешнего поставщика путем вызова метода **IABLogon::OpenTemplateID** .</span><span class="sxs-lookup"><span data-stu-id="54d6b-140">MAPI continues the process by transferring the template identifier to the appropriate foreign provider through a call to its **IABLogon::OpenTemplateID** method.</span></span> <span data-ttu-id="54d6b-141">Для получения дополнительных сведений см [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) и [IABLogon::OpenTemplateID](iablogon-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="54d6b-141">For more information, see [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) and [IABLogon::OpenTemplateID](iablogon-opentemplateid.md).</span></span> <span data-ttu-id="54d6b-142">Внешний поставщик возвращает указатель на его реализация **IMAPIProp** для получателя, который поставщик узла можно использовать вместо собственная реализация.</span><span class="sxs-lookup"><span data-stu-id="54d6b-142">The foreign provider returns a pointer to its **IMAPIProp** implementation for the recipient, which the host provider can use in place of its own implementation.</span></span> 
  


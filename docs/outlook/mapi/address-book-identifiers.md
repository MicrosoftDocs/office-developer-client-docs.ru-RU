---
title: Идентификаторы адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 40f6c699-86aa-4324-a30d-12c8f1e2de9c
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 822d83c4b77d06c2e000b391c7e229985470ccd3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33421573"
---
# <a name="address-book-identifiers"></a><span data-ttu-id="07e29-103">Идентификаторы адресной книги</span><span class="sxs-lookup"><span data-stu-id="07e29-103">Address Book Identifiers</span></span>

  
  
<span data-ttu-id="07e29-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="07e29-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="07e29-105">Все поставщики адресных книг назначают идентификаторы записей **с помощью свойства PR_ENTRYID** [(PidTagEntryId)](pidtagentryid-canonical-property.md)своим объектам пользователей сообщений и списков рассылки.</span><span class="sxs-lookup"><span data-stu-id="07e29-105">All address book providers assign entry identifiers using the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property to their messaging user and distribution list objects.</span></span> <span data-ttu-id="07e29-106">Клиентские приложения используют эти идентификаторы записей для открытия и доступа к объектам, которым они назначены.</span><span class="sxs-lookup"><span data-stu-id="07e29-106">Client applications use these entry identifiers to open and access the objects to which they are assigned.</span></span>
  
<span data-ttu-id="07e29-107">Адресная книга использует три других типа идентификаторов для представления объектов:</span><span class="sxs-lookup"><span data-stu-id="07e29-107">The address book makes use of three other types of identifiers to represent objects:</span></span>
  
- <span data-ttu-id="07e29-108">Одноразовые идентификаторы записей</span><span class="sxs-lookup"><span data-stu-id="07e29-108">One-off entry identifiers</span></span>
    
- <span data-ttu-id="07e29-109">Идентификаторы входов в шаблоны один раз</span><span class="sxs-lookup"><span data-stu-id="07e29-109">One-off template entry identifiers</span></span>
    
- <span data-ttu-id="07e29-110">Идентификаторы шаблонов</span><span class="sxs-lookup"><span data-stu-id="07e29-110">Template identifiers</span></span>
    
<span data-ttu-id="07e29-111">Из-за разнообразия идентификаторов записей и сходства, с которыми они именуются, легко запутаться в том, как каждый тип используется и создается.</span><span class="sxs-lookup"><span data-stu-id="07e29-111">Because of the variety of entry identifiers and the similarity with which they are named, it is easy to become confused about how each type is used and created.</span></span> 
  
<span data-ttu-id="07e29-112">Идентификатор для разной записи — это идентификатор записи, который используется для открытия и доступа к типу получателя, известному как разовый или настраиваемый получатель.</span><span class="sxs-lookup"><span data-stu-id="07e29-112">A one-off entry identifier is an entry identifier that is used to open and access the type of recipient known as a one-off, or custom recipient.</span></span> <span data-ttu-id="07e29-113">Односемейные получатели — это получатели, которые не принадлежат ни одному из поставщиков адресных книг в профиле.</span><span class="sxs-lookup"><span data-stu-id="07e29-113">One-offs are recipients that do not belong to any of the address book providers in the profile.</span></span> <span data-ttu-id="07e29-114">Идентификаторы записей, предназначенные для разных получателей, используют формат, специально зарезервированный для разных получателей.</span><span class="sxs-lookup"><span data-stu-id="07e29-114">The entry identifiers assigned to one-offs use a format specifically reserved for one-off recipients.</span></span> <span data-ttu-id="07e29-115">Поскольку идентификаторы разных входов используются для открытия и доступа к объектам, они хранятся в PR_ENTRYID свойстве.</span><span class="sxs-lookup"><span data-stu-id="07e29-115">Because one-off entry identifiers are used to open and access objects, they are stored in the PR_ENTRYID property.</span></span>
  
<span data-ttu-id="07e29-116">Создаются идентификаторы одноавтных и одноавтных записей:</span><span class="sxs-lookup"><span data-stu-id="07e29-116">One-offs and one-off entry identifiers are created:</span></span>
  
- <span data-ttu-id="07e29-117">Когда пользователи клиентского приложения выбирают добавить получателя, который не представляет ни одной записи в адресной книге, в список получателей сообщения.</span><span class="sxs-lookup"><span data-stu-id="07e29-117">When users of a client application elect to add a recipient that does not represent any entry in the address book to a message's recipient list.</span></span>
    
- <span data-ttu-id="07e29-118">Когда пользователи клиентского приложения выбирают добавить получателя, который не представляет никакой записи в адресной книге, в контейнер модифицированной адресной книги.</span><span class="sxs-lookup"><span data-stu-id="07e29-118">When users of a client application elect to add a recipient that does not represent any entry in the address book to a modifiable address book container.</span></span>
    
- <span data-ttu-id="07e29-119">Когда поставщик транспорта получает сообщение с адресом, который не может обрабатываться его связанным поставщиком адресной книги.</span><span class="sxs-lookup"><span data-stu-id="07e29-119">When a transport provider receives a message with an address that cannot be handled by its related address book provider.</span></span>
    
- <span data-ttu-id="07e29-120">Когда поставщик транспорта получает сообщение с адресом, который принадлежит шлюзу.</span><span class="sxs-lookup"><span data-stu-id="07e29-120">When a transport provider receives a message with an address that belongs to a gateway.</span></span>
    
<span data-ttu-id="07e29-121">В первых двух ситуациях клиент вызывает **IAddrBook::CreateOneOff,** чтобы связать идентификатор разовой записи с вновь созданным разовым получателем.</span><span class="sxs-lookup"><span data-stu-id="07e29-121">In the first two situations, the client calls **IAddrBook::CreateOneOff** to associate a one-off entry identifier with the newly created one-off recipient.</span></span> <span data-ttu-id="07e29-122">Во втором двух ситуациях поставщик транспорта вызывает **IMAPISupport::CreateOneOff,** чтобы связать идентификатор одноразовой записи с иностранным адресом.</span><span class="sxs-lookup"><span data-stu-id="07e29-122">In the second two situations, the transport provider calls **IMAPISupport::CreateOneOff** to associate a one-off entry identifier with the foreign address.</span></span> <span data-ttu-id="07e29-123">Дополнительные сведения см. [в книге IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) и [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span><span class="sxs-lookup"><span data-stu-id="07e29-123">For more information, see [IAddrBook::CreateOneOff](iaddrbook-createoneoff.md) and [IMAPISupport::CreateOneOff](imapisupport-createoneoff.md).</span></span>
  
<span data-ttu-id="07e29-124">Идентификатор входа в один шаблон — это краткосрочный идентификатор записи, который используется для открытия и доступа к шаблону для создания разов.</span><span class="sxs-lookup"><span data-stu-id="07e29-124">A one-off template entry identifier is a short-term entry identifier that is used to open and access a template for creating one-offs.</span></span> <span data-ttu-id="07e29-125">Поставщики адресных книг и шаблоны поставок MAPI для ввода сведений, необходимых для создания получателя определенного типа.</span><span class="sxs-lookup"><span data-stu-id="07e29-125">Both address book providers and MAPI supply templates for entering the information that is required to create a recipient of a particular type.</span></span> <span data-ttu-id="07e29-126">Сведения об этих шаблонах, включая идентификаторы записей, публикуются в разовой таблице.</span><span class="sxs-lookup"><span data-stu-id="07e29-126">Information about these templates, including their entry identifiers, is published in the one-off table.</span></span> <span data-ttu-id="07e29-127">Разовые таблицы отображаются, когда MAPI вызывает свойство **IABLogon::GetOneOffTable** или метод **IMAPIProp::OpenProperty**  для запроса свойства PR_CREATE_TEMPLATES [(PidTagCreateTemplates)](pidtagcreatetemplates-canonical-property.md)или когда поставщик вызывает **IMAPISupport::GetOneOffTable**.</span><span class="sxs-lookup"><span data-stu-id="07e29-127">One-off tables are displayed when MAPI calls either the **IABLogon::GetOneOffTable** method or an address book container's **IMAPIProp::OpenProperty** method to request the **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) property or when a provider calls **IMAPISupport::GetOneOffTable**.</span></span> <span data-ttu-id="07e29-128">Дополнительные сведения см. в [iABLogon::GetOneOffTable,](iablogon-getoneofftable.md) [IMAPIProp::OpenProperty](imapiprop-openproperty.md)и [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span><span class="sxs-lookup"><span data-stu-id="07e29-128">For more information, see [IABLogon::GetOneOffTable](iablogon-getoneofftable.md), [IMAPIProp::OpenProperty](imapiprop-openproperty.md), and [IMAPISupport::GetOneOffTable](imapisupport-getoneofftable.md).</span></span>
  
<span data-ttu-id="07e29-129">Для создания нового разового шаблона пользователь выбирает один из шаблонов, перечисленных в разовой таблице.</span><span class="sxs-lookup"><span data-stu-id="07e29-129">To create a new one-off, a user selects one of the templates listed in the one-off table.</span></span> <span data-ttu-id="07e29-130">Клиент передает столбец PR_ENTRYID из выбранной строки, которая является идентификатором ввода шаблона выбранного шаблона, в **IAddrBook::NewEntry** в параметре _lpEIDNewEntryTpl._</span><span class="sxs-lookup"><span data-stu-id="07e29-130">The client passes the PR_ENTRYID column from the selected row, which is the one-off template entry identifier of the selected template, to **IAddrBook::NewEntry** in the  _lpEIDNewEntryTpl_ parameter.</span></span> <span data-ttu-id="07e29-131">Дополнительные сведения см. [в книге IAddrBook::NewEntry.](iaddrbook-newentry.md)</span><span class="sxs-lookup"><span data-stu-id="07e29-131">For more information, see [IAddrBook::NewEntry](iaddrbook-newentry.md).</span></span> <span data-ttu-id="07e29-132">MAPI использует идентификатор входа в шаблон, чтобы отобразить шаблон и разрешить пользователю вводить сведения, необходимые для создания получателя.</span><span class="sxs-lookup"><span data-stu-id="07e29-132">MAPI uses the one-off template entry identifier to display the template and to allow the user to enter the information needed to create the recipient.</span></span> 
  
<span data-ttu-id="07e29-133">Идентификатор шаблона — это идентификатор записи, который некоторые поставщики адресных книг назначают получателям в дополнение к идентификатору записи, который хранится в свойстве PR_ENTRYID.</span><span class="sxs-lookup"><span data-stu-id="07e29-133">A template identifier is an entry identifier that some address book providers assign to their recipients in addition to the entry identifier that is kept in the PR_ENTRYID property.</span></span> <span data-ttu-id="07e29-134">Поставщики устанавливают свойство  PR_TEMPLATEID[(PidTagTemplateid)](pidtagtemplateid-canonical-property.md)для хранения его идентификатора шаблона.</span><span class="sxs-lookup"><span data-stu-id="07e29-134">Providers set a recipient's **PR_TEMPLATEID** ([PidTagTemplateid](pidtagtemplateid-canonical-property.md)) property to store its template identifier.</span></span> <span data-ttu-id="07e29-135">Некоторые поставщики адресных книг назначают одинаковое значение для свойств идентификатора шаблона получателя и идентификатора записи.</span><span class="sxs-lookup"><span data-stu-id="07e29-135">Some address book providers assign the same value for a recipient's template identifier and entry identifier properties.</span></span>
  
<span data-ttu-id="07e29-136">Идентификаторы шаблонов используются только поставщиками адресных книг и MAPI для привязки данных получателей в одном поставщике, который называется хост-провайдером, для кода получателя в другом поставщике, именуемом иностранным поставщиком.</span><span class="sxs-lookup"><span data-stu-id="07e29-136">Template identifiers are used only by address book providers and by MAPI to bind recipient data in one provider, referred to as the host provider, to code for the recipient in another provider, referred to as the foreign provider.</span></span> <span data-ttu-id="07e29-137">Поставщик хостов поставляет хранилище для получателя; иностранный поставщик поставляет логику.</span><span class="sxs-lookup"><span data-stu-id="07e29-137">The host provider supplies the storage for the recipient; the foreign provider supplies the logic.</span></span> <span data-ttu-id="07e29-138">Процесс привязки позволяет хост-поставщику обновлять данные получателя, которые он хранит с помощью кода иностранного поставщика.</span><span class="sxs-lookup"><span data-stu-id="07e29-138">The binding process enables a host provider to update the data of a recipient that it stores using the code of a foreign provider.</span></span>
  
<span data-ttu-id="07e29-139">Когда поставщик хостов готов изменить получателя, он передает свойство PR_TEMPLATEID в вызов к методу **IMAPISupport::OpenTemplateID** для инициации процесса привязки.</span><span class="sxs-lookup"><span data-stu-id="07e29-139">When the host provider is ready to modify its recipient, it passes the PR_TEMPLATEID property in a call to the **IMAPISupport::OpenTemplateID** method to initiate the binding process.</span></span> <span data-ttu-id="07e29-140">MAPI продолжает процесс, передав идентификатор шаблона соответствующему иностранному поставщику с помощью вызова на его **метод IABLogon::OpenTemplateID.**</span><span class="sxs-lookup"><span data-stu-id="07e29-140">MAPI continues the process by transferring the template identifier to the appropriate foreign provider through a call to its **IABLogon::OpenTemplateID** method.</span></span> <span data-ttu-id="07e29-141">Дополнительные сведения см. [в таблице IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) и [IABLogon::OpenTemplateID](iablogon-opentemplateid.md).</span><span class="sxs-lookup"><span data-stu-id="07e29-141">For more information, see [IMAPISupport::OpenTemplateID](imapisupport-opentemplateid.md) and [IABLogon::OpenTemplateID](iablogon-opentemplateid.md).</span></span> <span data-ttu-id="07e29-142">Иностранный поставщик возвращает указатель для реализации **IMAPIProp** для получателя, который поставщик хост может использовать взамен собственной реализации.</span><span class="sxs-lookup"><span data-stu-id="07e29-142">The foreign provider returns a pointer to its **IMAPIProp** implementation for the recipient, which the host provider can use in place of its own implementation.</span></span> 
  


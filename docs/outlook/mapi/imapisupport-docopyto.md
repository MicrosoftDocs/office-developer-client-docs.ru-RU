---
title: имаписуппортдокопито
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISupport.DoCopyTo
api_type:
- COM
ms.assetid: 84019475-5176-4fc5-a3ee-871095077498
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 6f6c802f1d5ead1750c05fafc54533487fe3732a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32331810"
---
# <a name="imapisupportdocopyto"></a>IMAPISupport::DoCopyTo

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Копирует или перемещает все свойства одного объекта, за исключением явно исключенных свойств, в другой объект.
  
```cpp
HRESULT DoCopyTo(
  LPCIID lpSrcInterface,
  LPVOID lpSrcObj,
  ULONG ciidExclude,
  LPCIID rgiidExclude,
  LPSPropTagArray lpExcludeProps,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  LPCIID lpDestInterface,
  LPVOID lpDestObj,
  ULONG ulFlags,
  LPSPropProblemArray FAR * lppProblems
);
```

## <a name="parameters"></a>Параметры

 _лпсрЦинтерфаце_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к объекту, свойства которого необходимо скопировать или переместить.
    
 _лпсркобж_
  
> возврата Указатель на объект, содержащий свойства, которые необходимо скопировать или переместить.
    
 _Циидексклуде_
  
> возврата Количество интерфейсов, которые необходимо исключить при копировании или перемещении свойств.
    
 _ргиидексклуде_
  
> возврата Массив идентификаторов интерфейса, указывающий интерфейсы, которые не следует использовать при копировании или перемещении дополнительных сведений в целевой объект.
    
 _лпексклудепропс_
  
> возврата Указатель на массив тегов свойств, определяющий теги свойств, которые следует исключить из операции копирования или перемещения. При передаче значения NULL в параметре _лпексклудепропс_ показывается, что все свойства объекта должны быть скопированы или перемещены. **Докопито** возвращает MAPI_E_INVALID_PARAMETER, когда элемент **квалуес** структуры [Спроптагаррай](sproptagarray.md) , на который указывает _лпексклудепропс_ , имеет значение 0. 
    
 _улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения. 
    
 _лппрогресс_
  
> возврата Указатель на реализацию индикатора хода выполнения. Если в параметре _лппрогресс_ передается значение null, MAPI предоставляет реализацию хода выполнения. Параметр _лппрогресс_ игнорируется, если в параметре _ulFlags_ не задан флаг MAPI_DIALOG. 
    
 _лпдестинтерфаце_
  
> возврата Указатель на идентификатор интерфейса, представляющий интерфейс, который будет использоваться для доступа к объекту для получения скопированных или перемещенных свойств.
    
 _лпдестобж_
  
> возврата Указатель на объект, который будет получать скопированные или перемещенные свойства.
    
 _ulFlags_
  
> возврата Битовая маска флагов, управляющих операциями копирования или перемещения. Можно задать следующие флаги:
    
MAPI_DIALOG 
  
> Отображает индикатор хода выполнения. 
    
MAPI_MOVE 
  
> **Докопито** должен выполнять операцию перемещения, а не операцию копирования. Если этот флаг не задан, **докопито** выполняет операцию копирования. 
    
MAPI_NOREPLACE 
  
> Существующие свойства в целевом объекте не должны быть перезаписаны. Если этот флаг не задан, **докопито** перезаписывает существующие свойства. 
    
 _лпппроблемс_
  
> вышли На входе указатель на указатель на структуру [спроппроблемаррай](spropproblemarray.md) ; в противном случае — значение NULL, которое указывает на отсутствие необходимости в сведениях об ошибке. Если _лпппроблемс_ является допустимым указателем на входе, **докопито** возвращает подробные сведения об ошибках при копировании одного или нескольких свойств. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Свойства успешно скопированы или перемещены.
    
MAPI_E_COLLISION 
  
> Свойство, которое необходимо скопировать или переместить, уже существует в целевом объекте, а флаг MAPI_NOREPLACE установлен. 
    
MAPI_E_FOLDER_CYCLE 
  
> Исходный объект напрямую или косвенно содержит целевой объект. Прежде чем было обнаружено это условие, можно выполнить значительную работу, чтобы исходный и конечный объекты могли быть изменены частично. 
    
MAPI_E_INTERFACE_NOT_SUPPORTED 
  
> Интерфейс, определенный параметром _лпсрЦинтерфаце_ , не поддерживается объектом, на который указывает _лпсркобж_, или интерфейс, определенный параметром _лпдестинтерфаце_ , не поддерживается объектом, на который указывает _лпдестобж_. 
    
MAPI_E_NO_ACCESS 
  
> Предпринята попытка получить доступ к объекту, для которого вызывающая сторона не имеет достаточных разрешений. Эта ошибка возвращается, если целевой объект совпадает с исходным объектом.
    
MAPI_E_INVALID_PARAMETER 
  
> Параметр _лпсрЦинтерфаце_ имеет значение null. 
    
Следующие значения могут возвращаться в структуре **спроппроблемаррай** , но не в качестве возвращаемых значений для **докопито**. Эти ошибки относятся к одному свойству.
  
MAPI_E_BAD_CHARWIDTH 
  
> Установлен установленный флаг MAPI_UNICODE и **докопито** не поддерживает Юникод, или MAPI_UNICODE не задан и **Докопито** поддерживает только Юникод. 
    
MAPI_E_COMPUTED 
  
> Абонент не может изменить свойство, так как оно является свойством только для чтения, которое вычисляется владельцем целевого объекта. Эта ошибка не серьезна; вызывающая сторона должна разрешить продолжение операции копирования.
    
MAPI_E_INVALID_TYPE 
  
> Недопустимый тип свойства.
    
MAPI_E_UNEXPECTED_TYPE 
  
> Тип свойства не является типом, ожидаемым вызывающим абонентом.
    
## <a name="remarks"></a>Примечания

Метод **имаписуппорт::D окопито** реализован для объектов поддержки поставщика хранилища сообщений. Поставщики хранилища сообщений могут вызывать **докопито** для реализации метода [IMAPIProp:: CopyTo](imapiprop-copyto.md) для своих папок и сообщений. 
  
По умолчанию **докопито** копирует или перемещает все свойства одного объекта в другой объект. Любые подобъекты в исходном объекте автоматически включаются в операцию, а затем копируются или перемещаются целиком. 
  
Если какие-либо из скопированных или перемещенных свойств уже существуют в целевом объекте, существующие свойства перезаписываются новыми свойствами, если не установлен флаг MAPI_NOREPLACE в параметре _ulFlags_ . Существующие сведения в целевом объекте, которые не перезаписываются, остаются нетронутыми. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Чтобы исключить свойства из операции копирования или перемещения, добавьте их теги свойств в параметр _лпексклудепропс_ . Если вы передаете результаты с помощью макроса [PROP_TAG](prop_tag.md) для создания тега свойства из определенного идентификатора в массиве тегов свойств, все свойства с этим идентификатором будут исключены. Например, следующая запись в массиве тегов свойств вызывает исключение всех свойств с идентификатором 0x8002, независимо от типа. 
  
 `PROP_TAG(PT_LONG, 0x8002)`
  
Чтобы избежать копирования времени доставки сообщения при копировании сообщения в другую папку, укажите **PR_MESSAGE_DELIVERY_TIME** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md)) в теге свойства Exclude Array. Чтобы исключить список получателей сообщения, добавьте свойство **PR_MESSAGE_RECIPIENTS** ([PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)) в массив Exclude. Чтобы исключить вложения сообщения, добавьте в массив свойство **PR_MESSAGE_ATTACHMENTS** ([PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)).
  
Аналогичным образом, чтобы не допустить копирование или перемещение папки или таблицы иерархии контейнера или адресной книги, укажите **PR_CONTAINER_HIERARCHY** ([PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)) или **PR_CONTAINER_CONTENTS** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)) в теге свойства Exclude Array.
  
Пропускать ошибки MAPI_E_COMPUTED, возвращаемые в структуре **спроппроблемаррай** в параметре _лпппроблемс_ . 
  
Идентификатор интерфейса, на который указывает _лпсрЦинтерфаце_ , обычно совпадает с идентификатором интерфейса, на который указывает _лпдестинтерфаце_ . 
  
Если вы передаете допустимый идентификатор интерфейса в _лпдестинтерфаце_ , но недопустимый указатель в _лпдестобж_, результаты будут непредсказуемыми. Скорее всего, это приведет к сбою поставщика. 
  
И наоборот, если вы узнаете о дополнительной информации, которую не следует копировать или переместить, добавьте идентификаторы интерфейсов для интерфейсов, исключаемых из массива, переданного в параметре _ргиидексклуде_ . Например, если вы копируете сообщения, но не любые вложения сообщений, передавайте IID_IMessage в массиве _ргиидексклуде_ . **Докопито** игнорирует все интерфейсы, перечисленные в _ргиидексклуде_ , которые не распознаются. 
  
При использовании параметра _ргиидексклуде_ для исключения интерфейса он также исключает все интерфейсы, полученные из этого интерфейса. Например, исключение из интерфейса [IMAPIContainer](imapicontainerimapiprop.md) приводит к исключению папок или контейнеров адресных книг в зависимости от типа поставщика. Не следует исключать [IMAPIProp](imapipropiunknown.md) или [IUnknown](https://msdn.microsoft.com/library/33f1d79a-33fc-4ce5-a372-e08bda378332%28Office.15%29.aspx) , так как многие интерфейсы являются производными от них. 
  
 **Докопито** сообщает о глобальных ошибках, которые применяются к операции в целом, и отдельных ошибках, которые применяются к отдельным свойствам. Эти отдельные ошибки помещаются в структуру **спроппроблемаррай** . Вы можете отключить отчеты об ошибках на уровне свойств, передав значение NULL, а не действительный указатель для параметра структуры массива проблем свойств. 
  
Если вы хотите получать сведения об ошибках, передайте допустимый указатель структуры **спроппроблемаррай** в параметр _лпппроблемс_ . Когда **докопито** возвращает S_OK, проверьте возможные ошибки с отдельными свойствами в структуре. Когда **докопито** возвращает ошибку, в структуре **спроппроблемаррай** не возвращается никакой информации. Вместо этого вызовите метод [имаписуппорт:: GetLastError](imapisupport-getlasterror.md) , чтобы получить подробные сведения об ошибке. 
  
Если **докопито** возвращает S_OK, освободите возвращаемую структуру **спроппроблемаррай** , вызвав функцию [мапифрибуффер](mapifreebuffer.md) . 
  
Если в вызове **докопито** возникает глобальная ошибка, не используйте и не освобождайте структуру **спроппроблемаррай** . Поставщики должны игнорировать элемент _улиндекс_ в структурах **спроппроблемаррай** , возвращаемых **докопито**.
  
## <a name="see-also"></a>См. также



[IMAPIProp::CopyTo](imapiprop-copyto.md)
  
[IMAPISupport::CopyFolder](imapisupport-copyfolder.md)
  
[IMAPISupport::CopyMessages](imapisupport-copymessages.md)
  
[IMAPISupport::GetLastError](imapisupport-getlasterror.md)
  
[Каноническое свойство PidTagContainerContents](pidtagcontainercontents-canonical-property.md)
  
[Каноническое свойство PidTagContainerHierarchy](pidtagcontainerhierarchy-canonical-property.md)
  
[Каноническое свойство PidTagMessageAttachments](pidtagmessageattachments-canonical-property.md)
  
[Каноническое свойство PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md)
  
[Каноническое свойство PidTagMessageRecipients](pidtagmessagerecipients-canonical-property.md)
  
[SPropProblemArray](spropproblemarray.md)
  
[SPropTagArray](sproptagarray.md)
  
[IMAPISupport: IUnknown](imapisupportiunknown.md)


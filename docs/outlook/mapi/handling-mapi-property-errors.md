---
title: Обработка ошибок свойство MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 23d68d8b-b0b6-4c32-8404-6acd23802db0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 82f37e2a6f6834c7a8553a3d9d364f7e657d81da
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22579510"
---
# <a name="handling-mapi-property-errors"></a>Обработка ошибок свойство MAPI

**Применимо к**: Outlook 2013 | Outlook 2016 
  
Вместо завершения сбоя или успеха следующие методы **IMAPIProp** сообщить о частичном успехе: 
  
[GetProps](imapiprop-getprops.md)
  
[SetProps](imapiprop-setprops.md)
  
[DeleteProps](imapiprop-deleteprops.md)
  
[CopyTo](imapiprop-copyto.md)
  
[CopyProps](imapiprop-copyprops.md)
  
**GetProps** отчетов частичного успеха при его можно получить по крайней мере один из запрошенного свойства для объекта. **GetProps** указывает частичный успех возвращение предупреждение MAPI_W_ERRORS_RETURNED и поместить сведения о свойствах, недоступны в массиве значение свойства указывает параметр **lppPropArray** . Запись недоступна свойство в этот массив содержит PT_ERROR тип свойства в элемент **ulPropTag** и MAPI_E_NOT_FOUND или другой соответствующего значения ошибки для элемента **значение** . Например если клиент вызывает метод **GetProps** папки для извлечения три свойства и третий недоступна, поставщика хранилища сообщений помещает PT_ERROR в третий тип свойства в массив значений свойств и MAPI_E_NOT_FOUND в третьей значение свойства. 
  
Другие методы **IMAPIProp** о частичном успехе по-разному. Эти методы о частичного успеха возвращает значение S_OK и поместить сведения об ошибке в структуре [SPropProblemArray](spropproblemarray.md) . В отличие от массива значение свойства в **GetProps** , который содержит данные, независимо от того, как метод выполнен успешно, так и не удалось, свойство массива проблемы в эти методы существует только в случае обнаружения ошибок и только в том случае, если вызывающий объект имеет зарегистрированных заинтересованность в общие сведения о ошибки. Вызывающие необходимо указать допустимое указатель **SPropProblemArray** регистрировать сведения об ошибке. 
  
Если возвращает код ошибки **SetProps**, **DeleteProps**, **CopyTo**или **CopyProps**, это значит, сбоя вместо частичный успех. Проблема массива свойства, если он доступен, недействительны. Клиенты не рекомендуется для доступа к данным, которые проводятся в структуре, а также они должны пытаться освободить самой структуре. Соответствующий ответ — вызов [IMAPIProp::GetLastError](imapiprop-getlasterror.md). 
  
**GetLastError** аналогична функции с таким же именем, входящий в пакет SDK для Windows. Оба предоставляют более подробные сведения об ошибке не возвращаемое значение. Обе они возвращают сведения о предыдущем произошедшей ошибки. Разница в том, что функция Win32 **GetLastError** отчетов об ошибках, вызывающий поток, а метод **IMAPIProp::GetLastError** отчетов об ошибках для текущего объекта. То есть если клиент вызывает **DeleteProps** на сообщение и MAPI_E_NO_ACCESS возвращается указать, что сообщение доступно только для чтения, **код последней ошибки** возвращается данные, предоставляемые сообщения. 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


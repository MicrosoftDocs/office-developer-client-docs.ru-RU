---
title: Обработка ошибок свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 23d68d8b-b0b6-4c32-8404-6acd23802db0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 1dc676101d4c39544c9dd1fae94000db9963ea02
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419081"
---
# <a name="handling-mapi-property-errors"></a>Обработка ошибок свойств MAPI

**Относится к**: Outlook 2013 | Outlook 2016 
  
Вместо полного сбоя или успеха следующие методы **IMAPIProp** отменяют частичный успех: 
  
[GetProps](imapiprop-getprops.md)
  
[SetProps](imapiprop-setprops.md)
  
[делетепропс](imapiprop-deleteprops.md)
  
[CopyTo](imapiprop-copyto.md)
  
[копипропс](imapiprop-copyprops.md)
  
При получении по крайней мере одного из запрошенных свойств объекта **PROPS** сообщает о частичном успехе. **PROPS** указывает на частичный успех, возвращая предупреждение MAPI_W_ERRORS_RETURNED и помещая сведения о недоступных свойствах в массиве значений свойств, на который указывает параметр **лпппропаррай** . Запись недоступного свойства в этом массиве содержит PT_ERROR для типа свойства в элементе **улпроптаг** и MAPI_E_NOT_FOUND или другое подходящее значение ошибки для элемента **value** . Например, если клиент вызывает метод **PROPS** папки для получения трех свойств, а третья недоступна, поставщик хранилища сообщений размещает PT_ERROR в третьем типе свойства в массиве значений свойства и MAPI_E_NOT_FOUND в третьем значении свойства. 
  
Другие методы **IMAPIProp** по-разному сообщают о частичном успехе. Эти методы отменяют частичный успех, возвращая S_OK и помещают сведения об ошибке в структуру [спроппроблемаррай](spropproblemarray.md) . В отличие от массива значений свойства в свойствах **PROPS** , которые содержат данные независимо от того, успешно ли выполнен метод или произошел сбой, массив ошибок свойств в этих методах существует только в том случае, если у вызывающего абонента есть зарегистрированный процент сведений об ошибках. Абоненты должны указать допустимый указатель **спроппроблемаррай** для регистрации сведений об ошибке. 
  
Когда значение ошибки возвращается из **SetProps**, **делетепропс**, **CopyTo**или **копипропс**, это указывает на ошибку, а не на частичное успешное выполнение. Недопустимый массив проблем свойств, если он доступен. Клиенты не должны пытаться получить доступ к данным, удерживаемым в структуре, и не должны пытаться освободить структуру. Соответствующий ответ заключается в вызове [IMAPIProp:: GetLastError](imapiprop-getlasterror.md). 
  
**GetLastError** похожа на функцию с тем же именем, что и в пакете SDK для Windows. Оба предоставляют более подробные сведения об ошибке, чем доступ к возвращаемому значению. Они оба возвращают сведения о предыдущей произошедшей ошибке. Разница заключается в том, что функция **GetLastError** Win32 сообщает об ошибке, созданной вызывающим потоком, и метод **IMAPIProp:: GetLastError** сообщает об ошибке, созданной текущим объектом. То есть, если клиент вызывает **делетепропс** для сообщения и возвращается MAPI_E_NO_ACCESS, чтобы указать, что сообщение доступно только для чтения, **GetLastError** возвращает данные, предоставляемые сообщением. 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


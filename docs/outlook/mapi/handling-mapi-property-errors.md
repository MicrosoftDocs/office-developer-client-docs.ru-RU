---
title: Обработка ошибок свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 23d68d8b-b0b6-4c32-8404-6acd23802db0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 1dc676101d4c39544c9dd1fae94000db9963ea02
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419081"
---
# <a name="handling-mapi-property-errors"></a>Обработка ошибок свойств MAPI

**Область применения**: Outlook 2013 | Outlook 2016 
  
Вместо полного сбоя или успешного выполнения следующие **методы IMAPIProp** сообщают о частичном успехе: 
  
[GetProps](imapiprop-getprops.md)
  
[SetProps](imapiprop-setprops.md)
  
[DeleteProps](imapiprop-deleteprops.md)
  
[CopyTo](imapiprop-copyto.md)
  
[CopyProps](imapiprop-copyprops.md)
  
**GetProps** сообщает о частичном успехе, когда он может получить хотя бы одно из запрашиваемого свойства для объекта. **GetProps** указывает на частичный успех, возвращая предупреждение MAPI_W_ERRORS_RETURNED и размещая сведения о недоступных свойствах в массиве значений свойств, указанных параметром **lppPropArray.** Запись недоступного свойства в этом массиве содержит PT_ERROR для типа свойства в члене **ulPropTag** и MAPI_E_NOT_FOUND или другое соответствующее значение ошибки для участника **Value.** Например, если клиент вызывает метод **GetProps** папки для получения трех свойств, а третий недоступен, поставщик магазина сообщений помещает PT_ERROR в третий тип свойства в массиве значений свойств и MAPI_E_NOT_FOUND в третьем значении свойства. 
  
Другие методы **IMAPIProp** по-разному сообщают о частичном успехе. Эти методы сообщают о частичном успехе, возвращая S_OK и размещая сведения об ошибках в [структуре SPropProblemArray.](spropproblemarray.md) В отличие от массива значений свойств **в GetProps,** который содержит данные независимо от того, был ли метод успешным или неудачным, массив проблем свойств в этих методах существует только в том случае, если имеются ошибки и только в том случае, если вызываемая зарегистрировано заинтересованность в изучении ошибок. Для регистрации сведений об ошибках звонителям необходимо указать допустимый указатель **SPropProblemArray.** 
  
Когда значение ошибки возвращается из **SetProps,** **DeleteProps,** **CopyTo** или **CopyProps,** это указывает на сбой, а не частичный успех. Массив проблем свойств, если он доступен, не является допустимым. Клиенты не должны пытаться получать доступ к данным, удерживаемой в структуре, и не должны пытаться освободить ее. Соответствующий ответ — вызвать [IMAPIProp::GetLastError](imapiprop-getlasterror.md). 
  
**GetLastError** аналогична функции с тем же именем, что и в Windows SDK. Оба предоставляют более подробные сведения об ошибке, чем доступно с возвратным значением. Они оба возвращают сведения о предыдущей ошибке, которая произошла. Разница заключается в том, что функция **Win32 GetLastError** сообщает об ошибке, вызываемой потоком вызовов, а метод **IMAPIProp::GetLastError** сообщает об ошибке, порожденной текущим объектом. То есть, если клиент вызывает **DeleteProps** в сообщении и возвращает MAPI_E_NO_ACCESS, чтобы указать, что сообщение только для чтения, **GetLastError** возвращает данные, предоставленные сообщением. 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


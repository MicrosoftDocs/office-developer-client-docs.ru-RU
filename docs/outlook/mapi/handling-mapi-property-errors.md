---
title: Обработка ошибок свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 23d68d8b-b0b6-4c32-8404-6acd23802db0
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 1dc676101d4c39544c9dd1fae94000db9963ea02
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419081"
---
# <a name="handling-mapi-property-errors"></a>Обработка ошибок свойств MAPI

**Относится к**: Outlook 2013 | Outlook 2016 
  
Вместо полного сбоя или успешного выполнения следующие методы **IMAPIProp** сообщают о частичном успехе: 
  
[GetProps](imapiprop-getprops.md)
  
[SetProps](imapiprop-setprops.md)
  
[DeleteProps](imapiprop-deleteprops.md)
  
[CopyTo](imapiprop-copyto.md)
  
[CopyProps](imapiprop-copyprops.md)
  
**GetProps** сообщает о частичном успешном результате, когда он может получить по крайней мере одно из запрашиваемого свойства объекта. **GetProps** указывает на частичный успех, MAPI_W_ERRORS_RETURNED предупреждение и размещение сведений о недоступных свойствах в массиве значений свойств, на который указывает параметр **lppPropArray.** Запись недоступного свойства в этом массиве содержит PT_ERROR для типа свойства в члене **ulPropTag** и MAPI_E_NOT_FOUND или другое соответствующее значение ошибки для члена **Value.** Например, если клиент вызывает метод **GetProps** папки для извлечения трех свойств, а третье недоступно, поставщик хранения сообщений помещает PT_ERROR в третий тип свойства в массиве значений свойств и MAPI_E_NOT_FOUND в третьем значении свойства. 
  
Другие методы **IMAPIProp** по-разному сообщают о частичном успехе. Эти методы сообщают о частичном успешном S_OK и помещают сведения об ошибке в структуру [SPropProblemArray.](spropproblemarray.md) В отличие от массива значений свойств **в GetProps,** который содержит данные независимо от того, был ли метод успешным или неудачным, массив проблем свойств в этих методах существует только в случае ошибок и только в том случае, если вызываемая компания зарегистрировала интерес к изучению ошибок. Для регистрации сведений об ошибке звонякам необходимо указать допустимый указатель **SPropProblemArray.** 
  
Если из **SetProps,** **DeleteProps,** **CopyTo** или **CopyProps** возвращается значение ошибки, это указывает на сбой вместо частичного успеха. Массив проблем свойств, если он доступен, является не допустимым. Клиенты не должны пытаться получить доступ к данным, которые удерживаются в структуре, и не должны пытаться освободить ее. Подходящий ответ — вызов [IMAPIProp::GetLastError.](imapiprop-getlasterror.md) 
  
**GetLastError** похож на функцию с тем же именем, что и в Windows SDK. Оба этих значения предоставляют более подробные сведения об ошибке, чем доступно в возвращаемом значении. Они оба возвращают сведения о предыдущей возникной ошибке. Разница заключается в том, что функция Win32 **GetLastError** сообщает об ошибке, генерируемой вызывателем, и метод **IMAPIProp::GetLastError** сообщает об ошибке, сгенерированной текущим объектом. То есть, если клиент вызывает **DeleteProps** для сообщения и возвращает MAPI_E_NO_ACCESS, чтобы указать, что сообщение только для чтения, **GetLastError** возвращает данные, предоставленные сообщением. 
  
## <a name="see-also"></a>См. также

- [Обзор свойств MAPI](mapi-property-overview.md)


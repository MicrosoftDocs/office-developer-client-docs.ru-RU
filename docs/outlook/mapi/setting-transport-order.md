---
title: Настройка порядка транспорта
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4a140ec3-9520-4119-a975-0fb6c1049967
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: efa2d6ab9edbd50634093b5185ef9036689f1379
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433600"
---
# <a name="setting-transport-order"></a>Настройка порядка транспорта

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Пулер MAPI назначает ответственность за исходяние сообщений на основе типов адресов и идентификаторов, которые поставщики транспорта объявляют, что они могут обрабатывать. Поставщики транспорта публикуют список поддерживаемых типов адресов и идентификаторов, хранимых в структурах **MAPIUID,** когда MAPI вызывает их метод [IXPLogon::AddressTypes](ixplogon-addresstypes.md) непосредственно после логарифма. Тип адреса получателя хранится в его свойстве **PR_ADDRTYPE** ([PidTagAddressType).](pidtagaddresstype-canonical-property.md)
  
Регистрация для типа адреса указывает MAPI, что поставщик транспорта может  доставить получателям с PR_ADDRTYPE свойства зарегистрированного типа адреса. Аналогичным образом, регистрация **MAPIUID** означает, что поставщик транспорта может доставить получателям, представленным идентификаторами записей с зарегистрированным **MAPIUID.**
  
Большинство поставщиков транспорта регистрируются для одного или более типов адресов; несколько регистрируются **с помощью MAPIUID.** Поставщики транспорта, тесно совмещение с поставщиком адресной книги и понимание формата идентификатора записи, могут регистрироваться для обработки сообщений с помощью **MAPIUID,** тем самым повышая производительность. Эти тесно сжатые поставщики транспорта могут извлечь адрес электронной почты получателя и другие необходимые сведения из идентификатора записи, не открывая его с помощью вызова **IMAPISupport::OpenEntry.** 
  
MAPI поддерживает порядок для поставщиков транспорта, используемый при регистрации нескольких поставщиков транспорта для одного типа адреса или **MAPIUID.** Этот порядок можно переопредить, вызывая [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md) и передавая упорядоченный список **mapIUID** всех активных поставщиков транспорта, на которые указывает параметр _lpUIDList.:_ 
  
Чтобы получить список всех типов адресов, которые могут обрабатываться одним из активных поставщиков транспорта, вызовите [IMAPISession::EnumAdrTypes](imapisession-enumadrtypes.md). **EnumAdrTypes** возвращает массив строк, описывая типы адресов, поддерживаемые поставщиками транспорта, которые активны в текущем сеансе. 
  


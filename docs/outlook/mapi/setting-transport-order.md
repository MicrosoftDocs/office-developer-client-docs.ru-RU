---
title: Настройка порядка транспортировки
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4a140ec3-9520-4119-a975-0fb6c1049967
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: efa2d6ab9edbd50634093b5185ef9036689f1379
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433600"
---
# <a name="setting-transport-order"></a>Настройка порядка транспортировки

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Spooler MAPI назначает ответственность за исходяние сообщений на основе типов адресов и идентификаторов, которые поставщики транспорта заявляют, что они могут обрабатывать. Поставщики транспорта публикуют список поддерживаемых типов адресов и идентификаторов, хранимых в структурах **MAPIUID,** когда MAPI вызывает их [метод IXPLogon::AddressTypes](ixplogon-addresstypes.md) непосредственно после логотипа. Тип адреса получателя хранится в **свойстве PR_ADDRTYPE** [(PidTagAddressType).](pidtagaddresstype-canonical-property.md)
  
Регистрация типа адресов указывает MAPI, что поставщик транспорта может доставить  получателям PR_ADDRTYPE свойства, заданная для зарегистрированного типа адреса. Кроме того, регистрация **mapIUID** указывает, что поставщик транспорта может доставить получателям, представленным идентификаторами входа с зарегистрированным **MAPIUID.**
  
Большинство поставщиков транспорта регистрируются для одного или более типов адресов; немногие зарегистрироваться **в MAPIUID**. Поставщики транспорта, тесно соединая с поставщиком адресной книги и понимаюющие формат идентификатора записи, могут регистрироваться для обработки сообщений **mapIUID,** тем самым повышая производительность. Эти поставщики транспорта с тесной связи могут извлекать адрес электронной почты получателя и другие необходимые сведения из идентификатора записи, не открывая его с помощью **вызова IMAPISupport::OpenEntry.** 
  
MAPI поддерживает порядок для поставщиков транспорта, используемый при регистрации нескольких поставщиков транспорта для одного типа адресов или **MAPIUID.** Переопределять этот порядок можно, позвонив [в IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md) и передав упорядоченный список **mapIUID** s всех активных поставщиков транспорта, на которые указывает параметр _lpUIDList.:_ 
  
Чтобы получить список всех типов адресов, которые могут обрабатываться одним из активных поставщиков транспорта, позвоните [в службу IMAPISession::EnumAdrTypes.](imapisession-enumadrtypes.md) **EnumAdrTypes** возвращает массив строк, которые описывают типы адресов, поддерживаемые поставщиками транспорта, активными в текущем сеансе. 
  


---
title: Реализация просмотра форм
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a567185c-bd72-4307-928c-08cac5494c1a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bbd0792b0e3e3f274797fabd7f5d5eb49cfc73fd
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435819"
---
# <a name="implementing-a-form-viewer"></a>Реализация просмотра форм

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Зритель формы включает в себя три объекта: сайт сообщения, представление рекомендации раковины и контекст представления. Каждый из этих объектов позволяет взаимодействовать с сервером форм и его формами.
  
Сайт сообщений — это объект, реализующий [интерфейс IMAPIMessageSite: IUnknown](imapimessagesiteiunknown.md) и помогающий серверам форм с такими задачами, как перемещение, сохранение или удаление сообщений, создание новых сообщений или запуск новых серверов форм. Сайты сообщений используются формами для получения сведений о состоянии клиента в отношении различных поставщиков услуг. Например, форма может использовать ваш сайт сообщений для получения указателя в текущем хранилище сообщений, сообщении или папке. 
  
В интерфейсе **IMAPIMessageSite** существует два типа методов: 
  
- Методы, которые предоставляют информацию для формирования объектов.
    
- Методы, которые манипулируют сообщениями.
    
Методы, которые предоставляют информацию для формирования объектов, просты в реализации. Во всех случаях, кроме [IMAPIMessageSite::GetSiteStatus,](imapimessagesite-getsitestatus.md)вы уже должны иметь доступ к информации, требуемой каждым методом.
  
Методы, которые манипулируют сообщениями, должны действовать так, как если бы они были вызваны с помощью обычного пользовательского интерфейса. Например, если объект формы вызывает метод [IMAPIMessageSite::NewMessage,](imapimessagesite-newmessage.md) ведите себя так, будто пользователь решил составить новое пользовательское сообщение с помощью обычного пользовательского интерфейса. Команды, которые обычно генерируют такое поведение: **Compose,** **Open,** **Reply,** **Reply to All Recipients** и **Forward**. 
  
Контекст представления — это объект, который реализует [интерфейс IMAPIViewContext: IUnknown](imapiviewcontextiunknown.md) и предоставляет серверам форм контекст для текущего сообщения, что позволяет серверам легко переключаться на следующее или предыдущее сообщение в папке. Форма использует контекст представления для обмена информацией. С объектом контекста представления форма может: 
  
- Зарегистрируйтесь у клиента для уведомлений.
    
- Активируйте следующее или предыдущее сообщение в папке.
    
- Получить сведения о печати.
    
- Получите состояние клиента.
    
- Получите поток, который можно использовать для сохранения текстовой версии сообщения.
    
Как и методы в [интерфейсе IMAPIMessageSite: IUnknown,](imapimessagesiteiunknown.md) методы **в IMAPIViewContext** соотносятся с действиями пользователей и функциями клиентов, которые связаны с контекстом представления. Например, контекст представления включается в активацию следующего или предыдущего сообщения, сортировку содержимого папки и фильтрацию содержимого папки. 
  
Не важно, какой механизм вы предоставляете пользователям для активации этих функций, важно только, чтобы семантика этих функций хорошо соотносима с методами в интерфейсе **IMAPIViewContext.** 
  
Представление советовать раковина является объектом, который реализует [интерфейс IMAPIViewAdviseSink : IUnknown](imapiviewadvisesinkiunknown.md) и обрабатывает уведомления с серверов форм, которые влияют на вашего зрителя и помочь формам и форме зрителей для совместной работы. Дополнительные сведения см. в [рублях Отправка и получение уведомлений о форме.](sending-and-receiving-form-notifications.md) 
  


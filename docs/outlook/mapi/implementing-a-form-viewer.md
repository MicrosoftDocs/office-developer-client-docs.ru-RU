---
title: Реализация средства просмотра форм
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a567185c-bd72-4307-928c-08cac5494c1a
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bbd0792b0e3e3f274797fabd7f5d5eb49cfc73fd
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435819"
---
# <a name="implementing-a-form-viewer"></a>Реализация средства просмотра форм

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Средство просмотра форм включает три объекта: сайт сообщений, приемник уведомлений о представлении и контекст представления. Каждый из этих объектов позволяет взаимодействовать с сервером форм и формами.
  
Сайт сообщения — это объект, который реализует интерфейс [имапимессажесите: IUnknown](imapimessagesiteiunknown.md) и помогает серверам форм создавать такие задачи, как перемещение, сохранение или удаление сообщений, создание новых сообщений или запуск новых серверов форм. Сайты сообщений используются формами для получения сведений о состоянии клиента по отношению к различным поставщикам услуг. Например, форма может использовать ваш сайт сообщений для получения указателя на текущее хранилище сообщений, сообщение или папку. 
  
В интерфейсе **имапимессажесите** существует два типа методов: 
  
- Методы, предоставляющие сведения для объектов Form.
    
- Методы, управляющие сообщениями.
    
Методы, которые предоставляют сведения для объектов формы, просты для реализации. Во всех случаях, кроме [имапимессажесите:: жетситестатус](imapimessagesite-getsitestatus.md), у вас уже должны быть сведения, необходимые для каждого метода.
  
Методы, управляющие сообщениями, должны действовать так, как если бы они были активированы с помощью обычного пользовательского интерфейса. Например, если объект Form вызывает метод [имапимессажесите:: невмессаже](imapimessagesite-newmessage.md) , то будет действовать так, как если бы пользователь выбрал создание нового настраиваемого сообщения с обычным пользовательским интерфейсом. Как правило, в этом случае создаются такие команды, как **Создание**, **Открытие**, **ответ**, **ответ всем получателям**и **Пересылка**. 
  
Контекст представления — это объект, который реализует интерфейс [имапивиевконтекст: IUnknown](imapiviewcontextiunknown.md) и предоставляет серверы форм с контекстом для текущего сообщения, позволяя серверам легко переходить к следующему или предыдущему сообщению в папке. Для обмена сведениями в форме используется контекст представления. С помощью объекта контекста представления форма может: 
  
- Регистрация у клиента для получения уведомлений.
    
- Активация следующего или предыдущего сообщения в папке.
    
- Получение сведений о печати.
    
- Получение состояния клиента.
    
- Получение потока, который можно использовать для сохранения текстовой версии сообщения.
    
Аналогично методам в интерфейсе [имапимессажесите: IUnknown](imapimessagesiteiunknown.md) методы в **имапивиевконтекст** сопоставляются с действиями пользователя и клиентскими функциями, которые относятся к контексту представления. Например, контекст представления включает активацию следующего или предыдущего сообщения, сортировку содержимого папки и фильтрацию содержимого папки. 
  
Не важно, какой механизм вы предоставляете пользователям для активации этих функций, поэтому важно, чтобы семантика этих функций хорошо сопоставлена с методами в интерфейсе **имапивиевконтекст** . 
  
Приемник рекомендаций по просмотру — это объект, который реализует интерфейс [имапивиевадвисесинк: IUnknown](imapiviewadvisesinkiunknown.md) и обрабатывает уведомления от серверов форм, которые влияют на средство просмотра и формы справки и средства просмотра форм для совместной работы. Дополнительную информацию можно узнать в статье [Отправка и получение уведомлений формы](sending-and-receiving-form-notifications.md). 
  


---
title: Регистрация служб и поставщиков служб в MapiSvc. INF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: a04acf17-4b2d-458e-9852-b6074acac096
description: 'Дата последнего изменения: 18 июля 2013 г.'
ms.openlocfilehash: adc6318ab36818b4c423bb6b1dc1b083b3fb54eb
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328373"
---
# <a name="registering-services-and-service-providers-in-mapisvcinf"></a>Регистрация служб и поставщиков служб в MapiSvc. INF

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Для установки нового поставщика в системе необходимо обновить файл MapiSvc. INF, указав нового поставщика. Стандартные свойства, заданные во время настройки, включая следующие, информируют MAPI, где найти библиотеку динамической компоновки поставщика (DLL):
  
- **PR_SERVICE_DLL_NAME** задаются в разделе **[Message Service]** . 
    
- **PR_PROVIDER_DLL_NAME** задаются в разделе **[Provider Service]** . 
    
> [!NOTE]
> Ожидается, что вы задаете имя DLL поставщика (без суффикса "32"). После этого MAPI загружает поставщик, выполняя поиск по пути. 
  
## <a name="putting-a-path-in-mapisvcinf"></a>Размещение пути в MapiSvc. INF

Большинство приложений устанавливаются в разделе Program Files, поэтому необходимо обновить переменную Path, чтобы разрешить поставщикам MAPI работать. С некоторыми ограничениями Microsoft Outlook 2010 и Outlook 2013 могут поддерживать полные пути к поставщикам MAPI.
  
При регистрации поставщика в MapiSvc. inf можно поместить полный путь к поставщику в свойствах MAPI **PR_SERVICE_DLL_NAME** и **PR_PROVIDER_DLL_NAME**.
  
В обоих свойствах полный путь должен быть без суффикса "32", так как MAPI продолжает добавлять его в имя файла, прежде чем искать файл. Это означает, что если вы зарегистрируете путь "к:\мипас\мипровидер.длл", MAPI предпримет попытку загрузить "c:\mypath\myprovider32.dll".
  
Так как MAPI Outlook изначально не предназначался для размещения полных путей, он выполняет эту вставку суффикса "32", выполняя поиск первого периода в строке, что означает, что пути, содержащие другие точки, не могут работать, поэтому нельзя использовать такие пути, как "к:\ми.пас\мипровидер.длл" или "к:\мипас\ми.провидер.длл".
  
Иногда в поставщике хранилища вы будете создавать идентификаторы записей с помощью функции **врапсторинтрид** , которая принимает в качестве параметра имя поставщика. 
  
> [!IMPORTANT]
> При использовании полных путей в MapiSvc. INF необходимо использовать один и тот же путь во всех вызовах **врапсторинтрид**. 
  
Кроме того, используемый путь можно преобразовать в Юникод и из него, используя кодовую страницу, предоставляемую функцией [жетакп](https://msdn.microsoft.com/library/windows/desktop/dd318070%28v=vs.85%29.aspx/) . 
  
> [!CAUTION]
> Если выбрать путь, который содержит символы, которые не могут быть циклически продерживаться, через функции [мултибитетовидечар](https://msdn.microsoft.com/library/windows/desktop/dd319072%28v=vs.85%29.aspx/) и [видечартомултибите](https://msdn.microsoft.com/library/windows/desktop/dd374130%28v=vs.85%29.aspx/) будет возникать ошибка. 
  
В качестве демонстрации этой функции вы перестроили [Пример упакованного PST](https://github.com/stephenegriffin/Outlook2010CodeSamples) -файла на сайте GitHub, и у вас есть соответствующие функции в **мержевисмаписвк** и **женератепровидерпас**.
  


---
title: Объекты и свойства MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 0aebf536-dcfb-406d-86ac-65db98c78139
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 7fef84b7519c7a9d6373198283e903fba4fd0780
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411213"
---
# <a name="mapi-objects-and-properties"></a>Объекты и свойства MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Некоторые свойства поддерживаются различными типами объектов. Следующие свойства являются примерами свойств, используемых несколькими объектами:
  
- **PR_ENTRYID** ([PidTagEntryId)](pidtagentryid-canonical-property.md)— это двоичный идентификатор, используемый для открытия объектов.
    
- **PR_OBJECT_TYPE** ([PidTagObjectType)](pidtagobjecttype-canonical-property.md)— константа, используемая для идентификации типа объекта.
    
- **PR_DISPLAY_NAME** ([PidTagDisplayName)](pidtagdisplayname-canonical-property.md)— это строка символов, используемая для описания объекта для пользователя.
    
Другие свойства имеют смысл для одного типа объекта. Следующие свойства являются примерами свойств, которые применяются к одному типу объекта:
  
- **PR_MESSAGE_CLASS** ([PidTagMessageClass)](pidtagmessageclass-canonical-property.md)— это строка символов, используемая для описания типа сообщения.
    
- **PR_ROWID** ([PidTagRowid)](pidtagrowid-canonical-property.md)— это integer, используемая для идентификации строки в таблице.
    
- **PR_ATTACH_SIZE** ([PidTagAttachSize)](pidtagattachsize-canonical-property.md)— это целый ряд, используемый для хранения количества вложений.
    
Другие свойства применимы только к одному типу объекта в определенном состоянии. Свойства этого типа обычно являются свойствами сообщений. Когда сообщение создается впервые, его набор свойств очень мал. По мере того как клиент отправляет его получателю через систему обмена сообщениями, количество свойств, необходимых для описания сообщения, увеличивается. Некоторые из этих добавленных свойств отображаются только в сообщении при его доставке, а другие отображаются только в сообщении при его доставке. Сообщения также имеют свойства, связанные с классом, к которому они принадлежат. Сообщения отчетов, например, имеют свойства, которые не поддерживаются сообщениями других классов, такими как сообщения заметок. 
  
Каждый объект имеет некоторые необходимые свойства и может иметь или не иметь других необязательных свойств. Необходимые свойства — это свойства, которые должны существовать в объекте, прежде чем можно будет успешно сохранить объект с помощью метода [IMAPIProp::SaveChanges.](imapiprop-savechanges.md) Клиенты или поставщики услуг, использующие объект, могут зависеть от доступности необходимых свойств после вызова **SaveChanges.** То есть они могут быть уверены, что вызов метода [IMAPIProp::GetProps](imapiprop-getprops.md) объекта или метода [IMAPIProp::OpenProperty](imapiprop-openproperty.md) для получения этих свойств будет успешным. 
  
Необязательные свойства — это свойства, которые, в зависимости от реализующих объектов, могут поддерживаться объектом или не поддерживаться. Клиент или поставщик услуг, использующий объект, не может ожидать, что необязательные свойства будут доступны с помощью методов **GetProps** или **OpenProperty** и будут иметь допустимые значения. 
  
Список или свойства в этом справочнике см. в [свойстве MAPI.](mapi-properties.md) Описания свойств, принадлежащих каждому объекту хранения сообщений и адресной книги, можно найти в обсуждении стандартного интерфейса объекта. Например, свойства папки обсуждаются с **IMAPIFolder,** а свойства пользователя сообщений — с **IMailUser.** Свойства сообщений, включая свойства сообщений отчетов, описываются с **помощью IMessage** и в обзоре [свойств сообщения.](message-properties-overview.md) Свойства, принадлежащие каждому из различных типов таблиц, описаны в соответствующей теме "Таблицы [MAPI".](mapi-tables.md) Например, свойства таблиц иерархии описаны в [таблицах иерархии.](hierarchy-tables.md) Свойства, принадлежащие серверам форм, описываются в выборе [набора свойств формы.](choosing-a-form-s-property-set.md)
  
Когда клиент или поставщик услуг вызывает метод **GetProps** объекта для получения нескольких его свойств и одно из этих свойств недоступно, **GetProps** возвращает предупреждение MAPI_W_ERRORS_RETURNED. Вызов считается успешным, так как были возвращены некоторые свойства. Когда клиент или поставщик услуг вызывает **OpenProperty** и целевое свойство недоступно, метод не удается с ошибкой MAPI_E_NOT_FOUND. Перед попыткой работы с ним важно проверить, возвращается ли запрашиваемая свойство. 
  
В зависимости от объекта, поставщик услуг, поставляющий реализацию, и свойства, свойство может иметь разрешение на чтение, записи или только для чтения. Разрешение на чтение и записи позволяет клиенту или поставщику служб изменить его значение, используя свойство; Разрешение только для чтения позволяет вносить изменения только поставщику услуг, владеюму объектом. 
  
Чтобы точно узнать, какие свойства в настоящее время настроены для объекта, вызовите [IMAPIProp::GetPropList.](imapiprop-getproplist.md) Метод **GetPropList** позволяет звонялю узнать, что доступно перед попыткой открыть потенциально несущественное свойство. Так как нет стандартного набора свойств, поддерживаемых всеми объектами определенного типа, невозможно угадать, поддерживает ли объект определенное свойство. Вызов **GetPropList** исключает угадать работу. 
  
## <a name="see-also"></a>См. также



[Объекты и свойства MAPI](mapi-objects-and-properties.md)


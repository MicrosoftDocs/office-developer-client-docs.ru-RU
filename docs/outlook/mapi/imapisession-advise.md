---
title: Имаписессионадвисе
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISession.Advise
api_type:
- COM
ms.assetid: a6a6b6b1-31e2-4899-a5fe-74d5d1c2ccfc
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: d5d87d7be9cb3524445107e975a298d4afd5bf98
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419837"
---
# <a name="imapisessionadvise"></a>IMAPISession::Advise

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Регистрируется для получения уведомлений об указанных событиях, влияющих на сеанс.
  
```cpp
HRESULT Advise(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulEventMask,
  LPMAPIADVISESINK lpAdviseSink,
  ULONG_PTR lpulConnection
);
```

## <a name="parameters"></a>Параметры

 _Кбентрид_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _Лпентрид_
  
> возврата Указатель на идентификатор записи адресной книги или объекта хранилища сообщений о том, какие уведомления должны быть созданы, или значение NULL, которое указывает на то, что клиент регистрируется для получения уведомлений о событиях, которые влияют только на сеанс. 
    
 _Улевентмаск_
  
> возврата Маска значений, указывающая типы событий уведомления, которые интересуются клиентом и должны быть включены в регистрацию. Если _лпентрид_ имеет значение null, MAPI автоматически регистрирует клиент для событий с критическими ошибками, которые влияют только на сеанс. Когда _лпентрид_ указывает на идентификатор записи, для параметра _улевентмаск_ допустимы следующие значения: 
    
Фневкритикалеррор 
  
> Регистрирует уведомления о серьезных ошибках, таких как недостаток памяти.
    
Фневекстендед 
  
> Регистрирует уведомления о событиях, относящихся к определенной адресной книге или поставщику хранилища сообщений, а также о завершении сеанса.
    
Фневневмаил 
  
> Регистрирует уведомления о поступлении новых сообщений. 
    
Фневобжекткреатед 
  
> Регистрирует уведомления о создании нового объекта.
    
Фневобжекткопиед
  
> Регистрирует уведомления о копируемом объекте.
    
Фневобжектделетед
  
> Регистрирует уведомления об удалении объекта.
    
Фневобжектмодифиед
  
> Регистрирует уведомления об изменяемом объекте.
    
Фневобжектмовед
  
> Регистрирует уведомления об перемещении объекта.
    
Фневсеарчкомплете
  
> Регистрирует уведомления о завершении операции поиска.
    
 _Лпадвисесинк_
  
> возврата Указатель на объект приемника уведомлений для получения последующих уведомлений. Этот объект приемника уведомлений должен быть уже выделен.
    
 _Лпулконнектион_
  
> вышли Указатель на ненулевое число, которое представляет соединение между объектом приемника уведомлений вызывающего абонента и сеансом.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Регистрация выполнена успешно.
    
МАПИ_Е_ИНВАЛИД_ЕНТРИД 
  
> Идентификатор записи, на который указывает _лпентрид_ , не представляет допустимый идентификатор записи. 
    
МАПИ_Е_НО_СУППОРТ 
  
> Поставщик услуг, ответственный за идентификатор записи, на который указывает _лпентрид_ , либо не поддерживает тип событий, указанных в параметре _улевентмаск_ , либо не поддерживает уведомление. 
    
МАПИ_Е_УНКНОВН_ЕНТРИД 
  
> Идентификатор записи, на который указывает _лпентрид_ , не может быть обработан ни одним из поставщиков услуг в профиле. 
    
## <a name="remarks"></a>Примечания

Метод **IMAPISession:: Advise** устанавливает соединение между объектом приемника уведомлений вызывающего абонента, сеансом и, при необходимости, поставщиком службы. Это подключение используется для отправки уведомлений в приемник уведомлений, когда одно или несколько событий, указанных в параметре _улевентмаск_ , происходят в объекте, на который указывает _лпентрид_. Если _лпентрид_ имеет значение null, то целевой объект является сеансом, а уведомления отправляются только для критических ошибок и расширенных событий. 
  
Когда _лпентрид_ указывает на допустимый идентификатор записи, MAPI вызывает метод **advise** объекта logon, принадлежащего поставщику услуг. Например, если _лпентрид_ указывает на идентификатор элемента списка рассылки, MAPI вызывает соответствующий метод поставщика адресных книг [Иаблогон:: Advise](iablogon-advise.md) . 
  
Чтобы отправить уведомление, поставщик услуг или MAPI вызывает зарегистрированный метод [имапиадвисесинк:: OnNotify](imapiadvisesink-onnotify.md) приемника уведомлений. Один из параметров для параметра **OnNotify**, структура уведомления содержит сведения, описывающие конкретное событие.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

В системах, поддерживающих несколько потоков выполнения, вызов onNotify **** также может выполняться в любом потоке в любое время. Если требуется гарантировать, что уведомления будут выполняться только в определенный момент в определенном потоке, вызовите функцию [хрсиссреададвисесинк](hrthisthreadadvisesink.md) , чтобы создать объект приемника уведомлений, передаваемый в метод **advise** . 
  
Чтобы определить, когда клиент вышел из системы, зарегистрируйте уведомления у поставщика услуг, вызвав предложение **advise** с _ЛПЕНТРИД_ , указав значение null, а для параметра _кбентрид_ значение 0. При выходе из системы вы получите уведомление Фневекстендед. 
  
После успешного выполнения вызова **advise** и до [IMAPISession:: unadvise](imapisession-unadvise.md) вызывается для отмены регистрации, освобождения объекта приемника уведомлений, если для него не задано конкретное долгосрочное использование. 
  
Обзор процесса уведомления представлен [в статье уведомление о событии в MAPI](event-notification-in-mapi.md). 
  
Более подробную информацию об обработке уведомлений можно узнать в статье [обработка уведомлений](handling-notifications.md). 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Баседиалог. cpp  <br/> |Кбаседиалог:: Оннотификатионсон  <br/> |MFCMAPI использует метод **IMAPISession:: Advise** для регистрации уведомлений в сеансе.  <br/> |
   
## <a name="see-also"></a>См. также



[IABLogon::Advise](iablogon-advise.md)
  
[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)
  
[IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)
  
[IMAPISession::Unadvise](imapisession-unadvise.md)
  
[IMAPISession: IUnknown](imapisessioniunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Уведомление о соБытии в MAPI](event-notification-in-mapi.md)


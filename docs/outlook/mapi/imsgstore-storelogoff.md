---
title: Имсгсторесторелогофф
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMsgStore.StoreLogoff
api_type:
- COM
ms.assetid: 3773c98e-531e-4bdc-a39a-2c3bb7378cd3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: be11c536804682d1baec8188b6d7487c71d411e1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424338"
---
# <a name="imsgstorestorelogoff"></a>IMsgStore::StoreLogoff

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Позволяет выполнять упорядоченный выход из хранилища сообщений.
  
```cpp
HRESULT StoreLogoff(
  ULONG FAR * lpulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпулфлагс_
  
> [вход, выход] Битовая маска флагов, которые управляют выходом из хранилища сообщений. Во входных данных все флаги, установленные для этого параметра, являются взаимоисключающими; вызывающий абонент должен указать только один флаг для каждого вызова. Следующие флаги допустимы для входных данных:
    
ЛОГОФФ_АБОРТ 
  
> Перед выходом из системы необходимо остановить все действия поставщика транспорта для этого хранилища сообщений. Управление возвращается вызывающему абоненту после остановки действия. Если выполняется какое-либо действие поставщика транспорта, выход не выполняется и не происходит никаких изменений в работе диспетчера очереди MAPI или поставщиков транспорта. Если активность поставщика транспорта неактивна, то диспетчер очереди MAPI освобождает хранилище. 
    
ЛОГОФФ_НО_ВАИТ 
  
> Перед закрытием хранилище сообщений не должно ждать сообщений от поставщиков транспорта. Отправляются исХодящие сообщения, готовые к отправке. Если это хранилище содержит папку "Входящие" по умолчанию, все сообщения в процессе принимаются, а затем дальнейший прием отключен. После завершения всех действий Диспетчер очереди MAPI освобождает хранилище, а управление немедленно возвращается вызывающему абоненту. 
    
ЛОГОФФ_ОРДЕРЛИ 
  
> Хранилище сообщений не должно ждать получения информации от поставщиков транспорта перед закрытием. Сообщения, которые обрабатываются в данный момент, заполняются, но новые сообщения не обрабатываются. После завершения всех действий Диспетчер очереди MAPI освобождает хранилище, а управление немедленно возвращается поставщику хранилища. 
    
ЛОГОФФ_ПУРЖЕ 
  
> Выход должен работать так же, как при установке флага ЛОГОФФ_НО_ВАИТ, но для соответствующих поставщиков транспорта следует вызывать метод [иксплогон:: FlushQueues](ixplogon-flushqueues.md) или [Имапистатус:: FlushQueues](imapistatus-flushqueues.md) . Флаг ЛОГОФФ_ПУРЖЕ возвращает управление вызывающей стороне после завершения. 
    
ЛОГОФФ_КУИЕТ 
  
> Если выполняется какое-либо действие поставщика транспорта, выход из системы не выполняется.
    
    The following flags are valid on output:
    
ЛОГОФФ_ИНБАУНД 
  
> Входящие сообщения в настоящее время поступают.
    
ЛОГОФФ_АУТБАУНД 
  
> ИсХодящие сообщения находятся в процессе отправки.
    
ЛОГОФФ_АУТБАУНД_КУЕУЕ 
  
> ИсХодящие сообщения находятся в папке "исХодящие" (то есть в папке "исХодящие").
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Выход из системы успешно выполнен.
    
## <a name="remarks"></a>Примечания

Метод **IMsgStore:: сторелогофф** оказывает Управление взаимодействием между хранилищем сообщений и поставщиками транспорта в процессе выхода из системы. Вызов **сторелогофф** является допустимым только для хранилищ сообщений, используемых вызывающим абонентом. Например, если два клиента используют одно и то же хранилище сообщений и один из них вызывает **сторелогофф**, то хранилище сообщений немедленно освободится и управление возвращается вызывающему клиенту.
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Сохраните флаги, которые передаются в **сторелогофф** , и передайте их при вызове метода [Имаписуппорт:: сторелогоффтранспортс](imapisupport-storelogofftransports.md) . Не вызывайте **сторелогоффтранспортс** , пока счетчик ссылок хранилища сообщений не сбрасывается в ноль. Несколько вызовов **сторелогоффтранспортс** просто перезаписывают сохраненные флаги. 
  
Если в **сторелогофф** не был выполнен вызов до тех пор, пока значение счетчика ссылок банка сообщений достигнет нуля, установите флаг логофф_аборт в параметре _ulFlags_ , передаваемый в **сторелогоффтранспортс**.
  
## <a name="see-also"></a>См. также



[IMAPIStatus::FlushQueues](imapistatus-flushqueues.md)
  
[IMAPISupport::StoreLogoffTransports](imapisupport-storelogofftransports.md)
  
[IXPLogon::FlushQueues](ixplogon-flushqueues.md)
  
[IMsgStore: IMAPIProp](imsgstoreimapiprop.md)


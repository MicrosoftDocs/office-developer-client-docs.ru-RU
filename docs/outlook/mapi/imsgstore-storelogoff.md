---
title: IMsgStoreStoreLogoff
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMsgStore.StoreLogoff
api_type:
- COM
ms.assetid: 3773c98e-531e-4bdc-a39a-2c3bb7378cd3
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: a55fc361120472473bcba70152c153fb7824fb9e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22566553"
---
# <a name="imsgstorestorelogoff"></a>IMsgStore::StoreLogoff

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Включение упорядоченного выхода хранилища сообщений.
  
```cpp
HRESULT StoreLogoff(
  ULONG FAR * lpulFlags
);
```

## <a name="parameters"></a>Параметры

 _lpulFlags_
  
> [in, out] Битовая маска флаги, который управляет выхода из хранилища сообщений. Для ввода данных задайте для этого параметра все флаги являются взаимоисключающими; вызывающий объект необходимо указать только один флаг на вызов. Следующие флаги являются допустимыми на входные данные:
    
LOGOFF_ABORT 
  
> Какие-либо действия поставщика транспорта для хранилища должна быть прекращена до выхода из системы. Управление возвращается вызывающему после остановки активности. Если какие-либо действия поставщика транспорта с удалением, выхода из системы не происходит и не изменяется поведения очереди или транспорта поставщики MAPI. Если действие поставщика транспорта простоя, диспетчер очереди MAPI освобождает хранилище. 
    
LOGOFF_NO_WAIT 
  
> Хранилище сообщений не должна ожидать сообщения от поставщиками транспорта перед закрытием. Отправки исходящих сообщений, которые являются Готово к отправке. Если это хранилище содержит папки "Входящие" по умолчанию, полученного сообщения в процесс и затем отключено дальнейший приема. После завершения всех действий диспетчера очереди MAPI освобождает хранилище и управление немедленно возвращается вызывающему. 
    
LOGOFF_ORDERLY 
  
> Хранилище сообщений не должна ожидать сведений из поставщиков транспорта перед закрытием. Сообщения, которые обрабатываются в настоящее время завершения, но не новые сообщения обрабатываются. После завершения всех действий диспетчера очереди MAPI освобождает хранилище и управление немедленно возвращается поставщика хранилища. 
    
LOGOFF_PURGE 
  
> Выход из системы должны работать же, как если бы значение флага LOGOFF_NO_WAIT, но необходимо вызвать метод либо [IXPLogon::FlushQueues](ixplogon-flushqueues.md) , либо [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) для поставщиков соответствующий транспортный протокол. После завершения флаг LOGOFF_PURGE возвращает управление вызывающего абонента. 
    
LOGOFF_QUIET 
  
> Если какие-либо действия поставщика транспорта с удалением, выход из системы не должно происходить.
    
    The following flags are valid on output:
    
LOGOFF_INBOUND 
  
> Входящие сообщения поступают в настоящее время.
    
LOGOFF_OUTBOUND 
  
> Исходящие сообщения, в процессе отправки.
    
LOGOFF_OUTBOUND_QUEUE 
  
> Исходящие сообщения, ожидающие (то есть, они находятся в папке Исходящие).
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Выход из системы, успешно завершена.
    
## <a name="remarks"></a>Примечания

Метод **IMsgStore::StoreLogoff** оказывает управления через взаимодействие сообщение хранения и поставщиками транспорта во время выхода из системы. Вызов **StoreLogoff** допустимо только для хранилищ сообщений, которые используются только вызывающим абонентом. Например при два клиента с помощью одного хранилища сообщений и один из них вызывает **StoreLogoff**, сразу же выпущен хранилища сообщений и управление возвращается вызывающему клиенту.
  
## <a name="notes-to-implementers"></a>Примечания для реализующих

Сохраните флаги, которые передаются в **StoreLogoff** и передавайте их при вызове метода [IMAPISupport::StoreLogoffTransports](imapisupport-storelogofftransports.md) . Не вызывайте **StoreLogoffTransports** , пока число ссылок хранилища сообщений не станет нулевое значение. Несколько вызовов **StoreLogoffTransports** просто перезаписать сохраненного флаги. 
  
Если не вызов для **StoreLogoff** перед сообщением магазина число ссылок достигает нуля, задавать флаг LOGOFF_ABORT в параметре _ulFlags_ , передаваемый **StoreLogoffTransports**.
  
## <a name="see-also"></a>См. также



[IMAPIStatus::FlushQueues](imapistatus-flushqueues.md)
  
[IMAPISupport::StoreLogoffTransports](imapisupport-storelogofftransports.md)
  
[IXPLogon::FlushQueues](ixplogon-flushqueues.md)
  
[IMsgStore: IMAPIProp](imsgstoreimapiprop.md)


---
title: Разработка поставщика хранилища сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32316764"
---
# <a name="developing-a-mapi-message-store-provider"></a>Разработка поставщика хранилища сообщений MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Как и другие поставщики службы MAPI, хранилища сообщений — это библиотеки динамической компоновки (DLL), которые представляют службы базового механизма хранения для клиентских приложений MAPI и диспетчера очереди MAPI. Поставщик хранилища сообщений предоставляет базовый механизм хранения в виде иерархического набора папок и сообщений, которые могут использовать клиенты MAPI и Диспетчер очереди MAPI.
  
На следующем рисунке показана базовая архитектура хранилища сообщений MAPI.
  
**Архитектура хранилища сообщений**
  
![Архитектура хранилища сообщений] (media/storearc.gif "Архитектура хранилища сообщений")
  
Поставщик хранилища сообщений можно реализовать с помощью любого такого механизма хранения. Тем не менее, необходимо учитывать проблемы, связанные с производительностью. Кроме того, базовый механизм хранения необходимо представить в виде иерархической коллекции объектов MAPI. Эти требования означают, что хранилища сообщений обычно реализуются с помощью существующего продукта базы данных, поддерживающего иерархическое хранилище объектов в базе данных и имеющего программный интерфейс или строго определенную структуру файлов. Например, в качестве базового механизма хранения можно использовать базы данных Microsoft Office Access, SQL и Oracle. Некоторые продукты баз данных имеют наборы функций, которые упрощают реализацию функций MAPI, поэтому выбор продуктов базы данных может зависеть от возможностей, которые должен поддерживать поставщик хранилища сообщений.
  
Использование существующей базы данных в качестве базового механизма хранения позволяет сохранить работу, так как обычно упрощается предоставление объектов базы данных клиентам MAPI как объектов MAPI, чем реализация собственного механизма иерархической структуры хранилища. Это позволяет обрабатывать операции MAPI на более высоком уровне, чем при реализации собственного механизма иерархического хранилища. Например, при поиске сообщения с определенной темой тема становится довольно простой задачей создания и отправки соответствующего запроса к базе данных, а не реализации сложных подпрограмм для поиска в иерархическом механизме хранения.
  
Поставщики хранилищ сообщений взаимодействуют с клиентами MAPI и с помощью диспетчера очереди MAPI для выполнения операций над папками и объектами. Поставщик хранилища сообщений преобразует эти операции в операции более низкого уровня в базовом механизме хранения. Диспетчер очереди MAPI обычно обменивается данными с поставщиком хранилища сообщений при отправке и получении сообщений. Клиенты MAPI обычно взаимодействуют с поставщиками хранилищ сообщений для управления иерархией папок, чтения, редактирования, удаления и отправки сообщений.
  
Как диспетчер очереди MAPI, так и клиенты MAPI взаимодействуют с поставщиком хранилища сообщений для создания новых сообщений. Клиентские приложения делают это, когда пользователи составляют сообщение. Это происходит при получении входящего сообщения с помощью диспетчера очереди MAPI. В любом случае новое сообщение, как правило, создается в папке "Входящие" в хранилище сообщений (при его наличии).
  
Поставщики хранилищ сообщений интенсивно используют таблицы MAPI, папки, сообщения и свойства MAPI. Сведения о реализации этих объектов задокументированы в [таблицах MAPI](mapi-tables.md), [папках MAPI](mapi-folders.md), [сообщениях MAPI](mapi-messages.md)и [о свойствах MAPI](mapi-property-overview.md). Прежде чем приступать к внедрению поставщика хранилища сообщений, необходимо ознакомиться с этим материалом.
  
Существует два важных типа поставщиков хранилищ сообщений: те, которые могут использоваться в качестве хранилища сообщений пользователя по умолчанию, и те, которые не могут. По умолчанию используется хранилище сообщений, в котором клиентские приложения и Диспетчер очереди MAPI могут выполнять любые задачи обмена сообщениями, такие как получение сообщений или создание папок. Поставщик хранилища сообщений по умолчанию должен поддерживать несколько дополнительных функций, чем минимальное число, необходимое для всех поставщиков хранилищ сообщений.
  
## <a name="see-also"></a>См. также

- [Основные понятия MAPI](mapi-concepts.md)


---
title: Разработка поставщика хранилища сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412613"
---
# <a name="developing-a-mapi-message-store-provider"></a>Разработка поставщика хранилища сообщений MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Как и другие поставщики служб MAPI, хранилища сообщений представляют собой библиотеки динамических ссылок (DLLs), которые представляют службы базирующегося механизма хранения для клиентских приложений MAPI и spooler MAPI. Поставщик хранилища сообщений представляет механизм хранения в качестве иерархического набора папок и сообщений, которые могут использовать клиенты MAPI и шпалер MAPI.
  
На следующем рисунке показана базовая архитектура магазина сообщений MAPI.
  
**Архитектура хранилища сообщений**
  
![Архитектура архитектуры магазина](media/storearc.gif "сообщений")
  
Вы можете реализовать поставщика хранилища сообщений с помощью любого типа механизма хранения, который вам нравится. Однако необходимо знать о проблемах производительности. Кроме того, основной механизм хранения должен быть представлен в качестве иерархической коллекции объектов MAPI. Эти требования означают, что хранилища сообщений обычно реализуются с помощью существующего продукта базы данных, который поддерживает иерархическое хранение объектов в базе данных и имеет интерфейс программирования или четко определенную структуру файлов. Например, Microsoft Office, SQL и базы данных Oracle можно использовать в качестве механизма хранения данных. Некоторые продукты базы данных имеют наборы компонентов, которые упрощают реализацию функций MAPI, поэтому на выбор продукта базы данных могут повлиять функции, которые должен поддерживать поставщик магазинов сообщений.
  
Использование существующей базы данных в качестве баз данных в качестве баз данных позволяет сохранить работу, так как обычно клиентам MAPI проще представить объекты баз данных в качестве объектов MAPI, чем реализовать собственный иерархический механизм хранения. Это позволяет обрабатывать операции MAPI на более высоком уровне, чем при реализации собственного иерархического механизма хранения. Например, поиск сообщения с определенной темой становится довольно простым делом создания и отправки соответствующего запроса базы данных, а не реализации сложных процедур для поиска иерархического механизма хранения.
  
Поставщики магазинов сообщений взаимодействуют с клиентами MAPI и шпалером MAPI для выполнения операций на папках и объектах. Поставщик хранилища сообщений переводит эти операции в операции более низкого уровня в основном механизме хранения. Spooler MAPI обычно взаимодействует с поставщиком магазина сообщений при отправке и получении сообщений. Клиенты MAPI обычно взаимодействуют с поставщиками магазинов сообщений для управления иерархией папок и чтения, редактирования, удаления и отправки сообщений.
  
Клиенты MAPI и клиенты MAPI взаимодействуют с поставщиком магазина сообщений для создания новых сообщений. Клиентские приложения делают это, когда пользователи составляют сообщение. Spooler MAPI делает это, когда получает входящие сообщения. В любом случае новое сообщение обычно создается в папке "Входящие" в хранилище сообщений, если оно имеется.
  
Поставщики магазинов сообщений используют таблицы MAPI, папки, сообщения и свойства. Сведения о реализации этих объектов задокументированы в [таблицах MAPI,](mapi-tables.md) [папках MAPI,](mapi-folders.md) [сообщениях MAPI](mapi-messages.md)и [обзоре свойств MAPI.](mapi-property-overview.md) Прежде чем реализовать поставщика магазина сообщений, необходимо ознакомиться с этим материалом.
  
Существует два важных типа поставщиков хранения сообщений: те, которые могут выступать в качестве магазина сообщений по умолчанию пользователя, и те, которые не могут. Хранилище сообщений по умолчанию — это хранилище, в котором клиентские приложения и шпалер MAPI могут выполнять любую задачу обмена сообщениями, например получение сообщений или создание папок. Поставщик хранения сообщений по умолчанию должен поддерживать несколько дополнительных функций, чем минимальное число, необходимое для всех поставщиков магазина сообщений.
  
## <a name="see-also"></a>См. также

- [Концепции MAPI](mapi-concepts.md)


---
title: Разработка поставщика хранилища сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412613"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="4cde2-103">Разработка поставщика хранилища сообщений MAPI</span><span class="sxs-lookup"><span data-stu-id="4cde2-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="4cde2-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4cde2-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4cde2-105">Как и другие поставщики службы MAPI, хранилища сообщений — это библиотеки динамической компоновки (DLL), которые представляют службы базового механизма хранения для клиентских приложений MAPI и диспетчера очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cde2-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="4cde2-106">Поставщик хранилища сообщений предоставляет базовый механизм хранения в виде иерархического набора папок и сообщений, которые могут использовать клиенты MAPI и Диспетчер очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cde2-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="4cde2-107">На следующем рисунке показана базовая архитектура хранилища сообщений MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cde2-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="4cde2-108">**Архитектура хранилища сообщений**</span><span class="sxs-lookup"><span data-stu-id="4cde2-108">**Message store architecture**</span></span>
  
<span data-ttu-id="4cde2-109">Архитектура(media/storearc.gif "хранилища сообщений") ![архитектура]хранилища сообщений</span><span class="sxs-lookup"><span data-stu-id="4cde2-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="4cde2-110">Поставщик хранилища сообщений можно реализовать с помощью любого такого механизма хранения.</span><span class="sxs-lookup"><span data-stu-id="4cde2-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="4cde2-111">Тем не менее, необходимо учитывать проблемы, связанные с производительностью.</span><span class="sxs-lookup"><span data-stu-id="4cde2-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="4cde2-112">Кроме того, базовый механизм хранения необходимо представить в виде иерархической коллекции объектов MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cde2-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="4cde2-113">Эти требования означают, что хранилища сообщений обычно реализуются с помощью существующего продукта базы данных, поддерживающего иерархическое хранилище объектов в базе данных и имеющего программный интерфейс или строго определенную структуру файлов.</span><span class="sxs-lookup"><span data-stu-id="4cde2-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="4cde2-114">Например, в качестве базового механизма хранения можно использовать базы данных Microsoft Office Access, SQL и Oracle.</span><span class="sxs-lookup"><span data-stu-id="4cde2-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="4cde2-115">Некоторые продукты баз данных имеют наборы функций, которые упрощают реализацию функций MAPI, поэтому выбор продуктов базы данных может зависеть от возможностей, которые должен поддерживать поставщик хранилища сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cde2-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="4cde2-116">Использование существующей базы данных в качестве базового механизма хранения позволяет сохранить работу, так как обычно упрощается предоставление объектов базы данных клиентам MAPI как объектов MAPI, чем реализация собственного механизма иерархической структуры хранилища.</span><span class="sxs-lookup"><span data-stu-id="4cde2-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="4cde2-117">Это позволяет обрабатывать операции MAPI на более высоком уровне, чем при реализации собственного механизма иерархического хранилища.</span><span class="sxs-lookup"><span data-stu-id="4cde2-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="4cde2-118">Например, при поиске сообщения с определенной темой тема становится довольно простой задачей создания и отправки соответствующего запроса к базе данных, а не реализации сложных подпрограмм для поиска в иерархическом механизме хранения.</span><span class="sxs-lookup"><span data-stu-id="4cde2-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="4cde2-119">Поставщики хранилищ сообщений взаимодействуют с клиентами MAPI и с помощью диспетчера очереди MAPI для выполнения операций над папками и объектами.</span><span class="sxs-lookup"><span data-stu-id="4cde2-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="4cde2-120">Поставщик хранилища сообщений преобразует эти операции в операции более низкого уровня в базовом механизме хранения.</span><span class="sxs-lookup"><span data-stu-id="4cde2-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="4cde2-121">Диспетчер очереди MAPI обычно обменивается данными с поставщиком хранилища сообщений при отправке и получении сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cde2-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="4cde2-122">Клиенты MAPI обычно взаимодействуют с поставщиками хранилищ сообщений для управления иерархией папок, чтения, редактирования, удаления и отправки сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cde2-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="4cde2-123">Как диспетчер очереди MAPI, так и клиенты MAPI взаимодействуют с поставщиком хранилища сообщений для создания новых сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cde2-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="4cde2-124">Клиентские приложения делают это, когда пользователи составляют сообщение.</span><span class="sxs-lookup"><span data-stu-id="4cde2-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="4cde2-125">Это происходит при получении входящего сообщения с помощью диспетчера очереди MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cde2-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="4cde2-126">В любом случае новое сообщение, как правило, создается в папке "Входящие" в хранилище сообщений (при его наличии).</span><span class="sxs-lookup"><span data-stu-id="4cde2-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="4cde2-127">Поставщики хранилищ сообщений интенсивно используют таблицы MAPI, папки, сообщения и свойства MAPI.</span><span class="sxs-lookup"><span data-stu-id="4cde2-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="4cde2-128">Сведения о реализации этих объектов задокументированы в [таблицах MAPI](mapi-tables.md), [папках MAPI](mapi-folders.md), [сообщениях MAPI](mapi-messages.md)и [о свойствах MAPI](mapi-property-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4cde2-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="4cde2-129">Прежде чем приступать к внедрению поставщика хранилища сообщений, необходимо ознакомиться с этим материалом.</span><span class="sxs-lookup"><span data-stu-id="4cde2-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="4cde2-130">Существует два важных типа поставщиков хранилищ сообщений: те, которые могут использоваться в качестве хранилища сообщений пользователя по умолчанию, и те, которые не могут.</span><span class="sxs-lookup"><span data-stu-id="4cde2-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="4cde2-131">По умолчанию используется хранилище сообщений, в котором клиентские приложения и Диспетчер очереди MAPI могут выполнять любые задачи обмена сообщениями, такие как получение сообщений или создание папок.</span><span class="sxs-lookup"><span data-stu-id="4cde2-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="4cde2-132">Поставщик хранилища сообщений по умолчанию должен поддерживать несколько дополнительных функций, чем минимальное число, необходимое для всех поставщиков хранилищ сообщений.</span><span class="sxs-lookup"><span data-stu-id="4cde2-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="4cde2-133">См. также</span><span class="sxs-lookup"><span data-stu-id="4cde2-133">See also</span></span>

- [<span data-ttu-id="4cde2-134">Основные понятия MAPI</span><span class="sxs-lookup"><span data-stu-id="4cde2-134">MAPI concepts</span></span>](mapi-concepts.md)


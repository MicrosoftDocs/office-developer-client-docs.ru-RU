---
title: Разработка поставщика хранилища сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 36233d51f47c53d6a69494c0fcd799a7c83add29
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22567876"
---
# <a name="developing-a-mapi-message-store-provider"></a>Разработка поставщика хранилища сообщений MAPI
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Как и другие поставщики служб MAPI хранилищ сообщений, библиотеки динамической компоновки (DLL), которые представляют службы базовый механизм хранения для клиентских приложений MAPI и диспетчер очереди MAPI. Поставщик хранения сообщений представляет базовый механизм хранения виде иерархического набора папок и сообщений, которые могут использоваться клиентами MAPI и диспетчер очереди MAPI.
  
На следующем рисунке показана базовая архитектура хранилища сообщений MAPI.
  
**Архитектура хранилища сообщений**
  
![Архитектура хранилища сообщений] (media/storearc.gif "Архитектура хранилища сообщений")
  
Можно реализовать поставщик хранилища сообщений с помощью любого вида базовый механизм хранения продолжать. Тем не менее необходимо иметь в виду проблем с производительностью. Кроме того базовый механизм хранения должна быть представлена как Иерархическая коллекция объектов MAPI. Эти требования имели в виду, что хранилищ сообщений обычно реализуются с помощью существующего продукта базы данных, которая поддерживает иерархические хранение объектов в базе данных и имеет API-интерфейс или структура четко определенных файлов. Например базы данных Microsoft Office Access, SQL и Oracle можно использовать в качестве базового механизма хранения. Некоторые продукты базы данных имеют наборы компонентов, которые облегчают внедрять функции MAPI, поэтому Выбор продукта базы данных может влиять функции, которые должна поддерживать поставщика хранилища сообщений.
  
Использование существующей базы данных в качестве базового хранилища механизм экономит работают, так как они обычно легче присутствует объекты базы данных для клиентов MAPI как объекты MAPI чем реализовать собственный механизм иерархических хранилища. Это позволяет обрабатывать операций MAPI на высоком уровне, чем при реализации собственного механизм иерархических хранения. Например поиск сообщений с конкретной темой становится довольно просто создание и отправка запроса на соответствующую базу данных, а не реализации сложных процедуры для поиска вашей механизм иерархических хранения.
  
Поставщики хранилища сообщений общаться с клиентами MAPI и диспетчер очереди MAPI для выполнения операций в папки и объекты. Поставщик хранения сообщений преобразует эти операции в нижнем уровне операций на базовый механизм хранения. Диспетчер очереди MAPI обычно взаимодействует с поставщиком хранилища сообщений во время отправки и получения сообщений. Клиентов MAPI обычно связываться с поставщиками хранилища сообщений для работы с иерархии папок, а также читать, изменять, удалять и отправлять сообщения.
  
Диспетчер очереди MAPI и клиентов MAPI общаться с поставщиком хранилища сообщений, чтобы создать новые сообщения. Клиентские приложения для этого при создании сообщения пользователям. Диспетчер очереди MAPI выполняется при получении входящего сообщения. В любом случае нового сообщения обычно создается в папке "Входящие" хранилища сообщений, если он существует.
  
Поставщики хранилища сообщений сделать интенсивное использование таблиц, папок, сообщений и свойств MAPI. Сведения о реализации для этих объектов описаны в [Таблицах MAPI](mapi-tables.md), [Папки MAPI](mapi-folders.md), [Сообщения MAPI](mapi-messages.md)и [Обзор свойств MAPI](mapi-property-overview.md). Вам следует ознакомиться с этот материал перед попыткой реализации поставщика хранилища сообщений.
  
Существует два типа важные поставщиков хранилища сообщений: те, которые могут выступать в качестве пользователя по умолчанию сообщений хранилища и те, которые нельзя. Хранилище сообщений по умолчанию — это один в которой клиентские приложения и диспетчер очереди MAPI могут выполнять любые задачи обмена мгновенными сообщениями, такие как получение сообщений или создание папок. Поставщик хранилища сообщений по умолчанию должен поддерживать несколько больше возможностей, чем минимальное время, необходимое для всех поставщиков хранилища сообщений.
  
## <a name="see-also"></a>См. также

- [Основные понятия MAPI](mapi-concepts.md)


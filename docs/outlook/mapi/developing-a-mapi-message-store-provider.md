---
title: Разработка поставщика хранилища сообщений MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412613"
---
# <a name="developing-a-mapi-message-store-provider"></a>Разработка поставщика хранилища сообщений MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Как и другие поставщики услуг MAPI, хранилища сообщений представляют собой библиотеки динамической связи ( DLL), которые представляют службы механизма хранения для клиентских приложений MAPI и пула MAPI. Поставщик хранилища сообщений представляет механизм хранения в качестве иерархического набора папок и сообщений, которые могут использовать клиенты MAPI и пулер MAPI.
  
На следующем рисунке показана базовая архитектура хранения сообщений MAPI.
  
**Архитектура хранилища сообщений**
  
![Архитектура хранения сообщений](media/storearc.gif "")
  
Вы можете реализовать поставщика хранилища сообщений с помощью любого механизма хранения. Однако необходимо знать о проблемах с производительностью. Кроме того, основной механизм хранения должен быть представлен в качестве иерархической коллекции объектов MAPI. Эти требования означают, что хранилища сообщений обычно реализуются с помощью существующего продукта базы данных, который поддерживает иерархическое хранение объектов в базе данных и имеет программный интерфейс или четко определяемую структуру файлов. Например, Microsoft Office Access, SQL и Oracle можно использовать в качестве механизма хранения. Некоторые продукты баз данных имеют наборы функций, которые упрощают реализацию функций MAPI, поэтому выбор продукта базы данных может оказаться под влиянием функций, которые должен поддерживать ваш поставщик банка сообщений.
  
Использование существующей базы данных в качестве механизма хранения экономит работу, так как обычно проще представить объекты базы данных клиентам MAPI в качестве объектов MAPI, чем реализовать собственный иерархический механизм хранения. Это позволяет обрабатывать операции MAPI на более высоком уровне, чем при реализации собственного иерархического механизма хранения. Например, поиск сообщения с определенной строкой темы становится довольно простым вопросом создания и отправки соответствующего запроса базы данных вместо реализации сложных процедур для поиска в иерархическому механизму хранения.
  
Поставщики store сообщений взаимодействуют с клиентами MAPI и пулом MAPI для выполнения операций с папками и объектами. Поставщик хранилища сообщений преобразует эти операции в операции нижнего уровня в основном механизме хранения. Как правило, пульер MAPI взаимодействует с поставщиком store сообщений при отправке и получении сообщений. Клиенты MAPI обычно взаимодействуют с поставщиками store сообщений для управления иерархией папок, а также для чтения, редактирования, удаления и отправки сообщений.
  
Как клиенты MAPI, так и клиенты MAPI взаимодействуют с поставщиком банка сообщений для создания новых сообщений. Клиентские приложения делают это, когда пользователи составляют сообщение. Пулер MAPI делает это, когда получает входящие сообщения. В любом случае новое сообщение обычно создается в папке "Входящие" в хранилище сообщений, если оно существует.
  
Поставщики store сообщений интенсивно используют таблицы, папки, сообщения и свойства MAPI. Сведения о реализации этих объектов задокументированы в таблицах [MAPI,](mapi-tables.md)папках [MAPI,](mapi-folders.md) [сообщениях MAPI](mapi-messages.md)и [обзоре свойств MAPI.](mapi-property-overview.md) Прежде чем пытаться реализовать поставщика store сообщений, ознакомьтесь с этим материалом.
  
Существует два важных типа поставщиков store сообщений: те, которые могут действовать как хранилище сообщений пользователя по умолчанию, и те, которые не могут. Хранилище сообщений по умолчанию — это хранилище, в котором клиентские приложения и пулер MAPI могут выполнять любую задачу обмена сообщениями, например получение сообщений или создание папок. Поставщик по умолчанию для хранения сообщений должен поддерживать несколько дополнительных функций, чем минимальное число, необходимое для всех поставщиков.
  
## <a name="see-also"></a>См. также

- [Понятия MAPI](mapi-concepts.md)


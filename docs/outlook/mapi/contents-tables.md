---
title: Таблицы содержимого
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7b8efb4e-b5be-41b8-81bb-9aa1da421433
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 491381c771cae65e682acc8033b6558523847d3d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435588"
---
# <a name="contents-tables"></a>Таблицы содержимого

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Таблица содержимого содержит сведения об объектах в контейнере MAPI. Поставщики адресных книг реализуют таблицы содержимого для каждого из контейнеров, а хранилище сообщений и удаленные поставщики транспорта реализуют таблицы содержимого для своих папок. В таблице содержимого контейнера адресной книги представлены сведения об объектах обмена сообщениями и списках рассылки, а в таблице содержимого папки приведена информация о сообщениях. Таблицы содержимого используются в основном клиентскими приложениями. 
  
Существует два типа таблиц содержимого папок:
  
- Стандартные таблицы содержимого содержат стандартные сообщения — сообщения, которые могут быть переданы и сделаны видимыми для пользователя. 
    
- Связанные таблицы содержимого содержат скрытые, несохраняемые сведения, созданные клиентом для определенной цели, например для хранения альтернативного представления стандартного сообщения. Связанные сведения создаются путем передачи флага МАПИ_АССОЦИАТЕД в вызов [IMAPIFolder:: CreateMessage](imapifolder-createmessage.md) . 
    
Таблицы содержимого большинства контейнеров адресных книг и многих папок не поддерживают сортировку по категориям. 
  
Доступ к таблице содержимого можно получить с помощью вызова:
  
- [IMAPIContainer:: жетконтентстабле](imapicontainer-getcontentstable.md).
    
    - Также
    
- [IMAPIProp:: опенпроперти](imapiprop-openproperty.md) WITH **пр_контаинер_контентс** ([PidTagContainerContents](pidtagcontainercontents-canonical-property.md)) или **пр_фолдер_ассоЦиатед_контентс** ([PidTagFolderAssociatedContents](pidtagfolderassociatedcontents-canonical-property.md)) (только папки), указанные как тег свойства и IID _Имапитабле в качестве идентификатора интерфейса.
    
Поставщики хранилищ сообщений и адресных книг должны поддерживать оба способа извлечения свойств таблицы. Он неприемлемо для поставщиков, поддерживающих только один способ доступа к этим таблицам, так как клиенты ожидают выбора. 
  
 **Жетконтентстабле** принимает в качестве входных данных несколько флагов, определяющих предпочтения. Если этот параметр установлен, флаг МАПИ_АССОЦИАТЕД получает связанную таблицу содержимого. Так как некоторые папки не поддерживают связанное содержимое, и клиенты не могут заранее определить это время, **жетконтентстабле** иногда ВОЗВРАЩАЕТ ошибку мапи_е_но_суппорт при запросе связанной таблицы содержимого. 
  
Флаг МАПИ_ДЕФЕРРЕД_ЕРРОРС указывает разработчику таблицы на то, что все ошибки, обнаруженные во время вызова, не нужно сообщать до появления следующего момента. 
  
Вызов **IMAPIProp:: опенпроперти** включает доступ к таблице содержимого, открывая соответствующее свойство, **пр_контаинер_контентс** для таблиц содержимого адресных книг и таблиц содержимого стандартных папок и **пр_фолдер_ассоЦиатед_ СОДЕРЖИМОЕ** для связанных таблиц содержимого. Несмотря на то, что эти свойства не могут быть получены с помощью метода [IMAPIProp::](imapiprop-getprops.md) -PROPS папки или контейнера, они включаются в массив тегов свойств, который возвращается методом [IMAPIProp:: жетпроплист](imapiprop-getproplist.md) . 
  
 **Пр_контаинер_контентс** также можно использовать для включения или исключения таблицы содержимого из операции копирования. Если клиент указывает **пр_контаинер_контентс** в параметре *лпексклудепропс* для **IMAPIProp:: CopyTo** в операции копирования, Новая папка или контейнер не будет поддерживать таблицу содержимого исходной папки или контейнера. 
  
В таблицах контейнеров и папок адресной книги имеется длинный список обязательных столбцов — столбцов, которые клиенты могут ожидать после получения таблицы из **жетконтентстабле** или **опенпроперти**. Поставщики могут добавлять в этот обязательный набор, если это необходимо, а клиенты, с помощью метода **метода SetColumns** , также могут запрашивать изменения. 
  
Для каждого из типов таблиц содержимого требуются следующие столбцы:
  
|**Обязательный столбец**|**Таблица типов содержимого**|
|:-----|:-----|
|**Пр_аддртипе** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
|**Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
|**Пр_дисплай_кк** ([PidTagDisplayCc](pidtagdisplaycc-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_дисплай_то** ([PidTagDisplayTo](pidtagdisplayto-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_дисплай_типе** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
|**Пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md))  <br/> |Все таблицы содержимого  <br/> |
|**Пр_хасаттач** ([PidTagHasAttachments](pidtaghasattachments-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md))  <br/> |Все таблицы содержимого  <br/> |
|**Пр_ласт_модификатион_тиме** ([PidTagLastModificationTime](pidtaglastmodificationtime-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_маппинг_сигнатуре** ([PidTagMappingSignature](pidtagmappingsignature-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_мессаже_класс** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_мессаже_довнлоад_тиме** ([PidTagMessageDownloadTime](pidtagmessagedownloadtime-canonical-property.md))  <br/> |Таблицы удаленных транспортных папок  <br/> |
|**Пр_мессаже_флагс** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_мессаже_сизе** ([PidTagMessageSize](pidtagmessagesize-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_мсг_статус** ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_обжект_типе** ([PidTagObjectType](pidtagobjecttype-canonical-property.md))  <br/> |Все таблицы содержимого  <br/> |
|**Пр_парент_ентрид** ([PidTagParentEntryId](pidtagparententryid-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_рекорд_кэй** ([PidTagRecordKey](pidtagrecordkey-canonical-property.md))  <br/> |Таблицы папок адресных книг и папок хранилища сообщений  <br/> |
|**Пр_сент_репресентинг_наме** ([PidTagSentRepresentingName](pidtagsentrepresentingname-canonical-property.md))  <br/> |Таблицы удаленных транспортных папок  <br/> |
|**Пр_сторе_ентрид** ([PidTagStoreEntryId](pidtagstoreentryid-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_сторе_рекорд_кэй** ([PidTagStoreRecordKey](pidtagstorerecordkey-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
   
Идентификатор записи, доступный для каждой строки, может быть коротким или долгосрочным идентификатором записи в зависимости от реализации таблицы. Краткосрочные идентификаторы записей обычно используются в ситуациях, когда производительность является неисправностью. Для доступа к соответствующему объекту можно использовать любой тип идентификатора записи. 
  
Таблицы содержимого также имеют набор необязательных столбцов, которые обычно включаются поставщиками услуг в их реализациях. Эти необязательные столбцы:
  
|**НеОбязательный столбец**|**Таблица типов содержимого**|
|:-----|:-----|
|**Пр_клиент_субмит_тиме** ([PidTagClientSubmitTime](pidtagclientsubmittime-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_контент_каунт** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))  <br/> |Стандартные таблицы содержимого папки  <br/> |
|**Пр_контент_унреад** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md))  <br/> |Стандартные таблицы содержимого папки  <br/> |
|**PR_CONVERSATION_INDEX** ([PidTagConversationIndex](pidtagconversationindex-canonical-property.md))  <br/> |Таблицы папок хранилища сообщений  <br/> |
|**Пр_емаил_аддресс** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
|**Пр_импортанце** ([PidTagImportance](pidtagimportance-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_мессаже_деливери_тиме** ([PidTagMessageDeliveryTime](pidtagmessagedeliverytime-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_нормализед_субжект** ([PidTagNormalizedSubject](pidtagnormalizedsubject-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_приорити** ([PidTagPriority](pidtagpriority-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_сеарч_кэй** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
|**Пр_сенд_рич_инфо** ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
|**Пр_сендер_наме** ([PidTagSenderName](pidtagsendername-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_сенситивити** ([PidTagSensitivity](pidtagsensitivity-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_субжект** ([PidTagSubject](pidtagsubject-canonical-property.md))  <br/> |Все таблицы содержимого папки  <br/> |
|**Пр_трансмитабле_дисплай_наме** ([PidTagTransmittableDisplayName](pidtagtransmittabledisplayname-canonical-property.md))  <br/> |Таблицы контейнеров адресных книг  <br/> |
   
Кроме того, поставщики хранилища сообщений должны включать **пр_парент_дисплай** ([PidTagParentDisplay](pidtagparentdisplay-canonical-property.md)) для только таблиц содержимого папок результатов поиска.
  
Именованные свойства можно добавить в набор столбцов таблицы содержимого папки только в том случае, если все сообщения в папке имеют одинаковую подпись сопоставления, то есть одно сопоставление имен свойств с идентификаторами свойств. Таблицы содержимого папок должны поддерживать добавление определенных свойств класса сообщений в набор столбцов, если они поддерживают создание произвольных сообщений в папке.
  
Клиенты могут сохранить порядок сортировки по умолчанию для таблицы содержимого папки, вызвав его метод [IMAPIFolder:: савеконтентссорт](imapifolder-savecontentssort.md) . Если в вызове указан флаг РЕКУРСИВЕ_СОРТ, порядок сортировки можно применить ко всем вложенным папкам в папке. 
  
## <a name="see-also"></a>См. также



[Таблицы MAPI](mapi-tables.md)


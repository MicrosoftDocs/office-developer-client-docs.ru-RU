---
title: Установка формы в библиотеку
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 303c9dcb-f9b5-4cea-b5f2-3eba01aa3b09
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 08470a80153e42136922ae502252d83de0125512
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433145"
---
# <a name="installing-a-form-into-a-library"></a>Установка формы в библиотеку

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Диспетчер форм MAPI по умолчанию, поставляющийся с Windows SDK, не предоставляет пользовательский интерфейс для установки форм в различных библиотеках форм. По этой причине необходимо создать небольшое приложение (или подробный набор инструкций), которое пользователи могут использовать для установки формы.
  
При реализации приложения установки необходимо выполнить ряд действий для установки формы в связанную с папкой таблицу содержимого следующим образом:
  
1. Вызовите [функцию MAPIOpenFormMgr,](mapiopenformmgr.md) чтобы открыть диспетчер форм. 
    
2. Используйте [метод IMAPIFormMgr::OpenFormContainer](imapiformmgr-openformcontainer.md) или [IMAPIFormMgr::SelectFormContainer,](imapiformmgr-selectformcontainer.md) чтобы выбрать и открыть целевой контейнер для формы. 
    
3. Используйте [функцию IMAPIFormContainer::InstallForm](imapiformcontainer-installform.md) для установки формы. 
    
    Шаги 4–6 для установки в локализованную библиотеку форм:
    
4. Скопируйте все файлы в нужное место на локальном диске, если установка происходит в локализованную библиотеку форм на рабочей станции пользователя. При необходимости измените файл конфигурации формы, чтобы отразить текущие пути компонентов. Файл конфигурации формы может содержать относительные пути, в этом случае этот шаг может не потребоваться.
    
5. Выполните соответствующие действия регистрации OLE, чтобы связать тип сообщения с устанавливаемого сервера форм.
    
6. Если форма была установлена в локальной библиотеке форм, скопируйте файлы значка формы (.ico) и файлов конфигурации (CFG) в каталог %WINDOWS%\FORMS\CONFIGS, чтобы ее можно было автоматически восстановить на случай, если библиотека форм повреждена или удалена. Этот шаг рекомендуется, но не является обязательным.
    
> [!NOTE]
> Вы можете упростить установку в локальной библиотеке форм, заменив шаги 1 и 2 вызовом функции [MAPIOpenLocalFormContainer.](mapiopenlocalformcontainer.md) 
  
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


---
title: Объекты настраиваемой формы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4c1c04e5b04be9bb67b050f5cf498be89d380410
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318250"
---
# <a name="mapi-custom-form-objects"></a>Объекты настраиваемой формы MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Объекты для настраиваемой формы реализуются тремя различными компонентами:
  
- Сервер форм.
    
- Поставщик библиотеки форм.
    
- Зритель формы.
    
Сервер форм похож по функциональности на объект объектного приложения для сложных документов OLE. Это исполняемый компонент, который реализует форму; он управляет своим отображением и операциями, которые пользователь может выполнять. MAPI запускает сервер формы по запросу, когда пользователь хочет просматривать сообщение вместе с классом сообщений, отображаемым с помощью формы, поддерживаемой сервером форм. Серверы форм реализуют три объекта: объект фабрики форм, похожий на стандартный завод класса OLE, форму для обработки событий, характерных для формы, и сам форму. 
  
Поставщик библиотеки форм обеспечивает доступ клиентов к набору свойств формы, к контейнеру и объекту, который связывает сообщения определенного класса с сервером, который может открыть форму для этого класса. Поставщики библиотек форм реализуют три объекта: информационный объект формы, контейнер формы и диспетчер форм для привязки сообщения к соответствующему серверу форм на основе класса сообщения.
  
Просмотра форм является компонентом, который входит в клиенты, которые поддерживают отображение пользовательских форм в их папке зрителей. Зрители форм не являются независимыми компонентами MAPI, как и поставщики библиотек форм и серверы форм. Просмотр формы, запуск серверов форм и предоставление контекста для них. Зрители форм реализуют три объекта: сайт сообщения, контекст представления и раковину рекомендации для обработки событий, определенных представлениям.
  
В следующей таблице описываются все настраиваемые объекты формы. 
  
|**Объект Form**|**Описание**|
|:-----|:-----|
|Form  <br/> |Управление отображением и функционированием настраиваемой формы для просмотра сообщений определенного класса.  <br/> |
|Форма советовать раковина  <br/> |Обрабатывает уведомления от просмотра форм.  <br/> |
|Фабрика форм  <br/> |Создает экземпляр формы и позволяет серверу оставаться в памяти.  <br/> |
|Контейнер формы  <br/> |Содержит сведения о форме.  <br/> |
|Сведения о форме  <br/> |Содержит сообщения и другие контейнеры сообщений.  <br/> |
|Диспетчер форм  <br/> |Предоставляет доступ к интегрированному представлению пользовательских сведений о формах, связанных со всеми установленными формами. Также совпадает классы сообщений с соответствующими идентификаторами классов форм.  <br/> |
|Сайт сообщений  <br/> |Обрабатывает манипуляции с объектами формы изнутри клиента и предоставляет доступ к объекту диспетчера форм.  <br/> |
|Просмотр контекста  <br/> |Поддерживает команды форм для активации следующих и предыдущих сообщений, а также для сохранения или печати.  <br/> |
|Просмотр рекомендации по раковине  <br/> |Обрабатывает уведомления с сервера форм.  <br/> |
   
На следующем рисунке показана связь между настраиваемые компоненты форм, объектами и интерфейсами, которые они реализуют, и компонентами, которые являются пользователями объектов. Обратите внимание, что в отличие от большинства других объектов MAPI объект формы реализует два интерфейса, не связанных прямым наследованием. Если объект предоставляет несколько независимых интерфейсов, пользователь объекта с указателем на один из интерфейсов может получить указатель на любой из других интерфейсов. Эта возможность перемещения между реализацией интерфейса объекта является особенностью метода [IUnknown::QueryInterface.](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) 
  
**Компоненты настраиваемых форм**
  
![Настраиваемые компоненты](media/amapi_67.gif "формы Настраиваемые компоненты формы")
  
## <a name="see-also"></a>См. также

- [Обзор объектов и интерфейсов MAPI](mapi-object-and-interface-overview.md)


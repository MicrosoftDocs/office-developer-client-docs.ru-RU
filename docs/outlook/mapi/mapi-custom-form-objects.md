---
title: Объекты настраиваемой формы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4c1c04e5b04be9bb67b050f5cf498be89d380410
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318250"
---
# <a name="mapi-custom-form-objects"></a><span data-ttu-id="9c706-103">Объекты настраиваемой формы MAPI</span><span class="sxs-lookup"><span data-stu-id="9c706-103">MAPI custom form objects</span></span>
  
<span data-ttu-id="9c706-104">**Относится к**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="9c706-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="9c706-105">Объекты настраиваемой формы реализуются тремя различными компонентами:</span><span class="sxs-lookup"><span data-stu-id="9c706-105">Objects for custom forms are implemented by three different components:</span></span>
  
- <span data-ttu-id="9c706-106">Сервер форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-106">A form server.</span></span>
    
- <span data-ttu-id="9c706-107">Поставщик библиотеки форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-107">A form library provider.</span></span>
    
- <span data-ttu-id="9c706-108">Просмотр форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-108">A form viewer.</span></span>
    
<span data-ttu-id="9c706-109">Сервер форм схож с функциональными возможностями приложения составного объекта документа OLE.</span><span class="sxs-lookup"><span data-stu-id="9c706-109">A form server is similar in functionality to an OLE compound document object application.</span></span> <span data-ttu-id="9c706-110">Это исполняемый компонент, который реализует форму; он управляет своим отображением и операциями, которые может выполнять пользователь.</span><span class="sxs-lookup"><span data-stu-id="9c706-110">It is an executable component that implements the form; it controls its display and the operations that a user can perform.</span></span> <span data-ttu-id="9c706-111">MAPI запускает сервер форм по запросу, когда пользователь хочет просмотреть сообщение вместе с классом сообщений, который отображается с помощью формы, поддерживаемой сервером форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-111">MAPI starts a form server upon request when a user wants to view a message together with a message class that is displayed by using a form supported by the form server.</span></span> <span data-ttu-id="9c706-112">Серверы форм реализуют три объекта: объект фабрики форм, похожий на стандартную фабрику класса OLE, обработчик с консультацией по форме для обработки событий, характерных для форм, и сама форма.</span><span class="sxs-lookup"><span data-stu-id="9c706-112">Form servers implement three objects: a form factory object that resembles the standard OLE class factory, a form advise sink for handling form-specific events, and the form itself.</span></span> 
  
<span data-ttu-id="9c706-113">Поставщик библиотеки форм обеспечивает доступ клиентов к набору свойств формы, контейнеру и объекту, который связывает сообщения определенного класса с сервером, который может открыть форму для этого класса.</span><span class="sxs-lookup"><span data-stu-id="9c706-113">A form library provider supplies access for clients to a form's property set, to its container, and to the object that links messages of a specific class to the server that can open the form for that class.</span></span> <span data-ttu-id="9c706-114">Поставщики библиотеки форм реализуют три объекта: информационный объект формы, контейнер формы и диспетчер форм для привязки сообщения к соответствующему серверу форм на основе класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="9c706-114">Form library providers implement three objects: a form information object, a form container, and a form manager for binding a message to the appropriate form server based on the message's class.</span></span>
  
<span data-ttu-id="9c706-115">Просмотр форм — это компонент, включаемый в клиенты, которые поддерживают отображение настраиваемой формы в средствах просмотра папок.</span><span class="sxs-lookup"><span data-stu-id="9c706-115">A form viewer is a component that is included in clients that support the display of custom forms in their folder viewers.</span></span> <span data-ttu-id="9c706-116">Просмотр форм не является независимыми компонентами MAPI, как и поставщики библиотек форм и серверы форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-116">Form viewers are not independent MAPI components, as are form library providers and form servers.</span></span> <span data-ttu-id="9c706-117">Посетители форм запускают серверы форм и предоставляют для них контекст.</span><span class="sxs-lookup"><span data-stu-id="9c706-117">Form viewers start form servers and provide context for them.</span></span> <span data-ttu-id="9c706-118">Посетители форм реализуют три объекта: сайт сообщения, контекст представления и сигнальный сигнал для обработки событий, характерных для представления.</span><span class="sxs-lookup"><span data-stu-id="9c706-118">Form viewers implement three objects: a message site, a view context, and an advise sink for handling view-specific events.</span></span>
  
<span data-ttu-id="9c706-119">В следующей таблице описаны все объекты настраиваемой формы.</span><span class="sxs-lookup"><span data-stu-id="9c706-119">The following table describes all of the custom form objects.</span></span> 
  
|<span data-ttu-id="9c706-120">**Объект Form**</span><span class="sxs-lookup"><span data-stu-id="9c706-120">**Form object**</span></span>|<span data-ttu-id="9c706-121">**Описание**</span><span class="sxs-lookup"><span data-stu-id="9c706-121">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="9c706-122">Form</span><span class="sxs-lookup"><span data-stu-id="9c706-122">Form</span></span>  <br/> |<span data-ttu-id="9c706-123">Управляет отображением и эксплуатацией настраиваемой формы для просмотра сообщений определенного класса.</span><span class="sxs-lookup"><span data-stu-id="9c706-123">Controls the display and operation of a custom form for viewing messages of a specific class.</span></span>  <br/> |
|<span data-ttu-id="9c706-124">Веха с консультацией по форме</span><span class="sxs-lookup"><span data-stu-id="9c706-124">Form advise sink</span></span>  <br/> |<span data-ttu-id="9c706-125">Обрабатывает уведомления от просматриваемой формы.</span><span class="sxs-lookup"><span data-stu-id="9c706-125">Handles notifications from the form viewer.</span></span>  <br/> |
|<span data-ttu-id="9c706-126">Фабрика форм</span><span class="sxs-lookup"><span data-stu-id="9c706-126">Form factory</span></span>  <br/> |<span data-ttu-id="9c706-127">Создает экземпляр формы и позволяет ее серверу оставаться в памяти.</span><span class="sxs-lookup"><span data-stu-id="9c706-127">Creates an instance of a form and allows its server to remain in memory.</span></span>  <br/> |
|<span data-ttu-id="9c706-128">Контейнер формы</span><span class="sxs-lookup"><span data-stu-id="9c706-128">Form container</span></span>  <br/> |<span data-ttu-id="9c706-129">Содержит сведения о форме.</span><span class="sxs-lookup"><span data-stu-id="9c706-129">Contains form information.</span></span>  <br/> |
|<span data-ttu-id="9c706-130">Сведения о форме</span><span class="sxs-lookup"><span data-stu-id="9c706-130">Form information</span></span>  <br/> |<span data-ttu-id="9c706-131">Содержит сообщения и другие контейнеры сообщений.</span><span class="sxs-lookup"><span data-stu-id="9c706-131">Contains messages and other message containers.</span></span>  <br/> |
|<span data-ttu-id="9c706-132">Диспетчер форм</span><span class="sxs-lookup"><span data-stu-id="9c706-132">Form manager</span></span>  <br/> |<span data-ttu-id="9c706-133">Предоставляет доступ к интегрированному представлению сведений о настраиваемой форме, связанной со всеми установленными формами.</span><span class="sxs-lookup"><span data-stu-id="9c706-133">Provides access to an integrated view of custom form information that is related to all of the installed forms.</span></span> <span data-ttu-id="9c706-134">Также соответствует классам сообщений с соответствующими идентификаторами класса формы.</span><span class="sxs-lookup"><span data-stu-id="9c706-134">Also matches message classes with corresponding form class identifiers.</span></span>  <br/> |
|<span data-ttu-id="9c706-135">Сайт сообщений</span><span class="sxs-lookup"><span data-stu-id="9c706-135">Message site</span></span>  <br/> |<span data-ttu-id="9c706-136">Обрабатывает манипуляции с объектами формы из клиента и предоставляет доступ к объекту диспетчера форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-136">Handles the manipulation of form objects from inside the client, and provides access to a form manager object.</span></span>  <br/> |
|<span data-ttu-id="9c706-137">Контекст представления</span><span class="sxs-lookup"><span data-stu-id="9c706-137">View context</span></span>  <br/> |<span data-ttu-id="9c706-138">Поддерживает команды формы для активации следующих и предыдущих сообщений, а также для сохранения или печати.</span><span class="sxs-lookup"><span data-stu-id="9c706-138">Supports form commands for activating next and previous messages and for saving or printing.</span></span>  <br/> |
|<span data-ttu-id="9c706-139">View advise sink</span><span class="sxs-lookup"><span data-stu-id="9c706-139">View advise sink</span></span>  <br/> |<span data-ttu-id="9c706-140">Обрабатывает уведомления с сервера форм.</span><span class="sxs-lookup"><span data-stu-id="9c706-140">Handles notifications from the form server.</span></span>  <br/> |
   
<span data-ttu-id="9c706-141">На следующем рисунке показана связь между пользовательскими компонентами форм, объектами и интерфейсами, которые они реализуют, и компонентами, которые являются пользователями объектов.</span><span class="sxs-lookup"><span data-stu-id="9c706-141">The following illustration shows the relationship between custom form components, the objects and interfaces that they implement, and the components that are users of the objects.</span></span> <span data-ttu-id="9c706-142">Обратите внимание, что, в отличие от большинства других объектов MAPI, объект формы реализует два интерфейса, не связанных прямым наследованием.</span><span class="sxs-lookup"><span data-stu-id="9c706-142">Notice that, unlike most other MAPI objects, the form object implements two interfaces that are not related by direct inheritance.</span></span> <span data-ttu-id="9c706-143">Когда объект предоставляет несколько независимых интерфейсов, пользователь объекта с указателем на один из интерфейсов может получить указатель на любой из других интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9c706-143">When an object exposes multiple independent interfaces, a user of the object that has a pointer to one of the interfaces can retrieve a pointer to any of the other interfaces.</span></span> <span data-ttu-id="9c706-144">Эта возможность навигации между реализациями интерфейса объекта является функцией метода [IUnknown::QueryInterface.](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="9c706-144">This ability to navigate between an object's interface implementations is a feature of the [IUnknown::QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) method.</span></span> 
  
<span data-ttu-id="9c706-145">**Компоненты настраиваемых форм**</span><span class="sxs-lookup"><span data-stu-id="9c706-145">**Custom form components**</span></span>
  
<span data-ttu-id="9c706-146">![Настраиваемые компоненты форм](media/amapi_67.gif "Настраиваемые компоненты форм")</span><span class="sxs-lookup"><span data-stu-id="9c706-146">![Custom form components](media/amapi_67.gif "Custom form components")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="9c706-147">См. также</span><span class="sxs-lookup"><span data-stu-id="9c706-147">See also</span></span>

- [<span data-ttu-id="9c706-148">Общие сведения об объектах и интерфейсах MAPI</span><span class="sxs-lookup"><span data-stu-id="9c706-148">MAPI Object and Interface Overview</span></span>](mapi-object-and-interface-overview.md)


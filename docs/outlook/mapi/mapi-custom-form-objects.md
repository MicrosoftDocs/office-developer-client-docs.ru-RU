---
title: Объекты настраиваемой формы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4c1c04e5b04be9bb67b050f5cf498be89d380410
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318250"
---
# <a name="mapi-custom-form-objects"></a>Объекты настраиваемой формы MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Объекты настраиваемой формы реализуются тремя различными компонентами:
  
- Сервер форм.
    
- Поставщик библиотеки форм.
    
- Просмотр форм.
    
Сервер форм схож с функциональными возможностями приложения составного объекта документа OLE. Это исполняемый компонент, который реализует форму; он управляет своим отображением и операциями, которые может выполнять пользователь. MAPI запускает сервер форм по запросу, когда пользователь хочет просмотреть сообщение вместе с классом сообщений, который отображается с помощью формы, поддерживаемой сервером форм. Серверы форм реализуют три объекта: объект фабрики форм, похожий на стандартную фабрику класса OLE, обработчик с консультацией по форме для обработки событий, характерных для форм, и сама форма. 
  
Поставщик библиотеки форм обеспечивает доступ клиентов к набору свойств формы, контейнеру и объекту, который связывает сообщения определенного класса с сервером, который может открыть форму для этого класса. Поставщики библиотеки форм реализуют три объекта: информационный объект формы, контейнер формы и диспетчер форм для привязки сообщения к соответствующему серверу форм на основе класса сообщения.
  
Просмотр форм — это компонент, включаемый в клиенты, которые поддерживают отображение настраиваемой формы в средствах просмотра папок. Просмотр форм не является независимыми компонентами MAPI, как и поставщики библиотек форм и серверы форм. Посетители форм запускают серверы форм и предоставляют для них контекст. Посетители форм реализуют три объекта: сайт сообщения, контекст представления и сигнальный сигнал для обработки событий, характерных для представления.
  
В следующей таблице описаны все объекты настраиваемой формы. 
  
|**Объект Form**|**Описание**|
|:-----|:-----|
|Form  <br/> |Управляет отображением и эксплуатацией настраиваемой формы для просмотра сообщений определенного класса.  <br/> |
|Веха с консультацией по форме  <br/> |Обрабатывает уведомления от просматриваемой формы.  <br/> |
|Фабрика форм  <br/> |Создает экземпляр формы и позволяет ее серверу оставаться в памяти.  <br/> |
|Контейнер формы  <br/> |Содержит сведения о форме.  <br/> |
|Сведения о форме  <br/> |Содержит сообщения и другие контейнеры сообщений.  <br/> |
|Диспетчер форм  <br/> |Предоставляет доступ к интегрированному представлению сведений о настраиваемой форме, связанной со всеми установленными формами. Также соответствует классам сообщений с соответствующими идентификаторами класса формы.  <br/> |
|Сайт сообщений  <br/> |Обрабатывает манипуляции с объектами формы из клиента и предоставляет доступ к объекту диспетчера форм.  <br/> |
|Контекст представления  <br/> |Поддерживает команды формы для активации следующих и предыдущих сообщений, а также для сохранения или печати.  <br/> |
|View advise sink  <br/> |Обрабатывает уведомления с сервера форм.  <br/> |
   
На следующем рисунке показана связь между пользовательскими компонентами форм, объектами и интерфейсами, которые они реализуют, и компонентами, которые являются пользователями объектов. Обратите внимание, что, в отличие от большинства других объектов MAPI, объект формы реализует два интерфейса, не связанных прямым наследованием. Когда объект предоставляет несколько независимых интерфейсов, пользователь объекта с указателем на один из интерфейсов может получить указатель на любой из других интерфейсов. Эта возможность навигации между реализациями интерфейса объекта является функцией метода [IUnknown::QueryInterface.](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) 
  
**Компоненты настраиваемых форм**
  
![Настраиваемые компоненты форм](media/amapi_67.gif "Настраиваемые компоненты форм")
  
## <a name="see-also"></a>См. также

- [Общие сведения об объектах и интерфейсах MAPI](mapi-object-and-interface-overview.md)


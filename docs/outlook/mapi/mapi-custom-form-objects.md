---
title: Пользовательские объекты форм MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 306d62b1-d541-4039-9759-3903f62e0f26
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 4c1c04e5b04be9bb67b050f5cf498be89d380410
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32318250"
---
# <a name="mapi-custom-form-objects"></a>Пользовательские объекты форм MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Объекты настраиваемых форм реализуются тремя различными компонентами:
  
- Сервер форм.
    
- Поставщик библиотеки форм.
    
- Средство просмотра форм.
    
Сервер форм похож на функциональность приложения-объекта составного документа OLE. Это исполняемый компонент, который реализует форму; Он управляет его отображением и операциями, которые может выполнять пользователь. MAPI запускает сервер форм по запросу, когда пользователь хочет просмотреть сообщение вместе с классом сообщений, который отображается с помощью формы, поддерживаемой сервером форм. Серверы форм реализуют три объекта: объект фабрики форм, похожий на стандартную фабрику классов OLE, приемник уведомлений формы для обработки событий, связанных с формой, и саму форму. 
  
Поставщик библиотеки форм предоставляет доступ для клиентов к набору свойств формы, к его контейнеру и объекту, который связывает сообщения определенного класса с сервером, который может открыть форму для этого класса. Поставщики библиотек форм реализуют три объекта: объект информации формы, контейнер формы и Диспетчер форм для привязки сообщения к соответствующему серверу форм на основе класса сообщения.
  
Средство просмотра форм — это компонент, который входит в число клиентов, поддерживающих отображение настраиваемых форм в своих папках просмотра. Средства просмотра форм не являются независимыми компонентами MAPI, как поставщики библиотек форм и серверы форм. Средства просмотра форм запускают серверы форм и предоставляют контекст для них. Средства просмотра форм реализуют три объекта: сайт сообщений, контекст представления и приемник уведомлений для обработки событий, связанных с представлениями.
  
В следующей таблице описаны все объекты настраиваемых форм. 
  
|**Объект Form**|**Описание**|
|:-----|:-----|
|Form  <br/> |Управляет отображением и работой настраиваемой формы для просмотра сообщений определенного класса.  <br/> |
|Приемник рекомендаций для формы  <br/> |Обрабатывает уведомления в средстве просмотра форм.  <br/> |
|Фабрика форм  <br/> |Создает экземпляр формы и позволяет серверу храниться в памяти.  <br/> |
|Контейнер форм  <br/> |Содержит сведения о форме.  <br/> |
|Сведения о форме  <br/> |Содержит сообщения и другие контейнеры сообщений.  <br/> |
|Диспетчер форм  <br/> |Предоставляет доступ к интегрированному представлению настраиваемых сведений формы, которые относятся ко всем установленным формам. Также сопоставляет классы сообщений с соответствующими идентификаторами классов форм.  <br/> |
|Сайт сообщений  <br/> |Обрабатывает обработку объектов формы в клиенте и предоставляет доступ к объекту диспетчера форм.  <br/> |
|Контекст представления  <br/> |Поддерживает команды форм для активации следующих и предыдущих сообщений, а также для сохранения и печати.  <br/> |
|Просмотр приемника уведомлений  <br/> |Обрабатывает уведомления от сервера форм.  <br/> |
   
На следующем рисунке показана связь между настраиваемыми компонентами форм, объектами и интерфейсами, которые они реализуют, и компонентами, которые являются пользователями объектов. Обратите внимание, что в отличие от большинства других объектов MAPI объект Form реализует два интерфейса, которые не связаны прямым наследованием. Если объект предоставляет несколько независимых интерфейсов, пользователь объекта с указателем на один из интерфейсов может получить указатель на любой из других интерфейсов. Такая возможность перехода между реализациями интерфейса объекта — это функция метода [IUnknown:: QueryInterface](https://msdn.microsoft.com/library/54d5ff80-18db-43f2-b636-f93ac053146d%28Office.15%29.aspx) . 
  
**Компоненты настраиваемых форм**
  
![Настраиваемые компоненты форм] (media/amapi_67.gif "Настраиваемые компоненты форм")
  
## <a name="see-also"></a>См. также

- [Общие сведения об объекте и интерфейсе MAPI](mapi-object-and-interface-overview.md)


---
title: иаддрбуккреатеонеофф
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IAddrBook.CreateOneOff
api_type:
- COM
ms.assetid: bcacfbdf-edff-4810-a985-e6d2c9271901
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 980ac82c6f7fcb5771a6013b3fb033b0bdfd05e0
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427383"
---
# <a name="iaddrbookcreateoneoff"></a>IAddrBook::CreateOneOff

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает идентификатор записи для одного адреса.
  
```cpp
HRESULT CreateOneOff(
  LPSTR lpszName,
  LPSTR lpszAdrType,
  LPSTR lpszAddress,
  ULONG ulFlags,
  ULONG FAR * lpcbEntryID,
  LPENTRYID FAR * lppEntryID
);
```

## <a name="parameters"></a>Параметры

 _лпсзнаме_
  
> возврата Указатель на значение свойства **PR_DISPLAY_NAME** получателя ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)). Параметр _лпсзнаме_ может иметь значение null. 
    
 _лпсзадртипе_
  
> возврата Указатель на тип адреса получателя, например Факс или SMTP. Параметр _лпсзадртипе_ не может иметь значение null. 
    
 _лпсзаддресс_
  
> возврата Указатель на адрес получателя. Параметр _лпсзаддресс_ не может иметь значение null. 
    
 _ulFlags_
  
> возврата Битовая маска флагов, влияющих на одного получателя. Можно задать следующие флаги:
    
MAPI_SEND_NO_RICH_INFO 
  
> Получатель не может обрабатывать форматированное содержимое сообщения. Если параметр MAPI_SEND_NO_RICH_INFO установлен, MAPI задает для свойства **PR_SEND_RICH_INFO** получателя ([PidTagSendRichInfo](pidtagsendrichinfo-canonical-property.md)) значение false. Если MAPI_SEND_NO_RICH_INFO не задано, MAPI задает для этого свойства значение TRUE, если адрес обмена сообщениями получателя, на который указывает _лпсзаддресс_ , не считается Интернет-адресом. В этом случае MAPI устанавливает **PR_SEND_RICH_INFO** в значение false. 
    
MAPI_UNICODE 
  
> Отображаемое имя, тип адреса и адрес имеют формат Юникод. Если флаг MAPI_UNICODE не установлен, эти строки представлены в формате ANSI.
    
 _лпкбентрид_
  
> вышли Указатель на число байтов в идентификаторе записи, на который указывает параметр _лппентрид_ . 
    
 _лппентрид_
  
> вышли Указатель на указатель на идентификатор записи для одноразового получателя.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Идентификатор записи с одноразовым входом успешно создан.
    
## <a name="remarks"></a>Примечания

Клиенты вызывают метод **креатеонеофф** для создания идентификатора записи для одноразового получателя — получателя, не относящегося к какому-либо из контейнеров из загруженных в текущий момент поставщиков адресной книги. У одноразовых получателей может быть любой адрес, поддерживаемый одним из активных поставщиков адресных книг для этого сеанса. 
  
Как правило, одноразовые получатели создаются с помощью шаблона для определенного типа адресов. Поставщик адресных книг, поддерживающий тип адреса, предоставляет шаблон. Пользователь клиентского приложения вводит соответствующую информацию в шаблон.
  
MAPI поддерживает строки символов Юникода для отображаемого имени, типа адреса и параметров адреса **креатеонеофф**.
  
Флаг MAPI_SEND_NO_RICH_INFO определяет, будет ли форматированный текст в формате RTF передаваться вместе с каждым сообщением. Формат TNEF, используемый для передачи форматированного текста, отправляется большинством поставщиков транспорта, независимо от того, как получатель задает его свойство **PR_SEND_RICH_INFO** . Это не проблема для клиентов обмена сообщениями, работающих с взаимосвязанными сообщениями. Тем не менее, так как формат TNEF обычно используется для отправки настраиваемых свойств настраиваемым классам сообщений, он может быть проблемой для клиентов на основе форм или клиентов, которым требуются настраиваемые свойства MAPI. Более подробную информацию можно узнать [в статье отправка сообщений в формате TNEF](sending-messages-with-tnef.md).
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мапиабфунктионс. cpp  <br/> |аддонеоффаддресс  <br/> |MFCMAPI использует метод **креатеонеофф** для создания идентификатора записи для адреса, не найденного в адресной книге.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPISupport::CreateOneOff](imapisupport-createoneoff.md)
  
[IAddrBook : IMAPIProp](iaddrbookimapiprop.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


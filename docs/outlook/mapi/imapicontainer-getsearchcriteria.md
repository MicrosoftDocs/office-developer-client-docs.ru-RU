---
title: имапиконтаинержетсеарчкритериа
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIContainer.GetSearchCriteria
api_type:
- COM
ms.assetid: 41b6c162-9984-43a3-b38e-44f0afae67de
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 7845238722ce81b84210b6f4fc33f9df0abacc07
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412025"
---
# <a name="imapicontainergetsearchcriteria"></a>IMAPIContainer::GetSearchCriteria

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Получает условия поиска для контейнера.
  
```cpp
HRESULT GetSearchCriteria(
  ULONG ulFlags,
  LPSRestriction FAR * lppRestriction,
  LPENTRYLIST FAR * lppContainerList,
  ULONG FAR * lpulSearchState
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют типом переданных строк. Можно задать следующий флаг:
    
MAPI_UNICODE 
  
> Переданные строки имеют формат Юникод. Если флаг MAPI_UNICODE не установлен, строки представлены в формате ANSI.
    
 _лппрестриктион_
  
> вышли Указатель на указатель на структуру [срестриктион](srestriction.md) , которая определяет критерии поиска. Если клиентское приложение передает значение NULL в параметр _лппрестриктион_ , то **жетсеарчкритериа** не возвращает структуру **срестриктион** . 
    
 _лппконтаинерлист_
  
> вышли Указатель на указатель на массив идентификаторов записей, которые представляют контейнеры, включаемые в поиск. Если клиент передает значение NULL в параметр _лппконтаинерлист_ , то **жетсеарчкритериа** не возвращает массив идентификаторов записей. 
    
 _лпулсеарчстате_
  
> вышли Указатель на битовую маску флагов, используемый для указания текущего состояния поиска. Если клиент передает значение NULL в параметр _лпулсеарчстате_ , **жетсеарчкритериа** не возвращает флагов. Можно задать следующие флаги: 
    
SEARCH_FOREGROUND 
  
> Поиск должен выполняться с высоким приоритетом, связанным с другими поисковыми операциями. Если этот флаг не установлен, поиск выполняется с нормальным приоритетом относительно других поисков.
    
SEARCH_REBUILD 
  
> Поиск выполняется в режиме интенсивного использования ЦП для операции, пытаясь найти сообщения, соответствующие условиям. Если этот флаг не установлен, часть операции поиска, интенсивно использующая ЦП, превышает. Этот флаг имеет значение только в том случае, если активен Поиск (то есть, если установлен флаг SEARCH_RUNNING).
    
SEARCH_RECURSIVE 
  
> Поиск выполняется в указанных контейнерах и всех дочерних контейнерах для соответствующих записей. Если этот флаг не задан, поиск выполняется только для контейнеров, явно включенных в последний вызов метода [IMAPIContainer:: сетсеарчкритериа](imapicontainer-setsearchcriteria.md) . 
    
SEARCH_RUNNING 
  
> Поиск активен, и таблица содержимого контейнера обновляется в соответствии с изменениями, внесенными в хранилище сообщений или адресную книгу. Если этот флаг не установлен, поиск является неактивным и таблица содержимого является статической.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Условия поиска успешно получены.
    
MAPI_E_BAD_CHARWIDTH 
  
> Установлен флаг MAPI_UNICODE, а реализация не поддерживает Юникод, или MAPI_UNICODE не задано, а реализация поддерживает только Юникод.
    
MAPI_E_NOT_INITIALIZED 
  
> Условия поиска для контейнера никогда не были установлены.
    
## <a name="remarks"></a>Примечания

Метод **IMAPIContainer:: жетсеарчкритериа** получает условия поиска для контейнера, поддерживающего Поиск, как правило, папка результатов поиска. Вы создаете критерии поиска, вызывая метод контейнера **IMAPIContainer:: сетсеарчкритериа** . 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Для контейнеров адресных книг может потребоваться поддержка **жетсеарчкритериа** только в том случае, если они предоставляют расширенные возможности поиска, связанные со свойством **PR_SEARCH** ([PidTagSearch](pidtagsearch-canonical-property.md)). Дополнительные сведения о том, как реализовать функцию расширенного поиска для контейнеров адресных книг, можно узнать в статье [Реализация расширенного](implementing-advanced-searching.md)поиска.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

По завершении работы с структурами данных, на которые указывает параметр _лппрестриктион_ и _лппконтаинерлист_ , вызовите [мапифрибуффер](mapifreebuffer.md) один раз для каждой структуры, чтобы освободить их. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Хиерарчитабледлг. cpp  <br/> |Чиерарчитабледлг:: Онедитсеарчкритериа  <br/> |MFCMAPI использует метод **IMAPIContainer:: жетсеарчкритериа** для получения условий поиска из папки для отображения.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)
  
[IMAPIFolder::CreateFolder](imapifolder-createfolder.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[Каноническое свойство PidTagSearch](pidtagsearch-canonical-property.md)
  
[IMAPIContainer : IMAPIProp](imapicontainerimapiprop.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


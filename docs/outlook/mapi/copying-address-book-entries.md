---
title: Копирование записей адресной книги
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 285abeb4-45c8-4e82-9a16-b935b4651afe
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 190c4bf12c8f5aaaf8143f59239bb53fb68046f5
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32333070"
---
# <a name="copying-address-book-entries"></a>Копирование записей адресной книги

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Ваш контейнер [иабконтаинер:: копентриес](iabcontainer-copyentries.md) вызывается при копировании одного или нескольких получателей из одного или другого контейнера в этот контейнер. **Копентриес** имеет четыре входных параметра: массив идентификаторов записей, представляющих копируемых получателей, дескриптор окна для индикатора хода выполнения, указатель на объект хода выполнения и значение флагов. Поставщик должен отображать ход выполнения, если флаг АБ_НО_ДИАЛОГ не задан, и использовать объект Progress из параметра _лппрогресс_ , если он не имеет значение null. Если _лппрогресс_ имеет значение null, вызовите [Имаписуппорт::D опрогрессдиалог](imapisupport-doprogressdialog.md) , чтобы использовать объект Progress MAPI. Для получения дополнительных сведений об отображении [индикатора хода выполнения](mapi-progress-indicators.md)см.
  
В дополнение к АБ_НО_ДИАЛОГ, чтобы отключить индикатор хода выполнения, можно задать один из двух других флагов, чтобы запросить тип проверки повторяющихся записей: КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ или КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ. Флаги КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ и КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ представляют собой только варианты, определяющие, как поставщик определяет дублирующиеся записи и может быть проигнорирован. MAPI предлагает поставщику поддержку этих флагов, как показано ниже.
  
|**Повторяющийся флаг записи**|**Предлагаемая реализация**|
|:-----|:-----|
|КРЕАТЕ_ЧЕКК_ДУП_ЛУСЕ  <br/> |Убедитесь, что отображаемое имя в создаваемой записи совпадает с отображаемым именем записи, которая уже находится в контейнере.  <br/> |
|КРЕАТЕ_ЧЕКК_ДУП_СТРИКТ  <br/> |Убедитесь, что отображаемое имя и ключ поиска в записи совпадают с отображаемым именем и ключом поиска записи контейнера.  <br/> |
   
Последний флаг, КРЕАТЕ_РЕПЛАЦЕ, указывает, что новая запись должна заменить существующую, если у поставщика определено, что создаваемая запись является дубликатом записи, которая уже находится в контейнере. 
  
Если ваш поставщик является личной адресной книгой, включите свойство **пр_детаилс_табле** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) в каждую операцию копирования. Включение таблицы отображения сведений для скопированного получателя позволяет контейнеру отображать сведения о получателе, а не вызывать исходный контейнер для создания отображения.
  
 **Реализация Иабконтаинер:: Копентриес**
  
1. Определите, является ли каждый идентификатор записи в параметре _лпентриес_ форматом, который обрабатывается поставщиком, а также в случае, если это не так, отработка отказа и возврат мапи_е_инвалид_ентрид. 
    
2. Если идентификатор записи представляет пользователя обмена сообщениями, список рассылки или контейнер, который обрабатывает ваш поставщик:
    
1. ВыЗовите метод [имаписуппорт:: OpenEntry](imapisupport-openentry.md) , чтобы открыть соответствующий получатель. 
    
2. Скопируйте получателя в свой контейнер. 
    
3. Если идентификатор записи представляет инородного получателя:
    
1. ВыЗовите свой контейнер [иабконтаинер:: креатинтри](iabcontainer-createentry.md) , чтобы создать нового получателя. 
    
2. Задайте исходные свойства для нового получателя.
    
4. ВыЗовите метод [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) нового объекта, чтобы сохранить его. 
    
5. Обновите таблицу содержимого контейнера в соответствии с новым получателем. 
    
6. Call [имаписуппорт:: notify](imapisupport-notify.md) для отправки табличного уведомления зарегистрированным клиентам. 
    


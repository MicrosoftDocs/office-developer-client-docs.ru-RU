---
title: Копирование записей адресной книги
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 285abeb4-45c8-4e82-9a16-b935b4651afe
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: ce7f7e2db341be62912935b7a55d69eaf5db8ab5
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808205"
---
# <a name="copying-address-book-entries"></a>Копирование записей адресной книги

  
  
**Относится к**: Outlook 
  
При вызове метода [IABContainer::CopyEntries](iabcontainer-copyentries.md) контейнера одного или нескольких получателей из того же или другой контейнер, должны быть скопированы в этот контейнер. **CopyEntries** имеет четыре входных параметров: массив идентификаторов записи, представляющее получателей для копирования, дескриптор окна для индикатора, указатель объекта хода выполнения и значение флагов. Поставщик должен отображаться ход выполнения, если не задан флаг AB_NO_DIALOG и используйте объект о ходе выполнения с помощью параметра _lpProgress_ , если он не может быть NULL. Если _lpProgress_ имеет значение NULL, вызовите [IMAPISupport::DoProgressDialog](imapisupport-doprogressdialog.md) использовать объект MAPI хода выполнения. Дополнительные сведения об отображении хода выполнения [отображая индикатор выполнения](mapi-progress-indicators.md)см.
  
В дополнение к AB_NO_DIALOG для отмены вывода индикатор хода выполнения один из двух флагов можно задать тип проверки дубликат запроса: CREATE_CHECK_DUP_LOOSE или CREATE_CHECK_DUP_STRICT. Флаги CREATE_CHECK_DUP_LOOSE и CREATE_CHECK_DUP_STRICT только предложения, как, чтобы как поставщика определяет повторяющихся записей и можно пропустить. MAPI предполагает, что ваш поставщик реализации поддержки эти флаги следующим образом.
  
|**Флаг Повторяющаяся запись**|**Предлагаемые реализации**|
|:-----|:-----|
|CREATE_CHECK_DUP_LOOSE  <br/> |Проверьте, если отображаемое имя в записи, которую требуется создать соответствует отображаемое имя записи уже в контейнере.  <br/> |
|CREATE_CHECK_DUP_STRICT  <br/> |Убедитесь, если отображаемое имя и ключа поиска в записи, которую требуется создать соответствуют отображаемое имя и поиска ключ записи контейнера.  <br/> |
   
Последний флаг CREATE_REPLACE, указывает, что новая запись необходимо заменить существующий, если ваш поставщик обнаружила, что запись будет создан дубликат запись уже в контейнере. 
  
Если ваш поставщик Личная адресная книга, включите свойство **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) для каждой операции копирования. Включая в таблице отображения сведений о скопированной получателя позволяет контейнера для отображения сведений о получателя, а не прибегая к исходной контейнер для создания отображения.
  
 **Для реализации IABContainer::CopyEntries**
  
1. Определение возможности каждого идентификатор записи с помощью параметра _lpEntries_ в виде, ваш поставщик обрабатывает и если это не так, с ошибкой и возвращать MAPI_E_INVALID_ENTRYID. 
    
2. Если обмена сообщениями пользователя, список рассылки или контейнера, обрабатывающего ваш поставщик представляет идентификатор записи:
    
1. Вызовите метод [IMAPISupport::OpenEntry](imapisupport-openentry.md) для открытия соответствующего получателя. 
    
2. Скопируйте получателя контейнера. 
    
3. Если идентификатор записи представляет внешнего получателя:
    
1. Вызов метода [IABContainer::CreateEntry](iabcontainer-createentry.md) контейнера для создания нового получателя. 
    
2. Задавать начальные свойства нового получателя.
    
4. Вызов метода [IMAPIProp::SaveChanges](imapiprop-savechanges.md) новый объект для его сохранения. 
    
5. Обновление таблицы содержимого контейнера в соответствии с новой получателя. 
    
6. Вызов [IMAPISupport::Notify](imapisupport-notify.md) для отправки уведомлений в таблице зарегистрированным пользователям. 
    


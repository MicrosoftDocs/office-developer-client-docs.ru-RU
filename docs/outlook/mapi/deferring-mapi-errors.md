---
title: Откладывание ошибок MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 93ae6d54-41cd-433c-8124-eb07d71baa57
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 0cf56a92190acfab1a941bc8d3ad0acc1f3e1f89
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427341"
---
# <a name="deferring-mapi-errors"></a>Откладывание ошибок MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Некоторые методы интерфейса принимают флаг MAPI_DEFERRED_ERRORS в качестве входного параметра. Если этот флаг установлен, метод не должен возвращаться немедленно со значением; он может дать звоняке знать результат вызова позже.
  
Отсрочка ошибок помогает поставщикам услуг в реализации сложных методов, ускоряя обработку. Вместо обработки многих запросов и возврата значения для каждого из них отсрочка ошибок позволяет объединить вызовы в поставщике услуг. Обработка множества запросов одновременно сокращает сетевой трафик, тем самым повышая производительность. Отсрочка ошибок особенно полезна при вызовах для удаления или копирования свойств, что может быть очень трудоемким процессом. 
  
Если клиент совершает вызов, не устанавливая флаг MAPI_DEFERRED_ERRORS, который может обрабатываться только отложенным способом, поставщики услуг могут отложить ошибки независимо от того, MAPI_E_TOO_COMPLEX. Большинство клиентов должны откладывать ошибки в качестве предпочтительной стратегии для сбоя вызова. 
  
Установка флага MAPI_DEFERRED_ERRORS изменяет реализацию обработки ошибок клиента, так как возвращаемая информация может быть доставлена в любое время, а не в запланированное время. Ошибка может быть возвращена, когда слишком поздно что-либо с ней сделать или после того, как данные об исходном запросе перестают быть доступны. Например, если клиент вызывает **IMsgStore::OpenEntry,** чтобы открыть удаленную папку с установленным MAPI_DEFERRED_ERRORS, клиент не узнает о проблеме, пока не будет выполнен вызов **IMAPIProp::GetProps** для получения одного из свойств папки. **Затем GetProps** возвращает MAPI_E_NOT_FOUND. 
  
## <a name="see-also"></a>См. также



[IMsgStore::OpenEntry](imsgstore-openentry.md)
  
[IMAPIProp::GetProps](imapiprop-getprops.md)


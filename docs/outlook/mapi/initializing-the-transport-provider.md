---
title: Инициализация поставщика транспорта
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 474a8085ca8b82d11efd68c9fd4d8719fe239207
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416603"
---
# <a name="initializing-the-transport-provider"></a>Инициализация поставщика транспорта

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Интерфейс транспортной очереди печати определяет вызовы, которые отправляет Диспетчер очереди MAPI поставщику транспорта. Поставщики транспорта реализуют эти процедуры в библиотеке динамической компоновки (DLL). Первая прямая точка входа в БИБЛИОТЕКУ, используемую диспетчером MAPI, должна быть функцией инициализации поставщика транспорта [ксппровидеринит](xpproviderinit.md).
  
MAPI использует подпрограмму **GetProcAddress** для получения адреса процедуры инициализации поставщика услуг, а затем вызывает эту процедуру. Имя процедуры инициализации — **ксппровидеринит** для поставщиков транспорта. Он отличается для других типов поставщиков услуг MAPI, чтобы одна библиотека DLL могла содержать любую комбинацию типов поставщиков услуг, но только один поставщик услуг определенного типа. Тем не менее, один поставщик услуг данного типа может реализовать несколько служб своего типа. Например, один поставщик транспорта может реализовать функции транспорта сообщений для нескольких служб сообщений. 
  
Файл заголовка маписпи. h содержит определение типа для прототипа функции функции инициализации поставщика транспорта и предварительно определенное имя процедуры. С помощью имен процедур инициализации в файлах C и C++ с теми же именами, что и **GetProcAddress** , и с помощью непосредственного объявления экспорта в библиотеке DLL. DEF, вы автоматически получаете проверку типов параметров в процедуре инициализации. Примеры приведены в примере исходного кода поставщика транспорта. Дополнительные сведения см. [](transport-provider-sample.md)
  
Если вызов инициализации поставщика услуг завершается успешно, но возвращает номер версии интерфейса поставщика услуг, который слишком мал для обработки MAPI, то MAPI немедленно вызывает метод **Release** объекта поставщика службы и выполняется как при вызове инициализации. произошел сбой с МАПИ_Е_ВЕРСИОН. Таким образом, MAPI и поставщик услуг определяют диапазон номеров версий интерфейса поставщика услуг, которые они могут обрабатывать, и если ничего не происходит, Загрузка поставщика услуг не выполняется с возвращаемым значением МАПИ_Е_ВЕРСИОН. 
  
Последним шагом для диспетчера очереди MAPI в доступе к ресурсам поставщика услуг является вход в поставщик транспорта. Диспетчер очереди MAPI вызывает метод [иксппровидер:: транспортлогон](ixpprovider-transportlogon.md) объекта [иксппровидер: IUnknown](ixpprovideriunknown.md) , возвращенный из **ксппровидеринит**. Это вызов, в котором проверяются учетные данные, если они используются, а также разрешены диалоговые окна.
  
Если процесс открывает второй сеанс транспорта для одного и того же поставщика транспорта и сеанса MAPI, Библиотека DLL поставщика транспорта не должна создавать второй объект provider. Первый объект Provider должен использоваться для входа во второй сеанс транспорта. Поставщик транспорта должен программироваться для поддержки нескольких транспортных сеансов в едином объекте поставщика. Второй объект Provider следует создавать только в том случае, если в одном процессе используются разные сеансы MAPI.
  


---
title: Инициализация поставщика транспорта
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 474a8085ca8b82d11efd68c9fd4d8719fe239207
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416603"
---
# <a name="initializing-the-transport-provider"></a>Инициализация поставщика транспорта

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Интерфейс пула транспорта определяет вызовы, которые поставщик услуг mapI передает поставщику транспорта. Поставщики транспорта реализуют эти процедуры в библиотеке динамической ссылки (DLL). Первой прямой точкой входа в DLL, используемой пулом MAPI, должна быть функция инициализации поставщика транспорта [XPProviderInit.](xpproviderinit.md)
  
MAPI использует процедуру **GetProcAddress** для получения адреса процедуры инициализации поставщика услуг, а затем вызывает эту процедуру. Процедура инициализации называется **XPProviderInit** для поставщиков транспорта. Он отличается для других типов поставщиков услуг MAPI, так что одна DLL может содержать любое сочетание типов поставщиков служб, но только один поставщик услуг определенного типа. Однако один поставщик услуг заданного типа может реализовать несколько служб своего типа. Например, один поставщик транспорта может реализовать функции транспорта сообщений в нескольких службах сообщений. 
  
Файл заголовок mapispi.h имеет определение типа прототипа функции функции инициализации поставщика транспорта и предопределенное имя процедуры для него. Именуя процедуры инициализации в файлах C и C++ с одинаковыми именами, используемыми **GetProcAddress,** и используя простое объявление экспорта в файле DLL.DEF, вы автоматически получаете проверку типа параметров в процедуре инициализации. Примеры см. в примере кода источника поставщика транспорта. Дополнительные сведения см. в [примере поставщика транспорта.](transport-provider-sample.md)
  
Если вызов инициализации поставщика службы успешно проходит, но возвращает слишком маленький номер версии интерфейса поставщика услуг для обработки MAPI, MAPI немедленно вызывает метод **Release** объекта поставщика услуг и продолжает работу так, как если бы вызов инициализации не удалось обработать MAPI_E_VERSION. Таким образом MAPI и поставщик услуг совместно определяют диапазон номеров версий интерфейса поставщика услуг, которые они могут обработать, и если ничего не соответствует, то загрузка поставщика службы не MAPI_E_VERSION возвращаемого значения. 
  
Последний шаг для пула MAPI при получении доступа к ресурсам поставщика услуг — войти к поставщику транспорта. Пулер MAPI вызывает метод [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) объекта [IXPProvider : IUnknown,](ixpprovideriunknown.md) возвращенного **из XPProviderInit.** Это вызов, при котором проверяются учетные данные, если они используются, и диалоговое окно может быть разрешено.
  
Если процесс открывает второй сеанс транспорта для того же поставщика транспорта и сеанс MAPI, DLL поставщика транспорта не должен создавать второй объект поставщика. Первый объект поставщика должен использоваться для входа во второй сеанс транспорта. Поставщик транспорта должен быть запрограммирован для поддержки нескольких сеансов транспорта в одном объекте поставщика. Второй объект поставщика следует создавать, только если в одном процессе используются разные сеансы MAPI.
  


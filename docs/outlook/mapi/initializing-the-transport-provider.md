---
title: Инициализация поставщика транспорта
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 474a8085ca8b82d11efd68c9fd4d8719fe239207
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416603"
---
# <a name="initializing-the-transport-provider"></a>Инициализация поставщика транспорта

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Интерфейс transport-spooler определяет вызовы, которые spooler MAPI делает поставщику транспорта. Поставщики транспорта реализуют эти процедуры в библиотеке динамических ссылок (DLL). Первой точкой прямого входа в DLL, используемой шпалером MAPI, должна быть функция инициализации поставщика транспорта [XPProviderInit.](xpproviderinit.md)
  
MAPI использует обычный **GetProcAddress** для получения адреса обычной процедуры инициализации поставщика услуг, а затем вызывает эту процедуру. Имя процедуры инициализации **— XPProviderInit** для транспортных поставщиков. Он отличается для других типов поставщиков услуг MAPI, так что один DLL может содержать любое сочетание типов поставщиков услуг, но только один поставщик услуг определенного типа. Однако один поставщик услуг данного типа может реализовать несколько служб такого типа. Например, один поставщик транспорта может реализовать функции переноса сообщений нескольким службам сообщений. 
  
Файл заголовки mapispi.h имеет определение типа для прототипа функции функции инициализации поставщика транспорта и предопределенное имя процедуры для него. Назначив процедуры инициализации в C и C++ файлах с одинаковыми именами, используемыми **GetProcAddress,** и используя простую экспортную декларацию в файле DLL.DEF, вы автоматически получаете тип проверки параметров процедуры инициализации. Примеры примеров см. в примере исходный код поставщика транспорта. Дополнительные сведения см. в [примере поставщика транспорта.](transport-provider-sample.md)
  
Если вызов инициализации поставщика услуг удается, но возвращает номер версии интерфейса поставщика услуг слишком  мал для обработки MAPI, MAPI немедленно вызывает метод выпуска объекта поставщика услуг и продолжает, как если бы вызов инициализации не справился с MAPI_E_VERSION. Таким образом MAPI и поставщик услуг совместно определяют диапазон номеров версий интерфейса поставщика услуг, которые они могут обрабатывать, и если ничего не совпадает, загрузка поставщика услуг сбой с MAPI_E_VERSION возвращается. 
  
Последний шаг для шпалеров MAPI в получении доступа к ресурсам поставщика услуг — войти к поставщику транспорта. Spooler MAPI вызывает [метод IXPProvider::TransportLogon](ixpprovider-transportlogon.md) объекта [IXPProvider: объект IUnknown,](ixpprovideriunknown.md) возвращенный из **XPProviderInit.** Это вызов, в котором проверяются учетные данные, если они используются, и можно разрешить диалоговое окно.
  
Если процесс открывает вторую транспортную сессию на том же поставщике транспорта и сеанс MAPI, поставщик транспорта DLL не должен создавать второй объект поставщика. Первый объект поставщика должен быть использован для входа во вторую транспортную сессию. Поставщик транспорта должен быть запрограммирован для поддержки нескольких сеансов транспорта в одном объекте поставщика. Второй объект поставщика должен быть создан только в том случае, если в одном процессе используются различные сеансы MAPI.
  


---
title: Инициализация поставщика транспорта
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 3b369e20101bbaba5e246b2ef9f6ab3ed1771ef6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22563557"
---
# <a name="initializing-the-transport-provider"></a>Инициализация поставщика транспорта

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Интерфейс диспетчера очереди транспорта определяет вызовах, выполненных диспетчер очереди MAPI для поставщика транспорта. Эти процедуры внедряемые поставщиками транспорта в библиотеке динамической компоновки (DLL). Первой точкой ввод в DLL-ФАЙЛ, используемый диспетчером очереди MAPI должен быть функции инициализации поставщика транспорта [XPProviderInit](xpproviderinit.md).
  
MAPI использует процедуру **GetProcAddress** получить адрес программа инициализации поставщика услуг и затем вызывает подпрограмма. Имя процедуры инициализации — **XPProviderInit** поставщиками транспорта. Оно отличается для других типов поставщиков служб MAPI, чтобы одна библиотека DLL может содержать любое сочетание типов поставщика служб, но только одну службу поставщика определенного типа. Тем не менее один поставщик службы данного типа можно реализовать несколько служб этого типа. Например, для одного поставщика транспорта можно реализовать средства транспорта сообщений для нескольких служб сообщения. 
  
Файл заголовка mapispi.h имеет определение типа для прототипа функции функции инициализации поставщика транспорта и имя предварительно определенные процедуры для него. Назвав процедуры инициализации в файлах C и C++ с теми же именами, используемых **GetProcAddress** и с помощью простой экспортируйте объявление в библиотеке DLL. Файл DEF автоматически получить проверки параметров на Подпрограмма инициализации типа. Просмотрите поставщика транспорта примеров исходного кода примеры. Для получения дополнительных сведений см [Пример поставщика транспорта](transport-provider-sample.md).
  
Если звонок инициализации поставщика услуг успешно, но возвращает номер версии интерфейса, поставщика услуг, слишком мало для MAPI для обработки, MAPI сразу же вызывает метод **выпуске** объекта поставщика службы и переходит как если бы инициализация звонок Возникла ошибка с MAPI_E_VERSION. Таким образом MAPI и поставщика услуг совместно определяют диапазон номеров версий интерфейс поставщика службы, они могут обрабатывать, и если ничего не соответствует, то загрузка поставщика услуг завершается MAPI_E_VERSION возвращают значение. 
  
Последний шаг для очереди MAPI в получении доступа к ресурсам поставщика службы — войдите в систему поставщика транспорта. Диспетчер очереди MAPI вызывает метод [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) [IXPProvider: IUnknown](ixpprovideriunknown.md) объект, возвращенный из **XPProviderInit**. Это вызов, где учетные данные, при использовании проверяется, и можно разрешить диалоговых окон.
  
Если процесс открывается второй сеанс транспорта на того же поставщика транспорта и сеанса MAPI, поставщика транспорта DLL не следует создавать второй объект поставщика. Первый объект поставщика должен использоваться для входа на второй сеанс транспорта. Для поддержки нескольких сеансов транспорта в объект одного поставщика необходимо запрограммировать поставщика транспорта. Второй объект поставщика должны быть созданы только в том случае, если в тот же самый процесс используются разные сеансов MAPI.
  


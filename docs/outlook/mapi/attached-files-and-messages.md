---
title: Вложенные файлы и сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b2f2fb72-23ae-4e0b-a8a1-3b78a1862acb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 489930b35d24d2691c9b9fbb59b0fa95707a0618
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808052"
---
# <a name="attached-files-and-messages"></a>Вложенные файлы и сообщения

  
  
**Относится к**: Outlook 
  
При использовании во время кодирования содержимого сообщения MIME с TNEF все вложения свойства и содержимое находятся в поток TNEF. TNEF самого — это один двоичный вложенные файл с именем Winmail.dat в кодировке, как описано для MIME без TNEF. 
  
При использовании MIME без TNEF вложенные файлы отправляются в виде содержимого части сообщений MIME. Имя файла помещается в параметре *name* в заголовок *Content-type* для вложения. Набор знаков для вложения переводится в параметр *charset* *типа контента* ; и content-transfer-encoding определяются сканирования содержимое всей вложения. URL-адрес вложения, специально рассматриваются: 
  
- Если вложение — URL-адрес (вложенный файл с расширением. URL-адрес) и режим доступа, определенные в нем — анонимный FTP закодирован внешнее сообщение и содержимое файла (URL-адрес) копируется в заголовок внешних сообщений. *Content-type: сообщение/external-body; тип доступа = анонимного пользователя ftp*  (Content-Transfer-Encoding: 7-разрядных предполагается.) 
    
- Если только 7-разрядные символы находятся и строка не превышает 140 символов в длину, вложение представляет текст в формате ASCII. *Тип содержимого: text/plain; CharSet = us-ascii кодирование при передаче контента: 7-разрядных* 
    
- Если длинные строки или копирование 25% 8-разрядных символов обнаружены, содержимое вложения — текст и набор знаков, определяется языкового стандарта. Его следует выбрать из наборов знаков, определяемыми спецификацией ISO 8859 стандартные. *Content-type: text/plain; charset = ISO-8859-1*  (например) 
    
     *Content-Transfer-Encoding: quoted-printable* 
    
- Если 25% или более символов высокой бит, двоичные вложения. Кодируются с помощью алгоритма Base64. *Content-type: приложение/октета потока*  (по умолчанию; на основе расширения файла) 
    
     * Content-Transfer-Encoding: base64 * 
    
Для исходящих сообщений типа контента должны быть получены из трех букв расширение имени файла. Это сопоставление существует в системном реестре; в этом разделе — это строковое значение с именем «Тип содержимого», задающей типу содержимого MIME, если оно было определено. В этом примере — для файла изображения TIFF:
  
HKEY_LOCAL_MACHINE\
  
Software\
  
Microsoft\
  
Classes\
  
.tif
  
Тип контента = «image/tiff»
  
Если отсутствует сопоставление для расширения файла, следует использовать *приложение/октета* поток по умолчанию. 
  
На входящих сообщений типа контента для вложения, которое необходимо копировать всегда в свойство MAPI **PR_ATTACH_MIME_TAG** ([PidTagAttachMimeTag](pidtagattachmimetag-canonical-property.md)). Даже в том случае, если имя файла определен для вложенного файла, расширение, сопоставленные с типом содержимого должен использоваться в свойства **PR_ATTACH_EXTENSION** ([PidTagAttachExtension](pidtagattachextension-canonical-property.md)) и **PR_ATTACH_FILENAME** ([PidTagAttachFilename](pidtagattachfilename-canonical-property.md)) .
  
Параметр *name* официально поддерживается, согласно документу RFC 821. По мере стандартов Microsoft будут использоваться указания альтернативного сопоставления для вложенных файлов. 
  
Вложенные исходящие сообщения отправляются в виде * Content-type: message/rfc822 * сообщения в рамках вложенные сообщения, закодированный рекурсивно, вместо них соответствующих прав. Входящий трафик содержимого части сообщения с *Content-Type: multipart/digest* также сопоставляются с внедренных сообщений. 
  
При использовании uuencode с TNEF а кодировка содержимого сообщения все вложения свойства и содержимое находятся в поток TNEF. TNEF самого — это один двоичный вложенные файл с именем Winmail.dat в кодировке, как описано для Uuencode без TNEF.
  
При использовании uuencode без TNEF все вложенные файлы обрабатывается как двоичный и формате UUENCODE, выполнив текста сообщения. Имя файла присутствует в заголовке uuencode:
  
 начать 0755 Winmail.dat 
  
 ... данных... 
  
 end 
  
Вложенные сообщения textized в текст сообщения. Иерархия вложенные сообщения всегда сведение; то есть сообщения в рамках вложенные сообщения извлекаются на верхний уровень.
  
Внедренные объекты OLE, отбрасываются.
  
Вложения визуализации положения передаются сам, с помощью свойства **PR_ATTACH_RENDERING** ([PidTagAttachRendering](pidtagattachrendering-canonical-property.md)) в формате TNEF. Если не используется формат TNEF, они будут потеряны. Входящие вложения с не положения (в том числе при не TNEF) иметь свои положения значение 0xFFFFFFFF, то есть не позицию в качестве текста сообщения.
  
## <a name="see-also"></a>См. также



[Сопоставление атрибутов почты Интернета со свойствами MAPI](mapping-of-internet-mail-attributes-to-mapi-properties.md)


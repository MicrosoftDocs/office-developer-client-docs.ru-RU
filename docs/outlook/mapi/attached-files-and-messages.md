---
title: Вложенные файлы и сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b2f2fb72-23ae-4e0b-a8a1-3b78a1862acb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c4dbe1a761a753bef77168aec8d2674a1b2b100e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436841"
---
# <a name="attached-files-and-messages"></a>Вложенные файлы и сообщения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Если MIME с TNEF используется при кодивной кодивности содержимого сообщения, все свойства и содержимое вложений находятся в потоке TNEF. Сам TNEF — это один двоичный вложенный файл с именем Winmail.dat, закодированный как описано для MIME без TNEF. 
  
Если MIME используется без TNEF, вложенные файлы отправляются в качестве частей содержимого сообщения MIME. Имя файла помещается в параметр  *name*  в заглавную папку типа  *content*  для вложения. Набор символов для вложения помещается в параметр  *charset*  для типа  *Content;*  оно и кодировидная передача содержимого определяются путем сканирования всего содержимого вложения. Вложения URL-адресов обрабатываются особым образом: 
  
- Если вложение является URL-адресом (вложенный файл с расширением. URL-адрес), а режим доступа, определенный в нем, анонимный FTP, кодируется как внешнее сообщение, а содержимое файла (URL-адрес) копируется в загон внешнего сообщения. *Content-type: message/external-body; access-type=anon-ftp*  (Content-Transfer-Encoding: 7bit is assumed.) 
    
- Если найдены только 7-битные символы и длина строки не превышает 140 символов, вложением будет текст ASCII. *Тип контента: текст/обычный; charset=us-ascii Content-Transfer-Encoding: 7bit* 
    
- Если найдены длинные строки или до 25 % 8-битных символов, содержимое вложения — это текст, а набор символов определяется региональными настройками. Его следует выбирать из наборов символов, определенных стандартом ISO 8859. *Тип контента: text/plain; charset=ISO-8859-1*  (например) 
    
     *Content-Transfer-Encoding: quoted-printable* 
    
- Если для 25% или более символов установлен высокий бит, вложение будет двоичным. Кодируются с помощью алгоритма Base64. *Тип контента: application/octet-stream*  (по умолчанию на основе расширения файла) 
    
     * Content-Transfer-Encoding: base64 * 
    
В исходящие сообщения тип контента должен быть производным от трехбуквеченного расширения имени файла. Это сопоставление существует в системный реестр; под строкой с именем "Content Type" (Тип контента), которая предоставляет тип контента MIME, если он определен. Этот пример для TIFF-файла изображения:
  
HKEY_LOCAL_MACHINE\
  
Программное обеспечение\
  
Microsoft\
  
Classes\
  
.tif
  
Тип контента = "image/tiff"
  
Если сопоставление для расширения файла не существует, следует использовать поток  *приложения или октета*  по умолчанию. 
  
Во входящие сообщения тип контента для вложения всегда следует копировать в свойство MAPI **PR_ATTACH_MIME_TAG** ([PidTagAttachMimeTag).](pidtagattachmimetag-canonical-property.md) Даже если для вложенного файла определено имя файла, расширение, соотносимые с типом контента, следует использовать в свойствах **PR_ATTACH_FILENAME** ([PidTagAttachFilename)](pidtagattachfilename-canonical-property.md)и **PR_ATTACH_EXTENSION** ([PidTagAttachExtension).](pidtagattachextension-canonical-property.md)
  
Параметр  *name*  официально не задан в RFC 821. По мере развития стандартов Корпорация Майкрософт рассмотрит возможность указания альтернативного сопоставления для вложенных имен файлов. 
  
Исходящие вложенные сообщения отправляются как * Content-type: message/rfc822 * Messages within attached messages are encoded recursively, in their proper place. Части содержимого входящие сообщений  *с content-Type: multipart/digest*  также со картой внедренных сообщений. 
  
Если uuencode с TNEF используется при кодировании содержимого сообщения, все свойства и содержимое вложения находятся в потоке TNEF. Сам TNEF — это один двоичный вложенный файл с именем Winmail.dat, закодированный как описано для Uuencode без TNEF.
  
Если uuencode используется без TNEF, все вложенные файлы обрабатываются как двоичные и uuencoded, следуя тексту сообщения. Имя файла присутствует в загоделе uuencode:
  
 0755 Winmail.dat 
  
 ... data ... 
  
 end 
  
Вложенные сообщения текстизируются в текст сообщения. Иерархия вложенных сообщений всегда плоская; то есть сообщения в вложенных сообщениях извлекаются на верхний уровень.
  
Внедренные объекты OLE удаляются.
  
Положения отрисовки вложений передаются буквально с помощью свойства **PR_ATTACH_RENDERING** ([PidTagAttachRendering)](pidtagattachrendering-canonical-property.md)в TNEF. Если TNEF не используется, они теряются. Для входящих вложений без позиции отрисовки (в том числе при отсутствие TNEF) установлено положение 0xFFFFFFFF, то есть нет положения в тексте сообщения.
  
## <a name="see-also"></a>См. также



[Сопоставление атрибутов почты Интернета со свойствами MAPI](mapping-of-internet-mail-attributes-to-mapi-properties.md)


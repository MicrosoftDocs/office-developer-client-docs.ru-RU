---
title: Присоединенные файлы и сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b2f2fb72-23ae-4e0b-a8a1-3b78a1862acb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c4dbe1a761a753bef77168aec8d2674a1b2b100e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436841"
---
# <a name="attached-files-and-messages"></a>Присоединенные файлы и сообщения

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Если MIME с TNEF используется при кодовом коде контента сообщений, все свойства и содержимое вложений находятся в потоке TNEF. Сам TNEF представляет собой единый двоичный присоединенный файл winmail.dat, закодированный как описано для MIME без TNEF. 
  
Если MIME используется без TNEF, присоединенные файлы отправляются в качестве частей контента сообщения MIME. Имя файла помещается в  *параметре имя*  в заглавную папку  *типа Контент*  для вложения. Набор символов для вложения помещается в  *параметре charset*  для  *типа Content;*  оно и кодироление переноса контента определяются путем сканирования всего содержимого вложения. Вложения URL-адресов обрабатываются специально: 
  
- Если вложение является URL-адресом (присоединенный файл с расширением. URL-адрес), а режим доступа, определенный в нем, является анонимным FTP, кодируется как внешнее сообщение, а содержимое файла (URL-адрес) копируется в загон внешнего сообщения. *Тип контента: сообщение/внешнее тело; access-type=anon-ftp*  (предполагается контент-transfer-Encoding: 7bit).) 
    
- Если найдены только 7-битные символы, а длина строки не превышает 140 символов, вложение — это текст ASCII. *Тип контента: текст/обычная; charset=us-ascii Content-Transfer-Encoding: 7bit* 
    
- Если найдены длинные строки или до 25% 8-битных символов, содержимое вложения является текстовым, а набор символов определяется локализом. Его следует выбирать из наборов символов, определенных стандартом ISO 8859. *Тип контента: text/plain; charset=ISO-8859-1*  (например) 
    
     *Content-Transfer-Encoding: quoted-printable* 
    
- Если 25% или более символов имеют высокий бит, вложение двоично. Кодируются с помощью алгоритма Base64. *Тип контента: application/octet-stream*  (по умолчанию, в зависимости от расширения файла) 
    
     * Кодинг контента-передачи: base64 * 
    
В исходящие сообщения тип контента должен быть получен из расширения файла с тремя буквами. Это сопоставление существует в реестре системы; под строкой имеется значение "Тип контента", которое дает тип контента MIME, если он определен. В этом примере для файла изображений TIFF:
  
HKEY_LOCAL_MACHINE\
  
Программное обеспечение\
  
Microsoft\
  
Классы\
  
.tif
  
Тип контента = "изображение/tiff"
  
Если нет сопоставления для расширения файла, следует использовать поток  *приложения и octet*  по умолчанию. 
  
В входящие сообщения тип контента для вложения всегда должен быть **скопирован** в свойство MAPI PR_ATTACH_MIME_TAG [(PidTagAttachMimeTag).](pidtagattachmimetag-canonical-property.md) Даже если для присоединенного файла определено имя файла, расширение, отображенное типом контента, следует использовать в свойствах **PR_ATTACH_FILENAME** [(PidTagAttachFilename)](pidtagattachfilename-canonical-property.md)и **PR_ATTACH_EXTENSION** [(PidTagAttachExtension).](pidtagattachextension-canonical-property.md)
  
Параметр  *имя*  официально отстает от RFC 821. По мере развития стандартов Корпорация Майкрософт рассмотрит возможность указания альтернативного сопоставления для присоединенных имен файлов. 
  
Исходящие присоединенные сообщения отправляются в виде * Типа контента: сообщения/rfc822 * Сообщения в прикрепленных сообщениях кодируются повторно, в их надлежащем месте. Входящие части контента сообщений  *с контентом типа Content-Type: multipart/digest*  также отображёны для встроенных сообщений. 
  
Если uuencode с TNEF используется при кодировании контента сообщений, все свойства и содержимое вложений находятся в потоке TNEF. Сам TNEF — это один двоичный присоединенный файл с именем Winmail.dat, закодированный как описано для Uuencode без TNEF.
  
Если uuencode используется без TNEF, все присоединенные файлы рассматриваются как двоичные и uuencoded, следуя тексту сообщения. Имя файла присутствует в загонщике uuencode:
  
 начало 0755 Winmail.dat 
  
 ... данные ... 
  
 end 
  
Присоединенные сообщения текстовые в текст сообщения. Иерархия присоединенных сообщений всегда выравнивается; то есть сообщения в прикрепленных сообщениях извлекаются на верхний уровень.
  
Встроенные объекты OLE удаляются.
  
Позиции отрисовки вложений передаются в буквальном смысле, **используя** свойство [PR_ATTACH_RENDERING (PidTagAttachRendering)](pidtagattachrendering-canonical-property.md)в TNEF. Если TNEF не используется, они теряются. Входящие вложения без позиции отрисовки (в том числе при отсутствие TNEF) имеют свою позицию отрисовки 0xFFFFFFFF, то есть нет позиции в тексте сообщения.
  
## <a name="see-also"></a>См. также



[Сопоставление атрибутов интернет-почты с свойствами MAPI](mapping-of-internet-mail-attributes-to-mapi-properties.md)


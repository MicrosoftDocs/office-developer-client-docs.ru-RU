---
title: Вложенные файлы и сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b2f2fb72-23ae-4e0b-a8a1-3b78a1862acb
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c4dbe1a761a753bef77168aec8d2674a1b2b100e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436841"
---
# <a name="attached-files-and-messages"></a>Вложенные файлы и сообщения

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Если при кодировании содержимого сообщения используется MIME с ФОРМАТом TNEF, все свойства и содержимое вложений находятся в потоке TNEF. ФОРМАТ TNEF сам по себе представляет собой отдельный двоичный файл Winmail. dat, закодированный как описанный для MIME без формата TNEF. 
  
Если MIME используется без формата TNEF, вложенные файлы отправляются как части MIME-содержимого сообщений. Имя файла помещается в параметр *Name* в заголовок *Content-Type* для вложения. Набор знаков для вложения размещается в параметре *CharSet* для *Content-Type* ; Он и кодирование контента зависят от сканирования всего содержимого вложения. Вложения URL-адресов имеют особую отсебе: 
  
- Если вложение является URL-АДРЕСом (вложенный файл с расширением. URL-адрес), а режим доступа, определенный в нем анонимный FTP, он кодируется как внешнее сообщение, а содержимое файла (URL-адрес) копируется в заголовок внешнего сообщения. *Content-Type: Message/External-Body; Access-Type = Анон-FTP*  (Content-Transfer-Encoding: 7bit предполагается.) 
    
- Если найдены только 7-разрядные символы, и длина строки не превышает 140 символов, то вложение будет ASCII-текст. *Content-Type: text/plain; charset = US – ASCII Content — Transfer – Encoding: 7bit* 
    
- Если найдены длинные строки или до 25% 8-разрядных символов, содержимое вложения будет текстовым, а набор знаков будет определяться языковым стандартом. Он должен быть выбран из наборов символов, определенных стандартом ISO 8859. *Content-Type: text/plain; charset = ISO-8859-1*  (например,) 
    
     *Content-Transfer-Encoding: quoted-printable* 
    
- Если для 25% или более символов задана Высокая скорость, вложение будет двоичным. Он кодируется с помощью алгоритма Base64. *Content-Type: Application/октет-Stream*  (по умолчанию; в зависимости от расширения файла) 
    
     * Content — Transfer — Encoding: Base64 * 
    
В исходящих сообщениях тип контента должен быть производным от третьего расширения имени файла. Это сопоставление существует в системном реестре; в разделе существует строковое значение с именем "тип контента", которое предоставляет тип контента MIME, если он определен. Этот пример предназначен для файла изображения TIFF:
  
Раздел
  
По
  
Корпораци
  
Классы
  
TIF
  
Тип контента = "Image/TIFF"
  
Если сопоставление для расширения файла отсутствует, следует использовать поток *приложения и октета* по умолчанию. 
  
Во входящих сообщениях тип контента для вложения всегда должен копироваться в свойство MAPI **пр_аттач_миме_таг** ([PidTagAttachMimeTag](pidtagattachmimetag-canonical-property.md)). Даже если для вложенного файла определено имя файла, в свойствах **пр_аттач_филенаме** ([PidTagAttachFilename](pidtagattachfilename-canonical-property.md)) и **пр_аттач_екстенсион** ([PidTagAttachExtension](pidtagattachextension-canonical-property.md)) необходимо использовать расширение, сопоставленное с типом контента. .
  
Параметр *Name* официально устарел в соответствии со спецификацией RFC 821. По мере развития стандартов Корпорация Майкрософт рассматривает указание альтернативного сопоставления для присоединенных имен файлов. 
  
ИсХодящие вложенные сообщения отправляются в виде * Content-Type: сообщения/RFC822 * сообщения в вложенных сообщениях кодируются рекурсивно в надлежащем месте. Части контента входящих сообщений с *Content-Type: multipart/Digest* также сопоставляются с внедренными сообщениями. 
  
Если при кодировании содержимого сообщения используется uuencode с ФОРМАТом TNEF, все свойства и содержимое вложений находятся в потоке TNEF. ФОРМАТ TNEF сам по себе является отдельным двоичным файлом Winmail. dat, который кодируется в соответствии с описанием для uuencode без формата TNEF.
  
Если кодировка UUEncode используется без формата TNEF, все вложенные файлы обрабатываются как двоичные и ууенкодед, после текста сообщения. Имя файла присутствует в заголовке uuencode:
  
 Начало 0755 Winmail. dat 
  
 ... данные... 
  
 end 
  
Вложенные сообщения выводятся в тексте сообщения. Иерархия вложенных сообщений всегда сведена; то есть сообщения в прикрепленных сообщениях отправляются на верхний уровень.
  
Внедренные объекты OLE отбрасываются.
  
Позиции отображения вложений передаются буквально, используя свойство **пр_аттач_рендеринг** ([PIDTAGATTACHRENDERING](pidtagattachrendering-canonical-property.md)) в формате TNEF. Если формат TNEF не используется, они теряются. Для входящих вложений без позиции отрисовки (в том случае, когда отсутствует формат TNEF) позиция отображения в тексте сообщения не задана.
  
## <a name="see-also"></a>См. также



[Сопоставление атрибутов почты Интернета со свойствами MAPI](mapping-of-internet-mail-attributes-to-mapi-properties.md)


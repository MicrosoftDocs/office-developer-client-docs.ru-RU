---
title: Отправка сообщений с помощью MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3edfbfff-ea15-4926-bf0f-47137251d921
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bf6324b89f06ef7f0553d3de1eaa24ae31a329ba
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438724"
---
# <a name="sending-messages-by-using-mapi"></a>Отправка сообщений с помощью MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения звонят [по методу IMessage::SubmitMessage](imessage-submitmessage.md) для отправки сообщения. **SubmitMessage** вызывает [IMAPIProp::SaveChanges,](imapiprop-savechanges.md) чтобы сохранить сообщение перед передачей управления в пулер MAPI или непосредственно поставщику транспорта. 
  
Spooler MAPI получает сообщение, если произойдет следующее:
  
- Поставщик и поставщик транспорта для хранения сообщений не тесно совмещение.
    
- Сообщение требует предварительной подготовки.
    
- Тесное хранилище и транспорт сообщений не может обрабатывать всех получателей, к которым адресовано сообщение.
    
В тесном хранилище сообщений необходимо принять во внимание состояние сообщения, прежде чем оно будет представлено в пулер MAPI, который будет загружен поставщику транспорта. Существуют ситуации, когда сообщение может потребовать пульпера MAPI, но шпалер MAPI действительно не должен быть вовлечен.
  
Например, рассмотрим ситуацию, когда пользователь передает сообщение из почтового ящика. Клиент использует тесно соединый магазин и транспорт. Если в тесном хранилище сообщений используется расположение сообщения в качестве единственного критерия для принятия решения о том, разрешить ли пуллеру MAPI обрабатывать сообщение, пуллер MAPI всегда будет получать сообщение. Чтобы избежать подобных проблем, в хранилище сообщений с тесной связи необходимо проверить состояние сообщения в дополнение к расположению сообщения. В частности, поставщик транспорта не должен запрашивать, чтобы spooler MAPI скачал любое сообщение, которое активно отправлено.
  
Процесс передачи сообщений включает поставщика хранения сообщений, одного или несколько поставщиков транспорта и MAPI. В разделах этого раздела подробно описаны конкретные роли в процессе передачи сообщений.
  
## <a name="see-also"></a>См. также



[IMessage::SubmitMessage](imessage-submitmessage.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)


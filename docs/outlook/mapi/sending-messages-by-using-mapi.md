---
title: Отправка сообщений с помощью MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3edfbfff-ea15-4926-bf0f-47137251d921
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bf6324b89f06ef7f0553d3de1eaa24ae31a329ba
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438724"
---
# <a name="sending-messages-by-using-mapi"></a>Отправка сообщений с помощью MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения вызывают [метод IMessage::SubmitMessage](imessage-submitmessage.md) для отправки сообщения. **SubmitMessage** вызывает [IMAPIProp::SaveChanges,](imapiprop-savechanges.md) чтобы сохранить сообщение перед передачей управления в пулер MAPI или непосредственно поставщику транспорта. 
  
Пулер MAPI получает сообщение, если происходит следующее:
  
- Поставщик и поставщик транспорта, хранимые в хранилище сообщений, не имеют тесной связи.
    
- Сообщение требует предварительной подготовки.
    
- Тесное хранилище сообщений и транспорт не могут обрабатывать всех получателей, которым адресовано сообщение.
    
Для загрузки сообщения поставщику транспорта в тесном хранилище сообщений необходимо учесть состояние сообщения, прежде чем оно будет представлено в пуле MAPI. В ряде ситуаций может показаться, что для сообщения требуется пулер MAPI, но в самом деле, это не должно быть задействовано.
  
Например, рассмотрим ситуацию, когда пользователь передает сообщение из "Входящие". Клиент использует тесное хранилище и транспорт. Если в тесном хранилище сообщений в качестве единственного критерия для принятия решения о том, следует ли разрешить пуле MAPI обрабатывать сообщение, то пулер MAPI всегда будет получать сообщение. Чтобы избежать подобных проблем, в тесном хранилище сообщений необходимо проверять состояние сообщения в дополнение к расположению сообщения. В частности, поставщик транспорта не должен запрашивать загрузку пулом MAPI сообщений, которые активно отправлены.
  
Процесс передачи сообщений включает поставщика хранения сообщений, одного или несколько поставщиков транспорта и MAPI. В темах этого раздела подробно описаны определенные роли в процессе передачи сообщений.
  
## <a name="see-also"></a>См. также



[IMessage::SubmitMessage](imessage-submitmessage.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)


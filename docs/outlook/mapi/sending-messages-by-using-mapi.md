---
title: Отправка сообщений с помощью MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3edfbfff-ea15-4926-bf0f-47137251d921
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 36de3b70b0ab7b16f8abed85bbd0983224e00568
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812243"
---
# <a name="sending-messages-by-using-mapi"></a>Отправка сообщений с помощью MAPI

  
  
**Относится к**: Outlook 
  
Клиентские приложения вызовите метод [IMessage::SubmitMessage](imessage-submitmessage.md) , чтобы отправить сообщение. **SubmitMessage** вызывает [IMAPIProp::SaveChanges](imapiprop-savechanges.md) для сохранения сообщения перед передачей управления диспетчер очереди MAPI или непосредственно к поставщику транспорта. 
  
Диспетчер очереди MAPI получает сообщение при возникновении любого из следующих:
  
- Поставщик транспорта и поставщика хранилища сообщений не являются тесно связанными.
    
- Сообщение необходимо предварительной обработки.
    
- Хранилище тесно связанных сообщений и транспорта не может обрабатывать всех получателей, которым адресовано сообщение.
    
Хранилище тесно связанных сообщений следует учитывать состояние сообщения перед его представляет диспетчер очереди MAPI веб-сайта для поставщика транспорта. Бывают ситуации, чтобы сделать обязательным наличие диспетчер очереди MAPI может появиться сообщение, когда диспетчер очереди MAPI следует действительно не принимать участие.
  
Например рассмотрим ситуацию, когда пользователь отправляет сообщения, находящиеся в папке "Входящие". Клиент использует тесно связанных хранилище и транспорта. Если хранилище тесно связанных сообщений использует расположение сообщения в качестве единственного критерии решения о необходимости разрешить диспетчер очереди MAPI для обработки сообщения, диспетчер очереди MAPI всегда будет выведено сообщение. Во избежание такой проблемы, хранилищем тесно связанных сообщений необходимо проверить состояние сообщения в дополнение к расположение сообщения. В частности поставщика транспорта не должен запрашивать, что диспетчер очереди MAPI загрузите все сообщение, отправляемое активно.
  
Процесс передачи сообщений включает поставщика хранилища сообщений, одним или несколькими поставщиками транспорта и MAPI. В этом разделе представлены подробные сведения о конкретных ролей в процессе передачи сообщений.
  
## <a name="see-also"></a>См. также



[IMessage::SubmitMessage](imessage-submitmessage.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)


---
title: Отправка сообщений с помощью MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3edfbfff-ea15-4926-bf0f-47137251d921
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: bf6324b89f06ef7f0553d3de1eaa24ae31a329ba
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32339755"
---
# <a name="sending-messages-by-using-mapi"></a>Отправка сообщений с помощью MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиентские приложения вызывают метод [iMessage:: субмитмессаже](imessage-submitmessage.md) для отправки сообщения. **Субмитмессаже** вызывает [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) для сохранения сообщения перед передачей управления диспетчеру MAPI или непосредственно поставщику транспорта. 
  
Очередь MAPI получает сообщение в следующих случаях:
  
- Поставщик хранилища сообщений и поставщик транспорта не тесно связаны.
    
- Сообщение требует предварительной обработки.
    
- Тесно связанный банк сообщений и транспорт не могут обрабатывать всех получателей, которым адресовано сообщение.
    
Жестко связанное хранилище сообщений должно учитывать состояние сообщения перед тем, как оно будет представлено диспетчером очереди MAPI для загрузки в поставщик транспорта. Существуют ситуации, в которых может потребоваться, чтобы в сообщении отображался почтовый диспетчер MAPI, но диспетчер очереди MAPI не должен быть включен.
  
Например, рассмотрим ситуацию, когда пользователь передает сообщение из папки "Входящие". Клиент использует тесно связанное хранилище и транспорт. Если тесно связанное хранилище сообщений использует расположение сообщения в качестве единственного условия для принятия решения о том, следует ли разрешить диспетчеру очереди MAPI обрабатывать сообщение, диспетчер очереди MAPI всегда будет получать сообщение. Чтобы избежать такого рода проблем, строго связанное хранилище сообщений должно проверять состояние сообщения в дополнение к расположению сообщения. В частности, поставщик транспорта не должен запрашивать, чтобы диспетчер очереди MAPI загружал сообщение, которое отправляется в активном состоянии.
  
Процесс передачи сообщений включает в себя поставщика хранилища сообщений, одного или нескольких поставщиков транспорта и MAPI. В подразделах этого раздела представлены подробные сведения об определенных ролях в процессе передачи сообщений.
  
## <a name="see-also"></a>См. также



[IMessage::SubmitMessage](imessage-submitmessage.md)
  
[IMAPIProp::SaveChanges](imapiprop-savechanges.md)


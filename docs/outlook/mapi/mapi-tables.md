---
title: Таблицы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437086"
---
# <a name="mapi-tables"></a>Таблицы MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Таблица MAPI — это объект MAPI, который используется для просмотра коллекции свойств, принадлежащих другим объектам MAPI определенного типа. Таблицы MAPI структурированы в виде строк и столбцов, каждая строка которых представляет объект, а каждый столбец — свойство объекта. Одним из свойств, обычно включенных в каждую **строку,** является свойство PR_ENTRYID ([PidTagEntryId),](pidtagentryid-canonical-property.md)идентификатор, который можно использовать для открытия и изменения объекта. 
  
Так как строки содержат значения свойств, получение строки из таблицы аналогично получении набора свойств непосредственно из объекта, представленного строкой. В результате обеих операций будет выявить массив значений свойств. Основное различие заключается в обработке длинных строк и двоичных свойств. Для включения в таблицу некоторые реализации таблиц усегляет эти свойства до 255 bytes. При извлечении непосредственно из объекта полное значение всегда доступно.
  
Таблицы реализуются поставщиками адресной книги и хранения сообщений, а также MAPI в зависимости от типа таблицы и объектов в ней. Поставщик содержимого реализует папки и таблицу содержимого для каждой папки, которая содержит сведения о сообщениях в папке. Поставщик адресной книги реализует контейнеры адресной книги и таблицу иерархии, в котором показана их организация. MAPI реализует несколько различных таблиц, некоторые из них используются клиентских приложений, некоторые для использования поставщиками услуг, а некоторые для обоих. Таблица состояния уникальна тем, что MAPI в конечном итоге передает таблицу, но строки состоят из вкладов всех типов поставщиков услуг в дополнение к MAPI. 
  
На следующем рисунке показано одно из часто используемых таблиц в MAPI: отображение содержимого папки. Справа отображается два сообщения, которые могут отображаться в типичном клиентских приложениях для обмена сообщениями. Отображение содержит четыре части сведений о каждом сообщении: отправитель, получатель, тема и текст сообщения. Каждый фрагмент информации соответствует свойству сообщения.
  
Слева находится представление таблицы содержимого, которая включает эти два сообщения. В то время как в таблице содержимого может быть десять строк, так как папка содержит десять сообщений, каждая строка содержит больше трех столбцов, в этом представлении может быть только две строки и три столбца.
  
В следующей таблице показаны свойства, которые составляют набор столбцов для представления таблицы.
  
|**Свойство**|**Описание**|
|:-----|:-----|
|**PR_SENDER_NAME** ([PidTagSenderName)](pidtagsendername-canonical-property.md)  <br/> |Имя отправитель  <br/> |
|**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime)](pidtagoriginaldeliverytime-canonical-property.md)  <br/> |Дата и время, когда было отправлено сообщение  <br/> |
|**PR_SUBJECT** ([PidTagSubject)](pidtagsubject-canonical-property.md)  <br/> |Строка темы сообщения  <br/> |
   
Обратите внимание, что набор свойств, отображаемого в сообщении, не такой, как набор столбцов, отображаемой в таблице. В данном случае поставщик, реализуя таблицу, поставщик хранилище сообщений, передает набор столбцов по умолчанию в порядке по умолчанию. Клиент может изменять этот набор столбцов, запрашивать дополнительные столбцы или отклонить их по умолчанию, а также запрашивать их упорядочение определенным образом. Клиент также может заказать строки, сортировать их в соответствии со значением одного или более столбцов.
  
**Использование таблицы для отображения содержимого папки**
  
![Использование таблицы для отображения содержимого папки]с помощью таблицы для отображения(media/amapi_54.gif "содержимого папки")
  
Существует два интерфейса для работы с таблицами:
  
- [IMAPITable : IUnknown](imapitableiunknown.md) предоставляет клиентам и поставщикам услуг представление только для чтения данных в таблице, позволяя им просматривать и изменять только презентацию. Несколько пользователей могут получать доступ к одному и тем же данным одновременно с **IMAPITable.** **IMAPITable** реализуется MAPI и поставщиками услуг. 
    
- [ITableData : IUnknown](itabledataiunknown.md) предоставляет клиентам и поставщикам услуг доступ на чтение и записи к данным в таблице, позволяя им вносить постоянные изменения. **IMAPITable** реализуется mapI и в основном используется поставщиками служб, которые имеют к нему доступ, вызывая [функцию CreateTable.](createtable.md) Реализация **ITableData** содержит все данные для таблицы и все связанные ограничения в памяти, что делает ее неподходящей для использования с очень большими таблицами. Составные ограничения и сложные операции, такие как категоризация, неподтверчены. 
    
## <a name="see-also"></a>См. также

- [Понятия MAPI](mapi-concepts.md)


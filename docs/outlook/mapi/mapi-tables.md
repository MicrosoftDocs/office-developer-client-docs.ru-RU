---
title: Таблицы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33437086"
---
# <a name="mapi-tables"></a>Таблицы MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Таблица MAPI — это объект MAPI, который используется для просмотра коллекции свойств, принадлежащих другим объектам MAPI определенного типа. Таблицы MAPI структурированы в формате строки и столбца, каждая строка представляет объект и каждый столбец, представляющий свойство объекта. Одним из свойств, обычно включенных в каждую **строку,** является свойство [PR_ENTRYID (PidTagEntryId),](pidtagentryid-canonical-property.md)идентификатор, который можно использовать для открытия и изменения объекта. 
  
Поскольку строки содержат значения свойств, получение строки из таблицы похоже на получение набора свойств непосредственно с объекта, который представляет строка. В результате обеих операций будет выявим массив значений свойств. Основное отличие заключается в обработке длинных строк и двоичных свойств. Для включения в таблицу некоторые реализутели таблицы усечены до 255 bytes. При непосредственном извлечении из объекта полное значение всегда доступно.
  
Таблицы реализуются поставщиками адресной книги и магазина сообщений и MAPI в зависимости от типа таблицы и объектов в ней. Поставщик магазина сообщений реализует папки и таблицу содержимого для каждой папки, которая содержит сведения о сообщениях в папке. Поставщик адресных книг реализует контейнеры адресных книг и таблицу иерархии, в которую указывается их организация. MAPI реализует несколько различных таблиц, некоторые из них для использования в клиентских приложениях, некоторые для использования поставщиками услуг, а некоторые для использования обоими. Таблица состояния уникальна тем, что MAPI в конечном счете поставляет таблицу, но строки состоят из взносов всех типов поставщиков услуг в дополнение к MAPI. 
  
На следующем рисунке показано одно из часто используемых таблиц в MAPI: отображение содержимого папки. Справа отображается два сообщения, которые могут отображаться в типичном клиентской приложении для обмена сообщениями. Дисплей содержит четыре части сведений о каждом сообщении: отправитель, получатель, субъект и текст сообщения. Каждая часть информации соответствует свойству сообщения.
  
Слева — представление таблицы контента, которая включает эти два сообщения. Если в таблице контента может быть десять строк, так как в папке десять сообщений, в каждой строке содержится более трех столбцов, это представление ограничено только двумя строками и тремя столбцами.
  
В следующей таблице показаны свойства, которые составляют столбец для представления таблицы.
  
|**Свойство**|**Описание**|
|:-----|:-----|
|**PR_SENDER_NAME** [(PidTagSenderName)](pidtagsendername-canonical-property.md)  <br/> |Имя отправитель  <br/> |
|**PR_ORIGINAL_DELIVERY_TIME** [(PidTagOriginalDeliveryTime)](pidtagoriginaldeliverytime-canonical-property.md)  <br/> |Дата и время, когда было отправлено сообщение  <br/> |
|**PR_SUBJECT** [(PidTagSubject)](pidtagsubject-canonical-property.md)  <br/> |Строка темы сообщения  <br/> |
   
Обратите внимание, что набор свойств, отображаемого в сообщении, не то же самое, что набор столбцов, отображаемого в таблице. В этом случае поставщик хранения сообщений, реализутель таблицы, поставляет набор столбцов по умолчанию в порядке по умолчанию. Клиент может изменить этот набор столбцов, запросив дополнительные столбцы или отказавшись от них по умолчанию, и попросить их заказать определенным образом. Клиент также может заказать строки, сортировать их в соответствии со значением одного или более столбцов.
  
**Использование таблицы для отображения содержимого папки**
  
![Использование таблицы для отображения содержимого папки]с помощью таблицы(media/amapi_54.gif "для отображения содержимого папок")
  
Существует два интерфейса для работы со таблицами:
  
- [IMAPITable: IUnknown](imapitableiunknown.md) предоставляет клиентам и поставщикам услуг только для чтения представление данных, которые находятся в таблице, что позволяет им просматривать и изменять только презентацию. Несколько пользователей могут получать доступ к одинаковым данным одновременно с **IMAPITable**. **IMAPITable** реализуется MAPI и поставщиками услуг. 
    
- [ITableData: IUnknown](itabledataiunknown.md) предоставляет клиентам и поставщикам услуг доступ к данным таблицы, позволяющим им вносить постоянные изменения. **IMAPITable** реализуется MAPI и используется в основном поставщиками услуг, которые имеют к нему доступ, вызывая [функцию CreateTable.](createtable.md) Реализация **ITableData** содержит все данные для таблицы и все связанные ограничения в памяти, что делает ее непригодной для использования с очень большими таблицами. Сложные ограничения и сложные операции, такие как классификация, неподтверчены. 
    
## <a name="see-also"></a>См. также

- [Понятия MAPI](mapi-concepts.md)


---
title: Таблицы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32355840"
---
# <a name="mapi-tables"></a>Таблицы MAPI
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Таблица MAPI — это объект MAPI, используемый для просмотра коллекции свойств, принадлежащих другим объектам MAPI определенного типа. Таблицы MAPI структурированы в виде строк и столбцов с каждой строкой, представляющей объект, и каждым столбцом, представляющим свойство объекта. Одним из свойств, которые обычно включаются в каждую строку, является свойство **пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)), которое можно использовать для открытия и изменения объекта. 
  
Так как строки содержат значения свойств, Извлечение строки из таблицы аналогично получению набора свойств непосредственно из объекта, который представляет строка. Обе операции приводят к извлечению массива значений свойства. Основное отличие заключается в обработке длинных строковых и двоичных свойств. Для включения в таблицу некоторые разработчики таблиц усекаются эти свойства до 255 байт. При получении непосредственно из объекта полное значение всегда доступно.
  
Таблицы реализуются адресными книгами и поставщиками хранилищ сообщений и MAPI в зависимости от типа таблицы и содержащихся в ней объектов. Поставщик хранилища сообщений реализует папки и таблицу содержимого для каждой папки, в которой содержатся сведения о сообщениях в папке. Поставщик адресных книг реализует контейнеры адресных книг и таблицу иерархии, в которой отображается их организация. MAPI реализует несколько различных таблиц, некоторые из них для использования клиентскими приложениями, некоторые для использования поставщиками услуг и некоторые из них для их использования. Таблица Status является уникальной в том, что в конечном счете она предоставляет таблицу, но строки состоят из вкладов всех типов поставщиков услуг в дополнение к MAPI. 
  
На следующем рисунке показано одно из часто используемых таблиц в MAPI: для отображения содержимого папки. Справа отображается два сообщения, которые могут отображаться в типичном клиентском приложении обмена сообщениями. Отображение содержит четыре части сведений о каждом сообщении: отправитель, получатель, тема и текст сообщения. Каждая часть данных соответствует свойству сообщения.
  
Слева находится представление таблицы содержимого, включающей эти два сообщения. В то время как в таблице содержимого может быть десять строк, так как папка содержит десять сообщений, а каждая строка содержит не более трех столбцов, это представление ограничено только двумя строками и тремя столбцами.
  
В следующей таблице показаны свойства, которые составляют набор столбцов для представления таблицы.
  
|**Свойство**|**Описание**|
|:-----|:-----|
|**Пр_сендер_наме** ([PidTagSenderName](pidtagsendername-canonical-property.md))  <br/> |Имя отПравителя  <br/> |
|**Пр_оригинал_деливери_тиме** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))  <br/> |Дата и время отправки сообщения  <br/> |
|**Пр_субжект** ([PidTagSubject](pidtagsubject-canonical-property.md))  <br/> |Строка темы сообщения  <br/> |
   
Обратите внимание, что набор свойств, отображаемых в сообщении, не совпадает с набором столбцов, отображаемых в таблице. Разработчик таблицы (в данном случае — поставщик хранилища сообщений) предоставляет набор столбцов по умолчанию в порядке по умолчанию. Клиент может изменить этот набор столбцов, запросив дополнительные столбцы или отклонить значения по умолчанию, а также попросить, чтобы они были упорядочены определенным образом. Клиент также может упорядочивать строки, сортируя их в соответствии со значением одного или нескольких столбцов.
  
**Использование таблицы для отображения содержимого папки**
  
![Использование таблицы для отображения содержимого папки] (media/amapi_54.gif "Использование таблицы для отображения содержимого папки")
  
Существует два интерфейса для работы с таблицами:
  
- [IMAPITable: интерфейс IUnknown](imapitableiunknown.md) предоставляет клиентам и поставщикам услуг доступное только для чтения представление базовых данных таблицы, позволяя просматривать и изменять только презентацию. Несколько пользователей могут одновременно получить доступ к одним и тем же данным с помощью **IMAPITable**. **Обращение** по протоколу IMAPITable реализовано с помощью MAPI и поставщиков услуг. 
    
- [Итабледата: интерфейс IUnknown](itabledataiunknown.md) предоставляет клиентам и поставщикам услуг доступ для чтения и записи к базовым данным таблицы, позволяя им вносить постоянные изменения. Вызов **IMAPITable** РЕАЛИЗОВАН службой MAPI и в основном используется поставщиками услуг, которые обращаются к ней с помощью функции [креатетабле](createtable.md) . Реализация **итабледата** содержит все данные для таблицы и все связанные ограничения в памяти, что делает ее непригодной для использования с очень большими таблицами. Составные ограничения и сложные операции, такие как категоризация, не поддерживаются. 
    
## <a name="see-also"></a>См. также

- [Понятия MAPI](mapi-concepts.md)


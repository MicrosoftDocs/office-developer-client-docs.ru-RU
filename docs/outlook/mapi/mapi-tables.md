---
title: Таблицы MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7974cae1-10f1-42e9-8be4-c02f2bd86714
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 840c34a64cd0478be8f208799653b9916f50079d
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32355840"
---
# <a name="mapi-tables"></a><span data-ttu-id="4ef90-103">Таблицы MAPI</span><span class="sxs-lookup"><span data-stu-id="4ef90-103">MAPI tables</span></span>
  
<span data-ttu-id="4ef90-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="4ef90-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="4ef90-105">Таблица MAPI — это объект MAPI, используемый для просмотра коллекции свойств, принадлежащих другим объектам MAPI определенного типа.</span><span class="sxs-lookup"><span data-stu-id="4ef90-105">A MAPI table is a MAPI object that is used to view a collection of properties belonging to other MAPI objects of a particular type.</span></span> <span data-ttu-id="4ef90-106">Таблицы MAPI структурированы в виде строк и столбцов с каждой строкой, представляющей объект, и каждым столбцом, представляющим свойство объекта.</span><span class="sxs-lookup"><span data-stu-id="4ef90-106">MAPI tables are structured in a row and column format with each row representing an object and each column representing a property of the object.</span></span> <span data-ttu-id="4ef90-107">Одним из свойств, которые обычно включаются в каждую строку, является свойство **пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)), которое можно использовать для открытия и изменения объекта.</span><span class="sxs-lookup"><span data-stu-id="4ef90-107">One of the properties usually included in each row is the **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) property, an identifier that can be used to open and modify the object.</span></span> 
  
<span data-ttu-id="4ef90-108">Так как строки содержат значения свойств, Извлечение строки из таблицы аналогично получению набора свойств непосредственно из объекта, который представляет строка.</span><span class="sxs-lookup"><span data-stu-id="4ef90-108">Because rows contain property values, retrieving a row from a table is similar to getting a set of properties directly from the object that the row represents.</span></span> <span data-ttu-id="4ef90-109">Обе операции приводят к извлечению массива значений свойства.</span><span class="sxs-lookup"><span data-stu-id="4ef90-109">Both operations result in the retrieval of a property value array.</span></span> <span data-ttu-id="4ef90-110">Основное отличие заключается в обработке длинных строковых и двоичных свойств.</span><span class="sxs-lookup"><span data-stu-id="4ef90-110">The main difference is in the handling of long string and binary properties.</span></span> <span data-ttu-id="4ef90-111">Для включения в таблицу некоторые разработчики таблиц усекаются эти свойства до 255 байт.</span><span class="sxs-lookup"><span data-stu-id="4ef90-111">For inclusion in a table, some table implementers truncate these properties to 255 bytes.</span></span> <span data-ttu-id="4ef90-112">При получении непосредственно из объекта полное значение всегда доступно.</span><span class="sxs-lookup"><span data-stu-id="4ef90-112">When retrieved directly from the object, the full value is always available.</span></span>
  
<span data-ttu-id="4ef90-113">Таблицы реализуются адресными книгами и поставщиками хранилищ сообщений и MAPI в зависимости от типа таблицы и содержащихся в ней объектов.</span><span class="sxs-lookup"><span data-stu-id="4ef90-113">Tables are implemented by address book and message store providers and by MAPI, depending on the type of table and the objects within it.</span></span> <span data-ttu-id="4ef90-114">Поставщик хранилища сообщений реализует папки и таблицу содержимого для каждой папки, в которой содержатся сведения о сообщениях в папке.</span><span class="sxs-lookup"><span data-stu-id="4ef90-114">A message store provider implements folders and a contents table for each folder that includes information about the messages in the folder.</span></span> <span data-ttu-id="4ef90-115">Поставщик адресных книг реализует контейнеры адресных книг и таблицу иерархии, в которой отображается их организация.</span><span class="sxs-lookup"><span data-stu-id="4ef90-115">An address book provider implements address book containers and a hierarchy table that shows their organization.</span></span> <span data-ttu-id="4ef90-116">MAPI реализует несколько различных таблиц, некоторые из них для использования клиентскими приложениями, некоторые для использования поставщиками услуг и некоторые из них для их использования.</span><span class="sxs-lookup"><span data-stu-id="4ef90-116">MAPI implements several different tables, some for use by client applications, some for use by service providers, and some for use by both.</span></span> <span data-ttu-id="4ef90-117">Таблица Status является уникальной в том, что в конечном счете она предоставляет таблицу, но строки состоят из вкладов всех типов поставщиков услуг в дополнение к MAPI.</span><span class="sxs-lookup"><span data-stu-id="4ef90-117">The status table is unique in that MAPI ultimately supplies the table, but the rows are comprised of contributions from all types of service providers in addition to MAPI.</span></span> 
  
<span data-ttu-id="4ef90-118">На следующем рисунке показано одно из часто используемых таблиц в MAPI: для отображения содержимого папки.</span><span class="sxs-lookup"><span data-stu-id="4ef90-118">The following illustration shows one of the frequent uses of a table in MAPI: to display the contents of a folder.</span></span> <span data-ttu-id="4ef90-119">Справа отображается два сообщения, которые могут отображаться в типичном клиентском приложении обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="4ef90-119">On the right is a display of two messages as might appear in a typical messaging client application.</span></span> <span data-ttu-id="4ef90-120">Отображение содержит четыре части сведений о каждом сообщении: отправитель, получатель, тема и текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="4ef90-120">The display contains four pieces of information about each message: the sender, the recipient, the subject, and the message text.</span></span> <span data-ttu-id="4ef90-121">Каждая часть данных соответствует свойству сообщения.</span><span class="sxs-lookup"><span data-stu-id="4ef90-121">Each piece of information corresponds to a property of the message.</span></span>
  
<span data-ttu-id="4ef90-122">Слева находится представление таблицы содержимого, включающей эти два сообщения.</span><span class="sxs-lookup"><span data-stu-id="4ef90-122">On the left is a view of the contents table that includes these two messages.</span></span> <span data-ttu-id="4ef90-123">В то время как в таблице содержимого может быть десять строк, так как папка содержит десять сообщений, а каждая строка содержит не более трех столбцов, это представление ограничено только двумя строками и тремя столбцами.</span><span class="sxs-lookup"><span data-stu-id="4ef90-123">Whereas the contents table may have ten rows because the folder has ten messages, with each row containing many more than three columns, this particular view is limited to only two rows and three columns.</span></span>
  
<span data-ttu-id="4ef90-124">В следующей таблице показаны свойства, которые составляют набор столбцов для представления таблицы.</span><span class="sxs-lookup"><span data-stu-id="4ef90-124">The following table shows the properties that make up the column set for the table view.</span></span>
  
|<span data-ttu-id="4ef90-125">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="4ef90-125">**Property**</span></span>|<span data-ttu-id="4ef90-126">**Описание**</span><span class="sxs-lookup"><span data-stu-id="4ef90-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="4ef90-127">**Пр_сендер_наме** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4ef90-127">**PR_SENDER_NAME** ([PidTagSenderName](pidtagsendername-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="4ef90-128">Имя отПравителя</span><span class="sxs-lookup"><span data-stu-id="4ef90-128">Sender name</span></span>  <br/> |
|<span data-ttu-id="4ef90-129">**Пр_оригинал_деливери_тиме** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4ef90-129">**PR_ORIGINAL_DELIVERY_TIME** ([PidTagOriginalDeliveryTime](pidtagoriginaldeliverytime-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="4ef90-130">Дата и время отправки сообщения</span><span class="sxs-lookup"><span data-stu-id="4ef90-130">Date and time when the message was sent</span></span>  <br/> |
|<span data-ttu-id="4ef90-131">**Пр_субжект** ([PidTagSubject](pidtagsubject-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="4ef90-131">**PR_SUBJECT** ([PidTagSubject](pidtagsubject-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="4ef90-132">Строка темы сообщения</span><span class="sxs-lookup"><span data-stu-id="4ef90-132">Message subject line</span></span>  <br/> |
   
<span data-ttu-id="4ef90-133">Обратите внимание, что набор свойств, отображаемых в сообщении, не совпадает с набором столбцов, отображаемых в таблице.</span><span class="sxs-lookup"><span data-stu-id="4ef90-133">Notice that the set of properties displayed in the message are not the same as the set of columns displayed in the table.</span></span> <span data-ttu-id="4ef90-134">Разработчик таблицы (в данном случае — поставщик хранилища сообщений) предоставляет набор столбцов по умолчанию в порядке по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4ef90-134">The implementer of the table, in this case a message store provider, supplies a default set of columns in a default order.</span></span> <span data-ttu-id="4ef90-135">Клиент может изменить этот набор столбцов, запросив дополнительные столбцы или отклонить значения по умолчанию, а также попросить, чтобы они были упорядочены определенным образом.</span><span class="sxs-lookup"><span data-stu-id="4ef90-135">The client can modify this column set, requesting additional columns or rejecting default ones, and ask that they be ordered in a specific way.</span></span> <span data-ttu-id="4ef90-136">Клиент также может упорядочивать строки, сортируя их в соответствии со значением одного или нескольких столбцов.</span><span class="sxs-lookup"><span data-stu-id="4ef90-136">The client can also order the rows, sorting them according to the value of one or more columns.</span></span>
  
<span data-ttu-id="4ef90-137">**Использование таблицы для отображения содержимого папки**</span><span class="sxs-lookup"><span data-stu-id="4ef90-137">**Using a table to display folder contents**</span></span>
  
<span data-ttu-id="4ef90-138">![Использование таблицы для отображения содержимого папки] (media/amapi_54.gif "Использование таблицы для отображения содержимого папки")</span><span class="sxs-lookup"><span data-stu-id="4ef90-138">![Using a table to display folder contents](media/amapi_54.gif "Using a table to display folder contents")</span></span>
  
<span data-ttu-id="4ef90-139">Существует два интерфейса для работы с таблицами:</span><span class="sxs-lookup"><span data-stu-id="4ef90-139">There are two interfaces for working with tables:</span></span>
  
- <span data-ttu-id="4ef90-140">[IMAPITable: интерфейс IUnknown](imapitableiunknown.md) предоставляет клиентам и поставщикам услуг доступное только для чтения представление базовых данных таблицы, позволяя просматривать и изменять только презентацию.</span><span class="sxs-lookup"><span data-stu-id="4ef90-140">[IMAPITable : IUnknown](imapitableiunknown.md) gives clients and service providers a read-only view of the underlying data of the table, allowing them to view and change only the presentation.</span></span> <span data-ttu-id="4ef90-141">Несколько пользователей могут одновременно получить доступ к одним и тем же данным с помощью **IMAPITable**.</span><span class="sxs-lookup"><span data-stu-id="4ef90-141">Multiple users can access the same data concurrently with **IMAPITable**.</span></span> <span data-ttu-id="4ef90-142">**Обращение** по протоколу IMAPITable реализовано с помощью MAPI и поставщиков услуг.</span><span class="sxs-lookup"><span data-stu-id="4ef90-142">**IMAPITable** is implemented by MAPI and by service providers.</span></span> 
    
- <span data-ttu-id="4ef90-143">[Итабледата: интерфейс IUnknown](itabledataiunknown.md) предоставляет клиентам и поставщикам услуг доступ для чтения и записи к базовым данным таблицы, позволяя им вносить постоянные изменения.</span><span class="sxs-lookup"><span data-stu-id="4ef90-143">[ITableData : IUnknown](itabledataiunknown.md) gives clients and service providers read/write access to the underlying data of the table, allowing them to make permanent changes.</span></span> <span data-ttu-id="4ef90-144">Вызов **IMAPITable** РЕАЛИЗОВАН службой MAPI и в основном используется поставщиками услуг, которые обращаются к ней с помощью функции [креатетабле](createtable.md) .</span><span class="sxs-lookup"><span data-stu-id="4ef90-144">**IMAPITable** is implemented by MAPI and used primarily by service providers who access it by calling the [CreateTable](createtable.md) function.</span></span> <span data-ttu-id="4ef90-145">Реализация **итабледата** содержит все данные для таблицы и все связанные ограничения в памяти, что делает ее непригодной для использования с очень большими таблицами.</span><span class="sxs-lookup"><span data-stu-id="4ef90-145">The **ITableData** implementation holds all the data for the table and any associated restrictions in memory, making it unsuitable for use with very large tables.</span></span> <span data-ttu-id="4ef90-146">Составные ограничения и сложные операции, такие как категоризация, не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="4ef90-146">Compound restrictions and complex operations such as categorization are unsupported.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="4ef90-147">См. также</span><span class="sxs-lookup"><span data-stu-id="4ef90-147">See also</span></span>

- [<span data-ttu-id="4ef90-148">Понятия MAPI</span><span class="sxs-lookup"><span data-stu-id="4ef90-148">MAPI Concepts</span></span>](mapi-concepts.md)


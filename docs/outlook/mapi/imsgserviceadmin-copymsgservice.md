---
title: Имсгсервицеадминкопимсгсервице
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMsgServiceAdmin.CopyMsgService
api_type:
- COM
ms.assetid: a13c6757-358f-421a-9a76-de7483501613
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 72b4ab1fec10b2e91c7609af6644a54d29ed5e02
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32309970"
---
# <a name="imsgserviceadmincopymsgservice"></a>IMsgServiceAdmin::CopyMsgService

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Копирует службу сообщений в профиль. 
  
```cpp
HRESULT CopyMsgService(
  LPMAPIUID lpUID,
  LPSTR lpszDisplayName,
  LPCIID lpInterfaceToCopy,
  LPCIID lpInterfaceDst,
  LPVOID lpObjectDst,
  ULONG_PTR ulUIParam,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпуид_
  
> возврата Указатель на структуру [мапиуид](mapiuid.md) , которая содержит уникальный идентификатор службы сообщений для копирования. 
    
 _Лпсздисплайнаме_
  
> возврата Этот параметр устарел. 
    
 _Лпинтерфацетокопи_
  
> возврата Указатель на идентификатор интерфейса (IID), представляющий интерфейс, который будет использоваться для доступа к разделу профиля службы сообщений, который необходимо скопировать. При передаче значений NULL в стандартный раздел профиля используется интерфейс [ипрофсект](iprofsectimapiprop.md).
    
 _Лпинтерфацедст_
  
> возврата Указатель на идентификатор IID, представляющий интерфейс, который будет использоваться для доступа к объекту, на который указывает параметр _лпобжектдст_ . Передача результатов NULL в интерфейс сеанса [IMAPISession](imapisessioniunknown.md)используется. Для параметра _лпинтерфацедст_ также можно задать значение иид_имсгсервицеадмин. 
    
 _Лпобжектдст_
  
> возврата Указатель на указатель на объект администрирования службы сеансов или службы сообщений. Тип объекта должен соответствовать идентификатору интерфейса, переданному в _лпинтерфацедст_. Допустимыми указателями объектов являются ЛПМАПИСЕССИОН и ЛПСЕРВИЦЕАДМИН.
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна любых диалоговых окон или окон, которые отображает этот метод.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих способ копирования службы сообщений. Можно задать следующие флаги:
    
СЕРВИЦЕ_УИ_АЛВАЙС 
  
> Запросы, которые служба сообщений всегда отображает страницу свойств конфигурации.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Служба сообщений успешно скопирована.
    
МАПИ_Е_НО_АКЦЕСС 
  
> Служба сообщений уже включена в профиль и не поддерживает несколько экземпляров.
    
МАПИ_Е_НОТ_ФАУНД 
  
> **Мапиуид** , на который указывает _лпуид_ , не ссылается на существующую службу сообщений. 
    
## <a name="remarks"></a>Замечания

Метод **имсгсервицеадмин:: копимсгсервице** копирует службу сообщений в профиль, активный профиль или другой профиль. Профиль, содержащий службу сообщений, которую необходимо скопировать, и конечное расположение не обязательно должно быть одним и тем же профилем, но это может быть. 
  
Функция точки входа службы сообщений не вызывается для операции копирования. Скопированная служба сообщений имеет те же параметры конфигурации, что и ее оригинал. Чтобы изменить эти параметры, клиент должен вызвать метод [имсгсервицеадмин:: конфигуремсгсервице](imsgserviceadmin-configuremsgservice.md) . 
  
## <a name="see-also"></a>См. также



[IMsgServiceAdmin::ConfigureMsgService](imsgserviceadmin-configuremsgservice.md)
  
[MAPIUID](mapiuid.md)
  
[IMsgServiceAdmin : IUnknown](imsgserviceadminiunknown.md)


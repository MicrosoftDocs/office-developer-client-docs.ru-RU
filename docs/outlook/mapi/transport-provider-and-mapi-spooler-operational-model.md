---
title: Модель поставщика транспорта и очереди печати MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0f8d8f0-fed7-4a7c-bc40-e935f159591d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5987111844f087801c63989b905992900ff6909c
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426627"
---
# <a name="transport-provider-and-mapi-spooler-operational-model"></a>Модель поставщика транспорта и очереди печати MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Инициализация, запуск, обработка, завершение работы и деинициализация поставщика транспорта выполняются с помощью ряда вызовов от диспетчера очереди MAPI к поставщику транспорта. Звонки упорядочены следующим образом:
  
1. Диспетчер очереди MAPI вызывает функцию [ксппровидеринит](xpproviderinit.md) , передает объект поддержки, получает объект поставщика и проверяет, поддерживает ли поставщик транспорта и Диспетчер очереди MAPI совместимый диапазон номеров версий MAPI. 
    
2. Диспетчер очереди MAPI вызывает метод [иксппровидер:: транспортлогон](ixpprovider-transportlogon.md) интерфейса [иксппровидер: IUnknown](ixpprovideriunknown.md) . Между диспетчером очереди MAPI и поставщиком транспорта устанавливается сеанс с учетными данными из текущего раздела профиля. Поставщик транспорта возвращает объект logon. 
    
3. Диспетчер очереди MAPI вызывает метод [иксплогон:: аддресстипес](ixplogon-addresstypes.md) . Поставщик транспорта возвращает список уникальных идентификаторов (UID) и типов электронных адресов, которые он будет принимать. 
    
4. Поставщик транспорта вызывает метод [имаписуппорт:: модифистатусров](imapisupport-modifystatusrow.md) для создания строки в таблице состояния MAPI. 
    
5. Диспетчер очереди MAPI вызывает метод [иксплогон:: транспортнотифи](ixplogon-transportnotify.md) для включения передачи и приема сообщений. 
    
6. Если поставщик транспорта запрашивается в результате возврата для вызова **транспортлогон** , то диспетчер очереди MAPI периодически вызывает метод [Иксплогон:: Idle](ixplogon-idle.md) . Обработка в режиме простоя полезна, если поставщик транспорта должен опросить базовую систему обмена сообщениями для новых сообщений или выполнить другие задачи с низким приоритетом. 
    
7. Диспетчер очереди MAPI и поставщик транспорта отправляют и получают сообщения. Для получения дополнительных сведений см [модель отправки сообщений](message-submission-model.md) и [модель приема сообщений](message-reception-model.md). Службы диспетчера очереди MAPI относят запросы и вызовы для объектов support, Message и вложения.
    
8. Диспетчер очереди MAPI вызывает метод **транспортнотифи** , чтобы отключить передачу и прием сообщений. 
    
9. Диспетчер очереди MAPI освобождает объекты входа и поставщика. Дополнительные сведения см. в методе [иксппровидер:: Shutdown](ixpprovider-shutdown.md) . 
    


---
title: Поставщик транспорта и операционная модель системы буферизации MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: b0f8d8f0-fed7-4a7c-bc40-e935f159591d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 0e6c38091e5b2e10e82012bc470ea41037f57c7d
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812515"
---
# <a name="transport-provider-and-mapi-spooler-operational-model"></a>Поставщик транспорта и операционная модель системы буферизации MAPI

  
  
**Относится к**: Outlook 
  
Инициализация поставщика транспорта, загрузки, обработки, завершение работы и deinitialization выполняются посредством ряда вызовов из очереди MAPI поставщика транспорта. Вызовы упорядочены следующим образом:
  
1. Диспетчер очереди MAPI вызывает функцию [XPProviderInit](xpproviderinit.md) , передает объект поддержки, возвращает объект поставщика и проверяет, что поставщик транспорта и диспетчер очереди MAPI поддерживают номера версий совместимые диапазон MAPI. 
    
2. Диспетчер очереди MAPI вызывает метод [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) [IXPProvider: IUnknown](ixpprovideriunknown.md) интерфейса. Установить сеанс связи между диспетчер очереди MAPI и поставщика транспорта с использованием учетных данных в разделе текущего профиля. Поставщика транспорта возвращает объект входа в систему. 
    
3. Диспетчер очереди MAPI вызывает метод [IXPLogon::AddressTypes](ixplogon-addresstypes.md) . Поставщика транспорта возвращает список уникальных идентификаторов (UID) и типов адресов электронной почты, который будет принимать. 
    
4. Поставщика транспорта вызывает метод [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) , чтобы создать его строку в таблице состояния MAPI. 
    
5. Диспетчер очереди MAPI вызывает метод [IXPLogon::TransportNotify](ixplogon-transportnotify.md) для включения передачи сообщений и прием. 
    
6. По запросу поставщика транспорта возврата для вызова **TransportLogon** , диспетчер очереди MAPI периодически вызывает метод [IXPLogon::Idle](ixplogon-idle.md) . Обработки бездействия полезна, если требуется, чтобы опроса системы обмена сообщениями для новых сообщений или выполнять другие задачи низким приоритетом поставщик транспорта. 
    
7. Диспетчер очереди MAPI и поставщика транспорта отправлять и получать сообщения. Для получения дополнительных сведений см [Модель отправки сообщений](message-submission-model.md) и [Модели приема сообщений](message-reception-model.md). Диспетчер очереди MAPI включают следующие транспорта и вызывает на объекты поддержки, сообщения и вложения.
    
8. Диспетчер очереди MAPI вызывает метод **TransportNotify** для отключения передачи сообщений и приема. 
    
9. Диспетчер очереди MAPI высвобождение объектов входа в систему и поставщика. Для получения дополнительных сведений см [IXPProvider::Shutdown](ixpprovider-shutdown.md) . 
    


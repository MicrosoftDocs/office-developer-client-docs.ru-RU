---
title: итнеффинишкомпонент
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ITnef.FinishComponent
api_type:
- COM
ms.assetid: bcdd0688-0897-47d7-9601-f592ba453b39
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: c8dc10bdb8bcde15dccf7bab4d9e10d2481cef11
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416442"
---
# <a name="itneffinishcomponent"></a>ITnef::FinishComponent

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Обрабатывает отдельные компоненты из сообщения по одному на один раз в поток формата TNEF.
  
```cpp
HRESULT FinishComponent(
  ULONG ulFlags,
  ULONG ulComponentID,
  LPSPropTagArray lpCustomPropList,
  LPSPropValue lpCustomProps,
  LPSPropTagArray lpPropList,
  LPSTnefProblemArray FAR * lppProblems
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> возврата Битовая маска флагов, определяющих, какой компонент будет завершен. Необходимо задать один или несколько из следующих флагов:
    
TNEF_COMPONENT_ATTACHMENT 
  
> Обработка будет завершена для объекта вложения; параметр _улкомпонентид_ содержит свойство **PR_ATTACH_NUM** ([PidTagAttachNumber](pidtagattachnumber-canonical-property.md)) вложения. 
    
TNEF_COMPONENT_MESSAGE 
  
> Обработка будет завершена для объекта Message. 
    
 _улкомпонентид_
  
> [in] 0 для обозначения обработки сообщения или свойства **PR_ATTACH_NUM** вложения, которое требуется обработать. Если в параметре _ulFlags_ задан флаг TNEF_COMPONENT_MESSAGE, _улкомпонентид_ должен быть равен 0. 
    
 _лпкустомпроплист_
  
> возврата Указатель на структуру [спроптагаррай](sproptagarray.md) , содержащую теги свойств, которые определяют свойства, переданные в параметре _лпкустомпропс_ . Между значением свойства в _лпкустомпропс_ и тегом свойства в параметре _лпкустомпроплист_ должно быть отношение "один к одному". 
    
 _лпкустомпропс_
  
> возврата Указатель на структуру [спропвалуе](spropvalue.md) , которая содержит значения свойств для кодирования. 
    
 _лппроплист_
  
> возврата Указатель на структуру **спроптагаррай** , содержащую теги свойств для кодирования свойств. 
    
 _лпппроблемс_
  
> вышли Указатель на указатель на возвращаемую структуру [стнефпроблемаррай](stnefproblemarray.md) . Структура **стнефпроблемаррай** указывает, какие свойства не кодируются должным образом. Если параметр _лпппроблемс_ передается значение null, массив проблем свойств не возвращается. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������.
    
## <a name="remarks"></a>Примечания

Поставщики транспорта, поставщики хранилищ сообщений и шлюзы вызывают метод **итнеф:: финишкомпонент** для выполнения обработки TNEF для одного компонента, сообщения или вложения, как показано в параметре _ulFlags_ . 
  
Чтобы включить обработку компонентов, поставщик вызова или шлюз передают TNEF_COMPONENT_ENCODINGный флаг в _ulFlags_ для функции [опентнефстреам](opentnefstream.md) или [опентнефстреамекс](opentnefstreamex.md) , открывающей объект для получения кодировки. 
  
Передача значений в параметрах _лпкустомпроплист_ и _лпкустомпропс_ выполняет эквивалент кодирования компонентов, выполняемый методом [итнеф:: SetProps](itnef-setprops.md) . Передача значения в параметре _лппроплист_ выполняет эквивалентную кодировку компонентов, выполняемую методом [Итнеф:: аддпропс](itnef-addprops.md) с флагом TNEF_PROP_INCLUDE, установленным в _ulFlags_. Передача этих значений позволяет выполнять кодирование с помощью одного вызова, а не нескольких вызовов.
  
Реализация TNEF сообщает о неполадках кодирования потока TNEF без остановки процесса **финишкомпонент** . Структура **стнефпроблемаррай** , возвращаемая в _лпппроблемс_ , указывает, какие АТРИБУТЫ TNEF или свойства MAPI, если они есть, не могут быть обработаны. Значение, возвращаемое элементом **SCODE** одной из структур **стнефпроблем** , включенных в **стнефпроблемаррай** , указывает на конкретную проблему. Поставщик или шлюз могут работать в предположении, что все свойства или атрибуты, для которых **финишкомпонент** не возвращает отчет о проблеме, были успешно обработаны. 
  
Если поставщик или шлюз не работают с неисправной массивом, он может передавать значение NULL в _лпппроблемс_; в этом случае массив проблем не возвращается.
  
Значение, возвращаемое в _лпппроблемс_ , является допустимым только в том случае, если вызов возвращает S_OK. Когда возвращается S_OK, поставщик или шлюз должны проверить значения, возвращаемые в структуре [стнефпроблемаррай](stnefproblemarray.md) . Если при вызове возникает ошибка, структура **стнефпроблемаррай** не заполняется, а поставщик или шлюз вызова не должен использовать или освобождать структуру. Если при вызове не возникнет ошибок, поставщик или шлюз вызовов должен освободить память для **стнефпроблемаррай** , вызвав функцию [мапифрибуффер](mapifreebuffer.md) . 
  
## <a name="see-also"></a>См. также



[ITnef::AddProps](itnef-addprops.md)
  
[ITnef::SetProps](itnef-setprops.md)
  
[MAPIFreeBuffer](mapifreebuffer.md)
  
[OpenTnefStream](opentnefstream.md)
  
[OpenTnefStreamEx](opentnefstreamex.md)
  
[SPropTagArray](sproptagarray.md)
  
[STnefProblemArray](stnefproblemarray.md)
  
[ITnef : IUnknown](itnefiunknown.md)


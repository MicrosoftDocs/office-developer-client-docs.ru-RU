---
title: Разрешения для объектов и свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32669cbe-5460-4043-99cc-c609608f48da
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 4efa9cd1596cffe19a19a62059f81fa553343d77
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436176"
---
# <a name="permissions-for-mapi-objects-and-properties"></a>Разрешения для объектов и свойств MAPI

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Разрешение на доступ или набор разрешенных операций могут быть характеристикой объектов MAPI и отдельных свойств, поддерживаемых этими объектами. Доступ к объекту определяется родительским объектом. Для сообщения его папка определяет разрешения на доступ. Для пользователя обмена сообщениями или списка рассылки это определение принимает контейнер адресной книги. Если объект, например сообщение, находится в двух папках, разрешения для двух копий объекта могут быть разными. 
  
Клиенты, использующие эти объекты, могут запрашивать наивысший уровень доступа, разрешенный для объекта, установив флаг MAPI_BEST_ACCESS в вызове [IMAPISession::OpenEntry.](imapisession-openentry.md) В зависимости от поставщика услуг, реализующих объект, клиенту может быть предоставлен необходимый уровень доступа. Клиенты могут определить уровень доступа, предоставленный им, путем вызова метода **GetProps** объекта для получения свойства **PR_ACCESS** ([PidTagAccess).](pidtagaccess-canonical-property.md) Однако, так как поставщик услуг должен динамически генерировать значение для этого свойства, рекомендуется, чтобы клиенты извлекали его только при необходимости. 
  
Чтобы определить, допускает ли контейнер, например папку, контейнер адресной книги или список рассылки, возможность изменения, вызовите метод **GetProps** для получения свойства **PR_ACCESS_LEVEL** ([PidTagAccessLevel).](pidtagaccesslevel-canonical-property.md) Доступ на уровне контейнера влияет на клиенты с точки зрения их отображения пользовательских интерфейсов. Это также влияет на реализации объектов в контейнерах с точки зрения отображения их пользовательского интерфейса и их общей реализации. 
  
Доступ к определенному свойству определяется схемой свойства, настроенной MAPI для объекта, который владеет свойством. Схемы свойств указывают набор необходимых и необязательных свойств для объекта и их разрешение на доступ. В отличие от доступа к объекту, который определяется родительским объектом, доступ к свойству является глобальным. Каждый объект, независимо от требований к доступу родительского объекта, имеет те же разрешения для свойства, что и схема.
  
Если свойство доступно только для чтения, оно всегда будет доступно с помощью **вызова GetProps** или **OpenProperty.** Однако в зависимости от реализации объекта, поддерживающих свойство, существует два возможных результата для метода **SetProps** для изменения свойства и метода **DeleteProps** для его удаления: 
  
- Сбой и возврат MAPI_E_NO_ACCESS
    
- Успешно, без каких-либо действий
    
Доступ к свойствам и объектам также можно получить или настроить с помощью интерфейса [IPropData,](ipropdataimapiprop.md) который наследуется от **интерфейса IMAPIProp.** MAPI предоставляет реализацию **IPropData,** основанную на данных в памяти. Поставщики служб могут использовать **IPropData** для реализации **IMAPIProp** в определенных обстоятельствах, например для их объекта состояния или если они используют базу данных без встроенных транзакций. **IPropData** работает исключительно в памяти, что делает ненужным блокировку и разблокировку данных. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


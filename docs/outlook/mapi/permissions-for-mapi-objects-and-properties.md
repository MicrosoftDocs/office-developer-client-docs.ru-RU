---
title: Разрешения для объектов и свойств MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32669cbe-5460-4043-99cc-c609608f48da
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 4efa9cd1596cffe19a19a62059f81fa553343d77
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436176"
---
# <a name="permissions-for-mapi-objects-and-properties"></a>Разрешения для объектов и свойств MAPI

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Разрешение доступа или набор допустимых операций могут быть характерными для объектов MAPI и отдельных свойств, поддерживаемых этими объектами. Доступ к объекту определяется родителем объекта. Для сообщения папка определяет разрешения доступа. Для пользователя или списка рассылки сообщений это определение принимает контейнер адресной книги. Если объект, например сообщение, находится в двух папках, разрешения для двух копий объекта могут быть разными. 
  
Клиенты, использующие эти объекты, могут запрашивать самый высокий уровень доступа, разрешенный для объекта, установив флаг MAPI_BEST_ACCESS на [вызовЕ IMAPISession::OpenEntry.](imapisession-openentry.md) В зависимости от поставщика услуг, реализующих объект, клиенту может быть предоставлен необходимый уровень доступа. Клиенты могут определить уровень доступа, который им был предоставлен, позвонив методу **объекта GetProps** **для** получения свойства [PR_ACCESS (PidTagAccess).](pidtagaccess-canonical-property.md) Однако, поскольку поставщик услуг должен динамически создавать значение для этого свойства, рекомендуется, чтобы клиенты извлекали его только при необходимости. 
  
Чтобы определить, допускается ли изменение контейнера, например папки, контейнера адресной книги или  списка рассылки, позвоните в метод **GetProps** для получения свойства [PR_ACCESS_LEVEL (PidTagAccessLevel).](pidtagaccesslevel-canonical-property.md) Доступ к уровню контейнера влияет на клиентов с точки зрения отображения их пользовательских интерфейсов. Это также влияет на реализации объектов в контейнерах с точки зрения отображения пользовательского интерфейса и их общей реализации. 
  
Доступ к определенному свойству определяется схемой свойства, настроенной MAPI для объекта, который владеет этим свойством. Схемы свойств указывают набор необходимых и необязательных свойств объекта и разрешение на доступ. В отличие от доступа к объекту, который определяется родителем объекта, доступ к свойству является глобальным. Каждый объект, независимо от требований к доступу родительского объекта, имеет те же разрешения для свойства, что и схема.
  
Когда свойство доступно только для чтения, оно всегда будет доступно с **помощью вызова GetProps** или **OpenProperty.** Однако в зависимости от реализации объекта, поддерживающей свойство, для метода **SetProps** для изменения свойства и метода **DeleteProps** для его удаления возможны два возможных результата: 
  
- Сбой и возвращение MAPI_E_NO_ACCESS
    
- Успех без каких-либо действий
    
Свойство и доступ к объекту также можно получить или установить с помощью интерфейса [IPropData,](ipropdataimapiprop.md) который наследуется от **интерфейса IMAPIProp.** MAPI обеспечивает реализацию **IPropData,** основанной на данных в памяти. Поставщики услуг могут использовать **IPropData** для реализации **IMAPIProp в** определенных обстоятельствах, например для объекта состояния или если они используют базу данных, в которой нет встроенных транзакций. **IPropData** работает исключительно в памяти, что делает ненужным блокировку и разблокирование данных. 
  
## <a name="see-also"></a>См. также



[Обзор свойств MAPI](mapi-property-overview.md)


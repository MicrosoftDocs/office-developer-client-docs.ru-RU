---
title: Ипрофадминкреатепрофиле
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IProfAdmin.CreateProfile
api_type:
- COM
ms.assetid: 10cda14a-8f93-41e0-b1fb-500098bdc392
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b104c62eb617e6c68f85dea4ef6379c831733844
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404402"
---
# <a name="iprofadmincreateprofile"></a>IProfAdmin::CreateProfile

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Создает новый профиль.
  
```cpp
HRESULT CreateProfile(
  LPSTR lpszProfileName,
  LPSTR lpszPassword,
  ULONG_PTR ulUIParam,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпсзпрофиленаме_
  
> возврата Указатель на имя нового профиля.
    
 _Лпсзпассворд_
  
> возврата Указатель на пароль нового профиля. 
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна всех диалоговых окон и окон, отображаемых данным методом.
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющая способ создания профиля. Можно задать следующие флаги:
    
МАПИ_ДЕФАУЛТ_СЕРВИЦЕС 
  
> MAPI должен заполнить новый профиль службами сообщений, которые включены в раздел [службы по умолчанию] файла Mapisvc. INF.
    
МАПИ_ДИАЛОГ 
  
> Могут отображаться страницы свойств конфигурации каждого поставщика в службах сообщений, которые необходимо добавить. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Создан новый профиль.
    
МАПИ_Е_НО_АКЦЕСС 
  
> Указанный новый профиль уже существует.
    
## <a name="remarks"></a>Примечания

Метод **ипрофадмин:: креатепрофиле** создает новый профиль. 
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вы можете вызывать **креатепрофиле** во время установки приложения или в любое время в течение сеанса. При вызове этого метода во время установки многие параметры конфигурации берутся из файла конфигурации Mapisvc. INF. При вызове этого метода во время активного сеанса параметры берутся из пользователя, который получает приглашение через ряд страниц свойств. 
  
Если в параметре _ulFlags_ ЗАДАН флаг Мапи_дефаулт_сервицес, **креатепрофиле** вызывает функцию точки входа службы сообщений для каждой службы сообщений в разделе [службы по умолчанию] файла Mapisvc. INF. Каждая функция точки входа службы сообщений вызывается с параметром _улконтекст_ , равным мсг_сервице_креате. 
  
Если установлены флаги МАПИ_ДИАЛОГ и МАПИ_ДЕФАУЛТ_СЕРВИЦЕС, значения в параметрах _улуипарам_ и _ulFlags_ также передаются в функцию точки входа службы сообщений. Функции точки входа службы сообщений вызываются только после добавления в профиль всех доступных сведений из файла Mapisvc. INF. 
  
Имя нового профиля и его пароль могут иметь длину до 64 символов и могут включать следующие символы:
  
- Все буквенно-цифровые символы, включая диакритические знаки и символ подчеркивания.
    
- Внутренние пробелы, но не ведущие и замыкающие пробелы.
    
Параметр _лпсзпассворд_ должен иметь значение null или указатель на строку нулевой длины. 
  
## <a name="see-also"></a>См. также



[IMsgServiceAdmin::ConfigureMsgService](imsgserviceadmin-configuremsgservice.md)
  
[IMsgServiceAdmin::CreateMsgService](imsgserviceadmin-createmsgservice.md)
  
[MSGSERVICEENTRY](msgserviceentry.md)
  
[IProfAdmin : IUnknown](iprofadminiunknown.md)


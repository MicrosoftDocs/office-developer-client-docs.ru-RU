---
title: Реализация одноразовой таблицы поставщика
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8b0dcbfe-6bed-4fb8-a906-009f1d009055
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 023686702b76b5b29acf4304fcfdb3377e8cfcff
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32332867"
---
# <a name="implementing-a-provider-one-off-table"></a>Реализация одноразовой таблицы поставщика

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
MAPI вызывает метод [иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) поставщика, когда пользователь клиентского приложения добавляет получателя в исходящее сообщение. Как правило, запрошенные типы адресов уникальны для системы обмена сообщениями. Если поставщик поддерживает создание получателей, он должен предоставить одноразовую таблицу, предоставляющую шаблоны для каждого типа поддерживаемого адреса получателя. Если поставщик не поддерживает создание получателей, возвращайте МАПИ_Е_НО_СУППОРТ из вызова **жетонеоффтабле** . 
  
Как правило, Служба MAPI будет хранить одноразовую таблицу поставщика в течение всего времени существования сеанса, освобождая ее, только когда клиент вызывает метод [имапистатус:: валидатестате](imapistatus-validatestate.md) подсистемы или адресной книги. Регистры MAPI для уведомлений в этой таблице, чтобы при добавлении или удалении шаблонов эти изменения могли быть отражены для пользователя. 
  
 **Реализация Иаблогон:: Жетонеоффтабле**
  
1. Проверьте значение параметра flags, _ulFlags_. Если установлен флаг МАПИ_УНИКОДЕ, а поставщик не поддерживает Юникод, ошибки и возвращать МАПИ_Е_БАД_ЧАРВИДС. 
    
2. Проверьте, была ли уже создана одноразовая таблица поставщика. Так как одноразовые таблицы обычно статичны, поставщику никогда не придется выполнять процесс создания несколько раз. Если таблица уже существует, возвращается указатель на нее. 
    
3. Если одна из таблиц еще не существует, вызовите **креатетабле** , чтобы создать ее. 
    
4. Задайте следующие свойства для столбцов в строках таблицы:
    
  - **Пр_дисплай_наме** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) имя типа получателя, который может создать шаблон. 
    
  - **Пр_ентрид** ([PidTagEntryId](pidtagentryid-canonical-property.md)) на идентификатор записи для одноразового шаблона.
    
  - **Пр_депс** ([PidTagDepth](pidtagdepth-canonical-property.md)), чтобы обозначить уровень иерархии в отображении односторонней таблицы.
    
  - **Пр_селектабле** ([PidTagSelectable](pidtagselectable-canonical-property.md)) в значение true, чтобы указать, представляет ли строка шаблон, и false в противном случае.
    
  - **Пр_аддртипе** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) на тип адреса, созданного шаблоном.
    
  - **Пр_дисплай_типе** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) в дт_маилусер или другое значение, указывающее тип отображения для шаблона.
    
  - **Пр_инстанце_кэй** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md)) на уникальное двоичное значение. 
    
5. Call [итабледата:: хрмодифиров](itabledata-hrmodifyrow.md) для непосредственного изменения таблицы. 
    
6. Call [итабледата:: хржетвиев](itabledata-hrgetview.md) , чтобы создать реализацию интерфейса **IMAPITable** , чтобы вернуться к вызывающему абоненту. 
    


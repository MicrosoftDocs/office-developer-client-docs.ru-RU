---
title: Реализация одноразовой таблицы поставщика
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8b0dcbfe-6bed-4fb8-a906-009f1d009055
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 023686702b76b5b29acf4304fcfdb3377e8cfcff
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436295"
---
# <a name="implementing-a-provider-one-off-table"></a>Реализация одноразовой таблицы поставщика

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
MAPI вызывает метод [иаблогон:: жетонеоффтабле](iablogon-getoneofftable.md) поставщика, когда пользователь клиентского приложения добавляет получателя в исходящее сообщение. Как правило, запрошенные типы адресов уникальны для системы обмена сообщениями. Если поставщик поддерживает создание получателей, он должен предоставить одноразовую таблицу, предоставляющую шаблоны для каждого типа поддерживаемого адреса получателя. Если поставщик не поддерживает создание получателей, возвращайте MAPI_E_NO_SUPPORT из вызова **жетонеоффтабле** . 
  
Как правило, Служба MAPI будет хранить одноразовую таблицу поставщика в течение всего времени существования сеанса, освобождая ее, только когда клиент вызывает метод [имапистатус:: валидатестате](imapistatus-validatestate.md) подсистемы или адресной книги. Регистры MAPI для уведомлений в этой таблице, чтобы при добавлении или удалении шаблонов эти изменения могли быть отражены для пользователя. 
  
 **Реализация Иаблогон:: Жетонеоффтабле**
  
1. Проверьте значение параметра flags, _ulFlags_. Если установлен флаг MAPI_UNICODE и поставщик не поддерживает Юникод, ошибка и возврат MAPI_E_BAD_CHARWIDTH. 
    
2. Проверьте, была ли уже создана одноразовая таблица поставщика. Так как одноразовые таблицы обычно статичны, поставщику никогда не придется выполнять процесс создания несколько раз. Если таблица уже существует, возвращается указатель на нее. 
    
3. Если одна из таблиц еще не существует, вызовите **креатетабле** , чтобы создать ее. 
    
4. Задайте следующие свойства для столбцов в строках таблицы:
    
  - **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) имя типа получателя, который может создать шаблон. 
    
  - **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) в качестве идентификатора записи для одноразового шаблона.
    
  - **PR_DEPTH** ([PidTagDepth](pidtagdepth-canonical-property.md)), чтобы обозначить уровень иерархии в отображении односторонней таблицы.
    
  - **PR_SELECTABLE** ([PidTagSelectable](pidtagselectable-canonical-property.md)) в значение true, чтобы указать, представляет ли строка шаблон, и false в противном случае.
    
  - **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md)) в тип адреса, созданного шаблоном.
    
  - **PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) в DT_MAILUSER или другое значение, указывающее тип отображения для шаблона.
    
  - **PR_INSTANCE_KEY** ([PidTagInstanceKey](pidtaginstancekey-canonical-property.md)) в уникальное двоичное значение. 
    
5. Call [итабледата:: хрмодифиров](itabledata-hrmodifyrow.md) для непосредственного изменения таблицы. 
    
6. Call [итабледата:: хржетвиев](itabledata-hrgetview.md) , чтобы создать реализацию интерфейса **IMAPITable** , чтобы вернуться к вызывающему абоненту. 
    


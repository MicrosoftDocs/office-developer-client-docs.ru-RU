---
title: Регистрация для получения уведомления
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ccc2758b59a9227afbc50360102e793892bbdc52
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424905"
---
# <a name="registering-for-a-notification"></a>Регистрация для получения уведомления

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Клиент может регистрировать уведомления о адресной книге или хранилище сообщений в рамках процесса инициализации.
  
MAPI поддерживает уведомления в адресной книге независимо от того, поддерживает ли она какие бы какие бы то ни были поставщики адресных книг. Поддержка уведомлений о хранилищах сообщений зависит от конкретного поставщика хранилища сообщений. Чтобы определить, поддерживает ли конкретный поставщик хранилища сообщений уведомления, проверьте его свойство **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)). Если хранилище сообщений поддерживает уведомления, будет установлен бит STORE_NOTIFY_OK. 
  
Зарегистрируйте уведомления, вызвав метод **advise** исходного объекта Advise. Многие объекты реализуют предложение и **Клиенты, которые** могут регистрировать эти объекты различными способами. 
  
 **Регистрация для получения уведомления**
  
1. Создайте объект приемника уведомлений MAPI и увеличьте значение счетчика ссылок.
    
2. При необходимости вызовите [хрсиссреададвисесинк](hrthisthreadadvisesink.md) для создания объекта приемника уведомлений, который создает оболочку исходного приемника уведомлений, а затем Освободите исходный приемник уведомлений.. 
    
3. Вызовите один из следующих методов **advise** для завершения регистрации: 
    
  - Call [IMAPISession:: Advise](imapisession-advise.md) для регистрации уведомлений о сеансе или для уведомлений в адресной книге или объекте хранилища сообщений. 
    
  - Call [IAddrBook:: Advise](iaddrbook-advise.md) для регистрации в уведомлениях адресной книги или уведомления о пользователе, контейнере или списке рассылки для обмена сообщениями. 
    
  - Call [иаблогон:: Advise](iablogon-advise.md) для регистрации непосредственно с помощью поставщика адресных книг для уведомлений о пользователях, контейнерах и списках рассылки для обмена сообщениями. 
    
  - Call [IMsgStore:: Advise](imsgstore-advise.md) для регистрации уведомлений о хранилище сообщений или уведомления для папки или сообщения. 
    
  - Call [имслогон:: Advise](imslogon-advise.md) для регистрации непосредственно с помощью поставщика хранилища сообщений для уведомлений в папке или сообщении. 
    
  - Call [IMAPITable:: Advise](imapitable-advise.md) для регистрации в табличных уведомлениях. 
    
4. Кэшировать номер подключения, возвращенный из **advise**.
    
5. Если вы используете упакованный приемник уведомлений, освободите его. После регистрации приемника уведомлений с оболочкой больше не требуется.
    
Вызов * * IMAPISession:: Advise * * позволяет регистрировать уведомления о критических ошибках в общем сеансе или для различных уведомлений по отдельным объектам. Сеансы отправляют критические уведомления об ошибках клиентам, вошедшим в общие сеансы, когда другой клиент, использующий общий сеанс, вызывает метод [IMAPISession:: logoff](imapisession-logoff.md) . Чтобы зарегистрировать уведомления сеанса, перед параметром идентификатора записи необходимо передать значение NULL. Чтобы зарегистрировать уведомления для отдельного объекта, передайте идентификатор записи объекта. Метод **IMAPISession** перенаправляет вызов соответствующему поставщику услуг, как определено частью **мапиуид** идентификатора записи. Вызов **IMAPISession:: Advise** для регистрации уведомлений об объектах проще, чем вызов метода **advise** поставщика услуг. 
  
Регистрация в адресной книге аналогична регистрации в сеансе. Чтобы зарегистрировать Критическое уведомление об ошибке из адресной книги, передайте значение NULL для идентификатора записи. Чтобы зарегистрировать уведомления для определенного объекта адресной книги, укажите соответствующий идентификатор записи, события или события, представляющие интерес. Имейте в виду, что многие поставщики адресных книг не поддерживают уведомления для отдельных объектов. Вместо этого они поддерживают табличные уведомления о содержимом и таблицах иерархии. 
  
Рекомендуется отпустить приемник уведомлений, который вы реализуете или создаете с помощью [храллокадвисесинк](hrallocadvisesink.md) сразу после успешного возврата из вызова **advise** . Это связано с тем, что поставщики услуг могут освобождать приемник уведомлений после вызова **advise** , но до совершения вызова метода **unadvise** . Когда вы передаете источнику уведомления указатель на ваш приемник уведомлений, и счетчик ссылок увеличивается в этом приемнике уведомлений, рекомендуется отпустить его, если для него не используется долгосрочный срок. 
  
> [!NOTE]
> Все номера подключений, представляющие действительные регистрационные данные, не будут выпускаться до тех пор, пока не будет выполнен вызов **unadvise** . 
  


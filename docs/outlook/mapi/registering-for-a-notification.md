---
title: Регистрация уведомления
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 5a35add66fb685b3c17464269456edf6b456711e
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22570214"
---
# <a name="registering-for-a-notification"></a>Регистрация уведомления

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Клиент может регистрировать для уведомлений хранилища адресной книги или сообщение как часть процесса инициализации.
  
MAPI поддерживает уведомления на в адресной книге, независимо от того, является ли какие-либо поставщиками адресных книг поддержки. Поддержка уведомлений на хранилищ сообщений зависит от поставщика хранилища конкретное сообщение. Чтобы определить, поддерживает ли поставщик хранения конкретное сообщение уведомления, проверьте его свойство **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)). Если хранилище сообщений поддерживает уведомлений, будет установлен бит STORE_NOTIFY_OK. 
  
Зарегистрировать для уведомлений с помощью метода **уведомлений** объект источника уведомлений. Количество объектов реализации **уведомлений** и клиентов можно зарегистрировать эти объекты различными способами. 
  
 **Чтобы зарегистрировать уведомления**
  
1. Создание MAPI объект приемника рекомендаций и увеличивает счетчик ссылок на него.
    
2. При необходимости вызова [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) для создания объекта приемник уведомлений, который является оболочкой вашего исходного приемник уведомлений, а затем освобождение исходного приемник advice... 
    
3. Вызовите один из следующих методов для завершения регистрации **уведомлений** : 
    
  - Вызов [IMAPISession::Advise](imapisession-advise.md) для регистрации уведомлений сеанса или для уведомлений на объекте хранилища адресной книги или сообщения. 
    
  - Вызов [IAddrBook::Advise](iaddrbook-advise.md) для регистрации уведомлений адресной книги или для уведомления в списке пользователя, контейнер или рассылки сообщений. 
    
  - Вызов [IABLogon::Advise](iablogon-advise.md) для регистрации непосредственно с помощью поставщика адресных книг для уведомления в списке пользователя, контейнер или рассылки сообщений. 
    
  - Вызов [IMsgStore::Advise](imsgstore-advise.md) для регистрации для уведомления хранилища или для уведомления в папке или сообщения. 
    
  - Вызов [IMSLogon::Advise](imslogon-advise.md) для регистрации непосредственно с поставщиком хранилища сообщений уведомлений на папку или сообщение. 
    
  - Вызов [IMAPITable::Advise](imapitable-advise.md) для регистрации уведомлений в таблице. 
    
4. Кэширование номер подключения, возвращенные **уведомлений**.
    
5. При использовании приемник оболочку уведомлений, выпуска системы. После регистрации приемник оболочку уведомлений больше не требуется его.
    
Вызов ** IMAPISession::Advise ** позволяет регистрировать критическая ошибка уведомлений на общую сеанса или для различных уведомлений на отдельные объекты. Сеансы отправлять уведомления критическая ошибка на вход в систему на общую сеансов, когда другой клиент, использующий совместный сеанс вызывает метод [IMAPISession::Logoff](imapisession-logoff.md) клиентов. Для регистрации уведомлений сеанса, передайте значение NULL для параметра идентификатор записи. Чтобы зарегистрировать для уведомлений для отдельного объекта, передайте идентификатором записи. Метод **IMAPISession** перенаправляет вызов поставщика услуг, соответствующего согласно **MAPIUID** часть идентификатор записи. Вызов **IMAPISession::Advise** для регистрации уведомлений объект проще, чем вызов метода **уведомлений** поставщика услуг. 
  
Регистрация в адресной книге аналогична через сеанс. Для регистрации критическая ошибка уведомления в адресной книге, передайте значение NULL для идентификатор записи. Для регистрации уведомлений на объект определенного адресной книги, укажите идентификатор соответствующие записи и события или события. Обратите внимание, что много поставщиками адресной книги не поддерживают уведомления на отдельные объекты. Вместо этого они поддерживают таблицы уведомлений на их содержимое и таблиц иерархии. 
  
Рекомендуется для освобождения приемник уведомлений, реализации или создание с помощью [HrAllocAdviseSink](hrallocadvisesink.md) сразу же после успешного возврата из вызова **уведомлений** . Это возможно для поставщиков услуг для освобождения вашей приемник уведомлений после вызова **уведомлений** , но перед **Unadvise** вызов. После назначается источника уведомлений указатель на приемник уведомлений и счетчик ссылок увеличилось на этот приемник уведомлений, имеет смысл выпуска системы при отсутствии долгосрочные использовать его. 
  
> [!NOTE]
> Все подключения чисел, представляющих допустимый advisory регистраций не удаляется, пока не будет выполнен вызов **Unadvise** . 
  


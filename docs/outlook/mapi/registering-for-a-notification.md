---
title: Регистрация для уведомления
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 45625387-dbd2-4ca8-926b-ef87998d01d7
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ccc2758b59a9227afbc50360102e793892bbdc52
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424905"
---
# <a name="registering-for-a-notification"></a>Регистрация для уведомления

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Клиент может зарегистрироваться для уведомлений о адресной книге или хранилище сообщений в рамках процесса инициализации.
  
MAPI поддерживает уведомление в адресной книге независимо от того, поддерживает ли его кто-либо из поставщиков адресной книги. Поддержка уведомлений в хранилищах сообщений зависит от конкретного поставщика хранилища сообщений. Чтобы определить, поддерживает ли какой-либо поставщик сообщений уведомления, PR_STORE_SUPPORT_MASK[(PidTagStoreSupportMask).](pidtagstoresupportmask-canonical-property.md)  Если хранилище сообщений поддерживает уведомления, STORE_NOTIFY_OK будет установлен бит. 
  
Зарегистрируйтесь для уведомлений, позвонив в метод advise source object's **Advise.** Многие объекты **реализуют Advise,** и клиенты могут регистрироваться с этими объектами различными способами. 
  
 **Регистрация для уведомления**
  
1. Создайте объект MAPI для рекомендации по раковине и приумножйте его количество ссылок.
    
2. Если это необходимо, позвоните [в HrThisThreadAdviseSink,](hrthisthreadadvisesink.md) чтобы создать объект раковины, который обертывание исходной раковины совет, а затем освободить оригинальную раковину советов.. 
    
3. Чтобы завершить **регистрацию,** позвоните по одному из следующих методов консультирования: 
    
  - Позвоните [в IMAPISession::Advise,](imapisession-advise.md) чтобы зарегистрироваться для уведомлений сеанса или уведомлений на объекте адресной книги или магазина сообщений. 
    
  - Call [IAddrBook::Advise](iaddrbook-advise.md) to register for address book notifications or for notifications on a messaging user, container, or distribution list. 
    
  - Call [IABLogon::Advise](iablogon-advise.md) to register directly with an address book provider for notifications on a messaging user, container, or distribution list. 
    
  - Позвоните [в IMsgStore::Advise,](imsgstore-advise.md) чтобы зарегистрироваться для уведомлений магазина сообщений или уведомлений в папке или сообщении. 
    
  - Call [IMSLogon::Advise](imslogon-advise.md) to register directly with a message store provider for notifications on a folder or message. 
    
  - Позвоните [в IMAPITable::Advise,](imapitable-advise.md) чтобы зарегистрироваться для уведомлений таблицы. 
    
4. Кэш для номера подключения, возвращенного из **Advise**.
    
5. Если используется завернутая раковина, отпустите ее. После регистрации завернутой раковины рекомендации она больше не понадобится.
    
Вызов ** IMAPISession::Advise ** позволяет регистрироваться для уведомления об ошибках в ходе общего сеанса или для различных уведомлений на отдельных объектах. Сеансы отправляют уведомления о критической ошибке клиентам, входим в общие сеансы, когда другой клиент, использующий общий сеанс, вызывает [метод IMAPISession::Logoff.](imapisession-logoff.md) Чтобы зарегистрироваться для уведомлений сеанса, передай NULL для параметра идентификатора входа. Чтобы зарегистрироваться для уведомлений на отдельном объекте, передай идентификатор записи объекта. Метод **IMAPISession** передает вызов соответствующему поставщику услуг, как определяется **частью MAPIUID** идентификатора записи. Вызов **IMAPISession:::Advise** для регистрации уведомлений об объектах проще, чем вызов метода консультирования поставщика **услуг.** 
  
Регистрация в адресной книге похожа на регистрацию в сеансе. Чтобы зарегистрироваться для уведомления о критической ошибке из адресной книги, передай NULL для идентификатора записи. Чтобы зарегистрироваться для уведомлений на определенном объекте адресной книги, укажите соответствующий идентификатор записи и события или события, интересующие вас. Следует помнить, что многие поставщики адресных книг не поддерживают уведомления на отдельных объектах. Вместо этого они поддерживают уведомления таблиц в их содержимом и таблицах иерархии. 
  
Это хорошая практика, чтобы освободить раковину рекомендации, которую вы реализуете или создаете с [HrAllocAdviseSink](hrallocadvisesink.md) сразу же после успешного возвращения из **сообщите** вызова. Это потому, что это возможно для поставщиков услуг, чтобы освободить ваш раковина рекомендации после вызова Сообщить, но до **вызова Unadvise.**  После того как вы дали источнику советы указатель на раковину рекомендации и количество ссылок было приращено на этом раковине рекомендации, целесообразно освободить его, если у вас есть долгосрочное использование для него. 
  
> [!NOTE]
> Все номера подключений, которые представляют действительные консультативные регистрации, не будут выпущены до тех пор, пока не будет выполнен вызов **Unadvise.** 
  


---
title: Имапифолдерделетемессажес
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFolder.DeleteMessages
api_type:
- COM
ms.assetid: 5a16e62b-9d33-41cd-af2b-9abd403b6f2e
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0f0523c01e163b57d9ed37d9b324ec858adbd685
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426074"
---
# <a name="imapifolderdeletemessages"></a>IMAPIFolder::DeleteMessages

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Удаляет одно или несколько сообщений.
  
```cpp
HRESULT DeleteMessages(
  LPENTRYLIST lpMsgList,
  ULONG_PTR ulUIParam,
  LPMAPIPROGRESS lpProgress,
  ULONG ulFlags
);
```

## <a name="parameters"></a>Параметры

 _Лпмсглист_
  
> возврата Указатель на структуру [ентрилист](entrylist.md) , которая содержит количество сообщений, которые необходимо удалить, и массив структуры [EntryID](entryid.md) , определяющих сообщения. 
    
 _Улуипарам_
  
> возврата Дескриптор родительского окна индикатора хода выполнения. Параметр _улуипарам_ игнорируется, если не установлен флаг мессаже_диалог в параметре _ulFlags_ . 
    
 _Лппрогресс_
  
> возврата Указатель на объект Progress, который отображает индикатор хода выполнения. Если в _лппрогресс_переДАЕТСЯ значение null, то поставщик хранилища сообщений отображает индикатор хода выполнения с помощью реализации объекта Progress для MAPI. Параметр _лппрогресс_ игнорируется, если не установлен флаг мессаже_диалог в параметре _ulFlags_ . 
    
 _ulFlags_
  
> возврата Битовая маска флагов, определяющих способ удаления сообщений. Можно задать следующие флаги:
    
ДЕЛЕТЕ_ХАРД_ДЕЛЕТЕ
  
> Окончательно удаляет все сообщения, включая обратимо удаленные.
    
МЕССАЖЕ_ДИАЛОГ 
  
> Отображает индикатор хода выполнения операции.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Указанное сообщение или сообщения были успешно удалены.
    
МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН 
  
> Вызов выполнен успешно, но не все сообщения были успешно удалены. При возвращении этого предупреждения вызов должен обрабатываться как успешный. Чтобы проверить это предупреждение, используйте макрос **хр_фаилед** . Дополнительные сведения см. [в разделе Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIFolder::D елетемессажес** удаляет сообщения из папки. Сообщения, которые не существуют, перемещены в другое место, открыты с разрешением на чтение и запись или которые уже отправлены, невозможно удалить. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Если операция удаления содержит более одного сообщения, выполните операцию как можно скорее для каждой папки, даже если не удается удалить одно или несколько сообщений. Не прекращайте выполнение операции преждевременно, если не произойдет сбой, который выходит за рамки элемента управления, например, не хватает памяти, не хватает места на диске или повреждено хранилище сообщений.
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Эти возвращаемые значения следует ожидать при соблюдении следующих условий.
  
|**Условие**|**Возвращаемое значение**|
|:-----|:-----|
|**Делетемессажес** успешно удалил каждое сообщение.  <br/> |S_OK  <br/> |
|**Делетемессажес** не удалось удалить все сообщения и вложенную папку.  <br/> |МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН или МАПИ_Е_НОТ_ФАУНД  <br/> |
|**Делетемессажес** не удалось выполнить.  <br/> |Любое значение ошибки, кроме МАПИ_Е_НОТ_ФАУНД  <br/> |
   
Если **делетемессажес** не удается выполнить, не следует предполагать, что работа не выполнялась. Возможно, в **делетемессажес** удалось удалить одно или несколько сообщений, прежде чем возникнет ошибка. 
  
 **Делетемессажес** возвращает МАПИ_В_ПАРТИАЛ_КОМПЛЕТИОН или мапи_е_нот_фаунд в зависимости от реализации хранилища сообщений. 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Фолдердлг. cpp  <br/> |Кфолдердлг:: Онделетеселектедитем  <br/> |MFCMAPI использует метод **IMAPIFolder::D елетемессажес** для удаления указанных сообщений.  <br/> |
   
## <a name="see-also"></a>См. также



[ENTRYID](entryid.md)
  
[ENTRYLIST](entrylist.md)
  
[IMAPIFolder : IMAPIContainer](imapifolderimapicontainer.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Использование макросов для обработки ошибок](using-macros-for-error-handling.md)


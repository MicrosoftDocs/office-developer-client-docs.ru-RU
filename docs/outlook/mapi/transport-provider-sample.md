---
title: Пример поставщика транспорта
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ec6eb6c0-bfe3-4989-9071-89a14c0e7bdd
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: def51a752abcb79a35980ed12eb73011c26d2597
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356590"
---
# <a name="transport-provider-sample"></a>Пример поставщика транспорта

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
В этом примере используются файлы и каталоги для передачи и получения сообщений. Он реализует и регистрирует очень простой препроцессор, который примыкает строку текста к каждому исходячему сообщению. В примере показано, как разделить содержимое сообщения между форматом инкапсуляции (TNEF) и текстом. Он также поддерживает все параметры конфигурации (листы свойств, мастера и программную конфигурацию) и параметры сообщений. Он не поддерживает удаленные транспортные интерфейсы. 
  
Этот пример можно скачать Outlook API обмена сообщениями [(MAPI).](https://go.microsoft.com/fwlink/?LinkId=129740)
  
|||
|:-----|:-----|
|Исполняемый:  <br/> |mrxp32.dll  <br/> |
|Каталог исходных кодов:  <br/> |SampleTransportProvider\MRXP  <br/> |
|Язык:  <br/> |C++  <br/> |
|Платформы:  <br/> |Visual Studio 2008 г. для Windows Vista, Windows Server 2008, Windows XP SP2 и Windows Server 2003 SP1  <br/> |
   
## <a name="supported-features"></a>Поддерживаемые функции

В этом примере поддерживаются следующие функции:
  
- Основные функции, такие как отправка, получение и опрос новых сообщений.
    
- Интерактивная и программная конфигурация.
    
- Интерфейс **IMAPIStatus,** за исключением параметра свойства. Дополнительные сведения см. в [интерфейсе IMAPIStatus : IMAPIProp.](imapistatusimapiprop.md) 
    
- Безопасность потока.
    
- Ведение журнала событий в текстовом файле. Файл автоматически ограничен заданным размером. Все сеансы транспорта используют один и тот же файл.
    
## <a name="unsupported-features"></a>Неподтверченные функции

Этот пример не поддерживает асинхронное обнаружение входящих сообщений.
  
 **Установка поставщика образцов транспорта**
  
1. Чтобы скачать образец поставщика транспорта, см. в Outlook [mapi Samples](downloading-the-outlook-mapi-samples.md).
    
2. Найдите папку, в которой сохранены Outlook MAPI. Щелкните правой кнопкой **мыши папку OutlookMAPISamples-version \< \> number** zip и нажмите **кнопку Извлечь все**.
    
3. Щелкните **Обзор,** выберите расположение, в котором необходимо сохранить образец, и нажмите кнопку **Извлечение**.
    
4. Запуск Visual Studio 2008.
    
5. В Visual Studio 2008 нажмите **кнопку Файл**, выберите **Открыть**, а затем **нажмите кнопку Project/Решение**.
    
6. Просмотрите расположение, в котором сохранен пример, щелкните **mrxp32.vcproj** и нажмите **кнопку Открыть**.
    
7. В меню **Сборка** щелкните **Диспетчер конфигурации**.
    
8. В **диалоговом** окне Диспетчер конфигурации перейдите к **строке mrxp32,** а в столбце **Конфигурация** выберите Выпуск **и** нажмите **кнопку Закрыть**.
    
9. On the **Build** menu, click **Build Solution**.
    
10. В **диалоговом окне Сохранить файл как** диалоговое окно нажмите **кнопку Сохранить**.
    
11. В папке, в которой сохранен пример, щелкните правой кнопкой мыши пакетный файл установки и нажмите **кнопку Выполнить в качестве администратора.**
    
12. В диалоговом окне **Контроль учетных записей пользователей** нажмите кнопку **Продолжить**.
    
    > [!NOTE]
    > **install.bat** копирует .dll в папку установки Microsoft Office по умолчанию C:\Program Files\Microsoft Office\Office12\. Если вы установили Office в другом расположении, щелкните правой кнопкой **мыши** install.batнажмите **кнопку Изменить**. Файл открывается в Блокнот. Замените путь установки по умолчанию на путь установки, используемый на компьютере. 
  
 **Настройка поставщика транспорта в Outlook**
  
1. В меню **Tools** Outlook нажмите **кнопку Учетная запись Параметры**.
    
2. В **диалоговом окне Параметры** учетной записи на вкладке **"Электронная** почта" нажмите **кнопку New**.
    
3. В **статье Выберите службу электронной почты** **нажмите кнопку Другие**, выберите **mrXP Пример транспорта,** а затем нажмите **кнопку Далее**.
    
4. В **диалоговом окне конфигурации транспорта MRXP** введите **имя отображения пользователя.**
    
5. В **статье Путь к папке (Share UNC)** введите путь папки. Это также может быть путь к локальной папке. 
    
    > [!IMPORTANT]
    > Этот путь должен существовать. 
  
6. Нажмите кнопку **ОК**.
    
7. В **диалоговом окне Добавить учетную запись** электронной почты нажмите **кнопку ОК**. Нажмите **кнопку Готово** и нажмите **кнопку Закрыть**.
    
8. Чтобы начать использовать учетную запись MRXP, выйдите и перезапустите Outlook.
    
 **Использование примера поставщика транспорта для отправки сообщения в Outlook**
  
1. В меню **File** нажмите **кнопку New** и нажмите сообщение **почты**.
    
2. В поле **Для** введите имя получателя с помощью **формата [MRXP: \< ADDRESS \> ]**. Адрес — это путь к папке unC или локальной папке в папку "Входящие" получателя.
    
    > [!NOTE]
    > Если в адресе имеются двоеточия или задние ресницы, перед каждой толстой или задней кишки необходимо вставить ответную сетку. Например, для отправки почты в [MRXP:C:\Mail\myDir] необходимо ввести  `[MRXP:C\:\\Mail\\myDir]` . 
  
    > [!IMPORTANT]
    > Адрес получателя должен существовать. 
  
3. Щелкните **учетную** запись и **нажмите кнопку MRXP Sample Transport**.
    
4. Введите сообщение и нажмите кнопку **Отправить**. Сообщение отправляется с помощью поставщика транспорта MRXP.
    
 **Использование примера поставщика транспорта для получения сообщения в Outlook**
  
1. В меню **File** нажмите **кнопку New** и нажмите сообщение **почты**.
    
2. Введите сообщение.
    
3. Щелкните **кнопку Microsoft Office,** нажмите кнопку **Сохранить** как и нажмите кнопку **Сохранить,** чтобы сохранить файл в папку "Входящие", указанную во время установки. 
    
4. В **диалоговом** окне Save As просмотрите раздел UNC или локализованную папку, которую вы установите в качестве папки "Входящие". 
    
5. В **формате Сохранить при падении** типа щелкните **Outlook формате сообщений.**
    
6. Введите имя файла и нажмите кнопку **Сохранить**.
    
7. Файл сохранен в общей папке. Поставщик транспорта MRXP доставляет сообщение в почтовый ящик в Outlook.
    


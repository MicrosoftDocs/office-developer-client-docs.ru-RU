---
title: Пример поставщика транспорта
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ec6eb6c0-bfe3-4989-9071-89a14c0e7bdd
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: def51a752abcb79a35980ed12eb73011c26d2597
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32356590"
---
# <a name="transport-provider-sample"></a>Пример поставщика транспорта

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
В этом примере используются файлы и каталоги для передачи и получения сообщений. Он реализует и регистрирует очень простой препроцессор, который добавляет строку текста для каждого исходящего сообщения. В этом примере показано, как разделить содержимое сообщения между форматами TNEF и Text, не зависящим от транспорта. Кроме того, поддерживаются все параметры конфигурации (страницы свойств, мастера и программная конфигурация) и параметры сообщений. Он не поддерживает удаленные транспортные интерфейсы. 
  
Этот пример можно скачать из [примеров кода для API обмена сообщенияМи Outlook (MAPI)](https://go.microsoft.com/fwlink/?LinkId=129740).
  
|||
|:-----|:-----|
|Выполним  <br/> |mrxp32. dll  <br/> |
|Каталог исходного кода:  <br/> |Самплетранспортпровидер\мрксп  <br/> |
|Языки  <br/> |Языка  <br/> |
|Embedded  <br/> |Visual Studio 2008 для компиляции для Windows Vista, Windows Server 2008, Windows XP с ПАКЕТом обновления 2 и Windows Server 2003 с ПАКЕТом обновления 1 (SP1)  <br/> |
   
## <a name="supported-features"></a>Поддерживаемые функции

В этом примере поддерживаются следующие функции:
  
- Основные функции, такие как отправка, получение и опрос новых сообщений.
    
- Интерактивная и программная конфигурация.
    
- Интерфейс **имапистатус** , за исключением параметра свойства. Дополнительные сведения см. в интерфейсе [имапистатус: IMAPIProp](imapistatusimapiprop.md) . 
    
- Безопасность потоков.
    
- Ведение журнала событий в текстовый файл. Размер файла автоматически ограничен указанным. Все сеансы транспорта используют один и тот же файл.
    
## <a name="unsupported-features"></a>Неподдерживаемые функции

В этом примере не поддерживается асинхронное обнаружение входящих сообщений.
  
 **Установка образца поставщика транспорта**
  
1. Чтобы скачать образец поставщика транспорта, ознакомьтесь со статьей [скачивание образцов Outlook MAPI](downloading-the-outlook-mapi-samples.md).
    
2. Откройте папку, в которую были сохранены примеры Outlook MAPI. Щелкните правой кнопкой мыши папку Zip **\<аутлукмаписамплес-\> Version Number** и выберите **извлечь все**.
    
3. Нажмите кнопку **Обзор**, выберите расположение, в котором нужно сохранить пример, и нажмите кнопку **извлечь**.
    
4. Запустите Visual Studio 2008.
    
5. В Visual Studio 2008 откройте меню **файл**, выберите пункт **Открыть**, а затем выберите **проект/решение**.
    
6. Перейдите к папке, в которой сохранен пример, выберите **mrxp32. vcproj**, а затем нажмите кнопку **Открыть**.
    
7. В меню **Построение** выберите пункт **Диспетчер конфигураций**.
    
8. В диалоговом окне **Диспетчер конфигураций** перейдите к строке **mrxp32** , а затем в столбце **Конфигурация** выберите **выпуск**и нажмите кнопку **Закрыть**.
    
9. On the **Build** menu, click **Build Solution**.
    
10. В диалоговом окне **сохранить файл как** нажмите кнопку **сохранить**.
    
11. В папке, в которой сохранен пример, щелкните правой кнопкой мыши пакетный файл установки и выберите команду **Запуск от имени администратора**.
    
12. В диалоговом окне **Контроль учетных записей пользователей** нажмите кнопку **Продолжить**.
    
    > [!NOTE]
    > **install. bat** копирует библиотеку DLL в папку установки Microsoft Office по умолчанию, C:\Program Files\Microsoft Office\Office12\. Если вы установили продукты Office в другом расположении, щелкните правой кнопкой мыши **install. bat** и выберите команду **изменить**. Файл откроется в блокноте. Замените путь установки по умолчанию на путь установки, используемый на вашем компьютере. 
  
 **Настройка поставщика транспорта в Outlook**
  
1. В меню **Сервис** Outlook выберите пункт **Параметры учетной записи**.
    
2. В диалоговом окне **Параметры учетНой записи** на вкладке **Электронная почта** нажмите кнопку **создать**.
    
3. В разделе **Выбор службы электронной почты** нажмите кнопку **другой**, выберите пункт **мрксп Sample Transport (транспорт**), а затем нажмите кнопку **Далее**.
    
4. В диалоговом окне **Конфигурация транспорта мрксп** введите **Отображаемое имя пользователя**.
    
5. В разделе **путь к папке "Входящие" (UNC-общая папка)** введите путь к папке. Это также может быть путь к локальной папке. 
    
    > [!IMPORTANT]
    > Этот путь должен существовать. 
  
6. Нажмите кнопку **ОК**.
    
7. В диалоговом окне **Добавление учетНой записи электронной почты** нажмите кнопку **ОК**. Нажмите кнопку **Готово** , а затем кнопку **Закрыть**.
    
8. Чтобы начать работу с учетной записью МРКСП, закройте и перезапустите Outlook.
    
 **Использование образца поставщика транспорта для отправки сообщения в Outlook**
  
1. В меню **файл** выберите команду **создать**, а затем — **сообщение электронной почты**.
    
2. В поле **Кому** введите имя получателя в формате **[мрксп\<\>: адрес]**. Адрес — это UNC-путь к папке "Входящие" или путь к локальной папке получателя.
    
    > [!NOTE]
    > Если в адресе есть двоеточия или обратные косые черты, необходимо вставить обратную косую черту перед каждым двоеточием или обратной косой чертой. Например, чтобы отправить почту [МРКСП: C: \Маил\мидир], необходимо ввести `[MRXP:C\:\\Mail\\myDir]`. 
  
    > [!IMPORTANT]
    > Адрес получателя должен существовать. 
  
3. Выберите **учетНая запись** , а затем щелкните **мрксп образец транспорта**.
    
4. Введите сообщение и нажмите кнопку **Отправить**. Сообщение отправляется с помощью поставщика транспорта МРКСП.
    
 **Использование образца поставщика транспорта для получения сообщения в Outlook**
  
1. В меню **файл** выберите команду **создать**, а затем — **сообщение электронной почты**.
    
2. Введите текст сообщения.
    
3. Нажмите кнопку **Microsoft Office**, выберите **Сохранить как**, а затем нажмите кнопку **Сохранить как** , чтобы сохранить файл в папке "Входящие", указанной во время установки. 
    
4. В диалоговом окне **Сохранить как** перейдите к общему ресурсу UNC или локальной папке, настроенным в качестве папки "Входящие". 
    
5. В раскрывающемся списке **Тип файла** выберите **Формат сообщений Outlook**.
    
6. Введите имя файла и нажмите кнопку **сохранить**.
    
7. Файл будет сохранен в общей папке. Поставщик транспорта МРКСП доставляет сообщение в папку "Входящие" в Outlook.
    


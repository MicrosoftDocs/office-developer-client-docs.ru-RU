---
title: Пример поставщика транспорта
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ec6eb6c0-bfe3-4989-9071-89a14c0e7bdd
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: def51a752abcb79a35980ed12eb73011c26d2597
ms.sourcegitcommit: ef717c65d8dd41ababffb01eafc443c79950aed4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25401407"
---
# <a name="transport-provider-sample"></a>Пример поставщика транспорта

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В этом примере использует каталоги и файлы для передачи и получения сообщений. Он реализует и регистрирует очень простым препроцессор, который добавляет строку текста для всех исходящих сообщений. Пример схемы иллюстрирует способ разделения содержимого сообщения между транспорта Neutral Encapsulation формата TNEF и текст. Он также поддерживает все параметры конфигурации (страницы свойств, мастеры и программной конфигурации) и параметры сообщения. Он не поддерживает интерфейсы удаленных транспорта. 
  
В этом примере можно загрузить из [Примеры кода Outlook системы обмена сообщениями API (MAPI)](https://go.microsoft.com/fwlink/?LinkId=129740).
  
|||
|:-----|:-----|
|Исполняемый файл:  <br/> |mrxp32.dll  <br/> |
|Каталог исходного кода:  <br/> |SampleTransportProvider\MRXP  <br/> |
|Язык:  <br/> |C++  <br/> |
|Платформы:  <br/> |Visual Studio 2008 для компиляции для Windows Vista, Windows Server 2008, Windows XP с пакетом обновления 2 и Windows Server 2003 с пакетом обновления 1  <br/> |
   
## <a name="supported-features"></a>Поддерживаемые функции

В этом примере не поддерживают следующие возможности:
  
- Основные функции, например, отправка, получение и опроса для новых сообщений.
    
- Интерактивные и программный конфигурации.
    
- Интерфейс **IMAPIStatus** , за исключением параметра свойства. Дополнительные сведения можно [IMAPIStatus: IMAPIProp](imapistatusimapiprop.md) интерфейса. 
    
- Потокобезопасность.
    
- Ведение журнала событий в текстовый файл. Файл автоматически ограничено до указанного размера. Все сеансы транспорта использовать тот же файл.
    
## <a name="unsupported-features"></a>Неподдерживаемые возможности

В этом примере не поддерживает асинхронные обнаружения входящих сообщений.
  
 **Установка примера поставщика транспорта**
  
1. Чтобы загрузить пример поставщика транспорта, обратитесь к разделу [Загрузка примеров Outlook MAPI](downloading-the-outlook-mapi-samples.md).
    
2. Найдите папку, в которой вы сохранили примеры Outlook MAPI. Щелкните правой кнопкой мыши **OutlookMAPISamples -\<номер версии\> ** ZIP-папку и выберите команду **Извлечь все**.
    
3. Нажмите кнопку **Обзор**, выберите расположение, где требуется сохранить образца и нажмите кнопку **извлечь**.
    
4. Запустите Visual Studio 2008.
    
5. В Visual Studio 2008 откройте меню **файл**, выберите команду **Открыть**и щелкните **Проект/решение**.
    
6. Перейдите к папке, в которой вы сохранили примера **mrxp32.vcproj**и нажмите кнопку **Открыть**.
    
7. В меню **Построение** выберите пункт **Диспетчер конфигураций**.
    
8. В диалоговом окне **Диспетчер конфигураций** переход на строку **mrxp32** и выберите в столбце **конфигурации** **выпуска**и нажмите кнопку **Закрыть**.
    
9. On the **Build** menu, click **Build Solution**.
    
10. В диалоговом окне **Сохранение файла** нажмите кнопку **Сохранить**.
    
11. В папке, где был сохранен примера щелкните правой кнопкой мыши файл пакета установки и выберите команду **Запуск от имени администратора**.
    
12. В диалоговом окне **Контроль учетных записей пользователей** нажмите кнопку **Продолжить**.
    
    > [!NOTE]
    > **Install.bat** копирует DLL-файл в папке установки Microsoft Office по умолчанию C:\Program Files\Microsoft Office\Office12\. Если вы установили продукты Office в другом месте, щелкните правой кнопкой мыши **install.bat** и нажмите кнопку **Изменить**. Файл открывается в "Блокнот". Замените путь установки по умолчанию путь установки, используемые на вашем компьютере. 
  
 **Чтобы настроить поставщика транспорта в Outlook**
  
1. В меню **Сервис** Outlook выберите **Настройка учетных записей**.
    
2. В диалоговом окне **Настройка учетных записей** на вкладке **электронной почты** нажмите кнопку **Создать**.
    
3. В разделе **Выбор службы электронной почты** нажмите кнопку **другие**, выберите **MRXP пример транспорта**и нажмите кнопку **Далее**.
    
4. В диалоговом окне **Конфигурация транспорта MRXP** введите **Отображаемое имя пользователя**.
    
5. В поле **путь к папке "Входящие" (общий Сетевой ресурс)** введите путь к папке. Это также может быть пути в локальную папку. 
    
    > [!IMPORTANT]
    > Этот путь должен существовать. 
  
6. Нажмите кнопку **ОК**.
    
7. В диалоговом окне **Добавление учетной записи электронной почты** нажмите **кнопку ОК**. Нажмите кнопку **Готово** , а затем нажмите кнопку **Закрыть**.
    
8. Чтобы начать работу с использованием учетной записи MRXP, закройте и перезапустите Outlook.
    
 **Чтобы отправить сообщение в Outlook при использовании примера поставщика транспорта**
  
1. В меню **файл** выберите **Создать**и нажмите кнопку **Сообщение электронной почты**.
    
2. В **поле** введите имя получателя, в формате **[MRXP:\<адрес\>]**. Адрес — это общий Сетевой ресурс или локальный путь к папке "Входящие" получателя.
    
    > [!NOTE]
    > В случае с запятыми или обратной косой черты в поле адрес, необходимо вставить обратную косую черту перед каждого двоеточие или обратная косая черта. Например, для отправки почты в [MRXP:C:\Mail\myDir] необходимо будет ввести `[MRXP:C\:\\Mail\\myDir]`. 
  
    > [!IMPORTANT]
    > Должны существовать в адресе получателя. 
  
3. Выберите **учетную запись** и нажмите кнопку **MRXP пример транспорта**.
    
4. Введите сообщение и нажмите кнопку **Отправить**. Сообщение отправлено с использованием поставщика транспорта MRXP.
    
 **Использование примера поставщика транспорта для получения сообщений в Outlook**
  
1. В меню **файл** выберите **Создать**и нажмите кнопку **Сообщение электронной почты**.
    
2. Введите сообщение.
    
3. Нажмите **Кнопку Microsoft Office**, выберите команду **Сохранить как**и нажмите кнопку **Сохранить как** для сохранения файла в папке "Входящие", которые были заданы во время установки. 
    
4. В диалоговом окне **Сохранить как** перейдите к общий Сетевой ресурс или локальную папку, который необходимо задать в качестве папки "Входящие". 
    
5. В раскрывающемся списке **Тип файла** нажмите кнопку **Формат сообщения Outlook**.
    
6. Введите имя для файла и нажмите кнопку **Сохранить**.
    
7. Файл сохраняется в общую папку. Поставщика транспорта MRXP доставляет сообщение в папку "Входящие" в Outlook.
    


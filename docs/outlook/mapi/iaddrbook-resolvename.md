---
title: иаддрбукресолвенаме
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IAddrBook.ResolveName
api_type:
- COM
ms.assetid: a7823c16-efda-45c2-b931-3e1fbc823b0b
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 8a6a73153b857078cb37d94a634a6b0215a0a8c5
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33408133"
---
# <a name="iaddrbookresolvename"></a>IAddrBook::ResolveName

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Выполняет разрешение имен, назначая идентификаторы записей получателям в списке получателей.
  
```cpp
HRESULT ResolveName(
  ULONG_PTR ulUIParam,
  ULONG ulFlags,
  LPSTR lpszNewEntryTitle,
  LPADRLIST lpAdrList
);
```

## <a name="parameters"></a>Параметры

 _улуипарам_
  
> возврата Дескриптор родительского окна диалогового окна, который отображается, если он указан, чтобы запросить разрешение на неоднозначность.
    
 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют различными аспектами процесса разрешения. Можно задать следующие флаги:
    
AB_UNICODEUI
  
> Указывает, что _лпсзневентрититле_ является строкой Юникода. 
    
MAPI_CACHE_ONLY
  
> Для разрешения имен используйте только автономную адресную книгу. Например, вы можете использовать этот флаг, чтобы разрешить клиентскому приложению открывать глобальный список адресов (GAL) в режиме кэширования Exchange и получать доступ к записи в этой адресной книге из кэша, не создавая трафик между клиентом и сервером. Этот флаг поддерживается только поставщиком адресной книги Exchange.
    
MAPI_DIALOG 
  
> Отображает диалоговое окно, в котором пользователю предлагается ввести дополнительные сведения о разрешении имен. Если этот флаг не установлен, диалоговое окно не отображается. 
    
MAPI_UNICODE 
  
> Указывает, что свойства, возвращаемые в списке адресов, должны иметь тип PT_UNICODE, а не PT_STRING8. 
    
 _лпсзневентрититле_
  
> возврата Указатель на текст заголовка элемента управления в диалоговом окне, предлагающий пользователю ввести получателя. Название зависит от типа получателя. Параметр _лпсзневентрититле_ может иметь значение null. 
    
 _лпадрлист_
  
> [по истечении] Указатель на структуру [ADRLIST](adrlist.md) , которая содержит список имен получателей, которые требуется разрешить. Эту структуру **ADRLIST** можно создать с помощью метода [IAddrBook:: Address](iaddrbook-address.md) . 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Процесс разрешения имен выполнен успешно.
    
MAPI_E_AMBIGUOUS_RECIP 
  
> По крайней мере один получатель в параметре _лпадрлист_ сопоставлен с более чем одной записью в адресной книге. Обычно это значение возвращается, если установлен флаг MAPI_DIALOG, запрещая отображение диалогового окна. 
    
MAPI_E_NOT_FOUND 
  
> Не удается разрешить по крайней мере одного получателя в параметре _лпадрлист_ . Обычно это значение возвращается, если установлен флаг MAPI_DIALOG, запрещая отображение диалогового окна. 
    
## <a name="remarks"></a>Примечания

Клиенты и поставщики услуг вызывают метод **ресолвенаме** для запуска процесса разрешения имен. Неразрешенная запись — это запись, у которой еще нет идентификатора записи или свойства **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)).
  
 **Ресолвенаме** проходит следующий процесс для каждой неразрешенной записи в списке адресов, переданном параметром _лпадрлист_ . 
  
1. Если тип адреса получателя соответствует формату SMTP-адреса (домен _DisplayName_@ _. верхний уровень — домен_), **ресолвенаме** назначает ему идентификатор одноразовой записи. 
    
2. Для каждого контейнера в свойстве **PR_AB_SEARCH_PATH** ([PidTagAbSearchPath](pidtagabsearchpath-canonical-property.md)) **ресолвенаме** вызывает метод [иабконтаинер:: ResolveNames](iabcontainer-resolvenames.md) . **ResolveNames** пытается найти отображаемое имя каждого неизвестного получателя с отображаемым именем, принадлежащим одной из записей. 
    
3. Если контейнер не поддерживает **ResolveNames**, **ресолвенаме** ограничит таблицу содержимого контейнера с помощью ограничения свойства **PR_ANR** ([PidTagAnr](pidtaganr-canonical-property.md)). Это ограничение приводит к тому, что контейнер выполнит "лучший тип поиска", чтобы найти совпадающего получателя. Все контейнеры должны поддерживать ограничение свойства **PR_ANR** . 
    
4. Если контейнер возвращает получателя, который соответствует нескольким именам, **ресолвенаме** отображает диалоговое окно, если установлен флаг MAPI_DIALOG, который позволяет пользователю выбрать правильное имя. 
    
5. Если все контейнеры в свойстве **PR_AB_SEARCH_PATH** вызваны, а совпадения не найдены, получатель остается неразрешимым. 
    
Если один или несколько получателей не разрешены, **ресолвенаме** возвращает MAPI_E_NOT_FOUND. Если одному или нескольким получателям присвоено неоднозначное разрешение, которое не удалось разрешить с помощью диалогового окна, или не задано значение флага MAPI_DIALOG, **ресолвенаме** возвращает MAPI_E_AMBIGUOUS_RECIP. Если некоторые из получателей являются неоднозначными и не удается разрешить некоторые из них, **ресолвенаме** может возвращать значение ошибки. 
  
Если не удается разрешить имя, клиент может создать один адрес с особым отформатированным адресом и идентификатором записи. Дополнительные сведения о формате одноразовых идентификаторов записей можно узнать в статье [одноразовые идентификаторы записей](one-off-entry-identifiers.md). Более подробную информацию о формате одноразовых адресов можно узнать в разделе [одноразовые адреса](one-off-addresses.md).
  
MAPI поддерживает строки символов Юникода для **ADRLIST** и новые параметры заголовка записи в **ресолвенаме**; При установке флага MAPI_UNICODE следующие свойства возвращаются в виде PT_UNICODE типов в структурах [адрентри](adrentry.md) : 
  
- **PR_ADDRTYPE** ([PidTagAddressType](pidtagaddresstype-canonical-property.md))
    
- **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md))
    
- **PR_EMAIL_ADDRESS** ([PidTagEmailAddress](pidtagemailaddress-canonical-property.md))
    
- **PR_TRANSMITABLE_DISPLAY_NAME** ([PidTagTransmittableDisplayName](pidtagtransmittabledisplayname-canonical-property.md))
    
Однако свойство **PR_7BIT_DISPLAY_NAME** ([PidTag7BitDisplayName](pidtag7bitdisplayname-canonical-property.md)) всегда возвращается как тип PT_STRING8.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**�����������**|
|:-----|:-----|:-----|
|Мапиабфунктионс. cpp  <br/> |аддонеоффаддресс  <br/> |MFCMAPI использует метод **ресолвенаме** , чтобы разрешить один адрес перед добавлением его в сообщение.  <br/> |
|Мапиабфунктионс. cpp  <br/> |аддреЦипиент  <br/> |MFCMAPI использует метод **ресолвенаме** для поиска записи в адресной книге по отображаемому имени.  <br/> |
   
## <a name="see-also"></a>См. также



[ADRLIST](adrlist.md)
  
[IABContainer::ResolveNames](iabcontainer-resolvenames.md)
  
[IAddrBook::Address](iaddrbook-address.md)
  
[IAddrBook : IMAPIProp](iaddrbookimapiprop.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


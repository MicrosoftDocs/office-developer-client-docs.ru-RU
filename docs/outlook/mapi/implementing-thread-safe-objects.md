---
title: Реализация потокобезопасных объектов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3c911694-b953-4d35-9a3a-22c17cfd79bc
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 8c8c89f3626d54f04896ad54de5d7e480dd9b568
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19809345"
---
# <a name="implementing-thread-safe-objects"></a>Реализация потокобезопасных объектов

  
  
**Относится к**: Outlook 
  
С объектами, возвращенные вызовы методов интерфейса напрямую отвечает поставщика для обеспечения безопасности потока. С помощью объектов обратного вызова отвечает клиентское приложение.
  
Клиент можно реализовать обратного вызова уведомления потоками путем вызова MAPI служебной программы [HrThisThreadAdviseSink](hrthisthreadadvisesink.md). **HrThisThreadAdviseSink** преобразует приемник не являющихся потокобезопасными уведомлений в один являющихся потокобезопасными. Для обратных вызовов хода выполнения нет такого служебной программы. Клиент можно использовать объект хода выполнения потоками MAPI или создать новое вручную. 
  
Объект потоками может или не также принять во внимание потока. Поток объект поддерживает отдельные контекст для каждого потока, который он используется. Поставщиков услуг не требуются для поддержки поддержка потоков в их объектами потоками несмотря на то, что поток-сведения о поддержке может быть полезен в некоторых случаях. Две таблицы MAPI всегда отправлять собственные контекста по определению. Одной таблицы, используемые на различных потоках не поддерживает и не следует предоставлять уникальный контекста.
  
Клиент можно выбрать получение уведомлений в том же потоке, который использовался для **MAPIInitialize** позвонить, в том же потоке, который использовался для вызова **уведомлений** или в отдельном потоке, принадлежащие MAPI. Чтобы убедиться, что уведомления о получении на тот же поток, который использовался для вызова **MAPIInitialize**, клиент вызывает [MAPIInitialize](mapiinitialize.md) и передает ноль в член **ulFlags** структуры [MAPIINIT_0](mapiinit_0.md) . Во время цикла основного сообщения нажмите доставить уведомления. 
  
Чтобы получать уведомления о потоке владении MAPI, клиент вызывает **MAPIInitialize** с членом **ulFlags** структуры **MAPIINIT_0** , задайте значение MAPI_MULTITHREAD_NOTIFICATIONS. Выполнен вызов **уведомлений** с помощью клиента уведомить объектом приемника, а не оболочку версии. 
  
Чтобы убедиться, что уведомления о получении на тот же поток, который использовался для вызова **уведомлений**, клиент вызывает [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) и этапы, которые только что созданный оболочку уведомить приемник для **уведомлений** , а не на исходный приемник уведомлений. **MAPIInitialize** может быть вызван с помощью любого из значение флага. 
  


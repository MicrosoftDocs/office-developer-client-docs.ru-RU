---
title: Реализация Thread-Safe объектов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3c911694-b953-4d35-9a3a-22c17cfd79bc
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 9160136542c7960bad0be2423872171b17d99fe3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33413530"
---
# <a name="implementing-thread-safe-objects"></a>Реализация Thread-Safe объектов

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
При прямом вызове методов интерфейса объекты отвечают поставщику за обеспечение потокобезопасности. За объекты callback отвечает клиентские приложения.
  
Клиент может реализовать потокобезопасный вызов уведомлений, вызывая с помощью средства MAPI [HrThisThreadAdviseSink.](hrthisthreadadvisesink.md) **HrThisThreadAdviseSink** преобразует потокобезопасный в потокобезопасный поток. Для вызовов хода выполнения такая программа не существует. Клиент может использовать потокобезопасный объект MAPI или создать его вручную. 
  
Потокобезопасный объект также может быть или не быть потокобезопасн. Объект, использующий поток, поддерживает отдельный контекст для каждого потока, который его использует. Поставщики услуг не обязаны поддерживать потоковую осведомленность в своих потокобезопасных объектах, хотя поддержка поддержки поддержки потоков может оказаться полезной в некоторых ситуациях. Две таблицы MAPI всегда предоставляют собственный контекст по определению. Одна таблица, используемая в разных потоках, не предоставляет и не должна предоставлять уникальный контекст.
  
Клиент может выбрать получение уведомлений в том же потоке, который использовался для вызова **MAPIInitialize,** в том же потоке, который использовался для вызова advise, или в отдельном потоке, который принадлежит MAPI.  Чтобы гарантировать, что уведомления поступают в тот же поток, который использовался для вызова **MAPIInitialize,** клиент вызывает [MAPIInitialize](mapiinitialize.md) и передает ноль в **члене ulFlags** структуры MAPIINIT_0. [](mapiinit_0.md) Затем уведомления доставляются во время основного цикла сообщений. 
  
Для получения уведомлений в потоке, **владельцем** MAPI, клиент вызывает **MAPIInitialize** с членом **ulFlags** структуры MAPIINIT_0 имеет MAPI_MULTITHREAD_NOTIFICATIONS. Вызов **"Сообщить"** выполнен с помощью объекта-оболочки клиентской рекомендации, а не упакованной версии. 
  
Чтобы гарантировать, что уведомления поступают в тот же поток, который использовался для вызова "Advise", клиент вызывает [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) и передает только что созданный оболочку-оболочку в "Advise", а не в исходную оболочку.   **MAPIInitialize** может быть вызвано с помощью любого значения флага. 
  


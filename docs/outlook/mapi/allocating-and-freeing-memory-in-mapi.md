---
title: Выделение и освобождение памяти в MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 2ec5c2604c72d41078aa467764463e2659c62e65
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22587945"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a>Выделение и освобождение памяти в MAPI

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Кроме возможности задания как выделить и освободить память, MAPI определяет модель знать при передаче памяти между открытый метод интерфейса и функции API, звонки нужно освободить. Модель применяется только к памяти, выделенный для параметров, которые не являются указатели на интерфейсы, такие как строки и указатели на структуры. Указатели интерфейса используйте механизмом реализации через **интерфейс IUnknown**подсчета ссылок. Если выделение и освобождение не MAPI связанные памяти в клиентском приложении или поставщик услуг, используйте любой механизм имеет смысл. 
  
Модель определяет параметры как один из трех типов. Они могут вводить установленные вызывающим абонентом со сведениями для использования с вызываемой функции или метода, параметры выходные параметры, функция или метод и возвращен вызывающего или параметры ввода вывода, комбинации двух типов. Часто используются параметры вывода указатели на данные или указатели на указатели на данные. Несмотря на то, что эта функция несет ответственность за распределения данных для выходных параметров, вызывающего выделения памяти для указателя мыши. 
  
В следующей таблице описываются правила для распределения и освобождения памяти для этих типов параметров.
  
|**Тип**|**Выделение памяти**|**Выпуск памяти**|
|:-----|:-----|:-----|
|Input  <br/> |Вызывающий объект отвечает и можно использовать любой механизм.  <br/> |Вызывающий объект отвечает и можно использовать любой механизм.  <br/> |
|Output  <br/> |Функция отвечает и необходимо использовать **MAPIAllocateBuffer**. Для получения дополнительных сведений см [MAPIAllocateBuffer](mapiallocatebuffer.md).  <br/> |Вызывающий объект отвечает и необходимо использовать **MAPIFreeBuffer**. Для получения дополнительных сведений см [MAPIFreeBuffer](mapifreebuffer.md).  <br/> |
|Ввода вывода  <br/> |Вызывающий объект отвечает за начального выделения и вызываемой функции можно перемещать при необходимости с помощью **MAPIAllocateBuffer**.  <br/> |Функция несет ответственность за начальной освобождение, если это необходимо. Вызывающий объект должен освободить конечное возвращаемое значение.  <br/> |
   
Во время сбоя условия реализации методов интерфейса нужно Обратите внимание на выходных данных и параметров ввода вывода, так как вызывающего абонента обычно не имеет возможности их очистки. Если возвращается сообщение об ошибке, затем каждый параметр ввода вывода или выходных данных необходимо либо оставить значение инициализации вызывающим абонентом или задать значение, которое может очистить без каких-либо действий со стороны вызывающего абонента. Например, выходной указатель аргумент `void ** ppv` должно остаться как его на входные данные или может быть задано значение NULL ( `*ppv = NULL`).
  


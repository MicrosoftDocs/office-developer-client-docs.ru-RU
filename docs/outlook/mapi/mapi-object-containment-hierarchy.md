---
title: Иерархия содержания объектов MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 33747835-6eeb-4e07-8f92-3cfa81eecd0f
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f5faf3a3d4971b01509d0ff0cfa59451015ba205
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426928"
---
# <a name="mapi-object-containment-hierarchy"></a>Иерархия содержания объектов MAPI
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Отношение вложенности между объектами определяет зависимости, которые некоторые объекты имеют в других объектах для доступа. Для клиентского приложения доступ к определенным объектам обеспечивает доступ к другим пользователям. В некоторых случаях отношение вложенности между объектами, реализуемыми поставщиком службы, соответствует логической иерархической структуре. В других случаях он является произвольным. 
  
Клиент должен получить доступ к объекту сеанса MAPI, прежде чем он сможет использовать многие другие объекты (например, поставщики услуг и адресная книга MAPI).
  
Вложение хранилища сообщений основано на иерархической связи между объектами в хранилище сообщений: самим объектом хранилища сообщений, папками, сообщениями и вложениями. Логически вложения хранятся в сообщениях, сообщениях в папках и папках в хранилище сообщений. Отношение вложения соответствует этой логической иерархии. Чтобы получить доступ к сообщению, например клиент должен получить доступ к папке, в которой находится сообщение. К объектам Profiles и Status относятся примеры более произвольного отношения вложенности. Оба эти объекта доступны через сеанс. 
  
С некоторыми объектами контейнеры предоставляют единственный доступ. Вложения и получатели — это примеры объектов, полностью зависящих от их контейнеров. Единственный доступ к вложению или получателю — через сообщение, к которому оно относится. Другие объекты имеют альтернативные пути доступа. Этим объектам присваиваются двоичные идентификаторы, называемые поставщиками услуг, которые создают их. Идентификаторы записей можно использовать для прямого доступа к своим объектам, что позволяет клиентам обходить дерево вложений. 
  
На следующем рисунке показана иерархия содержания MAPI. Сеанс находится в верхней части дерева, так как он проходит через сеанс, который клиент получает доступ ко всем остальным объектам. Следующий уровень включает таблицу хранилища сообщений, объект Table, который перечисляет свойства для всех поставщиков хранилища сообщений в текущем сеансе, и адресная книга для предоставления доступа всем поставщикам адресных книг. Таблица и адресная книга хранилища сообщений используются для доступа к объектам, реализованным определенными поставщиками услуг, показанными далее в порядке размещения.
  
**Иерархия вложений MAPI**
  
![Иерархия вложенИй MAPI] (media/amapi_41.gif "Иерархия вложенИй MAPI")
  
## <a name="see-also"></a>См. также

- [Общие сведения об объекте и интерфейсе MAPI](mapi-object-and-interface-overview.md)


---
title: HrQueryAllRows
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- HrQueryAllRows
api_type:
- HeaderDef
ms.assetid: b08fadcf-cdf3-48b7-9489-d7f745266482
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0f09304f21180d9ebc2a1e1dcc54ebadd3622804
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422896"
---
# <a name="hrqueryallrows"></a>HrQueryAllRows

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Извлекает все строки таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
HRESULT HrQueryAllRows(
  LPMAPITABLE ptable,
  LPSPropTagArray ptaga,
  LPSRestriction pres,
  LPSSortOrderSet psos,
  LONG crowsMax,
  LPSRowSet FAR * pprows
);
```

## <a name="parameters"></a>Parameters

 _ptable_
  
> [in] Указатель на таблицу MAPI, из которой извлекаются строки. 
    
 _ptaga_
  
> [in] Указатель на [структуру SPropTagArray,](sproptagarray.md) содержащий массив тегов свойств, указывающих столбцы таблиц. Эти теги используются для выбора определенных столбцов, которые будут извлечены. Если _параметром ptaga_ является NULL, **hrQueryAllRows** извлекает весь набор столбцов текущего представления таблицы, переданного в _параметре ptable._ 
    
 _pres_
  
> [in] Указатель на [структуру SRestriction,](srestriction.md) которая содержит ограничения на ирисовку. Если параметр  _pres_ NULL, **hrQueryAllRows** не создает ограничений. 
    
 _psos_
  
> [in] Указатель на [структуру SSortOrderSet,](ssortorderset.md) определяя порядок сортировки извлекаемой колонны. Если параметр  _psos_ — NULL, используется порядок сортировки по умолчанию для таблицы. 
    
 _crowsMax_
  
> [in] Максимальное количество строк, которые необходимо извлечь. Если значение параметра  _crowsMax_ нулевое, не устанавливается ограничение на количество извлеченных строк. 
    
 _pprows_
  
> [вышел] Указатель на указатель на возвращенную [структуру SRowSet,](srowset.md) которая содержит массив указателей к извлеченным строкам таблицы. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вызов извлек ожидаемые строки таблицы. 
    
MAPI_E_TABLE_TOO_BIG 
  
> Количество строк в таблице больше, чем число, переданного для _параметра crowsMax._ 
    
## <a name="remarks"></a>Примечания

Клиентские приложения или поставщик услуг не могут контролировать количество строк, которые **hrQueryAllRows** пытается получить, за исключением введения ограничения, на которое указывает параметр _pres._ Параметр  _crowsMax_ не ограничивает извлечение определенным количеством строк таблицы, а определяет максимальное количество памяти, доступной для удержания всех извлеченных строк. Единственной защитой от массового переполнения памяти является функция stopgap, предоставляемая установкой _crowsMax._ Возврат ошибок MAPI_E_TABLE_TOO_BIG означает, что в таблице содержится слишком много строк, которые должны быть одновременно в памяти. 
  
Таблицы, обычно небольшие, например таблица хранения сообщений или таблица поставщиков, обычно можно безопасно получить с **помощью HrQueryAllRows.** Таблицы с риском быть очень большими, например таблица содержимого или даже таблица получателей, должны быть пройдены в подразделах с помощью метода [IMAPITable::QueryRows.](imapitable-queryrows.md) 
  
Если какие-либо свойства таблицы не определены при призыве **HrQueryAllRows,** они возвращаются с помощью PT_NULL свойства и идентификатора PROP_ID_NULL 
  


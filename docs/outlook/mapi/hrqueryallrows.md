---
title: HrQueryAllRows
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- HrQueryAllRows
api_type:
- HeaderDef
ms.assetid: b08fadcf-cdf3-48b7-9489-d7f745266482
description: '���� ���������� ���������: 9 ����� 2015 �.'
ms.openlocfilehash: 5c62e5919c6e605aa4b60f48072996ed1fd4c355
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808694"
---
# <a name="hrqueryallrows"></a>HrQueryAllRows

  
  
**Применимо к**: Outlook 
  
Извлекает все строки из таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализованный:  <br/> |MAPI  <br/> |
|Вызывается:  <br/> |Клиентские приложения и поставщиков услуг  <br/> |
   
```cpp
HRESULT HrQueryAllRows(
  LPMAPITABLE ptable,
  LPSPropTagArray ptaga,
  LPSRestriction pres,
  LPSSortOrderSet psos,
  LONG crowsMax,
  LPSRowSet FAR * pprows
);
```

## <a name="parameters"></a>Parameters

 _pВ таблице_
  
> [in] Указатель в таблице MAPI, из которого извлекаются строк. 
    
 _ptaga_
  
> [in] Указатель на структуру [SPropTagArray](sproptagarray.md) , который содержит массив свойство теги, указывающее столбцов таблицы. Эти теги используются для выбора определенных столбцов нужно вернуть. Если параметр _ptaga_ имеет значение NULL, **HrQueryAllRows** получает набор целый столбец текущего представления таблицы, переданной в параметре _pВ таблице_ . 
    
 _веб-узла_
  
> [in] Указатель на структуру [SRestriction](srestriction.md) , содержащий извлечения ограничения. Если параметр _веб-узла_ имеет значение NULL, **HrQueryAllRows** делает без ограничений. 
    
 _параметров паролей_
  
> [in] Указатель на структуру [SSortOrderSet](ssortorderset.md) , определяющее порядок сортировки столбцов, нужно вернуть. Если параметр _параметров паролей_ имеет значение NULL, используется порядок сортировки по умолчанию для таблицы. 
    
 _crowsMax_
  
> [in] Максимальное число строк нужно вернуть. Если значение параметра _crowsMax_ равно нулю, устанавливается без ограничения на число извлекаемых строк. 
    
 _pprows_
  
> [out] Указатель на указатель на структуру возвращенные [SRowSet](srowset.md) , который содержит массив указатели на строки извлеченных таблицы. 
    
## <a name="return-value"></a>������������ ��������

ЗНАЧЕНИЕ S_OK 
  
> Вызов получить ожидаемый строк таблицы. 
    
MAPI_E_TABLE_TOO_BIG 
  
> Количество строк в таблице больше, чем значение, переданное для параметра _crowsMax_ . 
    
## <a name="remarks"></a>Замечания

Клиентское приложение или поставщик услуг не контролирует число строк, **HrQueryAllRows** пытается получить, отличное от, поскольку ограничение указывает параметр _веб-узла_ . Параметр _crowsMax_ не ограничивают извлечения на определенное количество строк в таблице, но вместо определяет максимальный объем памяти для хранения всех извлеченных строк. Только защиту от переполнения большой объем памяти — возможность временное, предоставленные параметру _crowsMax_. Возвращение ошибки MAPI_E_TABLE_TOO_BIG означает таблицы содержит слишком много строк, в течение которого будут храниться за один раз в памяти. 
  
Таблицы, которые обычно небольшие, например таблицы хранилища сообщений или таблицы поставщика, обычно можно безопасно извлечь с **HrQueryAllRows**. Таблицы риску большим, таких как содержимое таблицы или даже таблица получателей, следует обращаться в подразделах, с помощью метода [IMAPITable::QueryRows](imapitable-queryrows.md) . 
  
Если при вызове **HrQueryAllRows** любого свойства таблицы не определены, они возвращаются с типом свойства PT_NULL и идентификатор свойства PROP_ID_NULL 
  


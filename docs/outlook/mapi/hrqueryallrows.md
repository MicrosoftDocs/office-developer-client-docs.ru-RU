---
title: HrQueryAllRows
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- HrQueryAllRows
api_type:
- HeaderDef
ms.assetid: b08fadcf-cdf3-48b7-9489-d7f745266482
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0f09304f21180d9ebc2a1e1dcc54ebadd3622804
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422896"
---
# <a name="hrqueryallrows"></a>HrQueryAllRows

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Получает все строки таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Мапиутил. h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
HRESULT HrQueryAllRows(
  LPMAPITABLE ptable,
  LPSPropTagArray ptaga,
  LPSRestriction pres,
  LPSSortOrderSet psos,
  LONG crowsMax,
  LPSRowSet FAR * pprows
);
```

## <a name="parameters"></a>Параметры

 _птабле_
  
> возврата Указатель на таблицу MAPI, из которой извлекаются строки. 
    
 _птага_
  
> возврата Указатель на структуру [спроптагаррай](sproptagarray.md) , которая содержит массив тегов свойств, указывающих столбцы таблицы. Эти теги используются для выбора конкретных извлекаемых столбцов. Если параметр _птага_ имеет значение null, **хркуеряллровс** извлекает весь набор столбцов текущего представления таблицы, переданного в параметре _птабле_ . 
    
 _прес_
  
> возврата Указатель на структуру [срестриктион](srestriction.md) , которая содержит ограничения на получение. Если параметр _прес_ имеет значение null, **хркуеряллровс** не делает никаких ограничений. 
    
 _псос_
  
> возврата Указатель на структуру [ссортордерсет](ssortorderset.md) , определяющую порядок сортировки извлекаемых столбцов. Если параметр _псос_ имеет значение null, используется порядок сортировки по умолчанию для таблицы. 
    
 _кровсмакс_
  
> возврата Максимальное количество извлекаемых строк. Если значение параметра _кровсмакс_ равно нулю, не задано максимальное число извлеченных строк. 
    
 _ппровс_
  
> вышли Указатель на указатель на возвращаемую структуру [SRowSet](srowset.md) , содержащую массив указателей на извлеченные строки таблицы. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вызов получил ожидаемые строки таблицы. 
    
MAPI_E_TABLE_TOO_BIG 
  
> Количество строк в таблице больше, чем число, переданное для параметра _кровсмакс_ . 
    
## <a name="remarks"></a>Примечания

Клиентское приложение или поставщик услуг не могут управлять количеством строк, которые **хркуеряллровс** пытается получить, за исключением импосинг ограничения, на которые указывает параметр _прес_ . Параметр _кровсмакс_ не ограничивает извлечение определенным количеством строк таблицы, а определяет максимальный объем памяти, доступный для хранения всех извлеченных строк. Единственной защитой от значительного переполнения памяти является функция стопгап, предоставляемая параметром _кровсмакс_. Возвращаемое значение ошибки MAPI_E_TABLE_TOO_BIG означает, что таблица содержит слишком много строк для одновременного хранения в памяти. 
  
Таблицы, которые обычно небольшие, например, таблица хранилища сообщений или таблица поставщиков, обычно могут безопасно извлекаться с помощью **хркуеряллровс**. Таблицы под угрозой очень большого размера, например таблица содержимого или даже таблица получателей, должны проходить через подразделы с помощью метода [IMAPITable:: QueryRows](imapitable-queryrows.md) . 
  
Если какие-либо свойства таблицы не определены при вызове **хркуеряллровс** , они возвращаются с типом свойства PT_NULL и идентификатором свойства PROP_ID_NULL 
  


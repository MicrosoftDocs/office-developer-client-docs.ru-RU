---
title: HrQueryAllRows
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- HrQueryAllRows
api_type:
- HeaderDef
ms.assetid: b08fadcf-cdf3-48b7-9489-d7f745266482
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 0f09304f21180d9ebc2a1e1dcc54ebadd3622804
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33422896"
---
# <a name="hrqueryallrows"></a>HrQueryAllRows

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Извлекает все строки таблицы. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
HRESULT HrQueryAllRows(
  LPMAPITABLE ptable,
  LPSPropTagArray ptaga,
  LPSRestriction pres,
  LPSSortOrderSet psos,
  LONG crowsMax,
  LPSRowSet FAR * pprows
);
```

## <a name="parameters"></a>Параметры

 _ptable_
  
> [in] Указатель на таблицу MAPI, из которой извлекаются строки. 
    
 _ptaga_
  
> [in] Указатель на [структуру SPropTagArray,](sproptagarray.md) которая содержит массив тегов свойств, указывающих столбцы таблицы. Эти теги используются для выбора определенных столбцов, которые необходимо получить. Если параметр _ptaga_ имеет NULL, **HrQueryAllRows** извлекает весь набор столбцов текущего представления таблицы, переданного в _параметре ptable._ 
    
 _pres_
  
> [in] Указатель на [структуру SRestriction,](srestriction.md) которая содержит ограничения итерации. Если параметр  _pres_ имеет NULL, **HrQueryAllRows** не создает ограничений. 
    
 _psos_
  
> [in] Указатель на [структуру SSortOrderSet,](ssortorderset.md) определяя порядок сортировки извлекаемого столбца. Если параметр  _psos_ имеет значение NULL, используется порядок сортировки по умолчанию для таблицы. 
    
 _многофайтовая_
  
> [in] Максимальное число извлекаемых строк. Если значение параметра  _of themax_ — ноль, никакие ограничения на число извлекаемой строки не заданы. 
    
 _pprows_
  
> [out] Указатель на указатель на возвращенную структуру [SRowSet,](srowset.md) которая содержит массив указателей на полученные строки таблицы. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вызов извлек ожидаемые строки таблицы. 
    
MAPI_E_TABLE_TOO_BIG 
  
> Число строк в таблице больше, чем число, переданные для параметра _параметров ofMax._ 
    
## <a name="remarks"></a>Примечания

Клиентские приложения или поставщик службы не контролируют число строк **HrQueryAllRows,** которые пытается получить, за исключением наложенного ограничения, на которое указывает параметр _pres._ Параметра  _themax_ не ограничивает извлечение определенным количеством строк таблицы, а определяет максимальный объем памяти, доступный для удержания всех полученных строк. Единственная защита от переполнения памяти — это функция остановки, предоставляемая установкой _параметра settingsMax._ Возвращаемая ошибка MAPI_E_TABLE_TOO_BIG означает, что таблица содержит слишком много строк, которые необходимо одновременно удерживать в памяти. 
  
Обычно небольшие таблицы, такие как таблица хранения сообщений или таблица поставщика, обычно можно безопасно получить с помощью **HrQueryAllRows.** Таблицы с риском очень большого размера, такие как таблица содержимого или даже таблица получателей, следует обходить в подразделах с помощью метода [IMAPITable::QueryRows.](imapitable-queryrows.md) 
  
Если при вызвании **HrQueryAllRows** какие-либо свойства таблицы не определены, они возвращаются с типом PT_NULL и идентификатором PROP_ID_NULL 
  


---
title: Предоставление отчетов о проЧтении и непрочтении для поставщиков хранилищ сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9644b8c5-ecc0-4ea3-972a-2169c78b99e5
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 96546d3d766af398ff7acb50f4fc3a479b5668b2
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328513"
---
# <a name="providing-read-and-nonread-reports-for-message-store-providers"></a>Предоставление отчетов о проЧтении и непрочтении для поставщиков хранилищ сообщений

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Если поставщик хранилища сообщений может получать сообщения, он должен поддерживать отчеты о прочтении и отчеты о непрочтенных сообщениях, получаемых поставщиком хранилища сообщений. Если полученное сообщение содержит свойство **пр_реад_рецеипт_рекуестед** ([PidTagReadReceiptRequested](pidtagreadreceiptrequested-canonical-property.md)), а значение этого свойства равно true, то при открытии сообщения в хранилище сообщений необходимо отправить уведомление отправителю. Указывает, что сообщение прочитано. Аналогичным образом, если пользователь удаляет сообщение перед его открытием, то хранилище сообщений должно отправить ответ отправителю, указывая, что сообщение не было прочитано.
  
ВыПолнив эти отчеты, вы можете создать объект [iMessage: IMAPIProp](imessageimapiprop.md) , заполняя соответствующие свойства сообщения и отправив его в Диспетчер очереди MAPI так, как если бы сообщение поступило от пользователя. Для этого можно использовать метод [имаписуппорт:: ReadReceipt](imapisupport-readreceipt.md) . 
  
> [!NOTE]
> Если хранилище сообщений создает копии непрочитанного сообщения с непрочитанными или непрочтенными отчетами, необходимо принять специальные меры. Такие отчеты не должны создаваться при чтении пользователями копий сообщений, для которых были запрошены отчеты. При создании копии такого сообщения поставщик хранилища сообщений должен содержать флаги КЛЕАР_РН_ПЕНДИНГ и КЛЕАР_НРН_ПЕНДИНГ в вызовах [IMAPIFolder:: сетреадфлагс](imapifolder-setreadflags.md) и [iMessage:: сетреадфлаг](imessage-setreadflag.md). 
  
## <a name="see-also"></a>См. также



[���������� ��������� ���������](message-store-features.md)


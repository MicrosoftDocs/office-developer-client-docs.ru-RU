---
title: Профили MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 493c87a4-317d-47ec-850b-342cac59594b
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 3c6701f5b7f63fdc7d21b219a5588feb0580db48
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22579860"
---
# <a name="mapi-profiles"></a>Профили MAPI

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
В профиле хранятся сведения о поставщиках службы и службы сообщений, установленные на компьютере. Для каждого сеанса клиента во время входа выбирает один профиль, который описывает поставщики и служб, которые будут использоваться. Клиент можно выбрать из коллекции профилей и, при желании установить одно по умолчанию. Профиль по умолчанию является профиль, который выбран, автоматически при запуске сеанса и имеет без явного указания профиля клиента.
  
Также в этих разделах, вы найдете обсуждение кэш псевдонимов, которая хранится в двоичный поток.
  
- [Кэш псевдонимов](nickname-cache.md)
    
- [Поток автозаполнения](autocomplete-stream.md)
    
- [Синтаксический анализ двоичных файлов](http://portalvhds6gyn3khqwmgzd.blob.core.windows.net/files/NK2/NK2WithBinaryExample.pdf)
    
## <a name="profile-sections"></a>Разделы профилей

Профили, разделены на разделы, клиентов и поставщиков услуг доступа для отображения свойств профилей пользователей или для изменения конфигурации. Раздел профиля — это объект MAPI, который реализует интерфейс **IProfSect** , интерфейс, который является производным от **IMAPIProp** и не имеет дополнительных методов. Дополнительные сведения можно [IProfSect: IMAPIProp](iprofsectimapiprop.md). Только предназначен для работы с свойства профиля. Чтобы получить указатель **IProfSect** для определенного профиля, клиентов и поставщиков услуг используйте следующие методы. 
  
|||
|:-----|:-----|
|Клиенты могут вызывать:  <br/> |[IMAPISession::OpenProfileSection](imapisession-openprofilesection.md) <br/> |
|Можно вызвать поставщиков услуг:  <br/> |[IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) <br/> |
|Можно вызвать клиентов или поставщиков:  <br/> |[IProviderAdmin::OpenProfileSection](iprovideradmin-openprofilesection.md) <br/> |
   
Профили организованы иерархически намного как файл Mapisvc.inf. INF-файл. На верхнем уровне иерархии существует профилей разделы, содержащие сведения, относящиеся к профилю. Средний уровень включает разделы, содержащие сведения о службе конкретное сообщение и низкого уровня включает разделы, содержащие сведения об одном поставщиков услуг службы сообщений. 
  
Каждый профиль имеет несколько необходимые свойства, которые хранятся в одном или нескольких разделах профиля. Например каждый профиль имеет свойства **PR_SEARCH_KEY** ([PidTagSearchKey](pidtagsearchkey-canonical-property.md)) и **PR_PROFILE_NAME** ([PidTagProfileName](pidtagprofilename-canonical-property.md)). Ключ поиска профиля присвоено значение, определенное в MAPIGUID. Как MUID_PROFILE_INSTANCE и всегда гарантированно уникальным во всех профилей. Хотя для двух профилей может быть таким же именем, они не могут иметь один и тот же ключ поиска. Ключи поиска должны рассматриваться как двоичные данные вместо данных определенного типа.
  
Поставщики хранилища сообщений необходимы для включения свойство **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) их хранилища сообщений в разделах профиля для профиля и их сообщения поставщик хранилища и поддержания эти записи синхронизированы. При создании хранилища сообщений, Поставщик устанавливает **PR_DISPLAY_NAME** на основе значения, хранящиеся в этих разделах профилей. 
  
Существует два основных различия между разделах профилей и другие объекты, наследующие от **IMAPIProp**. 
  
- Разделы профиля не поддерживают транзакции.
    
- Разделы профиля не поддерживают именованные свойства, возвращение MAPI_E_NO_SUPPORT из их реализации **IMAPIProp::GetIDsFromNames** и **IMAPIProp::GetNamesFromIDs** . Для получения дополнительных сведений см [IMAPIProp::GetIDsFromNames](imapiprop-getidsfromnames.md) и [IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md).
    
Разделы профиля не поддерживают транзакции, все изменения, внесенные с помощью вызовов **IMAPIProp::CopyProps** **CopyTo**или **SetProps** сразу же вступают в силу. Для получения дополнительных сведений см [IMAPIProp::CopyProps](imapiprop-copyprops.md). Клиенты и поставщиков услуг можно вызвать метод **IMAPIProp::SaveChanges** раздела профиля и будет выполнена успешно, но не влияет на раздел данных профиля. Для получения дополнительных сведений см [IMAPIProp::SaveChanges](imapiprop-savechanges.md). Необходимости изменения происходят сразу же могут повлиять на способ реализации поставщиков услуг страницы свойств, которые клиенты будут использовать для отображения свойств профилей пользователей. Поставщики услуг, которые пользователи должны иметь возможность отложить или отменить изменения, необходимо реализовать их свойств с их копиями разделов профиля вместо настоящего раздела. С помощью копии пользователей можно внести изменения и более поздних версий отменить эти изменения, отправляемых из исходного разделах профиля без изменений. 
  
Порядок, в котором отображается информация в профиле влияет как MAPI настраивает ресурсы и делает назначения в сеансе. Следующие назначения, влияют профилей порядке:
  
- Хранение сообщений по умолчанию
    
- Личная адресная книга
    
- Путь поиска хранилища сообщений по умолчанию
    
- По умолчанию путь поиска адресной книги
    
- Порядок поставщика транспорта
    
MAPI задает хранилища сообщений по умолчанию, чтобы получить первого хранилища сообщений в профиль, который имеет флаг STATUS_DEFAULT_STORE в своем свойстве **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)), это означает, что она может быть хранилище по умолчанию. Клиенты могут переопределить этот параметр путем вызова **IMAPISession::SetDefaultStore**. Для получения дополнительных сведений см [IMAPISession::SetDefaultStore](imapisession-setdefaultstore.md).
  
MAPI создает заказ транспорта для обработки входящих и исходящих сообщений. Если более одного поставщика транспорта зарегистрировала для сообщения определенного типа, MAPI использует этот порядок для определения, какой поставщик должен обрабатывать сообщения. MAPI задает порядок транспорта порядку, в котором транспорта, которые поставщики были добавлены к профилю одно исключение — транспортов, установить флаг STATUS_XP_PREFER_LAST в своем свойстве **PR_RESOURCE_FLAGS** расположены последнего в порядке. Клиенты могут установить порядок транспорта путем вызова **IMsgServiceAdmin::MsgServiceTransportOrder**. Для получения дополнительных сведений см [IMsgServiceAdmin::MsgServiceTransportOrder](imsgserviceadmin-msgservicetransportorder.md).
  
В некоторых случаях могут конфликтовать этим правилам при заказе поставщиков услуг и службы сообщений. Если конфликт, код должен выполнять разрешение конфликта. Программы почты можно использовать для проверки профилей, созданный для определения, является ли поставщики были настроены должным.
  


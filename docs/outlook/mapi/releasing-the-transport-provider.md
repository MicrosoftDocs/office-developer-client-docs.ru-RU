---
title: Выпуск поставщика транспорта
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e0f37485-55c9-40f0-bc8c-48f7297f9f50
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: ea9656f9571777478d3db9a2613fbff5ddef0ee6
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22592292"
---
# <a name="releasing-the-transport-provider"></a>Выпуск поставщика транспорта

 
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
MAPI или диспетчер очереди MAPI завершении с помощью объекта транспорта входа:
  
1. MAPI или диспетчер очереди MAPI вызывает метод [IXPLogon::TransportLogoff](ixplogon-transportlogoff.md) поставщика транспорта. 
    
2. Поставщика транспорта признает недействительным состояние объекта путем вызова метода [IMAPISupport::MakeInvalid](imapisupport-makeinvalid.md) . Поставщика транспорта признает недействительным объекты сообщений, которые являются Предопределенная во время вызова **TransportLogoff** зависит от флаги, которые были переданы **TransportLogoff**.
    
3. Поставщика транспорта вызывает метод [функции IUnknown::Release](http://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) объект поддержки для удаления поставщика транспорта строки в таблице состояния и удалять из внутренних таблиц любого уникальных идентификаторов (UID), которые были заданы с [IMAPISupport:: SetProviderUID](imapisupport-setprovideruid.md) метод. Он уменьшает число объектов известные входа в систему, активных на этот объект поставщика. Если число достигает нуля, MAPI вызывает метод [IXPProvider::Shutdown](ixpprovider-shutdown.md) и **выпуске** на объекте поставщика. Если это последний объект известные поставщика, с помощью этой библиотеки DLL на этот процесс, MAPI вызывает функцию **FreeLibrary** на библиотеку DLL в дальнейшем. Освободить память для объекта поддержки MAPI и возвращает объект поддержки метод **выпуска** . 
    
4. Метод **TransportLogoff** возвращает значение S_OK. 
    
5. MAPI или диспетчер очереди MAPI вызывает **выпуска** для входа в систему объекта поставщика транспорта. Освобождается память для объекта. 
    
6. MAPI или диспетчер очереди MAPI вызывает **FreeLibrary** DLL-Библиотеки поставщика. 
    
Для надежности объекты поставщик и входа в систему должна появиться возможность обработки окончательной **версии** звонков на себя без необходимости их **TransportLogoff** или **Завершение работы** методов, вызываемых. Если **выпуск** вызывается в таких случаях, поставщиками транспорта следует считать вызовы вызова **TransportLogoff** или **Завершение работы** с аргументом ноль, а затем **выпуска**.
  


---
title: Выпуск поставщика транспорта
manager: soliver
ms.date: 12/07/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e0f37485-55c9-40f0-bc8c-48f7297f9f50
description: '���� ���������� ���������: 7 ������� 2015 �.'
ms.openlocfilehash: 41d953db8e00ff52cd09a27e2f7550f9f1879321
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32328387"
---
# <a name="releasing-the-transport-provider"></a>Выпуск поставщика транспорта

 
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
При завершении работы MAPI или диспетчера очереди MAPI с использованием объекта входа в систему:
  
1. MAPI или диспетчер очереди MAPI вызывает метод [иксплогон:: транспортлогофф](ixplogon-transportlogoff.md) поставщика транспорта. 
    
2. Поставщик транспорта делает недействительным объект status, вызывая метод [имаписуппорт:: макеинвалид](imapisupport-makeinvalid.md) . Указывает, является ли поставщик транспорта недействительным объекты сообщений, которые отправляются или принимаются во время вызова **транспортлогофф** , зависит от флагов, переданных в **транспортлогофф**.
    
3. Поставщик транспорта вызывает метод [IUnknown:: Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) объекта support, чтобы удалить строку поставщика транспорта из таблицы состояний и удалить из внутренних таблиц все уникальные идентификаторы (UID), заданные с помощью метода [Имаписуппорт:: сетпровидеруид](imapisupport-setprovideruid.md) . Он уменьшает количество известных объектов входа в систему, активных в данном объекте поставщика. Если значение счетчика достигнет нуля, то MAPI вызывает метод [иксппровидер:: Shutdown](ixpprovider-shutdown.md) и **Release** для объекта provider. Если это последний известный объект поставщика, использующий эту библиотеку DLL для этого процесса, MAPI вызывает функцию **FreeLibrary** в DLL позже. Память для объекта поддержки MAPI освобождается, и метод **Release** объекта support возвращает результат. 
    
4. Метод **транспортлогофф** возвращает S_OK. 
    
5. MAPI или диспетчер очереди MAPI вызывает **выпуск** для объекта входа поставщика транспорта. Освобождение памяти для объекта. 
    
6. MAPI или диспетчер очереди MAPI вызывает **FreeLibrary** для библиотеки DLL поставщика. 
    
Для надежности объекты входа и поставщика должны иметь возможность **обрабатывать окончательные** вызовы для себя, не выполняя вызов методов **транспортлогофф** или **Shutdown** . Если в таких случаях вызывается метод **Release** , поставщики транспорта должны обрабатывать вызовы, как если бы **транспортлогофф** или **Shutdown** были вызваны с нулевым аргументом, за которым следует **выпуск**.
  


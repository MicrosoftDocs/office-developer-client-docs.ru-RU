---
title: иксплогонстартмессаже
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPLogon.StartMessage
api_type:
- COM
ms.assetid: 83c349f7-dcac-4268-befe-fb2bc0cd9c50
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 00273d5572fa0c12a9501a1620db11ea087fd5d1
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33427607"
---
# <a name="ixplogonstartmessage"></a>IXPLogon::StartMessage

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Инициирует передачу входящего сообщения от поставщика транспорта в Диспетчер очереди MAPI.
  
```cpp
HRESULT StartMessage(
  ULONG ulFlags,
  LPMESSAGE lpMessage,
  ULONG FAR * lpulMsgRef
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> [in] ���������������; ������ ���� ����� ����.
    
 _лпмессаже_
  
> возврата Указатель на объект Message (представляющий входящее сообщение) с разрешениями на чтение и запись, который используется поставщиком транспорта для доступа к этому сообщению и управления им. Этот объект остается действительным до тех пор, пока поставщик транспорта не возвратит вызов в **иксплогон:: стартмессаже**.
    
 _лпулмсгреф_
  
> вышли Указатель на значение ссылки, назначенное сообщению. Диспетчер очереди MAPI Инициализирует это значение равным 1, прежде чем возвратить указатель поставщику транспорта.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������.
    
## <a name="remarks"></a>Примечания

Диспетчер очереди MAPI вызывает метод **иксплогон:: стартмессаже** для инициирования передачи входящего сообщения от поставщика транспорта в Диспетчер очереди MAPI. Прежде чем поставщик транспорта начнет использовать сообщение, на которое указывает _лпмессаже_, он должен хранить ссылку на сообщение в параметре _лпулмсгреф_ для возможного использования при вызове метода [иксплогон:: транспортнотифи](ixplogon-transportnotify.md) . 
  
Во время вызова **стартмессаже** Диспетчер очереди MAPI обрабатывает методы для объектов, открытых во время передачи сообщения, а также обрабатывает все вложения. Обработка может занять длительное время. Поставщики транспорта могут часто вызвать функцию обратного вызова [имаписуппорт:: спулериелд](imapisupport-spooleryield.md) для ДИСПЕТЧЕРА очереди MAPI во время этой обработки, чтобы освободить время ЦП для других системных задач. 
  
Все получатели в таблице получателей, которые создает поставщик транспорта для сообщения, должны содержать все необходимые свойства адресации. При необходимости поставщик может создать настраиваемого получателя для представления определенного получателя. Тем не менее, если поставщик может создать запись получателя с дополнительными сведениями, это необходимо сделать. Например, если у поставщика транспорта достаточно информации о формате получателя поставщика адресных книг, который может создать допустимый идентификатор записи для получателя в этом формате, он должен создать идентификатор записи.
  
Если получены какие – либо недопустимые свойства, поставщик транспорта не должен хранить их в новом сообщении. Тем не менее, поставщик транспорта должен хранить все получаемые в новом сообщении свойства для передачи.
  
Если входящее сообщение является отчетом о доставке или отчетом о недоставке, а поставщик транспорта не может использовать метод [имаписуппорт:: статусреЦипс](imapisupport-statusrecips.md) для создания отчета из исходного сообщения, то поставщик должен заполнить сообщение соответствующими свойствами. Однако поставщик транспорта не может задать свойство **PR_ENTRYID** сообщения ([PidTagEntryId](pidtagentryid-canonical-property.md)).
  
Чтобы сохранить входящее сообщение в соответствующем банке сообщений MAPI после обработки, поставщик транспорта вызывает метод [IMAPIProp:: SaveChanges](imapiprop-savechanges.md) . Если у поставщика транспорта нет сообщений для передачи в Диспетчер очереди MAPI, он может остановить входящее сообщение, выполнив возврат из вызова **стартмессаже** , не вызывая метод **SaveChanges**.
  
Все объекты, которые поставщик транспорта открывает при вызове **стартмессаже** , следует освободить перед возвратом. Однако поставщик не должен освобождать объект Message, который изначально передавался диспетчером очереди MAPI в параметре _лпмессаже_ . 
  
Если **стартмессаже** возвращает ошибку, то сообщение в процессе будет выпущено без сохранения изменений и потеряно. В этом случае поставщик транспорта должен передать флаг NOTIFY_CRITICAL_ERROR с вызовом метода [имаписуппорт:: спулернотифи](imapisupport-spoolernotify.md) и вызвать метод [иксплогон::P олл](ixplogon-poll.md) , чтобы УВЕДОМИТь Диспетчер очереди MAPI о критической ошибке. 
  
Для получения дополнительных сведений обратитесь к разделу [взаимодействие с диспетчером очереди MAPI](interacting-with-the-mapi-spooler.md). 
  
## <a name="see-also"></a>См. также



[IMAPIProp::SaveChanges](imapiprop-savechanges.md)
  
[IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md)
  
[IMAPISupport::SpoolerYield](imapisupport-spooleryield.md)
  
[IMAPISupport::StatusRecips](imapisupport-statusrecips.md)
  
[IMessage::GetRecipientTable](imessage-getrecipienttable.md)
  
[IXPLogon::Poll](ixplogon-poll.md)
  
[IXPLogon::TransportNotify](ixplogon-transportnotify.md)
  
[IXPLogon : IUnknown](ixplogoniunknown.md)


---
title: Открытие контейнер адресной книги
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 89383b27-618c-4ccb-9e16-f66235c98bfe
description: 'Последнее изменение: 08 ноября 2011 г.'
ms.openlocfilehash: 79f1f9254e69e1871e886fa0bb3fbb66e2aab128
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22590458"
---
# <a name="opening-an-address-book-container"></a>Открытие контейнер адресной книги

**Применимо к**: Outlook 2013 | Outlook 2016 
  
После открытия MAPI интегрированное адресную книгу, откройте один или несколько контейнеров адресной книги для доступа к получателям внутри них.
  
Чтобы открыть верхнего уровня контейнер адресной книги, вызовите [IAddrBook::OpenEntry](iaddrbook-openentry.md) с идентификатором записи NULL. 
  
Контейнеры адресной книги можно реализовать с помощью только для чтения или чтения и записи. Контейнеры только для чтения, используются только для просмотра. Чтение и запись контейнеров может быть изменено, позволяя клиентам для создания новых записей и удаления и изменения существующих записей. Все контейнеров адресной книге пользователя реализованы в виде контейнеров чтения и записи. 
  
Для открытия любого нижнего уровня контейнера, вызовите **OpenEntry** и укажите идентификатор записи контейнера для открытия. 
  
## <a name="open-the-container-designated-as-the-pab"></a>Откройте контейнер обозначены как личной адресной книги
  
1. Вызовите [IAddrBook::GetPAB](iaddrbook-getpab.md) , чтобы получить идентификатор записи адресной книги. 
    
2. Передайте этот идентификатор записи [IAddrBook::OpenEntry](iaddrbook-openentry.md).
    
## <a name="open-a-container-that-is-not-the-pab"></a>Откройте контейнер, который не является личной адресной книги
  
1. Вызов [IAddrBook::OpenEntry](iaddrbook-openentry.md) с идентификатором записи NULL для открытия корневой контейнер адресной книги. 
    
2. Вызовите метод [IMAPIContainer::GetHierarchyTable](imapicontainer-gethierarchytable.md) корневой контейнер для получения его иерархии таблицы — список всех контейнеров верхнего уровня в адресной книге. 
    
3. Если контейнер для открытия определенного типа:
    
   - Создайте структуру **SPropertyRestriction** с **PR_DISPLAY_TYPE** ([PidTagDisplayType](pidtagdisplaytype-canonical-property.md)) для тега свойства, типа контейнера значение свойства и RELOP_EQ для связи. **PR_DISPLAY_TYPE** можно установить множество значений, между ними. 
    
   - DT_GLOBAL для ограничения таблицы иерархии контейнеров, входящие в глобальном списке адресов.
    
   - DT_LOCAL для ограничения таблице для контейнеров, относящегося к локальной адресной книги.
    
   - DT_MODIFIABLE для ограничения таблице для контейнеров, которые могут быть изменены.
    
   - Создание структуры [SPropTagArray](sproptagarray.md) , который включает в себя **PR_ENTRYID**, **PR_DISPLAY_TYPE**и другие столбцы интересов. 
    
   - Вызовите [HrQueryAllRows](hrqueryallrows.md), передав ограничение свойства и свойства tag массива. **HrQueryAllRows** возвращает ноль или несколько строк, одна строка для каждого контейнера, к которой принадлежит указанный тип. Подготовиться к обработке return любое число строк. 
    
   - Вызов **IAddrBook::OpenEntry** с идентификатором записи из столбца **PR_ENTRYID** строку, которая представляет контейнер интересов. 
    
4. Если контейнер для открытия относится к определенным адресной книге:
    
   - Создайте структуру [SPropertyRestriction](spropertyrestriction.md) с **PR_AB_PROVIDERS** ([PidTagAbProviders](pidtagabproviders-canonical-property.md)) для тега свойства, значение от поставщика для значения свойства и RELOP_EQ для связи. Обычно значение от поставщика — это глобальный уникальный идентификатор или идентификатор GUID. Можно найти это значение, опубликованной в один из файлов заголовка поставщик адресной книги. 
    
   - Создание структуры [SPropTagArray](sproptagarray.md) , который включает в себя **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **PR_AB_PROVIDERS**и другие столбцы интересов. 
    
   - Вызовите [HrQueryAllRows](hrqueryallrows.md), передав ограничение свойства и свойства tag массива. **HrQueryAllRows** возвращает нуль строк, если поставщик указанного адресной книги не входит в профиле. Возвращается одна или несколько строк для контейнеров поставщика верхнего уровня, в зависимости от того, как организованы поставщика. 
    
   - Вызов [IAddrBook::OpenEntry](iaddrbook-openentry.md) с идентификатором записи из столбца **PR_ENTRYID** строку, которая представляет контейнер интересов. Если контейнер, в котором вы заинтересованы в не является контейнером верхнего уровня, найдите контейнер верхнего уровня и проходят через иерархии. 
    


---
title: Обработка входящего сообщения
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d45d5ed9-41cd-4aaf-91d2-1e4a27bb16d4
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: d6ec40005683cc67c51a63d6b186c042c8e170d7
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22568177"
---
# <a name="handling-an-incoming-message"></a>Обработка входящего сообщения

**Применимо к**: Outlook 2013 | Outlook 2016 
  
Входящее сообщение — это сообщение, отправленное в один или несколько систем обмена сообщениями. Он был отправлен только к вашему или к большому количеству получателей. Входящие сообщения помещаются в папку получения для хранения сообщения определенного класса. Вы можете настроить различные получать папки для каждого класса сообщений обработки или использование одной папки для всех классов.
  
Если вы зарегистрированы на уведомления о новой почте с помощью хранилища сообщений, каждый раз, когда сообщение помещается в папку получения уведомления. Если вы не зарегистрировали для новых почтовых уведомлений, необходимо открыть соответствующий получать папку периодически для вручную проверки поступления новых сообщений.
  
Клиенты регистрируются для уведомления о новой почте задав [IMsgStore::Advise](imsgstore-advise.md) параметры следующим образом: 
  
- _CbEntryID_ значение 0. 
    
- _LpEntryID_ значение NULL. 
    
- Значение _ulEventMask_ fnevNewMail. 
    
Указывает параметр _lpNotifications_ в вызове метода **IMAPIAdviseSink::OnNotify** **NEWMAIL\_уведомления** структуру, которая содержит сведения об входящего сообщения, такие как его класс сообщения, его запись Идентификатор записи идентификатор родительской папки и содержимое его свойство **PR_MESSAGE_FLAGS** . Дополнительные сведения о регистрации для и обработке уведомлений видеть [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) и [Обработки уведомлений](handling-notifications.md). 
  
Перед отображением входящее сообщение пользователю, определите его класс сообщения класса, поддерживающего вашего клиента. В противном случае проигнорировать. Если класс, который поддерживается, может открывать и отображать сообщение с формой, подходящую для класса сообщений для сообщения. Выбор форм основано на класс сообщения. Сообщения, которые относятся к классу IPM использовать формы по умолчанию, реализованный MAPI. Сообщения, которые принадлежат настраиваемые классы, определенные в клиентов можно использовать определенные клиента специализированных формы или формы MAPI по умолчанию.
  
## <a name="open-and-display-an-incoming-message"></a>Открытие и отображение входящих сообщений
  
1. Вызов **IMsgStore::GetReceiveFolder** для получения идентификатор записи папки получения для класса сообщений для сообщения и передайте этот идентификатор записи **IMsgStore::OpenEntry** , чтобы открыть папку. Для получения дополнительных сведений см [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md)и [Открытие папки хранения сообщений](opening-a-message-store-folder.md).
    
2. Вызов метода **IMAPIContainer::GetContentsTable** папку получения для получения его содержимое таблицы. Для получения дополнительных сведений см [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md). Вызовите метод **IMAPITable::QueryRows** таблицы, чтобы извлечь все строки в таблице. Для получения дополнительных сведений см [IMAPITable::QueryRows](imapitable-queryrows.md) и [Содержимое таблицы](contents-tables.md). Дополнительные сведения об отображении содержимого таблицы в разделе [Отображение Содержание папки](displaying-a-folder-contents-table.md).
    
3. Если ваш клиент является интерактивной, разрешает пользователю выберите сообщение из таблицы и определения формы, которые будут использоваться для отображения этого сообщения. Клиенты могут использовать формы по умолчанию, предоставленные MAPI или настраиваемую форму. Для получения дополнительных сведений см. [Обработка формы MAPI](handling-mapi-forms.md).
    
4. Вызовите **IMsgStore::OpenEntry** , чтобы открыть сообщение. Дополнительные сведения можно [Открыть сообщение](opening-a-message.md).
    
5. Процесс текста сообщения. Для получения дополнительных сведений см [Открывающий текста сообщения](opening-message-text.md).
    
6. Отображать каждый из вложений сообщений. Для получения дополнительных сведений см [визуализации вложение в обычный текст](rendering-an-attachment-in-plain-text.md) или [Отображение вложение в текст RTF](rendering-an-attachment-in-rtf-text.md).
    
7. Открывайте вложения, если это необходимо. Дополнительные сведения можно [открывать вложения](opening-an-attachment.md).
    
## <a name="in-this-section"></a>В этой статье

- [Текст сообщения открытия](opening-message-text.md): описывается, как открыть текста сообщения.
    
- [Отображение вложения в виде обычного текста](rendering-an-attachment-in-plain-text.md): описывается, как отобразить вложения в виде обычного текста.
    
- [Отображение вложение в текст RTF](rendering-an-attachment-in-rtf-text.md): описывается, как отобразить вложения в форматированный текст.
    
- [Открытие вложения](opening-an-attachment.md): описывается, как открыть вложение.
    


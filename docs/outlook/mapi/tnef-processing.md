---
title: Обработка TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4d324fb3-d917-4502-b3a4-179c479deb79
description: '���� ���������� ���������: 5 ���� 2012 �.'
ms.openlocfilehash: 066ad3dfb64161e326b92fef7774d5b3b9461d8a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32339601"
---
# <a name="tnef-processing"></a>Обработка TNEF

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В приведенной ниже последовательности действий описано, как транспорты используют методы TNEF для обработки исходящих и входящих сообщений.
  
 **Отправка сообщения, содержащего поток TNEF**
  
1. Обработка свойств сообщений, которые поддерживаются системой обмена сообщениями.
    
2. Пометка сообщения в определенном способе реализации, чтобы принимающий поставщик транспорта мог определить, что сообщение требует обработки TNEF. Например, поставщик транспорта TNEF, отправляющий в систему обмена сообщениями SMTP, может добавить настраиваемое поле заголовка, например "X-CONTAINS-TNEF", чтобы указать, что сообщение содержит данные TNEF.
    
3. Получите объект TNEF и используйте его для инкапсуляции свойств сообщений, не поддерживаемых системой обмена сообщениями, в поток TNEF.
    
4. Кодирование потока TNEF с помощью модели вложений системы обмена сообщениями. Например, если базовая модель вложений преобразуется в вложения uuencode и добавляет их в текст сообщения, то поставщик транспорта должен объединить поток TNEF в другое вложение. Поставщик транспорта также должен реализовать метод для распознавания вложения, которое содержит закодированный поток TNEF при получении сообщения. Стандартный способ пометить это вложение — присвоить файлу вложение имя WINMAIL. DAT ". Если ваш поставщик транспорта выполняет это, все другие поставщики транспорта с поддержкой TNEF, удовлетворяющие этому соглашению, смогут взаимодействовать с ним.
    
5. Используйте [итнеф:](itnefiunknown.md) методы интерфейса IUnknown для вставки тегов, описывающих положения вложений в тексте сообщения. 
    
6. Получите доступ к тексту сообщения с тегами с помощью методов [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) и отправьте его в систему обмена сообщениями. 
    
 **Извлечение инкапсулированных свойств**
  
1. Запишите свойства, поддерживаемые системой обмена сообщениями, в новое сообщение, включая текст сообщения с тегами, который содержит инкапсулированные свойства.
    
2. Декодирование потока TNEF из надлежащего вложения.
    
3. Декодирование любых других вложений и запись их в новые вложения MAPI сообщения.
    
4. Откройте поток TNEF для декодирования с помощью функции [опентнефстреамекс](opentnefstreamex.md) . 
    
5. Используйте метод [итнеф:: екстрактпропс](itnef-extractprops.md) для декодирования потока TNEF и записи инкапсулированных свойств в новое сообщение. Все зашифрованные свойства, которые являются дубликатами незакодированных свойств, будут перезаписывать незакодированные свойства при декодировании закодированных свойств. 
    
6. Используйте метод [итнеф:: опентагжедбоди](itnef-opentaggedbody.md) для синтаксического анализа текста сообщения, чтобы восстановить позиции вложений из тегов в тексте сообщения. 
    


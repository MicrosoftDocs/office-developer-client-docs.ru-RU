---
title: Обработка TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4d324fb3-d917-4502-b3a4-179c479deb79
description: '���� ���������� ���������: 5 ���� 2012 �.'
ms.openlocfilehash: e6b3ef7c7eb469a5de909d440e22e522218a41f8
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22569493"
---
# <a name="tnef-processing"></a>Обработка TNEF

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
Следующая последовательность действий описывают, как транспортов использовать методы TNEF для обработки входящих и исходящих сообщений.
  
 **Чтобы отправить сообщение, которое включает в себя поток TNEF**
  
1. Обработать свойства сообщений, поддерживаемые системой обмена сообщениями.
    
2. Пометить как сообщения в реализации конкретных способом, чтобы получающей поставщика транспорта можно определить, что сообщение требуется обработка TNEF. Например поставщика транспорта TNEF, отправка SMTP системы обмена сообщениями добавить настраиваемое поле заголовка как «X-содержит-TNEF» для указания, что сообщение содержит данные TNEF.
    
3. Получение объекта TNEF и используйте его для инкапсуляции свойства сообщений, не поддерживается системой обмена сообщениями в поток TNEF.
    
4. Кодирование поток TNEF, с помощью модели вложения системе обмена сообщениями. К примеру Если базовую модель вложений для вложений uuencode и добавить их в текст сообщения, затем поставщика транспорта необходимо uuencode поток TNEF в другой вложения. Поставщика транспорта, также необходимо реализовать метод для определения, какой вложение содержит зашифрованный поток TNEF при получении сообщения. Стандартный способ пометить это вложение — задайте для него файла вложения «WINMAIL. DAT». Если ваш поставщик транспорта делает это, других поставщиков включена поддержка формата TNEF транспорта, выполните эти соглашения могут взаимодействовать с ним.
    
5. Использование [ITnef: IUnknown](itnefiunknown.md) интерфейс методов для вставки теги, описывающее положения вложений сообщений в качестве текста сообщения. 
    
6. Доступ к текст с тегами сообщения с помощью методов [IStream](http://msdn.microsoft.com/en-us/library/aa380034%28VS.85%29.aspx) и отправьте его в системе обмена сообщениями. 
    
 **Для получения инкапсулированное свойства**
  
1. Написание свойств, доступных в системе обмена сообщениями в новые сообщения, включая текст с тегами сообщения, содержащий инкапсулированное свойства.
    
2. Декодирования поток TNEF из соответствующих прав вложения.
    
3. Декодирования другие вложения и записи их в новый вложений MAPI на сообщение.
    
4. Откройте в потоке TNEF для декодирования с помощью функции [OpenTnefStreamEx](opentnefstreamex.md) . 
    
5. Метод [ITnef::ExtractProps](itnef-extractprops.md) используется для декодирования TNEF потока и запись инкапсулированное свойств в новое сообщение. Любые закодированный свойства, которые дублируют nonencoded свойства будут перезаписаны nonencoded свойства при декодирование закодированный свойства. 
    
6. Используйте метод [ITnef::OpenTaggedBody](itnef-opentaggedbody.md) для анализа текста сообщения для восстановления положения вложения из теги в качестве текста сообщения. 
    


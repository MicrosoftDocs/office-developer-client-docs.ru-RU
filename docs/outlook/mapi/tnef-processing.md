---
title: Обработка TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4d324fb3-d917-4502-b3a4-179c479deb79
description: '���� ���������� ���������: 5 ���� 2012 �.'
ms.openlocfilehash: 066ad3dfb64161e326b92fef7774d5b3b9461d8a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32339601"
---
# <a name="tnef-processing"></a>Обработка TNEF

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
В следующей серии действий описано, как транспорт использует методы TNEF для обработки исходяющих и входящих сообщений.
  
 **Отправка сообщения, которое включает поток TNEF**
  
1. Обработать свойства сообщений, поддерживаемые системой обмена сообщениями.
    
2. Пометить сообщение определенным способом, чтобы принимающий поставщик транспорта мог определить, что сообщение требует обработки в TNEF. Например, поставщик транспорта TNEF, отправляющий сообщения в систему обмена сообщениями SMTP, может добавить настраиваемые поля, например X-CONTAINS-TNEF, чтобы указать, что сообщение содержит данные TNEF.
    
3. Получите объект TNEF и используйте его, чтобы инкапсулировать свойства сообщения, не поддерживаемые системой обмена сообщениями, в поток TNEF.
    
4. Кодировать поток TNEF с помощью модели вложений системы обмена сообщениями. Например, если моделью вложений является uuencode вложения и их приложение к тексту сообщения, то поставщик транспорта должен uuencode потока TNEF в другое вложение. Поставщик транспорта также должен реализовать метод для распознавания того, какое вложение содержит закодированный поток TNEF при приеме сообщения. Стандартный способ пометки этого вложения — предоставить ему имя файла вложения WINMAIL. DAT". Если ваш поставщик транспорта делает это, любые другие поставщики транспорта с поддержкой TNEF, которые следуют этому соглашению, смогут выполнять с ним межсервиаментное управление.
    
5. Используйте [методы интерфейса ITnef : IUnknown](itnefiunknown.md) для вставки тегов, описывающих положения вложений сообщений в тексте сообщения. 
    
6. Получить доступ к тексту помеченного сообщения с помощью [методов IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) и отправить его в систему обмена сообщениями. 
    
 **Извлечение инкапсулированных свойств**
  
1. Запишите свойства, поддерживаемые системой обмена сообщениями, в новое сообщение, включая помеченный текст сообщения, содержащий инкапсулированные свойства.
    
2. Декодировать поток TNEF из соответствующего вложения.
    
3. Декодировать любые другие вложения и записывать их в новые вложения MAPI в сообщении.
    
4. Откройте поток TNEF для декодирования с помощью [функции OpenTnefStreamEx.](opentnefstreamex.md) 
    
5. Используйте метод [ITnef::ExtractProps](itnef-extractprops.md) для декодирования потока TNEF и записи инкапсулированных свойств в новое сообщение. Все закодированные свойства, дублирующие незакодированные свойства, будут перезаписывать незакодированные свойства при декодировании закодированные свойства. 
    
6. Используйте метод [ITnef::OpenTaggedBody](itnef-opentaggedbody.md) для разбора текста сообщения для восстановления позиций вложений из тегов в тексте сообщения. 
    


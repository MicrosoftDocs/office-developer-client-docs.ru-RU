---
title: Обработка TNEF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 4d324fb3-d917-4502-b3a4-179c479deb79
description: '���� ���������� ���������: 5 ���� 2012 �.'
ms.openlocfilehash: 066ad3dfb64161e326b92fef7774d5b3b9461d8a
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32339601"
---
# <a name="tnef-processing"></a>Обработка TNEF

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
В следующей серии действий описывается, как транспорты используют методы TNEF для обработки исходяющих и входящих сообщений.
  
 **Отправка сообщения с потоком TNEF**
  
1. Обработать свойства сообщений, поддерживаемые системой обмена сообщениями.
    
2. Пометить сообщение определенным способом реализации, чтобы поставщик транспорта, получаюющий транспорт, мог определить, что сообщение требует обработки TNEF. Например, поставщик транспорта TNEF, отправляющий в систему обмена сообщениями SMTP, может добавить настраиваемую область загона, например "X-CONTAINS-TNEF", чтобы указать, что сообщение содержит данные TNEF.
    
3. Получение объекта TNEF и его использование для инкапсулации свойств сообщений, не поддерживаемых системой обмена сообщениями, в поток TNEF.
    
4. Кодировать поток TNEF с помощью модели вложений системы обмена сообщениями. Например, если в модели вложений вложены uuencode и они приложены к тексту сообщения, то поставщик транспорта должен uuencode поток TNEF в другое вложение. Поставщик транспорта также должен реализовать метод распознавания того, какое вложение содержит закодированный поток TNEF при приеме сообщения. Стандартный способ пометить это вложение — дать ему имя файла вложения "WINMAIL. DAT". Если ваш поставщик транспорта выполнит это, с ним смогут работать другие транспортные поставщики с поддержкой TNEF, которые следуют этой конвенции.
    
5. Используйте [методы интерфейса ITnef : IUnknown](itnefiunknown.md) для вставки тегов, описывающих позиции вложений сообщений в текст сообщения. 
    
6. Доступ к тексту сообщения с тегами с помощью [методов IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) и отправка его в систему обмена сообщениями. 
    
 **Извлечение инкапсулированных свойств**
  
1. Напишите свойства, поддерживаемые системой обмена сообщениями, в новое сообщение, включая помеченный текст сообщения, содержащий инкапсулированные свойства.
    
2. Расшифровка потока TNEF из правильного вложения.
    
3. Декодировать любые другие вложения и записывать их в новые вложения MAPI в сообщении.
    
4. Откройте поток TNEF для декодирования с помощью [функции OpenTnefStreamEx.](opentnefstreamex.md) 
    
5. Используйте [метод ITnef::ExtractProps](itnef-extractprops.md) для расшифровки потока TNEF и записи инкапсулированных свойств в новое сообщение. Все закодированные свойства, которые являются дубликатами некодируемых свойств, будут перезаписывать некодированные свойства при декодировании закодированные свойства. 
    
6. Используйте [метод ITnef::OpenTaggedBody](itnef-opentaggedbody.md) для разбора текста сообщения, чтобы восстановить позиции вложений из тегов в тексте сообщения. 
    


---
title: Имслогонадвисе
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMSLogon.Advise
api_type:
- COM
ms.assetid: a3c5d937-642b-463b-b5a0-5d099e651895
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: abe4867b965f05e781f931d2e72920474d007d78
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32317313"
---
# <a name="imslogonadvise"></a>IMSLogon::Advise

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Регистрирует объект с поставщиком хранилища сообщений для уведомлений об изменениях в хранилище сообщений. После этого хранилище сообщений будет отправлять уведомления об изменениях в зарегистрированном объекте.
  
```cpp
HRESULT Advise(
  ULONG cbEntryID,
  LPENTRYID lpEntryID,
  ULONG ulEventMask,
  LPMAPIADVISESINK lpAdviseSink,
  ULONG FAR * lpulConnection
);
```

## <a name="parameters"></a>Параметры

 _Кбентрид_
  
> возврата Размер (в байтах) идентификатора записи, на который указывает параметр _лпентрид_ . 
    
 _Лпентрид_
  
> возврата Указатель на идентификатор записи объекта, для которого необходимо создать уведомления. Этот объект может быть папкой, сообщением или любым другим объектом в хранилище сообщений. Кроме того, если MAPI задает для параметра _кбентрид_ значение 0 и передает **значение NULL** для _лпентрид_, приемник уведомлений предоставляет уведомления об изменениях во всем хранилище сообщений.
    
 _Улевентмаск_
  
> возврата Маска событий типов событий уведомления, происходящих для объекта, сведения о том, какие MAPI будут создавать уведомления. Маска фильтрует конкретные варианты. С каждым типом события связана структура, содержащая дополнительные сведения о событии. В следующей таблице приведены возможные типы событий и соответствующие им структуры.
    
|**Тип события уведомления**|**Соответствующая структура**|
|:-----|:-----|
|Фневкритикалеррор  <br/> |[ERROR_NOTIFICATION](error_notification.md) <br/> |
|Фневневмаил  <br/> |[NEWMAIL_NOTIFICATION](newmail_notification.md) <br/> |
|Фневобжекткреатед  <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|Фневобжектделетед  <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|Фневобжектмодифиед  <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|Фневобжекткопиед  <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|Фневобжектмовед  <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|Фневсеарчкомплете  <br/> |[OBJECT_NOTIFICATION](object_notification.md) <br/> |
|Фневстатусобжектмодифиед  <br/> |[STATUS_OBJECT_NOTIFICATION](status_object_notification.md) <br/> |
   
 _Лпадвисесинк_
  
> возврата Указатель на объект приемника уведомлений, который вызывается при возникновении события для объекта Session, для которого было запрошено уведомление. Этот объект приемника уведомлений должен уже существовать.
    
 _Лпулконнектион_
  
> вышли Указатель на переменную, которая после успешного возврата содержит номер подключения для регистрации уведомления. Номер подключения должен быть ненулевым.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> ����� ������� � ������ ��������� ��������� ��� ��������.
    
МАПИ_Е_НО_СУППОРТ 
  
> Эта операция не поддерживается MAPI или одним или несколькими поставщиками услуг.
    
## <a name="remarks"></a>Замечания

Поставщики хранилища сообщений реализуют метод **имслогон:: Advise** для регистрации объекта для обратных вызовов уведомлений. При каждом изменении указанного объекта поставщик проверяет, какой бит маски события был задан в параметре _улевентмаск_ , и, соответственно, какого типа произошло изменение. Если задан бит, поставщик вызывает метод [имапиадвисесинк:: OnNotify](imapiadvisesink-onnotify.md) для объекта приемника уведомлений, указанного параметром _лпадвисесинк_ , чтобы сообщить о событии. Данные, переданные в структуру уведомлений в **** подпрограмму OnNotify, описывают событие. 
  
Вызов onNotify **** может выполняться во время вызова, который изменяет объект или в любое время позже. В системах, поддерживающих несколько потоков выполнения, вызов onNotify **** может выполняться в любом потоке. Для безопасной обработки вызовов onNotify **** , которые могут произойти во время иноппортуне, клиентское приложение должно использовать функцию [хрсиссреададвисесинк](hrthisthreadadvisesink.md) . 
  
Для предоставления уведомлений поставщик хранилища сообщений, который реализует **advise** , должен хранить копию указателя на объект приемника уведомлений _лпадвисесинк_ ; для этого поставщик вызывает метод [IUnknown:: AddRef](https://msdn.microsoft.com/library/ms691379%28v=VS.85%29.aspx) для приемника уведомлений, чтобы сохранить указатель на объект до тех пор, пока регистрация уведомлений не будет отменена с помощью вызова метода [имслогон:: unadvise](imslogon-unadvise.md) . При реализации **рекомендаций** необходимо назначить номер подключения для регистрации уведомлений и **AddRef** вызовов для этого номера подключения, прежде чем возвратить его в параметре _лпулконнектион_ . Поставщики услуг могут освободить объект приемника уведомлений, прежде чем регистрация будет отменена, но не должна освобождать номер подключения, пока не будет вызвано предложение **unadvise** . 
  
После успешного вызова метода **advise** и вызова метода **unadvise** поставщики должны подготовиться к выпуску объекта приемника уведомлений. Таким образом, поставщик должен освободить объект приемника уведомлений после **** возврата, если для него не задано конкретное долговременное использование. 
  
Дополнительные сведения о процессе уведомления можно найти в статье [уведомление о событии в MAPI](event-notification-in-mapi.md). 
  
## <a name="see-also"></a>См. также



[HrThisThreadAdviseSink](hrthisthreadadvisesink.md)
  
[IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md)
  
[IMSLogon::Unadvise](imslogon-unadvise.md)
  
[�����������](notification.md)
  
[IMSLogon : IUnknown](imslogoniunknown.md)


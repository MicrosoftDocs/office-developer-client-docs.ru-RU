---
title: Разделы поставщика службы MapiSvc. INF
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: ab17dcf2-409b-4a57-9cc4-5794f995cd3e
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: ea192ec6356cc3b929bf8379567144d3a54223f2
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405564"
---
# <a name="mapisvcinf-service-provider-sections"></a>Разделы поставщика службы MapiSvc. INF

**Относится к**: Outlook 2013 | Outlook 2016 
  
Mapisvc. inf содержит один раздел поставщика услуг для каждой записи, указанной в записи **поставщиков** в предыдущем разделе Services messages. Разделы поставщика **услуг** аналогичны разделам службы сообщений, в которых разделы обоих типов содержат записи в следующем формате: 
  
**тег свойства** = значение свойства 
  
Тем не менее разделы "поставщик услуг" и "Служба сообщений" отличаются в том, что такие записи свойств относятся только к типам записей, включенным в разделы поставщика услуг. Для поставщиков услуг не может быть дополнительных или связанных разделов; все сведения о поставщиках услуг должны содержаться в одном разделе. 
  
Некоторые свойства, заданные в разделах службы сообщений, также задаются в разделах поставщика услуг, так как эти свойства имеют смысл для обоих типов. В качестве примера используется свойство **пр_дисплай_наме** . Оба поставщика услуг и службы сообщений имеют имя, используемое для отображения в пользовательском интерфейсе конфигурации. В зависимости от поставщика услуг это имя может быть и не совпадать. Другие свойства относятся только к поставщикам услуг. 
  
К типичным разделам поставщика услуг относятся следующие записи, которые являются обязательными:
  
**** =  _Строка_ пр_дисплай_наме
  
**** =  _Строка_ пр_провидер_дисплай
  
**Пр_провидер_длл_наме** =  _имя файла DLL_
  
**Пр_ресаурце_типе** =  _Long_
  
**** =  _Битовая маска_ пр_ресаурце_флагс
  
Запись **пр_провидер_длл_наме** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)) похожа на **пр_сервице_длл_наме**; Он указывает имя файла DLL, содержащего поставщика услуг. Код службы сообщений может храниться в одном из поставщиков услуг в том же файле DLL или в виде отдельной библиотеки DLL. Обратите внимание, что суффикс не включается в запись независимо от целевой платформы; При необходимости в MAPI позаботится о добавлении суффикса. 
  
**Пр_ресаурце_типе** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) запись представляет тип поставщика услуг; поставщики услуг присвойте ему соответствующую предварительно определенную константу. Допустимые значения: МАПИ_СТОРЕ_ПРОВИДЕР, МАПИ_ТРАНСПОРТ_ПРОВИДЕР и МАПИ_АБ_ПРОВИДЕР.
  
Другая запись свойства, которая применяется как к службам сообщений, так и к поставщикам услуг, запись **пр_ресаурце_флагс** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) указывает на параметры. Параметры этой записи свойства могут различаться в зависимости от поставщика услуг. Например, некоторые поставщики хранилищ сообщений могут установить **пр_ресаурце_флагс** в статус_но_дефаулт_сторе, если они никогда не работают в качестве хранилища сообщений по умолчанию. 
  
Ниже приведены три примера разделов поставщиков услуг. Раздел **[поставщик адресной книги]** является разделом поставщика услуг для службы адресной книги по умолчанию. Разделы **[Мсгсервице Prov1]** и **[мсгсервице Prov2]** принадлежат моей собственной службе; Первый является разделом поставщика адресных книг, а вторым — разделом "поставщик хранилища сообщений". 
  
```cpp
[AB Provider]
PR_DISPLAY_NAME=Default Address Book
PR_PROVIDER_DISPLAY=Default Address Book
PR_PROVIDER_DLL_NAME=AB.DLL
PR_RESOURCE_TYPE=MAPI_AB_PROVIDER
6600001e=C:\WINNT35\System32\DEFAB.TXT
[MsgService Prov1]
PR_DISPLAY_NAME=My Own Service
PR_PROVIDER_DISPLAY=My Own Address Book
PR_PROVIDER_DLL_NAME=MYXXX.DLL
PR_RESOURCE_TYPE=MAPI_AB_PROVIDER
[MsgService Prov2]
PR_DISPLAY_NAME=My Folders
PR_PROVIDER_DISPLAY=My Own Message Store
PR_RESOURCE_TYPE=MAPI_STORE_PROVIDER
PR_PROVIDER_DLL_NAME=MYZZZ.DLL
PR_RESOURCE_FLAGS=STATUS_NO_DEFAULT_STORE
66060003=00000000
66030003=00000000
34140102=78b2fa70aff711cd9bc800aa002fc45a
66090003=06000000
660A0003=03000000

```



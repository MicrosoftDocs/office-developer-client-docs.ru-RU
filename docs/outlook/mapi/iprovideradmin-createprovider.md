---
title: ипровидерадминкреатепровидер
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IProviderAdmin.CreateProvider
api_type:
- COM
ms.assetid: 80c1449a-6cd9-4b93-a300-395979894b71
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 72dddca5a8079374600e05b96a24cbbc25e7f7f9
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33430807"
---
# <a name="iprovideradmincreateprovider"></a>IProviderAdmin::CreateProvider

**Относится к**: Outlook 2013 | Outlook 2016 
  
Добавляет поставщика услуг в службу сообщений. 
  
```cpp
HRESULT CreateProvider(
  LPSTR lpszProvider,
  ULONG cValues,
  LPSPropValue lpProps,
  ULONG_PTR ulUIParam,
  ULONG ulFlags,
  MAPIUID FAR * lpUID
);
```

## <a name="parameters"></a>Параметры

 _лпсзпровидер_
  
> возврата Указатель имени добавляемого поставщика.
    
 _квалуес_
  
> возврата Количество значений свойств, на которые указывает параметр _лппропс_ . 
    
 _лппропс_
  
> возврата Указатель на массив значений свойств, описывающий свойства поставщика, который требуется добавить.
    
 _улуипарам_
  
> возврата Дескриптор родительского окна любых диалоговых окон или окон, которые отображает этот метод. Параметр _улуипарам_ используется, если установлен флаг MAPI_DIALOG в параметре _ulFlags_ . 
    
 _ulFlags_
  
> возврата Битовая маска флагов, управляющих добавлением поставщика. Можно задать следующие флаги:
    
  - MAPI_DIALOG: отображает диалоговое окно с запросом сведений о конфигурации.
      
  - MAPI_UNICODE: имя поставщика и строковые свойства имеют формат Юникод. Если флаг MAPI_UNICODE не установлен, эти строки представлены в формате ANSI.
    
 _лпуид_
  
> вышли Указатель на структуру [мапиуид](mapiuid.md) , которая содержит уникальный идентификатор, представляющий поставщика, которого требуется добавить. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Поставщик успешно добавлен в службу сообщений.
    
MAPI_E_USER_CANCEL 
  
> Пользователь отменил операцию, как правило, нажав кнопку **Отмена** в диалоговом окне. 
    
## <a name="remarks"></a>Примечания

Метод **ипровидерадмин:: креатепровидер** добавляет поставщика услуг в службу сообщений. Параметр _лпсзпровидер_ должен указать имя поставщика, который принадлежит службе сообщений. **Креатепровидер** не проверяет, совпадает ли имя с именем поставщика в службе; Если переданное имя не отвечает имени службы, вызов завершается успешно, но результаты непредсказуемы. Большинство служб сообщений не допускают Добавление или удаление поставщиков при использовании профиля. 
  
После того как все доступные сведения о поставщике услуг добавлены в профиль из файла Mapisvc. INF, **креатепровидер** вызывает функцию точки входа службы сообщений с параметром _улконтекст_ , равным MSG_SERVICE_PROVIDER_CREATE. Если MAPI_DIALOG задается в параметре _ulFlags_ метода **креатепровидер** , значения в параметрах _улуипарам_ и _ulFlags_ также передаются в функцию точки входа. Эти дополнительные параметры позволяют поставщику услуг отображать свой лист свойств, чтобы пользователь мог вводить параметры конфигурации. 
  
## <a name="see-also"></a>См. также

- [MAPIUID](mapiuid.md)  
- [MSGSERVICEENTRY](msgserviceentry.md)  
- [SPropValue](spropvalue.md)  
- [IProviderAdmin : IUnknown](iprovideradminiunknown.md)


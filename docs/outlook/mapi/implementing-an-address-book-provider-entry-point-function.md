---
title: Реализация функции точки входа для поставщика адресных книг
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9375b351-1c84-4728-bcdf-e3e7a44820ed
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 00b3b30101ee1efb984cf45afb35b0b085d545ac
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409715"
---
# <a name="implementing-an-address-book-provider-entry-point-function"></a>Реализация функции точки входа для поставщика адресных книг

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Когда клиентское приложение вызывает [мапилогонекс](mapilogonex.md) для запуска сеанса с использованием профиля, содержащего поставщика адресных книг, MAPI загружает поставщика и все остальные, которые являются частью профиля. Сведения о имени функции точки входа поставщика MAPI просматриваются в профиле. Помните, что эта функция отличается от функции точки входа DLL; в документации по Win32 вы найдете документацию по функции **DllMain** . 
  
Существует несколько записей, некоторые из которых должны присутствовать в файле конфигурации Mapisvc. INF, которые включены в раздел profile каждого поставщика адресных книг. В следующей таблице перечислены эти записи разделов профиля, а также указывается, следует ли включать файл Mapisvc. INF.
  
|**Запись раздела профиля**|**требование к Mapisvc. INF**|
|:-----|:-----|
|PR_DISPLAY_NAME = _строка_ <br/> |Необязательна  <br/> |
|PR_PROVIDER_DISPLAY = _строка_ <br/> |Обязательна  <br/> |
|PR_PROVIDER_DLL_NAME = _имя файла DLL_ <br/> |Обязательна  <br/> |
|PR_RESOURCE_TYPE = _Long_ <br/> |Обязательна  <br/> |
|PR_RESOURCE_FLAGS = _Битовая маска_ <br/> |Необязательна  <br/> |
   
Поставщик адресных книг может поместить эту информацию в профиль напрямую, вызвав метод [IMAPIProp:: SetProps](imapiprop-setprops.md) в разделе profile или опосредованно, изменив Mapisvc. INF. Профили создаются с использованием соответствующих сведений в MAPISVC. INF для выбранных поставщиков услуг или служб сообщений. Для получения дополнительных сведений об организации и содержимом MAPISVC. INF-файла см. в разделе [Формат файла MapiSvc. INF](file-format-of-mapisvc-inf.md).
  
Имя функции точки входа DLL поставщика адресных книг должно быть [абпровидеринит](abproviderinit.md) и должно соответствовать прототипу **абпровидеринит** . Выполните следующие задачи в функции точки входа DLL поставщика: 
  
- Проверьте версию интерфейса поставщика услуг (SPI), чтобы убедиться, что протокол MAPI использует версию, совместимую с версией, используемой поставщиком адресной книги.
    
- Создание экземпляра объекта поставщика адресных книг.
    
Не вызывайте ни **мапиинитиализе** , ни **мапиунинитиализе** в этой функции. 
  
Функция точки входа DLL создает экземпляр объекта поставщика и возвращается в MAPI указателем на этот объект. 
  


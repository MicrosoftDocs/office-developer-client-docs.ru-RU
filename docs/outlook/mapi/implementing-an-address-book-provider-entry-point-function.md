---
title: Реализация функции точки входа для поставщика адресной книги
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9375b351-1c84-4728-bcdf-e3e7a44820ed
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 68ba23e6ab23ff7306cd1326b73512b1c9f2a0f9
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22579678"
---
# <a name="implementing-an-address-book-provider-entry-point-function"></a>Реализация функции точки входа для поставщика адресной книги

  
  
**Применимо к**: Outlook 2013 | Outlook 2016 
  
При клиентского приложения вызовы [MAPILogonEx](mapilogonex.md) для начала сеанса с использованием профиля, содержащего адресной книге, MAPI загружает поставщика и все остальные, которые являются частью профиля. Имя функции точки входа вашего поставщика анализирует MAPI, изучив в профиле. Помните, что эта функция не то же, что функция точки входа DLL; Обратитесь к документации по **DllMain** в документации по Win32. 
  
Существует несколько записей, некоторые из них, которые должны встречаться в файле конфигурации mapisvc.inf, включенные в разделе профиль каждый поставщик адресной книги. В следующей таблице перечислены эти записи раздела профиля и того, является ли их необходимо включить файла mapisvc.inf.
  
|**Запись раздела профиля**|**требование Mapisvc.inf**|
|:-----|:-----|
|PR_DISPLAY_NAME = _строка_ <br/> |Optional  <br/> |
|PR_PROVIDER_DISPLAY = _строка_ <br/> |Обязательный  <br/> |
|PR_PROVIDER_DLL_NAME = _имя DLL-файла_ <br/> |Обязательный  <br/> |
|PR_RESOURCE_TYPE = _длинный_ <br/> |Обязательный  <br/> |
|PR_RESOURCE_FLAGS = _битовой маски_ <br/> |Optional  <br/> |
   
Поставщик адресной книги можно поместить эти сведения в профиль непосредственно путем вызова метода [IMAPIProp::SetProps](imapiprop-setprops.md) раздела профиля или косвенно, изменяя MAPISVC.INF. Профили создаются с помощью информацию в файл Mapisvc.inf. INF для выбранных поставщиков или службы сообщений. Дополнительные сведения об организации и содержимое файл Mapisvc.inf. INF, просмотрите [Файл формата MapiSvc.inf](file-format-of-mapisvc-inf.md).
  
Имя функции точки входа DLL вашей адресной книге должно быть [ABProviderInit](abproviderinit.md) , и он должен соответствовать типу прототип **ABProviderInit** . В ваш поставщик функцию точки входа DLL выполните следующие задачи: 
  
- Проверка версии интерфейс поставщика службы (SPI), чтобы убедиться в том, что используется версия, совместимый с версией, которая использует ваш поставщик адресной книги MAPI.
    
- Создайте экземпляр объекта поставщик адресной книги.
    
Не вызывайте **MAPIInitialize** или **MAPIUninitialize** в этой функции. 
  
Функции точки входа DLL создает экземпляр объекта поставщика и возвращает указатель на этот объект MAPI. 
  


---
title: Реализация функции точки входа поставщика адресных книг
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9375b351-1c84-4728-bcdf-e3e7a44820ed
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 00b3b30101ee1efb984cf45afb35b0b085d545ac
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409715"
---
# <a name="implementing-an-address-book-provider-entry-point-function"></a>Реализация функции точки входа поставщика адресных книг

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Когда клиентская заявка вызывает [MAPILogonEx](mapilogonex.md) для начала сеанса с помощью профиля, содержашего поставщика адресной книги, MAPI загружает поставщика и всех других пользователей, которые являются частью профиля. MAPI узнает имя функции точки входа поставщика, посмотрев в профиле. Помните, что эта функция не такая, как функция точки входа DLL; см. документацию **для DllMain в** документации Win32. 
  
Существует несколько записей, некоторые из которых должны отображаться в файле конфигурации mapisvc.inf, которые включены в раздел профилей каждого поставщика адресной книги. В следующей таблице перечислены эти записи раздела профилей и должны ли они включаться в файл mapisvc.inf.
  
|**Запись раздела "Профиль"**|**требование mapisvc.inf**|
|:-----|:-----|
|PR_DISPLAY_NAME= _строка_ <br/> |Необязательный  <br/> |
|PR_PROVIDER_DISPLAY= _строка_ <br/> |Обязательный  <br/> |
|PR_PROVIDER_DLL_NAME= _имя файла DLL_ <br/> |Обязательный  <br/> |
|PR_RESOURCE_TYPE= _длинный_ <br/> |Обязательный  <br/> |
|PR_RESOURCE_FLAGS= _bitmask_ <br/> |Необязательный  <br/> |
   
Поставщик адресной книги может непосредственно разместить эти сведения в профиле, позвонив в метод [IMAPIProp::SetProps](imapiprop-setprops.md) или косвенно, изменяя MAPISVC.INF. Профили строятся с использованием соответствующих сведений в MAPISVC. INF для выбранных поставщиков или служб сообщений. Дополнительные сведения об организации и содержимом MAPISVC. INF, [см. формат файла MapiSvc.inf](file-format-of-mapisvc-inf.md).
  
Имя функции точки входа поставщика адресной книги должно быть [ABProviderInit](abproviderinit.md) и соответствовать прототипу **ABProviderInit.** Выполните следующие задачи в функции точки входа DLL поставщика: 
  
- Проверьте версию интерфейса поставщика услуг (SPI), чтобы убедиться, что MAPI использует версию, совместимую с версией, которую использует поставщик адресных книг.
    
- Мгновенный доступ к объекту поставщика адресной книги.
    
Не вызывай **MAPIInitialize или** **MAPIUninitialize в** этой функции. 
  
Функция точки входа DLL мгновенно передает объект поставщика и возвращает в MAPI указатель на этот объект. 
  


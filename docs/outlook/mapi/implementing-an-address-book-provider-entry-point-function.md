---
title: Реализация функции точки входа поставщика адресной книги
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 9375b351-1c84-4728-bcdf-e3e7a44820ed
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 00b3b30101ee1efb984cf45afb35b0b085d545ac
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33409715"
---
# <a name="implementing-an-address-book-provider-entry-point-function"></a>Реализация функции точки входа поставщика адресной книги

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Когда клиентские приложения вызывает [MAPILogonEx](mapilogonex.md) для начала сеанса с использованием профиля, содержашего поставщика адресной книги, MAPI загружает поставщика и всех остальных, которые являются частью профиля. MAPI узнает об имени функции точки входа поставщика, изучив профиль. Помните, что эта функция не то же самое, что функция точки входа DLL; см. документацию **по DllMain** в документации win32. 
  
Существует несколько записей, некоторые из которых должны отображаться в файле конфигурации mapisvc.inf, которые включены в раздел профиля каждого поставщика адресной книги. В следующей таблице перечислены эти записи раздела профиля, а также их необходимо включить в файл mapisvc.inf.
  
|**Запись раздела профиля**|**Требование mapisvc.inf**|
|:-----|:-----|
|PR_DISPLAY_NAME= _строка_ <br/> |Необязательна  <br/> |
|PR_PROVIDER_DISPLAY= _string_ <br/> |Обязательна  <br/> |
|PR_PROVIDER_DLL_NAME= _имя файла DLL_ <br/> |Обязательна  <br/> |
|PR_RESOURCE_TYPE= _long_ <br/> |Обязательна  <br/> |
|PR_RESOURCE_FLAGS= _битоваяmask_ <br/> |Необязательна  <br/> |
   
Поставщик адресной книги может напрямую разместить эти сведения в профиле, вызывая метод [IMAPIProp::SetProps](imapiprop-setprops.md) его раздела профиля или косвенно, изменяя MAPISVC.INF. Профили построены с использованием соответствующей информации в MAPISVC. INF для выбранных поставщиков услуг или служб сообщений. Дополнительные сведения об организации и содержимом MAPISVC. INF, [см. формат файла MapiSvc.inf](file-format-of-mapisvc-inf.md).
  
Имя функции точки входа DLL поставщика адресной книги должно быть [ABProviderInit](abproviderinit.md) и соответствовать прототипу **ABProviderInit.** Выполните следующие задачи в функции точки входа DLL поставщика: 
  
- Проверьте версию интерфейса поставщика услуг (SPI), чтобы убедиться, что MAPI использует версию, совместимую с версией, используемой поставщиком адресной книги.
    
- Instantiate an address book provider object.
    
Не вызывай **MAPIInitialize** или **MAPIUninitialize в** этой функции. 
  
Функция точки входа DLL возвращает объект поставщика и возвращает MAPI указатель на этот объект. 
  


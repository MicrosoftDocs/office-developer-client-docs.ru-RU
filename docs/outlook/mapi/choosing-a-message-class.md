---
title: Выбор класса сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f1e604120041e9d91d06276fabb2e9dd7505df51
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808193"
---
# <a name="choosing-a-message-class"></a><span data-ttu-id="8cf13-103">Выбор класса сообщений</span><span class="sxs-lookup"><span data-stu-id="8cf13-103">Choosing a Message Class</span></span>

  
  
<span data-ttu-id="8cf13-104">**Относится к**: Outlook</span><span class="sxs-lookup"><span data-stu-id="8cf13-104">**Applies to**: Outlook</span></span> 
  
<span data-ttu-id="8cf13-105">Как описано в [Классы сообщений MAPI](mapi-message-classes.md), классы сообщений важны для установления отношения между типами пользовательские сообщения, а также, между серверами формы сами.</span><span class="sxs-lookup"><span data-stu-id="8cf13-105">As described in [MAPI Message Classes](mapi-message-classes.md), message classes are important for establishing the relationship between types of custom messages and, by extension, between form servers themselves.</span></span> <span data-ttu-id="8cf13-106">К счастью выбрав в строке класс сообщения является достаточно простым.</span><span class="sxs-lookup"><span data-stu-id="8cf13-106">Fortunately, choosing a message class string is fairly simple.</span></span> <span data-ttu-id="8cf13-107">Строка класса сообщения класса сообщений является произвольной строкой, но ее следует использовать следующие условные обозначения:</span><span class="sxs-lookup"><span data-stu-id="8cf13-107">The message class string of a message class is an arbitrary string, but it should use the following conventions:</span></span>
  
- <span data-ttu-id="8cf13-108">Строка должна соответствовать все соглашениям, описано в документации по свойству **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)).</span><span class="sxs-lookup"><span data-stu-id="8cf13-108">The string should satisfy all the conventions described in the documentation for the **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) property.</span></span> <span data-ttu-id="8cf13-109">Важно строка должна может состоять только из символов ANSI и иметь длину не более 256 символов.</span><span class="sxs-lookup"><span data-stu-id="8cf13-109">Importantly, the string must be composed entirely of ANSI characters and be less than 256 characters long.</span></span>
    
- <span data-ttu-id="8cf13-110">Если сервер формы является производным от существующего сервера формы или расширением существующего сервера форм, строки класс сообщения должны формат путем добавления за период и другого слова в строке класс сообщения сервера формы на основе формы.</span><span class="sxs-lookup"><span data-stu-id="8cf13-110">If your form server is derived from an existing form server or is an extension of an existing form server, your message class string should be formed by adding a period and another word to the message class string of the form server that your form is based on.</span></span> <span data-ttu-id="8cf13-111">К примеру можно реализовать форму, чтобы изменить расписание собрания и формы на основе существующей формы для планирования собраний.</span><span class="sxs-lookup"><span data-stu-id="8cf13-111">For example, you might want to implement a form to reschedule a meeting, and your form is based on an existing form for scheduling meetings.</span></span> <span data-ttu-id="8cf13-112">Если собрание, планирование строка класса сообщений формы «IPM. Собрания», строка класса ваше сообщение может быть «IPM. Meeting.Reschedule».</span><span class="sxs-lookup"><span data-stu-id="8cf13-112">If the meeting scheduling form's message class string is "IPM.Meeting", your message class string could be "IPM.Meeting.Reschedule".</span></span>
    
- <span data-ttu-id="8cf13-113">Если форма не основан на существующие формы, строки класс сообщения по-прежнему должен начинаться с любого из «IPM.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-113">If your form is not based on any existing form, your message class string should still begin with either the "IPM."</span></span> <span data-ttu-id="8cf13-114">или «Производственных Издержек.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-114">or "IPC."</span></span> <span data-ttu-id="8cf13-115">префикс, в зависимости от того, предназначен ли формы должны быть получены пользователем или в другом приложении.</span><span class="sxs-lookup"><span data-stu-id="8cf13-115">prefix, depending on whether the form is intended to be received by a person or by another application.</span></span> <span data-ttu-id="8cf13-116">«IPM.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-116">"IPM."</span></span> <span data-ttu-id="8cf13-117">обозначает сообщение электронной почты — это обычно заканчивается в папку Входящие» и «Производственных Издержек.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-117">designates an interpersonal message that usually ends up in a user's Inbox, and "IPC."</span></span> <span data-ttu-id="8cf13-118">обозначает сообщение связи между процессами, обычно не доставлено в почтовый ящик пользователя.</span><span class="sxs-lookup"><span data-stu-id="8cf13-118">designates an interprocess communication message that is not typically delivered to a user's Inbox.</span></span>
    
- <span data-ttu-id="8cf13-119">Если класс сообщения является восприятия, строка класс сообщения должны начинаться с «IPM.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-119">If your message class is intended to be human-readable, the message class string should start with "IPM."</span></span> <span data-ttu-id="8cf13-120">Класс сообщения обычно считается восприятия Если использует все свойства, содержащие обычный текст, HTML, либо данные форматированный текст (RTF).</span><span class="sxs-lookup"><span data-stu-id="8cf13-120">A message class is generally considered human-readable if it uses any properties that contain plain text, HTML, or Rich Text Format (RTF) data.</span></span> <span data-ttu-id="8cf13-121">Если в форме используется свойство **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)), следует использовать наверняка «IPM.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-121">If your form uses the **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) property, it should almost certainly use an "IPM."</span></span> <span data-ttu-id="8cf13-122">Строка класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="8cf13-122">message class string.</span></span> <span data-ttu-id="8cf13-123">К примеру Если организации требуется утвердить заказов на покупку диспетчером реализуется формы для заказов на покупку, строки класс сообщения может быть «IPM. Purchase_Order».</span><span class="sxs-lookup"><span data-stu-id="8cf13-123">For example, if you are implementing a form for purchase orders, and your organization requires that purchase orders be approved by a manager, your message class string could be "IPM.Purchase_Order".</span></span> <span data-ttu-id="8cf13-124">Формы, которые предназначены для использования с общедоступными папками или приложений общедоступных папок, обычно считаются электронной почты — это так, как их прочитать пользователи, несмотря на то, что они не рассматриваются фактически на любой адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="8cf13-124">Forms that are designed for use with public folders or public folder applications are typically considered to be interpersonal because they are read by people even though they are not actually addressed to any person's email address.</span></span> <span data-ttu-id="8cf13-125">Типичный префикс классы сообщений общих папок — это «IPM. Запись».</span><span class="sxs-lookup"><span data-stu-id="8cf13-125">The typical prefix for public folder message classes is "IPM.Post".</span></span> 
    
- <span data-ttu-id="8cf13-126">Если класс сообщения является будет приниматься другого приложения, а не пользователем, строка класс сообщения должны начинаться с «Производственных Издержек.»</span><span class="sxs-lookup"><span data-stu-id="8cf13-126">If your message class is intended to be received by another application instead of by a person, the message class string should start with "IPC."</span></span> <span data-ttu-id="8cf13-127">К примеру Если вы реализуете форму, которая позволяет пользователям автоматически подписка на списки рассылки, строки класс сообщения может быть «производственных Издержек. Подписка».</span><span class="sxs-lookup"><span data-stu-id="8cf13-127">For example, if you are implementing a form that enables people to automatically subscribe to mailing lists, your message class string could be "IPC.Subscribe".</span></span>
    
- <span data-ttu-id="8cf13-128">Текст в строке класс сообщения никогда не должно заканчиваться точкой.</span><span class="sxs-lookup"><span data-stu-id="8cf13-128">Your message class string should never end with a period.</span></span>
    
<span data-ttu-id="8cf13-129">Строка класса сообщений должна размещаться в разделе **[Описание]** файла конфигурации формы, в записи **MessageClass** , следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8cf13-129">The message class string should be put in the **[Description]** section of the form configuration file, in the **MessageClass** entry, similar to the following:</span></span> 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
<span data-ttu-id="8cf13-130">После выбора строку класс соответствующего сообщения следует создавать идентификатор класса для него.</span><span class="sxs-lookup"><span data-stu-id="8cf13-130">After you have chosen an appropriate message class string, you should generate a class identifier for it.</span></span> <span data-ttu-id="8cf13-131">Идентификаторы класса могут быть созданы с помощью команды **Создать GUID** , который включен в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8cf13-131">Class identifiers can be generated with the **Create GUID** command that is included in Visual Studio.</span></span> <span data-ttu-id="8cf13-132">Идентификатор класса необходимо поместить в файл конфигурации формы **CLSID** записи с записью **MessageClass** , следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8cf13-132">The class identifier must be put in the form configuration file's **CLSID** entry, along with the **MessageClass** entry, similar to the following:</span></span> 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
<span data-ttu-id="8cf13-133">Идентификатор класса будут отличаться, конечно.</span><span class="sxs-lookup"><span data-stu-id="8cf13-133">Your class identifier will almost certainly be different, of course.</span></span> <span data-ttu-id="8cf13-134">[Файл конфигурации формы](creating-a-form-configuration-file.md)для получения дополнительных сведений см.</span><span class="sxs-lookup"><span data-stu-id="8cf13-134">For more information, see [Creating a Form Configuration File](creating-a-form-configuration-file.md).</span></span>
  
<span data-ttu-id="8cf13-135">При установке формы на компьютере пользователя, процесса установки —, будет ли это программа установки или другое действие, необходимо принять запись реестра в **HKEY_CLASSES_ROOT\CLSID\* * раздел реестра для идентификатор класса.</span><span class="sxs-lookup"><span data-stu-id="8cf13-135">When the form is installed on a user's computer, your installation process — whether it is a setup program or something else — must make a registry entry in the **HKEY_CLASSES_ROOT\CLSID\** section of the registry for the class identifier.</span></span> <span data-ttu-id="8cf13-136">В этой записи необходимо установить строке класс сообщения.</span><span class="sxs-lookup"><span data-stu-id="8cf13-136">This entry must be set to the message class string.</span></span> <span data-ttu-id="8cf13-137">Например потребовалось бы создать запись реестра аналогичные приведенным ниже, для идентификатор класса примере выше:</span><span class="sxs-lookup"><span data-stu-id="8cf13-137">For example, you would create a registry entry similar to the following for the example class identifier above:</span></span> 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
<span data-ttu-id="8cf13-138">Для получения дополнительных сведений см [формы в библиотеку](installing-a-form-into-a-library.md).</span><span class="sxs-lookup"><span data-stu-id="8cf13-138">For more information, see [Installing a Form into a Library](installing-a-form-into-a-library.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="8cf13-139">См. также</span><span class="sxs-lookup"><span data-stu-id="8cf13-139">See also</span></span>



[<span data-ttu-id="8cf13-140">Разработка серверов форм MAPI</span><span class="sxs-lookup"><span data-stu-id="8cf13-140">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)


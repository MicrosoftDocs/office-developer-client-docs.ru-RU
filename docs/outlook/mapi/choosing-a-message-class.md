---
title: Выбор класса сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 279df7f07c8c8b66347488c6224d04f70292e968
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428055"
---
# <a name="choosing-a-message-class"></a><span data-ttu-id="a9cbc-103">Выбор класса сообщений</span><span class="sxs-lookup"><span data-stu-id="a9cbc-103">Choosing a Message Class</span></span>

  
  
<span data-ttu-id="a9cbc-104">**Область применения**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a9cbc-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a9cbc-105">Как описано в [классах сообщений MAPI,](mapi-message-classes.md)классы сообщений имеют важное значение для установления связи между типами настраиваемого сообщения и, более того, между самими серверами форм.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-105">As described in [MAPI Message Classes](mapi-message-classes.md), message classes are important for establishing the relationship between types of custom messages and, by extension, between form servers themselves.</span></span> <span data-ttu-id="a9cbc-106">К счастью, выбор строки класса сообщения довольно прост.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-106">Fortunately, choosing a message class string is fairly simple.</span></span> <span data-ttu-id="a9cbc-107">Строка класса сообщений класса сообщений является произвольной строкой, но в ней должны применяться следующие условности:</span><span class="sxs-lookup"><span data-stu-id="a9cbc-107">The message class string of a message class is an arbitrary string, but it should use the following conventions:</span></span>
  
- <span data-ttu-id="a9cbc-108">Строка должна удовлетворять всем конвенциям, описанным в документации для **свойства PR_MESSAGE_CLASS** [(PidTagMessageClass).](pidtagmessageclass-canonical-property.md)</span><span class="sxs-lookup"><span data-stu-id="a9cbc-108">The string should satisfy all the conventions described in the documentation for the **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)) property.</span></span> <span data-ttu-id="a9cbc-109">Важно отметить, что строка должна быть полностью составлена из символов ANSI и должна быть менее 256 символов в длину.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-109">Importantly, the string must be composed entirely of ANSI characters and be less than 256 characters long.</span></span>
    
- <span data-ttu-id="a9cbc-110">Если сервер формы получен из существующего сервера форм или является расширением существующего сервера форм, строка класса сообщения должна быть сформирована путем добавления периода и другого слова в строку класса сообщений сервера формы, на основе которую основана ваша форма.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-110">If your form server is derived from an existing form server or is an extension of an existing form server, your message class string should be formed by adding a period and another word to the message class string of the form server that your form is based on.</span></span> <span data-ttu-id="a9cbc-111">Например, может потребоваться реализовать форму для переноса собрания, а форма основана на существующей форме для планирования собраний.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-111">For example, you might want to implement a form to reschedule a meeting, and your form is based on an existing form for scheduling meetings.</span></span> <span data-ttu-id="a9cbc-112">Если строка класса сообщений формы планирования собраний является "IPM. Meeting", строка класса сообщения может быть "IPM. Meeting.Reschedule".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-112">If the meeting scheduling form's message class string is "IPM.Meeting", your message class string could be "IPM.Meeting.Reschedule".</span></span>
    
- <span data-ttu-id="a9cbc-113">Если форма не основана на существующей форме, строка класса сообщений по-прежнему должна начинаться с строки "IPM".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-113">If your form is not based on any existing form, your message class string should still begin with either the "IPM."</span></span> <span data-ttu-id="a9cbc-114">или "IPC".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-114">or "IPC."</span></span> <span data-ttu-id="a9cbc-115">префикс, в зависимости от того, должна ли форма быть получена человеком или другим приложением.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-115">prefix, depending on whether the form is intended to be received by a person or by another application.</span></span> <span data-ttu-id="a9cbc-116">"IPM".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-116">"IPM."</span></span> <span data-ttu-id="a9cbc-117">обозначает межличностное сообщение, которое обычно попадает в почтовый ящик пользователя, и "IPC".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-117">designates an interpersonal message that usually ends up in a user's Inbox, and "IPC."</span></span> <span data-ttu-id="a9cbc-118">обозначает сообщение межпроцессной связи, которое обычно не доставляется в почтовый ящик пользователя.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-118">designates an interprocess communication message that is not typically delivered to a user's Inbox.</span></span>
    
- <span data-ttu-id="a9cbc-119">Если класс сообщения предназначен для чтения с помощью человека, строка класса сообщения должна начинаться с "IPM".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-119">If your message class is intended to be human-readable, the message class string should start with "IPM."</span></span> <span data-ttu-id="a9cbc-120">Класс сообщений обычно считается читаемым для человека, если он использует свойства, содержащие простой текст, HTML или данные формата RTF.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-120">A message class is generally considered human-readable if it uses any properties that contain plain text, HTML, or Rich Text Format (RTF) data.</span></span> <span data-ttu-id="a9cbc-121">Если в вашей форме используется **свойство PR_BODY** [(PidTagBody),](pidtagbody-canonical-property.md)он должен почти наверняка использовать "IPM".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-121">If your form uses the **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) property, it should almost certainly use an "IPM."</span></span> <span data-ttu-id="a9cbc-122">строка класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-122">message class string.</span></span> <span data-ttu-id="a9cbc-123">Например, если вы реализуете форму для заказов на покупку и организации требуется, чтобы заказы на покупку были утверждены менеджером, строка класса сообщения может быть "IPM. Purchase_Order".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-123">For example, if you are implementing a form for purchase orders, and your organization requires that purchase orders be approved by a manager, your message class string could be "IPM.Purchase_Order".</span></span> <span data-ttu-id="a9cbc-124">Формы, предназначенные для использования с общедоступными папками или общедоступными приложениями папок, обычно считаются межличностными, так как они читают люди, даже несмотря на то, что на самом деле они не адресованы адресу электронной почты любого человека.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-124">Forms that are designed for use with public folders or public folder applications are typically considered to be interpersonal because they are read by people even though they are not actually addressed to any person's email address.</span></span> <span data-ttu-id="a9cbc-125">Типичный префикс для классов сообщений общедоступных папок : "IPM. Post".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-125">The typical prefix for public folder message classes is "IPM.Post".</span></span> 
    
- <span data-ttu-id="a9cbc-126">Если класс сообщения предназначен для того, чтобы получить другое приложение, а не человек, строка класса сообщения должна начинаться с "IPC".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-126">If your message class is intended to be received by another application instead of by a person, the message class string should start with "IPC."</span></span> <span data-ttu-id="a9cbc-127">Например, если вы реализуете форму, которая позволяет пользователям автоматически подписываться на списки рассылки, строка класса сообщения может быть "IPC. Подписка".</span><span class="sxs-lookup"><span data-stu-id="a9cbc-127">For example, if you are implementing a form that enables people to automatically subscribe to mailing lists, your message class string could be "IPC.Subscribe".</span></span>
    
- <span data-ttu-id="a9cbc-128">Строка класса сообщения никогда не должна закончиться периодом.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-128">Your message class string should never end with a period.</span></span>
    
<span data-ttu-id="a9cbc-129">Строка класса сообщения должна быть вложена в **раздел [Описание]** файла конфигурации формы в записи **MessageClass,** аналогично следующему:</span><span class="sxs-lookup"><span data-stu-id="a9cbc-129">The message class string should be put in the **[Description]** section of the form configuration file, in the **MessageClass** entry, similar to the following:</span></span> 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
<span data-ttu-id="a9cbc-130">После того как вы выбрали соответствующую строку класса сообщений, необходимо создать идентификатор класса для нее.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-130">After you have chosen an appropriate message class string, you should generate a class identifier for it.</span></span> <span data-ttu-id="a9cbc-131">Идентификаторы классов можно создавать с помощью команды **Create GUID,** которая включена в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-131">Class identifiers can be generated with the **Create GUID** command that is included in Visual Studio.</span></span> <span data-ttu-id="a9cbc-132">Идентификатор класса должен быть вложен в запись **CLSID** файла конфигурации формы, а также запись **MessageClass,** аналогичную следующему:</span><span class="sxs-lookup"><span data-stu-id="a9cbc-132">The class identifier must be put in the form configuration file's **CLSID** entry, along with the **MessageClass** entry, similar to the following:</span></span> 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
<span data-ttu-id="a9cbc-133">Конечно, идентификатор класса почти наверняка будет другим.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-133">Your class identifier will almost certainly be different, of course.</span></span> <span data-ttu-id="a9cbc-134">Дополнительные сведения см. в [материалах Creating a Form Configuration File.](creating-a-form-configuration-file.md)</span><span class="sxs-lookup"><span data-stu-id="a9cbc-134">For more information, see [Creating a Form Configuration File](creating-a-form-configuration-file.md).</span></span>
  
<span data-ttu-id="a9cbc-135">Когда форма устанавливается на компьютере пользователя, процесс установки — будь то программа установки или *что-то \** другое — должен внести запись реестра в разделе \*HKEY_CLASSES_ROOT\CLSIDреестра для идентификатора класса.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-135">When the form is installed on a user's computer, your installation process — whether it is a setup program or something else — must make a registry entry in the \**HKEY_CLASSES_ROOT\CLSID\** section of the registry for the class identifier.</span></span> <span data-ttu-id="a9cbc-136">Эта запись должна быть заданной строке класса сообщения.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-136">This entry must be set to the message class string.</span></span> <span data-ttu-id="a9cbc-137">Например, вы создайте запись реестра, аналогичную следующей для идентификатора класса примера выше:</span><span class="sxs-lookup"><span data-stu-id="a9cbc-137">For example, you would create a registry entry similar to the following for the example class identifier above:</span></span> 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
<span data-ttu-id="a9cbc-138">Дополнительные сведения см. [в дополнительных сведениях об](installing-a-form-into-a-library.md)установке формы в библиотеку.</span><span class="sxs-lookup"><span data-stu-id="a9cbc-138">For more information, see [Installing a Form into a Library](installing-a-form-into-a-library.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a9cbc-139">См. также</span><span class="sxs-lookup"><span data-stu-id="a9cbc-139">See also</span></span>



[<span data-ttu-id="a9cbc-140">Разработка серверов форм MAPI</span><span class="sxs-lookup"><span data-stu-id="a9cbc-140">Developing MAPI Form Servers</span></span>](developing-mapi-form-servers.md)


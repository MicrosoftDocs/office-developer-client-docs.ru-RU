---
title: Выбор класса сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: f1e604120041e9d91d06276fabb2e9dd7505df51
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19808193"
---
# <a name="choosing-a-message-class"></a>Выбор класса сообщений

  
  
**Относится к**: Outlook 
  
Как описано в [Классы сообщений MAPI](mapi-message-classes.md), классы сообщений важны для установления отношения между типами пользовательские сообщения, а также, между серверами формы сами. К счастью выбрав в строке класс сообщения является достаточно простым. Строка класса сообщения класса сообщений является произвольной строкой, но ее следует использовать следующие условные обозначения:
  
- Строка должна соответствовать все соглашениям, описано в документации по свойству **PR_MESSAGE_CLASS** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)). Важно строка должна может состоять только из символов ANSI и иметь длину не более 256 символов.
    
- Если сервер формы является производным от существующего сервера формы или расширением существующего сервера форм, строки класс сообщения должны формат путем добавления за период и другого слова в строке класс сообщения сервера формы на основе формы. К примеру можно реализовать форму, чтобы изменить расписание собрания и формы на основе существующей формы для планирования собраний. Если собрание, планирование строка класса сообщений формы «IPM. Собрания», строка класса ваше сообщение может быть «IPM. Meeting.Reschedule».
    
- Если форма не основан на существующие формы, строки класс сообщения по-прежнему должен начинаться с любого из «IPM.» или «Производственных Издержек.» префикс, в зависимости от того, предназначен ли формы должны быть получены пользователем или в другом приложении. «IPM.» обозначает сообщение электронной почты — это обычно заканчивается в папку Входящие» и «Производственных Издержек.» обозначает сообщение связи между процессами, обычно не доставлено в почтовый ящик пользователя.
    
- Если класс сообщения является восприятия, строка класс сообщения должны начинаться с «IPM.» Класс сообщения обычно считается восприятия Если использует все свойства, содержащие обычный текст, HTML, либо данные форматированный текст (RTF). Если в форме используется свойство **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)), следует использовать наверняка «IPM.» Строка класса сообщения. К примеру Если организации требуется утвердить заказов на покупку диспетчером реализуется формы для заказов на покупку, строки класс сообщения может быть «IPM. Purchase_Order». Формы, которые предназначены для использования с общедоступными папками или приложений общедоступных папок, обычно считаются электронной почты — это так, как их прочитать пользователи, несмотря на то, что они не рассматриваются фактически на любой адрес электронной почты. Типичный префикс классы сообщений общих папок — это «IPM. Запись». 
    
- Если класс сообщения является будет приниматься другого приложения, а не пользователем, строка класс сообщения должны начинаться с «Производственных Издержек.» К примеру Если вы реализуете форму, которая позволяет пользователям автоматически подписка на списки рассылки, строки класс сообщения может быть «производственных Издержек. Подписка».
    
- Текст в строке класс сообщения никогда не должно заканчиваться точкой.
    
Строка класса сообщений должна размещаться в разделе **[Описание]** файла конфигурации формы, в записи **MessageClass** , следующим образом: 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
После выбора строку класс соответствующего сообщения следует создавать идентификатор класса для него. Идентификаторы класса могут быть созданы с помощью команды **Создать GUID** , который включен в Visual Studio. Идентификатор класса необходимо поместить в файл конфигурации формы **CLSID** записи с записью **MessageClass** , следующим образом: 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
Идентификатор класса будут отличаться, конечно. [Файл конфигурации формы](creating-a-form-configuration-file.md)для получения дополнительных сведений см.
  
При установке формы на компьютере пользователя, процесса установки —, будет ли это программа установки или другое действие, необходимо принять запись реестра в **HKEY_CLASSES_ROOT\CLSID\* * раздел реестра для идентификатор класса. В этой записи необходимо установить строке класс сообщения. Например потребовалось бы создать запись реестра аналогичные приведенным ниже, для идентификатор класса примере выше: 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
Для получения дополнительных сведений см [формы в библиотеку](installing-a-form-into-a-library.md).
  
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


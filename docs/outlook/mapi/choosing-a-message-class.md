---
title: Выбор класса сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 279df7f07c8c8b66347488c6224d04f70292e968
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32285260"
---
# <a name="choosing-a-message-class"></a>Выбор класса сообщений

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Как описано в разделе [классы сообщений MAPI](mapi-message-classes.md), классы сообщений важны для установления связи между типами настраиваемых сообщений и, по расширению, между самими серверами форм. К счастью, выбор строки класса сообщений довольно прост. Строка класса сообщения в классе Message является произвольной строкой, но она должна использовать следующие соглашения:
  
- Строка должна удовлетворять всем соглашениям, описанным в документации для свойства **пр_мессаже_класс** ([PidTagMessageClass](pidtagmessageclass-canonical-property.md)). Важно! строка должна полностью состоять из символов ANSI и не превышать 256 символов в длину.
    
- Если сервер форм является производным от существующего сервера форм или является расширением существующего сервера форм, то строку класса сообщения необходимо сформировать, добавив точку и другое слово в строку класса сообщения на сервере формы, на котором размещается форма. Например, может потребоваться реализация формы для изменения расписания собрания, а форма основана на существующей форме для планирования собраний. Если строка класса сообщения для формы планирования собраний имеет значение IPM. Собрание ", строка класса сообщения может быть" IPM. Собрание. перепланирование ".
    
- Если форма не основана на какой-либо существующей форме, строка класса сообщения должна начинаться с "IPM". или "IPC". префикс в зависимости от того, должна ли форма быть получена пользователем или другим приложением. "IPM." Указывает межпользовательское сообщение, которое обычно завершается в папке "Входящие" пользователя, и "IPC". Задает сообщение для взаимодействия между процессами, которое обычно не доставляется в папку "Входящие" пользователя.
    
- Если класс сообщений предназначен для читаемого человека, строка класса сообщения должна начинаться с "IPM". Класс сообщения обычно считается понятным для человека, если он использует свойства, содержащие данные в формате обычного текста, HTML или форматированного текста (RTF). Если в форме используется свойство **пр_боди** ([PidTagBody](pidtagbody-canonical-property.md)), оно должно почти определенно использовать "IPM." Строка класса сообщения. Например, если вы реализуете форму для заказов на покупку, а ваша организация требует, чтобы заказы на покупку были утверждены руководителем, строка класса сообщений может иметь значение IPM. Пурчасе_ордер ". Формы, предназначенные для использования с общедоступными папками или приложениями общедоступных папок, обычно считаются взаимозаменяемыми, так как они читаются пользователями, даже если они фактически не направлены на электронный адрес любого человека. Типичным префиксом для классов сообщений общедоступных папок является "IPM. Post ". 
    
- Если класс сообщений предназначен для получения другим приложением, а не лицом, то строка класса сообщения должна начинаться с "IPC". Например, при реализации формы, позволяющей пользователям автоматически подписываться на списки рассылки, строка класса сообщений может иметь значение "IPC. Subscribe ".
    
- Строка класса сообщения не должна заканчиваться точкой.
    
Строку класса сообщения следует поместить в раздел **[Description]** файла конфигурации формы в записи **MessageClass** следующим образом: 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
После выбора соответствующей строки класса сообщений необходимо создать для него идентификатор класса. Идентификаторы классов можно создавать с помощью команды **CREATE GUID** , включенной в Visual Studio. Идентификатор класса должен быть помещен в запись **CLSID** файла конфигурации формы вместе с записью **MessageClass** , как показано ниже: 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
Разумеется, ваш идентификатор класса почти определенно будет другим. Дополнительные сведения см. [в разделе Создание файла конфигурации формы](creating-a-form-configuration-file.md).
  
Когда форма установлена на компьютере пользователя, процесс установки — это программа установки или другое действие — необходимо сделать запись реестра в разделе **хкэй_классес_рут\клсид\* * реестра для идентификатора класса. Для этой записи должна быть задана строка класса сообщения. Например, создайте запись реестра, аналогичную приведенной ниже, для примера идентификатора класса выше: 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
Дополнительную информацию можно узнать [в статье Установка формы в библиотеку](installing-a-form-into-a-library.md).
  
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


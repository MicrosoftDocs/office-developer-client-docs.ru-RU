---
title: Выбор класса message
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 279df7f07c8c8b66347488c6224d04f70292e968
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428055"
---
# <a name="choosing-a-message-class"></a>Выбор класса message

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Как описано в классах сообщений [MAPI,](mapi-message-classes.md)классы сообщений важны для установления связи между типами настраиваемого сообщения и, по расширению, между серверами форм. К счастью, выбрать строку класса сообщения довольно просто. Строка класса сообщения класса сообщения является произвольной строкой, но она должна использовать следующие соглашения:
  
- Строка должна удовлетворять всем соглашениям, описанным в документации для **свойства PR_MESSAGE_CLASS** ([PidTagMessageClass).](pidtagmessageclass-canonical-property.md) Важно отметить, что строка должна состоять полностью из символов ANSI и быть длиной менее 256 символов.
    
- Если сервер форм является производным от существующего сервера форм или является расширением существующего сервера форм, строка класса сообщения должна быть сформирована путем добавления точки и другого слова в строку класса сообщения сервера форм, на который основана форма. Например, может потребоваться реализовать форму для повторного планирования собрания, а форма будет основана на существующей форме планирования собраний. Если строка класса сообщения формы планирования собрания — "IPM. "Meeting", строка класса сообщения может быть "IPM. Meeting.Reschedule".
    
- Если форма не основана на существующей форме, строка класса сообщения все равно должна начинаться с "IPM". или "IPC". префикс, в зависимости от того, должна ли форма быть получена человеком или другим приложением. "IPM." обозначает межличное сообщение, которое обычно попадает в "Входящие" пользователя, и "IPC". обозначает межпроцессное сообщение, которое обычно не доставляется в почтовый ящик пользователя.
    
- Если класс сообщения предназначен для чтения человеком, строка класса сообщения должна начинаться с "IPM". Класс сообщения обычно считается читаемым, если он использует свойства, содержащие обычный текст, HTML или данные RTF. Если форма использует свойство **PR_BODY** ([PidTagBody),](pidtagbody-canonical-property.md)почти наверняка следует использовать "IPM". строка класса message. Например, если вы реализуете форму для заказов на покупку и вашей организации требуется, чтобы заказы на покупку были утверждены руководителем, строка класса сообщения может быть "IPM. Purchase_Order". Формы, предназначенные для использования с общедоступными папками или приложениями общедоступных папок, обычно считаются межличностными, так как они читают люди, даже если на самом деле они не адресованы электронному адресу какого-либо человека. Типичный префикс для классов сообщений общедоступных папок : "IPM. Post". 
    
- Если ваш класс сообщения должен быть получен другим приложением, а не человеком, строка класса сообщения должна начинаться с "IPC". Например, если вы реализуете форму, которая позволяет пользователям автоматически подписываться на списки рассылки, строка класса сообщения может быть "IPC. Подпишитесь".
    
- Строка класса сообщения никогда не должна заканчиваются точками.
    
Строку класса сообщения следует поместить в раздел **[Описание]** файла конфигурации формы в записи **MessageClass** следующим образом: 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
После того как вы выбрали соответствующую строку класса сообщения, необходимо создать для нее идентификатор класса. Идентификаторы классов могут создаваться с помощью команды **Create GUID,** включенной в Visual Studio. Идентификатор класса должен быть указан в записи **CLSID** файла конфигурации формы вместе с записью **MessageClass** следующим образом: 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
Идентификатор класса, конечно, почти наверняка будет другим. Дополнительные сведения см. [в теме "Создание файла конфигурации формы".](creating-a-form-configuration-file.md)
  
При установке формы на компьютере пользователя процесс установки (программа установки или что-то другое) должен создать запись реестра в разделе **HKEY_CLASSES_ROOT\CLSID\** реестра для идентификатора класса. Для этой записи должна быть заданной строка класса сообщения. Например, можно создать запись реестра, аналогичную следующей для примера идентификатора класса выше: 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
Дополнительные сведения см. [в установке формы в библиотеку.](installing-a-form-into-a-library.md)
  
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


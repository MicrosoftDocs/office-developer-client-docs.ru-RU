---
title: Выбор класса сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5ca8edd2-41b7-40e2-b755-b28eecb49786
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 279df7f07c8c8b66347488c6224d04f70292e968
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428055"
---
# <a name="choosing-a-message-class"></a>Выбор класса сообщений

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Как описано в [классах сообщений MAPI,](mapi-message-classes.md)классы сообщений имеют важное значение для установления связи между типами настраиваемого сообщения и, более того, между самими серверами форм. К счастью, выбор строки класса сообщения довольно прост. Строка класса сообщений класса сообщений является произвольной строкой, но в ней должны применяться следующие условности:
  
- Строка должна удовлетворять всем конвенциям, описанным в документации для **свойства PR_MESSAGE_CLASS** [(PidTagMessageClass).](pidtagmessageclass-canonical-property.md) Важно отметить, что строка должна быть полностью составлена из символов ANSI и должна быть менее 256 символов в длину.
    
- Если сервер формы получен из существующего сервера форм или является расширением существующего сервера форм, строка класса сообщения должна быть сформирована путем добавления периода и другого слова в строку класса сообщений сервера формы, на основе которую основана ваша форма. Например, может потребоваться реализовать форму для переноса собрания, а форма основана на существующей форме для планирования собраний. Если строка класса сообщений формы планирования собраний является "IPM. Meeting", строка класса сообщения может быть "IPM. Meeting.Reschedule".
    
- Если форма не основана на существующей форме, строка класса сообщений по-прежнему должна начинаться с строки "IPM". или "IPC". префикс, в зависимости от того, должна ли форма быть получена человеком или другим приложением. "IPM". обозначает межличностное сообщение, которое обычно попадает в почтовый ящик пользователя, и "IPC". обозначает сообщение межпроцессной связи, которое обычно не доставляется в почтовый ящик пользователя.
    
- Если класс сообщения предназначен для чтения с помощью человека, строка класса сообщения должна начинаться с "IPM". Класс сообщений обычно считается читаемым для человека, если он использует свойства, содержащие простой текст, HTML или данные формата RTF. Если в вашей форме используется **свойство PR_BODY** [(PidTagBody),](pidtagbody-canonical-property.md)он должен почти наверняка использовать "IPM". строка класса сообщения. Например, если вы реализуете форму для заказов на покупку и организации требуется, чтобы заказы на покупку были утверждены менеджером, строка класса сообщения может быть "IPM. Purchase_Order". Формы, предназначенные для использования с общедоступными папками или общедоступными приложениями папок, обычно считаются межличностными, так как они читают люди, даже несмотря на то, что на самом деле они не адресованы адресу электронной почты любого человека. Типичный префикс для классов сообщений общедоступных папок : "IPM. Post". 
    
- Если класс сообщения предназначен для того, чтобы получить другое приложение, а не человек, строка класса сообщения должна начинаться с "IPC". Например, если вы реализуете форму, которая позволяет пользователям автоматически подписываться на списки рассылки, строка класса сообщения может быть "IPC. Подписка".
    
- Строка класса сообщения никогда не должна закончиться периодом.
    
Строка класса сообщения должна быть вложена в **раздел [Описание]** файла конфигурации формы в записи **MessageClass,** аналогично следующему: 
  
 `MessageClass=IPM.Meeting.Reschedule`
  
После того как вы выбрали соответствующую строку класса сообщений, необходимо создать идентификатор класса для нее. Идентификаторы классов можно создавать с помощью команды **Create GUID,** которая включена в Visual Studio. Идентификатор класса должен быть вложен в запись **CLSID** файла конфигурации формы, а также запись **MessageClass,** аналогичную следующему: 
  
 `CLSID={88FFF551-B8C5-11ce-8DE0-00AA0060D242}`
  
Конечно, идентификатор класса почти наверняка будет другим. Дополнительные сведения см. в [материалах Creating a Form Configuration File.](creating-a-form-configuration-file.md)
  
Когда форма устанавливается на компьютере пользователя, процесс установки — будь то программа установки или *что-то \** другое — должен внести запись реестра в разделе *HKEY_CLASSES_ROOT\CLSIDреестра для идентификатора класса. Эта запись должна быть заданной строке класса сообщения. Например, вы создайте запись реестра, аналогичную следующей для идентификатора класса примера выше: 
  
 `HKEY_CLASSES_ROOT\CLSID\{88FFF551-B8C5-11ce-8DE0-00AA0060D242}="IPM.Meeting.Reschedule"`
  
Дополнительные сведения см. [в дополнительных сведениях об](installing-a-form-into-a-library.md)установке формы в библиотеку.
  
## <a name="see-also"></a>См. также



[Разработка серверов форм MAPI](developing-mapi-form-servers.md)


---
title: имапиформадвисесинконактиватенекст
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIFormAdviseSink.OnActivateNext
api_type:
- COM
ms.assetid: db621dfd-c6ad-42d2-8089-db40a63cab36
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: d647b41018afbade91dffb2818b48b0738148855
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33411766"
---
# <a name="imapiformadvisesinkonactivatenext"></a>IMAPIFormAdviseSink::OnActivateNext

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Указывает, может ли форма обрабатывать класс сообщения следующего отображаемого сообщения.
  
```cpp
HRESULT OnActivateNext(
  LPCSTR lpszMessageClass,
  ULONG ulMessageStatus,
  ULONG ulMessageFlags,
  LPPERSISTMESSAGE FAR * ppPersistMessage
);
```

## <a name="parameters"></a>Параметры

 _лпсзмессажекласс_
  
> возврата Указатель на класс сообщения следующего сообщения.
    
 _улмессажестатус_
  
> возврата Битовая маска, определяемая клиентом или поставщиком, которая копируется из свойства **PR_MSG_STATUS** ([PidTagMessageStatus](pidtagmessagestatus-canonical-property.md)) следующего отображаемого сообщения, которое предоставляет сведения о состоянии таблицы содержимого, в которую включается сообщение.
    
 _улмессажефлагс_
  
> возврата Указатель на битовую маску флагов, скопированных из свойства **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) следующего отображаемого сообщения, которое показывает текущее состояние сообщения.
    
 _ппперсистмессаже_
  
> вышли Указатель на указатель на реализацию [иперсистмессаже](ipersistmessageiunknown.md) для объекта формы, используемого для новой формы, если требуется новая форма. Указатель на NULL можно вернуть, если текущий объект формы можно использовать для отображения и сохранения следующего сообщения. 
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Уведомление было успешным, и форма может обрабатывать следующее сообщение.
    
S_FALSE 
  
> Форма не обрабатывает класс сообщения следующего сообщения.
    
## <a name="remarks"></a>Примечания

Средства просмотра форм вызывают метод **имапиформадвисесинк:: онактиватенекст** , чтобы определить, может ли форма отображать следующее сообщение в папке. Следующее сообщение может быть сообщением любого класса, но обычно оно относится к тому же классу или связанному классу. Это делает процесс чтения нескольких сообщений одного класса более эффективным, позволяя клиентским приложениям повторно использовать объекты форм по мере возможности. 
  
Большинство объектов Form будут использовать класс Message, на который указывает параметр _лпсзмессажекласс_ , чтобы определить, могут ли они обрабатывать следующее сообщение. Как правило, форма может обрабатывать сообщения, принадлежащие классам, для которых класс формы по умолчанию является подклассом, в дополнение к сообщениям, принадлежащим классу по умолчанию. Тем не менее, форма может использовать другие факторы, чтобы определить, может ли сообщение быть обработано, например состояние отправления или неотправления следующего сообщения. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Возвращает S_OK и значение NULL в параметре _ппперсистмессаже_ , если форма может обрабатывать класс Message. Если форма может создать новую форму, которая может обрабатывать сообщение, которое форма не может обработать, выполните указанные ниже действия. 
  
1. Вызовите фабрику классов формы, чтобы создать экземпляр нового объекта Form.
    
2. Сохраните этот экземпляр в содержимом параметра _ппперсистмессаже_ указателя. 
    
3. Возврат S_OK.
    
Средство просмотра форм загрузит сообщение, используя метод [иперсистмессаже:: Load](ipersistmessage-load.md) , принадлежащий объекту, на который указывает _ппперсистмессаже_.
  
Если ни форма, ни форма, которые вы можете создать, не смогут обработать следующее сообщение, возвращается S_FALSE. Однако в общем случае формы не должны возвращать это значение, так как это приводит к снижению производительности в средстве просмотра форм.
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Мапиформфунктионс. cpp  <br/> |Кмимапиформвиевер:: Активатенекст  <br/> |MFCMAPI использует метод **имапиформадвисесинк:: онактиватенекст** для реализации метода [Имапивиевконтекст:: активатенекст](imapiviewcontext-activatenext.md) .  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIViewContext::ActivateNext](imapiviewcontext-activatenext.md)
  
[IPersistMessage : IUnknown](ipersistmessageiunknown.md)
  
[IPersistMessage::Load](ipersistmessage-load.md)
  
[Каноническое свойство PidTagMessageFlags](pidtagmessageflags-canonical-property.md)
  
[Каноническое свойство PidTagMessageStatus](pidtagmessagestatus-canonical-property.md)
  
[IMAPIFormAdviseSink : IUnknown](imapiformadvisesinkiunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


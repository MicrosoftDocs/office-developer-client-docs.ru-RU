---
title: Поддержка форматированный текст в обязанности клиента входящих сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 79727700-5ef1-4a29-9ed0-fd46c7de3202
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 863c95856f3198c74bb9d72881154676386f6a9f
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/21/2018
ms.locfileid: "19812423"
---
# <a name="supporting-formatted-text-in-incoming-messages-client-responsibilities"></a>Поддержка форматированного текста во входящих сообщениях: обязанности клиентов

  
  
**Относится к**: Outlook 
  
Как сообщения передаются между систем обмена сообщениями, диспетчер очереди MAPI следит за тем, что форматирование текста остается синхронизированной с текста сообщения. Диспетчер очереди MAPI вызывает функцию [RTFSync](rtfsync.md) в оболочку версии сообщение, которое передается поставщика транспорта. Поставщика транспорта сохраняет изменения, внесенные в сообщение путем вызова метода [IMAPIProp::SaveChanges](imapiprop-savechanges.md) и направляет его нового получателя. 
  
При получателя RTF клиентское приложение открывает сообщение для отображения текста, его необходимо синхронизировать текст с форматированием и откройте **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) или **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) , в зависимости от того, какие свойства недоступны.
  
 **Чтобы открыть сообщение, поддерживающую RTF клиентов**
  
1. Вызовите **RTFSync** , чтобы синхронизировать текст сообщения с форматированием, если не учитывать RTF хранилища сообщений. Флаг RTF_SYNC_BODY_CHANGED должен передаваться в параметре _ulFlags_ , если свойство **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) отсутствует или задано значение FALSE. Клиентов, работающих с поддержкой RTF хранилищ сообщений не нужна выполнения вызова **RTFSync** , поскольку хранилище сообщений отвечает за его. 
    
2. Вызовите [IMAPIProp::SaveChanges](imapiprop-savechanges.md) , если были внесены текста сообщения. 
    
3. Вызовите [IMAPIProp::OpenProperty](imapiprop-openproperty.md) , чтобы открыть свойство **PR_RTF_COMPRESSED** . Если **PR_RTF_COMPRESSED** не поддерживается, следует вместо этого откройте свойство **PR_BODY** для отображения содержимого сообщения. 
    
4. Вызовите функцию [WrapCompressedRTFStream](wrapcompressedrtfstream.md) для создания несжатую версию сжатых данных RTF, если он доступен. 
    
5. Отображение несжатого данные в формате RTF или обычного текста данных для пользователя.
    
 **RTFSync** возвращает логическое значение, указывающее, обновлен ли сообщение. Если это значение возвращает значение TRUE, вызов **SaveChanges** в определенный момент, чтобы обновление было постоянным. Вызов не должны быть выполнены немедленно после возвращает **RTFSync** . 
  
> [!NOTE]
> Так как слишком большом числе компоненты обрабатывать форматированного текста, прежде чем вы получаете, нет возможности повреждения. В этом повреждения могут быть получены от поставщика хранилища сообщений, приложения сторонних производителей, шлюза или Ошибка передачи. 
  


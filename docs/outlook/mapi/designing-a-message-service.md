---
title: Проектирование службы сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32627ebb-547f-4fac-a406-e7243ec5521b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 19a8a939685c440901f3f57d72baf673a579e590
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404297"
---
# <a name="designing-a-message-service"></a>Проектирование службы сообщений

**Относится к**: Outlook 2013 | Outlook 2016 
  
Прежде чем приступить к написанию кода для поддержки службы сообщений, важно создать проект. Устраните следующие проблемы в процессе создания проекта.
  
1. Определите, сколько поставщиков служб должно быть включено в службу сообщений. Включайте в службу только связанные поставщики услуг (то есть поставщики, которые работают с одной и той же системой обмена сообщениями). Несвязанные поставщики услуг не входят в одну и ту же службу сообщений. Используйте профиль для интеграции несвязанных поставщиков услуг и служб сообщений.
    
2. Определите, какие типы поставщиков услуг следует включить в службу сообщений. Большинство служб мессже включают один поставщик каждого из общих типов. То есть обычная служба сообщений имеет одного поставщика адресных книг, одного поставщика хранилища сообщений и одного поставщика транспорта.
    
3. Определите, сколько библиотек DLL должно содержать службу сообщений. Количество библиотек DLL, которые использует служба сообщений, зависит от следующих условий:
    
   - Степень сложности, которую вы в качестве автора службы сообщений обрабатывается.
    
   - Тип поставщиков услуг в службе сообщений.
    
   - Связь, которую может иметь служба сообщений, с другой службой сообщений.
    
   Так как MAPI хранит только одну точку входа для каждого типа поставщика, не включайте нескольких поставщиков одного типа в одну библиотеку DLL. Если имеет смысл включить нескольких поставщиков одного типа, их следует реализовать в отдельных библиотеках DLL или предоставить им общий доступ к функции точки входа. Кроме того, можно реализовать связанные службы сообщений или службы сообщений, которые могут использовать один и тот же код установки и конфигурации и одну и ту же функцию точки входа DLL, в одной DLL.
    
   Если это возможно, храните его простой и используйте одну библиотеку DLL, которая содержит реализацию всех поставщиков служб в службе сообщений и весь код для установки и настройки службы сообщений. Если это невозможно, можно внедрить одну библиотеку DLL для кода установки и конфигурации, а также одну библиотеку DLL для всех поставщиков услуг или одной библиотеки DLL для каждого поставщика.
    
4. Определите имя библиотеки DLL службы сообщений или библиотек DLL. 
    
## <a name="see-also"></a>См. также

- [Реализация службы сообщений](message-service-implementation.md)


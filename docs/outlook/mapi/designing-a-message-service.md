---
title: Разработка службы сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32627ebb-547f-4fac-a406-e7243ec5521b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b572ebcec0a33d2134f4cf19b88e3132cbd47117
ms.sourcegitcommit: 0cf39e5382b8c6f236c8a63c6036849ed3527ded
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22582002"
---
# <a name="designing-a-message-service"></a>Разработка службы сообщений

**Применимо к**: Outlook 2013 | Outlook 2016 
  
Прежде чем начать писать код для поддержки службы сообщений, важно для создания проекта. Устранение следующих проблем в процессе разработки.
  
1. Определите, сколько поставщиков услуг должно быть включено в службы сообщений. Включите только поставщиков услуг, связанных с ними (поставщиков, которые работают с той же системе обмена сообщениями) в службе. Поставщики услуг несвязанных не принадлежат одной службы сообщений. Используйте профиль по интеграции поставщиков несвязанных службы и службы сообщений.
    
2. Определите, какой тип поставщиков услуг должно быть включено в службы сообщений. Большинство служб сообщения включают одного поставщика каждого из типов. То есть служба Типичное сообщение имеет один адресной книге, поставщик хранения одного сообщения и один транспортный протокол.
    
3. Определить, сколько библиотек DLL должен содержать службы сообщений. Число библиотек DLL, которые использует служба сообщений зависит от следующих:
    
   - Степень сложности, который разработчику службы сообщений требуется для обработки.
    
   - Тип поставщиков услуг службы сообщений.
    
   - Связь, службы сообщение может быть с другой службы сообщений.
    
   Так как MAPI сохраняет только одну точку входа для каждого типа поставщика, не включают нескольких поставщиков одного типа в одной библиотеке DLL. Если это имеет смысл включать несколько поставщиков одного типа, их реализации в отдельные библиотеки DLL или их совместно использовать функцию точки входа. Можно реализовать службы сообщений или службы сообщений, которые можно использовать же установки и настройки кода и же DLL точка входа функции, в одной библиотеке DLL.
    
   Если это возможно можно проще и используйте один DLL, которая содержит реализации всех поставщиков услуг службы сообщений и весь код для установки и настройки службы сообщений. Если это невозможно, можно реализовать один DLL-Библиотеку кода установки и настройки, а также одной библиотеки DLL для всех поставщиков услуг или один DLL-Библиотеку для каждого поставщика.
    
4. Определите имя службы сообщений DLL или DLL-библиотеки. 
    
## <a name="see-also"></a>См. также

- [Реализация службы сообщений](message-service-implementation.md)


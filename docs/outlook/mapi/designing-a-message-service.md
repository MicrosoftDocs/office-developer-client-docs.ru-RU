---
title: Проектирование службы сообщений
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 32627ebb-547f-4fac-a406-e7243ec5521b
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 19a8a939685c440901f3f57d72baf673a579e590
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404297"
---
# <a name="designing-a-message-service"></a>Проектирование службы сообщений

**Область применения**: Outlook 2013 | Outlook 2016 
  
Прежде чем приступить к написанию кода для поддержки службы сообщений, важно создать дизайн. Устранение следующих проблем в процессе разработки:
  
1. Определите, сколько поставщиков услуг должно быть включено в службу сообщений. Включите в службу только связанных поставщиков услуг (то есть поставщиков, которые работают с одной и той же системой обмена сообщениями). Несвязанные поставщики услуг не принадлежат к одной и той же службе сообщений. Используйте профиль для интеграции несвязанных поставщиков услуг и служб сообщений.
    
2. Определите, какой тип поставщиков услуг должен быть включен в службу сообщений. Большинство служб messge включают по одному поставщику каждого из общих типов. То есть у обычной службы сообщений есть один поставщик адресной книги, один поставщик магазинов сообщений и один поставщик транспорта.
    
3. Определите, сколько DLLs должно содержать службу сообщений. Количество DLLs, которое использует служба сообщений, зависит от следующих:
    
   - Степень сложности, которую вы, как автор службы сообщений, готовы обрабатывать.
    
   - Тип поставщиков услуг в службе сообщений.
    
   - Связь службы сообщений с другой службой сообщений.
    
   Так как MAPI хранит только одну точку входа для каждого типа поставщика, не включай несколько поставщиков одного типа в один DLL. Если имеет смысл включать несколько поставщиков одного типа, либо реализуйте их в отдельные DLLs, либо ведите их совместно с функцией точки входа. Другой вариант — реализовать связанные службы сообщений или службы сообщений, которые могут использовать один и тот же код установки и конфигурации и ту же функцию точек входа DLL в одной DLL.
    
   По возможности сохраняйте его простым и используйте один DLL, содержащий реализацию всех поставщиков услуг в службе сообщений и весь код для установки и настройки службы сообщений. Если это невозможно, можно реализовать один DLL для кода установки и конфигурации, а также один DLL для всех поставщиков услуг или один DLL для каждого поставщика.
    
4. Определите имя службы сообщений DLL или DLLs. 
    
## <a name="see-also"></a>См. также

- [Реализация службы сообщений](message-service-implementation.md)


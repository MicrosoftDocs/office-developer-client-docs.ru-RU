---
title: имапипропжетидсфромнамес
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.GetIDsFromNames
api_type:
- COM
ms.assetid: e3f501a4-a8ee-43d7-bd83-c94e7980c398
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 28880b818bc80e31cae0c695d4aac92eb9555cac
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433586"
---
# <a name="imapipropgetidsfromnames"></a>IMAPIProp::GetIDsFromNames

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Предоставляет идентификаторы свойств, соответствующие одному или нескольким именам свойств.
  
```cpp
HRESULT GetIDsFromNames(
  ULONG cPropNames,
  LPMAPINAMEID FAR * lppPropNames,
  ULONG ulFlags,
  LPSPropTagArray FAR * lppPropTags
);
```

## <a name="parameters"></a>Параметры

 _кпропнамес_
  
> возврата Количество имен свойств, на которые указывает параметр _лпппропнамес_ . Если _лпппропнамес_ имеет значение null, параметр _кпропнамес_ должен иметь значение 0. 
    
 _лпппропнамес_
  
> возврата Указатель на массив имен свойств или значение NULL. Передача идентификаторов свойств NULL для всех имен свойств во всех наборах свойств, сведения о котором имеются у объекта. Параметр _лпппропнамес_ не может иметь значение null, если установлен флаг MAPI_CREATE в параметре _ulFlags_ . 
    
 _ulFlags_
  
> возврата Битовая маска флагов, указывающая, как должны возвращаться идентификаторы свойств. Можно задать следующий флаг:
    
MAPI_CREATE 
  
> Присваивает идентификатор свойства, если он еще не назначен, одному или нескольким именам, включенным в массив имен свойств, на который указывает _лпппропнамес_. Этот флаг регистрирует идентификатор в таблице сопоставлений "имя — идентификатор".
    
 _лпппроптагс_
  
> вышли Указатель на указатель на массив тегов свойств, который содержит существующие или новые назначенные идентификаторы свойств. Для типов свойств для тегов свойств в этом массиве устанавливается значение **PT_UNSPECIFIED**.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Идентификаторы для указанных имен свойств успешно возвращены.
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает именованные свойства.
    
MAPI_E_NOT_ENOUGH_MEMORY 
  
> Недостаточно памяти для получения идентификаторов.
    
MAPI_E_TOO_BIG 
  
> Операция не может быть выполнена, так как ей требуется слишком много тегов свойств, которые необходимо вернуть.
    
MAPI_W_ERRORS_RETURNED 
  
> Вызов выполнен в целом, но не удалось вернуть один или несколько идентификаторов свойств. Соответствующий тип свойства для каждого доступного свойства имеет значение **PT_ERROR** , а его идентификатор — ноль. При возвращении этого предупреждения обработайте вызов как успешный. Чтобы проверить это предупреждение, используйте макрос **HR_FAILED** . Просмотр и [Использование макросов для обработки ошибок](using-macros-for-error-handling.md).
    
## <a name="remarks"></a>Примечания

Метод **IMAPIProp:: жетидсфромнамес** извлекает массив тегов свойств, которые содержат идентификаторы свойств для одного или нескольких именованных свойств. **IMAPIProp:: жетидсфромнамес** может вызываться для выполнения следующих действий: 
  
- Создание идентификаторов для новых имен.
    
- Получение идентификаторов для определенных имен.
    
- Получение идентификаторов для всех именованных свойств, включенных в сопоставление объекта.
    
Именованные свойства обычно используются поставщиками хранилищ сообщений для папок и сообщений. Другие объекты, такие как пользователи обмена сообщениями и разделы профилей, могут не поддерживать связь имен с идентификаторами свойств и могут возвращать MAPI_E_NO_SUPPORT из **жетидсфромнамес**.
  
Если возникает ошибка, возвращающая идентификатор для определенного имени, **жетидсфромнамес** возвращает MAPI_W_ERRORS_RETURNED и задает тип свойства в записи массива тегов свойства, соответствующей имени **PT_ERROR** , и идентификатору, равным нулю. 
  
Сопоставление имен с идентификаторами представлено свойством **PR_MAPPING_SIGNATURE** объекта ([PidTagMappingSignature](pidtagmappingsignature-canonical-property.md)). **PR_MAPPING_SIGNATURE** содержит структуру [мапиуид](mapiuid.md) , указывающую поставщика услуг, ответственного за объект. Если свойство **PR_MAPPING_SIGNATURE** одинаково для двух объектов, предполагается, что эти объекты используют одно и то же сопоставление имен и идентификаторов. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Идентификаторы, которые вы передаете в массиве тегов свойств, на который указывает параметр _лпппропнамес_ , должны находиться в диапазоне от 0x8000 до 0xFFFE. Записи в этом массиве должны находиться в том же порядке, что и имена, переданные в массиве имен свойств, на который указывает _лпппропнамес_. 
  
Если вы поддерживаете именованные свойства в контейнере, используйте одинаковое сопоставление имен и идентификаторов для всех объектов в вашем контейнере (то есть не используйте для каждой папки в хранилище сообщений или каждого сообщения в папке другое сопоставление).
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Так как типы свойств для возвращенных идентификаторов в массиве тегов свойств, на который указывает _лпппроптагс_ , имеют значение **PT_UNSPECIFIED**, необходимо вызвать метод [IMAPIProp:: SetProps](imapiprop-setprops.md) , чтобы получить точные типы. 
  
Если вы перемещаете или копируете объекты с именованными свойствами, а исходный и конечный объекты имеют разные подписи сопоставления, как указано значениями их свойств **PR_MAPPING_SIGNATURE** , необходимо сохранить имена во время этих операций. Чтобы сохранить имена свойств, измените соответствующие идентификаторы свойств в соответствии с сопоставлением имен с идентификатором целевого объекта. 
  
Некоторые объекты имеют ограничения на количество идентификаторов свойств, которые могут иметь имена. Если вызов **жетидсфромнамес** приводит к превышению этого ограничения, метод возвращает MAPI_E_TOO_BIG. В этом случае запрос выполняется по идентификатору. 
  
Дополнительные [сведения см.](mapi-named-properties.md) 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Синглемапипроплистктрл. cpp  <br/> |Ксинглемапипроплистктрл:: Финдаллнамедпропсусед  <br/> |MFCMAPI использует метод **IMAPIProp:: жетидсфромнамес** для получения тегов свойств для всех сопоставленных именованных свойств.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md)
  
[IMAPIProp::SetProps](imapiprop-setprops.md)
  
[MAPINAMEID](mapinameid.md)
  
[MAPIUID](mapiuid.md)
  
[IMAPIProp : IUnknown](imapipropiunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Именованные свойства MAPI](mapi-named-properties.md)
  
[Использование макросов для обработки ошибок](using-macros-for-error-handling.md)


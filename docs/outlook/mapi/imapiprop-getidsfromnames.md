---
title: IMAPIPropGetIDsFromNames
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPIProp.GetIDsFromNames
api_type:
- COM
ms.assetid: e3f501a4-a8ee-43d7-bd83-c94e7980c398
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 28880b818bc80e31cae0c695d4aac92eb9555cac
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33433586"
---
# <a name="imapipropgetidsfromnames"></a>IMAPIProp::GetIDsFromNames

  
  
**Область применения**: Outlook 2013 | Outlook 2016 
  
Предоставляет идентификаторы свойств, соответствующие одному или более имени свойств.
  
```cpp
HRESULT GetIDsFromNames(
  ULONG cPropNames,
  LPMAPINAMEID FAR * lppPropNames,
  ULONG ulFlags,
  LPSPropTagArray FAR * lppPropTags
);
```

## <a name="parameters"></a>Parameters

 _cPropNames_
  
> [in] Количество имен свойств, на которые указывает параметр _lppPropNames._ Если  _lppPropNames_ является NULL, параметр  _cPropNames_ должен быть 0. 
    
 _lppPropNames_
  
> [in] Указатель на массив имен свойств или NULL. Передача NULL запрашивает идентификаторы свойств для всех имен свойств во всех наборах свойств, о которых объект имеет сведения. Параметр _lppPropNames_ не должен быть NULL, если флаг MAPI_CREATE в _параметре ulFlags._ 
    
 _ulFlags_
  
> [in] Битмашка флагов, которая указывает, как должны быть возвращены идентификаторы свойств. Можно установить следующий флаг:
    
MAPI_CREATE 
  
> Назначает идентификатор свойства, если он еще не назначен, одному или несколько имен, включенных в массив имен свойств, на которые указывает _lppPropNames._ Этот флаг регистрирует идентификатор в таблице сопоставления от имени к идентификатору.
    
 _lppPropTags_
  
> [вышел] Указатель на указатель на массив тегов свойств, содержащий существующие или недавно назначенные идентификаторы свойств. Типы свойств тегов свойств в этом массиве заданной для **PT_UNSPECIFIED.**
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Идентификаторы для указанных имен свойств были успешно возвращены.
    
MAPI_E_NO_SUPPORT 
  
> Объект не поддерживает именимые свойства.
    
MAPI_E_NOT_ENOUGH_MEMORY 
  
> Недостаточная память была доступна для получения идентификаторов.
    
MAPI_E_TOO_BIG 
  
> Операция не может быть выполнена, так как для ее возврата требуется слишком много тегов свойств.
    
MAPI_W_ERRORS_RETURNED 
  
> Вызов удался в целом, но один или несколько идентификаторов свойств не удалось вернуть. Соответствующий тип свойства для каждого недоступного свойства PT_ERROR и его идентификатор до нуля.  Когда это предупреждение возвращается, обработать вызов как успешный. Чтобы проверить это предупреждение, используйте **HR_FAILED** макрос. См. в руб. Использование [макроса для обработки ошибок.](using-macros-for-error-handling.md)
    
## <a name="remarks"></a>Примечания

Метод **IMAPIProp::GetIDsFromNames** извлекает массив тегов свойств, которые удерживают идентификаторы свойств для одного или более именных свойств. **IMAPIProp::GetIDsFromNames** можно назвать следующим образом: 
  
- Создание идентификаторов для новых имен.
    
- Извлечение идентификаторов для определенных имен.
    
- Извлечение идентификаторов для всех именных свойств, включенных в сопоставление объекта.
    
Свойства имен обычно используются поставщиками магазинов сообщений для папок и сообщений. Другие объекты, например пользователи сообщений и разделы профилей, могут не поддерживать связь имен с идентификаторами свойств и могут возвращать MAPI_E_NO_SUPPORT из **GetIDsFromNames.**
  
При ошибке, возвращаемой идентификатором для определенного имени, **GetIDsFromNames** возвращает MAPI_W_ERRORS_RETURNED и задает тип свойства в записи массива тегов свойств, соответствующей имени PT_ERROR и идентификатору до нуля.  
  
Сопоставление имен и идентификаторов представлено свойством PR_MAPPING_SIGNATURE **объекта** [(PidTagMappingSignature).](pidtagmappingsignature-canonical-property.md) **PR_MAPPING_SIGNATURE** [содержит структуру MAPIUID,](mapiuid.md) которая указывает поставщика услуг, ответственного за объект. Если **свойство PR_MAPPING_SIGNATURE** одно и то же для двух объектов, предположим, что эти объекты используют одно и то же сопоставление от имени к идентификатору. 
  
## <a name="notes-to-implementers"></a>Примечания для исполнителей

Идентификаторы, которые передаются в массиве тегов свойств, на которые указывает параметр  _lppPropNames,_ должны быть в диапазоне 0x8000 0xFFFE. Записи в этом массиве должны быть в том же порядке, что и имена, переданные в массиве имен свойств, на которые указывает _lppPropNames._ 
  
Если вы поддерживаете свойства с именем в контейнере, используйте одно и то же сопоставление от имени к идентификатору для всех объектов в контейнере (то есть не используйте другое сопоставление для каждой папки в хранилище сообщений или каждого сообщения в папке).
  
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Поскольку типы свойств возвращаемого идентификатора в массиве тегов свойств, на которые указывают _lppPropTags,_ настроены на **PT_UNSPECIFIED,** для получения точных типов необходимо вызвать [метод IMAPIProp::SetProps.](imapiprop-setprops.md) 
  
Если вы перемещаете или **копируете** объекты с указанными свойствами, а объекты источника и назначения имеют различные подписи сопоставления, указанные значениями их свойств PR_MAPPING_SIGNATURE, необходимо сохранить имена во время этих операций. Чтобы сохранить имена свойств, настройте соответствующие идентификаторы свойств в соответствие с сопоставлением имени и идентификатора объекта назначения. 
  
Некоторые объекты имеют ограничение на количество идентификаторов свойств, которые они могут назвать. Если вызов **в GetIDsFromNames** приводит к превышению этого ограничения, метод возвращает MAPI_E_TOO_BIG. В этом случае запрос по идентификатору. 
  
Дополнительные сведения см. в [дополнительных сведениях о свойствах MAPI Named Properties.](mapi-named-properties.md) 
  
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|SingleMAPIPropListCtrl.cpp  <br/> |CSingleMAPIPropListCtrl::FindAllNamedPropsUsed  <br/> |MFCMAPI использует **метод IMAPIProp::GetIDsFromNames** для получения тегов свойств для всех именных свойств, которые были намечаемы.  <br/> |
   
## <a name="see-also"></a>См. также



[IMAPIProp::GetNamesFromIDs](imapiprop-getnamesfromids.md)
  
[IMAPIProp::SetProps](imapiprop-setprops.md)
  
[MAPINAMEID](mapinameid.md)
  
[MAPIUID](mapiuid.md)
  
[IMAPIProp : IUnknown](imapipropiunknown.md)


[MFCMAPI как пример кода](mfcmapi-as-a-code-sample.md)
  
[Именованные свойства MAPI](mapi-named-properties.md)
  
[Использование макроса для обработки ошибок](using-macros-for-error-handling.md)


---
title: имаписессионсетдефаултсторе
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IMAPISession.SetDefaultStore
api_type:
- COM
ms.assetid: 456c207f-5d41-4d0c-94b6-0c58893a6bed
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: f4ff2a3897306ebe4f77c08630782c5f2c7d5d3d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33426109"
---
# <a name="imapisessionsetdefaultstore"></a>IMAPISession::SetDefaultStore

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Устанавливает хранилище сообщений в качестве хранилища сообщений по умолчанию для данного сеанса.
  
```cpp
HRESULT SetDefaultStore(
  ULONG ulFlags,
  ULONG cbEntryID,
  LPENTRYID lpEntryID
);
```

## <a name="parameters"></a>Параметры

 _ulFlags_
  
> возврата Битовая маска флагов, которые управляют параметром хранилища сообщений по умолчанию. Эти флаги являются взаимоисключающими; можно задать только один из следующих флагов:
    
MAPI_DEFAULT_STORE
  
> Задает хранилище сообщений по умолчанию для сеанса. Обновляет строку таблицы состояния хранилища сообщений, устанавливая флаг STATUS_DEFAULT_STORE в столбце **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)).
    
MAPI_PRIMARY_STORE
  
> Создает хранилище сообщений в качестве хранилища, которое будет использоваться при входе в систему. Если хранилище сообщений не является хранилищем по умолчанию, клиенты должны сделать его значением по умолчанию. Обновляет строку таблицы состояния хранилища сообщений, устанавливая флаг STATUS_PRIMARY_STORE в столбце **PR_RESOURCE_FLAGS** . 
    
MAPI_SECONDARY_STORE
  
> Создает хранилище сообщений в качестве хранилища, которое будет использоваться при входе в систему, если основное хранилище сообщений недоступно. Если клиент не может открыть основное хранилище, он должен открыть дополнительное хранилище и сделать его значением по умолчанию. Обновляет строку таблицы состояния хранилища сообщений, устанавливая флаг STATUS_SECONDARY_STORE в столбце **PR_RESOURCE_FLAGS** . 
    
MAPI_SIMPLE_STORE_PERMANENT
  
> Задает флаг STATUS_SIMPLE_STORE в свойстве **PR_RESOURCE_FLAGS** хранилища сообщений в строке таблицы состояний, в строке таблицы хранилища сообщений и в профиле сеанса. 
    
MAPI_SIMPLE_STORE_TEMPORARY
  
> Задает флаг STATUS_SIMPLE_STORE в свойстве **PR_RESOURCE_FLAGS** хранилища сообщений в строке таблицы состояний и строке таблицы хранилища сообщений. Профиль не изменяется. 
    
 _кбентрид_
  
> возврата Число байтов в идентификаторе записи, на которое указывает параметр _лпентрид_ . 
    
 _лпентрид_
  
> возврата Указатель на идентификатор записи хранилища сообщений, который используется по умолчанию. Если клиент передает значение NULL в _лпентрид_, в качестве значения по умолчанию не выбрано ни одного хранилища сообщений.
    
## <a name="return-value"></a>Возвращаемое значение

S_OK 
  
> Вызов выполнен успешно и вернул ожидаемое значение или значения.
    
## <a name="remarks"></a>Примечания

Метод **IMAPISession:: сетдефаултсторе** устанавливает хранилище сообщений одним из следующих способов: 
  
- Хранилище сообщений по умолчанию для сеанса.
    
- Основной банк сообщений для сеанса.
    
- Дополнительное хранилище сообщений для сеанса.
    
Для установки хранилища сообщений по умолчанию в свойстве **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) в хранилище сообщений должны быть установлены следующие флаги:
  
- STORE_SUBMIT_OK
    
- STORE_CREATE_OK
    
- STORE_MODIFY_OK
    
## <a name="notes-to-callers"></a>Примечания для вызывающих методов

Вы можете определить хранилище сообщений по умолчанию для сеанса, изменив таблицу состояния и выполнив поиск значения флага STATUS_DEFAULT_STORE в столбце **PR_RESOURCE_FLAGS** . Строка с этим параметром представляет собой хранилище сообщений, назначенное в качестве сеанса по умолчанию. 
  
Если установлен флаг MAPI_DEFAULT_STORE или MAPI_SIMPLE_STORE_PERMANENT, MAPI обновляет данные профиля, таблицы хранилища сообщений и таблицы состояния. 
  
При внесении изменений в параметр хранилища сообщений по умолчанию создаются следующие уведомления:
  
- Уведомление о событии **фневтаблемодифиед** создается для каждой затронутой строки в таблице "хранилище сообщений" и "состояние". 
    
- В очередь печати MAPI отправляется внутреннее уведомление. Выполняемые операции выполняются без изменений; новые операции, использующие хранилище сообщений по умолчанию (например, загрузку сообщений), обрабатываются для нового хранилища по умолчанию.
    
## <a name="mfcmapi-reference"></a>Справочные материалы по MFCMAPI

Пример кода MFCMAPI указан в приведенной ниже таблице.
  
|**Файл**|**Функция**|**Примечание**|
|:-----|:-----|:-----|
|Маиндлг. cpp  <br/> |Кмаиндлг:: Онсетдефаултсторе  <br/> |MFCMAPI использует метод **IMAPISession:: сетдефаултсторе** , чтобы установить выбранное хранилище в качестве хранилища по умолчанию.  <br/> |
   
## <a name="see-also"></a>См. также



[Каноническое свойство PidTagResourceFlags](pidtagresourceflags-canonical-property.md)
  
[Каноническое свойство PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)
  
[TABLE_NOTIFICATION](table_notification.md)
  
[IMAPISession: IUnknown](imapisessioniunknown.md)


[Mfcmapi (en) � �������� ������� ����](mfcmapi-as-a-code-sample.md)


---
title: ChangeIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ChangeIdleRoutine
api_type:
- HeaderDef
ms.assetid: 0a24fe3b-a1ef-4748-b3b3-3bf747473c9d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: cfec9356a866c79b687497c3af007c046a20a75e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418269"
---
# <a name="changeidleroutine"></a>ChangeIdleRoutine

**Область применения**: Outlook 2013 | Outlook 2016 
  
Изменяет некоторые или все характеристики обычного простоя на основе [FNIDLE.](fnidle.md) 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
VOID ChangeIdleRoutine(
  FTG ftg,
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle,
  USHORT ircIdle
);
```

## <a name="parameters"></a>Parameters

_ftg_
  
> [in] Тег Функции, определяя режим простоя. 
    
_pfnIdle_
  
> [in] Указатель на режим простоя. 
    
_pvIdleParam_
  
> [in] Указатель на новый блок памяти, который реализация вызовов выделяет для простоя. 
    
_priIdle_
  
> [in] Значение, представляющее новый приоритет для простоя. Возможные приоритеты для процедур, определенных реализацией, больше или меньше нуля, но не ноль. Значение нуля зарезервировано для события пользователя, например щелчка мыши или WM_PAINT сообщения. Значения, более нулевые, представляют приоритеты для фоновых задач, которые имеют более высокий приоритет, чем события пользователя, и отправляются в рамках стандартной Windows помпы сообщений. Значения менее нуля представляют приоритеты для задач, которые работают только во время простоя помпы сообщений. Примеры приоритетов: 1 для представления переднего плана, 1 для вставки символов для редактирования питания и 3 для скачивания новых сообщений.
    
_csecIdle_
  
> [in] Новое время, в сотые секунды, чтобы применить к режиму простоя. Значение начального значения времени варьируется в зависимости от того, что передается в _параметре iroIdle._ Это может быть: 
    
  - Минимальный период бездействия пользователей, который должен пройти до того, как простой двигатель MAPI впервые вызывает режим простоя, если флаг FIROWAIT установлен в _iroIdle._ После этого времени, простаивающим двигателем можно вызвать праздный режим так часто, как это необходимо. 
    
  - Минимальный интервал между вызовами в режим простоя, если флаг FIROINTERVAL задан в _iroIdle._ 
    
_iroIdle_
  
> [in] Bitmask флагов, указывающих на новые параметры для вызова простоя рутины. Необходимо установить один из следующих флагов:
    
  - FIROINTERVAL. Время, указанное параметром  _csecIdle,_ — это минимальный интервал между последовательными вызовами в режим простоя. 
      
  - FIROONCEONLY. Устарело. Не следует использовать. 
      
  - FIROPERBLOCK. Устарело. Не следует использовать. 
      
  - FIROWAIT. Время, указанное параметром  _csecIdle,_ — это минимальный период бездействия пользователя, который должен пройти до того, как простаивая система MAPI впервые вызывает режим простоя. После этого времени, простаивающим двигателем можно вызвать праздный режим так часто, как это необходимо. 
    
_ircIdle_
  
> [in] Bitmask флагов, используемых для указать изменения, которые необходимо внести в режим простоя. Следующие флаги можно установить в любой комбинации:
    
  - FIRCCSEC. Изменение времени, связанного с режимом простоя, то есть изменение, обозначенное значением, переданным в _параметре csecIdle._ 
      
  - FIRCIRO: Изменение параметров обычного простоя, то есть изменения, указанные в значении, переданном в _параметре iroIdle._ 
      
  - FIRCPFN. Изменение простаиваемой обычной указки, то есть изменения, указанные значением, переданным в _параметре pfnIdle._ 
      
  - FIRCPRI. Изменение приоритета обычного простоя, то есть изменения, указанные значением, переданным в _параметре priIdle._ 
      
  - FIRCPV. Изменение блока памяти простоя, то есть изменение, обозначенное значением, переданным в _параметре pvIdleParam._ 
    
## <a name="return-value"></a>Возвращаемое значение

Нет.
  
## <a name="remarks"></a>Примечания

Следующие функции выполняются с простаивающим двигателем MAPI и простаивающим режимом на основе прототипа [функции FNIDLE:](fnidle.md) 
  
|**Простаиваемая рутинная функция**|**Использование**|
|:-----|:-----|
|**ChangeIdleRoutine** <br/> |Изменяет характеристики зарегистрированного режима простоя.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированную процедуру простоя из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированный режим простоя без удаления его из системы MAPI.  <br/> |
|[FtgRegisterIdleRoutine](ftgregisteridleroutine.md) <br/> |Добавляет праздную рутину в систему MAPI с ее включением или без нее.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Отключит простой движок MAPI для вызываемой программы.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует простой двигатель MAPI для вызываемой заявки.  <br/> |
   
**ChangeIdleRoutine,** **DeregisterIdleRoutine** и **EnableIdleRoutine** принимают в качестве параметра ввода тег функции, возвращенный **FtgRegisterIdleRoutine**. 
  
Когда все задачи переднего плана для платформы простаивают, простаивающим двигателем MAPI называются самые приоритетные режимы простоя, готовые к выполнению. Не гарантируется порядок вызова среди праздных режимов одного и того же приоритета. 
  


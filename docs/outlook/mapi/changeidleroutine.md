---
title: ChangeIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ChangeIdleRoutine
api_type:
- HeaderDef
ms.assetid: 0a24fe3b-a1ef-4748-b3b3-3bf747473c9d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: cfec9356a866c79b687497c3af007c046a20a75e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418269"
---
# <a name="changeidleroutine"></a>ChangeIdleRoutine

**Относится к**: Outlook 2013 | Outlook 2016 
  
Изменяет некоторые или все характеристики процедуры бездействия на основе [фнидле](fnidle.md) . 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Мапиутил. h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
VOID ChangeIdleRoutine(
  FTG ftg,
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle,
  USHORT ircIdle
);
```

## <a name="parameters"></a>Параметры

_ФТГ_
  
> возврата Тег функции, определяющий подпрограмму Idle. 
    
_Пфнидле_
  
> возврата Указатель на подпрограмму Idle. 
    
_Пвидлепарам_
  
> возврата Указатель на новый блок памяти, выделенный вызывающей реализацией для процедуры Idle. 
    
_Приидле_
  
> возврата Значение, представляющее новый приоритет для процедуры простоя. Возможные приоритеты для подпрограмм, определенных при реализации, больше или меньше нуля, но не равны нулю. Нулевое значение зарезервировано для события пользователя, такого как щелчок мыши или сообщение WM_PAINT. Значения больше нуля представляют приоритеты для фоновых задач, которые имеют более высокий приоритет, чем события пользователя, и отправляются как часть стандартного цикла приема сообщений Windows. Значения, меньшие нуля, представляют приоритеты для бездействующих задач, которые выполняются только во время простоя для приема сообщений. Примерами приоритетов являются: 1 для отправки на передний план, 1 для вставки символов Power и 3 для загрузки новых сообщений.
    
_КсеЦидле_
  
> возврата Новое время в сотых долях секунды, которое применяется к процедуре бездействия. Значение начального значения времени может различаться в зависимости от того, что передается в параметре _ироидле_ . Возможные значения: 
    
  - Минимальный период действия пользователя, который должен пройти, прежде чем антивирусное ядро MAPI вызывает подпрограмму простоя в первый раз, если установлен флаг ФИРОВАИТ в _ироидле_. По исТечении этого времени модуль простоя может вызывать процедуру простоя, как это необходимо. 
    
  - Минимальный интервал между вызовами процедуры Idle, если установлен флаг ФИРОИНТЕРВАЛ в _ироидле_. 
    
_Ироидле_
  
> возврата Битовая маска флагов, указывающих новые параметры для вызова процедуры бездействия. Необходимо задать только один из следующих флагов:
    
  - ФИРОИНТЕРВАЛ: время, заданное параметром _ксеЦидле_ , является минимальным интервалом между последовательными вызовами процедуры Idle. 
      
  - ФИРУНЦЕОНЛИ: устарело. Не следует использовать. 
      
  - ФИРОПЕРБЛОКК: устарело. Не следует использовать. 
      
  - ФИРОВАИТ: время, заданное параметром _ксеЦидле_ , является минимальным периодом действия пользователя, который должен пройти, прежде чем антивирусное ядро MAPI вызывает подпрограмму простоя в первый раз. По исТечении этого времени модуль простоя может вызывать процедуру простоя, как это необходимо. 
    
_ИрЦидле_
  
> возврата Битовая маска флагов, используемых для указания изменений, которые необходимо внести в подпрограмму периода бездействия. Следующие флаги можно задавать в любом сочетании:
    
  - ФИРККСЕК: изменяет время, связанное с подпрограммой простоя, то есть изменением, указанным значением, переданным в параметре _ксеЦидле_ . 
      
  - ФИРЦИРО: изменение параметров для подпрограммы периода бездействия, то есть изменения, которые указываются значением, переданным в параметре _ироидле_ . 
      
  - ФИРКПФН: изменение указателя на процедуру простоя, то есть изменение, заданное значением, переданным в параметре _пфнидле_ . 
      
  - ФИРКПРИ: изменение приоритета неактивной процедуры, то есть изменения, которые указываются значением, переданным в параметре _приидле_ . 
      
  - ФИРКПВ: изменение блока памяти для подпрограммы Idle, то есть изменения, которые указываются значением, переданным в параметре _пвидлепарам_ . 
    
## <a name="return-value"></a>Возвращаемое значение

Нет.
  
## <a name="remarks"></a>Примечания

Следующие функции работают с модулем бездействия MAPI и с процедурами Idle, основанными на прототипе функции [фнидле](fnidle.md) : 
  
|**Функция неАктивности**|**Usage**|
|:-----|:-----|
|**ChangeIdleRoutine** <br/> |Изменяет характеристики зарегистрированной процедуры бездействия.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированную процедуру бездействия из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированную подпрограмму бездействия, не удаляя ее из системы MAPI.  <br/> |
|[FtgRegisterIdleRoutine](ftgregisteridleroutine.md) <br/> |Добавляет подпрограмму бездействия в систему MAPI с включением или без него.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Завершает работу модуля бездействия MAPI для вызывающего приложения.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует модуль бездействия MAPI для вызывающего приложения.  <br/> |
   
**Чанжеидлераутине**, **дерегистеридлераутине**и **енаблеидлераутине** принимают в качестве входного параметра тег функции, возвращенный методом **фтгрегистеридлераутине**. 
  
Когда все фоновые задачи для платформы становятся неактивными, модуль бездействия MAPI вызывает подпрограмму самого высокого приоритета, готовую к выполнению. Не существует гарантии того, что вы звоните между процедурами неактивности и одинаковым приоритетом. 
  


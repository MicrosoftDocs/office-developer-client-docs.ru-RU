---
title: ChangeIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ChangeIdleRoutine
api_type:
- HeaderDef
ms.assetid: 0a24fe3b-a1ef-4748-b3b3-3bf747473c9d
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: cfec9356a866c79b687497c3af007c046a20a75e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33418269"
---
# <a name="changeidleroutine"></a>ChangeIdleRoutine

**Относится к**: Outlook 2013 | Outlook 2016 
  
Изменяет некоторые или все характеристики процедуры бездействия на основе [FNIDLE.](fnidle.md) 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализовано в:  <br/> |MAPI  <br/> |
|Вызывающая сторона:  <br/> |Клиентские приложения и поставщики услуг  <br/> |
   
```cpp
VOID ChangeIdleRoutine(
  FTG ftg,
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle,
  USHORT ircIdle
);
```

## <a name="parameters"></a>Параметры

_ftg_
  
> [in] Тег функции, определяя процедуру бездействия. 
    
_pfnIdle_
  
> [in] Указатель на процедуру бездействия. 
    
_pvIdleParam_
  
> [in] Указатель на новый блок памяти, который реализация вызова выделяет для процедуры простоя. 
    
_priIdle_
  
> [in] Значение, представляющее новый приоритет для процедуры простоя. Возможные приоритеты для процедур, определяемой реализацией, больше или меньше нуля, но не нуль. Нулевое значение зарезервировано для события пользователя, например щелчка мыши или WM_PAINT сообщения. Значения больше нуля представляют приоритеты для фоновых задач, которые имеют более высокий приоритет, чем события пользователя, и отправляются в рамках стандартного цикла зациклки сообщений Windows. Значения меньше нуля представляют приоритеты для задач бездейства, которые запускались только во время простоя сообщений. Примеры приоритетов: 1 для отправки на переднем плане, 1 для вставки символов питания и 3 для загрузки новых сообщений.
    
_csecIdle_
  
> [in] Новое время (в сотых секундах) для применения к процедуре простоя. Значение начального значения времени зависит от того, что передается в _параметре iroIdle._ Это может быть: 
    
  - Минимальный период бездействия пользователя, который должен пройти до первого вызова процедуры простоя MAPI, если флаг FIROWAIT установлен в _iroIdle._ По идентности этого времени механизм бездействия может вызывать процедуру простоя по мере необходимости. 
    
  - Минимальный интервал между вызовами процедуры простоя, если флаг FIROINTERVAL установлен _в iroIdle._ 
    
_iroIdle_
  
> [in] Битоваяmas флагов, обозначающее новые параметры вызова процедуры бездействия. Необходимо установить только один из следующих флагов:
    
  - FIROINTERVAL: время, заданное параметром  _csecIdle,_ — это минимальный интервал между последовательными вызовами процедуры простоя. 
      
  - FIROONCEONLY: устаревшее. Не следует использовать. 
      
  - FIROPERBLOCK: устаревшее. Не следует использовать. 
      
  - FIROWAIT: время, заданное параметром  _csecIdle,_ — это минимальный период бездействия пользователя, который должен пройти, прежде чем механизм бездействия MAPI впервые вызывает процедуру простоя. По идентности этого времени механизм бездействия может вызывать процедуру простоя по мере необходимости. 
    
_ircIdle_
  
> [in] Битоваяmas флагов, используемых для того, чтобы указать изменения, которые необходимо внести в процедуру простоя. Следующие флаги можно установить в любом сочетании:
    
  - FIRCCSEC: изменение времени, связанного с процедурой простоя, то есть изменение, обозначенное значением, переданным в _параметре csecIdle._ 
      
  - FIRCКЛЮЧЕВЫХ: изменение параметров процедуры простоя, то есть изменение, заданное значением, переданным в _параметре iroIdle._ 
      
  - FIRCPFN: изменение указателя процедуры бездействия, то есть изменение, заданное значением, переданным в _параметре pfnIdle._ 
      
  - FIRCPRI: изменение приоритета процедуры простоя, то есть изменение, заданное значением, переданным в _параметре priIdle._ 
      
  - FIRCPV: изменение блока памяти процедуры простоя, то есть изменение, заданное значением, переданным в _параметре pvIdleParam._ 
    
## <a name="return-value"></a>Возвращаемое значение

Нет.
  
## <a name="remarks"></a>Примечания

Следующие функции работают с механизмом бездействия MAPI и процедурами бездействия на основе прототипа функции [FNIDLE:](fnidle.md) 
  
|**Простаиваемая подпрограмма**|**Использование**|
|:-----|:-----|
|**ChangeIdleRoutine** <br/> |Изменяет характеристики зарегистрированной процедуры бездействия.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированную процедуру бездействия из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированную процедуру бездействия, не удаляя ее из системы MAPI.  <br/> |
|[FtgRegisterIdleRoutine](ftgregisteridleroutine.md) <br/> |Добавляет процедуру бездействия в систему MAPI с ее включением или без нее.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Выключает механизм бездействия MAPI для вызывающим приложением.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует механизм бездействия MAPI для вызывающим приложением.  <br/> |
   
**ChangeIdleRoutine,** **DeregisterIdleRoutine** и **EnableIdleRoutine** принимают в качестве входного параметра тег функции, возвращенный **FtgRegisterIdleRoutine.** 
  
Когда все задачи переднего плана для платформы простаивают, механизм бездействия MAPI вызывает процедуру простоя с наивысшим приоритетом, готовую к выполнению. Порядок вызовов между процедурами бездействия с одинаковым приоритетом не гарантируется. 
  


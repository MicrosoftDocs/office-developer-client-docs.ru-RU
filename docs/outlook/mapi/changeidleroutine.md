---
title: ChangeIdleRoutine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- ChangeIdleRoutine
api_type:
- HeaderDef
ms.assetid: 0a24fe3b-a1ef-4748-b3b3-3bf747473c9d
description: '���� ���������� ���������: 9 ����� 2015 �.'
ms.openlocfilehash: 1fbeccd805953322b579d1490b5e74e5132aa7ce
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2018
ms.locfileid: "19808186"
---
# <a name="changeidleroutine"></a>ChangeIdleRoutine

**Применимо к**: Outlook 
  
Изменяет некоторые или все характеристики простоя подпрограмма [FNIDLE](fnidle.md) на основе. 
  
|||
|:-----|:-----|
|Файл заголовка:  <br/> |Mapiutil.h  <br/> |
|Реализованный:  <br/> |MAPI  <br/> |
|Вызывается:  <br/> |Клиентские приложения и поставщиков услуг  <br/> |
   
```cpp
VOID ChangeIdleRoutine(
  FTG ftg,
  PFNIDLE pfnIdle,
  LPVOID pvIdleParam,
  short priIdle,
  ULONG csecIdle,
  USHORT iroIdle,
  USHORT ircIdle
);
```

## <a name="parameters"></a>Parameters

_ftg_
  
> [in] Функция тег, идентифицирующий простоя процедуры. 
    
_pfnIdle_
  
> [in] Указатель на простоя процедуры. 
    
_pvIdleParam_
  
> [in] Указатель на новый блок памяти, вызывающий реализации выделяет для бездействующих процедуры. 
    
_priIdle_
  
> [in] Значение, представляющее новый приоритет для бездействующих процедуры. Возможных приоритетов для реализации процедуры больше или меньше, чем нулю, но не ноль. Нулевое значение зарезервировано для событие пользователя, например, одним щелчком мыши или сообщение WM_PAINT. Приоритеты для фоновых задач, которые имеют более высокий приоритет, чем событий пользователя и отправляется как часть стандартного цикла обработки сообщений Windows представляют значения больше нуля. Значения меньше, чем нулевой представляют приоритеты для бездействующих задачи, на которых выполняется только во время простоя обработки сообщений. Примеры приоритетов: 1 для отправки переднего плана, 1 для вставки символ power Правка и 3 для загрузки новых сообщений.
    
_csecIdle_
  
> [in] Время в сотые доли секунды, для применения к простоя подпрограммы новый. Смысл значения начальное время, может изменяться в зависимости от того, что передается в параметре _iroIdle_ . Это может быть: 
    
  - Минимальный период бездействия со стороны пользователя, которое должно пройти перед MAPI простоя механизм вызывает простоя подпрограммы в первый раз, если флаг FIROWAIT установлен в _iroIdle_. По истечении этого времени простоя модуль может вызывать простоя процедуру при необходимости. 
    
  - Минимальный интервал между вызовами простоя процедуру, если флаг FIROINTERVAL установлен в _iroIdle_. 
    
_iroIdle_
  
> [in] Битовая маска, указывающее новые параметры для вызова простоя подпрограммы флагов. Должны быть установлены только один из следующих флагов.
    
  - FIROINTERVAL: Времени, указанного с помощью параметра _csecIdle_ — это минимальный интервал между последовательными вызовами простоя процедуру. 
      
  - FIROONCEONLY: устаревший. Не используйте. 
      
  - FIROPERBLOCK: устаревший. Не используйте. 
      
  - FIROWAIT: Времени, указанного с помощью параметра _csecIdle_ — это минимальный период бездействия со стороны пользователя, которое должно пройти перед простоя подсистемы MAPI вызывает простоя подпрограмму в первый раз. По истечении этого времени простоя модуль может вызывать простоя процедуру при необходимости. 
    
_ircIdle_
  
> [in] Битовая маска флаги служит для указания изменений следует обратить внимание простоя процедуру. Следующие флаги может быть установлено в любом сочетании:
    
  - FIRCCSEC: Изменение времени, связанные с простоя процедуру, то есть, указанный в параметре значение, переданное в параметре _csecIdle_ изменений. 
      
  - FIRCIRO: Внесение изменений в параметры для бездействующих процедуру, то есть изменений, указанный в параметре значение переданной в параметре _iroIdle_ . 
      
  - FIRCPFN: Внесение изменений в простоя выполнять рутинные указатель, то есть изменений, указанный в параметре значение передается в параметре _pfnIdle_ . 
      
  - FIRCPRI: Изменение приоритета простоя процедуру, то есть изменений, указанный в параметре значение передается в параметре _priIdle_ . 
      
  - FIRCPV: Внесение изменений в блоке памяти простоя процедуру, то есть, изменения, указанный в параметре значение переданной в параметре _pvIdleParam_ . 
    
## <a name="return-value"></a>Возвращаемое значение

Нет.
  
## <a name="remarks"></a>Замечания

Следующие функции работы с простоя подсистемы MAPI и на основании прототипа функции [FNIDLE](fnidle.md) простоя процедуры: 
  
|**Функция простоя процедуры**|**Использование**|
|:-----|:-----|
|**ChangeIdleRoutine** <br/> |Изменение характеристик зарегистрированных простоя процедуры.  <br/> |
|[DeregisterIdleRoutine](deregisteridleroutine.md) <br/> |Удаляет зарегистрированные простоя процедуру из системы MAPI.  <br/> |
|[EnableIdleRoutine](enableidleroutine.md) <br/> |Отключает или повторно включает зарегистрированных простоя подпрограмму без его удаления из системы MAPI.  <br/> |
|[FtgRegisterIdleRoutine](ftgregisteridleroutine.md) <br/> |Добавляет простоя подпрограммы система MAPI, независимо от его включение.  <br/> |
|[MAPIDeInitIdle](mapideinitidle.md) <br/> |Завершает работу обработчика бездействия MAPI для вызывающего приложения.  <br/> |
|[MAPIInitIdle](mapiinitidle.md) <br/> |Инициализирует обработчик простоя MAPI для вызывающего приложения.  <br/> |
   
**ChangeIdleRoutine**, **DeregisterIdleRoutine**и **EnableIdleRoutine** принимают в качестве входного параметра, функция тег возвращаемых **FtgRegisterIdleRoutine**. 
  
При бездействии все задачи переднего плана для платформы, механизм простоя MAPI вызывает наивысший приоритет простоя подпрограммы готов к выполнению. Нет никаких гарантий вызова порядок простоя процедуры одинаковый приоритет. 
  


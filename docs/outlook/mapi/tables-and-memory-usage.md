---
title: Таблицы и использование памяти
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7ac11e60-6b2c-4241-96e2-20219f84d949
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: afd69f5a3fff69f670d6be78ba4957307cdb6995
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436862"
---
# <a name="tables-and-memory-usage"></a>Таблицы и использование памяти

**Область применения**: Outlook 2013 | Outlook 2016 
  
Важной проблемой, связанной с сбором данных из таблицы, является использование памяти. Отсутствие доступной памяти может привести к [сбойу IMAPITable::QueryRows](imapitable-queryrows.md) и [HrQueryAllRows,](hrqueryallrows.md) возвращая меньше нужного количества строк. Решение о том, какой метод или функцию использовать для получения данных таблицы, зависит от того, можно ли ожидать, что таблица впишется в память, и если она не может, если сбой допустим. 
  
Так как не всегда легко определить объем данных, которые будут одновременно вписаться в память, MAPI предоставляет некоторые основные рекомендации для клиентского приложения или поставщика услуг. Помните, что всегда существуют исключения, основанные на конкретной реализации таблицы и на том, как хранятся данные.
  
Для оценки использования памяти таблицы можно использовать следующие рекомендации:
  
- Клиенты, которые могут переносить время от времени использование рабочей наборной памяти в диапазоне мегабайт и могут предположить, что у них не будет проблем с чтением всей таблицы в память. 
    
- Ограничения влияют на использование памяти таблицы. Строго ограниченная таблица с большим количеством строк, например таблица контента, может быть вписана в память, в то время как ограниченная большая таблица обычно не может. 
    
- Некоторые таблицы, которые принадлежат MAPI, такие как состояние, профиль, служба сообщений, поставщик и таблицы хранения сообщений, обычно вписываются в память. Как правило, это небольшие таблицы. Однако существуют исключения. Например, поставщик профилей на основе сервера может создать большую таблицу профилей, которая не сможет соответствовать.
    
Чтобы извлечь все строки из таблицы, которая будет вписаться в память без проблем, позвоните [в HrQueryAllRows,](hrqueryallrows.md)установив максимальное количество строк до нуля.
  
Чтобы извлечь все строки из таблицы, которая может или не вписаться в память, создавая ошибку, позвоните **в HrQueryAllRows,** указав максимальное количество строк. Максимальное число строк должно быть установлено на число больше, чем необходимое минимальное число строк. Если клиент должен получить доступ по крайней мере к 50 строкам из таблицы 300 строк, максимальное число строк должно быть установлено не менее 51. 
  
Чтобы извлечь все строки из таблицы, которая не должна вписываться в память, позвоните по телефону [IMAPITable::QueryRows](imapitable-queryrows.md) в цикле с относительно небольшим количеством строк, как показано в следующем примере кода: 
  
```cpp
HRESULT     hr;
LPSRowSet   pRows = NULL;
LONG        irow;
LONG            cAsk = 50;                  // adjust this value
while ((hr = pTable->QueryRows(cAsk, 0, &pRows)) == hrSuccess
        && pRows->cRows != 0)
{
    for (irow = 0; irow < prows->cRows; ++irow)
    {
        // process the row...
    }
    FreeProws(pRows);
    pRows = NULL;
}
if (hr)
{
    // handle the error...
}
 
```

После завершения этого цикла и обработки всех строк в таблице и нулевого  _уровня cRows_ позиция курсора обычно находится в нижней части таблицы. 
  
## <a name="see-also"></a>См. также

- [Таблицы MAPI](mapi-tables.md)


---
title: Таблицы и использование памяти
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7ac11e60-6b2c-4241-96e2-20219f84d949
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: 390cec0cc59f189f83af2c5339512d82e125771e
ms.sourcegitcommit: 9d60cd82b5413446e5bc8ace2cd689f683fb41a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19812472"
---
# <a name="tables-and-memory-usage"></a>Таблицы и использование памяти

**Относится к**: Outlook 
  
Важной проблемы, подключенных к извлечения данных из таблицы — использование памяти. Недостаточно доступной памяти может привести к [IMAPITable::QueryRows](imapitable-queryrows.md) и [HrQueryAllRows](hrqueryallrows.md) к сбою, возвращая меньше, чем требуемое число строк. Решить, какой метод или функцию, чтобы использовать для извлечения данных в таблице зависит от таблицы могут неправильно для размещения в памяти, и если это невозможно, если допустима сбоя. 
  
Так как это не всегда легко определить объем данных, которая подходит в память за один раз, MAPI содержит основные рекомендации, касающиеся клиентское приложение или поставщик услуг для подписки. Имейте в виду, что всегда существуют исключения, на основе реализации определенной таблицы и хранение данных.
  
Для оценки использования памяти в таблице можно использовать со следующими рекомендациями:
  
- Клиенты, которые можно пренебречь периодически об использовании памяти рабочего набора в диапазоне мегабайт и можно допустить они будут иметь нет неполадок с чтение всю таблицу в памяти. 
    
- Ограничения оказывать влияние на таблице использования памяти. Строго ограничивается таблица с широкое число строк, такие как содержание, может проводить помещаются в памяти во время неограниченный большой таблицы обычно нельзя. 
    
- Некоторые из таблиц, принадлежащие MAPI, такие как состояние, профиля, службы сообщений, поставщика и таблиц хранилища сообщений, обычно подходит в памяти. Это обычно небольшой таблицы. Тем не менее существуют исключения. К примеру поставщика профилей на стороне сервера может создать увеличенное таблице профилей, которые не будут помещаться.
    
Чтобы получить все строки из таблицы, которые соответствуют памяти без проблем, вызовите [HrQueryAllRows](hrqueryallrows.md), задание максимального числа строк нулевое значение.
  
Чтобы получить все строки из таблицы, которые могут или может не хватает памяти, сообщение об ошибке, вызовите **HrQueryAllRows** указывает максимальное число строк. Максимальное число строк необходимо задать на номер больше, чем минимальное число строк, которые требуются. Если это клиент должна иметь доступ по крайней мере 50 строк из 300 строк таблицы, максимальное число строк должен иметь значение по крайней мере 51. 
  
Чтобы получить все строки из таблицы, которые не должны помещаются в памяти, вызовите [IMAPITable::QueryRows](imapitable-queryrows.md) цикла с число относительно небольших строк, как показано в следующем примере кода: 
  
```cpp
HRESULT     hr;
LPSRowSet   pRows = NULL;
LONG        irow;
LONG            cAsk = 50;                  // adjust this value
while ((hr = pTable->QueryRows(cAsk, 0, &pRows)) == hrSuccess
        && pRows->cRows != 0)
{
    for (irow = 0; irow < prows->cRows; ++irow)
    {
        // process the row...
    }
    FreeProws(pRows);
    pRows = NULL;
}
if (hr)
{
    // handle the error...
}
 
```

После завершения этого цикла и все строки в таблице будут обработаны _cRows_ равно нулю, положение курсора обычно будет в нижней части таблицы. 
  
## <a name="see-also"></a>См. также

- [Таблицы MAPI](mapi-tables.md)


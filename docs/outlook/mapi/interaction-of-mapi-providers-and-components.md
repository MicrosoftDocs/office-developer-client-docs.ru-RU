---
title: Взаимодействие поставщиков MAPI и компонентов
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 2c0e010b-0432-4ef7-a243-3a4b46f0a19d
description: 'Дата последнего изменения: 23 июля 2011 г.'
ms.openlocfilehash: b88eafcc1ca6be98c5c1e9418072a5cb35f43345
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33434664"
---
# <a name="interaction-of-mapi-providers-and-components"></a>Взаимодействие поставщиков MAPI и компонентов

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Поставщики службы MAPI любого рода должны следовать определенным рекомендациям для работы с другими компонентами MAPI. Каждый поставщик услуг должен:
  
- Используйте для инициализации нужные объекты provider и logon.
    
- Возвратить таблицу диспетчеризации точек входа поставщика в систему обмена сообщениями после инициализации.
    
- ЗаРегистрируйте строку таблицы состояния MAPI для каждого ресурса, принадлежащего поставщику, и вызовите метод [имаписуппорт:: модифистатусров](imapisupport-modifystatusrow.md) в соответствующее время. 
    
- Используйте метод [имаписуппорт:: невуид](imapisupport-newuid.md) для получения допустимых уникальных идентификаторов (UID). 
    
- Поддерживает стандартные интерфейсы MAPI для возвращаемых объектов.
    
- Используйте функции выделения памяти MAPI для выделения памяти, возвращаемой клиентским приложениям, и освобождения памяти, выделенной другими частями подсистемы MAPI.
    
- Поддержание раздела профиля, если необходимо, для хранения учетных данных в базовой системе обмена сообщениями.
    
- Используйте метод [имаписуппорт:: регистерпрепроцессор](imapisupport-registerpreprocessor.md) , чтобы зарегистрировать любые функции предварительной обработки сообщений. 
    
- Включите соответствующие файлы заголовков (включая маписпи. h), которые определяют общие константы, структуры, интерфейсы и возвращаемые значения.
    
- Используйте соглашения о форматах адресов для распространенных типов адресов.
    


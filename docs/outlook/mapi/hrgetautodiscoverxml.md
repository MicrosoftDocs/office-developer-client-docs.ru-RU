---
title: HrGetAutoDiscoverXML
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- HrGetAutoDiscoverXML
api_type:
- COM
ms.assetid: 03691187-7c65-620b-576f-6ebe62a80830
description: 'Дата последнего изменения: 9 марта 2015 г.'
ms.openlocfilehash: 77f28654ffe0f6f459fde229bb7428f2c39e96c0
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32347805"
---
# <a name="hrgetautodiscoverxml"></a>HrGetAutoDiscoverXML

  
  
**Относится к**: Outlook 2013 | Outlook 2016 
  
Возвращает XML-поток, представляющий информацию, полученную из службы автоматического обнаружения сервера Microsoft Exchange 2007.
  
## <a name="quick-info"></a>Краткие сведения

|||
|:-----|:-----|
|Экспортировано:  <br/> |olmapi32. dll  <br/> |
|Вызывающая сторона:  <br/> |Client  <br/> |
|Реализовано в:  <br/> |Outlook  <br/> |
   
```cpp
HRESULT HrGetAutoDiscoverXML( 
    __in_z const WCHAR *pwzAddress, 
    __in_opt_z const WCHAR *pwzPassword, 
    __in_opt HANDLE hCancelEvent, 
    __in_opt ULONG ulFlags, 
    __out IStream** ppXmlStream); 

```

## <a name="parameters"></a>Параметры

 _пвзаддресс_
  
> возврата SMTP-адрес электронной почты с завершающим нулем для учетной записи, для которой требуется получить сведения об автоматическом обнаружении.
    
 _пвзпассворд_
  
> возврата Необязательный пароль для учетной записи, указанной в параметре _пвзаддресс_. Обратите внимание на то, что передача любого пароля не действует, если учетная запись, указанная в _пвзаддресс_ , не требует пароля. 
    
 _хканцелевент_
  
> возврата Необязательный дескриптор события Win32, который можно использовать для отмены операции. Чтобы отменить операцию, задайте событие и передайте обработчик события как _хканцелевент_; Если не нужно отменять операцию, передается **значение NULL** . Обратите внимание, что передача значения, не представляющего дескриптор события, не оказывает влияния и игнорируется функцией. 
    
 _ulFlags_
  
> возврата Этот параметр не используется. Значение должно быть равно 0.
    
 _ппксмлстреам_
  
> вышли Указатель на объект [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) , который содержит XML-код автообнаружения. Возвращает **значение NULL** , если операция автообнаружения завершается с ошибкой. После завершения работы с объектом [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) необходимо освободить его. 
    
## <a name="return-values"></a>Возвращаемые значения

S_OK 
  
- Вызов функции выполнен успешно.
    
E_INVALIDARG 
  
-  _пвзаддресс_ имеет **значение NULL** или не является допустимым SMTP-адресом, или _ппксмлстреам_ является **нулевым** указателем на объект [IStream](https://msdn.microsoft.com/library/aa380034%28VS.85%29.aspx) . 
    
MAPI_E_NOT_FOUND 
  
- Клиентский компьютер не подключен к сети, клиентский компьютер не подключен к серверу Microsoft Exchange 2007, _пвзаддресс_ не является учетной записью на сервере Exchange 2007, или _пвзаддресс_ — это учетная запись, которая не поддерживает службу автоматического обнаружения Exchange. 
    
MAPI_E_USER_CANCEL 
  
- Для отмены операции в _хканцелевент_ был передан дескриптор события. 
    
STRSAFE_E_INSUFFICIENT_BUFFER
  
- Значение, переданное в _пвзаддресс_ или _пвзпассворд_ , имеет слишком большую длину, так как оно вызывает переполнение внутреннего буфера размером 256 байт. 
    


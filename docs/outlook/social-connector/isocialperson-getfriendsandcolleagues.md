---
title: ИсоЦиалперсонжетфриендсандколлеагуес
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 62d5b815-f199-499e-85eb-2dff21a8216e
description: Получает строку, представляющую коллекцию людей.
ms.openlocfilehash: f755476f66ab2f91471b88c74baff899f31b83e3
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33407657"
---
# <a name="isocialpersongetfriendsandcolleagues"></a>ISocialPerson::GetFriendsAndColleagues

Получает строку, представляющую коллекцию людей.
  
```cpp
HRESULT _stdcall GetFriendsAndColleagues([out, retval] BSTR* personsCollection);
```

## <a name="parameters"></a>Параметры

_Персонсколлектион_
  
> вышли XML-строка, представляющая набор друзей человека и удовлетворяющая определению **друзей** в соответствии с определением схемы XML для расширяемости поставщика Outlook Social Connector (OSC). 
    
## <a name="remarks"></a>Примечания

OSC вызывает **жетфриендсандколлеагуес** , если поставщик OSC поддерживает кэшированную или гибридную синхронизацию друзей в социальной сети. Когда OSC вызывает метод **жетфриендсандколлеагуес** для пользователя Outlook, выполнившего вход в социальной сети, **ЖЕТФРИЕНДСАНДКОЛЛЕАГУЕС** возвращает строку XML, которая представляет друзей пользователя, выполнившего вход в социальной сети. XML-строка соответствует определению схемы XML **друзей** и указывает элемент **Person** (который также соответствует определению схемы поставщика OSC) для каждого друга. 
  
Когда **жетфриендсандколлеагуес** возвращает сведения о друзьях для пользователя, вошедшего в систему, OSC сохраняет эти сведения в папке "Контакты". Эта папка относится к социальным сетям и находится в магазине Outlook пользователя, вошедшего в систему по умолчанию. Для получения дополнительных сведений о том, как OSC кэширует сведения о друзьях в папке "Контакты", ознакомьтесь со статьей [Синхронизация друзей и действий](synchronizing-friends-and-activities.md).
  
Сведения для каждого друга, возвращаемого в параметре _персонсколлектион_ , соответствуют определению схемы XML для **пользователя**. Элемент **Person** поддерживает множество сведений для каждого друга, в том числе SMTP-адреса электронной почты (которые сопоставляются с элементами **EmailAddress**, **emailAddress2**и **emailAddress3** ), указанными друг на друга социальные сети и идентификатор пользователя (который сопоставляется с элементом **UserID** ), который определяет этого друга в социальной сети. 
  
Чтобы отобразить действия для пользователя Outlook, выбранного в области пользователей, OSC пытается найти пользователя с каждым знаком, возвращенным из **жетфриендсандколлеагуес**. Это выполняется с помощью файла OSC, который соответствует SMTP-адресу выбранного пользователя Outlook с адресами электронной почты, указанными в социальных сетях. Если OSC обнаруживает соответствующий SMTP-адрес электронной почты, OSC использует соответствующего **UserID** , чтобы вызвать метод [настроенный ISocialSession::-Person](isocialsession-getperson.md) . Это позволяет получить объект [исоЦиалперсон](isocialpersoniunknown.md) для этого друга, который позволяет OSC получать действия и изображения этого друга из социальной сети. 
  
Тем не менее, если выбранный пользователь Outlook не указывает тот же SMTP-адрес для учетной записи в социальной сети, или если пользователь Outlook не имеет учетной записи в этой социальной сети, OSC не сможет найти соответствующее значение для этого пользователя и не будет отображать Активити ES для этого пользователя в социальной сети.
  
## <a name="see-also"></a>См. также

- [ISocialPerson : IUnknown](isocialpersoniunknown.md)
- [Получения сведений о друзьях](getting-friends-information.md)


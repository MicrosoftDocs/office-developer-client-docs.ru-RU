---
title: Контрольный список установки
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 9dfb9b6d-2fb4-45bf-a12f-bd10a799ce29
description: В этом разделе описываются предварительные условия для успешной установки поставщика Outlook Social Connector (OSC), а также проверка правильности работы установщика поставщика.
ms.openlocfilehash: 8fec8523e57ad2678d02a0c5cbc1ad57340e5267
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32286344"
---
# <a name="installation-checklist"></a>Контрольный список установки

В этом разделе описываются предварительные условия для успешной установки поставщика Outlook Social Connector (OSC), а также проверка правильности работы установщика поставщика.
  
## <a name="installation-overview"></a>Обзор установки

Пользователи должны устанавливать поставщики OSC только в том случае, если присутствует поддерживаемая версия Outlook и osC установлена и включена на клиентский компьютер. Поддерживаемые версии Outlook: Office Outlook 2003, Office Outlook 2007, Outlook 2010 и Outlook 2013 (установлены на клиентский компьютер или, в случае Outlook 2010 и Outlook 2013, поставляются с помощью средства "нажми и нажми и запускай" на клиентский компьютер). Чтобы обеспечить успешную установку, установщик поставщика должен сделать следующее:
  
- Проверьте, присутствует ли поддерживаемая версия Outlook.
    
- Проверьте, установлен ли OSC.
    
> [!NOTE]
> "Нажми и выйми" — это виртуальная среда, в которой может работать Outlook 2010 (32-битная) или Outlook 2013 (32-битная). Для Outlook 2013 проверьте, существует ли ключ VirtualOutlook HKEY_LOCAL_MACHINE\Software\Microsoft\Office\15.0\Common\InstallRoot\Virtual\VirtualOutlook реестра Windows. Дополнительные сведения о доставке Outlook в качестве продукта "нажми ижми и запуска" на клиентский компьютер см. в сведениях о том, как проверить, доступен ли Outlook на компьютере в качестве продукта "нажми [и запускай".](https://blogs.msdn.com/b/officedevdocs/archive/2010/03/09/how-to-verify-if-outlook-is-available-on-a-computer-as-a-click-to-run-product.aspx) 
  
Однако перед установкой поставщика пользователю необходимо убедиться, что osC включен.
  
Третьи стороны, включая поставщиков OSC, не могут перераспределять OSC. Однако если osC не установлен, установщик поставщика может использовать соответствующие ссылки g для установки OSC на клиентский компьютер. Ссылка g — это специально построенный URL-адрес, который перенаправляем пользователя на соответствующую веб-страницу для https://g.live.com загрузки OSC. G-ссылка OSC форматирована как https://g.live.com/0CR _LCID_ /  _Glink,_ где _LCID_ и _Glink_ указывают локали, версию и битность Outlook на клиентском компьютере. Каждая ссылка g указывает на исполняемый документ и определяется указанными _значениями LCID_ и _Glink._ 
  
Например, ссылка g для установки последней версии OSC для Outlook 2003 или Outlook 2007 для LCID 1033 (английский (США) является следующим образом:
  
https://g.live.com/0CR1033/80
  
Подробные сведения о значениях  _Glink_ для разных версий и битности Outlook, а также  _значениях LCID_ для поддерживаемых локали см. #7 в разделе "Контрольный список [установки"](#olosc_InstallationOverview_InstallationChecklist) ниже. 

<a name="olosc_InstallationOverview_InstallationChecklist"> </a>

## <a name="installation-checklist"></a>Контрольный список установки

Пакет установки поставщика должен выполнить ряд проверок установки, как показано на рисунке 1, чтобы убедиться, что поставщик успешно установлен.
  
**Рисунок 1. Логика установки поставщика**

![Контрольный список установки](media/odc_ol14_ta_OSC_Fig07.gif)
  
В следующей процедуре описаны проверки установки, описанные на рисунке 1.
  
1. В качестве обязательного условия определите, установлен ли Outlook или присутствует, а если установлено или присутствует, определите, поддерживает ли версия Outlook OSC. Дополнительные сведения об обнаружении установленной версии Outlook см. в сведениях [о проверке версии Outlook.](https://msdn.microsoft.com/library/672fc380-a29b-4e99-9211-949fd5065723%28Office.15%29.aspx)
    
   - Если установленная версия Outlook является более ранней, чем Outlook 2003, процедура установки поставщика не может быть завершена. Перед установкой поставщика OSC сообщите пользователю о получении поддерживаемой версии Outlook и OSC.
    
   - Если Outlook не установлен, переходите к шагу 2.
    
   - Если установлен Outlook 2003 или Outlook 2007, переходите к шагу 3. 
    
   - Если outlook 2010 или Outlook 2013 установлен, переходите к шагу 4.
    
2. **Если Outlook не установлен на клиентский компьютер, переходите к этому шагу:**
    
   1. Проверьте, установлен ли OSC в качестве компонента по умолчанию для установки Outlook 2010 или Outlook 2013 "нажми ижми и запускай". Проверьте ключ  `VirtualOutlook` в следующем расположении реестра Windows: 
      
      - Для Outlook 2010:  `HKEY_LOCAL_MACHINE\Software\Microsoft\Office\14.0\Common\InstallRoot\Virtual\VirtualOutlook`
      
      - Для Outlook Social Connector 2013:  `HKEY_LOCAL_MACHINE\Software\Microsoft\Office\15.0\Common\InstallRoot\Virtual\VirtualOutlook`
      
      Ключ — это REG_SZ, которое содержит тег локализованного продукта, например  `VirtualOutlook` en-us. 
      
   2. Если ключ не существует, Outlook отсутствует на клиентский компьютер, и процедура установки поставщика  `VirtualOutlook` не может завершиться. Перед установкой поставщика OSC сообщите пользователю о получении поддерживаемой версии Outlook и OSC. 
      
   3. Если ключ существует, Outlook был доставлен с помощью "нажми и найми"  `VirtualOutlook` на клиентский компьютер. Проверьте установленную версию библиотеки типов OSC, проверив ключ в следующем расположении  `OSCVersion` реестра Windows: 
      
      `HKEY_LOCAL_MACHINE\Software\Microsoft\Office\Outlook\SocialConnector\OSCVersion`
      
      Значением является строка, которая указывает номер версии библиотеки типов Socialprovider.dll  `OSCVersion` (например, "1.0", "1.1" или "15"). 
      
   4. Если  `OSCVersion` это "1.0", "1.1" или "15", устанавливается соответствующая версия OSC. Перейдите к шагу 6, чтобы найти текущий региональный интерфейс пользователя Outlook для подготовки к установке последней версии OSC. 
      
   5. В  `OSCVersion` противном случае не содержит ожидаемого значения. Перейдите к шагу 6, чтобы найти текущий региональный интерфейс пользователя Outlook для подготовки к установке соответствующей версии OSC. 
    
3. **При установке Outlook 2003 или Outlook 2007 на клиентский компьютер переходите к этому шагу:**
    
   1. Проверьте, установлен ли OSC, написав настраиваемого действия установщика для проверки наличия следующего квалифицированного ИД компонента:
      
      `{A3B82DA3-8AD9-4935-AEA8-54B754459483}`
      
      ИД квалифицированного компонента — это GUID, который предоставляет метод одноуровневого косвенного спряжения, аналогичный указателю. Дополнительные сведения об установщике Windows см. в документации [по установщику Windows.](https://docs.microsoft.com/windows/desktop/msi/roadmap-to-windows-installer-documentation)
      
   2. Если указанный квалифицированный компонент существует, устанавливается версия OSC. Перейдите к шагу 5, чтобы найти текущий региональный интерфейс пользователя Outlook для подготовки к установке последней версии OSC.
      
   3. В противном случае OSC не устанавливается. Перейдите к шагу 6, чтобы найти текущий региональный интерфейс пользователя Outlook для подготовки к установке соответствующей версии OSC.
      
4. **При установке Outlook 2010 или Outlook 2013 на клиентский компьютер переходите к этому шагу:**
    
   1. Определите битность установленной версии Outlook, изучив ключ в следующем расположении  `Bitness` реестра Windows: 
      
      - Для Outlook 2010 посмотрите на  `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\14.0\Outlook`
      
      - Для Outlook 2013 посмотрите на  `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\15.0\Outlook`
      
      Ключ  `Bitness` — "x86" для 32-битного Outlook или "x64" для 64-битного Outlook. 
      
   2. Если ваш поставщик является управляемым поставщиком и вы компилировали компонент поставщика, указав целевую платформу как любой ЦП, перейдите к шагу 6, чтобы найти текущий региональный интерфейс пользователя Outlook для подготовки к установке последней версии OSC. Поставщик будет работать как в 32-, так и в 64-битных версиях OSC.
      
   3. Если ваш поставщик является собственный компонент COM, проверьте толщину установленной версии Outlook:
      
      - Если установленная версия Outlook является 32-битной, после установки соответствующего OSC процедуре установки необходимо установить 32-битного поставщика (на шаге 8).
      
      - В противном случае установленная версия Outlook является 64-битной, и после установки соответствующего OSC процедура установки должна будет установить 64-битного поставщика (на шаге 8). 
      
   4. Перейдите к шагу 6, чтобы найти текущий региональный интерфейс пользователя Outlook для подготовки к установке соответствующей версии OSC.
    
5. **При установке Outlook 2003 или Outlook 2007** и установке операционной системы на клиентский компьютер переходите к этому шагу: Проверьте текущий региональный интерфейс пользователя Outlook, проверив ключ в следующем расположении  `OSCLcid` реестра Windows: 
    
   `HKEY_LOCAL_MACHINE\Software\Microsoft\Office\Outlook\SocialConnector\OSCLcid`
    
   Ключ — это значение DWORD, которое указывает тег локального интерфейса  `OSCLcid` internet Engineering Task Force (IETF) (определенный [[RFC4646]](https://www.ietf.org/rfc/rfc4646.txt) и [[RFC4647]](https://www.ietf.org/rfc/rfc4647.txt)), который представляет текущий региональный код пользовательского интерфейса Outlook. Пере переходите к шагу 7, чтобы установить последнюю версию OSC на клиентский компьютер.
    
6. **При установке Outlook 2003 или Outlook 2007 или outlook 2010 или Outlook 2013, но на клиентский компьютер не обязательно устанавливается последняя версия OSC:**
    
   Используйте объект **LanguageSettings,** чтобы определить LCID языкового интерфейса пользователя Outlook. В следующем фрагменте кода Visual Basic Scripting Edition (VBScript) показано, как получить код LCID для локального интерфейса пользователя Outlook. 
    
   ```vb
    Function GetOutlookUI_LCID()
        ' Declare variables.
        Dim msoLanguageIDUI, olApp
        msoLanguageIDUI = 2
        Set olApp = CreateObject("Outlook.Application")
        ' Return Outlook UI LCID.
        GetOutlookUI_LCID = olApp.LanguageSettings.LanguageID(msoLanguageIDUI)
    End Function
   ```

7. **Переходите к этому шагу, если установщик имеет LCID установленной версии Outlook, но последняя версия OSC не обязательно устанавливается на клиентский компьютер:**
    
   Связывайте g-link с пакетом установки, чтобы убедиться, что на клиентский компьютер установлена последняя версия OSC. Формат g-link:
    
   https://g.live.com/0CR_LCID_ /  _Glink_
    
   Поддерживаемые значения _LCID_ см. в таблице 1 ниже, а в таблице 2 поддерживаемые _значения Glink._ Например, ссылка g для установки последней версии 32-битного OSC для 32-битного Outlook Social Connector 2013 (английский (США) имеет 32-битную версию: 
    
   https://g.live.com/0CR1033/82
    
8. Установите поставщика. Процедура установки поставщика должна зарегистрировать программный идентификатор (ProgID) в соответствующем расположении реестра Windows. Дополнительные сведения [см. в сведениях о регистрации поставщика.](registering-a-provider.md) Кроме того, убедитесь, что битность устанавливаемого поставщика такая же, как и битность версии Outlook, установленной на клиентский компьютер. Например, установите 32-битный поставщик, если присутствует 32-битный Outlook 2013, и 64-битный поставщик, если установлен 64-битный Outlook 2013. Для Outlook 2003 или 2007 применяется только 32-битная версия поставщика. 
    
**Таблица 1. Поддерживаемые региональные значения и соответствующие значения LCID для OSC**
  
|**Locale**|**Код языка**|
|:-----|:-----|
|ar-sa  <br/> |1025  <br/> |
|bg-bg  <br/> |1026  <br/> |
|ca-es  <br/> |1027  <br/> |
|cs-cz  <br/> |1029  <br/> |
|da-dk  <br/> |1030  <br/> |
|de-de  <br/> |1031  <br/> |
|el-gr  <br/> |1032  <br/> |
|en-us  <br/> |1033  <br/> |
|es-es  <br/> |3082  <br/> |
|et-ee  <br/> |1061  <br/> |
|eu-es  <br/> |1069  <br/> |
|fi-fi  <br/> |1035  <br/> |
|fr-fr  <br/> |1036  <br/> |
|gl-es  <br/> |1110  <br/> |
|he-il  <br/> |1037  <br/> |
|hi-in  <br/> |1081  <br/> |
|hr-hr  <br/> |1050  <br/> |
|hu-hu  <br/> |1038  <br/> |
|it-it  <br/> |1040  <br/> |
|ja-jp  <br/> |1041  <br/> |
|kk-kz  <br/> |1087  <br/> |
|ko-kr  <br/> |1042  <br/> |
|lt-lt  <br/> |1063  <br/> |
|lv-lv  <br/> |1062  <br/> |
|nb-no  <br/> |1044  <br/> |
|nl-nl  <br/> |1043  <br/> |
|pl-pl  <br/> |1045  <br/> |
|pt-br  <br/> |1046  <br/> |
|pt-pt  <br/> |2070  <br/> |
|ro-ro  <br/> |1048  <br/> |
|ru-ru  <br/> |1049  <br/> |
|sk-sk  <br/> |1051  <br/> |
|sl-si  <br/> |1060  <br/> |
|sr-cyrl-cs  <br/> |3098  <br/> |
|sr-latn-cs  <br/> |2074  <br/> |
|sv-se  <br/> |1053  <br/> |
|th-th  <br/> |1054  <br/> |
|tr-tr  <br/> |1055  <br/> |
|uk-ua  <br/> |1058  <br/> |
|zh-cn  <br/> |2052  <br/> |
|zh-tw  <br/> |1028  <br/> |
   
**Таблица 2. Поддерживаемые значения Glink для OSC**
  
|**Значение Glink**|**Function**|
|:-----|:-----|
|80  <br/> |Устанавливает последнюю версию OSC для Outlook 2003 или Outlook 2007.  <br/> |
|82  <br/> |Устанавливает последнее исправление 32-битной операционной системы для Outlook 2007, Outlook 2010 или Outlook Social Connector 2013.  <br/> |
|83  <br/> |Устанавливает последнее исправление 64-битной операционной системы для Outlook 2010 или Outlook Social Connector 2013.  <br/> |
   
## <a name="see-also"></a>См. также

- [Регистрация поставщика](registering-a-provider.md) 
- [Быстрые шаги по обучению разработке поставщика](quick-steps-for-learning-to-develop-a-provider.md)
- [Развертывание поставщика](deploying-a-provider.md)


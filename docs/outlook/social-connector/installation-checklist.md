---
title: Контрольный список установки
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 9dfb9b6d-2fb4-45bf-a12f-bd10a799ce29
description: В этом разделе описываются предварительные условия для успешной установки поставщика Outlook Social Connector (OSC), а также выполняется проверка того, что установщик поставщика должен выполнить правильную работу.
ms.openlocfilehash: 8fec8523e57ad2678d02a0c5cbc1ad57340e5267
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32286344"
---
# <a name="installation-checklist"></a>Контрольный список установки

В этом разделе описываются предварительные условия для успешной установки поставщика Outlook Social Connector (OSC), а также выполняется проверка того, что установщик поставщика должен выполнить правильную работу.
  
## <a name="installation-overview"></a>Обзор установки

Пользователи должны устанавливать поставщиков OSC только в том случае, если на клиентском компьютере установлена поддерживающая версия Outlook, а также OSC установлена и включена. Поддерживаются версии Outlook 2003, Office Outlook 2007, Outlook 2010 и Outlook 2013 (устанавливается на клиентском компьютере, а в случае с Outlook 2010 и Outlook 2013 доставляются с помощью команды "нажми и работай" на клиентском компьютере). Чтобы обеспечить успешную установку, установщик поставщика должен выполнить следующие действия:
  
- Проверка наличия поддерживаемой версии Outlook.
    
- Проверьте, установлен ли OSC.
    
> [!NOTE]
> "Нажми и работай" — это виртуальная среда, в которой можно запустить Outlook 2010 (32-бит) или Outlook 2013 (32-разрядная версия). Для Outlook 2013 проверьте, существует ли ключ раздел VirtualOutlook в HKEY_LOCAL_MACHINE \Software\Microsoft\Office\15.0\Common\InstallRoot\Virtual\VirtualOutlook реестра Windows. Для получения дополнительных сведений о доставке Outlook в качестве продукта "нажми и работай" на клиентском компьютере Узнайте, [как проверить, доступно ли приложение Outlook на компьютере как продукт "нажми и работай"](https://blogs.msdn.com/b/officedevdocs/archive/2010/03/09/how-to-verify-if-outlook-is-available-on-a-computer-as-a-click-to-run-product.aspx). 
  
Однако пользователю необходимо убедиться, что OSC включен, прежде чем устанавливать поставщик.
  
Третьим лицам, в том числе поставщикам OSC, не удается перераспределить OSC. Однако если OSC не установлен, установщик поставщика может использовать соответствующие ссылки g-ссылки для установки OSC на клиентском компьютере. G-Link — это специально сконструированный URL- https://g.live.com адрес, перенаправляющий пользователя на соответствующую веб-страницу для загрузки OSC. Канал OSC g-Link отформатирован как https://g.live.com/0CR _LCID_/ _Глинк_, где _LCID_ и _Глинк_ указывают языковой стандарт, версию и разрядность Outlook на клиентском компьютере. Каждая ссылка указывает на исполняемый файл и относится только к указанным значениям _LCID_ и _Глинк_ . 
  
Например, с помощью параметра g-Link можно установить последнюю версию OSC для Outlook 2003 или Outlook 2007 для идентификатора LCID 1033 (американский английский) следующим образом:
  
https://g.live.com/0CR1033/80
  
Сведения о значениях _Глинк_ для разных версий и разрядности Outlook, а также значениях _LCID_ для поддерживаемых языковых стандартов можно найти в разделе #7 в [контрольном списке установки](#olosc_InstallationOverview_InstallationChecklist) раздела ниже. 

<a name="olosc_InstallationOverview_InstallationChecklist"> </a>

## <a name="installation-checklist"></a>Контрольный список установки

Пакет установки поставщика должен выполнить ряд проверок установки, как показано на рисунке 1, чтобы убедиться в успешности установки поставщика.
  
**Рис. 1. Логика установки поставщика**

![Контрольный список установки](media/odc_ol14_ta_OSC_Fig07.gif)
  
Следующая процедура описывает проверки установки, описанные на рисунке 1.
  
1. В качестве необходимого компонента определите, установлена или присутствует ли Outlook, и если она установлена или присутствует, определите, поддерживает ли версия Outlook OSC. Более подробную информацию об обнаружении установленной версии Outlook можно узнать [в статье Проверка версии Outlook](https://msdn.microsoft.com/library/672fc380-a29b-4e99-9211-949fd5065723%28Office.15%29.aspx).
    
   - Если установленная версия Outlook более ранняя, чем Outlook 2003, процедура установки поставщика не может быть завершена. Перед установкой поставщика OSC сообщите пользователю о том, чтобы получить поддерживаемую версию Outlook и OSC.
    
   - Если приложение Outlook не установлено, перейдите к шагу 2.
    
   - Если установлено приложение Outlook 2003 или Outlook 2007, перейдите к шагу 3. 
    
   - Если установлено приложение Outlook 2010 или Outlook 2013, перейдите к шагу 4.
    
2. **Выполните этот шаг, если Outlook не установлен на клиентском компьютере:**
    
   1. Проверьте, установлен ли OSC в качестве компонента по умолчанию для установки Outlook 2010 или Outlook 2013. Изучите `VirtualOutlook` ключ в следующем расположении в реестре Windows: 
      
      - Для Outlook 2010,`HKEY_LOCAL_MACHINE\Software\Microsoft\Office\14.0\Common\InstallRoot\Virtual\VirtualOutlook`
      
      - Для Outlook Social Connector 2013,`HKEY_LOCAL_MACHINE\Software\Microsoft\Office\15.0\Common\InstallRoot\Virtual\VirtualOutlook`
      
      `VirtualOutlook` Ключ является значением REG_SZ, содержащим тег языкового стандарта, например "en-US" установленного продукта. 
      
   2. Если `VirtualOutlook` ключ не существует, Outlook отсутствует на клиентском компьютере и процедура установки поставщика не может быть завершена. Перед установкой поставщика OSC сообщите пользователю о том, чтобы получить поддерживаемую версию Outlook и OSC. 
      
   3. Если `VirtualOutlook` ключ существует, Outlook был доставлен по нажатию кнопки "нажми и работай" на клиентском компьютере. Перейдите к `OSCVersion` разделу Проверка установленной версии библиотеки типов OSC, изучите раздел реестра Windows в следующем расположении: 
      
      `HKEY_LOCAL_MACHINE\Software\Microsoft\Office\Outlook\SocialConnector\OSCVersion`
      
      Значение `OSCVersion` — это строка, указывающая номер версии библиотеки типов соЦиалпровидер. dll (например, "1,0", "1,1" или "15"). 
      
   4. Если `OSCVersion` это "1,0", "1,1" или "15", устанавливается соответствующая версия OSC. Перейдите к шагу 6, чтобы найти текущий языковой стандарт пользовательского интерфейса Outlook, чтобы подготовиться к установке последней версии OSC. 
      
   5. `OSCVersion` В противном случае не содержит ожидаемого значения. Перейдите к шагу 6, чтобы найти текущий языковой стандарт пользовательского интерфейса Outlook, чтобы подготовиться к установке соответствующей версии OSC. 
    
3. **Выполните этот шаг, если Outlook 2003 или Outlook 2007 установлен на клиентском компьютере:**
    
   1. Проверьте, установлен ли OSC, записав дополнительное действие программы установки, чтобы проверить наличие следующего идентификатора компонента:
      
      `{A3B82DA3-8AD9-4935-AEA8-54B754459483}`
      
      Идентификатор полного компонента — это идентификатор GUID, предоставляющий метод одноуровневого косвенного обращения, аналогичный указателю. Для получения дополнительных сведений об установщике Windows ознакомьтесь [с документацией по установщику Windows](https://docs.microsoft.com/windows/desktop/msi/roadmap-to-windows-installer-documentation).
      
   2. Если указанный полный компонент существует, устанавливается версия OSC. Перейдите к шагу 5, чтобы найти текущий языковой стандарт пользовательского интерфейса Outlook, чтобы подготовиться к установке последней версии OSC.
      
   3. В противном случае OSC не устанавливается. Перейдите к шагу 6, чтобы найти текущий языковой стандарт пользовательского интерфейса Outlook, чтобы подготовиться к установке соответствующей версии OSC.
      
4. **Выполните этот шаг, если Outlook 2010 или Outlook 2013 установлен на клиентском компьютере:**
    
   1. Определите Разрядность установленной версии Outlook, изучив `Bitness` ключ в следующем расположении в реестре Windows: 
      
      - Для Outlook 2010 просмотрите`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\14.0\Outlook`
      
      - Для Outlook 2013 просмотрите`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\15.0\Outlook`
      
      `Bitness` Ключом является "x86" для 32-разрядной версии Outlook или "x64" для 64-разрядной версии Outlook. 
      
   2. Если ваш поставщик является управляемым поставщиком и вы откомпилирован компонент поставщика, указав целевую платформу в качестве **любого ЦП**, перейдите к шагу 6, чтобы найти текущую национальную настройку интерфейса пользователя Outlook, чтобы подготовиться к установке последней версии OSC. Поставщик будет работать как в 32, так и в версиях файла OSC для и 64.
      
   3. Если ваш поставщик является собственным компонентом COM, изучите Разрядность установленной версии Outlook:
      
      - Если установленная версия Outlook — 32-разрядная версия, то в процедуре установки потребуется установить 32-разрядный поставщик (на шаге 8), убедившись, что установлен соответствующий OSC.
      
      - В противном случае установленная версия Outlook — 64-разрядная, а в процедуре установки потребуется установить 64-разрядный поставщик (на шаге 8), убедившись, что установлен соответствующий OSC. 
      
   4. Перейдите к шагу 6, чтобы найти текущую национальную настройку интерфейса пользователя Outlook, чтобы подготовиться к установке соответствующей версии OSC.
    
5. **Выполните этот шаг, если установлен outlook 2003 или outlook 2007, а на клиентском компьютере установлен OSC:** Проверьте текущий языковой стандарт пользовательского интерфейса Outlook, изучив `OSCLcid` ключ в следующем расположении в реестре Windows: 
    
   `HKEY_LOCAL_MACHINE\Software\Microsoft\Office\Outlook\SocialConnector\OSCLcid`
    
   `OSCLcid` Ключ — это значение типа DWORD, задающее тег языка IETF (Internet Engineering Task Force) (определяется с помощью [[RFC4646]](https://www.ietf.org/rfc/rfc4646.txt) и [[RFC4647]](https://www.ietf.org/rfc/rfc4647.txt)), который представляет текущий языковой стандарт пользовательского интерфейса Outlook. Перейдите к шагу 7, чтобы установить последнюю версию OSC на клиентском компьютере.
    
6. **Выполните это действие, если Outlook 2003 или Outlook 2007 установлен или Outlook 2010 или Outlook 2013, но на клиентском компьютере не обязательно установлена последняя версия OSC:**
    
   Используйте объект **LanguageSettings** , чтобы определить LCID языкового стандарта пользовательского интерфейса Outlook. В приведенном ниже фрагменте кода Visual Basic Scripting Edition (VBScript) показано, как получить LCID для языкового стандарта пользовательского интерфейса Outlook. 
    
   ```vb
    Function GetOutlookUI_LCID()
        ' Declare variables.
        Dim msoLanguageIDUI, olApp
        msoLanguageIDUI = 2
        Set olApp = CreateObject("Outlook.Application")
        ' Return Outlook UI LCID.
        GetOutlookUI_LCID = olApp.LanguageSettings.LanguageID(msoLanguageIDUI)
    End Function
   ```

7. **Выполните это действие, если у установщика есть идентификатор LCID установленной версии Outlook, но на клиентском компьютере не обязательно установлена последняя версия OSC:**
    
   Свяжите ссылку g-Link с пакетом установки, чтобы убедиться, что на клиентском компьютере установлена последняя версия OSC. Формат g-ссылки выглядит следующим образом:
    
   https://g.live.com/0CR_Код языка (LCID_/ )_Глинк_
    
   В таблице 1 ниже приведены поддерживаемые значения _LCID_ и таблица 2 для поддерживаемых значений _Глинк_ . Например, с помощью параметра g-Link можно установить последнюю версию 32-разрядного файла OSC для 32-разрядной версии Outlook Social Connector 2013 (американский английский): 
    
   https://g.live.com/0CR1033/82
    
8. Установите поставщик. Процедура установки поставщика должна зарегистрировать программный идентификатор (ProgID) в соответствующем расположении реестра Windows. Для получения дополнительных сведений обратитесь [к разделу Регистрация поставщика](registering-a-provider.md). Кроме того, убедитесь, что разрядность устанавливаемого поставщика совпадает с разрядностью версии Outlook, представленной на клиентском компьютере. Например, установите 32-разрядный поставщик при наличии 32-разрядной версии Outlook 2013 и 64-разрядный поставщик, если установлено 64-разрядная версия Outlook 2013. Для Outlook 2003 или 2007 применяется только 32 — разрядная версия поставщика. 
    
**Таблица 1: поддерживаемый языковой стандарт и соответствующие значения LCID в шестнадцатеричном формате для OSC**
  
|**Locale**|**Код языка**|
|:-----|:-----|
|ar-sa  <br/> |1025  <br/> |
|bg-bg  <br/> |1026  <br/> |
|ca-es  <br/> |1027  <br/> |
|cs-cz  <br/> |1029  <br/> |
|da-dk  <br/> |1030  <br/> |
|de-de  <br/> |1031  <br/> |
|el-gr  <br/> |1032  <br/> |
|en-us  <br/> |1033  <br/> |
|es-es  <br/> |3082  <br/> |
|et-ee  <br/> |1061  <br/> |
|eu-es  <br/> |1069  <br/> |
|fi-fi  <br/> |1035  <br/> |
|fr-fr  <br/> |1036  <br/> |
|gl-es  <br/> |1110  <br/> |
|he-il  <br/> |1037  <br/> |
|hi-in  <br/> |1081  <br/> |
|hr-hr  <br/> |1050  <br/> |
|hu-hu  <br/> |1038  <br/> |
|it-it  <br/> |1040  <br/> |
|ja-jp  <br/> |1041  <br/> |
|kk-kz  <br/> |1087  <br/> |
|ko-kr  <br/> |1042  <br/> |
|lt-lt  <br/> |1063  <br/> |
|lv-lv  <br/> |1062  <br/> |
|nb-no  <br/> |1044  <br/> |
|nl-nl  <br/> |1043  <br/> |
|pl-pl  <br/> |1045  <br/> |
|pt-br  <br/> |1046  <br/> |
|pt-pt  <br/> |2070  <br/> |
|ro-ro  <br/> |1048  <br/> |
|ru-ru  <br/> |1049  <br/> |
|sk-sk  <br/> |1051  <br/> |
|sl-si  <br/> |1060  <br/> |
|SR – Цирл — CS  <br/> |3098  <br/> |
|sr – Latn — CS  <br/> |2074  <br/> |
|sv-se  <br/> |1053  <br/> |
|th-th  <br/> |1054  <br/> |
|tr-tr  <br/> |1055  <br/> |
|uk-ua  <br/> |1058  <br/> |
|zh-cn  <br/> |2052  <br/> |
|zh-tw  <br/> |1028  <br/> |
   
**Таблица 2: Поддерживаемые значения Глинк для OSC**
  
|**Значение Глинк**|**Function**|
|:-----|:-----|
|80  <br/> |Устанавливает последнюю версию OSC для Outlook 2003 или Outlook 2007.  <br/> |
|82  <br/> |Устанавливает последнюю версию пакета обновления 32 – bit OSC для Outlook 2007, Outlook 2010 или Outlook Social Connector 2013.  <br/> |
|83  <br/> |Устанавливает последнюю версию пакета обновления 64 – bit OSC для Outlook 2010 или Outlook Social Connector 2013.  <br/> |
   
## <a name="see-also"></a>См. также

- [Регистрация поставщика](registering-a-provider.md) 
- [Быстрые действия для изучения разработки поставщика](quick-steps-for-learning-to-develop-a-provider.md)
- [Развертывание поставщика](deploying-a-provider.md)


---
title: Интерфейс приложения (OneNote)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.assetid: 87926f7d-e1dc-41d5-8805-6ba91fc7b154
description: С помощью методов интерфейса приложения можно извлекать и обновлять содержимое и данные OneNote, а также работать с такими данными и содержимым. Методы разбиты на четыре общие категории.
localization_priority: Priority
ms.openlocfilehash: 295db4fcb64541ccf461fbd8d48dc19b89e6b1f8
ms.sourcegitcommit: e7b38e37a9d79becfd679e10420a19890165606d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "34537824"
---
# <a name="application-interface-onenote"></a>Интерфейс приложения (OneNote)

С помощью методов интерфейса **приложения** можно извлекать и обновлять содержимое и данные OneNote, а также работать с такими данными и содержимым. Методы разбиты на четыре общие категории. 
  
- **Структура записной книжки**. Методы для работы со структурой записной книжки, в том числе предназначенные для обнаружения, открытия, изменения, закрытия и удаления записных книжек, разделов и групп разделов. 
    
- **Страница содержимого**. Методы для работы со страницами и содержимым страниц, в том числе предназначенные для обнаружения, изменения, сохранения и удаления содержимого страницы. Содержимое страницы включает двоичные объекты, в частности объекты рукописного ввода и изображения, а также текстовые объекты, например структуры. 
    
- **Навигация**. Методы для поиска страниц и объектов, создания ссылок на них и навигации по ним. 
    
- **Функциональные**. Все остальные методы, которые выполняют определенные действия или задают параметры в OneNote. 
    
Кроме того, интерфейс **приложения** содержит ряд *свойств* и *событий*. 
  
## <a name="notebook-structure-methods"></a>Методы структуры записной книжки
<a name="ON14DevRef_Application_NotebookStructure"> </a>

Методы, описанные в этом разделе, позволяют находить, открывать, изменять, закрывать и удалять записные книжки OneNote, разделы и группы разделов.
  
### <a name="gethierarchy-method"></a>Метод GetHierarchy

|||
|:-----|:-----|
|**Описание** <br/> |Получает структуру иерархии узла записной книжки, начиная с указанного узла (все записные книжки или одна записная книжка, группа разделов или раздел) и заканчивая последним потомком на указанном уровне (раскрытие списка потомков).  <br/> |
|**Синтаксис** <br/> | `HRESULT GetHierarchy(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]HierarchyScope hsScope,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(xs2013)]XMLSchema xsSchema);` <br/> |
|**Параметры** <br/> | _bstrStartNodeID_. Узел (записная книжка, группа разделов или раздел), потомки которого вам нужны. Если вы передаете строку NULL (""), метод получает все узлы ниже корневого узла (то есть все записные книжки, группы разделов и разделы). Если указать узел в виде записной книжки, группы разделов или раздела, метод получает только потомков этого узла.  <br/><br/>_hsScope_. Уровень узла самого нижнего потомка, который вам нужен. Например, если указать страницы, метод возвращает все узлы до уровня страниц. Если указать разделы, метод получит только узлы разделов, указанных под уровнем записной книжки. Дополнительные сведения см. в статье о перечислении **HierarchyScope** в теме [Перечисление](enumerations-onenote-developer-reference.md#odc_HierarchyScope).  <br/><br/>_pbstrHierarchyXmlOut_. Выходной параметр, указатель на строку, в которую программа OneNote должна записать выходные данные XML.  <br/><br/>_xsSchema_. (Необязательный параметр.) Версия схемы XML OneNote типа **XMLSchema**, которую нужно вывести. Вы можете указать нужную версию схемы XML: 2013, 2010, 2007 или текущую.  <br/><br/>**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.           |
   
По умолчанию метод GetHierarchy возвращает строку в формате OneNote 2013 XML. Можно также задать предпочитаемую версию схемы XML с помощью необязательного параметра _xsSchema_. 
  
В зависимости от переданных параметров метод **GetHierarchy** может возвращать разные списки (например, все записные книжки, все разделы всех записных книжек, все страницы в пределах указанного раздела или все страницы указанной записной книжки). Для каждого узла возвращенная строка XML содержит свойства (например, раздел или название страницы, идентификатор и время последнего изменения). 
  
Не все сочетания начального узла и области допустимы. Например, если указать начальный узел в виде раздела и область в виде записной книжки, **GetHierarchy** возвратит результат NULL, так как записная книжка находится в иерархии узлов выше, чем раздел. 
  
В следующем примере на C# показано, как использовать метод **GetHierarchy**, чтобы получить всю иерархию OneNote, включая все записные книжки, до уровня страницы. Он копирует выходную строку в буфер обмена, из которого можно вставить строку в текстовый редактор для проверки. 
  
```cs
static void GetEntireHierarchy()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(null, 
            OneNote.HierarchyScope.hsPages, out strXML);
        Clipboard.SetText(strXML);
        MessageBox.Show("The XML has been copied to the clipboard");
    }

```

### <a name="updatehierarchy-method"></a>Метод UpdateHierarchy

|||
|:-----|:-----|
|**Описание**|Изменяет или обновляет иерархию записных книжек. Например, можно добавить разделы и группы разделов в записную книжку, добавить новую записную книжку, переместить разделы в пределах записной книжки, изменить имя раздела, добавить страницы в раздел или изменить порядок страниц в разделах.|
|**Синтаксис**| `HRESULT UpdateHierarchy(`<br/>`[in]BSTR bstrChangesXmlIn,`<br/>`[in,defaultvalue(xsCurrent)] XMLSchema xsSchema);`|
|**Параметры**| _bstrChangesXmlIn_. Строка, которая содержит код XML OneNote, в котором указаны вносимые в иерархию изменения. Например, если вы хотите вставить новый раздел, вы можете добавить элемент **Section** в строку XML, чтобы указать место добавления раздела. Кроме того, если вы хотите переименовать существующий раздел, можно сохранить тот же идентификатор раздела и изменить его атрибут **name** в XML-коде.<br/><br/>_xsSchema_. (Необязательный параметр.) Версия схемы OneNote строки _bstrChangesXmln_. Это необязательное значение используется для указания версии схемы XML OneNote, в которой находится строка _bstrChangesXmlIn_. Если это значение не указано, OneNote будет предполагать, что версия схемы XML — _xsCurrent_. <br/><br/>**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.           |
   
Если вы передадите только часть строки XML OneNote для параметра _bstrChangesXmlIn_, OneNote попытается определить нужные изменения. Например, если вы включаете элемент **Notebook**, который содержит только один раздел, OneNote добавляет раздел после всех существующих разделов. Однако если указанная вами операция неоднозначна, определить результат может быть сложно. Например, если существующая записная книжка содержит четыре раздела, а переданная строка XML включает записную книжку и только четвертый и первый разделы (в таком порядке), OneNote может поместить второй и третий разделы перед четвертым разделом или после первого раздела. 
  
С помощью метода **UpdateHierarchy** невозможно удалить часть записной книжки. Иными словами, передача строки XML, которая содержит только часть существующей иерархии, не приводит к удалению разделов, которые не входят в строку. Чтобы удалить часть иерархии, используйте метод **DeleteHierarchy**. 
  
Указанный ниже код C# демонстрирует один способ использования метода **UpdateHierarchy** для изменения иерархии OneNote путем изменения имени существующего раздела. Он читает XML-код из файла образца с именем ChangeSectionName.xml в корне диска C, загружает код в XML-документ, а затем передает структуру XML этого документа методу. 
  
```cs
static void UpdateExistingHierarchy()
    {
        OneNote.Application onApplication = new OneNote.Application();
        
        // Get the XML from the file.
        XmlTextReader reader = new XmlTextReader("C:\\ChangeSectionName.xml");
        reader.WhitespaceHandling = WhitespaceHandling.None;
        XmlDocument xmlDocIn = new XmlDocument();
        xmlDocIn.Load(reader);
        
        // Update the hierarchy.
        onApplication.UpdateHierarchy(xmlDocIn.OuterXml,
        OneNote.XMLSchema.xs2007);   
    }

```

Следующий XML-код является выдержкой из файла ChangeSectionName.xml, переданной методу с помощью предыдущего кода на C#. При передаче методу **UpdateHierarchy** XML изменяет имя одного из разделов в существующей иерархии (изменяет значение атрибута **name**, указывая "My Renamed Section"). Затем он удаляет все разделы, кроме раздела с измененным именем. Кроме того, код удаляет ненужные атрибуты из целевого элемента **Section**, включая атрибуты **lastModifiedTime**, **isCurrentlyViewed** и **color**, оставляя незатронутыми только атрибуты **name**, **ID** и **path**. 
  
```XML
<?xml version="1.0" ?> 
    <one:Notebooks xmlns:one="http://schemas.microsoft.com/office/onenote/12/2004/onenote"> 
        <one:Notebook name="My Notebook" nickname="My Notebook" ID="{0B8E7305-AC2C-4BCB-8651-1CDA55AAE14C}{1}{B0}"> 
            <one:Section name="My Renamed Section" ID="{5F4E2908-44BA-4C02-91FE-49FC665E9A33}{1}{B0}" path="C:\My Section.one" /> 
        </one:Notebook> 
    </one:Notebooks>
```

Предыдущий XML-код был получен с помощью кода, показанного в примере для метода **GetHierarchy**, который изменен, как показано ниже, чтобы ограничить область разделами. 
  
```cs
static void GetAllSections()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(System.String.Empty, 
            OneNote.HierarchyScope.hsSections, out strXML);
        Clipboard.SetText(strXML.ToString());
        MessageBox.Show("The XML has been copied to the Clipboard");
    }

```

В приведенном ниже примере на C# показано готовое консольное приложение, которое ищет раздел с именем "`Sample_Section`", предлагает пользователю ввести новое имя раздела, а затем использует метод **UpdateHierarchy**, чтобы вместо существующего имени раздела указать введенное пользователем. Прежде чем выполнять код, измените "`Sample_Section`", указав имя раздела, который существует в иерархии OneNote.
  
```cs
    static void Main(string[] args)
    {
        
        // OneNote 2013 Schema namespace.
        string strNamespace = "http://schemas.microsoft.com/office/onenote/2013/onenote";
        string outputXML;
        Application onApplication = new Application();
        onApplication.GetHierarchy(null, HierarchyScope.hsSections, out outputXML);
        // Load a new XmlDocument.
        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.LoadXml(outputXML);
        XmlNamespaceManager nsmgr = new XmlNamespaceManager(xmlDoc.NameTable);
            nsmgr.AddNamespace("one", strNamespace);
        // Search for the section named "Sample_Section".
        XmlNode xmlNode = xmlDoc.SelectSingleNode("//one:Section[@name='Sample_Section']", nsmgr);
        // Prompt for a new section title.
        System.Console.Write("Please enter a new title for the section: ");
        string input = System.Console.ReadLine();
        xmlNode.Attributes["name"].Value = input; 
        // Update the section with the new title.
        onApp.UpdateHierarchy(xmlNode.OuterXml);
        System.Console.Write("Done!\n");
    }

```

### <a name="openhierarchy-method"></a>Метод OpenHierarchy

|||
|:-----|:-----|
|**Описание** <br/> |Откроется раздел или группа разделов, которые вы указали.  <br/> |
|**Синтаксис** <br/> | `HRESULT OpenHierarchy(`<br/>`[in]BSTR bstrPath,`<br/>`[in]BSTR bstrRelativeToObjectID,`<br/>`[out]BSTR * pbstrObjectID,`<br/>`[in,defaultvalue(cftNone)]CreateFileType cftIfNotExist);` <br/> |
|**Параметры** <br/> | _bstrPath_. Путь, который вы хотите открыть. Для записной книжки или группы разделов в записной книжке _bstrPath_ может быть путем к папке или файлу раздела .one. Если указать путь к файлу раздела .one, необходимо включить расширение .one в строку пути к файлу.  <br/><br/>_bstrRelativeToObjectID_. Идентификатор OneNote родительского объекта (записной книжки или группы разделов), в котором нужно открыть новый объект. Если параметр _bstrPath_ является абсолютным путем, можно передать пустую строку ("") для _bstrRelativeToObjectID_. Кроме того, можно передать идентификатор объекта записной книжки или группы разделов, который должен содержать создаваемый объект (раздел или группу разделов). Затем укажите имя файла (например, section1.one) объекта, который нужно создать ниже этого родительского объекта.  <br/><br/>_pbstrObjectID_. (Выходной параметр.) Идентификатор объекта, который OneNote возвращает для записной книжки, группы разделов или раздела, открываемых с помощью метода **OpenHierarchy**. Этот параметр является указателем на строку, в которую метод должен записать идентификатор.  <br/><br/>_cftlfNotExist_. (Необязательный параметр.) Значение из перечисления [CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType). Если вы передаете значение для _cftIfNotExist_, метод **OpenHierarchy** создает файл группы разделов или раздела по указанному пути только в том случае, если файл еще не существует.  <br/> |
   
Если указать группу разделов, которой нет в открытой записной книжке, метод **OpenHierarchy** откроет группу разделов как записную книжку. Если указать раздел, которого нет в открытой записной книжке, метод **OpenHierarchy** откроет раздел в группе недавно открытых разделов. Если указать группу разделов или раздел, которые уже есть в открытой записной книжке, ничего не произойдет, потому что нужная группа разделов или раздел уже открыты. В любом случае **OpenHierarchy** возвращает идентификатор объекта для группы разделов, записной книжки или раздела, которые вы указали, для использования в других операциях. 
  
С помощью метода **OpenHierarchy** можно также создавать новые разделы, не прибегая к импорту XML. 
  
Приведенный ниже код демонстрирует, как использовать метод **OpenHierarchy**, чтобы открыть раздел "Собрания" в записной книжке "Работа" и получить идентификатор раздела. Если раздел еще не существует, OneNote создает его в указанном расположении. 
  
```cs
static void OpenSection()
    {
        String strID;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.OpenHierarchy("C:\\Documents and Settings\\user\\My Documents\\OneNote Notebooks\\Work\\Meetings.one", 
        System.String.Empty, out strID, OneNote.CreateFileType.cftSection);
    }

```

### <a name="deletehierarchy-method"></a>Метод DeleteHierarchy

|||
|:-----|:-----|
|**Описание** <br/> |Удаляет любой объект иерархии (группу разделов, раздел или страницу) из иерархии записной книжки OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT DeleteHierarchy(`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL deletePermanently);` <br/> |
|**Параметры** <br/> | _bstrObjectID_. Идентификатор OneNote объекта, который нужно удалить. Объект может быть группой разделов, разделом или страницей.  <br/><br/>_dateExpectedLastModified_. (Необязательный параметр.) Дата и время (по вашим сведениям) последнего изменения удаляемого объекта. При передаче ненулевого значения для этого параметра OneNote будет выполнять обновление, только если переданное значение соответствует фактической дате и времени последнего изменения объекта. Передача значения для этого параметра помогает предотвратить случайную перезапись во время внесения правок пользователей после последнего изменения объекта.  <br/><br/>_deletePermanently_. (Необязательный параметр.) **true** — окончательное удаление содержимого, **false** — перемещение содержимого в корзину OneNote для соответствующей записной книжки (по умолчанию). Если записная книжка имеет формат OneNote 2007, корзина не существует, поэтому содержимое удаляется без возможности восстановления.  <br/> |
   
### <a name="createnewpage-method"></a>Метод CreateNewPage

|||
|:-----|:-----|
|**Описание** <br/> |Добавляет новую страницу в конец указанного раздела. Новая страница будет добавлена в качестве последней страницы раздела  <br/> |
|**Синтаксис** <br/> | `HRESULT CreateNewPage(`<br/>`[in]BSTR bstrSectionID,`<br/>`[out]BSTR * pbstrPageID);`<br/>`[in,defaultvalue(npsDefault)]NewPageStyle npsNewPageStyle);` <br/> |
|**Параметры** <br/> | _bstrSectionID_. Строка, содержащая идентификатор раздела OneNote, в котором нужно создать новую страницу.  <br/><br/>_pbstrPageID_. (Выходной параметр.) Указатель на строку, в которую метод записывает идентификатор OneNote для только что созданной страницы.  <br/><br/>_npsNewPageStyle_. Значение из перечисления **NewPageStyle**, в котором будет указан стиль создаваемой страницы.  <br/> |
   
API OneNote включает в себя метод **CreateNewPage** для удобства. Можно получить аналогичный результат с лучшим управлением над расположением новой страницы в иерархии, вызвав метод **UpdateHierarchy**. Метод **UpdateHierarchy** также дает возможность создавать вложенные страницы в момент создания новой страницы. 
  
### <a name="closenotebook-method"></a>Способ CloseNotebook

|||
|:-----|:-----|
|**Описание** <br/> |Закрывает указанную записную книжку.  <br/> |
|**Синтаксис** <br/> | `HRESULT CloseNotebook(`<br/>`[in]BSTR bstrNotebookID,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);` <br/> |
|**Параметры** <br/> | _bstrNotebookID_. Идентификатор OneNote записной книжки, которую нужно закрыть.  <br/><br/>_force_. (Необязательный параметр.) Чтобы закрыть записную книжку, даже если в ней есть изменения, которые OneNote не может синхронизировать до закрытия, используется **true**. В ином случае используется **false** (по умолчанию).  <br/> |
   
С помощью метода **CloseNotebook** можно закрыть указанную записную книжку. При вызове этого метода OneNote синхронизирует все автономные файлы с содержимым текущей записной книжки, если это необходимо, и затем закрывает указанную записную книжку. После возвращения метода записная книжка больше не отображается в списке открытых записных книжек в пользовательском интерфейсе OneNote. 
  
### <a name="gethierarchyparent-method"></a>Метод GetHierarchyParent

|||
|:-----|:-----|
|**Описание** <br/> |Получает идентификатор OneNote родительского объекта OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT GetHierarchyParent (`<br/>`[in]BSTR bstrObjectID,`<br/>`[out]BSTR * pbstrParentID);` <br/> |
|**Параметры** <br/> | _bstrObjectID_. Строка, содержащая идентификатор объекта OneNote, для которого нужно найти родительский объект.  <br/><br/>_pbstrParentID_. (Выходной параметр.) Указатель на строку, в которую метод записывает идентификатор родительского объекта OneNote.  <br/> |
   
Если у объекта OneNote нет родительского объекта (например, если пользователь желает получить родительский объект записной книжки), выдается исключение.
  
### <a name="getspeciallocation-method"></a>Метод GetSpecialLocation

|||
|:-----|:-----|
|**Описание** <br/> |Находит путь к расположению, где OneNote сохраняет определенные специальные элементы, такие как резервные копии, не подшитые заметки и записная книжку по умолчанию.  <br/> |
|**Синтаксис** <br/> | `HRESULT GetSpecialLocation(`<br/>`[in]SpecialLocation slToGet,`<br/>`[out]BSTR * pbstrSpecialLocationPath);` <br/> |
|**Параметры** <br/> | _slToGet_. Одно из значений перечисления [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation), которое задает расположение специальной папки для получения.  <br/><br/>_pbstrSpecialLocationPath_. (Выходной параметр.) Указатель на строку, в которую приложение OneNote должно записать путь специальной папки.  <br/> |
   
С помощью этого метода можно определить место на диске, в котором хранится папка "Не подшитые заметки". Иными словами, папка, в которой OneNote хранит заметки, которые создаются при перетаскивании элемента в OneNote, а также заметки, полученные напрямую от других приложений (такие, которые возникают при выборе **Отправить в OneNote** в Microsoft Outlook или Microsoft Internet Explorer). 
  
## <a name="page-content-methods"></a>Методы для содержимого страницы
<a name="ON14DevRef_Application_PageContent"> </a>

Методы, описанные в этом разделе, позволяют обнаруживать, обновлять и удалять содержимое на страницах в записных книжках OneNote, а также публиковать содержимое OneNote.
  
### <a name="getpagecontent-method"></a>Метод GetPageContent

|||
|:-----|:-----|
|**Описание**|Получает все содержимое (в формате XML OneNote) указанной страницы.|
|**Синтаксис**| `HRESULT GetPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[out]BSTR * pbstrPageXmlOut,`<br/>`[in,defaultvalue(piBasic)]PageInfo pageInfoToExport,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema);`|
|**Параметры**| _bstrPageId_. Идентификатор страницы OneNote, содержимое которой нужно получить.<br/><br/>_pbstrPageXmlOut_. (Выходной параметр.) Указатель на строку, в которую программа OneNote должна записать выходные данные XML.<br/><br/>_pageInfoToExport_. (Необязательный параметр.) Указывает, возвращает ли метод **GetPageContent** двоичные данные, внедренные в XML-код в кодировке Base64. Двоичные данные могут включать, например, изображения и данные рукописного ввода. Параметр _pageInfoToExport_ также указывает, нужно ли выполнять разметку выделенного XML-кода, который возвращен методом **GetPageContent**. Необходимое значение перечисления из [PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo).<br/><br/>_xsSchema_. (Необязательный параметр.) Версия схемы XML OneNote типа **XMLSchema**, которую нужно вывести. Вы можете указать нужную версию схемы XML: 2013, 2010, 2007 или текущую. <br/><br/>**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.           |
   
По умолчанию, чтобы избежать чрезмерной длины возвращаемой строки XML, OneNote не внедряет двоичные данные в XML-код. По этой же причине приложение не выполняет разметку для текущего выделенного фрагмента с помощью атрибутов выделения. Двоичные объекты содержат идентификатор OneNote в своих тегах. Чтобы получить двоичный объект, вызовите метод **GetBinaryPageContent** и передайте ему идентификатор OneNote, полученный от метода **GetPageContent**. Используйте метод **GetPageContent**, когда двоичные данные не требуются мгновенно. 
  
### <a name="updatepagecontent-method"></a>Метод UpdatePageContent

|||
|:-----|:-----|
|**Описание**|Обновляет или изменяет содержимое на странице.|
|**Синтаксис**| `HRESULT UpdatePageContent(`<br/>`[in]BSTR bstrPageChangesXmlIn,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);`|
|**Параметры**| _bstrPageChangesXmlIn_. Строка, содержащая XML-код OneNote, включающий в себя изменения, которые нужно внести на странице.<br/><br/>_dateExpectedLastModified_. (Необязательный параметр.) Дата и время (по вашим сведениям) последнего изменения обновляемой страницы. При передаче ненулевого значения для этого параметра OneNote будет выполнять обновление, только если переданное значение соответствует фактической дате и времени последнего изменения страницы. Передача значения для этого параметра помогает предотвратить случайную перезапись во время внесения правок пользователей после последнего изменения страницы.<br/><br/>_xsSchema_. (Необязательный параметр.) Версия схемы XML OneNote типа **XMLSchema**, которую нужно вывести. Вы можете указать нужную версию схемы XML: 2013, 2010, 2007 или текущую. <br/><br/>**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.<br/><br/>_force_ (необязательный параметр). Чтобы обновить содержимое страницы, даже если есть неизвестные данные на странице от будущей версии OneNote, используется **true**. В противном случае используется **false** (по умолчанию). |
   
С помощью этого метода можно изменять страницу разными способами. Например, с помощью метода **UpdatePageContent** можно добавить структуру на страницу, изменить содержимое структуры, добавить изображения, добавить объект рукописного ввода, переместить содержимое и изменить текст в структурах. 
  
Более конкретный пример: с помощью метода **GetPageContent** можно экспортировать существующую страницу, внести некоторые изменения в XML-код страницы, а затем с помощью метода **UpdatePageContent** импортировать всю страницу снова. Кроме того, можно использовать этот метод для добавления новых объектов страницы, например изображений, в конец существующей страницы. 
  
Единственные объекты, которые необходимо включить в XML-код, передаваемый методу **UpdatePageContent**, — это объекты уровня страницы (например, структуры, изображения на странице или объект рукописного ввода на странице), которые были изменены. Этот метод не изменяет и не удаляет объекты уровня страницы, которые не указаны в параметре _bstrPageChangesXmlIn_. Метод полностью заменяет такие объекты уровня страницы, как структуры, идентификаторы которых соответствуют переданным объектам. Поэтому необходимо полностью указать все объекты уровня страницы в коде, включая их существующее содержимое и внесенные в них изменения. 
  
Например, если страница содержит структуру и изображение страницы фона, можно заменить структуру и оставить изображение без изменений, полностью указав структуру в XML-коде с помощью идентификатора существующей структуры, не включая изображение в код. Так как измененная структура, которую вы включаете в код, полностью заменяет существующую, необходимо включить все содержимое структуры.
  
Кроме того, метод **UpdatePageContent** изменяет только свойства элементов, которые вы указываете в параметре _bstrPageChangesXmlIn_. Например, если указать некоторые, но не все свойства элемента **PageSettings**, свойства, которые вы не указываете, остаются без изменений. 
  
В приведенном ниже примере показано, как использовать метод **UpdatePageContent**, чтобы изменить название страницы и добавить на нее некоторый текст образца. Перед выполнением кода замените действительный идентификатор страницы, отображаемый в коде, чтобы код работал на вашем компьютере. Можно получить идентификатор страницы с помощью метода **GetHierarchy** и проверки выходных данных. 
  
```cs
static void UpdatePageContent()
    {
        OneNote.Application onApplication = new OneNote.Application();
        String strImportXML;
        strImportXML = "<?xml version=\"1.0\"?>" +
            "<one:Page xmlns:one=\"http://schemas.microsoft.com/office/onenote/12/2004/onenote\" 
            ID=\"{3428B7BB-EF39-4B9C-A167-3FAE20630C37}{1}{B0}\">" +
            "    <one:PageSettings RTL=\"false\" color=\"automatic\">" +
            "        <one:PageSize>" +
            "            <one:Automatic/>" +
            "        </one:PageSize>" +
            "        <one:RuleLines visible=\"false\"/>" +
            "    </one:PageSettings>" +
            "    <one:Title style=\"font-family:Calibri;
                 font-size:17.0pt\" lang=\"en-US\">" +
            "        <one:OE alignment=\"left\">" +
            "            <one:T>" +
            "                <![CDATA[My Sample Page]]>" +
            "            </one:T>" +
            "        </one:OE>" +
            "    </one:Title>" +
            "    <one:Outline >" +
            "        <one:Position x=\"120\" y=\"160\"/>" +
            "        <one:Size width=\"120\" height=\"15\"/>" +
            "        <one:OEChildren>" +
            "            <one:OE alignment=\"left\">" +
            "                <one:T>" +
            "                    <![CDATA[Sample Text]]>" +
            "                </one:T>" +
            "            </one:OE>" +
            "        </one:OEChildren>" +
            "    </one:Outline>" +
            "</one:Page>";
        // Update the page content.
        onApplication.UpdatePageContent(strImportXML, System.DateTime.MinValue);
    }

```

### <a name="getbinarypagecontent-method"></a>Метод GetBinaryPageContent

|||
|:-----|:-----|
|**Описание** <br/> |Возвращает двоичный объект (например, рукописного ввода или изображения) на странице OneNote в виде строки в кодировке Base64.  <br/> |
|**Синтаксис** <br/> | `HRESULT GetBinaryPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrCallbackID,`<br/>`[out]BSTR * pbstrBinaryObjectB64Out);` <br/> |
|**Параметры** <br/> | _bstrPageID_. Идентификатор OneNote страницы, содержащей двоичный объект, который нужно получить.  <br/><br/>_bstrCallBackID_. Идентификатор OneNote двоичного объекта, который нужно получить. Этот идентификатор, который называется **callbackID**, находится в XML-коде OneNote для страницы, возвращаемой методом **GetPageContent**.  <br/><br/>_pbstrBinaryObectB64Out_. (Выходной параметр.) Указатель на строку, в которую OneNote записывает двоичный объект в виде строки в кодировке Base64.  <br/> |
   
### <a name="deletepagecontent-method"></a>Метод DeletePageContent

|||
|:-----|:-----|
|**Описание** <br/> |Удаляет объект &ndash;, например **Outline**, **Ink** или **Image**, со страницы.  <br/> |
|**Синтаксис** <br/> | `HRESULT DeletePageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL force);` <br/> |
|**Параметры** <br/> | _bstrPageID_. Идентификатор OneNote страницы, содержащей объект, который нужно удалить.  <br/><br/>_bstrObjectID_. Идентификатор OneNote ID объекта, который нужно удалить.  <br/><br/>_dateExpectedLastModified_. (Необязательный параметр.) Дата и время (по вашим сведениям) последнего изменения страницы с удаляемым содержимым. При передаче ненулевого значения для этого параметра OneNote будет выполнять удаление, только если переданное значение соответствует фактической дате и времени последнего изменения страницы. Передача значения для этого параметра помогает предотвратить случайную перезапись во время внесения правок пользователей после последнего изменения страницы.  <br/><br/>_force_. (Необязательный параметр.) Чтобы обновить содержимое страницы, даже если есть неизвестные данные на странице от будущей версии OneNote, используется **true**. В противном случае используется **false** (по умолчанию).  <br/> |
   
### <a name="publish-method"></a>Метод Publish

|||
|:-----|:-----|
|**Описание** <br/> |Экспорт указанной страницы в файл в любом формате, поддерживаемом приложением OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT Publish(`<br/>`[in]BSTR bstrHierarchyID,`<br/>`[in]BSTR bstrTargetFilePath,`<br/>`[in,defaultvalue(pfOneNote)]PublishFormat pfPublishFormat,`<br/>`[in,defaultvalue(0)]BSTR bstrCLSIDofExporter);` <br/> |
|**Параметры** <br/> | _bstrHierarchyID_. Идентификатор OneNote иерархии, которую вы хотите экспортировать.  <br/><br/>_bstrTargetFilePath_. Абсолютный путь к расположению, где вы хотите сохранить получившийся выходной файл. Указанного вами файла не должно быть в этом расположении.  <br/><br/>_pfPublishFormat_. Одно из значений перечисления [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat), указывающее нужный формат, в котором должна быть опубликована страница (например, MTHML, PDF).  <br/><br/>_bstrCLSIDofExporter_, Идентификатор класса (CLSID) для зарегистрированного приложения COM, которое может экспортировать расширенные метафайлы Microsoft Windows (.emf). В COM-приложении необходимо реализовать интерфейс **IMsoDocExporter**. Этот параметр включен, чтобы разрешить сторонним разработчикам писать собственный код для публикации содержимого OneNote в пользовательском формате. Дополнительные сведения об интерфейсе **IMsoDocExporter** см. в статье [Расширение функции экспорта с фиксированным форматом Office 2007](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx).  <br/> |
   
В настоящее время OneNote поддерживает такие форматы файлов:
  
- файлы MHTML (.mht);
- файлы Adobe Acrobat PDF (.pdf);
- файлы XML Paper Specification (XPS) (.xps);
- файлы OneNote 2013, 2010 или 2007 (.one);
- файлы пакетов OneNote (.onepkg);
- документы Microsoft Word (.doc или .docx);
- расширенные метафайлы Microsoft Windows (.emf);
- HTML-файлы (.html).
    
Этот метод дает точно такие же результаты, которые можно получить, нажав кнопку **Опубликовать** в пользовательском интерфейсе и указав нужный формат. 
  
## <a name="navigation-methods"></a>Методы навигации
<a name="ON14DevRef_Application_Navigation"> </a>

Методы, описанные в этом разделе, позволяют находить записные книжки, группы разделов, разделы, страницы и объекты страницы OneNote, переходить к ним и создавать на них ссылки.
  
### <a name="navigateto-method"></a>Метод NavigateTo

|||
|:-----|:-----|
|**Описание** <br/> |Переходит на указанный объект (например, разделы, страницы и элементы **структуры** в пределах страниц).  <br/> |
|**Синтаксис** <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrHierarchyObjectID,`<br/>`[in,defaultvalue(#)]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|**Параметры** <br/> | _bstrHierarchyObjectID_. Идентификатор OneNote объекта, к которому нужно перейти в иерархии OneNote.  <br/><br/>_bstrObjectID_. Идентификатор OneNote объекта, к которому нужно перейти на странице OneNote.  <br/><br/>_fNewWindow_. (Необязательный параметр.) Используется **true**, чтобы открыть указанный объект в новом окне OneNote. Используется **false**, чтобы не открывать новое окно OneNote, если одно уже открыто.  <br/> |
   
### <a name="navigatetourl-method"></a>Метод NavigateToUrl

|||
|:-----|:-----|
|**Описание** <br/> |Если передана ссылка OneNote (onenote://), откроется окно OneNote для соответствующего расположения в OneNote. Если ссылка является внешней по отношению к OneNote (например, https:// или file://), появится диалоговое окно системы безопасности. После удаления OneNote попытается открыть ссылку, и будет возвращена ошибка **HResult.hrObjectDoesNotExist**.  <br/> |
|**Синтаксис** <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrUrl,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|**Параметры** <br/> | _bstrUrl_. Строка, которая указывает, куда нужно перейти. Это может быть ссылка OneNote или любой другой URL-адрес (например, веб-ссылка или указание на сетевое хранилище).  <br/><br/>_fNewWindow_. (Необязательный параметр.) Используется **true**, чтобы открыть указанный URL-адрес в новом окне OneNote. Используется **false**, чтобы не открывать новое окно OneNote, если одно уже открыто.  <br/> |
   
### <a name="gethyperlinktoobject-method"></a>Метод GetHyperLinkToObject

|||
|:-----|:-----|
|**Описание** <br/> |Получает гиперссылку OneNote на указанную записную книжку, группу разделов, раздел, страницу или объект страницы.  <br/> |
|**Синтаксис** <br/> | `HRESULT GetHyperlinkToObject(`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|**Параметры** <br/> | _bstrHierarchyID_. Идентификатор OneNote для записной книжки, группы разделов, раздела или страницы, для которых требуется гиперссылка.  <br/><br/>_bstrPageContentObjectID_. (Необязательный параметр.) Идентификатор OneNote для объекта в пределах страницы, для которого требуется гиперссылка. Например, объект может быть структурой или элементом **Outline**. Если передать пустую строку (""), возвращаемая ссылка указывает на записную книжку, группу разделов, раздел или страницу, которые указаны в параметре _bstrHierarchyID_. Если передать непустую строку для параметра _bstrPageContentObjectID_, параметр _bstrHierarchyID_ должен быть ссылкой на страницу, которая содержит указанный объект.  <br/><br/>_pbstrHyperlinkOut_. (Выходной параметр.) Указатель на строку, в которую метод **GetHyperlinkToObject** записывает выходной текст гиперссылки.  <br/> |
   
При попытке перейти по получившейся ссылке OneNote откроется и отобразит указанный объект в браузере.
  
### <a name="getwebhyperlinktoobject-method"></a>Метод GetWebHyperlinktoObject

|||
|:-----|:-----|
|**Описание** <br/> |Возвращает гиперссылку на объект, который открывается в веб-клиенте OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT GetWebHyperlinkToObject (`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|**Параметры** <br/> | _bstrHierarchyID_. Идентификатор OneNote для записной книжки, группы разделов, раздела или страницы, для которых требуется веб-гиперссылка.  <br/><br/>_bstrPageContentObjectID_. (Необязательный параметр.) Идентификатор OneNote для объекта в пределах страницы, для которого требуется гиперссылка. Например, объект может быть структурой или элементом **Outline**. Если передать пустую строку (""), возвращаемая ссылка указывает на записную книжку, группу разделов, раздел или страницу, которые указаны в параметре _bstrHierarchyID_. Если передать непустую строку для параметра _bstrPageContentObjectID_, параметр _bstrHierarchyID_ должен быть ссылкой на страницу, которая содержит указанный объект.  <br/><br/>_pbstrHyperlinkOut_. (Выходной параметр.) Указатель на строку, в которую метод **GetWebHyperlinkToObject** записывает выходной текст гиперссылки. Если веб-гиперссылку невозможно создать для записной книжки, возвращается значение NULL.  <br/> |
   
### <a name="findpages-method"></a>Метод FindPages

|||
|:-----|:-----|
|**Описание**|Возвращает список страниц, которые соответствуют указанному термину запроса.|
|**Синтаксис**| `HRESULT FindPages(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTR,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fDisplay,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|**Параметры**| _bstrStartNodeID_. Узел (корневой каталог, записная книжка, группа разделов или раздел) ниже для поиска контента. Этот параметр задает область для поиска.<br/><br/>_bstrSearchString_. Строка поиска. Передайте точно такую же строку, которую вы ввели бы в поле поиска пользовательского интерфейса OneNote. Можно использовать битовые операторы, такие как **AND** и **OR**, которые должны быть полностью прописными.<br/><br/>_pbstrHierarchyXmlOut_. (Выходной параметр.) Указатель на строку, в которую программа OneNote должна записать выходную строку XML. Полученная строка XML содержит иерархию записной книжки от корневого каталога до страниц, которые соответствуют строке поиска, включая эти страницы. Например, метод **FindPages** не содержит списка разделов, в которых нет страниц, соответствующих иерархии. Кроме того, если только одна страница в одном разделе соответствует строке, возвращаемая иерархия включает в себя путь к этому разделу и странице, но не другие части иерархии записной книжки.<br/><br/>_fIncludeUnindexedPages_. (Необязательный параметр.) Используется **true**, чтобы искать страницы, которые не были индексированы с помощью Windows Search. В противном случае используется **false**.<br/><br/>_fDisplay_. (Необязательный параметр.) Используется **true**, чтобы выполнить поиск в пользовательском интерфейсе для пользователя, как если бы он ввел строку самостоятельно. Используется **false**, чтобы выполнить запрос без изменения пользовательского интерфейса (по умолчанию).<br/><br/>_xsSchema_. (Необязательный параметр.) Версия схемы OneNote строки _pbstrHierarchyXmlOut_. Это необязательное значение используется для указания версии схемы XML OneNote, в которой находится строка _pbstrHierarchyXmlOut_. Если это значение не указано, OneNote будет предполагать, что версия схемы XML — _xsCurrent_. <br/><br/>**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.           |
   
 **FindPages** работает, только если на вашем компьютере установлен компонент "Поиск" 3.0 или 4.0 (Майкрософт). Windows Vista и Windows 7 включают этот компонент. Но если вы используете более раннюю версию Windows, вам необходимо установить [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) для работы **FindPages**. 
  
### <a name="findmeta-method"></a>Метод FindMeta

|||
|:-----|:-----|
|**Описание**|Возвращает список объектов OneNote, которые содержат метаданные, соответствующие указанному термину запроса.|
|**Синтаксис**| `HRESULT FindMeta (`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTRName,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|**Параметры**| _bstrStartNodeID_. Узел (корневой каталог, записная книжка, группа разделов или раздел) ниже для поиска контента. Этот параметр задает область для поиска.<br/><br/>_bstrSearchStringName_. Строка поиска. Передает любую часть имени метаданных. Если передана пустая строка или значение NULL, все объекты, которые содержат метаданные, будут соответствовать запросу.<br/><br/>_pbstrHierarchyXmlOut_. (Выходной параметр.) Указатель на строку, в которую программа OneNote должна записать выходную строку XML. Полученная строка XML содержит иерархию записной книжки от корневого каталога до страниц, которые соответствуют строке поиска, включая эти страницы. Например, метод **FindPages** не содержит списка разделов, в которых нет страниц, соответствующих иерархии. Кроме того, если только одна страница в одном разделе соответствует строке, возвращаемая иерархия включает в себя путь к этому разделу и странице, но не другие части иерархии записной книжки.  <br/><br/>_fIncludeUnindexedPages_. (Необязательный параметр.) Используется **true**, чтобы искать страницы, которые не были индексированы с помощью Windows Search. В противном случае используется **false**.<br/><br/>_xsSchema_. (Необязательный параметр.) Версия схемы OneNote строки _pbstrHierarchyXmlOut_. Это необязательное значение используется для указания версии схемы XML OneNote, в которой находится строка _pbstrHierarchyXmlOut_. Если это значение не указано, OneNote будет предполагать, что версия схемы XML — _xsCurrent_. <br/><br/>**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.           |
   
**FindMeta** работает только в том случае, если на вашем компьютере установлена служба Microsoft Windows Search 3.0 или 4.0. Windows Vista и Windows 7 включают этот компонент. Но если вы используете более раннюю версию Windows, вам необходимо установить [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) для работы **FindMeta**. 
  
## <a name="functional-methods"></a>Функциональные методы
<a name="ON14DevRef_Application_Functional"> </a>

Методы, описанные в этом разделе, позволяют выполнять определенные действия или задавать параметры в приложении OneNote.
  
### <a name="mergefiles-method"></a>Метод MergeFiles

|||
|:-----|:-----|
|**Описание** <br/> |Позволяет пользователям объединять изменения для одного и того же файла в одно. Чтобы файлы считались одним и тем же файлом, они должны иметь одинаковый идентификатор OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT MergeFiles (`<br/>`[in]BSTR bstrBaseFile,`<br/>`[in]BSTR bstrClientFile,`<br/>`[in]BSTR bstrServerFile,`<br/>`[in]BSTR bstrTargetFile);` <br/> |
|**Параметры** <br/> | _bstrBaseFile_. Строка пути к расположению файла .one первоначального состояния файла.  <br/><br/>_bstrClientFile_. Строка, содержащая путь к расположению файла .one второго набора изменений для объединения в базовый файл после объединения изменений серверного файла с базовым.  <br/><br/>_bstrServerFile_. Строка, содержащая путь к расположению файла .one первого набора изменений для объединения с базовым файлом.  <br/><br/>_bstrTargetFile_. Строка, содержащая путь к расположению файла .one с объединенными изменениями.  <br/> |
   
Метод **MergeFiles** предназначен для мобильных сценариев, в которых может существовать несколько версий файла OneNote. 
  
### <a name="mergesections-method"></a>Метод MergeSections

|||
|:-----|:-----|
|**Описание** <br/> |Объединяет содержимое одного раздела в другой раздел OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT MergeSections (`<br/>`[in]BSTR bstrSectionSourceId,`<br/>`[in]BSTR bstrSectionDestinationId);` <br/> |
|**Параметры** <br/> | _bstrSectionSourceId_. Идентификатор OneNote раздела для объединения.  <br/><br/>_bstrSectionDestinationId_. Идентификатор OneNote раздела, в котором должно произойти объединение. Раздел источника будет объединен в этом разделе назначения.  <br/> |
   
Этот метод выполняет ту же операцию, которую выполняет функция **Объединить в другом разделе**, которая отображается при выборе раздела правой кнопкой мыши. 
  
### <a name="quickfiling-method"></a>Метод QuickFiling

|||
|:-----|:-----|
|**Описание** <br/> |Возвращает экземпляр диалогового окна [IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog), которое может использоваться для выбора расположения в дереве иерархии OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT QuickFiling (`<br/>` );` <br/> |
   
### <a name="synchierarchy-method"></a>Метод SyncHierarchy

|||
|:-----|:-----|
|**Описание** <br/> |OneNote выполняет принудительную синхронизацию указанного объекта с исходным файлом на диске.  <br/> |
|**Синтаксис** <br/> | `HRESULT SyncHierarchy (`<br/>`[in]BSTR bstrHierarchyID);` <br/> |
|**Параметры** <br/> | _bstrHierarchyID_. Идентификатор OneNote синхронизируемого объекта.  <br/> |
   
### <a name="setfilinglocation-method"></a>Метод SetFilingLocation

|||
|:-----|:-----|
|**Описание** <br/> |Позволяет пользователям указать, где и как следует хранить определенные типы содержимого в OneNote.  <br/> |
|**Синтаксис** <br/> | `HRESULT SetFilingLocation (`<br/>`[in]FilingLocation flToSet,`<br/>`[in]FilingLocationType fltToSet,`<br/>`[in]BSTR bstrFilingSectionID);`           <br/> |
|**Параметры** <br/> | _flToSet_. Тип объекта расположения для хранения, который нужно задать.  <br/><br/>_fltToSet_. Расположение для хранения типа.  <br/><br/>_bstrFilingSectionID_. Идентификатор OneNote раздела или страницы, расположение которых нужно задать. Если неприменимо, пользователь может передать значение NULL или пустую строку.  <br/> |
   
Типы содержимого, которое можно хранить, включают элементы Outlook и веб-заметки в Internet Explorer, которые будут импортированы в OneNote с помощью команды **Отправить в OneNote** в каждом приложении. С помощью этого метода можно задать также расположение для хранения элементов, которые должны печататься в OneNote. 
  
## <a name="properties"></a>Свойства
<a name="ON14DevRef_Application_Properties"> </a>

В этом разделе описаны свойства интерфейса **приложения**. 
  
|**Свойство**|**Описание**|
|:-----|:-----|
|**Windows** <br/> |Предоставляет пользователям доступ к открытым окнам OneNote. Это свойство позволяет пользователям выполнять перечисление через набор окон OneNote и изменять некоторые свойства окон. Дополнительные сведения см. в статье [Интерфейсы Windows](window-interfaces-onenote.md).  <br/> |
|**COMAddIns** <br/> |Возвращает коллекцию **COMAddIns** для OneNote. Эта коллекция содержит все надстройки COM, доступные в OneNote. Свойство **Count** коллекции **COMAddins** возвращает количество доступных надстроек COM. Дополнительные сведения см. в статье об объекте [COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx).  <br/> |
|**LanguageSettings** <br/> |Позволяет получить доступ к некоторым интерфейсам API, чтобы изменить общие языковые параметры OneNote.  <br/> |
   
## <a name="events"></a>События
<a name="ON14DevRef_Application_Events"> </a>

В этом разделе описаны события интерфейса приложения.
  
> [!CAUTION]
> В настоящее время события невозможно добавить в управляемый код. 
  
### <a name="onnavigate-event"></a>Событие OnNavigate

|||
|:-----|:-----|
|**Описание** <br/> |Позволяет пользователю назначить функцию, которая будет вызываться при перемещении пользовательского интерфейса OneNote от текущего расположения OneNote.  <br/> |
|**Синтаксис** <br/> | `Event OnNavigate (`<br/>` );` <br/> |
   
### <a name="onhierarchychange-method"></a>Метод OnHierarchyChange

|||
|:-----|:-----|
|**Описание** <br/> |Позволяет пользователю назначить функцию, которая будет вызываться при каждом изменении иерархии OneNote (например, при добавлении или удалении страниц и перемещении разделов). Изменения иерархии пакетные. Если происходит несколько изменений одновременно или почти одновременно, событие в OneNote возникает один раз.  <br/> |
|**Синтаксис** <br/> | `Event OnHierarchyChange (`<br/>` BSTR bstrActivePageID);` <br/> |
|**Параметры** <br/> | _bstrActivePageID_. Передает идентификатор OneNote активной страницы.  <br/> |
   
## <a name="see-also"></a>См. также

- [Справочник разработчика для OneNote](onenote-developer-reference.md)


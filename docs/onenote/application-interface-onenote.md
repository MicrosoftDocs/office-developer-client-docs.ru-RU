---
title: Интерфейс приложения (OneNote)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
ms.assetid: 87926f7d-e1dc-41d5-8805-6ba91fc7b154
description: С помощью методов интерфейса приложения можно извлекать и обновлять содержимое и данные OneNote, а также работать с такими данными и содержимым. Методы разбиты на четыре общие категории.
localization_priority: Priority
ms.openlocfilehash: 20b2fc42711aaf4f1b407efb2c70057bd88a9046
ms.sourcegitcommit: d6695c94415fa47952ee7961a69660abc0904434
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2019
ms.locfileid: "28707999"
---
# <a name="application-interface-onenote"></a><span data-ttu-id="f3a80-104">Интерфейс приложения (OneNote)</span><span class="sxs-lookup"><span data-stu-id="f3a80-104">Application interface (OneNote)</span></span>

<span data-ttu-id="f3a80-105">С помощью методов интерфейса **приложения** можно извлекать и обновлять содержимое и данные OneNote, а также работать с такими данными и содержимым.</span><span class="sxs-lookup"><span data-stu-id="f3a80-105">The **Application** interface includes methods help retrieve, manipulate, and update OneNote information and content.</span></span> <span data-ttu-id="f3a80-106">Методы разбиты на четыре общие категории.</span><span class="sxs-lookup"><span data-stu-id="f3a80-106">The methods are in four general categories:</span></span> 
  
- <span data-ttu-id="f3a80-107">**Структура записной книжки**. Методы для работы со структурой записной книжки, в том числе предназначенные для обнаружения, открытия, изменения, закрытия и удаления записных книжек, разделов и групп разделов.</span><span class="sxs-lookup"><span data-stu-id="f3a80-107">**Notebook structure** &ndash; Methods for working with notebook structure, including those for discovering, opening, modifying, closing, and deleting notebooks, section groups, and sections.</span></span> 
    
- <span data-ttu-id="f3a80-108">**Страница содержимого**. Методы для работы со страницами и содержимым страниц, в том числе предназначенные для обнаружения, изменения, сохранения и удаления содержимого страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-108">**Page content** &ndash; Methods for working with pages and page content, including those for discovering, modifying, saving, and deleting page content.</span></span> <span data-ttu-id="f3a80-109">Содержимое страницы включает двоичные объекты, в частности объекты рукописного ввода и изображения, а также текстовые объекты, например структуры.</span><span class="sxs-lookup"><span data-stu-id="f3a80-109">Page content includes binary objects, such as ink and images, and text objects, such as outlines.</span></span> 
    
- <span data-ttu-id="f3a80-110">**Навигация**. Методы для поиска страниц и объектов, создания ссылок на них и навигации по ним.</span><span class="sxs-lookup"><span data-stu-id="f3a80-110">**Navigation** &ndash; Methods for finding, linking to, and navigating to pages and objects.</span></span> 
    
- <span data-ttu-id="f3a80-111">**Функциональные**. Все остальные методы, которые выполняют определенные действия или задают параметры в OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-111">**Functional** &ndash; All other methods that perform certain actions or set parameters in OneNote.</span></span> 
    
<span data-ttu-id="f3a80-112">Кроме того, интерфейс **приложения** содержит ряд *свойств* и *событий*.</span><span class="sxs-lookup"><span data-stu-id="f3a80-112">In addition, the **Application** interface includes a number of  *properties*  and  *events*  .</span></span> 
  
## <a name="notebook-structure-methods"></a><span data-ttu-id="f3a80-113">Методы структуры записной книжки</span><span class="sxs-lookup"><span data-stu-id="f3a80-113">Notebook Structure methods</span></span>
<span data-ttu-id="f3a80-114"><a name="ON14DevRef_Application_NotebookStructure"> </a></span><span class="sxs-lookup"><span data-stu-id="f3a80-114"></span></span>

<span data-ttu-id="f3a80-115">Методы, описанные в этом разделе, позволяют находить, открывать, изменять, закрывать и удалять записные книжки OneNote, разделы и группы разделов.</span><span class="sxs-lookup"><span data-stu-id="f3a80-115">The methods described in this section enable you to discover, open, modify, close, and delete OneNote notebooks, section groups, and sections.</span></span>
  
### <a name="gethierarchy-method"></a><span data-ttu-id="f3a80-116">Метод GetHierarchy</span><span class="sxs-lookup"><span data-stu-id="f3a80-116">GetHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-117">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-117">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-118">Получает структуру иерархии узла записной книжки, начиная с указанного узла (все записные книжки или одна записная книжка, группа разделов или раздел) и заканчивая последним потомком на указанном уровне (раскрытие списка потомков).</span><span class="sxs-lookup"><span data-stu-id="f3a80-118">Gets the notebook node hierarchy structure, starting from the node you specify (all notebooks or a single notebook, section group, or section), and extending downward to all descendants at the level you specify.</span></span>  <br/> |
|<span data-ttu-id="f3a80-119">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-119">**Syntax**</span></span> <br/> | `HRESULT GetHierarchy(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]HierarchyScope hsScope,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(xs2013)]XMLSchema xsSchema);` <br/> |
|<span data-ttu-id="f3a80-120">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-120">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-121">_bstrStartNodeID_. Узел (записная книжка, группа разделов или раздел), потомки которого вам нужны.</span><span class="sxs-lookup"><span data-stu-id="f3a80-121">_bstrStartNodeID_ &ndash; The node (notebook, section group, or section) whose descendants you want.</span></span> <span data-ttu-id="f3a80-122">Если вы передаете строку NULL (""), метод получает все узлы ниже корневого узла (то есть все записные книжки, группы разделов и разделы).</span><span class="sxs-lookup"><span data-stu-id="f3a80-122">If you pass a null string (""), the method gets all nodes below the root node (that is, all notebooks, section groups, and sections).</span></span> <span data-ttu-id="f3a80-123">Если указать узел в виде записной книжки, группы разделов или раздела, метод получает только потомков этого узла.</span><span class="sxs-lookup"><span data-stu-id="f3a80-123">If you specify a notebook, section group, or section node, the method gets only descendants of that node.</span></span>  <br/><br/><span data-ttu-id="f3a80-124">_hsScope_. Уровень узла самого нижнего потомка, который вам нужен.</span><span class="sxs-lookup"><span data-stu-id="f3a80-124">_hsScope_ &ndash; The lowest descendant node level you want.</span></span> <span data-ttu-id="f3a80-125">Например, если указать страницы, метод возвращает все узлы до уровня страниц.</span><span class="sxs-lookup"><span data-stu-id="f3a80-125">For example, if you specify pages, the method gets all nodes as far down as the page level.</span></span> <span data-ttu-id="f3a80-126">Если указать разделы, метод получит только узлы разделов, указанных под уровнем записной книжки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-126">If you specify sections, the method gets only section nodes below the notebook.</span></span> <span data-ttu-id="f3a80-127">Дополнительные сведения см. в статье о перечислении **HierarchyScope** в теме [Перечисление](enumerations-onenote-developer-reference.md#odc_HierarchyScope).</span><span class="sxs-lookup"><span data-stu-id="f3a80-127">For more information, see the **HierarchyScope** enumeration in the [Enumerations](enumerations-onenote-developer-reference.md#odc_HierarchyScope) topic.</span></span>  <br/><br/><span data-ttu-id="f3a80-128">_pbstrHierarchyXmlOut_. Выходной параметр, указатель на строку, в которую программа OneNote должна записать выходные данные XML.</span><span class="sxs-lookup"><span data-stu-id="f3a80-128">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to the string in which you want OneNote to write the XML output.</span></span>  <br/><br/><span data-ttu-id="f3a80-129">_xsSchema_. (Необязательный параметр.) Версия схемы XML OneNote типа **XMLSchema**, которую нужно вывести.</span><span class="sxs-lookup"><span data-stu-id="f3a80-129">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="f3a80-130">Вы можете указать нужную версию схемы XML: 2013, 2010, 2007 или текущую.</span><span class="sxs-lookup"><span data-stu-id="f3a80-130">You can specify whether you want XML Schema version 2013, 2010, 2007, or the current version.</span></span>  <br/><br/><span data-ttu-id="f3a80-131">**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-131">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="f3a80-132">По умолчанию метод GetHierarchy возвращает строку в формате OneNote 2013 XML. Можно также задать предпочитаемую версию схемы XML с помощью необязательного параметра _xsSchema_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-132">The GetHierarchy method returns a string in OneNote 2013 XML format by default or you can set the preferred XML schema version by using the optional  _xsSchema_ parameter.</span></span> 
  
<span data-ttu-id="f3a80-133">В зависимости от переданных параметров метод **GetHierarchy** может возвращать разные списки (например, все записные книжки, все разделы всех записных книжек, все страницы в пределах указанного раздела или все страницы указанной записной книжки).</span><span class="sxs-lookup"><span data-stu-id="f3a80-133">Depending on the parameters you pass, the **GetHierarchy** method can return various lists (for example all notebooks, all sections in all notebooks, all pages within a given section, or all pages within a given notebook).</span></span> <span data-ttu-id="f3a80-134">Для каждого узла возвращенная строка XML содержит свойства (например, раздел или название страницы, идентификатор и время последнего изменения).</span><span class="sxs-lookup"><span data-stu-id="f3a80-134">For each node, the XML string returned provides properties (for example, the section or page title, ID, and last-modified time).</span></span> 
  
<span data-ttu-id="f3a80-135">Не все сочетания начального узла и области допустимы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-135">Not all combinations of start node and scope are valid.</span></span> <span data-ttu-id="f3a80-136">Например, если указать начальный узел в виде раздела и область в виде записной книжки, **GetHierarchy** возвратит результат NULL, так как записная книжка находится в иерархии узлов выше, чем раздел.</span><span class="sxs-lookup"><span data-stu-id="f3a80-136">For example, if you specify a section start node and a notebook scope, **GetHierarchy** returns a null result because a notebook is higher in the node hierarchy than a section.</span></span> 
  
<span data-ttu-id="f3a80-137">В следующем примере на C# показано, как использовать метод **GetHierarchy**, чтобы получить всю иерархию OneNote, включая все записные книжки, до уровня страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-137">The following C# example shows how to use the **GetHierarchy** method to get the entire OneNote hierarchy, including all notebooks, down to the page level.</span></span> <span data-ttu-id="f3a80-138">Он копирует выходную строку в буфер обмена, из которого можно вставить строку в текстовый редактор для проверки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-138">It copies the output string to the Clipboard, from which you can paste the string into a text editor for review.</span></span> 
  
```cs
static void GetEntireHierarchy()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(null, 
            OneNote.HierarchyScope.hsPages, out strXML);
        Clipboard.SetText(strXML);
        MessageBox.Show("The XML has been copied to the clipboard");
    }

```

### <a name="updatehierarchy-method"></a><span data-ttu-id="f3a80-139">Метод UpdateHierarchy</span><span class="sxs-lookup"><span data-stu-id="f3a80-139">UpdateHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-140">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-140">**Description**</span></span>|<span data-ttu-id="f3a80-141">Изменяет или обновляет иерархию записных книжек.</span><span class="sxs-lookup"><span data-stu-id="f3a80-141">Modifies or updates the hierarchy of notebooks.</span></span> <span data-ttu-id="f3a80-142">Например, можно добавить разделы и группы разделов в записную книжку, добавить новую записную книжку, переместить разделы в пределах записной книжки, изменить имя раздела, добавить страницы в раздел или изменить порядок страниц в разделах.</span><span class="sxs-lookup"><span data-stu-id="f3a80-142">For example, you can add sections or section groups to a notebook, add a new notebook, move sections within a notebook, change the name of a section, add pages to a section, or change the order of pages within sections.</span></span>|
|<span data-ttu-id="f3a80-143">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-143">**Syntax**</span></span>| `HRESULT UpdateHierarchy(`<br/>`[in]BSTR bstrChangesXmlIn,`<br/>`[in,defaultvalue(xsCurrent)] XMLSchema xsSchema);`|
|<span data-ttu-id="f3a80-144">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-144">**Parameters**</span></span>| <span data-ttu-id="f3a80-145">_bstrChangesXmlIn_. Строка, которая содержит код XML OneNote, в котором указаны вносимые в иерархию изменения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-145">_bstrChangesXmlIn_ &ndash; A string that contains OneNote XML code that specifies the hierarchy changes to make.</span></span> <span data-ttu-id="f3a80-146">Например, если вы хотите вставить новый раздел, вы можете добавить элемент **Section** в строку XML, чтобы указать место добавления раздела.</span><span class="sxs-lookup"><span data-stu-id="f3a80-146">For example, if you want to insert a new section, you can add a **Section** element in the XML string to indicate where you want the new section to be added.</span></span> <span data-ttu-id="f3a80-147">Кроме того, если вы хотите переименовать существующий раздел, можно сохранить тот же идентификатор раздела и изменить его атрибут **name** в XML-коде.</span><span class="sxs-lookup"><span data-stu-id="f3a80-147">Alternatively, if you want to change the name of an existing section, you can keep the same section ID and change its **name** attribute in the XML code.</span></span><br/><br/><span data-ttu-id="f3a80-148">_xsSchema_. (Необязательный параметр.) Версия схемы OneNote строки _bstrChangesXmln_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-148">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _bstrChangesXmln_.</span></span> <span data-ttu-id="f3a80-149">Это необязательное значение используется для указания версии схемы XML OneNote, в которой находится строка _bstrChangesXmlIn_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-149">This optional value is used to specify the version of the OneNote XML schema that the  _bstrChangesXmlIn_ string is in.</span></span> <span data-ttu-id="f3a80-150">Если это значение не указано, OneNote будет предполагать, что версия схемы XML — _xsCurrent_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-150">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="f3a80-151">**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-151">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="f3a80-152">Если вы передадите только часть строки XML OneNote для параметра _bstrChangesXmlIn_, OneNote попытается определить нужные изменения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-152">If you pass only a partial OneNote XML string for the  _bstrChangesXmlIn_ parameter, OneNote attempts to infer the changes you want.</span></span> <span data-ttu-id="f3a80-153">Например, если вы включаете элемент **Notebook**, который содержит только один раздел, OneNote добавляет раздел после всех существующих разделов.</span><span class="sxs-lookup"><span data-stu-id="f3a80-153">For example, if you include a **Notebook** element that contains only one section, OneNote adds the section after any existing sections.</span></span> <span data-ttu-id="f3a80-154">Однако если указанная вами операция неоднозначна, определить результат может быть сложно.</span><span class="sxs-lookup"><span data-stu-id="f3a80-154">However, if the operation you specify is ambiguous, the result can be hard to determine.</span></span> <span data-ttu-id="f3a80-155">Например, если существующая записная книжка содержит четыре раздела, а переданная строка XML включает записную книжку и только четвертый и первый разделы (в таком порядке), OneNote может поместить второй и третий разделы перед четвертым разделом или после первого раздела.</span><span class="sxs-lookup"><span data-stu-id="f3a80-155">For example, if an existing notebook contains four sections, and the XML string you pass includes the notebook and only the fourth and first sections (in that order), OneNote might place the second and third sections before the fourth section or after the first section.</span></span> 
  
<span data-ttu-id="f3a80-156">С помощью метода **UpdateHierarchy** невозможно удалить часть записной книжки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-156">You cannot use the **UpdateHierarchy** method to delete part of a notebook.</span></span> <span data-ttu-id="f3a80-157">Иными словами, передача строки XML, которая содержит только часть существующей иерархии, не приводит к удалению разделов, которые не входят в строку.</span><span class="sxs-lookup"><span data-stu-id="f3a80-157">That is, passing an XML string that includes only part of an existing hierarchy does not delete sections that are not included in the string.</span></span> <span data-ttu-id="f3a80-158">Чтобы удалить часть иерархии, используйте метод **DeleteHierarchy**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-158">To delete part of a hierarchy, use the **DeleteHierarchy** method.</span></span> 
  
<span data-ttu-id="f3a80-159">Указанный ниже код C# демонстрирует один способ использования метода **UpdateHierarchy** для изменения иерархии OneNote путем изменения имени существующего раздела.</span><span class="sxs-lookup"><span data-stu-id="f3a80-159">The following C# code shows one way to use the **UpdateHierarchy** method to change the OneNote hierarchy, by changing the name of an existing section.</span></span> <span data-ttu-id="f3a80-160">Он читает XML-код из файла образца с именем ChangeSectionName.xml в корне диска C, загружает код в XML-документ, а затем передает структуру XML этого документа методу.</span><span class="sxs-lookup"><span data-stu-id="f3a80-160">It reads XML code from a sample file named ChangeSectionName.xml at the root of drive C, loads it into an XML document, and then passes the XML structure of that document to the method.</span></span> 
  
```cs
static void UpdateExistingHierarchy()
    {
        OneNote.Application onApplication = new OneNote.Application();
        
        // Get the XML from the file.
        XmlTextReader reader = new XmlTextReader("C:\\ChangeSectionName.xml");
        reader.WhitespaceHandling = WhitespaceHandling.None;
        XmlDocument xmlDocIn = new XmlDocument();
        xmlDocIn.Load(reader);
        
        // Update the hierarchy.
        onApplication.UpdateHierarchy(xmlDocIn.OuterXml,
        OneNote.XMLSchema.xs2007);   
    }

```

<span data-ttu-id="f3a80-161">Следующий XML-код является выдержкой из файла ChangeSectionName.xml, переданной методу с помощью предыдущего кода на C#.</span><span class="sxs-lookup"><span data-stu-id="f3a80-161">The following XML code is an excerpt of the ChangeSectionName.xml file that the previous C# code passes to the method.</span></span> <span data-ttu-id="f3a80-162">При передаче методу **UpdateHierarchy** XML изменяет имя одного из разделов в существующей иерархии (изменяет значение атрибута **name**, указывая "My Renamed Section").</span><span class="sxs-lookup"><span data-stu-id="f3a80-162">When the XML is passed to the **UpdateHierarchy** method, it changes the name of one of the sections in the existing hierarchy (by changing the value of the **name** attribute to "My Renamed Section").</span></span> <span data-ttu-id="f3a80-163">Затем он удаляет все разделы, кроме раздела с измененным именем.</span><span class="sxs-lookup"><span data-stu-id="f3a80-163">It then removes all the sections except the one whose name was changed.</span></span> <span data-ttu-id="f3a80-164">Кроме того, код удаляет ненужные атрибуты из целевого элемента **Section**, включая атрибуты **lastModifiedTime**, **isCurrentlyViewed** и **color**, оставляя незатронутыми только атрибуты **name**, **ID** и **path**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-164">In addition, the code removes unnecessary attributes from the target **Section** element, including the **lastModifiedTime**, **isCurrentlyViewed**, and **color** attributes, leaving only the **name**, **ID**, and **path** attributes intact.</span></span> 
  
```XML
<?xml version="1.0" ?> 
    <one:Notebooks xmlns:one="https://schemas.microsoft.com/office/onenote/12/2004/onenote"> 
        <one:Notebook name="My Notebook" nickname="My Notebook" ID="{0B8E7305-AC2C-4BCB-8651-1CDA55AAE14C}{1}{B0}"> 
            <one:Section name="My Renamed Section" ID="{5F4E2908-44BA-4C02-91FE-49FC665E9A33}{1}{B0}" path="C:\My Section.one" /> 
        </one:Notebook> 
    </one:Notebooks>
```

<span data-ttu-id="f3a80-165">Предыдущий XML-код был получен с помощью кода, показанного в примере для метода **GetHierarchy**, который изменен, как показано ниже, чтобы ограничить область разделами.</span><span class="sxs-lookup"><span data-stu-id="f3a80-165">The preceding XML code was obtained by using the code shown in the example for the **GetHierarchy** method, which is modified, as follows, to limit the scope to sections.</span></span> 
  
```cs
static void GetAllSections()
    {
        String strXML;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.GetHierarchy(System.String.Empty, 
            OneNote.HierarchyScope.hsSections, out strXML);
        Clipboard.SetText(strXML.ToString());
        MessageBox.Show("The XML has been copied to the Clipboard");
    }

```

<span data-ttu-id="f3a80-166">В приведенном ниже примере на C# показано готовое консольное приложение, которое ищет раздел с именем "`Sample_Section`", предлагает пользователю ввести новое имя раздела, а затем использует метод **UpdateHierarchy**, чтобы вместо существующего имени раздела указать введенное пользователем.</span><span class="sxs-lookup"><span data-stu-id="f3a80-166">The following C# example shows a complete console application that searches for a section named " `Sample_Section`", prompts the user to input a new name for the section, and then uses the **UpdateHierarchy** method to change the section name to the name that the user typed.</span></span> <span data-ttu-id="f3a80-167">Прежде чем выполнять код, измените "`Sample_Section`", указав имя раздела, который существует в иерархии OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-167">Before running the code, change "  `Sample_Section`" to the name of a section that exists in your OneNote hierarchy.</span></span>
  
```cs
    static void Main(string[] args)
    {
        
        // OneNote 2013 Schema namespace.
        string strNamespace = "https://schemas.microsoft.com/office/onenote/2013/onenote";
        string outputXML;
        Application onApplication = new Application();
        onApplication.GetHierarchy(null, HierarchyScope.hsSections, out outputXML);
        // Load a new XmlDocument.
        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.LoadXml(outputXML);
        XmlNamespaceManager nsmgr = new XmlNamespaceManager(xmlDoc.NameTable);
            nsmgr.AddNamespace("one", strNamespace);
        // Search for the section named "Sample_Section".
        XmlNode xmlNode = xmlDoc.SelectSingleNode("//one:Section[@name='Sample_Section']", nsmgr);
        // Prompt for a new section title.
        System.Console.Write("Please enter a new title for the section: ");
        string input = System.Console.ReadLine();
        xmlNode.Attributes["name"].Value = input; 
        // Update the section with the new title.
        onApp.UpdateHierarchy(xmlNode.OuterXml);
        System.Console.Write("Done!\n");
    }

```

### <a name="openhierarchy-method"></a><span data-ttu-id="f3a80-168">Метод OpenHierarchy</span><span class="sxs-lookup"><span data-stu-id="f3a80-168">OpenHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-169">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-169">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-170">Откроется раздел или группа разделов, которые вы указали.</span><span class="sxs-lookup"><span data-stu-id="f3a80-170">Opens a section group or section that you specify.</span></span>  <br/> |
|<span data-ttu-id="f3a80-171">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-171">**Syntax**</span></span> <br/> | `HRESULT OpenHierarchy(`<br/>`[in]BSTR bstrPath,`<br/>`[in]BSTR bstrRelativeToObjectID,`<br/>`[out]BSTR * pbstrObjectID,`<br/>`[in,defaultvalue(cftNone)]CreateFileType cftIfNotExist);` <br/> |
|<span data-ttu-id="f3a80-172">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-172">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-173">_bstrPath_. Путь, который вы хотите открыть.</span><span class="sxs-lookup"><span data-stu-id="f3a80-173">_bstrPath_ &ndash; The path that you want to open.</span></span> <span data-ttu-id="f3a80-174">Для записной книжки или группы разделов в записной книжке _bstrPath_ может быть путем к папке или файлу раздела .one.</span><span class="sxs-lookup"><span data-stu-id="f3a80-174">For a notebook, or for a section group in a notebook,  _bstrPath_ can be a folder path or the path to an .one section file.</span></span> <span data-ttu-id="f3a80-175">Если указать путь к файлу раздела .one, необходимо включить расширение .one в строку пути к файлу.</span><span class="sxs-lookup"><span data-stu-id="f3a80-175">If you specify the path to an .one section file, you must include the .one extension on the file-path string.</span></span>  <br/><br/><span data-ttu-id="f3a80-176">_bstrRelativeToObjectID_. Идентификатор OneNote родительского объекта (записной книжки или группы разделов), в котором нужно открыть новый объект.</span><span class="sxs-lookup"><span data-stu-id="f3a80-176">_bstrRelativeToObjectID_ &ndash; The OneNote ID of the parent object (notebook or section group) under which you want the new object to open.</span></span> <span data-ttu-id="f3a80-177">Если параметр _bstrPath_ является абсолютным путем, можно передать пустую строку ("") для _bstrRelativeToObjectID_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-177">If the  _bstrPath_ parameter is an absolute path, you can pass an empty string ("") for  _bstrRelativeToObjectID_.</span></span> <span data-ttu-id="f3a80-178">Кроме того, можно передать идентификатор объекта записной книжки или группы разделов, который должен содержать создаваемый объект (раздел или группу разделов). Затем укажите имя файла (например, section1.one) объекта, который нужно создать ниже этого родительского объекта.</span><span class="sxs-lookup"><span data-stu-id="f3a80-178">Alternatively, you can pass the object ID of the notebook or section group that should contain the object (section or section group) that you want to create, and then specify the file name (for example, section1.one) of the object that you want to create under that parent object.</span></span>  <br/><br/><span data-ttu-id="f3a80-179">_pbstrObjectID_. (Выходной параметр.) Идентификатор объекта, который OneNote возвращает для записной книжки, группы разделов или раздела, открываемых с помощью метода **OpenHierarchy**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-179">_pbstrObjectID_ &ndash; (Output parameter) The object ID that OneNote returns for the notebook, section group, or section that the **OpenHierarchy** method opens.</span></span> <span data-ttu-id="f3a80-180">Этот параметр является указателем на строку, в которую метод должен записать идентификатор.</span><span class="sxs-lookup"><span data-stu-id="f3a80-180">This parameter is a pointer to the string into which you want the method to write the ID.</span></span>  <br/><br/><span data-ttu-id="f3a80-181">_cftlfNotExist_. (Необязательный параметр.) Значение из перечисления [CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType).</span><span class="sxs-lookup"><span data-stu-id="f3a80-181">_cftlfNotExist_ &ndash; (Optional) An enumerated value from the [CreateFileType](enumerations-onenote-developer-reference.md#odc_CreateFileType) enumeration.</span></span> <span data-ttu-id="f3a80-182">Если вы передаете значение для _cftIfNotExist_, метод **OpenHierarchy** создает файл группы разделов или раздела по указанному пути только в том случае, если файл еще не существует.</span><span class="sxs-lookup"><span data-stu-id="f3a80-182">If you pass a value for  _cftIfNotExist_, the **OpenHierarchy** method creates the section group or section file at the specified path only if the file does not already exist.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-183">Если указать группу разделов, которой нет в открытой записной книжке, метод **OpenHierarchy** откроет группу разделов как записную книжку.</span><span class="sxs-lookup"><span data-stu-id="f3a80-183">If you specify a section group that is not in an open notebook, the **OpenHierarchy** method opens the section group as a notebook.</span></span> <span data-ttu-id="f3a80-184">Если указать раздел, которого нет в открытой записной книжке, метод **OpenHierarchy** откроет раздел в группе недавно открытых разделов.</span><span class="sxs-lookup"><span data-stu-id="f3a80-184">If you specify a section that is not in an open notebook, the **OpenHierarchy** method opens the section in the Recent Opened Sections section group.</span></span> <span data-ttu-id="f3a80-185">Если указать группу разделов или раздел, которые уже есть в открытой записной книжке, ничего не произойдет, потому что нужная группа разделов или раздел уже открыты.</span><span class="sxs-lookup"><span data-stu-id="f3a80-185">If you specify a section group or section that is already in an open notebook, nothing happens because the section group or section is already open, as well.</span></span> <span data-ttu-id="f3a80-186">В любом случае **OpenHierarchy** возвращает идентификатор объекта для группы разделов, записной книжки или раздела, которые вы указали, для использования в других операциях.</span><span class="sxs-lookup"><span data-stu-id="f3a80-186">In any case, **OpenHierarchy** returns the object ID for the section group, notebook, or section that you specify, so that you can use it in other operations.</span></span> 
  
<span data-ttu-id="f3a80-187">С помощью метода **OpenHierarchy** можно также создавать новые разделы, не прибегая к импорту XML.</span><span class="sxs-lookup"><span data-stu-id="f3a80-187">You can also use the **OpenHierarchy** method to create new sections, instead of doing so by importing XML.</span></span> 
  
<span data-ttu-id="f3a80-188">Приведенный ниже код демонстрирует, как использовать метод **OpenHierarchy**, чтобы открыть раздел "Собрания" в записной книжке "Работа" и получить идентификатор раздела.</span><span class="sxs-lookup"><span data-stu-id="f3a80-188">The following code shows how to use the **OpenHierarchy** method to open the Meetings section in the Work notebook and get the ID for the section.</span></span> <span data-ttu-id="f3a80-189">Если раздел еще не существует, OneNote создает его в указанном расположении.</span><span class="sxs-lookup"><span data-stu-id="f3a80-189">If the section does not already exist, OneNote creates it in the location that you specify.</span></span> 
  
```cs
static void OpenSection()
    {
        String strID;
        OneNote.Application onApplication = new OneNote.Application();
        onApplication.OpenHierarchy("C:\\Documents and Settings\\user\\My Documents\\OneNote Notebooks\\Work\\Meetings.one", 
        System.String.Empty, out strID, OneNote.CreateFileType.cftSection);
    }

```

### <a name="deletehierarchy-method"></a><span data-ttu-id="f3a80-190">Метод DeleteHierarchy</span><span class="sxs-lookup"><span data-stu-id="f3a80-190">DeleteHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-191">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-191">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-192">Удаляет любой объект иерархии (группу разделов, раздел или страницу) из иерархии записной книжки OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-192">Deletes any hierarchy object (a section group, section, or page) from the OneNote notebook hierarchy.</span></span>  <br/> |
|<span data-ttu-id="f3a80-193">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-193">**Syntax**</span></span> <br/> | `HRESULT DeleteHierarchy(`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL deletePermanently);` <br/> |
|<span data-ttu-id="f3a80-194">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-194">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-195">_bstrObjectID_. Идентификатор OneNote объекта, который нужно удалить.</span><span class="sxs-lookup"><span data-stu-id="f3a80-195">_bstrObjectID_ &ndash; The OneNote ID of the object you want to delete.</span></span> <span data-ttu-id="f3a80-196">Объект может быть группой разделов, разделом или страницей.</span><span class="sxs-lookup"><span data-stu-id="f3a80-196">The object can be a section group, section, or page.</span></span>  <br/><br/><span data-ttu-id="f3a80-197">_dateExpectedLastModified_. (Необязательный параметр.) Дата и время (по вашим сведениям) последнего изменения удаляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="f3a80-197">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the object you want to delete was last modified.</span></span> <span data-ttu-id="f3a80-198">При передаче ненулевого значения для этого параметра OneNote будет выполнять обновление, только если переданное значение соответствует фактической дате и времени последнего изменения объекта.</span><span class="sxs-lookup"><span data-stu-id="f3a80-198">If you pass a non-zero value for this parameter, OneNote proceeds with the update only if the value you pass matches the actual date and time the object was last modified.</span></span> <span data-ttu-id="f3a80-199">Передача значения для этого параметра помогает предотвратить случайную перезапись во время внесения правок пользователей после последнего изменения объекта.</span><span class="sxs-lookup"><span data-stu-id="f3a80-199">Passing a value for this parameter helps prevent accidentally overwriting edits users made since the last time the object was modified.</span></span>  <br/><br/><span data-ttu-id="f3a80-200">_deletePermanently_. (Необязательный параметр.) **true** — окончательное удаление содержимого, **false** — перемещение содержимого в корзину OneNote для соответствующей записной книжки (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="f3a80-200">_deletePermanently_ &ndash; (Optional) **true** to permanently delete the content; **false** to move the content into the OneNote recycle bin for the corresponding Notebook (the default).</span></span> <span data-ttu-id="f3a80-201">Если записная книжка имеет формат OneNote 2007, корзина не существует, поэтому содержимое удаляется без возможности восстановления.</span><span class="sxs-lookup"><span data-stu-id="f3a80-201">If the Notebook is in OneNote 2007 format, no recycle bin exists, so the content is permanently deleted.</span></span>  <br/> |
   
### <a name="createnewpage-method"></a><span data-ttu-id="f3a80-202">Метод CreateNewPage</span><span class="sxs-lookup"><span data-stu-id="f3a80-202">CreateNewPage method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-203">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-203">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-204">Добавляет новую страницу в конец указанного раздела.</span><span class="sxs-lookup"><span data-stu-id="f3a80-204">Adds a new page to the end of the section.</span></span> <span data-ttu-id="f3a80-205">Новая страница будет добавлена в качестве последней страницы раздела</span><span class="sxs-lookup"><span data-stu-id="f3a80-205">The new page is added as the last page of the section</span></span>  <br/> |
|<span data-ttu-id="f3a80-206">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-206">**Syntax**</span></span> <br/> | `HRESULT CreateNewPage(`<br/>`[in]BSTR bstrSectionID,`<br/>`[out]BSTR * pbstrPageID);`<br/>`[in,defaultvalue(npsDefault)]NewPageStyle npsNewPageStyle);` <br/> |
|<span data-ttu-id="f3a80-207">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-207">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-208">_bstrSectionID_. Строка, содержащая идентификатор раздела OneNote, в котором нужно создать новую страницу.</span><span class="sxs-lookup"><span data-stu-id="f3a80-208">_bstrSectionID_ &ndash; A string that contains the OneNote ID of the section in which you want to create the new page.</span></span>  <br/><br/><span data-ttu-id="f3a80-209">_pbstrPageID_. (Выходной параметр.) Указатель на строку, в которую метод записывает идентификатор OneNote для только что созданной страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-209">_pbstrPageID_ &ndash; (Output parameter) A pointer to the string into which the method writes the OneNote ID for the newly created page.</span></span>  <br/><br/><span data-ttu-id="f3a80-210">_npsNewPageStyle_. Значение из перечисления **NewPageStyle**, в котором будет указан стиль создаваемой страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-210">_npsNewPageStyle_ &ndash; A value from the **NewPageStyle** enumeration that specifies the style of the page to be created.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-211">API OneNote включает в себя метод **CreateNewPage** для удобства.</span><span class="sxs-lookup"><span data-stu-id="f3a80-211">The OneNote API includes the **CreateNewPage** method as a convenience.</span></span> <span data-ttu-id="f3a80-212">Можно получить аналогичный результат с лучшим управлением над расположением новой страницы в иерархии, вызвав метод **UpdateHierarchy**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-212">You can achieve the same result, with greater control over how the new page is positioned in the hierarchy, by calling the **UpdateHierarchy** method.</span></span> <span data-ttu-id="f3a80-213">Метод **UpdateHierarchy** также дает возможность создавать вложенные страницы в момент создания новой страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-213">The **UpdateHierarchy** method also lets you create subpages at the same time as you create a new page.</span></span> 
  
### <a name="closenotebook-method"></a><span data-ttu-id="f3a80-214">Способ CloseNotebook</span><span class="sxs-lookup"><span data-stu-id="f3a80-214">CloseNotebook method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-215">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-215">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-216">Закрывает указанную записную книжку.</span><span class="sxs-lookup"><span data-stu-id="f3a80-216">Closes the specified form.</span></span>  <br/> |
|<span data-ttu-id="f3a80-217">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-217">**Syntax**</span></span> <br/> | `HRESULT CloseNotebook(`<br/>`[in]BSTR bstrNotebookID,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);` <br/> |
|<span data-ttu-id="f3a80-218">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-218">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-219">_bstrNotebookID_. Идентификатор OneNote записной книжки, которую нужно закрыть.</span><span class="sxs-lookup"><span data-stu-id="f3a80-219">_bstrNotebookID_ &ndash; The OneNote ID of the notebook you want to close.</span></span>  <br/><br/><span data-ttu-id="f3a80-220">_force_. (Необязательный параметр.) Чтобы закрыть записную книжку, даже если в ней есть изменения, которые OneNote не может синхронизировать до закрытия, используется **true**. В ином случае используется **false** (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="f3a80-220">_force_ &ndash; (Optional) **true** to close the notebook, even if there are changes in the notebook that OneNote cannot sync before closing; otherwise, **false** (the default).</span></span>  <br/> |
   
<span data-ttu-id="f3a80-221">С помощью метода **CloseNotebook** можно закрыть указанную записную книжку.</span><span class="sxs-lookup"><span data-stu-id="f3a80-221">You can use the **CloseNotebook** method to close the notebook you specify.</span></span> <span data-ttu-id="f3a80-222">При вызове этого метода OneNote синхронизирует все автономные файлы с содержимым текущей записной книжки, если это необходимо, и затем закрывает указанную записную книжку.</span><span class="sxs-lookup"><span data-stu-id="f3a80-222">When you call this method, OneNote synchronizes any offline files with current notebook content, if necessary, and then closes the specified notebook.</span></span> <span data-ttu-id="f3a80-223">После возвращения метода записная книжка больше не отображается в списке открытых записных книжек в пользовательском интерфейсе OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-223">After the method returns, the notebook no longer appears in the list of open notebooks in the OneNote user interface (UI).</span></span> 
  
### <a name="gethierarchyparent-method"></a><span data-ttu-id="f3a80-224">Метод GetHierarchyParent</span><span class="sxs-lookup"><span data-stu-id="f3a80-224">GetHierarchyParent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-225">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-225">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-226">Получает идентификатор OneNote родительского объекта OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-226">Gets the OneNote ID for the parent object of a OneNote object.</span></span>  <br/> |
|<span data-ttu-id="f3a80-227">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-227">**Syntax**</span></span> <br/> | `HRESULT GetHierarchyParent (`<br/>`[in]BSTR bstrObjectID,`<br/>`[out]BSTR * pbstrParentID);` <br/> |
|<span data-ttu-id="f3a80-228">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-228">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-229">_bstrObjectID_. Строка, содержащая идентификатор объекта OneNote, для которого нужно найти родительский объект.</span><span class="sxs-lookup"><span data-stu-id="f3a80-229">_bstrObjectID_ &ndash; A string that contains the OneNote ID of the object of which you want to find the parent object.</span></span>  <br/><br/><span data-ttu-id="f3a80-230">_pbstrParentID_. (Выходной параметр.) Указатель на строку, в которую метод записывает идентификатор родительского объекта OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-230">_pbstrParentID_ &ndash; (Output parameter) A pointer to the string into which the method writes the OneNote ID of the parent object.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-231">Если у объекта OneNote нет родительского объекта (например, если пользователь желает получить родительский объект записной книжки), выдается исключение.</span><span class="sxs-lookup"><span data-stu-id="f3a80-231">If the OneNote object has no parent object (for example, when a user wants to get the parent of a Notebook), an exception is thrown.</span></span>
  
### <a name="getspeciallocation-method"></a><span data-ttu-id="f3a80-232">Метод GetSpecialLocation</span><span class="sxs-lookup"><span data-stu-id="f3a80-232">GetSpecialLocation method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-233">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-233">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-234">Находит путь к расположению, где OneNote сохраняет определенные специальные элементы, такие как резервные копии, не подшитые заметки и записная книжку по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="f3a80-234">Finds the path to the location where OneNote stores certain special items, such as backups, unfiled notes, and the default notebook.</span></span>  <br/> |
|<span data-ttu-id="f3a80-235">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-235">**Syntax**</span></span> <br/> | `HRESULT GetSpecialLocation(`<br/>`[in]SpecialLocation slToGet,`<br/>`[out]BSTR * pbstrSpecialLocationPath);` <br/> |
|<span data-ttu-id="f3a80-236">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-236">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-237">_slToGet_. Одно из значений перечисления [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation), которое задает расположение специальной папки для получения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-237">_slToGet_ &ndash; One of the [SpecialLocation](enumerations-onenote-developer-reference.md#odc_SpecialLocation) enumeration values that specifies the special folder location to get.</span></span>  <br/><br/><span data-ttu-id="f3a80-238">_pbstrSpecialLocationPath_. (Выходной параметр.) Указатель на строку, в которую приложение OneNote должно записать путь специальной папки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-238">_pbstrSpecialLocationPath_ &ndash; (Output parameter) A pointer to the string into which you want OneNote to write the path of the special folder.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-239">С помощью этого метода можно определить место на диске, в котором хранится папка "Не подшитые заметки".</span><span class="sxs-lookup"><span data-stu-id="f3a80-239">You can use this method to determine the location on disk of the Unfiled Notes folder.</span></span> <span data-ttu-id="f3a80-240">Иными словами, папка, в которой OneNote хранит заметки, которые создаются при перетаскивании элемента в OneNote, а также заметки, полученные напрямую от других приложений (такие, которые возникают при выборе **Отправить в OneNote** в Microsoft Outlook или Microsoft Internet Explorer).</span><span class="sxs-lookup"><span data-stu-id="f3a80-240">That is the folder in which OneNote stores notes that are created when you drag an item into OneNote, as well as notes that come directly from other applications (such as those that result when you click **Send to OneNote** in Microsoft Outlook or Microsoft Internet Explorer).</span></span> 
  
## <a name="page-content-methods"></a><span data-ttu-id="f3a80-241">Методы для содержимого страницы</span><span class="sxs-lookup"><span data-stu-id="f3a80-241">Page Content methods</span></span>
<span data-ttu-id="f3a80-242"><a name="ON14DevRef_Application_PageContent"> </a></span><span class="sxs-lookup"><span data-stu-id="f3a80-242"></span></span>

<span data-ttu-id="f3a80-243">Методы, описанные в этом разделе, позволяют обнаруживать, обновлять и удалять содержимое на страницах в записных книжках OneNote, а также публиковать содержимое OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-243">The methods described in this section enable you to discover, update, and delete the content on pages in OneNote notebooks, as well as to publish OneNote content.</span></span>
  
### <a name="getpagecontent-method"></a><span data-ttu-id="f3a80-244">Метод GetPageContent</span><span class="sxs-lookup"><span data-stu-id="f3a80-244">GetPageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-245">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-245">**Description**</span></span>|<span data-ttu-id="f3a80-246">Получает все содержимое (в формате XML OneNote) указанной страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-246">Gets all of the content (in OneNote XML format) of the specified page.</span></span>|
|<span data-ttu-id="f3a80-247">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-247">**Syntax**</span></span>| `HRESULT GetPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[out]BSTR * pbstrPageXmlOut,`<br/>`[in,defaultvalue(piBasic)]PageInfo pageInfoToExport,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema);`|
|<span data-ttu-id="f3a80-248">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-248">**Parameters**</span></span>| <span data-ttu-id="f3a80-249">_bstrPageId_. Идентификатор страницы OneNote, содержимое которой нужно получить.</span><span class="sxs-lookup"><span data-stu-id="f3a80-249">_bstrPageId_ &ndash; The OneNote ID of the page whose content you want to get.</span></span><br/><br/><span data-ttu-id="f3a80-250">_pbstrPageXmlOut_. (Выходной параметр.) Указатель на строку, в которую программа OneNote должна записать выходные данные XML.</span><span class="sxs-lookup"><span data-stu-id="f3a80-250">_pbstrPageXmlOut_ &ndash; (Output parameter) A pointer to the string into which you want OneNote to write the XML output.</span></span><br/><br/><span data-ttu-id="f3a80-251">_pageInfoToExport_. (Необязательный параметр.) Указывает, возвращает ли метод **GetPageContent** двоичные данные, внедренные в XML-код в кодировке Base64.</span><span class="sxs-lookup"><span data-stu-id="f3a80-251">_pageInfoToExport_ &ndash; (Optional) Specifies whether the **GetPageContent** method returns binary content, embedded in the XML code and base-64 encoded.</span></span> <span data-ttu-id="f3a80-252">Двоичные данные могут включать, например, изображения и данные рукописного ввода.</span><span class="sxs-lookup"><span data-stu-id="f3a80-252">Binary content can include, for example, images and ink data.</span></span> <span data-ttu-id="f3a80-253">Параметр _pageInfoToExport_ также указывает, нужно ли выполнять разметку выделенного XML-кода, который возвращен методом **GetPageContent**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-253">The  _pageInfoToExport_ parameter also specifies whether to mark up the selection in the XML code that the **GetPageContent** method returns.</span></span> <span data-ttu-id="f3a80-254">Необходимое значение перечисления из [PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo).</span><span class="sxs-lookup"><span data-stu-id="f3a80-254">It takes an enumerated value from the [PageInfo](enumerations-onenote-developer-reference.md#odc_PageInfo) enumeration.</span></span><br/><br/><span data-ttu-id="f3a80-255">_xsSchema_. (Необязательный параметр.) Версия схемы XML OneNote типа **XMLSchema**, которую нужно вывести.</span><span class="sxs-lookup"><span data-stu-id="f3a80-255">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="f3a80-256">Вы можете указать нужную версию схемы XML: 2013, 2010, 2007 или текущую.</span><span class="sxs-lookup"><span data-stu-id="f3a80-256">You can specify whether you want XML Schema version 2013, 2010, 2007, or the current version.</span></span> <br/><br/><span data-ttu-id="f3a80-257">**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-257">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="f3a80-258">По умолчанию, чтобы избежать чрезмерной длины возвращаемой строки XML, OneNote не внедряет двоичные данные в XML-код.</span><span class="sxs-lookup"><span data-stu-id="f3a80-258">By default, to avoid excess length in the XML string it returns, OneNote does not embed binary content in the XML code.</span></span> <span data-ttu-id="f3a80-259">По этой же причине приложение не выполняет разметку для текущего выделенного фрагмента с помощью атрибутов выделения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-259">For the same reason, it does not mark up the current selection with selection attributes.</span></span> <span data-ttu-id="f3a80-260">Двоичные объекты содержат идентификатор OneNote в своих тегах.</span><span class="sxs-lookup"><span data-stu-id="f3a80-260">Binary objects include a OneNote ID in their tags.</span></span> <span data-ttu-id="f3a80-261">Чтобы получить двоичный объект, вызовите метод **GetBinaryPageContent** и передайте ему идентификатор OneNote, полученный от метода **GetPageContent**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-261">To get a binary object, you call the **GetBinaryPageContent** method and pass it the OneNote ID you get from the **GetPageContent** method.</span></span> <span data-ttu-id="f3a80-262">Используйте метод **GetPageContent**, когда двоичные данные не требуются мгновенно.</span><span class="sxs-lookup"><span data-stu-id="f3a80-262">You use the **GetPageContent** method when you do not need the binary data immediately.</span></span> 
  
### <a name="updatepagecontent-method"></a><span data-ttu-id="f3a80-263">Метод UpdatePageContent</span><span class="sxs-lookup"><span data-stu-id="f3a80-263">UpdatePageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-264">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-264">**Description**</span></span>|<span data-ttu-id="f3a80-265">Обновляет или изменяет содержимое на странице.</span><span class="sxs-lookup"><span data-stu-id="f3a80-265">Updates or modifies the content on the page.</span></span>|
|<span data-ttu-id="f3a80-266">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-266">**Syntax**</span></span>| `HRESULT UpdatePageContent(`<br/>`[in]BSTR bstrPageChangesXmlIn,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(xsCurrent)]XMLSchema xsSchema,`<br/>`[in,defaultvalue(false)]VARIANT_BOOL force);`|
|<span data-ttu-id="f3a80-267">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-267">**Parameters**</span></span>| <span data-ttu-id="f3a80-268">_bstrPageChangesXmlIn_. Строка, содержащая XML-код OneNote, включающий в себя изменения, которые нужно внести на странице.</span><span class="sxs-lookup"><span data-stu-id="f3a80-268">_bstrPageChangesXmlIn_ &ndash; A string that contains OneNote XML code that includes the changes you want to make to the page.</span></span><br/><br/><span data-ttu-id="f3a80-269">_dateExpectedLastModified_. (Необязательный параметр.) Дата и время (по вашим сведениям) последнего изменения обновляемой страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-269">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the page you want to update was last modified.</span></span> <span data-ttu-id="f3a80-270">При передаче ненулевого значения для этого параметра OneNote будет выполнять обновление, только если переданное значение соответствует фактической дате и времени последнего изменения страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-270">If you pass a non-zero value for this parameter, OneNote proceeds with the update only if the value you pass matches the actual date and time the page was last modified.</span></span> <span data-ttu-id="f3a80-271">Передача значения для этого параметра помогает предотвратить случайную перезапись во время внесения правок пользователей после последнего изменения страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-271">Passing a value for this parameter helps prevent accidentally overwriting edits users made since the last time the page was modified.</span></span><br/><br/><span data-ttu-id="f3a80-272">_xsSchema_. (Необязательный параметр.) Версия схемы XML OneNote типа **XMLSchema**, которую нужно вывести.</span><span class="sxs-lookup"><span data-stu-id="f3a80-272">_xsSchema_ &ndash; (Optional) The version of the OneNote XML schema, of type **XMLSchema**, that you want to be output.</span></span> <span data-ttu-id="f3a80-273">Вы можете указать нужную версию схемы XML: 2013, 2010, 2007 или текущую.</span><span class="sxs-lookup"><span data-stu-id="f3a80-273">You can specify whether you want XML schema version 2013, 2010, 2007, or the current version.</span></span> <br/><br/><span data-ttu-id="f3a80-274">**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-274">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span><br/><br/><span data-ttu-id="f3a80-275">_force_ (необязательный параметр). Чтобы обновить содержимое страницы, даже если есть неизвестные данные на странице от будущей версии OneNote, используется **true**. В противном случае используется **false** (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="f3a80-275">_force_(Optional) **true** to update the page content, even if there is unknown data on the page from a future version of OneNote; otherwise, **false** (the default).</span></span> |
   
<span data-ttu-id="f3a80-276">С помощью этого метода можно изменять страницу разными способами.</span><span class="sxs-lookup"><span data-stu-id="f3a80-276">You can use this method to modify the page in various ways.</span></span> <span data-ttu-id="f3a80-277">Например, с помощью метода **UpdatePageContent** можно добавить структуру на страницу, изменить содержимое структуры, добавить изображения, добавить объект рукописного ввода, переместить содержимое и изменить текст в структурах.</span><span class="sxs-lookup"><span data-stu-id="f3a80-277">For example, you can use the **UpdatePageContent** method to add an outline to a page, change the content of an outline, add images, add ink, move content, or modify text in outlines.</span></span> 
  
<span data-ttu-id="f3a80-278">Более конкретный пример: с помощью метода **GetPageContent** можно экспортировать существующую страницу, внести некоторые изменения в XML-код страницы, а затем с помощью метода **UpdatePageContent** импортировать всю страницу снова.</span><span class="sxs-lookup"><span data-stu-id="f3a80-278">As a more specific example, you might use the **GetPageContent** method to export an existing page, make some changes to the XML code for the page, and then use the **UpdatePageContent** method to import the entire page again.</span></span> <span data-ttu-id="f3a80-279">Кроме того, можно использовать этот метод для добавления новых объектов страницы, например изображений, в конец существующей страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-279">Or, you might use this method to add new page objects, such as images, to the bottom of an existing page.</span></span> 
  
<span data-ttu-id="f3a80-280">Единственные объекты, которые необходимо включить в XML-код, передаваемый методу **UpdatePageContent**, — это объекты уровня страницы (например, структуры, изображения на странице или объект рукописного ввода на странице), которые были изменены.</span><span class="sxs-lookup"><span data-stu-id="f3a80-280">The only objects that you must include in the XML code that you pass to the **UpdatePageContent** method are page-level objects (such as outlines, images on the page, or ink on the page) that have changed.</span></span> <span data-ttu-id="f3a80-281">Этот метод не изменяет и не удаляет объекты уровня страницы, которые не указаны в параметре _bstrPageChangesXmlIn_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-281">This method does not modify or remove page-level objects that you do not specify in the  _bstrPageChangesXmlIn_ parameter.</span></span> <span data-ttu-id="f3a80-282">Метод полностью заменяет такие объекты уровня страницы, как структуры, идентификаторы которых соответствуют переданным объектам.</span><span class="sxs-lookup"><span data-stu-id="f3a80-282">The method entirely replaces page-level objects, such as outlines, whose IDs match those of the objects you pass.</span></span> <span data-ttu-id="f3a80-283">Поэтому необходимо полностью указать все объекты уровня страницы в коде, включая их существующее содержимое и внесенные в них изменения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-283">Consequently, you must fully specify all page-level objects in your code, including their existing content and changes you want to make to them.</span></span> 
  
<span data-ttu-id="f3a80-284">Например, если страница содержит структуру и изображение страницы фона, можно заменить структуру и оставить изображение без изменений, полностью указав структуру в XML-коде с помощью идентификатора существующей структуры, не включая изображение в код.</span><span class="sxs-lookup"><span data-stu-id="f3a80-284">For example, if your page contains an outline and a background page image, you can replace the outline and leave the image unchanged by completely specifying the outline in the XML code, using the ID of the existing outline, and not including the image in the code.</span></span> <span data-ttu-id="f3a80-285">Так как измененная структура, которую вы включаете в код, полностью заменяет существующую, необходимо включить все содержимое структуры.</span><span class="sxs-lookup"><span data-stu-id="f3a80-285">Because the revised outline you include in the code completely replaces the existing outline, you must include the entire contents of the outline.</span></span>
  
<span data-ttu-id="f3a80-286">Кроме того, метод **UpdatePageContent** изменяет только свойства элементов, которые вы указываете в параметре _bstrPageChangesXmlIn_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-286">Also, the **UpdatePageContent** method modifies only element properties that you specify in the  _bstrPageChangesXmlIn_ parameter.</span></span> <span data-ttu-id="f3a80-287">Например, если указать некоторые, но не все свойства элемента **PageSettings**, свойства, которые вы не указываете, остаются без изменений.</span><span class="sxs-lookup"><span data-stu-id="f3a80-287">For example, if you specify some, but not all, properties of the **PageSettings** element, the properties that you do not specify remain unchanged.</span></span> 
  
<span data-ttu-id="f3a80-288">В приведенном ниже примере показано, как использовать метод **UpdatePageContent**, чтобы изменить название страницы и добавить на нее некоторый текст образца.</span><span class="sxs-lookup"><span data-stu-id="f3a80-288">The following example shows how to use the **UpdatePageContent** method to change the title of a page and add some sample text to the page.</span></span> <span data-ttu-id="f3a80-289">Перед выполнением кода замените действительный идентификатор страницы, отображаемый в коде, чтобы код работал на вашем компьютере.</span><span class="sxs-lookup"><span data-stu-id="f3a80-289">Before running the code, substitute a valid page ID for the page ID shown in the code, so that the code works on your computer.</span></span> <span data-ttu-id="f3a80-290">Можно получить идентификатор страницы с помощью метода **GetHierarchy** и проверки выходных данных.</span><span class="sxs-lookup"><span data-stu-id="f3a80-290">You can get the page ID for a page by using the **GetHierarchy** method and examining the output.</span></span> 
  
```cs
static void UpdatePageContent()
    {
        OneNote.Application onApplication = new OneNote.Application();
        String strImportXML;
        strImportXML = "<?xml version=\"1.0\"?>" +
            "<one:Page xmlns:one=\"https://schemas.microsoft.com/office/onenote/12/2004/onenote\" 
            ID=\"{3428B7BB-EF39-4B9C-A167-3FAE20630C37}{1}{B0}\">" +
            "    <one:PageSettings RTL=\"false\" color=\"automatic\">" +
            "        <one:PageSize>" +
            "            <one:Automatic/>" +
            "        </one:PageSize>" +
            "        <one:RuleLines visible=\"false\"/>" +
            "    </one:PageSettings>" +
            "    <one:Title style=\"font-family:Calibri;
                 font-size:17.0pt\" lang=\"en-US\">" +
            "        <one:OE alignment=\"left\">" +
            "            <one:T>" +
            "                <![CDATA[My Sample Page]]>" +
            "            </one:T>" +
            "        </one:OE>" +
            "    </one:Title>" +
            "    <one:Outline >" +
            "        <one:Position x=\"120\" y=\"160\"/>" +
            "        <one:Size width=\"120\" height=\"15\"/>" +
            "        <one:OEChildren>" +
            "            <one:OE alignment=\"left\">" +
            "                <one:T>" +
            "                    <![CDATA[Sample Text]]>" +
            "                </one:T>" +
            "            </one:OE>" +
            "        </one:OEChildren>" +
            "    </one:Outline>" +
            "</one:Page>";
        // Update the page content.
        onApplication.UpdatePageContent(strImportXML, System.DateTime.MinValue);
    }

```

### <a name="getbinarypagecontent-method"></a><span data-ttu-id="f3a80-291">Метод GetBinaryPageContent</span><span class="sxs-lookup"><span data-stu-id="f3a80-291">GetBinaryPageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-292">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-292">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-293">Возвращает двоичный объект (например, рукописного ввода или изображения) на странице OneNote в виде строки в кодировке Base64.</span><span class="sxs-lookup"><span data-stu-id="f3a80-293">Returns a binary object, such as ink or images, on an OneNote page as a base-64-encoded string.</span></span>  <br/> |
|<span data-ttu-id="f3a80-294">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-294">**Syntax**</span></span> <br/> | `HRESULT GetBinaryPageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrCallbackID,`<br/>`[out]BSTR * pbstrBinaryObjectB64Out);` <br/> |
|<span data-ttu-id="f3a80-295">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-295">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-296">_bstrPageID_. Идентификатор OneNote страницы, содержащей двоичный объект, который нужно получить.</span><span class="sxs-lookup"><span data-stu-id="f3a80-296">_bstrPageID_ &ndash; The OneNote ID of the page that contains the binary object to get.</span></span>  <br/><br/><span data-ttu-id="f3a80-297">_bstrCallBackID_. Идентификатор OneNote двоичного объекта, который нужно получить.</span><span class="sxs-lookup"><span data-stu-id="f3a80-297">_bstrCallBackID_ &ndash; The OneNote ID of the binary object you want to get.</span></span> <span data-ttu-id="f3a80-298">Этот идентификатор, который называется **callbackID**, находится в XML-коде OneNote для страницы, возвращаемой методом **GetPageContent**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-298">This ID, known as a **callbackID**, is in the OneNote XML code for a page returned by the **GetPageContent** method.</span></span>  <br/><br/><span data-ttu-id="f3a80-299">_pbstrBinaryObectB64Out_. (Выходной параметр.) Указатель на строку, в которую OneNote записывает двоичный объект в виде строки в кодировке Base64.</span><span class="sxs-lookup"><span data-stu-id="f3a80-299">_pbstrBinaryObectB64Out_ &ndash; (Output parameter) A pointer to a string into which OneNote writes the binary object as a base-64-encoded string.</span></span>  <br/> |
   
### <a name="deletepagecontent-method"></a><span data-ttu-id="f3a80-300">Метод DeletePageContent</span><span class="sxs-lookup"><span data-stu-id="f3a80-300">DeletePageContent method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-301">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-301">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-302">Удаляет объект &ndash;, например **Outline**, **Ink** или **Image**, со страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-302">Deletes an object &ndash; such as an **Outline**, **Ink**, or **Image** object from a page.</span></span>  <br/> |
|<span data-ttu-id="f3a80-303">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-303">**Syntax**</span></span> <br/> | `HRESULT DeletePageContent(`<br/>`[in]BSTR bstrPageID,`<br/>`[in]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]DATE dateExpectedLastModified,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL force);` <br/> |
|<span data-ttu-id="f3a80-304">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-304">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-305">_bstrPageID_. Идентификатор OneNote страницы, содержащей объект, который нужно удалить.</span><span class="sxs-lookup"><span data-stu-id="f3a80-305">_bstrPageID_ &ndash; The OneNote ID of the page that contains the object to delete.</span></span>  <br/><br/><span data-ttu-id="f3a80-306">_bstrObjectID_. Идентификатор OneNote ID объекта, который нужно удалить.</span><span class="sxs-lookup"><span data-stu-id="f3a80-306">_bstrObjectID_ &ndash; The OneNote ID of the object that you want to delete.</span></span>  <br/><br/><span data-ttu-id="f3a80-307">_dateExpectedLastModified_. (Необязательный параметр.) Дата и время (по вашим сведениям) последнего изменения страницы с удаляемым содержимым.</span><span class="sxs-lookup"><span data-stu-id="f3a80-307">_dateExpectedLastModified_ &ndash; (Optional) The date and time that you think the page that contains content you want to delete was last modified.</span></span> <span data-ttu-id="f3a80-308">При передаче ненулевого значения для этого параметра OneNote будет выполнять удаление, только если переданное значение соответствует фактической дате и времени последнего изменения страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-308">If you pass a non-zero value for this parameter, OneNote proceeds with the deletion only if the value you pass matches the actual date and time the page was last modified.</span></span> <span data-ttu-id="f3a80-309">Передача значения для этого параметра помогает предотвратить случайную перезапись во время внесения правок пользователей после последнего изменения страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-309">Passing a value for this parameter helps prevent accidentally overwriting edits made by users since the last time the page was modified.</span></span>  <br/><br/><span data-ttu-id="f3a80-310">_force_. (Необязательный параметр.) Чтобы обновить содержимое страницы, даже если есть неизвестные данные на странице от будущей версии OneNote, используется **true**. В противном случае используется **false** (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="f3a80-310">_force_ &ndash; (Optional) **true** to update the page content, even if there is unknown data on the page from a future version of OneNote; otherwise, **false** (the default).</span></span>  <br/> |
   
### <a name="publish-method"></a><span data-ttu-id="f3a80-311">Метод Publish</span><span class="sxs-lookup"><span data-stu-id="f3a80-311">Publish method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-312">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-312">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-313">Экспорт указанной страницы в файл в любом формате, поддерживаемом приложением OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-313">Exports the page you specify to a file in any format that OneNote supports.</span></span>  <br/> |
|<span data-ttu-id="f3a80-314">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-314">**Syntax**</span></span> <br/> | `HRESULT Publish(`<br/>`[in]BSTR bstrHierarchyID,`<br/>`[in]BSTR bstrTargetFilePath,`<br/>`[in,defaultvalue(pfOneNote)]PublishFormat pfPublishFormat,`<br/>`[in,defaultvalue(0)]BSTR bstrCLSIDofExporter);` <br/> |
|<span data-ttu-id="f3a80-315">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-315">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-316">_bstrHierarchyID_. Идентификатор OneNote иерархии, которую вы хотите экспортировать.</span><span class="sxs-lookup"><span data-stu-id="f3a80-316">_bstrHierarchyID_ &ndash; The OneNote ID of the hierarchy you want to export.</span></span>  <br/><br/><span data-ttu-id="f3a80-317">_bstrTargetFilePath_. Абсолютный путь к расположению, где вы хотите сохранить получившийся выходной файл.</span><span class="sxs-lookup"><span data-stu-id="f3a80-317">_bstrTargetFilePath_ &ndash; The absolute path to the location where you want to save the resulting output file.</span></span> <span data-ttu-id="f3a80-318">Указанного вами файла не должно быть в этом расположении.</span><span class="sxs-lookup"><span data-stu-id="f3a80-318">The file you specify must be one that does not already exist at that location.</span></span>  <br/><br/><span data-ttu-id="f3a80-319">_pfPublishFormat_. Одно из значений перечисления [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat), указывающее нужный формат, в котором должна быть опубликована страница (например, MTHML, PDF).</span><span class="sxs-lookup"><span data-stu-id="f3a80-319">_pfPublishFormat_ &ndash; One of the [PublishFormat](enumerations-onenote-developer-reference.md#odc_PublishFormat) enumeration values that specifies the format in which you want the published page to be (for example, MTHML, PDF, and so on).</span></span>  <br/><br/><span data-ttu-id="f3a80-320">_bstrCLSIDofExporter_, Идентификатор класса (CLSID) для зарегистрированного приложения COM, которое может экспортировать расширенные метафайлы Microsoft Windows (.emf).</span><span class="sxs-lookup"><span data-stu-id="f3a80-320">_bstrCLSIDofExporter_ &ndash; The class ID (CLSID) of a registered COM application that can export Microsoft Windows enhanced metafiles (.emf).</span></span> <span data-ttu-id="f3a80-321">В COM-приложении необходимо реализовать интерфейс **IMsoDocExporter**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-321">The COM application must implement the **IMsoDocExporter** interface.</span></span> <span data-ttu-id="f3a80-322">Этот параметр включен, чтобы разрешить сторонним разработчикам писать собственный код для публикации содержимого OneNote в пользовательском формате.</span><span class="sxs-lookup"><span data-stu-id="f3a80-322">This parameter is included to permit third-party developers to write their own code to publish OneNote content in a custom format.</span></span> <span data-ttu-id="f3a80-323">Дополнительные сведения об интерфейсе **IMsoDocExporter** см. в статье [Расширение функции экспорта с фиксированным форматом Office 2007](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="f3a80-323">For more information about the **IMsoDocExporter** interface, see [Extending the Office 2007 Fixed-Format Export Feature](https://msdn.microsoft.com/library/office/aa338206%28v=office.12%29.aspx).</span></span>  <br/> |
   
<span data-ttu-id="f3a80-324">В настоящее время OneNote поддерживает такие форматы файлов:</span><span class="sxs-lookup"><span data-stu-id="f3a80-324">Currently, OneNote supports the following file formats:</span></span>
  
- <span data-ttu-id="f3a80-325">файлы MHTML (.mht);</span><span class="sxs-lookup"><span data-stu-id="f3a80-325">MHTML files (.mht)</span></span>
- <span data-ttu-id="f3a80-326">файлы Adobe Acrobat PDF (.pdf);</span><span class="sxs-lookup"><span data-stu-id="f3a80-326">Adobe Acrobat PDF files (.pdf)</span></span>
- <span data-ttu-id="f3a80-327">файлы XML Paper Specification (XPS) (.xps);</span><span class="sxs-lookup"><span data-stu-id="f3a80-327">XML Paper Specification (XPS) files.</span></span>
- <span data-ttu-id="f3a80-328">файлы OneNote 2013, 2010 или 2007 (.one);</span><span class="sxs-lookup"><span data-stu-id="f3a80-328">OneNote 2013, 2010 or 2007 files (.one)</span></span>
- <span data-ttu-id="f3a80-329">файлы пакетов OneNote (.onepkg);</span><span class="sxs-lookup"><span data-stu-id="f3a80-329">OneNote Package files (.onepkg)</span></span>
- <span data-ttu-id="f3a80-330">документы Microsoft Word (.doc или .docx);</span><span class="sxs-lookup"><span data-stu-id="f3a80-330">Microsoft Word documents (.doc or .docx)</span></span>
- <span data-ttu-id="f3a80-331">расширенные метафайлы Microsoft Windows (.emf);</span><span class="sxs-lookup"><span data-stu-id="f3a80-331">Microsoft Windows Enhanced Metafiles (.emf)</span></span>
- <span data-ttu-id="f3a80-332">HTML-файлы (.html).</span><span class="sxs-lookup"><span data-stu-id="f3a80-332">HTML files (.html)</span></span>
    
<span data-ttu-id="f3a80-333">Этот метод дает точно такие же результаты, которые можно получить, нажав кнопку **Опубликовать** в пользовательском интерфейсе и указав нужный формат.</span><span class="sxs-lookup"><span data-stu-id="f3a80-333">This method produces exactly the same results you would get by clicking **Publish** in the UI and specifying the format.</span></span> 
  
## <a name="navigation-methods"></a><span data-ttu-id="f3a80-334">Методы навигации</span><span class="sxs-lookup"><span data-stu-id="f3a80-334">Navigation methods</span></span>
<span data-ttu-id="f3a80-335"><a name="ON14DevRef_Application_Navigation"> </a></span><span class="sxs-lookup"><span data-stu-id="f3a80-335"></span></span>

<span data-ttu-id="f3a80-336">Методы, описанные в этом разделе, позволяют находить записные книжки, группы разделов, разделы, страницы и объекты страницы OneNote, переходить к ним и создавать на них ссылки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-336">The methods described in this section enable you to find, navigate to, and link to OneNote notebooks, section groups, sections, pages, and page objects.</span></span>
  
### <a name="navigateto-method"></a><span data-ttu-id="f3a80-337">Метод NavigateTo</span><span class="sxs-lookup"><span data-stu-id="f3a80-337">NavigateTo Method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-338">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-338">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-339">Переходит на указанный объект (например, разделы, страницы и элементы **структуры** в пределах страниц).</span><span class="sxs-lookup"><span data-stu-id="f3a80-339">Navigates to the specified object (for example, sections, pages, and **Outline** elements within pages).</span></span>  <br/> |
|<span data-ttu-id="f3a80-340">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-340">**Syntax**</span></span> <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrHierarchyObjectID,`<br/>`[in,defaultvalue(#)]BSTR bstrObjectID,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|<span data-ttu-id="f3a80-341">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-341">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-342">_bstrHierarchyObjectID_. Идентификатор OneNote объекта, к которому нужно перейти в иерархии OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-342">_bstrHierarchyObjectID_ &ndash; The OneNote ID of the object you want to navigate to in the OneNote Hierarchy.</span></span>  <br/><br/><span data-ttu-id="f3a80-343">_bstrObjectID_. Идентификатор OneNote объекта, к которому нужно перейти на странице OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-343">_bstrObjectID_ &ndash; The OneNote ID of the object you want to navigate to on the OneNote page.</span></span>  <br/><br/><span data-ttu-id="f3a80-344">_fNewWindow_. (Необязательный параметр.) Используется **true**, чтобы открыть указанный объект в новом окне OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-344">_fNewWindow_ &ndash; (Optional) **true** to open specified object in a new OneNote window.</span></span> <span data-ttu-id="f3a80-345">Используется **false**, чтобы не открывать новое окно OneNote, если одно уже открыто.</span><span class="sxs-lookup"><span data-stu-id="f3a80-345">**false** does not open a new OneNote window if one is open.</span></span>  <br/> |
   
### <a name="navigatetourl-method"></a><span data-ttu-id="f3a80-346">Метод NavigateToUrl</span><span class="sxs-lookup"><span data-stu-id="f3a80-346">NavigateToUrl method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-347">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-347">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-348">Если передана ссылка OneNote (onenote://), откроется окно OneNote для соответствующего расположения в OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-348">If passed a OneNote link (onenote://), opens the OneNote window to the corresponding location in OneNote.</span></span> <span data-ttu-id="f3a80-349">Если ссылка является внешней по отношению к OneNote (например, https:// или file://), появится диалоговое окно системы безопасности.</span><span class="sxs-lookup"><span data-stu-id="f3a80-349">If the link is external to OneNote (such as https:// or file://), a security dialog box will appear.</span></span> <span data-ttu-id="f3a80-350">После удаления OneNote попытается открыть ссылку, и будет возвращена ошибка **HResult.hrObjectDoesNotExist**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-350">Upon dismissal, OneNote attempts to open the link and an **HResult.hrObjectDoesNotExist** error is returned.</span></span>  <br/> |
|<span data-ttu-id="f3a80-351">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-351">**Syntax**</span></span> <br/> | `HRESULT NavigateTo(`<br/>`[in]BSTR bstrUrl,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fNewWindow);` <br/> |
|<span data-ttu-id="f3a80-352">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-352">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-353">_bstrUrl_. Строка, которая указывает, куда нужно перейти.</span><span class="sxs-lookup"><span data-stu-id="f3a80-353">_bstrUrl_ &ndash; A string that indicates where to navigate to.</span></span> <span data-ttu-id="f3a80-354">Это может быть ссылка OneNote или любой другой URL-адрес (например, веб-ссылка или указание на сетевое хранилище).</span><span class="sxs-lookup"><span data-stu-id="f3a80-354">This could be a OneNote link, or any other URL, such as a web link or network location.</span></span>  <br/><br/><span data-ttu-id="f3a80-355">_fNewWindow_. (Необязательный параметр.) Используется **true**, чтобы открыть указанный URL-адрес в новом окне OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-355">_fNewWindow_ &ndash; (Optional) **true** to open the specified URL in a new OneNote window.</span></span> <span data-ttu-id="f3a80-356">Используется **false**, чтобы не открывать новое окно OneNote, если одно уже открыто.</span><span class="sxs-lookup"><span data-stu-id="f3a80-356">**false** does not open a new OneNote window if one is open.</span></span>  <br/> |
   
### <a name="gethyperlinktoobject-method"></a><span data-ttu-id="f3a80-357">Метод GetHyperLinkToObject</span><span class="sxs-lookup"><span data-stu-id="f3a80-357">GetHyperLinkToObject method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-358">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-358">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-359">Получает гиперссылку OneNote на указанную записную книжку, группу разделов, раздел, страницу или объект страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-359">Gets a OneNote hyperlink to the specified notebook, section group, section, page, or page object.</span></span>  <br/> |
|<span data-ttu-id="f3a80-360">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-360">**Syntax**</span></span> <br/> | `HRESULT GetHyperlinkToObject(`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|<span data-ttu-id="f3a80-361">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-361">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-362">_bstrHierarchyID_. Идентификатор OneNote для записной книжки, группы разделов, раздела или страницы, для которых требуется гиперссылка.</span><span class="sxs-lookup"><span data-stu-id="f3a80-362">_bstrHierarchyID_ &ndash; The OneNote ID for the notebook, section group, section, or page for which you want a hyperlink.</span></span>  <br/><br/><span data-ttu-id="f3a80-363">_bstrPageContentObjectID_. (Необязательный параметр.) Идентификатор OneNote для объекта в пределах страницы, для которого требуется гиперссылка.</span><span class="sxs-lookup"><span data-stu-id="f3a80-363">_bstrPageContentObjectID_ &ndash; (Optional) The OneNote ID for the object within the page for which you want a hyperlink.</span></span> <span data-ttu-id="f3a80-364">Например, объект может быть структурой или элементом **Outline**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-364">For example, the object can be an outline or **Outline** element.</span></span> <span data-ttu-id="f3a80-365">Если передать пустую строку (""), возвращаемая ссылка указывает на записную книжку, группу разделов, раздел или страницу, которые указаны в параметре _bstrHierarchyID_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-365">If you pass an empty string (""), the returned link points to the notebook, section group, section, or page that you specified in the  _bstrHierarchyID_ parameter.</span></span> <span data-ttu-id="f3a80-366">Если передать непустую строку для параметра _bstrPageContentObjectID_, параметр _bstrHierarchyID_ должен быть ссылкой на страницу, которая содержит указанный объект.</span><span class="sxs-lookup"><span data-stu-id="f3a80-366">If you pass a non-empty string for the  _bstrPageContentObjectID_ parameter, the  _bstrHierarchyID_ parameter must be a reference to the page that contains the specified object.</span></span>  <br/><br/><span data-ttu-id="f3a80-367">_pbstrHyperlinkOut_. (Выходной параметр.) Указатель на строку, в которую метод **GetHyperlinkToObject** записывает выходной текст гиперссылки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-367">_pbstrHyperlinkOut_ &ndash; (Output parameter) A pointer to a string into which the **GetHyperlinkToObject** method writes the output hyperlink text.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-368">При попытке перейти по получившейся ссылке OneNote откроется и отобразит указанный объект в браузере.</span><span class="sxs-lookup"><span data-stu-id="f3a80-368">When you attempt to navigate to the resulting link, OneNote opens and displays the specified object in the browser.</span></span>
  
### <a name="getwebhyperlinktoobject-method"></a><span data-ttu-id="f3a80-369">Метод GetWebHyperlinktoObject</span><span class="sxs-lookup"><span data-stu-id="f3a80-369">GetWebHyperlinktoObject method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-370">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-370">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-371">Возвращает гиперссылку на объект, который открывается в веб-клиенте OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-371">Returns a hyperlink to an object that opens in the OneNote Web Client.</span></span>  <br/> |
|<span data-ttu-id="f3a80-372">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-372">**Syntax**</span></span> <br/> | `HRESULT GetWebHyperlinkToObject (`<br/>`[in] BSTR bstrHierarchyID,`<br/>`[in] BSTR bstrPageContentObjectID,`<br/>`[out] BSTR * pbstrHyperlinkOut);` <br/> |
|<span data-ttu-id="f3a80-373">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-373">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-374">_bstrHierarchyID_. Идентификатор OneNote для записной книжки, группы разделов, раздела или страницы, для которых требуется веб-гиперссылка.</span><span class="sxs-lookup"><span data-stu-id="f3a80-374">_bstrHierarchyID_ &ndash; The OneNote ID for the notebook, section group, section or page for which you want a web hyperlink.</span></span>  <br/><br/><span data-ttu-id="f3a80-375">_bstrPageContentObjectID_. (Необязательный параметр.) Идентификатор OneNote для объекта в пределах страницы, для которого требуется гиперссылка.</span><span class="sxs-lookup"><span data-stu-id="f3a80-375">_bstrPageContentObjectID_ &ndash; (Optional) The OneNote ID for the object within the page for which you want a hyperlink.</span></span> <span data-ttu-id="f3a80-376">Например, объект может быть структурой или элементом **Outline**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-376">For example, the object can be an outline or **Outline** element.</span></span> <span data-ttu-id="f3a80-377">Если передать пустую строку (""), возвращаемая ссылка указывает на записную книжку, группу разделов, раздел или страницу, которые указаны в параметре _bstrHierarchyID_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-377">If you pass an empty string (""), the returned link points to the notebook, section group, section, or page that you specified in the  _bstrHierarchyID_ parameter.</span></span> <span data-ttu-id="f3a80-378">Если передать непустую строку для параметра _bstrPageContentObjectID_, параметр _bstrHierarchyID_ должен быть ссылкой на страницу, которая содержит указанный объект.</span><span class="sxs-lookup"><span data-stu-id="f3a80-378">If you pass a non-empty string for the  _bstrPageContentObjectID_ parameter, the  _bstrHierarchyID_ parameter must be a reference to the page that contains the specified object.</span></span>  <br/><br/><span data-ttu-id="f3a80-379">_pbstrHyperlinkOut_. (Выходной параметр.) Указатель на строку, в которую метод **GetWebHyperlinkToObject** записывает выходной текст гиперссылки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-379">_pbstrHyperlinkOut_ &ndash; (Output parameter) A pointer to a string into which the **GetWebHyperlinkToObject** method writes the output hyperlink text.</span></span> <span data-ttu-id="f3a80-380">Если веб-гиперссылку невозможно создать для записной книжки, возвращается значение NULL.</span><span class="sxs-lookup"><span data-stu-id="f3a80-380">If a web hyperlink cannot be created for the notebook, a null value is returned.</span></span>  <br/> |
   
### <a name="findpages-method"></a><span data-ttu-id="f3a80-381">Метод FindPages</span><span class="sxs-lookup"><span data-stu-id="f3a80-381">FindPages method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-382">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-382">**Description**</span></span>|<span data-ttu-id="f3a80-383">Возвращает список страниц, которые соответствуют указанному термину запроса.</span><span class="sxs-lookup"><span data-stu-id="f3a80-383">Returns a list of pages that match the specified query term.</span></span>|
|<span data-ttu-id="f3a80-384">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-384">**Syntax**</span></span>| `HRESULT FindPages(`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTR,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(0)]VARIANT_BOOL fDisplay,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|<span data-ttu-id="f3a80-385">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-385">**Parameters**</span></span>| <span data-ttu-id="f3a80-386">_bstrStartNodeID_. Узел (корневой каталог, записная книжка, группа разделов или раздел) ниже для поиска контента.</span><span class="sxs-lookup"><span data-stu-id="f3a80-386">_bstrStartNodeID_ &ndash; The node (root, notebook, section group, or section) below which to search for content.</span></span> <span data-ttu-id="f3a80-387">Этот параметр задает область для поиска.</span><span class="sxs-lookup"><span data-stu-id="f3a80-387">This parameter sets the scope for the search.</span></span><br/><br/><span data-ttu-id="f3a80-388">_bstrSearchString_. Строка поиска.</span><span class="sxs-lookup"><span data-stu-id="f3a80-388">_bstrSearchString_ &ndash; The search string.</span></span> <span data-ttu-id="f3a80-389">Передайте точно такую же строку, которую вы ввели бы в поле поиска пользовательского интерфейса OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-389">Pass exactly the same string that you would type into the search box in the OneNote UI.</span></span> <span data-ttu-id="f3a80-390">Можно использовать битовые операторы, такие как **AND** и **OR**, которые должны быть полностью прописными.</span><span class="sxs-lookup"><span data-stu-id="f3a80-390">You can use bitwise operators, such as **AND** and **OR**, which must be all uppercase.</span></span><br/><br/><span data-ttu-id="f3a80-391">_pbstrHierarchyXmlOut_. (Выходной параметр.) Указатель на строку, в которую программа OneNote должна записать выходную строку XML.</span><span class="sxs-lookup"><span data-stu-id="f3a80-391">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to a string into which you want OneNote to write the output XML string.</span></span> <span data-ttu-id="f3a80-392">Полученная строка XML содержит иерархию записной книжки от корневого каталога до страниц, которые соответствуют строке поиска, включая эти страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-392">The resulting XML string contains the notebook hierarchy from the root downward to, and including, any pages that match the search string.</span></span> <span data-ttu-id="f3a80-393">Например, метод **FindPages** не содержит списка разделов, в которых нет страниц, соответствующих иерархии.</span><span class="sxs-lookup"><span data-stu-id="f3a80-393">For example, the **FindPages** method does not list sections that have no page matches in the hierarchy.</span></span> <span data-ttu-id="f3a80-394">Кроме того, если только одна страница в одном разделе соответствует строке, возвращаемая иерархия включает в себя путь к этому разделу и странице, но не другие части иерархии записной книжки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-394">Also, if only one page in a single section matches the string, the returned hierarchy includes the path to that section and page, but to no other parts of the notebook hierarchy.</span></span><br/><br/><span data-ttu-id="f3a80-395">_fIncludeUnindexedPages_. (Необязательный параметр.) Используется **true**, чтобы искать страницы, которые не были индексированы с помощью Windows Search. В противном случае используется **false**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-395">_fIncludeUnindexedPages_ &ndash; (Optional) **true** to search pages that have not been indexed by Windows Search; otherwise, **false**.</span></span><br/><br/><span data-ttu-id="f3a80-396">_fDisplay_. (Необязательный параметр.) Используется **true**, чтобы выполнить поиск в пользовательском интерфейсе для пользователя, как если бы он ввел строку самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="f3a80-396">_fDisplay_ &ndash; (Optional) **true** to also run the search in the UI for the user, just as if the user had typed it themselves.</span></span> <span data-ttu-id="f3a80-397">Используется **false**, чтобы выполнить запрос без изменения пользовательского интерфейса (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="f3a80-397">**false** to perform the query with no change to the UI (the default).</span></span><br/><br/><span data-ttu-id="f3a80-398">_xsSchema_. (Необязательный параметр.) Версия схемы OneNote строки _pbstrHierarchyXmlOut_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-398">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _pbstrHierarchyXmlOut_.</span></span> <span data-ttu-id="f3a80-399">Это необязательное значение используется для указания версии схемы XML OneNote, в которой находится строка _pbstrHierarchyXmlOut_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-399">This optional value is used to specify the version of the OneNote XML schema that contains the  _pbstrHierarchyXmlOut_ string.</span></span> <span data-ttu-id="f3a80-400">Если это значение не указано, OneNote будет предполагать, что версия схемы XML — _xsCurrent_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-400">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="f3a80-401">**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-401">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
 <span data-ttu-id="f3a80-402">**FindPages** работает, только если на вашем компьютере установлен компонент "Поиск" 3.0 или 4.0 (Майкрософт).</span><span class="sxs-lookup"><span data-stu-id="f3a80-402">**FindPages** works only if you have Microsoft Search 3.0 or 4.0 installed on your computer.</span></span> <span data-ttu-id="f3a80-403">Windows Vista и Windows 7 включают этот компонент.</span><span class="sxs-lookup"><span data-stu-id="f3a80-403">Windows Vista and Windows 7 include this component.</span></span> <span data-ttu-id="f3a80-404">Но если вы используете более раннюю версию Windows, вам необходимо установить [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) для работы **FindPages**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-404">However, if you are running an earlier version of Windows, you must install [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) for **FindPages** to work.</span></span> 
  
### <a name="findmeta-method"></a><span data-ttu-id="f3a80-405">Метод FindMeta</span><span class="sxs-lookup"><span data-stu-id="f3a80-405">FindMeta method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-406">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-406">**Description**</span></span>|<span data-ttu-id="f3a80-407">Возвращает список объектов OneNote, которые содержат метаданные, соответствующие указанному термину запроса.</span><span class="sxs-lookup"><span data-stu-id="f3a80-407">Returns a list of OneNote objects that contain metadata that matches the specified query term.</span></span>|
|<span data-ttu-id="f3a80-408">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-408">**Syntax**</span></span>| `HRESULT FindMeta (`<br/>`[in]BSTR bstrStartNodeID,`<br/>`[in]BSTR bstrSearchBSTRName,`<br/>`[out]BSTR * pbstrHierarchyXmlOut,`<br/>`[in,defaultvalue(#)]VARIANT_BOOL fIncludeUnindexedPages,`<br/>`[in,defaultvalue(#)]XMLSchema xsSchema);`|
|<span data-ttu-id="f3a80-409">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-409">**Parameters**</span></span>| <span data-ttu-id="f3a80-410">_bstrStartNodeID_. Узел (корневой каталог, записная книжка, группа разделов или раздел) ниже для поиска контента.</span><span class="sxs-lookup"><span data-stu-id="f3a80-410">_bstrStartNodeID_ &ndash; The node (root, notebook, section group, or section) below which to search for content.</span></span> <span data-ttu-id="f3a80-411">Этот параметр задает область для поиска.</span><span class="sxs-lookup"><span data-stu-id="f3a80-411">This parameter sets the scope for the search.</span></span><br/><br/><span data-ttu-id="f3a80-412">_bstrSearchStringName_. Строка поиска.</span><span class="sxs-lookup"><span data-stu-id="f3a80-412">_bstrSearchStringName_ &ndash; The search string.</span></span> <span data-ttu-id="f3a80-413">Передает любую часть имени метаданных.</span><span class="sxs-lookup"><span data-stu-id="f3a80-413">Pass in any part of the metadata name.</span></span> <span data-ttu-id="f3a80-414">Если передана пустая строка или значение NULL, все объекты, которые содержат метаданные, будут соответствовать запросу.</span><span class="sxs-lookup"><span data-stu-id="f3a80-414">If you pass in an empty string or a null value, all objects that have metadata will match the query.</span></span><br/><br/><span data-ttu-id="f3a80-415">_pbstrHierarchyXmlOut_. (Выходной параметр.) Указатель на строку, в которую программа OneNote должна записать выходную строку XML.</span><span class="sxs-lookup"><span data-stu-id="f3a80-415">_pbstrHierarchyXmlOut_ &ndash; (Output parameter) A pointer to a string into which you want OneNote to write the output XML string.</span></span> <span data-ttu-id="f3a80-416">Полученная строка XML содержит иерархию записной книжки от корневого каталога до страниц, которые соответствуют строке поиска, включая эти страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-416">The resulting XML string contains the notebook hierarchy from the root downward to, and including, any pages that match the search string.</span></span> <span data-ttu-id="f3a80-417">Например, метод **FindPages** не содержит списка разделов, в которых нет страниц, соответствующих иерархии.</span><span class="sxs-lookup"><span data-stu-id="f3a80-417">For example, the **FindPages** method does not list sections that have no page matches in the hierarchy.</span></span> <span data-ttu-id="f3a80-418">Кроме того, если только одна страница в одном разделе соответствует строке, возвращаемая иерархия включает в себя путь к этому разделу и странице, но не другие части иерархии записной книжки.</span><span class="sxs-lookup"><span data-stu-id="f3a80-418">Also, if only one page in a single section matches the string, the returned hierarchy includes the path to that section and page, but to no other parts of the notebook hierarchy.</span></span>  <br/><br/><span data-ttu-id="f3a80-419">_fIncludeUnindexedPages_. (Необязательный параметр.) Используется **true**, чтобы искать страницы, которые не были индексированы с помощью Windows Search. В противном случае используется **false**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-419">_fIncludeUnindexedPages_ &ndash; (Optional) **true** to search pages that have not been indexed by Windows Search; otherwise, **false**.</span></span><br/><br/><span data-ttu-id="f3a80-420">_xsSchema_. (Необязательный параметр.) Версия схемы OneNote строки _pbstrHierarchyXmlOut_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-420">_xsSchema_ &ndash; (Optional) The OneNote schema version of the string  _pbstrHierarchyXmlOut_.</span></span> <span data-ttu-id="f3a80-421">Это необязательное значение используется для указания версии схемы XML OneNote, в которой находится строка _pbstrHierarchyXmlOut_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-421">This optional value is used to specify the version of the OneNote XML schema that contains the  _pbstrHierarchyXmlOut_ string.</span></span> <span data-ttu-id="f3a80-422">Если это значение не указано, OneNote будет предполагать, что версия схемы XML — _xsCurrent_.</span><span class="sxs-lookup"><span data-stu-id="f3a80-422">If this value is not specified, OneNote will assume that the XML is in schema version  _xsCurrent_.</span></span> <br/><br/><span data-ttu-id="f3a80-423">**ПРИМЕЧАНИЕ.** Рекомендуется указать версию OneNote (например, **xs2013**), а не использовать **xsCurrent** или оставлять значение пустым, так как это позволит надстройке работать с будущими версиями OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-423">**NOTE**:  We recommend specifying a version of OneNote (such as **xs2013**) instead of using **xsCurrent** or leaving it blank, because this will allow your add-in to work with future versions of OneNote.</span></span>           |
   
<span data-ttu-id="f3a80-424">**FindMeta** работает только в том случае, если на вашем компьютере установлена служба Microsoft Windows Search 3.0 или 4.0.</span><span class="sxs-lookup"><span data-stu-id="f3a80-424">**FindMeta** works only if you have Microsoft Windows Search 3.0 or 4.0 installed on your computer.</span></span> <span data-ttu-id="f3a80-425">Windows Vista и Windows 7 включают этот компонент.</span><span class="sxs-lookup"><span data-stu-id="f3a80-425">Windows Vista and Windows 7 include this component.</span></span> <span data-ttu-id="f3a80-426">Но если вы используете более раннюю версию Windows, вам необходимо установить [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) для работы **FindMeta**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-426">However, if you are running an earlier version of Windows, you must install [Windows Search](https://www.microsoft.com/windows/products/winfamily/desktopsearch/getitnow.mspx) for **FindMeta** to work.</span></span> 
  
## <a name="functional-methods"></a><span data-ttu-id="f3a80-427">Функциональные методы</span><span class="sxs-lookup"><span data-stu-id="f3a80-427">Functional methods</span></span>
<span data-ttu-id="f3a80-428"><a name="ON14DevRef_Application_Functional"> </a></span><span class="sxs-lookup"><span data-stu-id="f3a80-428"></span></span>

<span data-ttu-id="f3a80-429">Методы, описанные в этом разделе, позволяют выполнять определенные действия или задавать параметры в приложении OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-429">The methods described in this section enable you to perform certain actions or set parameters within the OneNote application.</span></span>
  
### <a name="mergefiles-method"></a><span data-ttu-id="f3a80-430">Метод MergeFiles</span><span class="sxs-lookup"><span data-stu-id="f3a80-430">MergeFiles method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-431">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-431">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-432">Позволяет пользователям объединять изменения для одного и того же файла в одно.</span><span class="sxs-lookup"><span data-stu-id="f3a80-432">Allows users to merge changes for the same file into one.</span></span> <span data-ttu-id="f3a80-433">Чтобы файлы считались одним и тем же файлом, они должны иметь одинаковый идентификатор OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-433">For the files to be considered the same, they must have the same OneNote ID.</span></span>  <br/> |
|<span data-ttu-id="f3a80-434">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-434">**Syntax**</span></span> <br/> | `HRESULT MergeFiles (`<br/>`[in]BSTR bstrBaseFile,`<br/>`[in]BSTR bstrClientFile,`<br/>`[in]BSTR bstrServerFile,`<br/>`[in]BSTR bstrTargetFile);` <br/> |
|<span data-ttu-id="f3a80-435">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-435">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-436">_bstrBaseFile_. Строка пути к расположению файла .one первоначального состояния файла.</span><span class="sxs-lookup"><span data-stu-id="f3a80-436">_bstrBaseFile_ &ndash; The path string to the .one file location of the initial state of the file.</span></span>  <br/><br/><span data-ttu-id="f3a80-437">_bstrClientFile_. Строка, содержащая путь к расположению файла .one второго набора изменений для объединения в базовый файл после объединения изменений серверного файла с базовым.</span><span class="sxs-lookup"><span data-stu-id="f3a80-437">_bstrClientFile_ &ndash; The path string to the .one file location of the second set of changes to be merged with the base file after the server file changes are merged with the base.</span></span>  <br/><br/><span data-ttu-id="f3a80-438">_bstrServerFile_. Строка, содержащая путь к расположению файла .one первого набора изменений для объединения с базовым файлом.</span><span class="sxs-lookup"><span data-stu-id="f3a80-438">_bstrServerFile_ &ndash; The path string to the .one file location of the first set of changes to be merged with the base file.</span></span>  <br/><br/><span data-ttu-id="f3a80-439">_bstrTargetFile_. Строка, содержащая путь к расположению файла .one с объединенными изменениями.</span><span class="sxs-lookup"><span data-stu-id="f3a80-439">_bstrTargetFile_ &ndash; The path string to the .one file location of the file with the merged changes.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-440">Метод **MergeFiles** предназначен для мобильных сценариев, в которых может существовать несколько версий файла OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-440">The **MergeFiles** method was intended for mobile scenarios in which multiple versions of an OneNote file may exist.</span></span> 
  
### <a name="mergesections-method"></a><span data-ttu-id="f3a80-441">Метод MergeSections</span><span class="sxs-lookup"><span data-stu-id="f3a80-441">MergeSections method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-442">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-442">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-443">Объединяет содержимое одного раздела в другой раздел OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-443">Merges the content of one section into another in OneNote.</span></span>  <br/> |
|<span data-ttu-id="f3a80-444">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-444">**Syntax**</span></span> <br/> | `HRESULT MergeSections (`<br/>`[in]BSTR bstrSectionSourceId,`<br/>`[in]BSTR bstrSectionDestinationId);` <br/> |
|<span data-ttu-id="f3a80-445">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-445">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-446">_bstrSectionSourceId_. Идентификатор OneNote раздела для объединения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-446">_bstrSectionSourceId_ &ndash; The OneNote ID of the section to be merged.</span></span>  <br/><br/><span data-ttu-id="f3a80-447">_bstrSectionDestinationId_. Идентификатор OneNote раздела, в котором должно произойти объединение.</span><span class="sxs-lookup"><span data-stu-id="f3a80-447">_bstrSectionDestinationId_ &ndash; The OneNote ID of the section to be merged into.</span></span> <span data-ttu-id="f3a80-448">Раздел источника будет объединен в этом разделе назначения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-448">The source section will be merged into this destination section.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-449">Этот метод выполняет ту же операцию, которую выполняет функция **Объединить в другом разделе**, которая отображается при выборе раздела правой кнопкой мыши.</span><span class="sxs-lookup"><span data-stu-id="f3a80-449">This method performs the same operation as the **Merge into Another Section** feature that is visible when you right-click a section.</span></span> 
  
### <a name="quickfiling-method"></a><span data-ttu-id="f3a80-450">Метод QuickFiling</span><span class="sxs-lookup"><span data-stu-id="f3a80-450">QuickFiling method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-451">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-451">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-452">Возвращает экземпляр диалогового окна [IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog), которое может использоваться для выбора расположения в дереве иерархии OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-452">Returns an instance of the [IQuickFilingDialog](quick-filing-dialog-box-interfaces-onenote.md#odc_IQuickFilingDialog) dialog box, which can be used to select a location within the OneNote hierarchy tree.</span></span>  <br/> |
|<span data-ttu-id="f3a80-453">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-453">**Syntax**</span></span> <br/> | `HRESULT QuickFiling (`<br/>` );` <br/> |
   
### <a name="synchierarchy-method"></a><span data-ttu-id="f3a80-454">Метод SyncHierarchy</span><span class="sxs-lookup"><span data-stu-id="f3a80-454">SyncHierarchy method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-455">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-455">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-456">OneNote выполняет принудительную синхронизацию указанного объекта с исходным файлом на диске.</span><span class="sxs-lookup"><span data-stu-id="f3a80-456">Forces OneNote to sync the specified object with the source file on disk.</span></span>  <br/> |
|<span data-ttu-id="f3a80-457">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-457">**Syntax**</span></span> <br/> | `HRESULT SyncHierarchy (`<br/>`[in]BSTR bstrHierarchyID);` <br/> |
|<span data-ttu-id="f3a80-458">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-458">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-459">_bstrHierarchyID_. Идентификатор OneNote синхронизируемого объекта.</span><span class="sxs-lookup"><span data-stu-id="f3a80-459">_bstrHierarchyID_ &ndash; The OneNote ID of the object to be synced.</span></span>  <br/> |
   
### <a name="setfilinglocation-method"></a><span data-ttu-id="f3a80-460">Метод SetFilingLocation</span><span class="sxs-lookup"><span data-stu-id="f3a80-460">SetFilingLocation method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-461">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-461">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-462">Позволяет пользователям указать, где и как следует хранить определенные типы содержимого в OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-462">Allows users to specify where and how certain types of content should be filed in OneNote.</span></span>  <br/> |
|<span data-ttu-id="f3a80-463">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-463">**Syntax**</span></span> <br/> | `HRESULT SetFilingLocation (`<br/>`[in]FilingLocation flToSet,`<br/>`[in]FilingLocationType fltToSet,`<br/>`[in]BSTR bstrFilingSectionID);`           <br/> |
|<span data-ttu-id="f3a80-464">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-464">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-465">_flToSet_. Тип объекта расположения для хранения, который нужно задать.</span><span class="sxs-lookup"><span data-stu-id="f3a80-465">_flToSet_ &ndash; The object type of the filing location to set.</span></span>  <br/><br/><span data-ttu-id="f3a80-466">_fltToSet_. Расположение для хранения типа.</span><span class="sxs-lookup"><span data-stu-id="f3a80-466">_fltToSet_ &ndash; The location in which to file the type.</span></span>  <br/><br/><span data-ttu-id="f3a80-467">_bstrFilingSectionID_. Идентификатор OneNote раздела или страницы, расположение которых нужно задать.</span><span class="sxs-lookup"><span data-stu-id="f3a80-467">_bstrFilingSectionID_ &ndash; The OneNote ID of the section or page at which location you want to set.</span></span> <span data-ttu-id="f3a80-468">Если неприменимо, пользователь может передать значение NULL или пустую строку.</span><span class="sxs-lookup"><span data-stu-id="f3a80-468">If not applicable, the user can pass in null or an empty string.</span></span>  <br/> |
   
<span data-ttu-id="f3a80-469">Типы содержимого, которое можно хранить, включают элементы Outlook и веб-заметки в Internet Explorer, которые будут импортированы в OneNote с помощью команды **Отправить в OneNote** в каждом приложении.</span><span class="sxs-lookup"><span data-stu-id="f3a80-469">The types of content that can be filed include Outlook items and Web Notes from Internet Explorer that are imported to OneNote through the **Send to OneNote** command in each application.</span></span> <span data-ttu-id="f3a80-470">С помощью этого метода можно задать также расположение для хранения элементов, которые должны печататься в OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-470">The filing location of items that are printed into OneNote can also be set with this method.</span></span> 
  
## <a name="properties"></a><span data-ttu-id="f3a80-471">Свойства</span><span class="sxs-lookup"><span data-stu-id="f3a80-471">Properties</span></span>
<span data-ttu-id="f3a80-472"><a name="ON14DevRef_Application_Properties"> </a></span><span class="sxs-lookup"><span data-stu-id="f3a80-472"></span></span>

<span data-ttu-id="f3a80-473">В этом разделе описаны свойства интерфейса **приложения**.</span><span class="sxs-lookup"><span data-stu-id="f3a80-473">This section describes the properties of the **Application** interface.</span></span> 
  
|<span data-ttu-id="f3a80-474">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="f3a80-474">**Property**</span></span>|<span data-ttu-id="f3a80-475">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-475">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="f3a80-476">**Windows**</span><span class="sxs-lookup"><span data-stu-id="f3a80-476">**Windows**</span></span> <br/> |<span data-ttu-id="f3a80-477">Предоставляет пользователям доступ к открытым окнам OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-477">Gives users access to opened OneNote windows.</span></span> <span data-ttu-id="f3a80-478">Это свойство позволяет пользователям выполнять перечисление через набор окон OneNote и изменять некоторые свойства окон.</span><span class="sxs-lookup"><span data-stu-id="f3a80-478">This property allows users to enumerate through the set of OneNote windows and modify certain window properties.</span></span> <span data-ttu-id="f3a80-479">Дополнительные сведения см. в статье [Интерфейсы Windows](window-interfaces-onenote.md).</span><span class="sxs-lookup"><span data-stu-id="f3a80-479">For more information, see [Windows Interfaces](window-interfaces-onenote.md).</span></span>  <br/> |
|<span data-ttu-id="f3a80-480">**COMAddIns**</span><span class="sxs-lookup"><span data-stu-id="f3a80-480">**COMAddIns**</span></span> <br/> |<span data-ttu-id="f3a80-481">Возвращает коллекцию **COMAddIns** для OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-481">Returns the **COMAddIns** collection for OneNote.</span></span> <span data-ttu-id="f3a80-482">Эта коллекция содержит все надстройки COM, доступные в OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-482">This collection contains all of the COM add-ins that are available to OneNote.</span></span> <span data-ttu-id="f3a80-483">Свойство **Count** коллекции **COMAddins** возвращает количество доступных надстроек COM. Дополнительные сведения см. в статье об объекте [COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx).</span><span class="sxs-lookup"><span data-stu-id="f3a80-483">The **Count** property of the **COMAddins** collection returns the number of available COM add-ins. For more information, see the [COMAddIns](https://msdn.microsoft.com/library/office/ff865489.aspx) object.</span></span>  <br/> |
|<span data-ttu-id="f3a80-484">**LanguageSettings**</span><span class="sxs-lookup"><span data-stu-id="f3a80-484">**LanguageSettings**</span></span> <br/> |<span data-ttu-id="f3a80-485">Позволяет получить доступ к некоторым интерфейсам API, чтобы изменить общие языковые параметры OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-485">Enables you to access some APIs to change the common language settings of OneNote.</span></span>  <br/> |
   
## <a name="events"></a><span data-ttu-id="f3a80-486">События</span><span class="sxs-lookup"><span data-stu-id="f3a80-486">Events</span></span>
<span data-ttu-id="f3a80-487"><a name="ON14DevRef_Application_Events"> </a></span><span class="sxs-lookup"><span data-stu-id="f3a80-487"></span></span>

<span data-ttu-id="f3a80-488">В этом разделе описаны события интерфейса приложения.</span><span class="sxs-lookup"><span data-stu-id="f3a80-488">This section describes the events of the Application interface.</span></span>
  
> [!CAUTION]
> <span data-ttu-id="f3a80-489">В настоящее время события невозможно добавить в управляемый код.</span><span class="sxs-lookup"><span data-stu-id="f3a80-489">Events cannot currently be added in managed code.</span></span> 
  
### <a name="onnavigate-event"></a><span data-ttu-id="f3a80-490">Событие OnNavigate</span><span class="sxs-lookup"><span data-stu-id="f3a80-490">OnNavigate event</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-491">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-491">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-492">Позволяет пользователю назначить функцию, которая будет вызываться при перемещении пользовательского интерфейса OneNote от текущего расположения OneNote.</span><span class="sxs-lookup"><span data-stu-id="f3a80-492">Allows a user to assign a function to be called when the OneNote UI is navigated away from the current OneNote location.</span></span>  <br/> |
|<span data-ttu-id="f3a80-493">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-493">**Syntax**</span></span> <br/> | `Event OnNavigate (`<br/>` );` <br/> |
   
### <a name="onhierarchychange-method"></a><span data-ttu-id="f3a80-494">Метод OnHierarchyChange</span><span class="sxs-lookup"><span data-stu-id="f3a80-494">OnHierarchyChange method</span></span>

|||
|:-----|:-----|
|<span data-ttu-id="f3a80-495">**Описание**</span><span class="sxs-lookup"><span data-stu-id="f3a80-495">**Description**</span></span> <br/> |<span data-ttu-id="f3a80-496">Позволяет пользователю назначить функцию, которая будет вызываться при каждом изменении иерархии OneNote (например, при добавлении или удалении страниц и перемещении разделов).</span><span class="sxs-lookup"><span data-stu-id="f3a80-496">Allows a user to assign a function to be called any time the OneNote hierarchy changes (for example, adding or deleting pages, or moving sections).</span></span> <span data-ttu-id="f3a80-497">Изменения иерархии пакетные. Если происходит несколько изменений одновременно или почти одновременно, событие в OneNote возникает один раз.</span><span class="sxs-lookup"><span data-stu-id="f3a80-497">Hierarchy changes are batched, so if multiple changes occur at or near the same time, OneNote raises the event once.</span></span>  <br/> |
|<span data-ttu-id="f3a80-498">**Синтаксис**</span><span class="sxs-lookup"><span data-stu-id="f3a80-498">**Syntax**</span></span> <br/> | `Event OnHierarchyChange (`<br/>` BSTR bstrActivePageID);` <br/> |
|<span data-ttu-id="f3a80-499">**Параметры**</span><span class="sxs-lookup"><span data-stu-id="f3a80-499">**Parameters**</span></span> <br/> | <span data-ttu-id="f3a80-500">_bstrActivePageID_. Передает идентификатор OneNote активной страницы.</span><span class="sxs-lookup"><span data-stu-id="f3a80-500">_bstrActivePageID_ &ndash; Passes the OneNote ID of the active page.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="f3a80-501">См. также</span><span class="sxs-lookup"><span data-stu-id="f3a80-501">See also</span></span>

- [<span data-ttu-id="f3a80-502">Справочник разработчика для OneNote</span><span class="sxs-lookup"><span data-stu-id="f3a80-502">OneNote developer reference</span></span>](onenote-developer-reference.md)


---
title: Интерфейсы диалоговых окон быстрого хранения (OneNote)
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: d83e39f0-b259-4c33-8f3e-e03e94c2403d
description: В этом разделе описываются интерфейсы, которые можно использовать для программного настройки диалогового окна быстрого хранения в OneNote 2013.
ms.openlocfilehash: dd6b28ae6cb2acb007bae26ea661facaf1f8d4be
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425339"
---
# <a name="quick-filing-dialog-box-interfaces-onenote"></a>Интерфейсы диалоговых окон быстрого хранения (OneNote)

В этом разделе описываются интерфейсы, которые можно использовать для программного настройки диалогового окна быстрого хранения в OneNote 2013.
  
## <a name="quick-filing-dialog-box"></a>Диалоговое окно "быстрое сохранение"

Диалоговое окно "быстрое сохранение" в OneNote 2013 является настраиваемым диалоговым окном, которое позволяет пользователям выбрать расположение в структуре иерархии OneNote. Выбираемые расположения включают записные книжки, группы разделов, разделы, страницы и вложенные страницы. Диалоговое окно используется как в приложении OneNote, так и во внешних приложениях с помощью API OneNote 2013. На рисунке 1 показано диалоговое окно быстрого хранения в состоянии по умолчанию.
  
**Рис. 1. Диалоговое окно "быстрое сохранение" без настроек**

![Диалоговое окно "быстрое сохранение" без](media/ON15Con_quick_filing_dialog.jpg "настройки диалогового окна \"краткое профилирование\" без настроек")
  
В диалоговом окне пользователи могут перейти в иерархию "все записные книжки", чтобы найти определенные расположения, или выполнить поиск по древовидной структуре OneNote, введя текст в текстовое поле. Параметры диалогового окна, которое можно изменить, включают название, описание, список недавних результатов, текст флажка и состояние, глубину дерева, кнопки и доступные для выбора типы расположения.

Вы можете получить доступ к функциям диалогового окна "быстрое сохранение" через два интерфейса OneNote 2013. Интерфейс **икуиккфилингдиалог** позволяет пользователям создавать экземпляры, настраивать и запускать диалоговое окно. Интерфейс **икуиккфилингдиалогкаллбакк** вызывается после закрытия диалогового окна. Диалоговое окно запускается в процессе OneNote, поэтому необходим механизм, позволяющий обеспечить выполнение потока диалогового окна, а затем записывать выбор пользователя и состояние диалогового окна при его закрытии. 
  
## <a name="iquickfilingdialog-interface"></a>Интерфейс Икуиккфилингдиалог
<a name="odc_IQuickFilingDialog"> </a>

Этот интерфейс позволяет пользователю настраивать и запускать диалоговое окно. Пользователь может создать экземпляр диалогового окна с помощью класса **Application** с помощью метода **Application. куиккфилингдиалог** . Метод возвращает экземпляр диалогового окна. После задания свойств диалогового окна метод **икуиккфилингдиалог. Run** используется для запуска диалогового окна. Этот метод запускает диалоговое окно в новом потоке. 
  
**Свойства**

|**Имя**|**Тип**|**Описание**|
|:-----|:-----|:-----|
|**Заголовок** <br/> |string  <br/> |Получает или задает текст заголовка, который отображается в строке заголовка окна диалогового окна.  <br/> |
|**Описание** <br/> |string  <br/> |Получает или задает текстовое описание, указывающее пользователю, что нужно выбрать. Это значение может быть многострочным текстом.  <br/> |
|**чеккбокстекст** <br/> |string  <br/> |Получает или задает текст, который следует за флажком. Если для этого параметра задана непустая строка, в диалоговом окне отображается флажок. Если значением является пустая строка, флажок не отображается.  <br/> |
|**чеккбоксстате** <br/> |логический  <br/> |Получает или задает состояние флажка. Если параметру присвоено значение **false**, то при запуске диалогового окна флажок снимается. Если для этого параметра установлено значение **true**, то при запуске диалогового окна устанавливается флажок, если **чеккбокстекст** не является пустой строкой.  <br/> |
|**виндовхандле** <br/> |ulong  <br/> |Получает идентификатор дескриптора для окна диалогового окна быстрого хранения.  <br/> |
|**тридепс** <br/> |**хиерарчелемент** <br/> |Получает или задает значение, указывающее, как глубокое дерево OneNote должно отображаться в разделе Все записные книжки. По умолчанию дерево отображается в соответствии с разделами. Это свойство не влияет на тип элементов, которые можно выбрать.  <br/> Если для **тридепс** задан элемент, расположенный ниже в иерархии OneNote, чем можно выбрать с помощью любой из кнопок, отображаемая глубина дерева будет наименьшим возможным выбираемым элементом. То есть, если глубина дерева настроена на отображение страниц, но самый маленький элемент является разделом, дерево отображается в разделах.  <br/> |
|**парентвиндовхандле** <br/> |ulong  <br/> |Получает или задает идентификатор дескриптора родительского окна диалогового окна. Если это свойство задано, диалоговое окно быстрого хранения будет модальным для назначенного родительского окна при открытии диалогового окна. Таким образом, пользователь не сможет получить доступ к родительскому окну до тех пор, пока не будет закрыто диалоговое окно "быстрое Архивация".  <br/> |
|**Position** <br/> |тагпоинт  <br/> |Получает или задает положение окна по отношению к экрану. По умолчанию диалоговое окно отображается в середине родительского окна или рабочего стола.  <br/> |
|**SelectedItem** <br/> |string  <br/> |Получает идентификатор объекта расположения OneNote, выбранного пользователем при закрытии диалогового окна. Если пользователь нажимает кнопку **Cancel (Отмена** ), для объекта устанавливается значение null.  <br/> |
|**пресседбуттон** <br/> |ulong  <br/> |Получает значение, по которому была нажата кнопка при закрытии диалогового окна. Если была нажата кнопка **Cancel (Отмена** ), это свойство возвращает значение – 1. Всем остальным кнопкам присваиваются целочисленные значения от 0, что увеличивается на 1 для каждой кнопки, добавленной в диалоговое окно. Целочисленное значение кнопки **ОК** по умолчанию равно 0.  <br/> |
   
### <a name="methods"></a>Methods

**сетрецентресултс**

|||
|:-----|:-----|
|**Описание** <br/> |Задает, какой список последних результатов будет отображаться в диалоговом окне "быстрое сохранение", и указывает, следует ли включить в список некоторые специальные места хранения. Пользователи могут выбрать последний список результатов из перечисления [рецентресулттипе](enumerations-onenote-developer-reference.md#odc_RecentResultType) . Кроме того, пользователи могут добавлять в список следующие параметры: текущий раздел, текущая страница или unfile Notes. Если выбрано **рецентресулттипе. рртноне** , список последних результатов не отображается.  <br/> |
|**Синтаксис** <br/> | `HRESULT SetRecentResults (`<br/>`[in]RecentResultType recentResults,`<br/>`[in]VARIANT_BOOL fShowCurrentSection,`<br/>`[in]VARIANT_BOOL fShowCurrentPage,`<br/>`[in]VARIANT_BOOL fShowUnfiledNotes);` <br/> |
|**Параметры** <br/> | _рецентресултс_ &ndash; объект типа **рецентресулттипе** , указывающий, какой список последних результатов (при его наличии) должен отображаться. Если выбрано значение **рртноне** , в диалоговом окне не отображается ни одного списка результатов.<br/><br/>  _фшовкуррентсектион_ &ndash; логическое значение, которое указывает, следует ли включить текущий раздел в список последних результатов.<br/><br/>  _фшовкуррентпаже_ &ndash; логическое значение, которое указывает, следует ли включить текущую страницу в список последних результатов.<br/><br/>  _фшовунфиледнотес_ &ndash; логическое значение, которое указывает, следует ли включать раздел "неные заметки" в список последних результатов.  <br/> |
   
> [!NOTE]
> Если специальное расположение для хранения не может быть выбрано с помощью каких-либо кнопок в диалоговом окне, оно не отображается в списке. Если в списке "Недавние результаты" нет выбираемого элемента, список последних результатов не отображается. 
  
В следующем примере используется метод **сетрецентресултс** для отображения текущего раздела, текущей страницы и раздела unfile Notes в списке последних результатов. 
  
```cs
        static void Main(string[] args)
        {
            Microsoft.Office.Interop.OneNote.Application app = 
                new Microsoft.Office.Interop.OneNote.Application();
            ... 
            // RECENT RESULTS
            qfDialog.SetRecentResults(RecentResultType.rrtFiling,
                /*Current Section*/ true,
                /*Current Page*/ true,
                /*Unfiled Notes*/ true);
            ...
        }

```

**аддбуттон**

|||
|:-----|:-----|
|**Описание** <br/> |Позволяет пользователям добавлять и настраивать кнопки в диалоговом окне. Пользователи могут указать текст на кнопках и элементы иерархии OneNote, которые могут быть выбраны каждой кнопкой.  <br/> |
|**Синтаксис** <br/> | `HRESULT AddButton (`<br/>`[in]BSTR bstrText,`<br/>`[in]HierarchyElement allowedElements,`<br/>`[in]HierarchyElement allowedReadOnlyElements,`<br/>`[in]VARIANT_BOOL fDefault);` <br/> |
|**Параметры** <br/> | _бстртекст_ &ndash; строка, указывающая текст, который будет отображаться на кнопке. Чтобы настроить кнопку " **ОК** " по умолчанию, передайте значение NULL в качестве **бстртекст**.  <br/><br/>_алловеделементс_ &ndash; **хиерарчелемент** , указывающий, какие элементы иерархии OneNote, не предназначенные только для чтения, разрешено выбирать пользователю с помощью кнопки. Для выбора нескольких элементов пользователь должен передать оператор **or** для всех эквивалентных **значений типа uint,** допустимых в виде **хиерарчелемент**.<br/><br/>  _алловедреадонлелементс_ &ndash; **хиерарчелемент** , который указывает, какие элементы иерархии OneNote, доступные только для чтения, разрешено выбирать пользователю с помощью кнопки. Чтобы выбрать несколько элементов, пользователь должен передать оператору **or** все значения **uint** , эквивалентные типам **хиерарчелемент** , разрешенные в виде **хиерарчелемент**.<br/><br/>  _фдефаулт_ &ndash; логическое значение, указывающее, должна ли эта кнопка быть кнопкой по умолчанию. Если для нескольких кнопок задано значение по умолчанию, Последняя указанная кнопка становится кнопкой по умолчанию.  <br/> |
   
В приведенном ниже примере в диалоговое окно "быстрое хранение" добавляются три кнопки. Первый из них может быть **выбран всеми элементами**в дереве иерархии OneNote. Остальные, **записные книжки** и **страницы**можно выбирать только в том случае, если выбраны соответствующие элементы, записные книжки и страницы.
  
```cs
        static void Main(string[] args)
        {
            Microsoft.Office.Interop.OneNote.Application app = 
                new Microsoft.Office.Interop.OneNote.Application();
            ... 
            
            // BUTTONS
            HierarchyElement heAll = (HierarchyElement) 
                ((uint)HierarchyElement.heNotebooks | 
                (uint)HierarchyElement.heSectionGroups | 
                (uint)HierarchyElement.heSections |  
                (uint)HierarchyElement.hePages);
            
            qfDialog.AddButton("All", heAll, heAll, true);
            qfDialog.AddButton("Notebooks", HierarchyElement.heNotebooks, 
                HierarchyElement.heNotebooks, false);
            qfDialog.AddButton("Pages", HierarchyElement.hePages, 
                HierarchyElement.hePages, false);
            ... 
        }

```

**Run**

|||
|:-----|:-----|
|**Описание** <br/> |Отображает диалоговое окно "быстрое сохранение в новом потоке". Он принимает ссылку на интерфейс **икуиккфилингдиалогкаллбакк** , метод **ондиалогклосед** которого будет вызываться после закрытия диалогового окна.  <br/> |
|**Синтаксис** <br/> | `HRESULT Run (`<br/>`[in]IQuickFilingDialogCallback piCallback);` <br/> |
|**Параметры** <br/> | _пикаллбакк_ &ndash; ссылка на интерфейс **икуиккфилингдиалогкаллбакк** , который будет создан после закрытия диалогового окна.  <br/> |
   
В следующем примере используется метод **Run** для отображения диалогового окна быстрого хранения из нового потока. 
  
```cs
    class OpenQuickFilingDialog
    {
            ... 
        static void Main(string[] args)
        {
            Microsoft.Office.Interop.OneNote.Application app = 
                new Microsoft.Office.Interop.OneNote.Application();
            ... 
            // Display Quick Filing UI
            qfDialog.Run(new Callback());
            ... 
        }
    }

```

**триколлапседстате**

|||
|:-----|:-----|
|**Описание** <br/> |Указывает, должно ли дерево иерархии разворачиваться или сворачиваться.  <br/> |
|**Синтаксис** <br/> | `HRESULT TreeCollapsedState(`<br/>`[in] TreeCollapsedStateType tcs);` <br/> |
|**Параметры** <br/> | _служб TCS_ — указывает, развернут или свернут дерево.  <br/> |
   
**нотебукфилтераут**

|||
|:-----|:-----|
|**Описание** <br/> |Фильтрует список записных книжек, отображаемых по типу.  <br/> |
|**Синтаксис** <br/> | `HRESULT NotebookFilterOut(`<br/>`[in] NotebookFilterOutType nfo);` <br/> |
|**Параметры** <br/> | _NFO_ — задает набор записных книжек, которые будут отфильтровываться из списка.  <br/> |
   
**шовкреатеневнотебук**

|||
|:-----|:-----|
|**Описание** <br/> |Отображает параметр создать новую записную книжку в диалоговом окне.  <br/> |
|**Синтаксис** <br/> | `HRESULT ShowCreateNewNotebook ();` <br/> |
|**Параметры** <br/> |Нет  <br/> |
   
**аддинитиаледитор**

|||
|:-----|:-----|
|**Описание** <br/> |Добавляет пользователя в качестве исходного редактора в записную книжку в диалоговом окне "быстрое хранение".  <br/> |
|**Синтаксис** <br/> | `HRESULT AddInitialEditor (BSTR initialEditor);` <br/> |
|**Параметры** <br/> | _инитиаледитор_ — адрес электронной почты пользователя, который вы хотите добавить в качестве редактора записной книжки. Когда Записная книжка создается с помощью диалогового окна "быстрое Архивация", она автоматически становится общей для всех начальных редакторов.  <br/> |
   
**клеаринитиаледиторс**

|||
|:-----|:-----|
|**Описание** <br/> |Удаляет все начальные редакторы из диалогового окна "быстрое сохранение".  <br/> |
|**Синтаксис** <br/> | `HRESULT ClearInitialEditors ();` <br/> |
|**Параметры** <br/> |Нет  <br/> |
   
**шовшарингхиперлинк**

|||
|:-----|:-----|
|**Описание** <br/> |Отображает ссылку на раздел справки "общий доступ" в диалоговом окне "быстрое Архивация".  <br/> |
|**Синтаксис** <br/> | `HRESULT ShowSharingHyperlink();` <br/> |
|**Параметры** <br/> |Нет  <br/> |
   
## <a name="iquickfilingdialogcallback-interface"></a>Интерфейс Икуиккфилингдиалогкаллбакк
<a name="odc_IQuickFilingDialog"> </a>

Этот интерфейс позволяет пользователю получить доступ к свойствам диалогового окна после закрытия диалогового окна. Когда диалоговое окно закроется, OneNote 2013 вызывает метод **икуиккфилингдиалогкаллбакк. ондиалогклосе** в этом интерфейсе. 
  
Необходимо определить класс, наследуемый этим интерфейсом.
  
### <a name="methods"></a>Methods

В следующем разделе описаны методы, связанные с интерфейсами, описанными выше.
  
**ондиалогклосед**

|||
|:-----|:-----|
|**Описание** <br/> |Позволяет пользователям добавлять функции для захвата и использования выбора пользователя в диалоговом окне. Этот метод вызывается после закрытия диалогового окна "быстрое Архивация". Этот метод является функцией, которую необходимо определить для интерфейсов **икуиккфилингдиалогкаллбакк** .  <br/> |
|**Синтаксис** <br/> | `HRESULT OnDialogClosed (`<br/>`[in]IQuickFilingDialog dialog);` <br/> |
|**Параметры** <br/> | _диалоговое окно_ &ndash; с объектом **икуиккфилингдиалог** , который вызвал метод **ондиалогклосе** .  <br/> |
   
Ниже приведен пример интерфейса **икуиккфилингдиалогкаллбакк** . Метод **ондиалогклосе** выводит выбранные пользователем элементы из диалогового окна быстрого хранения в консоль. 
  
```cs
    class Callback : IQuickFilingDialogCallback
    {
        public Callback(){}
        public void OnDialogClosed(IQuickFilingDialog qfDialog)
        {
            Console.WriteLine(qfDialog.SelectedItem);
            Console.WriteLine(qfDialog.PressedButton);
            Console.WriteLine(qfDialog.CheckboxState);
        }
    }

```

## <a name="example"></a>Пример
<a name="odc_IQuickFilingDialog"> </a>

В следующем примере кода открывается диалоговое окно быстрого хранения с настроенным названием, описанием, списком последних результатов, глубиной дерева, флажком и кнопками. Выбранный пользователем элемент, нажатая кнопка и состояние флажка будут отображаться в окне консоли при закрытии диалогового окна. Чтобы увидеть, включена ли кнопка страницы, пользователь должен выполнить поиск страницы и выбрать ее, так как глубина дерева устанавливается на разделы. Диалоговое окно не является дочерним по отношению к какому-либо окну.
  
```cs
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using Microsoft.Office.Interop.OneNote;
namespace SampleQFD
{
    class OpenQuickFilingDialog
    {
        private static EventWaitHandle wh = new AutoResetEvent(false);
        private static IQuickFilingDialog qfDialog;
        private static String strTitle = "Sample Title";
        private static String strDescription = "Sample Description";
        private static String strCheckboxText = "Sample Checkbox";
        static void Main(string[] args)
        {
            Microsoft.Office.Interop.OneNote.Application app = 
                new Microsoft.Office.Interop.OneNote.Application();
            // Instantiate Quick Filing UI
            qfDialog = app.QuickFiling();
            #region//SET API PARAMETERS
            // TITLE
            qfDialog.Title = strTitle;
            // DESCRIPTION
            qfDialog.Description = strDescription;
            // RECENT RESULTS
            qfDialog.SetRecentResults(RecentResultType.rrtFiling,
                /*Current Section*/ true,
                /*Current Page*/ true,
                /*Unfiled Notes*/ true);
            // TREE DEPTH
            qfDialog.TreeDepth = HierarchyElement.heSections;
            // CHECKBOX
            qfDialog.CheckboxText = strCheckboxText;
            qfDialog.CheckboxState = false;
            // BUTTONS
            HierarchyElement heAll = (HierarchyElement) 
                ((uint)HierarchyElement.heNotebooks | 
                (uint)HierarchyElement.heSectionGroups | 
                (uint)HierarchyElement.heSections |  
                (uint)HierarchyElement.hePages);
            
            qfDialog.AddButton("All", heAll, heAll, true);
            qfDialog.AddButton("Notebooks", HierarchyElement.heNotebooks, 
                HierarchyElement.heNotebooks, false);
            qfDialog.AddButton("Pages", HierarchyElement.hePages, 
                HierarchyElement.hePages, false);
            // PARENTWINDOW
            #endregion
            // Display Quick Filing UI
            qfDialog.Run(new Callback());
            // Clean up and Wait so console window does not close
            qfDialog = null;
            wh.WaitOne();
        }
    }
    class Callback : IQuickFilingDialogCallback
    {
        public Callback(){}
        public void OnDialogClosed(IQuickFilingDialog qfDialog)
        {
            Console.WriteLine(qfDialog.SelectedItem);
            Console.WriteLine(qfDialog.PressedButton);
            Console.WriteLine(qfDialog.CheckboxState);
        }
    }
}

```

## <a name="see-also"></a>См. также

- [Справочник разработчика для OneNote](onenote-developer-reference.md)

